
/* Result Sets Interface */
#ifndef SQL_CRSR
#  define SQL_CRSR
  struct sql_cursor
  {
    unsigned int curocn;
    void *ptr1;
    void *ptr2;
    unsigned long magic;
  };
  typedef struct sql_cursor sql_cursor;
  typedef struct sql_cursor SQL_CURSOR;
#endif /* SQL_CRSR */

/* Thread Safety */
typedef void * sql_context;
typedef void * SQL_CONTEXT;

/* Object support */
struct sqltvn
{
  unsigned char *tvnvsn; 
  unsigned short tvnvsnl; 
  unsigned char *tvnnm;
  unsigned short tvnnml; 
  unsigned char *tvnsnm;
  unsigned short tvnsnml;
};
typedef struct sqltvn sqltvn;

struct sqladts
{
  unsigned int adtvsn; 
  unsigned short adtmode; 
  unsigned short adtnum;  
  sqltvn adttvn[1];       
};
typedef struct sqladts sqladts;

static struct sqladts sqladt = {
  1,1,0,
};

/* Binding to PL/SQL Records */
struct sqltdss
{
  unsigned int tdsvsn; 
  unsigned short tdsnum; 
  unsigned char *tdsval[1]; 
};
typedef struct sqltdss sqltdss;
static struct sqltdss sqltds =
{
  1,
  0,
};

/* File name & Package Name */
struct sqlcxp
{
  unsigned short fillen;
           char  filnam[59];
};
static const struct sqlcxp sqlfpn =
{
    58,
    "c:\\documents and settings\\durair\\desktop\\durai\\rlrsenq4.pc"
};


static unsigned long sqlctx = 1726287563;


static struct sqlexd {
   unsigned int   sqlvsn;
   unsigned int   arrsiz;
   unsigned int   iters;
   unsigned int   offset;
   unsigned short selerr;
   unsigned short sqlety;
   unsigned int   occurs;
      const short *cud;
   unsigned char  *sqlest;
      const char  *stmt;
   sqladts *sqladtp;
   sqltdss *sqltdsp;
            void  **sqphsv;
   unsigned int   *sqphsl;
            int   *sqphss;
            void  **sqpind;
            int   *sqpins;
   unsigned int   *sqparm;
   unsigned int   **sqparc;
   unsigned short  *sqpadto;
   unsigned short  *sqptdso;
            void  *sqhstv[33];
   unsigned int   sqhstl[33];
            int   sqhsts[33];
            void  *sqindv[33];
            int   sqinds[33];
   unsigned int   sqharm[33];
   unsigned int   *sqharc[33];
   unsigned short  sqadto[33];
   unsigned short  sqtdso[33];
} sqlstm = {10,33};

/* SQLLIB Prototypes */
extern void sqlcxt (void **, unsigned long *,
                    struct sqlexd *, const struct sqlcxp *);
extern void sqlcx2t(void **, unsigned long *,
                    struct sqlexd *, const struct sqlcxp *);
extern void sqlbuft(void **, char *);
extern void sqlgs2t(void **, char *);
extern void sqlorat(void **, unsigned long *, void *);

/* Forms Interface */
static const int IAPSUCC = 0;
static const int IAPFAIL = 1403;
static const int IAPFTL  = 535;
extern void sqliem(char *, int *);

 static const char *sq0040 = 
"select SOURCE_CODE ,CONSULTANT_CODE ,TO_CHAR(SPEC_RECD_DATE_TIME,'DD/MM/YYYY\
 HH24:MI') ,TO_CHAR(SPEC_REGD_DATE_TIME,'DD/MM/YYYY HH24:MI') ,TO_CHAR(SPEC_CO\
LLTD_DATE_TIME,'DD/MM/YYYY HH24:MI') ,TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI') ,S\
ECTION_CODE ,REQUEST_COMMENT_CODE1 ,REQUEST_COMMENT_CODE2 ,REQUEST_COMMENT_COD\
E3 ,REQUEST_COMMENT_DESC1 ,REQUEST_COMMENT_DESC2 ,REQUEST_COMMENT_DESC3 ,EXTRA\
_COPIES_TO ,SPECIMEN_TYPE_CODE ,ADDED_BY_ID ,TO_CHAR(ADDED_DATE,'DD/MM/YYYY HH\
24:MI') ,MODIFIED_BY_ID ,TO_CHAR(MODIFIED_DATE,'DD/MM/YYYY HH24:MI') ,URGENT_I\
NDICATOR ,EPISODE_TYPE ,SOURCE_TYPE ,RELEASED_BY_ID ,TO_CHAR(RELEASED_DATE,'DD\
/MM/YYYY HH24:MI') ,category_code ,category_year ,category_number ,TO_CHAR(SPE\
C_REGD_DATE_TIME,'DD/MM/YYYY') ,ordered_facility_id ,ordering_doctor_name ,pat\
ient_id ,order_id ,perform_site_code  from RL_REQUEST_HEADER where (SPECIMEN_N\
O=:b0 and OPERATING_FACILITY_ID=:b1) for update of STATUS nowait ";

 static const char *sq0041 = 
"select TEST_CODE ,NVL(RESULT_STATUS,'O') ,DECODE(GROUP_TEST_YN,'Y','G','I') \
 from RL_REQUEST_DETAIL where ((PATIENT_ID=:b0 and SPECIMEN_NO=:b1) and OPERAT\
ING_FACILITY_ID=:b2)           ";

 static const char *sq0046 = 
"select SNOMED_CODE ,snomed_code_2 ,SNOMED_MARKER_CODE_1 ,SNOMED_MARKER_CODE_\
2  from RL_RESULT_SNOMED where ((((PATIENT_ID=:b0 and SPECIMEN_NO=:b1) and OPE\
RATING_FACILITY_ID=:b2) and GROUP_TEST_CODE=:b3) and TEST_CODE=:b4) order by S\
NOMED_CODE            ";

 static const char *sq0047 = 
"select ORGANISM_CODE ,RESULT_COMMENT_DESC  from RL_RESULT_ORGANISM where (((\
((PATIENT_ID=:b0 and SPECIMEN_NO=:b1) and OPERATING_FACILITY_ID=:b2) and GROUP\
_TEST_CODE=:b3) and TEST_CODE=:b4) and NVL(hide_organism_yn,'N')<>'Y') order b\
y ORGANISM_CODE            ";

 static const char *sq0048 = 
"select distinct ANTIBIOTIC_CODE  from RL_RESULT_ORGANISM_DTL where ((((((PAT\
IENT_ID=:b0 and SPECIMEN_NO=:b1) and OPERATING_FACILITY_ID=:b2) and GROUP_TEST\
_CODE=:b3) and TEST_CODE=:b4) and REPORT_YN='Y') and SENSITIVITY_IND in ('S','\
R','I')) order by ANTIBIOTIC_CODE            ";

 static const char *sq0049 = 
"select ORGANISM_CODE ,ANTIBIOTIC_CODE ,SENSITIVITY_IND ,MIC_RESULT ,zone_siz\
e  from RL_RESULT_ORGANISM_DTL where ((((((PATIENT_ID=:b0 and SPECIMEN_NO=:b1)\
 and OPERATING_FACILITY_ID=:b2) and GROUP_TEST_CODE=:b3) and TEST_CODE=:b4) an\
d REPORT_YN='Y') and SENSITIVITY_IND in ('S','R','I')) order by ANTIBIOTIC_COD\
E,ORGANISM_CODE            ";

 static const char *sq0050 = 
"select ANTIBIOTIC_CODE ,SENSITIVITY_IND ,MIC_RESULT ,zone_size  from RL_RESU\
LT_ORGANISM_DTL where (((((((PATIENT_ID=:b0 and SPECIMEN_NO=:b1) and OPERATING\
_FACILITY_ID=:b2) and GROUP_TEST_CODE=:b3) and TEST_CODE=:b4) and ORGANISM_COD\
E=:b5) and REPORT_YN='Y') and SENSITIVITY_IND in ('S','R','I')) order by SEQ_N\
O            ";

 static const char *sq0059 = 
"select TITLE_CODE ,DECODE(:b0,'en',SHORT_NAME,'th',SHORT_NAME_LOC_LANG) SHOR\
T_NAME ,SEX ,NATIONALITY_CODE ,ROUND((TRUNC(TO_DATE(:b1,'DD/MM/YYYY HH24:MI'))\
-DATE_OF_BIRTH)) ,TO_CHAR(DATE_OF_BIRTH,'DD/MM/YYYY') ,NVL(actual_dob_yn,'N') \
,race_code ,ROUND(((TRUNC(TO_DATE(:b1,'DD/MM/YYYY HH24:MI'))-DATE_OF_BIRTH)/36\
5)) ,NATIONAL_ID_NUM ,nvl(ALTERNATE_ID_NUM,nvl(ALTERNATE_ID2_NUM,nvl(ALTERNATE\
_ID3_NUM,nvl(ALTERNATE_ID4_NUM,' '))))  from MP_PATIENT_MAST where PATIENT_ID=\
:b3           ";

 static const char *sq0060 = 
"select TITLE_CODE ,DECODE(:b0,'en',SHORT_NAME,'th',SHORT_NAME_LOC_LANG) SHOR\
T_NAME ,SEX ,NATIONALITY_CODE ,ROUND((TRUNC(TO_DATE(:b1,'DD/MM/YYYY HH24:MI'))\
-DATE_OF_BIRTH)) ,TO_CHAR(DATE_OF_BIRTH,'DD/MM/YYYY') ,NVL(actual_dob_yn,'N') \
,race_code ,ROUND(((TRUNC(TO_DATE(:b1,'DD/MM/YYYY HH24:MI'))-DATE_OF_BIRTH)/36\
5)) ,NATIONAL_ID_NUM  from MP_PATIENT_MAST where PATIENT_ID=:b3           ";

 static const char *sq0061 = 
"select TITLE_CODE ,DECODE(:b0,'en',SHORT_NAME,'th',SHORT_NAME_LOC_LANG) SHOR\
T_NAME ,SEX ,NATIONALITY_CODE ,ROUND((TRUNC(TO_DATE(:b1,'DD/MM/YYYY HH24:MI'))\
-DATE_OF_BIRTH)) ,TO_CHAR(DATE_OF_BIRTH,'DD/MM/YYYY') ,SUBSTR(NVL(ACTUAL_PATIE\
NT_ID,'NULL'),1,10) ,NVL(actual_dob_yn,'N') ,race_code ,ROUND(((TRUNC(TO_DATE(\
:b1,'DD/MM/YYYY HH24:MI'))-DATE_OF_BIRTH)/365)) ,location  from RL_PATIENT_MAS\
T where PATIENT_ID=:b3           ";

 static const char *sq0042 = 
"select COMMENT_TEXT  from RL_COMMENTS_FOR_TEST where TEST_CODE=:b0 order by \
SEQ_NO            ";

 static const char *sq0043 = 
"select RESULT_TEXT  from RL_RESULT_TEXT where (((((PATIENT_ID=:b0 and SPECIM\
EN_NO=:b1) and OPERATING_FACILITY_ID=:b2) and GROUP_TEST_CODE=:b3) and TEST_CO\
DE=:b4) and NVL(hide_text_yn,'N')<>'Y') order by SERIAL_NO            ";

 static const char *sq0045 = 
"select OPERAND_1 ,OPERAND_1_TYPE ,OPERATOR_1 ,OPERAND_2 ,OPERAND_2_TYPE ,OPE\
RATOR_2  from RL_FUNCTION where TEST_CODE=:b0 order by SEQ_NUMBER            ";

 static const char *sq0088 = 
"select TEST_CODE ,GROUP_TEST_YN  from RL_REQUEST_DETAIL where (SPECIMEN_NO=T\
O_NUMBER(:b0) and OPERATING_FACILITY_ID=:b1) for update of result_status nowai\
t ";

 static const char *sq0099 = 
"select distinct TO_CHAR(A.interval_test_specimen_no)  from RL_INTERVAL_TEST_\
SPECIMENS A where (((A.specimen_no=TO_NUMBER(:b0) and A.OPERATING_FACILITY_ID=\
:b1) and NVL(A.cancelled_yn,'N')<>'Y') and (NVL(A.status,'O') in ('R',:b2) or \
:b3='Y'))           ";

 static const char *sq0102 = 
"select test_code  from RL_REQUEST_DETAIL where (((specimen_no=TO_NUMBER(:b0)\
 and OPERATING_FACILITY_ID=:b1) and NVL(cancelled_yn,'N')<>'Y') and (((NVL(res\
ult_status,'O') in ('R',:b2) or :b3='Y') or (test_code in (select test_code  f\
rom RL_TEST_CODE where (NVL(PROFILE_YN,'N')='Y' and NVL(GROUP_TEST_YN,'N')='Y'\
)) and (NVL(result_status,'O')='O' or (NVL(result_status,'O') in ('A') and rel\
eased_date is  not null )))) or (NVL(preliminary_release_yn,'N')='Y' and NVL(r\
esult_status,'O') in ('A'))))           ";

 static const char *sq0105 = 
"select TO_CHAR(A.specimen_no) ,A.group_test_code ,A.test_code ,A.seq_no  fro\
m RL_INTERVAL_TEST_SPECIMENS A where ((A.interval_test_specimen_no=TO_NUMBER(:\
b0) and OPERATING_FACILITY_ID=:b1) and NVL(A.cancelled_yn,'N')<>'Y') order by \
A.specimen_no            ";

 static const char *sq0112 = 
"select TO_CHAR(A.interval_test_specimen_no)  from RL_INTERVAL_TEST_SPECIMENS\
 A where (((A.specimen_no=TO_NUMBER(:b0) and A.OPERATING_FACILITY_ID=:b1) and \
NVL(A.cancelled_yn,'N')<>'Y') and (NVL(A.status,'O') in ('R',:b2) or :b3='Y'))\
 order by A.specimen_no            ";

 static const char *sq0114 = 
"select specimen_no ,clinical_text_code ,SUBSTR(clinical_text,1,4000)  from R\
L_PATIENT_CLINICAL_TEXT where ((specimen_no in (select distinct specimen_no  f\
rom RL_INTERVAL_TEST_TEMP where ((OPERATING_FACILITY_ID=:b0 and user_id='RLRRS\
ENQ') and session_id=1)) and OPERATING_FACILITY_ID=:b0) and NVL(order_question\
naire_yn,'N')<>'Y') order by specimen_no            ";

 static const char *sq0120 = 
"select distinct specimen_no  from RL_INTERVAL_TEST_TEMP where ((OPERATING_FA\
CILITY_ID=:b0 and user_id='RLRRSENQ') and session_id=1)           ";

 static const char *sq0122 = 
"select test_code ,cancel_code  from RL_REQUEST_DETAIL where ((specimen_no=TO\
_NUMBER(:b0) and OPERATING_FACILITY_ID=:b1) and NVL(cancelled_yn,'N')='Y')    \
       ";

 static const char *sq0123 = 
"select TO_CHAR(specimen_no) ,group_test_code ,test_code  from RL_INTERVAL_TE\
ST_TEMP where ((OPERATING_FACILITY_ID=:b0 and user_id='RLRRSENQ') and session_\
id=2)           ";

 static const char *sq0135 = 
"select OPERATING_FACILITY_ID ,SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDM\
MYYHH24MISS') ,MACHINE_NAME ,WS_NO ,ROWID ,PRINT_SERVER_ID ,PRINTER_NAME ,DEST\
_QUEUE_NAME ,FAX_ID ,MAIL_ID  from SY_REPORT_GENERATE_REQUEST where (((OPERATI\
NG_FACILITY_ID=DECODE(:b0,'*A',OPERATING_FACILITY_ID,:b0) and PGM_ID='RLRRSENQ\
') and REQUEST_STATUS is null ) and NVL(URGENT_INDICATOR,' ')='U')           ";

 static const char *sq0136 = 
"select OPERATING_FACILITY_ID ,SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDM\
MYYHH24MISS') ,MACHINE_NAME ,WS_NO ,ROWID ,PRINT_SERVER_ID ,PRINTER_NAME ,DEST\
_QUEUE_NAME ,FAX_ID ,MAIL_ID  from SY_REPORT_GENERATE_REQUEST where (((OPERATI\
NG_FACILITY_ID=DECODE(:b0,'*A',OPERATING_FACILITY_ID,:b0) and PGM_ID='RLRRSENQ\
') and REQUEST_STATUS is null ) and NVL(URGENT_INDICATOR,' ')='S')           ";

 static const char *sq0137 = 
"select OPERATING_FACILITY_ID ,SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDM\
MYYHH24MISS') ,MACHINE_NAME ,WS_NO ,ROWID ,PRINT_SERVER_ID ,PRINTER_NAME ,DEST\
_QUEUE_NAME ,FAX_ID ,MAIL_ID  from SY_REPORT_GENERATE_REQUEST where (((OPERATI\
NG_FACILITY_ID=DECODE(:b0,'*A',OPERATING_FACILITY_ID,:b0) and PGM_ID='RLRRSENQ\
') and REQUEST_STATUS is null ) and NVL(URGENT_INDICATOR,' ')='R')           ";

 static const char *sq0139 = 
"select OPERATING_FACILITY_ID ,PARAM1 ,PARAM2 ,PARAM3 ,PARAM4 ,PARAM5 ,NVL(PA\
RAM6,'N') ,PARAM7 ,PARAM8 ,NVL(PARAM9,'PRINT') ,NVL(PARAM10,'N') ,NVL(PARAM11,\
'N') ,NVL(PARAM12,'N') ,NVL(PARAM13,'N') ,PARAM15 ,PARAM16 ,PARAM19 ,PARAM20 ,\
PARAM21 ,rowid ,pgm_date  from SY_PROG_PARAM where (((OPERATING_FACILITY_ID=DE\
CODE(:b0,'*A',OPERATING_FACILITY_ID,:b0) and pgm_id='Rlrsenq4') and session_id\
=TO_NUMBER(:b2)) and param4=:b3) order by param9,TO_DATE(param10,'DD/MM/YYYY H\
H24:MI:SS')            ";

 static const char *sq0143 = 
"select OPERATING_FACILITY_ID ,SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDM\
MYYHH24MISS') ,MACHINE_NAME ,WS_NO ,ROWID ,PRINT_SERVER_ID ,PRINTER_NAME ,DEST\
_QUEUE_NAME ,FAX_ID ,MAIL_ID  from SY_REPORT_GENERATE_REQUEST where (((OPERATI\
NG_FACILITY_ID=DECODE(:b0,'*A',OPERATING_FACILITY_ID,:b0) and pgm_id in ('RLRR\
SENQ')) and request_date>(SYSDATE-2)) and NVL(request_status,'O')='E')        \
   ";

 static const char *sq0145 = 
"select OPERATING_FACILITY_ID ,SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDM\
MYYHH24MISS') ,MACHINE_NAME ,WS_NO ,ROWID ,PRINT_SERVER_ID ,PRINTER_NAME ,DEST\
_QUEUE_NAME ,FAX_ID ,MAIL_ID  from SY_REPORT_GENERATE_REQUEST where (((OPERATI\
NG_FACILITY_ID=DECODE(:b0,'*A',OPERATING_FACILITY_ID,:b0) and pgm_id in ('RLRR\
SENQ')) and request_date<(SYSDATE-2)) and NVL(request_status,'O')='E')        \
   ";

 static const char *sq0148 = 
"select TO_CHAR(request_date,'DDMMYYHH24MISS') ,ROWID  from SY_REPORT_GENERAT\
E_REQUEST where (((pgm_id in ('Rlrsenq4') and session_id=TO_NUMBER(:b0)) and u\
ser_id=:b1) and NVL(request_status,'O')='E')           ";

 static const char *sq0044 = 
"select REMARK_CODE ,REMARK_TEXT ,RELEASED_BY ,TO_CHAR(RELEASED_DATE,'DD/MM/Y\
Y HH24:MI') ,NUMERIC_PREFIX ,NUMERIC_RESULT ,NVL(MODIFY_COMPONENTS_IND,'!!!!')\
 ,INSTR(NVL(MODIFY_COMPONENTS_IND,'!!!!'),'NM')  from RL_RESULT_MODIFY_REASON \
where ((((SPECIMEN_NO=:b0 and OPERATING_FACILITY_ID=:b1) and PATIENT_ID=:b2) a\
nd GROUP_TEST_CODE=:b3) and TEST_CODE=:b4) order by MODIFY_LOG_SEQ_NO desc    \
         ";

 static const char *sq0170 = 
"select TO_CHAR(A.specimen_no) ,A.test_code ,A.numeric_result ,NVL(A.numeric_\
prefix,'+') ,A.status ,A.test_units ,A.age_range_low ,A.age_range_high ,A.high\
_low_ind ,TO_CHAR(B.spec_regd_date_time,'DD/MM/YYYY HH24:MI') ,B.operating_fac\
ility_id ,NVL(A.numeric_result_hide_yn,'N') numeric_result_hide_yn  from RL_TE\
ST_RESULT A ,RL_REQUEST_HEADER B where ((((((((B.patient_id=:b0 and B.patient_\
id=A.patient_id) and B.specimen_no=A.specimen_no) and B.operating_facility_id=\
A.operating_facility_id) and A.test_code=:b1) and A.specimen_no<>TO_NUMBER(:b2\
)) and B.spec_regd_date_time between TO_DATE(:b3,'DD/MM/YYYY HH24:MI') and TO_\
DATE(:b4,'DD/MM/YYYY HH24:MI')) and NVL(A.cancelled_yn,'N')<>'Y') and NVL(A.st\
atus,'O') in ('R','P')) order by B.spec_regd_date_time desc             ";

typedef struct { unsigned short len; unsigned char arr[1]; } VARCHAR;
typedef struct { unsigned short len; unsigned char arr[1]; } varchar;

/* cud (compilation unit data) array */
static const short sqlcud0[] =
{10,4274,0,0,0,
5,0,0,1,0,0,542,898,0,0,0,0,0,1,0,
20,0,0,2,141,0,516,1014,0,0,4,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
51,0,0,3,1318,0,516,1027,0,0,25,1,0,1,0,2,3,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,
9,0,0,
166,0,0,4,820,0,516,1079,0,0,24,0,0,1,0,2,3,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
277,0,0,5,65,0,516,1303,0,0,1,0,0,1,0,2,9,0,0,
296,0,0,6,384,0,518,1441,0,0,5,5,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
331,0,0,7,152,0,518,1567,0,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
358,0,0,8,220,0,516,1641,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
393,0,0,9,0,0,541,1783,0,0,0,0,0,1,0,
408,0,0,10,0,0,541,1790,0,0,0,0,0,1,0,
423,0,0,11,384,0,518,1998,0,0,5,5,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,1,9,0,0,1,9,0,
0,
458,0,0,12,152,0,518,2097,0,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
485,0,0,13,220,0,516,2175,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
520,0,0,14,0,0,541,2323,0,0,0,0,0,1,0,
535,0,0,15,0,0,541,2329,0,0,0,0,0,1,0,
550,0,0,16,73,0,517,2359,0,0,1,1,0,1,0,1,9,0,0,
569,0,0,17,56,0,514,2369,0,0,1,1,0,1,0,1,9,0,0,
588,0,0,18,43,0,514,2378,0,0,1,1,0,1,0,1,9,0,0,
607,0,0,19,261,0,516,2403,0,0,6,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,
646,0,0,20,261,0,516,2459,0,0,6,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,
685,0,0,21,261,0,516,2515,0,0,6,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,
724,0,0,22,253,0,516,2571,0,0,7,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,3,0,0,2,3,0,
0,1,9,0,0,1,9,0,0,
767,0,0,23,105,0,516,2758,0,0,4,3,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
798,0,0,24,109,0,516,2793,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,3,0,0,1,9,0,
0,
833,0,0,25,105,0,516,3170,0,0,4,3,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
864,0,0,26,109,0,516,3205,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,3,0,0,1,9,0,
0,
899,0,0,27,489,0,515,3373,0,0,14,14,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
970,0,0,28,613,0,518,3443,0,0,16,16,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,
1049,0,0,29,673,0,518,3521,0,0,14,14,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1120,0,0,30,489,0,515,3641,0,0,14,14,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1191,0,0,31,613,0,518,3706,0,0,16,16,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,
1270,0,0,32,587,0,518,3779,0,0,14,14,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1341,0,0,33,465,0,516,3918,0,0,23,4,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1448,0,0,34,0,0,539,4027,0,0,4,4,0,1,0,1,9,0,0,1,10,0,0,1,10,0,0,1,10,0,0,
1479,0,0,35,131,0,516,4042,0,0,5,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,
0,
1514,0,0,36,105,0,516,4057,0,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1541,0,0,37,762,0,516,4118,0,0,23,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
1648,0,0,38,303,0,516,4205,0,0,7,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,1,9,0,0,
1691,0,0,39,140,0,516,4218,0,0,6,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,
1730,0,0,51,87,0,516,4662,0,0,1,0,0,1,0,2,9,0,0,
1749,0,0,40,0,0,527,4756,0,0,0,0,0,1,0,
1764,0,0,40,921,0,521,4765,0,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
1787,0,0,40,0,0,525,4853,0,0,33,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
1934,0,0,41,185,0,521,4939,0,0,3,3,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,
1961,0,0,41,0,0,525,4955,0,0,3,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,
1988,0,0,52,0,0,529,5022,0,0,1,1,0,1,0,1,9,0,0,
2007,0,0,52,0,0,557,5035,0,0,3,3,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,
2034,0,0,52,0,0,525,5106,0,0,24,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,3,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2145,0,0,52,0,0,525,5204,0,0,14,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2216,0,0,53,129,0,517,5251,0,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
2239,0,0,54,172,0,518,5557,0,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
2266,0,0,55,44,0,516,5702,0,0,3,2,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
2293,0,0,46,254,0,521,6278,0,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
2328,0,0,46,0,0,525,6302,0,0,4,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2359,0,0,47,259,0,521,6628,0,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
2394,0,0,48,277,0,521,6636,0,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
2429,0,0,48,0,0,525,6647,0,0,1,0,0,1,0,2,9,0,0,
2448,0,0,56,0,0,529,6677,0,0,1,1,0,1,0,1,9,0,0,
2467,0,0,56,0,0,557,6684,0,0,7,7,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,
2510,0,0,56,0,0,525,6700,0,0,1,0,0,1,0,2,9,0,0,
2529,0,0,56,0,0,527,6711,0,0,0,0,0,1,0,
2544,0,0,47,0,0,525,6727,0,0,2,0,0,1,0,2,9,0,0,2,9,0,0,
2567,0,0,57,118,0,516,6753,0,0,4,2,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
2598,0,0,58,119,0,516,6784,0,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
2625,0,0,49,337,0,521,6804,0,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
2660,0,0,50,323,0,521,6813,0,0,6,6,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
2699,0,0,49,0,0,525,6842,0,0,5,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2734,0,0,50,0,0,525,6877,0,0,4,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2765,0,0,62,143,0,516,6986,0,0,3,1,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,
2792,0,0,59,480,0,521,7052,0,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2823,0,0,60,384,0,521,7054,0,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2854,0,0,59,0,0,525,7061,0,0,11,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2913,0,0,60,0,0,525,7076,0,0,10,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2968,0,0,61,421,0,521,7104,0,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2999,0,0,61,0,0,525,7105,0,0,11,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
3058,0,0,61,421,0,521,7130,0,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
3089,0,0,61,0,0,525,7131,0,0,11,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
3148,0,0,63,116,0,516,7183,0,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3175,0,0,64,611,0,516,7251,0,0,20,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,3,0,0,2,3,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
3270,0,0,65,107,0,516,7353,0,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
3293,0,0,66,136,0,516,7374,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
3328,0,0,67,115,0,516,7389,0,0,4,2,0,1,0,2,9,0,0,2,3,0,0,1,9,0,0,1,9,0,0,
3359,0,0,68,124,0,516,7399,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
3394,0,0,69,133,0,516,7420,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
3429,0,0,70,104,0,516,7429,0,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3456,0,0,71,133,0,516,7437,0,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
3491,0,0,72,178,0,516,7470,0,0,5,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,
0,
3526,0,0,73,235,0,516,7507,0,0,5,3,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
3561,0,0,42,94,0,521,7534,0,0,1,1,0,1,0,1,9,0,0,
3580,0,0,42,0,0,525,7549,0,0,1,0,0,1,0,2,9,0,0,
3599,0,0,74,166,0,516,7681,0,0,5,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,
0,
3634,0,0,43,224,0,521,9,1,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
3669,0,0,43,0,0,525,24,1,0,1,0,0,1,0,2,9,0,0,
3688,0,0,45,153,0,521,109,1,0,1,1,0,1,0,1,9,0,0,
3707,0,0,45,0,0,525,132,1,0,6,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,
3746,0,0,75,0,0,529,158,1,0,1,1,0,1,0,1,9,0,0,
3765,0,0,75,0,0,557,164,1,0,0,0,0,1,0,
3780,0,0,75,0,0,525,171,1,0,1,0,0,1,0,2,9,0,0,
3799,0,0,76,146,0,516,196,1,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
3834,0,0,77,42,0,516,355,1,0,2,1,0,1,0,1,9,0,0,2,3,0,0,
3857,0,0,78,49,0,516,358,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
3884,0,0,79,59,0,516,362,1,0,4,3,0,1,0,1,9,0,0,1,3,0,0,1,9,0,0,2,9,0,0,
3915,0,0,80,45,0,516,386,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
3942,0,0,81,60,0,516,391,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
3969,0,0,82,55,0,516,395,1,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3992,0,0,83,53,0,516,399,1,0,3,2,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
4019,0,0,84,52,0,516,423,1,0,4,3,0,1,0,1,9,0,0,1,9,0,0,1,3,0,0,2,9,0,0,
4050,0,0,85,148,0,516,448,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
4077,0,0,86,137,0,516,466,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
4104,0,0,87,146,0,517,485,1,0,3,3,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,
4131,0,0,88,156,0,521,521,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
4154,0,0,88,0,0,525,531,1,0,2,0,0,1,0,2,9,0,0,2,9,0,0,
4177,0,0,89,171,0,516,536,1,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4208,0,0,90,198,0,517,548,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4239,0,0,40,0,0,527,570,1,0,0,0,0,1,0,
4254,0,0,41,0,0,527,571,1,0,0,0,0,1,0,
4269,0,0,52,0,0,527,572,1,0,0,0,0,1,0,
4284,0,0,49,0,0,527,586,1,0,0,0,0,1,0,
4299,0,0,91,0,0,543,599,1,0,0,0,0,1,0,
4314,0,0,92,191,0,515,616,1,0,6,6,0,1,0,1,9,0,0,1,3,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
4353,0,0,93,0,0,541,624,1,0,0,0,0,1,0,
4368,0,0,94,0,0,543,630,1,0,0,0,0,1,0,
4383,0,0,95,191,0,515,647,1,0,6,6,0,1,0,1,9,0,0,1,3,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
4422,0,0,96,0,0,541,656,1,0,0,0,0,1,0,
4437,0,0,97,68,0,516,895,1,0,1,0,0,1,0,2,9,0,0,
4456,0,0,98,76,0,516,919,1,0,4,2,0,1,0,1,9,0,0,1,9,0,0,2,3,0,0,2,3,0,0,
4487,0,0,99,252,0,521,981,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4518,0,0,100,209,0,516,988,1,0,3,2,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,
4545,0,0,101,174,0,515,1016,1,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,3,
0,0,
4580,0,0,102,506,0,521,1051,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4611,0,0,103,181,0,516,1055,1,0,4,3,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4642,0,0,104,149,0,515,1067,1,0,3,3,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,
4669,0,0,105,257,0,521,1099,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
4692,0,0,105,0,0,525,1114,1,0,4,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,3,0,0,
4723,0,0,99,0,0,525,1136,1,0,1,0,0,1,0,2,9,0,0,
4742,0,0,102,0,0,525,1155,1,0,1,0,0,1,0,2,9,0,0,
4761,0,0,99,0,0,527,1171,1,0,0,0,0,1,0,
4776,0,0,105,0,0,527,1177,1,0,0,0,0,1,0,
4791,0,0,102,0,0,527,1182,1,0,0,0,0,1,0,
4806,0,0,106,175,0,516,1187,1,0,4,3,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4837,0,0,107,199,0,516,1201,1,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4868,0,0,108,167,0,517,1224,1,0,3,3,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,
4895,0,0,109,111,0,514,1237,1,0,1,1,0,1,0,1,9,0,0,
4914,0,0,110,111,0,514,1242,1,0,1,1,0,1,0,1,9,0,0,
4933,0,0,111,122,0,516,1255,1,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,3,0,0,1,9,0,0,
4964,0,0,112,267,0,521,1279,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4995,0,0,112,0,0,527,1283,1,0,0,0,0,1,0,
5010,0,0,112,0,0,525,1293,1,0,1,0,0,1,0,2,9,0,0,
5029,0,0,42,0,0,527,1311,1,0,0,0,0,1,0,
5044,0,0,43,0,0,527,1320,1,0,0,0,0,1,0,
5059,0,0,45,0,0,527,1329,1,0,0,0,0,1,0,
5074,0,0,46,0,0,527,1339,1,0,0,0,0,1,0,
5089,0,0,47,0,0,527,1349,1,0,0,0,0,1,0,
5104,0,0,48,0,0,527,1358,1,0,0,0,0,1,0,
5119,0,0,50,0,0,527,1367,1,0,0,0,0,1,0,
5134,0,0,75,0,0,527,1378,1,0,0,0,0,1,0,
5149,0,0,59,0,0,527,1388,1,0,0,0,0,1,0,
5164,0,0,60,0,0,527,1390,1,0,0,0,0,1,0,
5179,0,0,61,0,0,527,1401,1,0,0,0,0,1,0,
5194,0,0,88,0,0,527,1411,1,0,0,0,0,1,0,
5209,0,0,113,90,0,516,1440,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5236,0,0,114,362,0,521,1475,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
5259,0,0,114,0,0,527,1535,1,0,0,0,0,1,0,
5274,0,0,114,0,0,525,1551,1,0,3,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,
5301,0,0,115,81,0,516,1569,1,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5324,0,0,116,172,0,518,1849,1,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5351,0,0,117,172,0,518,2228,1,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5378,0,0,118,87,0,516,2631,1,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
5401,0,0,119,146,0,518,2638,1,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5428,0,0,120,142,0,521,2722,1,0,1,1,0,1,0,1,9,0,0,
5447,0,0,121,163,0,515,2734,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
5478,0,0,120,0,0,525,2755,1,0,1,0,0,1,0,2,9,0,0,
5497,0,0,120,0,0,527,2770,1,0,0,0,0,1,0,
5512,0,0,122,161,0,521,2783,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
5535,0,0,122,0,0,527,2789,1,0,0,0,0,1,0,
5550,0,0,122,0,0,525,2800,1,0,2,0,0,1,0,2,9,0,0,2,9,0,0,
5573,0,0,123,170,0,521,2828,1,0,1,1,0,1,0,1,9,0,0,
5592,0,0,124,44,0,516,2886,1,0,3,2,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
5619,0,0,123,0,0,525,2932,1,0,3,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,
5646,0,0,125,104,0,516,2953,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5673,0,0,123,0,0,527,2968,1,0,0,0,0,1,0,
5688,0,0,126,134,0,516,2981,1,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
5719,0,0,127,166,0,516,3023,1,0,5,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,
0,0,
5754,0,0,128,130,0,516,3080,1,0,8,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,2,9,0,0,2,3,0,0,2,3,0,0,
5801,0,0,129,57,0,516,3253,1,0,1,0,0,1,0,2,9,0,0,
5820,0,0,130,100,0,516,3256,1,0,3,2,0,1,0,1,9,0,0,1,9,0,0,2,4,0,0,
5847,0,0,131,99,0,516,3284,1,0,3,2,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
5874,0,0,132,94,0,516,3317,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5901,0,0,133,96,0,516,3346,1,0,4,2,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
5932,0,0,134,78,0,516,3354,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5959,0,0,135,387,0,521,3392,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
5982,0,0,135,0,0,525,3423,1,0,12,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
6045,0,0,136,387,0,521,3483,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
6068,0,0,136,0,0,525,3513,1,0,12,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
6131,0,0,137,387,0,521,3572,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
6154,0,0,137,0,0,525,3602,1,0,12,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
6217,0,0,135,0,0,527,3641,1,0,0,0,0,1,0,
6232,0,0,136,0,0,527,3647,1,0,0,0,0,1,0,
6247,0,0,137,0,0,527,3653,1,0,0,0,0,1,0,
6262,0,0,138,105,0,516,3664,1,0,1,0,0,1,0,2,9,0,0,
6281,0,0,139,489,0,521,3724,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
6312,0,0,139,0,0,525,3799,1,0,21,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
6411,0,0,139,0,0,527,3876,1,0,0,0,0,1,0,
6426,0,0,140,431,0,516,3909,1,0,15,4,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,
6501,0,0,141,182,0,516,4083,1,0,3,2,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,
6528,0,0,142,0,0,541,4111,1,0,0,0,0,1,0,
6543,0,0,143,391,0,521,4133,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
6566,0,0,143,0,0,525,4166,1,0,12,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
6629,0,0,143,0,0,527,4207,1,0,0,0,0,1,0,
6644,0,0,144,75,0,517,4213,1,0,1,1,0,1,0,1,9,0,0,
6663,0,0,145,391,0,521,4239,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
6686,0,0,145,0,0,525,4273,1,0,12,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
6749,0,0,145,0,0,527,4312,1,0,0,0,0,1,0,
6764,0,0,146,56,0,514,4318,1,0,1,1,0,1,0,1,9,0,0,
6783,0,0,147,145,0,514,4329,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
6814,0,0,148,209,0,521,4367,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
6837,0,0,148,0,0,525,4380,1,0,2,0,0,1,0,2,9,0,0,2,9,0,0,
6860,0,0,148,0,0,527,4400,1,0,0,0,0,1,0,
6875,0,0,149,119,0,514,4410,1,0,3,3,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,
6902,0,0,150,56,0,514,4425,1,0,1,1,0,1,0,1,9,0,0,
6921,0,0,151,70,0,516,4440,1,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6944,0,0,152,199,0,516,4488,1,0,6,5,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,
6983,0,0,153,495,0,516,4500,1,0,6,5,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,
7022,0,0,154,207,0,516,4524,1,0,6,5,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,
7061,0,0,155,75,0,516,4881,1,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7084,0,0,156,76,0,516,4890,1,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7107,0,0,157,76,0,516,4899,1,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7130,0,0,158,76,0,516,4908,1,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7153,0,0,44,397,0,521,4934,1,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
7188,0,0,44,0,0,525,4960,1,0,8,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,3,0,0,
7235,0,0,159,76,0,516,4991,1,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7258,0,0,44,0,0,527,5197,1,0,0,0,0,1,0,
7273,0,0,160,354,0,518,5306,1,0,3,3,0,1,0,2,9,0,0,1,9,0,0,2,9,0,0,
7300,0,0,161,96,0,516,5390,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
7327,0,0,162,121,0,516,5412,1,0,4,2,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
7358,0,0,163,121,0,516,5436,1,0,4,2,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
7389,0,0,164,174,0,516,5541,1,0,4,1,0,1,0,2,3,0,0,2,3,0,0,2,9,0,0,1,9,0,0,
7420,0,0,165,116,0,516,5551,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
7447,0,0,166,115,0,516,5558,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
7474,0,0,167,102,0,516,5565,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
7501,0,0,168,102,0,516,5571,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
7528,0,0,169,107,0,516,5577,1,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
7555,0,0,170,772,0,521,5641,1,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,
7590,0,0,170,0,0,525,5687,1,0,12,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
7653,0,0,171,105,0,516,5862,1,0,4,3,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
7684,0,0,172,109,0,516,5903,1,0,5,4,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,3,0,0,1,9,
0,0,
7719,0,0,173,109,0,518,5940,1,0,1,1,0,1,0,2,9,0,0,
7738,0,0,174,172,0,518,6616,1,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
7765,0,0,175,139,0,518,7107,1,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,2,9,0,0,
7796,0,0,176,172,0,518,7459,1,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
7823,0,0,177,172,0,518,8169,1,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
7850,0,0,178,87,0,516,426,2,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
7873,0,0,179,146,0,518,434,2,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
7900,0,0,180,87,0,516,761,2,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
7923,0,0,181,146,0,518,770,2,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
7950,0,0,182,87,0,516,1052,2,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
7973,0,0,183,146,0,518,1060,2,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
8000,0,0,184,93,0,516,1156,2,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
8023,0,0,185,150,0,516,1179,2,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
8046,0,0,186,203,0,516,1207,2,0,6,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,
0,0,1,9,0,0,
8085,0,0,187,142,0,516,1233,2,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
8112,0,0,188,178,0,516,1256,2,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
8139,0,0,189,88,0,516,1291,2,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
8166,0,0,190,106,0,516,1330,2,0,4,2,0,1,0,2,9,0,0,2,4,0,0,1,9,0,0,1,9,0,0,
5,1,0,191,40,0,516,1352,2,0,2,1,0,1,0,1,4,0,0,2,9,0,0,
28,1,0,192,59,0,516,1364,2,0,4,2,0,1,0,1,9,0,0,1,9,0,0,2,3,0,0,2,3,0,0,
59,1,0,193,40,0,516,1381,2,0,2,1,0,1,0,1,4,0,0,2,9,0,0,
82,1,0,194,40,0,516,1385,2,0,2,1,0,1,0,1,4,0,0,2,9,0,0,
105,1,0,195,191,0,518,1407,2,0,6,6,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,
144,1,0,196,270,0,518,1440,2,0,4,4,0,1,0,1,9,0,0,3,9,0,0,2,9,0,0,2,9,0,0,
175,1,0,197,47,0,516,1466,2,0,1,0,0,1,0,2,9,0,0,
194,1,0,198,49,0,516,1487,2,0,1,0,0,1,0,2,9,0,0,
213,1,0,199,150,0,516,1973,2,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
244,1,0,200,112,0,516,1997,2,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
275,1,0,201,110,0,516,2019,2,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
302,1,0,202,164,0,516,2040,2,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
329,1,0,203,171,0,516,2051,2,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
356,1,0,204,156,0,518,2075,2,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
383,1,0,205,172,0,518,2088,2,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
410,1,0,206,176,0,518,2098,2,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
437,1,0,207,160,0,518,2108,2,0,3,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
464,1,0,208,110,0,518,2144,2,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
487,1,0,209,136,0,518,2153,2,0,2,2,0,1,0,2,9,0,0,1,3,0,0,
510,1,0,210,293,0,516,2174,2,0,6,5,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
};


/************************************************************************/
/* OCS MEDICOM VER 1.6                                                  */
/************************************************************************/
/* PROGRAM NAME          : RLRRSENQ                                     */
/* DESCRIPTION		     : Test Results report 					        */
/* AUTHOR                : S. Sheelvant                                 */
/* DATE WRITTEN          : 11-SEP-1998                                  */
/* MODIFIED BY           : S.SHEELVANT 						            */
/* MODIFIED ON		     : 12-DEC-1998                                  */
/* Last Modified by      : HAMEED - For eHIS upgrade					*/
/* Last Modified by      : Srinivas - For enhancements           		*/
/************************************************************************/

#include <stdio.h>             
#include <string.h>   
#include <process.h>  
# include <malloc.h>     
#include <stdlib.h>

#include "rl.h"
#define NODATAFOUND				(sqlca.sqlcode == 1403)
#define OERROR 					(sqlca.sqlcode < 0)
#define LAST_ROW                (sqlca.sqlcode == 1403)
#define NOT_FOUND 				(sqlca.sqlerrd[2] == 0)
#define TABLE_ALREADY_EXISTS	(sqlca.sqlcode == -955)
#define RESOURCE_BUSY			(sqlca.sqlcode == -54)     

#define VIEW_LOG_FILE 1
#define ONLINE_PRINTING 1
#define RESTART_INTERVAL 2
#define RESTART_TIME 500
#define INIT_MESG ""

#define SPOOL_DIR			""	
#define ESC 0x1B
#define SEP 0xFA   

#define MAX_ORGANISMS	500

/* EXEC SQL BEGIN DECLARE SECTION; */ 


#define MAX_ANTIBIOTICS	1000


   /* VARCHAR nd_operating_facility_id         [5],
		   nd_facility_id					[5],
   		   nd_priority						[5],
           uid_pwd                          [132],
           d_curr_pgm_name                  [15],
           nd_file_name                     [151],
		   nd_file_name_fax                 [2520],
		   nd_get_fax_dir					[2],
		   today			                [20], 
           nd_file_no                       [15]; */ 
struct { unsigned short len; unsigned char arr[5]; } nd_operating_facility_id;

struct { unsigned short len; unsigned char arr[5]; } nd_facility_id;

struct { unsigned short len; unsigned char arr[5]; } nd_priority;

struct { unsigned short len; unsigned char arr[132]; } uid_pwd;

struct { unsigned short len; unsigned char arr[15]; } d_curr_pgm_name;

struct { unsigned short len; unsigned char arr[151]; } nd_file_name;

struct { unsigned short len; unsigned char arr[2520]; } nd_file_name_fax;

struct { unsigned short len; unsigned char arr[2]; } nd_get_fax_dir;

struct { unsigned short len; unsigned char arr[20]; } today;

struct { unsigned short len; unsigned char arr[15]; } nd_file_no;


   /* VARCHAR s_org							[MAX_ANTIBIOTICS][5],
           s_ant							[MAX_ANTIBIOTICS][5],
           s_ind							[MAX_ANTIBIOTICS][2],
		   s_mic							[MAX_ANTIBIOTICS][10],
		   s_zone							[MAX_ANTIBIOTICS][10]; */ 
struct { unsigned short len; unsigned char arr[6]; } s_org[1000];

struct { unsigned short len; unsigned char arr[6]; } s_ant[1000];

struct { unsigned short len; unsigned char arr[2]; } s_ind[1000];

struct { unsigned short len; unsigned char arr[10]; } s_mic[1000];

struct { unsigned short len; unsigned char arr[10]; } s_zone[1000];



   /* VARCHAR nd_hosp_no                       [21],	 /o Patient ID o/
           nd_spec_no                       [21],
           nd_cntrl_rowid                   [31],

		   nd_rowid							[31],

		   nd_result_printed_date			[21],
	       er_msg                           [1071],
		   er_msg_num						[1000],
   
             c_req_dtl_test_code              [11],/o Used in o/ 
             c_group_test_yn                  [2],/o Update_rl_request_detailo/
             c_count                          [3],/o-----o/
             c_count_profile                  [3],/o-----o/
             c_spec_no                        [21],

             p_print_name_yn                  [2],
             p_test_desc                      [41],
             p_function_yn                    [2], 

             rl_lab_title                     [101],
			 rl_lab_title_2					  [201],
			 rl_lab_title_3					  [201],
			 rl_lab_title_4					  [201],
			 rl_lab_title_5					  [201],
			 rl_lab_title_6					  [201],
			 rl_actual_dob_yn				  [2], 
			 rl_race_code					  [11],
			 rl_report_format				  [3],
			 rl_age_years					  [3], 
			 rl_national_id_num               [21],
			 rl_alternate_id_num              [21],
			 rl_location					  [21], 
			 d_race_desc					  [31], 
			 d_clinical_text_code			  [5],
			 d_clinical_text				  [4001],
			 d_clinical_spec_no				  [21], 
			 rl_test_requested_yn			  [2],
			 d_inhibit_yn					  [2],
			 inhibit_test_code				  [11], 
			 rl_message_line				  [500],
			 rl_name_on_report_yn			  [2],
			 rl_print_prv_result_yn           [2],
			 rl_print_build_clin_hist_yn      [2],
			 rl_print_pend_profile_yn         [2],
			 rl_legend_for_pending			  [40], 
			 rl_footer_line_1				  [500],
			 rl_footer_line_2				  [500],
			 rl_category_code				  [5],
			 rl_category_year				  [5],
			 rl_category_number				  [21], 
			 rl_ordered_facility_id			  [3],
			 rl_ordering_doctor_name		  [41],
			 rl_order_id					  [21],
			 rl_perform_site_code			  [5],
			 v_test_code					  [11],
			 rl_high_low_ind			      [10],
			 rl_cancelled_yn				  [2],
			 can_spec_no					  [21],
			 can_group_test					  [11],
			 can_test_name					  [41], 
			 can_test_code				      [11],
			 cancel_reason					  [41],
			 print_name_yn					  [2],
			 first_user						  [31],
			 rl_released_by_id				  [31],
			 p_user_id						  [31],
			 rl_released_date				  [17],
			 rl_released_date1				  [17], //added for globalisation
			 v_numeric_result				  [21],
			 sy_user						  [31],
			 sy_user_name					  [60],
             sy_func_role_id                  [21],

			rl_print_result_sect_yn			[2],
			rl_section_tel_num				[16],

           rl_hdr_source_code               [11],
           rl_hdr_consultant_code           [16],
           rl_hdr_spec_recd_date_time       [17],
           rl_hdr_spec_recd_date_time1       [17],//added for globalisation
           rl_hdr_spec_regd_date_time       [17],
           rl_hdr_spec_regd_date_time1       [17],//added for globalisation
  	     rl_hdr_spec_colltd_date_time     [17],
  	     rl_hdr_spec_colltd_date_time1     [17],//added for globalisation
           rl_hdr_current_date_time         [17],
           rl_hdr_current_date_time1         [17],//added for globalisation,
           rl_hdr_section_code              [2],
           rl_hdr_request_comment_code1     [5],
           rl_hdr_request_comment_code2     [5],
           rl_hdr_request_comment_code3     [5],
           rl_hdr_request_comment_desc1     [41],
           rl_hdr_request_comment_desc2     [41],  
           rl_hdr_request_comment_desc3     [41],
           rl_hdr_extra_copies_to           [16],
           rl_hdr_specimen_type_code        [5],
           rl_hdr_added_by_id               [31],
           rl_hdr_added_date                [16], 
           rl_hdr_added_date1                [16], //added for globalisation
           rl_hdr_modified_by_id            [31],
           rl_hdr_modified_date             [16],
           rl_hdr_modified_date1             [16],//added for globalisation
 	       rl_hdr_episode_type		    [2],
 	       rl_hdr_urgent_indicator	    [2],
		   rl_hdr_source_type		    [2],
		   rl_hdr_released_by_id		[31],
		   rl_hdr_released_date			[21],
		   rl_hdr_released_date1			[21], //added for globalisation
		   rl_num_result_hide_yn		[2],
		   rl_hdr_result_printed_date   [31],
		   rl_hdr_result_printed_date1   [31], //added for globalisation

		   rl_hdr_status                [2],

           rl_dtl_test_code_reqd	    [11],
           rl_dtl_test_code                 [100][11],
           rl_dtl_result_status             [100][2],
           rl_dtl_group_test_flag           [100][2],

           rl_tst_group_test_code           [11],
           rl_tst_test_code                 [11],
           rl_tst_numeric_prefix            [2],
           rl_tst_numeric_result            [16],
           rl_tst_result_comment_desc1      [41],
           rl_tst_result_comment_desc2      [41],
           rl_tst_result_comment_desc3      [41],
           rl_tst_result_comment_desc4      [41],
           rl_tst_rowid                     [31],
		   rl_tst_hide_rslt_comm_yn			[2],
		   rl_tst_status					[2], 
		   rl_tst_rslt_max_rev_date			[31],
		   rl_tst_rslt_max_rev_date1			[31], //added for globalisation
		   rl_tst_interval_test_yn			[2], 
		   rl_tst_preliminary_release_yn	[2],

           rl_loc_test_code                 [11],
           rl_loc_grp_test_code             [11],
           rl_loc_long_desc                 [41],

	       rl_pat_title                     [9],
           rl_pat_long_name                 [61],
           rl_pat_short_name                [300],
           rl_pat_sex                       [2],
           rl_pat_nationality               [6],
           rl_pat_dob_no_of_days            [10], //sunil
           rl_pat_date_of_birth             [16], //sunil
	       rl_pat_actual_id                 [31],
           rl_pat_blood_group               [3],
           rl_pat_g6pd                      [11],
           rl_pat_sicc                      [11],
           rl_pat_hbl4_1                    [11],
           rl_pat_hbl4_2                    [11],

           rl_spc_specimen_desc             [41],

           rl_source_short_name             [41],    	 /o long name o/
           rl_consultant_short_name         [41], 	 /o long name o/
           rl_section_short_name            [41],  
		   rl_section_ind					[5],
		   rl_use_sample_anatomy_ind		[3],

           rl_tst_cd_short_desc             [41],
           rl_tst_cd_numeric_result_yn      [2],
           rl_tst_cd_age_sex_range_yn       [2],
           rl_tst_cd_function_yn            [2],
           rl_tst_cd_print_report_yn        [2],
           rl_tst_cd_low_value_normal       [16],
           rl_tst_cd_high_value_normal      [16],
           rl_tst_cd_result_name_text       [11],
           rl_tst_cd_group_test_yn          [2],
           rl_tst_cd_text_block_yn          [2],
           rl_tst_cd_culture_test_yn        [2],
           rl_tst_cd_snomed_yn              [2],
           rl_tst_cd_test_units             [11],
		   rl_tst_cd_oth_units              [11],
		   rl_tst_cd_test_units_desc        [16],
		   rl_tst_cd_test_units_2           [11],
           rl_tst_cd_range_cmt              [41],
		   rl_tst_cd_range_cmt_2            [41],
		   rl_tst_cd_inh_rep_yn				[2],
		   rl_tst_cd_conf_yn				[2],
		   rl_tst_cd_profile_yn				[2],

		   rl_tst_ran_low_val_nor    [16],
           rl_tst_ran_high_val_nor   [16],
		
		   l_low_val				 [16],
		   l_high_val				 [16],
           rl_tst_rng_lvn            [16],
           rl_tst_rng_hvn            [16],

           rl_comm_tst_comm_txt      [41],

		   rl_res_modify_reason		 [41],
		   rl_res_modify_reason_code [5],
		   rl_modify_reason_rel_by   [31],
		   rl_modify_reason_rel_dt   [31],
		   rl_modify_numeric_prefix  [2],
		   rl_modify_numeric_result  [16],
		   rl_modify_components_ind  [21],

           rl_res_result_text				[2000],

           rl_func_operand_1                [11],
           rl_func_operand_1_type           [2],
           rl_func_operator_1               [2],
           rl_func_operand_2                [11],
           rl_func_operand_2_type           [2],
           rl_func_operator_2               [2],
  
           rl_func_value                    [16],

           rl_calc_str                      [400],
           rl_func_str                      [400],

           rl_res_organism_code             [5],
           rl_res_comment_desc              [41],

           rl_res_organism_code1             [5],
           rl_res_organism_code2             [5],

           rl_res_organism_code_desc        [41],
           rl_res_organism_code_s_desc      [16],

		   d_user_id_pwd					[91],

		   rl_res_dtl_organism_code			[5],
           rl_res_dtl_antibiotic_code       [5],
           rl_res_dtl_antibiotic_desc       [41],
           rl_res_dtl_sensitivity_ind       [2],
	   
	       //sy_acc_entity_name 		        [81],
			sy_acc_entity_name 		        [300],
		   sy_tel_num						[21],
		   sy_fax_num						[21],
		   sy_ord_acc_entity_name		    [61],
           rl_res_snomed_code               [21],
		   rl_res_snomed_code2				[21],
           
		   rl_res_snomed_mrkr_code1         [2],
		   rl_res_snomed_mrkr_code2         [2],		    

		   rl_prn_ctrl_hdr_pat_no	        [16],
		   rl_prn_ctrl_hdr_sp_no	        [21],
	       rl_prn_ctrl_hdr_source_code	    [11],  

	       rl_prn_ctrl_hdr_user		        [31],
	       rl_prn_ctrl_hdr_section_code	    [2],
           rl_prn_ctrl_hdr_rp_yn            [2],

	       rl_snomed_desc1                  [301],
           rl_snomed_desc2                  [41],
           rl_snomed_desc3                  [41],
           rl_snomed_desc4                  [41],
           rl_snomed_desc5                  [41],
           rl_snomed_print_yn               [2],
           rl_snomed2_desc1                  [301],
           rl_snomed2_desc2                  [41],
           rl_snomed2_desc3                  [41],
           rl_snomed2_desc4                  [41],
           rl_snomed2_desc5                  [41],
           rl_snomed2_print_yn               [2],
		   r_rslt							 [20], 
		
		   nd_snomed_mrkr_desc2				 [41],
		   nd_snomed_mrkr2_print_yn          [2],
		   nd_snomed_mrkr_desc1				 [41],
		   nd_snomed_mrkr1_print_yn          [2],
		   nd_res_modify_reason_print_yn     [2],
		   nd_order_date_time                [17],
		   nd_order_date_time1                [17], //added for globalisation
		   nd_position_desc                  [31], 
   		   nd_user_conf_access_yn			 [2], 	
		   nd_perform_site_desc				 [41],
		   nd_anatomy_site					 [5],
		   nd_anatomy_site_desc				 [41],

  	       d_loc_str 			    [20], 
  	       d_l_str 					[20], 
  	       d_dec_part			    [20],
  	       d_int_part			    [20],
  	       d_sig_part			    [20],

		   a_antibiotic_code		[5],
		   b_antibiotic_code		[5],
		   b_sensitivity_ind		[2],
		   b_mic_value              [10],
		   b_zone_value				[10],

		   d_sleep_secs		[10],
		   d_machine_name   [40],
		   d_started_by_id  [31],
		   d_eqvl_test_units [11],
		   d_mail_subject    [2001],
		   d_mail_salutation [4001],
		   d_mail_body       [4001], 
		   d_mail_footer     [2001],
		   
		   sy_user_id			[31],
           sy_session_id		[30],
           sy_req_date			[30],
           l_sy_req_date		[30], 
           l_sy_req_date1		[30], 
		   l_report_legend      [20],
		   l_report_legend1      [100],
		   l_report_legend2      [100],
		   sy_machine_name      [31],
           sy_ws_no             [31],
		   sy_rowid				[31],
           
		   p_uid_pwd            [151], 
		   p_print_name         [100], 
		   p_loc_type           [10],
		   p_fax_loc_type       [10],
           p_loc_code           [100],
		   p_fax_loc_code       [100],
		   p_mail_loc_type       [10],
		   p_mail_loc_code       [100],
		   p_rep_file           [151],
		   p_rep_file_fax       [151],
		   p_rep_file_fax_ext   [151],
		   p_print_mode         [10],
		   
		   p_param7				        [2],
		   prg_start_date		        [30],
		   d_next_start_date            [30],
		   d_cmd_line                   [200],

		   l_print_disch_pat_result     [2],
		   rl_printer_for_urgent_yn		[2],
		   rl_print_inpatient_yn		[2],
		   rl_print_outpatient_yn		[2],
		   rl_print_referral_yn			[2],
		   rl_print_external_yn			[2],
		   rl_sectn_report_entire_spec_yn	[2],
		   rl_print_prev_modified_result_yn [2],
		   rl_print_num_result_title_yn [2],
		   rl_title_for_test            [50],
		   rl_title_for_num_result      [50],
		   rl_title_for_test_units		[50],
		   rl_title_for_range_ind		[50],
		   rl_title_for_result_range	[50],
		   rl_legend_for_pre_result		[100],

		   l_rep_disch_pat_result		[2],
		   rl_rep_inpatient_yn			[2],
		   rl_rep_outpatient_yn			[2],
		   rl_rep_referral_yn			[2],
		   rl_rep_external_yn			[2],

		   l_fax_disch_pat_result		[2],
		   rl_fax_inpatient_yn			[2],
		   rl_fax_outpatient_yn			[2],
		   rl_fax_referral_yn			[2],
		   rl_fax_external_yn			[2],

		   l_mail_disch_pat_result		[2],
		   rl_mail_inpatient_yn			[2],
		   rl_mail_outpatient_yn		[2],
		   rl_mail_referral_yn			[2],
		   rl_mail_external_yn			[2],
		   rl_mic_to_print_yn			[2],

		   rl_print_test_name_in_contd_page	[2],
  		   rl_hmc_yn			        [2],

		   l_command_line				[225],

		   nd_status					[2],
		   d_specimen_no				[21],
		   d_group_test_code			[11],
		   d_test_code					[11],
		   d_no							[21],
		   p_param8						[2],
		   p_param9						[10],   /// added param9,10,11 on 09.12.2004
		   p_param10					[2],
		   p_param11					[2],

		   p_param12					[2],   /// added on 07.08.2005
		   p_param13					[2],   /// added on 16.01.2006
		   p_fax_id						[30],
		   p_mail_id					[30],
		   p_print_id					[30],  /// added on 07.08.2005

		   p_printer_name               [100], /// added on 21.08.2005
		   p_dest_queue_name            [100],
		   l_error_text1			    [500],

		   p_fax_to_rcpt_name			[500],
		   p_fax_to_comp_name           [500],
		   p_fax_to_phone_no            [100],
		   p_fax_address                [100],
		   p_mail_address               [100],

		   actual_specimen				[21],
		   interval_description			[41],
		   first_specimen_no			[21],
		   l_file_no                    [30],
		   l_loc_dir                    [200],
		   l_debug_yn                   [5],
		   l_text                       [500], 
		   l_file_exists                [1],
		   l_dir_exists                 [1],
		   sql_stmt						[2000]; */ 
struct { unsigned short len; unsigned char arr[21]; } nd_hosp_no;

struct { unsigned short len; unsigned char arr[21]; } nd_spec_no;

struct { unsigned short len; unsigned char arr[31]; } nd_cntrl_rowid;

struct { unsigned short len; unsigned char arr[31]; } nd_rowid;

struct { unsigned short len; unsigned char arr[21]; } nd_result_printed_date;

struct { unsigned short len; unsigned char arr[1071]; } er_msg;

struct { unsigned short len; unsigned char arr[1000]; } er_msg_num;

struct { unsigned short len; unsigned char arr[11]; } c_req_dtl_test_code;

struct { unsigned short len; unsigned char arr[2]; } c_group_test_yn;

struct { unsigned short len; unsigned char arr[3]; } c_count;

struct { unsigned short len; unsigned char arr[3]; } c_count_profile;

struct { unsigned short len; unsigned char arr[21]; } c_spec_no;

struct { unsigned short len; unsigned char arr[2]; } p_print_name_yn;

struct { unsigned short len; unsigned char arr[41]; } p_test_desc;

struct { unsigned short len; unsigned char arr[2]; } p_function_yn;

struct { unsigned short len; unsigned char arr[101]; } rl_lab_title;

struct { unsigned short len; unsigned char arr[201]; } rl_lab_title_2;

struct { unsigned short len; unsigned char arr[201]; } rl_lab_title_3;

struct { unsigned short len; unsigned char arr[201]; } rl_lab_title_4;

struct { unsigned short len; unsigned char arr[201]; } rl_lab_title_5;

struct { unsigned short len; unsigned char arr[201]; } rl_lab_title_6;

struct { unsigned short len; unsigned char arr[2]; } rl_actual_dob_yn;

struct { unsigned short len; unsigned char arr[11]; } rl_race_code;

struct { unsigned short len; unsigned char arr[3]; } rl_report_format;

struct { unsigned short len; unsigned char arr[3]; } rl_age_years;

struct { unsigned short len; unsigned char arr[21]; } rl_national_id_num;

struct { unsigned short len; unsigned char arr[21]; } rl_alternate_id_num;

struct { unsigned short len; unsigned char arr[21]; } rl_location;

struct { unsigned short len; unsigned char arr[31]; } d_race_desc;

struct { unsigned short len; unsigned char arr[5]; } d_clinical_text_code;

struct { unsigned short len; unsigned char arr[4001]; } d_clinical_text;

struct { unsigned short len; unsigned char arr[21]; } d_clinical_spec_no;

struct { unsigned short len; unsigned char arr[2]; } rl_test_requested_yn;

struct { unsigned short len; unsigned char arr[2]; } d_inhibit_yn;

struct { unsigned short len; unsigned char arr[11]; } inhibit_test_code;

struct { unsigned short len; unsigned char arr[500]; } rl_message_line;

struct { unsigned short len; unsigned char arr[2]; } rl_name_on_report_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_prv_result_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_build_clin_hist_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_pend_profile_yn;

struct { unsigned short len; unsigned char arr[40]; } rl_legend_for_pending;

struct { unsigned short len; unsigned char arr[500]; } rl_footer_line_1;

struct { unsigned short len; unsigned char arr[500]; } rl_footer_line_2;

struct { unsigned short len; unsigned char arr[5]; } rl_category_code;

struct { unsigned short len; unsigned char arr[5]; } rl_category_year;

struct { unsigned short len; unsigned char arr[21]; } rl_category_number;

struct { unsigned short len; unsigned char arr[3]; } rl_ordered_facility_id;

struct { unsigned short len; unsigned char arr[41]; } rl_ordering_doctor_name;

struct { unsigned short len; unsigned char arr[21]; } rl_order_id;

struct { unsigned short len; unsigned char arr[5]; } rl_perform_site_code;

struct { unsigned short len; unsigned char arr[11]; } v_test_code;

struct { unsigned short len; unsigned char arr[10]; } rl_high_low_ind;

struct { unsigned short len; unsigned char arr[2]; } rl_cancelled_yn;

struct { unsigned short len; unsigned char arr[21]; } can_spec_no;

struct { unsigned short len; unsigned char arr[11]; } can_group_test;

struct { unsigned short len; unsigned char arr[41]; } can_test_name;

struct { unsigned short len; unsigned char arr[11]; } can_test_code;

struct { unsigned short len; unsigned char arr[41]; } cancel_reason;

struct { unsigned short len; unsigned char arr[2]; } print_name_yn;

struct { unsigned short len; unsigned char arr[31]; } first_user;

struct { unsigned short len; unsigned char arr[31]; } rl_released_by_id;

struct { unsigned short len; unsigned char arr[31]; } p_user_id;

struct { unsigned short len; unsigned char arr[17]; } rl_released_date;

struct { unsigned short len; unsigned char arr[17]; } rl_released_date1;

struct { unsigned short len; unsigned char arr[21]; } v_numeric_result;

struct { unsigned short len; unsigned char arr[31]; } sy_user;

struct { unsigned short len; unsigned char arr[60]; } sy_user_name;

struct { unsigned short len; unsigned char arr[21]; } sy_func_role_id;

struct { unsigned short len; unsigned char arr[2]; } rl_print_result_sect_yn;

struct { unsigned short len; unsigned char arr[16]; } rl_section_tel_num;

struct { unsigned short len; unsigned char arr[11]; } rl_hdr_source_code;

struct { unsigned short len; unsigned char arr[16]; } rl_hdr_consultant_code;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_spec_recd_date_time;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_spec_recd_date_time1;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_spec_regd_date_time;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_spec_regd_date_time1;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_spec_colltd_date_time;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_spec_colltd_date_time1;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_current_date_time;

struct { unsigned short len; unsigned char arr[17]; } rl_hdr_current_date_time1;

struct { unsigned short len; unsigned char arr[2]; } rl_hdr_section_code;

struct { unsigned short len; unsigned char arr[5]; } rl_hdr_request_comment_code1;

struct { unsigned short len; unsigned char arr[5]; } rl_hdr_request_comment_code2;

struct { unsigned short len; unsigned char arr[5]; } rl_hdr_request_comment_code3;

struct { unsigned short len; unsigned char arr[41]; } rl_hdr_request_comment_desc1;

struct { unsigned short len; unsigned char arr[41]; } rl_hdr_request_comment_desc2;

struct { unsigned short len; unsigned char arr[41]; } rl_hdr_request_comment_desc3;

struct { unsigned short len; unsigned char arr[16]; } rl_hdr_extra_copies_to;

struct { unsigned short len; unsigned char arr[5]; } rl_hdr_specimen_type_code;

struct { unsigned short len; unsigned char arr[31]; } rl_hdr_added_by_id;

struct { unsigned short len; unsigned char arr[16]; } rl_hdr_added_date;

struct { unsigned short len; unsigned char arr[16]; } rl_hdr_added_date1;

struct { unsigned short len; unsigned char arr[31]; } rl_hdr_modified_by_id;

struct { unsigned short len; unsigned char arr[16]; } rl_hdr_modified_date;

struct { unsigned short len; unsigned char arr[16]; } rl_hdr_modified_date1;

struct { unsigned short len; unsigned char arr[2]; } rl_hdr_episode_type;

struct { unsigned short len; unsigned char arr[2]; } rl_hdr_urgent_indicator;

struct { unsigned short len; unsigned char arr[2]; } rl_hdr_source_type;

struct { unsigned short len; unsigned char arr[31]; } rl_hdr_released_by_id;

struct { unsigned short len; unsigned char arr[21]; } rl_hdr_released_date;

struct { unsigned short len; unsigned char arr[21]; } rl_hdr_released_date1;

struct { unsigned short len; unsigned char arr[2]; } rl_num_result_hide_yn;

struct { unsigned short len; unsigned char arr[31]; } rl_hdr_result_printed_date;

struct { unsigned short len; unsigned char arr[31]; } rl_hdr_result_printed_date1;

struct { unsigned short len; unsigned char arr[2]; } rl_hdr_status;

struct { unsigned short len; unsigned char arr[11]; } rl_dtl_test_code_reqd;

struct { unsigned short len; unsigned char arr[14]; } rl_dtl_test_code[100];

struct { unsigned short len; unsigned char arr[2]; } rl_dtl_result_status[100];

struct { unsigned short len; unsigned char arr[2]; } rl_dtl_group_test_flag[100];

struct { unsigned short len; unsigned char arr[11]; } rl_tst_group_test_code;

struct { unsigned short len; unsigned char arr[11]; } rl_tst_test_code;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_numeric_prefix;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_numeric_result;

struct { unsigned short len; unsigned char arr[41]; } rl_tst_result_comment_desc1;

struct { unsigned short len; unsigned char arr[41]; } rl_tst_result_comment_desc2;

struct { unsigned short len; unsigned char arr[41]; } rl_tst_result_comment_desc3;

struct { unsigned short len; unsigned char arr[41]; } rl_tst_result_comment_desc4;

struct { unsigned short len; unsigned char arr[31]; } rl_tst_rowid;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_hide_rslt_comm_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_status;

struct { unsigned short len; unsigned char arr[31]; } rl_tst_rslt_max_rev_date;

struct { unsigned short len; unsigned char arr[31]; } rl_tst_rslt_max_rev_date1;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_interval_test_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_preliminary_release_yn;

struct { unsigned short len; unsigned char arr[11]; } rl_loc_test_code;

struct { unsigned short len; unsigned char arr[11]; } rl_loc_grp_test_code;

struct { unsigned short len; unsigned char arr[41]; } rl_loc_long_desc;

struct { unsigned short len; unsigned char arr[9]; } rl_pat_title;

struct { unsigned short len; unsigned char arr[61]; } rl_pat_long_name;

struct { unsigned short len; unsigned char arr[300]; } rl_pat_short_name;

struct { unsigned short len; unsigned char arr[2]; } rl_pat_sex;

struct { unsigned short len; unsigned char arr[6]; } rl_pat_nationality;

struct { unsigned short len; unsigned char arr[10]; } rl_pat_dob_no_of_days;

struct { unsigned short len; unsigned char arr[16]; } rl_pat_date_of_birth;

struct { unsigned short len; unsigned char arr[31]; } rl_pat_actual_id;

struct { unsigned short len; unsigned char arr[3]; } rl_pat_blood_group;

struct { unsigned short len; unsigned char arr[11]; } rl_pat_g6pd;

struct { unsigned short len; unsigned char arr[11]; } rl_pat_sicc;

struct { unsigned short len; unsigned char arr[11]; } rl_pat_hbl4_1;

struct { unsigned short len; unsigned char arr[11]; } rl_pat_hbl4_2;

struct { unsigned short len; unsigned char arr[41]; } rl_spc_specimen_desc;

struct { unsigned short len; unsigned char arr[41]; } rl_source_short_name;

struct { unsigned short len; unsigned char arr[41]; } rl_consultant_short_name;

struct { unsigned short len; unsigned char arr[41]; } rl_section_short_name;

struct { unsigned short len; unsigned char arr[5]; } rl_section_ind;

struct { unsigned short len; unsigned char arr[3]; } rl_use_sample_anatomy_ind;

struct { unsigned short len; unsigned char arr[41]; } rl_tst_cd_short_desc;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_numeric_result_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_age_sex_range_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_function_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_print_report_yn;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_cd_low_value_normal;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_cd_high_value_normal;

struct { unsigned short len; unsigned char arr[11]; } rl_tst_cd_result_name_text;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_group_test_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_text_block_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_culture_test_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_snomed_yn;

struct { unsigned short len; unsigned char arr[11]; } rl_tst_cd_test_units;

struct { unsigned short len; unsigned char arr[11]; } rl_tst_cd_oth_units;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_cd_test_units_desc;

struct { unsigned short len; unsigned char arr[11]; } rl_tst_cd_test_units_2;

struct { unsigned short len; unsigned char arr[41]; } rl_tst_cd_range_cmt;

struct { unsigned short len; unsigned char arr[41]; } rl_tst_cd_range_cmt_2;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_inh_rep_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_conf_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_tst_cd_profile_yn;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_ran_low_val_nor;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_ran_high_val_nor;

struct { unsigned short len; unsigned char arr[16]; } l_low_val;

struct { unsigned short len; unsigned char arr[16]; } l_high_val;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_rng_lvn;

struct { unsigned short len; unsigned char arr[16]; } rl_tst_rng_hvn;

struct { unsigned short len; unsigned char arr[41]; } rl_comm_tst_comm_txt;

struct { unsigned short len; unsigned char arr[41]; } rl_res_modify_reason;

struct { unsigned short len; unsigned char arr[5]; } rl_res_modify_reason_code;

struct { unsigned short len; unsigned char arr[31]; } rl_modify_reason_rel_by;

struct { unsigned short len; unsigned char arr[31]; } rl_modify_reason_rel_dt;

struct { unsigned short len; unsigned char arr[2]; } rl_modify_numeric_prefix;

struct { unsigned short len; unsigned char arr[16]; } rl_modify_numeric_result;

struct { unsigned short len; unsigned char arr[21]; } rl_modify_components_ind;

struct { unsigned short len; unsigned char arr[2000]; } rl_res_result_text;

struct { unsigned short len; unsigned char arr[11]; } rl_func_operand_1;

struct { unsigned short len; unsigned char arr[2]; } rl_func_operand_1_type;

struct { unsigned short len; unsigned char arr[2]; } rl_func_operator_1;

struct { unsigned short len; unsigned char arr[11]; } rl_func_operand_2;

struct { unsigned short len; unsigned char arr[2]; } rl_func_operand_2_type;

struct { unsigned short len; unsigned char arr[2]; } rl_func_operator_2;

struct { unsigned short len; unsigned char arr[16]; } rl_func_value;

struct { unsigned short len; unsigned char arr[400]; } rl_calc_str;

struct { unsigned short len; unsigned char arr[400]; } rl_func_str;

struct { unsigned short len; unsigned char arr[5]; } rl_res_organism_code;

struct { unsigned short len; unsigned char arr[41]; } rl_res_comment_desc;

struct { unsigned short len; unsigned char arr[5]; } rl_res_organism_code1;

struct { unsigned short len; unsigned char arr[5]; } rl_res_organism_code2;

struct { unsigned short len; unsigned char arr[41]; } rl_res_organism_code_desc;

struct { unsigned short len; unsigned char arr[16]; } rl_res_organism_code_s_desc;

struct { unsigned short len; unsigned char arr[91]; } d_user_id_pwd;

struct { unsigned short len; unsigned char arr[5]; } rl_res_dtl_organism_code;

struct { unsigned short len; unsigned char arr[5]; } rl_res_dtl_antibiotic_code;

struct { unsigned short len; unsigned char arr[41]; } rl_res_dtl_antibiotic_desc;

struct { unsigned short len; unsigned char arr[2]; } rl_res_dtl_sensitivity_ind;

struct { unsigned short len; unsigned char arr[300]; } sy_acc_entity_name;

struct { unsigned short len; unsigned char arr[21]; } sy_tel_num;

struct { unsigned short len; unsigned char arr[21]; } sy_fax_num;

struct { unsigned short len; unsigned char arr[61]; } sy_ord_acc_entity_name;

struct { unsigned short len; unsigned char arr[21]; } rl_res_snomed_code;

struct { unsigned short len; unsigned char arr[21]; } rl_res_snomed_code2;

struct { unsigned short len; unsigned char arr[2]; } rl_res_snomed_mrkr_code1;

struct { unsigned short len; unsigned char arr[2]; } rl_res_snomed_mrkr_code2;

struct { unsigned short len; unsigned char arr[16]; } rl_prn_ctrl_hdr_pat_no;

struct { unsigned short len; unsigned char arr[21]; } rl_prn_ctrl_hdr_sp_no;

struct { unsigned short len; unsigned char arr[11]; } rl_prn_ctrl_hdr_source_code;

struct { unsigned short len; unsigned char arr[31]; } rl_prn_ctrl_hdr_user;

struct { unsigned short len; unsigned char arr[2]; } rl_prn_ctrl_hdr_section_code;

struct { unsigned short len; unsigned char arr[2]; } rl_prn_ctrl_hdr_rp_yn;

struct { unsigned short len; unsigned char arr[301]; } rl_snomed_desc1;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed_desc2;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed_desc3;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed_desc4;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed_desc5;

struct { unsigned short len; unsigned char arr[2]; } rl_snomed_print_yn;

struct { unsigned short len; unsigned char arr[301]; } rl_snomed2_desc1;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed2_desc2;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed2_desc3;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed2_desc4;

struct { unsigned short len; unsigned char arr[41]; } rl_snomed2_desc5;

struct { unsigned short len; unsigned char arr[2]; } rl_snomed2_print_yn;

struct { unsigned short len; unsigned char arr[20]; } r_rslt;

struct { unsigned short len; unsigned char arr[41]; } nd_snomed_mrkr_desc2;

struct { unsigned short len; unsigned char arr[2]; } nd_snomed_mrkr2_print_yn;

struct { unsigned short len; unsigned char arr[41]; } nd_snomed_mrkr_desc1;

struct { unsigned short len; unsigned char arr[2]; } nd_snomed_mrkr1_print_yn;

struct { unsigned short len; unsigned char arr[2]; } nd_res_modify_reason_print_yn;

struct { unsigned short len; unsigned char arr[17]; } nd_order_date_time;

struct { unsigned short len; unsigned char arr[17]; } nd_order_date_time1;

struct { unsigned short len; unsigned char arr[31]; } nd_position_desc;

struct { unsigned short len; unsigned char arr[2]; } nd_user_conf_access_yn;

struct { unsigned short len; unsigned char arr[41]; } nd_perform_site_desc;

struct { unsigned short len; unsigned char arr[5]; } nd_anatomy_site;

struct { unsigned short len; unsigned char arr[41]; } nd_anatomy_site_desc;

struct { unsigned short len; unsigned char arr[20]; } d_loc_str;

struct { unsigned short len; unsigned char arr[20]; } d_l_str;

struct { unsigned short len; unsigned char arr[20]; } d_dec_part;

struct { unsigned short len; unsigned char arr[20]; } d_int_part;

struct { unsigned short len; unsigned char arr[20]; } d_sig_part;

struct { unsigned short len; unsigned char arr[5]; } a_antibiotic_code;

struct { unsigned short len; unsigned char arr[5]; } b_antibiotic_code;

struct { unsigned short len; unsigned char arr[2]; } b_sensitivity_ind;

struct { unsigned short len; unsigned char arr[10]; } b_mic_value;

struct { unsigned short len; unsigned char arr[10]; } b_zone_value;

struct { unsigned short len; unsigned char arr[10]; } d_sleep_secs;

struct { unsigned short len; unsigned char arr[40]; } d_machine_name;

struct { unsigned short len; unsigned char arr[31]; } d_started_by_id;

struct { unsigned short len; unsigned char arr[11]; } d_eqvl_test_units;

struct { unsigned short len; unsigned char arr[2001]; } d_mail_subject;

struct { unsigned short len; unsigned char arr[4001]; } d_mail_salutation;

struct { unsigned short len; unsigned char arr[4001]; } d_mail_body;

struct { unsigned short len; unsigned char arr[2001]; } d_mail_footer;

struct { unsigned short len; unsigned char arr[31]; } sy_user_id;

struct { unsigned short len; unsigned char arr[30]; } sy_session_id;

struct { unsigned short len; unsigned char arr[30]; } sy_req_date;

struct { unsigned short len; unsigned char arr[30]; } l_sy_req_date;

struct { unsigned short len; unsigned char arr[30]; } l_sy_req_date1;

struct { unsigned short len; unsigned char arr[20]; } l_report_legend;

struct { unsigned short len; unsigned char arr[100]; } l_report_legend1;

struct { unsigned short len; unsigned char arr[100]; } l_report_legend2;

struct { unsigned short len; unsigned char arr[31]; } sy_machine_name;

struct { unsigned short len; unsigned char arr[31]; } sy_ws_no;

struct { unsigned short len; unsigned char arr[31]; } sy_rowid;

struct { unsigned short len; unsigned char arr[151]; } p_uid_pwd;

struct { unsigned short len; unsigned char arr[100]; } p_print_name;

struct { unsigned short len; unsigned char arr[10]; } p_loc_type;

struct { unsigned short len; unsigned char arr[10]; } p_fax_loc_type;

struct { unsigned short len; unsigned char arr[100]; } p_loc_code;

struct { unsigned short len; unsigned char arr[100]; } p_fax_loc_code;

struct { unsigned short len; unsigned char arr[10]; } p_mail_loc_type;

struct { unsigned short len; unsigned char arr[100]; } p_mail_loc_code;

struct { unsigned short len; unsigned char arr[151]; } p_rep_file;

struct { unsigned short len; unsigned char arr[151]; } p_rep_file_fax;

struct { unsigned short len; unsigned char arr[151]; } p_rep_file_fax_ext;

struct { unsigned short len; unsigned char arr[10]; } p_print_mode;

struct { unsigned short len; unsigned char arr[2]; } p_param7;

struct { unsigned short len; unsigned char arr[30]; } prg_start_date;

struct { unsigned short len; unsigned char arr[30]; } d_next_start_date;

struct { unsigned short len; unsigned char arr[200]; } d_cmd_line;

struct { unsigned short len; unsigned char arr[2]; } l_print_disch_pat_result;

struct { unsigned short len; unsigned char arr[2]; } rl_printer_for_urgent_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_inpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_outpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_referral_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_external_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_sectn_report_entire_spec_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_prev_modified_result_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_num_result_title_yn;

struct { unsigned short len; unsigned char arr[50]; } rl_title_for_test;

struct { unsigned short len; unsigned char arr[50]; } rl_title_for_num_result;

struct { unsigned short len; unsigned char arr[50]; } rl_title_for_test_units;

struct { unsigned short len; unsigned char arr[50]; } rl_title_for_range_ind;

struct { unsigned short len; unsigned char arr[50]; } rl_title_for_result_range;

struct { unsigned short len; unsigned char arr[100]; } rl_legend_for_pre_result;

struct { unsigned short len; unsigned char arr[2]; } l_rep_disch_pat_result;

struct { unsigned short len; unsigned char arr[2]; } rl_rep_inpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_rep_outpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_rep_referral_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_rep_external_yn;

struct { unsigned short len; unsigned char arr[2]; } l_fax_disch_pat_result;

struct { unsigned short len; unsigned char arr[2]; } rl_fax_inpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_fax_outpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_fax_referral_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_fax_external_yn;

struct { unsigned short len; unsigned char arr[2]; } l_mail_disch_pat_result;

struct { unsigned short len; unsigned char arr[2]; } rl_mail_inpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_mail_outpatient_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_mail_referral_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_mail_external_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_mic_to_print_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_test_name_in_contd_page;

struct { unsigned short len; unsigned char arr[2]; } rl_hmc_yn;

struct { unsigned short len; unsigned char arr[225]; } l_command_line;

struct { unsigned short len; unsigned char arr[2]; } nd_status;

struct { unsigned short len; unsigned char arr[21]; } d_specimen_no;

struct { unsigned short len; unsigned char arr[11]; } d_group_test_code;

struct { unsigned short len; unsigned char arr[11]; } d_test_code;

struct { unsigned short len; unsigned char arr[21]; } d_no;

struct { unsigned short len; unsigned char arr[2]; } p_param8;

struct { unsigned short len; unsigned char arr[10]; } p_param9;

struct { unsigned short len; unsigned char arr[2]; } p_param10;

struct { unsigned short len; unsigned char arr[2]; } p_param11;

struct { unsigned short len; unsigned char arr[2]; } p_param12;

struct { unsigned short len; unsigned char arr[2]; } p_param13;

struct { unsigned short len; unsigned char arr[30]; } p_fax_id;

struct { unsigned short len; unsigned char arr[30]; } p_mail_id;

struct { unsigned short len; unsigned char arr[30]; } p_print_id;

struct { unsigned short len; unsigned char arr[100]; } p_printer_name;

struct { unsigned short len; unsigned char arr[100]; } p_dest_queue_name;

struct { unsigned short len; unsigned char arr[500]; } l_error_text1;

struct { unsigned short len; unsigned char arr[500]; } p_fax_to_rcpt_name;

struct { unsigned short len; unsigned char arr[500]; } p_fax_to_comp_name;

struct { unsigned short len; unsigned char arr[100]; } p_fax_to_phone_no;

struct { unsigned short len; unsigned char arr[100]; } p_fax_address;

struct { unsigned short len; unsigned char arr[100]; } p_mail_address;

struct { unsigned short len; unsigned char arr[21]; } actual_specimen;

struct { unsigned short len; unsigned char arr[41]; } interval_description;

struct { unsigned short len; unsigned char arr[21]; } first_specimen_no;

struct { unsigned short len; unsigned char arr[30]; } l_file_no;

struct { unsigned short len; unsigned char arr[200]; } l_loc_dir;

struct { unsigned short len; unsigned char arr[5]; } l_debug_yn;

struct { unsigned short len; unsigned char arr[500]; } l_text;

struct { unsigned short len; unsigned char arr[1]; } l_file_exists;

struct { unsigned short len; unsigned char arr[1]; } l_dir_exists;

struct { unsigned short len; unsigned char arr[2000]; } sql_stmt;


  	/* varchar	 BVNewVersionYN[2]; */ 
struct { unsigned short len; unsigned char arr[2]; } BVNewVersionYN;
   	// TO check the MEDICOM version

	/* varchar  VCbdoperationalYN			[2],
			 VCbtoperationalYN			[2],
			 VCoperational_modules		[2000]; */ 
struct { unsigned short len; unsigned char arr[2]; } VCbdoperationalYN;

struct { unsigned short len; unsigned char arr[2]; } VCbtoperationalYN;

struct { unsigned short len; unsigned char arr[2000]; } VCoperational_modules;


       int l_count = 0; /* To get count */
	   int i_count = 0, u_count = 0, l_seq_no = 0;

       int no_of_dtl_recs = 0, 
		   d_time_interval =0,
		   d_starting_time =0,
           rl_tst_cd_no_of_decimals = 0,
	       sy_ref_no_of_copies = 0,
           rl_tst_cd_significant_digit = 0, 
   	       p_significant_digit,
   	       p_no_of_decimals,  
           er_msg_type = 0,
  	       d_dec_pos = 0,
           d_after_sig_digit = 0;

   int     page_length = 0;

   int l_low = 0, l_high = 0;

   long l_episode = 0;

   int l_restart_time = 0;

   int d_seq_no = 0, rl_seq_no = 0;
   int l_exist_decimals = 0;
   int l_inst_decimals = 0;

   int signif;
   long double d_numeric_eqvl_value;
   long double d_numeric_eqvl_value2;
   long double d_low_val_nor_eqvl_value;
   long double d_high_val_nor_eqvl_value;

   int d_numeric_length = 0;
   int d_decimal_pos = 0;

   int l_flag = 0;


		/*  For Patient Age SYSDATE, MTHS */
   /* VARCHAR  tday				[30],
			t_days				[30],
			mths				[30],
			mths1				[30],
			t_age				[30],
			rl_regd_date		[11]; */ 
struct { unsigned short len; unsigned char arr[30]; } tday;

struct { unsigned short len; unsigned char arr[30]; } t_days;

struct { unsigned short len; unsigned char arr[30]; } mths;

struct { unsigned short len; unsigned char arr[30]; } mths1;

struct { unsigned short len; unsigned char arr[30]; } t_age;

struct { unsigned short len; unsigned char arr[11]; } rl_regd_date;


/*********** NEWLY ADDED FOR KNDV LAB ENHANCEMENTS OF SNOMED CODE TO PRINT Y/N**********/
/* VARCHAR		 rl_print_snomed_code_yn		  [2],
			 rl_print_snomed2_code_yn		  [2],
			 d_found						  [2]; */ 
struct { unsigned short len; unsigned char arr[2]; } rl_print_snomed_code_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_print_snomed2_code_yn;

struct { unsigned short len; unsigned char arr[2]; } d_found;


	float mt;

/*********** NEWLY ADDED (23/12/2002) FOR KNDV LAB ENHANCEMENTS of PRINT PENDING BY SOURCE**********/
	/* VARCHAR	c_session_id					[50],
		    c_pgm_date						[21],
			nd_trx_ind						[2],
			c_pgm_type						[2],
			c_user_id						[50],
			c_next_start_date				[21]; */ 
struct { unsigned short len; unsigned char arr[50]; } c_session_id;

struct { unsigned short len; unsigned char arr[21]; } c_pgm_date;

struct { unsigned short len; unsigned char arr[2]; } nd_trx_ind;

struct { unsigned short len; unsigned char arr[2]; } c_pgm_type;

struct { unsigned short len; unsigned char arr[50]; } c_user_id;

struct { unsigned short len; unsigned char arr[21]; } c_next_start_date;


	int		v_count = 0;

/***** FOR QATAR **********/
   /* VARCHAR 		   nd_new_medicom_no			[21],
				   nd_nationality_desc          [21]; */ 
struct { unsigned short len; unsigned char arr[21]; } nd_new_medicom_no;

struct { unsigned short len; unsigned char arr[21]; } nd_nationality_desc;

	
/***** FOR MAFRAQ **********/
    /* VARCHAR		  rl_health_card_num            [15],
				  rl_health_num				    [15],
				  l_print_health_card_yn         [2],
				  rl_health_exp_date		    [20]; */ 
struct { unsigned short len; unsigned char arr[15]; } rl_health_card_num;

struct { unsigned short len; unsigned char arr[15]; } rl_health_num;

struct { unsigned short len; unsigned char arr[2]; } l_print_health_card_yn;

struct { unsigned short len; unsigned char arr[20]; } rl_health_exp_date;



	/* VARCHAR		rl_alt_id_for_pat_id		    [51],
	            test_desc_fill_for_report        [2],
				rl_hmc_no						[31]; */ 
struct { unsigned short len; unsigned char arr[51]; } rl_alt_id_for_pat_id;

struct { unsigned short len; unsigned char arr[2]; } test_desc_fill_for_report;

struct { unsigned short len; unsigned char arr[31]; } rl_hmc_no;


/***** added on 19/07/2004 **********/

	/* VARCHAR		draft_printing_yn				[2],
				rl_race_accepted_yn		        [2]; */ 
struct { unsigned short len; unsigned char arr[2]; } draft_printing_yn;

struct { unsigned short len; unsigned char arr[2]; } rl_race_accepted_yn;


	  int other_than_comments = 0;
	  int t_antib_head_first_time = 0;


/*** added on 29.07.2004 to print the Previous results ***/

	/* VARCHAR		d_prv_specimen_no				[21],
				d_tst_prv_test_code				[11],
				d_tst_prv_numeric_result    	[16],
				d_num_prv_prefix				[2],
				d_status_prv					[2],
				d_tst_prv_units					[11],
				d_tst_prv_age_range_low			[16],
				d_tst_prv_age_range_high		[16],
				d_tst_prv_high_low_ind			[10],
				d_prv_spec_regd_date_time		[31],
				d_prv_spec_facility_id			[3],
				nd_prv_result_dt				[31],
				d_past_result_unit      		[6],
				d_num_result_hide_yn			[2]; */ 
struct { unsigned short len; unsigned char arr[21]; } d_prv_specimen_no;

struct { unsigned short len; unsigned char arr[11]; } d_tst_prv_test_code;

struct { unsigned short len; unsigned char arr[16]; } d_tst_prv_numeric_result;

struct { unsigned short len; unsigned char arr[2]; } d_num_prv_prefix;

struct { unsigned short len; unsigned char arr[2]; } d_status_prv;

struct { unsigned short len; unsigned char arr[11]; } d_tst_prv_units;

struct { unsigned short len; unsigned char arr[16]; } d_tst_prv_age_range_low;

struct { unsigned short len; unsigned char arr[16]; } d_tst_prv_age_range_high;

struct { unsigned short len; unsigned char arr[10]; } d_tst_prv_high_low_ind;

struct { unsigned short len; unsigned char arr[31]; } d_prv_spec_regd_date_time;

struct { unsigned short len; unsigned char arr[3]; } d_prv_spec_facility_id;

struct { unsigned short len; unsigned char arr[31]; } nd_prv_result_dt;

struct { unsigned short len; unsigned char arr[6]; } d_past_result_unit;

struct { unsigned short len; unsigned char arr[2]; } d_num_result_hide_yn;


		int		d_past_result_period = 0;
		int		d_past_result_no     = 0;
	    int     p_count			     = 0;
		int     past_results_head_printed = 0;
		int     rl_num_component_modified = 0; /// 07.03.2006

    /* VARCHAR     d_mother_specimen_yn    [2]; */ 
struct { unsigned short len; unsigned char arr[2]; } d_mother_specimen_yn;
   /////// 19.10.2005
	/* VARCHAR     d_episode_type			[2]; */ 
struct { unsigned short len; unsigned char arr[2]; } d_episode_type;
   /////// 19.10.2005
	/* VARCHAR     d_screen_patient_id     [30],
				d_screen_donor_id		[30]; */ 
struct { unsigned short len; unsigned char arr[30]; } d_screen_patient_id;

struct { unsigned short len; unsigned char arr[30]; } d_screen_donor_id;


	/***************added for globalisation*************************/
	/* VARCHAR		l_translated_value		 [600],
				language_id			[5]; */ 
struct { unsigned short len; unsigned char arr[600]; } l_translated_value;

struct { unsigned short len; unsigned char arr[5]; } language_id;

	int			i;
	int		mic_count=0;
	/***************added for globalisation*************************/
	/* VARCHAR		l_html_dir					[200]; */ 
struct { unsigned short len; unsigned char arr[200]; } l_html_dir;



/* EXEC SQL END DECLARE SECTION; */ 


/* EXEC SQL INCLUDE SQLCA.H;
 */ 
/*
 * $Header: sqlca.h,v 1.3 1994/12/12 19:27:27 jbasu Exp $ sqlca.h 
 */

/* Copyright (c) 1985,1986, 1998 by Oracle Corporation. */
 
/*
NAME
  SQLCA : SQL Communications Area.
FUNCTION
  Contains no code. Oracle fills in the SQLCA with status info
  during the execution of a SQL stmt.
NOTES
  **************************************************************
  ***                                                        ***
  *** This file is SOSD.  Porters must change the data types ***
  *** appropriately on their platform.  See notes/pcport.doc ***
  *** for more information.                                  ***
  ***                                                        ***
  **************************************************************

  If the symbol SQLCA_STORAGE_CLASS is defined, then the SQLCA
  will be defined to have this storage class. For example:
 
    #define SQLCA_STORAGE_CLASS extern
 
  will define the SQLCA as an extern.
 
  If the symbol SQLCA_INIT is defined, then the SQLCA will be
  statically initialized. Although this is not necessary in order
  to use the SQLCA, it is a good pgming practice not to have
  unitialized variables. However, some C compilers/OS's don't
  allow automatic variables to be init'd in this manner. Therefore,
  if you are INCLUDE'ing the SQLCA in a place where it would be
  an automatic AND your C compiler/OS doesn't allow this style
  of initialization, then SQLCA_INIT should be left undefined --
  all others can define SQLCA_INIT if they wish.

  If the symbol SQLCA_NONE is defined, then the SQLCA variable will
  not be defined at all.  The symbol SQLCA_NONE should not be defined
  in source modules that have embedded SQL.  However, source modules
  that have no embedded SQL, but need to manipulate a sqlca struct
  passed in as a parameter, can set the SQLCA_NONE symbol to avoid
  creation of an extraneous sqlca variable.
 
MODIFIED
    lvbcheng   07/31/98 -  long to int
    jbasu      12/12/94 -  Bug 217878: note this is an SOSD file
    losborne   08/11/92 -  No sqlca var if SQLCA_NONE macro set 
  Clare      12/06/84 - Ch SQLCA to not be an extern.
  Clare      10/21/85 - Add initialization.
  Bradbury   01/05/86 - Only initialize when SQLCA_INIT set
  Clare      06/12/86 - Add SQLCA_STORAGE_CLASS option.
*/
 
#ifndef SQLCA
#define SQLCA 1
 
struct   sqlca
         {
         /* ub1 */ char    sqlcaid[8];
         /* b4  */ int     sqlabc;
         /* b4  */ int     sqlcode;
         struct
           {
           /* ub2 */ unsigned short sqlerrml;
           /* ub1 */ char           sqlerrmc[70];
           } sqlerrm;
         /* ub1 */ char    sqlerrp[8];
         /* b4  */ int     sqlerrd[6];
         /* ub1 */ char    sqlwarn[8];
         /* ub1 */ char    sqlext[8];
         };

#ifndef SQLCA_NONE 
#ifdef   SQLCA_STORAGE_CLASS
SQLCA_STORAGE_CLASS struct sqlca sqlca
#else
         struct sqlca sqlca
#endif
 
#ifdef  SQLCA_INIT
         = {
         {'S', 'Q', 'L', 'C', 'A', ' ', ' ', ' '},
         sizeof(struct sqlca),
         0,
         { 0, {0}},
         {'N', 'O', 'T', ' ', 'S', 'E', 'T', ' '},
         {0, 0, 0, 0, 0, 0},
         {0, 0, 0, 0, 0, 0, 0, 0},
         {0, 0, 0, 0, 0, 0, 0, 0}
         }
#endif
         ;
#endif
 
#endif
 
/* end SQLCA */
/* EXEC SQL INCLUDE SQLDA.H; 
 */ 
/*
 * $Header: sqlda.h 31-jul-99.19:34:41 apopat Exp $ sqlda.h 
 */

/***************************************************************
*      The SQLDA descriptor definition                         *
*--------------------------------------------------------------*
*      VAX/3B Version                                          *
*                                                              *
*  Copyright (c) 1987, 1997, 1998, 1999 by Oracle Corporation                    *
***************************************************************/


/* NOTES
  **************************************************************
  ***                                                        ***
  *** This file is SOSD.  Porters must change the data types ***
  *** appropriately on their platform.  See notes/pcport.doc ***
  *** for more information.                                  ***
  ***                                                        ***
  **************************************************************
*/

/*  MODIFIED
    apopat     07/31/99 -  [707588] TAB to blanks for OCCS
    lvbcheng   10/27/98 -  change long to int for sqlda
    lvbcheng   08/15/97 -  Move sqlda protos to sqlcpr.h
    lvbcheng   06/25/97 -  Move sqlda protos to this file
    jbasu      01/29/95 -  correct typo
    jbasu      01/27/95 -  correct comment - ub2->sb2
    jbasu      12/12/94 - Bug 217878: note this is an SOSD file
    Morse      12/01/87 - undef L and S for v6 include files
    Richey     07/13/87 - change int defs to long 
    Clare      09/13/84 - Port: Ch types to match SQLLIB structs
    Clare      10/02/86 - Add ifndef SQLDA
*/

#ifndef SQLDA_
#define SQLDA_ 1
 
#ifdef T
# undef T
#endif
#ifdef F
# undef F
#endif

#ifdef S
# undef S
#endif
#ifdef L
# undef L
#endif
 
struct SQLDA {
  /* ub4    */ int        N; /* Descriptor size in number of entries        */
  /* text** */ char     **V; /* Ptr to Arr of addresses of main variables   */
  /* ub4*   */ int       *L; /* Ptr to Arr of lengths of buffers            */
  /* sb2*   */ short     *T; /* Ptr to Arr of types of buffers              */
  /* sb2**  */ short    **I; /* Ptr to Arr of addresses of indicator vars   */
  /* sb4    */ int        F; /* Number of variables found by DESCRIBE       */
  /* text** */ char     **S; /* Ptr to Arr of variable name pointers        */
  /* ub2*   */ short     *M; /* Ptr to Arr of max lengths of var. names     */
  /* ub2*   */ short     *C; /* Ptr to Arr of current lengths of var. names */
  /* text** */ char     **X; /* Ptr to Arr of ind. var. name pointers       */
  /* ub2*   */ short     *Y; /* Ptr to Arr of max lengths of ind. var. names */
  /* ub2*   */ short     *Z; /* Ptr to Arr of cur lengths of ind. var. names */
  };
 
typedef struct SQLDA SQLDA;
 
#endif

/* ----------------- */
/* defines for sqlda */
/* ----------------- */

#define SQLSQLDAAlloc(arg1, arg2, arg3, arg4) sqlaldt(arg1, arg2, arg3, arg4) 

#define SQLSQLDAFree(arg1, arg2) sqlclut(arg1, arg2) 





#include<winproc.h>  

FILE *fp,*fp1,*fp2,*fp3,*fp4;
int  status_prn   = 0, pgm_flg  = 0,tst_cd_ind = 1,  err_flag = 0;
int copy = 0;
int numeric_value_flag = FALSE;
int  MAX_LINES = 27;
int	 fax_i = 0;
char	*wordir;

char l_html_hdr_str[8000],l_html_ftr_str[8000],l_html_bdy_str[4000],in_str[4000],out_str[4000];
char l_prtg = '%';
char l_text_uline = 'N',l_text_bold = 'N';

char local_legend[100][600];//added for globalisation
char l_kb_mic_legend[500];

char temp[160],temp1[5];
char nd_repo_file_name[151], extra_file_name[151],l_file_name[151], lab_file_name[151];

char prev_group_test [11],
     rl_curr_status  [4];

int i = 0, rec_ctr = 0, lctr = 0, pctr = 0, 
    spc_first = 0,    ind_test_prn   = 0,
    group_printed = 0, group = 0,print_c_hist = 0,
    test_printed = 0, test_result_found = 0,
    source_copies = 0, local_copies = 0, bold_print_check = 1, test_contd = 1;

DWORD sleep_sec = 0;

char text_line[1000],text_line1[1000], test_description[410], nd_e_name[551], nd_f_name[551];

char *to_day();

int no_of_sensitivities = 0;
int something_to_print = 0, something_to_print_for_test = 0;
int qq = 0, cntr = 0, z = 0, hell = 0, clt = 0, cmp = 0, t_rue = 0;

int last_page = 0;

int org_yn = 0; 
int a_flag = 0; 
int antb_yn = 0; 
int b_flag = 0;
int oflag = 1; 
int org1 = 1; 
char word1[2];
char err_num[10];
/****** ADDED FOR GTT SPECIMENS ************/
char l_should_print_yn = 'N';
char nd_test_code[11];
char d_interval_specimen_yn = 'N';

char l_numeric_result[30];

char footer_released_date[22];
char footer_released_date1[22];//added for globalisation

int request_count = 0;
int l_snomed_head_printed = 0;
char l_destn_rep_yn;
char l_destn_fax_yn;
char l_destn_mail_yn;
char string_var[2000];

//char l_command_line[225];


char* getvalue(char *bufline,char *value)
{

int i =0,cou=0,flag=0;
char retvalue[100];

 for(i=0; *(value+i)!='\0';i++)
 {

 if(*(bufline+i) != *(value+i))
 {
	    flag=1;
 }

 }


 if(flag==0)
 {

    for(;*(bufline+i)!='\0';i++)
		if(*(bufline+i) == '=') break;



	for(cou=0,i=i+1;*(bufline+i)!='\0';i++)
	{
		 retvalue[cou]=*(bufline+i);
		 cou++;
	}


 }	

  retvalue[cou]='\0';
 // printf(" 1 %s \n",retvalue);
  return retvalue;
}


void getValueInFile(char *find,char *res)
{
	char dat[100];
	
int ch1,cou=0;
FILE *f1;

   if ((f1 = fopen("Rlrsenq4.INI","r")) ==NULL)
    {
	  if (strcmp(find,"DEBUG")==0)
	   strcpy(res,"N");
    }
    else
   {	 
   f1=fopen("Rlrsenq4.INI","r");

   strcpy(res," ");

   while(!feof(f1))
   {

	ch1=fgetc(f1);    

	dat[cou++]=(char)ch1;

	if(ch1 == 10 ) 
	{
		dat[cou-1]='\0';					
		strcpy(res,getvalue(dat,find));
		cou=0;		
	}		

  }
 }
if(strlen(res)==0) 
{
dat[cou]='\0';
  strcpy(res,getvalue(dat,find));
}
fclose(f1);
}


void proc_main(argc,argv)
char *argv[];
int argc;
{
   int rec_found = 0;     
    
   if (argc < 6) 
   {
      disp_message(ERR_MESG,"Usage : Rlrsenq4 uid/password ");
      proc_exit();
   }
   
   strcpy(d_user_id_pwd.arr,argv[1]);
   d_user_id_pwd.len = strlen(d_user_id_pwd.arr);

   strcpy(c_session_id.arr, argv[2]);
   c_session_id.len = strlen(c_session_id.arr);

   strcpy(c_session_id.arr, argv[3]);
   c_session_id.len = strlen(c_session_id.arr);

   strcpy(nd_facility_id.arr, argv[4]);
   nd_facility_id.len = strlen(nd_facility_id.arr);

   strcpy(nd_priority.arr, argv[5]);
   nd_priority.len = strlen(nd_priority.arr);

   if (argc == 8)
   { 


/****************** commented and moved to above  23.06.2003	
		strcpy(c_session_id.arr, argv[3]);
		c_session_id.len = strlen(c_session_id.arr);
********************************/

		strcpy(c_user_id.arr, argv[6]);
		c_user_id.len = strlen(c_user_id.arr);

		strcpy(c_pgm_type.arr, argv[7]);
		c_pgm_type.len = strlen(c_pgm_type.arr);
	}

	strcpy(g_pgm_id,"RLRRSENQ");
	strcpy(d_curr_pgm_name.arr,g_pgm_id); 
	
   if(sql_connect(argv[1]) == -1)
   {
      disp_message(ERR_MESG,"Database Connection Problem Rlrsenq4.......");
	  //ins_message1(ORA_MESG,"Error in connecting to Oracle");
	  proc_exit();
   }

   set_meduser_role(); 

/********* This part added for globalisation ***************************/
    strcpy(language_id.arr,l_language_id.arr);
	language_id.len =l_language_id.len;
	language_id.arr[l_language_id.len]='\0';
/********* This part added for globalisation ***************************/

get_legend_value(77); //added for globalisation


   strcpy(draft_printing_yn.arr, "N");
   draft_printing_yn.len = strlen(draft_printing_yn.arr);

 
/*--------------from here---------*/
   l_loc_dir.arr[0]		    = '\0';
   l_loc_dir.len            = 0;
   l_debug_yn.arr[0]		    = '\0';
   l_debug_yn.len            = 0;

   fp2 = fopen("Rlrsenq4.INI", "r");
   if (fp2 ==NULL) 
   {
	   strcpy(l_loc_dir.arr," ");
	   strcpy(l_file_exists.arr,"N");
   }
   else
   {
	   strcpy(l_file_exists.arr,"Y");
	   getValueInFile("DIR",temp);
       strcpy(l_loc_dir.arr,temp);
       sprintf(l_file_name,"%sTRACE_Rlrsenq4.lis",l_loc_dir.arr);
    
     if ((fp3 = fopen(l_file_name,"w")) == NULL)
        strcpy(l_dir_exists.arr,"N");
     else
        strcpy(l_dir_exists.arr,"Y");
    }

  	strcpy(l_html_dir.arr,WORKING_DIR);
	strcat(l_html_dir.arr, "Rlrsenq4.html");
	fp4 = fopen(l_html_dir.arr,"w");

	sprintf(l_html_hdr_str,"<html><head><link rel='StyleSheet' href='font.css' type='text/css'></link></head><body>");
    write_html(fp4,l_html_hdr_str);
  
  if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
   {
   getValueInFile("DEBUG",temp1);
   strcpy(l_debug_yn.arr,temp1);

   l_loc_dir.arr[strlen(temp)] = '\0';
   l_debug_yn.arr[1] = '\0';

   if (strcmp(l_debug_yn.arr,"Y")==0)
    {
	  fp1=fopen(l_file_name,"w");
      fprintf(fp1,"STARTING........");
	  fprintf(fp1,"\n");
	  fclose(fp1);
    }
	}

/*----upto here----------------*/

   if (strcmp(c_pgm_type.arr, "R") == 0)    
   {
	  process_rec1();
	  delete_error_record();  

   }
   else if (strcmp(c_pgm_type.arr, "F") == 0)
   {

      patch_sy_table();  
   }
   else
   {
		if (strcmp(c_pgm_type.arr, "D") == 0)
		{
			strcpy(draft_printing_yn.arr, "Y");
			draft_printing_yn.len = strlen(draft_printing_yn.arr);
		}

	  process_rec();
   }


   /* EXEC SQL COMMIT WORK RELEASE; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 0;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )5;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




   if (OERROR)
     ins_message(ORA_MESG,"ROLLBACK WORK RELEASE failed");
   return;
}
/*----------------------------------------------------*/
/*************************** this is not required
get_restart_time()
{
    
	 l_restart_time = 0;

     EXEC SQL SELECT NVL(TO_NUMBER(TO_CHAR(restart_time, 'HH24MI')), 500)
     INTO :l_restart_time
	 FROM RL_PARAM;
  
     if (OERROR)
        ins_message(ORA_MESG,"Error Found in RL_PARAM 2");

	  if(NOT_FOUND) 
         ins_message(ORA_MESG,"Select failed on RL_PARAM 2 --> No Data Found");  


 }
 **************************/
/*------------------------------------------------------*/


 /*------------------------------------------------------*/
 
 get_len_from_param()
 {

     page_length = 0;

     l_print_disch_pat_result.arr[0]                = '\0';
	 rl_print_inpatient_yn.arr[0]					= '\0';
	 rl_print_outpatient_yn.arr[0]					= '\0';
	 rl_print_referral_yn.arr[0]					= '\0';
	 rl_print_external_yn.arr[0]					= '\0';

     l_rep_disch_pat_result.arr[0]					= '\0';
	 rl_rep_inpatient_yn.arr[0]						= '\0';
	 rl_rep_outpatient_yn.arr[0]					= '\0';
	 rl_rep_referral_yn.arr[0]						= '\0';
	 rl_rep_external_yn.arr[0]						= '\0';

     l_fax_disch_pat_result.arr[0]					= '\0';
	 rl_fax_inpatient_yn.arr[0]						= '\0';
	 rl_fax_outpatient_yn.arr[0]					= '\0';
	 rl_fax_referral_yn.arr[0]						= '\0';
	 rl_fax_external_yn.arr[0]						= '\0';

     l_mail_disch_pat_result.arr[0]					= '\0';
	 rl_mail_inpatient_yn.arr[0]					= '\0';
	 rl_mail_outpatient_yn.arr[0]					= '\0';
	 rl_mail_referral_yn.arr[0]						= '\0';
	 rl_mail_external_yn.arr[0]						= '\0';

	 rl_print_test_name_in_contd_page.arr[0]		= '\0';

	 rl_report_format.arr[0]						= '\0';
	 rl_alt_id_for_pat_id.arr[0]					= '\0';

     l_print_disch_pat_result.len                   = 0;
	 rl_print_inpatient_yn.len						= 0;
	 rl_print_outpatient_yn.len						= 0;
	 rl_print_referral_yn.len						= 0;
	 rl_print_external_yn.len						= 0;

     l_rep_disch_pat_result.len						= 0;
	 rl_rep_inpatient_yn.len						= 0;
	 rl_rep_outpatient_yn.len						= 0;
	 rl_rep_referral_yn.len							= 0;
	 rl_rep_external_yn.len							= 0;

     l_fax_disch_pat_result.len						= 0;
	 rl_fax_inpatient_yn.len						= 0;
	 rl_fax_outpatient_yn.len						= 0;
	 rl_fax_referral_yn.len							= 0;
	 rl_fax_external_yn.len							= 0;

     l_mail_disch_pat_result.len					= 0;
	 rl_mail_inpatient_yn.len						= 0;
	 rl_mail_outpatient_yn.len						= 0;
	 rl_mail_referral_yn.len						= 0;
	 rl_mail_external_yn.len						= 0;

	 rl_print_test_name_in_contd_page.len			= 0;

	 rl_report_format.len							= 0;
	 rl_alt_id_for_pat_id.len						= 0;

     l_print_health_card_yn.arr[0]					= '\0';
     l_print_health_card_yn.len						= 0;

     test_desc_fill_for_report.arr[0]				= '\0';
	 test_desc_fill_for_report.len					= 0;
	 rl_hmc_yn.arr[0]								='\0';   /// 30.05.2005
	 rl_hmc_yn.len                                  = 0;


/********************* 22.06.2003 
     EXEC SQL SELECT result_rep_pg_len, NVL(print_disch_pat_result_yn, 'N'),
					NVL(print_inpatient_yn, 'N'), NVL(print_outpatient_yn, 'N'), 
					NVL(print_referral_yn, 'N'), NVL(print_external_yn, 'N'),
					NVL(report_format, '1'), NVL(print_health_card_yn, 'N')
			  INTO :page_length, :l_print_disch_pat_result,
				   :rl_print_inpatient_yn, :rl_print_outpatient_yn,
				   :rl_print_referral_yn, :rl_print_external_yn,
				   :rl_report_format, :l_print_health_card_yn 
			  FROM RL_PARAM;
********************/

     /* EXEC SQL SELECT NVL(report_format, '1'), NVL(print_health_card_yn, 'N'), 
					 test_desc_fill_for_report, NVL(hmc_yn,'N')
			  INTO  :rl_report_format, :l_print_health_card_yn , 
				    :test_desc_fill_for_report, :rl_hmc_yn
			  FROM   RL_PARAM; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 4;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select NVL(report_format,'1') ,NVL(print_health_card_yn,\
'N') ,test_desc_fill_for_report ,NVL(hmc_yn,'N') into :b0,:b1,:b2,:b3  from RL\
_PARAM ";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )20;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&rl_report_format;
     sqlstm.sqhstl[0] = (unsigned int  )5;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&l_print_health_card_yn;
     sqlstm.sqhstl[1] = (unsigned int  )4;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&test_desc_fill_for_report;
     sqlstm.sqhstl[2] = (unsigned int  )4;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqhstv[3] = (         void  *)&rl_hmc_yn;
     sqlstm.sqhstl[3] = (unsigned int  )4;
     sqlstm.sqhsts[3] = (         int  )0;
     sqlstm.sqindv[3] = (         void  *)0;
     sqlstm.sqinds[3] = (         int  )0;
     sqlstm.sqharm[3] = (unsigned int  )0;
     sqlstm.sqadto[3] = (unsigned short )0;
     sqlstm.sqtdso[3] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



     if (OERROR)
        ins_message(ORA_MESG,"Error Found in RL_PARAM");

	  if(NOT_FOUND) 
         ins_message(ORA_MESG,"Select failed on RL_PARAM --> No Data Found");

     {
		 /* EXEC SQL SELECT nvl(a.result_rep_pg_len,b.result_rep_pg_len),
	 					 nvl(a.print_disch_pat_result_yn,b.print_disch_pat_result_yn), 
						 nvl(a.print_inpatient_yn,b.print_inpatient_yn),
						 nvl(a.print_outpatient_yn,b.print_outpatient_yn),
						 nvl(a.print_referral_yn,b.print_referral_yn),
						 nvl(a.print_external_yn,b.print_external_yn),
						 NVL(B.mapped_alt_id_for_pat_id, '!'),

	 					 nvl(a.REP_PRINT_FOR_DISCH_YN,b.REP_PRINT_FOR_DISCH_YN), 
						 nvl(a.rep_inpatient_yn,b.rep_inpatient_yn),
						 nvl(a.rep_outpatient_yn,b.rep_outpatient_yn),
						 nvl(a.rep_referral_yn,b.rep_referral_yn),
						 nvl(a.rep_external_yn,b.rep_external_yn),

	 					 nvl(a.FAX_FOR_DISCH_YN,b.FAX_FOR_DISCH_YN), 
						 nvl(a.fax_inpatient_yn,b.fax_inpatient_yn),
						 nvl(a.fax_outpatient_yn,b.fax_outpatient_yn),
						 nvl(a.fax_referral_yn,b.fax_referral_yn),
						 nvl(a.fax_external_yn,b.fax_external_yn),

						 nvl(a.print_test_name_in_contd_page,b.print_test_name_in_contd_page),

	 					 nvl(a.email_FOR_DISCH_YN,b.email_FOR_DISCH_YN), 
						 nvl(a.email_inpatient_yn,b.email_inpatient_yn),
						 nvl(a.email_outpatient_yn,b.email_outpatient_yn),
						 nvl(a.email_referral_yn,b.email_referral_yn),
						 nvl(a.email_external_yn,b.email_external_yn),
						 nvl(a.rep_mic_yn,b.rep_mic_yn)
				  INTO  :page_length, :l_print_disch_pat_result,
					    :rl_print_inpatient_yn, :rl_print_outpatient_yn,
					    :rl_print_referral_yn, :rl_print_external_yn,
						:rl_alt_id_for_pat_id,

						:l_rep_disch_pat_result,
					    :rl_rep_inpatient_yn, :rl_rep_outpatient_yn, 
					    :rl_rep_referral_yn, :rl_rep_external_yn,

						:l_fax_disch_pat_result,
					    :rl_fax_inpatient_yn, :rl_fax_outpatient_yn, 
					    :rl_fax_referral_yn, :rl_fax_external_yn,

						:rl_print_test_name_in_contd_page,

						:l_mail_disch_pat_result,
					    :rl_mail_inpatient_yn, :rl_mail_outpatient_yn,
					    :rl_mail_referral_yn, :rl_mail_external_yn,
						:rl_mic_to_print_yn
				  FROM   RL_PARAM_FOR_FACILITY A , RL_PARAM B
				  WHERE  OPERATING_FACILITY_ID = :nd_operating_facility_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlbuft((void **)0, 
     "select nvl(a.result_rep_pg_len,b.result_rep_pg_len) ,nvl(a.print_disch\
_pat_result_yn,b.print_disch_pat_result_yn) ,nvl(a.print_inpatient_yn,b.prin\
t_inpatient_yn) ,nvl(a.print_outpatient_yn,b.print_outpatient_yn) ,nvl(a.pri\
nt_referral_yn,b.print_referral_yn) ,nvl(a.print_external_yn,b.print_externa\
l_yn) ,NVL(B.mapped_alt_id_for_pat_id,'!') ,nvl(a.REP_PRINT_FOR_DISCH_YN,b.R\
EP_PRINT_FOR_DISCH_YN) ,nvl(a.rep_inpatient_yn,b.rep_inpatient_yn) ,nvl(a.re\
p_outpatient_yn,b.rep_outpatient_yn) ,nvl(a.rep_referral_yn,b.rep_referral_y\
n) ,nvl(a.rep_external_yn,b.rep_external_yn) ,nvl(a.FAX_FOR_DISCH_YN,b.FAX_F\
OR_DISCH_YN) ,nvl(a.fax_inpatient_yn,b.fax_inpatient_yn) ,nvl(a.fax_outpatie\
nt_yn,b.fax_outpatient_yn) ,nvl(a.fax_referral_yn,b.fax_referral_yn) ,nvl(a.\
fax_external_yn,b.fax_external_yn) ,nvl(a.print_test_name_in_contd_page,b.pr\
int_test_name_in_contd_page) ,nvl(a.email_FOR_DISCH_YN,b.email_FOR_DISCH_YN)\
 ,nvl(a.email_inpatient_yn,b.email_inpatient_yn) ,nvl(a.email_outpatient_yn,\
b.email_outpatient_yn) ,nvl(a.email_referr");
   sqlstm.stmt = "al_yn,b.email_referral_yn) ,nvl(a.email_external_yn,b.emai\
l_external_yn) ,nvl(a.rep_mic_yn,b.rep_mic_yn) into :b0,:b1,:b2,:b3,:b4,:b5,:b\
6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16,:b17,:b18,:b19,:b20,:b21,:b22\
,:b23  from RL_PARAM_FOR_FACILITY A ,RL_PARAM B where OPERATING_FACILITY_ID=:b\
24";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )51;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&page_length;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_print_disch_pat_result;
   sqlstm.sqhstl[1] = (unsigned int  )4;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_print_inpatient_yn;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_print_outpatient_yn;
   sqlstm.sqhstl[3] = (unsigned int  )4;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&rl_print_referral_yn;
   sqlstm.sqhstl[4] = (unsigned int  )4;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_print_external_yn;
   sqlstm.sqhstl[5] = (unsigned int  )4;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&rl_alt_id_for_pat_id;
   sqlstm.sqhstl[6] = (unsigned int  )53;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&l_rep_disch_pat_result;
   sqlstm.sqhstl[7] = (unsigned int  )4;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&rl_rep_inpatient_yn;
   sqlstm.sqhstl[8] = (unsigned int  )4;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&rl_rep_outpatient_yn;
   sqlstm.sqhstl[9] = (unsigned int  )4;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&rl_rep_referral_yn;
   sqlstm.sqhstl[10] = (unsigned int  )4;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&rl_rep_external_yn;
   sqlstm.sqhstl[11] = (unsigned int  )4;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqhstv[12] = (         void  *)&l_fax_disch_pat_result;
   sqlstm.sqhstl[12] = (unsigned int  )4;
   sqlstm.sqhsts[12] = (         int  )0;
   sqlstm.sqindv[12] = (         void  *)0;
   sqlstm.sqinds[12] = (         int  )0;
   sqlstm.sqharm[12] = (unsigned int  )0;
   sqlstm.sqadto[12] = (unsigned short )0;
   sqlstm.sqtdso[12] = (unsigned short )0;
   sqlstm.sqhstv[13] = (         void  *)&rl_fax_inpatient_yn;
   sqlstm.sqhstl[13] = (unsigned int  )4;
   sqlstm.sqhsts[13] = (         int  )0;
   sqlstm.sqindv[13] = (         void  *)0;
   sqlstm.sqinds[13] = (         int  )0;
   sqlstm.sqharm[13] = (unsigned int  )0;
   sqlstm.sqadto[13] = (unsigned short )0;
   sqlstm.sqtdso[13] = (unsigned short )0;
   sqlstm.sqhstv[14] = (         void  *)&rl_fax_outpatient_yn;
   sqlstm.sqhstl[14] = (unsigned int  )4;
   sqlstm.sqhsts[14] = (         int  )0;
   sqlstm.sqindv[14] = (         void  *)0;
   sqlstm.sqinds[14] = (         int  )0;
   sqlstm.sqharm[14] = (unsigned int  )0;
   sqlstm.sqadto[14] = (unsigned short )0;
   sqlstm.sqtdso[14] = (unsigned short )0;
   sqlstm.sqhstv[15] = (         void  *)&rl_fax_referral_yn;
   sqlstm.sqhstl[15] = (unsigned int  )4;
   sqlstm.sqhsts[15] = (         int  )0;
   sqlstm.sqindv[15] = (         void  *)0;
   sqlstm.sqinds[15] = (         int  )0;
   sqlstm.sqharm[15] = (unsigned int  )0;
   sqlstm.sqadto[15] = (unsigned short )0;
   sqlstm.sqtdso[15] = (unsigned short )0;
   sqlstm.sqhstv[16] = (         void  *)&rl_fax_external_yn;
   sqlstm.sqhstl[16] = (unsigned int  )4;
   sqlstm.sqhsts[16] = (         int  )0;
   sqlstm.sqindv[16] = (         void  *)0;
   sqlstm.sqinds[16] = (         int  )0;
   sqlstm.sqharm[16] = (unsigned int  )0;
   sqlstm.sqadto[16] = (unsigned short )0;
   sqlstm.sqtdso[16] = (unsigned short )0;
   sqlstm.sqhstv[17] = (         void  *)&rl_print_test_name_in_contd_page;
   sqlstm.sqhstl[17] = (unsigned int  )4;
   sqlstm.sqhsts[17] = (         int  )0;
   sqlstm.sqindv[17] = (         void  *)0;
   sqlstm.sqinds[17] = (         int  )0;
   sqlstm.sqharm[17] = (unsigned int  )0;
   sqlstm.sqadto[17] = (unsigned short )0;
   sqlstm.sqtdso[17] = (unsigned short )0;
   sqlstm.sqhstv[18] = (         void  *)&l_mail_disch_pat_result;
   sqlstm.sqhstl[18] = (unsigned int  )4;
   sqlstm.sqhsts[18] = (         int  )0;
   sqlstm.sqindv[18] = (         void  *)0;
   sqlstm.sqinds[18] = (         int  )0;
   sqlstm.sqharm[18] = (unsigned int  )0;
   sqlstm.sqadto[18] = (unsigned short )0;
   sqlstm.sqtdso[18] = (unsigned short )0;
   sqlstm.sqhstv[19] = (         void  *)&rl_mail_inpatient_yn;
   sqlstm.sqhstl[19] = (unsigned int  )4;
   sqlstm.sqhsts[19] = (         int  )0;
   sqlstm.sqindv[19] = (         void  *)0;
   sqlstm.sqinds[19] = (         int  )0;
   sqlstm.sqharm[19] = (unsigned int  )0;
   sqlstm.sqadto[19] = (unsigned short )0;
   sqlstm.sqtdso[19] = (unsigned short )0;
   sqlstm.sqhstv[20] = (         void  *)&rl_mail_outpatient_yn;
   sqlstm.sqhstl[20] = (unsigned int  )4;
   sqlstm.sqhsts[20] = (         int  )0;
   sqlstm.sqindv[20] = (         void  *)0;
   sqlstm.sqinds[20] = (         int  )0;
   sqlstm.sqharm[20] = (unsigned int  )0;
   sqlstm.sqadto[20] = (unsigned short )0;
   sqlstm.sqtdso[20] = (unsigned short )0;
   sqlstm.sqhstv[21] = (         void  *)&rl_mail_referral_yn;
   sqlstm.sqhstl[21] = (unsigned int  )4;
   sqlstm.sqhsts[21] = (         int  )0;
   sqlstm.sqindv[21] = (         void  *)0;
   sqlstm.sqinds[21] = (         int  )0;
   sqlstm.sqharm[21] = (unsigned int  )0;
   sqlstm.sqadto[21] = (unsigned short )0;
   sqlstm.sqtdso[21] = (unsigned short )0;
   sqlstm.sqhstv[22] = (         void  *)&rl_mail_external_yn;
   sqlstm.sqhstl[22] = (unsigned int  )4;
   sqlstm.sqhsts[22] = (         int  )0;
   sqlstm.sqindv[22] = (         void  *)0;
   sqlstm.sqinds[22] = (         int  )0;
   sqlstm.sqharm[22] = (unsigned int  )0;
   sqlstm.sqadto[22] = (unsigned short )0;
   sqlstm.sqtdso[22] = (unsigned short )0;
   sqlstm.sqhstv[23] = (         void  *)&rl_mic_to_print_yn;
   sqlstm.sqhstl[23] = (unsigned int  )4;
   sqlstm.sqhsts[23] = (         int  )0;
   sqlstm.sqindv[23] = (         void  *)0;
   sqlstm.sqinds[23] = (         int  )0;
   sqlstm.sqharm[23] = (unsigned int  )0;
   sqlstm.sqadto[23] = (unsigned short )0;
   sqlstm.sqtdso[23] = (unsigned short )0;
   sqlstm.sqhstv[24] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[24] = (unsigned int  )7;
   sqlstm.sqhsts[24] = (         int  )0;
   sqlstm.sqindv[24] = (         void  *)0;
   sqlstm.sqinds[24] = (         int  )0;
   sqlstm.sqharm[24] = (unsigned int  )0;
   sqlstm.sqadto[24] = (unsigned short )0;
   sqlstm.sqtdso[24] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 		 if(NODATAFOUND)
		 {
		 /* EXEC SQL SELECT result_rep_pg_len, NVL(print_disch_pat_result_yn, 'N'),
						NVL(print_inpatient_yn, 'N'), NVL(print_outpatient_yn, 'N'), 
						NVL(print_referral_yn, 'N'), NVL(print_external_yn, 'N'),
						NVL(mapped_alt_id_for_pat_id, '!'),

	 					 nvl(REP_PRINT_FOR_DISCH_YN,'N'), 
						 nvl(rep_inpatient_yn,'N'),
						 nvl(rep_outpatient_yn,'N'),
						 nvl(rep_referral_yn,'N'),
						 nvl(rep_external_yn,'N'),

	 					 nvl(FAX_FOR_DISCH_YN,'N'), 
						 nvl(fax_inpatient_yn,'N'),
						 nvl(fax_outpatient_yn,'N'),
						 nvl(fax_referral_yn,'N'),
						 nvl(fax_external_yn,'N'),

						 nvl(print_test_name_in_contd_page,'N'),

	 					 nvl(email_FOR_DISCH_YN,'N'), 
						 nvl(email_inpatient_yn,'N'),
						 nvl(email_outpatient_yn,'N'),
						 nvl(email_referral_yn,'N'),
						 nvl(email_external_yn,'N'),
						 nvl(rep_mic_yn,'N')
				  INTO :page_length, :l_print_disch_pat_result,
					   :rl_print_inpatient_yn, :rl_print_outpatient_yn,
					   :rl_print_referral_yn, :rl_print_external_yn,
					   :rl_alt_id_for_pat_id,

						:l_rep_disch_pat_result,
					    :rl_rep_inpatient_yn, :rl_rep_outpatient_yn,
					    :rl_rep_referral_yn, :rl_rep_external_yn,

						:l_fax_disch_pat_result,
					    :rl_fax_inpatient_yn, :rl_fax_outpatient_yn,
					    :rl_fax_referral_yn, :rl_fax_external_yn,

						:rl_print_test_name_in_contd_page,

						:l_mail_disch_pat_result,
					    :rl_mail_inpatient_yn, :rl_mail_outpatient_yn,
					    :rl_mail_referral_yn, :rl_mail_external_yn,
						:rl_mic_to_print_yn
				  FROM RL_PARAM; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select result_rep_pg_len ,NVL(print_disch_pat_result_yn,'N\
') ,NVL(print_inpatient_yn,'N') ,NVL(print_outpatient_yn,'N') ,NVL(print_refer\
ral_yn,'N') ,NVL(print_external_yn,'N') ,NVL(mapped_alt_id_for_pat_id,'!') ,nv\
l(REP_PRINT_FOR_DISCH_YN,'N') ,nvl(rep_inpatient_yn,'N') ,nvl(rep_outpatient_y\
n,'N') ,nvl(rep_referral_yn,'N') ,nvl(rep_external_yn,'N') ,nvl(FAX_FOR_DISCH_\
YN,'N') ,nvl(fax_inpatient_yn,'N') ,nvl(fax_outpatient_yn,'N') ,nvl(fax_referr\
al_yn,'N') ,nvl(fax_external_yn,'N') ,nvl(print_test_name_in_contd_page,'N') ,\
nvl(email_FOR_DISCH_YN,'N') ,nvl(email_inpatient_yn,'N') ,nvl(email_outpatient\
_yn,'N') ,nvl(email_referral_yn,'N') ,nvl(email_external_yn,'N') ,nvl(rep_mic_\
yn,'N') into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,\
:b15,:b16,:b17,:b18,:b19,:b20,:b21,:b22,:b23  from RL_PARAM ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )166;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&page_length;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_print_disch_pat_result;
   sqlstm.sqhstl[1] = (unsigned int  )4;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_print_inpatient_yn;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_print_outpatient_yn;
   sqlstm.sqhstl[3] = (unsigned int  )4;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&rl_print_referral_yn;
   sqlstm.sqhstl[4] = (unsigned int  )4;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_print_external_yn;
   sqlstm.sqhstl[5] = (unsigned int  )4;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&rl_alt_id_for_pat_id;
   sqlstm.sqhstl[6] = (unsigned int  )53;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&l_rep_disch_pat_result;
   sqlstm.sqhstl[7] = (unsigned int  )4;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&rl_rep_inpatient_yn;
   sqlstm.sqhstl[8] = (unsigned int  )4;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&rl_rep_outpatient_yn;
   sqlstm.sqhstl[9] = (unsigned int  )4;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&rl_rep_referral_yn;
   sqlstm.sqhstl[10] = (unsigned int  )4;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&rl_rep_external_yn;
   sqlstm.sqhstl[11] = (unsigned int  )4;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqhstv[12] = (         void  *)&l_fax_disch_pat_result;
   sqlstm.sqhstl[12] = (unsigned int  )4;
   sqlstm.sqhsts[12] = (         int  )0;
   sqlstm.sqindv[12] = (         void  *)0;
   sqlstm.sqinds[12] = (         int  )0;
   sqlstm.sqharm[12] = (unsigned int  )0;
   sqlstm.sqadto[12] = (unsigned short )0;
   sqlstm.sqtdso[12] = (unsigned short )0;
   sqlstm.sqhstv[13] = (         void  *)&rl_fax_inpatient_yn;
   sqlstm.sqhstl[13] = (unsigned int  )4;
   sqlstm.sqhsts[13] = (         int  )0;
   sqlstm.sqindv[13] = (         void  *)0;
   sqlstm.sqinds[13] = (         int  )0;
   sqlstm.sqharm[13] = (unsigned int  )0;
   sqlstm.sqadto[13] = (unsigned short )0;
   sqlstm.sqtdso[13] = (unsigned short )0;
   sqlstm.sqhstv[14] = (         void  *)&rl_fax_outpatient_yn;
   sqlstm.sqhstl[14] = (unsigned int  )4;
   sqlstm.sqhsts[14] = (         int  )0;
   sqlstm.sqindv[14] = (         void  *)0;
   sqlstm.sqinds[14] = (         int  )0;
   sqlstm.sqharm[14] = (unsigned int  )0;
   sqlstm.sqadto[14] = (unsigned short )0;
   sqlstm.sqtdso[14] = (unsigned short )0;
   sqlstm.sqhstv[15] = (         void  *)&rl_fax_referral_yn;
   sqlstm.sqhstl[15] = (unsigned int  )4;
   sqlstm.sqhsts[15] = (         int  )0;
   sqlstm.sqindv[15] = (         void  *)0;
   sqlstm.sqinds[15] = (         int  )0;
   sqlstm.sqharm[15] = (unsigned int  )0;
   sqlstm.sqadto[15] = (unsigned short )0;
   sqlstm.sqtdso[15] = (unsigned short )0;
   sqlstm.sqhstv[16] = (         void  *)&rl_fax_external_yn;
   sqlstm.sqhstl[16] = (unsigned int  )4;
   sqlstm.sqhsts[16] = (         int  )0;
   sqlstm.sqindv[16] = (         void  *)0;
   sqlstm.sqinds[16] = (         int  )0;
   sqlstm.sqharm[16] = (unsigned int  )0;
   sqlstm.sqadto[16] = (unsigned short )0;
   sqlstm.sqtdso[16] = (unsigned short )0;
   sqlstm.sqhstv[17] = (         void  *)&rl_print_test_name_in_contd_page;
   sqlstm.sqhstl[17] = (unsigned int  )4;
   sqlstm.sqhsts[17] = (         int  )0;
   sqlstm.sqindv[17] = (         void  *)0;
   sqlstm.sqinds[17] = (         int  )0;
   sqlstm.sqharm[17] = (unsigned int  )0;
   sqlstm.sqadto[17] = (unsigned short )0;
   sqlstm.sqtdso[17] = (unsigned short )0;
   sqlstm.sqhstv[18] = (         void  *)&l_mail_disch_pat_result;
   sqlstm.sqhstl[18] = (unsigned int  )4;
   sqlstm.sqhsts[18] = (         int  )0;
   sqlstm.sqindv[18] = (         void  *)0;
   sqlstm.sqinds[18] = (         int  )0;
   sqlstm.sqharm[18] = (unsigned int  )0;
   sqlstm.sqadto[18] = (unsigned short )0;
   sqlstm.sqtdso[18] = (unsigned short )0;
   sqlstm.sqhstv[19] = (         void  *)&rl_mail_inpatient_yn;
   sqlstm.sqhstl[19] = (unsigned int  )4;
   sqlstm.sqhsts[19] = (         int  )0;
   sqlstm.sqindv[19] = (         void  *)0;
   sqlstm.sqinds[19] = (         int  )0;
   sqlstm.sqharm[19] = (unsigned int  )0;
   sqlstm.sqadto[19] = (unsigned short )0;
   sqlstm.sqtdso[19] = (unsigned short )0;
   sqlstm.sqhstv[20] = (         void  *)&rl_mail_outpatient_yn;
   sqlstm.sqhstl[20] = (unsigned int  )4;
   sqlstm.sqhsts[20] = (         int  )0;
   sqlstm.sqindv[20] = (         void  *)0;
   sqlstm.sqinds[20] = (         int  )0;
   sqlstm.sqharm[20] = (unsigned int  )0;
   sqlstm.sqadto[20] = (unsigned short )0;
   sqlstm.sqtdso[20] = (unsigned short )0;
   sqlstm.sqhstv[21] = (         void  *)&rl_mail_referral_yn;
   sqlstm.sqhstl[21] = (unsigned int  )4;
   sqlstm.sqhsts[21] = (         int  )0;
   sqlstm.sqindv[21] = (         void  *)0;
   sqlstm.sqinds[21] = (         int  )0;
   sqlstm.sqharm[21] = (unsigned int  )0;
   sqlstm.sqadto[21] = (unsigned short )0;
   sqlstm.sqtdso[21] = (unsigned short )0;
   sqlstm.sqhstv[22] = (         void  *)&rl_mail_external_yn;
   sqlstm.sqhstl[22] = (unsigned int  )4;
   sqlstm.sqhsts[22] = (         int  )0;
   sqlstm.sqindv[22] = (         void  *)0;
   sqlstm.sqinds[22] = (         int  )0;
   sqlstm.sqharm[22] = (unsigned int  )0;
   sqlstm.sqadto[22] = (unsigned short )0;
   sqlstm.sqtdso[22] = (unsigned short )0;
   sqlstm.sqhstv[23] = (         void  *)&rl_mic_to_print_yn;
   sqlstm.sqhstl[23] = (unsigned int  )4;
   sqlstm.sqhsts[23] = (         int  )0;
   sqlstm.sqindv[23] = (         void  *)0;
   sqlstm.sqinds[23] = (         int  )0;
   sqlstm.sqharm[23] = (unsigned int  )0;
   sqlstm.sqadto[23] = (unsigned short )0;
   sqlstm.sqtdso[23] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		 }

     }

     if (OERROR)
        ins_message(ORA_MESG,"Error Found in RL_PARAM"); 

	  if(NOT_FOUND) 
         ins_message(ORA_MESG,"Select failed on RL_PARAM --> No Data Found");

	 l_print_disch_pat_result.arr[l_print_disch_pat_result.len]      = '\0';
	 rl_print_inpatient_yn.arr[rl_print_inpatient_yn.len]			 = '\0';
	 rl_print_outpatient_yn.arr[rl_print_outpatient_yn.len]			 = '\0';
	 rl_print_referral_yn.arr[rl_print_referral_yn.len]				 = '\0';
	 rl_print_external_yn.arr[rl_print_external_yn.len]				 = '\0';

	 l_rep_disch_pat_result.arr[l_rep_disch_pat_result.len]      = '\0';
	 rl_rep_inpatient_yn.arr[rl_rep_inpatient_yn.len]			 = '\0';
	 rl_rep_outpatient_yn.arr[rl_rep_outpatient_yn.len]			 = '\0';
	 rl_rep_referral_yn.arr[rl_rep_referral_yn.len]				 = '\0';
	 rl_mic_to_print_yn.arr[rl_mic_to_print_yn.len]				 = '\0';

	 l_fax_disch_pat_result.arr[l_fax_disch_pat_result.len]      = '\0';
	 rl_fax_inpatient_yn.arr[rl_fax_inpatient_yn.len]			 = '\0';
	 rl_fax_outpatient_yn.arr[rl_fax_outpatient_yn.len]			 = '\0';
	 rl_fax_referral_yn.arr[rl_fax_referral_yn.len]				 = '\0';
	 rl_fax_external_yn.arr[rl_fax_external_yn.len]				 = '\0';

	 rl_print_test_name_in_contd_page.arr[rl_print_test_name_in_contd_page.len]	 = '\0';

	 l_mail_disch_pat_result.arr[l_mail_disch_pat_result.len]	     = '\0';
	 rl_mail_inpatient_yn.arr[rl_mail_inpatient_yn.len]				 = '\0';
	 rl_mail_outpatient_yn.arr[rl_mail_outpatient_yn.len]			 = '\0';
	 rl_mail_referral_yn.arr[rl_mail_referral_yn.len]				 = '\0';
	 rl_mail_external_yn.arr[rl_mail_external_yn.len]				 = '\0';
	 rl_mail_external_yn.arr[rl_mail_external_yn.len]				 = '\0';

	 rl_report_format.arr[rl_report_format.len]						 = '\0';
	 l_print_health_card_yn.arr[l_print_health_card_yn.len]			 = '\0';
	 rl_alt_id_for_pat_id.arr[rl_alt_id_for_pat_id.len]				 = '\0';
	 test_desc_fill_for_report.arr[test_desc_fill_for_report.len]	 = '\0';
	 rl_hmc_yn.arr[rl_hmc_yn.len]									 = '\0';


 }

/*----------------------------------------------------------*/
/******************************* 22.06.2003 this is not required
get_sleep_secs()
{
    d_sleep_secs.arr[0] = '\0';
	d_machine_name.arr[0] = '\0';
	d_started_by_id.arr[0] = '\0';
	d_next_start_date.arr[0]='\0';

	d_sleep_secs.len		= 0;
	d_machine_name.len		= 0;
	d_started_by_id.len		= 0;
	d_next_start_date.len	= 0;

	_flushall();

	get_restart_time(); 	

    EXEC SQL  SELECT	processing_interval ,
						floor((sysdate-started_date)*24*60),
						machine_name,
						started_by_id,
						to_char(sysdate,'ddmmyyyyhh24miss'),
						to_number(to_char(sysdate,'hh24mi'))
				INTO	:d_sleep_secs,
						:d_time_interval,
						:d_machine_name,
						:d_started_by_id,
						:d_next_start_date,
						:d_starting_time
				FROM	SY_BG_PROCESS_CONTROL
				WHERE	PGM_ID = 'RLRRSENQ'
				AND		STARTED_DATE IS NOT NULL
				AND		STARTED_DATE = TO_DATE(:prg_start_date,	'DDMMYYHH24MISS');

    d_sleep_secs.arr[d_sleep_secs.len] = '\0';
	d_machine_name.arr[d_machine_name.len] = '\0';
	d_started_by_id.arr[d_started_by_id.len] = '\0';
	d_next_start_date.arr[d_next_start_date.len]='\0';

    
//     if((d_time_interval > RESTART_INTERVAL) && (d_starting_time == RESTART_TIME))

//	if (((d_time_interval > RESTART_INTERVAL) && (d_starting_time == l_restart_time)) || request_count > 25)

	if ((d_time_interval > RESTART_INTERVAL) && (d_starting_time == l_restart_time))
	{
		
		request_count = 1;
	    
		{
////////////////// the below sql commented old
	     EXEC SQL
			INSERT INTO SY_BG_PROCESS_CONTROL
			VALUES(	
			        :nd_operating_facility_id,
					'RL',
					'RLRRSENQ',
					'Lab Print Server',
					:d_machine_name,
					:d_started_by_id,
					TO_DATE(:d_next_start_date, 'ddmmyyyyhh24miss'),
					3000,
					'Y');
////////////////// upto here
	     EXEC SQL
			INSERT INTO SY_BG_PROCESS_CONTROL
			VALUES(	
			        :nd_operating_facility_id,
					'RLRRSENQ',
					:d_machine_name,
					:d_started_by_id,
					TO_DATE(:d_next_start_date, 'ddmmyyyyhh24miss'),
					'Y',
					 '~~');

		  if (OERROR) 
		  {
					disp_message(ORA_MESG,"insert failed");  
		  }
 
		}

		EXEC SQL
			DELETE FROM SY_BG_PROCESS_CONTROL 
				WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND PGM_ID='RLRRSENQ'
				AND STARTED_DATE IS NOT NULL
				AND STARTED_DATE=TO_DATE(:prg_start_date,
		                           'DDMMYYHH24MISS');

    	EXEC SQL COMMIT;


		d_cmd_line.arr[0] = '\0';

        strcat(d_cmd_line.arr,"RLRRSENQ");
		strcat(d_cmd_line.arr," ");
		strcat(d_cmd_line.arr,d_user_id_pwd.arr);
		strcat(d_cmd_line.arr," ");
		strcat(d_cmd_line.arr,d_next_start_date.arr);


		d_cmd_line.arr[strlen(d_cmd_line.arr)] = '\0';		
/////// IN WINDOWS 2000 SYSTEM COMMAND WILL NOT GIVE BACK THE CONTROL ////////	
//		system(d_cmd_line.arr);

		WinExec(d_cmd_line.arr, SW_SHOWNORMAL);	        
        exit(0);

		
	}

	if(NOT_FOUND) 
	{
		  return FALSE;
	}
	else 
	{
		d_sleep_secs.arr[d_sleep_secs.len] = '\0';
        sleep_sec = (DWORD) atol(d_sleep_secs.arr);  
	    return TRUE;
	}    
}
**********************************/

/*----------------------------------------------------------*/
char *to_day()
{

today.arr[0]	= '\0';
today.len	= 0;

/* EXEC SQL SELECT 	to_char(SYSDATE,'DD/MM/YYYY HH24:MI')
	   INTO		:today
	   FROM		DUAL; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 10;
sqlstm.arrsiz = 25;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select to_char(SYSDATE,'DD/MM/YYYY HH24:MI') into :b0  from D\
UAL ";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )277;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)256;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&today;
sqlstm.sqhstl[0] = (unsigned int  )22;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   if (OERROR)
     ins_message(ORA_MESG,"Select failed on DUAL in to_day() ");

today.arr[today.len]	= '\0';
return (today.arr);
}
/*----------------------------------------------------------*/
process_rec1()
{  
   int i = 0;
   int j = 0,corr_stat = 0;
   int sy_prg_param_found =0;
   int record_exist = 0;
   char test[11],group_test[11];
   _flushall();

   request_count = 1;

		/*********************************************************/
		   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
		   {

			l_text.arr[0]		    = '\0';
			l_text.len            = 0;
			strcpy(l_text.arr,"IN PROCESS_REC1......");
			write_to_file();
		   }
		/*********************************************************/

	declare_curs();
    
	declare_param_curs();
 
		/*********************************************************/
		   //if (strcmp(l_file_exists.arr,"Y")==0)
		if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
		   {

			l_text.arr[0]		    = '\0';
			l_text.len            = 0;
			strcpy(l_text.arr,"IN PROCESS_REC1...1...");
			write_to_file();
		   }
		/************************************************************/
	while(fetch_param_curs()) 
	{
		  get_company_name();  //// 16.01.2006
	      get_len_from_param();

		  get_operational_flags();  /// 10.04.2006
		  get_screen_donor_id();    /// 10.04.2006
		  get_screen_patient_id();  /// 10.04.2006



		  if (strcmp(rl_report_format.arr, "1") == 0)
			  MAX_LINES = (page_length - 5) ; 
		  else
		  {
   		    if ((strcmp(rl_report_format.arr, "2") == 0 ||strcmp(rl_report_format.arr, "4") == 0 
			    )    && (p_param8.arr[0] == 'P') )

			    MAX_LINES = (page_length - 8) ; 
			else if ( (strcmp(rl_report_format.arr, "6") == 0 || strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "7") == 0) 
						&& (p_param8.arr[0] == 'P') )
			    MAX_LINES = (page_length - 11) ; 
			else if (strcmp(rl_report_format.arr, "6") == 0 || strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "7") == 0)
			    MAX_LINES = (page_length - 10) ; 
			else
				MAX_LINES = (page_length - 7) ; 
		  }

		  l_should_print_yn = 'N';
		  d_interval_specimen_yn = 'N';

//		  if(fetch_sy_prog_param())
		  if(fetch_sy_requests())
		  {
			 err_flag = 0;
             lctr = 0;
             pctr = 0;
             rec_ctr = 0;
	         copy = 0;

			strcpy(actual_specimen.arr, nd_spec_no.arr);
		 	actual_specimen.len = strlen(actual_specimen.arr);

			 if (p_param8.arr[0] == 'P')
			 {
				strcpy(nd_status.arr, "P");
				nd_status.len = strlen(nd_status.arr);
			 }
			 else
			 {
				strcpy(nd_status.arr, "R");
				nd_status.len = strlen(nd_status.arr);
			 }
			 
/******---------------- added the below on 21.05.2005 ---------- */
			 get_result_printed_date(); 
			 get_departmental_parameters();
			 get_user_conf_access_yn();  /// 28.09.2006 
///			 if (strcmp(draft_printing_yn.arr, "N") == 0)
//			 {  // 1
				 if (strcmp(rl_sectn_report_entire_spec_yn.arr,"Y") == 0)
				 {  // 2
				   if (rl_hdr_result_printed_date.len && (strcmp(rl_hdr_status.arr,"R") == 0 ||
			  											  strcmp(rl_hdr_status.arr,"P") == 0
														 ) )
				   {
					  strcpy(nd_status.arr, "P"); 
					  nd_status.len = strlen(nd_status.arr);				   
					}

					get_tst_rslt_max_reviewed_date(); 

					strcpy(l_report_legend.arr, "");   ///// 27.07.2005
					l_report_legend.arr[0] = '\0';  
					l_report_legend.len    = 0;

					if(!rl_hdr_result_printed_date.len)
					{
					  if(strcmp(rl_hdr_status.arr,"R") != 0 &&
  												strcmp(rl_hdr_status.arr,"P") != 0)
						//strcpy(l_report_legend.arr,"Interim         ");
						strcpy(l_report_legend.arr,local_legend[33]);//added for globalisation
					}
					else if(rl_hdr_result_printed_date.len) 
					{ // 3
					  if(strcmp(rl_hdr_status.arr,"R") == 0 ||
  												strcmp(rl_hdr_status.arr,"P") == 0)
					  {  
						strcpy(l_report_legend1.arr, local_legend[34]);//added for globalisation
						strcpy(l_report_legend2.arr, local_legend[35]);//added for globalisation
						/* EXEC SQL EXECUTE
							begin
								if to_date(:rl_tst_rslt_max_rev_date,'dd/mm/yyyy hh24:mi:ss') <= to_date(:rl_hdr_result_printed_date,'dd/mm/yyyy hh24:mi:ss') then
								   //:l_report_legend := 'Final           ';
								   :l_report_legend := :l_report_legend1;//added for globalisation
								elsif to_date(:rl_tst_rslt_max_rev_date,'dd/mm/yyyy hh24:mi:ss') > to_date(:rl_hdr_result_printed_date,'dd/mm/yyyy hh24:mi:ss') then
								   //:l_report_legend := 'Amended Final ';
								   :l_report_legend := :l_report_legend2;//added for globalisation
								end if;

							end;
						END-EXEC; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 25;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "begin if to_date ( :rl_tst_rslt_max_rev_date , 'dd/mm/y\
yyy hh24:mi:ss' ) <= to_date ( :rl_hdr_result_printed_date , 'dd/mm/yyyy hh24:\
mi:ss' ) then :l_report_legend := :l_report_legend1 ; elsif to_date ( :rl_tst_\
rslt_max_rev_date , 'dd/mm/yyyy hh24:mi:ss' ) > to_date ( :rl_hdr_result_print\
ed_date , 'dd/mm/yyyy hh24:mi:ss' ) then :l_report_legend := :l_report_legend2\
 ; end if ; end ;";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )296;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_tst_rslt_max_rev_date;
      sqlstm.sqhstl[0] = (unsigned int  )33;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_hdr_result_printed_date;
      sqlstm.sqhstl[1] = (unsigned int  )33;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&l_report_legend;
      sqlstm.sqhstl[2] = (unsigned int  )22;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&l_report_legend1;
      sqlstm.sqhstl[3] = (unsigned int  )102;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&l_report_legend2;
      sqlstm.sqhstl[4] = (unsigned int  )102;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					   }					  
					   else if(strcmp(rl_hdr_status.arr,"R") != 0 &&
  												strcmp(rl_hdr_status.arr,"P") != 0)
						   strcpy(l_report_legend.arr,"Amended         ");
						   strcpy(l_report_legend.arr, local_legend[36]);//added for globalisation

					 } //3

/// 18.08.2005					 l_report_legend.len = strlen(l_report_legend.arr);

					 l_report_legend.arr[l_report_legend.len] = '\0';  // 18.08.2005


				 }  //2
/// 			 }  // 1
/******---------------- upto here added  on 21.05.2005 ------------- */

			/*********************************************************/
			if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN PROCESS_REC1...2...");
				write_to_file();
			   }
			/************************************************************/

			 build_table();

			 if(strcmp(d_episode_type.arr,"R") == 0 || strcmp(d_episode_type.arr,"H") == 0)
				check_neonate_mother_spec_yn(); ///////// 19.10.2005

			 build_cancelled_tests();

			 declare_tst_result_curs();
			 strcpy(nd_test_code, "");

  		     something_to_print = 0;  
			 other_than_comments = 0;
 
				/*********************************************************/
				if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
				   {

					l_text.arr[0]		    = '\0';
					l_text.len            = 0;
					strcpy(l_text.arr,"IN PROCESS_REC1...3...");
					write_to_file();
				   }
				/************************************************************/


		if (l_should_print_yn == 'Y')
		{

             open_hdr();
			 _flushall();

             while (fetch_hdr() && err_flag == 0)
             {   
				 _flushall();

				 convert_dates_to_local_lang();

				 gen_file_name1();

				  if (err_flag)
					break;

				 print_c_hist = 0;
/// 21.05.2005   get_departmental_parameters();
                 source_copies = 0;
                 local_copies = 0;
	             strcpy(c_spec_no.arr,nd_spec_no.arr);
                 c_spec_no.len = strlen(nd_spec_no.arr);
                 fetch_other_dtls();
                 fetch_dtl();
  
					/*********************************************************/
					if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
					   {
    
						l_text.arr[0]		    = '\0';
						l_text.len            = 0;
						strcpy(l_text.arr,"IN PROCESS_REC1...4...");
						write_to_file();
					   }
					/************************************************************/


				 while(TRUE)
                 {
                     copy++;
					 open_tst_result_curs();
					 strcpy(prev_group_test,"");
                     rec_ctr = 0;
                     fflush(fp);

					if (err_flag != 0) 
					{
					
						break; 
					}

	                 i = fetch_tst_result();

	                 if(i)
					 {
                       
					   last_page = 0;
					   strcpy(first_user.arr, rl_released_by_id.arr);
					   first_user.len = strlen(first_user.arr);

					/* EXEC SQL EXECUTE
						DECLARE
							t_date   date;
						BEGIN
							//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_released_date,'DD/MM/YYYY hh24:mi'), :language_id , t_date);
							//:rl_released_date1 := to_char(t_date,'DD/MM/YYYY hh24:mi');
							:rl_released_date1 :=sm_convert_datetime_2t(to_date(:rl_released_date,'DD/MM/YYYY HH24:MI'),:language_id);
						END;
					END-EXEC; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 25;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "declare t_date date ; BEGIN :rl_released_date1 := sm_con\
vert_datetime_2t ( to_date ( :rl_released_date , 'DD/MM/YYYY HH24:MI' ) , :lan\
guage_id ) ; END ;";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )331;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&rl_released_date1;
     sqlstm.sqhstl[0] = (unsigned int  )19;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&rl_released_date;
     sqlstm.sqhstl[1] = (unsigned int  )19;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&language_id;
     sqlstm.sqhstl[2] = (unsigned int  )7;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					   //strcpy(footer_released_date, rl_released_date.arr);
					   strcpy(footer_released_date, rl_released_date1.arr);
					 }

					   if (strcmp(rl_report_format.arr, "1") == 0)
					   {
//qatar
							print_header();
						}
					   else if (strcmp(rl_report_format.arr, "2") == 0)
					   {
//kn
							print_header2();
					   }
					   else if (strcmp(rl_report_format.arr, "4") == 0 || strcmp(rl_report_format.arr, "5") == 0 )
					   {
//ml 
							print_header4();
					   }
					   else if (strcmp(rl_report_format.arr, "7") == 0 )
					   {
//MAFRAQ 
							print_header7();
					   }

					   else if (strcmp(rl_report_format.arr, "6") == 0 )
					   {
//ARTEMIS 
							print_header6();
					   }
					   else
					   {
//mf & su
							print_header3();
					   }

						
					   _flushall();

					 set_printed_date_time();
                  
				  

                     while (i && err_flag == 0)
                     {

	                     group_printed = 0;
	                     group = 0;
                         strcpy(group_test, rl_tst_group_test_code.arr);
                         strcpy(test,rl_tst_test_code.arr);
	                     if(strcmp(group_test,test) !=0)
  		                    group = 1;

/******** added the below on 21.05.2005 *****************************/
						  
						  check_profile_yn(rl_tst_group_test_code.arr);

						  c_count_profile.arr[0]	='\0';
						  c_count_profile.len		= 0;   

						  if(rl_tst_cd_profile_yn.arr[0] == 'Y' && strcmp(draft_printing_yn.arr, "N") == 0)
						  {
							if(p_param8.arr[0] != 'P')  
							{
							  
								/* EXEC SQL SELECT NVL(COUNT(*),0)  
										 INTO	c_count_profile
										 FROM   RL_TEST_RESULT
										 WHERE  SPECIMEN_NO = TO_NUMBER(:nd_spec_no)
										 AND    OPERATING_FACILITY_ID = :nd_operating_facility_id
										 AND    GROUP_TEST_CODE = :rl_tst_group_test_code
////27.07.2005										 AND    NVL(STATUS,'O') = 'R';
										 AND    ( NVL(STATUS,'O') IN ('R',:nd_status)
													OR NVL(PRELIMINARY_RELEASE_YN,'N') = 'Y'); */ 

{
        struct sqlexd sqlstm;
        sqlstm.sqlvsn = 10;
        sqlstm.arrsiz = 25;
        sqlstm.sqladtp = &sqladt;
        sqlstm.sqltdsp = &sqltds;
        sqlstm.stmt = "select NVL(count(*) ,0) into :b0  from RL_TEST_RESULT\
 where (((SPECIMEN_NO=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) and GROUP_\
TEST_CODE=:b3) and (NVL(STATUS,'O') in ('R',:b4) or NVL(PRELIMINARY_RELEASE_YN\
,'N')='Y'))";
        sqlstm.iters = (unsigned int  )1;
        sqlstm.offset = (unsigned int  )358;
        sqlstm.selerr = (unsigned short)1;
        sqlstm.cud = sqlcud0;
        sqlstm.sqlest = (unsigned char  *)&sqlca;
        sqlstm.sqlety = (unsigned short)256;
        sqlstm.occurs = (unsigned int  )0;
        sqlstm.sqhstv[0] = (         void  *)&c_count_profile;
        sqlstm.sqhstl[0] = (unsigned int  )5;
        sqlstm.sqhsts[0] = (         int  )0;
        sqlstm.sqindv[0] = (         void  *)0;
        sqlstm.sqinds[0] = (         int  )0;
        sqlstm.sqharm[0] = (unsigned int  )0;
        sqlstm.sqadto[0] = (unsigned short )0;
        sqlstm.sqtdso[0] = (unsigned short )0;
        sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
        sqlstm.sqhstl[1] = (unsigned int  )23;
        sqlstm.sqhsts[1] = (         int  )0;
        sqlstm.sqindv[1] = (         void  *)0;
        sqlstm.sqinds[1] = (         int  )0;
        sqlstm.sqharm[1] = (unsigned int  )0;
        sqlstm.sqadto[1] = (unsigned short )0;
        sqlstm.sqtdso[1] = (unsigned short )0;
        sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
        sqlstm.sqhstl[2] = (unsigned int  )7;
        sqlstm.sqhsts[2] = (         int  )0;
        sqlstm.sqindv[2] = (         void  *)0;
        sqlstm.sqinds[2] = (         int  )0;
        sqlstm.sqharm[2] = (unsigned int  )0;
        sqlstm.sqadto[2] = (unsigned short )0;
        sqlstm.sqtdso[2] = (unsigned short )0;
        sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
        sqlstm.sqhstl[3] = (unsigned int  )13;
        sqlstm.sqhsts[3] = (         int  )0;
        sqlstm.sqindv[3] = (         void  *)0;
        sqlstm.sqinds[3] = (         int  )0;
        sqlstm.sqharm[3] = (unsigned int  )0;
        sqlstm.sqadto[3] = (unsigned short )0;
        sqlstm.sqtdso[3] = (unsigned short )0;
        sqlstm.sqhstv[4] = (         void  *)&nd_status;
        sqlstm.sqhstl[4] = (unsigned int  )4;
        sqlstm.sqhsts[4] = (         int  )0;
        sqlstm.sqindv[4] = (         void  *)0;
        sqlstm.sqinds[4] = (         int  )0;
        sqlstm.sqharm[4] = (unsigned int  )0;
        sqlstm.sqadto[4] = (unsigned short )0;
        sqlstm.sqtdso[4] = (unsigned short )0;
        sqlstm.sqphsv = sqlstm.sqhstv;
        sqlstm.sqphsl = sqlstm.sqhstl;
        sqlstm.sqphss = sqlstm.sqhsts;
        sqlstm.sqpind = sqlstm.sqindv;
        sqlstm.sqpins = sqlstm.sqinds;
        sqlstm.sqparm = sqlstm.sqharm;
        sqlstm.sqparc = sqlstm.sqharc;
        sqlstm.sqpadto = sqlstm.sqadto;
        sqlstm.sqptdso = sqlstm.sqtdso;
        sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  // 22.08.2006


								if(NODATAFOUND);
								if (OERROR)
									  ins_message(ORA_MESG,"Failed at Select RL_TEST_RESULT in print_dtls()");

								c_count_profile.arr[c_count_profile.len] ='\0';
							}
							else 
							{
							   strcpy(c_count_profile.arr,"1");
							   c_count_profile.len =  strlen(c_count_profile.arr);
							}
						  }
						  else
						  {
							   strcpy(c_count_profile.arr,"1");
							   c_count_profile.len =  strlen(c_count_profile.arr);
						  }

/*************************** upto here added on 21.05.2005 ******************/


                         while(i && strcmp(group_test,rl_tst_group_test_code.arr)==0 && err_flag == 0)
	                     {  

			 	             strcpy(c_spec_no.arr,nd_spec_no.arr);
			                 c_spec_no.len = strlen(c_spec_no.arr);

		                     test_printed = 0;
                             rec_ctr ++;

							 test_contd = 0;	// 19.03.2005

                             print_dtls();

							 test_contd = 1;	// 19.03.2005

                             update_tst_result();
 							 update_interval_specimen();
						     update_rl_request_detail();
							 update_rl_request_header();

                             i = fetch_tst_result();

							 other_than_comments = 0;
                         }
                      }
                      
                      if (rec_ctr && err_flag == 0)
                      {
						   print_cancelled_tests();

                          for (i=lctr;i<=MAX_LINES;i++)
						  {
                               fprintf(fp,"\n");
							   write_html(fp4,"<a class=font_disp><br></a>");
						  }
                          last_page = 1;

						  if (strcmp(rl_report_format.arr, "1") == 0)
								print_footer(0);
						  else if (strcmp(rl_report_format.arr, "2") == 0)
								print_footer2(0);
						  else if (strcmp(rl_report_format.arr, "4") == 0)
								print_footer4(0);
						  else if (strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "7") == 0)
								print_footer5(0);
						  else if (strcmp(rl_report_format.arr, "6") == 0 )
								print_footer6(0);
						  else 
								print_footer3(0);

                      }
                      if (rl_hdr_extra_copies_to.len && copy == 1 && err_flag == 0)
	                  {   
					      fclose(fp);  /* Close the Main file */
						  _flushall();

						  write_html(fp4,"</body></html>");

						  strcpy(nd_test_code, "");
   	                      gen_extra_file_name1();

		  				  if (err_flag)
								break;


	                      pctr = 0;
	                  }
                      else 
	                      break; 
                   }
   	               fclose(fp); /* Close the Main File if no Extra File,
								   else the Extra File */
			       _flushall();

				   write_html(fp4,"</body></html>");

				   if (err_flag == 0)
				   {
						create_lab_file_name();

						print_job1();
					}
				   _flushall();

				   if(err_flag)
				   {
				      update_sy_bg_rep_gen_req();
					}
				   else
				   {

					  delete_sy_bg_rep_gen_req();
					  delete_sy_prog_param(); 
                   }
				break;  //// 11.04.2005 
                }
			 }
			 else
			 {
  			    delete_sy_bg_rep_gen_req();
			    delete_sy_prog_param();

			 }
                close_all_cur(); 
			
				if(err_flag)
					update_sy_bg_rep_gen_req();

				delete_build_table();

                /* EXEC SQL COMMIT WORK; */ 

{
                struct sqlexd sqlstm;
                sqlstm.sqlvsn = 10;
                sqlstm.arrsiz = 25;
                sqlstm.sqladtp = &sqladt;
                sqlstm.sqltdsp = &sqltds;
                sqlstm.iters = (unsigned int  )1;
                sqlstm.offset = (unsigned int  )393;
                sqlstm.cud = sqlcud0;
                sqlstm.sqlest = (unsigned char  *)&sqlca;
                sqlstm.sqlety = (unsigned short)256;
                sqlstm.occurs = (unsigned int  )0;
                sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		     }
			 else
			 {
//				delete_sy_bg_rep_gen_req();
				delete_sy_prog_param();
				/* EXEC SQL COMMIT WORK; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 25;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )408;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			 }

			 record_exist = 0;

 	

			 request_count++;

		 _flushall();
		 fflush(NULL);	 
		fflush(stdin);
	}
	close_param_curs();

}
/*------------------------------------------------------------*/
process_rec()
{  
   int i = 0;
   int j = 0,corr_stat = 0;
   int sy_prg_param_found =0;
   int record_exist = 0;
   char test[11],group_test[11];  
   _flushall();

   request_count = 1;

  //sprintf(string_var,"DEBUG IN REC %s",l_debug_yn.arr);
   //disp_message(ERR_MESG,string_var);
/*-----------------------------------*/
		/*********************************************************/
		if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
		   {

			l_text.arr[0]		    = '\0';
			l_text.len            = 0;
			strcpy(l_text.arr,"IN PROCESS_REC......");
			write_to_file();
		   }
		/************************************************************/
	declare_curs();


	while(request_count < 20)
	{

	   strcpy(draft_printing_yn.arr, "N");
	   draft_printing_yn.len = strlen(draft_printing_yn.arr);

      if(strcmp(nd_priority.arr, "1") == 0)
      {
       record_exist = fetch_sy_urgent();
	   close_urgent_curs();

       if (!record_exist)
	   {
	   	  record_exist = fetch_sy_stat();
		  close_stat_curs();
        }
	  }
	  else if (strcmp(nd_priority.arr, "2") == 0 || strcmp(nd_priority.arr, "3") == 0 )
	   {	   
     	  record_exist = fetch_sy_routine();
          close_routine_curs();
	   }
	   else
	   {
        record_exist = fetch_sy_urgent();
	    close_urgent_curs();

        if (!record_exist)
	    {
	   	  record_exist = fetch_sy_stat();
		  close_stat_curs();
		}

	    if (!record_exist)
	    {
	   	   record_exist = fetch_sy_routine();
	       close_routine_curs();
	    }
       }
	  
			/*********************************************************/
			if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN PROCESS_REC...1...");
				write_to_file();
			   }
			/************************************************************/
	   if (record_exist == 0)
			break;

	   get_company_name();  //// 16.01.2006

       while (record_exist)
       {

          get_len_from_param();


		  if (strcmp(rl_report_format.arr, "1") == 0)
			  MAX_LINES = (page_length - 5) ; 
		  else
		  {
   		    if ((strcmp(rl_report_format.arr, "2") == 0 || strcmp(rl_report_format.arr, "4") == 0 
							) && (p_param8.arr[0] == 'P') )
			    MAX_LINES = (page_length - 8) ; 
			else if ((strcmp(rl_report_format.arr, "6") == 0 || strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "7") == 0) 
							&& (p_param8.arr[0] == 'P') )
			    MAX_LINES = (page_length - 11) ; 
			else if (strcmp(rl_report_format.arr, "6") == 0 || strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "7") == 0) 
			    MAX_LINES = (page_length - 10) ; 
			else
				MAX_LINES = (page_length - 7) ; 
		  }



		  l_should_print_yn = 'N';
		  d_interval_specimen_yn = 'N';

			/*********************************************************/
			if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;

				strcpy(l_text.arr,"IN PROCESS_REC...2...");
				write_to_file();
			   } 
			/************************************************************/
		  if(fetch_sy_prog_param())
		  {

			 err_flag = 0;
             lctr = 0;
             pctr = 0;
             rec_ctr = 0;
	         copy = 0;

			get_operational_flags(); /// 10.04.2006
			get_screen_donor_id();    /// 10.04.2006
			get_screen_patient_id();  /// 10.04.2006

 /********** decide whether the entry is an DRAFT COPY ********/
 	 		if (strcmp(p_param7.arr, "D") == 0)
			{
				strcpy(draft_printing_yn.arr, "Y");
				draft_printing_yn.len = strlen(draft_printing_yn.arr);
			}

 			strcpy(actual_specimen.arr, nd_spec_no.arr);
		 	actual_specimen.len = strlen(actual_specimen.arr);

			 if (p_param8.arr[0] == 'P')
			 {
				strcpy(nd_status.arr, "P");
				nd_status.len = strlen(nd_status.arr); 
			 }
			 else
			 {
				strcpy(nd_status.arr, "R");
				nd_status.len = strlen(nd_status.arr);
			 }

/******---------------- added the below on 21.05.2005 ---------- */
			 get_result_printed_date(); 
			 get_departmental_parameters();
			 get_user_conf_access_yn(); /// 28.09.2006

			 if (strcmp(draft_printing_yn.arr, "N") == 0)
			 {  // 1
				 if (strcmp(rl_sectn_report_entire_spec_yn.arr,"Y") == 0)
				 {  // 2
				   if (rl_hdr_result_printed_date.len && (strcmp(rl_hdr_status.arr,"R") == 0 ||
			  											  strcmp(rl_hdr_status.arr,"P") == 0
														 ) )
				   {
					  strcpy(nd_status.arr, "P"); 
					  nd_status.len = strlen(nd_status.arr);				   
					}

					get_tst_rslt_max_reviewed_date(); 

					strcpy(l_report_legend.arr, "");   //////// 27.07.2005
					l_report_legend.arr[0] = '\0';  
					l_report_legend.len    = 0;

					if(!rl_hdr_result_printed_date.len)
					{
					  if(strcmp(rl_hdr_status.arr,"R") != 0 &&
  												strcmp(rl_hdr_status.arr,"P") != 0)
						strcpy(l_report_legend.arr,"Interim         ");
					}
					else if(rl_hdr_result_printed_date.len) 
					{ // 3
					  if(strcmp(rl_hdr_status.arr,"R") == 0 ||
  												strcmp(rl_hdr_status.arr,"P") == 0)
					  {  
						strcpy(l_report_legend1.arr, local_legend[34]);//added for globalisation
						strcpy(l_report_legend2.arr, local_legend[35]);//added for globalisation

						/* EXEC SQL EXECUTE
							begin
								if to_date(:rl_tst_rslt_max_rev_date,'dd/mm/yyyy hh24:mi:ss') <= to_date(:rl_hdr_result_printed_date,'dd/mm/yyyy hh24:mi:ss') then
								   //:l_report_legend := 'Final           ';
									:l_report_legend := :l_report_legend1; //added for globalisation
								elsif to_date(:rl_tst_rslt_max_rev_date,'dd/mm/yyyy hh24:mi:ss') > to_date(:rl_hdr_result_printed_date,'dd/mm/yyyy hh24:mi:ss') then
								   //:l_report_legend := 'Amended Final ';
								   :l_report_legend := :l_report_legend2; //added for globalisation
								end if;

							end;
						END-EXEC; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 25;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "begin if to_date ( :rl_tst_rslt_max_rev_date , 'dd/mm/y\
yyy hh24:mi:ss' ) <= to_date ( :rl_hdr_result_printed_date , 'dd/mm/yyyy hh24:\
mi:ss' ) then :l_report_legend := :l_report_legend1 ; elsif to_date ( :rl_tst_\
rslt_max_rev_date , 'dd/mm/yyyy hh24:mi:ss' ) > to_date ( :rl_hdr_result_print\
ed_date , 'dd/mm/yyyy hh24:mi:ss' ) then :l_report_legend := :l_report_legend2\
 ; end if ; end ;";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )423;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_tst_rslt_max_rev_date;
      sqlstm.sqhstl[0] = (unsigned int  )33;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_hdr_result_printed_date;
      sqlstm.sqhstl[1] = (unsigned int  )33;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&l_report_legend;
      sqlstm.sqhstl[2] = (unsigned int  )22;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&l_report_legend1;
      sqlstm.sqhstl[3] = (unsigned int  )102;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&l_report_legend2;
      sqlstm.sqhstl[4] = (unsigned int  )102;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  
					   }					  
					   else if(strcmp(rl_hdr_status.arr,"R") != 0 &&
  												strcmp(rl_hdr_status.arr,"P") != 0)
						   //strcpy(l_report_legend.arr,"Amended         ");
						   strcpy(l_report_legend.arr,local_legend[36]);//added for globalisation

					 } //3

/// 18.08.2005			 l_report_legend.len = strlen(l_report_legend.arr);

					 l_report_legend.arr[l_report_legend.len] = '\0';  // 18.08.2005


				 }  //2
			 }  // 1
/******---------------- upto here added  on 21.05.2005 ------------- */

			/*********************************************************/
			if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN PROCESS_REC...3...");
				write_to_file();
			   }
			/************************************************************/
			 build_table();


			 if(strcmp(d_episode_type.arr,"R") == 0 || strcmp(d_episode_type.arr,"H") == 0)
				check_neonate_mother_spec_yn(); ///////// 19.10.2005

			 build_cancelled_tests();

			 declare_tst_result_curs();
			 strcpy(nd_test_code, "");



  		     something_to_print = 0;  
			 other_than_comments = 0;

		if (l_should_print_yn == 'Y')
		{

             open_hdr();
			 _flushall();

             while (fetch_hdr() && err_flag == 0)
             {   
				 _flushall();  

				convert_dates_to_local_lang();

				 gen_file_name();

				 if (err_flag)
					break;

				 print_c_hist = 0;
// 21.05.2005    get_departmental_parameters();
                 source_copies = 0;
                 local_copies = 0;
	             strcpy(c_spec_no.arr,nd_spec_no.arr);
                 c_spec_no.len = strlen(nd_spec_no.arr);
                 fetch_other_dtls();
                 fetch_dtl();

                 while(TRUE)
                 {

                     copy++;
					 open_tst_result_curs();
					 strcpy(prev_group_test,"");
                     rec_ctr = 0;
                     fflush(fp);

	                 i = fetch_tst_result();

	                 if(i)
					 {
                       
					   last_page = 0;
					   strcpy(first_user.arr, rl_released_by_id.arr);
					   first_user.len = strlen(first_user.arr);

					/* EXEC SQL EXECUTE
						DECLARE
							t_date   date; 
						BEGIN
							//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_released_date,'DD/MM/YYYY hh24:mi'), :language_id , t_date);
							//:rl_released_date1 := to_char(t_date,'DD/MM/YYYY hh24:mi');
							:rl_released_date1 :=sm_convert_datetime_2t(to_date(:rl_released_date,'DD/MM/YYYY HH24:MI'),:language_id);
						END;
					END-EXEC; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 25;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "declare t_date date ; BEGIN :rl_released_date1 := sm_con\
vert_datetime_2t ( to_date ( :rl_released_date , 'DD/MM/YYYY HH24:MI' ) , :lan\
guage_id ) ; END ;";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )458;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&rl_released_date1;
     sqlstm.sqhstl[0] = (unsigned int  )19;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&rl_released_date;
     sqlstm.sqhstl[1] = (unsigned int  )19;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&language_id;
     sqlstm.sqhstl[2] = (unsigned int  )7;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					   //strcpy(footer_released_date, rl_released_date.arr);
					   strcpy(footer_released_date, rl_released_date1.arr);

					 }

					   if (strcmp(rl_report_format.arr, "1") == 0)
					   {
//qatar
							print_header();
						}
					   else if (strcmp(rl_report_format.arr, "2") == 0)
					   {
//kn
							print_header2();   

					   }
					   else if (strcmp(rl_report_format.arr, "4") == 0 || strcmp(rl_report_format.arr, "5") == 0)
					   {
//ml
							print_header4();

					   }
					   else if (strcmp(rl_report_format.arr, "7") == 0 )
					   {
//MAFRAQ
							print_header7();

					   }

					   else if (strcmp(rl_report_format.arr, "6") == 0 )
					   {
//ARTEMIS
							print_header6();

					   }
					   else
					   {
//mf & su
							print_header3();
					   }

						
					   _flushall();

					 set_printed_date_time();

                     while (i && err_flag == 0)
                     {

	                     group_printed = 0;
	                     group = 0;

                         strcpy(group_test, rl_tst_group_test_code.arr);
                         strcpy(test,rl_tst_test_code.arr);
	                     if(strcmp(group_test,test) !=0)
  		                    group = 1;
 
/******** added the below on 21.05.2005 *****************************/
						  
						  check_profile_yn(rl_tst_group_test_code.arr);

						  c_count_profile.arr[0]	='\0';
						  c_count_profile.len		= 0; 

						  if(rl_tst_cd_profile_yn.arr[0] == 'Y' && strcmp(draft_printing_yn.arr, "N") == 0)
						  {
							if(p_param8.arr[0] != 'P')  
							{
							  
								/* EXEC SQL SELECT NVL(COUNT(*),0)  
										 INTO	c_count_profile
										 FROM   RL_TEST_RESULT
										 WHERE  SPECIMEN_NO = TO_NUMBER(:nd_spec_no)
										 AND    OPERATING_FACILITY_ID = :nd_operating_facility_id
										 AND    GROUP_TEST_CODE = :rl_tst_group_test_code
///// 27.07.2005						 AND    NVL(STATUS,'O') = 'R';
										 AND    ( NVL(STATUS,'O') IN ('R',:nd_status)
													OR NVL(PRELIMINARY_RELEASE_YN,'N') = 'Y'); */ 

{
        struct sqlexd sqlstm;
        sqlstm.sqlvsn = 10;
        sqlstm.arrsiz = 25;
        sqlstm.sqladtp = &sqladt;
        sqlstm.sqltdsp = &sqltds;
        sqlstm.stmt = "select NVL(count(*) ,0) into :b0  from RL_TEST_RESULT\
 where (((SPECIMEN_NO=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) and GROUP_\
TEST_CODE=:b3) and (NVL(STATUS,'O') in ('R',:b4) or NVL(PRELIMINARY_RELEASE_YN\
,'N')='Y'))";
        sqlstm.iters = (unsigned int  )1;
        sqlstm.offset = (unsigned int  )485;
        sqlstm.selerr = (unsigned short)1;
        sqlstm.cud = sqlcud0;
        sqlstm.sqlest = (unsigned char  *)&sqlca;
        sqlstm.sqlety = (unsigned short)256;
        sqlstm.occurs = (unsigned int  )0;
        sqlstm.sqhstv[0] = (         void  *)&c_count_profile;
        sqlstm.sqhstl[0] = (unsigned int  )5;
        sqlstm.sqhsts[0] = (         int  )0;
        sqlstm.sqindv[0] = (         void  *)0;
        sqlstm.sqinds[0] = (         int  )0;
        sqlstm.sqharm[0] = (unsigned int  )0;
        sqlstm.sqadto[0] = (unsigned short )0;
        sqlstm.sqtdso[0] = (unsigned short )0;
        sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
        sqlstm.sqhstl[1] = (unsigned int  )23;
        sqlstm.sqhsts[1] = (         int  )0;
        sqlstm.sqindv[1] = (         void  *)0;
        sqlstm.sqinds[1] = (         int  )0;
        sqlstm.sqharm[1] = (unsigned int  )0;
        sqlstm.sqadto[1] = (unsigned short )0;
        sqlstm.sqtdso[1] = (unsigned short )0;
        sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
        sqlstm.sqhstl[2] = (unsigned int  )7;
        sqlstm.sqhsts[2] = (         int  )0;
        sqlstm.sqindv[2] = (         void  *)0;
        sqlstm.sqinds[2] = (         int  )0;
        sqlstm.sqharm[2] = (unsigned int  )0;
        sqlstm.sqadto[2] = (unsigned short )0;
        sqlstm.sqtdso[2] = (unsigned short )0;
        sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
        sqlstm.sqhstl[3] = (unsigned int  )13;
        sqlstm.sqhsts[3] = (         int  )0;
        sqlstm.sqindv[3] = (         void  *)0;
        sqlstm.sqinds[3] = (         int  )0;
        sqlstm.sqharm[3] = (unsigned int  )0;
        sqlstm.sqadto[3] = (unsigned short )0;
        sqlstm.sqtdso[3] = (unsigned short )0;
        sqlstm.sqhstv[4] = (         void  *)&nd_status;
        sqlstm.sqhstl[4] = (unsigned int  )4;
        sqlstm.sqhsts[4] = (         int  )0;
        sqlstm.sqindv[4] = (         void  *)0;
        sqlstm.sqinds[4] = (         int  )0;
        sqlstm.sqharm[4] = (unsigned int  )0;
        sqlstm.sqadto[4] = (unsigned short )0;
        sqlstm.sqtdso[4] = (unsigned short )0;
        sqlstm.sqphsv = sqlstm.sqhstv;
        sqlstm.sqphsl = sqlstm.sqhstl;
        sqlstm.sqphss = sqlstm.sqhsts;
        sqlstm.sqpind = sqlstm.sqindv;
        sqlstm.sqpins = sqlstm.sqinds;
        sqlstm.sqparm = sqlstm.sqharm;
        sqlstm.sqparc = sqlstm.sqharc;
        sqlstm.sqpadto = sqlstm.sqadto;
        sqlstm.sqptdso = sqlstm.sqtdso;
        sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  /// 22.08.2006

								if(NODATAFOUND);
								if (OERROR)
									  ins_message(ORA_MESG,"Failed at Select RL_TEST_RESULT in print_dtls()");

								c_count_profile.arr[c_count_profile.len] ='\0';
							}
							else  
							{
							   strcpy(c_count_profile.arr,"1");
							   c_count_profile.len =  strlen(c_count_profile.arr);
							}
						  }
						  else
						  {
							   strcpy(c_count_profile.arr,"1");
							   c_count_profile.len =  strlen(c_count_profile.arr);
						  }

/*************************** upto here added on 21.05.2005 ******************/

                         while(i && strcmp(group_test,rl_tst_group_test_code.arr)==0 && err_flag == 0)
	                     {  
 
			 	             strcpy(c_spec_no.arr,nd_spec_no.arr);
			                 c_spec_no.len = strlen(c_spec_no.arr);

		                     test_printed = 0;
                             rec_ctr ++;
							 test_contd = 0;	// 19.03.2005

							 print_dtls();

							 test_contd = 1;  // 19.03.2005

							 if (strcmp(draft_printing_yn.arr, "N") == 0)
							 {
								update_tst_result();
 								update_interval_specimen();
								update_rl_request_detail();
								update_rl_request_header();
							  }

                             i = fetch_tst_result();

							 other_than_comments = 0;
                         }
                      }
                      

                      if (rec_ctr && err_flag == 0)
                      {
						   print_cancelled_tests();

                          for (i=lctr;i<=MAX_LINES;i++)
						  {
                               fprintf(fp,"\n");
							   write_html(fp4,"<a class=font_disp><br></a>");
						  }
                          last_page = 1;

						  if (strcmp(rl_report_format.arr, "1") == 0)
								print_footer(0);
						  else if (strcmp(rl_report_format.arr, "2") == 0)
								print_footer2(0);
						  else if (strcmp(rl_report_format.arr, "4") == 0 )
								print_footer4(0);
						  else if (strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "7") == 0	)
								print_footer5(0);
						  else  if (strcmp(rl_report_format.arr, "6") == 0 )
								print_footer6(0);
						  else
								print_footer3(0); 


                      }
					  if (strcmp(draft_printing_yn.arr, "N") == 0)
					  {
							if (rl_hdr_extra_copies_to.len && copy == 1 && err_flag == 0)
							{   
								fclose(fp);  /* Close the Main file */
								_flushall();

								write_html(fp4,"</body></html>");
								fclose(fp4);

								strcpy(nd_test_code, "");
   								gen_extra_file_name();

			  				    if (err_flag)
									break;

								pctr = 0;
							}
							else 
								break; 
					  }
					  else
						break;
                   }
   	               fclose(fp); /* Close the Main File if no Extra File,
								   else the Extra File */


			       _flushall();

				   write_html(fp4,"</body></html>");
				   fclose(fp4);

				   if (err_flag == 0)
				   {
						create_lab_file_name();
						print_job();
					}
				   _flushall(); 
				   if(err_flag)
				      update_sy_bg_rep_gen_req();
				   else
				   {
					  delete_sy_bg_rep_gen_req();
					  delete_sy_prog_param();
                   }
			    break;  //// 11.04.2005 
                }
			 }
			 else
			 {

  			    delete_sy_bg_rep_gen_req(); 
			    delete_sy_prog_param();

			 }
                close_all_cur(); 

				if(err_flag)
					update_sy_bg_rep_gen_req();

				delete_build_table();

                /* EXEC SQL COMMIT WORK; */ 

{
                struct sqlexd sqlstm;
                sqlstm.sqlvsn = 10;
                sqlstm.arrsiz = 25;
                sqlstm.sqladtp = &sqladt;
                sqlstm.sqltdsp = &sqltds;
                sqlstm.iters = (unsigned int  )1;
                sqlstm.offset = (unsigned int  )520;
                sqlstm.cud = sqlcud0;
                sqlstm.sqlest = (unsigned char  *)&sqlca;
                sqlstm.sqlety = (unsigned short)256;
                sqlstm.occurs = (unsigned int  )0;
                sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		     }
			 else
			 {
				delete_sy_bg_rep_gen_req();
				/* EXEC SQL COMMIT WORK; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 25;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )535;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			 }

			 record_exist = 0;

 	

         } 
		 request_count++;

		 _flushall();
		 fflush(NULL);	 
		fflush(stdin);
	}
			/*********************************************************/
			if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		  = '\0';
				l_text.len            = 0;

				strcpy(l_text.arr,"IN PROCESS_REC...LAST...");
				write_to_file();
			   }
			/************************************************************/

}
/*------------------------------------------------------------*/
update_sy_bg_rep_gen_req()
{
   /* EXEC SQL UPDATE SY_REPORT_GENERATE_REQUEST
               SET REQUEST_STATUS = 'E'
			 WHERE ROWID = :sy_rowid; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "update SY_REPORT_GENERATE_REQUEST  set REQUEST_STATUS='E' \
where ROWID=:b0";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )550;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   if(OERROR) 
      ins_message(ERR_MESG,"Failed in upd_sy_bg_rep_gen_req()");       
}
/*------------------------------------------------------------*/
delete_sy_bg_rep_gen_req()
{
   char test[100];
   /* EXEC SQL DELETE FROM SY_REPORT_GENERATE_REQUEST
             WHERE ROWID = :sy_rowid; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "delete  from SY_REPORT_GENERATE_REQUEST  where ROWID=:b0";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )569;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   if(OERROR) 
      ins_message(ERR_MESG,"Failed in delete_sy_bg_rep_gen_req");
}
/*------------------------------------------------------------*/
delete_sy_prog_param()
{

  /* EXEC SQL DELETE FROM SY_PROG_PARAM
 	         WHERE rowid = :nd_rowid; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 25;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "delete  from SY_PROG_PARAM  where rowid=:b0";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )588;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_rowid;
  sqlstm.sqhstl[0] = (unsigned int  )33;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   if(OERROR) 
      ins_message(ERR_MESG,"Failed in delete_sy_prog_param");
}

/*------------------------------------------------------------*/

fetch_sy_bg_rep_gen_req_u()
{
sy_user_id.arr[0] 		= '\0';
sy_session_id.arr[0] 	= '\0';
sy_req_date.arr[0]      = '\0';
sy_machine_name.arr[0]  = '\0';
sy_ws_no.arr[0]		    = '\0';
sy_rowid.arr[0]		    = '\0';

sy_session_id.len	    = 0;
sy_user_id.len	        = 0;
sy_req_date.len         = 0;
sy_machine_name.len     = 0;
sy_ws_no.len            = 0;
sy_rowid.len            = 0;

/* EXEC SQL SELECT
			    SESSION_ID,
				USER_ID,
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'),
				MACHINE_NAME,
				WS_NO,
				ROWID
	       INTO	
                :sy_session_id,
                :sy_user_id,
                :sy_req_date,
				:sy_machine_name,
				:sy_ws_no,
				:sy_rowid
	       FROM	SY_REPORT_GENERATE_REQUEST
	      WHERE	PGM_ID = 'RLRRSENQ'
			AND REQUEST_STATUS IS NULL
			AND NVL(URGENT_INDICATOR,' ') = 'U'
	        AND ROWNUM < 2; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 10;
sqlstm.arrsiz = 25;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDMMYYHH24M\
ISS') ,MACHINE_NAME ,WS_NO ,ROWID into :b0,:b1,:b2,:b3,:b4,:b5  from SY_REPORT\
_GENERATE_REQUEST where (((PGM_ID='RLRRSENQ' and REQUEST_STATUS is null ) and \
NVL(URGENT_INDICATOR,' ')='U') and ROWNUM<2)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )607;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)256;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&sy_session_id;
sqlstm.sqhstl[0] = (unsigned int  )32;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&sy_user_id;
sqlstm.sqhstl[1] = (unsigned int  )33;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&sy_req_date;
sqlstm.sqhstl[2] = (unsigned int  )32;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&sy_machine_name;
sqlstm.sqhstl[3] = (unsigned int  )33;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&sy_ws_no;
sqlstm.sqhstl[4] = (unsigned int  )33;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&sy_rowid;
sqlstm.sqhstl[5] = (unsigned int  )33;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      if(NOT_FOUND) 
      	  return FALSE;
      else 
	  {
          sy_user_id.arr[sy_user_id.len] = '\0';
          sy_session_id.arr[sy_session_id.len] = '\0';
          sy_rowid.arr[sy_rowid.len] = '\0';
          sy_req_date.arr[sy_req_date.len] = '\0';
		  sy_machine_name.arr[sy_machine_name.len] = '\0';
		  sy_ws_no.arr[sy_ws_no.len] = '\0';
		  sy_rowid.arr[sy_rowid.len] = '\0';

   	      return TRUE;
	  }
}

fetch_sy_bg_rep_gen_req_s()
{
sy_user_id.arr[0] 		= '\0';
sy_session_id.arr[0] 	= '\0';
sy_req_date.arr[0]      = '\0';
sy_machine_name.arr[0]  = '\0';
sy_ws_no.arr[0]		    = '\0';
sy_rowid.arr[0]		    = '\0';

sy_session_id.len	    = 0;
sy_user_id.len	        = 0;
sy_req_date.len         = 0;
sy_machine_name.len     = 0;
sy_ws_no.len            = 0;
sy_rowid.len            = 0;

/* EXEC SQL SELECT
			    SESSION_ID,
				USER_ID,
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'),
				MACHINE_NAME,
				WS_NO,
				ROWID
	       INTO	
                :sy_session_id,
                :sy_user_id,
                :sy_req_date,
				:sy_machine_name,
				:sy_ws_no,
				:sy_rowid
	       FROM	SY_REPORT_GENERATE_REQUEST
	      WHERE	PGM_ID = 'RLRRSENQ'
			AND REQUEST_STATUS IS NULL
			AND NVL(URGENT_INDICATOR,' ') = 'S'
	        AND ROWNUM < 2; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 10;
sqlstm.arrsiz = 25;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDMMYYHH24M\
ISS') ,MACHINE_NAME ,WS_NO ,ROWID into :b0,:b1,:b2,:b3,:b4,:b5  from SY_REPORT\
_GENERATE_REQUEST where (((PGM_ID='RLRRSENQ' and REQUEST_STATUS is null ) and \
NVL(URGENT_INDICATOR,' ')='S') and ROWNUM<2)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )646;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)256;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&sy_session_id;
sqlstm.sqhstl[0] = (unsigned int  )32;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&sy_user_id;
sqlstm.sqhstl[1] = (unsigned int  )33;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&sy_req_date;
sqlstm.sqhstl[2] = (unsigned int  )32;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&sy_machine_name;
sqlstm.sqhstl[3] = (unsigned int  )33;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&sy_ws_no;
sqlstm.sqhstl[4] = (unsigned int  )33;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&sy_rowid;
sqlstm.sqhstl[5] = (unsigned int  )33;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      if(NOT_FOUND) 
      	  return FALSE;
      else 
	  {
          sy_user_id.arr[sy_user_id.len] = '\0';
          sy_session_id.arr[sy_session_id.len] = '\0';
          sy_rowid.arr[sy_rowid.len] = '\0';
          sy_req_date.arr[sy_req_date.len] = '\0';
		  sy_machine_name.arr[sy_machine_name.len] = '\0';
		  sy_ws_no.arr[sy_ws_no.len] = '\0';
		  sy_rowid.arr[sy_rowid.len] = '\0';

   	      return TRUE;
	  }
}

fetch_sy_bg_rep_gen_req()
{
sy_user_id.arr[0] 		= '\0';
sy_session_id.arr[0] 	= '\0';
sy_req_date.arr[0]      = '\0';
sy_machine_name.arr[0]  = '\0';
sy_ws_no.arr[0]		    = '\0';
sy_rowid.arr[0]		    = '\0';

sy_session_id.len	    = 0;
sy_user_id.len	        = 0;
sy_req_date.len         = 0;
sy_machine_name.len     = 0;
sy_ws_no.len            = 0;
sy_rowid.len            = 0;

/* EXEC SQL SELECT
			    SESSION_ID,
				USER_ID,
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'),
				MACHINE_NAME,
				WS_NO,
				ROWID
	       INTO	
                :sy_session_id,
                :sy_user_id,
                :sy_req_date,
				:sy_machine_name,
				:sy_ws_no,
				:sy_rowid
	       FROM	SY_REPORT_GENERATE_REQUEST
	      WHERE	PGM_ID = 'RLRRSENQ'
			AND REQUEST_STATUS IS NULL
			AND NVL(URGENT_INDICATOR,' ') = 'R'
	        AND ROWNUM < 2; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 10;
sqlstm.arrsiz = 25;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDMMYYHH24M\
ISS') ,MACHINE_NAME ,WS_NO ,ROWID into :b0,:b1,:b2,:b3,:b4,:b5  from SY_REPORT\
_GENERATE_REQUEST where (((PGM_ID='RLRRSENQ' and REQUEST_STATUS is null ) and \
NVL(URGENT_INDICATOR,' ')='R') and ROWNUM<2)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )685;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)256;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&sy_session_id;
sqlstm.sqhstl[0] = (unsigned int  )32;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&sy_user_id;
sqlstm.sqhstl[1] = (unsigned int  )33;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&sy_req_date;
sqlstm.sqhstl[2] = (unsigned int  )32;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&sy_machine_name;
sqlstm.sqhstl[3] = (unsigned int  )33;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&sy_ws_no;
sqlstm.sqhstl[4] = (unsigned int  )33;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&sy_rowid;
sqlstm.sqhstl[5] = (unsigned int  )33;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      if(NOT_FOUND) 
      	  return FALSE;
      else 
	  {
          sy_user_id.arr[sy_user_id.len] = '\0';
          sy_session_id.arr[sy_session_id.len] = '\0';
          sy_rowid.arr[sy_rowid.len] = '\0';
          sy_req_date.arr[sy_req_date.len] = '\0';
		  sy_machine_name.arr[sy_machine_name.len] = '\0';
		  sy_ws_no.arr[sy_ws_no.len] = '\0';
		  sy_rowid.arr[sy_rowid.len] = '\0';

   	      return TRUE;
	  }
}
/*------------------------------------------------------------*/

print_group_test_desc()
{
   int l_len = 0;
   int nctr;
   char group_result[16];
   p_print_name_yn.arr[0] = '\0';
   p_test_desc.arr[0]     = '\0';
   p_function_yn.arr[0]   = '\0';
   p_print_name_yn.len    = 0;
   p_test_desc.len        = 0;
   p_function_yn.len      = 0;

   p_significant_digit    = 0;  
   p_no_of_decimals       = 0;

   /* EXEC SQL SELECT b.LONG_DESC,NVL(a.PRINT_NAME_YN,'N'),NVL(a.FUNCTION_YN,'N'),
		   a.SIGNIFICANT_DIGIT,a.NO_OF_DECIMALS
	    INTO   :p_test_desc,:p_print_name_yn,:p_function_yn,
		   :p_significant_digit,:p_no_of_decimals
	    FROM   rl_test_code a, RL_TEST_CODE_lang_vw b
	    WHERE  a.test_code = b.test_code
		and a.TEST_CODE = :rl_tst_group_test_code
		and b.language_id = :language_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select b.LONG_DESC ,NVL(a.PRINT_NAME_YN,'N') ,NVL(a.FUNCTI\
ON_YN,'N') ,a.SIGNIFICANT_DIGIT ,a.NO_OF_DECIMALS into :b0,:b1,:b2,:b3,:b4  fr\
om rl_test_code a ,RL_TEST_CODE_lang_vw b where ((a.test_code=b.test_code and \
a.TEST_CODE=:b5) and b.language_id=:b6)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )724;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&p_test_desc;
   sqlstm.sqhstl[0] = (unsigned int  )43;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&p_print_name_yn;
   sqlstm.sqhstl[1] = (unsigned int  )4;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&p_function_yn;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&p_significant_digit;
   sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&p_no_of_decimals;
   sqlstm.sqhstl[4] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_tst_group_test_code;
   sqlstm.sqhstl[5] = (unsigned int  )13;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&language_id;
   sqlstm.sqhstl[6] = (unsigned int  )7;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   if (OERROR)
      ins_message(ORA_MESG,"Select failed on table RL_TEST_CODE in print_group_test_desc");

   p_test_desc.arr[p_test_desc.len]    ='\0';
   p_print_name_yn.arr[p_print_name_yn.len]='\0';
   p_function_yn.arr[p_function_yn.len] = '\0';

   if(p_function_yn.arr[0] == 'Y')
   {
      group_result[0] = '\0';
      calc_func_and_prn(rl_tst_group_test_code.arr,group_result);
   }
      
   l_len = strlen(p_test_desc.arr);

   if(p_print_name_yn.arr[0] == 'Y')
   {
	  fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
      //fprintf(fp,"%-40s",p_test_desc.arr);
	  fprintf(fp, "%s", p_test_desc.arr);
      fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

	  fprintf(fp, "%-*s", 41 - l_len, " ");

	  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);

	  print_html_line (p_test_desc.arr,out_str);
	  sprintf(l_html_bdy_str,"%s<td class=font_disp width=43%c><u>%s</u></td>",l_html_bdy_str,l_prtg,out_str);
	  strcpy(out_str,"");

   }

   if(p_function_yn.arr[0] == 'Y')
      if(strlen(group_result))
	  {
		/********* Numeric result is increased to 10 chrs length **/
//		 fprintf(fp,"%-5s",group_result);

		  strcpy(r_rslt.arr, group_result);
		  r_rslt.len = strlen(r_rslt.arr);
		  add_zero_after_result();
		  strcpy(group_result, r_rslt.arr);

		 fprintf(fp,"%-10.10s",group_result);

		 sprintf(in_str,"%-10.10s",group_result);
		 print_html_line (in_str,out_str);

		 if(p_print_name_yn.arr[0] == 'Y')
		  sprintf(l_html_bdy_str,"%s<td class=font_disp width=12%c>%s</td>",l_html_bdy_str,l_prtg,out_str);
		 else
		 {
		 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		 sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		 sprintf(l_html_bdy_str,"%s<td class=font_disp  width=12%c>%s</td>",l_html_bdy_str,l_prtg,out_str);
		 }
		 strcpy(out_str,"");
	  }

   if(p_print_name_yn.arr[0] == 'Y' || strlen(group_result))
   {
      fprintf(fp,"\n");
	  sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
	  write_html(fp4,l_html_bdy_str);
	  strcpy(l_html_bdy_str,"");

      page_break(1);
   }

/*********** underline is added with printing of group test description ******
   if(p_print_name_yn.arr[0] == 'Y')
   {
      for(nctr = 0; nctr < p_test_desc.len; nctr++)
          fprintf(fp,"_");
	  fprintf(fp,"\n");

      page_break(1);
   } 
**************************** upto here ************/
}
/* Calculate result for the Group Test if a function is set on it.  */
float calculate_function_result(sd,dc)
int sd; int dc;
{
return 0;
}

/*------------------------------------------------------------*/
create_lab_file_name()
{
  source_copies = 1;

  /* Referral Patients and External Patients*/
  if (rl_hdr_episode_type.arr[0] == 'R' || rl_hdr_episode_type.arr[0] == 'H')  
  {
       source_copies = sy_ref_no_of_copies + 1;
/// 11.07.2004  strcpy(rl_prn_ctrl_hdr_source_code.arr,rl_prn_ctrl_hdr_section_code.arr);

	   strcpy(rl_prn_ctrl_hdr_source_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(rl_prn_ctrl_hdr_source_code.arr,rl_prn_ctrl_hdr_section_code.arr);  /// 11.07.2004

       rl_prn_ctrl_hdr_source_code.len = strlen(rl_prn_ctrl_hdr_source_code.arr);
  }

}
/*----------------------------------------------------------*/
print_job1()
{
char er_cd[10];
char print_yn = 'Y';
int i;

if(something_to_print == 1)
{

p_uid_pwd.arr[0] = '\0';
p_print_name.arr[0] = '\0';
p_loc_code.arr[0] = '\0';
p_loc_type.arr[0] = '\0';
p_rep_file.arr[0] = '\0';
p_print_mode.arr[0] = '\0';

p_uid_pwd.len = 0;
p_print_name.len = 0;
p_loc_code.len = 0;
p_loc_type.len = 0;
p_rep_file.len = 0;
p_print_mode.len = 0;


strcpy(p_uid_pwd.arr,uid_pwd.arr);
p_uid_pwd.len = strlen(uid_pwd.arr);

strcpy(p_print_name.arr,"RLRRSENQ");
p_print_name.len = strlen(p_print_name.arr);


if(rl_print_result_sect_yn.arr[0] == 'Y')
{
   strcpy(p_loc_type.arr,"O");
   p_loc_type.len = strlen(p_loc_type.arr);

/// 11.07.2004   strcpy(p_loc_code.arr,rl_hdr_section_code.arr); 

   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
   strcat(p_loc_code.arr,rl_hdr_section_code.arr);        /// 11.07.2004

   strcat(p_loc_code.arr,rl_hdr_episode_type.arr);

/***** Newly added for Urgent samples   *******/
   if (rl_printer_for_urgent_yn.arr[0] == 'Y')
   {
		if (rl_hdr_urgent_indicator.arr[0] != 'R')
			strcat(p_loc_code.arr, "U");
   }

   p_loc_code.len = strlen(p_loc_code.arr);

}
else
{

   strcpy(p_loc_code.arr,rl_prn_ctrl_hdr_source_code.arr);
/***** Newly added for Urgent samples   *******/
   if (rl_printer_for_urgent_yn.arr[0] == 'Y')
   {
		if (rl_hdr_urgent_indicator.arr[0] != 'R')
			strcat(p_loc_code.arr, "U");
   }

   p_loc_code.len = strlen(p_loc_code.arr);
	
   l_episode = 0;

   if ( (rl_hdr_episode_type.arr[0] == 'I') ||
		(rl_hdr_episode_type.arr[0] == 'O') )
   {

		/* EXEC SQL SELECT open_episode_id
		INTO :l_episode
		FROM IP_OPEN_EPISODE
		WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
		  AND patient_id = :nd_hosp_no; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 25;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select open_episode_id into :b0  from IP_OPEN_EPISODE where\
 (FACILITY_ID=NVL(:b1,:b2) and patient_id=:b3)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )767;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_episode;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(long);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )5;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[2] = (unsigned int  )7;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_hosp_no;
  sqlstm.sqhstl[3] = (unsigned int  )23;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if(NODATAFOUND) 
		{

             if (rl_hdr_episode_type.arr[0] == 'I')
			 {
				if (strcmp(l_print_disch_pat_result.arr, "Y") == 0)
				{

			  	    print_yn = 'Y';
					strcpy(p_loc_type.arr, "W");
					p_loc_type.len = strlen(p_loc_type.arr);
					strcpy(p_loc_code.arr, rl_hdr_source_code.arr);
					p_loc_code.len = strlen(rl_hdr_source_code.arr);
				}
                else
                  print_yn = 'N';
			 }
			 else
			 {
				strcpy(p_loc_type.arr, "C");
				p_loc_type.len = strlen(p_loc_type.arr);
				print_yn = 'Y';

			 }

		}
		else
		{

			/* EXEC SQL SELECT  'W'
			INTO :p_loc_type
			FROM IP_EPISODE
			WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
			AND episode_id = :l_episode
			AND patient_id = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select 'W' into :b0  from IP_EPISODE where ((FACILITY_ID=N\
VL(:b1,:b2) and episode_id=:b3) and patient_id=:b4)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )798;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&p_loc_type;
   sqlstm.sqhstl[0] = (unsigned int  )12;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
   sqlstm.sqhstl[1] = (unsigned int  )5;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&l_episode;
   sqlstm.sqhstl[3] = (unsigned int  )sizeof(long);
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[4] = (unsigned int  )23;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




			if(NODATAFOUND)
			{
			  strcpy(p_loc_type.arr, "C");
			  p_loc_type.len = strlen(p_loc_type.arr);
			  print_yn = 'Y';

			}

		}
		
		
   }
   else
   {
	  strcpy(p_loc_type.arr,"O");
	  print_yn = 'Y';

   }

/*****
   switch(rl_hdr_source_type.arr[0])
   {
      case 'W': strcpy(p_loc_type.arr,"W");
                break;
      case 'C': strcpy(p_loc_type.arr,"C");
                break;
      case 'E': strcpy(p_loc_type.arr,"O");
                break;
   }
**********/


   p_loc_type.len = strlen(p_loc_type.arr);

}

strcpy(p_rep_file.arr,nd_f_name);
p_rep_file.len = strlen(nd_f_name);

strcpy(p_print_mode.arr,"S");
p_print_mode.len = strlen(p_print_mode.arr);


/***** ADDED ON 12/07/2004   **************/
	if (p_param8.arr[0] == 'P')
		source_copies = 1;


switch(p_param7.arr[0])
{
   case 'L' :  /*-------To cater to pulling list---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr,"L");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'X':  /*-----To cater to confidential reports----*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr,"X");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'Z':  /*-----To cater to reprinting by Patient----*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr,"Z");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'Y' :  /*-------To cater to reprint of results while registration---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr, p_param7.arr);
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'D' :  /*-------To cater for Draft Copy ---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr, p_param7.arr);
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'A' :  /*-------To print Result Report of any facility from any facility ---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004		
       strcat(p_loc_code.arr,"A");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

}

if (strcmp(rl_hdr_urgent_indicator.arr, "U") == 0)
	print_yn = 'Y';


if (print_yn == 'Y')
{

/*******************/

	get_trans_ind();

	for( i = 0; i < source_copies; i++)
	{

      if (strcmp(nd_trx_ind.arr,"Y") == 0)


					 PrintDocument
						   (
							uid_pwd.arr,					//char	*PUidPwd;
							c_session_id.arr,				//char	*PSessionID;
							nd_operating_facility_id.arr,	//char	*PFacilityID;
							"RL",							//char	*PModuleID;
							"RLRRSENQ",						//char	*PDocumentID;
							nd_file_name.arr,				//char	*POnlinePrintFileNames;
							p_loc_type.arr,					//char	*PLocationTypes;
							p_loc_code.arr,					//char	*PLocationCodes;
							1,								//int 	 PNumOfCopies;
							1,								//int 	 PPageFrom;
							9999							//int	 PPageTo;
						   );
						   

	  else



					 PrintDocument
						   (
							uid_pwd.arr,					//char	*PUidPwd;
							c_session_id.arr,				//char	*PSessionID;
							nd_operating_facility_id.arr,	//char	*PFacilityID;
							"RL",							//char	*PModuleID;
							"RLRRSENQ",						//char	*PDocumentID;
							nd_file_name.arr,				//char	*POnlinePrintFileNames;
							p_loc_type.arr,					//char	*PLocationTypes;
							"",								//char	*PLocationCodes;
							1,								//int	 PNumOfCopies;
							1,								//int	 PPageFrom;
							9999							//int	 PPageTo;
						   );
						   


	}


/*-------------	EXTRA COPY ----------------*/

	if (rl_hdr_extra_copies_to.len)
	{

		strcpy(p_print_name.arr,"RLRSENQE");
		p_print_name.len = strlen(p_print_name.arr);

		strcpy(p_loc_type.arr,"O");
		p_loc_type.len = strlen(p_loc_type.arr);

		if(rl_print_result_sect_yn.arr[0] == 'Y') 
		{
/// 11.07.2004	strcpy(p_loc_code.arr,rl_hdr_section_code.arr); 

		    strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
		    strcat(p_loc_code.arr,rl_hdr_section_code.arr);        /// 11.07.2004

			strcat(p_loc_code.arr,rl_hdr_episode_type.arr);
			p_loc_code.len = strlen(p_loc_code.arr);
		}
		else
		{
/// 11.07.2004	strcpy(p_loc_code.arr,rl_prn_ctrl_hdr_section_code.arr);

		    strcpy(p_loc_code.arr,nd_operating_facility_id.arr);			/// 11.07.2004
		    strcat(p_loc_code.arr,rl_prn_ctrl_hdr_section_code.arr);        /// 11.07.2004

			p_loc_code.len = strlen(p_loc_code.arr);

		}

		strcpy(p_rep_file.arr,nd_e_name);

//// 12.10.2003		p_rep_file.len = strlen(nd_f_name);

		p_rep_file.len = strlen(p_rep_file.arr);  //// 12.10.2003


      if (strcmp(nd_trx_ind.arr,"Y") == 0) 

					 PrintDocument
						   (
							uid_pwd.arr,					//char	*PUidPwd;
							c_session_id.arr,				//char	*PSessionID;
							nd_operating_facility_id.arr,	//char	*PFacilityID;
							"RL",							//char	*PModuleID;
							"RLRSENQE",						//char	*PDocumentID;
							nd_file_name.arr,				//char	*POnlinePrintFileNames;
							p_loc_type.arr,					//char	*PLocationTypes;
							p_loc_code.arr,					//char	*PLocationCodes;
							1,								//int	 PNumOfCopies;
							1,								//int	 PPageFrom;
							9999							//int	 PPageTo;
						   );
						   
	  else

					 PrintDocument
						   (
							uid_pwd.arr,					//char	*PUidPwd;
							c_session_id.arr,				//char	*PSessionID;
							nd_operating_facility_id.arr,	//char	*PFacilityID;
							"RL",							//char	*PModuleID;
							"RLRSENQE",						//char	*PDocumentID;
							nd_file_name.arr,				//char	*POnlinePrintFileNames;
							p_loc_type.arr,					//char	*PLocationTypes;
							"",								//char	*PLocationCodes;
							1,								//int	 PNumOfCopies;
							1,								//int	 PPageFrom;
							9999							//int	 PPageTo;
						   );
						   

		_flushall();

		if(OERROR)
			ins_message(ERR_MESG,"1.Insert Failed on SY_REPORT_PRINT_REQUEST");
	} 

  }

}

 if(OERROR)
      ins_message(ERR_MESG,"Select failed on DUAL in print_job1()");
 
}
/*----------------------------------------------------------*/
print_job()
{
char er_cd[10];
char print_yn = 'Y';
int i;

//sprintf(string_var, "To be printed   %d", something_to_print);
//disp_message(ERR_MESG, string_var);

if(something_to_print == 1)
{
p_uid_pwd.arr[0] = '\0';
p_print_name.arr[0] = '\0';
p_loc_code.arr[0] = '\0';
p_loc_type.arr[0] = '\0';
p_rep_file.arr[0] = '\0';
p_print_mode.arr[0] = '\0';

p_uid_pwd.len = 0;
p_print_name.len = 0;
p_loc_code.len = 0;
p_loc_type.len = 0;
p_rep_file.len = 0;
p_print_mode.len = 0;


strcpy(p_uid_pwd.arr,uid_pwd.arr);
p_uid_pwd.len = strlen(uid_pwd.arr);

strcpy(p_print_name.arr,"RLRRSENQ");
p_print_name.len = strlen(p_print_name.arr);

if(rl_print_result_sect_yn.arr[0] == 'Y')
{
   strcpy(p_loc_type.arr,"O");
   p_loc_type.len = strlen(p_loc_type.arr);

/// 11.07.2004   strcpy(p_loc_code.arr,rl_hdr_section_code.arr); 

   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
   strcat(p_loc_code.arr,rl_hdr_section_code.arr);        /// 11.07.2004

   strcat(p_loc_code.arr,rl_hdr_episode_type.arr);

/***** Newly added for Urgent samples   *******/
   if (rl_printer_for_urgent_yn.arr[0] == 'Y')
   {
		if (rl_hdr_urgent_indicator.arr[0] != 'R')
			strcat(p_loc_code.arr, "U");
   }

   p_loc_code.len = strlen(p_loc_code.arr); 

}
else
{
   strcpy(p_loc_code.arr,rl_prn_ctrl_hdr_source_code.arr);
/***** Newly added for Urgent samples   *******/
/************* commented on 01.09.2004
   if (rl_printer_for_urgent_yn.arr[0] == 'Y')
   {
		if (rl_hdr_urgent_indicator.arr[0] != 'R')
			strcat(p_loc_code.arr, "U");
   }
************************/

   p_loc_code.len = strlen(p_loc_code.arr);
	
   l_episode = 0;

/********** commented on 22.07.2003 to handle the ordered facility id properly

   if ( (rl_hdr_episode_type.arr[0] == 'I') ||
		(rl_hdr_episode_type.arr[0] == 'O') )
******************/

   if (( (rl_hdr_episode_type.arr[0] == 'I') ||
		(rl_hdr_episode_type.arr[0] == 'O') ) && 
		(strcmp(nd_operating_facility_id.arr, rl_ordered_facility_id.arr) == 0) ) 
		
   {
		/* EXEC SQL SELECT open_episode_id
		INTO :l_episode
		FROM IP_OPEN_EPISODE
		WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
		  AND patient_id = :nd_hosp_no; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 25;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select open_episode_id into :b0  from IP_OPEN_EPISODE where\
 (FACILITY_ID=NVL(:b1,:b2) and patient_id=:b3)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )833;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_episode;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(long);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )5;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[2] = (unsigned int  )7;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_hosp_no;
  sqlstm.sqhstl[3] = (unsigned int  )23;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if(NODATAFOUND)
		{

             if (rl_hdr_episode_type.arr[0] == 'I')
			 {
				if (strcmp(l_print_disch_pat_result.arr, "Y") == 0)
				{

			  	    print_yn = 'Y';
					strcpy(p_loc_type.arr, "W");
					p_loc_type.len = strlen(p_loc_type.arr);
					strcpy(p_loc_code.arr, rl_hdr_source_code.arr);
					p_loc_code.len = strlen(rl_hdr_source_code.arr);
				}
                else
                  print_yn = 'N';
			 }
			 else
			 {
				strcpy(p_loc_type.arr, "C");
				p_loc_type.len = strlen(p_loc_type.arr);
				print_yn = 'Y';

			 }

		}
		else
		{

			/* EXEC SQL SELECT  'W'
			INTO :p_loc_type
			FROM IP_EPISODE
			WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
			AND episode_id = :l_episode
			AND patient_id = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select 'W' into :b0  from IP_EPISODE where ((FACILITY_ID=N\
VL(:b1,:b2) and episode_id=:b3) and patient_id=:b4)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )864;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&p_loc_type;
   sqlstm.sqhstl[0] = (unsigned int  )12;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
   sqlstm.sqhstl[1] = (unsigned int  )5;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&l_episode;
   sqlstm.sqhstl[3] = (unsigned int  )sizeof(long);
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[4] = (unsigned int  )23;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




			if(NODATAFOUND)
			{
			  strcpy(p_loc_type.arr, "C");
			  p_loc_type.len = strlen(p_loc_type.arr);
			  print_yn = 'Y';

			}

		}
		
   }
   else
   {
	  strcpy(p_loc_type.arr,"O");
	  print_yn = 'Y';

   }

/*****
   switch(rl_hdr_source_type.arr[0])
   {
      case 'W': strcpy(p_loc_type.arr,"W");
                break;
      case 'C': strcpy(p_loc_type.arr,"C");
                break;
      case 'E': strcpy(p_loc_type.arr,"O");
                break;
   }
**********/


   p_loc_type.len = strlen(p_loc_type.arr);

}

strcpy(p_rep_file.arr,nd_f_name);
p_rep_file.len = strlen(nd_f_name);

strcpy(p_print_mode.arr,"S");
p_print_mode.len = strlen(p_print_mode.arr);

/***** ADDED ON 12/07/2004   **************/
	if (p_param8.arr[0] == 'P')
		source_copies = 1;

switch(p_param7.arr[0])
{
   case 'L' :  /*-------To cater to pulling list---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004		
       strcat(p_loc_code.arr,"L");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'X':  /*-----To cater to confidential reports----*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr,"X");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'Z':  /*-----To cater to reprinting by Patient----*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr,"Z");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'Y' :  /*-------To cater to reprint of results while registration---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr, p_param7.arr);
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

	case 'D' :  /*-------To cater for Draft Copy ---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
       strcat(p_loc_code.arr, p_param7.arr);
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

   case 'A' :  /*-------To print Result Report of any facility from any facility ---------*/

       source_copies = 1;
       rl_hdr_extra_copies_to.arr[0] = '\0';
       rl_hdr_extra_copies_to.len = 0;

       strcpy(p_loc_type.arr,"O");
       p_loc_type.len = strlen(p_loc_type.arr);

	   strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004		
       strcat(p_loc_code.arr,"A");
       p_loc_code.len = strlen(p_loc_code.arr);

	   break;

}

if (strcmp(rl_hdr_urgent_indicator.arr, "U") == 0)
	print_yn = 'Y';

  if(strcmp(p_param7.arr,"D") == 0 || strcmp(p_param8.arr,"P") != 0)	
	if (strcmp(nd_hosp_no.arr,d_screen_donor_id.arr) == 0 || 
								strcmp(nd_hosp_no.arr,d_screen_patient_id.arr) == 0)
    {
		print_yn = 'N';     ///// 10.04.2006

	}


if (print_yn == 'Y')
{

//    check_for_print_destn_type();

	for( i = 0; i < source_copies; i++)
	{
	 if (l_destn_rep_yn == 'Y')		
	 {
			 /* EXEC SQL
				  INSERT INTO SY_REPORT_PRINT_REQUEST
				  (OPERATING_FACILITY_ID,USER_ID,MACHINE_NAME,WS_NO,MODULE_ID,
				   ONLINE_PRINT_NAME,
				   DEST_LOCN_TYPE,DEST_LOCN_CODE,ONLINE_PRINT_FILE_NAME,
				   PRINT_MODE,REQUEST_DATE,PROCESS_TYPE,PRINT_IMMEDIATE_YN,
				   PRINT_PRIORITY,SELECTION_CRITERIA,PRINT_SERVER_ID,
				   PRINTER_NAME,DEST_QUEUE_NAME   //////// added on 21.08.2005
				  )
				  VALUES
				  (NVL(:rl_ordered_facility_id, :nd_operating_facility_id),:sy_user_id,:sy_machine_name,:sy_ws_no,'RL','RLRRSENQ',
				   :p_loc_type,:p_loc_code,:p_rep_file,'S',SYSDATE,'S',
				   'Y',DECODE(:rl_hdr_urgent_indicator,'U','1','S','1','3'),
				   substr('Specimen No:'||:rl_prn_ctrl_hdr_sp_no||' Source:'||:rl_prn_ctrl_hdr_source_code,1,250),
				   :p_print_id,:p_printer_name,:p_dest_queue_name
				  ); */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 25;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "insert into SY_REPORT_PRINT_REQUEST (OPERATING_FACILITY_I\
D,USER_ID,MACHINE_NAME,WS_NO,MODULE_ID,ONLINE_PRINT_NAME,DEST_LOCN_TYPE,DEST_L\
OCN_CODE,ONLINE_PRINT_FILE_NAME,PRINT_MODE,REQUEST_DATE,PROCESS_TYPE,PRINT_IMM\
EDIATE_YN,PRINT_PRIORITY,SELECTION_CRITERIA,PRINT_SERVER_ID,PRINTER_NAME,DEST_\
QUEUE_NAME) values (NVL(:b0,:b1),:b2,:b3,:b4,'RL','RLRRSENQ',:b5,:b6,:b7,'S',S\
YSDATE,'S','Y',DECODE(:b8,'U','1','S','1','3'),substr(((('Specimen No:'||:b9)|\
|' Source:')||:b10),1,250),:b11,:b12,:b13)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )899;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_ordered_facility_id;
    sqlstm.sqhstl[0] = (unsigned int  )5;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )7;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&sy_user_id;
    sqlstm.sqhstl[2] = (unsigned int  )33;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&sy_machine_name;
    sqlstm.sqhstl[3] = (unsigned int  )33;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&sy_ws_no;
    sqlstm.sqhstl[4] = (unsigned int  )33;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&p_loc_type;
    sqlstm.sqhstl[5] = (unsigned int  )12;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&p_loc_code;
    sqlstm.sqhstl[6] = (unsigned int  )102;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&p_rep_file;
    sqlstm.sqhstl[7] = (unsigned int  )153;
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqhstv[8] = (         void  *)&rl_hdr_urgent_indicator;
    sqlstm.sqhstl[8] = (unsigned int  )4;
    sqlstm.sqhsts[8] = (         int  )0;
    sqlstm.sqindv[8] = (         void  *)0;
    sqlstm.sqinds[8] = (         int  )0;
    sqlstm.sqharm[8] = (unsigned int  )0;
    sqlstm.sqadto[8] = (unsigned short )0;
    sqlstm.sqtdso[8] = (unsigned short )0;
    sqlstm.sqhstv[9] = (         void  *)&rl_prn_ctrl_hdr_sp_no;
    sqlstm.sqhstl[9] = (unsigned int  )23;
    sqlstm.sqhsts[9] = (         int  )0;
    sqlstm.sqindv[9] = (         void  *)0;
    sqlstm.sqinds[9] = (         int  )0;
    sqlstm.sqharm[9] = (unsigned int  )0;
    sqlstm.sqadto[9] = (unsigned short )0;
    sqlstm.sqtdso[9] = (unsigned short )0;
    sqlstm.sqhstv[10] = (         void  *)&rl_prn_ctrl_hdr_source_code;
    sqlstm.sqhstl[10] = (unsigned int  )13;
    sqlstm.sqhsts[10] = (         int  )0;
    sqlstm.sqindv[10] = (         void  *)0;
    sqlstm.sqinds[10] = (         int  )0;
    sqlstm.sqharm[10] = (unsigned int  )0;
    sqlstm.sqadto[10] = (unsigned short )0;
    sqlstm.sqtdso[10] = (unsigned short )0;
    sqlstm.sqhstv[11] = (         void  *)&p_print_id;
    sqlstm.sqhstl[11] = (unsigned int  )32;
    sqlstm.sqhsts[11] = (         int  )0;
    sqlstm.sqindv[11] = (         void  *)0;
    sqlstm.sqinds[11] = (         int  )0;
    sqlstm.sqharm[11] = (unsigned int  )0;
    sqlstm.sqadto[11] = (unsigned short )0;
    sqlstm.sqtdso[11] = (unsigned short )0;
    sqlstm.sqhstv[12] = (         void  *)&p_printer_name;
    sqlstm.sqhstl[12] = (unsigned int  )102;
    sqlstm.sqhsts[12] = (         int  )0;
    sqlstm.sqindv[12] = (         void  *)0;
    sqlstm.sqinds[12] = (         int  )0;
    sqlstm.sqharm[12] = (unsigned int  )0;
    sqlstm.sqadto[12] = (unsigned short )0;
    sqlstm.sqtdso[12] = (unsigned short )0;
    sqlstm.sqhstv[13] = (         void  *)&p_dest_queue_name;
    sqlstm.sqhstl[13] = (unsigned int  )102;
    sqlstm.sqhsts[13] = (         int  )0;
    sqlstm.sqindv[13] = (         void  *)0;
    sqlstm.sqinds[13] = (         int  )0;
    sqlstm.sqharm[13] = (unsigned int  )0;
    sqlstm.sqadto[13] = (unsigned short )0;
    sqlstm.sqtdso[13] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if(OERROR)
			ins_message(ERR_MESG,"2.Insert Failed on SY_REPORT_PRINT_REQUEST");

	 }

/************************************* added on 16.05.2004 ************************/
	if (strcmp(draft_printing_yn.arr, "N") == 0)
	{
		 if (l_destn_fax_yn == 'Y' || l_destn_mail_yn == 'Y')		
		{

			//// insert to fax table SM_REPORT_FAX_MAIL_REQUEST
					
				 if (l_destn_rep_yn == 'Y')	 
				 {

					/// copy the .LIS file from WORKING_DIR to FAX directory 

					 l_command_line.arr[0]   = '\0';   
					 l_command_line.len      = 0;

					strcpy(l_command_line.arr, "COPY ");
					strcat(l_command_line.arr, nd_file_name.arr);
					strcat(l_command_line.arr, " ");
					strcat(l_command_line.arr, p_rep_file_fax.arr);

				    l_command_line.len = strlen(l_command_line.arr);

					_flushall;

				//	_spawnlp(_P_WAIT, "CMD", l_command_line.arr, NULL);
					
				//  WinExec(l_command_line, SW_SHOWNORMAL);	        

					system(l_command_line.arr);
					
				 }   

				 get_dest_type_n_locn();  /// 02.09.2004

				 strcpy(p_rep_file.arr,p_rep_file_fax.arr);	
				 p_rep_file.len = strlen(p_rep_file.arr);


				 if (l_destn_fax_yn == 'Y')		
		        {	
				     if(p_fax_address.len)
					 {
					    strcpy(p_fax_loc_type.arr,"@");
						strcpy(p_fax_loc_code.arr,"@");
						p_fax_loc_type.len = strlen(p_fax_loc_type.arr);
						p_fax_loc_code.len = strlen(p_fax_loc_code.arr);
					 }
					 /* EXEC SQL EXECUTE 
						  begin
							declare
							   l_error_text			VARCHAR2(200); 
							   l_report_priority    VARCHAR2(10);
							begin
							    SELECT DECODE(:rl_hdr_urgent_indicator,'R','N','H')
								INTO   l_report_priority
								FROM   DUAL; 
/o***********16.01.2006 ***************
								appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
															'RL',					
															'RLRRSENQ',				
															:p_fax_loc_type,		
															:p_fax_loc_code,  		
															 NULL,																 
															 NULL,														 
															 NULL,																 
															 NULL,																	 
															 NULL,																	 
															 l_report_priority,											           
															'F',             		
															:p_rep_file,			
															:sy_user_id,  			
															:sy_ws_no,    			
															:p_fax_id,		  			
															l_error_text 			
														  );
**********************************************************************o/
								appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
															'RL',					
															'RLRRSENQ',				
															:p_fax_loc_type,		
															:p_fax_loc_code,  		
															:p_fax_address,																 
															 NULL,     // p_fax_mail_cc_address
															 NULL,     // p_fax_mail_bcc_address
															 NULL,	   // p_subject	
															 NULL,	   // p_salutation
															 NULL,	   // p_body
															 NULL,	   // p_footer
															 l_report_priority,	
															:p_fax_to_rcpt_name,										           
															:p_fax_to_comp_name,
															:p_fax_to_phone_no,
															:sy_acc_entity_name,  // p_from_user_name
															:sy_tel_num,          // p_from_phone_number
															:sy_fax_num,           // p_from_fax_number
															'F',             		
															:p_rep_file,			
															:sy_user_id,  			
															:sy_ws_no,    			
															:p_fax_id,		  			
															l_error_text 			
														  );

							end;
						  end;
					 END-EXEC; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 25;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "begin declare l_error_text VARCHAR2 ( 200 ) ; l_report_\
priority VARCHAR2 ( 10 ) ; begin SELECT DECODE ( :rl_hdr_urgent_indicator , 'R\
' , 'N' , 'H' ) INTO l_report_priority FROM DUAL ; appfaxmail . fax_mail_repor\
t ( NVL ( :rl_ordered_facility_id , :nd_operating_facility_id ) , 'RL' , 'RLRR\
SENQ' , :p_fax_loc_type , :p_fax_loc_code , :p_fax_address , NULL , NULL , NUL\
L , NULL , NULL , NULL , l_report_priority , :p_fax_to_rcpt_name , :p_fax_to_c\
omp_name , :p_fax_to_phone_no , :sy_acc_entity_name , :sy_tel_num , :sy_fax_nu\
m , 'F' , :p_rep_file , :sy_user_id , :sy_ws_no , :p_fax_id , l_error_text ) ;\
 end ; end ;";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )970;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_hdr_urgent_indicator;
      sqlstm.sqhstl[0] = (unsigned int  )4;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
      sqlstm.sqhstl[1] = (unsigned int  )5;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
      sqlstm.sqhstl[2] = (unsigned int  )7;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&p_fax_loc_type;
      sqlstm.sqhstl[3] = (unsigned int  )12;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&p_fax_loc_code;
      sqlstm.sqhstl[4] = (unsigned int  )102;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqhstv[5] = (         void  *)&p_fax_address;
      sqlstm.sqhstl[5] = (unsigned int  )102;
      sqlstm.sqhsts[5] = (         int  )0;
      sqlstm.sqindv[5] = (         void  *)0;
      sqlstm.sqinds[5] = (         int  )0;
      sqlstm.sqharm[5] = (unsigned int  )0;
      sqlstm.sqadto[5] = (unsigned short )0;
      sqlstm.sqtdso[5] = (unsigned short )0;
      sqlstm.sqhstv[6] = (         void  *)&p_fax_to_rcpt_name;
      sqlstm.sqhstl[6] = (unsigned int  )502;
      sqlstm.sqhsts[6] = (         int  )0;
      sqlstm.sqindv[6] = (         void  *)0;
      sqlstm.sqinds[6] = (         int  )0;
      sqlstm.sqharm[6] = (unsigned int  )0;
      sqlstm.sqadto[6] = (unsigned short )0;
      sqlstm.sqtdso[6] = (unsigned short )0;
      sqlstm.sqhstv[7] = (         void  *)&p_fax_to_comp_name;
      sqlstm.sqhstl[7] = (unsigned int  )502;
      sqlstm.sqhsts[7] = (         int  )0;
      sqlstm.sqindv[7] = (         void  *)0;
      sqlstm.sqinds[7] = (         int  )0;
      sqlstm.sqharm[7] = (unsigned int  )0;
      sqlstm.sqadto[7] = (unsigned short )0;
      sqlstm.sqtdso[7] = (unsigned short )0;
      sqlstm.sqhstv[8] = (         void  *)&p_fax_to_phone_no;
      sqlstm.sqhstl[8] = (unsigned int  )102;
      sqlstm.sqhsts[8] = (         int  )0;
      sqlstm.sqindv[8] = (         void  *)0;
      sqlstm.sqinds[8] = (         int  )0;
      sqlstm.sqharm[8] = (unsigned int  )0;
      sqlstm.sqadto[8] = (unsigned short )0;
      sqlstm.sqtdso[8] = (unsigned short )0;
      sqlstm.sqhstv[9] = (         void  *)&sy_acc_entity_name;
      sqlstm.sqhstl[9] = (unsigned int  )302;
      sqlstm.sqhsts[9] = (         int  )0;
      sqlstm.sqindv[9] = (         void  *)0;
      sqlstm.sqinds[9] = (         int  )0;
      sqlstm.sqharm[9] = (unsigned int  )0;
      sqlstm.sqadto[9] = (unsigned short )0;
      sqlstm.sqtdso[9] = (unsigned short )0;
      sqlstm.sqhstv[10] = (         void  *)&sy_tel_num;
      sqlstm.sqhstl[10] = (unsigned int  )23;
      sqlstm.sqhsts[10] = (         int  )0;
      sqlstm.sqindv[10] = (         void  *)0;
      sqlstm.sqinds[10] = (         int  )0;
      sqlstm.sqharm[10] = (unsigned int  )0;
      sqlstm.sqadto[10] = (unsigned short )0;
      sqlstm.sqtdso[10] = (unsigned short )0;
      sqlstm.sqhstv[11] = (         void  *)&sy_fax_num;
      sqlstm.sqhstl[11] = (unsigned int  )23;
      sqlstm.sqhsts[11] = (         int  )0;
      sqlstm.sqindv[11] = (         void  *)0;
      sqlstm.sqinds[11] = (         int  )0;
      sqlstm.sqharm[11] = (unsigned int  )0;
      sqlstm.sqadto[11] = (unsigned short )0;
      sqlstm.sqtdso[11] = (unsigned short )0;
      sqlstm.sqhstv[12] = (         void  *)&p_rep_file;
      sqlstm.sqhstl[12] = (unsigned int  )153;
      sqlstm.sqhsts[12] = (         int  )0;
      sqlstm.sqindv[12] = (         void  *)0;
      sqlstm.sqinds[12] = (         int  )0;
      sqlstm.sqharm[12] = (unsigned int  )0;
      sqlstm.sqadto[12] = (unsigned short )0;
      sqlstm.sqtdso[12] = (unsigned short )0;
      sqlstm.sqhstv[13] = (         void  *)&sy_user_id;
      sqlstm.sqhstl[13] = (unsigned int  )33;
      sqlstm.sqhsts[13] = (         int  )0;
      sqlstm.sqindv[13] = (         void  *)0;
      sqlstm.sqinds[13] = (         int  )0;
      sqlstm.sqharm[13] = (unsigned int  )0;
      sqlstm.sqadto[13] = (unsigned short )0;
      sqlstm.sqtdso[13] = (unsigned short )0;
      sqlstm.sqhstv[14] = (         void  *)&sy_ws_no;
      sqlstm.sqhstl[14] = (unsigned int  )33;
      sqlstm.sqhsts[14] = (         int  )0;
      sqlstm.sqindv[14] = (         void  *)0;
      sqlstm.sqinds[14] = (         int  )0;
      sqlstm.sqharm[14] = (unsigned int  )0;
      sqlstm.sqadto[14] = (unsigned short )0;
      sqlstm.sqtdso[14] = (unsigned short )0;
      sqlstm.sqhstv[15] = (         void  *)&p_fax_id;
      sqlstm.sqhstl[15] = (unsigned int  )32;
      sqlstm.sqhsts[15] = (         int  )0;
      sqlstm.sqindv[15] = (         void  *)0;
      sqlstm.sqinds[15] = (         int  )0;
      sqlstm.sqharm[15] = (unsigned int  )0;
      sqlstm.sqadto[15] = (unsigned short )0;
      sqlstm.sqtdso[15] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					 
				 }

				if(OERROR)
					ins_message(ERR_MESG,"1.Insert Failed on SM_REPORT_FAX_MAIL_REQUEST for Fax");


				 if (l_destn_mail_yn == 'Y')		
		         {	

				     get_mail_body_oth_dtls();
					 if(p_mail_address.len)
					 {
					    strcpy(p_mail_loc_type.arr,"@");
						strcpy(p_mail_loc_code.arr,"@");
						p_mail_loc_type.len = strlen(p_mail_loc_type.arr);
						p_mail_loc_code.len = strlen(p_mail_loc_code.arr);
					 }

					 /* EXEC SQL EXECUTE 
						  begin
							declare
							   l_error_text			VARCHAR2(200);
							   l_report_priority    VARCHAR2(10);
							begin

							    SELECT DECODE(:rl_hdr_urgent_indicator,'R','N','H')
								INTO   l_report_priority
								FROM   DUAL;
/o***********16.01.2006 ********
								appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
															'RL',					
															'RLRRSENQ',				
															:p_mail_loc_type,		
															:p_mail_loc_code,  		
															 NULL,																	 
															 NULL,															 
															 NULL,																	 
															 NULL,																		 
															 NULL,																		 
															 l_report_priority,												           
															'M',             		
															:p_rep_file,			
															:sy_user_id,  			
															:sy_ws_no,    			
															:p_mail_id,		  			
															l_error_text 			
														  );
***********************************************************************o/
//insert into rl_error values('RLRRSENQ',:p_mail_address,'b4 call appfaxmail..specno='||:rl_prn_ctrl_hdr_sp_no);
								appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
															'RL',					
															'RLRRSENQ',				
															:p_mail_loc_type,		
															:p_mail_loc_code,  		
															:p_mail_address,																	 
															 NULL,			/// p_fax_mail_cc_address
															 NULL,		   ///  p_mail_bcc_address
															substr(:d_mail_subject,1,200),
															substr(:d_mail_salutation,1,100),
															substr(:d_mail_body,1,4000),
															substr(:d_mail_footer,1,1000),
															 l_report_priority,	
															 NULL,        /// p_to_reciepient_name
															 NULL,        /// p_to_company_name
															 NULL,        /// p_to_phone_number
															 NULL,        /// p_from_user_name
															 NULL,        /// p_from_phone_number
															 NULL,        /// p_from_fax_number
															'M', 
															:p_rep_file,
															:sy_user_id,
															:sy_ws_no,
															:p_mail_id,
															l_error_text 
														  );
//insert into rl_error values('RLRRSENQ',:p_mail_address,'after call appfaxmail..specno='||:rl_prn_ctrl_hdr_sp_no||',errortext='||substr(l_error_text,1,20));
							end;
						  end;
					 END-EXEC; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 25;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "begin declare l_error_text VARCHAR2 ( 200 ) ; l_report_\
priority VARCHAR2 ( 10 ) ; begin SELECT DECODE ( :rl_hdr_urgent_indicator , 'R\
' , 'N' , 'H' ) INTO l_report_priority FROM DUAL ; appfaxmail . fax_mail_repor\
t ( NVL ( :rl_ordered_facility_id , :nd_operating_facility_id ) , 'RL' , 'RLRR\
SENQ' , :p_mail_loc_type , :p_mail_loc_code , :p_mail_address , NULL , NULL , \
substr ( :d_mail_subject , 1 , 200 ) , substr ( :d_mail_salutation , 1 , 100 )\
 , substr ( :d_mail_body , 1 , 4000 ) , substr ( :d_mail_footer , 1 , 1000 ) ,\
 l_report_priority , NULL , NULL , NULL , NULL , NULL , NULL , 'M' , :p_rep_fi\
le , :sy_user_id , :sy_ws_no , :p_mail_id , l_error_text ) ; end ; end ;";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )1049;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_hdr_urgent_indicator;
      sqlstm.sqhstl[0] = (unsigned int  )4;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
      sqlstm.sqhstl[1] = (unsigned int  )5;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
      sqlstm.sqhstl[2] = (unsigned int  )7;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&p_mail_loc_type;
      sqlstm.sqhstl[3] = (unsigned int  )12;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&p_mail_loc_code;
      sqlstm.sqhstl[4] = (unsigned int  )102;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqhstv[5] = (         void  *)&p_mail_address;
      sqlstm.sqhstl[5] = (unsigned int  )102;
      sqlstm.sqhsts[5] = (         int  )0;
      sqlstm.sqindv[5] = (         void  *)0;
      sqlstm.sqinds[5] = (         int  )0;
      sqlstm.sqharm[5] = (unsigned int  )0;
      sqlstm.sqadto[5] = (unsigned short )0;
      sqlstm.sqtdso[5] = (unsigned short )0;
      sqlstm.sqhstv[6] = (         void  *)&d_mail_subject;
      sqlstm.sqhstl[6] = (unsigned int  )2003;
      sqlstm.sqhsts[6] = (         int  )0;
      sqlstm.sqindv[6] = (         void  *)0;
      sqlstm.sqinds[6] = (         int  )0;
      sqlstm.sqharm[6] = (unsigned int  )0;
      sqlstm.sqadto[6] = (unsigned short )0;
      sqlstm.sqtdso[6] = (unsigned short )0;
      sqlstm.sqhstv[7] = (         void  *)&d_mail_salutation;
      sqlstm.sqhstl[7] = (unsigned int  )4003;
      sqlstm.sqhsts[7] = (         int  )0;
      sqlstm.sqindv[7] = (         void  *)0;
      sqlstm.sqinds[7] = (         int  )0;
      sqlstm.sqharm[7] = (unsigned int  )0;
      sqlstm.sqadto[7] = (unsigned short )0;
      sqlstm.sqtdso[7] = (unsigned short )0;
      sqlstm.sqhstv[8] = (         void  *)&d_mail_body;
      sqlstm.sqhstl[8] = (unsigned int  )4003;
      sqlstm.sqhsts[8] = (         int  )0;
      sqlstm.sqindv[8] = (         void  *)0;
      sqlstm.sqinds[8] = (         int  )0;
      sqlstm.sqharm[8] = (unsigned int  )0;
      sqlstm.sqadto[8] = (unsigned short )0;
      sqlstm.sqtdso[8] = (unsigned short )0;
      sqlstm.sqhstv[9] = (         void  *)&d_mail_footer;
      sqlstm.sqhstl[9] = (unsigned int  )2003;
      sqlstm.sqhsts[9] = (         int  )0;
      sqlstm.sqindv[9] = (         void  *)0;
      sqlstm.sqinds[9] = (         int  )0;
      sqlstm.sqharm[9] = (unsigned int  )0;
      sqlstm.sqadto[9] = (unsigned short )0;
      sqlstm.sqtdso[9] = (unsigned short )0;
      sqlstm.sqhstv[10] = (         void  *)&p_rep_file;
      sqlstm.sqhstl[10] = (unsigned int  )153;
      sqlstm.sqhsts[10] = (         int  )0;
      sqlstm.sqindv[10] = (         void  *)0;
      sqlstm.sqinds[10] = (         int  )0;
      sqlstm.sqharm[10] = (unsigned int  )0;
      sqlstm.sqadto[10] = (unsigned short )0;
      sqlstm.sqtdso[10] = (unsigned short )0;
      sqlstm.sqhstv[11] = (         void  *)&sy_user_id;
      sqlstm.sqhstl[11] = (unsigned int  )33;
      sqlstm.sqhsts[11] = (         int  )0;
      sqlstm.sqindv[11] = (         void  *)0;
      sqlstm.sqinds[11] = (         int  )0;
      sqlstm.sqharm[11] = (unsigned int  )0;
      sqlstm.sqadto[11] = (unsigned short )0;
      sqlstm.sqtdso[11] = (unsigned short )0;
      sqlstm.sqhstv[12] = (         void  *)&sy_ws_no;
      sqlstm.sqhstl[12] = (unsigned int  )33;
      sqlstm.sqhsts[12] = (         int  )0;
      sqlstm.sqindv[12] = (         void  *)0;
      sqlstm.sqinds[12] = (         int  )0;
      sqlstm.sqharm[12] = (unsigned int  )0;
      sqlstm.sqadto[12] = (unsigned short )0;
      sqlstm.sqtdso[12] = (unsigned short )0;
      sqlstm.sqhstv[13] = (         void  *)&p_mail_id;
      sqlstm.sqhstl[13] = (unsigned int  )32;
      sqlstm.sqhsts[13] = (         int  )0;
      sqlstm.sqindv[13] = (         void  *)0;
      sqlstm.sqinds[13] = (         int  )0;
      sqlstm.sqharm[13] = (unsigned int  )0;
      sqlstm.sqadto[13] = (unsigned short )0;
      sqlstm.sqtdso[13] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				  }


				if(OERROR)
					ins_message(ERR_MESG,"1.Insert Failed on SM_REPORT_FAX_MAIL_REQUEST for Mail");

	 }
    }
/************************ upto here added on 16.05.2004 ***********************/

		_flushall();


	}

/*-------------	EXTRA COPY ----------------*/
  if (strcmp(draft_printing_yn.arr, "N") == 0)
  {
	if (rl_hdr_extra_copies_to.len)
	{

		strcpy(p_print_name.arr,"RLRSENQE");
		p_print_name.len = strlen(p_print_name.arr);

		strcpy(p_loc_type.arr,"O");
		p_loc_type.len = strlen(p_loc_type.arr);

		if(rl_print_result_sect_yn.arr[0] == 'Y')
		{
/// 11.07.2004 strcpy(p_loc_code.arr,rl_hdr_section_code.arr); 

			strcpy(p_loc_code.arr,nd_operating_facility_id.arr);   /// 11.07.2004
			strcat(p_loc_code.arr,rl_hdr_section_code.arr);        /// 11.07.2004


			strcat(p_loc_code.arr,rl_hdr_episode_type.arr); 
			p_loc_code.len = strlen(p_loc_code.arr);
		}
		else
		{
/// 11.07.2004 strcpy(p_loc_code.arr,rl_prn_ctrl_hdr_section_code.arr);

			strcpy(p_loc_code.arr,nd_operating_facility_id.arr);			 /// 11.07.2004
			strcat(p_loc_code.arr,rl_prn_ctrl_hdr_section_code.arr);        /// 11.07.2004


			p_loc_code.len = strlen(p_loc_code.arr);
		}

		strcpy(p_rep_file.arr,nd_e_name);

/// 12.10.2003		p_rep_file.len = strlen(nd_f_name); 

		p_rep_file.len = strlen(p_rep_file.arr);  /// 12.10.2003

	
	   if (l_destn_rep_yn == 'Y')		
	   {	
		/* EXEC SQL
			  INSERT INTO SY_REPORT_PRINT_REQUEST
				  (OPERATING_FACILITY_ID,USER_ID,MACHINE_NAME,WS_NO,MODULE_ID,
				   ONLINE_PRINT_NAME,DEST_LOCN_TYPE,DEST_LOCN_CODE,ONLINE_PRINT_FILE_NAME,
					PRINT_MODE,REQUEST_DATE,PROCESS_TYPE,PRINT_IMMEDIATE_YN,
					PRINT_PRIORITY,SELECTION_CRITERIA,
					PRINT_SERVER_ID,PRINTER_NAME,DEST_QUEUE_NAME    //// 21.08.2005
					)
				VALUES
					(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),:sy_user_id,:sy_machine_name,:sy_ws_no,'RL','RLRSENQE',
					:p_loc_type,:p_loc_code,:p_rep_file,'S',SYSDATE,'S',
					'Y',DECODE(:rl_hdr_urgent_indicator,'U','1','S','1','3'),
					substr('Specimen No:'||:rl_prn_ctrl_hdr_sp_no||' Source:'||:rl_prn_ctrl_hdr_source_code,1,250),
					:p_print_id,:p_printer_name,:p_dest_queue_name
					); */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 25;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "insert into SY_REPORT_PRINT_REQUEST (OPERATING_FACILITY_ID,\
USER_ID,MACHINE_NAME,WS_NO,MODULE_ID,ONLINE_PRINT_NAME,DEST_LOCN_TYPE,DEST_LOC\
N_CODE,ONLINE_PRINT_FILE_NAME,PRINT_MODE,REQUEST_DATE,PROCESS_TYPE,PRINT_IMMED\
IATE_YN,PRINT_PRIORITY,SELECTION_CRITERIA,PRINT_SERVER_ID,PRINTER_NAME,DEST_QU\
EUE_NAME) values (NVL(:b0,:b1),:b2,:b3,:b4,'RL','RLRSENQE',:b5,:b6,:b7,'S',SYS\
DATE,'S','Y',DECODE(:b8,'U','1','S','1','3'),substr(((('Specimen No:'||:b9)||'\
 Source:')||:b10),1,250),:b11,:b12,:b13)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )1120;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&rl_ordered_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )5;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )7;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&sy_user_id;
  sqlstm.sqhstl[2] = (unsigned int  )33;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&sy_machine_name;
  sqlstm.sqhstl[3] = (unsigned int  )33;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&sy_ws_no;
  sqlstm.sqhstl[4] = (unsigned int  )33;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&p_loc_type;
  sqlstm.sqhstl[5] = (unsigned int  )12;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&p_loc_code;
  sqlstm.sqhstl[6] = (unsigned int  )102;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&p_rep_file;
  sqlstm.sqhstl[7] = (unsigned int  )153;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqhstv[8] = (         void  *)&rl_hdr_urgent_indicator;
  sqlstm.sqhstl[8] = (unsigned int  )4;
  sqlstm.sqhsts[8] = (         int  )0;
  sqlstm.sqindv[8] = (         void  *)0;
  sqlstm.sqinds[8] = (         int  )0;
  sqlstm.sqharm[8] = (unsigned int  )0;
  sqlstm.sqadto[8] = (unsigned short )0;
  sqlstm.sqtdso[8] = (unsigned short )0;
  sqlstm.sqhstv[9] = (         void  *)&rl_prn_ctrl_hdr_sp_no;
  sqlstm.sqhstl[9] = (unsigned int  )23;
  sqlstm.sqhsts[9] = (         int  )0;
  sqlstm.sqindv[9] = (         void  *)0;
  sqlstm.sqinds[9] = (         int  )0;
  sqlstm.sqharm[9] = (unsigned int  )0;
  sqlstm.sqadto[9] = (unsigned short )0;
  sqlstm.sqtdso[9] = (unsigned short )0;
  sqlstm.sqhstv[10] = (         void  *)&rl_prn_ctrl_hdr_source_code;
  sqlstm.sqhstl[10] = (unsigned int  )13;
  sqlstm.sqhsts[10] = (         int  )0;
  sqlstm.sqindv[10] = (         void  *)0;
  sqlstm.sqinds[10] = (         int  )0;
  sqlstm.sqharm[10] = (unsigned int  )0;
  sqlstm.sqadto[10] = (unsigned short )0;
  sqlstm.sqtdso[10] = (unsigned short )0;
  sqlstm.sqhstv[11] = (         void  *)&p_print_id;
  sqlstm.sqhstl[11] = (unsigned int  )32;
  sqlstm.sqhsts[11] = (         int  )0;
  sqlstm.sqindv[11] = (         void  *)0;
  sqlstm.sqinds[11] = (         int  )0;
  sqlstm.sqharm[11] = (unsigned int  )0;
  sqlstm.sqadto[11] = (unsigned short )0;
  sqlstm.sqtdso[11] = (unsigned short )0;
  sqlstm.sqhstv[12] = (         void  *)&p_printer_name;
  sqlstm.sqhstl[12] = (unsigned int  )102;
  sqlstm.sqhsts[12] = (         int  )0;
  sqlstm.sqindv[12] = (         void  *)0;
  sqlstm.sqinds[12] = (         int  )0;
  sqlstm.sqharm[12] = (unsigned int  )0;
  sqlstm.sqadto[12] = (unsigned short )0;
  sqlstm.sqtdso[12] = (unsigned short )0;
  sqlstm.sqhstv[13] = (         void  *)&p_dest_queue_name;
  sqlstm.sqhstl[13] = (unsigned int  )102;
  sqlstm.sqhsts[13] = (         int  )0;
  sqlstm.sqindv[13] = (         void  *)0;
  sqlstm.sqinds[13] = (         int  )0;
  sqlstm.sqharm[13] = (unsigned int  )0;
  sqlstm.sqadto[13] = (unsigned short )0;
  sqlstm.sqtdso[13] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			if(OERROR)
				ins_message(ERR_MESG,"3.Insert Failed on SY_REPORT_PRINT_REQUEST");
		 }

		 if (l_destn_fax_yn == 'Y' || l_destn_mail_yn == 'Y')		
		 {

				//// insert to fax table SM_REPORT_FAX_MAIL_REQUEST 


					 if (l_destn_rep_yn == 'Y')	 
					 {
						/// copy the .LIS file from WORKING_DIR to FAX directory 

						 l_command_line.arr[0]   = '\0';   
						 l_command_line.len      = 0;

						strcpy(l_command_line.arr, "COPY ");
						strcat(l_command_line.arr, nd_file_name.arr);
						strcat(l_command_line.arr, " ");
						strcat(l_command_line.arr, p_rep_file_fax_ext.arr);

						l_command_line.len = strlen(l_command_line.arr);

						_flushall;

					//	_spawnlp(_P_WAIT, "CMD", l_command_line.arr, NULL);
						
					//  WinExec(l_command_line, SW_SHOWNORMAL);	        

						system(l_command_line.arr);

					 }   


					 get_dest_type_n_locn();   /// 02.09.2004

					 strcpy(p_rep_file.arr,p_rep_file_fax_ext.arr);	
					 p_rep_file.len = strlen(p_rep_file.arr);

					 if (l_destn_fax_yn == 'Y') 
					 {	
						 if(p_fax_address.len)
						 {
							strcpy(p_fax_loc_type.arr,"@");
							strcpy(p_fax_loc_code.arr,"@");
							p_fax_loc_type.len = strlen(p_fax_loc_type.arr);
							p_fax_loc_code.len = strlen(p_fax_loc_code.arr);
						 }
						 /* EXEC SQL EXECUTE  
							  begin
								declare
								   l_error_text			VARCHAR2(200);
							       l_report_priority    VARCHAR2(10);
								begin
									SELECT DECODE(:rl_hdr_urgent_indicator,'R','N','H')
									INTO   l_report_priority
									FROM   DUAL;  
/o**************16.01.2006 *****************								 			
									appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
																'RL',					
																'RLRSENQE',				
																:p_fax_loc_type,		
																:p_fax_loc_code,  		
																 NULL,																 
																 NULL,														 
																 NULL,																 
																 NULL,																	 
																 NULL,																	 
																 l_report_priority,											           
																'F',             		
																:p_rep_file,			
																:sy_user_id,  			
																:sy_ws_no,    			
																:p_fax_id,		  			
																l_error_text 			
															  );
***********************************************************************o/
								appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
															'RL',					
															'RLRSENQE',				
															:p_fax_loc_type,		
															:p_fax_loc_code,  		
															:p_fax_address,																 
															 NULL,     // p_fax_mail_cc_address
															 NULL,     // p_fax_mail_bcc_address
															 NULL,	   // p_subject	
															 NULL,	   // p_salutation
															 NULL,	   // p_body
															 NULL,	   // p_footer
															 l_report_priority,	
															:p_fax_to_rcpt_name,										           
															:p_fax_to_comp_name,
															:p_fax_to_phone_no,
															:sy_acc_entity_name,  // p_from_user_name
															:sy_tel_num,          // p_from_phone_number
															:sy_fax_num,           // p_from_fax_number
															'F',             		
															:p_rep_file,			
															:sy_user_id,  			
															:sy_ws_no,    			
															:p_fax_id,		  			
															l_error_text 			
														  );
								end;
							  end;
						 END-EXEC; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 10;
       sqlstm.arrsiz = 25;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.stmt = "begin declare l_error_text VARCHAR2 ( 200 ) ; l_report\
_priority VARCHAR2 ( 10 ) ; begin SELECT DECODE ( :rl_hdr_urgent_indicator , '\
R' , 'N' , 'H' ) INTO l_report_priority FROM DUAL ; appfaxmail . fax_mail_repo\
rt ( NVL ( :rl_ordered_facility_id , :nd_operating_facility_id ) , 'RL' , 'RLR\
SENQE' , :p_fax_loc_type , :p_fax_loc_code , :p_fax_address , NULL , NULL , NU\
LL , NULL , NULL , NULL , l_report_priority , :p_fax_to_rcpt_name , :p_fax_to_\
comp_name , :p_fax_to_phone_no , :sy_acc_entity_name , :sy_tel_num , :sy_fax_n\
um , 'F' , :p_rep_file , :sy_user_id , :sy_ws_no , :p_fax_id , l_error_text ) \
; end ; end ;";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )1191;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)256;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&rl_hdr_urgent_indicator;
       sqlstm.sqhstl[0] = (unsigned int  )4;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
       sqlstm.sqhstl[1] = (unsigned int  )5;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
       sqlstm.sqhstl[2] = (unsigned int  )7;
       sqlstm.sqhsts[2] = (         int  )0;
       sqlstm.sqindv[2] = (         void  *)0;
       sqlstm.sqinds[2] = (         int  )0;
       sqlstm.sqharm[2] = (unsigned int  )0;
       sqlstm.sqadto[2] = (unsigned short )0;
       sqlstm.sqtdso[2] = (unsigned short )0;
       sqlstm.sqhstv[3] = (         void  *)&p_fax_loc_type;
       sqlstm.sqhstl[3] = (unsigned int  )12;
       sqlstm.sqhsts[3] = (         int  )0;
       sqlstm.sqindv[3] = (         void  *)0;
       sqlstm.sqinds[3] = (         int  )0;
       sqlstm.sqharm[3] = (unsigned int  )0;
       sqlstm.sqadto[3] = (unsigned short )0;
       sqlstm.sqtdso[3] = (unsigned short )0;
       sqlstm.sqhstv[4] = (         void  *)&p_fax_loc_code;
       sqlstm.sqhstl[4] = (unsigned int  )102;
       sqlstm.sqhsts[4] = (         int  )0;
       sqlstm.sqindv[4] = (         void  *)0;
       sqlstm.sqinds[4] = (         int  )0;
       sqlstm.sqharm[4] = (unsigned int  )0;
       sqlstm.sqadto[4] = (unsigned short )0;
       sqlstm.sqtdso[4] = (unsigned short )0;
       sqlstm.sqhstv[5] = (         void  *)&p_fax_address;
       sqlstm.sqhstl[5] = (unsigned int  )102;
       sqlstm.sqhsts[5] = (         int  )0;
       sqlstm.sqindv[5] = (         void  *)0;
       sqlstm.sqinds[5] = (         int  )0;
       sqlstm.sqharm[5] = (unsigned int  )0;
       sqlstm.sqadto[5] = (unsigned short )0;
       sqlstm.sqtdso[5] = (unsigned short )0;
       sqlstm.sqhstv[6] = (         void  *)&p_fax_to_rcpt_name;
       sqlstm.sqhstl[6] = (unsigned int  )502;
       sqlstm.sqhsts[6] = (         int  )0;
       sqlstm.sqindv[6] = (         void  *)0;
       sqlstm.sqinds[6] = (         int  )0;
       sqlstm.sqharm[6] = (unsigned int  )0;
       sqlstm.sqadto[6] = (unsigned short )0;
       sqlstm.sqtdso[6] = (unsigned short )0;
       sqlstm.sqhstv[7] = (         void  *)&p_fax_to_comp_name;
       sqlstm.sqhstl[7] = (unsigned int  )502;
       sqlstm.sqhsts[7] = (         int  )0;
       sqlstm.sqindv[7] = (         void  *)0;
       sqlstm.sqinds[7] = (         int  )0;
       sqlstm.sqharm[7] = (unsigned int  )0;
       sqlstm.sqadto[7] = (unsigned short )0;
       sqlstm.sqtdso[7] = (unsigned short )0;
       sqlstm.sqhstv[8] = (         void  *)&p_fax_to_phone_no;
       sqlstm.sqhstl[8] = (unsigned int  )102;
       sqlstm.sqhsts[8] = (         int  )0;
       sqlstm.sqindv[8] = (         void  *)0;
       sqlstm.sqinds[8] = (         int  )0;
       sqlstm.sqharm[8] = (unsigned int  )0;
       sqlstm.sqadto[8] = (unsigned short )0;
       sqlstm.sqtdso[8] = (unsigned short )0;
       sqlstm.sqhstv[9] = (         void  *)&sy_acc_entity_name;
       sqlstm.sqhstl[9] = (unsigned int  )302;
       sqlstm.sqhsts[9] = (         int  )0;
       sqlstm.sqindv[9] = (         void  *)0;
       sqlstm.sqinds[9] = (         int  )0;
       sqlstm.sqharm[9] = (unsigned int  )0;
       sqlstm.sqadto[9] = (unsigned short )0;
       sqlstm.sqtdso[9] = (unsigned short )0;
       sqlstm.sqhstv[10] = (         void  *)&sy_tel_num;
       sqlstm.sqhstl[10] = (unsigned int  )23;
       sqlstm.sqhsts[10] = (         int  )0;
       sqlstm.sqindv[10] = (         void  *)0;
       sqlstm.sqinds[10] = (         int  )0;
       sqlstm.sqharm[10] = (unsigned int  )0;
       sqlstm.sqadto[10] = (unsigned short )0;
       sqlstm.sqtdso[10] = (unsigned short )0;
       sqlstm.sqhstv[11] = (         void  *)&sy_fax_num;
       sqlstm.sqhstl[11] = (unsigned int  )23;
       sqlstm.sqhsts[11] = (         int  )0;
       sqlstm.sqindv[11] = (         void  *)0;
       sqlstm.sqinds[11] = (         int  )0;
       sqlstm.sqharm[11] = (unsigned int  )0;
       sqlstm.sqadto[11] = (unsigned short )0;
       sqlstm.sqtdso[11] = (unsigned short )0;
       sqlstm.sqhstv[12] = (         void  *)&p_rep_file;
       sqlstm.sqhstl[12] = (unsigned int  )153;
       sqlstm.sqhsts[12] = (         int  )0;
       sqlstm.sqindv[12] = (         void  *)0;
       sqlstm.sqinds[12] = (         int  )0;
       sqlstm.sqharm[12] = (unsigned int  )0;
       sqlstm.sqadto[12] = (unsigned short )0;
       sqlstm.sqtdso[12] = (unsigned short )0;
       sqlstm.sqhstv[13] = (         void  *)&sy_user_id;
       sqlstm.sqhstl[13] = (unsigned int  )33;
       sqlstm.sqhsts[13] = (         int  )0;
       sqlstm.sqindv[13] = (         void  *)0;
       sqlstm.sqinds[13] = (         int  )0;
       sqlstm.sqharm[13] = (unsigned int  )0;
       sqlstm.sqadto[13] = (unsigned short )0;
       sqlstm.sqtdso[13] = (unsigned short )0;
       sqlstm.sqhstv[14] = (         void  *)&sy_ws_no;
       sqlstm.sqhstl[14] = (unsigned int  )33;
       sqlstm.sqhsts[14] = (         int  )0;
       sqlstm.sqindv[14] = (         void  *)0;
       sqlstm.sqinds[14] = (         int  )0;
       sqlstm.sqharm[14] = (unsigned int  )0;
       sqlstm.sqadto[14] = (unsigned short )0;
       sqlstm.sqtdso[14] = (unsigned short )0;
       sqlstm.sqhstv[15] = (         void  *)&p_fax_id;
       sqlstm.sqhstl[15] = (unsigned int  )32;
       sqlstm.sqhsts[15] = (         int  )0;
       sqlstm.sqindv[15] = (         void  *)0;
       sqlstm.sqinds[15] = (         int  )0;
       sqlstm.sqharm[15] = (unsigned int  )0;
       sqlstm.sqadto[15] = (unsigned short )0;
       sqlstm.sqtdso[15] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					  }

					if(OERROR)
						ins_message(ERR_MESG,"2.Insert Failed on SM_REPORT_FAX_MAIL_REQUEST for Fax");

					 if (l_destn_mail_yn == 'Y')  
					 {	
					     get_mail_body_oth_dtls();
						 if(p_mail_address.len)
						 {
							strcpy(p_mail_loc_type.arr,"@");
							strcpy(p_mail_loc_code.arr,"@");
							p_mail_loc_type.len = strlen(p_mail_loc_type.arr);
							p_mail_loc_code.len = strlen(p_mail_loc_code.arr);
						 }
						 /* EXEC SQL EXECUTE  
							  begin
								declare
								   l_error_text			VARCHAR2(200);
							       l_report_priority    VARCHAR2(10);
								begin

									SELECT DECODE(:rl_hdr_urgent_indicator,'R','N','H')
									INTO   l_report_priority
									FROM   DUAL;
/o******************16.01.2006 ***************								 			
									appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
																'RL',					
																'RLRSENQE',				
																:p_mail_loc_type,		
																:p_mail_loc_code,  		
																 NULL,																 
																 NULL,														 
																 NULL,																 
																 NULL,																	 
																 NULL,																	 
																 l_report_priority,											           
																'M',             		
																:p_rep_file,			
																:sy_user_id,  			
																:sy_ws_no,    			
																:p_mail_id,		  			
																l_error_text 			
															  );
*****************************************************************o/
								appfaxmail.fax_mail_report(NVL(:rl_ordered_facility_id, :nd_operating_facility_id),          
															'RL',					
															'RLRSENQE',				
															:p_mail_loc_type,		
															:p_mail_loc_code,  		
															:p_mail_address,																	 
															 NULL,			/// p_fax_mail_cc_address
															 NULL,		   ///  p_mail_bcc_address
															:d_mail_subject,
															:d_mail_salutation,
															:d_mail_body,
															:d_mail_footer,
															 l_report_priority,	
															 NULL,        /// p_to_reciepient_name
															 NULL,        /// p_to_company_name
															 NULL,        /// p_to_phone_number
															 NULL,        /// p_from_user_name
															 NULL,        /// p_from_phone_number
															 NULL,        /// p_from_fax_number
															'M', 
															:p_rep_file,
															:sy_user_id,
															:sy_ws_no,
															:p_mail_id,
															l_error_text 
														  );
								end;
							  end;
						 END-EXEC; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 10;
       sqlstm.arrsiz = 25;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.stmt = "begin declare l_error_text VARCHAR2 ( 200 ) ; l_report\
_priority VARCHAR2 ( 10 ) ; begin SELECT DECODE ( :rl_hdr_urgent_indicator , '\
R' , 'N' , 'H' ) INTO l_report_priority FROM DUAL ; appfaxmail . fax_mail_repo\
rt ( NVL ( :rl_ordered_facility_id , :nd_operating_facility_id ) , 'RL' , 'RLR\
SENQE' , :p_mail_loc_type , :p_mail_loc_code , :p_mail_address , NULL , NULL ,\
 :d_mail_subject , :d_mail_salutation , :d_mail_body , :d_mail_footer , l_repo\
rt_priority , NULL , NULL , NULL , NULL , NULL , NULL , 'M' , :p_rep_file , :s\
y_user_id , :sy_ws_no , :p_mail_id , l_error_text ) ; end ; end ;";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )1270;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)256;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&rl_hdr_urgent_indicator;
       sqlstm.sqhstl[0] = (unsigned int  )4;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
       sqlstm.sqhstl[1] = (unsigned int  )5;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
       sqlstm.sqhstl[2] = (unsigned int  )7;
       sqlstm.sqhsts[2] = (         int  )0;
       sqlstm.sqindv[2] = (         void  *)0;
       sqlstm.sqinds[2] = (         int  )0;
       sqlstm.sqharm[2] = (unsigned int  )0;
       sqlstm.sqadto[2] = (unsigned short )0;
       sqlstm.sqtdso[2] = (unsigned short )0;
       sqlstm.sqhstv[3] = (         void  *)&p_mail_loc_type;
       sqlstm.sqhstl[3] = (unsigned int  )12;
       sqlstm.sqhsts[3] = (         int  )0;
       sqlstm.sqindv[3] = (         void  *)0;
       sqlstm.sqinds[3] = (         int  )0;
       sqlstm.sqharm[3] = (unsigned int  )0;
       sqlstm.sqadto[3] = (unsigned short )0;
       sqlstm.sqtdso[3] = (unsigned short )0;
       sqlstm.sqhstv[4] = (         void  *)&p_mail_loc_code;
       sqlstm.sqhstl[4] = (unsigned int  )102;
       sqlstm.sqhsts[4] = (         int  )0;
       sqlstm.sqindv[4] = (         void  *)0;
       sqlstm.sqinds[4] = (         int  )0;
       sqlstm.sqharm[4] = (unsigned int  )0;
       sqlstm.sqadto[4] = (unsigned short )0;
       sqlstm.sqtdso[4] = (unsigned short )0;
       sqlstm.sqhstv[5] = (         void  *)&p_mail_address;
       sqlstm.sqhstl[5] = (unsigned int  )102;
       sqlstm.sqhsts[5] = (         int  )0;
       sqlstm.sqindv[5] = (         void  *)0;
       sqlstm.sqinds[5] = (         int  )0;
       sqlstm.sqharm[5] = (unsigned int  )0;
       sqlstm.sqadto[5] = (unsigned short )0;
       sqlstm.sqtdso[5] = (unsigned short )0;
       sqlstm.sqhstv[6] = (         void  *)&d_mail_subject;
       sqlstm.sqhstl[6] = (unsigned int  )2003;
       sqlstm.sqhsts[6] = (         int  )0;
       sqlstm.sqindv[6] = (         void  *)0;
       sqlstm.sqinds[6] = (         int  )0;
       sqlstm.sqharm[6] = (unsigned int  )0;
       sqlstm.sqadto[6] = (unsigned short )0;
       sqlstm.sqtdso[6] = (unsigned short )0;
       sqlstm.sqhstv[7] = (         void  *)&d_mail_salutation;
       sqlstm.sqhstl[7] = (unsigned int  )4003;
       sqlstm.sqhsts[7] = (         int  )0;
       sqlstm.sqindv[7] = (         void  *)0;
       sqlstm.sqinds[7] = (         int  )0;
       sqlstm.sqharm[7] = (unsigned int  )0;
       sqlstm.sqadto[7] = (unsigned short )0;
       sqlstm.sqtdso[7] = (unsigned short )0;
       sqlstm.sqhstv[8] = (         void  *)&d_mail_body;
       sqlstm.sqhstl[8] = (unsigned int  )4003;
       sqlstm.sqhsts[8] = (         int  )0;
       sqlstm.sqindv[8] = (         void  *)0;
       sqlstm.sqinds[8] = (         int  )0;
       sqlstm.sqharm[8] = (unsigned int  )0;
       sqlstm.sqadto[8] = (unsigned short )0;
       sqlstm.sqtdso[8] = (unsigned short )0;
       sqlstm.sqhstv[9] = (         void  *)&d_mail_footer;
       sqlstm.sqhstl[9] = (unsigned int  )2003;
       sqlstm.sqhsts[9] = (         int  )0;
       sqlstm.sqindv[9] = (         void  *)0;
       sqlstm.sqinds[9] = (         int  )0;
       sqlstm.sqharm[9] = (unsigned int  )0;
       sqlstm.sqadto[9] = (unsigned short )0;
       sqlstm.sqtdso[9] = (unsigned short )0;
       sqlstm.sqhstv[10] = (         void  *)&p_rep_file;
       sqlstm.sqhstl[10] = (unsigned int  )153;
       sqlstm.sqhsts[10] = (         int  )0;
       sqlstm.sqindv[10] = (         void  *)0;
       sqlstm.sqinds[10] = (         int  )0;
       sqlstm.sqharm[10] = (unsigned int  )0;
       sqlstm.sqadto[10] = (unsigned short )0;
       sqlstm.sqtdso[10] = (unsigned short )0;
       sqlstm.sqhstv[11] = (         void  *)&sy_user_id;
       sqlstm.sqhstl[11] = (unsigned int  )33;
       sqlstm.sqhsts[11] = (         int  )0;
       sqlstm.sqindv[11] = (         void  *)0;
       sqlstm.sqinds[11] = (         int  )0;
       sqlstm.sqharm[11] = (unsigned int  )0;
       sqlstm.sqadto[11] = (unsigned short )0;
       sqlstm.sqtdso[11] = (unsigned short )0;
       sqlstm.sqhstv[12] = (         void  *)&sy_ws_no;
       sqlstm.sqhstl[12] = (unsigned int  )33;
       sqlstm.sqhsts[12] = (         int  )0;
       sqlstm.sqindv[12] = (         void  *)0;
       sqlstm.sqinds[12] = (         int  )0;
       sqlstm.sqharm[12] = (unsigned int  )0;
       sqlstm.sqadto[12] = (unsigned short )0;
       sqlstm.sqtdso[12] = (unsigned short )0;
       sqlstm.sqhstv[13] = (         void  *)&p_mail_id;
       sqlstm.sqhstl[13] = (unsigned int  )32;
       sqlstm.sqhsts[13] = (         int  )0;
       sqlstm.sqindv[13] = (         void  *)0;
       sqlstm.sqinds[13] = (         int  )0;
       sqlstm.sqharm[13] = (unsigned int  )0;
       sqlstm.sqadto[13] = (unsigned short )0;
       sqlstm.sqtdso[13] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					  }


					if(OERROR)
						ins_message(ERR_MESG,"2.Insert Failed on SM_REPORT_FAX_MAIL_REQUEST for Mail");

		 }


		_flushall();  

	} 
   }
  }

}

 if(OERROR)
       ins_message(ERR_MESG,"Select failed on DUAL in print_job()");
 
}
/*----------------------------------------------------------*/
fetch_sy_prog_param()
{
rl_prn_ctrl_hdr_pat_no.arr[0] 		= '\0';
rl_prn_ctrl_hdr_sp_no.arr[0] 		= '\0';
rl_prn_ctrl_hdr_source_code.arr[0] 	= '\0';
rl_prn_ctrl_hdr_user.arr[0] 		= '\0';
rl_prn_ctrl_hdr_section_code.arr[0]     = '\0';
rl_prn_ctrl_hdr_rp_yn.arr[0] = '\0';
p_param7.arr[0] = '\0';
p_param8.arr[0]	= '\0';
p_param9.arr[0]	= '\0';      ///  added param9,10,11 on 09.12.2004
p_param10.arr[0]	= '\0';
p_param11.arr[0]	= '\0';
p_param12.arr[0]	= '\0';  
p_param13.arr[0]	= '\0';  
p_fax_id.arr[0]		= '\0';  
p_mail_id.arr[0]	= '\0';  
//p_print_id.arr[0]   = '\0';
//p_printer_name.arr[0] = '\0';
//p_dest_queue_name.arr[0] = '\0';

p_fax_to_rcpt_name.arr[0] = '\0';
p_fax_to_comp_name.arr[0] = '\0';
p_fax_to_phone_no.arr[0]  = '\0'; 
//p_fax_address.arr[0]      = '\0';     
//p_mail_address.arr[0]     = '\0';    

nd_rowid.arr[0]						= '\0';

rl_prn_ctrl_hdr_pat_no.len 	        = 0;
rl_prn_ctrl_hdr_source_code.len         = 0;
rl_prn_ctrl_hdr_sp_no.len 	        = 0;
rl_prn_ctrl_hdr_section_code.len        = 0;
rl_prn_ctrl_hdr_user.len	        = 0;
rl_prn_ctrl_hdr_rp_yn.len = 0;
p_param7.len = 0;
p_param8.len = 0;
p_param9.len = 0;
p_param10.len = 0;
p_param11.len = 0;
p_param12.len = 0;
p_param13.len = 0;
p_fax_id.len = 0;
p_mail_id.len = 0;
//p_print_id.len = 0;

//p_printer_name.len = 0;    /// 21.08.2005
//p_dest_queue_name.len = 0;

p_fax_to_rcpt_name.len = 0;
p_fax_to_comp_name.len = 0;
p_fax_to_phone_no.len  = 0;
//p_fax_address.len      = 0;
//p_mail_address.len     = 0;

nd_rowid.len  = 0;


/* EXEC SQL SELECT	PARAM1,
			    PARAM2,
			    PARAM3,
			    PARAM4,
			    PARAM5,
				NVL(PARAM6,'N'),
				PARAM7,
				PARAM8,
				NVL(PARAM9,'PRINT'),
				NVL(PARAM10, 'N'),
				NVL(PARAM11, 'N'),
				NVL(PARAM12, 'N'),
				NVL(PARAM13, 'N'),
	///			PARAM14,
				PARAM15,
				PARAM16,												
	///			PARAM17,
	///			PARAM18,
				PARAM19,  
				PARAM20,
				PARAM21,
	///			PARAM22,
	///			PARAM23,
				rowid
	       INTO	
			    :rl_prn_ctrl_hdr_pat_no,
	   	   	    :rl_prn_ctrl_hdr_sp_no,
			    :rl_prn_ctrl_hdr_source_code,
			    :rl_prn_ctrl_hdr_user,
			    :rl_prn_ctrl_hdr_section_code,
				:rl_prn_ctrl_hdr_rp_yn,
				:p_param7, 
				:p_param8,
				:p_param9,    ////added param9,10,11 on 09.12.2004
				:p_param10,
				:p_param11,
				:p_param12,  /// added on 07.08.2005
				:p_param13,  /// added on 16.01.2006
	///			:p_print_id,
				:p_fax_id,
				:p_mail_id,
	///			:p_printer_name,
	///			:p_dest_queue_name,
				:p_fax_to_rcpt_name,  /// added on 16.01.2006
				:p_fax_to_comp_name,  /// added on 16.01.2006
				:p_fax_to_phone_no,   /// added on 16.01.2006
	///			:p_fax_address,       /// added on 16.01.2006
	///			:p_mail_address,      /// added on 16.01.2006
				:nd_rowid
	       FROM	SY_PROG_PARAM
	      WHERE	OPERATING_FACILITY_ID = :nd_operating_facility_id
		    AND PGM_ID = 'RLRRSENQ'
	        AND	SESSION_ID = :sy_session_id
			AND PGM_DATE = :sy_req_date
            AND PARAM4 = :sy_user_id
			AND ROWNUM < 2; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 10;
sqlstm.arrsiz = 25;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select PARAM1 ,PARAM2 ,PARAM3 ,PARAM4 ,PARAM5 ,NVL(PARAM6,'N'\
) ,PARAM7 ,PARAM8 ,NVL(PARAM9,'PRINT') ,NVL(PARAM10,'N') ,NVL(PARAM11,'N') ,NV\
L(PARAM12,'N') ,NVL(PARAM13,'N') ,PARAM15 ,PARAM16 ,PARAM19 ,PARAM20 ,PARAM21 \
,rowid into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:\
b15,:b16,:b17,:b18  from SY_PROG_PARAM where (((((OPERATING_FACILITY_ID=:b19 a\
nd PGM_ID='RLRRSENQ') and SESSION_ID=:b20) and PGM_DATE=:b21) and PARAM4=:b22)\
 and ROWNUM<2)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )1341;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)256;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&rl_prn_ctrl_hdr_pat_no;
sqlstm.sqhstl[0] = (unsigned int  )18;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&rl_prn_ctrl_hdr_sp_no;
sqlstm.sqhstl[1] = (unsigned int  )23;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&rl_prn_ctrl_hdr_source_code;
sqlstm.sqhstl[2] = (unsigned int  )13;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&rl_prn_ctrl_hdr_user;
sqlstm.sqhstl[3] = (unsigned int  )33;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&rl_prn_ctrl_hdr_section_code;
sqlstm.sqhstl[4] = (unsigned int  )4;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&rl_prn_ctrl_hdr_rp_yn;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&p_param7;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&p_param8;
sqlstm.sqhstl[7] = (unsigned int  )4;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&p_param9;
sqlstm.sqhstl[8] = (unsigned int  )12;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&p_param10;
sqlstm.sqhstl[9] = (unsigned int  )4;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&p_param11;
sqlstm.sqhstl[10] = (unsigned int  )4;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&p_param12;
sqlstm.sqhstl[11] = (unsigned int  )4;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&p_param13;
sqlstm.sqhstl[12] = (unsigned int  )4;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&p_fax_id;
sqlstm.sqhstl[13] = (unsigned int  )32;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&p_mail_id;
sqlstm.sqhstl[14] = (unsigned int  )32;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&p_fax_to_rcpt_name;
sqlstm.sqhstl[15] = (unsigned int  )502;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&p_fax_to_comp_name;
sqlstm.sqhstl[16] = (unsigned int  )502;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&p_fax_to_phone_no;
sqlstm.sqhstl[17] = (unsigned int  )102;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_rowid;
sqlstm.sqhstl[18] = (unsigned int  )33;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&nd_operating_facility_id;
sqlstm.sqhstl[19] = (unsigned int  )7;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&sy_session_id;
sqlstm.sqhstl[20] = (unsigned int  )32;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqhstv[21] = (         void  *)&sy_req_date;
sqlstm.sqhstl[21] = (unsigned int  )32;
sqlstm.sqhsts[21] = (         int  )0;
sqlstm.sqindv[21] = (         void  *)0;
sqlstm.sqinds[21] = (         int  )0;
sqlstm.sqharm[21] = (unsigned int  )0;
sqlstm.sqadto[21] = (unsigned short )0;
sqlstm.sqtdso[21] = (unsigned short )0;
sqlstm.sqhstv[22] = (         void  *)&sy_user_id;
sqlstm.sqhstl[22] = (unsigned int  )33;
sqlstm.sqhsts[22] = (         int  )0;
sqlstm.sqindv[22] = (         void  *)0;
sqlstm.sqinds[22] = (         int  )0;
sqlstm.sqharm[22] = (unsigned int  )0;
sqlstm.sqadto[22] = (unsigned short )0;
sqlstm.sqtdso[22] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
      if (OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_PROG_PARAM");

      if (NOT_FOUND) 
	      return FALSE;
      else 
	  {
	      rl_prn_ctrl_hdr_pat_no.arr[rl_prn_ctrl_hdr_pat_no.len]           = '\0';
	      rl_prn_ctrl_hdr_sp_no.arr[rl_prn_ctrl_hdr_sp_no.len]             = '\0';
	      rl_prn_ctrl_hdr_source_code.arr[rl_prn_ctrl_hdr_source_code.len] = '\0';
 	      rl_prn_ctrl_hdr_user.arr[rl_prn_ctrl_hdr_user.len]               = '\0';
	      rl_prn_ctrl_hdr_section_code.arr[rl_prn_ctrl_hdr_section_code.len]  = '\0';
          rl_prn_ctrl_hdr_rp_yn.arr[rl_prn_ctrl_hdr_rp_yn.len] = '\0';
		  p_param7.arr[p_param7.len] = '\0';
		  nd_rowid.arr[nd_rowid.len]						   = '\0';
		  p_param8.arr[p_param8.len] = '\0';
		  p_param9.arr[p_param9.len] = '\0';
		  p_param10.arr[p_param10.len] = '\0';
		  p_param11.arr[p_param11.len] = '\0';

		  p_param12.arr[p_param12.len] = '\0';
		  p_param13.arr[p_param13.len] = '\0';
	///	  p_print_id.arr[p_print_id.len] = '\0';
		  p_fax_id.arr[p_fax_id.len] = '\0';
		  p_mail_id.arr[p_mail_id.len] = '\0';
	///	  p_printer_name.arr[p_printer_name.len] = '\0';
	///	  p_dest_queue_name.arr[p_dest_queue_name.len] = '\0';

		  p_fax_to_rcpt_name.arr[p_fax_to_rcpt_name.len] = '\0';
		  p_fax_to_comp_name.arr[p_fax_to_comp_name.len] = '\0';
		  p_fax_to_phone_no.arr[p_fax_to_phone_no.len]   = '\0'; 
	///	  p_fax_address.arr[p_fax_address.len]           = '\0';     
	///	  p_mail_address.arr[p_mail_address.len]         = '\0';    
		  		  		  		  
	      strcpy(nd_hosp_no.arr,rl_prn_ctrl_hdr_pat_no.arr);
	      strcpy(nd_spec_no.arr,rl_prn_ctrl_hdr_sp_no.arr);
	      nd_hosp_no.arr[rl_prn_ctrl_hdr_pat_no.len] 	= '\0';
	      nd_spec_no.arr[rl_prn_ctrl_hdr_sp_no.len] 	= '\0';
	      nd_hosp_no.len	= rl_prn_ctrl_hdr_pat_no.len;
	      nd_spec_no.len	= rl_prn_ctrl_hdr_sp_no.len; 

  	      return TRUE;
	}

}
/*----------------------------------------------------------*/
sql_connect(l_nd_ap_uid_pwd)
char l_nd_ap_uid_pwd[];
{
  strcpy(uid_pwd.arr,l_nd_ap_uid_pwd);
  uid_pwd.len = strlen(uid_pwd.arr);

  /* EXEC SQL CONNECT :uid_pwd; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 25;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )20;
  sqlstm.offset = (unsigned int  )1448;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&uid_pwd;
  sqlstm.sqhstl[0] = (unsigned int  )134;
  sqlstm.sqhsts[0] = (         int  )134;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  if (sqlca.sqlcode < 0)
      return(-1);
  return(0);
}
get_company_name()
{

    sy_acc_entity_name.arr[0] = '\0'; 
	sy_acc_entity_name.len    = 0; 
    sy_tel_num.arr[0] = '\0'; 
	sy_tel_num.len    = 0; 
    sy_fax_num.arr[0] = '\0'; 
	sy_fax_num.len    = 0; 

    /* EXEC SQL  SELECT ACC_ENTITY_NAME,TEL_NUM,FAX_NUM	  
		        INTO :sy_acc_entity_name,:sy_tel_num,:sy_fax_num
	            FROM SY_ACC_ENTITY_LANG_VW
			WHERE ACC_ENTITY_ID = :nd_operating_facility_id
			and language_id = :language_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 25;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ACC_ENTITY_NAME ,TEL_NUM ,FAX_NUM into :b0,:b1,:b2\
  from SY_ACC_ENTITY_LANG_VW where (ACC_ENTITY_ID=:b3 and language_id=:b4)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )1479;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&sy_acc_entity_name;
    sqlstm.sqhstl[0] = (unsigned int  )302;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&sy_tel_num;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&sy_fax_num;
    sqlstm.sqhstl[2] = (unsigned int  )23;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&language_id;
    sqlstm.sqhstl[4] = (unsigned int  )7;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

	/* Company Name Master */

      if (OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_ACC_ENTITY");

    sy_acc_entity_name.arr[sy_acc_entity_name.len] = '\0'; 
	sy_tel_num.arr[sy_tel_num.len] = '\0';
	sy_fax_num.arr[sy_fax_num.len] = '\0';
}
get_ordered_company_name()
{
    /* EXEC SQL  SELECT ACC_ENTITY_NAME  
		        INTO :sy_ord_acc_entity_name
	            FROM SY_ACC_ENTITY_LANG_VW
			WHERE ACC_ENTITY_ID = :rl_ordered_facility_id
			and language_id = :language_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 25;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ACC_ENTITY_NAME into :b0  from SY_ACC_ENTITY_LANG_\
VW where (ACC_ENTITY_ID=:b1 and language_id=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )1514;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&sy_ord_acc_entity_name;
    sqlstm.sqhstl[0] = (unsigned int  )63;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&language_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

	/* Company Name Master */

      if (OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_ACC_ENTITY");

    sy_ord_acc_entity_name.arr[sy_ord_acc_entity_name.len] = '\0'; 
}


/*-----------------------------------------------------*/

get_departmental_parameters()
{
   rl_print_result_sect_yn.arr[0] = '\0';
   rl_print_result_sect_yn.len = 0;
   rl_section_tel_num.arr[0] = '\0';
   rl_section_tel_num.len = 0;
   rl_printer_for_urgent_yn.arr[0]	= '\0';
   rl_printer_for_urgent_yn.len		= 0;
   rl_test_requested_yn.arr[0]		= '\0';
   rl_test_requested_yn.len			= 0;
   rl_message_line.arr[0]			= '\0';
   rl_message_line.len				= 0;
   rl_name_on_report_yn.arr[0]		= '\0';
   rl_name_on_report_yn.len			= 0;
   rl_print_prv_result_yn.arr[0]	= '\0';
   rl_print_prv_result_yn.len		= 0;
   rl_footer_line_1.arr[0]			= '\0';
   rl_footer_line_2.arr[0]			= '\0';
   rl_footer_line_1.len				= 0;
   rl_footer_line_2.len				= 0;
   rl_print_build_clin_hist_yn.arr[0]	= '\0';
   rl_print_build_clin_hist_yn.len		= 0;
   rl_print_pend_profile_yn.arr[0]      = '\0';   /////// 21.05.2005
   rl_print_pend_profile_yn.len         = 0;
   rl_legend_for_pending.arr[0]         = '\0';   /////// 21.05.2005
   rl_legend_for_pending.len            = 0;
   rl_sectn_report_entire_spec_yn.arr[0] = '\0';  // 21.05.2005
   rl_sectn_report_entire_spec_yn.len    = 0;
   rl_print_prev_modified_result_yn.arr[0] = '\0';  // 07.03.2006
   rl_print_prev_modified_result_yn.len    = 0;

   rl_print_num_result_title_yn.arr[0] = '\0';   /// 17.07.2006
   rl_print_num_result_title_yn.len	   = 0;
   rl_title_for_test.arr[0]            = '\0';
   rl_title_for_test.len               = 0;
   rl_title_for_num_result.arr[0]      ='\0';
   rl_title_for_num_result.len         = 0;
   rl_title_for_test_units.arr[0]      = '\0';
   rl_title_for_test_units.len         = 0;
   rl_title_for_range_ind.arr[0]       = '\0';
   rl_title_for_range_ind.len          = 0;
   rl_title_for_result_range.arr[0]    = '\0'; 
   rl_title_for_result_range.len       = 0;
   rl_legend_for_pre_result.arr[0]    = '\0';
   rl_legend_for_pre_result.len       = 0;   /// 29.08.2006

   /* EXEC SQL SELECT NVL(PRINT_RESULT_AT_SECTION_YN,'N'),TEL_NUM,
					NVL(printer_for_urgent_yn, 'N'), NVL(test_requested_yn,'N'),
					message_line, NVL(use_name_on_rep_feature_yn, 'N'),
					footer_line_1, footer_line_2,NVL(print_prev_results_yn,'N'),
					NVL(print_build_clin_hist_yn,'N'),   /// 06.12.2004
					NVL(print_pending_for_profile_yn,'N'),
					legend_for_pending,NVL(report_entire_spec_yn,'N'),
					NVL(print_modified_results_yn,'N'),
					NVL(PRINT_NUM_RESULT_TITLE_YN,'N'),
					TITLE_FOR_TEST,         
					TITLE_FOR_NUM_RESULT,   
					TITLE_FOR_TEST_UNITS,   
					TITLE_FOR_RANGE_IND,    
					TITLE_FOR_RESULT_RANGE,
					NVL(LEGEND_FOR_PRE_RESULT,'This is Preliminary Result')
              INTO :rl_print_result_sect_yn,:rl_section_tel_num,
					:rl_printer_for_urgent_yn, :rl_test_requested_yn,
					:rl_message_line, :rl_name_on_report_yn,
					:rl_footer_line_1, :rl_footer_line_2, :rl_print_prv_result_yn,
					:rl_print_build_clin_hist_yn,
					:rl_print_pend_profile_yn,:rl_legend_for_pending,
					:rl_sectn_report_entire_spec_yn,
					:rl_print_prev_modified_result_yn,
					:rl_print_num_result_title_yn,
					:rl_title_for_test,
					:rl_title_for_num_result,
					:rl_title_for_test_units, 
					:rl_title_for_range_ind,
					:rl_title_for_result_range,
					:rl_legend_for_pre_result
		      FROM RL_SECTION_CTL 
		     WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
			 AND SECTION_CODE = :rl_hdr_section_code; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select NVL(PRINT_RESULT_AT_SECTION_YN,'N') ,TEL_NUM ,NVL(p\
rinter_for_urgent_yn,'N') ,NVL(test_requested_yn,'N') ,message_line ,NVL(use_n\
ame_on_rep_feature_yn,'N') ,footer_line_1 ,footer_line_2 ,NVL(print_prev_resul\
ts_yn,'N') ,NVL(print_build_clin_hist_yn,'N') ,NVL(print_pending_for_profile_y\
n,'N') ,legend_for_pending ,NVL(report_entire_spec_yn,'N') ,NVL(print_modified\
_results_yn,'N') ,NVL(PRINT_NUM_RESULT_TITLE_YN,'N') ,TITLE_FOR_TEST ,TITLE_FO\
R_NUM_RESULT ,TITLE_FOR_TEST_UNITS ,TITLE_FOR_RANGE_IND ,TITLE_FOR_RESULT_RANG\
E ,NVL(LEGEND_FOR_PRE_RESULT,'This is Preliminary Result') into :b0,:b1,:b2,:b\
3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16,:b17,:b18,:b19,:b\
20  from RL_SECTION_CTL where (OPERATING_FACILITY_ID=:b21 and SECTION_CODE=:b2\
2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )1541;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_print_result_sect_yn;
   sqlstm.sqhstl[0] = (unsigned int  )4;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_section_tel_num;
   sqlstm.sqhstl[1] = (unsigned int  )18;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_printer_for_urgent_yn;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_test_requested_yn;
   sqlstm.sqhstl[3] = (unsigned int  )4;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&rl_message_line;
   sqlstm.sqhstl[4] = (unsigned int  )502;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_name_on_report_yn;
   sqlstm.sqhstl[5] = (unsigned int  )4;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&rl_footer_line_1;
   sqlstm.sqhstl[6] = (unsigned int  )502;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&rl_footer_line_2;
   sqlstm.sqhstl[7] = (unsigned int  )502;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&rl_print_prv_result_yn;
   sqlstm.sqhstl[8] = (unsigned int  )4;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&rl_print_build_clin_hist_yn;
   sqlstm.sqhstl[9] = (unsigned int  )4;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&rl_print_pend_profile_yn;
   sqlstm.sqhstl[10] = (unsigned int  )4;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&rl_legend_for_pending;
   sqlstm.sqhstl[11] = (unsigned int  )42;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqhstv[12] = (         void  *)&rl_sectn_report_entire_spec_yn;
   sqlstm.sqhstl[12] = (unsigned int  )4;
   sqlstm.sqhsts[12] = (         int  )0;
   sqlstm.sqindv[12] = (         void  *)0;
   sqlstm.sqinds[12] = (         int  )0;
   sqlstm.sqharm[12] = (unsigned int  )0;
   sqlstm.sqadto[12] = (unsigned short )0;
   sqlstm.sqtdso[12] = (unsigned short )0;
   sqlstm.sqhstv[13] = (         void  *)&rl_print_prev_modified_result_yn;
   sqlstm.sqhstl[13] = (unsigned int  )4;
   sqlstm.sqhsts[13] = (         int  )0;
   sqlstm.sqindv[13] = (         void  *)0;
   sqlstm.sqinds[13] = (         int  )0;
   sqlstm.sqharm[13] = (unsigned int  )0;
   sqlstm.sqadto[13] = (unsigned short )0;
   sqlstm.sqtdso[13] = (unsigned short )0;
   sqlstm.sqhstv[14] = (         void  *)&rl_print_num_result_title_yn;
   sqlstm.sqhstl[14] = (unsigned int  )4;
   sqlstm.sqhsts[14] = (         int  )0;
   sqlstm.sqindv[14] = (         void  *)0;
   sqlstm.sqinds[14] = (         int  )0;
   sqlstm.sqharm[14] = (unsigned int  )0;
   sqlstm.sqadto[14] = (unsigned short )0;
   sqlstm.sqtdso[14] = (unsigned short )0;
   sqlstm.sqhstv[15] = (         void  *)&rl_title_for_test;
   sqlstm.sqhstl[15] = (unsigned int  )52;
   sqlstm.sqhsts[15] = (         int  )0;
   sqlstm.sqindv[15] = (         void  *)0;
   sqlstm.sqinds[15] = (         int  )0;
   sqlstm.sqharm[15] = (unsigned int  )0;
   sqlstm.sqadto[15] = (unsigned short )0;
   sqlstm.sqtdso[15] = (unsigned short )0;
   sqlstm.sqhstv[16] = (         void  *)&rl_title_for_num_result;
   sqlstm.sqhstl[16] = (unsigned int  )52;
   sqlstm.sqhsts[16] = (         int  )0;
   sqlstm.sqindv[16] = (         void  *)0;
   sqlstm.sqinds[16] = (         int  )0;
   sqlstm.sqharm[16] = (unsigned int  )0;
   sqlstm.sqadto[16] = (unsigned short )0;
   sqlstm.sqtdso[16] = (unsigned short )0;
   sqlstm.sqhstv[17] = (         void  *)&rl_title_for_test_units;
   sqlstm.sqhstl[17] = (unsigned int  )52;
   sqlstm.sqhsts[17] = (         int  )0;
   sqlstm.sqindv[17] = (         void  *)0;
   sqlstm.sqinds[17] = (         int  )0;
   sqlstm.sqharm[17] = (unsigned int  )0;
   sqlstm.sqadto[17] = (unsigned short )0;
   sqlstm.sqtdso[17] = (unsigned short )0;
   sqlstm.sqhstv[18] = (         void  *)&rl_title_for_range_ind;
   sqlstm.sqhstl[18] = (unsigned int  )52;
   sqlstm.sqhsts[18] = (         int  )0;
   sqlstm.sqindv[18] = (         void  *)0;
   sqlstm.sqinds[18] = (         int  )0;
   sqlstm.sqharm[18] = (unsigned int  )0;
   sqlstm.sqadto[18] = (unsigned short )0;
   sqlstm.sqtdso[18] = (unsigned short )0;
   sqlstm.sqhstv[19] = (         void  *)&rl_title_for_result_range;
   sqlstm.sqhstl[19] = (unsigned int  )52;
   sqlstm.sqhsts[19] = (         int  )0;
   sqlstm.sqindv[19] = (         void  *)0;
   sqlstm.sqinds[19] = (         int  )0;
   sqlstm.sqharm[19] = (unsigned int  )0;
   sqlstm.sqadto[19] = (unsigned short )0;
   sqlstm.sqtdso[19] = (unsigned short )0;
   sqlstm.sqhstv[20] = (         void  *)&rl_legend_for_pre_result;
   sqlstm.sqhstl[20] = (unsigned int  )102;
   sqlstm.sqhsts[20] = (         int  )0;
   sqlstm.sqindv[20] = (         void  *)0;
   sqlstm.sqinds[20] = (         int  )0;
   sqlstm.sqharm[20] = (unsigned int  )0;
   sqlstm.sqadto[20] = (unsigned short )0;
   sqlstm.sqtdso[20] = (unsigned short )0;
   sqlstm.sqhstv[21] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[21] = (unsigned int  )7;
   sqlstm.sqhsts[21] = (         int  )0;
   sqlstm.sqindv[21] = (         void  *)0;
   sqlstm.sqinds[21] = (         int  )0;
   sqlstm.sqharm[21] = (unsigned int  )0;
   sqlstm.sqadto[21] = (unsigned short )0;
   sqlstm.sqtdso[21] = (unsigned short )0;
   sqlstm.sqhstv[22] = (         void  *)&rl_hdr_section_code;
   sqlstm.sqhstl[22] = (unsigned int  )4;
   sqlstm.sqhsts[22] = (         int  )0;
   sqlstm.sqindv[22] = (         void  *)0;
   sqlstm.sqinds[22] = (         int  )0;
   sqlstm.sqharm[22] = (unsigned int  )0;
   sqlstm.sqadto[22] = (unsigned short )0;
   sqlstm.sqtdso[22] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if (OERROR)
         ins_message(ORA_MESG,"Select failed on table RL_SECTION_CTL");

      rl_print_result_sect_yn.arr[rl_print_result_sect_yn.len] = '\0';
      rl_section_tel_num.arr[rl_section_tel_num.len] = '\0';
	  rl_printer_for_urgent_yn.arr[rl_printer_for_urgent_yn.len]= '\0';
	  rl_test_requested_yn.arr[rl_test_requested_yn.len]		= '\0';
	  rl_message_line.arr[rl_message_line.len]					= '\0';
	  rl_name_on_report_yn.arr[rl_name_on_report_yn.len]		= '\0';
	  rl_print_prv_result_yn.arr[rl_print_prv_result_yn.len]	= '\0';
	  rl_footer_line_1.arr[rl_footer_line_1.len]				= '\0';
	  rl_footer_line_2.arr[rl_footer_line_2.len]				= '\0';
	  rl_print_build_clin_hist_yn.arr[rl_print_build_clin_hist_yn.len]	= '\0';
	  rl_print_pend_profile_yn.arr[rl_print_pend_profile_yn.len]	    = '\0';
	  rl_legend_for_pending.arr[rl_legend_for_pending.len]				= '\0';
	  rl_sectn_report_entire_spec_yn.arr[rl_sectn_report_entire_spec_yn.len] = '\0';
	  rl_print_prev_modified_result_yn.arr[rl_print_prev_modified_result_yn.len] = '\0';
	  rl_print_num_result_title_yn.arr[rl_print_num_result_title_yn.len] = '\0';
	  rl_title_for_test.arr[rl_title_for_test.len] = '\0';
	  rl_title_for_num_result.arr[rl_title_for_num_result.len] = '\0';
	  rl_title_for_test_units.arr[rl_title_for_num_result.len] = '\0';
	  rl_title_for_range_ind.arr[rl_title_for_range_ind.len]   = '\0';
	  rl_title_for_result_range.arr[rl_title_for_result_range.len] = '\0';
	  rl_legend_for_pre_result.arr[rl_legend_for_pre_result.len] = '\0';
 
}
/*-----------------------------------------------------*/

get_parameters()
{
    rl_lab_title.arr[0] = '\0';
    rl_lab_title.len = 0;
    rl_lab_title_2.arr[0] = '\0';
    rl_lab_title_2.len = 0;
    rl_lab_title_3.arr[0] = '\0';
    rl_lab_title_3.len = 0;
    rl_lab_title_4.arr[0] = '\0';
    rl_lab_title_4.len = 0;
    rl_lab_title_5.arr[0] = '\0';
    rl_lab_title_5.len = 0;
    rl_race_accepted_yn.arr[0] = '\0';   /// 27.07.2004
    rl_race_accepted_yn.len = 0;

/*********************** 23.06.2003 commented and replaced as per new standard

    EXEC SQL  SELECT LAB_TITLE, lab_title_2, lab_title_3, lab_title_4
		    INTO :rl_lab_title, :rl_lab_title_2, :rl_lab_title_3, :rl_lab_title_4
	            FROM RL_PARAM;	////// Departmental Parameters 

*********************************/

///////////////////////////////////////////////
     {
		 /* EXEC SQL SELECT nvl(a.lab_title,b.lab_title),
	 					 nvl(a.lab_title_2,b.lab_title_2), 
						 nvl(a.lab_title_3,b.lab_title_3),
						 nvl(a.lab_title_4,b.lab_title_4),
						 nvl(a.lab_title_5,b.lab_title_5), 
						 nvl(b.race_accepted_yn,'N')
				  INTO :rl_lab_title, :rl_lab_title_2, :rl_lab_title_3, :rl_lab_title_4,
				       :rl_lab_title_5,:rl_race_accepted_yn
				  FROM   RL_PARAM_FOR_FACILITY A , RL_PARAM B
				  WHERE  OPERATING_FACILITY_ID = :nd_operating_facility_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 25;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select nvl(a.lab_title,b.lab_title) ,nvl(a.lab_title_2,b.l\
ab_title_2) ,nvl(a.lab_title_3,b.lab_title_3) ,nvl(a.lab_title_4,b.lab_title_4\
) ,nvl(a.lab_title_5,b.lab_title_5) ,nvl(b.race_accepted_yn,'N') into :b0,:b1,\
:b2,:b3,:b4,:b5  from RL_PARAM_FOR_FACILITY A ,RL_PARAM B where OPERATING_FACI\
LITY_ID=:b6";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )1648;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_lab_title;
   sqlstm.sqhstl[0] = (unsigned int  )103;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_lab_title_2;
   sqlstm.sqhstl[1] = (unsigned int  )203;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_lab_title_3;
   sqlstm.sqhstl[2] = (unsigned int  )203;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_lab_title_4;
   sqlstm.sqhstl[3] = (unsigned int  )203;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&rl_lab_title_5;
   sqlstm.sqhstl[4] = (unsigned int  )203;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_race_accepted_yn;
   sqlstm.sqhstl[5] = (unsigned int  )4;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[6] = (unsigned int  )7;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 		 if(NODATAFOUND)
		 {
			    /* EXEC SQL  SELECT LAB_TITLE, lab_title_2, lab_title_3,lab_title_4, lab_title_5, nvl(race_accepted_yn,'N')
						  INTO :rl_lab_title, :rl_lab_title_2, :rl_lab_title_3, :rl_lab_title_4,
							   :rl_lab_title_5,:rl_race_accepted_yn
						  FROM RL_PARAM; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 10;
       sqlstm.arrsiz = 25;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.stmt = "select LAB_TITLE ,lab_title_2 ,lab_title_3 ,lab_title_\
4 ,lab_title_5 ,nvl(race_accepted_yn,'N') into :b0,:b1,:b2,:b3,:b4,:b5  from R\
L_PARAM ";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )1691;
       sqlstm.selerr = (unsigned short)1;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)256;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&rl_lab_title;
       sqlstm.sqhstl[0] = (unsigned int  )103;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&rl_lab_title_2;
       sqlstm.sqhstl[1] = (unsigned int  )203;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqhstv[2] = (         void  *)&rl_lab_title_3;
       sqlstm.sqhstl[2] = (unsigned int  )203;
       sqlstm.sqhsts[2] = (         int  )0;
       sqlstm.sqindv[2] = (         void  *)0;
       sqlstm.sqinds[2] = (         int  )0;
       sqlstm.sqharm[2] = (unsigned int  )0;
       sqlstm.sqadto[2] = (unsigned short )0;
       sqlstm.sqtdso[2] = (unsigned short )0;
       sqlstm.sqhstv[3] = (         void  *)&rl_lab_title_4;
       sqlstm.sqhstl[3] = (unsigned int  )203;
       sqlstm.sqhsts[3] = (         int  )0;
       sqlstm.sqindv[3] = (         void  *)0;
       sqlstm.sqinds[3] = (         int  )0;
       sqlstm.sqharm[3] = (unsigned int  )0;
       sqlstm.sqadto[3] = (unsigned short )0;
       sqlstm.sqtdso[3] = (unsigned short )0;
       sqlstm.sqhstv[4] = (         void  *)&rl_lab_title_5;
       sqlstm.sqhstl[4] = (unsigned int  )203;
       sqlstm.sqhsts[4] = (         int  )0;
       sqlstm.sqindv[4] = (         void  *)0;
       sqlstm.sqinds[4] = (         int  )0;
       sqlstm.sqharm[4] = (unsigned int  )0;
       sqlstm.sqadto[4] = (unsigned short )0;
       sqlstm.sqtdso[4] = (unsigned short )0;
       sqlstm.sqhstv[5] = (         void  *)&rl_race_accepted_yn;
       sqlstm.sqhstl[5] = (unsigned int  )4;
       sqlstm.sqhsts[5] = (         int  )0;
       sqlstm.sqindv[5] = (         void  *)0;
       sqlstm.sqinds[5] = (         int  )0;
       sqlstm.sqharm[5] = (unsigned int  )0;
       sqlstm.sqadto[5] = (unsigned short )0;
       sqlstm.sqtdso[5] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				  if (OERROR)
					 ins_message(ORA_MESG,"Select failed on table RL_PARAM");

		 }
	 }

///////////////////////////////////////////////

      if (OERROR)
         ins_message(ORA_MESG,"Select failed on table RL_PARAM");

	rl_race_accepted_yn.arr[rl_race_accepted_yn.len] = '\0';
    rl_lab_title.arr[rl_lab_title.len] = '\0';
	rl_lab_title_2.arr[rl_lab_title_2.len] = '\0';
	rl_lab_title_3.arr[rl_lab_title_3.len] = '\0';
	rl_lab_title_4.arr[rl_lab_title_4.len] = '\0';  
	rl_lab_title_5.arr[rl_lab_title_5.len] = '\0';  

	// The last  title has to be concatenated with the department name

/******** title 4 has to be printed as it is. Dept name to be printed seperately 27.07.2004
	strcat(rl_lab_title_4.arr, " ");
	strcat(rl_lab_title_4.arr, rl_section_short_name.arr);
	rl_lab_title_4.len = strlen(rl_lab_title_4.arr);
**************/

}
/*-----------------------------------------------------*/
declare_curs()
{
    get_company_name();

    /* EXEC SQL DECLARE RL_REQ_HDR_CUR CURSOR FOR
              SELECT SOURCE_CODE,
                     CONSULTANT_CODE,
                     TO_CHAR(SPEC_RECD_DATE_TIME,'DD/MM/YYYY HH24:MI'),
                     TO_CHAR(SPEC_REGD_DATE_TIME,'DD/MM/YYYY HH24:MI'),
                     TO_CHAR(SPEC_COLLTD_DATE_TIME,'DD/MM/YYYY HH24:MI'),
                     TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI'),
                     SECTION_CODE,
                     REQUEST_COMMENT_CODE1,
                     REQUEST_COMMENT_CODE2,
                     REQUEST_COMMENT_CODE3,
                     REQUEST_COMMENT_DESC1,
                     REQUEST_COMMENT_DESC2,
                     REQUEST_COMMENT_DESC3,
                     EXTRA_COPIES_TO,
                     SPECIMEN_TYPE_CODE,
                     ADDED_BY_ID,
                     TO_CHAR(ADDED_DATE,'DD/MM/YYYY HH24:MI'),
                     MODIFIED_BY_ID,
                     TO_CHAR(MODIFIED_DATE,'DD/MM/YYYY HH24:MI'),
				     URGENT_INDICATOR,
				     EPISODE_TYPE, 
					 SOURCE_TYPE,
					 RELEASED_BY_ID,
					 TO_CHAR(RELEASED_DATE,'DD/MM/YYYY HH24:MI'),
					 category_code,
					 category_year, 
					 category_number,
					 TO_CHAR(SPEC_REGD_DATE_TIME,'DD/MM/YYYY'),
					 ordered_facility_id,
					 ordering_doctor_name,   // 06.12.2004
					 patient_id,   /// 12.12.2004
					 order_id,      /// 11.04.2005
					 perform_site_code   /// 31.10.2006
                FROM RL_REQUEST_HEADER
               WHERE SPECIMEN_NO = :nd_spec_no
/// 12.12.2004           WHERE PATIENT_ID = :nd_hosp_no
/// 12.12.2004             AND SPECIMEN_NO = :nd_spec_no
				 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
		 FOR UPDATE OF STATUS NOWAIT; */ 
  

    /* EXEC SQL DECLARE RL_REQ_DTL_CUR CURSOR FOR
              SELECT TEST_CODE,
                     NVL(RESULT_STATUS,'O'),
                     DECODE(GROUP_TEST_YN,'Y','G','I')
                FROM RL_REQUEST_DETAIL
               WHERE PATIENT_ID = :nd_hosp_no
                 AND SPECIMEN_NO = :first_specimen_no
				 AND OPERATING_FACILITY_ID = :nd_operating_facility_id; */ 

/****************
    EXEC SQL DECLARE RL_TEST_RESULT_CUR CURSOR FOR
              SELECT GROUP_TEST_CODE,
                     TEST_CODE,
                     NVL(NUMERIC_PREFIX,'+'),
                     NUMERIC_RESULT,
                     RESULT_COMMENT_DESC1,
                     RESULT_COMMENT_DESC2,
                     RESULT_COMMENT_DESC3,
                     RESULT_COMMENT_DESC4,
					 TEST_UNITS,
					 TEST_REF_RANGE_COMMENT,
					 AGE_RANGE_LOW,
					 AGE_RANGE_HIGH,
                     ROWID,
					 NVL(HIDE_RESULT_COMMENTS_YN,'N')
                FROM RL_TEST_RESULT
               WHERE PATIENT_ID = :nd_hosp_no
                 AND SPECIMEN_NO = :nd_spec_no
		         AND OPERATING_FACILITY_ID = :nd_operating_facility_id
		 AND GROUP_TEST_CODE IN
		 (
              SELECT TEST_CODE
                FROM RL_REQUEST_DETAIL
               WHERE PATIENT_ID = :nd_hosp_no
                 AND SPECIMEN_NO = :nd_spec_no
		         AND OPERATING_FACILITY_ID = :nd_operating_facility_id
		 AND NVL(RESULT_STATUS,' ') = 'R'
		 )
         ORDER BY GROUP_SEQ_NO,TEST_SEQ_NO
		 FOR UPDATE OF STATUS;
****************/
/******** INCLUDE AS DYNAMIC SQL ************************
    EXEC SQL DECLARE RL_TEST_RESULT_CUR CURSOR FOR
              SELECT B.specimen_no,
					 B.GROUP_TEST_CODE,
                     B.TEST_CODE,
                     NVL(NUMERIC_PREFIX,'+'),
                     NUMERIC_RESULT,
                     RESULT_COMMENT_DESC1,
                     RESULT_COMMENT_DESC2,
                     RESULT_COMMENT_DESC3,
                     RESULT_COMMENT_DESC4,
					 TEST_UNITS,
					 TEST_REF_RANGE_COMMENT,
					 AGE_RANGE_LOW,
					 AGE_RANGE_HIGH,
                     B.ROWID AS row_id,
					 NVL(HIDE_RESULT_COMMENTS_YN,'N')
                FROM RL_INTERVAL_TEST_TEMP A, RL_TEST_RESULT B
               WHERE B.PATIENT_ID = :nd_hosp_no
                 AND A.specimen_no = B.specimen_no
				 AND A.OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND B.OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND B.test_code = DECODE(A.test_code, NULL, B.test_code, A.test_code)
				 AND B.group_test_code = A.group_test_code
				 AND A.user_id = 'RLRRSENQ'
				 AND A.session_id = 1
         ORDER BY B.test_code, B.specimen_no, B.GROUP_SEQ_NO,B.TEST_SEQ_NO
		 FOR UPDATE OF STATUS;
****************/

/*   changed on 28/01/2002 and made as a implicit select statement

     EXEC SQL DECLARE RL_SPECIMEN_TYPE_CODE_CUR CURSOR FOR
              SELECT SPECIMEN_DESC
                FROM RL_SPECIMEN_TYPE_CODE
               WHERE SPECIMEN_TYPE_CODE = :rl_hdr_specimen_type_code;
*/


/*   changed on 28/01/2002 and made as a implicit select statement

    EXEC SQL DECLARE RL_SECTION_CUR CURSOR FOR
              SELECT SUBSTR(LONG_NAME,1,30)
                FROM RL_SECTION_CODE
               WHERE SECTION_CODE = :rl_hdr_section_code;

*/

/*   changed on 28/01/2002 and made as a implicit select statement
    EXEC SQL DECLARE RL_TEST_CODE_CUR CURSOR FOR
              SELECT LONG_DESC,
                     NUMERIC_RESULT_YN,
                     AGE_SEX_RANGE_YN,
                     FUNCTION_YN,
                     PRINT_NAME_YN,
                     LOW_VALUE_NORMAL,
                     HIGH_VALUE_NORMAL,
                     GROUP_TEST_YN,
                     TEXT_BLOCK_YN,
                     CULTURE_TEST_YN,
                     SNOMED_YN,
                     TEST_UNITS,
                     NVL(NO_OF_DECIMALS,0),
                     NVL(SIGNIFICANT_DIGIT,0),
					 REF_RANGE_COMMENT,
					 NVL(INHIBIT_REPORT_YN,'N'),
					 NVL(CONFIDENTIAL_YN,'N')    
                FROM RL_TEST_CODE
               WHERE TEST_CODE = :rl_loc_test_code
                 AND INHIBIT_REPORT_YN = 'N';

*/

/*   changed on 28/01/2002 and made as a implicit select statement

    EXEC SQL DECLARE RL_AGE_SEX_RANGE_CUR CURSOR FOR
              SELECT LOW_VALUE_NORMAL,
                     HIGH_VALUE_NORMAL
                FROM RL_AGE_SEX_RANGE
               WHERE TEST_CODE = :rl_tst_test_code
                 AND SEX       = :rl_pat_sex
                 AND :rl_pat_dob_no_of_days
                       BETWEEN CALC_MIN_AGE_IN_DAYS  AND 
                          CALC_MAX_AGE_IN_DAYS;
*/

    /* EXEC SQL DECLARE RL_COMM_FOR_TEST_CUR CURSOR FOR
              SELECT COMMENT_TEXT
                FROM RL_COMMENTS_FOR_TEST
               WHERE TEST_CODE = :rl_tst_test_code
	    ORDER BY SEQ_NO; */ 


    /* EXEC SQL DECLARE RL_RESULT_TEXT_CUR CURSOR FOR
              SELECT RESULT_TEXT
                FROM RL_RESULT_TEXT
               WHERE PATIENT_ID     = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
				 AND NVL(hide_text_yn, 'N') <> 'Y'
            ORDER BY SERIAL_NO; */ 


/// added the below cursor on 16.05.2004 

    /* EXEC SQL DECLARE RL_RESULT_MODIFY_REASON_CUR CURSOR FOR
              SELECT REMARK_CODE,REMARK_TEXT,RELEASED_BY,
					 TO_CHAR(RELEASED_DATE,'DD/MM/YY HH24:MI'),
					 NUMERIC_PREFIX,NUMERIC_RESULT,  ////06.03.2006
					 NVL(MODIFY_COMPONENTS_IND,'!!!!'),
					 INSTR(NVL(MODIFY_COMPONENTS_IND,'!!!!'),'NM')
                FROM RL_RESULT_MODIFY_REASON
               WHERE SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND PATIENT_ID     = :nd_hosp_no
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
            ORDER BY MODIFY_LOG_SEQ_NO desc; */ 



    /* EXEC SQL DECLARE RL_FUNCTION_CUR CURSOR FOR
              SELECT OPERAND_1,
                     OPERAND_1_TYPE,
                     OPERATOR_1,
                     OPERAND_2,
                     OPERAND_2_TYPE,
                     OPERATOR_2
                FROM RL_FUNCTION
               WHERE TEST_CODE       = :rl_loc_test_code
               ORDER BY SEQ_NUMBER; */ 


/******** Observed this cursor is not using in the program *********
    EXEC SQL DECLARE RL_TEST_RESULT_CUR2 CURSOR FOR
              SELECT NUMERIC_RESULT
                FROM RL_TEST_RESULT
               WHERE PATIENT_ID     = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND TEST_CODE       = :rl_loc_test_code;
**********************/

    /* EXEC SQL DECLARE RL_RESULT_SNOMED_CUR CURSOR FOR
              SELECT SNOMED_CODE, snomed_code_2,SNOMED_MARKER_CODE_1,SNOMED_MARKER_CODE_2
                FROM RL_RESULT_SNOMED
               WHERE PATIENT_ID      = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
	       ORDER BY SNOMED_CODE; */ 


/*   changed on 28/01/2002 and made as a implicit select statement

    EXEC SQL DECLARE RL_SNOMED_CODE_CUR CURSOR FOR
              SELECT DESCRIPTION_1,
                     DESCRIPTION_2,
                     DESCRIPTION_3,
                     DESCRIPTION_4,
                     DESCRIPTION_5,
		     PRINT_YN
                FROM RL_SNOMED_CODE
               WHERE SNOMED_CODE = :rl_res_snomed_code
			   and language_id = :language_id;

*/

    /* EXEC SQL DECLARE RL_RESULT_ORGANISM_CUR CURSOR FOR
              SELECT ORGANISM_CODE,
                     RESULT_COMMENT_DESC
                FROM RL_RESULT_ORGANISM
               WHERE PATIENT_ID      = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
				 AND NVL(hide_organism_yn, 'N') <> 'Y'
			   ORDER BY ORGANISM_CODE; */ 


    /* EXEC SQL DECLARE RL_ANTIBIOTIC_CUR CURSOR FOR
              SELECT DISTINCT ANTIBIOTIC_CODE
                FROM RL_RESULT_ORGANISM_DTL
               WHERE PATIENT_ID      = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
                 AND REPORT_YN       = 'Y'
				 AND SENSITIVITY_IND IN('S','R','I')
			   ORDER BY ANTIBIOTIC_CODE; */ 


    /* EXEC SQL DECLARE RL_SENSITIVITY_CUR CURSOR FOR
              SELECT ORGANISM_CODE,
					 ANTIBIOTIC_CODE,
                     SENSITIVITY_IND,
					 MIC_RESULT,
					 zone_size
                FROM RL_RESULT_ORGANISM_DTL
               WHERE PATIENT_ID      = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
                 AND REPORT_YN       = 'Y'
				 AND SENSITIVITY_IND IN('S','R','I')
               ORDER BY ANTIBIOTIC_CODE, ORGANISM_CODE; */ 
  

    /* EXEC SQL DECLARE RL_SENSITIVITY_CUR_FORMAT4 CURSOR FOR
              SELECT ANTIBIOTIC_CODE,
                     SENSITIVITY_IND,
					 MIC_RESULT,
					 zone_size
                FROM RL_RESULT_ORGANISM_DTL
               WHERE PATIENT_ID      = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
				 AND ORGANISM_CODE   = :rl_res_organism_code 
                 AND REPORT_YN       = 'Y'
				 AND SENSITIVITY_IND IN('S','R','I')
               ORDER BY SEQ_NO; */ 
  

/*   changed on 28/01/2002 and made as a implicit select statement

    EXEC SQL DECLARE RL_ORGANISM_CODE_CUR CURSOR FOR
              SELECT LONG_DESC
                FROM RL_ORGANISM_CODE
               WHERE ORGANISM_CODE = :rl_res_organism_code;
*/

/*   changed on 28/01/2002 and made as a implicit select statement

    EXEC SQL DECLARE RL_ANTIBIOTIC_CODE_CUR CURSOR FOR
              SELECT SUBSTR(LONG_DESC,1,39)
                FROM RL_ANTIBIOTIC_CODE
               WHERE ANTIBIOTIC_CODE = :rl_res_dtl_antibiotic_code;
*/
}

/*-----------------------------------------------------*/
gen_extra_file_name()
{

     p_rep_file_fax_ext.arr[0]   = '\0';   
     p_rep_file_fax_ext.len      = 0;



	 if (l_destn_rep_yn == 'Y')	
			sprintf(extra_file_name,"%srslt_%s.ext",WORKING_DIR,nd_file_no.arr);

	 if (l_destn_fax_yn == 'Y' || l_destn_mail_yn == 'Y')	// mail condn added on 07.08.2005
	 {
		 gen_file_name_fax();
		 sprintf(p_rep_file_fax_ext.arr,"%srslt_%s.ext", nd_file_name_fax.arr,nd_file_no.arr);

		 p_rep_file_fax_ext.len  = strlen(p_rep_file_fax_ext.arr);

		 if (l_destn_rep_yn != 'Y') 
			strcpy(extra_file_name, p_rep_file_fax_ext.arr);

	 }



				/************************************************/ 
				   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
				   {

					l_text.arr[0]		    = '\0';
					l_text.len            = 0;
					strcpy(l_text.arr,"IN GENERATE EXTRA FILE NAME......");
					write_to_file();
				   }

				/************************************************/

   strcpy(nd_e_name,extra_file_name);
   if ((fp = fopen(extra_file_name,"w")) == NULL)
   {
				/************************************************/ 
				   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
				   {

					l_text.arr[0]		    = '\0';
					l_text.len            = 0;
					strcpy(l_text.arr,"IN GENERATE EXTRA FILE NAME......ERROR");
					write_to_file();
				   }

				/************************************************/

				strcpy(string_var, "");
				sprintf(string_var, "E-[%c]<->%s::Mail-[%c]<->[%c]", l_destn_rep_yn, extra_file_name, l_destn_mail_yn, l_destn_fax_yn);

				ins_message(ERR_MESG, string_var);



   }
		/************************************************/ 
		   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
		   {

			l_text.arr[0]		    = '\0';
			l_text.len            = 0;
			strcpy(l_text.arr,"IN GENERATE EXTRA FILE NAME......LAST");
			write_to_file();
		   }

		/************************************************/


}
/*-----------------------------------------------------*/
gen_file_name()
{


     nd_file_name.arr[0]   = '\0';   
     nd_file_name.len      = 0;

     p_rep_file_fax.arr[0]   = '\0';   
	 p_rep_file_fax.len      = 0;


     /* EXEC SQL 
	          SELECT LTRIM(RTRIM(TO_CHAR(RL_PRINT_CTL_SEQ.NEXTVAL,'00000009')))
	            INTO :nd_file_no
	            FROM DUAL; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 25;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select LTRIM(RTRIM(TO_CHAR(RL_PRINT_CTL_SEQ.nextval ,'00\
000009'))) into :b0  from DUAL ";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )1730;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&nd_file_no;
     sqlstm.sqhstl[0] = (unsigned int  )17;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




     if (OERROR)
         ins_message(ORA_MESG,"Fetch failed on while getting file number1");


     nd_file_no.arr[nd_file_no.len] = '\0';

	 check_for_print_destn_type();   // 17.05.2004


	 if (l_destn_rep_yn == 'Y')	
	     sprintf(nd_file_name.arr,"%srslt_%s.lis", WORKING_DIR,nd_file_no.arr);



	 if (l_destn_fax_yn == 'Y' || l_destn_mail_yn == 'Y')  /// added mail condn on 07.08.2005
	 {


		 gen_file_name_fax();



		 sprintf(p_rep_file_fax.arr,"%srslt_%s.lis", nd_file_name_fax.arr,nd_file_no.arr);

		 p_rep_file_fax.len  = strlen(p_rep_file_fax.arr);

		 if (l_destn_rep_yn != 'Y') 
			strcpy(nd_file_name.arr, p_rep_file_fax.arr);

     }
	 strcpy(nd_f_name,nd_file_name.arr);

	 nd_file_name.len = strlen(nd_file_name.arr);

			/************************************************/ 
			   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN GENERATE FILE NAME......");
				write_to_file();
			   }

			/************************************************/
//sprintf(string_var, "Dir --->    %s   %s", nd_file_name.arr,  p_rep_file_fax.arr);

//disp_message(ERR_MESG, string_var);


     if ((fp = fopen(nd_file_name.arr,"w")) == NULL)
     {
			/************************************************/ 
			   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN GENERATE FILE NAME......ERROR");
				write_to_file();
			   }

			/************************************************/

				strcpy(string_var, "");
				sprintf(string_var, "F-[%c]<->%s::Mail-[%c]<->[%c]", l_destn_rep_yn, nd_file_name.arr, l_destn_mail_yn, l_destn_fax_yn);
				ins_message(ERR_MESG, string_var);



     }
			/************************************************/ 
			   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN GENERATE FILE NAME......LAST");
				write_to_file();
			   }

			/************************************************/


}
/*-----------------------------------------------------*/
close_hdr()
{
    /* EXEC SQL CLOSE RL_REQ_HDR_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 25;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )1749;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"CLOSE failed on cursor RL_REQ_HDR_CUR");
}

/*-----------------------------------------------------*/
open_hdr()
{
    /* EXEC SQL OPEN RL_REQ_HDR_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 25;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0040;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )1764;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )7;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	if (RESOURCE_BUSY)
	{
		ins_message(ORA_MESG,"OPEN failed resource busy RL_REQ_HDR_CUR");
	}

    if (OERROR)
	{
         ins_message(ORA_MESG,"OPEN failed on cursor RL_REQ_HDR_CUR");
	}


}
/*-----------------------------------------------------*/

fetch_hdr()
{
  rl_hdr_source_code.arr[0]            = '\0';
  rl_hdr_consultant_code.arr[0]        = '\0';
  rl_hdr_spec_regd_date_time.arr[0]    = '\0';
  rl_hdr_spec_recd_date_time.arr[0]    = '\0';
  rl_hdr_spec_colltd_date_time.arr[0]  = '\0';
  rl_hdr_current_date_time.arr[0]      = '\0';
  rl_hdr_section_code.arr[0]           = '\0';
  rl_hdr_request_comment_code1.arr[0]  = '\0';
  rl_hdr_request_comment_code2.arr[0]  = '\0';
  rl_hdr_request_comment_code3.arr[0]  = '\0';
  rl_hdr_request_comment_desc1.arr[0]  = '\0';
  rl_hdr_request_comment_desc2.arr[0]  = '\0';
  rl_hdr_request_comment_desc3.arr[0]  = '\0';
  rl_hdr_extra_copies_to.arr[0]        = '\0';
  rl_hdr_specimen_type_code.arr[0]     = '\0';
  rl_hdr_added_by_id.arr[0]            = '\0';
  rl_hdr_added_date.arr[0]             = '\0';
  rl_hdr_modified_by_id.arr[0]         = '\0';
  rl_hdr_modified_date.arr[0]          = '\0';
  rl_hdr_episode_type.arr[0]           = '\0';
  rl_hdr_urgent_indicator.arr[0]       = '\0';
  rl_hdr_source_type.arr[0]		       = '\0';
  rl_hdr_released_by_id.arr[0]		   = '\0';
  rl_hdr_released_date.arr[0]		   = '\0';
  rl_category_code.arr[0]			   = '\0';
  rl_category_year.arr[0]			   = '\0';
  rl_category_number.arr[0]			   = '\0';
  rl_regd_date.arr[0]				   = '\0';
  rl_ordered_facility_id.arr[0]		   = '\0';
  rl_ordering_doctor_name.arr[0]	   = '\0';
  nd_hosp_no.arr[0]              	   = '\0';
  rl_order_id.arr[0]				   = '\0';
  rl_perform_site_code.arr[0]		   = '\0';

  rl_hdr_source_code.len               = 0;
  rl_hdr_consultant_code.len           = 0;
  rl_hdr_spec_regd_date_time.len       = 0;
  rl_hdr_spec_recd_date_time.len       = 0;
  rl_hdr_spec_colltd_date_time.len     = 0;
  rl_hdr_current_date_time.len         = 0;
  rl_hdr_section_code.len              = 0;
  rl_hdr_request_comment_code1.len     = 0;
  rl_hdr_request_comment_code2.len     = 0;
  rl_hdr_request_comment_code3.len     = 0;
  rl_hdr_request_comment_desc1.len     = 0;
  rl_hdr_request_comment_desc2.len     = 0;
  rl_hdr_request_comment_desc3.len     = 0;
  rl_hdr_extra_copies_to.len           = 0;
  rl_hdr_specimen_type_code.len        = 0;
  rl_hdr_added_by_id.len               = 0;
  rl_hdr_added_date.len                = 0;
  rl_hdr_modified_by_id.len            = 0;
  rl_hdr_modified_date.len             = 0;
  rl_hdr_episode_type.len	           = 0;
  rl_hdr_urgent_indicator.len	       = 0;
  rl_hdr_source_type.len	           = 0;
  rl_hdr_released_by_id.len            = 0;
  rl_hdr_released_date.len             = 0;
  rl_category_code.len					= 0;
  rl_category_year.len					= 0;
  rl_category_number.len				= 0;
  rl_regd_date.len						= 0;
  rl_ordered_facility_id.len			= 0;
  rl_ordering_doctor_name.len  			= 0;
  nd_hosp_no.len                        = 0;
  rl_order_id.len			 			= 0; 
  rl_perform_site_code.len				= 0; 
  

    /* EXEC SQL FETCH RL_REQ_HDR_CUR
              INTO :rl_hdr_source_code,
                   :rl_hdr_consultant_code,
                   :rl_hdr_spec_recd_date_time,
                   :rl_hdr_spec_regd_date_time,
			       :rl_hdr_spec_colltd_date_time,
                   :rl_hdr_current_date_time,
                   :rl_hdr_section_code,
                   :rl_hdr_request_comment_code1,
                   :rl_hdr_request_comment_code2,
                   :rl_hdr_request_comment_code3,
                   :rl_hdr_request_comment_desc1,
                   :rl_hdr_request_comment_desc2,
                   :rl_hdr_request_comment_desc3,
                   :rl_hdr_extra_copies_to,
                   :rl_hdr_specimen_type_code,
                   :rl_hdr_added_by_id,
                   :rl_hdr_added_date,
                   :rl_hdr_modified_by_id,
                   :rl_hdr_modified_date,
  				   :rl_hdr_urgent_indicator,
  				   :rl_hdr_episode_type,
				   :rl_hdr_source_type,
				   :rl_hdr_released_by_id,
				   :rl_hdr_released_date,
				   :rl_category_code,
				   :rl_category_year,
				   :rl_category_number,
				   :rl_regd_date,
				   :rl_ordered_facility_id,
				   :rl_ordering_doctor_name,
				   :nd_hosp_no,   //// 12.12.2004
				   :rl_order_id,  //// 11.04.2005
				   :rl_perform_site_code; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )1787;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_hdr_source_code;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_hdr_consultant_code;
    sqlstm.sqhstl[1] = (unsigned int  )18;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_hdr_spec_recd_date_time;
    sqlstm.sqhstl[2] = (unsigned int  )19;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_hdr_spec_regd_date_time;
    sqlstm.sqhstl[3] = (unsigned int  )19;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_hdr_spec_colltd_date_time;
    sqlstm.sqhstl[4] = (unsigned int  )19;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&rl_hdr_current_date_time;
    sqlstm.sqhstl[5] = (unsigned int  )19;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&rl_hdr_section_code;
    sqlstm.sqhstl[6] = (unsigned int  )4;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&rl_hdr_request_comment_code1;
    sqlstm.sqhstl[7] = (unsigned int  )7;
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqhstv[8] = (         void  *)&rl_hdr_request_comment_code2;
    sqlstm.sqhstl[8] = (unsigned int  )7;
    sqlstm.sqhsts[8] = (         int  )0;
    sqlstm.sqindv[8] = (         void  *)0;
    sqlstm.sqinds[8] = (         int  )0;
    sqlstm.sqharm[8] = (unsigned int  )0;
    sqlstm.sqadto[8] = (unsigned short )0;
    sqlstm.sqtdso[8] = (unsigned short )0;
    sqlstm.sqhstv[9] = (         void  *)&rl_hdr_request_comment_code3;
    sqlstm.sqhstl[9] = (unsigned int  )7;
    sqlstm.sqhsts[9] = (         int  )0;
    sqlstm.sqindv[9] = (         void  *)0;
    sqlstm.sqinds[9] = (         int  )0;
    sqlstm.sqharm[9] = (unsigned int  )0;
    sqlstm.sqadto[9] = (unsigned short )0;
    sqlstm.sqtdso[9] = (unsigned short )0;
    sqlstm.sqhstv[10] = (         void  *)&rl_hdr_request_comment_desc1;
    sqlstm.sqhstl[10] = (unsigned int  )43;
    sqlstm.sqhsts[10] = (         int  )0;
    sqlstm.sqindv[10] = (         void  *)0;
    sqlstm.sqinds[10] = (         int  )0;
    sqlstm.sqharm[10] = (unsigned int  )0;
    sqlstm.sqadto[10] = (unsigned short )0;
    sqlstm.sqtdso[10] = (unsigned short )0;
    sqlstm.sqhstv[11] = (         void  *)&rl_hdr_request_comment_desc2;
    sqlstm.sqhstl[11] = (unsigned int  )43;
    sqlstm.sqhsts[11] = (         int  )0;
    sqlstm.sqindv[11] = (         void  *)0;
    sqlstm.sqinds[11] = (         int  )0;
    sqlstm.sqharm[11] = (unsigned int  )0;
    sqlstm.sqadto[11] = (unsigned short )0;
    sqlstm.sqtdso[11] = (unsigned short )0;
    sqlstm.sqhstv[12] = (         void  *)&rl_hdr_request_comment_desc3;
    sqlstm.sqhstl[12] = (unsigned int  )43;
    sqlstm.sqhsts[12] = (         int  )0;
    sqlstm.sqindv[12] = (         void  *)0;
    sqlstm.sqinds[12] = (         int  )0;
    sqlstm.sqharm[12] = (unsigned int  )0;
    sqlstm.sqadto[12] = (unsigned short )0;
    sqlstm.sqtdso[12] = (unsigned short )0;
    sqlstm.sqhstv[13] = (         void  *)&rl_hdr_extra_copies_to;
    sqlstm.sqhstl[13] = (unsigned int  )18;
    sqlstm.sqhsts[13] = (         int  )0;
    sqlstm.sqindv[13] = (         void  *)0;
    sqlstm.sqinds[13] = (         int  )0;
    sqlstm.sqharm[13] = (unsigned int  )0;
    sqlstm.sqadto[13] = (unsigned short )0;
    sqlstm.sqtdso[13] = (unsigned short )0;
    sqlstm.sqhstv[14] = (         void  *)&rl_hdr_specimen_type_code;
    sqlstm.sqhstl[14] = (unsigned int  )7;
    sqlstm.sqhsts[14] = (         int  )0;
    sqlstm.sqindv[14] = (         void  *)0;
    sqlstm.sqinds[14] = (         int  )0;
    sqlstm.sqharm[14] = (unsigned int  )0;
    sqlstm.sqadto[14] = (unsigned short )0;
    sqlstm.sqtdso[14] = (unsigned short )0;
    sqlstm.sqhstv[15] = (         void  *)&rl_hdr_added_by_id;
    sqlstm.sqhstl[15] = (unsigned int  )33;
    sqlstm.sqhsts[15] = (         int  )0;
    sqlstm.sqindv[15] = (         void  *)0;
    sqlstm.sqinds[15] = (         int  )0;
    sqlstm.sqharm[15] = (unsigned int  )0;
    sqlstm.sqadto[15] = (unsigned short )0;
    sqlstm.sqtdso[15] = (unsigned short )0;
    sqlstm.sqhstv[16] = (         void  *)&rl_hdr_added_date;
    sqlstm.sqhstl[16] = (unsigned int  )18;
    sqlstm.sqhsts[16] = (         int  )0;
    sqlstm.sqindv[16] = (         void  *)0;
    sqlstm.sqinds[16] = (         int  )0;
    sqlstm.sqharm[16] = (unsigned int  )0;
    sqlstm.sqadto[16] = (unsigned short )0;
    sqlstm.sqtdso[16] = (unsigned short )0;
    sqlstm.sqhstv[17] = (         void  *)&rl_hdr_modified_by_id;
    sqlstm.sqhstl[17] = (unsigned int  )33;
    sqlstm.sqhsts[17] = (         int  )0;
    sqlstm.sqindv[17] = (         void  *)0;
    sqlstm.sqinds[17] = (         int  )0;
    sqlstm.sqharm[17] = (unsigned int  )0;
    sqlstm.sqadto[17] = (unsigned short )0;
    sqlstm.sqtdso[17] = (unsigned short )0;
    sqlstm.sqhstv[18] = (         void  *)&rl_hdr_modified_date;
    sqlstm.sqhstl[18] = (unsigned int  )18;
    sqlstm.sqhsts[18] = (         int  )0;
    sqlstm.sqindv[18] = (         void  *)0;
    sqlstm.sqinds[18] = (         int  )0;
    sqlstm.sqharm[18] = (unsigned int  )0;
    sqlstm.sqadto[18] = (unsigned short )0;
    sqlstm.sqtdso[18] = (unsigned short )0;
    sqlstm.sqhstv[19] = (         void  *)&rl_hdr_urgent_indicator;
    sqlstm.sqhstl[19] = (unsigned int  )4;
    sqlstm.sqhsts[19] = (         int  )0;
    sqlstm.sqindv[19] = (         void  *)0;
    sqlstm.sqinds[19] = (         int  )0;
    sqlstm.sqharm[19] = (unsigned int  )0;
    sqlstm.sqadto[19] = (unsigned short )0;
    sqlstm.sqtdso[19] = (unsigned short )0;
    sqlstm.sqhstv[20] = (         void  *)&rl_hdr_episode_type;
    sqlstm.sqhstl[20] = (unsigned int  )4;
    sqlstm.sqhsts[20] = (         int  )0;
    sqlstm.sqindv[20] = (         void  *)0;
    sqlstm.sqinds[20] = (         int  )0;
    sqlstm.sqharm[20] = (unsigned int  )0;
    sqlstm.sqadto[20] = (unsigned short )0;
    sqlstm.sqtdso[20] = (unsigned short )0;
    sqlstm.sqhstv[21] = (         void  *)&rl_hdr_source_type;
    sqlstm.sqhstl[21] = (unsigned int  )4;
    sqlstm.sqhsts[21] = (         int  )0;
    sqlstm.sqindv[21] = (         void  *)0;
    sqlstm.sqinds[21] = (         int  )0;
    sqlstm.sqharm[21] = (unsigned int  )0;
    sqlstm.sqadto[21] = (unsigned short )0;
    sqlstm.sqtdso[21] = (unsigned short )0;
    sqlstm.sqhstv[22] = (         void  *)&rl_hdr_released_by_id;
    sqlstm.sqhstl[22] = (unsigned int  )33;
    sqlstm.sqhsts[22] = (         int  )0;
    sqlstm.sqindv[22] = (         void  *)0;
    sqlstm.sqinds[22] = (         int  )0;
    sqlstm.sqharm[22] = (unsigned int  )0;
    sqlstm.sqadto[22] = (unsigned short )0;
    sqlstm.sqtdso[22] = (unsigned short )0;
    sqlstm.sqhstv[23] = (         void  *)&rl_hdr_released_date;
    sqlstm.sqhstl[23] = (unsigned int  )23;
    sqlstm.sqhsts[23] = (         int  )0;
    sqlstm.sqindv[23] = (         void  *)0;
    sqlstm.sqinds[23] = (         int  )0;
    sqlstm.sqharm[23] = (unsigned int  )0;
    sqlstm.sqadto[23] = (unsigned short )0;
    sqlstm.sqtdso[23] = (unsigned short )0;
    sqlstm.sqhstv[24] = (         void  *)&rl_category_code;
    sqlstm.sqhstl[24] = (unsigned int  )7;
    sqlstm.sqhsts[24] = (         int  )0;
    sqlstm.sqindv[24] = (         void  *)0;
    sqlstm.sqinds[24] = (         int  )0;
    sqlstm.sqharm[24] = (unsigned int  )0;
    sqlstm.sqadto[24] = (unsigned short )0;
    sqlstm.sqtdso[24] = (unsigned short )0;
    sqlstm.sqhstv[25] = (         void  *)&rl_category_year;
    sqlstm.sqhstl[25] = (unsigned int  )7;
    sqlstm.sqhsts[25] = (         int  )0;
    sqlstm.sqindv[25] = (         void  *)0;
    sqlstm.sqinds[25] = (         int  )0;
    sqlstm.sqharm[25] = (unsigned int  )0;
    sqlstm.sqadto[25] = (unsigned short )0;
    sqlstm.sqtdso[25] = (unsigned short )0;
    sqlstm.sqhstv[26] = (         void  *)&rl_category_number;
    sqlstm.sqhstl[26] = (unsigned int  )23;
    sqlstm.sqhsts[26] = (         int  )0;
    sqlstm.sqindv[26] = (         void  *)0;
    sqlstm.sqinds[26] = (         int  )0;
    sqlstm.sqharm[26] = (unsigned int  )0;
    sqlstm.sqadto[26] = (unsigned short )0;
    sqlstm.sqtdso[26] = (unsigned short )0;
    sqlstm.sqhstv[27] = (         void  *)&rl_regd_date;
    sqlstm.sqhstl[27] = (unsigned int  )13;
    sqlstm.sqhsts[27] = (         int  )0;
    sqlstm.sqindv[27] = (         void  *)0;
    sqlstm.sqinds[27] = (         int  )0;
    sqlstm.sqharm[27] = (unsigned int  )0;
    sqlstm.sqadto[27] = (unsigned short )0;
    sqlstm.sqtdso[27] = (unsigned short )0;
    sqlstm.sqhstv[28] = (         void  *)&rl_ordered_facility_id;
    sqlstm.sqhstl[28] = (unsigned int  )5;
    sqlstm.sqhsts[28] = (         int  )0;
    sqlstm.sqindv[28] = (         void  *)0;
    sqlstm.sqinds[28] = (         int  )0;
    sqlstm.sqharm[28] = (unsigned int  )0;
    sqlstm.sqadto[28] = (unsigned short )0;
    sqlstm.sqtdso[28] = (unsigned short )0;
    sqlstm.sqhstv[29] = (         void  *)&rl_ordering_doctor_name;
    sqlstm.sqhstl[29] = (unsigned int  )43;
    sqlstm.sqhsts[29] = (         int  )0;
    sqlstm.sqindv[29] = (         void  *)0;
    sqlstm.sqinds[29] = (         int  )0;
    sqlstm.sqharm[29] = (unsigned int  )0;
    sqlstm.sqadto[29] = (unsigned short )0;
    sqlstm.sqtdso[29] = (unsigned short )0;
    sqlstm.sqhstv[30] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[30] = (unsigned int  )23;
    sqlstm.sqhsts[30] = (         int  )0;
    sqlstm.sqindv[30] = (         void  *)0;
    sqlstm.sqinds[30] = (         int  )0;
    sqlstm.sqharm[30] = (unsigned int  )0;
    sqlstm.sqadto[30] = (unsigned short )0;
    sqlstm.sqtdso[30] = (unsigned short )0;
    sqlstm.sqhstv[31] = (         void  *)&rl_order_id;
    sqlstm.sqhstl[31] = (unsigned int  )23;
    sqlstm.sqhsts[31] = (         int  )0;
    sqlstm.sqindv[31] = (         void  *)0;
    sqlstm.sqinds[31] = (         int  )0;
    sqlstm.sqharm[31] = (unsigned int  )0;
    sqlstm.sqadto[31] = (unsigned short )0;
    sqlstm.sqtdso[31] = (unsigned short )0;
    sqlstm.sqhstv[32] = (         void  *)&rl_perform_site_code;
    sqlstm.sqhstl[32] = (unsigned int  )7;
    sqlstm.sqhsts[32] = (         int  )0;
    sqlstm.sqindv[32] = (         void  *)0;
    sqlstm.sqinds[32] = (         int  )0;
    sqlstm.sqharm[32] = (unsigned int  )0;
    sqlstm.sqadto[32] = (unsigned short )0;
    sqlstm.sqtdso[32] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 /// 31.10.2006

    if (OERROR)
        ins_message(ORA_MESG,"FETCH failed on cursor RL_REQ_HDR_CUR");

    rl_hdr_source_code.arr[rl_hdr_source_code.len]		 	= '\0';
    rl_hdr_consultant_code.arr[rl_hdr_consultant_code.len]		= '\0';
    rl_hdr_spec_recd_date_time.arr[rl_hdr_spec_recd_date_time.len] 	= '\0';
    rl_hdr_spec_regd_date_time.arr[rl_hdr_spec_regd_date_time.len] 	= '\0';
    rl_hdr_spec_colltd_date_time.arr[rl_hdr_spec_colltd_date_time.len] = '\0';
    rl_hdr_current_date_time.arr[rl_hdr_current_date_time.len] 		= '\0';
    rl_hdr_section_code.arr[rl_hdr_section_code.len] 			= '\0';
    rl_hdr_request_comment_code1.arr[rl_hdr_request_comment_code1.len] = '\0';
    rl_hdr_request_comment_code2.arr[rl_hdr_request_comment_code2.len] = '\0';
    rl_hdr_request_comment_code3.arr[rl_hdr_request_comment_code3.len] = '\0';
    rl_hdr_request_comment_desc1.arr[rl_hdr_request_comment_desc1.len] = '\0';
    rl_hdr_request_comment_desc2.arr[rl_hdr_request_comment_desc2.len] = '\0';
    rl_hdr_request_comment_desc3.arr[rl_hdr_request_comment_desc3.len] = '\0';
    rl_hdr_extra_copies_to.arr[rl_hdr_extra_copies_to.len]             = '\0';
    rl_hdr_specimen_type_code.arr[rl_hdr_specimen_type_code.len]       = '\0';
    rl_hdr_added_by_id.arr[rl_hdr_added_by_id.len]                     = '\0';
    rl_hdr_added_date.arr[rl_hdr_added_date.len]                       = '\0';
    rl_hdr_modified_by_id.arr[rl_hdr_modified_by_id.len]               = '\0';
    rl_hdr_modified_date.arr[rl_hdr_modified_date.len]                 = '\0';
    rl_hdr_episode_type.arr[rl_hdr_episode_type.len]					= '\0';
    rl_hdr_urgent_indicator.arr[rl_hdr_urgent_indicator.len]			= '\0';
    rl_hdr_source_type.arr[rl_hdr_source_type.len]						= '\0';
    rl_hdr_released_by_id.arr[rl_hdr_released_by_id.len]				= '\0';
    rl_hdr_released_date.arr[rl_hdr_released_date.len]					= '\0';
	rl_category_code.arr[rl_category_code.len]							= '\0';
	rl_category_year.arr[rl_category_year.len]							= '\0';
	rl_category_number.arr[rl_category_number.len]						= '\0';
	rl_regd_date.arr[rl_regd_date.len]									= '\0';
	rl_ordered_facility_id.arr[rl_ordered_facility_id.len]				= '\0';
	rl_ordering_doctor_name.arr[rl_ordering_doctor_name.len]			= '\0';
	nd_hosp_no.arr[nd_hosp_no.len]										= '\0';
	rl_order_id.arr[rl_order_id.len]									= '\0';	 
	rl_perform_site_code.arr[rl_perform_site_code.len]					= '\0';	 
	

	/* To Override the Source Code which is sending through SY_PROG_PARAM *****/
/********** This portion is commented on 03/06/2001
		The result report should print in the current location of patient
	 strcpy(rl_prn_ctrl_hdr_source_code.arr, rl_hdr_source_code.arr);
	 rl_prn_ctrl_hdr_source_code.len = strlen(rl_prn_ctrl_hdr_source_code.arr);
********************************************/

    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/

fetch_dtl()
{
    /* EXEC SQL OPEN RL_REQ_DTL_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0041;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )1934;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&first_specimen_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_REQ_DTL_CUR");

    for (i=0;i<99;i++)
    {
        rl_dtl_test_code[i].arr[0]         = '\0';
        rl_dtl_result_status[i].arr[0]     = '\0';
        rl_dtl_group_test_flag[i].arr[0]   = '\0';

        rl_dtl_test_code[i].len            = 0;
        rl_dtl_result_status[i].len        = 0;
        rl_dtl_group_test_flag[i].len      = 0;
    }

    /* EXEC SQL FETCH RL_REQ_DTL_CUR
              INTO :rl_dtl_test_code,
                   :rl_dtl_result_status,
                   :rl_dtl_group_test_flag; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )100;
    sqlstm.offset = (unsigned int  )1961;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)rl_dtl_test_code;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )16;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqharc[0] = (unsigned int   *)0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)rl_dtl_result_status;
    sqlstm.sqhstl[1] = (unsigned int  )4;
    sqlstm.sqhsts[1] = (         int  )4;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqharc[1] = (unsigned int   *)0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)rl_dtl_group_test_flag;
    sqlstm.sqhstl[2] = (unsigned int  )4;
    sqlstm.sqhsts[2] = (         int  )4;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqharc[2] = (unsigned int   *)0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_REQ_DTL_CUR");

    no_of_dtl_recs = sqlca.sqlerrd[2];

    for (i=0;i<sqlca.sqlerrd[2];i++)
    {
        rl_dtl_test_code[i].arr[rl_dtl_test_code[i].len]         = '\0';
        rl_dtl_result_status[i].arr[rl_dtl_result_status[i].len] = '\0';
        rl_dtl_group_test_flag[i].arr[rl_dtl_group_test_flag[i].len]  = '\0';
    }
}
/*-----------------------------------------------------*/
/******* modified order by on 29.09.2003 *******/
declare_tst_result_curs()
{
    sql_stmt.arr[0]		= '\0';  
	sql_stmt.len		= 0;
	
	strcpy(sql_stmt.arr, "SELECT B.specimen_no, \
					 B.GROUP_TEST_CODE, \
                     B.TEST_CODE, \
                     NVL(NUMERIC_PREFIX,'+'), \
                     NUMERIC_RESULT, \
					 RESULT_COMMENT_DESC1, \
                     RESULT_COMMENT_DESC2, \
                     RESULT_COMMENT_DESC3, \
                     RESULT_COMMENT_DESC4, \
					 B.TEST_UNITS, \
					 TEST_REF_RANGE_COMMENT, \
					 AGE_RANGE_LOW, \
					 AGE_RANGE_HIGH, \
                     B.ROWID AS row_id, \
					 NVL(HIDE_RESULT_COMMENTS_YN,'N'), \
					 B.high_low_ind, \
					 A.seq_no, \
					 NVL(B.cancelled_yn, 'N'), \
					 B.released_by_id, \
					 TO_CHAR(B.released_date, 'DD/MM/YYYY HH24:MI'), \
					 NVL(B.numeric_result_hide_yn, 'N') numeric_result_hide_yn, \
					 NVL(B.status, 'O') status,  \
					 NVL(C.interval_test_yn,'N'), \
					 NVL(B.preliminary_release_yn,'N') preliminary_release_yn \
                FROM RL_INTERVAL_TEST_TEMP A, RL_TEST_RESULT B, RL_TEST_CODE C \
               WHERE B.PATIENT_ID = :nd_hosp_no \
                 AND A.specimen_no = B.specimen_no \
				 AND A.OPERATING_FACILITY_ID = :nd_operating_facility_id \
				 AND B.OPERATING_FACILITY_ID = :nd_operating_facility_id \
				 AND B.test_code = DECODE(A.test_code, NULL, B.test_code, A.test_code) \
				 AND B.group_test_code = A.group_test_code \
				 AND NVL(B.cancelled_yn, 'N') <> 'Y' \
				 AND A.user_id = 'RLRRSENQ' \
				 AND B.test_code = C.test_code \
				 AND A.session_id = 1 ");
	
	if (d_interval_specimen_yn == 'Y')
		strcat(sql_stmt.arr, " ORDER BY B.test_code, B.specimen_no, B.GROUP_SEQ_NO,B.GROUP_TEST_CODE,B.TEST_SEQ_NO,B.TEST_CODE FOR UPDATE OF B.STATUS NOWAIT");
	else
		strcat(sql_stmt.arr, " ORDER BY B.GROUP_SEQ_NO,B.GROUP_TEST_CODE,B.TEST_SEQ_NO,B.TEST_CODE FOR UPDATE OF B.STATUS NOWAIT");

		 
	sql_stmt.len = strlen(sql_stmt.arr);
	/* EXEC SQL PREPARE sr1 FROM :sql_stmt; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1988;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&sql_stmt;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		 ins_message(ORA_MESG,"PREPARE failed on table RL_TEST_RESULT");

    /* EXEC SQL DECLARE rl_test_result_cur CURSOR FOR sr1; */ 
		

}
/*-----------------------------------------------------*/
open_tst_result_curs()
{
/////////////// 22.06.2003 modified added facility id also 

	/* EXEC SQL OPEN rl_test_result_cur USING :nd_hosp_no,:nd_operating_facility_id,:nd_operating_facility_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2007;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (RESOURCE_BUSY)
	{
		ins_message(ORA_MESG,"OPEN failed resource busy rl_test_result_cur");
	}


}
/*-----------------------------------------------------*/

/********** INCLUDED AS DYNAMIC SQL ***************
open_tst_result()
{
    EXEC SQL OPEN RL_TEST_RESULT_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_TEST_RESULT_CUR");
}
**********************/
/*-----------------------------------------------------*/
fetch_tst_result() 
{

  rl_tst_group_test_code.arr[0]      = '\0';
  rl_tst_test_code.arr[0]      = '\0';
  rl_tst_numeric_prefix.arr[0]      = '\0';
  rl_tst_numeric_result.arr[0]      = '\0';
  rl_tst_result_comment_desc1.arr[0]      = '\0';
  rl_tst_result_comment_desc2.arr[0]      = '\0';
  rl_tst_result_comment_desc3.arr[0]      = '\0';
  rl_tst_result_comment_desc4.arr[0]      = '\0';
  rl_tst_rowid.arr[0]                     = '\0';
  rl_tst_cd_test_units.arr[0]			= '\0';
  rl_tst_cd_range_cmt.arr[0]		  = '\0';
  rl_tst_ran_low_val_nor.arr[0]	  = '\0';
  rl_tst_ran_high_val_nor.arr[0]	  = '\0';
  rl_tst_hide_rslt_comm_yn.arr[0] = '\0';
  d_specimen_no.arr[0]			  = '\0';
  rl_high_low_ind.arr[0]		  = '\0';
  rl_cancelled_yn.arr[0]			  = '\0';
  rl_released_by_id.arr[0]			  = '\0';
  rl_released_date.arr[0]			  = '\0';
  rl_num_result_hide_yn.arr[0]		  = '\0';
  rl_tst_status.arr[0]				  = '\0';
  rl_tst_interval_test_yn.arr[0]      = '\0';
  rl_tst_preliminary_release_yn.arr[0]      = '\0';
  rl_tst_group_test_code.len         = 0;
  rl_tst_test_code.len         = 0;
  rl_tst_numeric_prefix.len         = 0;
  rl_tst_numeric_result.len         = 0;
  rl_tst_result_comment_desc1.len         = 0;
  rl_tst_result_comment_desc2.len         = 0;
  rl_tst_result_comment_desc3.len         = 0;
  rl_tst_result_comment_desc4.len         = 0;
  rl_tst_rowid.len                        = 0;
  rl_tst_cd_test_units.len		  = 0;
  rl_tst_cd_range_cmt.len		  = 0;
  rl_tst_ran_low_val_nor.len	  = 0;
  rl_tst_ran_high_val_nor.len	  = 0;
  rl_tst_hide_rslt_comm_yn.len	  = 0;
  d_specimen_no.len				  = 0;
  rl_high_low_ind.len			  = 0;
  rl_cancelled_yn.len			  = 0;
  rl_released_by_id.len			  = 0;
  rl_released_date.len			  = 0;
  rl_num_result_hide_yn.len		  = 0;
  rl_tst_status.len				  = 0;   /// 21.05.2005
  rl_tst_interval_test_yn.len     = 0;
  rl_tst_preliminary_release_yn.len = 0; /// 22.08.2006

    /* EXEC SQL FETCH RL_TEST_RESULT_CUR
              INTO :d_specimen_no,
				   :rl_tst_group_test_code,
                   :rl_tst_test_code,
                   :rl_tst_numeric_prefix,
                   :rl_tst_numeric_result,
                   :rl_tst_result_comment_desc1,
                   :rl_tst_result_comment_desc2,
                   :rl_tst_result_comment_desc3,
                   :rl_tst_result_comment_desc4,
				   :rl_tst_cd_test_units,
				   :rl_tst_cd_range_cmt,
				   :rl_tst_ran_low_val_nor,
				   :rl_tst_ran_high_val_nor,
                   :rl_tst_rowid,
				   :rl_tst_hide_rslt_comm_yn,
				   :rl_high_low_ind, 
				   :rl_seq_no,
				   :rl_cancelled_yn,
				   :rl_released_by_id,
				   :rl_released_date,
				   :rl_num_result_hide_yn,
				   :rl_tst_status,
				   :rl_tst_interval_test_yn,
				   :rl_tst_preliminary_release_yn; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2034;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&d_specimen_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[1] = (unsigned int  )13;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[2] = (unsigned int  )13;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_numeric_prefix;
    sqlstm.sqhstl[3] = (unsigned int  )4;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_numeric_result;
    sqlstm.sqhstl[4] = (unsigned int  )18;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&rl_tst_result_comment_desc1;
    sqlstm.sqhstl[5] = (unsigned int  )43;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&rl_tst_result_comment_desc2;
    sqlstm.sqhstl[6] = (unsigned int  )43;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&rl_tst_result_comment_desc3;
    sqlstm.sqhstl[7] = (unsigned int  )43;
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqhstv[8] = (         void  *)&rl_tst_result_comment_desc4;
    sqlstm.sqhstl[8] = (unsigned int  )43;
    sqlstm.sqhsts[8] = (         int  )0;
    sqlstm.sqindv[8] = (         void  *)0;
    sqlstm.sqinds[8] = (         int  )0;
    sqlstm.sqharm[8] = (unsigned int  )0;
    sqlstm.sqadto[8] = (unsigned short )0;
    sqlstm.sqtdso[8] = (unsigned short )0;
    sqlstm.sqhstv[9] = (         void  *)&rl_tst_cd_test_units;
    sqlstm.sqhstl[9] = (unsigned int  )13;
    sqlstm.sqhsts[9] = (         int  )0;
    sqlstm.sqindv[9] = (         void  *)0;
    sqlstm.sqinds[9] = (         int  )0;
    sqlstm.sqharm[9] = (unsigned int  )0;
    sqlstm.sqadto[9] = (unsigned short )0;
    sqlstm.sqtdso[9] = (unsigned short )0;
    sqlstm.sqhstv[10] = (         void  *)&rl_tst_cd_range_cmt;
    sqlstm.sqhstl[10] = (unsigned int  )43;
    sqlstm.sqhsts[10] = (         int  )0;
    sqlstm.sqindv[10] = (         void  *)0;
    sqlstm.sqinds[10] = (         int  )0;
    sqlstm.sqharm[10] = (unsigned int  )0;
    sqlstm.sqadto[10] = (unsigned short )0;
    sqlstm.sqtdso[10] = (unsigned short )0;
    sqlstm.sqhstv[11] = (         void  *)&rl_tst_ran_low_val_nor;
    sqlstm.sqhstl[11] = (unsigned int  )18;
    sqlstm.sqhsts[11] = (         int  )0;
    sqlstm.sqindv[11] = (         void  *)0;
    sqlstm.sqinds[11] = (         int  )0;
    sqlstm.sqharm[11] = (unsigned int  )0;
    sqlstm.sqadto[11] = (unsigned short )0;
    sqlstm.sqtdso[11] = (unsigned short )0;
    sqlstm.sqhstv[12] = (         void  *)&rl_tst_ran_high_val_nor;
    sqlstm.sqhstl[12] = (unsigned int  )18;
    sqlstm.sqhsts[12] = (         int  )0;
    sqlstm.sqindv[12] = (         void  *)0;
    sqlstm.sqinds[12] = (         int  )0;
    sqlstm.sqharm[12] = (unsigned int  )0;
    sqlstm.sqadto[12] = (unsigned short )0;
    sqlstm.sqtdso[12] = (unsigned short )0;
    sqlstm.sqhstv[13] = (         void  *)&rl_tst_rowid;
    sqlstm.sqhstl[13] = (unsigned int  )33;
    sqlstm.sqhsts[13] = (         int  )0;
    sqlstm.sqindv[13] = (         void  *)0;
    sqlstm.sqinds[13] = (         int  )0;
    sqlstm.sqharm[13] = (unsigned int  )0;
    sqlstm.sqadto[13] = (unsigned short )0;
    sqlstm.sqtdso[13] = (unsigned short )0;
    sqlstm.sqhstv[14] = (         void  *)&rl_tst_hide_rslt_comm_yn;
    sqlstm.sqhstl[14] = (unsigned int  )4;
    sqlstm.sqhsts[14] = (         int  )0;
    sqlstm.sqindv[14] = (         void  *)0;
    sqlstm.sqinds[14] = (         int  )0;
    sqlstm.sqharm[14] = (unsigned int  )0;
    sqlstm.sqadto[14] = (unsigned short )0;
    sqlstm.sqtdso[14] = (unsigned short )0;
    sqlstm.sqhstv[15] = (         void  *)&rl_high_low_ind;
    sqlstm.sqhstl[15] = (unsigned int  )12;
    sqlstm.sqhsts[15] = (         int  )0;
    sqlstm.sqindv[15] = (         void  *)0;
    sqlstm.sqinds[15] = (         int  )0;
    sqlstm.sqharm[15] = (unsigned int  )0;
    sqlstm.sqadto[15] = (unsigned short )0;
    sqlstm.sqtdso[15] = (unsigned short )0;
    sqlstm.sqhstv[16] = (         void  *)&rl_seq_no;
    sqlstm.sqhstl[16] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[16] = (         int  )0;
    sqlstm.sqindv[16] = (         void  *)0;
    sqlstm.sqinds[16] = (         int  )0;
    sqlstm.sqharm[16] = (unsigned int  )0;
    sqlstm.sqadto[16] = (unsigned short )0;
    sqlstm.sqtdso[16] = (unsigned short )0;
    sqlstm.sqhstv[17] = (         void  *)&rl_cancelled_yn;
    sqlstm.sqhstl[17] = (unsigned int  )4;
    sqlstm.sqhsts[17] = (         int  )0;
    sqlstm.sqindv[17] = (         void  *)0;
    sqlstm.sqinds[17] = (         int  )0;
    sqlstm.sqharm[17] = (unsigned int  )0;
    sqlstm.sqadto[17] = (unsigned short )0;
    sqlstm.sqtdso[17] = (unsigned short )0;
    sqlstm.sqhstv[18] = (         void  *)&rl_released_by_id;
    sqlstm.sqhstl[18] = (unsigned int  )33;
    sqlstm.sqhsts[18] = (         int  )0;
    sqlstm.sqindv[18] = (         void  *)0;
    sqlstm.sqinds[18] = (         int  )0;
    sqlstm.sqharm[18] = (unsigned int  )0;
    sqlstm.sqadto[18] = (unsigned short )0;
    sqlstm.sqtdso[18] = (unsigned short )0;
    sqlstm.sqhstv[19] = (         void  *)&rl_released_date;
    sqlstm.sqhstl[19] = (unsigned int  )19;
    sqlstm.sqhsts[19] = (         int  )0;
    sqlstm.sqindv[19] = (         void  *)0;
    sqlstm.sqinds[19] = (         int  )0;
    sqlstm.sqharm[19] = (unsigned int  )0;
    sqlstm.sqadto[19] = (unsigned short )0;
    sqlstm.sqtdso[19] = (unsigned short )0;
    sqlstm.sqhstv[20] = (         void  *)&rl_num_result_hide_yn;
    sqlstm.sqhstl[20] = (unsigned int  )4;
    sqlstm.sqhsts[20] = (         int  )0;
    sqlstm.sqindv[20] = (         void  *)0;
    sqlstm.sqinds[20] = (         int  )0;
    sqlstm.sqharm[20] = (unsigned int  )0;
    sqlstm.sqadto[20] = (unsigned short )0;
    sqlstm.sqtdso[20] = (unsigned short )0;
    sqlstm.sqhstv[21] = (         void  *)&rl_tst_status;
    sqlstm.sqhstl[21] = (unsigned int  )4;
    sqlstm.sqhsts[21] = (         int  )0;
    sqlstm.sqindv[21] = (         void  *)0;
    sqlstm.sqinds[21] = (         int  )0;
    sqlstm.sqharm[21] = (unsigned int  )0;
    sqlstm.sqadto[21] = (unsigned short )0;
    sqlstm.sqtdso[21] = (unsigned short )0;
    sqlstm.sqhstv[22] = (         void  *)&rl_tst_interval_test_yn;
    sqlstm.sqhstl[22] = (unsigned int  )4;
    sqlstm.sqhsts[22] = (         int  )0;
    sqlstm.sqindv[22] = (         void  *)0;
    sqlstm.sqinds[22] = (         int  )0;
    sqlstm.sqharm[22] = (unsigned int  )0;
    sqlstm.sqadto[22] = (unsigned short )0;
    sqlstm.sqtdso[22] = (unsigned short )0;
    sqlstm.sqhstv[23] = (         void  *)&rl_tst_preliminary_release_yn;
    sqlstm.sqhstl[23] = (unsigned int  )4;
    sqlstm.sqhsts[23] = (         int  )0;
    sqlstm.sqindv[23] = (         void  *)0;
    sqlstm.sqinds[23] = (         int  )0;
    sqlstm.sqharm[23] = (unsigned int  )0;
    sqlstm.sqadto[23] = (unsigned short )0;
    sqlstm.sqtdso[23] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_TEST_RESULT_CUR");

    rl_tst_group_test_code.arr[rl_tst_group_test_code.len] = '\0';
    rl_tst_test_code.arr[rl_tst_test_code.len] = '\0';
    rl_tst_numeric_prefix.arr[rl_tst_numeric_prefix.len] = '\0';
    rl_tst_numeric_result.arr[rl_tst_numeric_result.len] = '\0';
    rl_tst_result_comment_desc1.arr[rl_tst_result_comment_desc1.len] = '\0';
    rl_tst_result_comment_desc2.arr[rl_tst_result_comment_desc2.len] = '\0';
    rl_tst_result_comment_desc3.arr[rl_tst_result_comment_desc3.len] = '\0';
    rl_tst_result_comment_desc4.arr[rl_tst_result_comment_desc4.len] = '\0';
    rl_tst_rowid.arr[rl_tst_rowid.len] = '\0';
    rl_tst_cd_test_units.arr[rl_tst_cd_test_units.len]  	      = '\0';
    rl_tst_cd_range_cmt.arr[rl_tst_cd_range_cmt.len]		      = '\0';
    rl_tst_ran_low_val_nor.arr[rl_tst_ran_low_val_nor.len]	  = '\0';
    rl_tst_ran_high_val_nor.arr[rl_tst_ran_high_val_nor.len]	  = '\0';
    rl_tst_hide_rslt_comm_yn.arr[rl_tst_hide_rslt_comm_yn.len] = '\0';
	d_specimen_no.arr[d_specimen_no.len]					   = '\0';
	rl_high_low_ind.arr[rl_high_low_ind.len]				   = '\0';
	rl_cancelled_yn.arr[rl_cancelled_yn.len]				   = '\0';
	rl_released_by_id.arr[rl_released_by_id.len]			   = '\0';
	rl_released_date.arr[rl_released_date.len]				   = '\0';
	rl_num_result_hide_yn.arr[rl_num_result_hide_yn.len]	   = '\0';
	rl_tst_status.arr[rl_tst_status.len]					   = '\0';
    rl_tst_interval_test_yn.arr[rl_tst_interval_test_yn.len]   = '\0';
	rl_tst_preliminary_release_yn.arr[rl_tst_preliminary_release_yn.len] = '\0';

	strcpy(nd_spec_no.arr, d_specimen_no.arr);
	nd_spec_no.len = strlen(nd_spec_no.arr);

#ifdef DEBUG
    printf("Group is <%s> tst is <%s>\n",rl_tst_group_test_code.arr,
                       rl_tst_test_code.arr);
	printf("In fetch_tst_result, last_row = %d \n",
	LAST_ROW);
#endif
    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/
fetch_tst_result1()
{

  rl_tst_group_test_code.arr[0]      = '\0';
  rl_tst_test_code.arr[0]      = '\0';
  rl_tst_numeric_prefix.arr[0]      = '\0';
  rl_tst_numeric_result.arr[0]      = '\0';
  rl_tst_result_comment_desc1.arr[0]      = '\0';
  rl_tst_result_comment_desc2.arr[0]      = '\0';
  rl_tst_result_comment_desc3.arr[0]      = '\0';
  rl_tst_result_comment_desc4.arr[0]      = '\0';
  rl_tst_rowid.arr[0]                     = '\0';
  rl_tst_cd_test_units.arr[0]			= '\0';
  rl_tst_cd_range_cmt.arr[0]		  = '\0';
  rl_tst_ran_low_val_nor.arr[0]	  = '\0';
  rl_tst_ran_high_val_nor.arr[0]	  = '\0';
  rl_tst_hide_rslt_comm_yn.arr[0] = '\0';

  rl_tst_group_test_code.len         = 0;
  rl_tst_test_code.len         = 0;
  rl_tst_numeric_prefix.len         = 0;
  rl_tst_numeric_result.len         = 0;
  rl_tst_result_comment_desc1.len         = 0;
  rl_tst_result_comment_desc2.len         = 0;
  rl_tst_result_comment_desc3.len         = 0;
  rl_tst_result_comment_desc4.len         = 0;
  rl_tst_rowid.len                        = 0;
  rl_tst_cd_test_units.len		  = 0;
  rl_tst_cd_range_cmt.len		  = 0;
  rl_tst_ran_low_val_nor.len	  = 0;
  rl_tst_ran_high_val_nor.len	  = 0;
  rl_tst_hide_rslt_comm_yn.len = 0;

    /* EXEC SQL FETCH RL_TEST_RESULT_CUR
              INTO :rl_tst_group_test_code,
                   :rl_tst_test_code,
                   :rl_tst_numeric_prefix,
                   :rl_tst_numeric_result,
                   :rl_tst_result_comment_desc1,
                   :rl_tst_result_comment_desc2,
                   :rl_tst_result_comment_desc3,
                   :rl_tst_result_comment_desc4,
				   :rl_tst_cd_test_units,
				   :rl_tst_cd_range_cmt,
				   :rl_tst_ran_low_val_nor,
				   :rl_tst_ran_high_val_nor,
                   :rl_tst_rowid,
				   :rl_tst_hide_rslt_comm_yn; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2145;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[1] = (unsigned int  )13;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_tst_numeric_prefix;
    sqlstm.sqhstl[2] = (unsigned int  )4;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_numeric_result;
    sqlstm.sqhstl[3] = (unsigned int  )18;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_result_comment_desc1;
    sqlstm.sqhstl[4] = (unsigned int  )43;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&rl_tst_result_comment_desc2;
    sqlstm.sqhstl[5] = (unsigned int  )43;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&rl_tst_result_comment_desc3;
    sqlstm.sqhstl[6] = (unsigned int  )43;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&rl_tst_result_comment_desc4;
    sqlstm.sqhstl[7] = (unsigned int  )43;
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqhstv[8] = (         void  *)&rl_tst_cd_test_units;
    sqlstm.sqhstl[8] = (unsigned int  )13;
    sqlstm.sqhsts[8] = (         int  )0;
    sqlstm.sqindv[8] = (         void  *)0;
    sqlstm.sqinds[8] = (         int  )0;
    sqlstm.sqharm[8] = (unsigned int  )0;
    sqlstm.sqadto[8] = (unsigned short )0;
    sqlstm.sqtdso[8] = (unsigned short )0;
    sqlstm.sqhstv[9] = (         void  *)&rl_tst_cd_range_cmt;
    sqlstm.sqhstl[9] = (unsigned int  )43;
    sqlstm.sqhsts[9] = (         int  )0;
    sqlstm.sqindv[9] = (         void  *)0;
    sqlstm.sqinds[9] = (         int  )0;
    sqlstm.sqharm[9] = (unsigned int  )0;
    sqlstm.sqadto[9] = (unsigned short )0;
    sqlstm.sqtdso[9] = (unsigned short )0;
    sqlstm.sqhstv[10] = (         void  *)&rl_tst_ran_low_val_nor;
    sqlstm.sqhstl[10] = (unsigned int  )18;
    sqlstm.sqhsts[10] = (         int  )0;
    sqlstm.sqindv[10] = (         void  *)0;
    sqlstm.sqinds[10] = (         int  )0;
    sqlstm.sqharm[10] = (unsigned int  )0;
    sqlstm.sqadto[10] = (unsigned short )0;
    sqlstm.sqtdso[10] = (unsigned short )0;
    sqlstm.sqhstv[11] = (         void  *)&rl_tst_ran_high_val_nor;
    sqlstm.sqhstl[11] = (unsigned int  )18;
    sqlstm.sqhsts[11] = (         int  )0;
    sqlstm.sqindv[11] = (         void  *)0;
    sqlstm.sqinds[11] = (         int  )0;
    sqlstm.sqharm[11] = (unsigned int  )0;
    sqlstm.sqadto[11] = (unsigned short )0;
    sqlstm.sqtdso[11] = (unsigned short )0;
    sqlstm.sqhstv[12] = (         void  *)&rl_tst_rowid;
    sqlstm.sqhstl[12] = (unsigned int  )33;
    sqlstm.sqhsts[12] = (         int  )0;
    sqlstm.sqindv[12] = (         void  *)0;
    sqlstm.sqinds[12] = (         int  )0;
    sqlstm.sqharm[12] = (unsigned int  )0;
    sqlstm.sqadto[12] = (unsigned short )0;
    sqlstm.sqtdso[12] = (unsigned short )0;
    sqlstm.sqhstv[13] = (         void  *)&rl_tst_hide_rslt_comm_yn;
    sqlstm.sqhstl[13] = (unsigned int  )4;
    sqlstm.sqhsts[13] = (         int  )0;
    sqlstm.sqindv[13] = (         void  *)0;
    sqlstm.sqinds[13] = (         int  )0;
    sqlstm.sqharm[13] = (unsigned int  )0;
    sqlstm.sqadto[13] = (unsigned short )0;
    sqlstm.sqtdso[13] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_TEST_RESULT_CUR");

    rl_tst_group_test_code.arr[rl_tst_group_test_code.len] = '\0';
    rl_tst_test_code.arr[rl_tst_test_code.len] = '\0';
    rl_tst_numeric_prefix.arr[rl_tst_numeric_prefix.len] = '\0';
    rl_tst_numeric_result.arr[rl_tst_numeric_result.len] = '\0';
    rl_tst_result_comment_desc1.arr[rl_tst_result_comment_desc1.len] = '\0';
    rl_tst_result_comment_desc2.arr[rl_tst_result_comment_desc2.len] = '\0';
    rl_tst_result_comment_desc3.arr[rl_tst_result_comment_desc3.len] = '\0';
    rl_tst_result_comment_desc4.arr[rl_tst_result_comment_desc4.len] = '\0';
    rl_tst_rowid.arr[rl_tst_rowid.len] = '\0';
    rl_tst_cd_test_units.arr[rl_tst_cd_test_units.len]  	      = '\0';
    rl_tst_cd_range_cmt.arr[rl_tst_cd_range_cmt.len]		      = '\0';
    rl_tst_ran_low_val_nor.arr[rl_tst_ran_low_val_nor.len]	  = '\0';
    rl_tst_ran_high_val_nor.arr[rl_tst_ran_high_val_nor.len]	  = '\0';
    rl_tst_hide_rslt_comm_yn.arr[rl_tst_hide_rslt_comm_yn.len] = '\0';

#ifdef DEBUG
    printf("Group is <%s> tst is <%s>\n",rl_tst_group_test_code.arr,
                       rl_tst_test_code.arr);
	printf("In fetch_tst_result, last_row = %d \n",
	LAST_ROW);
#endif
    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/

update_tst_result()  
{

     /* EXEC SQL UPDATE RL_TEST_RESULT
              SET    STATUS = 'P',
		             MODIFIED_BY_ID = :sy_user_id, ///ah scf USER,
		             MODIFIED_DATE = SYSDATE
              WHERE  ROWID       = :rl_tst_rowid
			  AND    NVL(STATUS,'O')  IN ('R','P'); */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 33;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "update RL_TEST_RESULT  set STATUS='P',MODIFIED_BY_ID=:b0\
,MODIFIED_DATE=SYSDATE where (ROWID=:b1 and NVL(STATUS,'O') in ('R','P'))";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )2216;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&sy_user_id;
     sqlstm.sqhstl[0] = (unsigned int  )33;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&rl_tst_rowid;
     sqlstm.sqhstl[1] = (unsigned int  )33;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 /// 21.05.2005

     if (OERROR)
         ins_message(ORA_MESG,"UPDATE failed on table RL_TEST_RESULT");
}
/*-----------------------------------------------------*/
print_header()
{   char t_patient_id[16];   
    char sex_desc[11];
	char pat_name[300];
	char uline[82];
	char l_str[100];
    int i,l_tests;

    pctr++;

	if (l_print_health_card_yn.arr[0]=='Y') 
		lctr = 20;
	else
	    lctr = 19;

    get_parameters();

/*---------*/
    fprintf(fp,"%c&a006L",ESC); /* Set the left Margin */
	fprintf(fp,"%c&k12S",ESC);	/* This makes the font size to increase to 12 */
	fprintf(fp,"%c&l6D",ESC);	/* Set the Density */
   	fprintf(fp,"%c(s4B",ESC);   /* Set Bold */
/*---------*/

    fprintf(fp,"\n%-*s%-.40s\n\n",(int)(((80 - sy_acc_entity_name.len)/2) - 6)," ",sy_acc_entity_name.arr);
    fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title.len)/2) - 6)," ",rl_lab_title.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);
    fprintf(fp,"%73.73sPage(s) : %3d\n"," ",pctr);
/*----------------------------------------*/


    if(rl_hdr_episode_type.arr[0] == 'R')
       if(strcmp(rl_pat_actual_id.arr,"NULL")==0)
	  strcpy(t_patient_id,nd_hosp_no.arr);
       else
	  strcpy(t_patient_id,rl_pat_actual_id.arr);
    else
       strcpy(t_patient_id,nd_hosp_no.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//  fprintf(fp,"Patient ID : ");
	//fprintf(fp,"HMC No.    : ");
	fprintf(fp,"%-11.11s: ",local_legend[1]); // added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
	
	fprintf(fp,"%c&k12S",ESC);	
	fprintf(fp,"%c&l6D",ESC);
   	fprintf(fp,"%c(s4B",ESC);

    fprintf(fp,"%-15.15s",t_patient_id);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Section : ");
	fprintf(fp, "%-8.8s: ", local_legend[2]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

	fprintf(fp, "%-s - %-s\n",rl_section_short_name.arr,
							  rl_section_tel_num.arr);


/********* added on 27/11/2002 for printing NEW MEDICOM NO FOR HMC ******/
/*----------------------------------------*/
	if(rl_hdr_episode_type.arr[0] == 'R')
	{
		get_new_medicom_no();
		if (strlen(nd_new_medicom_no.arr) > 0)
		{
			fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s4B",ESC);
			//fprintf(fp,"MEDICOM No.: ");
			fprintf(fp,"%-11.11s: ", local_legend[3]);//added for globalisation
			fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s-3B",ESC);   

			fprintf(fp,"%c&k12S",ESC);	
			fprintf(fp,"%c&l6D",ESC);
   			fprintf(fp,"%c(s4B",ESC);

			fprintf(fp,"%-15.15s\n",nd_new_medicom_no.arr);
	
			fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s-3B",ESC);
		}
	}
/*----------------------------------------*/
/********* upto here added on 27/11/2002 for printing NEW MEDICOM NO FOR HMC ******/

/* added by c dinesh to print health card info 21/06/2002 */

if ((l_print_health_card_yn.arr[0]=='Y') && 
			 ( (rl_health_card_num.arr[0]!='\0') ||
			   (rl_health_num.arr[0] != '\0')
			  ))
	{

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Health Card No : ");
    fprintf(fp,"%-15.15s: ", local_legend[4]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
	
	fprintf(fp,"%c&k12S",ESC);	
	fprintf(fp,"%c&l6D",ESC);
   	fprintf(fp,"%c(s4B",ESC);

    fprintf(fp,"%-15.15s",rl_health_card_num.arr);


/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"    Health No  : ");
    fprintf(fp,"%-15.15s: ", local_legend[5]);//added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

	fprintf(fp,"%c&k12S",ESC);	
	fprintf(fp,"%c&l6D",ESC);
   	fprintf(fp,"%c(s4B",ESC);

    fprintf(fp,"%-14.14s\n", rl_health_num.arr);

}
/*--------------till here ----------------------*/
    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"\n\n");

    if(rl_pat_sex.arr[0] == 'M')
	   //strcpy(sex_desc,"MALE");
		strcpy(sex_desc,local_legend[37]);//added for globalisation
	else
	if(rl_pat_sex.arr[0] == 'F')
	   //strcpy(sex_desc,"FEMALE");
		strcpy(sex_desc,local_legend[38]);//added for globalisation
	else
       strcpy(sex_desc,"");
    
	strcpy(pat_name,rl_pat_title.arr);
	if(strlen(rl_pat_title.arr) > 0)
	   strcat(pat_name," ");
	strcat(pat_name,rl_pat_short_name.arr);
    
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp,"Patient Name         : ");
	fprintf(fp,"%-21.21s: ", local_legend[6]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-42.42s",pat_name);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Sex : ");
    fprintf(fp,"%-4.4s: ", local_legend[7]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-8.8s\n",sex_desc);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Location             : ");
    fprintf(fp,"%-21.21s: ", local_legend[8]); //added for globaliation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-42.42s",rl_source_short_name.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"DOB : ");
    fprintf(fp,"%-4.4s: ",local_legend[9]);//added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
	
	fprintf(fp,"%-16.16s\n",rl_pat_date_of_birth.arr); 

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Clinical Information : ");
    fprintf(fp,"%-21.21s: ", local_legend[10]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    if (rl_hdr_request_comment_desc1.len)
    {
      fprintf(fp,"%-40s\n",rl_hdr_request_comment_desc1.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

    if (rl_hdr_request_comment_desc2.len)
    {
       /*----------------------------------------*/
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s4B",ESC);
       fprintf(fp,"%-23.23s"," ");
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/
      fprintf(fp,"%-40s\n",rl_hdr_request_comment_desc2.arr);
      page_break(1);
    }

    if (rl_hdr_request_comment_desc3.len)
    {
       /*----------------------------------------*/
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s4B",ESC);
       fprintf(fp,"%-23.23s"," ");
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/
      fprintf(fp,"%-40s\n",rl_hdr_request_comment_desc3.arr);
      page_break(1);
    }
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Requesting Doctor    : ");
    fprintf(fp,"%-21.21s: ",local_legend[11]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
    if(rl_ordering_doctor_name.len)    ///// added on 06.12.2004
	  strcpy(rl_consultant_short_name.arr,rl_ordering_doctor_name.arr);

    fprintf(fp,"%-33.33s",rl_consultant_short_name.arr);
				
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Request Date : ");
    fprintf(fp,"%-13.13s: ", local_legend[12]);//added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    //fprintf(fp,"%-s\n",rl_hdr_spec_recd_date_time.arr);
    fprintf(fp,"%-s\n",rl_hdr_spec_recd_date_time1.arr);//added for globalisation

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Specimen Type        : ");
    fprintf(fp,"%-21.21s: ", local_legend[13]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-33.33s",rl_spc_specimen_desc.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Regn Date    : ");
    fprintf(fp,"%-13.13s: ", local_legend[14]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_regd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_regd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_regd_dat\
e_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_regd_date_time , 'D\
D/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )2239;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    //fprintf(fp,"%s\n",rl_hdr_spec_regd_date_time.arr);
    fprintf(fp,"%s\n",rl_hdr_spec_regd_date_time1.arr);//added for globalisation

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Tests Requested      : ");
    fprintf(fp,"%-21.21s: ",local_legend[15]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-33.33s"," ");

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    fprintf(fp,"Specimen No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[16]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

	if (d_interval_specimen_yn == 'Y')
		fprintf(fp,"%-9.9s (I)\n",first_specimen_no.arr);
	else
		fprintf(fp,"%-s\n",nd_spec_no.arr);

	sprintf(l_str,"%-6.6s"," ");

    l_tests = no_of_dtl_recs;
	if (no_of_dtl_recs > 7)
	   l_tests = 7;

//    for (i=0;i < no_of_dtl_recs;i++)
    for (i=0;i < l_tests;i++)
    {
       sprintf(l_str,"%s%-5s  ",l_str, rl_dtl_test_code[i].arr);
    }
    fprintf(fp,"%s\n",l_str);

    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"\n\n");
}
/*---------------------------------------------------------*/
print_dtls()
{
  int next_line = 0;
  int c_count2 = 0;
  char range_cmnt_print_flag = 'N';
  char l_str[100],l_str1[100];
  int agesex_range_flag = FALSE;
  int path_review_flag = FALSE;
  numeric_value_flag = FALSE;
  strcpy(l_str,"");
  page_break(0); 

  something_to_print_for_test = 0; //// 21.05.2005



  /// 03.10.2005 if((atoi(c_count_profile.arr) > 0) && (rl_tst_status.arr[0] != 'A'))   ///// 21.05.2005

  if( ((atoi(c_count_profile.arr) > 0) && (rl_tst_status.arr[0] != 'A')) ||  ///// 21.05.2005
    	((atoi(c_count_profile.arr) > 0) && strcmp(draft_printing_yn.arr, "Y") == 0) || // 03.10.2005
		((atoi(c_count_profile.arr) > 0) && strcmp(rl_tst_preliminary_release_yn.arr, "Y") == 0)  // 22.08.2006
	)

  {
  fetch_test_code(rl_tst_test_code.arr);
  
  /* Check to see if test result should be printed (Confidential Result) */

/// 28.09.2006  if (rl_tst_cd_conf_yn.arr[0]	== 'N' || p_param7.arr[0] == 'X' )
  if (rl_tst_cd_conf_yn.arr[0]	== 'N' || p_param7.arr[0] == 'X' 
                                       || (nd_user_conf_access_yn.arr[0] == 'Y' && strcmp(draft_printing_yn.arr, "Y") == 0)) /// added 28.09.2006  
  {
  
  if(rl_tst_cd_inh_rep_yn.arr[0] == 'N')
  {
	spc_first = 1;
    fflush(fp);
    ind_test_prn = 0;

/********* Newly added to print only those reports 
	which is having some component or should print 
	  *********/

/***** changed on 13/04/2002 against scf - 42 of QATAR *********/
//		something_to_print = 1;	

/******** Newly added to print the specimen nos for the GTT Tests ****/
		if (d_interval_specimen_yn == 'Y' && rl_tst_interval_test_yn.arr[0] == 'Y')
		 {

			if (strcmp(rl_tst_test_code.arr, nd_test_code) != 0)
			{
				strcpy(nd_test_code, rl_tst_test_code.arr);
				l_seq_no = 1;
			}
			else
				l_seq_no++;
			if (strcmp(rl_report_format.arr, "4") != 0 && strcmp(rl_report_format.arr, "5") != 0
								&& strcmp(rl_report_format.arr, "6") != 0 && strcmp(rl_report_format.arr, "7") != 0
			   )    /// added on 05.04.2005
			{
				//sprintf(l_str,"Specimen No: %-15.15s", nd_spec_no.arr);
				sprintf(l_str,"%-11.11s: %-15.15s", local_legend[16], nd_spec_no.arr); //added for globalisation
				print_line(l_str);
				strcpy(l_str,"");
			}	

			page_break(0);
		 }
/******* Upto here *******/ 


    if(rl_tst_cd_print_report_yn.arr[0] == 'Y')
	{
		if (d_interval_specimen_yn == 'Y' && rl_tst_interval_test_yn.arr[0] == 'Y')
		{
			get_interval_description();
			sprintf(l_str,"%-40.40s",interval_description.arr);
		}
		else
		{
		    if(test_desc_fill_for_report.len)   
			{
				if ((rl_tst_numeric_result.len) ||
					((rl_tst_result_comment_desc1.len || rl_tst_result_comment_desc2.len ||
						rl_tst_result_comment_desc3.len || rl_tst_result_comment_desc4.len)) &&
						(rl_tst_hide_rslt_comm_yn.arr[0] == 'N'))
				{
	
			          /* EXEC SQL SELECT RPAD(:rl_tst_cd_short_desc,40,:test_desc_fill_for_report) 
					   INTO :rl_tst_cd_short_desc
					   FROM DUAL; */ 

{
             struct sqlexd sqlstm;
             sqlstm.sqlvsn = 10;
             sqlstm.arrsiz = 33;
             sqlstm.sqladtp = &sqladt;
             sqlstm.sqltdsp = &sqltds;
             sqlstm.stmt = "select RPAD(:b0,40,:b1) into :b0  from DUAL ";
             sqlstm.iters = (unsigned int  )1;
             sqlstm.offset = (unsigned int  )2266;
             sqlstm.selerr = (unsigned short)1;
             sqlstm.cud = sqlcud0;
             sqlstm.sqlest = (unsigned char  *)&sqlca;
             sqlstm.sqlety = (unsigned short)256;
             sqlstm.occurs = (unsigned int  )0;
             sqlstm.sqhstv[0] = (         void  *)&rl_tst_cd_short_desc;
             sqlstm.sqhstl[0] = (unsigned int  )43;
             sqlstm.sqhsts[0] = (         int  )0;
             sqlstm.sqindv[0] = (         void  *)0;
             sqlstm.sqinds[0] = (         int  )0;
             sqlstm.sqharm[0] = (unsigned int  )0;
             sqlstm.sqadto[0] = (unsigned short )0;
             sqlstm.sqtdso[0] = (unsigned short )0;
             sqlstm.sqhstv[1] = (         void  *)&test_desc_fill_for_report;
             sqlstm.sqhstl[1] = (unsigned int  )4;
             sqlstm.sqhsts[1] = (         int  )0;
             sqlstm.sqindv[1] = (         void  *)0;
             sqlstm.sqinds[1] = (         int  )0;
             sqlstm.sqharm[1] = (unsigned int  )0;
             sqlstm.sqadto[1] = (unsigned short )0;
             sqlstm.sqtdso[1] = (unsigned short )0;
             sqlstm.sqhstv[2] = (         void  *)&rl_tst_cd_short_desc;
             sqlstm.sqhstl[2] = (unsigned int  )43;
             sqlstm.sqhsts[2] = (         int  )0;
             sqlstm.sqindv[2] = (         void  *)0;
             sqlstm.sqinds[2] = (         int  )0;
             sqlstm.sqharm[2] = (unsigned int  )0;
             sqlstm.sqadto[2] = (unsigned short )0;
             sqlstm.sqtdso[2] = (unsigned short )0;
             sqlstm.sqphsv = sqlstm.sqhstv;
             sqlstm.sqphsl = sqlstm.sqhstl;
             sqlstm.sqphss = sqlstm.sqhsts;
             sqlstm.sqpind = sqlstm.sqindv;
             sqlstm.sqpins = sqlstm.sqinds;
             sqlstm.sqparm = sqlstm.sqharm;
             sqlstm.sqparc = sqlstm.sqharc;
             sqlstm.sqpadto = sqlstm.sqadto;
             sqlstm.sqptdso = sqlstm.sqtdso;
             sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					   rl_tst_cd_short_desc.arr[rl_tst_cd_short_desc.len] = '\0'; 
					   sprintf(l_str,"%-40.40s",rl_tst_cd_short_desc.arr);
				}
				else
     		           sprintf(l_str,"%-40.40s",rl_tst_cd_short_desc.arr);
			}
            else
     		  sprintf(l_str,"%-40.40s",rl_tst_cd_short_desc.arr);
		}
	}
    else
        sprintf(l_str,"%-40s"," ");
    strcpy(text_line,l_str);
    strcpy(test_description,l_str);

/********  added on 21.07.2003 ***/

    if (print_c_hist == 0)  
	{    

//sprintf(string_var,"b4 cl.histy. %s",rl_tst_group_test_code.arr);
//disp_message(ERR_MESG,string_var);
       if(rl_print_build_clin_hist_yn.arr[0] == 'Y')  /// if condn added on 06.12.2004
	   {
	     print_clinical_history(); 
		 print_c_hist = 1;
	   }
	}
/********  upto here *******/


    if ((rl_tst_cd_numeric_result_yn.arr[0] == 'Y') &&
			(rl_num_result_hide_yn.arr[0]	== 'N'))
    {
	if (rl_tst_numeric_result.len)
	{

/****** ADDED ON 14/04/2002 AGAINST SCF - 42 *******/		
		something_to_print = 1;
		something_to_print_for_test = 1;

		if (strcmp(p_param13.arr,"Y") == 0)
		  get_si_units_equv_val();  /// 16.01.2006

        if ( (atof(rl_tst_numeric_result.arr) < 1) && 
			(atof(rl_tst_numeric_result.arr) > 0) )
             put_zero_before_decimal(	);

	  numeric_value_flag = TRUE;

/*********** for adding zero after result if no fraction part **********/


	  strcpy(r_rslt.arr, rl_tst_numeric_result.arr);
	  r_rslt.len = strlen(r_rslt.arr);
	  add_zero_after_result();
	  strcpy(rl_tst_numeric_result.arr, r_rslt.arr);
	  rl_tst_numeric_result.len = strlen(rl_tst_numeric_result.arr);

	if(rl_tst_numeric_prefix.arr[0] == '+')
	{
			 sprintf(l_str,"%s %-10s",l_str,rl_tst_numeric_result.arr);
	}
	else
	{
		    sprintf(l_str,"%s%c%-10s",l_str,rl_tst_numeric_prefix.arr[0],
				     rl_tst_numeric_result.arr);
	}

          strcpy(l_str1,l_str);
          ltrim(l_str1);
          rtrim(l_str1);

		  /**********
			THE BELOW PORTION IS COMMENTED ON 13/10/2003 BECAUSE
		  IF THE TEST_UNITS IS NOT MENIOTED AT THE TIME OF RELEASE OF RESULTS
			THEN THE TRANSACTION TABLE WILL NOT GET UPDATED WITH  TEST UNITS.
			LATER IF THEY DEFINED IN TEST CODE MASTER IT SHOULD NOT SHOW IN 
			QUERY SINCE IT MAY AFFECT THE CR REPOSITORY**************


	  if (strlen(rl_tst_cd_test_units.arr) == 0)   
	  {
			strcpy(rl_tst_cd_test_units.arr,rl_tst_cd_test_units_2.arr);
			rl_tst_cd_test_units.len = strlen(rl_tst_cd_test_units.arr);
	  }
**************** upto here is commented **** the abv if commented on 27.10.2003 ***********/

///16.01.2006          sprintf(l_str,"%s%-10s",l_str,rl_tst_cd_test_units.arr);

		  get_test_units_desc_from_sy_uom(); //// 16.01.2006
          sprintf(l_str,"%s%-10s",l_str,rl_tst_cd_test_units_desc.arr); /// 16.01.2006

/******** CORRECTED ON 17/02/2004 AGAINST HMC RL-11 *********************
   	  if ((rl_tst_ran_low_val_nor.len  || rl_tst_ran_high_val_nor.len ) &&
		  (rl_pat_sex.arr[0] == 'M'    || rl_pat_sex.arr[0] == 'F'))
******** UPTO HERE CORRECTED ON 17/02/2004 AGAINST HMC RL-11 **************/

	      if ( rl_tst_ran_low_val_nor.len  ||
            rl_tst_ran_high_val_nor.len )
          {
		    get_zero_prefix_for_range();

			  strcpy(r_rslt.arr, rl_tst_ran_low_val_nor.arr);
			  r_rslt.len = strlen(r_rslt.arr);
 			  add_zero_after_result();
			  strcpy(rl_tst_ran_low_val_nor.arr, r_rslt.arr);
			  rl_tst_ran_low_val_nor.len = strlen(rl_tst_ran_low_val_nor.arr);

			  strcpy(r_rslt.arr, rl_tst_ran_high_val_nor.arr);
			  r_rslt.len = strlen(r_rslt.arr);
 			  add_zero_after_result();
			  strcpy(rl_tst_ran_high_val_nor.arr, r_rslt.arr);
			  rl_tst_ran_high_val_nor.len = strlen(rl_tst_ran_high_val_nor.arr);
			

			      sprintf(l_str,"%s %-1s (%s - %s)",l_str,
						rl_high_low_ind.arr,
                     rl_tst_ran_low_val_nor.arr,
                     rl_tst_ran_high_val_nor.arr);

		   				   agesex_range_flag = TRUE;
          }
          else
          {
              if(rl_tst_cd_range_cmt.len)
			  {
				   range_cmnt_print_flag = 'Y';
               }
/**************************** commented on 27.03.2005 as per Mr.Dinesh instructions.
becaz it should not take the age sex range from master setup.              
               else
               {
				 if ((!(rl_tst_ran_low_val_nor.len)  &&	!(rl_tst_ran_high_val_nor.len) && 
					(rl_tst_cd_age_sex_range_yn.arr[0] == 'Y')) &&
					(rl_pat_sex.arr[0] == 'M' || rl_pat_sex.arr[0] == 'F'))
				 {

					fetch_age_sex_range();
					if ( rl_tst_ran_low_val_nor.len && rl_tst_ran_high_val_nor.len )
					{
					   get_zero_prefix_for_range();

						  strcpy(r_rslt.arr, rl_tst_ran_low_val_nor.arr);
						  r_rslt.len = strlen(r_rslt.arr);
						  add_zero_after_result();
						  strcpy(rl_tst_ran_low_val_nor.arr, r_rslt.arr);
						  rl_tst_ran_low_val_nor.len = strlen(rl_tst_ran_low_val_nor.arr);

						  strcpy(r_rslt.arr, rl_tst_ran_high_val_nor.arr);
					   	  r_rslt.len = strlen(r_rslt.arr);
 						  add_zero_after_result();
 						  strcpy(rl_tst_ran_high_val_nor.arr, r_rslt.arr);
						  rl_tst_ran_high_val_nor.len = strlen(rl_tst_ran_high_val_nor.arr);

				      sprintf(l_str,"%s %-1s (%-s - %s)",l_str,
							rl_high_low_ind.arr,
			             rl_tst_ran_low_val_nor.arr,
				         rl_tst_ran_high_val_nor.arr);
					}
					agesex_range_flag = TRUE;
				 }				
				 else if(rl_tst_cd_range_cmt_2.len)
				 {
					strcpy(rl_tst_cd_range_cmt.arr,rl_tst_cd_range_cmt_2.arr);
					rl_tst_cd_range_cmt.len = strlen(rl_tst_cd_range_cmt.arr);
					range_cmnt_print_flag = 'Y';
				 } 
                    }
*********************************/

          }

		strcpy(l_str1,l_str);
		ltrim(l_str1);
		rtrim(l_str1);
	    
          if(group && !group_printed)
          {
		   print_group_test_desc();
	       group_printed = 1;
          }
	    
          next_line = 0;

          if(range_cmnt_print_flag == 'Y')
          {
			if(strlen(rl_tst_cd_range_cmt.arr) <= (80 - strlen(l_str)))
			{
				sprintf(l_str,"%s%s",l_str,rl_tst_cd_range_cmt.arr);
			}
			else
				next_line = 1;            
          }
		
/// commented on 21.07.2003 since it should print even if numeric_result_print_yn = N also
//////	  print_clinical_history();
          
		  bold_print_check = 1;   // 27.07.2004

		  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);

          print_line(l_str);
          test_printed  = 1;

		  bold_print_check = 0;  // 27.07.2004

          if(next_line == 1)
          {
	       sprintf(l_str,"%40.40s%40.40s"," ",rl_tst_cd_range_cmt.arr);
	       
		   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		   		   
		   print_line(l_str);
          } 

	}   /*Endif of rl_tst_numeric_result.len */

    } /* Endif of rl_tst_cd_numeric_result_yn.arr */

    if (rl_num_result_hide_yn.arr[0] == 'N')
			print_past_results();   /////// 29.07.2004 added to print past results based on setup

	if (strcmp(rl_tst_preliminary_release_yn.arr, "Y") == 0 && strcmp(rl_tst_status.arr,"A") == 0 ) 
	    print_prel_release_desc();	

	if(rl_tst_hide_rslt_comm_yn.arr[0] == 'N')
        print_comment_desc1234(); 

     print_test_comments(); 

     if(rl_tst_cd_culture_test_yn.arr[0] == 'Y')
	 {
		if (strcmp(rl_mic_to_print_yn.arr,"Y") == 0)
			check_mic_value_present_for_test();

	    if (strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "6") == 0)
			print_culture_format4();
		else 
			print_culture();

	 }


     if (rl_tst_cd_text_block_yn.arr[0] == 'Y')
     {
        open_result_text();
	    splitting();
     }

     if (rl_tst_cd_snomed_yn.arr[0] == 'Y')         
          print_snomed();

/***************** added the below on 21.05.2005	  *******************/

	 if ((rl_tst_status.arr[0] == 'O') && (rl_tst_cd_profile_yn.arr[0] == 'Y'))
	 {
	   if(rl_print_pend_profile_yn.arr[0] == 'Y')  
	   {
		if(!something_to_print_for_test) 
		{
		    strcpy(l_str,"");
			sprintf(l_str,"%-40.40s",test_description);

		    if(rl_tst_cd_print_report_yn.arr[0] == 'Y') 
			{
				if(group && !group_printed)  
				{
				  print_group_test_desc();
				  group_printed = 1;
				}
				if(rl_legend_for_pending.len)
				   sprintf(l_str,"%s %-35.35s",l_str,rl_legend_for_pending.arr);
				else
				   sprintf(l_str,"%s %-35.35s",l_str,"Pending.."); 
				   sprintf(l_str,"%s %-35.35s",l_str,"%-9.9s",local_legend[28]); //added for globalisation

				something_to_print_for_test = 1;
				print_line(l_str); 
				test_printed = 1;
			 }

		}		
	   }		   	
	 }
/*************** upto here added on 21.05.2005 ***********************/

	 print_result_modify_reason(); // to print modify reason if any and something_to_print_for_test = 1


     fflush(fp); 

  } /* end if of inh_rep_yn */

  } /* end if of confidential report*/
 } /* end if of if(atoi(c_count.arr) > 0) */
}
/*-----------------------------------------------------*/
print_test_comments()
{

  if (something_to_print ==  0 )
  {
	check_any_res_comp();

  }
  else
    other_than_comments = 1;


  if (other_than_comments > 0)
  {

	open_comments();
	_flushall();
	while(fetch_comments())
  {
    if (rl_comm_tst_comm_txt.len)
    {
	   //something_to_print = 1; 
       if(group && !group_printed)
       {
	      print_group_test_desc();
	      group_printed = 1;
       }
       if(test_printed)
       {  numeric_value_flag = TRUE;
		  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
          print_line_check(rl_comm_tst_comm_txt.arr);
       }
       else
       {
	      numeric_value_flag = FALSE;
	      sprintf(text_line,"%-40.40s%-40s",test_description,
			    rl_comm_tst_comm_txt.arr);
		  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
	      print_line_check(text_line);
	      test_printed = 1;
       }
     }
   }

   	close_comments_curs();

   _flushall();
 }

}
/*-----------------------------------------------------*/
print_line(char *t_str)
{
 	
	print_html_line (t_str,out_str);

	if (bold_print_check && rl_high_low_ind.len)
	{
	  fprintf(fp,"%c&k4S",ESC); 
   	  fprintf(fp,"%c(s4B",ESC);
      fprintf(fp,"%s\n",t_str);
	  fprintf(fp,"%c&k4S",ESC); 
   	  fprintf(fp,"%c(s-3B",ESC); 
	  sprintf(l_html_bdy_str,"%s<td class=font_disp><b>%s</b></td></tr></table>",l_html_bdy_str,out_str);	    
	}
    else
	{
	  fprintf(fp,"%s\n",t_str);
	  sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
	}

	  write_html(fp4,l_html_bdy_str);
	  strcpy(l_html_bdy_str,"");
	  strcpy(out_str,"");

      page_break(1);

/******COMMENTED AGAINST SCF 42 OF QATAR - ******/
//		 something_to_print = 1;
}
/*-----------------------------------------------------*/
/***** newly added on 07/07/2003 against AL-JAZIRA SCF 85 ***********/
print_line_org_ant(char *t_str)
{
		 print_html_line (t_str,out_str);         
		 
		 fprintf(fp,"%s\n",t_str);

		 if ((l_text_uline == 'Y') && (l_text_bold == 'N'))
				sprintf(l_html_bdy_str,"%s<td class=font_disp><u>%s</u></td></tr></table>",l_html_bdy_str,out_str);
		 else
		 {
			if ((l_text_uline == 'N') && (l_text_bold == 'Y'))
				sprintf(l_html_bdy_str,"%s<td class=font_disp><b>%s</b></td></tr></table>",l_html_bdy_str,out_str);
			else
				sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
		 }

		 write_html(fp4,l_html_bdy_str);
		 strcpy(l_html_bdy_str,"");
		 strcpy(out_str,"");

		 l_text_uline = 'N';
		 l_text_bold = 'N';

		 fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

         page_break(1);

}
/*-----------------------------------------------------*/
print_line_check(char *t_str)
{
      if (numeric_value_flag == TRUE)
	  {
		fprint_repeat(fp,' ',40);
		sprintf(l_html_bdy_str,"%s<td class=font_disp width=43%c>&nbsp</td>",l_html_bdy_str,l_prtg);
		print_line(t_str);
		numeric_value_flag = TRUE;
	  }
      else  
      {
		print_line(t_str);
		numeric_value_flag = TRUE;
	  }

/******COMMENTED AGAINST SCF 42 OF QATAR - ******/
//	  something_to_print = 1;
}
/*-----------------------------------------------------*/
print_html_line(char *in_str,char *out_str)
{
int i,l_len=0;

l_len = strlen(in_str);


	for(i=0;i<l_len;i++)
	{
		if(in_str[i] == ' ')
			strcat(out_str,"&nbsp;");
		else
			sprintf(out_str,"%s%c",out_str,in_str[i]);
	}
}
/*-----------------------------------------------------*/
print_test_desc(l_str)
char l_str[];
{
   if ((!ind_test_prn) &&
      (rl_tst_cd_group_test_yn.arr[0]  == 'N'))
   {
       if (rl_tst_cd_print_report_yn.arr[0] == 'Y')
           fprintf(fp,"%-40s%-36s%s",rl_tst_cd_short_desc.arr,l_str,
                           rl_curr_status);
       else
           fprintf(fp,"%-40s%-36s%s","",l_str,(tst_cd_ind)?rl_curr_status:"");
       ind_test_prn = 1;
       spc_first = 1;
    }
    else if (strlen(l_str))
           fprintf(fp,"%-40s%-40s","",l_str);

    if (tst_cd_ind) tst_cd_ind = 0;
}
/*-----------------------------------------------------*/

print_snomed()
{
	int ctr = 0;
	char prev_snomed_print_yn = 'N';

    open_result_snomed();
	
    l_snomed_head_printed = 0;

	_flushall();
    while (fetch_rl_result_snomed())
    {

        if (fetch_snomed_desc12345())
        {

	/***** NEWLY ADDED   *************/
		get_desc_snomed2();

	        if (rl_snomed_print_yn.arr[0] == 'Y' || rl_snomed2_print_yn.arr[0] == 'Y')
			    print_snomed_desc12345();
			else
			{
//			    something_to_print = 0;
//				something_to_print_for_test = 0;

				if(group && !group_printed)
				{
				   print_group_test_desc();
				  group_printed = 1;
				}
				if(!test_printed)
				{
					fprintf(fp,"%-40.40s\n",test_description);

					sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
					
					sprintf(in_str,"%-40.40s",test_description);
					print_html_line(in_str,out_str);					
					sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
					sprintf(l_html_bdy_str,"%s<tr><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
					strcpy(out_str,"");
					write_html(fp4,l_html_bdy_str);
					strcpy(l_html_bdy_str,"");

					test_printed = 1;
				}

				print_str('Y');

				if (l_snomed_head_printed) 
				{
					fprintf(fp, "\n");

					if (strlen(l_html_bdy_str))
						sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
					else
						sprintf(l_html_bdy_str,"<a class=font_disp><br></a>");

					write_html(fp4,l_html_bdy_str);
					strcpy(l_html_bdy_str,"");

					page_break(1); 
				}

/************ added on 20.07.2004 **************/

			    if (rl_res_snomed_mrkr_code1.len != 0) 
				{
				    get_snomed_marker_desc1();
					print_snomed_marker1();
				}
				if (rl_res_snomed_mrkr_code2.len != 0) 
				{
				    get_snomed_marker_desc2();
					print_snomed_marker2();
				}


/****************************** commented since new procedure print_str is added on 
		//     02/11/2002 for snomed code to be print y/n


					print_snomed_codes('Y');

					fprintf(fp, "\n");
					page_break(1);
******************************/				  


			}

	        ctr++;
        }
    }

	close_snomed_cur();

	_flushall();
}
/*-----------------------------------------------------*/

open_result_snomed()
{
    /* EXEC SQL OPEN RL_RESULT_SNOMED_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0046;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2293;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_RESULT_SNOMED_CUR");
}
/*-----------------------------------------------------*/

fetch_rl_result_snomed()
{
#ifdef DEBUG
       printf("In fetch_rl_result_snomed() \n");
#endif
    rl_res_snomed_code.arr[0]     = '\0';
	rl_res_snomed_code2.arr[0]	  = '\0';

	rl_res_snomed_mrkr_code1.arr[0]	  = '\0';
	rl_res_snomed_mrkr_code2.arr[0]	  = '\0';

    rl_res_snomed_code.len        = 0;
	rl_res_snomed_code2.len		  = 0;

	rl_res_snomed_mrkr_code1.len		  = 0;
	rl_res_snomed_mrkr_code2.len		  = 0;

    /* EXEC SQL FETCH RL_RESULT_SNOMED_CUR
              INTO :rl_res_snomed_code,
				   :rl_res_snomed_code2,
				   :rl_res_snomed_mrkr_code1,
				   :rl_res_snomed_mrkr_code2; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2328;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_res_snomed_code;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_res_snomed_code2;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_res_snomed_mrkr_code1;
    sqlstm.sqhstl[2] = (unsigned int  )4;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_res_snomed_mrkr_code2;
    sqlstm.sqhstl[3] = (unsigned int  )4;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_RESULT_SNOMED_CUR");

    rl_res_snomed_code.arr[rl_res_snomed_code.len] = '\0';
	rl_res_snomed_code2.arr[rl_res_snomed_code2.len]	= '\0';

	rl_res_snomed_mrkr_code1.arr[rl_res_snomed_mrkr_code1.len]	= '\0';
	rl_res_snomed_mrkr_code2.arr[rl_res_snomed_mrkr_code2.len]	= '\0';

    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/
print_culture()
{

    char temp_sens_ind;
    char temp_line[81];
	char org[MAX_ORGANISMS][5];
    int still_org_dtl_left;
    int print_anti_flag = 0;
    int change_flag = 0;
	int e = 0;
    int anti_flag = 0;
    int c = 0, s = 0;
	int no_of_organisms = 0;
    int oflag = 1;
	int match_found = 0;


    open_result_organism();
	_flushall();
    while(fetch_result_org())
    {
        something_to_print = 1;
		something_to_print_for_test = 1;

		strcpy(org[no_of_organisms],rl_res_organism_code.arr);
	    no_of_organisms++;

		if(group && !group_printed) 
		{
			print_group_test_desc();
			group_printed = 1;
		}
		if(!test_printed)
		{
			sprintf(text_line,"%-40.40s",test_description);
			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
			sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
			print_line(text_line);
			test_printed = 1;
		}

		if(oflag)
		{
		   	fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/

                        //sprintf(text_line,"%-46.46s%-41.41s","ORGANISM","COMMENT");
                        sprintf(text_line,"%-46.46s%-41.41s", local_legend[29], local_legend[30]);// added for globalisation
			
			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
			sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);			
			
			print_line_org_ant(text_line);

		   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

			oflag = 0;
		}

		fetch_org_desc();

//		sprintf(text_line,"%2d.   %-40.40s%-40.40s",no_of_organisms,
//							rl_res_organism_code_desc.arr,
//							rl_res_comment_desc.arr);

		sprintf(text_line,"%-6.6s%-40.40s%-34.34s",rl_res_organism_code.arr,
							rl_res_organism_code_desc.arr,rl_res_comment_desc.arr);


		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);

		print_line_org_ant(text_line);
	} 

	close_organism_cur();

	_flushall();

	if(no_of_organisms)
	{
		something_to_print = 1;
		something_to_print_for_test = 1;
   	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		sprintf(text_line,"");
		for(c=0;c<87;c++)
			sprintf(text_line,"%s%s",text_line," ");
		
		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		l_text_uline = 'Y';		
		
		print_line_org_ant(text_line);
   	    fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

/* 12.07.2004 */
//		sprintf(text_line,"%-46.46s","ANTIBIOTIC ");
//		for(c=0;c<no_of_organisms;c++)	/* Print organism codes as column headings*/
//			sprintf(text_line,"%s%2d     ",text_line,c+1);  /* c is printed in place of org[c]*/
//		print_line_org_ant(text_line);
//
//   	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
//		sprintf(text_line,"");
//		for(c=0;c<87;c++)
//			sprintf(text_line,"%s%s",text_line," ");
//		print_line_org_ant(text_line);
//	   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
/* ******/

		open_sensitivity();
		fetch_sensitivity();

//// 12.07.2004   	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		open_antibiotic();
		_flushall();
		t_antib_head_first_time = 0;
		while(fetch_antibiotic())
		{

////////////////////
		if (t_antib_head_first_time == 0) 
		{
		//sprintf(text_line,"%-46.46s","ANTIBIOTIC ");
		sprintf(text_line,"%-46.46s",local_legend[31]);//added for globalisation
		for(c=0;c<no_of_organisms;c++)	/* Print organism codes as column headings*/
			sprintf(text_line,"%s%-8.8s",text_line,org[c]);
// commented on 13/09/2004 to make the lab/ward query and result printout the same
//			sprintf(text_line,"%s%2d     ",text_line,c+1);  /* c is printed in place of org[c]*/

		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);

		print_line_org_ant(text_line);


   	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		sprintf(text_line,"");
		for(c=0;c<87;c++)
			sprintf(text_line,"%s%s",text_line," ");
		
		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		l_text_uline = 'Y';
		
		print_line_org_ant(text_line);
	   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

		t_antib_head_first_time = 1;
		}  
////////////////////
			something_to_print = 1;
			something_to_print_for_test = 1;
			strcpy(rl_res_dtl_antibiotic_code.arr,a_antibiotic_code.arr);
			rl_res_dtl_antibiotic_code.len = strlen(a_antibiotic_code.arr);
			fetch_antibiotic_desc();
		    sprintf(text_line,"%-46.46s",rl_res_dtl_antibiotic_desc.arr);
// to be corrected

			get_kb_mic_legend(no_of_organisms, 'L');
			sprintf(text_line1,"%-46.46s", l_kb_mic_legend);


			for(e=0;e<no_of_organisms;e++)
			{
				match_found = 0;
				for(s=0; s<no_of_sensitivities; s++)
				{
					if( (strcmp(s_ant[s].arr, a_antibiotic_code.arr) == 0) &&
						(strcmp(s_org[s].arr, org[e]) == 0) )
					{
					     sprintf(text_line,"%s%-8.8s",text_line,s_ind[s].arr);


						 if (strlen(s_mic[s].arr) > 0)
						 {
							 sprintf(text_line1,"%s%-8.8s",text_line1,s_mic[s].arr);
							 
						 }
						 else if (strlen(s_zone[s].arr) > 0)
						 {
							sprintf(text_line1,"%s%-8.8s",text_line1,s_zone[s].arr);
						 }
						 else
						 {
							sprintf(text_line1,"%s%-8.8s",text_line1," ");
						 }

// commented on 13/09/2004 to make the lab/ward query and result printout the same
			       //     sprintf(text_line,"%s%-7.7s",text_line,s_ind[s].arr);
						match_found = 1;
						break;
					}
				}

				if(match_found == 0)
				{
					sprintf(text_line, "%s        ",text_line);
					sprintf(text_line1,"%s        ",text_line1);
// commented on 13/09/2004 to make the lab/ward query and result printout the same
	            // sprintf(text_line,"%s       ",text_line);
				}

			}
			
			sprintf(text_line,"%-87.87s",text_line);
			sprintf(text_line1,"%-87.87s",text_line1);	

			if ( (strcmp(rl_mic_to_print_yn.arr,"Y")==0) && mic_count > 0)
			{
				//fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/					
				
				sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);				
				
				print_line_org_ant(text_line);

				fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/	
				
				sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
				l_text_uline = 'Y';
												
				print_line_org_ant(text_line1);
				fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
            } 
			else
			{ 
				fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/					
				
				sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
				l_text_uline = 'Y';				
				
				print_line_org_ant(text_line);
				fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
            }
/*********if a separate line and underline is required the below mentioned 
		//comment lines can be used

			fprintf(fp,"%c&d0D",ESC);   // Set  UnderLine ON					
			sprintf(text_line,"");
			for(c=0;c<87;c++)
				sprintf(text_line,"%s%s",text_line," ");

			print_line_org_ant(text_line);
			fprintf(fp,"%c&d@",ESC);   // Set UnderLine OFF 
*******************/

		}

		close_antibiotic_cur();

/*********** DONE ON 13/09/2004 TO BE COMMENTED TO MAKE 
	THE LAB/WARD QUERY AND
	RESULT REPORT LOOKS THE SAME
****************************************/
		if (t_antib_head_first_time == 1)	
		{
			//sprintf(text_line,"%-35.35s%-52.52s"," ","S - Sensitive     R - Resistant   I - Intermediate");
		    //disp_message(ERR_MESG,local_legend[17]);
			//disp_message(ERR_MESG,local_legend[18]);
			//disp_message(ERR_MESG,local_legend[19]);

			strcpy(string_var, " ");
			sprintf(string_var, "%s     %s     %s", local_legend[17],local_legend[18],local_legend[19]);

			sprintf(text_line,"%-33.33s%-52.52s"," ", string_var); //added for globalisation
           
			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
			sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);			
			
			print_line_org_ant(text_line);

			for(i=0; i < 87; i++)
					fprintf(fp,"%c",'_');

			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
			sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td>_______________________________________________________________________________</td></tr></table>",l_html_bdy_str);
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

			fprintf(fp,"\n");
			page_break(1);
		}


	   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		

	}
	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
}
/*-----------------------------------------------------*/
scan_and_prnt(l_str)
char *l_str;
{
   for(;*l_str != '\0';l_str++)
   {
     fprintf(fp,"%c",*l_str);
     if (*l_str == '\n')
        page_break(1);
   }
   fprintf(fp,"\n");
   page_break(1);
}
/*-----------------------------------------------------*/

open_result_organism()
{
    /* EXEC SQL OPEN RL_RESULT_ORGANISM_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0047;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2359;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_RESULT_ORGANISM_CUR");
}
/*-----------------------------------------------------*/

open_antibiotic()
{
    /* EXEC SQL OPEN RL_ANTIBIOTIC_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0048;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2394;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_ANTIBIOTIC_CUR");
}

/*-----------------------------------------------------*/
fetch_antibiotic()
{
    a_antibiotic_code.arr[0]   = '\0';
    a_antibiotic_code.len	   = 0;

    /* EXEC SQL FETCH RL_ANTIBIOTIC_CUR
              INTO a_antibiotic_code; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2429;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&a_antibiotic_code;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_RESULT_ORGANISM_CUR");

    a_antibiotic_code.arr[a_antibiotic_code.len]   = '\0';
    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/
open_antibiotic_format5()
{
    sql_stmt.arr[0]		= '\0';  
	sql_stmt.len		= 0;

	strcpy(sql_stmt.arr, " SELECT DISTINCT ANTIBIOTIC_CODE \
							 FROM RL_RESULT_ORGANISM_DTL \
							WHERE PATIENT_ID      = :nd_hosp_no \
							  AND SPECIMEN_NO     = :nd_spec_no \
							  AND OPERATING_FACILITY_ID = :nd_operating_facility_id \
							  AND GROUP_TEST_CODE = :rl_tst_group_test_code \
							  AND TEST_CODE       = :rl_tst_test_code \
							  AND ( ORGANISM_CODE = :rl_res_organism_code1 OR \
							        ORGANISM_CODE = :rl_res_organism_code2 \
								  )  \
							  AND REPORT_YN       = 'Y' \
							  AND SENSITIVITY_IND IN('S','R','I') \
						 ORDER BY ANTIBIOTIC_CODE ");

	sql_stmt.len = strlen(sql_stmt.arr);

	/* EXEC SQL PREPARE sr2 FROM :sql_stmt; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2448;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&sql_stmt;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		 ins_message(ORA_MESG,"PREPARE failed on table RL_RESULT_ORGANISM_DTL");

    /* EXEC SQL DECLARE RL_ANTIBIOTIC_CUR_FMT5 CURSOR FOR sr2; */ 
		

	/* EXEC SQL OPEN RL_ANTIBIOTIC_CUR_FMT5  USING :nd_hosp_no,:nd_spec_no,:nd_operating_facility_id,:rl_tst_group_test_code,:rl_tst_test_code,:rl_res_organism_code1,:rl_res_organism_code2; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2467;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[1] = (unsigned int  )23;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
 sqlstm.sqhstl[3] = (unsigned int  )13;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
 sqlstm.sqhstl[4] = (unsigned int  )13;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&rl_res_organism_code1;
 sqlstm.sqhstl[5] = (unsigned int  )7;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&rl_res_organism_code2;
 sqlstm.sqhstl[6] = (unsigned int  )7;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (RESOURCE_BUSY)
	{
		ins_message(ORA_MESG,"OPEN failed resource busy RL_RESULT_ORGANISM_DTL");
	}


}

/*-----------------------------------------------------*/
fetch_antibiotic_fmt5()
{
    a_antibiotic_code.arr[0]   = '\0';
    a_antibiotic_code.len	   = 0;

    /* EXEC SQL FETCH RL_ANTIBIOTIC_CUR_FMT5
              INTO a_antibiotic_code; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2510;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&a_antibiotic_code;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_ANTIBIOTIC_CUR_FMT5");

    a_antibiotic_code.arr[a_antibiotic_code.len]   = '\0';
    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/
close_antibiotic_cur_fmt5()
{
	/* EXEC SQL CLOSE RL_ANTIBIOTIC_CUR_FMT5; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2529;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_ANTIBIOTIC_CUR_FMT5");

}
/*-----------------------------------------------------*/

fetch_result_org()
{
    rl_res_organism_code.arr[0]   = '\0';
    rl_res_comment_desc.arr[0]    = '\0';

    rl_res_organism_code.len      = 0;
    rl_res_comment_desc.len       = 0;

    /* EXEC SQL FETCH RL_RESULT_ORGANISM_CUR
              INTO :rl_res_organism_code,
                   :rl_res_comment_desc; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2544;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_res_organism_code;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_res_comment_desc;
    sqlstm.sqhstl[1] = (unsigned int  )43;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_RESULT_ORGANISM_CUR");

    rl_res_organism_code.arr[rl_res_organism_code.len] = '\0';
    rl_res_comment_desc.arr[rl_res_comment_desc.len] = '\0';
    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/

fetch_org_desc()
{
    
//	EXEC SQL OPEN RL_ORGANISM_CODE_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_ORGANISM_CODE_CUR");

    rl_res_organism_code_desc.arr[0] = '\0';
    rl_res_organism_code_desc.len    = 0;

    rl_res_organism_code_s_desc.arr[0] = '\0';
    rl_res_organism_code_s_desc.len    = 0;

    /* EXEC SQL SELECT LONG_DESC, SHORT_DESC
			 INTO :rl_res_organism_code_desc, :rl_res_organism_code_s_desc
             FROM RL_ORGANISM_CODE_lang_vw
             WHERE ORGANISM_CODE = :rl_res_organism_code
			 and language_id = :language_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select LONG_DESC ,SHORT_DESC into :b0,:b1  from RL_ORGANI\
SM_CODE_lang_vw where (ORGANISM_CODE=:b2 and language_id=:b3)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2567;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_res_organism_code_desc;
    sqlstm.sqhstl[0] = (unsigned int  )43;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_res_organism_code_s_desc;
    sqlstm.sqhstl[1] = (unsigned int  )18;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_res_organism_code;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&language_id;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*
    EXEC SQL FETCH RL_ORGANISM_CODE_CUR
              INTO :rl_res_organism_code_desc;

*/

    rl_res_organism_code_desc.arr[rl_res_organism_code_desc.len] = '\0';
    rl_res_organism_code_s_desc.arr[rl_res_organism_code_s_desc.len] = '\0';

    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_ORGANISM_CODE_CUR");
}
/*-----------------------------------------------------*/

fetch_antibiotic_desc()
{
    
//	EXEC SQL OPEN RL_ANTIBIOTIC_CODE_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_ANTIBIOTIC_CODE_CUR");

    rl_res_dtl_antibiotic_desc.arr[0] = '\0';
    rl_res_dtl_antibiotic_desc.len    = 0;

    /* EXEC SQL SELECT SUBSTR(LONG_DESC,1,39)
			 INTO :rl_res_dtl_antibiotic_desc
             FROM RL_ANTIBIOTIC_CODE_lang_vw
             WHERE ANTIBIOTIC_CODE = :rl_res_dtl_antibiotic_code
			 and language_id = :language_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select SUBSTR(LONG_DESC,1,39) into :b0  from RL_ANTIBIOTI\
C_CODE_lang_vw where (ANTIBIOTIC_CODE=:b1 and language_id=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2598;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_res_dtl_antibiotic_desc;
    sqlstm.sqhstl[0] = (unsigned int  )43;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_res_dtl_antibiotic_code;
    sqlstm.sqhstl[1] = (unsigned int  )7;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&language_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*
    EXEC SQL FETCH RL_ANTIBIOTIC_CODE_CUR
              INTO :rl_res_dtl_antibiotic_desc;

*/
    rl_res_dtl_antibiotic_desc.arr[rl_res_dtl_antibiotic_desc.len] = '\0';

    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_ANTIBIOTIC_CODE_CUR");
}
/*-----------------------------------------------------*/
open_sensitivity()
{

    /* EXEC SQL OPEN RL_SENSITIVITY_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0049;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2625;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_SENSITIVITY_CUR");
}
/*-----------------------------------------------------*/
open_sensitivity_format4()
{

    /* EXEC SQL OPEN RL_SENSITIVITY_CUR_FORMAT4; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0050;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2660;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&rl_res_organism_code;
    sqlstm.sqhstl[5] = (unsigned int  )7;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_SENSITIVITY_CUR_FORMAT4");
}
/*-----------------------------------------------------*/

fetch_sensitivity()
{
   int i;
   char str[100];   

   no_of_sensitivities = 0;

   for(i=0;i<MAX_ANTIBIOTICS;i++)
   {
		s_ant[i].arr[0] = '\0';
		s_org[i].arr[0] = '\0';
		s_ind[i].arr[0] = '\0';
		s_mic[i].arr[0] = '\0';
		s_zone[i].arr[0] = '\0';

		s_ant[i].len = 0;
		s_org[i].len = 0;
		s_ind[i].len = 0;
		s_mic[i].len = 0;
		s_zone[i].len = 0;
   }

   /* EXEC SQL FETCH RL_SENSITIVITY_CUR
	         INTO :s_org,
			      :s_ant,
			      :s_ind,
				  :s_mic,
				  :s_zone; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1000;
   sqlstm.offset = (unsigned int  )2699;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)s_org;
   sqlstm.sqhstl[0] = (unsigned int  )7;
   sqlstm.sqhsts[0] = (         int  )8;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqharc[0] = (unsigned int   *)0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)s_ant;
   sqlstm.sqhstl[1] = (unsigned int  )7;
   sqlstm.sqhsts[1] = (         int  )8;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqharc[1] = (unsigned int   *)0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)s_ind;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )4;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqharc[2] = (unsigned int   *)0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)s_mic;
   sqlstm.sqhstl[3] = (unsigned int  )12;
   sqlstm.sqhsts[3] = (         int  )12;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqharc[3] = (unsigned int   *)0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)s_zone;
   sqlstm.sqhstl[4] = (unsigned int  )12;
   sqlstm.sqhsts[4] = (         int  )12;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqharc[4] = (unsigned int   *)0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_SENSITIVITY_CUR");

   for(i=0;i<MAX_ANTIBIOTICS;i++)
   {
		s_org[i].arr[s_org[i].len] = '\0';
		if(strlen(s_org[i].arr) == 0)
		   break;
		s_ant[i].arr[s_ant[i].len] = '\0';
		s_ind[i].arr[s_ind[i].len] = '\0';
		s_mic[i].arr[s_mic[i].len] = '\0';
		s_zone[i].arr[s_zone[i].len] = '\0';
   }
   no_of_sensitivities = i;
}
/*-----------------------------------------------------*/
fetch_sensitivity_format4() 
{
    b_antibiotic_code.arr[0]   = '\0';
    b_antibiotic_code.len	   = 0;
	b_sensitivity_ind.arr[0]   = '\0';
	b_sensitivity_ind.len      = 0;
	b_mic_value.arr[0]   = '\0';
	b_mic_value.len      = 0;
	b_zone_value.arr[0]   = '\0';
	b_zone_value.len      = 0;


    /* EXEC SQL FETCH RL_SENSITIVITY_CUR_FORMAT4
              INTO :b_antibiotic_code,:b_sensitivity_ind,:b_mic_value,
					:b_zone_value; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2734;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&b_antibiotic_code;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&b_sensitivity_ind;
    sqlstm.sqhstl[1] = (unsigned int  )4;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&b_mic_value;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&b_zone_value;
    sqlstm.sqhstl[3] = (unsigned int  )12;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_SENSITIVITY_CUR_FORMAT4");

    b_antibiotic_code.arr[b_antibiotic_code.len]   = '\0';
	b_sensitivity_ind.arr[b_sensitivity_ind.len]   = '\0';
	b_mic_value.arr[b_mic_value.len]   = '\0';
	b_zone_value.arr[b_zone_value.len]   = '\0';

    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/
fetch_other_dtls()
{
	if(strcmp(rl_hdr_episode_type.arr,"I")==0 || 
       strcmp(rl_hdr_episode_type.arr,"O")==0 ||
	   strcmp(rl_hdr_episode_type.arr,"H")==0 )
    { 
		get_sm_installation();
		if (strcmp(BVNewVersionYN.arr,"Y") == 0)
           declare_inpat_curs();
		else
		   declare_inpat_curs_ah();
	
    }
	else 
		declare_refpat_curs();

   fetch_pat_name();
   fetch_spec_desc();
   fetch_source();
   fetch_consultant();
   fetch_section(); 
}

/*-----------------------------------------------------*/
declare_inpat_curs()
{
	/* EXEC SQL DECLARE RL_PAT_MAST_CUR CURSOR FOR
              SELECT TITLE_CODE,
	 	      DECODE(:language_id, 'en', SHORT_NAME, 'th', SHORT_NAME_LOC_LANG) SHORT_NAME,
                     SEX, 
                     NATIONALITY_CODE,
                     ROUND(TRUNC(TO_DATE(:rl_hdr_spec_regd_date_time,
				   'DD/MM/YYYY HH24:MI')) - DATE_OF_BIRTH),
                     TO_CHAR(DATE_OF_BIRTH,'DD/MM/YYYY') ,
					 NVL(actual_dob_yn, 'N'),
					 race_code,
                     ROUND((TRUNC(TO_DATE(:rl_hdr_spec_regd_date_time,
				   'DD/MM/YYYY HH24:MI')) - DATE_OF_BIRTH)/365),
				     NATIONAL_ID_NUM,
					 //ALTERNATE_ID_NUM   /// 13.02.2005
					 nvl(ALTERNATE_ID_NUM,nvl(ALTERNATE_ID2_NUM,
													nvl(ALTERNATE_ID3_NUM,nvl(ALTERNATE_ID4_NUM,' ')))) //18.06.2008 against ML-SD-CRF-20224
                FROM MP_PATIENT_MAST 
               WHERE PATIENT_ID = :nd_hosp_no; */ 

}
/*-----------------------------------------------------*/
declare_inpat_curs_ah()
{
	/* EXEC SQL DECLARE RL_PAT_MAST_CUR_ah CURSOR FOR
              SELECT TITLE_CODE,
	 	      DECODE(:language_id, 'en', SHORT_NAME, 'th', SHORT_NAME_LOC_LANG) SHORT_NAME,
                     SEX,
                     NATIONALITY_CODE,
                     ROUND(TRUNC(TO_DATE(:rl_hdr_spec_regd_date_time,
				   'DD/MM/YYYY HH24:MI')) - DATE_OF_BIRTH),
                     TO_CHAR(DATE_OF_BIRTH,'DD/MM/YYYY') ,
					 NVL(actual_dob_yn, 'N'),
					 race_code,
                     ROUND((TRUNC(TO_DATE(:rl_hdr_spec_regd_date_time,
				   'DD/MM/YYYY HH24:MI')) - DATE_OF_BIRTH)/365),
				     NATIONAL_ID_NUM
                FROM MP_PATIENT_MAST
               WHERE PATIENT_ID = :nd_hosp_no; */ 

}
/*-----------------------------------------------------*/
declare_refpat_curs()
{
    /* EXEC SQL DECLARE RL_PAT_MAST3_CUR CURSOR FOR
              SELECT TITLE_CODE,
	 	      DECODE(:language_id, 'en', SHORT_NAME, 'th', SHORT_NAME_LOC_LANG) SHORT_NAME,
                     SEX,
                     NATIONALITY_CODE,
                     ROUND(TRUNC(TO_DATE(:rl_hdr_spec_regd_date_time,
				    'DD/MM/YYYY HH24:MI')) - DATE_OF_BIRTH),
                     TO_CHAR(DATE_OF_BIRTH,'DD/MM/YYYY'),
		     SUBSTR(NVL(ACTUAL_PATIENT_ID,'NULL'),1,10),
					NVL(actual_dob_yn, 'N'), 
					race_code,
                     ROUND((TRUNC(TO_DATE(:rl_hdr_spec_regd_date_time,
				   'DD/MM/YYYY HH24:MI')) - DATE_OF_BIRTH)/365),
				   location
                FROM RL_PATIENT_MAST
               WHERE PATIENT_ID = :nd_hosp_no; */ 

			   /* AND OPERATING_FACILITY_ID = :nd_operating_facility_id; */
}
/*-----------------------------------------------------*/
////////////////// 03.07.2005

fetch_mp_ext_per_nric() 
{
	rl_national_id_num.arr[0]				  = '\0';
	rl_alternate_id_num.arr[0]				  = '\0';
	rl_national_id_num.len					  = 0;
	rl_alternate_id_num.len                   = 0;

    /* EXEC SQL SELECT NATIONAL_ID_NO,
	        //ALT_ID1_NO
			NVL(ALT_ID1_NO,NVL(ALT_ID2_NO,NVL(ALT_ID3_NO,NVL(ALT_ID4_NO,' ')))) //18.06.2008 against ML-SD-CRF-20224

	           INTO :rl_national_id_num,:rl_alternate_id_num
               FROM MP_EXT_PERSON
              WHERE PERSON_ID = :nd_hosp_no; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select NATIONAL_ID_NO ,NVL(ALT_ID1_NO,NVL(ALT_ID2_NO,NVL(\
ALT_ID3_NO,NVL(ALT_ID4_NO,' ')))) into :b0,:b1  from MP_EXT_PERSON where PERSO\
N_ID=:b2";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )2765;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_national_id_num;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_alternate_id_num;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[2] = (unsigned int  )23;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND);    

    if (OERROR);

	rl_national_id_num.arr[rl_national_id_num.len]		 = '\0';
	rl_alternate_id_num.arr[rl_alternate_id_num.len]	 = '\0';

}

/*-----------------------------------------------------*/
fetch_pat_name()
{
    rl_pat_title.arr[0]     = '\0';
    rl_pat_long_name.arr[0]     = '\0';
    rl_pat_short_name.arr[0]     = '\0';
    rl_pat_sex.arr[0]           = '\0';
    rl_pat_nationality.arr[0]           = '\0';
    rl_pat_dob_no_of_days.arr[0]           = '\0';
    rl_pat_date_of_birth.arr[0]            = '\0';
    rl_pat_blood_group.arr[0]              = '\0';
    rl_pat_g6pd.arr[0]              = '\0';
    rl_pat_sicc.arr[0]              = '\0';
    rl_pat_hbl4_1.arr[0]              = '\0';
    rl_pat_hbl4_2.arr[0]              = '\0';
	rl_actual_dob_yn.arr[0]			  = '\0';
	rl_race_code.arr[0]				  = '\0';
	rl_age_years.arr[0]				  = '\0';
	rl_location.arr[0]				  = '\0';
	rl_national_id_num.arr[0]				  = '\0';
	rl_alternate_id_num.arr[0]				  = '\0';

    rl_pat_title.len     = 0;
    rl_pat_long_name.len         = 0;
    rl_pat_short_name.len         = 0;
    rl_pat_sex.len         = 0;
    rl_pat_nationality.len         = 0;
    rl_pat_dob_no_of_days.len         = 0;
    rl_pat_date_of_birth.len          = 0;
    rl_pat_g6pd.len                   = 0;
    rl_pat_sicc.len                   = 0;
    rl_pat_hbl4_1.len                   = 0;
    rl_pat_hbl4_2.len                   = 0;
	rl_actual_dob_yn.len				= 0;
	rl_race_code.len					= 0;
	rl_age_years.len					= 0;
	rl_location.len						= 0;
	rl_national_id_num.len				= 0;
	rl_alternate_id_num.len                = 0;

	if(strcmp(rl_hdr_episode_type.arr,"I")==0 || 
       strcmp(rl_hdr_episode_type.arr,"O")==0 ||
	   strcmp(rl_hdr_episode_type.arr,"H")==0 )
    { 

		rl_pat_actual_id.arr[0]   = '\0';
		rl_pat_actual_id.len      = 0;

	if (strcmp(BVNewVersionYN.arr,"Y") == 0)
		/* EXEC SQL OPEN RL_PAT_MAST_CUR; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = sq0059;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )2792;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&language_id;
  sqlstm.sqhstl[0] = (unsigned int  )7;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
  sqlstm.sqhstl[1] = (unsigned int  )19;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&rl_hdr_spec_regd_date_time;
  sqlstm.sqhstl[2] = (unsigned int  )19;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_hosp_no;
  sqlstm.sqhstl[3] = (unsigned int  )23;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    else
		/* EXEC SQL OPEN RL_PAT_MAST_CUR_ah; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = sq0060;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )2823;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&language_id;
  sqlstm.sqhstl[0] = (unsigned int  )7;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
  sqlstm.sqhstl[1] = (unsigned int  )19;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&rl_hdr_spec_regd_date_time;
  sqlstm.sqhstl[2] = (unsigned int  )19;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_hosp_no;
  sqlstm.sqhstl[3] = (unsigned int  )23;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
        ins_message(ORA_MESG,"OPEN failed on cursor RL_PAT_MAST_CUR");

	if (strcmp(BVNewVersionYN.arr,"Y") == 0)
    {
			/* EXEC SQL FETCH RL_PAT_MAST_CUR
					  INTO :rl_pat_title,
				   :rl_pat_short_name,
						   :rl_pat_sex,
						   :rl_pat_nationality,
						   :rl_pat_dob_no_of_days,
						   :rl_pat_date_of_birth, 
						   :rl_actual_dob_yn,
						   :rl_race_code,
						   :rl_age_years,
						   :rl_national_id_num,
						   :rl_alternate_id_num; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )2854;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_pat_title;
   sqlstm.sqhstl[0] = (unsigned int  )11;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_pat_short_name;
   sqlstm.sqhstl[1] = (unsigned int  )302;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_pat_sex;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_pat_nationality;
   sqlstm.sqhstl[3] = (unsigned int  )8;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&rl_pat_dob_no_of_days;
   sqlstm.sqhstl[4] = (unsigned int  )12;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_pat_date_of_birth;
   sqlstm.sqhstl[5] = (unsigned int  )18;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&rl_actual_dob_yn;
   sqlstm.sqhstl[6] = (unsigned int  )4;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&rl_race_code;
   sqlstm.sqhstl[7] = (unsigned int  )13;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&rl_age_years;
   sqlstm.sqhstl[8] = (unsigned int  )5;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&rl_national_id_num;
   sqlstm.sqhstl[9] = (unsigned int  )23;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&rl_alternate_id_num;
   sqlstm.sqhstl[10] = (unsigned int  )23;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}
	else
	{
			/* EXEC SQL FETCH RL_PAT_MAST_CUR_ah
					  INTO :rl_pat_title,
				   :rl_pat_short_name,
						   :rl_pat_sex,
						   :rl_pat_nationality,
						   :rl_pat_dob_no_of_days,
						   :rl_pat_date_of_birth, 
						   :rl_actual_dob_yn,
						   :rl_race_code,
						   :rl_age_years,
						   :rl_national_id_num; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )2913;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_pat_title;
   sqlstm.sqhstl[0] = (unsigned int  )11;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_pat_short_name;
   sqlstm.sqhstl[1] = (unsigned int  )302;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_pat_sex;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_pat_nationality;
   sqlstm.sqhstl[3] = (unsigned int  )8;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&rl_pat_dob_no_of_days;
   sqlstm.sqhstl[4] = (unsigned int  )12;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_pat_date_of_birth;
   sqlstm.sqhstl[5] = (unsigned int  )18;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&rl_actual_dob_yn;
   sqlstm.sqhstl[6] = (unsigned int  )4;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&rl_race_code;
   sqlstm.sqhstl[7] = (unsigned int  )13;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&rl_age_years;
   sqlstm.sqhstl[8] = (unsigned int  )5;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&rl_national_id_num;
   sqlstm.sqhstl[9] = (unsigned int  )23;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	close_mast_cur();

	if (l_print_health_card_yn.arr[0]=='Y') 
	{
		get_health_card_num();
	}

    if (OERROR)
       ins_message(ORA_MESG,"Error with MP_PATIENT_MAST fetch");
    else
	   if(NODATAFOUND) 
	   {    
			rl_pat_actual_id.arr[0]   = '\0';
			rl_pat_actual_id.len      = 0;

                /* EXEC SQL OPEN RL_PAT_MAST3_CUR; */ 

{
                struct sqlexd sqlstm;
                sqlstm.sqlvsn = 10;
                sqlstm.arrsiz = 33;
                sqlstm.sqladtp = &sqladt;
                sqlstm.sqltdsp = &sqltds;
                sqlstm.stmt = sq0061;
                sqlstm.iters = (unsigned int  )1;
                sqlstm.offset = (unsigned int  )2968;
                sqlstm.selerr = (unsigned short)1;
                sqlstm.cud = sqlcud0;
                sqlstm.sqlest = (unsigned char  *)&sqlca;
                sqlstm.sqlety = (unsigned short)256;
                sqlstm.occurs = (unsigned int  )0;
                sqlstm.sqhstv[0] = (         void  *)&language_id;
                sqlstm.sqhstl[0] = (unsigned int  )7;
                sqlstm.sqhsts[0] = (         int  )0;
                sqlstm.sqindv[0] = (         void  *)0;
                sqlstm.sqinds[0] = (         int  )0;
                sqlstm.sqharm[0] = (unsigned int  )0;
                sqlstm.sqadto[0] = (unsigned short )0;
                sqlstm.sqtdso[0] = (unsigned short )0;
                sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
                sqlstm.sqhstl[1] = (unsigned int  )19;
                sqlstm.sqhsts[1] = (         int  )0;
                sqlstm.sqindv[1] = (         void  *)0;
                sqlstm.sqinds[1] = (         int  )0;
                sqlstm.sqharm[1] = (unsigned int  )0;
                sqlstm.sqadto[1] = (unsigned short )0;
                sqlstm.sqtdso[1] = (unsigned short )0;
                sqlstm.sqhstv[2] = (         void  *)&rl_hdr_spec_regd_date_time;
                sqlstm.sqhstl[2] = (unsigned int  )19;
                sqlstm.sqhsts[2] = (         int  )0;
                sqlstm.sqindv[2] = (         void  *)0;
                sqlstm.sqinds[2] = (         int  )0;
                sqlstm.sqharm[2] = (unsigned int  )0;
                sqlstm.sqadto[2] = (unsigned short )0;
                sqlstm.sqtdso[2] = (unsigned short )0;
                sqlstm.sqhstv[3] = (         void  *)&nd_hosp_no;
                sqlstm.sqhstl[3] = (unsigned int  )23;
                sqlstm.sqhsts[3] = (         int  )0;
                sqlstm.sqindv[3] = (         void  *)0;
                sqlstm.sqinds[3] = (         int  )0;
                sqlstm.sqharm[3] = (unsigned int  )0;
                sqlstm.sqadto[3] = (unsigned short )0;
                sqlstm.sqtdso[3] = (unsigned short )0;
                sqlstm.sqphsv = sqlstm.sqhstv;
                sqlstm.sqphsl = sqlstm.sqhstl;
                sqlstm.sqphss = sqlstm.sqhsts;
                sqlstm.sqpind = sqlstm.sqindv;
                sqlstm.sqpins = sqlstm.sqinds;
                sqlstm.sqparm = sqlstm.sqharm;
                sqlstm.sqparc = sqlstm.sqharc;
                sqlstm.sqpadto = sqlstm.sqadto;
                sqlstm.sqptdso = sqlstm.sqtdso;
                sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    		/* EXEC SQL FETCH RL_PAT_MAST3_CUR
              	         INTO   :rl_pat_title,
			        :rl_pat_short_name,
                   		:rl_pat_sex,
                   		:rl_pat_nationality,
                   		:rl_pat_dob_no_of_days,
                   		:rl_pat_date_of_birth,
						:rl_pat_actual_id,
						:rl_actual_dob_yn,
						:rl_race_code,
						:rl_age_years, 
						:rl_location; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )2999;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_pat_title;
      sqlstm.sqhstl[0] = (unsigned int  )11;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_pat_short_name;
      sqlstm.sqhstl[1] = (unsigned int  )302;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&rl_pat_sex;
      sqlstm.sqhstl[2] = (unsigned int  )4;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&rl_pat_nationality;
      sqlstm.sqhstl[3] = (unsigned int  )8;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&rl_pat_dob_no_of_days;
      sqlstm.sqhstl[4] = (unsigned int  )12;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqhstv[5] = (         void  *)&rl_pat_date_of_birth;
      sqlstm.sqhstl[5] = (unsigned int  )18;
      sqlstm.sqhsts[5] = (         int  )0;
      sqlstm.sqindv[5] = (         void  *)0;
      sqlstm.sqinds[5] = (         int  )0;
      sqlstm.sqharm[5] = (unsigned int  )0;
      sqlstm.sqadto[5] = (unsigned short )0;
      sqlstm.sqtdso[5] = (unsigned short )0;
      sqlstm.sqhstv[6] = (         void  *)&rl_pat_actual_id;
      sqlstm.sqhstl[6] = (unsigned int  )33;
      sqlstm.sqhsts[6] = (         int  )0;
      sqlstm.sqindv[6] = (         void  *)0;
      sqlstm.sqinds[6] = (         int  )0;
      sqlstm.sqharm[6] = (unsigned int  )0;
      sqlstm.sqadto[6] = (unsigned short )0;
      sqlstm.sqtdso[6] = (unsigned short )0;
      sqlstm.sqhstv[7] = (         void  *)&rl_actual_dob_yn;
      sqlstm.sqhstl[7] = (unsigned int  )4;
      sqlstm.sqhsts[7] = (         int  )0;
      sqlstm.sqindv[7] = (         void  *)0;
      sqlstm.sqinds[7] = (         int  )0;
      sqlstm.sqharm[7] = (unsigned int  )0;
      sqlstm.sqadto[7] = (unsigned short )0;
      sqlstm.sqtdso[7] = (unsigned short )0;
      sqlstm.sqhstv[8] = (         void  *)&rl_race_code;
      sqlstm.sqhstl[8] = (unsigned int  )13;
      sqlstm.sqhsts[8] = (         int  )0;
      sqlstm.sqindv[8] = (         void  *)0;
      sqlstm.sqinds[8] = (         int  )0;
      sqlstm.sqharm[8] = (unsigned int  )0;
      sqlstm.sqadto[8] = (unsigned short )0;
      sqlstm.sqtdso[8] = (unsigned short )0;
      sqlstm.sqhstv[9] = (         void  *)&rl_age_years;
      sqlstm.sqhstl[9] = (unsigned int  )5;
      sqlstm.sqhsts[9] = (         int  )0;
      sqlstm.sqindv[9] = (         void  *)0;
      sqlstm.sqinds[9] = (         int  )0;
      sqlstm.sqharm[9] = (unsigned int  )0;
      sqlstm.sqadto[9] = (unsigned short )0;
      sqlstm.sqtdso[9] = (unsigned short )0;
      sqlstm.sqhstv[10] = (         void  *)&rl_location;
      sqlstm.sqhstl[10] = (unsigned int  )23;
      sqlstm.sqhsts[10] = (         int  )0;
      sqlstm.sqindv[10] = (         void  *)0;
      sqlstm.sqinds[10] = (         int  )0;
      sqlstm.sqharm[10] = (unsigned int  )0;
      sqlstm.sqadto[10] = (unsigned short )0;
      sqlstm.sqtdso[10] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


               if (OERROR)
                  ins_message(ORA_MESG,"Error with RL_PATIENT_MAST fetch");	
               else
					if(NODATAFOUND);

			close_mast3_cur();

       }
	}
	else
	{
	    rl_pat_actual_id.arr[0]   = '\0';
		rl_pat_actual_id.len      = 0;
             /* EXEC SQL OPEN RL_PAT_MAST3_CUR; */ 

{
             struct sqlexd sqlstm;
             sqlstm.sqlvsn = 10;
             sqlstm.arrsiz = 33;
             sqlstm.sqladtp = &sqladt;
             sqlstm.sqltdsp = &sqltds;
             sqlstm.stmt = sq0061;
             sqlstm.iters = (unsigned int  )1;
             sqlstm.offset = (unsigned int  )3058;
             sqlstm.selerr = (unsigned short)1;
             sqlstm.cud = sqlcud0;
             sqlstm.sqlest = (unsigned char  *)&sqlca;
             sqlstm.sqlety = (unsigned short)256;
             sqlstm.occurs = (unsigned int  )0;
             sqlstm.sqhstv[0] = (         void  *)&language_id;
             sqlstm.sqhstl[0] = (unsigned int  )7;
             sqlstm.sqhsts[0] = (         int  )0;
             sqlstm.sqindv[0] = (         void  *)0;
             sqlstm.sqinds[0] = (         int  )0;
             sqlstm.sqharm[0] = (unsigned int  )0;
             sqlstm.sqadto[0] = (unsigned short )0;
             sqlstm.sqtdso[0] = (unsigned short )0;
             sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
             sqlstm.sqhstl[1] = (unsigned int  )19;
             sqlstm.sqhsts[1] = (         int  )0;
             sqlstm.sqindv[1] = (         void  *)0;
             sqlstm.sqinds[1] = (         int  )0;
             sqlstm.sqharm[1] = (unsigned int  )0;
             sqlstm.sqadto[1] = (unsigned short )0;
             sqlstm.sqtdso[1] = (unsigned short )0;
             sqlstm.sqhstv[2] = (         void  *)&rl_hdr_spec_regd_date_time;
             sqlstm.sqhstl[2] = (unsigned int  )19;
             sqlstm.sqhsts[2] = (         int  )0;
             sqlstm.sqindv[2] = (         void  *)0;
             sqlstm.sqinds[2] = (         int  )0;
             sqlstm.sqharm[2] = (unsigned int  )0;
             sqlstm.sqadto[2] = (unsigned short )0;
             sqlstm.sqtdso[2] = (unsigned short )0;
             sqlstm.sqhstv[3] = (         void  *)&nd_hosp_no;
             sqlstm.sqhstl[3] = (unsigned int  )23;
             sqlstm.sqhsts[3] = (         int  )0;
             sqlstm.sqindv[3] = (         void  *)0;
             sqlstm.sqinds[3] = (         int  )0;
             sqlstm.sqharm[3] = (unsigned int  )0;
             sqlstm.sqadto[3] = (unsigned short )0;
             sqlstm.sqtdso[3] = (unsigned short )0;
             sqlstm.sqphsv = sqlstm.sqhstv;
             sqlstm.sqphsl = sqlstm.sqhstl;
             sqlstm.sqphss = sqlstm.sqhsts;
             sqlstm.sqpind = sqlstm.sqindv;
             sqlstm.sqpins = sqlstm.sqinds;
             sqlstm.sqparm = sqlstm.sqharm;
             sqlstm.sqparc = sqlstm.sqharc;
             sqlstm.sqpadto = sqlstm.sqadto;
             sqlstm.sqptdso = sqlstm.sqtdso;
             sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    		/* EXEC SQL FETCH RL_PAT_MAST3_CUR
              	         INTO   :rl_pat_title,
			        :rl_pat_short_name,
                   		:rl_pat_sex,
                   		:rl_pat_nationality,
                   		:rl_pat_dob_no_of_days,
                   		:rl_pat_date_of_birth,
						:rl_pat_actual_id,
						:rl_actual_dob_yn,
						:rl_race_code, 
						:rl_age_years,
						:rl_location; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3089;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_pat_title;
      sqlstm.sqhstl[0] = (unsigned int  )11;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_pat_short_name;
      sqlstm.sqhstl[1] = (unsigned int  )302;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&rl_pat_sex;
      sqlstm.sqhstl[2] = (unsigned int  )4;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&rl_pat_nationality;
      sqlstm.sqhstl[3] = (unsigned int  )8;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&rl_pat_dob_no_of_days;
      sqlstm.sqhstl[4] = (unsigned int  )12;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqhstv[5] = (         void  *)&rl_pat_date_of_birth;
      sqlstm.sqhstl[5] = (unsigned int  )18;
      sqlstm.sqhsts[5] = (         int  )0;
      sqlstm.sqindv[5] = (         void  *)0;
      sqlstm.sqinds[5] = (         int  )0;
      sqlstm.sqharm[5] = (unsigned int  )0;
      sqlstm.sqadto[5] = (unsigned short )0;
      sqlstm.sqtdso[5] = (unsigned short )0;
      sqlstm.sqhstv[6] = (         void  *)&rl_pat_actual_id;
      sqlstm.sqhstl[6] = (unsigned int  )33;
      sqlstm.sqhsts[6] = (         int  )0;
      sqlstm.sqindv[6] = (         void  *)0;
      sqlstm.sqinds[6] = (         int  )0;
      sqlstm.sqharm[6] = (unsigned int  )0;
      sqlstm.sqadto[6] = (unsigned short )0;
      sqlstm.sqtdso[6] = (unsigned short )0;
      sqlstm.sqhstv[7] = (         void  *)&rl_actual_dob_yn;
      sqlstm.sqhstl[7] = (unsigned int  )4;
      sqlstm.sqhsts[7] = (         int  )0;
      sqlstm.sqindv[7] = (         void  *)0;
      sqlstm.sqinds[7] = (         int  )0;
      sqlstm.sqharm[7] = (unsigned int  )0;
      sqlstm.sqadto[7] = (unsigned short )0;
      sqlstm.sqtdso[7] = (unsigned short )0;
      sqlstm.sqhstv[8] = (         void  *)&rl_race_code;
      sqlstm.sqhstl[8] = (unsigned int  )13;
      sqlstm.sqhsts[8] = (         int  )0;
      sqlstm.sqindv[8] = (         void  *)0;
      sqlstm.sqinds[8] = (         int  )0;
      sqlstm.sqharm[8] = (unsigned int  )0;
      sqlstm.sqadto[8] = (unsigned short )0;
      sqlstm.sqtdso[8] = (unsigned short )0;
      sqlstm.sqhstv[9] = (         void  *)&rl_age_years;
      sqlstm.sqhstl[9] = (unsigned int  )5;
      sqlstm.sqhsts[9] = (         int  )0;
      sqlstm.sqindv[9] = (         void  *)0;
      sqlstm.sqinds[9] = (         int  )0;
      sqlstm.sqharm[9] = (unsigned int  )0;
      sqlstm.sqadto[9] = (unsigned short )0;
      sqlstm.sqtdso[9] = (unsigned short )0;
      sqlstm.sqhstv[10] = (         void  *)&rl_location;
      sqlstm.sqhstl[10] = (unsigned int  )23;
      sqlstm.sqhsts[10] = (         int  )0;
      sqlstm.sqindv[10] = (         void  *)0;
      sqlstm.sqinds[10] = (         int  )0;
      sqlstm.sqharm[10] = (unsigned int  )0;
      sqlstm.sqadto[10] = (unsigned short )0;
      sqlstm.sqtdso[10] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


               if (OERROR)
                  ins_message(ORA_MESG,"Error with RL_PATIENT_MAST fetch");	
               else
	          if(NODATAFOUND);

			close_mast3_cur();


	}
    rl_pat_title.arr[rl_pat_title.len]                   = '\0';
    rl_pat_long_name.arr[rl_pat_long_name.len]           = '\0';
    rl_pat_short_name.arr[rl_pat_short_name.len]         = '\0';
    rl_pat_long_name.arr[rl_pat_long_name.len]           = '\0';
    rl_pat_short_name.arr[rl_pat_short_name.len]         = '\0';
    rl_pat_sex.arr[rl_pat_sex.len]                       = '\0';
    rl_pat_nationality.arr[rl_pat_nationality.len]       = '\0';
    rl_pat_dob_no_of_days.arr[rl_pat_dob_no_of_days.len] = '\0';
    rl_pat_date_of_birth.arr[rl_pat_date_of_birth.len]   = '\0';
    rl_pat_actual_id.arr[rl_pat_actual_id.len]           = '\0';
	rl_actual_dob_yn.arr[rl_actual_dob_yn.len]			 = '\0';
	rl_race_code.arr[rl_race_code.len]					 = '\0';
	rl_age_years.arr[rl_age_years.len]					 = '\0';
	rl_location.arr[rl_location.len]					 = '\0';
	rl_national_id_num.arr[rl_national_id_num.len]		 = '\0';
	rl_alternate_id_num.arr[rl_alternate_id_num.len]	 = '\0';

}

/*-----------------------------------------------------*/
fetch_spec_desc()   
{

//    EXEC SQL OPEN RL_SPECIMEN_TYPE_CODE_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_SPECIMEN_TYPE_CODE_CUR");

    rl_spc_specimen_desc.arr[0] = '\0';
    rl_spc_specimen_desc.len    = 0;

		/* EXEC SQL SELECT SPECIMEN_DESC
				 INTO :rl_spc_specimen_desc
				 FROM RL_SPECIMEN_TYPE_CODE_lang_vw
				 WHERE SPECIMEN_TYPE_CODE = :rl_hdr_specimen_type_code
				 and language_id = :language_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select SPECIMEN_DESC into :b0  from RL_SPECIMEN_TYPE_CODE_l\
ang_vw where (SPECIMEN_TYPE_CODE=:b1 and language_id=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )3148;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&rl_spc_specimen_desc;
  sqlstm.sqhstl[0] = (unsigned int  )43;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&rl_hdr_specimen_type_code;
  sqlstm.sqhstl[1] = (unsigned int  )7;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&language_id;
  sqlstm.sqhstl[2] = (unsigned int  )7;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*
    EXEC SQL FETCH RL_SPECIMEN_TYPE_CODE_CUR
              INTO :rl_spc_specimen_desc;

*/
    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_SPECIMEN_TYPE_CODE_CUR");

    rl_spc_specimen_desc.arr[rl_spc_specimen_desc.len] = '\0';

}
/*-----------------------------------------------------*/

fetch_test_code(loc_tst_code)
char loc_tst_code[];
{
    strcpy(rl_loc_test_code.arr,loc_tst_code);
    rl_loc_test_code.len  =  strlen(rl_loc_test_code.arr);

//    EXEC SQL OPEN RL_TEST_CODE_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_TEST_CODE_CUR");

    rl_tst_cd_short_desc.arr[0]         = '\0';
    rl_tst_cd_numeric_result_yn.arr[0]  = '\0';
    rl_tst_cd_age_sex_range_yn.arr[0]   = '\0';
    rl_tst_cd_function_yn.arr[0]        = '\0';
    rl_tst_cd_print_report_yn.arr[0]    = '\0';
    rl_tst_cd_low_value_normal.arr[0]   = '\0';
    rl_tst_cd_high_value_normal.arr[0]  = '\0';
    rl_tst_cd_test_units_2.arr[0]   = '\0';
    rl_tst_cd_group_test_yn.arr[0]      = '\0';
    rl_tst_cd_text_block_yn.arr[0]      = '\0';
    rl_tst_cd_culture_test_yn.arr[0]    = '\0';
    rl_tst_cd_snomed_yn.arr[0]          = '\0';
    rl_tst_cd_range_cmt_2.arr[0]        = '\0';
	rl_tst_cd_inh_rep_yn.arr[0]		    = '\0';
	rl_tst_cd_conf_yn.arr[0]		    = '\0';
	rl_tst_cd_oth_units.arr[0]			= '\0';

    rl_tst_cd_short_desc.len            = 0;
    rl_tst_cd_numeric_result_yn.len     = 0;
    rl_tst_cd_age_sex_range_yn.len      = 0;
    rl_tst_cd_function_yn.len           = 0;
    rl_tst_cd_print_report_yn.len       = 0;
    rl_tst_cd_low_value_normal.len      = 0;
    rl_tst_cd_high_value_normal.len     = 0;
    rl_tst_cd_test_units_2.len      = 0;
    rl_tst_cd_group_test_yn.len         = 0;
    rl_tst_cd_text_block_yn.len         = 0;
    rl_tst_cd_culture_test_yn.len       = 0;
    rl_tst_cd_snomed_yn.len             = 0;
    rl_tst_cd_range_cmt_2.len           = 0;
	rl_tst_cd_inh_rep_yn.len		    = 0;
	rl_tst_cd_conf_yn.len				= 0;
	rl_tst_cd_oth_units.len             = 0;  /// 26.01.2006
	

    rl_tst_cd_no_of_decimals = 0;
    rl_tst_cd_significant_digit = 0;

    /* EXEC SQL SELECT b.LONG_DESC,
                    a.NUMERIC_RESULT_YN,
                    a.AGE_SEX_RANGE_YN,
                    a.FUNCTION_YN,
                    a.PRINT_NAME_YN,
                    a.LOW_VALUE_NORMAL,
                    a.HIGH_VALUE_NORMAL,
                     a.GROUP_TEST_YN,
                     a.TEXT_BLOCK_YN,
                     a.CULTURE_TEST_YN,
                     a.SNOMED_YN,
                     a.TEST_UNITS,
                     NVL(a.NO_OF_DECIMALS,0),
                     NVL(a.SIGNIFICANT_DIGIT,0),
					 a.REF_RANGE_COMMENT,
					 NVL(a.INHIBIT_REPORT_YN,'N'),
					 NVL(a.CONFIDENTIAL_YN,'N'),
					 a.OTHER_TEST_UNITS
              INTO :rl_tst_cd_short_desc,
                   :rl_tst_cd_numeric_result_yn,
                   :rl_tst_cd_age_sex_range_yn,
                   :rl_tst_cd_function_yn,
                   :rl_tst_cd_print_report_yn,
                   :rl_tst_cd_low_value_normal,
                   :rl_tst_cd_high_value_normal,
                   :rl_tst_cd_group_test_yn,
                   :rl_tst_cd_text_block_yn,
                   :rl_tst_cd_culture_test_yn,
                   :rl_tst_cd_snomed_yn,
                   :rl_tst_cd_test_units_2,
                   :rl_tst_cd_no_of_decimals,
                   :rl_tst_cd_significant_digit,
                   :rl_tst_cd_range_cmt_2,
				   :rl_tst_cd_inh_rep_yn,
				   :rl_tst_cd_conf_yn,
				   :rl_tst_cd_oth_units
                FROM rl_test_code a, RL_TEST_CODE_lang_vw b
               WHERE a.test_code = b.test_code
			   and a.TEST_CODE = :rl_loc_test_code
                 AND NVL(a.INHIBIT_REPORT_YN,'N') = 'N'
				 and b.language_id = :language_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select b.LONG_DESC ,a.NUMERIC_RESULT_YN ,a.AGE_SEX_RANGE_\
YN ,a.FUNCTION_YN ,a.PRINT_NAME_YN ,a.LOW_VALUE_NORMAL ,a.HIGH_VALUE_NORMAL ,a\
.GROUP_TEST_YN ,a.TEXT_BLOCK_YN ,a.CULTURE_TEST_YN ,a.SNOMED_YN ,a.TEST_UNITS \
,NVL(a.NO_OF_DECIMALS,0) ,NVL(a.SIGNIFICANT_DIGIT,0) ,a.REF_RANGE_COMMENT ,NVL\
(a.INHIBIT_REPORT_YN,'N') ,NVL(a.CONFIDENTIAL_YN,'N') ,a.OTHER_TEST_UNITS into\
 :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16,:b\
17  from rl_test_code a ,RL_TEST_CODE_lang_vw b where (((a.test_code=b.test_co\
de and a.TEST_CODE=:b18) and NVL(a.INHIBIT_REPORT_YN,'N')='N') and b.language_\
id=:b19)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3175;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_tst_cd_short_desc;
    sqlstm.sqhstl[0] = (unsigned int  )43;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_tst_cd_numeric_result_yn;
    sqlstm.sqhstl[1] = (unsigned int  )4;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_tst_cd_age_sex_range_yn;
    sqlstm.sqhstl[2] = (unsigned int  )4;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_cd_function_yn;
    sqlstm.sqhstl[3] = (unsigned int  )4;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_cd_print_report_yn;
    sqlstm.sqhstl[4] = (unsigned int  )4;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&rl_tst_cd_low_value_normal;
    sqlstm.sqhstl[5] = (unsigned int  )18;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&rl_tst_cd_high_value_normal;
    sqlstm.sqhstl[6] = (unsigned int  )18;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&rl_tst_cd_group_test_yn;
    sqlstm.sqhstl[7] = (unsigned int  )4;
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqhstv[8] = (         void  *)&rl_tst_cd_text_block_yn;
    sqlstm.sqhstl[8] = (unsigned int  )4;
    sqlstm.sqhsts[8] = (         int  )0;
    sqlstm.sqindv[8] = (         void  *)0;
    sqlstm.sqinds[8] = (         int  )0;
    sqlstm.sqharm[8] = (unsigned int  )0;
    sqlstm.sqadto[8] = (unsigned short )0;
    sqlstm.sqtdso[8] = (unsigned short )0;
    sqlstm.sqhstv[9] = (         void  *)&rl_tst_cd_culture_test_yn;
    sqlstm.sqhstl[9] = (unsigned int  )4;
    sqlstm.sqhsts[9] = (         int  )0;
    sqlstm.sqindv[9] = (         void  *)0;
    sqlstm.sqinds[9] = (         int  )0;
    sqlstm.sqharm[9] = (unsigned int  )0;
    sqlstm.sqadto[9] = (unsigned short )0;
    sqlstm.sqtdso[9] = (unsigned short )0;
    sqlstm.sqhstv[10] = (         void  *)&rl_tst_cd_snomed_yn;
    sqlstm.sqhstl[10] = (unsigned int  )4;
    sqlstm.sqhsts[10] = (         int  )0;
    sqlstm.sqindv[10] = (         void  *)0;
    sqlstm.sqinds[10] = (         int  )0;
    sqlstm.sqharm[10] = (unsigned int  )0;
    sqlstm.sqadto[10] = (unsigned short )0;
    sqlstm.sqtdso[10] = (unsigned short )0;
    sqlstm.sqhstv[11] = (         void  *)&rl_tst_cd_test_units_2;
    sqlstm.sqhstl[11] = (unsigned int  )13;
    sqlstm.sqhsts[11] = (         int  )0;
    sqlstm.sqindv[11] = (         void  *)0;
    sqlstm.sqinds[11] = (         int  )0;
    sqlstm.sqharm[11] = (unsigned int  )0;
    sqlstm.sqadto[11] = (unsigned short )0;
    sqlstm.sqtdso[11] = (unsigned short )0;
    sqlstm.sqhstv[12] = (         void  *)&rl_tst_cd_no_of_decimals;
    sqlstm.sqhstl[12] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[12] = (         int  )0;
    sqlstm.sqindv[12] = (         void  *)0;
    sqlstm.sqinds[12] = (         int  )0;
    sqlstm.sqharm[12] = (unsigned int  )0;
    sqlstm.sqadto[12] = (unsigned short )0;
    sqlstm.sqtdso[12] = (unsigned short )0;
    sqlstm.sqhstv[13] = (         void  *)&rl_tst_cd_significant_digit;
    sqlstm.sqhstl[13] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[13] = (         int  )0;
    sqlstm.sqindv[13] = (         void  *)0;
    sqlstm.sqinds[13] = (         int  )0;
    sqlstm.sqharm[13] = (unsigned int  )0;
    sqlstm.sqadto[13] = (unsigned short )0;
    sqlstm.sqtdso[13] = (unsigned short )0;
    sqlstm.sqhstv[14] = (         void  *)&rl_tst_cd_range_cmt_2;
    sqlstm.sqhstl[14] = (unsigned int  )43;
    sqlstm.sqhsts[14] = (         int  )0;
    sqlstm.sqindv[14] = (         void  *)0;
    sqlstm.sqinds[14] = (         int  )0;
    sqlstm.sqharm[14] = (unsigned int  )0;
    sqlstm.sqadto[14] = (unsigned short )0;
    sqlstm.sqtdso[14] = (unsigned short )0;
    sqlstm.sqhstv[15] = (         void  *)&rl_tst_cd_inh_rep_yn;
    sqlstm.sqhstl[15] = (unsigned int  )4;
    sqlstm.sqhsts[15] = (         int  )0;
    sqlstm.sqindv[15] = (         void  *)0;
    sqlstm.sqinds[15] = (         int  )0;
    sqlstm.sqharm[15] = (unsigned int  )0;
    sqlstm.sqadto[15] = (unsigned short )0;
    sqlstm.sqtdso[15] = (unsigned short )0;
    sqlstm.sqhstv[16] = (         void  *)&rl_tst_cd_conf_yn;
    sqlstm.sqhstl[16] = (unsigned int  )4;
    sqlstm.sqhsts[16] = (         int  )0;
    sqlstm.sqindv[16] = (         void  *)0;
    sqlstm.sqinds[16] = (         int  )0;
    sqlstm.sqharm[16] = (unsigned int  )0;
    sqlstm.sqadto[16] = (unsigned short )0;
    sqlstm.sqtdso[16] = (unsigned short )0;
    sqlstm.sqhstv[17] = (         void  *)&rl_tst_cd_oth_units;
    sqlstm.sqhstl[17] = (unsigned int  )13;
    sqlstm.sqhsts[17] = (         int  )0;
    sqlstm.sqindv[17] = (         void  *)0;
    sqlstm.sqinds[17] = (         int  )0;
    sqlstm.sqharm[17] = (unsigned int  )0;
    sqlstm.sqadto[17] = (unsigned short )0;
    sqlstm.sqtdso[17] = (unsigned short )0;
    sqlstm.sqhstv[18] = (         void  *)&rl_loc_test_code;
    sqlstm.sqhstl[18] = (unsigned int  )13;
    sqlstm.sqhsts[18] = (         int  )0;
    sqlstm.sqindv[18] = (         void  *)0;
    sqlstm.sqinds[18] = (         int  )0;
    sqlstm.sqharm[18] = (unsigned int  )0;
    sqlstm.sqadto[18] = (unsigned short )0;
    sqlstm.sqtdso[18] = (unsigned short )0;
    sqlstm.sqhstv[19] = (         void  *)&language_id;
    sqlstm.sqhstl[19] = (unsigned int  )7;
    sqlstm.sqhsts[19] = (         int  )0;
    sqlstm.sqindv[19] = (         void  *)0;
    sqlstm.sqinds[19] = (         int  )0;
    sqlstm.sqharm[19] = (unsigned int  )0;
    sqlstm.sqadto[19] = (unsigned short )0;
    sqlstm.sqtdso[19] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*
    EXEC SQL FETCH RL_TEST_CODE_CUR
              INTO :rl_tst_cd_short_desc,
                   :rl_tst_cd_numeric_result_yn,
                   :rl_tst_cd_age_sex_range_yn,
                   :rl_tst_cd_function_yn,
                   :rl_tst_cd_print_report_yn,
                   :rl_tst_cd_low_value_normal,
                   :rl_tst_cd_high_value_normal,
                   :rl_tst_cd_group_test_yn,
                   :rl_tst_cd_text_block_yn,
                   :rl_tst_cd_culture_test_yn,
                   :rl_tst_cd_snomed_yn,
                   :rl_tst_cd_test_units_2,
                   :rl_tst_cd_no_of_decimals,
                   :rl_tst_cd_significant_digit,
                   :rl_tst_cd_range_cmt_2,
				   :rl_tst_cd_inh_rep_yn,
				   :rl_tst_cd_conf_yn;

*/

    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_TEST_CODE_CUR");

    rl_tst_cd_short_desc.arr[rl_tst_cd_short_desc.len] = '\0';
    rl_tst_cd_numeric_result_yn.arr[rl_tst_cd_numeric_result_yn.len] = '\0';
    rl_tst_cd_age_sex_range_yn.arr[rl_tst_cd_age_sex_range_yn.len] = '\0';
    rl_tst_cd_function_yn.arr[rl_tst_cd_function_yn.len] = '\0';
    rl_tst_cd_print_report_yn.arr[rl_tst_cd_print_report_yn.len] = '\0';
    rl_tst_cd_low_value_normal.arr[rl_tst_cd_low_value_normal.len] = '\0';
    rl_tst_cd_high_value_normal.arr[rl_tst_cd_high_value_normal.len] = '\0';
    rl_tst_cd_test_units_2.arr[rl_tst_cd_test_units_2.len] = '\0';
    rl_tst_cd_group_test_yn.arr[rl_tst_cd_group_test_yn.len] = '\0';
    rl_tst_cd_text_block_yn.arr[rl_tst_cd_text_block_yn.len] = '\0';
    rl_tst_cd_culture_test_yn.arr[rl_tst_cd_culture_test_yn.len] = '\0';
    rl_tst_cd_snomed_yn.arr[rl_tst_cd_snomed_yn.len] = '\0';
    rl_tst_cd_range_cmt_2.arr[rl_tst_cd_range_cmt_2.len] = '\0';
    rl_tst_cd_inh_rep_yn.arr[rl_tst_cd_inh_rep_yn.len] = '\0';
	rl_tst_cd_conf_yn.arr[rl_tst_cd_conf_yn.len]	   = '\0';		
	rl_tst_cd_oth_units.arr[rl_tst_cd_oth_units.len]   = '\0';

    rl_tst_cd_no_of_decimals = rl_tst_cd_no_of_decimals>9?9:
                         rl_tst_cd_no_of_decimals;
    rl_tst_cd_significant_digit = rl_tst_cd_no_of_decimals>9?9:
                         rl_tst_cd_significant_digit;

    if (sqlca.sqlerrd[2]) tst_cd_ind = 1;
    return (sqlca.sqlerrd[2]);
}
/*-----------------------------------------------------*/
check_profile_yn(loc_tst_code)
char loc_tst_code[];
{
    strcpy(rl_loc_grp_test_code.arr,loc_tst_code);
    rl_loc_grp_test_code.len  =  strlen(rl_loc_grp_test_code.arr);

	rl_tst_cd_profile_yn.arr[0]		    = '\0';
	rl_tst_cd_profile_yn.len			= 0;

    /* EXEC SQL SELECT  NVL(PROFILE_YN,'N')    /// 21.05.2005    
               INTO :rl_tst_cd_profile_yn
               FROM  RL_TEST_CODE
              WHERE  TEST_CODE = :rl_loc_grp_test_code
                AND  NVL(GROUP_TEST_YN,'N') = 'Y'; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select NVL(PROFILE_YN,'N') into :b0  from RL_TEST_CODE wh\
ere (TEST_CODE=:b1 and NVL(GROUP_TEST_YN,'N')='Y')";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3270;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_tst_cd_profile_yn;
    sqlstm.sqhstl[0] = (unsigned int  )4;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_loc_grp_test_code;
    sqlstm.sqhstl[1] = (unsigned int  )13;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND);
	   
    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_TEST_CODE_CUR..2");

	rl_tst_cd_profile_yn.arr[rl_tst_cd_profile_yn.len]	   = '\0';		

}
/*-----------------------------------------------------*/


fetch_source()
{
    if (rl_hdr_source_type.arr[0] == 'W') 
      {
      /* EXEC SQL  
			/oSELECT LONG_DESC
			INTO :rl_source_short_name
            FROM IP_WARD
            WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
			AND WARD_CODE = :rl_hdr_source_code;
			o/
			SELECT long_desc INTO :rl_source_short_name
			FROM   ip_nursing_unit_lang_vw 
			WHERE  facility_id = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
			AND NURSING_UNIT_CODE = :rl_hdr_source_code
			and language_id = :language_id; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select long_desc into :b0  from ip_nursing_unit_lang_vw\
 where ((facility_id=NVL(:b1,:b2) and NURSING_UNIT_CODE=:b3) and language_id=:\
b4)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3293;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_source_short_name;
      sqlstm.sqhstl[0] = (unsigned int  )43;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
      sqlstm.sqhstl[1] = (unsigned int  )5;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
      sqlstm.sqhstl[2] = (unsigned int  )7;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&rl_hdr_source_code;
      sqlstm.sqhstl[3] = (unsigned int  )13;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&language_id;
      sqlstm.sqhstl[4] = (unsigned int  )7;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      }
    else if (rl_hdr_source_type.arr[0] == 'E') 
      {
      /* EXEC SQL  SELECT LONG_DESC,
		       NO_OF_COPIES
		  INTO :rl_source_short_name,
		       :sy_ref_no_of_copies
                  FROM RL_REFERRAL_lang_vw
                 WHERE REFERRAL_CODE = :rl_hdr_source_code
				 and language_id = :language_id; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select LONG_DESC ,NO_OF_COPIES into :b0,:b1  from RL_RE\
FERRAL_lang_vw where (REFERRAL_CODE=:b2 and language_id=:b3)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3328;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_source_short_name;
      sqlstm.sqhstl[0] = (unsigned int  )43;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&sy_ref_no_of_copies;
      sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&rl_hdr_source_code;
      sqlstm.sqhstl[2] = (unsigned int  )13;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&language_id;
      sqlstm.sqhstl[3] = (unsigned int  )7;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      }
    else if (rl_hdr_source_type.arr[0] == 'C') 
      {
      /* EXEC SQL  SELECT LONG_DESC
		  INTO :rl_source_short_name
                  FROM OP_CLINIC_lang_vw
                 WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
				   AND CLINIC_CODE = :rl_hdr_source_code
				   and language_id = :language_id; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select LONG_DESC into :b0  from OP_CLINIC_lang_vw where\
 ((FACILITY_ID=NVL(:b1,:b2) and CLINIC_CODE=:b3) and language_id=:b4)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3359;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_source_short_name;
      sqlstm.sqhstl[0] = (unsigned int  )43;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
      sqlstm.sqhstl[1] = (unsigned int  )5;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
      sqlstm.sqhstl[2] = (unsigned int  )7;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&rl_hdr_source_code;
      sqlstm.sqhstl[3] = (unsigned int  )13;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&language_id;
      sqlstm.sqhstl[4] = (unsigned int  )7;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      }
    else
       ins_message(ORA_MESG,"Invalid Source type in Request Header");
	      
    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on SOURCE master ");

    rl_source_short_name.arr[rl_source_short_name.len] = '\0';
}
/*-----------------------------------------------------*/

fetch_consultant()
{
    if (rl_hdr_episode_type.arr[0] == 'I') 
      {
      /* EXEC SQL  SELECT FULL_NAME
		  INTO :rl_consultant_short_name
                  FROM SY_PHYSICIAN_MAST_lang_vw
                 WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
				   AND PHYSICIAN_ID = :rl_hdr_consultant_code
				   and language_id = :language_id; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select FULL_NAME into :b0  from SY_PHYSICIAN_MAST_lang_\
vw where ((FACILITY_ID=NVL(:b1,:b2) and PHYSICIAN_ID=:b3) and language_id=:b4)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3394;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_consultant_short_name;
      sqlstm.sqhstl[0] = (unsigned int  )43;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
      sqlstm.sqhstl[1] = (unsigned int  )5;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
      sqlstm.sqhstl[2] = (unsigned int  )7;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&rl_hdr_consultant_code;
      sqlstm.sqhstl[3] = (unsigned int  )18;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&language_id;
      sqlstm.sqhstl[4] = (unsigned int  )7;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      }
    else if (rl_hdr_episode_type.arr[0] == 'R' || rl_hdr_episode_type.arr[0] == 'H')
      {
      /* EXEC SQL  SELECT LONG_NAME
		  INTO :rl_consultant_short_name
                  FROM RL_CONSULTANTS_lang_vw
                 WHERE REF_CONSULTANT_ID = :rl_hdr_consultant_code
				 and language_id = :language_id; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select LONG_NAME into :b0  from RL_CONSULTANTS_lang_vw \
where (REF_CONSULTANT_ID=:b1 and language_id=:b2)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3429;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_consultant_short_name;
      sqlstm.sqhstl[0] = (unsigned int  )43;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_hdr_consultant_code;
      sqlstm.sqhstl[1] = (unsigned int  )18;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&language_id;
      sqlstm.sqhstl[2] = (unsigned int  )7;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      }
    else if (rl_hdr_episode_type.arr[0] == 'O') 
      {
      /* EXEC SQL  SELECT FULL_NAME
		  INTO :rl_consultant_short_name
                  FROM SY_PHYSICIAN_MAST_lang_vw
                 WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
				   AND PHYSICIAN_ID = :rl_hdr_consultant_code
				   and language_id = :language_id; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select FULL_NAME into :b0  from SY_PHYSICIAN_MAST_lang_\
vw where ((FACILITY_ID=NVL(:b1,:b2) and PHYSICIAN_ID=:b3) and language_id=:b4)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3456;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&rl_consultant_short_name;
      sqlstm.sqhstl[0] = (unsigned int  )43;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
      sqlstm.sqhstl[1] = (unsigned int  )5;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
      sqlstm.sqhstl[2] = (unsigned int  )7;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&rl_hdr_consultant_code;
      sqlstm.sqhstl[3] = (unsigned int  )18;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&language_id;
      sqlstm.sqhstl[4] = (unsigned int  )7;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      }
    else
       ins_message(ORA_MESG,"Invalid Episode type in Request Header");
	      
    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on CONSULTANT Master ");

    rl_consultant_short_name.arr[rl_consultant_short_name.len] = '\0';
}
/*-----------------------------------------------------*/
fetch_section()
{

//    EXEC SQL OPEN RL_SECTION_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_SECTION_CUR");

    rl_section_short_name.arr[0] 	= '\0';
    rl_section_short_name.len		= 0;

    rl_section_ind.arr[0] 	= '\0';
    rl_section_ind.len		= 0;

    rl_use_sample_anatomy_ind.arr[0] 	= '\0';
    rl_use_sample_anatomy_ind.len		= 0;
	  
    /* EXEC SQL SELECT SUBSTR(LONG_NAME,1,30),NVL(SECTION_IND,'!!'),NVL(USE_SAMPLE_ANATOMY_IND,'!!')
			 INTO :rl_section_short_name,:rl_section_ind, :rl_use_sample_anatomy_ind
             FROM RL_SECTION_CODE_lang_vw
             WHERE SECTION_CODE = :rl_hdr_section_code
			 and language_id = :language_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select SUBSTR(LONG_NAME,1,30) ,NVL(SECTION_IND,'!!') ,NVL\
(USE_SAMPLE_ANATOMY_IND,'!!') into :b0,:b1,:b2  from RL_SECTION_CODE_lang_vw w\
here (SECTION_CODE=:b3 and language_id=:b4)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3491;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_section_short_name;
    sqlstm.sqhstl[0] = (unsigned int  )43;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_section_ind;
    sqlstm.sqhstl[1] = (unsigned int  )7;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_use_sample_anatomy_ind;
    sqlstm.sqhstl[2] = (unsigned int  )5;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_hdr_section_code;
    sqlstm.sqhstl[3] = (unsigned int  )4;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&language_id;
    sqlstm.sqhstl[4] = (unsigned int  )7;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*   
    EXEC SQL FETCH RL_SECTION_CUR
              INTO :rl_section_short_name;

*/
    rl_section_short_name.arr[rl_section_short_name.len] = '\0';

    rl_section_ind.arr[rl_section_ind.len] = '\0';

    rl_use_sample_anatomy_ind.arr[rl_use_sample_anatomy_ind.len] = '\0';

    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_SECTION_CUR");

}
/*-----------------------------------------------------*/

fetch_age_sex_range()
{

//    EXEC SQL OPEN RL_AGE_SEX_RANGE_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_AGE_SEX_RANGE_CUR",0,"");

    rl_tst_ran_low_val_nor.arr[0]      = '\0';
    rl_tst_ran_high_val_nor.arr[0]      = '\0';

    rl_tst_ran_low_val_nor.len         = 0;
    rl_tst_ran_high_val_nor.len         = 0;

  /* EXEC SQL SELECT NVL(physician_age_low_value, LOW_VALUE_NORMAL),
                     NVL(physician_age_high_value, HIGH_VALUE_NORMAL)
		   INTO :rl_tst_ran_low_val_nor,
                   :rl_tst_ran_high_val_nor
           FROM RL_AGE_SEX_RANGE
           WHERE TEST_CODE = :rl_tst_test_code
           AND SEX       = :rl_pat_sex
           AND :rl_pat_dob_no_of_days
	          BETWEEN CALC_MIN_AGE_IN_DAYS  AND 
           CALC_MAX_AGE_IN_DAYS; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select NVL(physician_age_low_value,LOW_VALUE_NORMAL) ,NVL(p\
hysician_age_high_value,HIGH_VALUE_NORMAL) into :b0,:b1  from RL_AGE_SEX_RANGE\
 where ((TEST_CODE=:b2 and SEX=:b3) and :b4 between CALC_MIN_AGE_IN_DAYS and C\
ALC_MAX_AGE_IN_DAYS)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )3526;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&rl_tst_ran_low_val_nor;
  sqlstm.sqhstl[0] = (unsigned int  )18;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&rl_tst_ran_high_val_nor;
  sqlstm.sqhstl[1] = (unsigned int  )18;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&rl_tst_test_code;
  sqlstm.sqhstl[2] = (unsigned int  )13;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&rl_pat_sex;
  sqlstm.sqhstl[3] = (unsigned int  )4;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&rl_pat_dob_no_of_days;
  sqlstm.sqhstl[4] = (unsigned int  )12;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*
    EXEC SQL FETCH RL_AGE_SEX_RANGE_CUR
              INTO :rl_tst_ran_low_val_nor,
                   :rl_tst_ran_high_val_nor;
*/
 
    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_AGE_SEX_RANGE_CUR",0,"");

    rl_tst_ran_low_val_nor.arr[rl_tst_ran_low_val_nor.len] = '\0';
    rl_tst_ran_high_val_nor.arr[rl_tst_ran_high_val_nor.len] = '\0';
}
/*-----------------------------------------------------*/

open_comments()
{
    /* EXEC SQL OPEN RL_COMM_FOR_TEST_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0042;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3561;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_COMM_FOR_TEST_CUR");
}
/*-----------------------------------------------------*/
fetch_comments()
{
#ifdef DEBUG
       printf("In fetch_comments() \n");
#endif

    rl_comm_tst_comm_txt.arr[0]     = '\0';
    rl_comm_tst_comm_txt.len        = 0;

    /* EXEC SQL FETCH RL_COMM_FOR_TEST_CUR
              INTO :rl_comm_tst_comm_txt; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3580;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_comm_tst_comm_txt;
    sqlstm.sqhstl[0] = (unsigned int  )43;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_COMM_FOR_TEST_CUR");

    rl_comm_tst_comm_txt.arr[rl_comm_tst_comm_txt.len] = '\0';

    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/
print_comment_desc1234()
{
  if (rl_tst_result_comment_desc1.len || rl_tst_result_comment_desc2.len ||
     rl_tst_result_comment_desc3.len || rl_tst_result_comment_desc4.len)
  {  
     something_to_print = 1;
	 something_to_print_for_test = 1;
     if(group && !group_printed)
     {   print_group_test_desc();
	     group_printed = 1;
     }
     
	 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	 sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
	 	 
	 if(test_printed)
	    numeric_value_flag = TRUE;
     else
	 {
	    numeric_value_flag = FALSE;
        fprintf(fp,"%-40.40s",test_description);
		sprintf(in_str,"%-40.40s",test_description);
		print_html_line(in_str,out_str);
		sprintf(l_html_bdy_str,"%s<td class=font_disp width=43%c>%s</td>",l_html_bdy_str,l_prtg,out_str);
		strcpy(out_str,"");
	    test_printed = 1;
     }
     if (rl_tst_result_comment_desc1.len != 0)
         print_line_check(rl_tst_result_comment_desc1.arr);
     if (rl_tst_result_comment_desc2.len != 0)
	 {
	 	 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	     sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
         print_line_check(rl_tst_result_comment_desc2.arr);
	 }
     if (rl_tst_result_comment_desc3.len != 0)
	 {
	 	 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	     sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
         print_line_check(rl_tst_result_comment_desc3.arr);
	 }
     if (rl_tst_result_comment_desc4.len != 0)
	 {
	 	 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	     sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
         print_line_check(rl_tst_result_comment_desc4.arr);
	 }
  }
}
/*-----------------------------------------------------*/
print_prel_release_desc()
{
  if (rl_legend_for_pre_result.len)
  {  

     if(group && !group_printed)
     {   print_group_test_desc();
	     group_printed = 1;
     }

	 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	 sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);

     if(test_printed)
	    numeric_value_flag = TRUE;
     else
	 {
	    numeric_value_flag = FALSE;
        fprintf(fp,"%-40.40s",test_description);

		sprintf(in_str,"%-40.40s",test_description);
		print_html_line(in_str,out_str);
		sprintf(l_html_bdy_str,"%s<td class=font_disp width=43%c>%s</td>",l_html_bdy_str,l_prtg,out_str);
	    strcpy(out_str,"");
		test_printed = 1;
     }
     print_line_check(rl_legend_for_pre_result.arr);

  }
}
/*-----------------------------------------------------*/

fetch_snomed_desc12345()
{
    
//	EXEC SQL OPEN RL_SNOMED_CODE_CUR;

    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_SNOMED_CODE_CUR");

#ifdef DEBUG
       printf("In fetch_snomed_desc1234() \n");
#endif
    rl_snomed_desc1.arr[0]          = '\0';
    rl_snomed_desc2.arr[0]          = '\0';
    rl_snomed_desc3.arr[0]          = '\0';
    rl_snomed_desc4.arr[0]          = '\0';
    rl_snomed_desc5.arr[0]          = '\0';
    rl_snomed_print_yn.arr[0]       = '\0';
	rl_print_snomed_code_yn.arr[0]  = '\0';

    rl_snomed_desc1.len             = 0;
    rl_snomed_desc2.len             = 0;
    rl_snomed_desc3.len             = 0;
    rl_snomed_desc4.len             = 0;
    rl_snomed_desc5.len             = 0;
    rl_snomed_print_yn.len			= 0;
	rl_print_snomed_code_yn.len		= 0;

/**************** changed on 01/09/2002 
                   :rl_snomed_desc2,
                   :rl_snomed_desc3,
                   :rl_snomed_desc4,
                   :rl_snomed_desc5,

                     DESCRIPTION_2,
                     DESCRIPTION_3,
                     DESCRIPTION_4,
                     DESCRIPTION_5,
**********************************************/

	/* EXEC SQL SELECT SUBSTR(DESCRIPTION_1, 1, 12),
					 NVL(PRINT_YN, 'N'),
					 NVL(print_code_yn, 'N')
              INTO :rl_snomed_desc1,
    			   :rl_snomed_print_yn,
				   :rl_print_snomed_code_yn
             FROM RL_SNOMED_CODE_lang_vw
             WHERE SNOMED_CODE = :rl_res_snomed_code
			 and language_id = :language_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select SUBSTR(DESCRIPTION_1,1,12) ,NVL(PRINT_YN,'N') ,NVL(pr\
int_code_yn,'N') into :b0,:b1,:b2  from RL_SNOMED_CODE_lang_vw where (SNOMED_C\
ODE=:b3 and language_id=:b4)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3599;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&rl_snomed_desc1;
 sqlstm.sqhstl[0] = (unsigned int  )303;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&rl_snomed_print_yn;
 sqlstm.sqhstl[1] = (unsigned int  )4;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&rl_print_snomed_code_yn;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&rl_res_snomed_code;
 sqlstm.sqhstl[3] = (unsigned int  )23;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&language_id;
 sqlstm.sqhstl[4] = (unsigned int  )7;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*
    EXEC SQL FETCH RL_SNOMED_CODE_CUR
              INTO :rl_snomed_desc1,
                   :rl_snomed_desc2,
                   :rl_snomed_desc3,
                   :rl_snomed_desc4,
                   :rl_snomed_desc5,
    		   :rl_snomed_print_yn;

*/

    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_SNOMED_CODE_CUR");

    rl_snomed_desc1.arr[rl_snomed_desc1.len] = '\0';
    rl_snomed_desc2.arr[rl_snomed_desc2.len] = '\0';
    rl_snomed_desc3.arr[rl_snomed_desc3.len] = '\0';
    rl_snomed_desc4.arr[rl_snomed_desc4.len] = '\0';
    rl_snomed_desc5.arr[rl_snomed_desc5.len] = '\0';
    rl_snomed_print_yn.arr[rl_snomed_print_yn.len] = '\0';
	rl_print_snomed_code_yn.arr[rl_print_snomed_code_yn.len]	= '\0';

   return (sqlca.sqlerrd[2]);
}
/*-----------------------------------------------------*/
print_snomed_desc12345()
{
  if(rl_snomed_desc1.len  || rl_snomed_desc2.len  ||
     rl_snomed_desc3.len  || rl_snomed_desc4.len  || 
     rl_snomed_desc5.len  || rl_snomed2_desc1.len || 
	 rl_snomed2_desc2.len || rl_snomed2_desc3.len || 
	 rl_snomed2_desc4.len || rl_snomed2_desc5.len ) 
  {
  
    something_to_print = 1;
	something_to_print_for_test = 1;

    if(group && !group_printed)
    {   
	print_group_test_desc();
	group_printed = 1;
    }
    if(!test_printed)
    {
       fprintf(fp,"%-40.40s\n",test_description);

	   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
	   
	   sprintf(in_str,"%-40.40s",test_description);
	   print_html_line(in_str,out_str);
	   sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
	   strcpy(out_str,"");
	   write_html(fp4,l_html_bdy_str);
	   strcpy(l_html_bdy_str,"");
	   
       test_printed = 1;
    }

/****************************/

//	print_snomed_codes('Y');
	print_str('N');
	fprintf(fp, " - ");

	if (l_snomed_head_printed) 
		sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td>",l_html_bdy_str,l_prtg);
	else
	{
		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	    sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td>",l_html_bdy_str,l_prtg);
	}

/**************************/

	if (rl_snomed_desc1.len != 0 && rl_snomed_print_yn.arr[0] == 'Y')
    {
		 fprintf(fp,"%-20s",rl_snomed_desc1.arr);
		 fprintf(fp, " | ");

		 sprintf(in_str,"%-20s",rl_snomed_desc1.arr);
		 print_html_line(in_str,out_str);		 
		 sprintf(l_html_bdy_str,"%s<td class=font_disp width=22%c>%s</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,out_str,l_prtg);
		 strcpy(out_str,"");

		 if (rl_snomed2_desc1.len == 0 || rl_snomed2_print_yn.arr[0] == 'N')
		 {
			fprintf(fp, "\n");

			sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
			write_html(fp4,l_html_bdy_str);	
			strcpy(l_html_bdy_str,"");

			page_break(1);
		 }
	}
	else
	{
		if (rl_snomed2_desc1.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
		{
			fprint_repeat(fp,' ',20);	
			fprintf(fp, " | ");
			
			sprintf(l_html_bdy_str,"%s<td class=font_disp width=22%c>&nbsp;</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,l_prtg);

		}
	}

	if (rl_snomed2_desc1.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
	{
			fprintf(fp,"%s\n",rl_snomed2_desc1.arr);
			
		    print_html_line(rl_snomed2_desc1.arr,out_str);			
			sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
			strcpy(out_str,"");
			write_html(fp4,l_html_bdy_str);	
		    strcpy(l_html_bdy_str,"");			
			
			page_break(1);
	}

	if (strlen(l_html_bdy_str))
	{
		sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
		write_html(fp4,l_html_bdy_str);	
		strcpy(l_html_bdy_str,"");
	}
	    
/*-----------------------*/    
    if (rl_snomed_desc2.len != 0 && rl_snomed_print_yn.arr[0] == 'Y')
    {
		 print_snomed_codes('N');	
		 fprintf(fp, " - ");

		 sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td>",l_html_bdy_str,l_prtg);

		 fprintf(fp,"%-20s",rl_snomed_desc2.arr);
		 fprintf(fp, " | ");

		 sprintf(in_str,"%-20s",rl_snomed_desc2.arr);
		 print_html_line(in_str,out_str);	
		 sprintf(l_html_bdy_str,"%s<td class=font_disp width=22%c>%s</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,out_str,l_prtg);
		 strcpy(out_str,"");

		 if (rl_snomed2_desc2.len == 0 || rl_snomed2_print_yn.arr[0] == 'N')
		 {
			fprintf(fp, "\n");

			sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
			write_html(fp4,l_html_bdy_str);	
			strcpy(l_html_bdy_str,"");

			page_break(1);

		 }
	}
	else
	{
		if (rl_snomed2_desc2.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
		{
			print_snomed_codes('N');		
			fprintf(fp, " - ");
			fprint_repeat(fp,' ',20);
			fprintf(fp, " | ");

			sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td><td class=font_disp width=22%c>&nbsp;</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,l_prtg,l_prtg);

		}
	}

	if (rl_snomed2_desc2.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
	{
			fprintf(fp,"%s\n",rl_snomed2_desc2.arr);

			print_html_line(rl_snomed2_desc2.arr,out_str);
			sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
			strcpy(out_str,"");
			write_html(fp4,l_html_bdy_str);	
			strcpy(l_html_bdy_str,"");

			page_break(1);
	}
    
/*-----------------------*/    

    if (rl_snomed_desc3.len != 0 && rl_snomed_print_yn.arr[0] == 'Y')
    {

		print_snomed_codes('N');	
		fprintf(fp, " - ");

		sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td>",l_html_bdy_str,l_prtg);

		fprintf(fp,"%-20s",rl_snomed_desc3.arr);
		fprintf(fp, " | ");

		sprintf(in_str,"%-20s",rl_snomed_desc3.arr);
		print_html_line(in_str,out_str);		
		sprintf(l_html_bdy_str,"%s<td class=font_disp width=22%c>%s</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,out_str,l_prtg);
		strcpy(out_str,"");

		if (rl_snomed2_desc3.len == 0 || rl_snomed2_print_yn.arr[0] == 'N')
		{
			fprintf(fp, "\n");

			sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

			page_break(1);

		}
	}
	else
	{
		if (rl_snomed2_desc3.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
		{
			print_snomed_codes('N');	
			fprintf(fp, " - ");
			fprint_repeat(fp,' ',20);
			fprintf(fp, " | ");

			sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td><td class=font_disp width=22%c>&nbsp;</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,l_prtg,l_prtg);

		}
	}

	if (rl_snomed2_desc3.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
	{
	        fprintf(fp,"%s\n",rl_snomed2_desc3.arr);

			print_html_line(rl_snomed2_desc3.arr,out_str);
			sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
			strcpy(out_str,"");
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

			page_break(1);
	}

/*-----------------------*/        

    if (rl_snomed_desc4.len != 0 && rl_snomed_print_yn.arr[0] == 'Y')
    {
		 print_snomed_codes('N');	
		 fprintf(fp, " - ");

		 sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td>",l_html_bdy_str,l_prtg);

		 fprintf(fp,"%-20s",rl_snomed_desc4.arr);
		 fprintf(fp, " | ");

		 sprintf(in_str,"%-20s",rl_snomed_desc4.arr);
		 print_html_line(in_str,out_str);		 
		 sprintf(l_html_bdy_str,"%s<td class=font_disp width=22%c>%s</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,out_str,l_prtg);
		 strcpy(out_str,"");

		 if (rl_snomed2_desc4.len == 0 || rl_snomed2_print_yn.arr[0] == 'N')
		 {
			fprintf(fp, "\n");

			sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

			page_break(1);

		 }
	}
	else
	{
		if (rl_snomed2_desc4.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
		{
			print_snomed_codes('N');	
			fprintf(fp, " - ");

			sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td>",l_html_bdy_str,l_prtg);

			fprint_repeat(fp,' ',20);
			fprintf(fp, " | ");

			sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td><td class=font_disp width=22%c>&nbsp;</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,l_prtg,l_prtg);
		}
	}

	if (rl_snomed2_desc4.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
	{
			fprintf(fp,"%s\n",rl_snomed2_desc4.arr);

			print_html_line(rl_snomed2_desc4.arr,out_str);
			sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
			strcpy(out_str,"");
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

			page_break(1);
	}

/*-----------------------*/            

	if (rl_snomed_desc5.len != 0 && rl_snomed_print_yn.arr[0] == 'Y')	
	{
			print_snomed_codes('N');	
			fprintf(fp, " - ");

			sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td>",l_html_bdy_str,l_prtg);

			fprintf(fp,"%-20s",rl_snomed_desc5.arr);
			fprintf(fp, " | ");

			sprintf(in_str,"%-20s",rl_snomed_desc5.arr);
			print_html_line(in_str,out_str);			
			sprintf(l_html_bdy_str,"%s<td class=font_disp width=22%c>%s</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,out_str,l_prtg);
			strcpy(out_str,"");

			if (rl_snomed2_desc5.len == 0 || rl_snomed2_print_yn.arr[0] == 'N')
			{
				fprintf(fp, "\n");
				sprintf(l_html_bdy_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_bdy_str);
				write_html(fp4,l_html_bdy_str);
				strcpy(l_html_bdy_str,"");
				page_break(1);

			}
	}
	else
	{
		if (rl_snomed2_desc5.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
		{
			print_snomed_codes('N');	
			fprintf(fp, " - ");
			fprint_repeat(fp,' ',20);
			fprintf(fp, " | ");

			sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>-</td><td class=font_disp width=22%c>&nbsp;</td><td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg,l_prtg,l_prtg);

		}
	}

	if (rl_snomed2_desc5.len != 0 && rl_snomed2_print_yn.arr[0] == 'Y')
	{

			fprintf(fp,"%s\n",rl_snomed2_desc5.arr);

			print_html_line(rl_snomed2_desc5.arr,out_str);
			sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
			strcpy(out_str,"");
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

			page_break(1);
	}

  
/************* old snomed logic *****************
    if (rl_snomed_desc1.len != 0)
    {
         fprint_repeat(fp,' ',40);
         fprintf(fp,"%s\n",rl_snomed_desc1.arr);
         page_break(1);
    }
    if (rl_snomed_desc2.len != 0)
    {
         fprint_repeat(fp,' ',40);
         fprintf(fp,"%s\n",rl_snomed_desc2.arr);
         page_break(1);
    }
    if (rl_snomed_desc3.len != 0)
    {
         fprint_repeat(fp,' ',40);
         fprintf(fp,"%s\n",rl_snomed_desc3.arr);
         page_break(1);
    }
    if (rl_snomed_desc4.len != 0)
    {
         fprint_repeat(fp,' ',40);
         fprintf(fp,"%s\n",rl_snomed_desc4.arr);
         page_break(1);
    }
    if (rl_snomed_desc5.len != 0)
    {
         fprint_repeat(fp,' ',40);
         fprintf(fp,"%s\n",rl_snomed_desc5.arr);
         page_break(1);
    }
************* UPTO HERE old snomed logic *****************/


  }


  if (rl_res_snomed_mrkr_code1.len != 0) 
  {
     get_snomed_marker_desc1();
	 print_snomed_marker1();
  }
  if (rl_res_snomed_mrkr_code2.len != 0) 
  {
     get_snomed_marker_desc2();
	 print_snomed_marker2();
  }	

}
/*-----------------------------------------------------*/

fprint_repeat(l_fp,l_prn_chr,l_no)
FILE *l_fp;
char l_prn_chr;
int  l_no;
{
   int l_i = 0;

   for (l_i = 0;l_i < l_no;l_i++)
        fputc(l_prn_chr,l_fp);
}
/*-----------------------------------------------------*/

page_break(l_skip)
int l_skip;
{
    lctr+= l_skip;
    if (lctr == 0 || lctr > MAX_LINES)
    {
       if (lctr != 0)
	   {
		   if (strcmp(rl_report_format.arr, "1") == 0)
               print_footer(1);
		  else if (strcmp(rl_report_format.arr, "2") == 0)
				print_footer2(1);
		  else if (strcmp(rl_report_format.arr, "4") == 0 )
				print_footer4(1);
		  else if (strcmp(rl_report_format.arr, "5") == 0 || strcmp(rl_report_format.arr, "7") == 0)
				print_footer5(1);
		  else  if (strcmp(rl_report_format.arr, "6") == 0 )
				print_footer6(1);
		  else
				print_footer3(2);

		}


					  if (org_yn)   ////  to print Organism Heading 
					    oflag = 1;   

					  if (antb_yn)  ///  to print Antibiotic Heading
						a_flag = 1;

					   if (strcmp(rl_report_format.arr, "1") == 0)
					   {
//qatar
							print_header();
						}
					   else if (strcmp(rl_report_format.arr, "2") == 0)
					   {
//kn
							print_header2();  

							/****** added the below on 19.03.2005  ******/

							if ((test_contd == 0) && (rl_print_test_name_in_contd_page.arr[0] == 'Y') )
							{
								 if(p_print_name_yn.arr[0] == 'Y' && group)
								 {
									sprintf(text_line,"%s%s",p_test_desc.arr,"(Contd..)");
									
									sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>","",l_prtg);
									sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
																		
									print_line(text_line);
								 }
								 if(rl_tst_cd_print_report_yn.arr[0] == 'Y')
								 {
								    sprintf(text_line,"%s%s",rl_tst_cd_short_desc.arr,"(Contd..)");
								    
									sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
									sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
																		
									print_line(text_line);
								 }
							}
							/****** upto here added on 19.03.2005  ******/

					   }
					   else if (strcmp(rl_report_format.arr, "4") == 0 || strcmp(rl_report_format.arr, "5") == 0)
					   {
//ml
							print_header4();
					   }
					   else  if (strcmp(rl_report_format.arr, "7") == 0)
					   {
//MAFRAQ
							print_header7();
					   }
					   else  if (strcmp(rl_report_format.arr, "6") == 0)
					   {
//ARTEMIS
							print_header6();
					   }
					   else
					   {
//mf & su
							print_header3();
					   }

    }
}
/*-----------------------------------------------------*/
open_result_text()
{
    /* EXEC SQL OPEN RL_RESULT_TEXT_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0043;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3634;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_RESULT_TEXT_CUR");
}
/*-----------------------------------------------------*/

fetch_result_text()
{
#ifdef DEBUG
       printf("In fetch_result_text() \n");
#endif

    rl_res_result_text.arr[0]  = '\0';

    /* EXEC SQL FETCH RL_RESULT_TEXT_CUR
              INTO rl_res_result_text ; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3669;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_res_result_text;
    sqlstm.sqhstl[0] = (unsigned int  )2002;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			  
    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_RESULT_TEXT_CUR",0,"");

    rl_res_result_text.arr[rl_res_result_text.len] = '\0';

    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/
calc_func_and_prn(l_str,l_str2)
char l_str[],l_str2[];
{
   int func_ctr = 0;

   strcpy(rl_loc_test_code.arr,l_str);
   rl_loc_test_code.len = strlen(rl_loc_test_code.arr);
   open_function_cur();
   strcpy(rl_func_str.arr,"");
   _flushall();
   while (fetch_function_cur())
   {
        func_ctr ++;
        strcpy(rl_func_value.arr,rl_func_operand_1.arr);

        if (rl_func_operand_1_type.arr[0] == 'T')
             get_rl_test_result(rl_func_operand_1.arr);

	if(test_result_found == 0)
	{
	   l_str2[0] = '\0'; 
	   break;
        }
        strcat(rl_func_str.arr,rl_func_value.arr);
        strcat(rl_func_str.arr," ");

        if (func_ctr != 1)
             calculate_value();

        if (rl_func_operator_1.len == 0)
             break;

        strcat(rl_func_str.arr,rl_func_operator_1.arr);
        strcat(rl_func_str.arr," ");
        strcpy(rl_func_value.arr,rl_func_operand_2.arr);

        if (rl_func_operand_2_type.arr[0] == 'T')
             get_rl_test_result(rl_func_operand_2.arr);

	if(test_result_found == 0)
	{
	   l_str2[0] = '\0'; 
	   break;
        }

        strcat(rl_func_str.arr,rl_func_value.arr);
        strcat(rl_func_str.arr," ");
        calculate_value();

        if (rl_func_operator_2.len == 0)
             break;

        strcat(rl_func_str.arr,rl_func_operator_2.arr);
        strcat(rl_func_str.arr," ");
   }
   ltrim(rl_func_str.arr); 
   rtrim(rl_func_str.arr); 
   
	close_function_cur();

   rl_func_str.arr[9] = '\0';
   if (rl_tst_cd_no_of_decimals != 0 ||
             rl_tst_cd_significant_digit != 0)
      get_deci_sig_dig(rl_func_str.arr, p_no_of_decimals, p_significant_digit);
   rl_func_str.arr[5] = '\0';
   sprintf(l_str2,"%-10s",rl_func_str.arr);
#ifdef DEBUG
    printf("func str is <%s> str is <%s>\n",rl_func_str.arr,l_str2);
#endif
}
/*-----------------------------------------------------*/

open_function_cur()
{
    /* EXEC SQL OPEN RL_FUNCTION_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0045;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3688;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_loc_test_code;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_FUNCTION_CUR");
}
/*-----------------------------------------------------*/

fetch_function_cur()
{
    rl_func_operand_1.arr[0]          = '\0';
    rl_func_operand_1_type.arr[0]     = '\0';
    rl_func_operator_1.arr[0]         = '\0';
    rl_func_operand_2.arr[0]          = '\0';
    rl_func_operand_2_type.arr[0]     = '\0';
    rl_func_operator_2.arr[0]         = '\0';

    rl_func_operand_1.len             = 0;
    rl_func_operand_1_type.len        = 0;
    rl_func_operator_1.len            = 0;
    rl_func_operand_2.len             = 0;
    rl_func_operand_2_type.len        = 0;
    rl_func_operator_2.len            = 0;

    /* EXEC SQL FETCH RL_FUNCTION_CUR
              INTO :rl_func_operand_1,
                   :rl_func_operand_1_type,
                   :rl_func_operator_1,
                   :rl_func_operand_2,
                   :rl_func_operand_2_type,
                   :rl_func_operator_2; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3707;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_func_operand_1;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_func_operand_1_type;
    sqlstm.sqhstl[1] = (unsigned int  )4;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_func_operator_1;
    sqlstm.sqhstl[2] = (unsigned int  )4;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_func_operand_2;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_func_operand_2_type;
    sqlstm.sqhstl[4] = (unsigned int  )4;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&rl_func_operator_2;
    sqlstm.sqhstl[5] = (unsigned int  )4;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_FUNCTION_CUR");

    rl_func_operand_1.arr[rl_func_operand_1.len]           = '\0';
    rl_func_operand_1_type.arr[rl_func_operand_1_type.len] = '\0';
    rl_func_operator_1.arr[rl_func_operator_1.len]         = '\0';
    rl_func_operand_2.arr[rl_func_operand_2.len]           = '\0';
    rl_func_operand_2_type.arr[rl_func_operand_2_type.len] = '\0';
    rl_func_operator_2.arr[rl_func_operator_2.len]         = '\0';

    return (LAST_ROW?0:1);
}
/*-----------------------------------------------------*/

calculate_value()
{
    sprintf(rl_calc_str.arr,"SELECT %s FROM DUAL",rl_func_str.arr);
    rl_calc_str.len = strlen(rl_calc_str.arr);
    /* EXEC SQL PREPARE STR1 FROM :rl_calc_str; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3746;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_calc_str;
    sqlstm.sqhstl[0] = (unsigned int  )402;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"PREPARE failed on table DUAL");

    /* EXEC SQL DECLARE CUR1 CURSOR FOR STR1; */ 


    /* EXEC SQL OPEN CUR1; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3765;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor CUR1");

    rl_func_str.arr[0] = '\0';
    rl_func_str.len    = 0;

    /* EXEC SQL FETCH CUR1
              INTO :rl_func_str; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3780;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_func_str;
    sqlstm.sqhstl[0] = (unsigned int  )402;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor CUR1");

    rl_func_str.arr[rl_func_str.len] = '\0';
    strcat(rl_func_str.arr," ");

	close_cur1_cur();

}
/*-----------------------------------------------------*/
get_rl_test_result(l_test_code)
char l_test_code[];
{
    test_result_found = 1;
    strcpy(rl_loc_test_code.arr,l_test_code);
    rl_loc_test_code.len = strlen(rl_loc_test_code.arr);

    /* EXEC SQL WHENEVER SQLERROR GOTO err_exit; */ 


    rl_func_value.arr[0] = '\0';
    rl_func_value.len    = 0;

    /* EXEC SQL SELECT NUMERIC_RESULT INTO :rl_func_value
               FROM RL_TEST_RESULT
              WHERE PATIENT_ID      = :nd_hosp_no
                AND SPECIMEN_NO     = :nd_spec_no
                AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND TEST_CODE       = :rl_loc_test_code; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select NUMERIC_RESULT into :b0  from RL_TEST_RESULT where\
 (((PATIENT_ID=:b1 and SPECIMEN_NO=:b2) and OPERATING_FACILITY_ID=:b3) and TES\
T_CODE=:b4)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3799;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_func_value;
    sqlstm.sqhstl[0] = (unsigned int  )18;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[2] = (unsigned int  )23;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_loc_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
    if (sqlca.sqlcode < 0) goto err_exit;
}



    if(NODATAFOUND);
/*
    {
	       ins_message(ORA_MESG,"Error occurred at get_rl_test_result() Test not found.");
    }
*/
    rl_func_value.arr[rl_func_value.len] = '\0';

    if(strlen(rl_func_value.arr) == 0)
       test_result_found = 0;

    return;
err_exit:
   /* EXEC SQL WHENEVER SQLERROR CONTINUE; */ 

   ins_message(ORA_MESG,"Error occurred at get_rl_test_result()");
   return;

}
/*-----------------------------------------------------*/
print_footer(foot_ind)
int foot_ind;
{
   int fi = 0;
   char l_str[100];
   l_str[0] = '\0'; 

   for(fi=0; fi < 87; fi++)
       fprintf(fp,"%c",'_');

   fprintf(fp,"\n");

   fflush(fp);

   /*----------------------------------------*/
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s4B",ESC);
   //fprintf(fp,"Release Date : ");
   fprintf(fp,"%-13.13s: ", local_legend[20]);//added for globalisation
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s-3B",ESC);   
   //sprintf(l_str,"%s",rl_hdr_released_date.arr);
   sprintf(l_str,"%s",rl_hdr_released_date1.arr);//added for globalisation
   fprintf(fp,"%-25.25s",l_str);
   /*----------------------------------------*/

   /*----------------------------------------*/
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s4B",ESC);
   fprintf(fp,"Released/Reviewed By : ");
   fprintf(fp,"%-21.21s: ", local_legend[21]);//added for globalisation
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s-3B",ESC);   
   fprintf(fp,"%-s\n",rl_hdr_released_by_id.arr);
   /*----------------------------------------*/

   /*----------------------------------------*/
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s4B",ESC);
   //fprintf(fp,"Reprint Date : ");
   fprintf(fp,"%-13.13s: ", local_legend[22]);//added for globalisation
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s-3B",ESC);   
   /*----------------------------------------*/
   
   if (rl_prn_ctrl_hdr_rp_yn.arr[0] == 'Y')
       sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
   else
       sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
   fprintf(fp,"%s",nd_result_printed_date.arr);

   /*----------------------------------------*/

   if (rl_hdr_extra_copies_to.len && copy == 2 ) 
   {
      /*----------------------------------------*/
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s4B",ESC);
      //fprintf(fp,"Copy To : ");
      fprintf(fp,"%-8.8s: ", local_legend[23]); //added for globalisation
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/

      sprintf(l_str,"%24.24s",rl_hdr_extra_copies_to.arr);
   }
   else
      sprintf(l_str,"%34.34s"," ");

   fprintf(fp,"%s\n",l_str);

   if(last_page == 0)
      //sprintf(l_str,"%-73.73s--CONTINUED--"," ");
      sprintf(l_str,"%-73.73s--%-9.9s--"," ",local_legend[24]); //added for globalisation
   else
      //sprintf(l_str,"%-73.73s      --END--"," ");
      sprintf(l_str,"%-73.73s --%-3.3s--"," ",local_legend[25]);// added for globalisation

   fprintf(fp,"%s\f",l_str);

   lctr = 0;
  
}
/*-----------------------------------------------------*/

ltrim(l_str)
char *l_str;
{
   char *ptr;
   ptr = l_str;
   while (*ptr== ' ') ptr++;
   for(;*ptr!='\0';ptr++,l_str++)
    *l_str = *ptr;
   *l_str = '\0';
}
/*-----------------------------------------------------*/

rtrim(l_str)
char *l_str;
{
  while (*l_str != '\0') *l_str++;
  l_str--;
  while (*l_str == ' ') *l_str--;
  *(l_str+1) = '\0';
}

/*-----------------------------------------------------*/
get_deci_sig_dig(loc_str,no_of_dec,signif)

 char *loc_str;
 /* EXEC SQL BEGIN DECLARE SECTION; */ 

 int no_of_dec;
 /* EXEC SQL END DECLARE SECTION; */ 

/// int signif;
{
  char significant_digits_applied_yn = 'N';
  signif    = 0;
  d_dec_pos = 0;
  d_after_sig_digit = 0;  

  d_loc_str.arr[0] = '\0';
  d_dec_part.arr[0] = '\0';
  d_int_part.arr[0] = '\0';
  d_sig_part.arr[0] = '\0';

  d_loc_str.len     = 0;
  d_dec_part.len    = 0;
  d_int_part.len    = 0;
  d_sig_part.len    = 0;

  strcpy(d_loc_str.arr,loc_str);
  d_loc_str.len = strlen(d_loc_str.arr);
/*--- The following IF splits the result into two parts : INTEGER & DECIMAL --*/
  /* EXEC SQL SELECT INSTR(:d_loc_str,'.') INTO :d_dec_pos FROM DUAL; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select INSTR(:b0,'.') into :b1  from DUAL ";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )3834;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_loc_str;
  sqlstm.sqhstl[0] = (unsigned int  )22;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_dec_pos;
  sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  if(d_dec_pos > 0)
  {
      /* EXEC SQL SELECT SUBSTR(:d_loc_str,1,:d_dec_pos - 1) INTO :d_int_part FROM DUAL; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select SUBSTR(:b0,1,(:b1-1)) into :b2  from DUAL ";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )3857;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&d_loc_str;
      sqlstm.sqhstl[0] = (unsigned int  )22;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&d_dec_pos;
      sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&d_int_part;
      sqlstm.sqhstl[2] = (unsigned int  )22;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      d_int_part.arr[d_int_part.len] = '\0';
      if(strlen(d_loc_str.arr) > d_dec_pos )
      {
         /* EXEC SQL SELECT SUBSTR(:d_loc_str,:d_dec_pos + 1,LENGTH(:d_loc_str)) 
			  	    INTO :d_dec_part FROM DUAL; */ 

{
         struct sqlexd sqlstm;
         sqlstm.sqlvsn = 10;
         sqlstm.arrsiz = 33;
         sqlstm.sqladtp = &sqladt;
         sqlstm.sqltdsp = &sqltds;
         sqlstm.stmt = "select SUBSTR(:b0,(:b1+1),LENGTH(:b0)) into :b3  fro\
m DUAL ";
         sqlstm.iters = (unsigned int  )1;
         sqlstm.offset = (unsigned int  )3884;
         sqlstm.selerr = (unsigned short)1;
         sqlstm.cud = sqlcud0;
         sqlstm.sqlest = (unsigned char  *)&sqlca;
         sqlstm.sqlety = (unsigned short)256;
         sqlstm.occurs = (unsigned int  )0;
         sqlstm.sqhstv[0] = (         void  *)&d_loc_str;
         sqlstm.sqhstl[0] = (unsigned int  )22;
         sqlstm.sqhsts[0] = (         int  )0;
         sqlstm.sqindv[0] = (         void  *)0;
         sqlstm.sqinds[0] = (         int  )0;
         sqlstm.sqharm[0] = (unsigned int  )0;
         sqlstm.sqadto[0] = (unsigned short )0;
         sqlstm.sqtdso[0] = (unsigned short )0;
         sqlstm.sqhstv[1] = (         void  *)&d_dec_pos;
         sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
         sqlstm.sqhsts[1] = (         int  )0;
         sqlstm.sqindv[1] = (         void  *)0;
         sqlstm.sqinds[1] = (         int  )0;
         sqlstm.sqharm[1] = (unsigned int  )0;
         sqlstm.sqadto[1] = (unsigned short )0;
         sqlstm.sqtdso[1] = (unsigned short )0;
         sqlstm.sqhstv[2] = (         void  *)&d_loc_str;
         sqlstm.sqhstl[2] = (unsigned int  )22;
         sqlstm.sqhsts[2] = (         int  )0;
         sqlstm.sqindv[2] = (         void  *)0;
         sqlstm.sqinds[2] = (         int  )0;
         sqlstm.sqharm[2] = (unsigned int  )0;
         sqlstm.sqadto[2] = (unsigned short )0;
         sqlstm.sqtdso[2] = (unsigned short )0;
         sqlstm.sqhstv[3] = (         void  *)&d_dec_part;
         sqlstm.sqhstl[3] = (unsigned int  )22;
         sqlstm.sqhsts[3] = (         int  )0;
         sqlstm.sqindv[3] = (         void  *)0;
         sqlstm.sqinds[3] = (         int  )0;
         sqlstm.sqharm[3] = (unsigned int  )0;
         sqlstm.sqadto[3] = (unsigned short )0;
         sqlstm.sqtdso[3] = (unsigned short )0;
         sqlstm.sqphsv = sqlstm.sqhstv;
         sqlstm.sqphsl = sqlstm.sqhstl;
         sqlstm.sqphss = sqlstm.sqhsts;
         sqlstm.sqpind = sqlstm.sqindv;
         sqlstm.sqpins = sqlstm.sqinds;
         sqlstm.sqparm = sqlstm.sqharm;
         sqlstm.sqparc = sqlstm.sqharc;
         sqlstm.sqpadto = sqlstm.sqadto;
         sqlstm.sqptdso = sqlstm.sqtdso;
         sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



         d_dec_part.arr[d_dec_part.len] = '\0';
      }
  }
  else
  {
     strcpy(d_int_part.arr,d_loc_str.arr);
     d_int_part.len = strlen(d_int_part.arr);
  }
/*-- This IF is to take care of the INTEGER part of the Result ---------------*/
  if(strlen(d_int_part.arr))
  {
    if(signif > 0)
    {
       if(strlen(d_int_part.arr) <= signif)
       {
          strcpy(d_l_str.arr,d_int_part.arr);
       }
       else
       {
		  significant_digits_applied_yn = 'Y';

		  /* EXEC SQL SELECT SUBSTR(:d_int_part,1,:signif) INTO :d_sig_part FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select SUBSTR(:b0,1,:b1) into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3915;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&d_int_part;
    sqlstm.sqhstl[0] = (unsigned int  )22;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&signif;
    sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_sig_part;
    sqlstm.sqhstl[2] = (unsigned int  )22;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		  d_sig_part.arr[d_sig_part.len] = '\0';

		  /* EXEC SQL SELECT TO_NUMBER(SUBSTR(:d_int_part,:signif + 1,1)) INTO :d_after_sig_digit FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_NUMBER(SUBSTR(:b0,(:b1+1),1)) into :b2  from DU\
AL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3942;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&d_int_part;
    sqlstm.sqhstl[0] = (unsigned int  )22;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&signif;
    sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_after_sig_digit;
    sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		  if(d_after_sig_digit >= 5)
		  {
			 /* EXEC SQL SELECT TO_CHAR(TO_NUMBER(:d_sig_part) + 1)
								INTO :d_sig_part FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_CHAR((TO_NUMBER(:b0)+1)) into :b0  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3969;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&d_sig_part;
    sqlstm.sqhstl[0] = (unsigned int  )22;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_sig_part;
    sqlstm.sqhstl[1] = (unsigned int  )22;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


				 d_sig_part.arr[d_sig_part.len] = '\0'; 
		  }
			  /* EXEC SQL SELECT RPAD(:d_sig_part,LENGTH(:d_int_part),'0')
				 INTO :d_l_str FROM DUAL; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 33;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select RPAD(:b0,LENGTH(:b1),'0') into :b2  from DUAL ";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )3992;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&d_sig_part;
     sqlstm.sqhstl[0] = (unsigned int  )22;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&d_int_part;
     sqlstm.sqhstl[1] = (unsigned int  )22;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&d_l_str;
     sqlstm.sqhstl[2] = (unsigned int  )22;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			  d_l_str.arr[d_l_str.len] = '\0'; 
       }
    }
    else
    {
       strcpy(d_l_str.arr,d_int_part.arr);
    }
  }         
/*-- This IF is to take care of the INTEGER part of the Result ---------------*/
if(strlen(d_dec_part.arr))
{
  if(no_of_dec > 0)
  {
     strcpy(d_l_str.arr,strcat(d_l_str.arr,"."));
     d_l_str.len = strlen(d_l_str.arr);
     if(strlen(d_dec_part.arr) <= no_of_dec) 
     {
        strcpy(d_l_str.arr,strcat(d_l_str.arr,d_dec_part.arr));
	d_l_str.len = strlen(d_l_str.arr);
     }
     else
     {
        /* EXEC SQL SELECT :d_l_str || SUBSTR(:d_dec_part,1,:no_of_dec)
                   INTO :d_l_str FROM DUAL; */ 

{
        struct sqlexd sqlstm;
        sqlstm.sqlvsn = 10;
        sqlstm.arrsiz = 33;
        sqlstm.sqladtp = &sqladt;
        sqlstm.sqltdsp = &sqltds;
        sqlstm.stmt = "select (:b0||SUBSTR(:b1,1,:b2)) into :b0  from DUAL ";
        sqlstm.iters = (unsigned int  )1;
        sqlstm.offset = (unsigned int  )4019;
        sqlstm.selerr = (unsigned short)1;
        sqlstm.cud = sqlcud0;
        sqlstm.sqlest = (unsigned char  *)&sqlca;
        sqlstm.sqlety = (unsigned short)256;
        sqlstm.occurs = (unsigned int  )0;
        sqlstm.sqhstv[0] = (         void  *)&d_l_str;
        sqlstm.sqhstl[0] = (unsigned int  )22;
        sqlstm.sqhsts[0] = (         int  )0;
        sqlstm.sqindv[0] = (         void  *)0;
        sqlstm.sqinds[0] = (         int  )0;
        sqlstm.sqharm[0] = (unsigned int  )0;
        sqlstm.sqadto[0] = (unsigned short )0;
        sqlstm.sqtdso[0] = (unsigned short )0;
        sqlstm.sqhstv[1] = (         void  *)&d_dec_part;
        sqlstm.sqhstl[1] = (unsigned int  )22;
        sqlstm.sqhsts[1] = (         int  )0;
        sqlstm.sqindv[1] = (         void  *)0;
        sqlstm.sqinds[1] = (         int  )0;
        sqlstm.sqharm[1] = (unsigned int  )0;
        sqlstm.sqadto[1] = (unsigned short )0;
        sqlstm.sqtdso[1] = (unsigned short )0;
        sqlstm.sqhstv[2] = (         void  *)&no_of_dec;
        sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
        sqlstm.sqhsts[2] = (         int  )0;
        sqlstm.sqindv[2] = (         void  *)0;
        sqlstm.sqinds[2] = (         int  )0;
        sqlstm.sqharm[2] = (unsigned int  )0;
        sqlstm.sqadto[2] = (unsigned short )0;
        sqlstm.sqtdso[2] = (unsigned short )0;
        sqlstm.sqhstv[3] = (         void  *)&d_l_str;
        sqlstm.sqhstl[3] = (unsigned int  )22;
        sqlstm.sqhsts[3] = (         int  )0;
        sqlstm.sqindv[3] = (         void  *)0;
        sqlstm.sqinds[3] = (         int  )0;
        sqlstm.sqharm[3] = (unsigned int  )0;
        sqlstm.sqadto[3] = (unsigned short )0;
        sqlstm.sqtdso[3] = (unsigned short )0;
        sqlstm.sqphsv = sqlstm.sqhstv;
        sqlstm.sqphsl = sqlstm.sqhstl;
        sqlstm.sqphss = sqlstm.sqhsts;
        sqlstm.sqpind = sqlstm.sqindv;
        sqlstm.sqpins = sqlstm.sqinds;
        sqlstm.sqparm = sqlstm.sqharm;
        sqlstm.sqparc = sqlstm.sqharc;
        sqlstm.sqpadto = sqlstm.sqadto;
        sqlstm.sqptdso = sqlstm.sqtdso;
        sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


        d_l_str.arr[d_l_str.len] = '\0';
     }
  }
}
  strcpy(loc_str,d_l_str.arr);
}
/*-----------------------------------------------------*/

split_num(l_str,l_var1,l_var2)
char l_str[];
char *l_var1, *l_var2;
{
  int i=0,j=0;
  for (i=0;(l_str[i]!='\0' && l_str[i] != '.');i++,l_var1++)
     *l_var1 = l_str[i];
  *l_var1 = '\0';
  for (i++,j=0;(l_str[i]!='\0');i++,j++,l_var2++)
     *l_var2 = l_str[i];
  *l_var2 = '\0';
}
/*----------------------------------------------------------*/
update_rl_request_header()
{
     /* EXEC SQL SELECT  COUNT(*) 
			    INTO :c_count
                FROM  RL_REQUEST_DETAIL
               WHERE  SPECIMEN_NO = TO_NUMBER(:c_spec_no)
	             AND  OPERATING_FACILITY_ID = :nd_operating_facility_id
		         AND  NVL(RESULT_STATUS,' ') != 'P'; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 33;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select count(*)  into :b0  from RL_REQUEST_DETAIL where \
((SPECIMEN_NO=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) and NVL(RESULT_STA\
TUS,' ')<>'P')";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )4050;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&c_count;
     sqlstm.sqhstl[0] = (unsigned int  )5;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&c_spec_no;
     sqlstm.sqhstl[1] = (unsigned int  )23;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
     sqlstm.sqhstl[2] = (unsigned int  )7;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


     if (NODATAFOUND)
	 ;
         if (OERROR)
              ins_message(ORA_MESG,"Failed in function update_rl_request_header()");
         c_count.arr[c_count.len] ='\0';

         if(atoi(c_count.arr) == 0)
		 {
	
			d_found.arr[0]	= '\0';
			d_found.len		= 0;

			/* EXEC SQL SELECT 'x' 
					   INTO :d_found
			           FROM  RL_REQUEST_HEADER 
			          WHERE  SPECIMEN_NO = TO_NUMBER(:c_spec_no)
			            AND	 OPERATING_FACILITY_ID = :nd_operating_facility_id
						FOR  UPDATE OF STATUS NOWAIT; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select 'x' into :b0  from RL_REQUEST_HEADER where (SPECIME\
N_NO=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) for update of STATUS nowait\
 ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4077;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&d_found;
   sqlstm.sqhstl[0] = (unsigned int  )4;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&c_spec_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 

			d_found.arr[d_found.len]		= '\0';

	         if (OERROR)
		          ins_message(ORA_MESG,"Failed in function update_rl_request_header()");
			
	 		if (RESOURCE_BUSY)
			{
				ins_message(ORA_MESG,"OPEN failed resource busy update_rl_request_header()");
			}
			else   
			{

					/* EXEC SQL UPDATE RL_REQUEST_HEADER 
								SET STATUS = 'P',
// 21.05.2005		RESULT_PRINTED_DATE = to_date(:nd_result_printed_date,'DD/MM/YYYY HH24:MI:SS'),
									MODIFIED_BY_ID = :sy_user_id, // against ah scfUSER,
									MODIFIED_DATE = SYSDATE
							  WHERE SPECIMEN_NO = TO_NUMBER(:c_spec_no)
								AND OPERATING_FACILITY_ID = :nd_operating_facility_id; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 33;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "update RL_REQUEST_HEADER  set STATUS='P',MODIFIED_BY_ID=\
:b0,MODIFIED_DATE=SYSDATE where (SPECIMEN_NO=TO_NUMBER(:b1) and OPERATING_FACI\
LITY_ID=:b2)";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )4104;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&sy_user_id;
     sqlstm.sqhstl[0] = (unsigned int  )33;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&c_spec_no;
     sqlstm.sqhstl[1] = (unsigned int  )23;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
     sqlstm.sqhstl[2] = (unsigned int  )7;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			}
		 }

         if (OERROR)
              ins_message(ORA_MESG,"Failed in function update_rl_request_header()");
}
/*----------------------------------------------------------*/
update_rl_request_detail()
{   
    int fetch_c_rl_request_detail();

/***** changed on 06/04/2003 because of windows shut down problem in oracle 9.2 **/
	/************
    strcpy(sql_stmt.arr,"SELECT TEST_CODE, GROUP_TEST_YN FROM RL_REQUEST_DETAIL WHERE SPECIMEN_NO = TO_NUMBER(:v1) AND OPERATING_FACILITY_ID = :nd_operating_facility_id for update of result_status NOWAIT");
    sql_stmt.len = strlen(sql_stmt.arr);
    EXEC SQL WHENEVER SQLERROR GOTO err_exit;
    EXEC SQL PREPARE S FROM :sql_stmt;
    EXEC SQL DECLARE C CURSOR FOR S;
    EXEC SQL OPEN C USING :c_spec_no;
	****************/

	/* EXEC SQL DECLARE c CURSOR FOR 
				SELECT TEST_CODE, GROUP_TEST_YN 
				FROM RL_REQUEST_DETAIL
				WHERE SPECIMEN_NO = TO_NUMBER(:c_spec_no)
				AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				for update of result_status NOWAIT; */ 



	/* EXEC SQL OPEN c; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0088;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4131;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&c_spec_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (RESOURCE_BUSY)
	{
		ins_message(ORA_MESG,"OPEN failed resource busy rl_request_detail");
	}
	else    /// 22.09.2003
	{
		while(1)
		{
			/* EXEC SQL FETCH C INTO :c_req_dtl_test_code,:c_group_test_yn; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4154;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&c_req_dtl_test_code;
   sqlstm.sqhstl[0] = (unsigned int  )13;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&c_group_test_yn;
   sqlstm.sqhstl[1] = (unsigned int  )4;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			if(NODATAFOUND)
				return;
		        c_req_dtl_test_code.arr[c_req_dtl_test_code.len] = '\0';
				c_group_test_yn.arr[c_group_test_yn.len] = '\0';
				/* EXEC SQL SELECT NVL(COUNT(*),0) INTO :c_count
				FROM   RL_TEST_RESULT
				WHERE  SPECIMEN_NO = TO_NUMBER(:c_spec_no)
				AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND GROUP_TEST_CODE = :c_req_dtl_test_code
				AND NVL(STATUS,' ') != 'P'; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select NVL(count(*) ,0) into :b0  from RL_TEST_RESULT whe\
re (((SPECIMEN_NO=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) and GROUP_TEST\
_CODE=:b3) and NVL(STATUS,' ')<>'P')";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4177;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&c_count;
    sqlstm.sqhstl[0] = (unsigned int  )5;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&c_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&c_req_dtl_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


				if(NODATAFOUND)
					;
				if (OERROR)
					  ins_message(ORA_MESG,"Failed at Select RL_TEST_RESULT in c_request_detail_cur");
				c_count.arr[c_count.len] ='\0';
				if(atoi(c_count.arr) == 0)
				/* EXEC SQL UPDATE RL_REQUEST_DETAIL 
					     SET RESULT_STATUS = 'P',
						 RESULT_PRINTED_DATE = to_date(:nd_result_printed_date,'DD/MM/YYYY HH24:MI:SS'),
						 MODIFIED_BY_ID = :sy_user_id, ///against ah scf USER,
						 MODIFIED_DATE = SYSDATE
						 WHERE SPECIMEN_NO = TO_NUMBER(:c_spec_no)
						 AND TEST_CODE = :c_req_dtl_test_code; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "update RL_REQUEST_DETAIL  set RESULT_STATUS='P',RESULT_PR\
INTED_DATE=to_date(:b0,'DD/MM/YYYY HH24:MI:SS'),MODIFIED_BY_ID=:b1,MODIFIED_DA\
TE=SYSDATE where (SPECIMEN_NO=TO_NUMBER(:b2) and TEST_CODE=:b3)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4208;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_result_printed_date;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&sy_user_id;
    sqlstm.sqhstl[1] = (unsigned int  )33;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&c_spec_no;
    sqlstm.sqhstl[2] = (unsigned int  )23;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&c_req_dtl_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					if (OERROR)
						ins_message(ORA_MESG,"Failed at update rl_request_detail");
		}

		close_c_cur();
     }    /// 22.09.2003
    return;
err_exit:
   /* EXEC SQL WHENEVER SQLERROR CONTINUE; */ 

   ins_message(ORA_MESG,"Error occurred at update_rl_request_detail()");
   return;
}
/*----------------------------------------------------------*/
close_all_cur()
{
    /* EXEC SQL CLOSE RL_REQ_HDR_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4239;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    /* EXEC SQL CLOSE RL_REQ_DTL_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4254;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    /* EXEC SQL CLOSE RL_TEST_RESULT_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4269;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


//    EXEC SQL CLOSE RL_PAT_MAST_CUR;
//    EXEC SQL CLOSE RL_SPECIMEN_TYPE_CODE_CUR;
//    EXEC SQL CLOSE RL_SECTION_CUR;
//    EXEC SQL CLOSE RL_TEST_CODE_CUR;
//    EXEC SQL CLOSE RL_AGE_SEX_RANGE_CUR;
//    EXEC SQL CLOSE RL_COMM_FOR_TEST_CUR;
//    EXEC SQL CLOSE RL_RESULT_TEXT_CUR;
//    EXEC SQL CLOSE RL_FUNCTION_CUR;
//    EXEC SQL CLOSE RL_TEST_RESULT_CUR2;
//    EXEC SQL CLOSE RL_RESULT_SNOMED_CUR;
//    EXEC SQL CLOSE RL_SNOMED_CODE_CUR;
//    EXEC SQL CLOSE RL_RESULT_ORGANISM_CUR;
//	  EXEC SQL CLOSE RL_ANTIBIOTIC_CUR;
	/* EXEC SQL CLOSE RL_SENSITIVITY_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4284;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


//    EXEC SQL CLOSE RL_ORGANISM_CODE_CUR;
//    EXEC SQL CLOSE RL_ANTIBIOTIC_CODE_CUR;
//    EXEC SQL CLOSE RL_PAT_MAST3_CUR;
//    EXEC SQL CLOSE CUR1;

}

ins_message(int msg_type,char msg[])
{

   
   
   /* EXEC SQL ROLLBACK; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4299;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   er_msg.arr[0] = '\0';
   er_msg.len = 0;
   
   er_msg_type = 0;

   strcpy(er_msg.arr,msg);
   er_msg.len = strlen(msg);
 
   er_msg_type = msg_type;

   sprintf(err_num,"%d",sqlca.sqlcode);

   strcpy(er_msg_num.arr, err_num);
 	er_msg_num.len = strlen(er_msg_num.arr);


   /* EXEC SQL
   INSERT INTO SY_PROG_MSG
          (OPERATING_FACILITY_ID,PGM_ID,MSG_TYPE,MSG_NUM,MSG_DESC,MSG_DATE_TIME,SESSION_ID,PGM_DATE)
   VALUES 
          (:nd_operating_facility_id,'RLRRSENQ',:er_msg_type, SUBSTR(:er_msg_num,1,6),SUBSTR(:er_msg, 1, 70),SYSDATE,:sy_session_id,
		   :sy_req_date); */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "insert into SY_PROG_MSG (OPERATING_FACILITY_ID,PGM_ID,MSG_\
TYPE,MSG_NUM,MSG_DESC,MSG_DATE_TIME,SESSION_ID,PGM_DATE) values (:b0,'RLRRSENQ\
',:b1,SUBSTR(:b2,1,6),SUBSTR(:b3,1,70),SYSDATE,:b4,:b5)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4314;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )7;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&er_msg_type;
   sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&er_msg_num;
   sqlstm.sqhstl[2] = (unsigned int  )1002;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&er_msg;
   sqlstm.sqhstl[3] = (unsigned int  )1073;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&sy_session_id;
   sqlstm.sqhstl[4] = (unsigned int  )32;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[5] = (unsigned int  )32;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   err_flag = 1;
  
  /* EXEC SQL COMMIT ; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4353;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  
}
ins_message1(int msg_type,char msg[])
{

   /* EXEC SQL ROLLBACK ; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4368;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   er_msg.arr[0] = '\0';
   er_msg.len = 0;
   
   er_msg_type = 0;

   strcpy(er_msg.arr,msg);
   er_msg.len = strlen(msg);
 
   er_msg_type = msg_type;

   sprintf(err_num,"%d",sqlca.sqlcode);

   strcpy(er_msg_num.arr, err_num);
 	er_msg_num.len = strlen(er_msg_num.arr);

   /* EXEC SQL
   INSERT INTO SY_PROG_MSG
          (OPERATING_FACILITY_ID,PGM_ID,MSG_TYPE,MSG_NUM,MSG_DESC,MSG_DATE_TIME,SESSION_ID,PGM_DATE)
   VALUES 
          (:nd_operating_facility_id,'RLRRSENQ',:er_msg_type, SUBSTR(:er_msg_num,1,6),SUBSTR(:er_msg, 1, 70),SYSDATE,:sy_session_id,
		   :sy_req_date); */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "insert into SY_PROG_MSG (OPERATING_FACILITY_ID,PGM_ID,MSG_\
TYPE,MSG_NUM,MSG_DESC,MSG_DATE_TIME,SESSION_ID,PGM_DATE) values (:b0,'RLRRSENQ\
',:b1,SUBSTR(:b2,1,6),SUBSTR(:b3,1,70),SYSDATE,:b4,:b5)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4383;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )7;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&er_msg_type;
   sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&er_msg_num;
   sqlstm.sqhstl[2] = (unsigned int  )1002;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&er_msg;
   sqlstm.sqhstl[3] = (unsigned int  )1073;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&sy_session_id;
   sqlstm.sqhstl[4] = (unsigned int  )32;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[5] = (unsigned int  )32;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   
   err_flag = 1;

   /* EXEC SQL COMMIT; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4422;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

/* SPLITTING THE VARCHAR 2000 INTO 70 CHARACTERS   */
/************************************************/
splitting()
{
  
    int fetch_result_text();
	char word[2];

    strcpy(word1,"F");
	_flushall();
    while(fetch_result_text())
    {
		  something_to_print = 1;
		  something_to_print_for_test = 1;
          hell = strlen(rl_res_result_text.arr);
		  
			if(group && !group_printed)
			{   print_group_test_desc();
				group_printed = 1;
			}
			if(!test_printed  && strlen(test_description))
			{     numeric_value_flag = FALSE;  
				sprintf(text_line,"%37.37s%-40s",test_description," ");
					print_line_check(text_line);
			    test_printed = 1;
			}

         z = 0;
	     clt = 0;
	     strcpy(word1,"F");
	     cntr = 1;
	     qq = 0;

         while(z<hell)
         {
		 		  	
		 
             word[0] = rl_res_result_text.arr[z];
 		     word[1] = '\0';

		     if (strcmp(word,"\n") == 0)
		     {
   
		       cntr = 0;
		       strcpy(word1,"N");
		       qq = z ;
		      }


  		      if(cntr >= 71)
		      {
		   	
			     cmp = cntr;
			     while((rl_res_result_text.arr[z] != 32) && (cmp > 1))
			     {

			         z--;
				     cmp--;
				  
			      }

				  qq = z;
				  			   
			      word[0] = rl_res_result_text.arr[z];
   			      word[1] = '\0';
		
		  	      if (cmp == 1)
				     strcpy(word1,"W");
			      else
			         strcpy(word1,"T");
			   
		
		       }


				if (((z == hell) || (z == hell - 1)) && (strcmp(word1,"F") == 0))
				{
	
				   fprint_repeat(fp,' ',8);	
				   
				   sprintf(in_str,"%8.8s"," ");
				   	   
				   for(i=clt;i < z + 1;i++)
		           {
		              fprintf(fp,"%c",rl_res_result_text.arr[i]);
					  sprintf(in_str,"%s%c",in_str,rl_res_result_text.arr[i]);
				
			       }
			       fprintf	(fp,"\n");

				   print_html_line (in_str,out_str);

				   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				   strcpy(out_str,"");
				   write_html(fp4,l_html_bdy_str);
				   strcpy(l_html_bdy_str,"");

				   page_break(1);

				   cntr = 0 ;
				   clt = clt + 70 ;
				   z = clt ;
			       qq = 0;
				   strcpy(word1,"F");


				}

			
		       if (strcmp(word1,"N") == 0) 
		       {
				
		          fprint_repeat(fp,' ',8);	
				  
				  sprintf(in_str,"%8.8s"," ");
				  	   
				  for(i=clt;i<=qq;i++)
		          {
			         fprintf(fp,"%c",rl_res_result_text.arr[i]);
					 sprintf(in_str,"%s%c",in_str,rl_res_result_text.arr[i]);
			      }
                  
				  print_html_line (in_str,out_str);

				  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				  strcpy(out_str,"");
				  write_html(fp4,l_html_bdy_str);
				  strcpy(l_html_bdy_str,"");
				  
				  page_break(1);                                 
			      strcpy(word1,"F");
			      cntr = 0 ;
			      clt = qq + 1;
		          qq = 0;
	   	       }

		       if (strcmp(word1,"T") == 0)
		       {
		 										 
			      fprint_repeat(fp,' ',8);
				  
				  sprintf(in_str,"%8.8s"," ");
				  		   
				  for(i=clt;i<= qq;i++)
		          {
		             fprintf(fp,"%c",rl_res_result_text.arr[i]);
					 sprintf(in_str,"%s%c",in_str,rl_res_result_text.arr[i]);
			      }

			       fprintf	(fp,"\n");

				   print_html_line (in_str,out_str);

				   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				   strcpy(out_str,"");
				   write_html(fp4,l_html_bdy_str);
				   strcpy(l_html_bdy_str,"");

				   page_break(1);
			       cntr = 0 ;
				   clt = qq + 1 ;
			       qq = 0;
				   strcpy(word1,"F");

				
		        }


		        if (strcmp(word1,"W") == 0)
		        {
		 										 
			       fprint_repeat(fp,' ',8);	
				   
				   sprintf(in_str,"%8.8s"," ");
				   	   
				   for(i=clt;i < clt + 70;i++)
		           {
		              fprintf(fp,"%c",rl_res_result_text.arr[i]);
					  sprintf(in_str,"%s%c",in_str,rl_res_result_text.arr[i]);
			       }

			       fprintf(fp,"\n");

				   print_html_line (in_str,out_str);

				   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				   strcpy(out_str,"");
				   write_html(fp4,l_html_bdy_str);
				   strcpy(l_html_bdy_str,"");

				   page_break(1);
				   cntr = 0 ;
				   clt = clt + 70 ;
				   z = clt ;
			       qq = 0;
				   strcpy(word1,"F");

				
		        }

		  
            cntr += 1;
	        z++ ;
          }

		
      }

	  close_text_cur();
  
       fflush(fp);

#ifdef DEBUG
   printf("rl_res_result_text = %s\n", rl_res_result_text.arr);
#endif

if (OERROR)
   ins_message(ORA_MESG,"Error occurred at splitting()");

  return;

err_exit:
   /* EXEC SQL WHENEVER SQLERROR CONTINUE; */ 

   ins_message(ORA_MESG,"Error occurred at splitting()");
   return;

}
set_printed_date_time()
{
 /* Trapping the result printed date/time into a variable */
 nd_result_printed_date.arr[0] = '\0';
 nd_result_printed_date.len = 0;
 /* EXEC SQL SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI:SS') 
            INTO :nd_result_printed_date
			FROM DUAL; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI:SS') into :b0  fr\
om DUAL ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4437;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_result_printed_date;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  
 nd_result_printed_date.arr[nd_result_printed_date.len] = '\0';

 return;

err_exit:
   /* EXEC SQL WHENEVER SQLERROR CONTINUE; */ 

   ins_message(ORA_MESG,"Error occurred at set_printed_date_time()");
   return;
}
/*------------------------------------------------------------*/
get_zero_prefix_for_range()
{
	l_low_val.arr[0]	= '\0';
	l_low_val.len		= 0;
	l_high_val.arr[0]	= '\0';
	l_high_val.len		= 0;
		
	l_low = 0;
	l_high = 0;


	/* EXEC SQL SELECT FLOOR(TO_NUMBER(:rl_tst_ran_high_val_nor)),
				FLOOR(TO_NUMBER(:rl_tst_ran_low_val_nor))
		     INTO :l_high, :l_low
			 FROM DUAL; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select FLOOR(TO_NUMBER(:b0)) ,FLOOR(TO_NUMBER(:b1)) into :b2\
,:b3  from DUAL ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4456;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&rl_tst_ran_high_val_nor;
 sqlstm.sqhstl[0] = (unsigned int  )18;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&rl_tst_ran_low_val_nor;
 sqlstm.sqhstl[1] = (unsigned int  )18;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&l_high;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&l_low;
 sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	strcpy(l_low_val.arr, rl_tst_ran_low_val_nor.arr);
	l_low_val.len = strlen(l_low_val.arr);

	strcpy(l_high_val.arr, rl_tst_ran_high_val_nor.arr);
	l_high_val.len = strlen(l_high_val.arr);

	if (l_low == 0)
	{
		strcpy(rl_tst_ran_low_val_nor.arr, "0");

		if (strcmp(l_low_val.arr, "0") != 0)
			strcat(rl_tst_ran_low_val_nor.arr, l_low_val.arr);

		rl_tst_ran_low_val_nor.len = strlen(rl_tst_ran_low_val_nor.arr);
	}

	if (l_high == 0)
	{
		strcpy(rl_tst_ran_high_val_nor.arr, "0");

		if (strcmp(l_high_val.arr, "0") != 0)
			strcat(rl_tst_ran_high_val_nor.arr, l_high_val.arr);

		rl_tst_ran_high_val_nor.len = strlen(rl_tst_ran_high_val_nor.arr);
	}


    l_low_val.arr[0]		= '\0';
	l_low_val.len			= 0;

	l_high_val.arr[0]		= '\0';
	l_high_val.len			= 0;

	l_low = 0;
	l_high = 0;


}
/*------------------------------------------------------------*/
build_table()
{
	int i;

	l_should_print_yn = 'N';
	d_interval_specimen_yn = 'N';

	i = 1;

	/* EXEC SQL DECLARE int_curs CURSOR FOR 
				SELECT DISTINCT TO_CHAR(A.interval_test_specimen_no)
				FROM RL_INTERVAL_TEST_SPECIMENS A 
				WHERE A.specimen_no = TO_NUMBER(:nd_spec_no) 
				AND A.OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND NVL(A.cancelled_yn, 'N') <> 'Y'
				AND ( NVL(A.status, 'O') IN ('R', :nd_status)
					 OR :draft_printing_yn = 'Y'); */ 


	/* EXEC SQL OPEN int_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0099;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4487;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_status;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&draft_printing_yn;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	while(fetch_int_curs())  
	{
	
		if (strcmp(draft_printing_yn.arr, "N") == 0)
		{
			/* EXEC SQL SELECT COUNT(1)
				 INTO :i_count
				 FROM RL_INTERVAL_TEST_SPECIMENS
				 WHERE interval_test_specimen_no = TO_NUMBER(:d_no) 
				 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND NVL(cancelled_yn, 'N') <> 'Y'
				 AND NVL(status, 'O') NOT IN ('R', 'P'); */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select count(1) into :b0  from RL_INTERVAL_TEST_SPECIMENS \
where (((interval_test_specimen_no=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b\
2) and NVL(cancelled_yn,'N')<>'Y') and NVL(status,'O') not  in ('R','P'))";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4518;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&i_count;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&d_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


//////				OR (AND :draft_printing_yn = 'N') );
		}
		else
			i_count = 0;



		if (i_count == 0)
		{

			declare_spec_curs();
			while(fetch_spec_curs())
			{

				if (i == 1)
				{
				   strcpy(first_specimen_no.arr, d_specimen_no.arr);
				   first_specimen_no.len = strlen(first_specimen_no.arr);
				   i++;
				}

				/* EXEC SQL INSERT INTO RL_INTERVAL_TEST_TEMP
							(operating_facility_id,user_id, session_id, specimen_no, 
							 group_test_code, test_code, seq_no)
						 VALUES
						 	(:nd_operating_facility_id,'RLRRSENQ', 1, 
							 TO_NUMBER(:d_specimen_no), :d_group_test_code, 
							 :d_test_code, :d_seq_no); */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "insert into RL_INTERVAL_TEST_TEMP (operating_facility_id,\
user_id,session_id,specimen_no,group_test_code,test_code,seq_no) values (:b0,'\
RLRRSENQ',1,TO_NUMBER(:b1),:b2,:b3,:b4)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4545;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_specimen_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_group_test_code;
    sqlstm.sqhstl[2] = (unsigned int  )13;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d_seq_no;
    sqlstm.sqhstl[4] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				l_should_print_yn = 'Y';
				d_interval_specimen_yn = 'Y';
			}
			close_spec_curs();
		}
	}

	close_int_curs(); 

	/* EXEC SQL DECLARE req_curs CURSOR FOR 
				SELECT test_code 
				FROM RL_REQUEST_DETAIL
				WHERE specimen_no = TO_NUMBER(:nd_spec_no) 
				AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND NVL(cancelled_yn, 'N') <> 'Y'
				AND (NVL(result_status, 'O') IN ('R', :nd_status)
						OR :draft_printing_yn = 'Y' 
						OR (test_code in (SELECT test_code FROM RL_TEST_CODE
										 WHERE  NVL(PROFILE_YN,'N') = 'Y'
										 AND    NVL(GROUP_TEST_YN,'N') = 'Y')  /// 21.05.2005
							AND ( NVL(result_status,'O') = 'O' 
									OR (NVL(result_status,'O') IN ('A') AND released_date IS NOT NULL))
							)
						OR (NVL(preliminary_release_yn,'N') = 'Y' AND NVL(result_status,'O') IN ('A'))  /// 22.08.2006
					); */ 

		   	    

	/* EXEC SQL OPEN req_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0102;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4580;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_status;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&draft_printing_yn;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	while(fetch_req_curs())
	{
		/* EXEC SQL SELECT COUNT(1)
		INTO :i_count
		FROM RL_INTERVAL_TEST_SPECIMENS
		WHERE specimen_no = TO_NUMBER(:nd_spec_no)
		AND OPERATING_FACILITY_ID = :nd_operating_facility_id
		AND NVL(cancelled_yn, 'N') <> 'Y'
		AND group_test_code = :d_group_test_code; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select count(1) into :b0  from RL_INTERVAL_TEST_SPECIMENS w\
here (((specimen_no=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) and NVL(canc\
elled_yn,'N')<>'Y') and group_test_code=:b3)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4611;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&i_count;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
  sqlstm.sqhstl[1] = (unsigned int  )23;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[2] = (unsigned int  )7;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d_group_test_code;
  sqlstm.sqhstl[3] = (unsigned int  )13;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (i_count == 0)  
		{
			l_should_print_yn = 'Y';

			/* EXEC SQL INSERT INTO RL_INTERVAL_TEST_TEMP
							(OPERATING_FACILITY_ID,user_id, session_id, 
							 specimen_no, group_test_code)
					 VALUES
							(:nd_operating_facility_id,'RLRRSENQ', 1, 
							 TO_NUMBER(:nd_spec_no), :d_group_test_code); */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "insert into RL_INTERVAL_TEST_TEMP (OPERATING_FACILITY_ID,u\
ser_id,session_id,specimen_no,group_test_code) values (:b0,'RLRRSENQ',1,TO_NUM\
BER(:b1),:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4642;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )7;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&d_group_test_code;
   sqlstm.sqhstl[2] = (unsigned int  )13;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		}


	}
	close_req_curs();

	if (d_interval_specimen_yn == 'N')
	{
	   strcpy(first_specimen_no.arr, nd_spec_no.arr);
	   first_specimen_no.len = strlen(first_specimen_no.arr);

	}

}
/*------------------------------------------------------------*/
declare_spec_curs()
{
		/* EXEC SQL DECLARE spec_curs CURSOR FOR 
				SELECT TO_CHAR(A.specimen_no), A.group_test_code, A.test_code, A.seq_no
				FROM RL_INTERVAL_TEST_SPECIMENS A 
				WHERE A.interval_test_specimen_no= TO_NUMBER(:d_no) 
				AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND NVL(A.cancelled_yn, 'N') <> 'Y'
		   	    ORDER BY A.specimen_no; */ 


		/* EXEC SQL OPEN spec_curs; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = sq0105;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4669;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_no;
  sqlstm.sqhstl[0] = (unsigned int  )23;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )7;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		
}

/*------------------------------------------------------------*/
fetch_spec_curs()
{
	 d_specimen_no.arr[0]		= '\0';
	 d_specimen_no.len			= 0;
	 d_group_test_code.arr[0]	= '\0';
	 d_group_test_code.len		= 0;
	 d_test_code.arr[0]			= '\0';
	 d_test_code.len			= 0;

	/* EXEC SQL FETCH spec_curs 
				 INTO :d_specimen_no, :d_group_test_code, :d_test_code,
				 :d_seq_no; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4692;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_specimen_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_group_test_code;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_test_code;
 sqlstm.sqhstl[2] = (unsigned int  )13;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_seq_no;
 sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		if (OERROR)
			ins_message(ORA_MESG,"FETCH failed on cursor specimen_curs");

	
		d_specimen_no.arr[d_specimen_no.len]			= '\0';
		d_group_test_code.arr[d_group_test_code.len]	= '\0';
		d_test_code.arr[d_test_code.len]				= '\0';

	return (LAST_ROW?0:1);
	 
}
/*------------------------------------------------------------*/
fetch_int_curs()
{
	 d_no.arr[0]		= '\0';
	 d_no.len			= 0;
	 
	/* EXEC SQL FETCH int_curs 
				 INTO :d_no; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4723;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		if (OERROR)
			ins_message(ORA_MESG,"FETCH failed on cursor int_curs");

	
		d_no.arr[d_no.len]			= '\0';

	return (LAST_ROW?0:1);
	 
}
/*------------------------------------------------------------*/
fetch_req_curs()
{
	 d_group_test_code.arr[0]		= '\0';
	 d_group_test_code.len			= 0;
	 
	/* EXEC SQL FETCH req_curs 
				 INTO :d_group_test_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4742;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_group_test_code;
 sqlstm.sqhstl[0] = (unsigned int  )13;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		if (OERROR)
			ins_message(ORA_MESG,"FETCH failed on cursor req_curs");

	
		d_group_test_code.arr[d_group_test_code.len]			= '\0';

	return (LAST_ROW?0:1);
	 
}
/*------------------------------------------------------------*/
close_int_curs()
{
	/* EXEC SQL CLOSE int_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4761;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/

close_spec_curs()
{
	/* EXEC SQL CLOSE spec_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4776;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
close_req_curs()
{
	/* EXEC SQL CLOSE req_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4791;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
update_interval_specimen()
{
	/* EXEC SQL SELECT COUNT(1)
			 INTO :u_count
			 FROM RL_INTERVAL_TEST_SPECIMENS
			 WHERE specimen_no = TO_NUMBER(:nd_spec_no)
			 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
			 AND test_code = :rl_tst_test_code
			 AND NVL(cancelled_yn, 'N') <> 'Y'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select count(1) into :b0  from RL_INTERVAL_TEST_SPECIMENS wh\
ere (((specimen_no=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) and test_code\
=:b3) and NVL(cancelled_yn,'N')<>'Y')";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4806;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&u_count;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[1] = (unsigned int  )23;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&rl_tst_test_code;
 sqlstm.sqhstl[3] = (unsigned int  )13;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
	if (u_count > 0)
	{
			
			d_found.arr[0]		= '\0';
			d_found.len			= 0;
			
		/* EXEC SQL SELECT 'x'
				 INTO :d_found
				 FROM RL_INTERVAL_TEST_SPECIMENS
				 WHERE specimen_no = TO_NUMBER(:nd_spec_no)
				 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND test_code = :rl_tst_test_code
				 AND NVL(cancelled_yn, 'N') <> 'Y'
				 FOR UPDATE OF status NOWAIT; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select 'x' into :b0  from RL_INTERVAL_TEST_SPECIMENS where \
(((specimen_no=TO_NUMBER(:b1) and OPERATING_FACILITY_ID=:b2) and test_code=:b3\
) and NVL(cancelled_yn,'N')<>'Y') for update of status nowait ";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4837;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_found;
  sqlstm.sqhstl[0] = (unsigned int  )4;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
  sqlstm.sqhstl[1] = (unsigned int  )23;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[2] = (unsigned int  )7;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&rl_tst_test_code;
  sqlstm.sqhstl[3] = (unsigned int  )13;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			d_found.arr[d_found.len]	= '\0';

			 if (OERROR)
		 	 {
		 		ins_message(ORA_MESG,"SELECT failed on RL_INTERVAL_TEST_SPECIMENS");
			 }

			 if (RESOURCE_BUSY)
			 {
				ins_message(ORA_MESG,"OPEN failed resource busy RL_INTERVAL_TEST_SPECIMENS");
			 }
			 else
			 {
				 
				/* EXEC SQL UPDATE RL_INTERVAL_TEST_SPECIMENS
					 SET status = 'P'
					 WHERE specimen_no = TO_NUMBER(:nd_spec_no)
					 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
					 AND test_code = :rl_tst_test_code
					 AND NVL(cancelled_yn, 'N') <> 'Y'; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "update RL_INTERVAL_TEST_SPECIMENS  set status='P' where (\
((specimen_no=TO_NUMBER(:b0) and OPERATING_FACILITY_ID=:b1) and test_code=:b2)\
 and NVL(cancelled_yn,'N')<>'Y')";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4868;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )7;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[2] = (unsigned int  )13;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			 }
	}

}
/*------------------------------------------------------------*/
delete_build_table()
{
	/* EXEC SQL DELETE FROM RL_INTERVAL_TEST_TEMP
			 WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
			 AND user_id = 'RLRRSENQ'
			 AND session_id = 1; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "delete  from RL_INTERVAL_TEST_TEMP  where ((OPERATING_FACILI\
TY_ID=:b0 and user_id='RLRRSENQ') and session_id=1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4895;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	/* EXEC SQL DELETE FROM RL_INTERVAL_TEST_TEMP
			 WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
			 AND user_id = 'RLRRSENQ'
			 AND session_id = 2; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "delete  from RL_INTERVAL_TEST_TEMP  where ((OPERATING_FACILI\
TY_ID=:b0 and user_id='RLRRSENQ') and session_id=2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4914;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/*------------------------------------------------------------*/

get_interval_description()
{
	interval_description.arr[0]		= '\0';
	interval_description.len		= 0;

	/* EXEC SQL SELECT description
			 INTO :interval_description
			 FROM RL_INTERVAL_TEST_DESC_lang_vw
			 WHERE test_code = :rl_tst_test_code
			 AND seq_no = :rl_seq_no
			 and language_id = :language_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select description into :b0  from RL_INTERVAL_TEST_DESC_lang\
_vw where ((test_code=:b1 and seq_no=:b2) and language_id=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4933;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&interval_description;
 sqlstm.sqhstl[0] = (unsigned int  )43;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&rl_tst_test_code;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&rl_seq_no;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&language_id;
 sqlstm.sqhstl[3] = (unsigned int  )7;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	interval_description.arr[interval_description.len]		= '\0';
}
/*-----------------------------------------------------*/
get_first_specimen_no()
{
	int i;

	/* EXEC SQL DECLARE first_spec_curs CURSOR FOR 
				SELECT TO_CHAR(A.interval_test_specimen_no)
				FROM RL_INTERVAL_TEST_SPECIMENS A 
				WHERE A.specimen_no = TO_NUMBER(:nd_spec_no) 
				AND A.OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND NVL(A.cancelled_yn, 'N') <> 'Y'
				AND (NVL(A.status, 'O') IN ('R', :nd_status) 
						OR :draft_printing_yn = 'Y')
		   	    ORDER BY A.specimen_no; */ 


	/* EXEC SQL OPEN first_spec_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0112;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4964;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_status;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&draft_printing_yn;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	i = fetch_first_spec_curs();

	/* EXEC SQL CLOSE first_spec_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4995;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}

/*------------------------------------------------------------*/
fetch_first_spec_curs()
{
	 first_specimen_no.arr[0]	= '\0';
	 first_specimen_no.len		= 0;

	/* EXEC SQL FETCH first_spec_curs 
				 INTO :first_specimen_no; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5010;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&first_specimen_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		if (OERROR)
			ins_message(ORA_MESG,"FETCH failed on cursor first_specimen_curs");

	
		first_specimen_no.arr[first_specimen_no.len]		= '\0';

	return (LAST_ROW?0:1);
	 
}
/*------------------------------------------------------------*/

close_comments_curs()
{

	/* EXEC SQL CLOSE RL_COMM_FOR_TEST_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5029;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_COMM_FOR_TEST_CUR");

}

close_text_cur()
{
	/* EXEC SQL CLOSE RL_RESULT_TEXT_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5044;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_RESULT_TEXT_CUR");

}

close_function_cur()
{
	/* EXEC SQL CLOSE RL_FUNCTION_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5059;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_FUNCTION_CUR");

}

close_snomed_cur()
{

	/* EXEC SQL CLOSE RL_RESULT_SNOMED_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5074;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_RESULT_SNOMED_CUR");

}

close_organism_cur()
{

	/* EXEC SQL CLOSE RL_RESULT_ORGANISM_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5089;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_RESULT_ORGANISM_CUR");

}

close_antibiotic_cur()
{
	/* EXEC SQL CLOSE RL_ANTIBIOTIC_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5104;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_ANTIBIOTIC_CUR");

}

close_sensitivity_cur_format4()
{
	/* EXEC SQL CLOSE RL_SENSITIVITY_CUR_FORMAT4; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5119;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_SENSITIVITY_CUR_FORMAT4");

}



close_cur1_cur()
{
	/* EXEC SQL CLOSE CUR1; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5134;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor CUR1");

}

close_mast_cur()
{
	if (strcmp(BVNewVersionYN.arr,"Y") == 0)
		/* EXEC SQL CLOSE RL_PAT_MAST_CUR; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5149;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	else
		/* EXEC SQL CLOSE RL_PAT_MAST_CUR_ah; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5164;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_PAT_MAST_CUR");

}


close_mast3_cur()
{
	
	/* EXEC SQL CLOSE RL_PAT_MAST3_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5179;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_PAT_MAST3_CUR");

}

close_c_cur()
{
	
	/* EXEC SQL CLOSE C; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5194;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor C");

}

put_zero_before_decimal()
{

	if (rl_tst_numeric_result.arr[0] != '0')
	{
		strcpy(l_numeric_result, "0");
		strcat(l_numeric_result, rl_tst_numeric_result.arr);

		strcpy(rl_tst_numeric_result.arr, l_numeric_result);
		rl_tst_numeric_result.len = strlen(rl_tst_numeric_result.arr);
	}
	

}

/******************************************************************************************/
get_race_desc()
{
	
	d_race_desc.arr[0]		= '\0';
	d_race_desc.len			= 0;

	/* EXEC SQL SELECT short_desc
		     INTO :d_race_desc
			 FROM MP_RACE_lang_vw
			 WHERE race_code = :rl_race_code
			 and language_id = :language_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select short_desc into :b0  from MP_RACE_lang_vw where (race\
_code=:b1 and language_id=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5209;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_race_desc;
 sqlstm.sqhstl[0] = (unsigned int  )33;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&rl_race_code;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&language_id;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND);

	d_race_desc.arr[d_race_desc.len]			= '\0';
	
}


/******************************************************************************************/
print_clinical_history()
{

	int ctr = 0;
	int len = 0;
	int r_ctr = 0;

	char l_string[100];     

		/* EXEC SQL DECLARE rl_clinical_cur CURSOR FOR
				 SELECT specimen_no, clinical_text_code, SUBSTR(clinical_text, 1, 4000) 
				 FROM RL_PATIENT_CLINICAL_TEXT
				 WHERE specimen_no IN (SELECT distinct specimen_no
							FROM RL_INTERVAL_TEST_TEMP
							WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
							AND user_id = 'RLRRSENQ' 
							AND session_id = 1 )
			       AND OPERATING_FACILITY_ID = :nd_operating_facility_id
			       AND NVL(order_questionnaire_yn, 'N') <> 'Y'
				 ORDER BY specimen_no; */ 


		/* EXEC SQL OPEN rl_clinical_cur; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = sq0114;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5236;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )7;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )7;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

   

		ctr = 0;

/* commented on 14.08.2003 and added another version of splittext in local itself

		while(fetch_clinical_text())
		{

			len = strlen(d_clinical_text.arr);

			if (strlen(d_clinical_text.arr) > 0)
			{

			   split_text(d_clinical_text.arr, 79, l_string, &r_ctr);

  			   if (d_interval_specimen_yn == 'Y')
			   {
			  	  fprintf(fp, "Specimen No : %-15s", d_clinical_spec_no.arr);
			   }

				if (ctr == 0)
				{

					if (strlen(l_string) > 0 )
					{

						page_break(1);
						fprintf(fp,"%c&k4S",ESC); 
						fprintf(fp,"%c(s4B",ESC);
						//fprintf(fp, "Clinical History\n");
						fprintf(fp, "%s\n", local_legend[39]); //added for globalisation
						fprintf(fp,"%c&k4S",ESC); 
						fprintf(fp,"%c(s-3B",ESC);
						
					}
				}

				fprintf(fp,"       %s\n",l_string);  
				page_break(1);

				while(r_ctr <= len)
				{	
					page_break(1);
					split_text(d_clinical_text.arr, 79, l_string, &r_ctr);
					fprintf(fp,"       %s\n",l_string);  
					page_break(1);

					strcpy(l_string, "");

				}
			
				ctr++;
			}
		}

********************/

		split_hist();   ///////// added on 14.08.2003

		/* EXEC SQL CLOSE rl_clinical_cur; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5259;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}

/******************************************************************************************/
fetch_clinical_text()
{

	d_clinical_text_code.arr[0]		= '\0';
	d_clinical_text_code.len		= 0;
	d_clinical_spec_no.arr[0]		= '\0';
	d_clinical_spec_no.len			= 0;

	d_clinical_text.arr[0]			= '\0';
	d_clinical_text.len				= 0;

    /* EXEC SQL FETCH rl_clinical_cur
              INTO :d_clinical_spec_no,
				   :d_clinical_text_code, 
				   :d_clinical_text; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )5274;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&d_clinical_spec_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_clinical_text_code;
    sqlstm.sqhstl[1] = (unsigned int  )7;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_clinical_text;
    sqlstm.sqhstl[2] = (unsigned int  )4003;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_PATIENT_CLINICAL_TEXT");


	d_clinical_spec_no.arr[d_clinical_spec_no.len]			= '\0';
	d_clinical_text_code.arr[d_clinical_text_code.len]		= '\0';
	d_clinical_text.arr[d_clinical_text.len]				= '\0';

    return (LAST_ROW?0:1);
}
/*******************************************************************************************/
chk_inhibit_yn()
{

	/* EXEC SQL SELECT NVL(inhibit_report_yn, 'N') 
			INTO :d_inhibit_yn
			FROM RL_TEST_CODE 
			WHERE test_code = :inhibit_test_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select NVL(inhibit_report_yn,'N') into :b0  from RL_TEST_COD\
E where test_code=:b1";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5301;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_inhibit_yn;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&inhibit_test_code;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	d_inhibit_yn.arr[d_inhibit_yn.len]		= '\0';
}

/*******************************************************************************************/
print_header3()
{   char t_patient_id[16];   
    char sex_desc[11];
	char pat_name[300];
	char uline[82];
	char l_str[100];
    int i,l_tests;

    pctr++;

	if (l_print_health_card_yn.arr[0]=='Y') 
		lctr = 20;
	else
	    lctr = 19;

    get_parameters();

/*---------*/
    fprintf(fp,"%c&a006L",ESC); /* Set the left Margin */
	fprintf(fp,"%c&k12S",ESC);	/* This makes the font size to increase to 12 */
	fprintf(fp,"%c&l6D",ESC);	/* Set the Density */
   	fprintf(fp,"%c(s4B",ESC);   /* Set Bold */
/*---------*/

    fprintf(fp,"\n%-*s%-.40s\n\n",(int)(((80 - sy_acc_entity_name.len)/2) - 6)," ",sy_acc_entity_name.arr);
    fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title.len)/2) - 6)," ",rl_lab_title.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);
    fprintf(fp,"%73.73sPage(s) : %3d\n"," ",pctr);
/*----------------------------------------*/


    if(rl_hdr_episode_type.arr[0] == 'R')
       if(strcmp(rl_pat_actual_id.arr,"NULL")==0)
	  strcpy(t_patient_id,nd_hosp_no.arr);
       else
	  strcpy(t_patient_id,rl_pat_actual_id.arr);
    else
       strcpy(t_patient_id,nd_hosp_no.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Patient ID : ");
    fprintf(fp,"%-11.11s: ", local_legend[26]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
	
	fprintf(fp,"%c&k12S",ESC);	
	fprintf(fp,"%c&l6D",ESC);
   	fprintf(fp,"%c(s4B",ESC);

    fprintf(fp,"%-15.15s",t_patient_id);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Section : ");
	fprintf(fp, "%-8.8s: ", local_legend[27]);//added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

	fprintf(fp, "%-s - %-s\n",rl_section_short_name.arr,
							  rl_section_tel_num.arr);

/* added by c shekhar to print health card info 21/06/2002 */

if ((l_print_health_card_yn.arr[0]=='Y') && 
			 ( (rl_health_card_num.arr[0]!='\0') ||
			   (rl_health_num.arr[0] != '\0')
			  ))
	{

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Health Card No : ");
    fprintf(fp,"%-15.15s: ", local_legend[4]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
	
	fprintf(fp,"%c&k12S",ESC);	
	fprintf(fp,"%c&l6D",ESC);
   	fprintf(fp,"%c(s4B",ESC);

    fprintf(fp,"%-15.15s",rl_health_card_num.arr);


/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"     Health No : ");
    fprintf(fp,"%-15.15s: ", local_legend[5]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

	fprintf(fp,"%c&k12S",ESC);	
	fprintf(fp,"%c&l6D",ESC);
   	fprintf(fp,"%c(s4B",ESC);

    fprintf(fp,"%-14.14s\n", rl_health_num.arr);

//	fprintf(fp, "   Exp. Date : ");
//	fprintf(fp, "%-10.10s\n", rl_health_exp_date.arr);
}

/*--------------till here ----------------------*/

    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"\n\n");

    if(rl_pat_sex.arr[0] == 'M')
	   //strcpy(sex_desc,"MALE");
	   strcpy(sex_desc,local_legend[37]); //added for globalisation
	else
	if(rl_pat_sex.arr[0] == 'F')
	   //strcpy(sex_desc,"FEMALE");
	   strcpy(sex_desc,local_legend[38]); //added for globalisation
	else
       strcpy(sex_desc,"");
    
	strcpy(pat_name,rl_pat_title.arr);
	if(strlen(rl_pat_title.arr) > 0)
	   strcat(pat_name," ");
	strcat(pat_name,rl_pat_short_name.arr);
    
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp,"Patient Name         : ");
	fprintf(fp,"%-21.21s: ", local_legend[6]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-42.42s",pat_name);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Sex : ");
    fprintf(fp,"%-4.4s: ", local_legend[7]);//added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-8.8s\n",sex_desc);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Location             : ");
    fprintf(fp,"%-21.21s: ", local_legend[8]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-42.42s",rl_source_short_name.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"DOB : ");
    fprintf(fp,"%-4.4s: ", local_legend[9]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
	
	fprintf(fp,"%-16.16s\n",rl_pat_date_of_birth.arr); 

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Clinical Information : ");
    fprintf(fp,"%-21.21s: ", local_legend[10]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    if (rl_hdr_request_comment_desc1.len)
    {
      fprintf(fp,"%-40s\n",rl_hdr_request_comment_desc1.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

    if (rl_hdr_request_comment_desc2.len)
    {
       /*----------------------------------------*/
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s4B",ESC);
       fprintf(fp,"%-23.23s"," ");
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/
      fprintf(fp,"%-40s\n",rl_hdr_request_comment_desc2.arr);
      page_break(1);
    }

    if (rl_hdr_request_comment_desc3.len)
    {
       /*----------------------------------------*/
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s4B",ESC);
       fprintf(fp,"%-23.23s"," ");
       fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/
      fprintf(fp,"%-40s\n",rl_hdr_request_comment_desc3.arr);
      page_break(1);
    }
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Requesting Doctor    : ");
    fprintf(fp,"%-21.21s: ",local_legend[11]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
    if(rl_ordering_doctor_name.len)    ///// added on 06.12.2004
	  strcpy(rl_consultant_short_name.arr,rl_ordering_doctor_name.arr);

    fprintf(fp,"%-33.33s",rl_consultant_short_name.arr);
				
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Request Date : ");
    fprintf(fp,"%-13.13s: ", local_legend[12]);//added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    //fprintf(fp,"%-s\n",rl_hdr_spec_recd_date_time.arr);
    fprintf(fp,"%-s\n",rl_hdr_spec_recd_date_time1.arr);//added for globalisation

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Specimen Type        : ");
    fprintf(fp,"%-21.21s: ", local_legend[13]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-33.33s",rl_spc_specimen_desc.arr);

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Regn Date    : ");
    fprintf(fp,"%-13.13s: ", local_legend[14]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/
            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_regd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_regd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_regd_dat\
e_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_regd_date_time , 'D\
D/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )5324;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    //fprintf(fp,"%s\n",rl_hdr_spec_regd_date_time.arr);
    fprintf(fp,"%s\n",rl_hdr_spec_regd_date_time1.arr);//added for globalisation

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Tests Requested      : ");
    fprintf(fp,"%-21.21s: ",local_legend[15]); //added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

    fprintf(fp,"%-33.33s"," ");

/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
    //fprintf(fp,"Specimen No  : ");
    fprintf(fp,"-13.13s: ",local_legend[16]);//added for globalisation
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
/*----------------------------------------*/

	if (d_interval_specimen_yn == 'Y')
		fprintf(fp,"%-9.9s (I)\n",first_specimen_no.arr);
	else
		fprintf(fp,"%-s\n",nd_spec_no.arr);

	sprintf(l_str,"%-6.6s"," ");

    l_tests = no_of_dtl_recs;
	if (no_of_dtl_recs > 7)
	   l_tests = 7;

//    for (i=0;i < no_of_dtl_recs;i++)
    for (i=0;i < l_tests;i++)
    {
       sprintf(l_str,"%s%-5s  ",l_str, rl_dtl_test_code[i].arr);
    }
    fprintf(fp,"%s\n",l_str);

    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"\n\n");
}
/*---------------------------------------------------------*/
print_header2()
{

    char t_patient_id[16];   
    char sex_desc[11];
	char pat_name[300];
	char uline[82];
	char l_str[100];
    int i;
	char l_age_legend[5];

    pctr++;
    
    get_parameters();
	lctr = 0;
/*---------*/

/*-------------------------- added on 21.10.2004 to skip 2 lines for site AH ------*/
	get_sm_installation();
	if (strcmp(BVNewVersionYN.arr,"N") == 0)
	{
	 fprintf(fp,"\n\n");
	 lctr+=2;
	}    
	else
	{
	 fprintf(fp,"\n");
	 lctr+=1;
	}    


/*-------  added on 21.10.2004 to reset the printer setting before start printing ------*/
    fprintf(fp,"%cE",ESC); 

/*-------- upto here on 21.10.2004 -----*/

    fprintf(fp,"%c&a006L",ESC); /* Set the left Margin */
	fprintf(fp,"%c&k12S",ESC);	/* This makes the font size to increase to 12 */
	fprintf(fp,"%c&l6D",ESC);	/* Set the Density */
   	fprintf(fp,"%c(s4B",ESC);   /* Set Bold */
/*---------*/
    if (rl_lab_title.len) 
	{
       fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title.len)/2) - 6)," ",rl_lab_title.arr);
	   lctr+=2;
	}
    if (rl_lab_title_2.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_2.len)/2) - 6)," ",rl_lab_title_2.arr);
	   lctr+=2;
	}
    if (rl_lab_title_3.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_3.len)/2) - 6)," ",rl_lab_title_3.arr);
	   lctr+=2;
	}
    if (rl_lab_title_4.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_4.len)/2) - 6)," ",rl_lab_title_4.arr);
	   lctr+=2;
	}
    if (rl_lab_title_5.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_5.len)/2) - 6)," ",rl_lab_title_5.arr);
	   lctr+=2;
	}

	// New title has to be printed as the department name with hardcoded legend 'Department of' 27.07.2004

    rl_lab_title_6.arr[0] = '\0';
    rl_lab_title_6.len = 0;
	/// 12.02.2006 if (strcmp(rl_hmc_yn.arr,"Y") == 0)  // because HMC doesnt want hardcoded legend 
	if (strcmp(BVNewVersionYN.arr,"Y") == 0)  // 12.02.2006 becaz ML,HMC doesnt want hardcoded legend
	{
		strcpy(rl_lab_title_6.arr, rl_section_short_name.arr);
	}
	else
	{
		//strcpy(rl_lab_title_6.arr, "Department of ");
		strcpy(rl_lab_title_6.arr, local_legend[40]);//added for globalisation
		strcat(rl_lab_title_6.arr, " ");//added for globalisation
		strcat(rl_lab_title_6.arr, rl_section_short_name.arr);
	}

	rl_lab_title_6.len = strlen(rl_lab_title_6.arr);
    if (rl_lab_title_6.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_6.len)/2) - 6)," ",rl_lab_title_6.arr);
	   lctr+=2;
	}


/*----------------------------------------*/

/***** for draft copy legend *********/

	if (strcmp(draft_printing_yn.arr, "N") == 0)
		lctr = lctr;   /// 27.07.2004  lctr = 8;

	else
	{
	    lctr++;       /// 27.07.2004   lctr = 9;
		//fprintf(fp, "Draft Copy\n");
		fprintf(fp, "%-10.10s\n", local_legend[71]); //added for globalisation
	}


	if(l_report_legend.len && strcmp(draft_printing_yn.arr, "N") == 0)  // 21.05.2005
	{
	    lctr++;       
		fprintf(fp, "%s\n",l_report_legend.arr);  
	}



/*----------------------------------------*/ 
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);
    fprintf(fp,"%73.73sPage(s) : %3d\n"," ",pctr);
/*----------------------------------------*/

	

	/*** NEWLY ADDED ON 28/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO 
			BEFORE the detail portion of heading******/
	if(rl_hdr_episode_type.arr[0] != 'R')
		print_hmc_no();


	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

   for(i=0;i<87;i++)
        fprintf(fp,"_");

	fprintf(fp, "\n");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);

	lctr++;

	if (strcmp(rl_actual_dob_yn.arr, "Y") == 0)
		strcpy(l_age_legend, "");
	else
		strcpy(l_age_legend, "*");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Patient Name : ");
	fprintf(fp, "%-13.13s:", local_legend[6]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-30.30s                ", rl_pat_short_name.arr);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Age: ");
	fprintf(fp, "%-3.3s: ", local_legend[41]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%s ", l_age_legend);

	patient_age();

	fprintf(fp, "%s\n", t_age.arr);
	page_break(1);


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Patient  ID  : ");
	fprintf(fp, "%-13.13s: ", local_legend[41]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	if(rl_hdr_episode_type.arr[0] == 'R')
	{
       if(strcmp(rl_pat_actual_id.arr,"NULL")==0)
	 	   strcpy(t_patient_id,nd_hosp_no.arr);
	   else
		   strcpy(t_patient_id,rl_pat_actual_id.arr);
	}
    else
       strcpy(t_patient_id,nd_hosp_no.arr);

	fprintf(fp, "%-15.15s                          ", t_patient_id);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

	if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	   //fprintf(fp, "Sex/Race: ");
	   fprintf(fp, "%-8.8s: ",local_legend[42] );//added for globalisation
    else
       //fprintf(fp, "     Sex: ");
	   fprintf(fp, "%8.8s: ",local_legend[7] );//added for globalisation
		
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_pat_sex.arr[0] == 'M')
	   //strcpy(sex_desc,"MALE");
	   strcpy(sex_desc,local_legend[37]);//added for globalisation
	else
		if(rl_pat_sex.arr[0] == 'F')
			//strcpy(sex_desc,"FEMALE");
			strcpy(sex_desc,local_legend[38]);//added for globalisation
		else
			//strcpy(sex_desc,"Unknown");
		   strcpy(sex_desc,local_legend[43]);//added for globalisation

	fprintf(fp,"%s", sex_desc);

    if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	{
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		get_race_desc();
		fprintf(fp, "%-15.15s", d_race_desc.arr);
	}

    fprintf(fp, "\n");
	page_break(1);


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Location     : ");
	fprintf(fp, "%-13.13s: ",local_legend[8]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%s", rl_source_short_name.arr);

	if(rl_hdr_episode_type.arr[0] == 'R')
	{
	    fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		fprintf(fp, "%-20.20s\n", rl_location.arr);
		page_break(1);
	}
	else
	{
		fprintf(fp, "\n");
		page_break(1);
		
	}


	/*** NEWLY ADDED ON 26/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO ******/
//	if(rl_hdr_episode_type.arr[0] != 'R')
//		print_hmc_no();


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Doctor       : ");
	fprintf(fp, "%-13.13s: ",local_legend[44]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_ordering_doctor_name.len)    ///// added on 06.12.2004
	  strcpy(rl_consultant_short_name.arr,rl_ordering_doctor_name.arr);

	fprintf(fp,"%-30.30s",rl_consultant_short_name.arr);
	
/////////////////  12.07.2004
	fprintf(fp,"%-8.8s"," ");
    get_nationality_desc();	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Nationality: ");
	fprintf(fp, "%-11.11s: ",local_legend[45]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	fprintf(fp, "%-15.15s\n", nd_nationality_desc.arr);
/////////////////

	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen No  : ");
	fprintf(fp, "%-13.13s: ",local_legend[16]);//added for globalisation
// 12.07.2004	fprintf(fp,"%c&k4S",ESC); 
// 12.07.2004  	fprintf(fp,"%c(s-3B",ESC);   

	if (d_interval_specimen_yn == 'Y')
	{
		strcpy(l_str, first_specimen_no.arr);
		strcat(l_str, " (I)");
	}
	else
	{
		strcpy(l_str, nd_spec_no.arr);
		strcat(l_str, "    ");
	}

	fprintf(fp, "%-19.19s                    ", l_str);

	fprintf(fp,"%c&k4S",ESC);  // 12.07.2004
  	fprintf(fp,"%c(s-3B",ESC); // 12.07.2004  

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Regd  Date: ");
	fprintf(fp, "%-10.10s: ",local_legend[46]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_regd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_regd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_regd_dat\
e_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_regd_date_time , 'D\
D/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )5351;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time.arr);
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time1.arr);//added for globalisation
	page_break(1);
	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen Type: ");
    fprintf(fp,"%-13.13s: ", local_legend[13]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp,"%-39.39s",rl_spc_specimen_desc.arr);
	

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Recd  Date: ");
    fprintf(fp,"%-10.10s: ", local_legend[47]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_recd_date_time.arr);
    fprintf(fp, "%-16.16s\n",rl_hdr_spec_recd_date_time1.arr); //added for globalisation
	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Category No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[48]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-4.4s/%-4.4s/%-15.15s              ", rl_category_code.arr, rl_category_year.arr,
								rl_category_number.arr);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Collt Date: ");
    fprintf(fp,"%-10.10s: ", local_legend[49]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time.arr);	
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time1.arr); //added for globalisation	
	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Clinical     : ");
    fprintf(fp,"%-13.13s: ", local_legend[50]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);
	   
	if (rl_hdr_request_comment_desc1.len)
    {
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc1.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s4B",ESC);
	 //fprintf(fp, "Comment        ");
     fprintf(fp,"%-15.15s", local_legend[51]); //added for globalisation
	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s-3B",ESC);

	if (rl_hdr_request_comment_desc2.len)
    {

      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc2.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

    
	if (rl_hdr_request_comment_desc3.len)
    {
	  fprintf(fp, "               ");
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc3.arr);
      page_break(1);
    }

/// 12.07.2004 added the below 
		if (strcmp(rl_ordered_facility_id.arr,nd_operating_facility_id.arr) != 0)
		{
		 get_ordered_company_name();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordering Facility ID: ");
		 fprintf(fp,"%-20.20s: ", local_legend[52]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",sy_ord_acc_entity_name.arr);
  		 page_break(1);
		}
///

	if (strcmp(rl_test_requested_yn.arr, "Y") == 0)
	{

		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordered Tests: ");
		 fprintf(fp,"%-13.13s: ", local_legend[53]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);
		
		strcpy(l_str, "");

		for (i=0;i < no_of_dtl_recs;i++)
		{
			d_inhibit_yn.arr[0]		= '\0';
			d_inhibit_yn.len		= 0;

			strcpy(inhibit_test_code.arr, rl_dtl_test_code[i].arr);
			inhibit_test_code.len = strlen(inhibit_test_code.arr);

			chk_inhibit_yn();

			if (d_inhibit_yn.arr[0]	== 'N') 
			{
				if (i == 0)
					sprintf(l_str,"%s", rl_dtl_test_code[i].arr);
				else
					sprintf(l_str,"%s,%s",l_str, rl_dtl_test_code[i].arr);
			}

//11.04.2005  if (i > 15) 

			if (i > 5) 
				break;
		}

		if(no_of_dtl_recs > 7)
		  sprintf(l_str,"%s...",l_str);

		fprintf(fp,"%s\n",l_str);
		page_break(1);
	}


	if(rl_hdr_episode_type.arr[0] == 'R')
	{
		if (strlen(rl_message_line.arr) > 0)
		{
			fprintf(fp, "%70.70s ", rl_message_line.arr);
			fprintf(fp, "%-15.15s\n", nd_hosp_no.arr);
			page_break(1);

		}
	}

    fprintf(fp,"%c&k4S",ESC); 
    fprintf(fp,"%c(s4B",ESC);
    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"%c&k4S",ESC); 
    fprintf(fp,"%c(s-3B",ESC);

	page_break(1);
	fprintf(fp, "\n");
    
}
/********************************************************************************************/
print_footer3(foot_ind)
int foot_ind;
{
   int fi = 0;
   char l_str[100];
   l_str[0] = '\0'; 

   for(fi=0; fi < 87; fi++)
       fprintf(fp,"%c",'_');

   fprintf(fp,"\n");

   fflush(fp);

   /*----------------------------------------*/
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s4B",ESC);
   //fprintf(fp,"Release Date : ");
   fprintf(fp,"%-13.13s : ", local_legend[20]); //added for globalisation
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s-3B",ESC);   
   //sprintf(l_str,"%s",rl_hdr_released_date.arr);
   sprintf(l_str,"%s",rl_hdr_released_date1.arr);//added for globalisation
   fprintf(fp,"%-25.25s",l_str);
   /*----------------------------------------*/

   /*----------------------------------------*/
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s4B",ESC);
   //fprintf(fp,"Released/Reviewed By : ");
   fprintf(fp,"%-21.21s : ", local_legend[21]); //added for globalisation
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s-3B",ESC);   
   fprintf(fp,"%-s\n",rl_hdr_released_by_id.arr);
   /*----------------------------------------*/

   /*----------------------------------------*/
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s4B",ESC);
   //fprintf(fp,"Reprint Date : ");
   fprintf(fp,"%-13.13s : ", local_legend[22]); //added for globalisation
   fprintf(fp,"%c&k4S",ESC); 
   fprintf(fp,"%c(s-3B",ESC);   
   /*----------------------------------------*/
   
   if (rl_prn_ctrl_hdr_rp_yn.arr[0] == 'Y')
       sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
   else
       sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
   fprintf(fp,"%s",nd_result_printed_date.arr);

   /*----------------------------------------*/

   if (rl_hdr_extra_copies_to.len && copy == 2 ) 
   {
      /*----------------------------------------*/
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s4B",ESC);
      //fprintf(fp,"Copy To : ");
	  fprintf(fp,"%-7.7s : ", local_legend[23]); //added for globalisation
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/

      sprintf(l_str,"%24.24s",rl_hdr_extra_copies_to.arr);
   }
   else
      sprintf(l_str,"%34.34s"," ");

   fprintf(fp,"%s\n",l_str);

   if(last_page == 0)
      //sprintf(l_str,"%-73.73s--CONTINUED--"," ");
      sprintf(l_str,"%-73.73s--%-9.9s--"," ",local_legend[24]); //added for globalisation
   else
      //sprintf(l_str,"%-73.73s      --END--"," ");
      sprintf(l_str,"%-73.73s --%-3.3s--"," ",local_legend[25]);// added for globalisation

   fprintf(fp,"%s\f",l_str);

   lctr = 0;
  
}
/*-----------------------------------------------------*/
print_footer2(foot_ind)
int foot_ind; 
{
   int fi = 0;
   char l_str[100];
   l_str[0] = '\0'; 

   for(fi=0; fi < 87; fi++)
       fprintf(fp,"%c",'_');

   fprintf(fp,"\n");
   
   fflush(fp);


      if (rl_name_on_report_yn.arr[0] == 'Y')
	  {

		get_print_name(first_user.arr);
	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(first_user.arr);

	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
//		fprintf(fp,"Released/Reviewed By : ");
		//fprintf(fp,"Released By : ");
		fprintf(fp,"%-13.13s : ", local_legend[61]); //added for globalisation 
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC);   
  	    sprintf(l_str,"%s", sy_user_name.arr);
	    fprintf(fp,"%-30.30s",l_str);
		fprintf(fp, "        ");
		/*----------------------------------------*/

	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
	   //fprintf(fp,"Released Date : ");
		fprintf(fp,"%-15.15s : ", local_legend[62]); //added for globalisation 
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);   
	   fprintf(fp,"%-s\n",footer_released_date);
	   /*----------------------------------------*/

	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;

	 }

	  get_print_name(rl_hdr_released_by_id.arr);

	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(rl_hdr_released_by_id.arr);

	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
		//fprintf(fp,"Reviewed By : ");
		fprintf(fp,"%-13.13s : ", local_legend[63]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC);   
  	    sprintf(l_str,"%s", sy_user_name.arr);
	    fprintf(fp,"%-30.30s",l_str);
		fprintf(fp, "        ");
	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
	   //fprintf(fp,"Reviewed Date : ");
	   fprintf(fp,"%-13.13s : ", local_legend[65]); //added for globalisation 
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);   
	   //fprintf(fp,"%-s\n",rl_hdr_released_date.arr);
	   fprintf(fp,"%-s\n",rl_hdr_released_date1.arr); //added for globalisation
	   /*----------------------------------------*/

   	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;


	  }


		/*----------------------------------------*/
		/***********************
	    fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp,"Reprint Date : ");
        fprintf(fp,"%c&k4S",ESC); 
        fprintf(fp,"%c(s-3B",ESC);   
		***********************/
		/*----------------------------------------*/
	/***********************
	   if (rl_prn_ctrl_hdr_rp_yn.arr[0] == 'Y')
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
	   else
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);

	   fprintf(fp,"%s",nd_result_printed_date.arr);
	***********************/

///////////////// 12.07.2004 'ss'
		if (p_param8.arr[0] == 'P')
		{
		  get_print_name(sy_user_id.arr);
		  if (print_name_yn.arr[0]	== 'Y')
		  {

			get_user_name(sy_user_id.arr);

		   /*----------------------------------------*/
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s4B",ESC);
			//fprintf(fp,"Reprinted By: ");
			fprintf(fp,"%-12.12s: ", local_legend[67]); //added for globalisation 
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s-3B",ESC);   
  			sprintf(l_str,"%s", sy_user_name.arr);
			fprintf(fp,"%-30.30s",l_str);
			fprintf(fp, "        ");
		   /*----------------------------------------*/	   
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s4B",ESC);
		   //fprintf(fp,"Reprinted Date: ");
			fprintf(fp,"%-14.14s: ", local_legend[68]); //added for globalisation 
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s-3B",ESC);   

			l_sy_req_date.arr[0]	= '\0';
			l_sy_req_date.len	= 0;

			/* EXEC SQL SELECT  to_char(to_date(:sy_req_date,'DDMMYYHH24MISS'),'DD/MM/YYYY HH24:MI')
				   INTO		:l_sy_req_date
				   FROM		DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select to_char(to_date(:b0,'DDMMYYHH24MISS'),'DD/MM/YYYY H\
H24:MI') into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )5378;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[0] = (unsigned int  )32;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
   sqlstm.sqhstl[1] = (unsigned int  )32;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			   if (OERROR);
			l_sy_req_date.arr[l_sy_req_date.len] = '\0';
	 /**** date conversion start for globalisation ************/
        /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:l_sy_req_date1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:l_sy_req_date1 :=sm_convert_datetime_2t(to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
        struct sqlexd sqlstm;
        sqlstm.sqlvsn = 10;
        sqlstm.arrsiz = 33;
        sqlstm.sqladtp = &sqladt;
        sqlstm.sqltdsp = &sqltds;
        sqlstm.stmt = "declare t_date date ; BEGIN :l_sy_req_date1 := sm_con\
vert_datetime_2t ( to_date ( :l_sy_req_date , 'DD/MM/YYYY HH24:MI' ) , :langua\
ge_id ) ; END ;";
        sqlstm.iters = (unsigned int  )1;
        sqlstm.offset = (unsigned int  )5401;
        sqlstm.cud = sqlcud0;
        sqlstm.sqlest = (unsigned char  *)&sqlca;
        sqlstm.sqlety = (unsigned short)256;
        sqlstm.occurs = (unsigned int  )0;
        sqlstm.sqhstv[0] = (         void  *)&l_sy_req_date1;
        sqlstm.sqhstl[0] = (unsigned int  )32;
        sqlstm.sqhsts[0] = (         int  )0;
        sqlstm.sqindv[0] = (         void  *)0;
        sqlstm.sqinds[0] = (         int  )0;
        sqlstm.sqharm[0] = (unsigned int  )0;
        sqlstm.sqadto[0] = (unsigned short )0;
        sqlstm.sqtdso[0] = (unsigned short )0;
        sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
        sqlstm.sqhstl[1] = (unsigned int  )32;
        sqlstm.sqhsts[1] = (         int  )0;
        sqlstm.sqindv[1] = (         void  *)0;
        sqlstm.sqinds[1] = (         int  )0;
        sqlstm.sqharm[1] = (unsigned int  )0;
        sqlstm.sqadto[1] = (unsigned short )0;
        sqlstm.sqtdso[1] = (unsigned short )0;
        sqlstm.sqhstv[2] = (         void  *)&language_id;
        sqlstm.sqhstl[2] = (unsigned int  )7;
        sqlstm.sqhsts[2] = (         int  )0;
        sqlstm.sqindv[2] = (         void  *)0;
        sqlstm.sqinds[2] = (         int  )0;
        sqlstm.sqharm[2] = (unsigned int  )0;
        sqlstm.sqadto[2] = (unsigned short )0;
        sqlstm.sqtdso[2] = (unsigned short )0;
        sqlstm.sqphsv = sqlstm.sqhstv;
        sqlstm.sqphsl = sqlstm.sqhstl;
        sqlstm.sqphss = sqlstm.sqhsts;
        sqlstm.sqpind = sqlstm.sqindv;
        sqlstm.sqpins = sqlstm.sqinds;
        sqlstm.sqparm = sqlstm.sqharm;
        sqlstm.sqparc = sqlstm.sqharc;
        sqlstm.sqpadto = sqlstm.sqadto;
        sqlstm.sqptdso = sqlstm.sqtdso;
        sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	 /**** date conversion end for globalisation ************/


		   fprintf(fp,"%-s\n",l_sy_req_date1.arr);
		   /*----------------------------------------*/

   	   		sy_user_name.arr[0]		= '\0';
			sy_user_name.len			= 0;

		  }

		}
////////////////
	  
	}

/****** FOOTER PRINTING FROM RL_SECTION_CTL  ****************/
   if ( (strlen(rl_footer_line_1.arr) > 0) ||
			(strlen(rl_footer_line_2.arr) > 0) )
   {
		if (strlen(rl_footer_line_1.arr) > 0) 
			fprintf(fp, "%-79.79s\n", rl_footer_line_1.arr);

		if (strlen(rl_footer_line_2.arr) > 0) 
			fprintf(fp, "%-79.79s\n", rl_footer_line_2.arr);
   }


   /*----------------------------------------*/

   if (rl_hdr_extra_copies_to.len && copy == 2  && 
		strcmp(draft_printing_yn.arr, "N") == 0)
   {
      /*----------------------------------------*/
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s4B",ESC);						   
      //fprintf(fp,"Copy To : ");
      fprintf(fp,"%-8.8s: ", local_legend[23]); //added for globalisation
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/

      sprintf(l_str,"%24.24s",rl_hdr_extra_copies_to.arr);
   }
   else
      sprintf(l_str,"%34.34s"," ");

   fprintf(fp,"%s\n",l_str);

   if(last_page == 0)
      //sprintf(l_str,"%-73.73s--CONTINUED--"," ");
      sprintf(l_str,"%-73.73s--%-9.9s--"," ",local_legend[24]); //added for globalisation
   else
      //sprintf(l_str,"%-73.73s      --END--"," ");   
      sprintf(l_str,"%-73.73s --%-3.3s--"," ",local_legend[25]);// added for globalisation

   fprintf(fp,"%s\f",l_str);   

   fprintf(fp,"%cE",ESC); // added on 21.10.2004 to reset the printer settings.
 
   lctr = 0; 
  
}

/*-----------------------------------------------------*/
build_cancelled_tests()
{

	/* EXEC SQL DECLARE cancelled_curs CURSOR FOR 
				SELECT DISTINCT specimen_no
				FROM RL_INTERVAL_TEST_TEMP
				WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND user_id = 'RLRRSENQ'
				AND session_id = 1; */ 

	   	    
	/* EXEC SQL OPEN cancelled_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0120;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5428;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	while(fetch_cancelled_curs())
	{
		
		declare_can_req_curs();
		while(fetch_can_req_curs())
		{

/************ In Rl_interval_test_temp table in column test code 
			  the system will put the cancel code				   *************/

			/* EXEC SQL INSERT INTO RL_INTERVAL_TEST_TEMP
							(OPERATING_FACILITY_ID,user_id, session_id, specimen_no, group_test_code, test_code)
					 VALUES
							(:nd_operating_facility_id,'RLRRSENQ', 2, 
							 TO_NUMBER(:can_spec_no), :can_group_test, 
							 :can_test_code); */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "insert into RL_INTERVAL_TEST_TEMP (OPERATING_FACILITY_ID,u\
ser_id,session_id,specimen_no,group_test_code,test_code) values (:b0,'RLRRSENQ\
',2,TO_NUMBER(:b1),:b2,:b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )5447;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )7;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&can_spec_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&can_group_test;
   sqlstm.sqhstl[2] = (unsigned int  )13;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&can_test_code;
   sqlstm.sqhstl[3] = (unsigned int  )13;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		}

		close_can_req_curs();
	}
	close_cancelled_curs();

}

/*------------------------------------------------------------*/
fetch_cancelled_curs()
{
	 can_spec_no.arr[0]		= '\0';
	 can_spec_no.len			= 0;

	/* EXEC SQL FETCH cancelled_curs 
				 INTO :can_spec_no; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5478;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&can_spec_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		if (OERROR)
			ins_message(ORA_MESG,"FETCH failed on cursor specimen_curs");

	 can_spec_no.arr[can_spec_no.len]		= '\0';
	
	return (LAST_ROW?0:1);
	 
}
/*------------------------------------------------------------*/
close_cancelled_curs()
{
	/* EXEC SQL CLOSE cancelled_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5497;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
declare_can_req_curs()
{

	/* EXEC SQL DECLARE can_req_curs CURSOR FOR 
				SELECT test_code, cancel_code
				FROM RL_REQUEST_DETAIL
				WHERE specimen_no = TO_NUMBER(:can_spec_no)
				AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND NVL(cancelled_yn, 'N') = 'Y'; */ 

	   	    
	/* EXEC SQL OPEN can_req_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0122;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5512;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&can_spec_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/*------------------------------------------------------------*/
close_can_req_curs()
{
	/* EXEC SQL CLOSE can_req_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5535;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
fetch_can_req_curs()
{
	
	can_test_code.arr[0]		= '\0';
	can_test_code.len			= 0;
    can_group_test.arr[0]		= '\0';
    can_group_test.len			= 0;

	/* EXEC SQL FETCH can_req_curs 
				 INTO	:can_group_test,
						:can_test_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5550;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&can_group_test;
 sqlstm.sqhstl[0] = (unsigned int  )13;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&can_test_code;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		if (OERROR)
			ins_message(ORA_MESG,"FETCH failed on cursor specimen_curs");

	 can_test_code.arr[can_test_code.len]		= '\0';
	 can_group_test.arr[can_group_test.len]		= '\0';
	
	return (LAST_ROW?0:1);
	 
}
/*------------------------------------------------------------*/
print_cancelled_tests()
{

   int ctr = 0;

/************ in test code the system will put the cancel code *************/
	/* EXEC SQL DECLARE prn_can_curs CURSOR FOR 
				SELECT TO_CHAR(specimen_no), group_test_code, test_code
				FROM RL_INTERVAL_TEST_TEMP
				WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
				AND user_id = 'RLRRSENQ'
				AND session_id = 2; */ 


	/* EXEC SQL OPEN prn_can_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0123;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5573;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	while(fetch_prn_can_curs())
	{

		if (ctr == 0)
		{

			fprintf(fp, "\n");
			page_break(1);

		    fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s4B",ESC);
			fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
			//fprintf(fp, "Cancelled Tests\n");  
		   	fprintf(fp, "%-15.15s\n", local_legend[69]); //added for globalisation
			fprintf(fp,"%c&d@",ESC);
			fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s-3B",ESC);
			
			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		    sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
			
			sprintf(in_str,"%-15.15s",local_legend[69]);
			print_html_line(in_str,out_str);			
			sprintf(l_html_bdy_str,"%s<td class=font_disp><b><u>%s</b></u></td></tr></table>",l_html_bdy_str,out_str);
			strcpy(out_str,"");
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");
						   
			page_break(1);
		}


		if (d_interval_specimen_yn == 'Y')
		{
			//fprintf(fp, "Specimen No : %-15.15s\n", can_spec_no.arr);
			fprintf(fp, "%-11.11s : %-15.15s\n", local_legend[16], can_spec_no.arr);

			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		    sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
			sprintf(in_str,"%-11.11s",local_legend[16]);
			print_html_line(in_str,out_str);			
			sprintf(l_html_bdy_str,"%s<td class=font_disp width=13%c>%s</td><td class=font_disp align=center width=3%c>:</td><td class=font_disp>%-15.15s</td></tr></table>",l_html_bdy_str,l_prtg,out_str,l_prtg,can_spec_no.arr);
			strcpy(out_str,"");
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

			page_break(1);
		}

		if (strlen(can_test_code.arr) > 0)
		{
			get_cancel_reason();
			get_test_desc();

		    if(test_desc_fill_for_report.len)   
			{
              /* EXEC SQL SELECT RPAD(:can_test_name,40,:test_desc_fill_for_report) 
					   INTO :can_test_name
					   FROM DUAL; */ 

{
              struct sqlexd sqlstm;
              sqlstm.sqlvsn = 10;
              sqlstm.arrsiz = 33;
              sqlstm.sqladtp = &sqladt;
              sqlstm.sqltdsp = &sqltds;
              sqlstm.stmt = "select RPAD(:b0,40,:b1) into :b0  from DUAL ";
              sqlstm.iters = (unsigned int  )1;
              sqlstm.offset = (unsigned int  )5592;
              sqlstm.selerr = (unsigned short)1;
              sqlstm.cud = sqlcud0;
              sqlstm.sqlest = (unsigned char  *)&sqlca;
              sqlstm.sqlety = (unsigned short)256;
              sqlstm.occurs = (unsigned int  )0;
              sqlstm.sqhstv[0] = (         void  *)&can_test_name;
              sqlstm.sqhstl[0] = (unsigned int  )43;
              sqlstm.sqhsts[0] = (         int  )0;
              sqlstm.sqindv[0] = (         void  *)0;
              sqlstm.sqinds[0] = (         int  )0;
              sqlstm.sqharm[0] = (unsigned int  )0;
              sqlstm.sqadto[0] = (unsigned short )0;
              sqlstm.sqtdso[0] = (unsigned short )0;
              sqlstm.sqhstv[1] = (         void  *)&test_desc_fill_for_report;
              sqlstm.sqhstl[1] = (unsigned int  )4;
              sqlstm.sqhsts[1] = (         int  )0;
              sqlstm.sqindv[1] = (         void  *)0;
              sqlstm.sqinds[1] = (         int  )0;
              sqlstm.sqharm[1] = (unsigned int  )0;
              sqlstm.sqadto[1] = (unsigned short )0;
              sqlstm.sqtdso[1] = (unsigned short )0;
              sqlstm.sqhstv[2] = (         void  *)&can_test_name;
              sqlstm.sqhstl[2] = (unsigned int  )43;
              sqlstm.sqhsts[2] = (         int  )0;
              sqlstm.sqindv[2] = (         void  *)0;
              sqlstm.sqinds[2] = (         int  )0;
              sqlstm.sqharm[2] = (unsigned int  )0;
              sqlstm.sqadto[2] = (unsigned short )0;
              sqlstm.sqtdso[2] = (unsigned short )0;
              sqlstm.sqphsv = sqlstm.sqhstv;
              sqlstm.sqphsl = sqlstm.sqhstl;
              sqlstm.sqphss = sqlstm.sqhsts;
              sqlstm.sqpind = sqlstm.sqindv;
              sqlstm.sqpins = sqlstm.sqinds;
              sqlstm.sqparm = sqlstm.sqharm;
              sqlstm.sqparc = sqlstm.sqharc;
              sqlstm.sqpadto = sqlstm.sqadto;
              sqlstm.sqptdso = sqlstm.sqtdso;
              sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	          can_test_name.arr[can_test_name.len] = '\0'; 
			  fprintf(fp, "%-40.40s %s\n", can_test_name.arr, cancel_reason.arr);
			  
			  sprintf(in_str,"%-40.40s %s", can_test_name.arr, cancel_reason.arr);
			  print_html_line(in_str,out_str);
			  sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
			  strcpy(out_str,"");
			}
			else
			{
     		  fprintf(fp, "%-40.40s %s\n", can_test_name.arr, cancel_reason.arr);
			  
			  sprintf(in_str,"%-40.40s %s", can_test_name.arr, cancel_reason.arr);
			  print_html_line(in_str,out_str);
			  sprintf(l_html_bdy_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
			  strcpy(out_str,"");
			}
			write_html(fp4,l_html_bdy_str);
			strcpy(l_html_bdy_str,"");

//			fprintf(fp, "%-10.10s  %-40s\n", can_group_test.arr, cancel_reason.arr);
			page_break(1);
		}

		ctr++;

	}

	close_prn_can_curs();

}

/*------------------------------------------------------------*/
fetch_prn_can_curs()
{
	 can_spec_no.arr[0]			= '\0';
	 can_spec_no.len			= 0;
	 can_group_test.arr[0]		= '\0';
	 can_group_test.len			= 0;
 	 can_test_code.arr[0]		= '\0';
	 can_test_code.len			= 0;

	/* EXEC SQL FETCH prn_can_curs
				 INTO :can_spec_no,
					  :can_group_test,
					  :can_test_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5619;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&can_spec_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&can_group_test;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&can_test_code;
 sqlstm.sqhstl[2] = (unsigned int  )13;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (OERROR)
			ins_message(ORA_MESG,"FETCH failed on cursor specimen_curs");

	 can_spec_no.arr[can_spec_no.len]			= '\0';
	 can_test_code.arr[can_test_code.len]		= '\0';
	 can_group_test.arr[can_group_test.len]		= '\0';
	 	
	return (LAST_ROW?0:1);
	 
}
/*------------------------------------------------------------*/
get_cancel_reason()
{
	cancel_reason.arr[0]		= '\0';
	cancel_reason.len			= 0;

	/* EXEC SQL SELECT long_desc
			 INTO :cancel_reason
		     FROM RL_CANCELLATION_CODE_LANG_VW
			 WHERE cancel_code = :can_test_code
			 AND LANGUAGE_ID = :language_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select long_desc into :b0  from RL_CANCELLATION_CODE_LANG_VW\
 where (cancel_code=:b1 and LANGUAGE_ID=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5646;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&cancel_reason;
 sqlstm.sqhstl[0] = (unsigned int  )43;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&can_test_code;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&language_id;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	if (NODATAFOUND);

	cancel_reason.arr[cancel_reason.len]	= '\0';

}
/*------------------------------------------------------------*/
close_prn_can_curs()
{
	/* EXEC SQL CLOSE prn_can_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5673;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
get_print_name(prn_user_id)
char prn_user_id[];
{
	
	strcpy(p_user_id.arr, prn_user_id);
	p_user_id.len = strlen(p_user_id.arr);

	print_name_yn.arr[0]		= '\0';
	print_name_yn.len			= 0;

	/* EXEC SQL SELECT NVL(name_on_report_yn, 'Y')
			 INTO :print_name_yn
			 FROM RL_USER_DEPT
			 WHERE OPERATING_FACILITY_ID = :nd_operating_facility_id
			 AND user_id = :p_user_id
			 AND section_code = :rl_hdr_section_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select NVL(name_on_report_yn,'Y') into :b0  from RL_USER_DEP\
T where ((OPERATING_FACILITY_ID=:b1 and user_id=:b2) and section_code=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5688;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&print_name_yn;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&p_user_id;
 sqlstm.sqhstl[2] = (unsigned int  )33;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&rl_hdr_section_code;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	print_name_yn.arr[print_name_yn.len]	= '\0';

}
/*------------------------------------------------------------*/
get_desc_snomed2()
{
    rl_snomed2_desc1.arr[0]          = '\0';
    rl_snomed2_desc2.arr[0]          = '\0';
    rl_snomed2_desc3.arr[0]          = '\0';
    rl_snomed2_desc4.arr[0]          = '\0';
    rl_snomed2_desc5.arr[0]          = '\0';
    rl_snomed2_print_yn.arr[0]       = '\0';
	rl_print_snomed2_code_yn.arr[0]	 = '\0';

    rl_snomed2_desc1.len             = 0;
    rl_snomed2_desc2.len             = 0;
    rl_snomed2_desc3.len             = 0;
    rl_snomed2_desc4.len             = 0;
    rl_snomed2_desc5.len             = 0;
    rl_snomed2_print_yn.len			 = 0;
	rl_print_snomed2_code_yn.arr[0]	 = '\0';

/************************** changed on 01/09/2002   
                     DESCRIPTION_2,
                     DESCRIPTION_3,
                     DESCRIPTION_4,
                     DESCRIPTION_5,

                   :rl_snomed2_desc2,
                   :rl_snomed2_desc3,
                   :rl_snomed2_desc4,
                   :rl_snomed2_desc5,

******************************************/

     /* EXEC SQL SELECT SUBSTR(DESCRIPTION_1, 1, 12),
					 NVL(PRINT_YN, 'N'),
					 NVL(print_code_yn, 'N')
	           INTO :rl_snomed2_desc1,
    			    :rl_snomed2_print_yn,
					:rl_print_snomed2_code_yn
             FROM RL_SNOMED_CODE_lang_vw
             WHERE SNOMED_CODE = :rl_res_snomed_code2
			 and language_id = :language_id; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 33;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select SUBSTR(DESCRIPTION_1,1,12) ,NVL(PRINT_YN,'N') ,NV\
L(print_code_yn,'N') into :b0,:b1,:b2  from RL_SNOMED_CODE_lang_vw where (SNOM\
ED_CODE=:b3 and language_id=:b4)";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )5719;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&rl_snomed2_desc1;
     sqlstm.sqhstl[0] = (unsigned int  )303;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&rl_snomed2_print_yn;
     sqlstm.sqhstl[1] = (unsigned int  )4;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&rl_print_snomed2_code_yn;
     sqlstm.sqhstl[2] = (unsigned int  )4;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqhstv[3] = (         void  *)&rl_res_snomed_code2;
     sqlstm.sqhstl[3] = (unsigned int  )23;
     sqlstm.sqhsts[3] = (         int  )0;
     sqlstm.sqindv[3] = (         void  *)0;
     sqlstm.sqinds[3] = (         int  )0;
     sqlstm.sqharm[3] = (unsigned int  )0;
     sqlstm.sqadto[3] = (unsigned short )0;
     sqlstm.sqtdso[3] = (unsigned short )0;
     sqlstm.sqhstv[4] = (         void  *)&language_id;
     sqlstm.sqhstl[4] = (unsigned int  )7;
     sqlstm.sqhsts[4] = (         int  )0;
     sqlstm.sqindv[4] = (         void  *)0;
     sqlstm.sqinds[4] = (         int  )0;
     sqlstm.sqharm[4] = (unsigned int  )0;
     sqlstm.sqadto[4] = (unsigned short )0;
     sqlstm.sqtdso[4] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    rl_snomed2_desc1.arr[rl_snomed2_desc1.len] = '\0';
    rl_snomed2_desc2.arr[rl_snomed2_desc2.len] = '\0';
    rl_snomed2_desc3.arr[rl_snomed2_desc3.len] = '\0';
    rl_snomed2_desc4.arr[rl_snomed2_desc4.len] = '\0';
    rl_snomed2_desc5.arr[rl_snomed2_desc5.len] = '\0';
    rl_snomed2_print_yn.arr[rl_snomed2_print_yn.len] = '\0';
	rl_print_snomed2_code_yn.arr[rl_print_snomed2_code_yn.len]	= '\0';

}
/*------------------------------------------------------------*/
print_line_snomed1(char *t_str)
{
         fprintf(fp,"%-18.18s",t_str);

		 sprintf(in_str,"%-18.18s",t_str);
		 print_html_line(in_str,out_str);		 
		 sprintf(l_html_bdy_str,"%s<td class=font_disp width=19%c>%s</td>",l_html_bdy_str,l_prtg,out_str);
		 strcpy(out_str,"");
}
/*------------------------------------------------------------*/
print_line_snomed2(char *t_str)
{
         fprintf(fp,"%-18.18s",t_str);

		 sprintf(in_str,"%-18.18s",t_str);
		 print_html_line(in_str,out_str);
		 sprintf(l_html_bdy_str,"%s<td class=font_disp width=19%c>%s</td>",l_html_bdy_str,l_prtg,out_str);
		 strcpy(out_str,"");
}
/*------------------------------------------------------------*/
add_zero_after_result()
{
	int i = 0;
	char rslt[21];
	int l_decimal_position = 0;

	strcpy(rslt, r_rslt.arr);

//	if (atoi(r_rslt.arr) > 1 || atoi(r_rslt.arr) == 1)
//	{

		v_numeric_result.arr[0]		= '\0';
		v_numeric_result.len		= 0;

		l_exist_decimals = 0;
		l_inst_decimals = 0;
		
		/* EXEC SQL SELECT TO_NUMBER(:r_rslt) - FLOOR(TO_NUMBER(:r_rslt)),
						LENGTH(SUBSTR(:r_rslt, INSTR(:r_rslt, '.') + 1)), INSTR(:r_rslt, '.')
				 INTO :v_numeric_result, :l_exist_decimals, :l_inst_decimals
				 FROM DUAL; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select (TO_NUMBER(:b0)-FLOOR(TO_NUMBER(:b0))) ,LENGTH(SUBST\
R(:b0,(INSTR(:b0,'.')+1))) ,INSTR(:b0,'.') into :b5,:b6,:b7  from DUAL ";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5754;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&r_rslt;
  sqlstm.sqhstl[0] = (unsigned int  )22;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&r_rslt;
  sqlstm.sqhstl[1] = (unsigned int  )22;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&r_rslt;
  sqlstm.sqhstl[2] = (unsigned int  )22;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&r_rslt;
  sqlstm.sqhstl[3] = (unsigned int  )22;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&r_rslt;
  sqlstm.sqhstl[4] = (unsigned int  )22;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&v_numeric_result;
  sqlstm.sqhstl[5] = (unsigned int  )23;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&l_exist_decimals;
  sqlstm.sqhstl[6] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&l_inst_decimals;
  sqlstm.sqhstl[7] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	
		v_numeric_result.arr[v_numeric_result.len]	= '\0';

		if (l_inst_decimals == 0)
			l_exist_decimals = 0;

		l_decimal_position = l_exist_decimals;


//		if (strcmp(v_numeric_result.arr, "0") == 0)
//		{

			for (i = l_exist_decimals;i < rl_tst_cd_no_of_decimals; i++)
			{

/**************  
			if (strcmp(rslt, "4.65") == 0)  
			{
				sprintf(string_var, "RESULT  %d  %d  %s", l_exist_decimals, rl_tst_cd_no_of_decimals,
											r_rslt.arr);
				disp_message(ERR_MESG, string_var);
			}
****************/ 

				 
				if (l_decimal_position == 0)
					strcat(r_rslt.arr, ".");				
	
				strcat(r_rslt.arr, "0");

				l_decimal_position++;

			}
	
			r_rslt.len = strlen(r_rslt.arr);
//		}
/*		else
		{

			strcpy(r_rslt.arr, rslt);
			r_rslt.len = strlen(r_rslt.arr);

		}
*/



//	}

	
	for (i = 0; i < 10; i++)
	{
		rslt[i] = r_rslt.arr[i];
	}

	rslt[i] = '\0';

	strcpy(r_rslt.arr, rslt);
	r_rslt.len = strlen(r_rslt.arr);

}
/*------------------------------------------------------------*/
print_str(char l_mode)
{

	if ( rl_snomed_print_yn.arr[0]	== 'Y' || rl_snomed2_print_yn.arr[0]	== 'Y' ||
		rl_print_snomed_code_yn.arr[0] == 'Y' || rl_print_snomed2_code_yn.arr[0] == 'Y' )
	{

		something_to_print = 1;
		something_to_print_for_test = 1;

		//fprintf(fp, "SNOMED : ");
		fprintf(fp, "%-6.6s : ", local_legend[70]);  //added for globalisation

	    sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	    sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);

		sprintf(in_str,"%-6.6s",local_legend[70]);
		print_html_line(in_str,out_str);
		sprintf(l_html_bdy_str,"%s<td class=font_disp width=6%c>%s</td><td class=font_disp align=center width=3%c>:</td>",l_html_bdy_str,l_prtg,out_str,l_prtg);
		strcpy(out_str,"");

        l_snomed_head_printed = 1;

		if (rl_print_snomed_code_yn.arr[0] == 'Y' )
		{
			print_line_snomed2(rl_res_snomed_code.arr);
		}
		else
			print_line_snomed2(" ");
	
		fprintf(fp, " | ");

		sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg); 

		if (rl_print_snomed2_code_yn.arr[0] == 'Y' && 
				strlen(rl_res_snomed_code2.arr) > 0 )
		{
			print_line_snomed2(rl_res_snomed_code2.arr);
		}
		else
		{
			print_line_snomed2(" ");
		}


	}
	
}
/*------------------------------------------------------------*/
print_snomed_codes(char l_mode)
{
	
	sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);	

	if (l_mode == 'Y')
	{
		//fprintf(fp, "SNOMED : ");
		fprintf(fp, "%-6.6s : ", local_legend[70]);  //added for globalisation

		sprintf(in_str,"%-6.6s",local_legend[70]);
		print_html_line(in_str,out_str);
		sprintf(l_html_bdy_str,"%s<td class=font_disp width=6%c>%s</td><td class=font_disp align=center width=3%c>:</td>",l_html_bdy_str,l_prtg,out_str,l_prtg);
		strcpy(out_str,"");
	}
	else
	{
		fprint_repeat(fp, ' ', 9);

		sprintf(l_html_bdy_str,"%s<td class=font_disp width=9%c>&nbsp;</td>",l_html_bdy_str,l_prtg);
	}

	if (strlen(rl_res_snomed_code2.arr) > 0 )
	{
		print_line_snomed2(rl_res_snomed_code.arr);
	}
	else
	{
		print_line_snomed1(rl_res_snomed_code.arr);
	}

	fprintf(fp, " | ");

	sprintf(l_html_bdy_str,"%s<td class=font_disp align=center width=3%c>|</td>",l_html_bdy_str,l_prtg);

	print_line_snomed2(rl_res_snomed_code2.arr);
    
}
/*------------------------------------------------------------*/
 patient_age()
 {

		 float  lone = 0;
		 float  num1 = 0, yrs = 0, 
				tmp_mths = 0, 
				tmp_days = 0;

		 char st_r[50];

	tday.arr[0] = '\0';
	tday.len = 0;

	mths.arr[0]  = '\0';
	mths.len  = 0;

	
	/* EXEC SQL SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY') INTO :tday
            FROM DUAL; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select TO_CHAR(SYSDATE,'DD/MM/YYYY') into :b0  from DUAL ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5801;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&tday;
 sqlstm.sqhstl[0] = (unsigned int  )32;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

                                        

    /* EXEC SQL SELECT ABS(MONTHS_BETWEEN(
		TO_DATE(:rl_regd_date,'DD/MM/YYYY'), 
		TO_DATE(:rl_pat_date_of_birth, 'DD/MM/YYYY')))
			INTO :mt FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ABS(MONTHS_BETWEEN(TO_DATE(:b0,'DD/MM/YYYY'),TO_DA\
TE(:b1,'DD/MM/YYYY'))) into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )5820;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_regd_date;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_pat_date_of_birth;
    sqlstm.sqhstl[1] = (unsigned int  )18;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&mt;
    sqlstm.sqhstl[2] = (unsigned int  )sizeof(float);
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			sprintf(mths.arr,"%f",mt);
			strcpy(mths1.arr, mths.arr);

        	tday.arr[tday.len] = '\0';
							
			lone = atoi(strtok(mths1.arr, ".")) ;

		   if (lone > 0) 
		   {
			  num1 = lone/12 ;
			  sprintf(t_age.arr, "%f", num1);
			  yrs = atoi(strtok(t_age.arr, ".")) ;
		   }
		   else
			  yrs = 0;
            
			tmp_mths   = atoi(mths1.arr) - (yrs * 12) ;
			sprintf(t_age.arr, "%f", tmp_mths);
			tmp_mths   = atoi(strtok(t_age.arr, "."));

			if ((tmp_mths == 0)  && (yrs ==0))
			{

				/* EXEC SQL SELECT TO_CHAR(ROUND((TO_DATE(:rl_regd_date,'DD/MM/YYYY') -
					TO_DATE(:rl_pat_date_of_birth, 'DD/MM/YYYY')),3))
					INTO :t_days FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_CHAR(ROUND((TO_DATE(:b0,'DD/MM/YYYY')-TO_DATE(:\
b1,'DD/MM/YYYY')),3)) into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )5847;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_regd_date;
    sqlstm.sqhstl[0] = (unsigned int  )13;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_pat_date_of_birth;
    sqlstm.sqhstl[1] = (unsigned int  )18;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&t_days;
    sqlstm.sqhstl[2] = (unsigned int  )32;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					tmp_days = atoi(strtok(t_days.arr,"."));
			}
			else
				tmp_days = (atof(mths.arr) - atoi(mths1.arr)) * 31 ;


			sprintf(st_r, "%f", yrs);
			strcpy(t_age.arr, strtok(st_r, "."));
			//strcat(t_age.arr, "Y");
			strncat(t_age.arr, local_legend[72],1);
			if(strcmp(rl_report_format.arr, "6") != 0)   /// condition added on 11.07.2007 for ARTEMIS
			{
				sprintf(st_r, " %f", tmp_mths);
				strcat(t_age.arr, strtok(st_r, "."));
				//strcat(t_age.arr, "M");
				strncat(t_age.arr, local_legend[73],1);
				sprintf(st_r, " %f", tmp_days);
				strcat(t_age.arr, strtok(st_r, "."));
				//strcat(t_age.arr, "D ");
				strncat(t_age.arr, local_legend[74],1);
			}
				
 }
/*------------------------------------------------------------*/
get_test_desc()
{
	can_test_name.arr[0]	= '\0';
	can_test_name.len		= 0;
	
	/* EXEC SQL SELECT long_desc
			 INTO :can_test_name
			 FROM RL_TEST_CODE_LANG_VW
			 WHERE test_code = :can_group_test
			 AND LANGUAGE_ID = :language_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select long_desc into :b0  from RL_TEST_CODE_LANG_VW where (\
test_code=:b1 and LANGUAGE_ID=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5874;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&can_test_name;
 sqlstm.sqhstl[0] = (unsigned int  )43;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&can_group_test;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&language_id;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	
	can_test_name.arr[can_test_name.len]	= '\0';

	if (NODATAFOUND);


}
/*------------------------------------------------------------*/
get_user_name(char *y_user)
{
	
	strcpy(sy_user.arr, y_user);
	sy_user.len = strlen(sy_user.arr); 
	
	sy_user_name.arr[0]		= '\0';
	sy_user_name.len			= 0;

	sy_func_role_id.arr[0]  = '\0';
	sy_func_role_id.len     = 0;
	
	if (strcmp(BVNewVersionYN.arr,"Y") == 0)
	{
		/* EXEC SQL SELECT username,func_role_id 
				 INTO :sy_user_name,:sy_func_role_id
				 FROM SY_USER
				 WHERE FACILITY_ID = :nd_operating_facility_id
				   AND user_id = :sy_user; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select username ,func_role_id into :b0,:b1  from SY_USER wh\
ere (FACILITY_ID=:b2 and user_id=:b3)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5901;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&sy_user_name;
  sqlstm.sqhstl[0] = (unsigned int  )62;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&sy_func_role_id;
  sqlstm.sqhstl[1] = (unsigned int  )23;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[2] = (unsigned int  )7;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&sy_user;
  sqlstm.sqhstl[3] = (unsigned int  )33;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


     }
	 else
	 {
		/* EXEC SQL SELECT username
				 INTO :sy_user_name
				 FROM SY_USER
				 WHERE FACILITY_ID = :nd_operating_facility_id
				   AND user_id = :sy_user; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select username into :b0  from SY_USER where (FACILITY_ID=:\
b1 and user_id=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5932;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&sy_user_name;
  sqlstm.sqhstl[0] = (unsigned int  )62;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )7;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&sy_user;
  sqlstm.sqhstl[2] = (unsigned int  )33;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	 }

	sy_user_name.arr[sy_user_name.len]		= '\0';
	sy_func_role_id.arr[sy_func_role_id.len] = '\0';

	if (NODATAFOUND);
	if (OERROR);

}
/*------------------------------------------------------------*/
fetch_sy_urgent()
{

	/* EXEC SQL DECLARE urgent_curs CURSOR FOR
		 SELECT OPERATING_FACILITY_ID,
			    SESSION_ID,
				USER_ID,
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'),
				MACHINE_NAME,
				WS_NO,
				ROWID,
				PRINT_SERVER_ID,
				PRINTER_NAME,
				DEST_QUEUE_NAME,
				FAX_ID,
				MAIL_ID
	       FROM	SY_REPORT_GENERATE_REQUEST
	      WHERE	OPERATING_FACILITY_ID = DECODE(:nd_facility_id,'*A',OPERATING_FACILITY_ID,
         										                   :nd_facility_id)
		    AND PGM_ID = 'RLRRSENQ'
			AND REQUEST_STATUS IS NULL
			AND NVL(URGENT_INDICATOR,' ') = 'U'; */ 


	/* EXEC SQL OPEN urgent_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0135;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5959;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



sy_user_id.arr[0] 		= '\0';
sy_session_id.arr[0] 	= '\0';
sy_req_date.arr[0]      = '\0';
sy_machine_name.arr[0]  = '\0';
sy_ws_no.arr[0]		    = '\0';
sy_rowid.arr[0]		    = '\0';
nd_operating_facility_id.arr[0]		    = '\0';

p_print_id.arr[0]   = '\0';
p_printer_name.arr[0] = '\0';
p_dest_queue_name.arr[0] = '\0';
p_fax_address.arr[0]      = '\0';     
p_mail_address.arr[0]     = '\0';    


sy_session_id.len	     = 0;
sy_user_id.len	         = 0;
sy_req_date.len          = 0;
sy_machine_name.len      = 0;
sy_ws_no.len             = 0;
sy_rowid.len             = 0;
nd_operating_facility_id.len = 0;

p_print_id.len = 0;
p_printer_name.len = 0;   
p_dest_queue_name.len = 0;
p_fax_address.len      = 0;
p_mail_address.len     = 0;

	/* EXEC SQL FETCH urgent_curs 
	       INTO	:nd_operating_facility_id,
                :sy_session_id,
                :sy_user_id,
                :sy_req_date,
				:sy_machine_name,
				:sy_ws_no,
				:sy_rowid,
				:p_print_id,
				:p_printer_name,
				:p_dest_queue_name,
				:p_fax_address,       
				:p_mail_address; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5982;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sy_session_id;
 sqlstm.sqhstl[1] = (unsigned int  )32;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&sy_user_id;
 sqlstm.sqhstl[2] = (unsigned int  )33;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&sy_req_date;
 sqlstm.sqhstl[3] = (unsigned int  )32;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&sy_machine_name;
 sqlstm.sqhstl[4] = (unsigned int  )33;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&sy_ws_no;
 sqlstm.sqhstl[5] = (unsigned int  )33;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&sy_rowid;
 sqlstm.sqhstl[6] = (unsigned int  )33;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_print_id;
 sqlstm.sqhstl[7] = (unsigned int  )32;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_printer_name;
 sqlstm.sqhstl[8] = (unsigned int  )102;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&p_dest_queue_name;
 sqlstm.sqhstl[9] = (unsigned int  )102;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&p_fax_address;
 sqlstm.sqhstl[10] = (unsigned int  )102;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&p_mail_address;
 sqlstm.sqhstl[11] = (unsigned int  )102;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      sy_user_id.arr[sy_user_id.len] = '\0';
      sy_session_id.arr[sy_session_id.len] = '\0';
      sy_rowid.arr[sy_rowid.len] = '\0';
      sy_req_date.arr[sy_req_date.len] = '\0';
	  sy_machine_name.arr[sy_machine_name.len] = '\0';
	  sy_ws_no.arr[sy_ws_no.len] = '\0';
	  sy_rowid.arr[sy_rowid.len] = '\0';
	  nd_operating_facility_id.arr[nd_operating_facility_id.len] = '\0';

	  p_print_id.arr[p_print_id.len] = '\0';
	  p_printer_name.arr[p_printer_name.len] = '\0';
	  p_dest_queue_name.arr[p_dest_queue_name.len] = '\0';
	  p_fax_address.arr[p_fax_address.len]           = '\0';     
	  p_mail_address.arr[p_mail_address.len]         = '\0';    

    return (LAST_ROW?0:1);

}
/*------------------------------------------------------------*/
fetch_sy_stat()
{

	/* EXEC SQL DECLARE stat_curs CURSOR FOR
		 SELECT OPERATING_FACILITY_ID,
			    SESSION_ID,
				USER_ID,
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'),
				MACHINE_NAME,
				WS_NO,
				ROWID,
				PRINT_SERVER_ID,
				PRINTER_NAME,
				DEST_QUEUE_NAME,
				FAX_ID,
				MAIL_ID
	       FROM	SY_REPORT_GENERATE_REQUEST
	      WHERE	OPERATING_FACILITY_ID = DECODE(:nd_facility_id,'*A',OPERATING_FACILITY_ID,
         										                   :nd_facility_id)
		    AND PGM_ID = 'RLRRSENQ'
			AND REQUEST_STATUS IS NULL
			AND NVL(URGENT_INDICATOR,' ') = 'S'; */ 


	/* EXEC SQL OPEN stat_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0136;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6045;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



sy_user_id.arr[0] 		= '\0';
sy_session_id.arr[0] 	= '\0';
sy_req_date.arr[0]      = '\0';
sy_machine_name.arr[0]  = '\0';
sy_ws_no.arr[0]		    = '\0';
sy_rowid.arr[0]		    = '\0';
nd_operating_facility_id.arr[0]		    = '\0';

p_print_id.arr[0]   = '\0';
p_printer_name.arr[0] = '\0';
p_dest_queue_name.arr[0] = '\0';
p_fax_address.arr[0]      = '\0';     
p_mail_address.arr[0]     = '\0';    

sy_session_id.len	    = 0;
sy_user_id.len	        = 0;
sy_req_date.len         = 0;
sy_machine_name.len     = 0;
sy_ws_no.len            = 0;
sy_rowid.len            = 0;
nd_operating_facility_id.len = 0;

p_print_id.len = 0;
p_printer_name.len = 0;   
p_dest_queue_name.len = 0;
p_fax_address.len      = 0;
p_mail_address.len     = 0;

	/* EXEC SQL FETCH stat_curs 
	       INTO	:nd_operating_facility_id,
                :sy_session_id,
                :sy_user_id,
                :sy_req_date,
				:sy_machine_name,
				:sy_ws_no,
				:sy_rowid,
				:p_print_id,
				:p_printer_name,
				:p_dest_queue_name,
				:p_fax_address,       
				:p_mail_address; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6068;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sy_session_id;
 sqlstm.sqhstl[1] = (unsigned int  )32;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&sy_user_id;
 sqlstm.sqhstl[2] = (unsigned int  )33;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&sy_req_date;
 sqlstm.sqhstl[3] = (unsigned int  )32;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&sy_machine_name;
 sqlstm.sqhstl[4] = (unsigned int  )33;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&sy_ws_no;
 sqlstm.sqhstl[5] = (unsigned int  )33;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&sy_rowid;
 sqlstm.sqhstl[6] = (unsigned int  )33;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_print_id;
 sqlstm.sqhstl[7] = (unsigned int  )32;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_printer_name;
 sqlstm.sqhstl[8] = (unsigned int  )102;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&p_dest_queue_name;
 sqlstm.sqhstl[9] = (unsigned int  )102;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&p_fax_address;
 sqlstm.sqhstl[10] = (unsigned int  )102;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&p_mail_address;
 sqlstm.sqhstl[11] = (unsigned int  )102;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
			
      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      sy_user_id.arr[sy_user_id.len] = '\0';
      sy_session_id.arr[sy_session_id.len] = '\0';
      sy_rowid.arr[sy_rowid.len] = '\0';
      sy_req_date.arr[sy_req_date.len] = '\0';
	  sy_machine_name.arr[sy_machine_name.len] = '\0';
	  sy_ws_no.arr[sy_ws_no.len] = '\0';
	  sy_rowid.arr[sy_rowid.len] = '\0';
	  nd_operating_facility_id.arr[nd_operating_facility_id.len] = '\0';

	  p_print_id.arr[p_print_id.len] = '\0';
	  p_printer_name.arr[p_printer_name.len] = '\0';
	  p_dest_queue_name.arr[p_dest_queue_name.len] = '\0';
	  p_fax_address.arr[p_fax_address.len]           = '\0';     
	  p_mail_address.arr[p_mail_address.len]         = '\0';    

    return (LAST_ROW?0:1); 

}
/*------------------------------------------------------------*/
fetch_sy_routine()
{
	/* EXEC SQL DECLARE routine_curs CURSOR FOR
		 SELECT OPERATING_FACILITY_ID,
			    SESSION_ID,
				USER_ID,
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'),
				MACHINE_NAME,
				WS_NO,
				ROWID,
				PRINT_SERVER_ID,
				PRINTER_NAME,
				DEST_QUEUE_NAME,
				FAX_ID,
				MAIL_ID
	       FROM	SY_REPORT_GENERATE_REQUEST
	      WHERE	OPERATING_FACILITY_ID = DECODE(:nd_facility_id,'*A',OPERATING_FACILITY_ID,
         										                   :nd_facility_id)
		    AND PGM_ID = 'RLRRSENQ'
			AND REQUEST_STATUS IS NULL
			AND NVL(URGENT_INDICATOR,' ') = 'R'; */ 


	/* EXEC SQL OPEN routine_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0137;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6131;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



sy_user_id.arr[0] 		= '\0';
sy_session_id.arr[0] 	= '\0';
sy_req_date.arr[0]      = '\0';
sy_machine_name.arr[0]  = '\0';
sy_ws_no.arr[0]		    = '\0';
sy_rowid.arr[0]		    = '\0';
nd_operating_facility_id.arr[0]		    = '\0';

p_print_id.arr[0]   = '\0';
p_printer_name.arr[0] = '\0';
p_dest_queue_name.arr[0] = '\0';
p_fax_address.arr[0]      = '\0';     
p_mail_address.arr[0]     = '\0';    

sy_session_id.len	    = 0;
sy_user_id.len	        = 0;
sy_req_date.len         = 0;
sy_machine_name.len     = 0;
sy_ws_no.len            = 0;
sy_rowid.len            = 0;
nd_operating_facility_id.len = 0;

p_print_id.len = 0;
p_printer_name.len = 0;   
p_dest_queue_name.len = 0;
p_fax_address.len      = 0;
p_mail_address.len     = 0;

	/* EXEC SQL FETCH routine_curs 
	       INTO	:nd_operating_facility_id,
                :sy_session_id,
                :sy_user_id,
                :sy_req_date,
				:sy_machine_name,
				:sy_ws_no,
				:sy_rowid,
				:p_print_id,
				:p_printer_name,
				:p_dest_queue_name,
				:p_fax_address,       
				:p_mail_address; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6154;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sy_session_id;
 sqlstm.sqhstl[1] = (unsigned int  )32;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&sy_user_id;
 sqlstm.sqhstl[2] = (unsigned int  )33;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&sy_req_date;
 sqlstm.sqhstl[3] = (unsigned int  )32;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&sy_machine_name;
 sqlstm.sqhstl[4] = (unsigned int  )33;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&sy_ws_no;
 sqlstm.sqhstl[5] = (unsigned int  )33;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&sy_rowid;
 sqlstm.sqhstl[6] = (unsigned int  )33;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_print_id;
 sqlstm.sqhstl[7] = (unsigned int  )32;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_printer_name;
 sqlstm.sqhstl[8] = (unsigned int  )102;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&p_dest_queue_name;
 sqlstm.sqhstl[9] = (unsigned int  )102;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&p_fax_address;
 sqlstm.sqhstl[10] = (unsigned int  )102;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&p_mail_address;
 sqlstm.sqhstl[11] = (unsigned int  )102;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


							
			
      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      sy_user_id.arr[sy_user_id.len] = '\0';
      sy_session_id.arr[sy_session_id.len] = '\0';
      sy_rowid.arr[sy_rowid.len] = '\0';
      sy_req_date.arr[sy_req_date.len] = '\0';
	  sy_machine_name.arr[sy_machine_name.len] = '\0';
	  sy_ws_no.arr[sy_ws_no.len] = '\0';
	  sy_rowid.arr[sy_rowid.len] = '\0';
	  nd_operating_facility_id.arr[nd_operating_facility_id.len] = '\0';

	  p_print_id.arr[p_print_id.len] = '\0';
	  p_printer_name.arr[p_printer_name.len] = '\0';
	  p_dest_queue_name.arr[p_dest_queue_name.len] = '\0';
	  p_fax_address.arr[p_fax_address.len]           = '\0';     
	  p_mail_address.arr[p_mail_address.len]         = '\0';    

    return (LAST_ROW?0:1);

}
/*------------------------------------------------------------*/
close_urgent_curs()
{
	/* EXEC SQL CLOSE urgent_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6217;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/*------------------------------------------------------------*/
close_stat_curs()
{
	/* EXEC SQL CLOSE stat_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6232;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/*------------------------------------------------------------*/
close_routine_curs()
{
	/* EXEC SQL CLOSE routine_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6247;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




}
/**************************select transaction based or not ***************/
get_trans_ind()
{
	
	nd_trx_ind.arr[0]		= '\0';
	nd_trx_ind.len		= 0;

	/* EXEC SQL  SELECT NVL(TRANSACTION_BASED_YN, 'N')
	          INTO   :nd_trx_ind
	          FROM   sy_online_print_id
              WHERE  ONLINE_PRINT_NAME = 'RLRRSENQ'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select NVL(TRANSACTION_BASED_YN,'N') into :b0  from sy_onlin\
e_print_id where ONLINE_PRINT_NAME='RLRRSENQ'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6262;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_trx_ind;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if(OERROR)
	{
	    ins_message(ORA_MESG,"SELECT failed on  SY_ON_LINE_PRINT_ID");
	}

	nd_trx_ind.arr[nd_trx_ind.len]			= '\0';


    if(NODATAFOUND)
		return 0;

		
	return 1;

}
/*------------------------------------------------------------*/
declare_param_curs()
{

	/* EXEC SQL DECLARE param_curs CURSOR FOR
			 SELECT	OPERATING_FACILITY_ID,
			    PARAM1,
			    PARAM2,
			    PARAM3,
			    PARAM4,
			    PARAM5,
				NVL(PARAM6,'N'),
				PARAM7,
				PARAM8,
				NVL(PARAM9,'PRINT'),
				NVL(PARAM10, 'N'),
				NVL(PARAM11, 'N'),
				NVL(PARAM12, 'N'),
				NVL(PARAM13, 'N'),
		///		PARAM14,
				PARAM15,
				PARAM16,
		///		PARAM17, 
		///		PARAM18,
				PARAM19,  
				PARAM20,
				PARAM21,
		///		PARAM22,
		///		PARAM23,
				rowid,
				pgm_date
			FROM SY_PROG_PARAM
			WHERE OPERATING_FACILITY_ID = DECODE(:nd_facility_id,'*A',OPERATING_FACILITY_ID,
         										                   :nd_facility_id)
			AND pgm_id = 'Rlrsenq4'
			AND session_id = TO_NUMBER(:c_session_id)
            AND param4 = :c_user_id
			ORDER BY param9, TO_DATE(param10, 'DD/MM/YYYY HH24:MI:SS'); */ 



	/* EXEC SQL OPEN param_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0139;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6281;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&c_session_id;
 sqlstm.sqhstl[2] = (unsigned int  )52;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&c_user_id;
 sqlstm.sqhstl[3] = (unsigned int  )52;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




      if(OERROR)
         ins_message(ORA_MESG,"Error in opening cursor param_curs");

}

/*------------------------------------------------------------*/
fetch_param_curs()
{

	rl_prn_ctrl_hdr_pat_no.arr[0] 		= '\0';
	rl_prn_ctrl_hdr_sp_no.arr[0] 		= '\0';
	rl_prn_ctrl_hdr_source_code.arr[0] 	= '\0';
	rl_prn_ctrl_hdr_user.arr[0] 		= '\0';
	rl_prn_ctrl_hdr_section_code.arr[0] = '\0';
	rl_prn_ctrl_hdr_rp_yn.arr[0]		= '\0';
	p_param7.arr[0]						= '\0';
	p_param8.arr[0]						= '\0';
	p_param9.arr[0]						= '\0';   //// 09.12.2004
	p_param10.arr[0]					= '\0';
	p_param11.arr[0]					= '\0';

	p_param12.arr[0]					= '\0';  
	p_param13.arr[0]					= '\0';  
	p_fax_id.arr[0]						= '\0';  
	p_mail_id.arr[0]					= '\0';  
///	p_print_id.arr[0]					= '\0';

///	p_printer_name.arr[0]				= '\0';
///	p_dest_queue_name.arr[0]			= '\0';  //// 21.08.2005

	p_fax_to_rcpt_name.arr[0] = '\0';
	p_fax_to_comp_name.arr[0] = '\0';
	p_fax_to_phone_no.arr[0]  = '\0'; 
///	p_fax_address.arr[0]      = '\0';     
///	p_mail_address.arr[0]     = '\0';    

	nd_rowid.arr[0]						= '\0';
	c_pgm_date.arr[0]					= '\0';
	nd_operating_facility_id.arr[0]		= '\0';

	rl_prn_ctrl_hdr_pat_no.len 	        = 0;
	rl_prn_ctrl_hdr_source_code.len     = 0;
	rl_prn_ctrl_hdr_sp_no.len 	        = 0;
	rl_prn_ctrl_hdr_section_code.len    = 0;
	rl_prn_ctrl_hdr_user.len	        = 0;
	rl_prn_ctrl_hdr_rp_yn.len			= 0;
	p_param7.len						= 0;
	p_param8.len						= 0;
	p_param9.len						= 0;  //// 09.12.2004
	p_param10.len						= 0;
	p_param11.len						= 0;

	p_param12.len						= 0;  /// 07.08.2005
	p_param13.len						= 0;  /// 16.01.2006
	p_fax_id.len						= 0;
	p_mail_id.len						= 0;
///	p_print_id.len						= 0;

///	p_printer_name.len					= 0;
///	p_dest_queue_name.len				= 0;

	p_fax_to_rcpt_name.len = 0;
	p_fax_to_comp_name.len = 0;
	p_fax_to_phone_no.len  = 0;
///	p_fax_address.len      = 0;
///	p_mail_address.len     = 0;

	nd_rowid.len						= 0;
	c_pgm_date.len						= 0;
	nd_operating_facility_id.len		= 0;


	/* EXEC SQL FETCH param_curs 
	       INTO	:nd_operating_facility_id,
			    :rl_prn_ctrl_hdr_pat_no,
	   	   	    :rl_prn_ctrl_hdr_sp_no,
			    :rl_prn_ctrl_hdr_source_code,
			    :rl_prn_ctrl_hdr_user,
			    :rl_prn_ctrl_hdr_section_code,
				:rl_prn_ctrl_hdr_rp_yn,
				:p_param7,
				:p_param8,
				:p_param9,    /// 09.12.2004
				:p_param10,
				:p_param11,
				:p_param12,  /// added on 07.08.2005
				:p_param13,  /// added on 16.01.2006
		///		:p_print_id,
				:p_fax_id,
				:p_mail_id,
		///		:p_printer_name,    //// added on 21.08.2005
		///		:p_dest_queue_name,
				:p_fax_to_rcpt_name,  /// added on 16.01.2006
				:p_fax_to_comp_name,  /// added on 16.01.2006
				:p_fax_to_phone_no,   /// added on 16.01.2006
		///		:p_fax_address,       /// added on 16.01.2006
		///		:p_mail_address,      /// added on 16.01.2006
				:nd_rowid,
				:c_pgm_date; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6312;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&rl_prn_ctrl_hdr_pat_no;
 sqlstm.sqhstl[1] = (unsigned int  )18;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&rl_prn_ctrl_hdr_sp_no;
 sqlstm.sqhstl[2] = (unsigned int  )23;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&rl_prn_ctrl_hdr_source_code;
 sqlstm.sqhstl[3] = (unsigned int  )13;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&rl_prn_ctrl_hdr_user;
 sqlstm.sqhstl[4] = (unsigned int  )33;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&rl_prn_ctrl_hdr_section_code;
 sqlstm.sqhstl[5] = (unsigned int  )4;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&rl_prn_ctrl_hdr_rp_yn;
 sqlstm.sqhstl[6] = (unsigned int  )4;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_param7;
 sqlstm.sqhstl[7] = (unsigned int  )4;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_param8;
 sqlstm.sqhstl[8] = (unsigned int  )4;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&p_param9;
 sqlstm.sqhstl[9] = (unsigned int  )12;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&p_param10;
 sqlstm.sqhstl[10] = (unsigned int  )4;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&p_param11;
 sqlstm.sqhstl[11] = (unsigned int  )4;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&p_param12;
 sqlstm.sqhstl[12] = (unsigned int  )4;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&p_param13;
 sqlstm.sqhstl[13] = (unsigned int  )4;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&p_fax_id;
 sqlstm.sqhstl[14] = (unsigned int  )32;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&p_mail_id;
 sqlstm.sqhstl[15] = (unsigned int  )32;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&p_fax_to_rcpt_name;
 sqlstm.sqhstl[16] = (unsigned int  )502;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&p_fax_to_comp_name;
 sqlstm.sqhstl[17] = (unsigned int  )502;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&p_fax_to_phone_no;
 sqlstm.sqhstl[18] = (unsigned int  )102;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&nd_rowid;
 sqlstm.sqhstl[19] = (unsigned int  )33;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&c_pgm_date;
 sqlstm.sqhstl[20] = (unsigned int  )23;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_PROG_PARAM");

	      rl_prn_ctrl_hdr_pat_no.arr[rl_prn_ctrl_hdr_pat_no.len]           = '\0';
	      rl_prn_ctrl_hdr_sp_no.arr[rl_prn_ctrl_hdr_sp_no.len]             = '\0';
	      rl_prn_ctrl_hdr_source_code.arr[rl_prn_ctrl_hdr_source_code.len] = '\0';
 	      rl_prn_ctrl_hdr_user.arr[rl_prn_ctrl_hdr_user.len]               = '\0';
	      rl_prn_ctrl_hdr_section_code.arr[rl_prn_ctrl_hdr_section_code.len]  = '\0';
          rl_prn_ctrl_hdr_rp_yn.arr[rl_prn_ctrl_hdr_rp_yn.len]		 = '\0';
		  p_param7.arr[p_param7.len]								 = '\0';
		  nd_rowid.arr[nd_rowid.len]								 = '\0';
		  p_param8.arr[p_param8.len]								 = '\0';
		  p_param9.arr[p_param9.len]								 = '\0';
		  p_param10.arr[p_param10.len]								 = '\0';
		  p_param11.arr[p_param11.len]								 = '\0';

		  p_param12.arr[p_param12.len]								 = '\0';
		  p_param13.arr[p_param13.len]								 = '\0';
///		  p_print_id.arr[p_print_id.len]							 = '\0';
		  p_fax_id.arr[p_fax_id.len]								 = '\0';
		  p_mail_id.arr[p_mail_id.len]								 = '\0';

///		  p_printer_name.arr[p_printer_name.len]					 = '\0';
///		  p_dest_queue_name.arr[p_dest_queue_name.len]			     = '\0'; 

		  p_fax_to_rcpt_name.arr[p_fax_to_rcpt_name.len] = '\0';
		  p_fax_to_comp_name.arr[p_fax_to_comp_name.len] = '\0';
		  p_fax_to_phone_no.arr[p_fax_to_phone_no.len]   = '\0'; 
///		  p_fax_address.arr[p_fax_address.len]           = '\0';     
///		  p_mail_address.arr[p_mail_address.len]         = '\0';    

		  c_pgm_date.arr[c_pgm_date.len]							 = '\0';
		  nd_operating_facility_id.arr[nd_operating_facility_id.len] = '\0';
		  
	      strcpy(nd_hosp_no.arr,rl_prn_ctrl_hdr_pat_no.arr);
	      strcpy(nd_spec_no.arr,rl_prn_ctrl_hdr_sp_no.arr);
	      nd_hosp_no.arr[rl_prn_ctrl_hdr_pat_no.len] 	= '\0';
	      nd_spec_no.arr[rl_prn_ctrl_hdr_sp_no.len] 	= '\0';
	      nd_hosp_no.len	= rl_prn_ctrl_hdr_pat_no.len;
	      nd_spec_no.len	= rl_prn_ctrl_hdr_sp_no.len;


	    return (LAST_ROW?0:1);

}
/*------------------------------------------------------------*/
close_param_curs()
{
	/* EXEC SQL CLOSE param_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6411;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
fetch_sy_requests()
{


	sy_user_id.arr[0] 		= '\0';
	sy_session_id.arr[0] 	= '\0';
	sy_req_date.arr[0]      = '\0';
	sy_machine_name.arr[0]  = '\0';
	sy_ws_no.arr[0]		    = '\0';
	sy_rowid.arr[0]		    = '\0';

	p_print_id.arr[0]   = '\0';
	p_printer_name.arr[0] = '\0';
	p_dest_queue_name.arr[0] = '\0';
	p_fax_address.arr[0]      = '\0';     
	p_mail_address.arr[0]     = '\0';    

	sy_session_id.len	    = 0;
	sy_user_id.len	        = 0;
	sy_req_date.len         = 0;
	sy_machine_name.len     = 0;
	sy_ws_no.len            = 0;
	sy_rowid.len            = 0;

	p_print_id.len = 0;
	p_printer_name.len = 0;    
	p_dest_queue_name.len = 0;
	p_fax_address.len      = 0;
	p_mail_address.len     = 0;

		/* EXEC SQL SELECT
			    SESSION_ID,
				USER_ID,
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'),
				MACHINE_NAME,
				WS_NO,
				ROWID,
				PRINT_SERVER_ID,
				PRINTER_NAME,   
				DEST_QUEUE_NAME,
				FAX_ID,         
				MAIL_ID        
		   INTO 
                :sy_session_id,
                :sy_user_id,
                :sy_req_date,
				:sy_machine_name,
				:sy_ws_no,
				:sy_rowid,
				:p_print_id,
				:p_printer_name,
				:p_dest_queue_name,
				:p_fax_address,       /// added on 16.01.2006
				:p_mail_address      /// added on 16.01.2006
	       FROM	SY_REPORT_GENERATE_REQUEST
	      WHERE	operating_facility_id = :nd_operating_facility_id
		    AND pgm_id = 'Rlrsenq4'
	        AND	session_id = TO_NUMBER(:c_session_id)
			AND request_date = TO_DATE(:c_pgm_date, 'DDMMYYHH24MISS')
            AND user_id = :c_user_id
			AND request_status IS NULL; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select SESSION_ID ,USER_ID ,TO_CHAR(REQUEST_DATE,'DDMMYYHH2\
4MISS') ,MACHINE_NAME ,WS_NO ,ROWID ,PRINT_SERVER_ID ,PRINTER_NAME ,DEST_QUEUE\
_NAME ,FAX_ID ,MAIL_ID into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10  from\
 SY_REPORT_GENERATE_REQUEST where (((((operating_facility_id=:b11 and pgm_id='\
Rlrsenq4') and session_id=TO_NUMBER(:b12)) and request_date=TO_DATE(:b13,'DDMM\
YYHH24MISS')) and user_id=:b14) and request_status is null )";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6426;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&sy_session_id;
  sqlstm.sqhstl[0] = (unsigned int  )32;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&sy_user_id;
  sqlstm.sqhstl[1] = (unsigned int  )33;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&sy_req_date;
  sqlstm.sqhstl[2] = (unsigned int  )32;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&sy_machine_name;
  sqlstm.sqhstl[3] = (unsigned int  )33;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&sy_ws_no;
  sqlstm.sqhstl[4] = (unsigned int  )33;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&sy_rowid;
  sqlstm.sqhstl[5] = (unsigned int  )33;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&p_print_id;
  sqlstm.sqhstl[6] = (unsigned int  )32;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&p_printer_name;
  sqlstm.sqhstl[7] = (unsigned int  )102;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqhstv[8] = (         void  *)&p_dest_queue_name;
  sqlstm.sqhstl[8] = (unsigned int  )102;
  sqlstm.sqhsts[8] = (         int  )0;
  sqlstm.sqindv[8] = (         void  *)0;
  sqlstm.sqinds[8] = (         int  )0;
  sqlstm.sqharm[8] = (unsigned int  )0;
  sqlstm.sqadto[8] = (unsigned short )0;
  sqlstm.sqtdso[8] = (unsigned short )0;
  sqlstm.sqhstv[9] = (         void  *)&p_fax_address;
  sqlstm.sqhstl[9] = (unsigned int  )102;
  sqlstm.sqhsts[9] = (         int  )0;
  sqlstm.sqindv[9] = (         void  *)0;
  sqlstm.sqinds[9] = (         int  )0;
  sqlstm.sqharm[9] = (unsigned int  )0;
  sqlstm.sqadto[9] = (unsigned short )0;
  sqlstm.sqtdso[9] = (unsigned short )0;
  sqlstm.sqhstv[10] = (         void  *)&p_mail_address;
  sqlstm.sqhstl[10] = (unsigned int  )102;
  sqlstm.sqhsts[10] = (         int  )0;
  sqlstm.sqindv[10] = (         void  *)0;
  sqlstm.sqinds[10] = (         int  )0;
  sqlstm.sqharm[10] = (unsigned int  )0;
  sqlstm.sqadto[10] = (unsigned short )0;
  sqlstm.sqtdso[10] = (unsigned short )0;
  sqlstm.sqhstv[11] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[11] = (unsigned int  )7;
  sqlstm.sqhsts[11] = (         int  )0;
  sqlstm.sqindv[11] = (         void  *)0;
  sqlstm.sqinds[11] = (         int  )0;
  sqlstm.sqharm[11] = (unsigned int  )0;
  sqlstm.sqadto[11] = (unsigned short )0;
  sqlstm.sqtdso[11] = (unsigned short )0;
  sqlstm.sqhstv[12] = (         void  *)&c_session_id;
  sqlstm.sqhstl[12] = (unsigned int  )52;
  sqlstm.sqhsts[12] = (         int  )0;
  sqlstm.sqindv[12] = (         void  *)0;
  sqlstm.sqinds[12] = (         int  )0;
  sqlstm.sqharm[12] = (unsigned int  )0;
  sqlstm.sqadto[12] = (unsigned short )0;
  sqlstm.sqtdso[12] = (unsigned short )0;
  sqlstm.sqhstv[13] = (         void  *)&c_pgm_date;
  sqlstm.sqhstl[13] = (unsigned int  )23;
  sqlstm.sqhsts[13] = (         int  )0;
  sqlstm.sqindv[13] = (         void  *)0;
  sqlstm.sqinds[13] = (         int  )0;
  sqlstm.sqharm[13] = (unsigned int  )0;
  sqlstm.sqadto[13] = (unsigned short )0;
  sqlstm.sqtdso[13] = (unsigned short )0;
  sqlstm.sqhstv[14] = (         void  *)&c_user_id;
  sqlstm.sqhstl[14] = (unsigned int  )52;
  sqlstm.sqhsts[14] = (         int  )0;
  sqlstm.sqindv[14] = (         void  *)0;
  sqlstm.sqinds[14] = (         int  )0;
  sqlstm.sqharm[14] = (unsigned int  )0;
  sqlstm.sqadto[14] = (unsigned short )0;
  sqlstm.sqtdso[14] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      if (NOT_FOUND) 
	      return FALSE;
	  else
	  {
		sy_user_id.arr[sy_user_id.len] = '\0';
		sy_session_id.arr[sy_session_id.len] = '\0';
		sy_rowid.arr[sy_rowid.len] = '\0';
		sy_req_date.arr[sy_req_date.len] = '\0';
		sy_machine_name.arr[sy_machine_name.len] = '\0';
		sy_ws_no.arr[sy_ws_no.len] = '\0';
		sy_rowid.arr[sy_rowid.len] = '\0';

		  p_print_id.arr[p_print_id.len] = '\0';
		  p_printer_name.arr[p_printer_name.len] = '\0';
		  p_dest_queue_name.arr[p_dest_queue_name.len] = '\0';
		  p_fax_address.arr[p_fax_address.len]           = '\0';     
		  p_mail_address.arr[p_mail_address.len]         = '\0';    

		return TRUE;
	  }



    return (LAST_ROW?0:1);

}
/*------------------------------------------------------------*/
gen_file_name1()
{
     nd_file_name.arr[0]   = '\0';
     nd_file_name.len      = 0;

     if (OERROR)
         ins_message(ORA_MESG,"Fetch failed on table RL_PARAM");
      
     nd_file_no.arr[nd_file_no.len] = '\0';

     sprintf(nd_file_name.arr,"%sRlrsenq4.lis", WORKING_DIR);

	 strcpy(nd_f_name,nd_file_name.arr);
		/************************************************/ 
		   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
		   {

			l_text.arr[0]		    = '\0';
			l_text.len            = 0;
			strcpy(l_text.arr,"IN GENERATE FILE NAME1......");
			write_to_file();
		   }

		/************************************************/
     if ((fp = fopen(nd_file_name.arr,"w")) == NULL)
     {
		/************************************************/ 
		   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
		   {

			l_text.arr[0]		    = '\0';
			l_text.len            = 0;
			strcpy(l_text.arr,"IN GENERATE FILE NAME1......ERROR");
			write_to_file();
		   }

		/************************************************/

		strcpy(string_var, "");
		sprintf(string_var, "F1-[%c]<->%s::Mail-[%c]<->[%c]", l_destn_rep_yn, nd_file_name.arr, l_destn_mail_yn, l_destn_fax_yn);

        ins_message1(ERR_MESG, string_var);

     }
		/************************************************/ 
		   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
		   {

			l_text.arr[0]		    = '\0';
			l_text.len            = 0;
			strcpy(l_text.arr,"IN GENERATE FILE NAME1......LAST");
			write_to_file();
		   }

		/************************************************/

}
/*-----------------------------------------------------*/
gen_extra_file_name1()
{
   sprintf(extra_file_name,"%srlrsenqe.lis",WORKING_DIR);

   strcpy(nd_e_name,extra_file_name);
			/************************************************/ 
			   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN gen_extra_file_name1......");
				write_to_file();
			   }

			/************************************************/

   if ((fp = fopen(extra_file_name,"w")) == NULL)
   {
			/************************************************/ 
			   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN gen_extra_file_name1......ERROR");
				write_to_file();
			   }

			/************************************************/

		strcpy(string_var, "");
		sprintf(string_var, "E1-[%c]<->%s::Mail-[%c]<->[%c]", l_destn_rep_yn, extra_file_name, l_destn_mail_yn, l_destn_fax_yn);
        ins_message1(ERR_MESG, string_var);

   }
			/************************************************/ 
			   if ( strcmp(l_file_exists.arr,"Y")==0 && strcmp(l_dir_exists.arr,"Y")==0)
			   {

				l_text.arr[0]		    = '\0';
				l_text.len            = 0;
				strcpy(l_text.arr,"IN gen_extra_file_name1......LAST");
				write_to_file();
			   }

			/************************************************/

}
/*-----------------------------------------------------*/
patch_sy_table()
{


		   /* EXEC SQL SELECT COUNT(1)
				    INTO  :v_count
				    FROM   SY_REPORT_GENERATE_REQUEST
				    WHERE  OPERATING_FACILITY_ID = DECODE(:nd_facility_id,'*A',OPERATING_FACILITY_ID,
         										                   :nd_facility_id)
				    AND    pgm_id IN ('RLRRSENQ')
				    AND    request_status = 'E'; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 10;
     sqlstm.arrsiz = 33;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select count(1) into :b0  from SY_REPORT_GENERATE_REQUES\
T where ((OPERATING_FACILITY_ID=DECODE(:b1,'*A',OPERATING_FACILITY_ID,:b1) and\
 pgm_id in ('RLRRSENQ')) and request_status='E')";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )6501;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)256;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&v_count;
     sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
     sqlstm.sqhstl[1] = (unsigned int  )7;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
     sqlstm.sqhstl[2] = (unsigned int  )7;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
		   if (v_count > 0)
		   {
		   /***** commented against MZ issue on 02.06.2008
				declare_sy_curs();
				while(fetch_sy_curs())
				{
					update_sy_curs();
				}	
				close_sy_curs();

			*********/

				declare_sy_curs_e();
				while(fetch_sy_curs_e())
				{
					delete_sy_curs();
					del_sy_prog_param();
				}	
				close_sy_curs_e();

				/* EXEC SQL COMMIT WORK; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )6528;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		   }

}
/*------------------------------------------------------------*/
declare_sy_curs()
{
	/* EXEC SQL DECLARE sy_curs CURSOR FOR
		SELECT  OPERATING_FACILITY_ID,
				SESSION_ID, USER_ID, 
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'), 
				MACHINE_NAME, WS_NO, ROWID,
				PRINT_SERVER_ID,PRINTER_NAME,DEST_QUEUE_NAME,        
				FAX_ID,MAIL_ID                 
	       FROM	SY_REPORT_GENERATE_REQUEST 
	      WHERE	OPERATING_FACILITY_ID = DECODE(:nd_facility_id,'*A',OPERATING_FACILITY_ID,
         										                   :nd_facility_id)
		    AND pgm_id IN ('RLRRSENQ') 
		    AND request_date > (SYSDATE - 2) 
			AND NVL(request_status, 'O') = 'E'; */ 



	/* EXEC SQL OPEN sy_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0143;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6543;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
fetch_sy_curs()
{
		sy_user_id.arr[0] 				= '\0';
		sy_session_id.arr[0] 			= '\0';
		sy_req_date.arr[0]				= '\0';
		sy_machine_name.arr[0]			= '\0';
		sy_ws_no.arr[0]					= '\0';
		sy_rowid.arr[0]					= '\0';
		nd_operating_facility_id.arr[0]	= '\0';

		p_print_id.arr[0]   = '\0';
		p_printer_name.arr[0] = '\0';
		p_dest_queue_name.arr[0] = '\0';
		p_fax_address.arr[0]      = '\0';     
		p_mail_address.arr[0]     = '\0';    

		sy_session_id.len	    = 0;
		sy_user_id.len	        = 0;
		sy_req_date.len         = 0;
		sy_machine_name.len     = 0;
		sy_ws_no.len            = 0;
		sy_rowid.len            = 0;
		nd_operating_facility_id.len = 0;

		p_print_id.len = 0;
		p_printer_name.len = 0;    
		p_dest_queue_name.len = 0;
		p_fax_address.len      = 0;
		p_mail_address.len     = 0;

			/* EXEC SQL FETCH sy_curs
					 INTO :nd_operating_facility_id,	
						  :sy_session_id,
						  :sy_user_id,
						  :sy_req_date,
						  :sy_machine_name,
						  :sy_ws_no,
						  :sy_rowid,
						  :p_print_id,
						  :p_printer_name,
						  :p_dest_queue_name,
						  :p_fax_address,       /// added on 16.01.2006
						  :p_mail_address; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )6566;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )7;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&sy_session_id;
   sqlstm.sqhstl[1] = (unsigned int  )32;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&sy_user_id;
   sqlstm.sqhstl[2] = (unsigned int  )33;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[3] = (unsigned int  )32;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&sy_machine_name;
   sqlstm.sqhstl[4] = (unsigned int  )33;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&sy_ws_no;
   sqlstm.sqhstl[5] = (unsigned int  )33;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[6] = (unsigned int  )33;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&p_print_id;
   sqlstm.sqhstl[7] = (unsigned int  )32;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&p_printer_name;
   sqlstm.sqhstl[8] = (unsigned int  )102;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&p_dest_queue_name;
   sqlstm.sqhstl[9] = (unsigned int  )102;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&p_fax_address;
   sqlstm.sqhstl[10] = (unsigned int  )102;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&p_mail_address;
   sqlstm.sqhstl[11] = (unsigned int  )102;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

      /// added on 16.01.2006
						  
			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      sy_user_id.arr[sy_user_id.len] = '\0';
      sy_session_id.arr[sy_session_id.len] = '\0';
      sy_rowid.arr[sy_rowid.len] = '\0';
      sy_req_date.arr[sy_req_date.len] = '\0';
	  sy_machine_name.arr[sy_machine_name.len] = '\0';
	  sy_ws_no.arr[sy_ws_no.len] = '\0';
	  sy_rowid.arr[sy_rowid.len] = '\0';
	  nd_operating_facility_id.arr[nd_operating_facility_id.len] = '\0';

	  p_print_id.arr[p_print_id.len] = '\0';
	  p_printer_name.arr[p_printer_name.len] = '\0';
	  p_dest_queue_name.arr[p_dest_queue_name.len] = '\0';
	  p_fax_address.arr[p_fax_address.len]           = '\0';     
	  p_mail_address.arr[p_mail_address.len]         = '\0';    


    return (LAST_ROW?0:1);

}
/*------------------------------------------------------------*/
close_sy_curs()
{
	/* EXEC SQL CLOSE sy_curs; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6629;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/*------------------------------------------------------------*/
update_sy_curs()
{
   /* EXEC SQL UPDATE SY_REPORT_GENERATE_REQUEST
               SET request_status = NULL
			 WHERE ROWID = :sy_rowid; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "update SY_REPORT_GENERATE_REQUEST  set request_status=null\
  where ROWID=:b0";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )6644;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   if(OERROR) 
      ins_message(ERR_MESG,"Failed in update_sy_curs()");       

}
/*------------------------------------------------------------*/
declare_sy_curs_e()
{

	/* EXEC SQL DECLARE sy_curs_e CURSOR FOR 
  		 SELECT OPERATING_FACILITY_ID,SESSION_ID, USER_ID, 
			    TO_CHAR(REQUEST_DATE,'DDMMYYHH24MISS'), 
				MACHINE_NAME, WS_NO, ROWID, 
				PRINT_SERVER_ID,PRINTER_NAME,DEST_QUEUE_NAME,
				FAX_ID, MAIL_ID        
	       FROM	SY_REPORT_GENERATE_REQUEST 
	      WHERE	OPERATING_FACILITY_ID = DECODE(:nd_facility_id,'*A',OPERATING_FACILITY_ID,
         										                   :nd_facility_id)
		    AND pgm_id IN ('RLRRSENQ') 
		    AND request_date < (SYSDATE - 2)
			AND NVL(request_status, 'O') = 'E'; */ 



	/* EXEC SQL OPEN sy_curs_e; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0145;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6663;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
/*------------------------------------------------------------*/
fetch_sy_curs_e()
{
		sy_user_id.arr[0] 		= '\0';
		sy_session_id.arr[0] 	= '\0';
		sy_req_date.arr[0]      = '\0';
		sy_machine_name.arr[0]  = '\0';
		sy_ws_no.arr[0]		    = '\0';
		sy_rowid.arr[0]		    = '\0';
		nd_operating_facility_id.arr[0]		    = '\0';

		p_print_id.arr[0]   = '\0';
		p_printer_name.arr[0] = '\0';
		p_dest_queue_name.arr[0] = '\0';
		p_fax_address.arr[0]      = '\0';     
		p_mail_address.arr[0]     = '\0';    

		sy_session_id.len	    = 0;
		sy_user_id.len	        = 0;
		sy_req_date.len         = 0;
		sy_machine_name.len     = 0;
		sy_ws_no.len            = 0;
		sy_rowid.len            = 0;
		nd_operating_facility_id.len = 0;


		p_print_id.len = 0;
		p_printer_name.len = 0;    
		p_dest_queue_name.len = 0;
		p_fax_address.len      = 0;
		p_mail_address.len     = 0;

			/* EXEC SQL FETCH sy_curs_e
					 INTO :nd_operating_facility_id,	
					 	  :sy_session_id,
						  :sy_user_id,
						  :sy_req_date,
						  :sy_machine_name,
						  :sy_ws_no,
						  :sy_rowid,
						  :p_print_id,
						  :p_printer_name,
						  :p_dest_queue_name,
						  :p_fax_address,       /// added on 16.01.2006
						  :p_mail_address; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )6686;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )7;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&sy_session_id;
   sqlstm.sqhstl[1] = (unsigned int  )32;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&sy_user_id;
   sqlstm.sqhstl[2] = (unsigned int  )33;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[3] = (unsigned int  )32;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&sy_machine_name;
   sqlstm.sqhstl[4] = (unsigned int  )33;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&sy_ws_no;
   sqlstm.sqhstl[5] = (unsigned int  )33;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[6] = (unsigned int  )33;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&p_print_id;
   sqlstm.sqhstl[7] = (unsigned int  )32;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&p_printer_name;
   sqlstm.sqhstl[8] = (unsigned int  )102;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&p_dest_queue_name;
   sqlstm.sqhstl[9] = (unsigned int  )102;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&p_fax_address;
   sqlstm.sqhstl[10] = (unsigned int  )102;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&p_mail_address;
   sqlstm.sqhstl[11] = (unsigned int  )102;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

      /// added on 16.01.2006
			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      sy_user_id.arr[sy_user_id.len] = '\0';
      sy_session_id.arr[sy_session_id.len] = '\0';
      sy_rowid.arr[sy_rowid.len] = '\0';
      sy_req_date.arr[sy_req_date.len] = '\0';
	  sy_machine_name.arr[sy_machine_name.len] = '\0';
	  sy_ws_no.arr[sy_ws_no.len] = '\0';
	  sy_rowid.arr[sy_rowid.len] = '\0';
	  nd_operating_facility_id.arr[nd_operating_facility_id.len] = '\0';

	  p_print_id.arr[p_print_id.len] = '\0';
	  p_printer_name.arr[p_printer_name.len] = '\0';
	  p_dest_queue_name.arr[p_dest_queue_name.len] = '\0';
	  p_fax_address.arr[p_fax_address.len]           = '\0';     
	  p_mail_address.arr[p_mail_address.len]         = '\0';    

    return (LAST_ROW?0:1);

}
/*------------------------------------------------------------*/
close_sy_curs_e()
{
	/* EXEC SQL CLOSE sy_curs_e; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6749;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/*------------------------------------------------------------*/
delete_sy_curs()
{
   /* EXEC SQL DELETE FROM SY_REPORT_GENERATE_REQUEST
			 WHERE ROWID = :sy_rowid; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "delete  from SY_REPORT_GENERATE_REQUEST  where ROWID=:b0";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )6764;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   if(OERROR) 
      ins_message(ERR_MESG,"Failed in delete_sy_curs()");       

}
/*------------------------------------------------------------*/
del_sy_prog_param()
{

	/* EXEC SQL DELETE FROM SY_PROG_PARAM 
				WHERE operating_facility_id = :nd_operating_facility_id
				AND pgm_id IN ('RLRRSENQ')
				AND session_id = :sy_session_id
				AND pgm_date = :sy_req_date
				AND param4 = :sy_user_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "delete  from SY_PROG_PARAM  where ((((operating_facility_id=\
:b0 and pgm_id in ('RLRRSENQ')) and session_id=:b1) and pgm_date=:b2) and para\
m4=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6783;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sy_session_id;
 sqlstm.sqhstl[1] = (unsigned int  )32;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&sy_req_date;
 sqlstm.sqhstl[2] = (unsigned int  )32;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&sy_user_id;
 sqlstm.sqhstl[3] = (unsigned int  )33;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	
      if (OERROR)
         ins_message(ORA_MESG,"Delete failed on table SY_PROG_PARAM");

}
/*------------------------------------------------------------*/
delete_error_record()
{

	declare_sy_curs_2();
	while(fetch_sy_curs_2())
	{
		delete_sy_curs2();
		delete_sy_param();

	}
	close_sy_curs_2();

}
/*------------------------------------------------------------*/
declare_sy_curs_2()
{

	/* EXEC SQL DECLARE sy_curs_2 CURSOR FOR 
			SELECT   TO_CHAR(request_date,'DDMMYYHH24MISS'), ROWID 
	        FROM	SY_REPORT_GENERATE_REQUEST 
		    WHERE	pgm_id IN ('Rlrsenq4') 
		    AND session_id = TO_NUMBER(:c_session_id)
		    AND user_id = :c_user_id
		    AND NVL(request_status, 'O') = 'E'; */ 


	/* EXEC SQL OPEN sy_curs_2; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0148;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6814;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&c_session_id;
 sqlstm.sqhstl[0] = (unsigned int  )52;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&c_user_id;
 sqlstm.sqhstl[1] = (unsigned int  )52;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/*------------------------------------------------------------*/
fetch_sy_curs_2()
{
		sy_req_date.arr[0]      = '\0';
		sy_rowid.arr[0]		    = '\0';

		sy_req_date.len         = 0;
		sy_rowid.len            = 0;


			/* EXEC SQL FETCH sy_curs_2
				INTO	
					:sy_req_date,
					:sy_rowid; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )6837;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[0] = (unsigned int  )32;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[1] = (unsigned int  )33;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			

      if(OERROR)
         ins_message(ORA_MESG,"Select failed on table SY_REPORT_GENERATE_REQUEST");

      sy_req_date.arr[sy_req_date.len] = '\0';
	  sy_rowid.arr[sy_rowid.len] = '\0';



    return (LAST_ROW?0:1);

}
/*------------------------------------------------------------*/
close_sy_curs_2()
{
	/* EXEC SQL CLOSE sy_curs_2; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6860;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if(OERROR)
         ins_message(ORA_MESG,"Close failed on cursor sy_curs_2");

}
/*------------------------------------------------------------*/
delete_sy_param()
{

	/* EXEC SQL DELETE FROM SY_PROG_PARAM
			 WHERE pgm_id = 'Rlrsenq4'
			 AND session_id = TO_NUMBER(:c_session_id)
			 AND pgm_date = :sy_req_date
			 AND param4 = :c_user_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "delete  from SY_PROG_PARAM  where (((pgm_id='Rlrsenq4' and s\
ession_id=TO_NUMBER(:b0)) and pgm_date=:b1) and param4=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6875;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&c_session_id;
 sqlstm.sqhstl[0] = (unsigned int  )52;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sy_req_date;
 sqlstm.sqhstl[1] = (unsigned int  )32;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&c_user_id;
 sqlstm.sqhstl[2] = (unsigned int  )52;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if(OERROR)
         ins_message(ORA_MESG,"Delete failed on table SY_PROG_PARAM");


}
/*------------------------------------------------------------*/
delete_sy_curs2()
{

   /* EXEC SQL DELETE FROM SY_REPORT_GENERATE_REQUEST
			 WHERE ROWID = :sy_rowid; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "delete  from SY_REPORT_GENERATE_REQUEST  where ROWID=:b0";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )6902;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_rowid;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   if(OERROR) 
      ins_message(ERR_MESG,"Failed in delete_sy_curs2()");       

}
/*------------------------------------------------------------*/
/*** only for qatar ***/
get_new_medicom_no()
{
	nd_new_medicom_no.arr[0]		= '\0';
	nd_new_medicom_no.len			= 0;


   /* EXEC SQL SELECT medicom_no
			INTO :nd_new_medicom_no
			FROM RL_PATIENT_TEMP_LINK
			WHERE hmc_no = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select medicom_no into :b0  from RL_PATIENT_TEMP_LINK wher\
e hmc_no=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )6921;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_new_medicom_no;
   sqlstm.sqhstl[0] = (unsigned int  )23;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if(OERROR);

	if (NODATAFOUND);

	nd_new_medicom_no.arr[nd_new_medicom_no.len]	= '\0';

}
/*------------------------------------------------------------*/
get_health_card_num()
{
    rl_health_card_num.arr[0]      = '\0';
	rl_health_num.arr[0]		   = '\0';
	rl_health_exp_date.arr[0]	   = '\0';

    rl_health_card_num.len         = 0;
	rl_health_num.len			   = 0;
	rl_health_exp_date.len		   = 0;
/*
		EXEC SQL 
              SELECT health_card_num, health_num, 
					TO_CHAR(health_card_exp_date, 'DD/MM/YYYY')
			  INTO :rl_health_card_num, :rl_health_num,
				   :rl_health_exp_date
              FROM MP_PATIENT_MAST
             WHERE PATIENT_ID = :nd_hosp_no;
*/

      if(OERROR);

	if (NODATAFOUND);

    rl_health_card_num.arr[rl_health_card_num.len]       = '\0';
	rl_health_num.arr[rl_health_num.len]				 = '\0';
	rl_health_exp_date.arr[rl_health_exp_date.len]		 = '\0';


}
/*------------------------------------------------------------*/

/*------------------------------------------------------------*/
check_any_res_comp()
{

	/* EXEC SQL SELECT COUNT(1)
				INTO :other_than_comments
                FROM RL_RESULT_TEXT
               WHERE PATIENT_ID     = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
				 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
                 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
				 AND NVL(hide_text_yn, 'N') <> 'Y'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select count(1) into :b0  from RL_RESULT_TEXT where (((((PAT\
IENT_ID=:b1 and SPECIMEN_NO=:b2) and OPERATING_FACILITY_ID=:b3) and GROUP_TEST\
_CODE=:b4) and TEST_CODE=:b5) and NVL(hide_text_yn,'N')<>'Y')";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6944;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&other_than_comments;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
 sqlstm.sqhstl[1] = (unsigned int  )23;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[2] = (unsigned int  )23;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[3] = (unsigned int  )7;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&rl_tst_group_test_code;
 sqlstm.sqhstl[4] = (unsigned int  )13;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&rl_tst_test_code;
 sqlstm.sqhstl[5] = (unsigned int  )13;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
	if (other_than_comments == 0)
	{
		/* EXEC SQL SELECT  COUNT(1)
			 INTO :other_than_comments
                FROM RL_RESULT_SNOMED A
               WHERE A.PATIENT_ID     = :nd_hosp_no
                 AND A.SPECIMEN_NO     = :nd_spec_no
				 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
                 AND A.GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND A.TEST_CODE       = :rl_tst_test_code
				AND (A.SNOMED_CODE
							IN (SELECT SNOMED_CODE
								FROM RL_SNOMED_CODE
								WHERE snomed_code = A.snomed_code
								AND (NVL(print_yn, 'N') = 'Y' 
									OR NVL(print_code_yn, 'N') = 'Y' ))
					 OR A.SNOMED_CODE_2
							IN (SELECT SNOMED_CODE
								FROM RL_SNOMED_CODE
								WHERE snomed_code = A.snomed_code_2
								AND (NVL(print_yn, 'N') = 'Y' 
								OR NVL(print_code_yn, 'N') = 'Y' ))); */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select count(1) into :b0  from RL_RESULT_SNOMED A where (((\
((A.PATIENT_ID=:b1 and A.SPECIMEN_NO=:b2) and OPERATING_FACILITY_ID=:b3) and A\
.GROUP_TEST_CODE=:b4) and A.TEST_CODE=:b5) and (A.SNOMED_CODE in (select SNOME\
D_CODE  from RL_SNOMED_CODE where (snomed_code=A.snomed_code and (NVL(print_yn\
,'N')='Y' or NVL(print_code_yn,'N')='Y'))) or A.SNOMED_CODE_2 in (select SNOME\
D_CODE  from RL_SNOMED_CODE where (snomed_code=A.snomed_code_2 and (NVL(print_\
yn,'N')='Y' or NVL(print_code_yn,'N')='Y')))))";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6983;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&other_than_comments;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
  sqlstm.sqhstl[1] = (unsigned int  )23;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_spec_no;
  sqlstm.sqhstl[2] = (unsigned int  )23;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[3] = (unsigned int  )7;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&rl_tst_group_test_code;
  sqlstm.sqhstl[4] = (unsigned int  )13;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&rl_tst_test_code;
  sqlstm.sqhstl[5] = (unsigned int  )13;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	
		if (other_than_comments == 0)
		{
			/* EXEC SQL  SELECT COUNT(1)
               INTO :other_than_comments 
                FROM RL_RESULT_ORGANISM
               WHERE PATIENT_ID      = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
				 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
                 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
				 AND NVL(hide_organism_yn, 'N') <> 'Y'; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select count(1) into :b0  from RL_RESULT_ORGANISM where ((\
(((PATIENT_ID=:b1 and SPECIMEN_NO=:b2) and OPERATING_FACILITY_ID=:b3) and GROU\
P_TEST_CODE=:b4) and TEST_CODE=:b5) and NVL(hide_organism_yn,'N')<>'Y')";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7022;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&other_than_comments;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_spec_no;
   sqlstm.sqhstl[2] = (unsigned int  )23;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[3] = (unsigned int  )7;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&rl_tst_group_test_code;
   sqlstm.sqhstl[4] = (unsigned int  )13;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&rl_tst_test_code;
   sqlstm.sqhstl[5] = (unsigned int  )13;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/************
			 if (other_than_comments == 0)
			{

			} 
****************/
		}
	}

}


/*------------------------------------------------------------*/
/* SPLITTING THE VARCHAR 2000 INTO 70 CHARACTERS   */
/************************************************/
split_hist()
{
  
	char word[2];
	char w_flag ;

    strcpy(word1,"F");

	w_flag = 'T';

    while(fetch_clinical_text())
    {
          
		  	/***** ADDED FOR SCF42 OF QATAR *****/		
			something_to_print = 1;
			something_to_print_for_test = 1;

		  hell = strlen(d_clinical_text.arr);


         z = 0;
	     clt = 0;
	     strcpy(word1,"F"); 
	     cntr = 1;
	     qq = 0;

         while(z<hell)
         {
		 		  	
		 
             word[0] = d_clinical_text.arr[z];
 		     word[1] = '\0';

		     if (strcmp(word,"\n") == 0)
		     {
   
		       cntr = 0;
		       strcpy(word1,"N");
		       qq = z ;
		      }


  		      if(cntr >= 71)
		      {
		   	
			     cmp = cntr;
			     while((d_clinical_text.arr[z] != 32) && (cmp > 1))
			     {

			         z--;
				     cmp--;
				  
			      }

				  qq = z;
				  			   
			      word[0] = d_clinical_text.arr[z];
   			      word[1] = '\0';
		
		  	      if (cmp == 1)
				     strcpy(word1,"W");
			      else
			         strcpy(word1,"T");
			   
		
		       }


				if (((z == hell) || (z == hell - 1)) && (strcmp(word1,"F") == 0))
				{
	
				   fprint_repeat(fp,' ',8);	

				   sprintf(in_str,"%8.8s"," ");
				   
				   for(i=clt;i < z + 1;i++)
		           {
			       		
						if(d_clinical_text.arr[i] == '\n')
						{


							    w_flag = 'F';
 						 }

						fprintf(fp,"%c",d_clinical_text.arr[i]);
						sprintf(in_str,"%s%c",in_str,d_clinical_text.arr[i]);
			       }

				   print_html_line (in_str,out_str);

				   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				   strcpy(out_str,"");
				   write_html(fp4,l_html_bdy_str);
				   strcpy(l_html_bdy_str,"");

				   if (w_flag == 'T')
				   {
				   };

			       fprintf	(fp,"\n");

				   cntr = 0 ;
				   clt = clt + 70 ;
				   z = clt ;
			       qq = 0;
				   strcpy(word1,"F");


				}

			
		       if (strcmp(word1,"N") == 0) 
		       {
				
		          fprint_repeat(fp,' ',8);
				  
				  sprintf(in_str,"%8.8s"," ");

				  for(i=clt;i<=qq;i++)
		          {
			         if(d_clinical_text.arr[i] == '\n')
					{
						  
								w_flag = 'F';

				    }

				    fprintf(fp,"%c",d_clinical_text.arr[i]);
					sprintf(in_str,"%s%c",in_str,d_clinical_text.arr[i]);
			      }

				   print_html_line (in_str,out_str);

				   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				   strcpy(out_str,"");
				   write_html(fp4,l_html_bdy_str);
				   strcpy(l_html_bdy_str,"");
				  if (w_flag == 'T')
				  {
				  };
					
			      strcpy(word1,"F");
			      cntr = 0 ;
			      clt = qq + 1;
		          qq = 0;
	   	       }

		       if (strcmp(word1,"T") == 0)
		       {
		 										 
			      fprint_repeat(fp,' ',8);
				  
				  sprintf(in_str,"%8.8s"," ");
				  		   
				  for(i=clt;i<= qq;i++)
		          {
		             if(d_clinical_text.arr[i] == '\n')
					 {
						 
								w_flag = 'F';

					  }

					  fprintf(fp,"%c",d_clinical_text.arr[i]);
					  sprintf(in_str,"%s%c",in_str,d_clinical_text.arr[i]);
			      }

				   print_html_line (in_str,out_str);

				   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				   strcpy(out_str,"");
				   write_html(fp4,l_html_bdy_str);				  
				   strcpy(l_html_bdy_str,"");
				  if (w_flag == 'T')
				  {
				  };


			       fprintf	(fp,"\n");
			       cntr = 0 ;
				   clt = qq + 1 ;
			       qq = 0;
				   strcpy(word1,"F");

				
		        }


		        if (strcmp(word1,"W") == 0)
		        {
		 										 
			       fprint_repeat(fp,' ',8);
				   
				   sprintf(in_str,"%8.8s"," ");
		   
				   for(i=clt;i < clt + 70;i++)
		           {
		              if(d_clinical_text.arr[i] == '\n')
						{

								w_flag = 'F';
						}

						fprintf(fp,"%c",d_clinical_text.arr[i]);
						sprintf(in_str,"%s%c",in_str,d_clinical_text.arr[i]);
			       }

				   print_html_line (in_str,out_str);

				   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_bdy_str,out_str);
				   strcpy(out_str,"");
				   write_html(fp4,l_html_bdy_str);
				   strcpy(l_html_bdy_str,"");
				   if (w_flag = 'T')
				   {
				   };

			       fprintf(fp,"\n");
				   cntr = 0 ;
				   clt = clt + 70 ;
				   z = clt ;
			       qq = 0;
				   strcpy(word1,"F");

				
		        }

			w_flag = 'T';	  
	        cntr += 1;
	        z++ ;
          }

		
      }
  
       fflush(fp);

#ifdef DEBUG
   printf("rl_res_result_text = %s\n", d_clinical_text.arr);
#endif

if (OERROR)
      ins_message(ERR_MESG, "SPLITTING failed on table RL_PATIENT_CLINICAL_TEXT");

}
/*------------------------------------------------------------*/
print_hmc_no()
{
	char v_patient_id [100];

	get_hmc_no();

	if (strlen(rl_hmc_no.arr) > 0)
	{
		
		fprintf(fp,"%c&k4S",ESC); 
	   	fprintf(fp,"%c(s4B",ESC);
		//fprintf(fp, "Patient  ID  : ");
		fprintf(fp,"%-13.13s: ", local_legend[26]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC); 

		sprintf(in_str,"%s%-13.13s","",local_legend[26]);
		print_html_line (in_str,out_str);		
		sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0  width=100%c>",l_html_hdr_str,l_prtg);
		sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=14%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_hdr_str,l_prtg,out_str,l_prtg);
		strcpy(out_str,"");

		if(rl_hdr_episode_type.arr[0] == 'R')
		{
			if(strcmp(rl_pat_actual_id.arr,"NULL")==0)
	 			strcpy(v_patient_id,nd_hosp_no.arr);
			else
				strcpy(v_patient_id,rl_pat_actual_id.arr);
		}
		else
			strcpy(v_patient_id,nd_hosp_no.arr);

		fprintf(fp, "%-15.15s                          ", v_patient_id);

		sprintf(in_str,"%s%-15.15s","",v_patient_id);
		print_html_line (in_str,out_str);
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=40%c>%s</td>",l_html_hdr_str,l_prtg,out_str);
	    strcpy(out_str,"");

			page_break(1);

			fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s4B",ESC);
			//fprintf(fp, "HMC No. : ");
			fprintf(fp,"%-11.11s: ",local_legend[1]); // added for globalisation
			fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s-3B",ESC); 
			
		    sprintf(in_str,"%s%-11.11s","",local_legend[1]);
			print_html_line (in_str,out_str);			
			sprintf(l_html_hdr_str,"%s<td class=font_disp width=12%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_hdr_str,l_prtg,out_str,l_prtg);			  
			strcpy(out_str,"");

			fprintf(fp,"%c&k12S",ESC);	
			fprintf(fp,"%c&l6D",ESC);
   			fprintf(fp,"%c(s4B",ESC);

			fprintf(fp,"%-20.20s\n",rl_hmc_no.arr);
	
			fprintf(fp,"%c&k4S",ESC); 
   			fprintf(fp,"%c(s-3B",ESC);

			sprintf(in_str,"%s%-20.20s","",rl_hmc_no.arr);
			print_html_line (in_str,out_str);
			sprintf(l_html_hdr_str,"%s<td class=font_disp><b>%s</b></td></tr></table>",l_html_hdr_str,out_str);
			strcpy(out_str,"");

	}

}
/*------------------------------------------------------------*/
get_hmc_no()
{
	rl_hmc_no.arr[0]		= '\0';
	rl_hmc_no.len			= 0;

	if (strcmp(rl_alt_id_for_pat_id.arr, "!") != 0)
	{
		if (strcmp(rl_alt_id_for_pat_id.arr, "ALT_ID1_NO") == 0 ||
			strcmp(rl_alt_id_for_pat_id.arr, "ALTERNATE_ID_NUM") == 0)
		{
			/* EXEC SQL SELECT alternate_id_num
					 INTO :rl_hmc_no
					 FROM MP_PATIENT_MAST
					 WHERE patient_id = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select alternate_id_num into :b0  from MP_PATIENT_MAST whe\
re patient_id=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7061;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_hmc_no;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		}
		else if (strcmp(rl_alt_id_for_pat_id.arr, "ALT_ID2_NO") == 0 || 
			strcmp(rl_alt_id_for_pat_id.arr, "ALTERNATE_ID2_NUM") == 0)
		{

			/* EXEC SQL SELECT alternate_id2_num
					 INTO :rl_hmc_no
					 FROM MP_PATIENT_MAST
					 WHERE patient_id = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select alternate_id2_num into :b0  from MP_PATIENT_MAST wh\
ere patient_id=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7084;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_hmc_no;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		}
		else if (strcmp(rl_alt_id_for_pat_id.arr, "ALT_ID3_NO") == 0 ||
			strcmp(rl_alt_id_for_pat_id.arr, "ALTERNATE_ID3_NUM") == 0)
		{
			/* EXEC SQL SELECT alternate_id3_num
					 INTO :rl_hmc_no
					 FROM MP_PATIENT_MAST
					 WHERE patient_id = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select alternate_id3_num into :b0  from MP_PATIENT_MAST wh\
ere patient_id=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7107;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_hmc_no;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		}
		else if (strcmp(rl_alt_id_for_pat_id.arr, "ALT_ID4_NO") == 0 ||
			strcmp(rl_alt_id_for_pat_id.arr, "ALTERNATE_ID4_NUM") == 0)
		{
			/* EXEC SQL SELECT alternate_id4_num
					 INTO :rl_hmc_no
					 FROM MP_PATIENT_MAST
					 WHERE patient_id = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select alternate_id4_num into :b0  from MP_PATIENT_MAST wh\
ere patient_id=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7130;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_hmc_no;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		}


		if (NODATAFOUND);

		if (OERROR);

	}

	rl_hmc_no.arr[rl_hmc_no.len]			= '\0';

}
/*------------------------------------------------------------*/



/* *******				16.05.2004 ADDED				******* */

/*-----------------------------------------------------*/
open_result_modify_reason()
{
    /* EXEC SQL OPEN RL_RESULT_MODIFY_REASON_CUR; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = sq0044;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )7153;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[0] = (unsigned int  )23;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )7;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_hosp_no;
    sqlstm.sqhstl[2] = (unsigned int  )23;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_tst_group_test_code;
    sqlstm.sqhstl[3] = (unsigned int  )13;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_tst_test_code;
    sqlstm.sqhstl[4] = (unsigned int  )13;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
         ins_message(ORA_MESG,"OPEN failed on cursor RL_RESULT_MODIFY_REASON_CUR");
}
/*-----------------------------------------------------*/

fetch_result_modify_reason()
{
#ifdef DEBUG
       printf("In fetch_result_modify_reason() \n");
#endif

    rl_res_modify_reason.arr[0]		= '\0';
    rl_res_modify_reason_code.arr[0]		= '\0';
    rl_modify_reason_rel_by.arr[0]  = '\0';
    rl_modify_reason_rel_dt.arr[0]  = '\0';

	rl_modify_numeric_prefix.arr[0] = '\0';
	rl_modify_numeric_prefix.len = 0;
	rl_modify_numeric_result.arr[0] = '\0';
	rl_modify_numeric_result.len = 0;
	rl_modify_components_ind.arr[0] = '\0';
	rl_modify_components_ind.len = 0;
	rl_num_component_modified = 0;

    /* EXEC SQL FETCH RL_RESULT_MODIFY_REASON_CUR
              INTO rl_res_modify_reason_code,rl_res_modify_reason,
				   rl_modify_reason_rel_by,rl_modify_reason_rel_dt,
				   rl_modify_numeric_prefix,rl_modify_numeric_result,
				   rl_modify_components_ind,rl_num_component_modified; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )7188;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_res_modify_reason_code;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&rl_res_modify_reason;
    sqlstm.sqhstl[1] = (unsigned int  )43;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&rl_modify_reason_rel_by;
    sqlstm.sqhstl[2] = (unsigned int  )33;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&rl_modify_reason_rel_dt;
    sqlstm.sqhstl[3] = (unsigned int  )33;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&rl_modify_numeric_prefix;
    sqlstm.sqhstl[4] = (unsigned int  )4;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&rl_modify_numeric_result;
    sqlstm.sqhstl[5] = (unsigned int  )18;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&rl_modify_components_ind;
    sqlstm.sqhstl[6] = (unsigned int  )23;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&rl_num_component_modified;
    sqlstm.sqhstl[7] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			  
    if (OERROR)
         ins_message(ORA_MESG,"FETCH failed on cursor RL_RESULT_MODIFY_REASON_CUR",0,"");

    rl_res_modify_reason.arr[rl_res_modify_reason.len] = '\0';
    rl_res_modify_reason_code.arr[rl_res_modify_reason_code.len] = '\0';
    rl_modify_reason_rel_by.arr[rl_modify_reason_rel_by.len] = '\0';
    rl_modify_reason_rel_dt.arr[rl_modify_reason_rel_dt.len] = '\0';
	rl_modify_numeric_prefix.arr[rl_modify_numeric_prefix.len] = '\0';
	rl_modify_numeric_result.arr[rl_modify_numeric_result.len] = '\0';
	rl_modify_components_ind.arr[rl_modify_components_ind.len] = '\0';

    return (LAST_ROW?0:1);
}


/*-----------------------------------------------------*/

get_modify_reason_print_yn_for_code()
{



    nd_res_modify_reason_print_yn.arr[0] = '\0';
    nd_res_modify_reason_print_yn.len    = 0;

   /* EXEC SQL SELECT nvl(print_yn,'N')
			INTO :nd_res_modify_reason_print_yn
			FROM RL_REASON_CODE
			WHERE reason_code = :rl_res_modify_reason_code; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select nvl(print_yn,'N') into :b0  from RL_REASON_CODE whe\
re reason_code=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7235;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_res_modify_reason_print_yn;
   sqlstm.sqhstl[0] = (unsigned int  )4;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_res_modify_reason_code;
   sqlstm.sqhstl[1] = (unsigned int  )7;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if(OERROR)
   	    strcpy(nd_res_modify_reason_print_yn.arr,"N");;

	if (NODATAFOUND)
	    strcpy(nd_res_modify_reason_print_yn.arr,"N");

	nd_res_modify_reason_print_yn.arr[nd_res_modify_reason_print_yn.len]	= '\0';

}

/*-----------------------------------------------------*/

print_result_modify_reason()
{
 
  if (something_to_print_for_test > 0)
  {

	open_result_modify_reason();

	_flushall();
  
	test_printed = 0;	

	while(fetch_result_modify_reason())
	{
     strcpy(nd_res_modify_reason_print_yn.arr,"N");

	 if (rl_res_modify_reason_code.len)
	    get_modify_reason_print_yn_for_code();
     else
	    strcpy(nd_res_modify_reason_print_yn.arr,"Y");;

	 if((strcmp(rl_print_prev_modified_result_yn.arr,"Y") == 0 && rl_num_component_modified > 0) ||
		(rl_res_modify_reason.len && strcmp(nd_res_modify_reason_print_yn.arr,"Y")== 0))			

//07.03.2006 if (rl_res_modify_reason.len && strcmp(nd_res_modify_reason_print_yn.arr,"Y")== 0)

     {

       if(test_printed)
       {  

//07.03.2006	      sprintf(text_line,"%-17.17s%-31.31s%s",rl_modify_reason_rel_dt.arr,
//07.03.2006							rl_modify_reason_rel_by.arr,rl_res_modify_reason.arr);
		  
		  fprintf(fp,"\n");
		  page_break(1);

		  sprintf(text_line,"%-17.17s%-31.31s ",rl_modify_reason_rel_dt.arr,
														rl_modify_reason_rel_by.arr);
		  fprintf(fp,"%s",text_line);

		  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		  print_html_line (text_line,out_str);
		  sprintf(l_html_bdy_str,"%s<td class=font_disp>%s",l_html_bdy_str,out_str);
		  strcpy(out_str,"");

		  if (rl_res_modify_reason.len && strcmp(nd_res_modify_reason_print_yn.arr,"Y")== 0)
		  {
			 sprintf(text_line,"%s",rl_res_modify_reason.arr);
	 		 fprintf(fp,"%s",text_line);
			 print_html_line (text_line,out_str);
			 sprintf(l_html_bdy_str,"%s%s",l_html_bdy_str,out_str);
			 strcpy(out_str,"");
		  }

		  if((strcmp(rl_print_prev_modified_result_yn.arr,"Y") == 0 && rl_num_component_modified > 0) && 
					((rl_tst_cd_numeric_result_yn.arr[0] == 'Y') &&
											(rl_num_result_hide_yn.arr[0]	== 'N')
					)
			 )
		  {
		   fprintf(fp,"\n");

		   sprintf(l_html_bdy_str,"%s</td></tr></table>",l_html_bdy_str);
		   write_html(fp4,l_html_bdy_str);
		   strcpy(l_html_bdy_str,"");

		   page_break(1);
//		   sprintf(text_line,"Numeric Result: %s%s",rl_modify_numeric_prefix.arr,rl_modify_numeric_result.arr);
		   sprintf(text_line,"%41s%s%-10s%-10s"," ",rl_modify_numeric_prefix.arr,rl_modify_numeric_result.arr,rl_tst_cd_test_units_desc.arr);
	 	   fprintf(fp,"%s",text_line);

		   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		   print_html_line (text_line,out_str);
		   sprintf(l_html_bdy_str,"%s<td class=font_disp>%s",l_html_bdy_str,out_str);
		   strcpy(out_str,"");
		  }

///07.03.2006 fprintf(fp,"%s",text_line);
       }
       else
       {
	      
//07.03.2006  sprintf(text_line,"(%s","Reason for Modification: ");

		  fprintf(fp,"%c&k4S",ESC); 
   		  fprintf(fp,"%c(s4B",ESC);
		  fprintf(fp, "[");
		  fprintf(fp,"%c&k4S",ESC); 
   		  fprintf(fp,"%c(s-3B",ESC);   		  

		  sprintf(text_line,"%s","Above result has been modified: ");   ///07.03.2006

		  fprintf(fp,"%s",text_line);
		  fprintf(fp,"\n");

		  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		  print_html_line (text_line,out_str);
		  sprintf(l_html_bdy_str,"%s<td class=font_disp><b>[</b>%s</td></tr></table>",l_html_bdy_str,out_str);
		  strcpy(out_str,"");
		  write_html(fp4,l_html_bdy_str);
          strcpy(l_html_bdy_str,"");

		  page_break(1); 

//07.03.2006 sprintf(text_line,"%-17.17s%-31.31s%s",rl_modify_reason_rel_dt.arr,
//07.03.2006			rl_modify_reason_rel_by.arr,rl_res_modify_reason.arr);

		  sprintf(text_line,"%-17.17s%-31.31s ",rl_modify_reason_rel_dt.arr,
														rl_modify_reason_rel_by.arr);
		  fprintf(fp,"%s",text_line);

		  sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		  sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		  print_html_line (text_line,out_str);
		  sprintf(l_html_bdy_str,"%s<td class=font_disp>%s",l_html_bdy_str,out_str);
		  strcpy(out_str,"");

		  if (rl_res_modify_reason.len && strcmp(nd_res_modify_reason_print_yn.arr,"Y")== 0)
		  {
			 sprintf(text_line,"%s",rl_res_modify_reason.arr);
	 		 fprintf(fp,"%s",text_line);
			 print_html_line (text_line,out_str);
			 sprintf(l_html_bdy_str,"%s%s",l_html_bdy_str,out_str);
		  }
		 
		  if((strcmp(rl_print_prev_modified_result_yn.arr,"Y") == 0 && rl_num_component_modified > 0) && 
					((rl_tst_cd_numeric_result_yn.arr[0] == 'Y') &&
											(rl_num_result_hide_yn.arr[0]	== 'N')
					)
			 )
		  {
		   fprintf(fp,"\n");

		   sprintf(l_html_bdy_str,"%s</td></tr></table>",l_html_bdy_str);
		   write_html(fp4,l_html_bdy_str);
		   strcpy(l_html_bdy_str,"");

		   page_break(1);

		   sprintf(text_line,"%41s%s%-10s%-10s"," ",rl_modify_numeric_prefix.arr,rl_modify_numeric_result.arr,rl_tst_cd_test_units_desc.arr);
	 	   fprintf(fp,"%s",text_line);

		   sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		   sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		   print_html_line (text_line,out_str);
		   sprintf(l_html_bdy_str,"%s<td class=font_disp>%s",l_html_bdy_str,out_str);
		   strcpy(out_str,"");

		  }

//07.03.2006  fprintf(fp,"%s",text_line);
	      test_printed = 1;
       }

     }
   }
   if (test_printed) 
   {
	   fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s4B",ESC);
	   fprintf(fp, "]");
	   fprintf(fp,"%c&k4S",ESC); 
   	   fprintf(fp,"%c(s-3B",ESC);   		  

	   fprintf(fp,"\n");

	   sprintf(l_html_bdy_str,"%s<b>]</b></td></tr></table>",l_html_bdy_str);
	   write_html(fp4,l_html_bdy_str);
	   strcpy(l_html_bdy_str,"");

	   page_break(1);
   }

   	close_result_modify_reason_cur(); 

   _flushall();
 }

}


/*-----------------------------------------------------*/

close_result_modify_reason_cur()
{
	/* EXEC SQL CLOSE RL_RESULT_MODIFY_REASON_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7258;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		ins_message(ORA_MESG,"CLOSE failed on cursor RL_RESULT_MODIFY_REASON_CUR");

}

/*-----------------------------------------------------*/

check_for_print_destn_type()
{

 if (((rl_hdr_episode_type.arr[0] == 'I') &&  (strcmp(rl_rep_inpatient_yn.arr, "Y") == 0 )) ||
    ((rl_hdr_episode_type.arr[0] == 'O') &&  (strcmp(rl_rep_outpatient_yn.arr, "Y") == 0 )) ||
    ((rl_hdr_episode_type.arr[0] == 'H') &&  (strcmp(rl_rep_referral_yn.arr, "Y") == 0 ))   ||
	((rl_hdr_episode_type.arr[0] == 'I') && (strcmp(l_rep_disch_pat_result.arr, "Y") == 0)) ||
    ((rl_hdr_episode_type.arr[0] == 'R') &&  (strcmp(rl_rep_external_yn.arr, "Y") == 0 )))   
	{
		l_destn_rep_yn = 'Y';
	}
 else
    l_destn_rep_yn = 'N'; 
   
 if (((rl_hdr_episode_type.arr[0] == 'I') &&  (strcmp(rl_fax_inpatient_yn.arr, "Y") == 0 )) ||
    ((rl_hdr_episode_type.arr[0] == 'O') &&  (strcmp(rl_fax_outpatient_yn.arr, "Y") == 0 )) ||
	((rl_hdr_episode_type.arr[0] == 'H') &&  (strcmp(rl_fax_referral_yn.arr, "Y") == 0 ))   ||
    ((rl_hdr_episode_type.arr[0] == 'I') && (strcmp(l_fax_disch_pat_result.arr, "Y") == 0)) ||	 
	((rl_hdr_episode_type.arr[0] == 'R') &&  (strcmp(rl_fax_external_yn.arr, "Y") == 0 )) )
	{
		l_destn_fax_yn = 'Y';
	}
 else
    l_destn_fax_yn = 'N';  


 if (((rl_hdr_episode_type.arr[0] == 'I') &&  (strcmp(rl_mail_inpatient_yn.arr, "Y") == 0 )) ||
    ((rl_hdr_episode_type.arr[0] == 'O') &&  (strcmp(rl_mail_outpatient_yn.arr, "Y") == 0 )) ||
	((rl_hdr_episode_type.arr[0] == 'H') &&  (strcmp(rl_mail_referral_yn.arr, "Y") == 0 ))   ||
    ((rl_hdr_episode_type.arr[0] == 'I') && (strcmp(l_mail_disch_pat_result.arr, "Y") == 0)) ||	 
	((rl_hdr_episode_type.arr[0] == 'R') &&  (strcmp(rl_mail_external_yn.arr, "Y") == 0 )) )
	{
		l_destn_mail_yn = 'Y';
	}
 else
    l_destn_mail_yn = 'N';  


///////////// added the below on 20.03.2005 

  if (p_param8.arr[0] == 'P' || (strcmp(p_param7.arr, "L") == 0) 
								|| (strcmp(p_param7.arr, "X") == 0))
  {
	l_destn_rep_yn = 'Y';
	if (strcmp(p_param9.arr,"REPRINT") == 0) 
	{
	  if(strcmp(p_param10.arr, "Y") == 0 ) 
		l_destn_rep_yn = 'Y';
	  else
		l_destn_rep_yn = 'N';
	}
    
	l_destn_fax_yn = 'N';

	if (strcmp(p_param9.arr,"REPRINT") == 0) 
	{
	  if (strcmp(p_param11.arr, "Y") == 0 ) 	
		l_destn_fax_yn = 'Y';
	  else	
		l_destn_fax_yn = 'N';  
	}

	l_destn_mail_yn = 'N';
	if (strcmp(p_param9.arr,"REPRINT") == 0) 
	{
	  if (strcmp(p_param12.arr, "Y") == 0 ) 	
		l_destn_mail_yn = 'Y';
	  else	
		l_destn_mail_yn = 'N';  
	}

  }
///////////////// upto here added on 20.03.2005
   

}


/*-----------------------------------------------------*/
gen_file_name_fax()
{



	nd_get_fax_dir.arr[0]		= '\0';
	nd_get_fax_dir.len			= 0;
    strcpy(nd_get_fax_dir.arr,"Y");
	nd_get_fax_dir.len = strlen(nd_get_fax_dir.arr);



	get_sm_installation();



	if (strcmp(BVNewVersionYN.arr,"Y") == 0)
	{



	 /* EXEC SQL EXECUTE 
		  begin
			declare
				v_file_name VARCHAR2(2500);
				v_err_txt   VARCHAR2(2500);
			begin
			   :nd_get_fax_dir := 'N';

//insert into rl_error values('RLRRSENQ',:sy_ws_no,'gen_file_name_fax()..specno='||:rl_prn_ctrl_hdr_sp_no);

				workstation.get_ws_param(:sy_ws_no,           
								 'FAX_MAIL_FILE_LOCN',
								  v_file_name,  
								  v_err_txt     
										 );
//insert into rl_error values('RLRRSENQ',SUBSTR(v_file_name,1,50),'gen_file_name_fax()..specno='||:rl_prn_ctrl_hdr_sp_no||',errortext='||substr(v_err_txt,1,20));

				if v_err_txt is null then
					if v_file_name is not null then
						:nd_file_name_fax := v_file_name;
					end if;
				else
					:nd_file_name_fax := null;   
				end if;			    
			end;
			
		end;  
	 END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "begin declare v_file_name VARCHAR2 ( 2500 ) ; v_err_txt VAR\
CHAR2 ( 2500 ) ; begin :nd_get_fax_dir := 'N' ; workstation . get_ws_param ( :\
sy_ws_no , 'FAX_MAIL_FILE_LOCN' , v_file_name , v_err_txt ) ; if v_err_txt is \
null then if v_file_name is not null then :nd_file_name_fax := v_file_name ; e\
nd if ; else :nd_file_name_fax := null ; end if ; end ; end ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7273;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_get_fax_dir;
  sqlstm.sqhstl[0] = (unsigned int  )4;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&sy_ws_no;
  sqlstm.sqhstl[1] = (unsigned int  )33;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_file_name_fax;
  sqlstm.sqhstl[2] = (unsigned int  )2522;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}
	 nd_get_fax_dir.arr[nd_get_fax_dir.len]	= '\0';



	 if (strcmp(nd_get_fax_dir.arr,"Y") == 0)     /// 29.07.2004
	 {



      ///    GetPrivateProfileStringA("Reports","Fax_Dir","",nd_file_name_fax.arr,sizeof(nd_file_name_fax.arr),"medicom.ini");

				wordir=(char*) malloc(200* sizeof(char));

				fax_i=GetPrivateProfileString("Reports","Fax_Dir","",wordir,200,"medicom.ini");

				wordir[fax_i]='\0';

				strcpy(nd_file_name_fax.arr,wordir);
				nd_file_name_fax.len = strlen(nd_file_name_fax.arr);

	  }

     if (OERROR)
         ins_message(ORA_MESG,"Fetch failed on while getting file number2");
      

     nd_file_name_fax.arr[nd_file_name_fax.len] = '\0';
/*
     p_rep_file_fax.arr[0]   = '\0';   
     p_rep_file_fax.len      = 0;

     p_rep_file_fax_ext.arr[0]   = '\0';   
     p_rep_file_fax_ext.len      = 0;

     sprintf(p_rep_file_fax.arr,"%srslt_%s.lis", nd_file_name_fax.arr,nd_file_no.arr);


	 sprintf(p_rep_file_fax_ext.arr,"%srslt_%s.ext",nd_file_name_fax.arr,nd_file_no.arr);

*/

}
/*-----------------------------------------------------*/

/*** only for qatar ***/
get_nationality_desc()
{
	nd_nationality_desc.arr[0]		= '\0';
	nd_nationality_desc.len			= 0;

 /*
   EXEC SQL SELECT nationality
			INTO :nd_nationality_desc
			FROM MP_COUNTRY_HIS_VW
			WHERE country_code = :rl_pat_nationality;*/
   /* EXEC SQL SELECT short_name
			INTO :nd_nationality_desc
			FROM MP_COUNTRY_LANG_VW
			WHERE country_code = :rl_pat_nationality
			AND   language_id =:language_id ; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select short_name into :b0  from MP_COUNTRY_LANG_VW where \
(country_code=:b1 and language_id=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7300;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_nationality_desc;
   sqlstm.sqhstl[0] = (unsigned int  )23;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_pat_nationality;
   sqlstm.sqhstl[1] = (unsigned int  )8;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&language_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      if(OERROR);

	if (NODATAFOUND);

	nd_nationality_desc.arr[nd_nationality_desc.len]	= '\0';

}
/*------------------------------------------------------------*/

get_snomed_marker_desc1()
{
	nd_snomed_mrkr_desc1.arr[0]		= '\0';
	nd_snomed_mrkr_desc1.len		= 0;

    nd_snomed_mrkr1_print_yn.arr[0] = '\0';
    nd_snomed_mrkr1_print_yn.len    = 0;

   /* EXEC SQL SELECT long_desc,print_yn
			INTO :nd_snomed_mrkr_desc1,:nd_snomed_mrkr1_print_yn
			FROM RL_SNOMED_MARKER_lang_vw
			WHERE snomed_marker_code = :rl_res_snomed_mrkr_code1
			and language_id = :language_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select long_desc ,print_yn into :b0,:b1  from RL_SNOMED_MA\
RKER_lang_vw where (snomed_marker_code=:b2 and language_id=:b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7327;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_snomed_mrkr_desc1;
   sqlstm.sqhstl[0] = (unsigned int  )43;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_snomed_mrkr1_print_yn;
   sqlstm.sqhstl[1] = (unsigned int  )4;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_res_snomed_mrkr_code1;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&language_id;
   sqlstm.sqhstl[3] = (unsigned int  )7;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if(OERROR);

	if (NODATAFOUND);

	nd_snomed_mrkr_desc1.arr[nd_snomed_mrkr_desc1.len]	= '\0';
	nd_snomed_mrkr1_print_yn.arr[nd_snomed_mrkr1_print_yn.len]	= '\0';

}
/*------------------------------------------------------------*/

get_snomed_marker_desc2()
{
	nd_snomed_mrkr_desc2.arr[0]		= '\0';
	nd_snomed_mrkr_desc2.len		= 0;

    nd_snomed_mrkr2_print_yn.arr[0] = '\0';
    nd_snomed_mrkr2_print_yn.len    = 0;

   /* EXEC SQL SELECT long_desc,print_yn
			INTO :nd_snomed_mrkr_desc2,:nd_snomed_mrkr2_print_yn
			FROM RL_SNOMED_MARKER_lang_vw
			WHERE snomed_marker_code = :rl_res_snomed_mrkr_code2
			and language_id = :language_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select long_desc ,print_yn into :b0,:b1  from RL_SNOMED_MA\
RKER_lang_vw where (snomed_marker_code=:b2 and language_id=:b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7358;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_snomed_mrkr_desc2;
   sqlstm.sqhstl[0] = (unsigned int  )43;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_snomed_mrkr2_print_yn;
   sqlstm.sqhstl[1] = (unsigned int  )4;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_res_snomed_mrkr_code2;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&language_id;
   sqlstm.sqhstl[3] = (unsigned int  )7;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if(OERROR);

	if (NODATAFOUND);

	nd_snomed_mrkr_desc2.arr[nd_snomed_mrkr_desc2.len]	= '\0';
	nd_snomed_mrkr2_print_yn.arr[nd_snomed_mrkr2_print_yn.len]	= '\0';

}
/*------------------------------------------------------------*/

print_snomed_marker1()
{
	if (strcmp(nd_snomed_mrkr1_print_yn.arr,"Y") == 0 && nd_snomed_mrkr_desc1.len != 0)
	{
         something_to_print = 1;
		 something_to_print_for_test = 1;

/********** no heading, no margin is needed
         if (l_snomed_head_printed == 0)
		 {
	 		fprintf(fp, "SNOMED : \n");
			l_snomed_head_printed = 1;
		    page_break(1);
		 }
         else
	 		fprintf(fp, "         ");
**********/

		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 fprintf(fp,"%s\n",nd_snomed_mrkr_desc1.arr);
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	     sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
	     
		 print_html_line(nd_snomed_mrkr_desc1.arr,out_str);
		 sprintf(l_html_bdy_str,"%s<td class=font_disp><b>%s</b></td></tr></table>",l_html_bdy_str,out_str);
		 strcpy(out_str,"");
		 write_html(fp4,l_html_bdy_str);
		 strcpy(l_html_bdy_str,"");	     
		 
		 page_break(1);
	} 

}

/*------------------------------------------------------------*/

print_snomed_marker2()
{

	if (strcmp(nd_snomed_mrkr2_print_yn.arr,"Y") == 0 && nd_snomed_mrkr_desc2.len != 0)
	{
         something_to_print = 1;
		 something_to_print_for_test = 1;

/****** no heading, no margin is needed
         if (l_snomed_head_printed == 0)
		 {
	 		fprintf(fp, "SNOMED : \n");
			l_snomed_head_printed = 1;
		    page_break(1);
		 }
         else
	 		fprintf(fp, "         ");
**************/ 

		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 fprintf(fp,"%s\n",nd_snomed_mrkr_desc2.arr);
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	     sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
	     
		 print_html_line(nd_snomed_mrkr_desc2.arr,out_str);
		 sprintf(l_html_bdy_str,"%s<td class=font_disp><b>%s</b></td></tr></table>",l_html_bdy_str,out_str);
		 strcpy(out_str,"");
		 write_html(fp4,l_html_bdy_str);
		 strcpy(l_html_bdy_str,"");

	     page_break(1);
	}

}

/*------------------------------------------------------------*/

/**************** added on 29.07.2004 *****************************************/

	/*** Code added to check and Print the Past results based on setup ***/

print_past_results()
{
	if (strcmp(rl_print_prv_result_yn.arr, "Y") == 0 )
	{
		/* EXEC SQL SELECT NVL(PERIOD_FOR_PAST_RESULTS,0),NVL(NO_OF_PAST_RESULTS,0),
		                PAST_RESULT_UNITS
				 INTO :d_past_result_period, :d_past_result_no, :d_past_result_unit
				 FROM RL_TEST_PAST_RESULT
				 WHERE test_code = :rl_tst_test_code
				 AND   result_type_ind = 'REP'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select NVL(PERIOD_FOR_PAST_RESULTS,0) ,NVL(NO_OF_PAST_RESUL\
TS,0) ,PAST_RESULT_UNITS into :b0,:b1,:b2  from RL_TEST_PAST_RESULT where (tes\
t_code=:b3 and result_type_ind='REP')";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7389;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_past_result_period;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_past_result_no;
  sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d_past_result_unit;
  sqlstm.sqhstl[2] = (unsigned int  )8;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&rl_tst_test_code;
  sqlstm.sqhstl[3] = (unsigned int  )13;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		if (d_past_result_period)
		{
			if (strcmp(d_past_result_unit.arr, "YRS") == 0) 
			{
				/* EXEC SQL SELECT TO_CHAR(ADD_MONTHS(TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), -12*:d_past_result_period),
					                    'DD/MM/YYYY HH24:MI')
						 INTO :nd_prv_result_dt
						FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_CHAR(ADD_MONTHS(TO_DATE(:b0,'DD/MM/YYYY HH24:MI\
'),((-12)* :b1)),'DD/MM/YYYY HH24:MI') into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )7420;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time;
    sqlstm.sqhstl[0] = (unsigned int  )19;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_past_result_period;
    sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_prv_result_dt;
    sqlstm.sqhstl[2] = (unsigned int  )33;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			}
			if (strcmp(d_past_result_unit.arr, "MTHS") == 0)
			{
				/* EXEC SQL SELECT TO_CHAR(ADD_MONTHS(TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), -1*:d_past_result_period),
										'DD/MM/YYYY HH24:MI')
						 INTO :nd_prv_result_dt
						 FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_CHAR(ADD_MONTHS(TO_DATE(:b0,'DD/MM/YYYY HH24:MI\
'),((-1)* :b1)),'DD/MM/YYYY HH24:MI') into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )7447;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time;
    sqlstm.sqhstl[0] = (unsigned int  )19;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_past_result_period;
    sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_prv_result_dt;
    sqlstm.sqhstl[2] = (unsigned int  )33;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			}
			if (strcmp(d_past_result_unit.arr, "WKS") == 0)
			{
				/* EXEC SQL SELECT TO_CHAR(TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI') - 7*:d_past_result_period, 'DD/MM/YYYY HH24:MI')
						 INTO :nd_prv_result_dt
						 FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_CHAR((TO_DATE(:b0,'DD/MM/YYYY HH24:MI')-(7* :b1\
)),'DD/MM/YYYY HH24:MI') into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )7474;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time;
    sqlstm.sqhstl[0] = (unsigned int  )19;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_past_result_period;
    sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_prv_result_dt;
    sqlstm.sqhstl[2] = (unsigned int  )33;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			}
			if (strcmp(d_past_result_unit.arr, "DAY") == 0)
			{
				/* EXEC SQL SELECT TO_CHAR(TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI') - 1*:d_past_result_period, 'DD/MM/YYYY HH24:MI')
						 INTO :nd_prv_result_dt
						 FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_CHAR((TO_DATE(:b0,'DD/MM/YYYY HH24:MI')-(1* :b1\
)),'DD/MM/YYYY HH24:MI') into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )7501;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time;
    sqlstm.sqhstl[0] = (unsigned int  )19;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_past_result_period;
    sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_prv_result_dt;
    sqlstm.sqhstl[2] = (unsigned int  )33;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			}
			if (strcmp(d_past_result_unit.arr, "HRS") == 0)
			{
				/* EXEC SQL SELECT TO_CHAR(TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI') - (1/24)*:d_past_result_period, 'DD/MM/YYYY HH24:MI')
						 INTO :nd_prv_result_dt
						 FROM DUAL; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select TO_CHAR((TO_DATE(:b0,'DD/MM/YYYY HH24:MI')-((1/24)\
* :b1)),'DD/MM/YYYY HH24:MI') into :b2  from DUAL ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )7528;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time;
    sqlstm.sqhstl[0] = (unsigned int  )19;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_past_result_period;
    sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_prv_result_dt;
    sqlstm.sqhstl[2] = (unsigned int  )33;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			}



			dclr_test_result_prv_cur();

	        p_count = 0;
			past_results_head_printed = 0;
			while(fetch_test_result_prv_cur())
			{
				if (d_num_result_hide_yn.arr[0] == 'N')
					ge_prev_result_line(); 

				p_count++;

				if (p_count == d_past_result_no)
				{
					break;
				}
				

			}


		}
	}
}

/*-------------------------------------------------------------------------------*/

/*** Cursor declared to get the previous results of the Test Code  from the RL_TEST_RESULT ***/

dclr_test_result_prv_cur() 
{

    /* EXEC SQL DECLARE test_result_prv_cur CURSOR FOR
         SELECT TO_CHAR(A.specimen_no), A.test_code, A.numeric_result, NVL(A.numeric_prefix,'+'), 
				A.status, A.test_units, A.age_range_low, A.age_range_high, A.high_low_ind,
				TO_CHAR(B.spec_regd_date_time,'DD/MM/YYYY HH24:MI'),B.operating_facility_id,
				NVL(A.numeric_result_hide_yn, 'N') numeric_result_hide_yn
           FROM RL_TEST_RESULT A, RL_REQUEST_HEADER B
           WHERE B.patient_id = :nd_hosp_no
		   AND B.patient_id = A.patient_id
		   AND B.specimen_no = A.specimen_no
		   AND B.operating_facility_id = A.operating_facility_id
		   AND A.test_code = :rl_tst_test_code
		   AND A.specimen_no != TO_NUMBER(:nd_spec_no)
           AND B.spec_regd_date_time BETWEEN
		       TO_DATE(:nd_prv_result_dt,'DD/MM/YYYY HH24:MI') AND
		       TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI')
           AND NVL(A.cancelled_yn, 'N') <> 'Y'
		   AND NVL(A.status,'O') IN ('R','P')
		   ORDER BY B.spec_regd_date_time desc; */ 


//AND NVL(B.spec_regd_date_time,TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI')) >= 
//		       TO_DATE(:nd_prv_result_dt,'DD/MM/YYYY HH24:MI')
//           AND NVL(B.spec_regd_date_time,TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI')) <= 
//		       TO_DATE(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI')
//		   ORDER BY A.reviewed_date desc;


	/* EXEC SQL OPEN test_result_prv_cur; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0170;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7555;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
 sqlstm.sqhstl[0] = (unsigned int  )23;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&rl_tst_test_code;
 sqlstm.sqhstl[1] = (unsigned int  )13;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[2] = (unsigned int  )23;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_prv_result_dt;
 sqlstm.sqhstl[3] = (unsigned int  )33;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&rl_hdr_spec_regd_date_time;
 sqlstm.sqhstl[4] = (unsigned int  )19;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}

/*-----------------------------------------------------------------------------------------*/

/*** Added to fetch the Previous results for the Test ***/

fetch_test_result_prv_cur()
{
  d_prv_specimen_no.arr[0]          = '\0';
  d_prv_specimen_no.len				= 0;

  d_tst_prv_test_code.arr[0]		= '\0';
  d_tst_prv_test_code.len			= 0;
  
  d_tst_prv_numeric_result.arr[0]	= '\0';
  d_tst_prv_numeric_result.len		= 0;

  d_num_prv_prefix.arr[0]			= '\0';
  d_num_prv_prefix.len				= 0;

  d_status_prv.arr[0]				= '\0';
  d_status_prv.len					= 0;

  d_tst_prv_units.arr[0]			= '\0';
  d_tst_prv_units.len				= 0;

  d_tst_prv_age_range_low.arr[0]	= '\0';
  d_tst_prv_age_range_low.len		= 0;

  d_tst_prv_age_range_high.arr[0]	= '\0';
  d_tst_prv_age_range_high.len		= 0;

  d_tst_prv_high_low_ind.arr[0]		= '\0';
  d_tst_prv_high_low_ind.len		= 0;

  d_prv_spec_regd_date_time.arr[0]	= '\0';
  d_prv_spec_regd_date_time.len		= 0;

  d_prv_spec_facility_id.arr[0]		= '\0';
  d_prv_spec_facility_id.len		= 0;

  d_num_result_hide_yn.arr[0]		= '\0';
  d_num_result_hide_yn.len			= 0;

  /* EXEC SQL FETCH test_result_prv_cur
		   INTO :d_prv_specimen_no,	
				:d_tst_prv_test_code,
				:d_tst_prv_numeric_result,
				:d_num_prv_prefix,
				:d_status_prv,
				:d_tst_prv_units,
				:d_tst_prv_age_range_low,
				:d_tst_prv_age_range_high,
				:d_tst_prv_high_low_ind,
				:d_prv_spec_regd_date_time,
				:d_prv_spec_facility_id,
				:d_num_result_hide_yn; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7590;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_prv_specimen_no;
  sqlstm.sqhstl[0] = (unsigned int  )23;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_tst_prv_test_code;
  sqlstm.sqhstl[1] = (unsigned int  )13;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d_tst_prv_numeric_result;
  sqlstm.sqhstl[2] = (unsigned int  )18;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d_num_prv_prefix;
  sqlstm.sqhstl[3] = (unsigned int  )4;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&d_status_prv;
  sqlstm.sqhstl[4] = (unsigned int  )4;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&d_tst_prv_units;
  sqlstm.sqhstl[5] = (unsigned int  )13;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&d_tst_prv_age_range_low;
  sqlstm.sqhstl[6] = (unsigned int  )18;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&d_tst_prv_age_range_high;
  sqlstm.sqhstl[7] = (unsigned int  )18;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqhstv[8] = (         void  *)&d_tst_prv_high_low_ind;
  sqlstm.sqhstl[8] = (unsigned int  )12;
  sqlstm.sqhsts[8] = (         int  )0;
  sqlstm.sqindv[8] = (         void  *)0;
  sqlstm.sqinds[8] = (         int  )0;
  sqlstm.sqharm[8] = (unsigned int  )0;
  sqlstm.sqadto[8] = (unsigned short )0;
  sqlstm.sqtdso[8] = (unsigned short )0;
  sqlstm.sqhstv[9] = (         void  *)&d_prv_spec_regd_date_time;
  sqlstm.sqhstl[9] = (unsigned int  )33;
  sqlstm.sqhsts[9] = (         int  )0;
  sqlstm.sqindv[9] = (         void  *)0;
  sqlstm.sqinds[9] = (         int  )0;
  sqlstm.sqharm[9] = (unsigned int  )0;
  sqlstm.sqadto[9] = (unsigned short )0;
  sqlstm.sqtdso[9] = (unsigned short )0;
  sqlstm.sqhstv[10] = (         void  *)&d_prv_spec_facility_id;
  sqlstm.sqhstl[10] = (unsigned int  )5;
  sqlstm.sqhsts[10] = (         int  )0;
  sqlstm.sqindv[10] = (         void  *)0;
  sqlstm.sqinds[10] = (         int  )0;
  sqlstm.sqharm[10] = (unsigned int  )0;
  sqlstm.sqadto[10] = (unsigned short )0;
  sqlstm.sqtdso[10] = (unsigned short )0;
  sqlstm.sqhstv[11] = (         void  *)&d_num_result_hide_yn;
  sqlstm.sqhstl[11] = (unsigned int  )4;
  sqlstm.sqhsts[11] = (         int  )0;
  sqlstm.sqindv[11] = (         void  *)0;
  sqlstm.sqinds[11] = (         int  )0;
  sqlstm.sqharm[11] = (unsigned int  )0;
  sqlstm.sqadto[11] = (unsigned short )0;
  sqlstm.sqtdso[11] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




  d_prv_specimen_no.arr[d_prv_specimen_no.len]					= '\0';
  d_tst_prv_numeric_result.arr[d_tst_prv_numeric_result.len]	= '\0';
  d_tst_prv_test_code.arr[d_tst_prv_test_code.len]				= '\0';
  d_num_prv_prefix.arr[d_num_prv_prefix.len]					= '\0';
  d_status_prv.arr[d_status_prv.len]							= '\0';
  d_tst_prv_units.arr[d_tst_prv_units.len]						= '\0';
  d_tst_prv_age_range_low.arr[d_tst_prv_age_range_low.len]		= '\0';
  d_tst_prv_age_range_high.arr[d_tst_prv_age_range_high.len]	= '\0';
  d_tst_prv_high_low_ind.arr[d_tst_prv_high_low_ind.len]		= '\0';
  d_prv_spec_regd_date_time.arr[d_prv_spec_regd_date_time.len]	= '\0';
  d_prv_spec_facility_id.arr[d_prv_spec_facility_id.len]		= '\0';
  d_num_result_hide_yn.arr[d_num_result_hide_yn.len]			= '\0';

   return (LAST_ROW?0:1);   

}
/*-----------------------------------------------------------------*/
put_zero_before_decimal_past_result()
{

	if (d_tst_prv_numeric_result.arr[0] != '0')
	{
		strcpy(l_numeric_result, "0");
		strcat(l_numeric_result, d_tst_prv_numeric_result.arr);

		strcpy(d_tst_prv_numeric_result.arr, l_numeric_result);
		d_tst_prv_numeric_result.len = strlen(d_tst_prv_numeric_result.arr);
	}
	

}

/*--------------------------------------------------------------------------------------*/
ge_prev_result_line()
{
char l_str [100];

	if(past_results_head_printed==0)
	{
//		fprintf(fp,"    ");
		fprintf(fp,"[Previous Results]\n");

		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
		sprintf(l_html_bdy_str,"%s<td class=font_disp>[Previous Results]</td></tr></table>",l_html_bdy_str);
		write_html(fp4,l_html_bdy_str);
		strcpy(l_html_bdy_str,"");

		past_results_head_printed = 1;
		page_break(1);
	}

    strcpy(l_str,"");
	sprintf(l_str,"%-15.15s  %s   %s   ",d_prv_specimen_no.arr,d_prv_spec_regd_date_time.arr,
																	d_prv_spec_facility_id.arr);

	something_to_print = 1;
	something_to_print_for_test = 1;
	if (d_tst_prv_numeric_result.len)
	{

	  if ( (atof(d_tst_prv_numeric_result.arr) < 1) && 
												(atof(d_tst_prv_numeric_result.arr) > 0) )
			 put_zero_before_decimal_past_result();

	  numeric_value_flag = TRUE;

	  strcpy(r_rslt.arr, d_tst_prv_numeric_result.arr);
	  r_rslt.len = strlen(r_rslt.arr);
	  add_zero_after_result();
	  strcpy(d_tst_prv_numeric_result.arr, r_rslt.arr);
	  d_tst_prv_numeric_result.len = strlen(d_tst_prv_numeric_result.arr);

	  if(d_num_prv_prefix.arr[0] == '+')
	  {
		 sprintf(l_str,"%s%-10s",l_str,d_tst_prv_numeric_result.arr);  
      }
	  else
	  {
         sprintf(l_str,"%s%c%-10s",l_str,d_num_prv_prefix.arr[0],
													     d_tst_prv_numeric_result.arr);
      }

      sprintf(l_str,"%s%-10s",l_str,d_tst_prv_units.arr);

	  if ( d_tst_prv_age_range_low.len  || d_tst_prv_age_range_high.len )
      {

		  get_zero_prefix_for_range();

		  strcpy(r_rslt.arr, d_tst_prv_age_range_low.arr);
		  r_rslt.len = strlen(r_rslt.arr);
 		  add_zero_after_result();
		  strcpy(d_tst_prv_age_range_low.arr, r_rslt.arr);
		  d_tst_prv_age_range_low.len = strlen(d_tst_prv_age_range_low.arr);

		  strcpy(r_rslt.arr, d_tst_prv_age_range_high.arr);
		  r_rslt.len = strlen(r_rslt.arr);
 		  add_zero_after_result();
		  strcpy(d_tst_prv_age_range_high.arr, r_rslt.arr);
		  d_tst_prv_age_range_high.len = strlen(d_tst_prv_age_range_high.arr);
		

			  sprintf(l_str,"%s %-1s (%s - %s)",l_str,
													  d_tst_prv_high_low_ind.arr,
													  d_tst_prv_age_range_low.arr,
													  d_tst_prv_age_range_high.arr);
      }
 
	}   /*Endif of rl_tst_numeric_result.len */

	//bold_print_check = 1;   

	sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
	sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);	
	
	print_line(l_str);

	//bold_print_check = 0;   


}

/************************** added on 02.09.2004 ************************************/
get_dest_type_n_locn()
{

   if ((rl_hdr_episode_type.arr[0] == 'R') || (rl_hdr_episode_type.arr[0] == 'H'))  
	   strcpy(p_fax_loc_code.arr,rl_hdr_source_code.arr);
   else
	   strcpy(p_fax_loc_code.arr,rl_prn_ctrl_hdr_source_code.arr);

   p_fax_loc_code.len = strlen(p_fax_loc_code.arr);

   if ((rl_hdr_episode_type.arr[0] == 'I'))  
      strcpy(p_fax_loc_type.arr, "W");  

   if ((rl_hdr_episode_type.arr[0] == 'O'))  
      strcpy(p_fax_loc_type.arr, "C");  

   if ((rl_hdr_episode_type.arr[0] == 'R') || (rl_hdr_episode_type.arr[0] == 'H'))  
      strcpy(p_fax_loc_type.arr, "R");  
	  	
   p_fax_loc_type.len = strlen(p_fax_loc_type.arr);

   strcpy(p_mail_loc_code.arr, p_fax_loc_code.arr); // 07.08.2005
   strcpy(p_mail_loc_type.arr,p_fax_loc_type.arr); //

   p_mail_loc_code.len = strlen(p_mail_loc_code.arr); // 07.08.2005
   p_mail_loc_type.len = strlen(p_mail_loc_type.arr); //

   l_episode = 0;


   if (( (rl_hdr_episode_type.arr[0] == 'I') ||
		(rl_hdr_episode_type.arr[0] == 'O') ) && 
		(strcmp(nd_operating_facility_id.arr, rl_ordered_facility_id.arr) == 0) ) 
		
   {

		/* EXEC SQL SELECT open_episode_id
		INTO :l_episode
		FROM IP_OPEN_EPISODE
		WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
		AND   patient_id = :nd_hosp_no; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select open_episode_id into :b0  from IP_OPEN_EPISODE where\
 (FACILITY_ID=NVL(:b1,:b2) and patient_id=:b3)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7653;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_episode;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(long);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )5;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
  sqlstm.sqhstl[2] = (unsigned int  )7;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_hosp_no;
  sqlstm.sqhstl[3] = (unsigned int  )23;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if(NODATAFOUND)
		{

             if (rl_hdr_episode_type.arr[0] == 'I')
			 {
				if (strcmp(l_fax_disch_pat_result.arr, "Y") == 0)
				{
					strcpy(p_fax_loc_type.arr, "W");
					p_fax_loc_type.len = strlen(p_fax_loc_type.arr);
					strcpy(p_fax_loc_code.arr, rl_hdr_source_code.arr);
					p_fax_loc_code.len = strlen(rl_hdr_source_code.arr);

				}
				if (strcmp(l_mail_disch_pat_result.arr, "Y") == 0) // 07.08.2005
				{
					strcpy(p_mail_loc_type.arr, "W");
					p_mail_loc_type.len = strlen(p_mail_loc_type.arr);
					strcpy(p_mail_loc_code.arr, rl_hdr_source_code.arr);
					p_mail_loc_code.len = strlen(rl_hdr_source_code.arr);

				}
			 }
			 else
			 {
				strcpy(p_fax_loc_type.arr, "C");
				p_fax_loc_type.len = strlen(p_fax_loc_type.arr);

				strcpy(p_mail_loc_type.arr, "C");  /// 07.08.2005
				p_mail_loc_type.len = strlen(p_mail_loc_type.arr);  //
			 }

		}
		else
		{

			/* EXEC SQL SELECT  'W'
			INTO :p_fax_loc_type
			FROM IP_EPISODE
			WHERE FACILITY_ID = NVL(:rl_ordered_facility_id, :nd_operating_facility_id)
			AND episode_id = :l_episode
			AND patient_id = :nd_hosp_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select 'W' into :b0  from IP_EPISODE where ((FACILITY_ID=N\
VL(:b1,:b2) and episode_id=:b3) and patient_id=:b4)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7684;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&p_fax_loc_type;
   sqlstm.sqhstl[0] = (unsigned int  )12;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
   sqlstm.sqhstl[1] = (unsigned int  )5;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&l_episode;
   sqlstm.sqhstl[3] = (unsigned int  )sizeof(long);
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[4] = (unsigned int  )23;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




			if(NODATAFOUND)
			{
			  strcpy(p_fax_loc_type.arr, "C");
			  p_fax_loc_type.len = strlen(p_fax_loc_type.arr);
			}

		   strcpy(p_mail_loc_type.arr,p_fax_loc_type.arr); // 07.08.2005


		}
		
   }

	  p_fax_loc_type.len = strlen(p_fax_loc_type.arr);
	  p_mail_loc_type.len = strlen(p_mail_loc_type.arr); // 07.08.2005

}


/***************** upto here added 02.09.2004 ***************************************/

/**************************************************************/
get_sm_installation()
{
 
	BVNewVersionYN.arr[0] = '\0';
	BVNewVersionYN.len = 0;
	strcpy(BVNewVersionYN.arr,"N");

	/* EXEC SQL EXECUTE 
	BEGIN 
		IF sm_installation_tab_check THEN
			:BVNewVersionYN := 'Y';
		ELSE
			:BVNewVersionYN := 'N';
		END IF;
	END ;
	END-EXEC ; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin IF sm_installation_tab_check THEN :BVNewVersionYN := '\
Y' ; ELSE :BVNewVersionYN := 'N' ; END IF ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7719;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&BVNewVersionYN;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	BVNewVersionYN.len = strlen(BVNewVersionYN.arr);

			
}
/*--------------added on 13.02.2005-------------------------------------------*/
print_header4()
{

    char t_patient_id[16];   
    char sex_desc[11];
	char pat_name[300];
	char uline[82];
	char l_str[100];
    int i;
	char l_age_legend[5];

    pctr++;
    
    get_parameters();
	lctr = 0;



/*-------------------------- added on 21.10.2004 to skip 2 lines for site AH ------*/
	get_sm_installation();
	if (strcmp(BVNewVersionYN.arr,"N") == 0
					|| strcmp(rl_report_format.arr, "6") == 0    /// added on 09.07.2007 against ARTEMIS request
	   )
	{
	 fprintf(fp,"\n\n");
	 lctr+=2;
	 sprintf(l_html_hdr_str,"%s<a class=font_disp><br><br></a>","");
	}    
	else
	{
		fprintf(fp,"\n");
		lctr+=1;
		sprintf(l_html_hdr_str,"%s<a class=font_disp><br></a>","");
	}

/*---------*/
/*-------  added on 21.10.2004 to reset the printer setting before start printing ------*/
    fprintf(fp,"%cE",ESC); 

/*-------- upto here on 21.10.2004 -----*/

    fprintf(fp,"%c&a006L",ESC); /* Set the left Margin */
	fprintf(fp,"%c&k12S",ESC);	/* This makes the font size to increase to 12 */
	fprintf(fp,"%c&l6D",ESC);	/* Set the Density */
   	fprintf(fp,"%c(s4B",ESC);   /* Set Bold */
/*---------*/

	sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_hdr_str,l_prtg);

    if (rl_lab_title.len) 
	{
       fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title.len)/2) - 6)," ",rl_lab_title.arr);
	   lctr+=2;
	   print_html_line (rl_lab_title.arr,out_str);
	   sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><th class=font_heading width=82%c>%s</th>",l_html_hdr_str,l_prtg,out_str);
	   sprintf(l_html_hdr_str,"%s<th rowspan=4><img src=isoft.jpg height=40/></th></tr>",l_html_hdr_str);
	   strcpy(out_str,"");
	}
    if (rl_lab_title_2.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_2.len)/2) - 6)," ",rl_lab_title_2.arr);
	   lctr+=2;
	   print_html_line (rl_lab_title_2.arr,out_str);
	   sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><th class=font_heading>%s</th></tr>",l_html_hdr_str,out_str);
	   strcpy(out_str,"");
	}
    if (rl_lab_title_3.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_3.len)/2) - 6)," ",rl_lab_title_3.arr);
	   lctr+=2;
	   print_html_line (rl_lab_title_3.arr,out_str);
	   sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><th class=font_heading>%s</th></tr>",l_html_hdr_str,out_str);
	   strcpy(out_str,"");
	}
    if (rl_lab_title_4.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_4.len)/2) - 6)," ",rl_lab_title_4.arr);
	   lctr+=2;
	   print_html_line (rl_lab_title_4.arr,out_str);
	   sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><th class=font_heading>%s</th></tr>",l_html_hdr_str,out_str);
	   strcpy(out_str,"");
	}
    if (rl_lab_title_5.len)  
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_5.len)/2) - 6)," ",rl_lab_title_5.arr);
	   lctr+=2;
	   print_html_line (rl_lab_title_5.arr,out_str);
	   sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><th class=font_heading>%s</th></tr>",l_html_hdr_str,out_str);
	   strcpy(out_str,"");
	}

	// New title has to be printed as the department name with hardcoded legend 'Department of' 27.07.2004

    rl_lab_title_6.arr[0] = '\0';
    rl_lab_title_6.len = 0;
	/// 12.02.2006 if (strcmp(rl_hmc_yn.arr,"Y") == 0)  // because HMC doesnt want hardcoded legend 
	if (strcmp(BVNewVersionYN.arr,"Y") == 0)  // 12.02.2006 becaz ML,HMC doesnt want hardcoded legend
	{
		strcpy(rl_lab_title_6.arr, rl_section_short_name.arr);
	}
	else
	{
		strcpy(rl_lab_title_6.arr, "Department of ");
		strcat(rl_lab_title_6.arr, rl_section_short_name.arr);
	}

	rl_lab_title_6.len = strlen(rl_lab_title_6.arr);
    if (rl_lab_title_6.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_6.len)/2) - 6)," ",rl_lab_title_6.arr);
	   lctr+=2;
	   print_html_line (rl_lab_title_6.arr,out_str);
	   sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><th class=font_heading>%s</th></tr>",l_html_hdr_str,out_str);
	   strcpy(out_str,"");
	}


/*----------------------------------------*/

/***** for draft copy legend *********/

	if (strcmp(draft_printing_yn.arr, "N") == 0)
		lctr = lctr;   /// 27.07.2004  lctr = 8;

	else
	{
	    lctr++;       /// 27.07.2004   lctr = 9;    
		//fprintf(fp, "Draft Copy\n"); 
		fprintf(fp, "%-10.10s\n", local_legend[71]); //added for globalisation
		sprintf(in_str,"%s%-10.10s","",local_legend[71]);
		print_html_line (in_str,out_str);
		sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_heading><b>%s</b></td></tr>",l_html_hdr_str,out_str);
	    strcpy(out_str,"");
	}

	if(l_report_legend.len && strcmp(draft_printing_yn.arr, "N") == 0)  // 21.05.2005
	{
	    lctr++;       
		fprintf(fp, "%s\n",l_report_legend.arr);
		print_html_line (l_report_legend.arr,out_str);
		sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_heading><b>%s</b></td></tr>",l_html_hdr_str,out_str);
	    strcpy(out_str,"");
	}
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);
    fprintf(fp,"%73.73sPage(s) : %3d\n"," ",pctr);
/*----------------------------------------*/

	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp align=right>Page(s)&nbsp;&nbsp;:</td>",l_html_hdr_str);

	sprintf(l_html_hdr_str,"%s<td class=font_disp align=right>%3d</td></tr>",l_html_hdr_str,pctr);
	
	sprintf(l_html_hdr_str,"%s</table>",l_html_hdr_str);	

	/*** NEWLY ADDED ON 28/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO 
			BEFORE the detail portion of heading******/
	if(rl_hdr_episode_type.arr[0] != 'R')
		print_hmc_no();


	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

   for(i=0;i<87;i++)
        fprintf(fp,"_");

    sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_hdr_str,l_prtg);
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td>_______________________________________________________________________________</td></tr></table>",l_html_hdr_str);

	fprintf(fp, "\n");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);

	lctr++;
	
	if (strcmp(rl_actual_dob_yn.arr, "Y") == 0)
		strcpy(l_age_legend, "");
	else
		strcpy(l_age_legend, "*");

	sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0  width=100%c>",l_html_hdr_str,l_prtg);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Patient Name : ");
	fprintf(fp,"%-13.13s: ", local_legend[6]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-13.13s","",local_legend[6]);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=14%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_hdr_str,l_prtg,out_str,l_prtg);	  
	strcpy(out_str,"");

	fprintf(fp, "%-30.30s                ", rl_pat_short_name.arr);

	sprintf(in_str,"%s%-30.30s","",rl_pat_short_name.arr);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp width=41%c>%s</td>",l_html_hdr_str,l_prtg,out_str);
	strcpy(out_str,"");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Age: ");
	fprintf(fp, "%-3.3s: ", local_legend[41]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	sprintf(in_str,"%s%-3.3s","",local_legend[41]);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<td class=font_disp align=right width=13%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_hdr_str,l_prtg,out_str,l_prtg);
	strcpy(out_str,"");

	fprintf(fp, "%s ", l_age_legend);

	patient_age();

	fprintf(fp, "%s\n", t_age.arr);

	print_html_line (t_age.arr,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp><b>%s</b>&nbsp;%s</td></tr>",l_html_hdr_str,l_age_legend,out_str);
	strcpy(out_str,"");

	page_break(1);


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Patient  ID  : ");
    fprintf(fp,"%-13.13s: ", local_legend[26]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-13.13s","",local_legend[26]);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	  
	strcpy(out_str,"");
		
	if(rl_hdr_episode_type.arr[0] == 'R')
	{
	   fetch_mp_ext_per_nric();  ///// 03.07.2005 

       if(strcmp(rl_pat_actual_id.arr,"NULL")==0)
	 	   strcpy(t_patient_id,nd_hosp_no.arr);
	   else
		   strcpy(t_patient_id,rl_pat_actual_id.arr);
	}
    else
       strcpy(t_patient_id,nd_hosp_no.arr);

	fprintf(fp, "%-15.15s                          ", t_patient_id);

	sprintf(in_str,"%s%-15.15s","",t_patient_id);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

	if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	{
	   //fprintf(fp, "Sex/Race: ");
	   fprintf(fp, "%-8.8s: ",local_legend[42] );//added for globalisation
	   	
		sprintf(in_str,"%s%-8.8s","",local_legend[42]);
	}
    else
	{
       //fprintf(fp, "     Sex: ");
	   fprintf(fp, "%8.8s: ",local_legend[7] );//added for globalisation

		sprintf(in_str,"%s%8.8s","",local_legend[7]);
	}

	print_html_line (in_str,out_str);	   
    sprintf(l_html_hdr_str,"%s<td class=font_disp align=right><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);
    strcpy(out_str,"");

	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_pat_sex.arr[0] == 'M')
	   //strcpy(sex_desc,"MALE");
		strcpy(sex_desc,local_legend[37]);//added for globalisation
	else
		if(rl_pat_sex.arr[0] == 'F')
			//strcpy(sex_desc,"FEMALE");
			strcpy(sex_desc,local_legend[38]);//added for globalisation
		else
			//strcpy(sex_desc,"Unknown");
			strcpy(sex_desc,local_legend[43]);//added for globalisation

	fprintf(fp,"%s", sex_desc);
	
	print_html_line (sex_desc,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp>%s",l_html_hdr_str,out_str);
	strcpy(out_str,"");

    if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	{
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		get_race_desc();
		fprintf(fp, "%-15.15s", d_race_desc.arr);

		sprintf(in_str,"%s%-15.15s","",d_race_desc.arr);
		print_html_line (in_str,out_str);		
		sprintf(l_html_hdr_str,"%s/%s",l_html_hdr_str,out_str);
		strcpy(out_str,"");
	}

    sprintf(l_html_hdr_str,"%s</td></tr>",l_html_hdr_str);

    fprintf(fp, "\n");
	page_break(1);

/********** added on 13.02.2005 *************/

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "NRIC/Alt.IdNo: ");
    fprintf(fp,"%-13.13s: ", local_legend[55]); //added for globaliation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-13.13s","",local_legend[55]);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	  
	strcpy(out_str,"");

    if (rl_national_id_num.len)
	{
	   //fprintf(fp, "%s", rl_national_id_num.arr);  against scf ML-SD-SCF-1749
         fprintf(fp, "%-30.30s", rl_national_id_num.arr); 
		 
		 sprintf(in_str,"%s%-30.30s","",rl_national_id_num.arr);
	}
	else
	{
         fprintf(fp, "%-30.30s", rl_alternate_id_num.arr);
	     sprintf(in_str,"%s%-30.30s","",rl_alternate_id_num.arr);
	}

     print_html_line (in_str,out_str);
	 sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td>",l_html_hdr_str,out_str);
	 strcpy(out_str,"");

//11.04.2005    fprintf(fp, "\n");
//11.04.2005	page_break(1);

/************* upto here added on 13.02.2005 ******/

/////////////////  11.04.2005
    get_nationality_desc();	
	fprintf(fp,"%-8.8s"," ");
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Nationality: ");
	fprintf(fp, "%-11.11s: ",local_legend[45]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-11.11s","",local_legend[45]);
    print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp align=right><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	
    strcpy(out_str,"");
	 	  
	fprintf(fp, "%-15.15s\n", nd_nationality_desc.arr);

	sprintf(in_str,"%s%-15.15s","",nd_nationality_desc.arr);
    print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td></tr>",l_html_hdr_str,out_str);
    strcpy(out_str,"");

	page_break(1);
/////////////////


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Location     : ");
    fprintf(fp,"%-13.13s: ", local_legend[8]); //added for globaliation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-13.13s","",local_legend[8]);
    print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	  
    strcpy(out_str,"");

	fprintf(fp, "%s", rl_source_short_name.arr);

    print_html_line (local_legend[8],out_str);	
	sprintf(l_html_hdr_str,"%s<td class=font_disp colspan=4>%s",l_html_hdr_str,out_str);
    strcpy(out_str,"");

	if(rl_hdr_episode_type.arr[0] == 'R')
	{
	    fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		fprintf(fp, "%-20.20s\n", rl_location.arr);

		sprintf(in_str,"%s%-20.20s","",rl_location.arr);
		print_html_line (in_str,out_str);		
		sprintf(l_html_hdr_str,"%s/%s</td></tr>",l_html_hdr_str,out_str);
		strcpy(out_str,"");

		page_break(1);
	}
	else
	{
		fprintf(fp, "\n");
		sprintf(l_html_hdr_str,"%s</td></tr>",l_html_hdr_str);
		page_break(1);
	}


	/*** NEWLY ADDED ON 26/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO ******/
//	if(rl_hdr_episode_type.arr[0] != 'R')
//		print_hmc_no();


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Doctor       : ");
	fprintf(fp, "%-13.13s: ",local_legend[44]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-13.13s","",local_legend[44]);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");	  

    if(rl_ordering_doctor_name.len)    ///// added on 06.12.2004
	  strcpy(rl_consultant_short_name.arr,rl_ordering_doctor_name.arr);

	fprintf(fp,"%-30.30s",rl_consultant_short_name.arr);

	sprintf(in_str,"%s%-30.30s","",rl_consultant_short_name.arr);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");

/************** 11.04.2005
/////////////////  12.07.2004
	fprintf(fp,"%-8.8s"," ");
    get_nationality_desc();	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Nationality: ");
	fprintf(fp, "%-11.11s: ",local_legend[45]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	fprintf(fp, "%-15.15s\n", nd_nationality_desc.arr);
/////////////////
**************************/

//////// 11.04.2005

	fprintf(fp,"%-9.9s"," ");
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Ordered   : ");
	fprintf(fp,"%-10.10s: ", local_legend[56]); //added for globalisation

	sprintf(in_str,"%s%-10.10s","",local_legend[56]);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp align=right><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");

	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_order_id.len)
	{
	  fprintf(fp, "%-16.16s\n", nd_order_date_time1.arr);//added for globalisation

	  sprintf(in_str,"%s%-16.16s","",nd_order_date_time1.arr);
	  print_html_line (in_str,out_str);	  
	  sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td></tr>",l_html_hdr_str,out_str);
	  strcpy(out_str,"");
    }
	else
	{
	  fprintf(fp, "\n");
	  sprintf(l_html_hdr_str,"%s</tr>",l_html_hdr_str);
	}

//////////// 11.04.2005
	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[16]); //added for globalisation

	sprintf(in_str,"%s%-13.13s","",local_legend[16]);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);
    strcpy(out_str,"");

// 12.07.2004	fprintf(fp,"%c&k4S",ESC); 
// 12.07.2004  	fprintf(fp,"%c(s-3B",ESC);   

	if (d_interval_specimen_yn == 'Y')
	{
		strcpy(l_str, first_specimen_no.arr);
		strcat(l_str, " (I)");
	}
	else
	{
		strcpy(l_str, nd_spec_no.arr);
		strcat(l_str, "    ");
	}

	fprintf(fp, "%-19.19s                    ", l_str);

	sprintf(in_str,"%s%-19.19s","",l_str);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp><b>%s</b></td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");

	fprintf(fp,"%c&k4S",ESC);  // 12.07.2004
  	fprintf(fp,"%c(s-3B",ESC); // 12.07.2004  

/*******11.04.2005
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Regd  Date: ");
	//fprintf(fp, "Registered: ");
    fprintf(fp,"%-10.10s: ", local_legend[57]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time.arr);
************/

//// added the below on  11.04.2005

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Collt Date: ");
	//fprintf(fp, "Collected : ");
    fprintf(fp,"%-10.10s: ", local_legend[58]); //added for globalisation

	sprintf(in_str,"%s%-10.10s","",local_legend[58]);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp align=right><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");

	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time.arr);	
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time1.arr); //added for globalisation	

	sprintf(l_html_hdr_str,"%s<td class=font_disp>%-16.16s</td></tr>",l_html_hdr_str,rl_hdr_spec_colltd_date_time1.arr);

////////  upto here added on 11.04.2005

	page_break(1);
	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen Type: ");
      fprintf(fp,"%-13.13s: ", local_legend[13]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-13.13s","",local_legend[13]);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	  
	strcpy(out_str,"");

	fprintf(fp,"%-39.39s",rl_spc_specimen_desc.arr);

	sprintf(in_str,"%s%-39.39s","",rl_spc_specimen_desc.arr);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");	

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Recd  Date: ");
	//fprintf(fp, "Received  : ");
    fprintf(fp,"%-10.10s: ", local_legend[59]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-10.10s","",local_legend[59]);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp align=right><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	  
	strcpy(out_str,"");

	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_recd_date_time.arr);
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_recd_date_time1.arr); //added for globalisation
	
	sprintf(l_html_hdr_str,"%s<td class=font_disp>%-16.16s</td></tr>",l_html_hdr_str,rl_hdr_spec_recd_date_time1.arr);	

	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Category No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[48]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-13.13s","",local_legend[48]);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	  
	strcpy(out_str,"");

	fprintf(fp, "%-4.4s/%-4.4s/%-15.15s              ", rl_category_code.arr, rl_category_year.arr,
								rl_category_number.arr);

	sprintf(in_str,"%s%-4.4s/%-4.4s/%-15.15s","",rl_category_code.arr, rl_category_year.arr,rl_category_number.arr);
	print_html_line (in_str,out_str);
	sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");

/************** 11.04.2005
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Collt Date: ");
	//fprintf(fp, "Collected : ");
    fprintf(fp,"%-10.10s: ", local_legend[58]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time.arr);	
***********************/

//////// added the below on 11.04.2005

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Regd  Date: ");
	//fprintf(fp, "Registered: ");
    fprintf(fp,"%-10.10s: ", local_legend[57]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC); 
	
	sprintf(in_str,"%s%-10.10s","",local_legend[57]);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<td class=font_disp align=right><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);	  
	strcpy(out_str,"");

            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_regd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_regd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_regd_dat\
e_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_regd_date_time , 'D\
D/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )7738;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time.arr);
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time1.arr); //added for globalisation

	sprintf(l_html_hdr_str,"%s<td class=font_disp>%-16.16s</td></tr>",l_html_hdr_str,rl_hdr_spec_regd_date_time1.arr);

//////////// upto here added on 11.04.2005

	page_break(1);


/// 31.10.2006 added the below 

		if (strcmp(rl_use_sample_anatomy_ind.arr, "SA") == 0 ||
				strcmp(rl_use_sample_anatomy_ind.arr, "AT") == 0)
		{
	  	 get_anatomy_site();
		 get_anatomy_site_desc();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Anatomy Site : ");
	     fprintf(fp,"%-13.13s: ", local_legend[60]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 sprintf(in_str,"%s%-13.13s","",local_legend[60]);
		 print_html_line (in_str,out_str);		 
		 sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);
		 strcpy(out_str,"");

		 fprintf(fp,"%s\n",nd_anatomy_site_desc.arr);

		 print_html_line (nd_anatomy_site_desc.arr,out_str);		 
		 sprintf(l_html_hdr_str,"%s<td class=font_disp colspan=4>%s</td></tr>",l_html_hdr_str,out_str);
		 strcpy(out_str,"");

  		 page_break(1);
		}

///



    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Clinical     : ");
    fprintf(fp,"%-13.13s: ", local_legend[50]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);

	sprintf(in_str,"%s%-13.13s","",local_legend[50]);
	print_html_line (in_str,out_str);	
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s</td><td class=font_disp>:</b></td>",l_html_hdr_str,out_str);
	strcpy(out_str,"");
		 	   
	if (rl_hdr_request_comment_desc1.len)
    {
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc1.arr);

	  sprintf(in_str,"%s%-40.40s","",rl_hdr_request_comment_desc1.arr);
	  print_html_line (in_str,out_str);	  
	  sprintf(l_html_hdr_str,"%s<td class=font_disp colspan=4>%s</td></tr>",l_html_hdr_str,out_str);
	  strcpy(out_str,"");

      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
	  sprintf(l_html_hdr_str,"%s</tr>",l_html_hdr_str);
      page_break(1);
    }

	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s4B",ESC);
	 //fprintf(fp, "Comment        ");
     fprintf(fp,"%-15.15s ", local_legend[51]); //added for globalisation
	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s-3B",ESC);

	 sprintf(in_str,"%s%-15.15s","",local_legend[51]);
	 print_html_line (in_str,out_str);		 
	 sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp colspan=2><b>%s</b></td>",l_html_hdr_str,out_str);
	 strcpy(out_str,"");

	if (rl_hdr_request_comment_desc2.len)
    {

      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc2.arr);

	  sprintf(in_str,"%s%-40.40s","",rl_hdr_request_comment_desc2.arr);
	  print_html_line (in_str,out_str);		  
	  sprintf(l_html_hdr_str,"%s<td class=font_disp colspan=4>%s</td></tr>",l_html_hdr_str,out_str);
	  strcpy(out_str,"");

      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
	  sprintf(l_html_hdr_str,"%s</tr>",l_html_hdr_str);
      page_break(1);
    }

    
	if (rl_hdr_request_comment_desc3.len)
    {
	  fprintf(fp, "               ");
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc3.arr);

	  sprintf(in_str,"%s%-40.40s","",rl_hdr_request_comment_desc3.arr);
	  print_html_line (in_str,out_str);
	  sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp colspan=2>&nbsp;</td><td class=font_disp colspan=4>%s</td></tr>",l_html_hdr_str,out_str);
	 strcpy(out_str,"");      
	  
	  page_break(1);
    }

	sprintf(l_html_hdr_str,"%s</table>",l_html_hdr_str);

/// 12.07.2004 added the below 
		if (strcmp(rl_ordered_facility_id.arr,nd_operating_facility_id.arr) != 0)
		{
		 get_ordered_company_name();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordering Facility ID: ");
		 fprintf(fp,"%-20.20s: ", local_legend[52]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_hdr_str,l_prtg);
		 sprintf(in_str,"%s%-20.20s","",local_legend[52]);
		 print_html_line (in_str,out_str);		 
		 sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=22%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_hdr_str,l_prtg,out_str,l_prtg);
		 strcpy(out_str,""); 

		 fprintf(fp,"%s\n",sy_ord_acc_entity_name.arr);
		 
		 print_html_line (sy_ord_acc_entity_name.arr,out_str);
		 sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_hdr_str,out_str);
		 strcpy(out_str,"");

  		 page_break(1);
		}
///

/// 31.10.2006 added the below 
/*********commented on 31.10.2006
		if (rl_perform_site_code.len)
		{
		 get_perform_site_desc();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 fprintf(fp, "Performing Location: ");
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",nd_perform_site_desc.arr);
  		 page_break(1);
		}
**************/
///


	if (strcmp(rl_test_requested_yn.arr, "Y") == 0)
	{

		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordered Tests: ");
		 fprintf(fp,"%-13.13s: ", local_legend[53]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 sprintf(in_str,"%s%-13.13s","",local_legend[53]);
		 print_html_line (in_str,out_str);		 
		 sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_hdr_str,l_prtg);
		 sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=14%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_hdr_str,l_prtg,out_str,l_prtg);
		 strcpy(out_str,"");
		
		strcpy(l_str, "");

		for (i=0;i < no_of_dtl_recs;i++)
		{
			d_inhibit_yn.arr[0]		= '\0';
			d_inhibit_yn.len		= 0;

			strcpy(inhibit_test_code.arr, rl_dtl_test_code[i].arr);
			inhibit_test_code.len = strlen(inhibit_test_code.arr);

			chk_inhibit_yn();

			if (d_inhibit_yn.arr[0]	== 'N') 
			{
				if (i == 0)
					sprintf(l_str,"%s", rl_dtl_test_code[i].arr);
				else
					sprintf(l_str,"%s,%s",l_str, rl_dtl_test_code[i].arr);
			}

//11.04.2005   if (i > 15) 

			if (i > 5) 
				break;
		}

		if(no_of_dtl_recs > 7)
		  sprintf(l_str,"%s...",l_str);

		fprintf(fp,"%s\n",l_str);

	    print_html_line (l_str,out_str);		
		sprintf(l_html_hdr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_hdr_str,out_str);
		strcpy(out_str,"");

		page_break(1);
	}


	if(rl_hdr_episode_type.arr[0] == 'R')
	{
		if (strlen(rl_message_line.arr) > 0)
		{
			fprintf(fp, "%70.70s ", rl_message_line.arr);
			fprintf(fp, "%-15.15s\n", nd_hosp_no.arr);

			sprintf(in_str,"%s%70.70 %-15.15s","",rl_message_line.arr,nd_hosp_no.arr);
			print_html_line (in_str,out_str);			
			sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_hdr_str,l_prtg);
			sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_hdr_str,out_str);
			strcpy(out_str,"");

			page_break(1);

		}
	}

    fprintf(fp,"%c&k4S",ESC);  
    fprintf(fp,"%c(s4B",ESC);
    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"%c&k4S",ESC); 
    fprintf(fp,"%c(s-3B",ESC);

	sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_hdr_str,l_prtg);
	sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td>_______________________________________________________________________________</td></tr></table>",l_html_hdr_str);

	page_break(1);
	fprintf(fp, "\n"); 
    
	if (strcmp(rl_print_num_result_title_yn.arr, "Y") == 0)
    {
     
     sprintf(l_html_hdr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_hdr_str,l_prtg);
	 sprintf(l_html_hdr_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_hdr_str);
	 	 
	 if(rl_title_for_test.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_test.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

		print_html_line (rl_title_for_test.arr,out_str);		
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=43%c><u>%s</u></td>",l_html_hdr_str,l_prtg,out_str);
		strcpy(out_str,"");

		for(i=0;i<(39-rl_title_for_test.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
	 {
		fprintf(fp, "%-40.40s", " ");
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=43%c>&nbsp;</td>",l_html_hdr_str,l_prtg);
	 }

     if(rl_title_for_num_result.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_num_result.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

		print_html_line (rl_title_for_num_result.arr,out_str);		
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=12%c><u>%s</u></td>",l_html_hdr_str,l_prtg,out_str);
		strcpy(out_str,"");

		for(i=0;i<(9-rl_title_for_num_result.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
	 {
		fprintf(fp, "%-10.10s", " ");
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=12%c>&nbsp;</td>",l_html_hdr_str,l_prtg);

	 }

     if(rl_title_for_test_units.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_test_units.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		
		print_html_line (rl_title_for_test_units.arr,out_str);		
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=12%c><u>%s</u></td>",l_html_hdr_str,l_prtg,out_str);
		strcpy(out_str,"");

		for(i=0;i<(9-rl_title_for_test_units.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
	 {
		fprintf(fp, "%-10.10s", " ");
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=12%c>&nbsp;</td>",l_html_hdr_str,l_prtg);
	 }
     if(rl_title_for_range_ind.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s", rl_title_for_range_ind.arr);
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		
		print_html_line (rl_title_for_range_ind.arr,out_str);		
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=5%c><u>%s</u></td>",l_html_hdr_str,l_prtg,out_str);
		strcpy(out_str,"");

		for(i=0;i<(5-rl_title_for_range_ind.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
	 {
		fprintf(fp, "%-4.4s", " ");
		sprintf(l_html_hdr_str,"%s<td class=font_disp width=5%c>&nbsp;</td>",l_html_hdr_str,l_prtg);

	 }
     if(rl_title_for_result_range.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_result_range.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

		print_html_line (rl_title_for_result_range.arr,out_str);		
		sprintf(l_html_hdr_str,"%s<td class=font_disp><u>%s</u></td></tr></table>",l_html_hdr_str,out_str);
		strcpy(out_str,"");

		for(i=0;i<(14-rl_title_for_result_range.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
	 {
		fprintf(fp, "%-15.15s", " ");
		sprintf(l_html_hdr_str,"%s<td class=font_disp>&nbsp;</td></tr></table>",l_html_hdr_str);
	 }

	page_break(1);
	fprintf(fp, "\n");

	}
	write_html(fp4,l_html_hdr_str);    
}
/*-----------------------------*/
print_header7()
{

    char t_patient_id[16];   
    char sex_desc[11];
	char pat_name[300];
	char uline[82];
	char l_str[100];
    int i;
	char l_age_legend[5];

    pctr++;
    
    get_parameters();
	lctr = 0;



/*-------------------------- added on 21.10.2004 to skip 2 lines for site AH ------*/
	get_sm_installation();
	if (strcmp(BVNewVersionYN.arr,"N") == 0
					|| strcmp(rl_report_format.arr, "6") == 0    /// added on 09.07.2007 against ARTEMIS request
	   )
	{
	 fprintf(fp,"\n\n");
	 lctr+=2;
	}    
	else
	{
		fprintf(fp,"\n");
		lctr+=1;
	}

/*---------*/
/*-------  added on 21.10.2004 to reset the printer setting before start printing ------*/
    fprintf(fp,"%cE",ESC); 

/*-------- upto here on 21.10.2004 -----*/

    fprintf(fp,"%c&a006L",ESC); /* Set the left Margin */
	fprintf(fp,"%c&k12S",ESC);	/* This makes the font size to increase to 12 */
	fprintf(fp,"%c&l6D",ESC);	/* Set the Density */
   	fprintf(fp,"%c(s4B",ESC);   /* Set Bold */
/*---------*/
    if (rl_lab_title.len) 
	{
       fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title.len)/2) - 6)," ",rl_lab_title.arr);
	   lctr+=2;
	}
    if (rl_lab_title_2.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_2.len)/2) - 6)," ",rl_lab_title_2.arr);
	   lctr+=2;
	}
    if (rl_lab_title_3.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_3.len)/2) - 6)," ",rl_lab_title_3.arr);
	   lctr+=2;
	}
    if (rl_lab_title_4.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_4.len)/2) - 6)," ",rl_lab_title_4.arr);
	   lctr+=2;
	}
    if (rl_lab_title_5.len)  
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_5.len)/2) - 6)," ",rl_lab_title_5.arr);
	   lctr+=2;
	}

	// New title has to be printed as the department name with hardcoded legend 'Department of' 27.07.2004

    rl_lab_title_6.arr[0] = '\0';
    rl_lab_title_6.len = 0;
	/// 12.02.2006 if (strcmp(rl_hmc_yn.arr,"Y") == 0)  // because HMC doesnt want hardcoded legend 
	if (strcmp(BVNewVersionYN.arr,"Y") == 0)  // 12.02.2006 becaz ML,HMC doesnt want hardcoded legend
	{
		strcpy(rl_lab_title_6.arr, rl_section_short_name.arr);
	}
	else
	{
		strcpy(rl_lab_title_6.arr, "Department of ");
		strcat(rl_lab_title_6.arr, rl_section_short_name.arr);
	}

	rl_lab_title_6.len = strlen(rl_lab_title_6.arr);
    if (rl_lab_title_6.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_6.len)/2) - 6)," ",rl_lab_title_6.arr);
	   lctr+=2;
	}


/*----------------------------------------*/

/***** for draft copy legend *********/

	if (strcmp(draft_printing_yn.arr, "N") == 0)
		lctr = lctr;   /// 27.07.2004  lctr = 8;

	else
	{
	    lctr++;       /// 27.07.2004   lctr = 9;    
		//fprintf(fp, "Draft Copy\n"); 
		fprintf(fp, "%-10.10s\n", local_legend[71]); //added for globalisation
	}

	if(l_report_legend.len && strcmp(draft_printing_yn.arr, "N") == 0)  // 21.05.2005
	{
	    lctr++;       
		fprintf(fp, "%s\n",l_report_legend.arr);
	}
/*----------------------------------------*/
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);
  //  fprintf(fp,"%73.73sPage(s) : %3d\n"," ",pctr);09.09.2008
   if(rl_hdr_episode_type.arr[0] == 'I' || rl_hdr_episode_type.arr[0] == 'O' || rl_hdr_episode_type.arr[0] == 'H')//from here added 09.09.2008
    {
	  	
	  l_file_no.arr[0]	= '\0';
	  l_file_no.len	= 0;
		
	  /* EXEC SQL EXECUTE
     	BEGIN 
           SELECT MR_GET_FILE_NO(:nd_hosp_no,NVL(:rl_ordered_facility_id, :nd_operating_facility_id))
		   INTO :l_file_no from dual;
	    END;
		END-EXEC ; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "begin SELECT MR_GET_FILE_NO ( :nd_hosp_no , NVL ( :rl_orde\
red_facility_id , :nd_operating_facility_id ) ) INTO :l_file_no from dual ; EN\
D ;";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7765;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_hosp_no;
   sqlstm.sqhstl[0] = (unsigned int  )23;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_ordered_facility_id;
   sqlstm.sqhstl[1] = (unsigned int  )5;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&l_file_no;
   sqlstm.sqhstl[3] = (unsigned int  )32;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		l_file_no.arr[l_file_no.len] ='\0';
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "File No : ");
	fprintf(fp,"%-13.13s: ", local_legend[75]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-30.30s", l_file_no.arr);
	 
	fprintf(fp,"%-29.29sPage(s) : %3d\n"," ",pctr);
	}
   else
     fprintf(fp,"%73.73sPage(s) : %3d\n"," ",pctr);//upto here added 09.09.2008
/*----------------------------------------*/

	

	/*** NEWLY ADDED ON 28/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO 
			BEFORE the detail portion of heading******/
	if(rl_hdr_episode_type.arr[0] != 'R')
		print_hmc_no();


	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

   for(i=0;i<87;i++)
        fprintf(fp,"_");

	fprintf(fp, "\n");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);

	lctr++;
	
	if (strcmp(rl_actual_dob_yn.arr, "Y") == 0)
		strcpy(l_age_legend, "");
	else
		strcpy(l_age_legend, "*");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Patient Name : ");
	fprintf(fp,"%-13.13s: ", local_legend[6]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-30.30s                ", rl_pat_short_name.arr);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Age: ");
	fprintf(fp, "%-3.3s: ", local_legend[41]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%s ", l_age_legend);

	patient_age();

	fprintf(fp, "%s\n", t_age.arr);
	page_break(1);


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Patient  ID  : ");
    fprintf(fp,"%-13.13s: ", local_legend[26]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	if(rl_hdr_episode_type.arr[0] == 'R')
	{
	   fetch_mp_ext_per_nric();  ///// 03.07.2005 

       if(strcmp(rl_pat_actual_id.arr,"NULL")==0)
	 	   strcpy(t_patient_id,nd_hosp_no.arr);
	   else
		   strcpy(t_patient_id,rl_pat_actual_id.arr);
	}
    else
       strcpy(t_patient_id,nd_hosp_no.arr);

	fprintf(fp, "%-15.15s                          ", t_patient_id);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

	if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	   //fprintf(fp, "Sex/Race: ");
	   fprintf(fp, "%-8.8s: ",local_legend[42] );//added for globalisation
    else
       //fprintf(fp, "     Sex: ");
	   fprintf(fp, "%8.8s: ",local_legend[7] );//added for globalisation

	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_pat_sex.arr[0] == 'M')
	   //strcpy(sex_desc,"MALE");
		strcpy(sex_desc,local_legend[37]);//added for globalisation
	else
		if(rl_pat_sex.arr[0] == 'F')
			//strcpy(sex_desc,"FEMALE");
			strcpy(sex_desc,local_legend[38]);//added for globalisation
		else
			//strcpy(sex_desc,"Unknown");
			strcpy(sex_desc,local_legend[43]);//added for globalisation

	fprintf(fp,"%s", sex_desc);

    if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	{
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		get_race_desc();
		fprintf(fp, "%-15.15s", d_race_desc.arr);
	}

    fprintf(fp, "\n");
	page_break(1);

/********** added on 13.02.2005 *************/

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "NRIC/Alt.IdNo: ");
    fprintf(fp,"%-13.13s: ", local_legend[55]); //added for globaliation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if (rl_national_id_num.len)
	   //fprintf(fp, "%s", rl_national_id_num.arr);  against scf ML-SD-SCF-1749
         fprintf(fp, "%-30.30s", rl_national_id_num.arr); 
	else
       fprintf(fp, "%-30.30s", rl_alternate_id_num.arr);

//11.04.2005    fprintf(fp, "\n");
//11.04.2005	page_break(1);

/************* upto here added on 13.02.2005 ******/

/////////////////  11.04.2005
    get_nationality_desc();	
	fprintf(fp,"%-8.8s"," ");
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Nationality: ");
	fprintf(fp, "%-11.11s: ",local_legend[45]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	fprintf(fp, "%-15.15s\n", nd_nationality_desc.arr);
	page_break(1);
/////////////////


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Location     : ");
    fprintf(fp,"%-13.13s: ", local_legend[8]); //added for globaliation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%s", rl_source_short_name.arr);

	if(rl_hdr_episode_type.arr[0] == 'R')
	{
	    fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		fprintf(fp, "%-20.20s\n", rl_location.arr);
		page_break(1);
	}
	else
	{
		fprintf(fp, "\n");
		page_break(1);
	}


	/*** NEWLY ADDED ON 26/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO ******/
//	if(rl_hdr_episode_type.arr[0] != 'R')
//		print_hmc_no();


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Doctor       : ");
	fprintf(fp, "%-13.13s: ",local_legend[44]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_ordering_doctor_name.len)    ///// added on 06.12.2004
	  strcpy(rl_consultant_short_name.arr,rl_ordering_doctor_name.arr);

	fprintf(fp,"%-30.30s",rl_consultant_short_name.arr);

/************** 11.04.2005
/////////////////  12.07.2004
	fprintf(fp,"%-8.8s"," ");
    get_nationality_desc();	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Nationality: ");
	fprintf(fp, "%-11.11s: ",local_legend[45]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	fprintf(fp, "%-15.15s\n", nd_nationality_desc.arr);
/////////////////
**************************/

//////// 11.04.2005

	fprintf(fp,"%-9.9s"," ");
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Ordered   : ");
	fprintf(fp,"%-10.10s: ", local_legend[56]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_order_id.len)
	{
	  fprintf(fp, "%-16.16s\n", nd_order_date_time1.arr);//added for globalisation
    }
	else
	  fprintf(fp, "\n");

//////////// 11.04.2005
	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[16]); //added for globalisation
// 12.07.2004	fprintf(fp,"%c&k4S",ESC); 
// 12.07.2004  	fprintf(fp,"%c(s-3B",ESC);   

	if (d_interval_specimen_yn == 'Y')
	{
		strcpy(l_str, first_specimen_no.arr);
		strcat(l_str, " (I)");
	}
	else
	{
		strcpy(l_str, nd_spec_no.arr);
		strcat(l_str, "    ");
	}

	fprintf(fp, "%-19.19s                    ", l_str);

	fprintf(fp,"%c&k4S",ESC);  // 12.07.2004
  	fprintf(fp,"%c(s-3B",ESC); // 12.07.2004  

/*******11.04.2005
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Regd  Date: ");
	//fprintf(fp, "Registered: ");
    fprintf(fp,"%-10.10s: ", local_legend[57]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time.arr);
************/

//// added the below on  11.04.2005

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Collt Date: ");
	//fprintf(fp, "Collected : ");
    fprintf(fp,"%-10.10s: ", local_legend[58]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time.arr);	
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time1.arr); //added for globalisation	
////////  upto here added on 11.04.2005

	page_break(1);
	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen Type: ");
      fprintf(fp,"%-13.13s: ", local_legend[13]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp,"%-39.39s",rl_spc_specimen_desc.arr);
	

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Recd  Date: ");
	//fprintf(fp, "Received  : ");
    fprintf(fp,"%-10.10s: ", local_legend[59]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_recd_date_time.arr);
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_recd_date_time1.arr); //added for globalisation
	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Category No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[48]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-4.4s/%-4.4s/%-15.15s              ", rl_category_code.arr, rl_category_year.arr,
								rl_category_number.arr);

/************** 11.04.2005
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Collt Date: ");
	//fprintf(fp, "Collected : ");
    fprintf(fp,"%-10.10s: ", local_legend[58]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time.arr);	
***********************/

//////// added the below on 11.04.2005

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Regd  Date: ");
	//fprintf(fp, "Registered: ");
    fprintf(fp,"%-10.10s: ", local_legend[57]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_regd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_regd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_regd_dat\
e_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_regd_date_time , 'D\
D/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )7796;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time.arr);
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time1.arr); //added for globalisation

//////////// upto here added on 11.04.2005

	page_break(1);


/// 31.10.2006 added the below 

		if (strcmp(rl_use_sample_anatomy_ind.arr, "SA") == 0 ||
				strcmp(rl_use_sample_anatomy_ind.arr, "AT") == 0)
		{
	  	 get_anatomy_site();
		 get_anatomy_site_desc();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Anatomy Site : ");
	     fprintf(fp,"%-13.13s: ", local_legend[60]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",nd_anatomy_site_desc.arr);
  		 page_break(1);
		}

///



    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Clinical     : ");
    fprintf(fp,"%-13.13s: ", local_legend[50]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);
	   
	if (rl_hdr_request_comment_desc1.len)
    {
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc1.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s4B",ESC);
	 //fprintf(fp, "Comment        ");
     fprintf(fp,"%-15.15s ", local_legend[51]); //added for globalisation
	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s-3B",ESC);

	if (rl_hdr_request_comment_desc2.len)
    {

      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc2.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

    
	if (rl_hdr_request_comment_desc3.len)
    {
	  fprintf(fp, "               ");
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc3.arr);
      page_break(1);
    }

/// 12.07.2004 added the below 
		if (strcmp(rl_ordered_facility_id.arr,nd_operating_facility_id.arr) != 0)
		{
		 get_ordered_company_name();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordering Facility ID: ");
		 fprintf(fp,"%-20.20s: ", local_legend[52]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",sy_ord_acc_entity_name.arr);
  		 page_break(1);
		}
///

/// 31.10.2006 added the below 
/*********commented on 31.10.2006
		if (rl_perform_site_code.len)
		{
		 get_perform_site_desc();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 fprintf(fp, "Performing Location: ");
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",nd_perform_site_desc.arr);
  		 page_break(1);
		}
**************/
///


	if (strcmp(rl_test_requested_yn.arr, "Y") == 0)
	{

		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordered Tests: ");
		 fprintf(fp,"%-13.13s: ", local_legend[53]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);
		
		strcpy(l_str, "");

		for (i=0;i < no_of_dtl_recs;i++)
		{
			d_inhibit_yn.arr[0]		= '\0';
			d_inhibit_yn.len		= 0;

			strcpy(inhibit_test_code.arr, rl_dtl_test_code[i].arr);
			inhibit_test_code.len = strlen(inhibit_test_code.arr);

			chk_inhibit_yn();

			if (d_inhibit_yn.arr[0]	== 'N') 
			{
				if (i == 0)
					sprintf(l_str,"%s", rl_dtl_test_code[i].arr);
				else
					sprintf(l_str,"%s,%s",l_str, rl_dtl_test_code[i].arr);
			}

//11.04.2005   if (i > 15) 

			if (i > 5) 
				break;
		}

		if(no_of_dtl_recs > 7)
		  sprintf(l_str,"%s...",l_str);

		fprintf(fp,"%s\n",l_str);
		page_break(1);
	}


	if(rl_hdr_episode_type.arr[0] == 'R')
	{
		if (strlen(rl_message_line.arr) > 0)
		{
			fprintf(fp, "%70.70s ", rl_message_line.arr);
			fprintf(fp, "%-15.15s\n", nd_hosp_no.arr);
			page_break(1);

		}
	}

    fprintf(fp,"%c&k4S",ESC);  
    fprintf(fp,"%c(s4B",ESC);
    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"%c&k4S",ESC); 
    fprintf(fp,"%c(s-3B",ESC);

	page_break(1);
	fprintf(fp, "\n"); 
    
	if (strcmp(rl_print_num_result_title_yn.arr, "Y") == 0)
    {
     if(rl_title_for_test.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_test.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

		for(i=0;i<(39-rl_title_for_test.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-40.40s", " ");

     if(rl_title_for_num_result.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_num_result.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(9-rl_title_for_num_result.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-10.10s", " ");

     if(rl_title_for_test_units.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_test_units.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(9-rl_title_for_test_units.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-10.10s", " ");

     if(rl_title_for_range_ind.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s", rl_title_for_range_ind.arr);
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(5-rl_title_for_range_ind.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-4.4s", " ");

     if(rl_title_for_result_range.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_result_range.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(14-rl_title_for_result_range.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-15.15s", " ");


	page_break(1);
	fprintf(fp, "\n");

	}
    
}
/*-------------------------------------------*/
/*--------------added on 09.07.2007----- against ARTEMIs request        -----------------------------*/
print_header6()
{

    char t_patient_id[16];   
    char sex_desc[11];
	char pat_name[300];
	char uline[82];
	char l_str[100];
    int i;
	char l_age_legend[5];

    pctr++;
    
    get_parameters();
	lctr = 0;
/*---------*/

/*-------------------------- added on 21.10.2004 to skip 2 lines for site AH ------*/
	get_sm_installation();
	if (strcmp(BVNewVersionYN.arr,"N") == 0
					|| strcmp(rl_report_format.arr, "6") == 0    /// added on 09.07.2007 against ARTEMIS request
	   )
	{
	 fprintf(fp,"\n\n\n\n\n\n");
	 lctr+=6;
	}    
	else
	{
	 fprintf(fp,"\n");
	 lctr+=1;

	}

/*-------  added on 21.10.2004 to reset the printer setting before start printing ------*/
    fprintf(fp,"%cE",ESC); 

/*-------- upto here on 21.10.2004 -----*/

    fprintf(fp,"%c&a006L",ESC); /* Set the left Margin */
	fprintf(fp,"%c&k12S",ESC);	/* This makes the font size to increase to 12 */
	fprintf(fp,"%c&l6D",ESC);	/* Set the Density */
   	fprintf(fp,"%c(s4B",ESC);   /* Set Bold */
/*---------*/

/************* commented againt the ARTEMIS request on 09.07.2007 
    if (rl_lab_title.len) 
	{
       fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title.len)/2) - 6)," ",rl_lab_title.arr);
	   lctr+=2;
	}
    if (rl_lab_title_2.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_2.len)/2) - 6)," ",rl_lab_title_2.arr);
	   lctr+=2;
	}
    if (rl_lab_title_3.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_3.len)/2) - 6)," ",rl_lab_title_3.arr);
	   lctr+=2;
	}
    if (rl_lab_title_4.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_4.len)/2) - 6)," ",rl_lab_title_4.arr);
	   lctr+=2;
	}
    if (rl_lab_title_5.len)  
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_5.len)/2) - 6)," ",rl_lab_title_5.arr);
	   lctr+=2;
	}

	// New title has to be printed as the department name with hardcoded legend 'Department of' 27.07.2004

    rl_lab_title_6.arr[0] = '\0';
    rl_lab_title_6.len = 0;
	/// 12.02.2006 if (strcmp(rl_hmc_yn.arr,"Y") == 0)  // because HMC doesnt want hardcoded legend 
	if (strcmp(BVNewVersionYN.arr,"Y") == 0)  // 12.02.2006 becaz ML,HMC doesnt want hardcoded legend
	{
		strcpy(rl_lab_title_6.arr, rl_section_short_name.arr);
	}
	else
	{
		strcpy(rl_lab_title_6.arr, "Department of ");
		strcat(rl_lab_title_6.arr, rl_section_short_name.arr);
	}

	rl_lab_title_6.len = strlen(rl_lab_title_6.arr);
    if (rl_lab_title_6.len)
	{
	   fprintf(fp,"%-*s%-.80s\n",(int)(((80 - rl_lab_title_6.len)/2) - 6)," ",rl_lab_title_6.arr);
	   lctr+=2;
	}
*********************************** upto here commented on 09.07.2007 against ARTEMIS request ***************/

/*----------------------------------------*/

/***** for draft copy legend *********/

	if (strcmp(draft_printing_yn.arr, "N") == 0)
		lctr = lctr;   /// 27.07.2004  lctr = 8;

	else
	{
	    lctr++;       /// 27.07.2004   lctr = 9;    
		//fprintf(fp, "Draft Copy\n");
		fprintf(fp, "%-10.10s\n", local_legend[71]); //added for globalisation
	}

/******** commented the below on 09.07.2007 against ARTEMIS request
	if(l_report_legend.len && strcmp(draft_printing_yn.arr, "N") == 0)  // 21.05.2005
	{
	    lctr++;       
		fprintf(fp, "%s\n",l_report_legend.arr);
	}

///----------------------------------------
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);
    fprintf(fp,"%73.73sPage(s) : %3d\n"," ",pctr);
///----------------------------------------

********************************/
	

	/*** NEWLY ADDED ON 28/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO 
			BEFORE the detail portion of heading******/
	if(rl_hdr_episode_type.arr[0] != 'R')
		print_hmc_no();


	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

   for(i=0;i<87;i++)
        fprintf(fp,"_");

	fprintf(fp, "\n");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
   	fprintf(fp,"%c(s-3B",ESC);

	lctr++;
	
	if (strcmp(rl_actual_dob_yn.arr, "Y") == 0)
		strcpy(l_age_legend, "");
	else
		strcpy(l_age_legend, "*");

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Patient Name : ");
	fprintf(fp,"%-13.13s: ", local_legend[6]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-30.30s                ", rl_pat_short_name.arr);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Age: ");
	fprintf(fp, "%-3.3s: ", local_legend[41]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%s ", l_age_legend);

	patient_age();

	fprintf(fp, "%s\n", t_age.arr);
	page_break(1);


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
// 09.07.2007	fprintf(fp, "Patient  ID  : ");
	//fprintf(fp, "AHI ID       : ");   // 09.07.2007
    fprintf(fp,"%-13.13s: ", local_legend[54]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	if(rl_hdr_episode_type.arr[0] == 'R')
	{
	   fetch_mp_ext_per_nric();  ///// 03.07.2005 

       if(strcmp(rl_pat_actual_id.arr,"NULL")==0)
	 	   strcpy(t_patient_id,nd_hosp_no.arr);
	   else
		   strcpy(t_patient_id,rl_pat_actual_id.arr);
	}
    else
       strcpy(t_patient_id,nd_hosp_no.arr);

	fprintf(fp, "%-15.15s                          ", t_patient_id);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);

	if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	   //fprintf(fp, "Sex/Race: ");
	   fprintf(fp, "%-8.8s: ",local_legend[42] );//added for globalisation
    else
       //fprintf(fp, "     Sex: ");
	   fprintf(fp, "%8.8s: ",local_legend[7] );//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_pat_sex.arr[0] == 'M')
	   //strcpy(sex_desc,"MALE");
		strcpy(sex_desc,local_legend[37]);//added for globalisation
	else
		if(rl_pat_sex.arr[0] == 'F')
		//	strcpy(sex_desc,"FEMALE");
			strcpy(sex_desc,local_legend[38]);//added for globalisation
		else
			strcpy(sex_desc,"Unknown");
			strcpy(sex_desc,local_legend[43]);//added for globalisation

	fprintf(fp,"%s", sex_desc);

    if (strcmp(rl_race_accepted_yn.arr,"Y") == 0)
	{
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		get_race_desc();
		fprintf(fp, "%-15.15s", d_race_desc.arr);
	}

    fprintf(fp, "\n");
	page_break(1);

/********** added on 13.02.2005 *************/

/******** commented against ARTEMIS request

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "NRIC/Alt.IdNo: ");
    fprintf(fp,"%-13.13s: ", local_legend[55]); //added for globaliation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if (rl_national_id_num.len)
     //fprintf(fp, "%s", rl_national_id_num.arr);  against scf ML-SD-SCF-1749
	   fprintf(fp, "%-30.30s", rl_national_id_num.arr);
	else
       fprintf(fp, "%-30.30s", rl_alternate_id_num.arr);

****************************************************************/

//11.04.2005    fprintf(fp, "\n");
//11.04.2005	page_break(1);

/************* upto here added on 13.02.2005 ******/

/////////////////  11.04.2005
/**************commented against ARTEMIS request
    get_nationality_desc();	
//09.07.2007	fprintf(fp,"%-8.8s"," ");
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Nationality  : ");
	fprintf(fp, "%-11.11s: ",local_legend[45]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	fprintf(fp, "%-15.15s\n", nd_nationality_desc.arr);
	page_break(1);
/////////////////
************************/

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Location     : ");
    fprintf(fp,"%-13.13s: ", local_legend[8]); //added for globaliation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%s", rl_source_short_name.arr);

	if(rl_hdr_episode_type.arr[0] == 'R')
	{
	    fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp, "/");
		fprintf(fp,"%c&k4S",ESC); 
   		fprintf(fp,"%c(s-3B",ESC);   

		fprintf(fp, "%-20.20s\n", rl_location.arr);
		page_break(1);
	}
	else
	{
		fprintf(fp, "\n");
		page_break(1);
	}


	/*** NEWLY ADDED ON 26/08/2003 TO PRINT THE HMC NO FOR THE MEDICOM NO ******/
//	if(rl_hdr_episode_type.arr[0] != 'R')
//		print_hmc_no();


    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Doctor       : ");
	fprintf(fp, "%-13.13s: ",local_legend[44]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_ordering_doctor_name.len)    ///// added on 06.12.2004
	  strcpy(rl_consultant_short_name.arr,rl_ordering_doctor_name.arr);

	fprintf(fp,"%-30.30s",rl_consultant_short_name.arr);

/************** 11.04.2005
/////////////////  12.07.2004
	fprintf(fp,"%-8.8s"," ");
    get_nationality_desc();	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Nationality: ");
	fprintf(fp, "%-11.11s: ",local_legend[45]);//added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	fprintf(fp, "%-15.15s\n", nd_nationality_desc.arr);
/////////////////
**************************/

//////// 11.04.2005

	fprintf(fp,"%-9.9s"," ");
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Ordered   : ");
	fprintf(fp,"%-10.10s: ", local_legend[56]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

    if(rl_order_id.len)
	{
  
	  fprintf(fp, "%-16.16s\n", nd_order_date_time1.arr);//added for globalisation
    }
	else
	  fprintf(fp, "\n");

//////////// 11.04.2005
	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[16]); //added for globalisation
// 12.07.2004	fprintf(fp,"%c&k4S",ESC); 
// 12.07.2004  	fprintf(fp,"%c(s-3B",ESC);   

	if (d_interval_specimen_yn == 'Y')
	{
		strcpy(l_str, first_specimen_no.arr);
		strcat(l_str, " (I)");
	}
	else
	{
		strcpy(l_str, nd_spec_no.arr);
		strcat(l_str, "    ");
	}

	fprintf(fp, "%-19.19s                    ", l_str);

	fprintf(fp,"%c&k4S",ESC);  // 12.07.2004
  	fprintf(fp,"%c(s-3B",ESC); // 12.07.2004  

/*******11.04.2005
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Regd  Date: ");
	//fprintf(fp, "Registered: ");
    fprintf(fp,"%-10.10s: ", local_legend[57]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time.arr);
************/

//// added the below on  11.04.2005

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Collt Date: ");
	//fprintf(fp, "Collected : ");
    fprintf(fp,"%-10.10s: ", local_legend[58]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time.arr);	
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time1.arr); //added for globalisation	
////////  upto here added on 11.04.2005

	page_break(1);
	
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Specimen Type: ");
      fprintf(fp,"%-13.13s: ", local_legend[13]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp,"%-39.39s",rl_spc_specimen_desc.arr);
	

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Recd  Date: ");
	//fprintf(fp, "Received  : ");
    fprintf(fp,"%-10.10s: ", local_legend[59]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_recd_date_time.arr);
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_recd_date_time1.arr); //added for globalisation
	page_break(1);

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Category No  : ");
    fprintf(fp,"%-13.13s: ", local_legend[48]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

	fprintf(fp, "%-4.4s/%-4.4s/%-15.15s              ", rl_category_code.arr, rl_category_year.arr,
								rl_category_number.arr);

/************** 11.04.2005
    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Collt Date: ");
	fprintf(fp, "Collected : ");
    fprintf(fp,"%-10.10s: ", local_legend[58]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   
	
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_colltd_date_time.arr);	
***********************/

//////// added the below on 11.04.2005

    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
//	fprintf(fp, "Regd  Date: ");
	//fprintf(fp, "Registered: ");
    fprintf(fp,"%-10.10s: ", local_legend[57]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);   

            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_regd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_regd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_regd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_regd_dat\
e_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_regd_date_time , 'D\
D/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )7823;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_regd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_regd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	//fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time.arr);
	fprintf(fp, "%-16.16s\n", rl_hdr_spec_regd_date_time1.arr);//added for globalisation

//////////// upto here added on 11.04.2005

	page_break(1);


/// 31.10.2006 added the below 

		if (strcmp(rl_use_sample_anatomy_ind.arr, "SA") == 0 ||
				strcmp(rl_use_sample_anatomy_ind.arr, "AT") == 0)
		{
	  	 get_anatomy_site();
		 get_anatomy_site_desc();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Anatomy Site : ");
	     fprintf(fp,"%-13.13s: ", local_legend[60]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",nd_anatomy_site_desc.arr);
  		 page_break(1);
		}

///



    fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s4B",ESC);
	//fprintf(fp, "Clinical     : ");
    fprintf(fp,"%-13.13s: ", local_legend[50]); //added for globalisation
	fprintf(fp,"%c&k4S",ESC); 
   	fprintf(fp,"%c(s-3B",ESC);
	   
	if (rl_hdr_request_comment_desc1.len)
    {
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc1.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s4B",ESC);
	 //fprintf(fp, "Comment        ");
     fprintf(fp,"%-15.15s ", local_legend[51]); //added for globalisation
	 fprintf(fp,"%c&k4S",ESC); 
   	 fprintf(fp,"%c(s-3B",ESC);

	if (rl_hdr_request_comment_desc2.len)
    {

      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc2.arr);
      page_break(1);
    }
	else
    {
      fprintf(fp,"\n");
      page_break(1);
    }

    
	if (rl_hdr_request_comment_desc3.len)
    {
	  fprintf(fp, "               ");
      fprintf(fp,"%-40.40s\n",rl_hdr_request_comment_desc3.arr);
      page_break(1);
    }

/// 12.07.2004 added the below 
		if (strcmp(rl_ordered_facility_id.arr,nd_operating_facility_id.arr) != 0)
		{
		 get_ordered_company_name();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordering Facility ID: ");
		 fprintf(fp,"%-20.20s: ", local_legend[52]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",sy_ord_acc_entity_name.arr);
  		 page_break(1);
		}
///

/// 31.10.2006 added the below 
/*********commented on 31.10.2006
		if (rl_perform_site_code.len)
		{
		 get_perform_site_desc();
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 fprintf(fp, "Performing Location: ");
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);

		 fprintf(fp,"%s\n",nd_perform_site_desc.arr);
  		 page_break(1);
		}
**************/
///


	if (strcmp(rl_test_requested_yn.arr, "Y") == 0)
	{

		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s4B",ESC);
		 //fprintf(fp, "Ordered Tests: ");
		 fprintf(fp,"%-13.13s: ", local_legend[53]); //added for globalisation
		 fprintf(fp,"%c&k4S",ESC); 
   		 fprintf(fp,"%c(s-3B",ESC);
		
		strcpy(l_str, "");

		for (i=0;i < no_of_dtl_recs;i++)
		{
			d_inhibit_yn.arr[0]		= '\0';
			d_inhibit_yn.len		= 0;

			strcpy(inhibit_test_code.arr, rl_dtl_test_code[i].arr);
			inhibit_test_code.len = strlen(inhibit_test_code.arr);

			chk_inhibit_yn();

			if (d_inhibit_yn.arr[0]	== 'N') 
			{
				if (i == 0)
					sprintf(l_str,"%s", rl_dtl_test_code[i].arr);
				else
					sprintf(l_str,"%s,%s",l_str, rl_dtl_test_code[i].arr);
			}

//11.04.2005   if (i > 15) 

			if (i > 5) 
				break;
		}

		if(no_of_dtl_recs > 7)
		  sprintf(l_str,"%s...",l_str);

		fprintf(fp,"%s\n",l_str);
		page_break(1);
	}


	if(rl_hdr_episode_type.arr[0] == 'R')
	{
		if (strlen(rl_message_line.arr) > 0)
		{
			fprintf(fp, "%70.70s ", rl_message_line.arr);
			fprintf(fp, "%-15.15s\n", nd_hosp_no.arr);
			page_break(1);

		}
	}

    fprintf(fp,"%c&k4S",ESC);  
    fprintf(fp,"%c(s4B",ESC);
    for(i=0;i<87;i++)
        fprintf(fp,"_");
    fprintf(fp,"%c&k4S",ESC); 
    fprintf(fp,"%c(s-3B",ESC);

	page_break(1);
	fprintf(fp, "\n"); 
    
	if (strcmp(rl_print_num_result_title_yn.arr, "Y") == 0)
    {
     if(rl_title_for_test.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_test.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

		for(i=0;i<(39-rl_title_for_test.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-40.40s", " ");

     if(rl_title_for_num_result.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_num_result.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(9-rl_title_for_num_result.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-10.10s", " ");

     if(rl_title_for_test_units.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_test_units.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(9-rl_title_for_test_units.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-10.10s", " ");

     if(rl_title_for_range_ind.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s", rl_title_for_range_ind.arr);
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(5-rl_title_for_range_ind.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-4.4s", " ");

     if(rl_title_for_result_range.len)
	 {
	    fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
		fprintf(fp, "%s%s", rl_title_for_result_range.arr," ");
        fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
		for(i=0;i<(14-rl_title_for_result_range.len);i++)
		   fprintf(fp, "%s", " ");
     }
	 else
		fprintf(fp, "%-15.15s", " ");


	page_break(1);
	fprintf(fp, "\n");

	}
    
}



/*----added on 13.02.2005-------------------------------------------------*/
print_footer4(foot_ind)
int foot_ind;
{
   int fi = 0;
   char l_str[100];
   l_str[0] = '\0'; 

   for(fi=0; fi < 87; fi++)
       fprintf(fp,"%c",'_');

   fprintf(fp,"\n");
   
   fflush(fp);

      if (rl_name_on_report_yn.arr[0] == 'Y')
	  {

		get_print_name(first_user.arr);
	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(first_user.arr);

	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
//		fprintf(fp,"Released/Reviewed By : ");
		//fprintf(fp,"Released By   : ");
		fprintf(fp,"%-13.13s : ", local_legend[61]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC);   
  	    sprintf(l_str,"%s", sy_user_name.arr);

//12.04.2005   fprintf(fp,"%-30.30s",l_str);
//12.04.2005   fprintf(fp, "    ");


		if (strcmp(rl_report_format.arr, "6") == 0)  //added on 09.07.2007 against ARTEMIS request.	    
		{
			fprintf(fp,"%-30.30s",l_str);
			fprintf(fp, "    ");
		}
		else
		{
			get_position_desc(sy_func_role_id.arr);
			if (nd_position_desc.len)
				fprintf(fp,"%-15.15s,",l_str);
			else
				fprintf(fp,"%-16.16s",l_str);

			sprintf(l_str,"%s", nd_position_desc.arr);
			fprintf(fp,"%-15.15s",l_str);	
			fprintf(fp, "    ");
		}
		/*----------------------------------------*/

	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
	   //fprintf(fp,"Released Date  : ");
	   fprintf(fp,"%-15.15s : ", local_legend[62]); //added for globalisation
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);   
	   fprintf(fp,"%-s\n",footer_released_date);
	   /*----------------------------------------*/

	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;

	 }

	  get_print_name(rl_hdr_released_by_id.arr);
	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(rl_hdr_released_by_id.arr);

	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
//		fprintf(fp,"Reviewed By : ");
		//fprintf(fp,"Authorized By : ");
		fprintf(fp,"%-13.13s : ", local_legend[64]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC);   
  	    sprintf(l_str,"%s", sy_user_name.arr);

//12.04.2005	    fprintf(fp,"%-30.30s",l_str);
//12.04.2005		fprintf(fp, "      ");


		if (strcmp(rl_report_format.arr, "6") == 0)  //added on 09.07.2007 against ARTEMIS request.	    
		{
			fprintf(fp,"%-30.30s",l_str);
			fprintf(fp, "      ");
		}
		else
		{
			get_position_desc(sy_func_role_id.arr);
			if (nd_position_desc.len)
				fprintf(fp,"%-15.15s,",l_str);
			else
				fprintf(fp,"%-16.16s",l_str);

			sprintf(l_str,"%s", nd_position_desc.arr);
			fprintf(fp,"%-15.15s",l_str);	
			fprintf(fp, "    ");
		}


	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
//	   fprintf(fp,"Reviewed Date : ");
	   //fprintf(fp,"Authorized Date: ");
	   fprintf(fp,"%-15.15s : ", local_legend[66]); //added for globalisation
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);   
	   //fprintf(fp,"%-s\n",rl_hdr_released_date.arr);
	   fprintf(fp,"%-s\n",rl_hdr_released_date1.arr); //added for globalisation
	   /*----------------------------------------*/

   	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;


	  }

		/*----------------------------------------*/
		/***********************
	    fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp,"Reprint Date : ");
        fprintf(fp,"%c&k4S",ESC); 
        fprintf(fp,"%c(s-3B",ESC);   
		***********************/
		/*----------------------------------------*/
	/***********************
	   if (rl_prn_ctrl_hdr_rp_yn.arr[0] == 'Y')
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
	   else
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);

	   fprintf(fp,"%s",nd_result_printed_date.arr);
	***********************/

///////////////// 12.07.2004 'ss'
		if (p_param8.arr[0] == 'P')
		{
		  get_print_name(sy_user_id.arr);
		  if (print_name_yn.arr[0]	== 'Y')
		  {

			get_user_name(sy_user_id.arr);

		   /*----------------------------------------*/
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s4B",ESC);
			//fprintf(fp,"Reprinted By  : ");
			fprintf(fp,"%-12.12s: ", local_legend[67]); //added for globalisation 
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s-3B",ESC);   
  			sprintf(l_str,"%s", sy_user_name.arr);

//12.04.2005			fprintf(fp,"%-30.30s",l_str);
//12.04.2005			fprintf(fp, "      ");

		if (strcmp(rl_report_format.arr, "6") == 0)  //added on 09.07.2007 against ARTEMIS request.	    
		{
			fprintf(fp,"%-30.30s",l_str);
			fprintf(fp, "      ");
		}
		else
		{
			get_position_desc(sy_func_role_id.arr);
			if (nd_position_desc.len)
				fprintf(fp,"%-15.15s,",l_str);
			else
				fprintf(fp,"%-16.16s",l_str);

			sprintf(l_str,"%s", nd_position_desc.arr);
			fprintf(fp,"%-15.15s",l_str);	
			fprintf(fp, "    ");
		}

		   /*----------------------------------------*/	   
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s4B",ESC);
		   //fprintf(fp,"Reprinted Date : ");
			fprintf(fp,"%-14.14s: ", local_legend[68]); //added for globalisation 
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s-3B",ESC);   

			l_sy_req_date.arr[0]	= '\0';
			l_sy_req_date.len	= 0;

			/* EXEC SQL SELECT  to_char(to_date(:sy_req_date,'DDMMYYHH24MISS'),'DD/MM/YYYY HH24:MI')
				   INTO		:l_sy_req_date
				   FROM		DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select to_char(to_date(:b0,'DDMMYYHH24MISS'),'DD/MM/YYYY H\
H24:MI') into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7850;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[0] = (unsigned int  )32;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
   sqlstm.sqhstl[1] = (unsigned int  )32;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			   if (OERROR);

			l_sy_req_date.arr[l_sy_req_date.len] = '\0';
	 /**** date conversion start for globalisation ************/
        /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:l_sy_req_date1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:l_sy_req_date1 :=sm_convert_datetime_2t(to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
        struct sqlexd sqlstm;
        sqlstm.sqlvsn = 10;
        sqlstm.arrsiz = 33;
        sqlstm.sqladtp = &sqladt;
        sqlstm.sqltdsp = &sqltds;
        sqlstm.stmt = "declare t_date date ; BEGIN :l_sy_req_date1 := sm_con\
vert_datetime_2t ( to_date ( :l_sy_req_date , 'DD/MM/YYYY HH24:MI' ) , :langua\
ge_id ) ; END ;";
        sqlstm.iters = (unsigned int  )1;
        sqlstm.offset = (unsigned int  )7873;
        sqlstm.cud = sqlcud0;
        sqlstm.sqlest = (unsigned char  *)&sqlca;
        sqlstm.sqlety = (unsigned short)256;
        sqlstm.occurs = (unsigned int  )0;
        sqlstm.sqhstv[0] = (         void  *)&l_sy_req_date1;
        sqlstm.sqhstl[0] = (unsigned int  )32;
        sqlstm.sqhsts[0] = (         int  )0;
        sqlstm.sqindv[0] = (         void  *)0;
        sqlstm.sqinds[0] = (         int  )0;
        sqlstm.sqharm[0] = (unsigned int  )0;
        sqlstm.sqadto[0] = (unsigned short )0;
        sqlstm.sqtdso[0] = (unsigned short )0;
        sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
        sqlstm.sqhstl[1] = (unsigned int  )32;
        sqlstm.sqhsts[1] = (         int  )0;
        sqlstm.sqindv[1] = (         void  *)0;
        sqlstm.sqinds[1] = (         int  )0;
        sqlstm.sqharm[1] = (unsigned int  )0;
        sqlstm.sqadto[1] = (unsigned short )0;
        sqlstm.sqtdso[1] = (unsigned short )0;
        sqlstm.sqhstv[2] = (         void  *)&language_id;
        sqlstm.sqhstl[2] = (unsigned int  )7;
        sqlstm.sqhsts[2] = (         int  )0;
        sqlstm.sqindv[2] = (         void  *)0;
        sqlstm.sqinds[2] = (         int  )0;
        sqlstm.sqharm[2] = (unsigned int  )0;
        sqlstm.sqadto[2] = (unsigned short )0;
        sqlstm.sqtdso[2] = (unsigned short )0;
        sqlstm.sqphsv = sqlstm.sqhstv;
        sqlstm.sqphsl = sqlstm.sqhstl;
        sqlstm.sqphss = sqlstm.sqhsts;
        sqlstm.sqpind = sqlstm.sqindv;
        sqlstm.sqpins = sqlstm.sqinds;
        sqlstm.sqparm = sqlstm.sqharm;
        sqlstm.sqparc = sqlstm.sqharc;
        sqlstm.sqpadto = sqlstm.sqadto;
        sqlstm.sqptdso = sqlstm.sqtdso;
        sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	 /**** date conversion end for globalisation ************/


		   fprintf(fp,"%-s\n",l_sy_req_date1.arr);

		   //fprintf(fp,"%-s\n",l_sy_req_date.arr);
		   /*----------------------------------------*/

   	   		sy_user_name.arr[0]		= '\0';
			sy_user_name.len			= 0; 

		  }

		}
////////////////
	  
	}

/****** FOOTER PRINTING FROM RL_SECTION_CTL  ****************/
   if ( (strlen(rl_footer_line_1.arr) > 0) ||
			(strlen(rl_footer_line_2.arr) > 0) )
   {
		if (strlen(rl_footer_line_1.arr) > 0) 
			fprintf(fp, "%-79.79s\n", rl_footer_line_1.arr);

		if (strlen(rl_footer_line_2.arr) > 0) 
			fprintf(fp, "%-79.79s\n", rl_footer_line_2.arr);
   }


   /*----------------------------------------*/

   if (rl_hdr_extra_copies_to.len && copy == 2  && 
		strcmp(draft_printing_yn.arr, "N") == 0)
   {
      /*----------------------------------------*/
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s4B",ESC);
      //fprintf(fp,"Copy To : ");
      fprintf(fp,"%-8.8s: ", local_legend[23]); //added for globalisation
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/

      sprintf(l_str,"%24.24s",rl_hdr_extra_copies_to.arr);
   }
   else
      sprintf(l_str,"%34.34s"," ");

   fprintf(fp,"%s\n",l_str);

   if(last_page == 0)
      //sprintf(l_str,"%-73.73s--CONTINUED--"," ");
      sprintf(l_str,"%-73.73s--%-9.9s--"," ",local_legend[24]); //added for globalisation
   else
      //sprintf(l_str,"%-73.73s      --END--"," ");
      sprintf(l_str,"%-73.73s --%-3.3s--"," ",local_legend[25]);// added for globalisation

   fprintf(fp,"%s\f",l_str);   

   fprintf(fp,"%cE",ESC); // added on 21.10.2004 to reset the printer settings.

   lctr = 0; 
  
}

/*-----------------------------------------------------*/

/*--------------------------  added on 11.10.2007 against the SD-CRF-20093 -------*/
print_footer5(foot_ind)
int foot_ind;
{
   int fi = 0;
   char l_str[100];
   l_str[0] = '\0'; 

   for(fi=0; fi < 87; fi++)
       fprintf(fp,"%c",'_');

   sprintf(l_html_ftr_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
   sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td>_______________________________________________________________________________</td></tr></table>",l_html_ftr_str);

   fprintf(fp,"\n");
   
   fflush(fp);

      if (rl_name_on_report_yn.arr[0] == 'Y')
	  {

		get_print_name(first_user.arr);
	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(first_user.arr);
	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
//		fprintf(fp,"Released/Reviewed By : ");
		//fprintf(fp,"Released By   : ");
		fprintf(fp,"%-13.13s : ", local_legend[61]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC); 
		
	    sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);		
		sprintf(in_str,"%s%-13.13s","",local_legend[61]);
		print_html_line (in_str,out_str);		
		sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=15%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_ftr_str,l_prtg,out_str,l_prtg);
		strcpy(out_str,"");
					  
  	    sprintf(l_str,"%s", sy_user_name.arr);

		fprintf(fp,"%-60.60s\n",l_str);

		sprintf(in_str,"%s%-60.60s","",l_str);
		print_html_line (in_str,out_str);		
		sprintf(l_html_ftr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_ftr_str,out_str);
		strcpy(out_str,"");

		get_position_desc(sy_func_role_id.arr);

		fprintf(fp,"                ");
		sprintf(l_str,"%s", nd_position_desc.arr);
		fprintf(fp,"%-30.30s",l_str);	
		fprintf(fp, "    ");

	    sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);				
		sprintf(in_str,"%s%-30.30s","",l_str);
		print_html_line (in_str,out_str);
		sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=17%c>&nbsp;</td><td class=font_disp width=36%c>%s</td>",l_html_ftr_str,l_prtg,l_prtg,out_str);
		strcpy(out_str,"");

		}
		/*----------------------------------------*/

	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
	   //fprintf(fp,"Released Date  : ");
	   fprintf(fp,"%-15.15s : ", local_legend[62]); //added for globalisation
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);  

	   if (print_name_yn.arr[0]	== 'Y')
	   {
			sprintf(in_str,"%s%-15.15s","",local_legend[62]);
			print_html_line (in_str,out_str);			
			sprintf(l_html_ftr_str,"%s<td class=font_disp align=right width=18%c><b>%s</td><td class=font_disp align=center width=3%c>:</b></td>",l_html_ftr_str,l_prtg,out_str,l_prtg);
			strcpy(out_str,"");	   
	   }
	   else
	   {
			sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);							
			sprintf(in_str,"%s%-15.15s","",local_legend[62]);
			print_html_line (in_str,out_str);			
			sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=15%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_ftr_str,l_prtg,out_str,l_prtg);
			strcpy(out_str,"");	   
	   }	
				    
	   fprintf(fp,"%-s\n",footer_released_date);

	   sprintf(l_html_ftr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_ftr_str,footer_released_date);

	   /*----------------------------------------*/

	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;

	 }

	  get_print_name(rl_hdr_released_by_id.arr);
	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(rl_hdr_released_by_id.arr);

	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
//		fprintf(fp,"Reviewed By : ");
		//fprintf(fp,"Authorized By : ");
		fprintf(fp,"%-13.13s : ", local_legend[64]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC);
		
		sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);						
		sprintf(in_str,"%s%-13.13s","",local_legend[64]);
		print_html_line (in_str,out_str);		
		sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=15%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_ftr_str,l_prtg,out_str,l_prtg);
	    strcpy(out_str,"");
	   				   
  	    sprintf(l_str,"%s", sy_user_name.arr);

		fprintf(fp,"%-60.60s\n",l_str);

		sprintf(in_str,"%s%-60.60s","",l_str);
		print_html_line (in_str,out_str);
		sprintf(l_html_ftr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_ftr_str,out_str);
	    strcpy(out_str,"");

		get_position_desc(sy_func_role_id.arr);

		sprintf(l_str,"%s", nd_position_desc.arr);
		fprintf(fp,"                ");
		fprintf(fp,"%-30.30s",l_str);	
		fprintf(fp, "    ");

		sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);						
		sprintf(in_str,"%s%-30.30s","",l_str);
		print_html_line (in_str,out_str);
		sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=17%c>&nbsp;</td><td class=font_disp  width=36%c>%s</td>",l_html_ftr_str,l_prtg,l_prtg,out_str);
	    strcpy(out_str,"");

	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
//	   fprintf(fp,"Reviewed Date : ");
	   //fprintf(fp,"Authorized Date: ");
	   fprintf(fp,"%-15.15s : ", local_legend[66]); //added for globalisation
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);  
	   
		sprintf(in_str,"%s%-15.15s","",local_legend[66]);
		print_html_line (in_str,out_str);	   
	    sprintf(l_html_ftr_str,"%s<td class=font_disp align=right width=18%c><b>%s</td><td class=font_disp align=center width=3%c>:</b></td>",l_html_ftr_str,l_prtg,out_str,l_prtg);
	    strcpy(out_str,"");
			   	    
	   //fprintf(fp,"%-s\n",rl_hdr_released_date.arr);
	   fprintf(fp,"%-s\n",rl_hdr_released_date1.arr); //added for globalisation

	    sprintf(l_html_ftr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_ftr_str,rl_hdr_released_date1.arr);

	   /*----------------------------------------*/

   	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;


	  }

		/*----------------------------------------*/
		/***********************
	    fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp,"Reprint Date : ");
        fprintf(fp,"%c&k4S",ESC); 
        fprintf(fp,"%c(s-3B",ESC);   
		***********************/
		/*----------------------------------------*/
	/***********************
	   if (rl_prn_ctrl_hdr_rp_yn.arr[0] == 'Y')
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
	   else
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);

	   fprintf(fp,"%s",nd_result_printed_date.arr);
	***********************/

///////////////// 12.07.2004 'ss'
		if (p_param8.arr[0] == 'P')
		{
		  get_print_name(sy_user_id.arr);
		  if (print_name_yn.arr[0]	== 'Y')
		  {

			get_user_name(sy_user_id.arr);

		   /*----------------------------------------*/ 
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s4B",ESC);
			//fprintf(fp,"Reprinted By  : ");
			fprintf(fp,"%-13.13s : ", local_legend[67]); //added for globalisation 
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s-3B",ESC); 
			
			sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);
			sprintf(in_str,"%s%-13.13s","",local_legend[67]);
			print_html_line (in_str,out_str);			
			sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=15%c><b>%s</td><td class=font_disp width=2%c>:</b></td>",l_html_ftr_str,l_prtg,out_str,l_prtg);
			strcpy(out_str,"");
								  
  			sprintf(l_str,"%s", sy_user_name.arr);

			fprintf(fp,"%-60.60s\n",l_str);

			sprintf(in_str,"%s%-60.60s","",l_str);
			print_html_line (in_str,out_str);			
			sprintf(l_html_ftr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_ftr_str,out_str);
			strcpy(out_str,"");

			get_position_desc(sy_func_role_id.arr);

			sprintf(l_str,"%s", nd_position_desc.arr);
			fprintf(fp,"                ");
			fprintf(fp,"%-30.30s",l_str);	
			fprintf(fp, "    ");

			sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);
			sprintf(in_str,"%s%-30.30s","",l_str);
			print_html_line (in_str,out_str);			
			sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp width=17%c>&nbsp;</td><td class=font_disp width=36%c>%s</td>",l_html_ftr_str,l_prtg,l_prtg,out_str);
			strcpy(out_str,"");

		   /*----------------------------------------*/	   
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s4B",ESC);
		   //fprintf(fp,"Reprinted Date : ");
			fprintf(fp,"%-15.15s : ", local_legend[68]); //added for globalisation 
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s-3B",ESC); 
		   
		   sprintf(in_str,"%s%-15.15s","",local_legend[68]);
		   print_html_line (in_str,out_str);		   
		   sprintf(l_html_ftr_str,"%s<td class=font_disp align=right width=18%c><b>%s</td><td class=font_disp align=center width=3%c>:</b></td>",l_html_ftr_str,l_prtg,out_str,l_prtg);
		   strcpy(out_str,"");	   		     

			l_sy_req_date.arr[0]	= '\0';
			l_sy_req_date.len	= 0;

			/* EXEC SQL SELECT  to_char(to_date(:sy_req_date,'DDMMYYHH24MISS'),'DD/MM/YYYY HH24:MI')
				   INTO		:l_sy_req_date
				   FROM		DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select to_char(to_date(:b0,'DDMMYYHH24MISS'),'DD/MM/YYYY H\
H24:MI') into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7900;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[0] = (unsigned int  )32;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
   sqlstm.sqhstl[1] = (unsigned int  )32;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			   if (OERROR);

			l_sy_req_date.arr[l_sy_req_date.len] = '\0';

	 /**** date conversion start for globalisation ************/
        /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:l_sy_req_date1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:l_sy_req_date1 :=sm_convert_datetime_2t(to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
        struct sqlexd sqlstm;
        sqlstm.sqlvsn = 10;
        sqlstm.arrsiz = 33;
        sqlstm.sqladtp = &sqladt;
        sqlstm.sqltdsp = &sqltds;
        sqlstm.stmt = "declare t_date date ; BEGIN :l_sy_req_date1 := sm_con\
vert_datetime_2t ( to_date ( :l_sy_req_date , 'DD/MM/YYYY HH24:MI' ) , :langua\
ge_id ) ; END ;";
        sqlstm.iters = (unsigned int  )1;
        sqlstm.offset = (unsigned int  )7923;
        sqlstm.cud = sqlcud0;
        sqlstm.sqlest = (unsigned char  *)&sqlca;
        sqlstm.sqlety = (unsigned short)256;
        sqlstm.occurs = (unsigned int  )0;
        sqlstm.sqhstv[0] = (         void  *)&l_sy_req_date1;
        sqlstm.sqhstl[0] = (unsigned int  )32;
        sqlstm.sqhsts[0] = (         int  )0;
        sqlstm.sqindv[0] = (         void  *)0;
        sqlstm.sqinds[0] = (         int  )0;
        sqlstm.sqharm[0] = (unsigned int  )0;
        sqlstm.sqadto[0] = (unsigned short )0;
        sqlstm.sqtdso[0] = (unsigned short )0;
        sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
        sqlstm.sqhstl[1] = (unsigned int  )32;
        sqlstm.sqhsts[1] = (         int  )0;
        sqlstm.sqindv[1] = (         void  *)0;
        sqlstm.sqinds[1] = (         int  )0;
        sqlstm.sqharm[1] = (unsigned int  )0;
        sqlstm.sqadto[1] = (unsigned short )0;
        sqlstm.sqtdso[1] = (unsigned short )0;
        sqlstm.sqhstv[2] = (         void  *)&language_id;
        sqlstm.sqhstl[2] = (unsigned int  )7;
        sqlstm.sqhsts[2] = (         int  )0;
        sqlstm.sqindv[2] = (         void  *)0;
        sqlstm.sqinds[2] = (         int  )0;
        sqlstm.sqharm[2] = (unsigned int  )0;
        sqlstm.sqadto[2] = (unsigned short )0;
        sqlstm.sqtdso[2] = (unsigned short )0;
        sqlstm.sqphsv = sqlstm.sqhstv;
        sqlstm.sqphsl = sqlstm.sqhstl;
        sqlstm.sqphss = sqlstm.sqhsts;
        sqlstm.sqpind = sqlstm.sqindv;
        sqlstm.sqpins = sqlstm.sqinds;
        sqlstm.sqparm = sqlstm.sqharm;
        sqlstm.sqparc = sqlstm.sqharc;
        sqlstm.sqpadto = sqlstm.sqadto;
        sqlstm.sqptdso = sqlstm.sqtdso;
        sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	 /**** date conversion end for globalisation ************/


		   fprintf(fp,"%-s\n",l_sy_req_date1.arr);

		   sprintf(l_html_ftr_str,"%s<td class=font_disp>%s</td></tr></table>",l_html_ftr_str,l_sy_req_date1.arr);

//		   fprintf(fp,"%-s\n",l_sy_req_date.arr);
		   /*----------------------------------------*/

   	   		sy_user_name.arr[0]		= '\0';
			sy_user_name.len			= 0; 



		}
////////////////
	  
	}

/****** FOOTER PRINTING FROM RL_SECTION_CTL  ****************/
   if ( (strlen(rl_footer_line_1.arr) > 0) ||
			(strlen(rl_footer_line_2.arr) > 0) )
   {
		if (strlen(rl_footer_line_1.arr) > 0) 
		{
			fprintf(fp, "%-79.79s\n", rl_footer_line_1.arr);
			
		    sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);
			sprintf(in_str,"%s%-79.79s","",rl_footer_line_1.arr);
		    print_html_line (in_str,out_str);			
		    sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_ftr_str,out_str);
		    strcpy(out_str,"");
		}
		if (strlen(rl_footer_line_2.arr) > 0) 
		{
			fprintf(fp, "%-79.79s\n", rl_footer_line_2.arr);
			
		    sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);
			sprintf(in_str,"%s%-79.79s","",rl_footer_line_2.arr);
		    print_html_line (in_str,out_str);
		    sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp>%s</td></tr></table>",l_html_ftr_str,out_str);
		    strcpy(out_str,"");		
		}
   }


   /*----------------------------------------*/
   if (rl_hdr_extra_copies_to.len && copy == 2  && 
		strcmp(draft_printing_yn.arr, "N") == 0)
   {
      /*----------------------------------------*/
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s4B",ESC);
      //fprintf(fp,"Copy To : ");
      fprintf(fp,"%-8.8s: ", local_legend[23]); //added for globalisation
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s-3B",ESC); 
	  
	  sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);
	  sprintf(in_str,"%s%-8.8s","",local_legend[23]);
	  print_html_line (in_str,out_str);	  
	  sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp><b>%s:</b>",l_html_ftr_str,out_str);
	  strcpy(out_str,"");

      /*----------------------------------------*/

	  sprintf(l_str,"%24.24s",rl_hdr_extra_copies_to.arr);
	  
	  print_html_line (l_str,out_str);
	  sprintf(l_html_ftr_str,"%s&nbsp;%s</td></tr></table>",l_html_ftr_str,out_str);
      strcpy(out_str,"");
   }
   else
   {
      sprintf(l_str,"%34.34s"," ");
	  sprintf(l_html_ftr_str,"%s<a class=font_disp><br></a>",l_html_ftr_str);	     
   }

   fprintf(fp,"%s\n",l_str);

   if(last_page == 0)
      //sprintf(l_str,"%-43.43s--CONTINUED--"," ");
      //sprintf(l_str,"%-43.43s--%-9.9s--"," ",local_legend[24]); //added for globalisation
	    sprintf(l_str,"%-34.34s--%-9.9s--"," ",local_legend[24]); //added for globalisation
   else
      //sprintf(l_str,"%-43.43s      --END--"," ");
      sprintf(l_str,"%-43.43s --%-3.3s--"," ",local_legend[25]);// added for globalisation

   
   sprintf(l_html_ftr_str,"%s<table cellspacing=0 cellpadding=0 width=100%c>",l_html_ftr_str,l_prtg);
   print_html_line (l_str,out_str);
   sprintf(l_html_ftr_str,"%s<tr><td class=page_left_align>&nbsp;</td><td class=font_disp align=center>%s</td></tr></table>",l_html_ftr_str,l_str);    
   strcpy(out_str,"");
      
   if(last_page == 0)
   sprintf(l_html_ftr_str,"%s<div style='page-break-before: always'></div>",l_html_ftr_str);

   write_html(fp4,l_html_ftr_str);   
   
   fprintf(fp,"%s\f",l_str);    

   fprintf(fp,"%cE",ESC); // added on 21.10.2004 to reset the printer settings.

   lctr = 0; 
  
}

/*-----------------------------------------------------*/


/*----added on 09.07.2007---AGAINST ARTEMIS REQUEST -----------------------------*/
print_footer6(foot_ind)
int foot_ind;
{
   int fi = 0;
   char l_str[100];
   l_str[0] = '\0'; 

   for(fi=0; fi < 87; fi++)
       fprintf(fp,"%c",'_');

   fprintf(fp,"\n");
   
   fflush(fp);

      if (rl_name_on_report_yn.arr[0] == 'Y')
	  {

		get_print_name(first_user.arr);
	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(first_user.arr);

	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
//		fprintf(fp,"Released/Reviewed By : ");
		//fprintf(fp,"Released By   : ");
		fprintf(fp,"%-13.13s : ", local_legend[61]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC);   
  	    sprintf(l_str,"%s", sy_user_name.arr);

		fprintf(fp,"%-60.60s\n",l_str);

		get_position_desc(sy_func_role_id.arr);

		fprintf(fp,"                ");
		sprintf(l_str,"%s", nd_position_desc.arr);
		fprintf(fp,"%-30.30s",l_str);	
		fprintf(fp, "    ");
		}
		/*----------------------------------------*/

	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
	   //fprintf(fp,"Released Date  : ");
	   fprintf(fp,"%-15.15s : ", local_legend[62]); //added for globalisation
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);   
	   fprintf(fp,"%-s\n",footer_released_date);
	   /*----------------------------------------*/

	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;

	 }

	  get_print_name(rl_hdr_released_by_id.arr);
	  if (print_name_yn.arr[0]	== 'Y')
	  {

		get_user_name(rl_hdr_released_by_id.arr);

	   /*----------------------------------------*/
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
//		fprintf(fp,"Reviewed By : ");
		//fprintf(fp,"Authorized By : ");
		fprintf(fp,"%-13.13s : ", local_legend[64]); //added for globalisation
		fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s-3B",ESC);   
  	    sprintf(l_str,"%s", sy_user_name.arr);

		fprintf(fp,"%-60.60s\n",l_str);

		get_position_desc(sy_func_role_id.arr);

		sprintf(l_str,"%s", nd_position_desc.arr);
		fprintf(fp,"                ");
		fprintf(fp,"%-30.30s",l_str);	
		fprintf(fp, "    ");


	   /*----------------------------------------*/	   
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s4B",ESC);
//	   fprintf(fp,"Reviewed Date : ");
	   //fprintf(fp,"Authorized Date: ");
	   fprintf(fp,"%-15.15s : ", local_legend[66]); //added for globalisation
	   fprintf(fp,"%c&k4S",ESC); 
	   fprintf(fp,"%c(s-3B",ESC);   
	   //fprintf(fp,"%-s\n",rl_hdr_released_date.arr);
	   fprintf(fp,"%-s\n",rl_hdr_released_date1.arr); //added for globalisation
	   /*----------------------------------------*/

   	   	sy_user_name.arr[0]		= '\0';
		sy_user_name.len			= 0;


	  }

		/*----------------------------------------*/
		/***********************
	    fprintf(fp,"%c&k4S",ESC); 
		fprintf(fp,"%c(s4B",ESC);
		fprintf(fp,"Reprint Date : ");
        fprintf(fp,"%c&k4S",ESC); 
        fprintf(fp,"%c(s-3B",ESC);   
		***********************/
		/*----------------------------------------*/
	/***********************
	   if (rl_prn_ctrl_hdr_rp_yn.arr[0] == 'Y')
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);
	   else
		   sprintf(l_str,"%-16.16s         ",nd_result_printed_date.arr);

	   fprintf(fp,"%s",nd_result_printed_date.arr);
	***********************/

///////////////// 12.07.2004 'ss'
		if (p_param8.arr[0] == 'P')
		{
		  get_print_name(sy_user_id.arr);
		  if (print_name_yn.arr[0]	== 'Y')
		  {

			get_user_name(sy_user_id.arr);

		   /*----------------------------------------*/
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s4B",ESC);
			//fprintf(fp,"Reprinted By  : ");
			fprintf(fp,"%-12.12s: ", local_legend[67]); //added for globalisation 
//			fprintf(fp,"                ");
			fprintf(fp,"%c&k4S",ESC); 
			fprintf(fp,"%c(s-3B",ESC);   
  			sprintf(l_str,"%s", sy_user_name.arr);

			fprintf(fp,"%-60.60s\n",l_str);

			get_position_desc(sy_func_role_id.arr);

			sprintf(l_str,"%s", nd_position_desc.arr);
			fprintf(fp,"                ");
			fprintf(fp,"%-30.30s",l_str);	
			fprintf(fp, "    ");


		   /*----------------------------------------*/	   
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s4B",ESC);
		   //fprintf(fp,"Reprinted Date : ");
			fprintf(fp,"%-14.14s: ", local_legend[68]); //added for globalisation 
		   fprintf(fp,"%c&k4S",ESC); 
		   fprintf(fp,"%c(s-3B",ESC);   

			l_sy_req_date.arr[0]	= '\0';
			l_sy_req_date.len	= 0;

			/* EXEC SQL SELECT  to_char(to_date(:sy_req_date,'DDMMYYHH24MISS'),'DD/MM/YYYY HH24:MI')
				   INTO		:l_sy_req_date
				   FROM		DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select to_char(to_date(:b0,'DDMMYYHH24MISS'),'DD/MM/YYYY H\
H24:MI') into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )7950;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&sy_req_date;
   sqlstm.sqhstl[0] = (unsigned int  )32;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
   sqlstm.sqhstl[1] = (unsigned int  )32;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			   if (OERROR);

			l_sy_req_date.arr[l_sy_req_date.len] = '\0';
	 /**** date conversion start for globalisation ************/
        /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:l_sy_req_date1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:l_sy_req_date1 :=sm_convert_datetime_2t(to_date(:l_sy_req_date,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
        struct sqlexd sqlstm;
        sqlstm.sqlvsn = 10;
        sqlstm.arrsiz = 33;
        sqlstm.sqladtp = &sqladt;
        sqlstm.sqltdsp = &sqltds;
        sqlstm.stmt = "declare t_date date ; BEGIN :l_sy_req_date1 := sm_con\
vert_datetime_2t ( to_date ( :l_sy_req_date , 'DD/MM/YYYY HH24:MI' ) , :langua\
ge_id ) ; END ;";
        sqlstm.iters = (unsigned int  )1;
        sqlstm.offset = (unsigned int  )7973;
        sqlstm.cud = sqlcud0;
        sqlstm.sqlest = (unsigned char  *)&sqlca;
        sqlstm.sqlety = (unsigned short)256;
        sqlstm.occurs = (unsigned int  )0;
        sqlstm.sqhstv[0] = (         void  *)&l_sy_req_date1;
        sqlstm.sqhstl[0] = (unsigned int  )32;
        sqlstm.sqhsts[0] = (         int  )0;
        sqlstm.sqindv[0] = (         void  *)0;
        sqlstm.sqinds[0] = (         int  )0;
        sqlstm.sqharm[0] = (unsigned int  )0;
        sqlstm.sqadto[0] = (unsigned short )0;
        sqlstm.sqtdso[0] = (unsigned short )0;
        sqlstm.sqhstv[1] = (         void  *)&l_sy_req_date;
        sqlstm.sqhstl[1] = (unsigned int  )32;
        sqlstm.sqhsts[1] = (         int  )0;
        sqlstm.sqindv[1] = (         void  *)0;
        sqlstm.sqinds[1] = (         int  )0;
        sqlstm.sqharm[1] = (unsigned int  )0;
        sqlstm.sqadto[1] = (unsigned short )0;
        sqlstm.sqtdso[1] = (unsigned short )0;
        sqlstm.sqhstv[2] = (         void  *)&language_id;
        sqlstm.sqhstl[2] = (unsigned int  )7;
        sqlstm.sqhsts[2] = (         int  )0;
        sqlstm.sqindv[2] = (         void  *)0;
        sqlstm.sqinds[2] = (         int  )0;
        sqlstm.sqharm[2] = (unsigned int  )0;
        sqlstm.sqadto[2] = (unsigned short )0;
        sqlstm.sqtdso[2] = (unsigned short )0;
        sqlstm.sqphsv = sqlstm.sqhstv;
        sqlstm.sqphsl = sqlstm.sqhstl;
        sqlstm.sqphss = sqlstm.sqhsts;
        sqlstm.sqpind = sqlstm.sqindv;
        sqlstm.sqpins = sqlstm.sqinds;
        sqlstm.sqparm = sqlstm.sqharm;
        sqlstm.sqparc = sqlstm.sqharc;
        sqlstm.sqpadto = sqlstm.sqadto;
        sqlstm.sqptdso = sqlstm.sqtdso;
        sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	 /**** date conversion end for globalisation ************/


		   fprintf(fp,"%-s\n",l_sy_req_date1.arr);

		 //  fprintf(fp,"%-s\n",l_sy_req_date.arr);
		   /*----------------------------------------*/

   	   		sy_user_name.arr[0]		= '\0';
			sy_user_name.len			= 0; 



		}
////////////////
	  
	}

/****** FOOTER PRINTING FROM RL_SECTION_CTL  ****************/
   if ( (strlen(rl_footer_line_1.arr) > 0) ||
			(strlen(rl_footer_line_2.arr) > 0) )
   {
		if (strlen(rl_footer_line_1.arr) > 0) 
			fprintf(fp, "%-79.79s\n", rl_footer_line_1.arr);

		if (strlen(rl_footer_line_2.arr) > 0) 
			fprintf(fp, "%-79.79s\n", rl_footer_line_2.arr);
   }


   /*----------------------------------------*/

   if (rl_hdr_extra_copies_to.len && copy == 2  && 
		strcmp(draft_printing_yn.arr, "N") == 0)
   {
      /*----------------------------------------*/
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s4B",ESC);
      //fprintf(fp,"Copy To : ");
      fprintf(fp,"%-8.8s: ", local_legend[23]); //added for globalisation
      fprintf(fp,"%c&k4S",ESC); 
      fprintf(fp,"%c(s-3B",ESC);   
      /*----------------------------------------*/

      sprintf(l_str,"%24.24s",rl_hdr_extra_copies_to.arr);
   }
   else
      sprintf(l_str,"%34.34s"," ");

   fprintf(fp,"%s\n",l_str);

/*******
   if(last_page == 0)
      sprintf(l_str,"%-73.73s--CONTINUED--"," ");
   else
      sprintf(l_str,"%-73.73s      --END--"," ");
********/

   if(last_page == 0)
      //sprintf(l_str,"%-43.43s--CONTINUED--"," ");
      sprintf(l_str,"%-43.43s--%-9.9s--"," ",local_legend[24]); //added for globalisation
   else
      sprintf(l_str,"%-43.43s      --END--"," ");
      sprintf(l_str,"%-43.43s --%-3.3s--"," ",local_legend[25]);// added for globalisation


/*----------------------------------------*/

      sprintf(l_str,"%s%10.10sPage(s) : %3d\n",l_str," ",pctr);    /// added 09.07.2007
/*----------------------------------------*/

   fprintf(fp,"%s\f",l_str);   

   fprintf(fp,"%cE",ESC); // added on 21.10.2004 to reset the printer settings.

   lctr = 0; 
  
}

/*-----------------------------------------------------*/


get_order_date_time()
{
	nd_order_date_time.arr[0]		= '\0';
	nd_order_date_time.len		= 0;

   /* EXEC SQL SELECT TO_CHAR(ord_date_time,'DD/MM/YYYY HH24:MI')
			INTO :nd_order_date_time
			FROM OR_ORDER
			WHERE order_id = :rl_order_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select TO_CHAR(ord_date_time,'DD/MM/YYYY HH24:MI') into :b\
0  from OR_ORDER where order_id=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8000;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_order_date_time;
   sqlstm.sqhstl[0] = (unsigned int  )19;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_order_id;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 

    if(OERROR);

	if (NODATAFOUND);    

	nd_order_date_time.arr[nd_order_date_time.len]	= '\0';
     
   
}
/*------------------------------------------------------------*/
/*------------ added the below on 12.04.2005 -----------*/
get_position_desc(char *fuserid)
{
	strcpy(sy_user.arr, fuserid);
	sy_user.len  = strlen(sy_user.arr);

	nd_position_desc.arr[0]		= '\0';
	nd_position_desc.len		= 0;
    
	/* EXEC SQL SELECT b.position_desc position_desc
			INTO :nd_position_desc
			FROM  AM_PRACTITIONER A,AM_POSITION B
			WHERE a.practitioner_id  = :sy_user
			AND   a.position_code = b.position_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select b.position_desc position_desc into :b0  from AM_PRACT\
ITIONER A ,AM_POSITION B where (a.practitioner_id=:b1 and a.position_code=b.po\
sition_code)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8023;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_position_desc;
 sqlstm.sqhstl[0] = (unsigned int  )33;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sy_user;
 sqlstm.sqhstl[1] = (unsigned int  )33;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if(OERROR);

	if (NODATAFOUND);

	nd_position_desc.arr[nd_position_desc.len]	= '\0';

}
/*------------------------------------------------------------*/

/*---- added the below on 21.05.2005  -----------------*/

get_result_printed_date()
{
	rl_hdr_result_printed_date.arr[0]	= '\0';
	rl_hdr_result_printed_date.len		= 0;
	rl_hdr_status.arr[0]				= '\0';
	rl_hdr_status.len					= 0;
    rl_hdr_section_code.arr[0]          = '\0';
    rl_hdr_section_code.len             = 0;
	d_episode_type.arr[0]				= '\0';
	d_episode_type.len					= 0;

   /* EXEC SQL SELECT  TO_CHAR(result_printed_date,'DD/MM/YYYY HH24:MI:SS'),NVL(status,'O'),
					section_code, episode_type
			  INTO :rl_hdr_result_printed_date,:rl_hdr_status,:rl_hdr_section_code,:d_episode_type
			  FROM  RL_REQUEST_HEADER
             WHERE  SPECIMEN_NO = :nd_spec_no
 			   AND  OPERATING_FACILITY_ID = :nd_operating_facility_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select TO_CHAR(result_printed_date,'DD/MM/YYYY HH24:MI:SS'\
) ,NVL(status,'O') ,section_code ,episode_type into :b0,:b1,:b2,:b3  from RL_R\
EQUEST_HEADER where (SPECIMEN_NO=:b4 and OPERATING_FACILITY_ID=:b5)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8046;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_hdr_result_printed_date;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_hdr_status;
   sqlstm.sqhstl[1] = (unsigned int  )4;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_hdr_section_code;
   sqlstm.sqhstl[2] = (unsigned int  )4;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
   sqlstm.sqhstl[3] = (unsigned int  )4;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&nd_spec_no;
   sqlstm.sqhstl[4] = (unsigned int  )23;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[5] = (unsigned int  )7;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND);    

    if (OERROR);

	rl_hdr_result_printed_date.arr[rl_hdr_result_printed_date.len]	= '\0';
	rl_hdr_status.arr[rl_hdr_status.len]	= '\0';
    rl_hdr_section_code.arr[rl_hdr_section_code.len] 			= '\0';
	d_episode_type.arr[d_episode_type.len] = '\0';

}
/*------------------------------------------------------------*/
/*---- added the below on 21.05.2005  -----------------*/

get_tst_rslt_max_reviewed_date()
{
	rl_tst_rslt_max_rev_date.arr[0]	= '\0';
	rl_tst_rslt_max_rev_date.len		= 0;


   /* EXEC SQL SELECT  TO_CHAR(MAX(reviewed_date),'DD/MM/YYYY HH24:MI:SS')
			  INTO :rl_tst_rslt_max_rev_date
			  FROM  RL_TEST_RESULT
             WHERE  SPECIMEN_NO = :nd_spec_no
 			   AND  OPERATING_FACILITY_ID = :nd_operating_facility_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select TO_CHAR(max(reviewed_date),'DD/MM/YYYY HH24:MI:SS')\
 into :b0  from RL_TEST_RESULT where (SPECIMEN_NO=:b1 and OPERATING_FACILITY_I\
D=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8085;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_tst_rslt_max_rev_date;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND);    

    if (OERROR);

	rl_tst_rslt_max_rev_date.arr[rl_tst_rslt_max_rev_date.len]	= '\0';

}
/*------------------------------------------------------------*/


/*--------- added the below on 19.10.2005 -------------------------------------*/
check_neonate_mother_spec_yn() 
{

   d_mother_specimen_yn.arr[0]		= '\0';      
   d_mother_specimen_yn.len		= 0;

   /* EXEC SQL SELECT  'Y'
			  INTO :d_mother_specimen_yn
		  	  FROM RL_NEONATE_MOTHER_SPECIMENS
			 WHERE specimen_no 			 = :nd_spec_no
			   AND operating_facility_id = :nd_operating_facility_id
			   AND NVL(nn_specimen_no_yn,'N') = 'N'
			   AND specimen_no <> nn_specimen_no; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select 'Y' into :b0  from RL_NEONATE_MOTHER_SPECIMENS wher\
e (((specimen_no=:b1 and operating_facility_id=:b2) and NVL(nn_specimen_no_yn,\
'N')='N') and specimen_no<>nn_specimen_no)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8112;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&d_mother_specimen_yn;
   sqlstm.sqhstl[0] = (unsigned int  )4;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
   sqlstm.sqhstl[1] = (unsigned int  )23;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND)
		strcpy(d_mother_specimen_yn.arr,"N");    

    if (OERROR)
		strcpy(d_mother_specimen_yn.arr,"N");    

	d_mother_specimen_yn.arr[d_mother_specimen_yn.len]	= '\0';

	if(strcmp(d_mother_specimen_yn.arr,"N") == 0)
		l_should_print_yn = 'Y';
	if(strcmp(d_mother_specimen_yn.arr,"Y") == 0)
		l_should_print_yn = 'N';

//sprintf(string_var,"checking neonates..specno=%d,should print=%c",nd_spec_no.arr,l_should_print_yn);
//disp_message(ERR_MESG,string_var);

}

/*------------------------------------------------------------*/

/*--------- added the below on 16.01.2006 -------------------------------------*/
get_test_units_desc_from_sy_uom()
{

   rl_tst_cd_test_units_desc.arr[0]		= '\0';      
   rl_tst_cd_test_units_desc.len		= 0;

   /* EXEC SQL SELECT  short_desc
			  INTO :rl_tst_cd_test_units_desc
		  	  FROM SY_UOM_LANG_VW
			 WHERE uom_code = :rl_tst_cd_test_units
			 AND LANGUAGE_ID = :language_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select short_desc into :b0  from SY_UOM_LANG_VW where (uom\
_code=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8139;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_tst_cd_test_units_desc;
   sqlstm.sqhstl[0] = (unsigned int  )18;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_tst_cd_test_units;
   sqlstm.sqhstl[1] = (unsigned int  )13;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&language_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND)
	{
		strcpy(rl_tst_cd_test_units_desc.arr,rl_tst_cd_test_units.arr);    
		rl_tst_cd_test_units_desc.len = strlen(rl_tst_cd_test_units_desc.arr);
//		rl_tst_cd_test_units_desc.arr[rl_tst_cd_test_units_desc.len]	= '\0';

	}

    if (OERROR)
	{
		strcpy(rl_tst_cd_test_units_desc.arr,rl_tst_cd_test_units.arr);    
		rl_tst_cd_test_units_desc.len = strlen(rl_tst_cd_test_units_desc.arr);
	}

	rl_tst_cd_test_units_desc.arr[rl_tst_cd_test_units_desc.len]	= '\0';

}
/*------------------------------------------------------------*/
get_si_units_equv_val()
{

   d_eqvl_test_units.arr[0]		= '\0';        
   d_eqvl_test_units.len		= 0;

   
   d_numeric_eqvl_value	= 0;
   d_numeric_eqvl_value2	= 0;
   d_low_val_nor_eqvl_value = 0;
   d_high_val_nor_eqvl_value = 0;

   l_flag = 0;


   /* EXEC SQL SELECT  eqvl_uom_code, eqvl_value
			  INTO :d_eqvl_test_units, :d_numeric_eqvl_value
		  	  FROM SY_UOM_EQVL
			 WHERE uom_code = :rl_tst_cd_test_units
			   AND eqvl_uom_code = :rl_tst_cd_oth_units; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select eqvl_uom_code ,eqvl_value into :b0,:b1  from SY_UOM\
_EQVL where (uom_code=:b2 and eqvl_uom_code=:b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8166;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&d_eqvl_test_units;
   sqlstm.sqhstl[0] = (unsigned int  )13;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&d_numeric_eqvl_value;
   sqlstm.sqhstl[1] = (unsigned int  )sizeof(long double);
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_tst_cd_test_units;
   sqlstm.sqhstl[2] = (unsigned int  )13;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_tst_cd_oth_units;
   sqlstm.sqhstl[3] = (unsigned int  )13;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	if (NODATAFOUND)
		l_flag = 1; 

    if (OERROR)
		l_flag = 1;

	d_eqvl_test_units.arr[d_eqvl_test_units.len]	= '\0';

    d_numeric_eqvl_value2	= d_numeric_eqvl_value;

    if (l_flag == 0)
	{

      d_numeric_eqvl_value = d_numeric_eqvl_value * (atof(rl_tst_numeric_result.arr));

	  /* EXEC SQL SELECT to_char(:d_numeric_eqvl_value)
	           INTO   :rl_tst_numeric_result
			   FROM DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select to_char(:b0) into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8197;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&d_numeric_eqvl_value;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(long double);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_tst_numeric_result;
   sqlstm.sqhstl[1] = (unsigned int  )18;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



//	  strcpy(rl_tst_numeric_result.arr,_fcvt(d_numeric_eqvl_value));

   	  rl_tst_numeric_result.arr[rl_tst_numeric_result.len]	= '\0';


	  d_numeric_length = 0;
	  d_dec_pos		   = 0;

	  /* EXEC SQL SELECT length(:rl_tst_numeric_result), instr(:rl_tst_numeric_result,'.')
	             INTO :d_numeric_length, :d_decimal_pos
				 FROM DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select length(:b0) ,instr(:b0,'.') into :b2,:b3  from DUAL\
 ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8220;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&rl_tst_numeric_result;
   sqlstm.sqhstl[0] = (unsigned int  )18;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_tst_numeric_result;
   sqlstm.sqhstl[1] = (unsigned int  )18;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&d_numeric_length;
   sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&d_decimal_pos;
   sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



      if ( (d_numeric_length > 10) && (d_dec_pos == 0) )
         strcpy(rl_tst_numeric_result.arr,">999999999");

	  rl_tst_numeric_result.arr[rl_tst_numeric_result.len]	= '\0';


      strcpy(rl_tst_cd_test_units.arr,d_eqvl_test_units.arr);    

	  if ( rl_tst_ran_low_val_nor.len  || rl_tst_ran_high_val_nor.len )
      {
		d_low_val_nor_eqvl_value = d_numeric_eqvl_value2 * (atof(rl_tst_ran_low_val_nor.arr));
		d_high_val_nor_eqvl_value = d_numeric_eqvl_value2 * (atof(rl_tst_ran_high_val_nor.arr));
//		strcpy(rl_tst_ran_low_val_nor.arr,d_low_val_nor_eqvl_value);
	  /* EXEC SQL SELECT to_char(:d_low_val_nor_eqvl_value)
	           INTO   :rl_tst_ran_low_val_nor
			   FROM DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select to_char(:b0) into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8251;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&d_low_val_nor_eqvl_value;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(long double);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_tst_ran_low_val_nor;
   sqlstm.sqhstl[1] = (unsigned int  )18;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


//		strcpy(rl_tst_ran_high_val_nor.arr,d_high_val_nor_eqvl_value);
	  /* EXEC SQL SELECT to_char(:d_high_val_nor_eqvl_value)
	           INTO   :rl_tst_ran_high_val_nor
			   FROM DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select to_char(:b0) into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8274;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&d_high_val_nor_eqvl_value;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(long double);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&rl_tst_ran_high_val_nor;
   sqlstm.sqhstl[1] = (unsigned int  )18;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	  }

	}

}
/*------------------------------------------------------------*/

get_mail_body_oth_dtls()  
{   

   d_mail_subject.arr[0]		= '\0';      
   d_mail_subject.len			= 0;
   d_mail_salutation.arr[0]		= '\0';      
   d_mail_salutation.len		= 0;
   d_mail_body.arr[0]			= '\0';      
   d_mail_body.len				= 0;
   d_mail_footer.arr[0]			= '\0';      
   d_mail_footer.len			= 0;

					 /* EXEC SQL EXECUTE  
						begin
							RL_MAIL_FORMAT.GENERATE_FORMAT('RLRRSENQ',
														:nd_operating_facility_id,
														:rl_prn_ctrl_hdr_sp_no,
														'M',
														:d_mail_subject,
														:d_mail_salutation,
														:d_mail_body,
														:d_mail_footer
													  );
						end;
					 END-EXEC; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 10;
      sqlstm.arrsiz = 33;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "begin RL_MAIL_FORMAT . GENERATE_FORMAT ( 'RLRRSENQ' , :\
nd_operating_facility_id , :rl_prn_ctrl_hdr_sp_no , 'M' , :d_mail_subject , :d\
_mail_salutation , :d_mail_body , :d_mail_footer ) ; end ;";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )8297;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)256;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
      sqlstm.sqhstl[0] = (unsigned int  )7;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&rl_prn_ctrl_hdr_sp_no;
      sqlstm.sqhstl[1] = (unsigned int  )23;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&d_mail_subject;
      sqlstm.sqhstl[2] = (unsigned int  )2003;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&d_mail_salutation;
      sqlstm.sqhstl[3] = (unsigned int  )4003;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&d_mail_body;
      sqlstm.sqhstl[4] = (unsigned int  )4003;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqhstv[5] = (         void  *)&d_mail_footer;
      sqlstm.sqhstl[5] = (unsigned int  )2003;
      sqlstm.sqhsts[5] = (         int  )0;
      sqlstm.sqindv[5] = (         void  *)0;
      sqlstm.sqinds[5] = (         int  )0;
      sqlstm.sqharm[5] = (unsigned int  )0;
      sqlstm.sqadto[5] = (unsigned short )0;
      sqlstm.sqtdso[5] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					 d_mail_subject.arr[d_mail_subject.len]		  = '\0';
					 d_mail_salutation.arr[d_mail_salutation.len] = '\0';
					 d_mail_body.arr[d_mail_body.len]			  = '\0';
					 d_mail_footer.arr[d_mail_footer.len]		  = '\0';
}

/*------------------------------------------------------------*/
///// added on 10.04.2006
get_operational_flags()
{
 
	VCbdoperationalYN.arr[0] = '\0';
	VCbdoperationalYN.len = 0;
	strcpy(VCbdoperationalYN.arr,"N");

	VCbtoperationalYN.arr[0] = '\0';
	VCbtoperationalYN.len = 0;
	strcpy(VCbtoperationalYN.arr,"N");

	/* EXEC SQL EXECUTE 
	BEGIN 
		GET_OPERATIONAL_MODULES(:nd_operating_facility_id, :VCoperational_modules);
	    IF INSTR(:VCoperational_modules, 'BD') > 0 THEN
			:VCbdoperationalYN := 'Y';
		END IF;
		IF INSTR(:VCoperational_modules, 'BT') > 0 THEN
			:VCbtoperationalYN := 'Y';
		END IF;

	END ;
	END-EXEC ; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin GET_OPERATIONAL_MODULES ( :nd_operating_facility_id , \
:VCoperational_modules ) ; IF INSTR ( :VCoperational_modules , 'BD' ) > 0 THEN\
 :VCbdoperationalYN := 'Y' ; END IF ; IF INSTR ( :VCoperational_modules , 'BT'\
 ) > 0 THEN :VCbtoperationalYN := 'Y' ; END IF ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8336;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&VCoperational_modules;
 sqlstm.sqhstl[1] = (unsigned int  )2002;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&VCbdoperationalYN;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&VCbtoperationalYN;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	VCbdoperationalYN.len = strlen(VCbdoperationalYN.arr);
	VCbtoperationalYN.len = strlen(VCbtoperationalYN.arr);
			
}
/*------------------------------------------------------------*/
///// added on 10.04.2006
get_screen_donor_id() 
{

   d_screen_donor_id.arr[0]		= '\0';      
   d_screen_donor_id.len		= 0;
	
   if(strcmp(VCbdoperationalYN.arr,"Y") == 0)
   {
	   /* EXEC SQL SELECT  screen_donor_id
				  INTO :d_screen_donor_id
		  		  FROM BD_PARAM; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select screen_donor_id into :b0  from BD_PARAM ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8367;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&d_screen_donor_id;
    sqlstm.sqhstl[0] = (unsigned int  )32;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (NODATAFOUND);    
		if (OERROR);    

		d_screen_donor_id.arr[d_screen_donor_id.len]	= '\0';
	}

}
/*------------------------------------------------------------*/
///// added on 10.04.2006
get_screen_patient_id() 
{

   d_screen_patient_id.arr[0]		= '\0';      
   d_screen_patient_id.len		= 0;
	
   if(strcmp(VCbtoperationalYN.arr,"Y") == 0)
   {
	   /* EXEC SQL SELECT  screen_patient_id
				  INTO :d_screen_patient_id
		  		  FROM BT_PARAM; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select screen_patient_id into :b0  from BT_PARAM ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8386;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&d_screen_patient_id;
    sqlstm.sqhstl[0] = (unsigned int  )32;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (NODATAFOUND);    
		if (OERROR);    

		d_screen_patient_id.arr[d_screen_patient_id.len]	= '\0';
	}
}
/*------------------------------------------------------------*/
/*-----------------------------------------------------*/
print_culture_format4()
{

    char temp_sens_ind;
    char temp_line[81];
	char org[MAX_ORGANISMS][5];
    int still_org_dtl_left;
    int print_anti_flag = 0;
    int change_flag = 0;
	int e = 0;
    int anti_flag = 0;
    int c = 0, s = 0;
	int no_of_organisms = 0;
    int oflag = 1;
	int match_found = 0;


    open_result_organism();
	_flushall();
    while(fetch_result_org())
    {
        something_to_print = 1;
		something_to_print_for_test = 1;

		strcpy(org[no_of_organisms],rl_res_organism_code.arr);
	    no_of_organisms++;

		if(group && !group_printed) 
		{
			print_group_test_desc();
			group_printed = 1;
		}
		if(!test_printed)
		{
			sprintf(text_line,"%-40.40s",test_description);

			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		    sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);

			print_line(text_line);
			test_printed = 1;
		}

		if(oflag)
		{
		   	fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/

                        //sprintf(text_line,"%-46.46s%-41.41s","ORGANISM","COMMENT");
						sprintf(text_line,"%-46.46s%-41.41s", local_legend[29], local_legend[30]);// added for globalisation
			
			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		    sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
			l_text_uline = 'Y';			
			
			print_line_org_ant(text_line);

		   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

			oflag = 0;
		}

		fetch_org_desc();

		sprintf(text_line,"%-6.6s%-40.40s%-34.34s",rl_res_organism_code.arr,
							rl_res_organism_code_desc.arr,rl_res_comment_desc.arr);

		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);		
		
		print_line_org_ant(text_line);
		org_yn = 1;

		write_html(fp4,"<a class=font_disp><br></a>");

	    fprintf(fp,"\n");
		page_break(1); 
		
		open_sensitivity_format4();
		 

		a_flag = 0;   
		antb_yn = 0;  
        b_flag = 1;
		while(fetch_sensitivity_format4())
		{
			if ((! a_flag) && (b_flag))
			{
               
				if ((lctr + 4)> MAX_LINES) //// 17.12.2003
				{
					for (i=lctr;i<=MAX_LINES;i++) 
					{
					   fprintf(fp,"\n");
					   write_html(fp4,"<a class=font_disp><br><a>");
					}

					page_break(4);  
				}
				//sprintf(text_line,"%-46.46s %s","ANTIBIOTIC ","SENSITIVITY");
				
				get_kb_mic_legend(no_of_organisms, 'C');
				
				sprintf(text_line,"%-46.46s %-13.13s %s",local_legend[31], local_legend[32], l_kb_mic_legend);//added for globalisation

				fprintf(fp,"%c&k4S",ESC); 
   				fprintf(fp,"%c(s4B",ESC);

				sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
				l_text_bold = 'Y';

				print_line_org_ant(text_line);

				fprintf(fp,"%c&k4S",ESC); 
   				fprintf(fp,"%c(s-3B",ESC);   

				b_flag = 0;
			}

			if(a_flag)
			{
				//sprintf(text_line,"%-46.46s %s","ANTIBIOTIC ","SENSITIVITY");
				sprintf(text_line,"%-46.46s %-13.13s %s",local_legend[31], local_legend[32], local_legend[76]);//added for globalisation

				fprintf(fp,"%c&k4S",ESC); 
   				fprintf(fp,"%c(s4B",ESC);

				sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
				sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
				l_text_bold = 'Y';

				print_line_org_ant(text_line);

				fprintf(fp,"%c&k4S",ESC); 
   				fprintf(fp,"%c(s-3B",ESC);   

				a_flag = 0; 
			}		
		
			strcpy(rl_res_dtl_antibiotic_code.arr,b_antibiotic_code.arr);
			rl_res_dtl_antibiotic_code.len = strlen(b_antibiotic_code.arr);
			fetch_antibiotic_desc();
               
		    if (strcmp(rl_mic_to_print_yn.arr,"Y")==0) 
			 {

					if (strlen(b_mic_value.arr) > 0)
					{
						sprintf(text_line,"%-47.47s %-13.13s %-5.5s",rl_res_dtl_antibiotic_desc.arr,
													b_sensitivity_ind.arr,b_mic_value.arr);
					}
					else if (strlen(b_zone_value.arr) > 0)
					{
						sprintf(text_line,"%-47.47s %-13.13s %-5.5s",rl_res_dtl_antibiotic_desc.arr,
													b_sensitivity_ind.arr,b_zone_value.arr);

					}
					else
					{
						sprintf(text_line,"%-47.47s %-13.13s %-5.5s",rl_res_dtl_antibiotic_desc.arr,
													b_sensitivity_ind.arr," ");

					}
             } 
			else
			 {
					sprintf(text_line,"%-47.47s %s",rl_res_dtl_antibiotic_desc.arr,b_sensitivity_ind.arr);
              }  
			
			sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
			sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
						
			print_line_org_ant(text_line);

			antb_yn = 1;  /// 18.12.2003
		
		}   /// while(fetch_sensitivity_format4())

		antb_yn = 0;  /// 18.12.2003
		close_sensitivity_cur_format4();

	    fprintf(fp,"\n");

		write_html(fp4,"<a class=font_disp><br></a>");

		page_break(1);    


	}  //// while(fetch_result_org())

	antb_yn = 0;  /// 18.12.2003

	if(no_of_organisms)
	{
		//sprintf(text_line,"%-35.35s%-52.52s"," ","S - Sensitive     R - Resistant   I - Intermediate");

			strcpy(string_var, " ");
			sprintf(string_var, "%s     %s     %s", local_legend[17],local_legend[18],local_legend[19]);

		sprintf(text_line,"%-33.33s%-52.52s"," ", string_var); //added for globalisation

//		sprintf(text_line,"%-5.5s%-78.78s"," ","S - Sensitive    R - Resistant  I - Intermediate  N - Negative  P - Positive");
		
		sprintf(l_html_bdy_str,"<table cellspacing=0 cellpadding=0 width=100%c>",l_prtg);
		sprintf(l_html_bdy_str,"%s<tr><td class=page_left_align>&nbsp;</td>",l_html_bdy_str);
				
		print_line_org_ant(text_line);
	   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
	}
	close_organism_cur();
   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
    org_yn = 0;  

}



/*-----------------------------------------------------*/


print_culture_format5() 
{

    char temp_sens_ind;
    char temp_line[81];
	char org[MAX_ORGANISMS][5];
    int still_org_dtl_left;
    int print_anti_flag = 0;
    int change_flag = 0;
	int e = 0;
    int anti_flag = 0;
    int c = 0, s = 0, c1 = 0, c2 = 0, c3 = 0;
	int no_of_organisms = 0;
    int oflag = 1;
	int match_found = 0;


    open_result_organism();
	_flushall();
    while(fetch_result_org())
    {
        something_to_print = 1;
		something_to_print_for_test = 1;

		strcpy(org[no_of_organisms],rl_res_organism_code.arr);
	    no_of_organisms++;

		if(group && !group_printed) 
		{
			print_group_test_desc();
			group_printed = 1;
		}
		if(!test_printed)
		{
			sprintf(text_line,"%-40.40s",test_description);
			print_line(text_line);
			test_printed = 1;
		}

		if(oflag)
		{
		   	fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/

                        //sprintf(text_line,"%-46.46s%-41.41s","ORGANISM","COMMENT");
						sprintf(text_line,"%-46.46s%-41.41s", local_legend[29], local_legend[30]);// added for globalisation
			print_line_org_ant(text_line);

		   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

			oflag = 0;
		}

		fetch_org_desc();

		sprintf(text_line,"%-6.6s%-40.40s%-34.34s",rl_res_organism_code.arr,
							rl_res_organism_code_desc.arr,rl_res_comment_desc.arr);

		print_line_org_ant(text_line);
	} 

	close_organism_cur();

	_flushall();

	if(no_of_organisms)
	{
		something_to_print = 1;
		something_to_print_for_test = 1;

	    open_sensitivity();
	    fetch_sensitivity();

        c2 = 0;
		while(c2<=no_of_organisms)
		{

				t_antib_head_first_time = 0;

				if (t_antib_head_first_time == 0) 
				{
				    if(lctr +4 > MAX_LINES)
					  page_break(1);

   					fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
					sprintf(text_line,"");
					for(c=0;c<87;c++)
						sprintf(text_line,"%s%s",text_line," ");
					print_line_org_ant(text_line);
   					fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

					//sprintf(text_line,"%-46.46s","ANTIBIOTIC ");
					sprintf(text_line,"%-46.46s", local_legend[31]); //added for globalisation
					
					//// for(c1=c2;c1<no_of_organisms;c1++)	/* Print organism codes as column headings*/
					////	sprintf(text_line,"%s%-5.5s",text_line,org[c1]);
					c1 = c2;
					org1= 1;

					rl_res_organism_code1.arr[0] = '\0'; 
					rl_res_organism_code1.len    = 0;
					rl_res_organism_code2.arr[0] = '\0'; 
					rl_res_organism_code2.len    = 0;

					while(c1< (c2+2)  && c1 <= no_of_organisms)
					{
						 rl_res_organism_code.arr[0] = '\0'; 
						 rl_res_organism_code.len    = 0;
						 strcpy(rl_res_organism_code.arr,org[c1]);
					//	 sprintf(rl_res_organism_code.arr,"%s",org[c1]);
						 rl_res_organism_code.len = strlen(rl_res_organism_code.arr);
						 rl_res_organism_code.arr[rl_res_organism_code.len] = '\0';

						 if(org1<3)
						 {
							strcpy(rl_res_organism_code1.arr,rl_res_organism_code.arr);
						
						 }
						 else
						 {
							strcpy(rl_res_organism_code2.arr,rl_res_organism_code.arr);

						 }
						 
						 fetch_org_desc();			 
 						 ///sprintf(text_line,"%s%-5.5s",text_line,org[c1]);

						 sprintf(text_line,"%s%-16.16s",text_line,rl_res_organism_code_s_desc.arr);
						 c1++;
						 org1=10;
					}

					rl_res_organism_code1.len = strlen(rl_res_organism_code1.arr);
					rl_res_organism_code1.arr[rl_res_organism_code1.len] = '\0';
					rl_res_organism_code2.len = strlen(rl_res_organism_code2.arr);
					rl_res_organism_code2.arr[rl_res_organism_code2.len] = '\0';

					print_line_org_ant(text_line);

   					fprintf(fp,"%c&d0D",ESC);   /* Set  UnderLine ON*/
					sprintf(text_line,"");
					for(c=0;c<87;c++)
						sprintf(text_line,"%s%s",text_line," ");
					print_line_org_ant(text_line);
	   				fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

					t_antib_head_first_time = 1;
				}  
				open_antibiotic_format5();

				_flushall();
				while(fetch_antibiotic_fmt5())
				{
						something_to_print = 1;
						something_to_print_for_test = 1;
						strcpy(rl_res_dtl_antibiotic_code.arr,a_antibiotic_code.arr);
						rl_res_dtl_antibiotic_code.len = strlen(a_antibiotic_code.arr);
						fetch_antibiotic_desc();
						sprintf(text_line,"%-47.47s",rl_res_dtl_antibiotic_desc.arr);

						get_kb_mic_legend(no_of_organisms, 'L');
						sprintf(text_line1,"%-47.47s", l_kb_mic_legend);

						e = c2;
						while(e < (c2 +2) && e <= no_of_organisms)
						///for(e=0;e<no_of_organisms;e++)
						{
							match_found = 0;
							for(s=0; s<no_of_sensitivities; s++)
							{
								if( (strcmp(s_ant[s].arr, a_antibiotic_code.arr) == 0) &&
									(strcmp(s_org[s].arr, org[e]) == 0) )
								{
									 sprintf(text_line,"%s%-16.16s",text_line,s_ind[s].arr);

									 if (strlen(s_mic[s].arr) > 0)
									 {
										 sprintf(text_line1,"%s%-5.5s%-11.11s",text_line1,s_mic[s].arr, " ");
										 
									 }
									 else if (strlen(s_zone[s].arr) > 0)
									 {
										sprintf(text_line1,"%s%-5.5s%-11.11s",text_line1,s_zone[s].arr, " ");
									 }
									 else
									 {
										sprintf(text_line1,"%s%-16.16s",text_line1," ");
									 }


									match_found = 1;
									break;
								}
							}

							if(match_found == 0)
							{
								sprintf(text_line, "%s                ",text_line);
								sprintf(text_line1,"%s                ",text_line1);
							}
						e++;
						}
						sprintf(text_line,"%-87.87s",text_line);			
						sprintf(text_line1,"%-87.87s",text_line1);	

						print_line_org_ant(text_line);

						if ( (strcmp(rl_mic_to_print_yn.arr,"Y")==0) && mic_count > 0)
						{
							print_line_org_ant(text_line1);
						}

				}  //// while(fetch_antibiotic())

			close_antibiotic_cur_fmt5();
			c2+=2;
			fprintf(fp,"\n");
			page_break(1); 
		}  //// while(c2<no_of_organisms)

		if (t_antib_head_first_time == 1)	
		{
			//sprintf(text_line,"%-35.35s%-52.52s"," ","S - Sensitive     R - Resistant   I - Intermediate");

			strcpy(string_var, " ");
			sprintf(string_var, "%s     %s     %s", local_legend[17],local_legend[18],local_legend[19]);

			sprintf(text_line,"%-33.33s%-52.52s"," ", string_var); //added for globalisation

			print_line_org_ant(text_line);

			for(i=0; i < 87; i++)
					fprintf(fp,"%c",'_');

			fprintf(fp,"\n");
			page_break(1);
		}


	   	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */

	}
	fprintf(fp,"%c&d@",ESC);   /* Set UnderLine OFF */
}
/*-----------------------------------------------------*/
//// 28.09.2006 added 
get_user_conf_access_yn()
{
	nd_user_conf_access_yn.arr[0]	= '\0';
	nd_user_conf_access_yn.len		= 0;

   strcpy(nd_user_conf_access_yn.arr,"N");
   nd_user_conf_access_yn.len = strlen(nd_user_conf_access_yn.arr);

   
   /* EXEC SQL SELECT NVL(VIEW_CONFIDENTIAL_YN,'N') 
			  INTO :nd_user_conf_access_yn
		      FROM RL_USER_DEPT_VIEW_RESULTS
             WHERE USER_ID = :sy_user_id
--             WHERE USER_ID = USER
		       AND OPERATING_FACILITY_ID = :nd_operating_facility_id
			   AND SECTION_CODE = :rl_hdr_section_code; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select NVL(VIEW_CONFIDENTIAL_YN,'N') into :b0  from RL_USE\
R_DEPT_VIEW_RESULTS where ((USER_ID=:b1 and OPERATING_FACILITY_ID=:b2) and SEC\
TION_CODE=:b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8405;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_user_conf_access_yn;
   sqlstm.sqhstl[0] = (unsigned int  )4;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&sy_user_id;
   sqlstm.sqhstl[1] = (unsigned int  )33;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&rl_hdr_section_code;
   sqlstm.sqhstl[3] = (unsigned int  )4;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




    if(OERROR);

	if (NODATAFOUND);

	nd_user_conf_access_yn.arr[nd_user_conf_access_yn.len]	= '\0';
	nd_user_conf_access_yn.arr[nd_user_conf_access_yn.len]	= '\0';

}
/*------------------------------------------------------------*/
//// added on 31.10.2006  
get_perform_site_desc()
{
	nd_perform_site_desc.arr[0]	= '\0';
	nd_perform_site_desc.len		= 0;

   /* EXEC SQL SELECT long_desc
			  INTO :nd_perform_site_desc
		      FROM RL_SITES_LANG_VW
             WHERE FACILITY_ID = :nd_operating_facility_id
			   AND SITE_CODE   = :rl_perform_site_code
			   AND LANGUAGE_ID = :language_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select long_desc into :b0  from RL_SITES_LANG_VW where ((F\
ACILITY_ID=:b1 and SITE_CODE=:b2) and LANGUAGE_ID=:b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8436;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_perform_site_desc;
   sqlstm.sqhstl[0] = (unsigned int  )43;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_operating_facility_id;
   sqlstm.sqhstl[1] = (unsigned int  )7;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&rl_perform_site_code;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&language_id;
   sqlstm.sqhstl[3] = (unsigned int  )7;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




    if(OERROR);

	if (NODATAFOUND);

	nd_perform_site_desc.arr[nd_perform_site_desc.len]	= '\0';
	
}
/*------------------------------------------------------------*/
//// added on 31.10.2006  
get_anatomy_site_desc()
{
	nd_anatomy_site_desc.arr[0]	= '\0';
	nd_anatomy_site_desc.len		= 0;

   /* EXEC SQL SELECT long_desc
			  INTO :nd_anatomy_site_desc
		      FROM RL_ANATOMY_SITE_CODE_LANG_VW
             WHERE ANATOMY_SITE_CODE   = :nd_anatomy_site
			 AND LANGUAGE_ID = :language_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 10;
   sqlstm.arrsiz = 33;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select long_desc into :b0  from RL_ANATOMY_SITE_CODE_LANG_\
VW where (ANATOMY_SITE_CODE=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )8467;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)256;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_anatomy_site_desc;
   sqlstm.sqhstl[0] = (unsigned int  )43;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_anatomy_site;
   sqlstm.sqhstl[1] = (unsigned int  )7;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&language_id;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




    if(OERROR);

	if (NODATAFOUND);

	nd_anatomy_site_desc.arr[nd_anatomy_site_desc.len]	= '\0';
	
}
/*------------------------------------------------------------*/
//// added on 31.10.2006  
get_anatomy_site()
{
	nd_anatomy_site.arr[0]	= '\0';
	nd_anatomy_site.len		= 0;

	   /* EXEC SQL SELECT anatomy_site_code
				  INTO :nd_anatomy_site
				  FROM RL_SAMPLE_DETAILS
				 WHERE SPECIMEN_NO     = :nd_spec_no
				   AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				   AND ANATOMY_SITE_CODE IS NOT NULL
				   AND ROWNUM =1; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select anatomy_site_code into :b0  from RL_SAMPLE_DETAILS\
 where (((SPECIMEN_NO=:b1 and OPERATING_FACILITY_ID=:b2) and ANATOMY_SITE_CODE\
 is  not null ) and ROWNUM=1)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8494;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_anatomy_site;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (NODATAFOUND)
	{

	   /* EXEC SQL SELECT anatomy_site_code
				  INTO :nd_anatomy_site
				  FROM RL_SPECIMEN_ANATOMY_DTLS
				 WHERE SPECIMEN_NO     = :nd_spec_no
				   AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				   AND ANATOMY_SITE_CODE IS NOT NULL
				   AND ROWNUM =1; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 10;
    sqlstm.arrsiz = 33;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select anatomy_site_code into :b0  from RL_SPECIMEN_ANATO\
MY_DTLS where (((SPECIMEN_NO=:b1 and OPERATING_FACILITY_ID=:b2) and ANATOMY_SI\
TE_CODE is  not null ) and ROWNUM=1)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8521;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)256;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_anatomy_site;
    sqlstm.sqhstl[0] = (unsigned int  )7;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_spec_no;
    sqlstm.sqhstl[1] = (unsigned int  )23;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_operating_facility_id;
    sqlstm.sqhstl[2] = (unsigned int  )7;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	}

	if (NODATAFOUND);

    if(OERROR);

	nd_anatomy_site.arr[nd_anatomy_site.len]	= '\0';
	
}
/*------------------------------------------------------------*/
convert_dates_to_local_lang()
{
    if(rl_order_id.len)
	{
	      get_order_date_time();

	            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:nd_order_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:nd_order_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:nd_order_date_time1 :=sm_convert_datetime_2t(to_date(:nd_order_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
             struct sqlexd sqlstm;
             sqlstm.sqlvsn = 10;
             sqlstm.arrsiz = 33;
             sqlstm.sqladtp = &sqladt;
             sqlstm.sqltdsp = &sqltds;
             sqlstm.stmt = "declare t_date date ; BEGIN :nd_order_date_time1\
 := sm_convert_datetime_2t ( to_date ( :nd_order_date_time , 'DD/MM/YYYY HH24:\
MI' ) , :language_id ) ; END ;";
             sqlstm.iters = (unsigned int  )1;
             sqlstm.offset = (unsigned int  )8548;
             sqlstm.cud = sqlcud0;
             sqlstm.sqlest = (unsigned char  *)&sqlca;
             sqlstm.sqlety = (unsigned short)256;
             sqlstm.occurs = (unsigned int  )0;
             sqlstm.sqhstv[0] = (         void  *)&nd_order_date_time1;
             sqlstm.sqhstl[0] = (unsigned int  )19;
             sqlstm.sqhsts[0] = (         int  )0;
             sqlstm.sqindv[0] = (         void  *)0;
             sqlstm.sqinds[0] = (         int  )0;
             sqlstm.sqharm[0] = (unsigned int  )0;
             sqlstm.sqadto[0] = (unsigned short )0;
             sqlstm.sqtdso[0] = (unsigned short )0;
             sqlstm.sqhstv[1] = (         void  *)&nd_order_date_time;
             sqlstm.sqhstl[1] = (unsigned int  )19;
             sqlstm.sqhsts[1] = (         int  )0;
             sqlstm.sqindv[1] = (         void  *)0;
             sqlstm.sqinds[1] = (         int  )0;
             sqlstm.sqharm[1] = (unsigned int  )0;
             sqlstm.sqadto[1] = (unsigned short )0;
             sqlstm.sqtdso[1] = (unsigned short )0;
             sqlstm.sqhstv[2] = (         void  *)&language_id;
             sqlstm.sqhstl[2] = (unsigned int  )7;
             sqlstm.sqhsts[2] = (         int  )0;
             sqlstm.sqindv[2] = (         void  *)0;
             sqlstm.sqinds[2] = (         int  )0;
             sqlstm.sqharm[2] = (unsigned int  )0;
             sqlstm.sqadto[2] = (unsigned short )0;
             sqlstm.sqtdso[2] = (unsigned short )0;
             sqlstm.sqphsv = sqlstm.sqhstv;
             sqlstm.sqphsl = sqlstm.sqhstl;
             sqlstm.sqphss = sqlstm.sqhsts;
             sqlstm.sqpind = sqlstm.sqindv;
             sqlstm.sqpins = sqlstm.sqinds;
             sqlstm.sqparm = sqlstm.sqharm;
             sqlstm.sqparc = sqlstm.sqharc;
             sqlstm.sqpadto = sqlstm.sqadto;
             sqlstm.sqptdso = sqlstm.sqtdso;
             sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	  
    }

	/*******************            *****/
            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_recd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_recd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_recd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_recd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_recd_dat\
e_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_recd_date_time , 'D\
D/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )8575;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_recd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_recd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_spec_colltd_date_time,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_spec_colltd_date_time1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_spec_colltd_date_time1 :=sm_convert_datetime_2t(to_date(:rl_hdr_spec_colltd_date_time,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_spec_colltd_d\
ate_time1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_spec_colltd_date_time \
, 'DD/MM/YYYY HH24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )8602;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_spec_colltd_date_time1;
            sqlstm.sqhstl[0] = (unsigned int  )19;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_spec_colltd_date_time;
            sqlstm.sqhstl[1] = (unsigned int  )19;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



            /* EXEC SQL EXECUTE
				DECLARE
				t_date   date;
				BEGIN
				//GET_LOCALE_DATE.CONVERT_TO_LOCALE_DATE (to_date(:rl_hdr_released_date,'DD/MM/YYYY HH24:MI'), :language_id , t_date);
				//:rl_hdr_released_date1 := to_char(t_date,'DD/MM/YYYY HH24:MI');
				:rl_hdr_released_date1 :=sm_convert_datetime_2t(to_date(:rl_hdr_released_date,'DD/MM/YYYY HH24:MI'),:language_id);
				END;
			END-EXEC; */ 

{
            struct sqlexd sqlstm;
            sqlstm.sqlvsn = 10;
            sqlstm.arrsiz = 33;
            sqlstm.sqladtp = &sqladt;
            sqlstm.sqltdsp = &sqltds;
            sqlstm.stmt = "declare t_date date ; BEGIN :rl_hdr_released_date\
1 := sm_convert_datetime_2t ( to_date ( :rl_hdr_released_date , 'DD/MM/YYYY HH\
24:MI' ) , :language_id ) ; END ;";
            sqlstm.iters = (unsigned int  )1;
            sqlstm.offset = (unsigned int  )8629;
            sqlstm.cud = sqlcud0;
            sqlstm.sqlest = (unsigned char  *)&sqlca;
            sqlstm.sqlety = (unsigned short)256;
            sqlstm.occurs = (unsigned int  )0;
            sqlstm.sqhstv[0] = (         void  *)&rl_hdr_released_date1;
            sqlstm.sqhstl[0] = (unsigned int  )23;
            sqlstm.sqhsts[0] = (         int  )0;
            sqlstm.sqindv[0] = (         void  *)0;
            sqlstm.sqinds[0] = (         int  )0;
            sqlstm.sqharm[0] = (unsigned int  )0;
            sqlstm.sqadto[0] = (unsigned short )0;
            sqlstm.sqtdso[0] = (unsigned short )0;
            sqlstm.sqhstv[1] = (         void  *)&rl_hdr_released_date;
            sqlstm.sqhstl[1] = (unsigned int  )23;
            sqlstm.sqhsts[1] = (         int  )0;
            sqlstm.sqindv[1] = (         void  *)0;
            sqlstm.sqinds[1] = (         int  )0;
            sqlstm.sqharm[1] = (unsigned int  )0;
            sqlstm.sqadto[1] = (unsigned short )0;
            sqlstm.sqtdso[1] = (unsigned short )0;
            sqlstm.sqhstv[2] = (         void  *)&language_id;
            sqlstm.sqhstl[2] = (unsigned int  )7;
            sqlstm.sqhsts[2] = (         int  )0;
            sqlstm.sqindv[2] = (         void  *)0;
            sqlstm.sqinds[2] = (         int  )0;
            sqlstm.sqharm[2] = (unsigned int  )0;
            sqlstm.sqadto[2] = (unsigned short )0;
            sqlstm.sqtdso[2] = (unsigned short )0;
            sqlstm.sqphsv = sqlstm.sqhstv;
            sqlstm.sqphsl = sqlstm.sqhstl;
            sqlstm.sqphss = sqlstm.sqhsts;
            sqlstm.sqpind = sqlstm.sqindv;
            sqlstm.sqpins = sqlstm.sqinds;
            sqlstm.sqparm = sqlstm.sqharm;
            sqlstm.sqparc = sqlstm.sqharc;
            sqlstm.sqpadto = sqlstm.sqadto;
            sqlstm.sqptdso = sqlstm.sqtdso;
            sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



}
/**********************************************************************************/
write_to_file()

{
   l_debug_yn.arr[0]		    = '\0';
   l_debug_yn.len            = 0;

   getValueInFile("DEBUG",temp1);
   strcpy(l_debug_yn.arr,temp1);

  l_debug_yn.arr[1] = '\0';

  if (strcmp(l_debug_yn.arr,"Y")==0)
    {
	  fp1=fopen(l_file_name,"a+");
      fprintf(fp1,l_text.arr);
      fprintf(fp1,"\n");	  
	  fclose(fp1);

    }
}

/********************** added for globalisation ***********************************/
get_legend_value(int cou)
 {
	/* EXEC SQL EXECUTE
	BEGIN
	  SM_POPULATE_REPORT_LEGEND.FETCH_LEGEND (:nd_facility_id,:language_id,'Rlrsenq4.LEGEND_');
	END;
	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin SM_POPULATE_REPORT_LEGEND . FETCH_LEGEND ( :nd_facilit\
y_id , :language_id , 'Rlrsenq4.LEGEND_' ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8656;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&language_id;
 sqlstm.sqhstl[1] = (unsigned int  )7;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	for (i=1; i<=cou; i++)
	{
		l_translated_value.arr[0]		= '\0';
		/* EXEC SQL EXECUTE
		BEGIN
               :l_translated_value :=    GET_LEGEND(LTRIM(RTRIM('Rlrsenq4.LEGEND_'||LTRIM(RTRIM(TO_CHAR(:i,'009'))))));
		END;
		END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 10;
  sqlstm.arrsiz = 33;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "begin :l_translated_value := GET_LEGEND ( LTRIM ( RTRIM ( '\
Rlrsenq4.LEGEND_' || LTRIM ( RTRIM ( TO_CHAR ( :i , '009' ) ) ) ) ) ) ; END ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8679;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)256;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_translated_value;
  sqlstm.sqhstl[0] = (unsigned int  )602;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&i;
  sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
		l_translated_value.arr[l_translated_value.len] = '\0';
		//sp_message(ERR_MESG,l_translated_value.arr);
		strcpy(local_legend[i],l_translated_value.arr);
		
		//disp_message(ERR_MESG,local_legend[i]);
	}
 }
/********************** added for globalisation ***********************************/


check_mic_value_present_for_test()
{
	
	mic_count = 0;

	/* EXEC SQL 

              SELECT COUNT(1)
                 INTO mic_count
                FROM RL_RESULT_ORGANISM_DTL
               WHERE PATIENT_ID      = :nd_hosp_no
                 AND SPECIMEN_NO     = :nd_spec_no
                 AND OPERATING_FACILITY_ID = :nd_operating_facility_id
				 AND GROUP_TEST_CODE = :rl_tst_group_test_code
                 AND TEST_CODE       = :rl_tst_test_code
                 AND REPORT_YN       = 'Y'
				 AND SENSITIVITY_IND IN('S','R','I')
				 AND (mic_result IS NOT NULL
					OR zone_size IS NOT NULL); */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 10;
 sqlstm.arrsiz = 33;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select count(1) into :b0  from RL_RESULT_ORGANISM_DTL where \
(((((((PATIENT_ID=:b1 and SPECIMEN_NO=:b2) and OPERATING_FACILITY_ID=:b3) and \
GROUP_TEST_CODE=:b4) and TEST_CODE=:b5) and REPORT_YN='Y') and SENSITIVITY_IND\
 in ('S','R','I')) and (mic_result is  not null  or zone_size is  not null ))";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8702;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)256;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&mic_count;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_hosp_no;
 sqlstm.sqhstl[1] = (unsigned int  )23;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_spec_no;
 sqlstm.sqhstl[2] = (unsigned int  )23;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_operating_facility_id;
 sqlstm.sqhstl[3] = (unsigned int  )7;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&rl_tst_group_test_code;
 sqlstm.sqhstl[4] = (unsigned int  )13;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&rl_tst_test_code;
 sqlstm.sqhstl[5] = (unsigned int  )13;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if(OERROR);               
}

/********************** added for check_mic_value_present_for_test*******************/

get_kb_mic_legend(int l_no_of_organisms, char l_char)
{

	int fe = 0, fs = 0;



		strcpy(l_kb_mic_legend, " ");

		if (l_char == 'L')
		{
			for(fe=0; fe < l_no_of_organisms; fe++)
			{

				for(fs = 0; fs < l_no_of_organisms; fs++)
				{

						if (strlen(s_mic[fs].arr) > 0)
						 {
							 strcpy(l_kb_mic_legend, local_legend[76]);
							 break;
							 
						 }
						 else if (strlen(s_zone[fs].arr) > 0)
						 {
							strcpy(l_kb_mic_legend, local_legend[77]);
							break;
						 }


				}


			}
		}
		else
		{
			if (strcmp(rl_mic_to_print_yn.arr,"Y")==0) 
			{

				if (strlen(b_mic_value.arr) > 0)
				{
							 strcpy(l_kb_mic_legend, local_legend[76]);
				}
				else if (strlen(b_zone_value.arr) > 0)
				{
							 strcpy(l_kb_mic_legend, local_legend[77]);

				}
			}
			else
			{
				strcpy(l_kb_mic_legend," ");
			}

		}

}
/********************** added for check_mic_value_present_for_test*******************/