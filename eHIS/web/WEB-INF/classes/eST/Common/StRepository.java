/*******************************************************************************
 * Copyright 1999-2015, Computer Sciences Corporation. All rights reserved.
 *  
 * Warning: This computer program is protected by copyright law and international treaties.
 * Unauthorized reproduction or distribution of this program, or any portion of it, 
 * may result in severe civil and criminal penalties, and will be prosecuted to 
 * the maximum extent possible under the law.
 ******************************************************************************/ 
/*   
-------------------------------------------------------------------------------------------------------------------------------------------
Date		            Edit History	        Name		       Rev.Date		     Rev.Name			     Description
-------------------------------------------------------------------------------------------------------------------------------------------
15/07/2014	 			43320					Abdul Rabbani	                                    		AMRI-CRF-100019
27/02/2014				42063			        Suresh R           27/02/2014        Suresh R     AMS-CRF-0054(Added Item Based IssueReturn)
25/02/2016				57461					B.Badmavathi									  Product Transfer\Repackaging	
21/04/2016				56060					B.Badmavathi									  Authorize at Issue Store privileges
03/05/2016				59650					B.Badmavathi									  ML-MMOH-SCF-0364-The total of Consumption Qty is not tally with details in Storewise Consumption for the Period.
09/05/2016				59478					B.Badmavathi									  ML-MMOH-SCF-0355
03/06/2016				60468					B.Badmavathi									  Batch auto allocation for Expiry batch
26/07/2016				60402					B.Badmavathi 					  				  ML-BRU-SCF-1686 - Parent Store and Item Class Combination	
26/10/2016				62242					B.Badmavathi									  To fetch Suspended and Expired batches 
06/02/2017				63460					B.Badmavathi 									  GHL-CRF-0413.7 - US009 - Barcode search
09/05/2017				62881					B.Badmavathi								      PO Mandatory in GRN 
23/05/2016				64266					Badmavathi B										KDAH-SCF-0433
24/05/2017				IN063603				Badmavathi B										GHL-CRF-0456
13/08/2018				INC068298				Shazana Hasan										GHL-SCF-1369 - Practitioner Name
22/10/2018				IN068653				Sharanraj										   GHL-CRF-0557
3/1/2019				INC069379 				Shazana Hasan										MMS-ICN-00110 - unit cost issue
14/10/2019      		IN:071344       		B Haribabu     	 15/10/2019      	Manickam        GHL-CRF-0609  
13/01/2020              IN072061               Haribabu                                           Post Variance -> On Apply -> System hangs
08/06/2020              IN:072963                Haribabu	      08/06/2020        Manickam         ML-MMOH-CRF-1389.1       
23/06/2020              IN:073185                 HARIBABU                                           ML-BRU-SCF-2032
31/12/2020				TFS-8224      		     Prabha           31/12/2020		  Manickam	     MMS-DM-CRF-0177
19/04/2021              TFS id:-16213           Haribabu   AMS-SCF-0970
13/5/2021				TFS:14012				Shazana												MO-CRF-20165
16/8/2021				TFS22446				Shazana				16/8/2021							MOHE-CRF-0084.1 
22/9/2021				TFS22321				Shazana												GHL-SCF-1587
13/10/2021				TFS-24348				Shazana				13/10/2021		 Manickam		MO-CRF-20172

22/2/2022				TFS27891				Shazana												MO-CRF-20176
22/5/2022				23465					Ramesh												MOHE-SCF-0156
--------------------------------------------------------------------------------------------------------------------------------------------
*/   
package	eST.Common; 
import java.util.*;
//import eST.Common.eHIS.HashMap;

final public class StRepository	{ 

	//Changed on 3/13/2006
	//private	static StRepository	instance ;
	private	static int	i=0;
	private static HashMap dataMap ;


	static{
			dataMap	= new HashMap()	;
			load() ;
/*			if (dataMap.isDuplicateFound())	{
				dataMap=null;
			}*/
	}
	
/*
	private	StRepository() throws Exception	{
		dataMap	= new HashMap()	;
		load() ;
	}
*/
	public static String getStKeyValue(	String key)	{
		try	{
			/*if ( instance == null )	{
				instance = new StRepository() ;
				instance.i++;
			}*/
			return getValue( key );
		}
		catch (Exception exception)	{
			exception.printStackTrace();
		}
		return "Error:(Key not found) for ID:"+key;
	}

	public static int getI(){
		return i;
	}

	/*public static void main( String	args[]){
		try	{
		}
		catch (Exception exception)	{
			exception.printStackTrace();
		}
	}*/

	private	static String getValue( String	key	) throws Exception {
		String value = "" ;
		try	{
			//new code
            if (dataMap ==null)
            {
				dataMap	=	new HashMap();
		        load();
            }
			//end of new code
			value =	(String) dataMap.get( key )	;
			if ( value == null )
				throw new Exception( key + " : Key not found" )	;
		}
		catch (	Exception exception	) {
			throw new Exception( key + " : Key not found."+exception) ;
		}
		return value ;
	}

	protected void finalize() throws Throwable {
		if ( dataMap !=	null )
			dataMap	= null;
	}

	private	static void load()	{
	/*Common CONSTANTS starts*/
		dataMap.put("DECIMAL_PRECISION",		"3");
		dataMap.put("INTEGER_PRECISION",		"12");
		dataMap.put("VALUE_PRECISION",		"16");
		dataMap.put("DEFAULT_LIST_OPTION",		"<option value=\"\">&nbsp;&nbsp;&nbsp;&nbsp;---	Select ---&nbsp;&nbsp;&nbsp;&nbsp;</option>");
		dataMap.put("DEFAULT_LIST_OPTION_TEXT",	"&nbsp;&nbsp;&nbsp;&nbsp;--- Select	---&nbsp;&nbsp;&nbsp;&nbsp;");
		dataMap.put("MANDATORY_IMAGE",			"&nbsp;<img	src='../../eCommon/images/mandatory.gif' align='center'>");
		dataMap.put("YES_IMAGE", "<img src='../../eCommon/images/enabled.gif' align='center'>");
		dataMap.put("NO_IMAGE",	"<img src='../../eCommon/images/disabled.gif' align='center'>");
		dataMap.put("YES", "Yes");
		dataMap.put("NO", "No");
	/*Common CONSTANTS ends*/

	/* JNDI	entry starts*/
		dataMap.put("JNDI_SS_GROUP",						"java:comp/env/Group");
		dataMap.put("JNDI_ST_GENERATE_REQUEST",				"java:comp/env/GenerateRequest");
		dataMap.put("JNDI_ST_REQUEST", "java:comp/env/Request");
		dataMap.put("JNDI_ST_AUTHORIZE_AT_ISSUE_STORE",	"java:comp/env/AuthorizeAtIssueStore");
		dataMap.put("JNDI_ST_OPENING_STOCK", "java:comp/env/OpeningStock");	

		dataMap.put("JNDI_ST_CONDEMN_EXPIRED_BATCHES", "java:comp/env/CondemnExpiredBatches");
		dataMap.put("JNDI_ST_CHANGE_EXPIRY_FLAG", "java:comp/env/ChangeExpiryFlag");
		dataMap.put("JNDI_ST_CANCEL_REQUEST", "java:comp/env/CancelRequest"); 	

		dataMap.put("JNDI_ST_ISSUE", "java:comp/env/Issue"); 	

		dataMap.put("JNDI_ST_ADJUST_STOCK",	"java:comp/env/AdjustStock");
		dataMap.put("JNDI_ST_ASSEMBLY_DTL",	"java:comp/env/AssemblyDetail");
		dataMap.put("JNDI_ST_SPLIT_BATCH", "java:comp/env/SplitBatch");
		dataMap.put("JNDI_ST_REQUISITION_ISSUE", "java:comp/env/RequisitionIssue");
		dataMap.put("JNDI_ST_STOCK_TRANSFER", "java:comp/env/StockTransfer");
		dataMap.put("JNDI_ST_SUSPEND_OR_REINSTATE",	"java:comp/env/SuspendOrReinstate");
		dataMap.put("JNDI_ST_CHANGE_BIN_LOCATION",	"java:comp/env/ChangeBinLocation");
		dataMap.put("JNDI_ST_PRODUCT_TRANSFER",	"java:comp/env/ProductTransfer");
		dataMap.put("JNDI_ST_ISSUE_RETURN",	"java:comp/env/IssueReturn");
		dataMap.put("JNDI_ST_MANUFACTURING_REQUEST",	"java:comp/env/ManufacturingRequest");
		dataMap.put("JNDI_ST_MANUFACTURING_RECEIPT",	"java:comp/env/ManufacturingReceipt");

		dataMap.put("JNDI_ST_SALES", "java:comp/env/Sales");
		dataMap.put("JNDI_ST_STOCKITEMCONSUMPTION", "java:comp/env/StockItemConsumption");
		dataMap.put("JNDI_ST_SALES_RETURN", "java:comp/env/SalesReturn");
		dataMap.put("JNDI_ST_GOODS_RECEIVED_NOTE", "java:comp/env/GoodsReceivedNote");
		dataMap.put("JNDI_ST_REPLACEMENT_GOODS_RECEIVED_NOTE", "java:comp/env/ReplacementGRN");

		dataMap.put("JNDI_PRINT_COUNT_SHEET", "java:comp/env/PrintCountSheet");
		dataMap.put("JNDI_POST_VARIANCE", "java:comp/env/PostVariance");
		dataMap.put("JNDI_PHYINV_FOR_SPECIFIC_ITEM", "java:comp/env/PhyInvForSpecificItem");
		dataMap.put("JNDI_PHYSICAL_INVENTORY_ENTRY", "java:comp/env/PhysicalInventoryEntry");
		dataMap.put("JNDI_COUNT_CANCEL_SHEET","java:comp/env/CancelCountSheet");
		dataMap.put("JNDI_ST_GOODS_RETURN_TO_VENDOR","java:comp/env/GoodsReturnToVendor");
		dataMap.put("JNDI_ST_PERIOD_END","java:comp/env/PeriodEnd");
		dataMap.put("JNDI_ST_ITEM_FOR_STORE", "java:comp/env/ItemForStore");
		dataMap.put("JNDI_ST_KIT_TEMPLATE", "java:comp/env/KitTemplate");
		dataMap.put("JNDI_PROCESS_GL_DISTRIBUTION", "java:comp/env/STProcessGLDistribution");
		dataMap.put("JNDI_PARENT_STORE_FOR_STORE", "java:comp/env/ParentStoreForStore");
		dataMap.put("JNDI_ST_ACKNOWLEDGMENT", "java:comp/env/Acknowledgment");
		dataMap.put("JNDI_ST_POGENERATE_REQUEST","java:comp/env/PORequest");
		dataMap.put("JNDI_ST_PURCHASE_ORDER","java:comp/env/PurchaseOrder");
	/* JNDI	entry ends*/

	/*Common SQL starts*/
		dataMap.put("SQL_SY_ACC_PERIOD_DEFN_SELECT_COUNT","select count(*) total from SY_ACC_PERIOD_DEFN where ACC_PER_MONTH=? and ACC_PER_YEAR=?");
		dataMap.put("SQL_SM_ACC_ENTITY_PARAM_DECIMAL_SELECT","SELECT no_of_decimal FROM	sm_acc_entity_param	WHERE acc_entity_id	=?");
		dataMap.put("SQL_SM_MODULES_FACILITY_COUNT_VALID",		"SELECT	COUNT(*) total FROM	sm_modules_facility	WHERE facility_id=?	AND	module_id=?	AND	operational_yn='Y'");
		dataMap.put("SQL_SY_ACC_ENTITY_DOC_TYPE_SELECT_FLAG",	"SELECT	nvl(doc_num_gen_flag,'N') doc_num_gen_flag FROM	sy_acc_entity_doc_type WHERE doc_type_code =?");
		dataMap.put("SQL_ST_ITEM_INTEGER_SELECT","SELECT issue_int_qty_yn FROM	st_item	WHERE item_code	=  ?");
		//dataMap.put("SQL_MM_PARAMETER_SELECT_SINGLE", "SELECT receive_bonus_yn, receive_sample_yn, dflt_batch_id, dflt_trade_id, ss_period_end_scope, st_period_end_scope, po_period_end_scope FROM mm_parameter WHERE module_id=?");//Modified against GDOH-CRF-0109
		dataMap.put("SQL_MM_PARAMETER_SELECT_SINGLE", "SELECT receive_bonus_yn, receive_sample_yn, dflt_batch_id, dflt_trade_id, ss_period_end_scope, st_period_end_scope, po_period_end_scope, PO_MANDATORY_YN FROM mm_parameter WHERE module_id=?");
		dataMap.put("SQL_ST_PARAMETER_SELECT_SINGLE","SELECT curr_proc_month, curr_proc_year, def_store_code_for_rec, def_grn_doc_type_code, def_rtv_doc_type_code, def_mfg_doc_type_code, def_iss_doc_type_code, def_ret_doc_type_code, def_urg_doc_type_code, def_tfr_doc_type_code, def_adj_doc_type_code, def_var_doc_type_code, def_prt_doc_type_code, def_sal_doc_type_code, def_srt_doc_type_code, def_obs_doc_type_code, def_bin_doc_type_code, def_spl_doc_type_code, curr_phy_inv_id, curr_spec_phy_inv_id FROM ST_FACILITY_PARAM WHERE facility_id = ?");
	
//		dataMap.put("SQL_ST_ITEM_STORE_SELECT_DIST_FOR_PHY","SELECT DISTINCT phy_inv_id FROM st_item_store WHERE store_code=?");

		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_GRN",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_grn_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_grn_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_RTV",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_rtv_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_rtv_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_REQ",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT req_by_store_code store_code FROM st_request_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=? UNION SELECT req_on_store_code store_code FROM st_request_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_request_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_ISS",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT fm_store_code store_code FROM st_issue_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=? AND seq_no=? UNION SELECT to_store_code store_code FROM st_issue_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=? AND seq_no=?) AND item_code IN (SELECT item_code FROM st_issue_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=? AND seq_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_MFG",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_mfg_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT CHILD_ITEM_CODE item_code FROM st_mfg_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_TFR",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT fm_store_code store_code FROM st_transfer_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=? UNION SELECT to_store_code store_code FROM st_transfer_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_transfer_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_RET",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT fm_store_code store_code FROM st_issue_ret_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=? UNION SELECT to_store_code store_code FROM st_issue_ret_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_issue_ret_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_ADJ",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_adj_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_adj_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_SAL",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_sal_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_sal_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT_COUNT_FOR_PHY_SRT",	"SELECT COUNT(*) total FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_sal_ret_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_sal_ret_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SELECT_COUNT","SELECT	count(*) total FROM	st_user_access_for_store WHERE user_id	= ?	 AND store_code = ?");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_SELECT_LIST", "SELECT st.bin_location_code, mm.short_desc FROM st_item_store_bin_locn st, mm_bin_location_lang_vw mm WHERE st.store_code=mm.store_code AND  st.bin_location_code=mm.bin_location_code AND st.store_code=? AND st.item_code=? AND mm.eff_status ='E' AND mm.language_id = ? and st.eff_status = 'Y' ORDER BY short_desc");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_SELECT_MODIFY_LIST", "SELECT ST.BIN_LOCATION_CODE, MM.SHORT_DESC FROM ST_ITEM_STORE_BIN_LOCN ST, MM_BIN_LOCATION_LANG_VW MM WHERE ST.STORE_CODE=MM.STORE_CODE AND  ST.BIN_LOCATION_CODE=MM.BIN_LOCATION_CODE AND ST.STORE_CODE=? AND ST.ITEM_CODE=? AND MM.EFF_STATUS ='E' AND MM.LANGUAGE_ID = ?  UNION SELECT BIN_LOCATION_CODE, SHORT_DESC FROM MM_BIN_LOCATION_LANG_VW WHERE STORE_CODE=? AND LANGUAGE_ID = ? and eff_status = 'E' ORDER BY SHORT_DESC");
		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_SELECT_LISTS","SELECT DISTINCT(st.bin_location_code), mm.short_desc FROM st_item_store_bin_locn st, mm_bin_location mm WHERE st.store_code=mm.store_code AND  st.bin_location_code=mm.bin_location_code AND st.store_code= ? /*AND st.item_code=?*/ AND mm.eff_status ='E' ORDER BY short_desc");
		dataMap.put("SQL_ST_ITEM_STORE_COMB_CHECK","SELECT Count(*) COUNT FROM st_item_store WHERE ITEM_CODE=? AND store_code=? AND eff_status='E' ");
		dataMap.put("SQL_ST_ITEM_DOC_TYPE_SELECT","SELECT CHILD_ITEM_CODE, CHILD_ITEM_QTY, ITEM_UNIT_COST, STOCK_ITEM_YN, MFG_UOM_CODE, MFG_UOM_CONV, CHILD_ITEM_TRANS_QTY, MFG_COST_VALUE FROM st_mfg_dtl WHERE FACILITY_ID=? AND DOC_TYPE_CODE=? AND DOC_NO=? ");

		//added on 20/09/2004 for online printing alert pop up check .
		dataMap.put("SQL_ST_ONLINE_PRINT_ALERT_REQD_YN_SELECT" , "select ALERT_REQD_YN from ST_TRN_DOC_TYPE WHERE DOC_TYPE_CODE = ? AND FACILITY_ID = ?");
		//Added on 1/10/2004 for  Online printing alert pop up check ..
		dataMap.put("SQL_ST_ONLINE_PRINT_ALERT_FOR_PRINT_PICKSLIP_YN_SELECT" , "select ALERT_FOR_PRINT_PICKSLIP_YN from st_store where STORE_CODE = ?");



	/*Common SQL ends*/

	/*Function specific	SQL	starts*/
		dataMap.put("SQL_SM_SUBFUNCTION_SELECT_MENU_SCRIPT",	"SELECT	'masters[\"'||a.subfunction_id||'\"]='''|| function_parameters ||'?module_id=' ||a.module_id||'&function_id='||a.subfunction_id||'&function_name='||subfunction_name||'&function_type='||subfunction_type||'&access='||b.insert_access_yn||b.update_access_yn||b.query_only_access_yn||b.delete_access_yn ||b.print_access_yn||''';' master	FROM  sm_subfunction a,sm_menu_sfunc_dtl b WHERE a.module_id=? AND a.subfunction_id=b.subfunction_id");
		dataMap.put("SQL_SM_MASTER_CODE_SELECT_MENU",			"SELECT	b.master_code,a.subfunction_id,	b.master_code_desc,a.incl_yn FROM sm_menu_sfunc_dtl	a,sm_master_code b WHERE a.function_id = (?) AND a.subfunction_id=b.table_id AND a.incl_yn = 'Y' ORDER BY b.master_code");

	

	

		// Machine
		dataMap.put("SQL_AM_MANUFACTURER_LIST",	"SELECT	manufacturer_id,short_name FROM	am_manufacturer_lang_vw	WHERE eff_status='E' AND language_id = ? ORDER BY short_name");
		dataMap.put("SQL_ST_MACHINE_CODE_UPDATE","UPDATE st_machine	set	machine_name=?,model_no=?, manufacturer_id=?, technical_specification=?,eff_status=?,modified_by_id=?,modified_date=SYSDATE,modified_at_ws_no=?,modified_facility_id=? where machine_code=?	");
		dataMap.put("SQL_ST_MACHINE_CODE_INSERT"," INSERT INTO st_machine (machine_code,machine_name,model_no,manufacturer_id,technical_specification,eff_status,added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id) VALUES	(?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_MACHINE_CODE_COUNT","SELECT	COUNT(*) FROM st_machine WHERE machine_code= ? ");
		dataMap.put("SQL_ST_MACHINE_CODE_SELECT_SINGLE","SELECT	machine_name, model_no,	manufacturer_id	, technical_specification ,	eff_status FROM	st_machine_lang_vw st_machine WHERE Machine_code= ? AND language_id = ?");
		dataMap.put("SQL_ST_MACHINE_CODE_QUERY_RESULT","SELECT a.machine_code,a.machine_name, a.model_no, a.manufacturer_id, b.short_name,a.technical_specification	, a.eff_status FROM	st_machine_lang_vw a, am_manufacturer_lang_vw b	WHERE a.manufacturer_id=b.manufacturer_id(+) AND a.machine_code	like UPPER(?) AND upper(a.machine_name)	like upper(?) and upper(a.model_no)	like upper(?) and nvl(a.manufacturer_id,'X') like ?	and	a.eff_status like ? AND a.language_id = b.language_id(+) AND a.language_id = ?");

		// Item	Class For Store	-- Martin
		dataMap.put("SQL_MM_ITEM_CLASS_FOR_STORE_SELECT_LIST","SELECT stp.item_class_code, mm.short_desc FROM st_store_parent_store stp, mm_item_class_lang_vw mm WHERE mm.item_class_code = stp.item_class_code AND stp.store_code =? AND stp.parent_store_code =? AND stp.eff_status = 'E'  AND language_id =?");

		dataMap.put("SQL_MM_ITEM_CLASS_FOR_STORE_SELECT_LIST1","SELECT item_class_code,short_desc FROM mm_item_class_lang_vw mm_item_class	WHERE eff_status ='E' AND appl_st_yn ='Y' AND language_id = ?  ORDER	BY short_desc");
		dataMap.put("SQL_ST_STORE_SELECT_LIST",	"SELECT	a.store_code, b.short_desc FROM	st_store a,	mm_store_lang_vw b WHERE a.store_code =	b.store_code AND b.eff_status='E' AND b.facility_id	= ?	AND b.language_id= ? ORDER BY b.short_desc");
		dataMap.put("SQL_ST_STORE_SELECT_LIST_WT_LANG",	"SELECT	a.store_code, b.short_desc FROM	st_store a,	mm_store_lang_vw b WHERE a.store_code =	b.store_code AND b.eff_status='E' and b.facility_id	= ?	 and b.language_id LIKE ?  order by b.short_desc");
	    dataMap.put("SQL_ST_STORE_SELECT_LIST_QUERY_PG",	"SELECT	a.store_code, b.short_desc FROM	st_store a,	mm_store b WHERE a.store_code =	b.store_code AND b.eff_status='E' order by b.short_desc");
	    dataMap.put("SQL_ST_USER_SELECT_LIST",	"SELECT   DISTINCT user_id FROM st_user_access_for_store a,mm_store m,st_store s WHERE m.store_code=s.store_code AND s.store_code=a.store_code AND m.store_code =a.store_code");

		dataMap.put("SQL_ST_STORE_SELECT_LIST_ACROSS_FCY",	"SELECT	a.store_code, b.short_desc FROM	st_store a,	mm_store_lang_vw b WHERE a.store_code =	b.store_code AND b.eff_status='E' 	AND b.language_id = ? order by b.short_desc");

		dataMap.put("SQL_ST_STORE_EXIST_SELECT","SELECT	item_class_code	FROM st_item_class_store WHERE store_code =	?");
		dataMap.put("SQL_ST_ITEM_CLASS_STORE_QUERY_RESULT","SELECT a.store_code, b.long_desc store_desc, a.item_class_code,	c.long_desc	item_class_desc	FROM st_item_class_store a,	mm_store_lang_vw b,	mm_item_class_lang_vw c	WHERE  a.store_code	= b.store_code AND a.item_class_code = c.item_class_code AND b.facility_id = ? and a.store_code	like UPPER(?) AND UPPER(b.long_desc) like UPPER(?) AND a.item_class_code like UPPER(?) AND UPPER(c.long_desc) like UPPER(?) AND b.language_id = c.language_id AND b.language_id = ?");
		dataMap.put("SQL_ST_ITEM_CLASS_STORE_INSERT","INSERT INTO ST_ITEM_CLASS_STORE (	store_code,	item_class_code, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id	) VALUES  (	? ,	? ,	? ,	sysdate	, ?	, ?	, ?	, sysdate ,	? ,	? )");
		dataMap.put("SQL_ST_ITEM_LOOKUP","SELECT ST.ITEM_CODE CODE, MM.SHORT_DESC DESCRIPTION FROM MM_ITEM_LANG_VW  MM, ST_ITEM ST WHERE ST.ITEM_CODE = MM.ITEM_CODE AND MM.EFF_STATUS = 'E' AND MM.LANGUAGE_ID LIKE  ? AND ST .ITEM_CODE LIKE UPPER(?) AND UPPER(MM.SHORT_DESC) LIKE UPPER(?) ORDER BY 2");
		dataMap.put("SQL_ST_ITEM_LOOKUP_LANG","SELECT st.item_code code,	mm.short_desc description   FROM mm_item_lang_vw mm, st_item st    WHERE	    mm.eff_status =	'E'	  AND	  st.item_code LIKE UPPER(?) AND                upper(mm.short_desc)	  LIKE upper(?)      and    st.item_code = mm.item_code");
		dataMap.put("SQL_ST_ITEM_LOOKUP_FOR_PUR_AD","SELECT st.item_code code,	mm.short_desc description FROM mm_item_lang_vw mm, st_item st        			WHERE	     mm.eff_status =	'E'  	AND    mm.language_id like ?    AND	 st.item_code  LIKE   UPPER(?)  AND   upper(mm.short_desc)	LIKE upper(?)   and   st.item_code = mm.item_code order by  2");
		dataMap.put("SQL_ST_ASSEMBLY_ITEM_LOOKUP","SELECT   st.item_code code,  mm.short_desc description   FROM    mm_item_lang_vw    mm,     st_item   st WHERE	 mm.eff_status =	'E'    AND    mm.language_id like  ?      AND	    st.item_code    LIKE    UPPER(?) AND UPPER(mm.short_desc)    LIKE    UPPER(?)    AND    st.item_code = mm.item_code     AND   mfg_item_yn='Y' ORDER BY 2");

		//Item For Store - Martin
		dataMap.put("SQL_ST_ITEM_SEARCH_SELECT","SELECT st.item_code code, mm.short_desc description FROM mm_item_lang_vw mm, st_item st WHERE mm.eff_status = 'E' AND st.item_code = ? AND st.item_code = mm.item_code AND mm.language_id = ?");
		dataMap.put("SQL_MM_BIN_LOCATION_SELECT_LIST", "SELECT bin_location_code, short_desc FROM mm_bin_location_lang_vw mm_bin_location WHERE	store_code = ? AND eff_status =	'E'	 AND language_id = ? order by short_desc");
		dataMap.put("SQL_DEFAULT_MM_BIN_LOCATION_SELECT_LIST" , "select bin_location_code from st_item_store where store_code=? and item_code=? " );
		dataMap.put("SQL_ST_ITEM_MULTIPLE_SELECT", "SELECT B.store_code, D.short_desc store_desc, A.item_code, C.short_desc item_desc, b.store_type_flag,c.gen_uom_code stock_uom FROM st_item A, st_store B, mm_item_lang_vw C, mm_store_lang_vw D WHERE A.item_code = C.item_code AND C.eff_status='E' AND B.store_code = D.store_code AND D.eff_status='E' AND ((B.medical_item_yn = 'Y' and A.medical_item_yn='Y') OR(B.nonmedical_item_yn = 'Y' and A.medical_item_yn='N'))  AND (B.store_code BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (A.item_code BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(C.item_anal1_code,'!') BETWEEN NVL(?,'!') AND NVL(?,'~'))  AND (NVL(C.item_anal2_code,'!') BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(C.item_anal3_code,'!') BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (B.store_code,A.item_code) NOT IN (SELECT store_code,item_code FROM st_item_store)  AND c.language_id = d.language_id AND c.language_id = ? ORDER BY 1,3");
		//dataMap.put("SQL_ST_ITEM_STORE_INSERT","INSERT INTO	ST_ITEM_STORE (store_code, item_code, bin_location_code, stock_item_yn,	min_stk_qty, max_stk_qty, reorder_level, reorder_freq_days,	lead_days, min_stock_days, percent_min_stock, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id,request_gen_stage,def_request_uom,def_issue_uom) VALUES  (	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	?, sysdate,	? ,	? ,	? ,	sysdate	, ?	, ?	,? ,?,?)");
	//	dataMap.put("SQL_ST_ITEM_STORE_INSERT","INSERT INTO ST_ITEM_STORE (store_code, item_code, bin_location_code, stock_item_yn, min_stk_qty, max_stk_qty, reorder_level, reorder_freq_days, lead_days, min_stock_days, percent_min_stock, reorder_qty,added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,request_gen_stage,def_request_uom,def_issue_uom,phy_inv_type,phy_inv_count_per_year) VALUES  ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ?,?, sysdate, ? , ? , ? , sysdate , ? , ? ,? ,?, ? , ? , ?)");Modified for GHL-CRF-0456
		dataMap.put("SQL_ST_ITEM_STORE_INSERT","INSERT INTO ST_ITEM_STORE (store_code, item_code, bin_location_code, stock_item_yn, min_stk_qty, max_stk_qty, reorder_level, reorder_freq_days, lead_days, min_stock_days, percent_min_stock, reorder_qty,added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,request_gen_stage,def_request_uom,def_issue_uom,phy_inv_type,phy_inv_count_per_year,sales_allowed_yn,consumption_allowed_yn,near_expiry_appl,durn_value,durn_type,durn_value_in_days,NO_OF_DAYS) VALUES  ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ?,?, sysdate, ? , ? , ? , sysdate , ? , ? ,? ,?, ? , ? , ? ,? ,? ,? ,? ,? ,?,?)"); //near_expiry_appl, durn_value, durn_type, durn_value_in_days added for MMS-DM-CRF-0177,MO-CRF-20172  

		//dataMap.put("SQL_ST_ITEM_STORE_UPDATE","UPDATE st_item_store SET bin_location_code = ?, 	stock_item_yn = ?, min_stk_qty = ?, max_stk_qty = ?, reorder_level = ?, reorder_freq_days = ?, lead_days = ?, min_stock_days = ?, percent_min_stock = ?, modified_by_id = ?, modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id = ? ,request_gen_stage = ? ,def_request_uom = ? , def_issue_uom = ? ,eff_status = ? WHERE store_code = ? AND item_code = ?");
		//dataMap.put("SQL_ST_ITEM_STORE_UPDATE","UPDATE st_item_store SET bin_location_code = ?,  stock_item_yn = ?, min_stk_qty = ?, max_stk_qty = ?, reorder_level = ?, reorder_freq_days = ?, lead_days = ?, min_stock_days = ?, percent_min_stock = ?, modified_by_id = ?, modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id = ? ,request_gen_stage = ? ,def_request_uom = ? , def_issue_uom = ? ,eff_status = ?,phy_inv_type = ?, phy_inv_count_per_year = ?, reorder_qty = ?  WHERE store_code = ? AND item_code = ?");Modified for GHL-CRF-0456
		dataMap.put("SQL_ST_ITEM_STORE_UPDATE","UPDATE st_item_store SET bin_location_code = ?,  stock_item_yn = ?, min_stk_qty = ?, max_stk_qty = ?, reorder_level = ?, reorder_freq_days = ?, lead_days = ?, min_stock_days = ?, percent_min_stock = ?, modified_by_id = ?, modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id = ? ,request_gen_stage = ? ,def_request_uom = ? , def_issue_uom = ? ,eff_status = ?,phy_inv_type = ?, phy_inv_count_per_year = ?, reorder_qty = ?, sales_allowed_yn=?, consumption_allowed_yn=?,near_expiry_appl=?,durn_value=?,durn_type=?,durn_value_in_days=?, no_of_days = ?  WHERE store_code = ? AND item_code = ?"); //near_expiry_appl, durn_value, durn_type, durn_value_in_days added for MMS-DM-CRF-0177,MO-CRF-20172
		dataMap.put("SQL_ST_ITEM_STORE_COUNT","SELECT COUNT(*) COUNT FROM st_item_store	WHERE store_code = ? AND item_code = ?");
		//Wednesday, July 21, 2004 added effective status for Item for Store 
		dataMap.put("SQL_ST_ITEM_STORE_QUERY_RESULT","SELECT a.store_code, b.long_desc store_desc, a.item_code, c.short_desc item_desc, stock_item_yn, min_stk_qty, max_stk_qty, reorder_level,c.gen_uom_code  stock_uom , a.eff_status  eff_status,a.reorder_qty reorder_qty  FROM st_item_store a, mm_store_lang_vw b, mm_item_lang_vw c,st_store d WHERE a.store_code = b.store_code AND a.item_code = c.item_code AND b.facility_id = ? AND a.store_code like UPPER(?) AND UPPER(b.long_desc) like UPPER(?) AND a.item_code like UPPER(?) AND UPPER(c.short_desc) like UPPER(?) AND d.store_type_flag LIKE (?) AND  a.store_code = d.store_code AND a.stock_item_yn LIKE (?) AND c.item_class_code like (?) and a.eff_status like nvl(?,'%')  AND b.eff_status = 'E' AND c.eff_status = 'E' AND b.language_id = c.language_id AND b.language_id = ?");

		dataMap.put("SQL_ST_ITEM_STORE_LOOKUP",	"SELECT	a.store_code code, b.short_desc	description	FROM st_store a, mm_store_lang_vw b	WHERE a.store_code = b.store_code AND b.eff_status='E' and b.facility_id like (?) AND a.store_code LIKE	UPPER(?)  AND upper(b.short_desc) like upper(?) AND b.language_id = ");
		dataMap.put("SQL_ST_ITEM_STORE_TYPE_SELECT", "SELECT st.store_type_flag, mm.external_yn	FROM st_store st, mm_store mm WHERE	st.store_code =	mm.store_code AND st.store_code	= ?");

		// Added by jagadeesh on 18/10/2004 
		//dataMap.put("SQL_ST_ITEM_STORE_SELECT","SELECT B.short_desc	item_desc, A.bin_location_code bin_location_code, A.stock_item_yn, A.min_stk_qty, A.max_stk_qty, A.reorder_level, A.reorder_freq_days, A.lead_days,	A.min_stock_days, A.percent_min_stock,A.request_gen_stage,A.def_request_uom,A.def_issue_uom , a.eff_status,b.gen_uom_code FROM st_item_store A,	mm_item	B  WHERE store_code	= ?	AND	B.item_code	= ?	AND	B.item_code	= A.item_code");
		dataMap.put("SQL_ST_ITEM_STORE_AND_ST_ITEM_SELECT","SELECT phy_inv_type,phy_inv_count_per_year from ST_ITEM where item_code=?");
		//dataMap.put("SQL_ST_ITEM_STORE_AND_ST_ITEMINV_SELECT","SELECT phy_inv_type from ST_ITEM where item_code=?");
		//dataMap.put("SQL_ST_ITEM_STORE_AND_ST_COUNT_ITEM_SELECT","SELECT phy_inv_count_per_year from ST_ITEM where item_code=?");
        dataMap.put("SQL_ST_ITEM_STORE_SELECT","SELECT B.short_desc	item_desc, A.bin_location_code bin_location_code, A.stock_item_yn, A.min_stk_qty, A.max_stk_qty, A.reorder_level, A.reorder_freq_days, A.lead_days,	A.min_stock_days, A.percent_min_stock,A.request_gen_stage,A.def_request_uom,A.def_issue_uom , a.eff_status,b.gen_uom_code,A.phy_inv_type phy_inv_type,A.phy_inv_count_per_year phy_inv_count_per_year   FROM st_item_store A,	mm_item_lang_vw	B  WHERE store_code	= ?	AND	B.item_code	= ?	AND	B.item_code	= A.item_code AND b.language_id = ?");
		dataMap.put("SQL_ST_ITEM_STORE_SELECT1","SELECT B.short_desc	item_desc, A.bin_location_code bin_location_code, A.stock_item_yn, A.min_stk_qty, A.max_stk_qty, A.reorder_level, A.reorder_freq_days, A.lead_days,	A.min_stock_days, A.percent_min_stock,A.request_gen_stage,A.def_request_uom,A.def_issue_uom , a.eff_status,b.gen_uom_code,A.phy_inv_type phy_inv_type,A.phy_inv_count_per_year phy_inv_count_per_year   FROM st_item_store A,	mm_item_lang_vw	B  WHERE store_code	= ?	AND	B.item_code	= ?	AND	B.item_code	= A.item_code AND B.language_id = ?");
//Added By Janet on 16/05/2005 for including UOM
		dataMap.put("SQL_ST_ITEM_STORE_UOM_CODE_SELECT","select gen_uom_code from MM_ITEM where item_code=?");
		dataMap.put("SQL_MM_ITEM_CLASS_ST_SELECT_LIST","SELECT item_class_code,	short_desc FROM	mm_item_class WHERE	appl_st_yn ='Y'	ORDER BY short_desc");
		dataMap.put("SQL_ST_ITEM_BATCH_VALIDATE_SELECT","SELECT	qty_on_hand, phy_inv_id	,batch_id, trade_id, bin_location_code,	to_char(expiry_date_or_receipt_date,'dd/mm/yyyy') exp_rec_dt FROM st_item_batch	WHERE store_code = ? AND item_code = ?");
// modified by manish on Monday, February 16, 2004
		dataMap.put("SQL_ST_STORE_MEDICAL_ITEM_SELECT","SELECT decode(medical_item_yn,'Y',decode(nonmedical_item_yn,'Y','A','Y'),'N') medical_item_yn FROM st_store WHERE store_code =	?");
//		dataMap.put("SQL_ST_STORE_MEDICAL_ITEM_SELECT","SELECT medical_item_yn FROM	st_store WHERE store_code =	?");
//  ends.

		dataMap.put("SQL_ST_ITEM_STORE_QTY_ON_HAND","SELECT nvl(qty_on_hand,0) qty_on_hand,stock_item_yn FROM st_item_store WHERE store_code = ? AND item_code = ?");



		// Request - Martin
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_REQ_AUTHORIZE_SELECT","SELECT	req_authorize_allowed_yn,ret_finalize_allowed_yn,parent_store_code,PRQ_FINALIZE_ALLOWED_YN FROM	st_user_access_for_store su,st_store st	WHERE su.store_code	= st.store_code	and	user_id	= ?	 AND su.store_code = ?");
	
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SPL_REQ_AUTHORIZE","SELECT AUTHORIZE_SPECIAL_REQ_YN FROM ST_USER_ACCESS_FOR_STORE WHERE USER_ID = ? AND STORE_CODE = ? ");
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_AUTHORIZE_SELECT","SELECT	iss_finalize_allowed_yn, req_authorize_allowed_yn,urg_finalize_allowed_yn,parent_store_code	FROM st_user_access_for_store su,st_store st WHERE su.store_code = st.store_code and user_id = ?  AND su.store_code	= ?");
		
		dataMap.put("SQL_ST_ITEM_CLASS_SELECT_LIST","SELECT   item_class_code, short_desc FROM mm_item_class_lang_vw WHERE eff_status = 'E' AND item_class_code IN (SELECT item_class_code  FROM st_item_class_store WHERE store_code IN (?)) AND item_class_code IN (SELECT item_class_code FROM st_item_class_store WHERE store_code IN (?)) AND language_id = ? ORDER BY 2 ");
         //Commented by Rabbani INC NO:34758(RUT-CRF-0082) on 07/02/2013
		//dataMap.put("SQL_ST_REQUEST_HDR_INSERT","INSERT	INTO st_request_hdr	( facility_id, doc_type_code, doc_no, doc_date,	doc_ref, item_class_code, request_status, req_by_store_code, req_on_store_code,	req_raised_by_id, req_authorized_by_id,	trn_type, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id,REQUEST_TYPE ) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ?,?  )");
		
		//Added by Rabbani INC NO:34758(RUT-CRF-0082) on 07/02/2013
		dataMap.put("SQL_ST_REQUEST_HDR_INSERT","INSERT	INTO st_request_hdr	( facility_id, doc_type_code, doc_no, doc_date,	doc_ref, item_class_code, request_status, req_by_store_code, req_on_store_code,	req_raised_by_id, req_authorized_by_id,	trn_type, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id,REQUEST_TYPE,REMARKS ) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ?,?,?  )");
		
		//18/09/12
		//dataMap.put("SQL_ST_REQUEST_DTL_INSERT","INSERT	INTO st_request_dtl	( facility_id, doc_type_code, doc_no, doc_srl_no, item_code, req_item_qty, stock_item_yn, committed_item_qty, pending_item_qty,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id,request_uom,request_uom_conv,request_uom_qty,auth_trn_remarks_code ) VALUES	 ( ? , ? , ? , ? , ? , ? , ? , ? , ?, ? , sysdate , ? , ? , ? , sysdate , ? , ?,?,?,?,?  )");
		dataMap.put("SQL_ST_REQUEST_DTL_INSERT","INSERT	INTO st_request_dtl	( facility_id, doc_type_code, doc_no, doc_srl_no, item_code, req_item_qty, stock_item_yn, committed_item_qty, pending_item_qty,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id,request_uom,request_uom_conv,request_uom_qty,auth_trn_remarks_code,usage_type ) VALUES	 ( ? , ? , ? , ? , ? , ? , ? , ? , ?, ? , sysdate , ? , ? , ? , sysdate , ? , ?,?,?,?,?,?  )");
		//dataMap.put("SQL_ST_REQUEST_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.req_by_store_code,  rbys.short_desc req_by_store_desc,hdr.req_on_store_code,	rons.short_desc	req_on_store_desc, hdr.item_class_code,	itm.short_desc item_class_desc	FROM st_request_hdr	hdr, mm_store_lang_vw rbys,mm_store_lang_vw	rons, mm_item_class_lang_vw	itm, sy_doc_type_master_lang_vw	sy,	st_store uaca, st_user_access_for_store	uacb, st_acc_entity_param pa WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL AND hdr.req_authorized_by_id IS NULL AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') like ?	AND	hdr.req_by_store_code like ? AND hdr.req_on_store_code like	? AND  NVL(hdr.item_class_code,'X')	like ? AND /*uaca.user_id	= ?	AND*/	uaca.store_code	= hdr.req_on_store_code	AND	uaca.iss_allowed_yn	= 'Y' AND uacb.user_id = ? /*uaca.user_id*/ AND uacb.store_code =	hdr.req_by_store_code AND uacb.req_allowed_yn =	'Y'	AND	rbys.facility_id=? AND pa.acc_entity_id=? AND ((pa.trn_across_facility_yn='Y') OR rons.facility_id = ?) AND rbys.language_id = rons.language_id AND rons.language_id = sy.language_id AND sy.language_id = ? AND itm.language_id(+) = ?");

		dataMap.put("SQL_ST_REQUEST_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.req_by_store_code,  rbys.short_desc req_by_store_desc,hdr.req_on_store_code,	rons.short_desc	req_on_store_desc, hdr.item_class_code,	itm.short_desc item_class_desc	FROM st_request_hdr	hdr, mm_store_lang_vw rbys,mm_store_lang_vw	rons, mm_item_class_lang_vw	itm, sy_doc_type_master_lang_vw	sy,	st_store uaca, st_user_access_for_store	uacb, st_acc_entity_param pa WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL AND hdr.req_authorized_by_id IS NULL AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	/*TO_CHAR(hdr.doc_date,'dd/mm/yyyy') like ?*/ TO_DATE (TO_CHAR (hdr.doc_date, 'dd/mm/yyyy'), 'dd/mm/yyyy')  BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy')	AND	hdr.req_by_store_code like ? AND hdr.req_on_store_code like	? AND  NVL(hdr.item_class_code,'X')	like ? AND /*uaca.user_id	= ?	AND*/	uaca.store_code	= hdr.req_on_store_code	AND	uaca.iss_allowed_yn	= 'Y' AND uacb.user_id = ? /*uaca.user_id*/ AND uacb.store_code =	hdr.req_by_store_code AND uacb.req_allowed_yn =	'Y'	AND	rbys.facility_id=? AND pa.acc_entity_id=? AND ((pa.trn_across_facility_yn='Y') OR rons.facility_id = ?) AND rbys.language_id = rons.language_id AND rons.language_id = sy.language_id AND sy.language_id = ? AND itm.language_id(+) = ?");

		// Commented by Padmapriya On 03/02/2012
		//dataMap.put("SQL_ST_REQ_HDR_INSERT_FOR_AUTH","INSERT	INTO st_request_hdr	( facility_id, doc_type_code, doc_no, doc_date,	doc_ref, item_class_code, issue_seq_no, request_status, req_by_store_code, req_on_store_code,	req_raised_by_id, req_authorized_by_id,	trn_type, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id ) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ?, ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ?  )");
		// Added CANCELLED_BY_ID , CANCELLED_REMARKS by Padmapriya On 03/02/2012
		dataMap.put("SQL_ST_REQ_HDR_INSERT_FOR_AUTH","INSERT	INTO st_request_hdr	( facility_id, doc_type_code, doc_no, doc_date,	doc_ref, item_class_code, issue_seq_no, CANCELLED_BY_ID, CANCELLED_REMARKS, request_status, req_by_store_code, req_on_store_code,	req_raised_by_id, req_authorized_by_id,	trn_type, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id ) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ? , ?, ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ?  )");
		//Commented by Rabbani INC NO:34758(RUT-CRF-0082) on 07/FEB/2013
		//dataMap.put("SQL_ST_REQUEST_HDR_SELECT","SELECT	facility_id, doc_type_code,	doc_no,	to_char(doc_date,'dd/mm/yyyy'),	doc_ref, item_class_code, req_by_store_code, req_on_store_code ,REQUEST_TYPE FROM	st_request_hdr WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?");
		//Added by Rabbani INC NO:34758(RUT-CRF-0082) on 07/FEB/2013
		
		dataMap.put("SQL_ST_REQUEST_HDR_SELECT","SELECT	facility_id, doc_type_code,	doc_no,	to_char(doc_date,'dd/mm/yyyy'),	doc_ref, item_class_code, req_by_store_code, req_on_store_code ,REQUEST_TYPE, remarks remarks_code,(SELECT remarks_desc FROM MM_trn_remarks_lang_vw  WHERE module_id = 'ST'  AND trn_remarks_code = a.REMARKS AND language_id = ?)remarks  FROM	st_request_hdr a WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?");
		
		dataMap.put("SQL_ST_REQUEST_ITEM_STORE_SELECT","SELECT req_by_store_code,item_code,req_item_qty FROM st_request_HDR HDR,st_request_dtl dtl WHERE  hdr.facility_id=dtl.facility_id AND hdr.doc_type_code=dtl.doc_type_code AND hdr.doc_no=dtl.doc_no AND hdr.facility_id=? AND hdr.doc_type_code=? AND hdr.doc_no=?");
// changed by manish..
//		dataMap.put("SQL_ST_REQUEST_DTL_SELECT","SELECT	doc_srl_no,	dtl.item_code, itm.short_desc item_desc, req_item_qty, uom.short_desc uom_desc,	stock_item_yn from st_request_dtl dtl, mm_item itm,	am_uom uom WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND dtl.item_code = itm.item_code AND itm.gen_uom_code	= uom.uom_code ORDER BY	doc_srl_no");

		//dataMap.put("SQL_ST_REQUEST_DTL_SELECT","SELECT	doc_srl_no, dtl.item_code, itm.short_desc item_desc, req_item_qty, uom.short_desc uom_desc, dtl.stock_item_yn, qty_on_hand available_stock from st_request_dtl dtl, mm_item itm, am_uom uom, st_request_hdr hdr, st_item_store itstr WHERE dtl.facility_id = ? AND dtl.doc_type_code = ? AND dtl.doc_no = ? AND dtl.item_code = itm.item_code AND itm.gen_uom_code = uom.uom_code and dtl.facility_id=hdr.facility_id and dtl.doc_type_code=hdr.doc_type_code and dtl.doc_no=hdr.doc_no and hdr.req_on_store_code=itstr.store_code and dtl.item_code=itstr.item_code ORDER BY doc_srl_no");
		//18/09/12
		//dataMap.put("SQL_ST_REQUEST_DTL_SELECT","SELECT   (select nvl(ALLOW_DECIMALS_YN,'N') from st_item where item_code = dtl.item_code) dec_allowed_yn,(select nvl(NO_OF_DECIMALS,0) from st_acc_entity_param where acc_entity_id = 'ZZ') NO_OF_DECIMALS,hdr.req_by_store_code,hdr.req_on_store_code,doc_srl_no, dtl.item_code, itm.short_desc item_desc, req_item_qty, itstr1.def_issue_uom uom,uom.short_desc uom_desc, dtl.stock_item_yn, itstr.qty_on_hand available_stock, dtl.request_uom, dtl.request_uom_conv, dtl.request_uom_qty, itstr1.qty_on_hand, itstr1.max_stk_qty, itm.gen_uom_code,dtl.usage_type FROM st_request_dtl dtl, mm_item_lang_vw itm, am_uom_lang_vw uom, st_request_hdr hdr, st_item_store itstr, st_item_store itstr1 WHERE dtl.facility_id = ? AND dtl.doc_type_code = ? AND dtl.doc_no = ? AND dtl.item_code = itm.item_code AND itstr1.DEF_ISSUE_UOM = uom.uom_code AND dtl.facility_id = hdr.facility_id AND dtl.doc_type_code = hdr.doc_type_code AND dtl.doc_no = hdr.doc_no AND hdr.req_on_store_code = itstr.store_code AND hdr.req_by_store_code = itstr1.store_code AND dtl.item_code = itstr.item_code AND dtl.item_code = itstr1.item_code AND itm.language_id = uom.language_id AND itm.language_id = ? ORDER BY doc_srl_no");
		//Added by Sakti Sankar Inc#32347 Monday, October 22, 2012
		dataMap.put("SQL_ST_REQUEST_DTL_SELECT","SELECT   (select nvl(ALLOW_DECIMALS_YN,'N') from st_item where item_code = dtl.item_code) dec_allowed_yn,(select nvl(NO_OF_DECIMALS,0) from st_acc_entity_param where acc_entity_id = 'ZZ') NO_OF_DECIMALS,hdr.req_by_store_code,hdr.req_on_store_code,doc_srl_no, dtl.item_code, itm.short_desc item_desc, req_item_qty, itstr1.def_issue_uom uom,uom.short_desc uom_desc, dtl.stock_item_yn, itstr.qty_on_hand available_stock, dtl.request_uom, dtl.request_uom_conv, dtl.request_uom_qty, itstr1.qty_on_hand, itstr1.max_stk_qty, itm.gen_uom_code,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW WHERE UOM_CODE=itm.gen_uom_code and language_id= itm.language_id)gen_uom_desc,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW WHERE UOM_CODE=dtl.request_uom and language_id= itm.language_id)request_uom_desc, dtl.usage_type FROM st_request_dtl dtl, mm_item_lang_vw itm, am_uom_lang_vw uom, st_request_hdr hdr, st_item_store itstr, st_item_store itstr1 WHERE dtl.facility_id = ? AND dtl.doc_type_code = ? AND dtl.doc_no = ? AND dtl.item_code = itm.item_code AND itstr1.DEF_ISSUE_UOM = uom.uom_code AND dtl.facility_id = hdr.facility_id AND dtl.doc_type_code = hdr.doc_type_code AND dtl.doc_no = hdr.doc_no AND hdr.req_on_store_code = itstr.store_code AND hdr.req_by_store_code = itstr1.store_code AND dtl.item_code = itstr.item_code AND dtl.item_code = itstr1.item_code AND itm.language_id = uom.language_id AND itm.language_id = ? ORDER BY doc_srl_no");

		dataMap.put("SQL_ST_REQUEST_HDR_DELETE","DELETE	FROM st_request_hdr	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?");
		dataMap.put("SQL_ST_REQUEST_DTL_DELETE","DELETE	FROM st_request_dtl	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?");
		dataMap.put("SQL_ST_REQUEST_DTL_SINGLE_DELETE","DELETE FROM	st_request_dtl WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND	doc_srl_no = ?");
		//Commented by Rabbani INC NO:34758(RUT-CRF-0082) on 07/FEB/2013
		dataMap.put("SQL_ST_REQUEST_HDR_UPDATE","UPDATE	st_request_hdr SET doc_date	= TO_DATE(?,'dd/mm/yyyy') ,	doc_ref	= ?	, req_authorized_by_id = ? , request_status	= ?	, modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	?  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?");
		
		//Added by Rabbani INC NO:34758(RUT-CRF-0082) on 07/FEB/2013
		dataMap.put("SQL_ST_REQUEST_HDR_UPDATE","UPDATE	st_request_hdr SET doc_date	= TO_DATE(?,'dd/mm/yyyy') ,	doc_ref	= ?	, req_authorized_by_id = ? , request_status	= ?	, modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	?,REMARKS = ?  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?");
		
		//dataMap.put("SQL_ST_REQUEST_DTL_UPDATE","UPDATE	st_request_dtl SET req_item_qty	= ?, pending_item_qty =	?, stock_item_yn = ? ,  modified_by_id =	? ,	modified_date =	SYSDATE	, modified_at_ws_no	= ?	, modified_facility_id = ?	,  request_uom = ? , request_uom_conv = ? , request_uom_qty = ?  WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");
		dataMap.put("SQL_ST_REQUEST_DTL_UPDATE","UPDATE	st_request_dtl SET req_item_qty	= ?, pending_item_qty =	?, stock_item_yn = ? ,  modified_by_id =	? ,	modified_date =	SYSDATE	, modified_at_ws_no	= ?	, modified_facility_id = ?	,  request_uom = ? , request_uom_conv = ? , request_uom_qty = ?, usage_type = ?  WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");

//added by manish on Thursday, December 25, 2003.
/*This query is used by common header page, hence skipping parameter will require code change*/
		dataMap.put("SQL_ST_REQUEST_FROM_STORE_SELECT_FROMST_STORE","SELECT DISTINCT parent_store_code, mm.short_desc FROM ST_STORE_PARENT_STORE stp, mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st, ST_ACC_ENTITY_PARAM WHERE  mm.store_code = stp.parent_store_code AND stp.parent_store_code = st.store_code AND st.req_allowed_yn = 'Y' AND mm.eff_status = 'E' AND mm.facility_id LIKE DECODE (trn_across_facility_yn, 'Y', '%', ?) AND mm.language_id = ? AND stp.store_code = ? ORDER BY 2, 1  ");


		dataMap.put("SQL_ST_REQUEST_FROM_STORE_SELECT","SELECT st.store_code, mm.short_desc	FROM st_user_access_for_store st, mm_store mm, st_acc_entity_param pa WHERE	st.user_id = ? AND st.store_code = mm.store_code AND st.iss_allowed_yn='Y' AND mm.eff_status = 'E' AND pa.acc_entity_id= ? AND ((pa.trn_across_facility_yn='Y')	OR mm.facility_id =	?) ORDER BY	2,1");
		dataMap.put("SQL_ST_ITEM_STORE_PENDING_UPDATE","UPDATE st_item_store SET pending_req_qty = NVL(pending_req_qty,0) +	? ,	modified_by_id = ?,	modified_date =	sysdate, modified_at_ws_no = ?,	modified_facility_id = ? WHERE store_code =	? AND  item_code = ?");
		dataMap.put("SQL_ST_ITEM_STORE_PENDING_SELECT","SELECT pending_item_qty FROM st_request_dtl WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ? AND doc_srl_no = ?");

		//Query added for Item Request Type
		dataMap.put("SQL_ST_ITEM_REQUEST_TYPE" , "SELECT ITEM_CODE FROM ST_ITEM WHERE ITEM_CODE = ? AND SPECIAL_REQ_ITEM_YN = DECODE(?,'S','Y','N') ");

		//Cancel Request --	Martin
		//Commented by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 19-JULY-2013  
		//dataMap.put("SQL_ST_CANCEL_REQUEST_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no,        TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc,        hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status FROM st_request_hdr hdr, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast WHERE hdr.doc_type_code = sy.doc_type_code AND hdr.req_by_store_code = rbys.store_code    AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND hdr.doc_type_code LIKE ? AND TO_CHAR (hdr.doc_no) LIKE ?  AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND hdr.req_by_store_code LIKE ? AND hdr.req_on_store_code LIKE ? AND NVL (hdr.item_class_code, '%') LIKE ? AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.CANCL_ALLOWED_YN = 'Y' AND uast.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rbys.external_yn LIKE DECODE (?, 'Y', 'Y', 'N', 'N', '%') AND request_status LIKE ? AND rons.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND rbys.facility_id = ? AND uast.USER_ID = ?");
		
		//Added by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 19-JULY-2013  
		//dataMap.put("SQL_ST_CANCEL_REQUEST_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc, hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status ,hdr.facility_id facility_id FROM st_request_hdr hdr,st_request_dtl dtl, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast  WHERE hdr.doc_type_code = sy.doc_type_code AND HDR.DOC_TYPE_CODE =  DTL.DOC_TYPE_CODE AND HDR.DOC_NO = DTL.DOC_NO AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND hdr.doc_type_code LIKE ? AND TO_CHAR (hdr.doc_no) LIKE ?  AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND hdr.req_by_store_code LIKE ? AND hdr.req_on_store_code LIKE ?  AND DTL.ITEM_CODE LIKE ? AND NVL (hdr.item_class_code, '%') LIKE ? AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.CANCL_ALLOWED_YN = 'Y' AND uast.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rbys.external_yn LIKE DECODE (?, 'Y', 'Y', 'N', 'N', '%') AND request_status LIKE ? AND rons.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND rbys.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND uast.USER_ID = ?  and dtl.pending_item_qty > 0");
		
		//Added by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 23-JULY-2013  
		//dataMap.put("SQL_ST_CANCEL_REQUEST_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc, hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status ,hdr.facility_id facility_id FROM st_request_hdr hdr,st_request_dtl dtl, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast ,mm_item_lang_vw mm WHERE hdr.doc_type_code = sy.doc_type_code AND HDR.DOC_TYPE_CODE =  DTL.DOC_TYPE_CODE AND HDR.DOC_NO = DTL.DOC_NO AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND hdr.doc_type_code LIKE ? AND TO_CHAR (hdr.doc_no) LIKE ?  AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND hdr.req_by_store_code LIKE ? AND hdr.req_on_store_code LIKE ?  AND DTL.ITEM_CODE LIKE ?  and dtl.item_code = mm.item_code AND UPPER (mm.short_desc) LIKE UPPER (?) AND NVL (hdr.item_class_code, '%') LIKE ? AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.CANCL_ALLOWED_YN = 'Y' AND uast.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rbys.external_yn LIKE DECODE (?, 'Y', 'Y', 'N', 'N', '%') AND request_status LIKE ? AND rons.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND rbys.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND uast.USER_ID = ?  and mm.language_id = ? and dtl.pending_item_qty > 0");
		
		//Added By Rabbani #Inc no:27060 (MO-CRF-20048) on 17-Feb-2014
		//dataMap.put("SQL_ST_CANCEL_REQUEST_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc, hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status ,hdr.facility_id facility_id FROM st_request_hdr hdr,st_request_dtl dtl, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast ,mm_item_lang_vw mm WHERE hdr.doc_type_code = sy.doc_type_code AND HDR.DOC_TYPE_CODE =  DTL.DOC_TYPE_CODE AND HDR.DOC_NO = DTL.DOC_NO AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND hdr.doc_type_code LIKE ? AND TO_CHAR (hdr.doc_no) LIKE ?  AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND hdr.req_by_store_code LIKE ? AND hdr.req_on_store_code LIKE ?  AND DTL.ITEM_CODE LIKE ?  and dtl.item_code = mm.item_code AND UPPER (mm.short_desc) LIKE UPPER (?) AND NVL (hdr.item_class_code, '%') LIKE ? AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.CANCL_ALLOWED_YN = 'Y' AND uast.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rbys.external_yn LIKE DECODE (?, 'Y', 'Y', 'N', 'N', '%') AND request_status LIKE ? AND rons.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND rbys.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND uast.USER_ID = ?  and mm.language_id = ? and dtl.pending_item_qty > 0 AND DTL.COMMITTED_ITEM_QTY = 0 ");

		//Modified by Sakti for performance tuning. passing some more parameters to this query based on availability of the same from the application Inc# 51157
		//dataMap.put("SQL_ST_CANCEL_REQUEST_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc, hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status ,hdr.facility_id facility_id FROM st_request_hdr hdr,st_request_dtl dtl, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast ,mm_item_lang_vw mm WHERE hdr.doc_type_code = sy.doc_type_code AND HDR.DOC_TYPE_CODE =  DTL.DOC_TYPE_CODE AND HDR.DOC_NO = DTL.DOC_NO AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.CANCL_ALLOWED_YN = 'Y' AND uast.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rons.facility_id = DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND rbys.facility_id = DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND uast.USER_ID = ? and mm.language_id = ? and dtl.pending_item_qty > 0 AND DTL.COMMITTED_ITEM_QTY = 0 ");

		//Modified by sakti againat 52621 changed facility_id = to facility_id LIKE AT LAST
		//dataMap.put("SQL_ST_CANCEL_REQUEST_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc, hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status ,hdr.facility_id facility_id FROM st_request_hdr hdr,st_request_dtl dtl, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast ,mm_item_lang_vw mm WHERE hdr.doc_type_code = sy.doc_type_code AND HDR.DOC_TYPE_CODE =  DTL.DOC_TYPE_CODE AND HDR.DOC_NO = DTL.DOC_NO AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.CANCL_ALLOWED_YN = 'Y' AND uast.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rons.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND rbys.facility_id LIKE DECODE (stpa.trn_across_facility_yn, 'Y', '%', ?) AND uast.USER_ID = ? and mm.language_id = ? and dtl.pending_item_qty > 0 AND DTL.COMMITTED_ITEM_QTY = 0 ");
		//Modified by suresh.r on 12-12-2014 against Inc 052998
		dataMap.put("SQL_ST_CANCEL_REQUEST_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc, hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status ,hdr.facility_id facility_id FROM st_request_hdr hdr,st_request_dtl dtl, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast ,mm_item_lang_vw mm WHERE hdr.doc_type_code = sy.doc_type_code AND HDR.DOC_TYPE_CODE =  DTL.DOC_TYPE_CODE AND HDR.DOC_NO = DTL.DOC_NO AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.CANCL_ALLOWED_YN = 'Y' AND uast.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rons.facility_id = DECODE (stpa.trn_across_facility_yn, 'Y', rons.facility_id, ?) AND rbys.facility_id = DECODE (stpa.trn_across_facility_yn, 'Y', rbys.facility_id, ?) AND uast.USER_ID = ? and mm.language_id = ? and dtl.pending_item_qty > 0 AND DTL.COMMITTED_ITEM_QTY = 0 ");
		
         //commented by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 19-JULY-2013 
		//dataMap.put("SQL_ST_CANCEL_REQUEST_DTL_SELECT","SELECT doc_no,doc_srl_no, dtl.item_code, itm.short_desc item_desc,	req_item_qty,iss_item_qty, pending_item_qty FROM st_request_dtl dtl, mm_item_lang_vw itm WHERE facility_id = (SELECT DISTINCT FACILITY_ID FROM st_request_dtl WHERE DOC_TYPE_CODE = DTL.doc_type_code  AND doc_no = DTL.doc_no)  AND doc_type_code	= ?	 AND doc_no	= ?	 AND dtl.item_code = itm.item_code AND itm.language_id = ? ORDER BY	doc_srl_no");
		//Added by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 16-JULY-2013 
		//dataMap.put("SQL_ST_CANCEL_REQUEST_DTL_SELECT","SELECT doc_no,doc_srl_no, dtl.item_code, itm.short_desc item_desc,	req_item_qty,iss_item_qty, pending_item_qty FROM st_request_dtl dtl, mm_item_lang_vw itm WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND dtl.item_code = itm.item_code AND DTL.item_code LIKE  ? AND itm.language_id = ? and dtl.pending_item_qty > 0 ORDER BY	doc_srl_no");
		
		//dataMap.put("SQL_ST_CANCEL_REQUEST_DTL_SELECT","SELECT doc_no,doc_srl_no, dtl.item_code, itm.short_desc item_desc,	req_item_qty,iss_item_qty, pending_item_qty FROM st_request_dtl dtl, mm_item_lang_vw itm WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND dtl.item_code = itm.item_code AND DTL.item_code LIKE  ?  AND UPPER (itm.short_desc) LIKE UPPER (?) AND itm.language_id = ? and dtl.pending_item_qty > 0 ORDER BY	doc_srl_no");
		
		//Added By Rabbani #Inc no:27060 (MO-CRF-20048) on 17-Feb-2014
		dataMap.put("SQL_ST_CANCEL_REQUEST_DTL_SELECT","SELECT doc_no,doc_srl_no, dtl.item_code, itm.short_desc item_desc,	req_item_qty,iss_item_qty, pending_item_qty FROM st_request_dtl dtl, mm_item_lang_vw itm WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND dtl.item_code = itm.item_code AND DTL.item_code LIKE  ?  AND UPPER (itm.short_desc) LIKE UPPER (?) AND itm.language_id = ? and dtl.pending_item_qty > 0 AND DTL.COMMITTED_ITEM_QTY = 0 ORDER BY	doc_srl_no");
		
		//commented by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 19-JULY-2013 
		//dataMap.put("SQL_ST_CANCEL_REQUEST_UPDATE","UPDATE st_request_hdr SET cancelled_by_id =	? ,	cancelled_remarks =	?, request_status =	?, modified_by_id =	? ,	modified_date =	sysdate	, modified_at_ws_no	= ?	, modified_facility_id = ?	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?");
		//Added by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 19-JULY-2013 
		dataMap.put("SQL_ST_CANCEL_REQUEST_UPDATE","UPDATE st_request_hdr SET cancelled_by_id =	? ,	cancelled_remarks =	?, request_status =	?, modified_by_id =	? ,	modified_date =	sysdate	, modified_at_ws_no	= ?	, modified_facility_id = ?,CANCEL_REMARKS_DESC = ?	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?");
		 
		dataMap.put("SQL_ST_REVERT_REQUEST_ON_CANCEL","UPDATE st_item_store SET pending_req_qty = DECODE (SIGN (pending_req_qty - ?), -1, 0, (pending_req_qty - ?) ), modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?, modified_facility_id = ? WHERE store_code = ? AND item_code = ?");//Modified for TTM-SCF-0202
		//dataMap.put("SQL_ST_REVERT_DTL_SELECT","SELECT hdr.req_by_store_code, dtl.pending_item_qty,dtl.item_code FROM st_request_hdr hdr, st_request_dtl dtl WHERE hdr.doc_no = dtl.doc_no AND hdr.doc_no = ? and hdr.doc_type_code = ?");
		
		dataMap.put("SQL_ST_REVERT_DTL_SELECT","SELECT hdr.req_by_store_code, dtl.pending_item_qty,dtl.item_code FROM st_request_hdr hdr, st_request_dtl dtl WHERE hdr.doc_no = dtl.doc_no AND hdr.doc_no = ? and hdr.doc_type_code = ?  and dtl.pending_item_qty > 0");
		
		dataMap.put("SQL_ST_CANCEL_REQUEST_REQ_BY_STORE_SELECT","SELECT   st.store_code, mm.short_desc FROM st_store st, mm_store_lang_vw mm, st_user_access_for_store su  WHERE st.store_code = mm.store_code    AND mm.eff_status = 'E' AND st.req_allowed_yn = 'Y' AND su.req_allowed_yn = 'Y' AND su.cancl_allowed_yn = 'Y' AND su.store_code = st.store_code AND mm.facility_id = ? AND mm.language_id = ? AND user_id = ? ORDER BY 2, 1");
        //added by Rabbani on 27/07/11 #inc no:27426 updating Query for st_request_store
		dataMap.put("SQL_ST_CANCEL_REQUEST_DTL","UPDATE st_request_dtl SET   pending_item_qty=pending_item_qty - NVL(?,0) , modified_by_id = ?,modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id = ? WHERE  item_code=? AND doc_no = ? AND doc_type_code	= ?"); 
		//Added by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 19-JULY-2013 
		dataMap.put("SQL_ST_CANCEL_REQUEST_BY_ITEM","UPDATE st_request_dtl SET   pending_item_qty=pending_item_qty - NVL(?,0) , modified_by_id = ?,modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id = ?,CANCEL_REMARKS = ?,CANCEL_REMARKS_DESC = ? WHERE  item_code=? AND doc_no = ? AND doc_type_code	= ?");

		dataMap.put("SQL_ST_CANCEL_REQUEST_REQ_ON_STORE_SELECT","SELECT DISTINCT stp.parent_store_code, mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm, st_store st, st_acc_entity_param stpa  WHERE mm.store_code = stp.parent_store_code AND mm.eff_status = 'E'  AND  st.store_code = mm.store_code   AND st.iss_allowed_yn = 'Y' AND mm.facility_id LIKE DECODE( TRN_ACROSS_FACILITY_YN, 'Y','%',?) AND mm.language_id = ? AND stp.store_Code = ? ORDER BY	2");

		//Authorize	at Issue - Martin

		dataMap.put("SQL_ST_REQUEST_ISSUE_YTTD_SELECT","select abs(sum(nvl(out_iss_qty_ns,0) + nvl(out_iss_qty_st,0) + nvl(out_urg_qty_ns,0) + nvl(out_urg_qty_st,0) + nvl(sal_qty,0))) ytd_issue_qty from st_item_move_summ a,st_facility_param b where b.facility_id=? and a.item_code=?  and a.move_year=b.curr_proc_year");
		dataMap.put("SQL_ST_ALL_QTY_FOR_DISPLAY","select sum(case when chk_stk_lvl_for_pur_yn='Y' then avail_qty else 0 end) stk_at_reorder_stores, sum(case when a.store_code='IPSAT' then avail_qty else 0 end) stk_at_req_by_store, sum(case when a.store_code='MAIN' then avail_qty else 0 end) stk_at_req_on_store from st_batch_search_view a,st_store b where a.store_code=b.store_code and item_code=?");
		dataMap.put("SQL_ST_REQUEST_ISSUE_AUTHORIZE_QUERY_RESULT","SELECT distinct hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.req_by_store_code,  rbys.short_desc req_by_store_desc,hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc,DECODE(hdr.request_status,'W','Auth at Req By Store','P', 'Partially Issued',hdr.request_status) request_status, hdr.facility_id req_store_facility_id, sm.facility_name req_store_facility_name FROM ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm, sy_doc_type_master_lang_vw sy, ST_USER_ACCESS_FOR_STORE uaca, ST_STORE uacb, ST_ACC_ENTITY_PARAM stp  , sm_facility_param_lang_vw sm, st_request_dtl dtl, mm_item_lang_vw mmvw WHERE hdr.request_status IN ('P','W') AND hdr.doc_type_code = sy.doc_type_code  AND hdr.req_by_store_code=  rbys.store_code AND  hdr.req_on_store_code = rons.store_code  AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL  AND hdr.req_authorized_by_id IS NOT NULL AND hdr.doc_type_code LIKE ? AND TO_CHAR(hdr.doc_no) LIKE  ?  AND (hdr.doc_date BETWEEN TO_DATE(NVL(?,'01/01/1901'),'dd/mm/yyyy') AND TO_DATE(NVL(?,'31/12/3012'),'dd/mm/yyyy'))  AND hdr.req_by_store_code LIKE ? AND hdr.req_on_store_code LIKE ? AND  NVL(hdr.item_class_code,'X') LIKE ?  AND uaca.user_id = ? AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y'  /*AND uacb.user_id = uaca.user_id*/ AND uacb.store_code = hdr.req_by_store_code AND uacb.req_allowed_yn = 'Y'  AND ST_REQ_ISSUE_CHK(hdr.facility_id, hdr.doc_type_code, hdr.doc_no)<>'2'  AND rbys.external_yn LIKE DECODE(?,'Y','Y','N','N','%') AND hdr.trn_type = 'ISS' AND hdr.request_status LIKE ? AND rons.facility_id = ?/*(hdr.facility_id LIKE DECODE(trn_across_facility_yn,'Y','%',?))*/ AND hdr.facility_id = sm.facility_id  AND rbys.language_id = rons.language_id AND rbys.language_id = sy.language_id AND rbys.language_id = sm.language_id AND rbys.language_id = ? AND itm.language_id(+) = ? AND rbys.facility_id LIKE DECODE (trn_across_facility_yn,'Y', '%', ?) AND hdr.doc_no = dtl.doc_no  AND hdr.doc_type_code = dtl.doc_type_code AND hdr.facility_id = dtl.facility_id AND dtl.item_code = mmvw.item_code  AND mmvw.language_id = rbys.language_id   and dtl.ITEM_CODE like ? ");
		
		dataMap.put("SQL_ST_REQUEST_ISSUE_HDR_SELECT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')doc_date, hdr.doc_ref, hdr.req_by_store_code, rbys.short_desc req_by_store_desc,hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc,hdr.facility_id facility_id FROM ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm, sy_doc_type_master_lang_vw sy, ST_ACC_ENTITY_PARAM stp  WHERE hdr.doc_type_code = sy.doc_type_code AND hdr.req_by_store_code= rbys.store_code AND hdr.facility_id =  rbys.facility_id  AND hdr.req_on_store_code = rons.store_code AND DECODE(TRN_ACROSS_FACILITY_YN,'Y','X',hdr.facility_id) = DECODE(TRN_ACROSS_FACILITY_YN,'Y','X',rons.facility_id) AND hdr.item_class_code = itm.item_class_code(+) /*AND DECODE(TRN_ACROSS_FACILITY_YN,'Y', rons.facility_id,hdr.facility_id )= ?*/ AND hdr.doc_type_code = ? AND hdr.doc_no = ? AND hdr.request_status NOT IN ('L','C') AND rbys.language_id = rons.language_id  AND rbys.language_id = sy.language_id  AND rbys.language_id = ?  AND itm.language_id(+) = ? ");

		dataMap.put("SQL_ST_REQUEST_ISSUE_DTL_SELECT","SELECT /*+ index(dtl st_request_dtl_pk) */ hdr.req_on_store_code store_code, dtl.doc_srl_no, dtl.item_code, itm.short_desc item_desc, req_item_qty, iss_item_qty,DECODE(rons.qty_on_hand,0,0,pending_item_qty-committed_item_qty) pending_item_qty, committed_item_qty, uom.short_desc uom_desc, dtl.stock_item_yn,/* rbys.qty_on_hand req_by_qty_on_hand, */ rbys.min_stk_qty req_by_min_stk_qty, rbys.max_stk_qty req_by_max_stk_qty, rbys.reorder_level req_by_reorder_level,/* rons.qty_on_hand req_on_qty_on_hand,*/ sitm.curr_pack_size, rons.min_stk_qty req_on_min_stk_qty, rons.max_stk_qty req_on_max_stk_qty, rons.reorder_level req_on_reorder_level, itm.unit_cost, sitm.issue_int_qty_yn,rbys.bin_location_code to_bin_location_code , request_uom, request_uom_conv, request_uom_qty ,uom.uom_code uom_code, (SELECT  SUM(NVL(stbvw.AVAIL_QTY,0)) FROM st_batch_search_lang_view stbvw WHERE   stbvw.item_code = dtl.item_code AND stbvw.store_code =  hdr.req_by_store_code AND stbvw.language_id = itm.language_id AND itm.language_id= stbvw.lang1 AND itm.language_id= stbvw.lang2)req_by_qty_on_hand, (SELECT  SUM(NVL(stbvw.AVAIL_QTY,0)) FROM st_batch_search_lang_view stbvw WHERE   stbvw.item_code = dtl.item_code AND stbvw.store_code =  hdr.req_on_store_code AND stbvw.language_id = itm.language_id AND itm.language_id= stbvw.lang1 AND itm.language_id= stbvw.lang2)req_on_qty_on_hand FROM st_request_hdr hdr,st_request_dtl dtl, mm_item_lang_vw itm, am_uom_lang_vw uom, st_item_store rbys, st_item_store rons, st_item sitm ,ST_ACC_ENTITY_PARAM stp, mm_store_lang_vw mms WHERE dtl.doc_type_code = ? AND dtl.doc_no = ?  AND hdr.facility_id = dtl.facility_id AND hdr.doc_type_code = dtl.doc_type_code AND hdr.doc_no = dtl.doc_no  AND dtl.item_code = sitm.item_code AND dtl.item_code = itm.item_code AND itm.gen_uom_code = uom.uom_code AND hdr.req_by_store_code = rbys.store_code AND dtl.item_code = rbys.item_code  AND hdr.req_on_store_code = rons.store_code AND dtl.item_code = rons.item_code AND dtl.pending_item_qty>0 /*dtl.req_item_qty - (dtl.committed_item_qty + dtl.iss_item_qty) > 0*/ AND rons.store_code = mms.store_code AND itm.language_id = uom.language_id  AND itm.language_id = mms.language_id AND itm.language_id = ? ORDER BY doc_srl_no");

		dataMap.put("SQL_ST_REQUEST_ISSUE_SEVERITY_SELECT","SELECT NVL(qty_on_hand,0) req_on_qty_on_hand, NVL(min_stk_qty,0) req_on_min_stk_qty, NVL(max_stk_qty,0)	req_on_max_stk_qty,	NVL(reorder_level,0) req_on_reorder_level FROM st_item_store WHERE store_code =	?  AND item_code = ?");
		dataMap.put("SQL_ST_REQUEST_ISSUE_MAX_SEQ_SELECT","	SELECT NVL(MAX(seq_no),0) seq_no FROM st_issue_hdr WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?");
		dataMap.put("SQL_ST_REQUEST_SEQ_SELECT","SELECT NVL(issue_seq_no,0) issue_seq_no FROM st_request_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?");
//		dataMap.put("SQL_ST_REQUEST_SEQ_NO_UPDATE","UPDATE st_request_hdr SET issue_seq_no = ? WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?"); // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_REQUEST_SEQ_NO_UPDATE","UPDATE st_request_hdr SET issue_seq_no = ? , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?");
		dataMap.put("SQL_ST_ISSUE_HDR_INSERT","INSERT INTO st_issue_hdr	( facility_id, doc_type_code, doc_no, seq_no, doc_date,	doc_ref, fm_store_code,	to_store_code, finalized_yn, gl_interfaced_yn, trn_type, entry_completed_yn, authorized_by_id, close_req_after_issue_yn, remarks,item_class_code ,added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id , CLOSE_REQ_AFTER_AUTHORIZE) values (	? ,	? ,	? ,	? ,	TO_DATE(?, 'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ?, ? , sysdate , ? , ? , ? , sysdate , ? , ? , ? )");//modified for MO-CRF-20173//commented by Rabbani #Inc no: 33564 on 29/06/12
		//dataMap.put("SQL_ST_ISSUE_DTL_INSERT","INSERT INTO st_issue_dtl	( facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, iss_item_qty, item_unit_cost, item_cost_value,	print_label_yn,	stock_item_yn, authorized_item_qty,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id , issue_uom,issue_uom_conv,issue_uom_qty ) VALUES	 ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ? , ? , ? ,? )");
		//commented by Rabbani #Inc no: 34905 on 18/09/12
		//dataMap.put("SQL_ST_ISSUE_DTL_INSERT","INSERT INTO st_issue_dtl	( facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, iss_item_qty, item_unit_cost, item_cost_value,	print_label_yn,	stock_item_yn, authorized_item_qty,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id , issue_uom,issue_uom_conv,issue_uom_qty,remarks ) VALUES	 ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ? , ? , ? ,?,? )");
		dataMap.put("SQL_ST_ISSUE_DTL_INSERT","INSERT INTO st_issue_dtl	( facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, iss_item_qty, item_unit_cost, item_cost_value,	print_label_yn,	stock_item_yn, authorized_item_qty,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id , issue_uom,issue_uom_conv,issue_uom_qty,remarks,usage_type,close_item_yn ) VALUES	 ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ? , ? , ? ,?,?,?,? )");//MO-CRF-20173
		
		//dataMap.put("SQL_ST_ISSUE_DTL_EXP_INSERT","INSERT INTO st_issue_dtl_exp	( facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, iss_item_qty, trade_id, to_bin_location_code, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id	) VALUES  (	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	TO_DATE(?,'dd/mm/yyyy')	, ?	, ?	, ?	, ?	, sysdate ,	? ,	? ,	? ,	sysdate	, ?	, ?	 )");
		//Commented By Ganga for RUT-CRF-0079 On Aug 16th 2013
		dataMap.put("SQL_ST_ISSUE_DTL_EXP_INSERT","INSERT INTO st_issue_dtl_exp	( facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, iss_item_qty, trade_id, to_bin_location_code, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id	,barcode_id) VALUES  (	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	TO_DATE(?,'dd/mm/yyyy')	, ?	, ?	, ?	, ?	, sysdate ,	? ,	? ,	? ,	sysdate	, ?	, ?	, ? )");
		// Commented by Padmapriya On 31/1/2012
		//dataMap.put("SQL_ST_REQUEST_HDR_ISS_AUTH_UPDATE","UPDATE st_request_hdr	SET	request_status = ? , modified_by_id	= ?	, modified_date	=  sysdate ,	modified_at_ws_no =	? ,	modified_facility_id = ?  WHERE	/*facility_id	= ?	 AND */doc_type_code = ?	AND	doc_no = ?"); 
		// Added CANCELLED_BY_ID , CANCELLED_REMARKS by Padmapriya On 31/1/2012		
		dataMap.put("SQL_ST_REQUEST_HDR_ISS_AUTH_UPDATE","UPDATE st_request_hdr	SET	CANCELLED_BY_ID = ? , CANCELLED_REMARKS = ? , request_status = ? , modified_by_id	= ?	, modified_date	= sysdate ,	modified_at_ws_no =	? ,	modified_facility_id = ?, CLOSE_REQ_AFTER_AUTHORIZE = ?  WHERE	doc_type_code = ?	AND	doc_no = ?");//added CLOSE_REQ_AFTER_AUTHORIZE for MO-CRF-20173 
		dataMap.put("SQL_ST_REQUEST_DTL_ISS_AUTH_UPDATE","UPDATE st_request_dtl	SET	committed_item_qty = committed_item_qty + ?,AUTH_TRN_REMARKS_CODE=?,	 modified_by_id	= ?	, modified_date	= sysdate ,	modified_at_ws_no =	? ,	modified_facility_id = ?, CLOSE_ITEM_YN = ? , CLOSE_REMARKS_DESC = ?  WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ?	AND	doc_srl_no = ?");//added CLOSE_ITEM_YN,CLOSE_REMARKS_DESC for MO-CRF-20173  
		dataMap.put("SQL_ST_ITEM_BATCH_ISS_AUTH_UPDATE","UPDATE	st_item_batch SET committed_qty	= NVL(committed_qty,0) +  ?	, modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	?  WHERE store_code	= ?	 AND item_code = ?	AND	batch_id = ?  AND bin_location_code	= ?	 AND expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy')");
		dataMap.put("SQL_ST_ITEM_DETAIL_SELECT","SELECT itm.short_desc item_desc, uom.short_desc uom_desc,(CASE WHEN ('1'='1') THEN (SELECT SUM(avail_qty) FROM st_batch_search_view WHERE store_code= rbys.store_code AND item_code=sitm.item_code) ELSE 0 END) req_by_qty_on_hand, (CASE WHEN ('1'='1') THEN (SELECT SUM(avail_qty) FROM st_batch_search_view WHERE store_code= rons.store_code AND item_code=sitm.item_code) ELSE 0 END) req_on_qty_on_hand, sitm.curr_pack_size, rons.min_stk_qty req_on_min_stk_qty, rons.max_stk_qty req_on_max_stk_qty, rons.reorder_level req_on_reorder_level, itm.unit_cost, rons.stock_item_yn, rbys.bin_location_code to_bin_location_code, rbys.qty_on_hand req_by_qty_on_hand, rbys.max_stk_qty req_by_max_stk_qty, rbys.min_stk_qty req_by_min_stk_qty, rbys.reorder_level req_by_reorder_level, rons.qty_on_hand req_on_qty_on_hand FROM mm_item_lang_vw itm, am_uom_lang_vw uom, st_item_store rbys, st_item_store rons, st_item sitm WHERE rbys.store_code = ? AND rons.store_code = ? AND sitm.item_code = ? AND itm.gen_uom_code = uom.uom_code AND sitm.item_code = itm.item_code AND rons.item_code = sitm.item_code AND rbys.item_code = sitm.item_code AND itm.language_id = uom.language_id AND itm.language_id = ?");
		dataMap.put("SQL_ST_ITEM_BATCH_AVAIL_SELECT","SELECT SUM(qty_on_hand-NVL(committed_qty,0)) avail_qty FROM st_item_batch	WHERE store_code = ?  AND item_code= ?");
        //added by Rabbani and Ganga #inc no:27426 on 08/08/11
	    dataMap.put("SQL_ST_ISSUE_DTL_FOR_AUTH_QTY", "select authorized_item_qty from st_issue_dtl where doc_type_code = ? AND doc_no = ? AND item_code = ?  and seq_no = ? "); 
        dataMap.put("SQL_ST_REQ_DTL_PEND_QTY_SELECT","SELECT hdr.req_by_store_code, dtl.pending_item_qty,dtl.item_code FROM st_request_hdr hdr, st_request_dtl dtl WHERE hdr.doc_no = dtl.doc_no AND hdr.doc_no = ? and hdr.doc_type_code = ? and dtl.item_code = ?  ");

		//Requisition Issue	- Martin
		dataMap.put("SQL_ST_REQUISITION_ISSUE_QUERY_RESULT","	SELECT hdr.doc_type_code, sy.short_desc	doc_type_desc, hdr.doc_no, hdr.seq_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date,	hdr.fm_store_code, rbys.short_desc req_by_store_desc,hdr.to_store_code,	rons.short_desc	req_on_store_desc FROM st_issue_hdr	hdr, mm_store rbys,	mm_store rons, sy_doc_type_master sy, st_user_access_for_store uaca, st_user_access_for_store uacb WHERE hdr.doc_type_code = sy.doc_type_code AND hdr.fm_store_code=  rbys.store_code AND hdr.to_store_code	= rons.store_code AND hdr.authorized_by_id IS NOT NULL AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	(hdr.doc_date BETWEEN TO_DATE(nvl(?,'01/01/1901'),'dd/mm/yyyy')	AND	 TO_DATE(nvl(?,'31/12/3012'),'dd/mm/yyyy'))	AND	hdr.fm_store_code like ? AND hdr.to_store_code like	? AND uaca.user_id = ? AND uaca.store_code = hdr.to_store_code AND uaca.req_allowed_yn = 'Y' AND uacb.user_id =	uaca.user_id AND uacb.store_code = hdr.fm_store_code AND uacb.iss_allowed_yn = 'Y' AND hdr.trn_type	= 'ISS'");
		dataMap.put("SQL_ST_ISSUE_FROM_STORE_SELECT", "SELECT st.store_code, mm.short_desc FROM	st_user_access_for_store st, mm_store mm, sm_appl_user sm WHERE	st.store_code =	mm.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status	= 'E' AND sm.eff_status='E'	AND	st.iss_allowed_yn='Y' AND mm.facility_id =?	AND	st.user_id = ?	order by 2");
		dataMap.put("SQL_ST_ISSUE_HDR_SELECT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, hdr.seq_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.doc_ref,	hdr.fm_store_code, rbys.short_desc req_by_store_desc,hdr.to_store_code,	rons.short_desc	req_on_store_desc FROM st_issue_hdr	hdr, mm_store rbys,	mm_store rons, sy_doc_type_master sy WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.fm_store_code=	rbys.store_code	AND	hdr.to_store_code =	rons.store_code	AND	hdr.facility_id	= ?	AND	hdr.doc_type_code =	? AND hdr.doc_no = ? AND hdr.seq_no	= ?	");
		
		dataMap.put("SQL_ST_ISSUE_DTL_SELECT","SELECT  dtl.remarks, dtl.doc_srl_no, dtl.store_code, str.short_desc store_desc, dtl.item_code, itm.short_desc item_desc, itm.gen_uom_code uom_code, uom.short_desc uom_desc, DECODE (dtl.iss_item_qty, 0, dtl.authorized_item_qty,dtl.iss_item_qty ) iss_item_qty, dtl.ret_item_qty, dtl.print_label_yn, dtl.stock_item_yn, dtl.authorized_item_qty, stis1.stock_item_yn to_stock_item_yn, uom.uom_code uom_code, dtl.issue_uom, dtl.issue_uom_conv, dtl.issue_uom_qty, stis.reorder_level rol, stis.min_stk_qty msq, stis.qty_on_hand qoh, ROUND ((  DECODE (stis.qty_on_hand, 0, 0, stis.item_value) / DECODE (stis.qty_on_hand, 0, 1, stis.qty_on_hand) ), 3 ) item_unit_cost, ROUND (  (  DECODE (stis.qty_on_hand, 0, 0, stis.item_value) / DECODE (stis.qty_on_hand, 0, 1, stis.qty_on_hand) ) * (DECODE (dtl.iss_item_qty, 0, dtl.authorized_item_qty, dtl.iss_item_qty ) ), 3 ) item_cost_value, uom1.short_desc stock_uom_desc FROM st_issue_dtl dtl, st_issue_hdr hdr, mm_item_lang_vw itm, am_uom_lang_vw uom, mm_store_lang_vw str, st_item_store stis, st_item_store stis1, am_uom_lang_vw uom1 WHERE dtl.facility_id = ? AND dtl.doc_type_code = ? AND dtl.doc_no = ? AND dtl.seq_no = ? AND dtl.item_code = itm.item_code AND itm.gen_uom_code = uom.uom_code AND stis.def_issue_uom = uom1.uom_code AND dtl.store_code = str.store_code AND hdr.to_store_code = stis1.store_code AND stis.store_code = ? AND dtl.item_code = stis.item_code AND dtl.item_code = stis1.item_code AND itm.language_id = uom.language_id AND itm.language_id = uom1.language_id AND itm.language_id = str.language_id AND itm.language_id = ? AND hdr.doc_type_code = dtl.doc_type_code AND hdr.doc_no = dtl.doc_no AND hdr.facility_id = dtl.facility_id and hdr.seq_no = dtl.seq_no ORDER BY dtl.doc_srl_no ");

		dataMap.put("SQL_ST_ISSUE_DTL_EXP_SELECT","SELECT  exp.doc_srl_no, exp.store_code, exp.item_code, itm.short_desc item_desc,	exp.batch_id, exp.bin_location_code, bin.short_desc	bin_desc, TO_CHAR(exp.expiry_date_or_receipt_date,'dd/mm/yyyy')	expiry_date_or_receipt_date, exp.trade_id, am.short_name trade_name, exp.iss_item_qty, exp.ret_item_qty, exp.to_bin_location_code FROM st_issue_dtl_exp	exp, mm_item itm, mm_bin_location bin, am_trade_name am	WHERE exp.facility_id =	?  AND exp.doc_type_code = ?  AND exp.doc_no = ?  AND exp.seq_no = ?  AND exp.doc_srl_no = ?  AND exp.store_code = ?  AND exp.item_code	= ?	AND	exp.item_code =	itm.item_code AND exp.bin_location_code	= bin.bin_location_code	AND	exp.store_code = bin.store_code	AND	exp.trade_id = am.trade_id(+)");
		dataMap.put("SQL_ST_ISSUE_DTL_EXP_SELECT_ALL","SELECT  exp.doc_srl_no, exp.store_code, exp.item_code, itm.short_desc item_desc,	exp.batch_id, exp.bin_location_code, bin.short_desc	bin_desc, TO_CHAR(exp.expiry_date_or_receipt_date,'dd/mm/yyyy')	expiry_date_or_receipt_date, exp.trade_id, am.short_name trade_name, exp.iss_item_qty, exp.ret_item_qty, exp.to_bin_location_code FROM st_issue_dtl_exp	exp, mm_item itm, mm_bin_location bin, am_trade_name am	WHERE exp.facility_id =	?  AND exp.doc_type_code = ?  AND exp.doc_no = ?  AND exp.seq_no = ?  AND exp.item_code	= itm.item_code	AND	exp.bin_location_code =	bin.bin_location_code AND exp.trade_id = am.trade_id(+)");
		dataMap.put("SQL_ST_ISSUE_HDR_UPDATE","UPDATE st_issue_hdr SET doc_date =	TO_DATE(?,'dd/mm/yyyy')	,doc_ref = ? , finalized_yn =	? ,process_for_acknowledge = ?,	close_req_after_issue_yn = ? , remarks = ? , modified_by_id	= ?	, modified_date	= sysdate ,	modified_at_ws_no =	? ,	modified_facility_id = ?  WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ?	AND	seq_no = ?");
		dataMap.put("SQL_ST_ISSUE_DTL_EXP_DELETE","DELETE FROM st_issue_dtl_exp	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?  AND seq_no = ?  AND doc_srl_no = ?");
		dataMap.put("SQL_ST_ISSUE_DTL_QTY_UPDATE","UPDATE st_issue_dtl SET iss_item_qty	= NVL(?,0) , item_cost_value = ?,	modified_by_id = ?,	modified_date =	sysdate, modified_at_ws_no = ?,	modified_facility_id = ? , issue_uom = ? ,  issue_uom_conv = ? , issue_uom_qty = ?,remarks=? WHERE facility_id = ? AND doc_type_code = ? AND doc_no	= ?	AND	seq_no = ? AND doc_srl_no =	?");
		dataMap.put("SQL_ST_REQUEST_DTL_QTY_UPDATE","UPDATE	st_request_dtl SET iss_item_qty	= NVL(iss_item_qty,0) +	?, committed_item_qty =	?,	pending_item_qty = ?, modified_by_id	= ?, modified_date = sysdate, modified_at_ws_no	= ?, modified_facility_id =	? WHERE	/*facility_id	= ?	AND	*/doc_type_code =	? AND doc_no = ? AND item_code	= ?");
		dataMap.put("SQL_ST_REQUEST_STATUS_SELECT","SELECT st_req_issue_chk(?, ?, ?) STATUS	FROM DUAL");
		dataMap.put("SQL_ST_COMMITTED_QTY_SELECT","SELECT committed_item_qty, pending_item_qty FROM st_request_dtl WHERE /*facility_id = ? AND */doc_type_code = ? AND doc_no = ? AND item_code = ?");
		//dataMap.put("SQL_ST_COMMITTED_QTY_SELECT","SELECT committed_item_qty, pending_item_qty FROM st_request_dtl WHERE facility_id = ?  AND doc_no = ? AND item_code = ?");
		dataMap.put("SQL_ST_EQVL_UOM_SELECT" , "SELECT   b.eqvl_uom_code eqvl_uom_code, short_desc FROM am_uom_lang_vw a, am_uom_eqvl b WHERE eff_status = 'E' AND pur_uom_yn = 'Y' AND b.eqvl_uom_code = a.uom_code AND b.uom_code = ? AND UPPER(a.language_id) = UPPER(?)  UNION SELECT   uom_code, short_desc  FROM am_uom_lang_vw WHERE uom_code = ? AND language_id = ? ORDER BY short_desc " );

        dataMap.put("SQL_ST_EQVL_UOM_SELECT1","SELECT   b.eqvl_uom_code eqvl_uom_code, short_desc FROM am_uom_lang_vw a, am_uom_eqvl b WHERE eff_status = 'E' AND pur_uom_yn = 'Y' AND b.eqvl_uom_code = a.uom_code AND b.uom_code = ? AND a.language_id = ?  UNION SELECT   uom_code, short_desc   FROM am_uom_lang_vw WHERE uom_code = ? AND language_id = ? UNION  SELECT eqvl_uom_code, short_desc FROM MM_ITEM_UOM_DEFN a, am_uom_lang_vw b WHERE a.uom_code = ? AND a.eqvl_uom_code = b.uom_code AND a.eff_status = 'E' AND b.language_id = ? AND item_code = ? ORDER BY short_desc");

		dataMap.put("SQL_ST_REQUEST_UOM_DEFAULT" , "SELECT DEF_REQUEST_UOM FROM ST_ITEM_STORE WHERE ITEM_CODE = ? AND STORE_CODE = ? " );
		dataMap.put("SQL_ST_ISSUE_UOM_DEFAULT","SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE ITEM_CODE = ? AND STORE_CODE = ? ");
		// Issue - Query - Modify mode
		dataMap.put("SQL_ST_ISS_HDR_SELECT","SELECT HDR.DOC_TYPE_CODE, SY.SHORT_DESC DOC_TYPE_DESC, HDR.DOC_NO, HDR.SEQ_NO,TO_CHAR (HDR.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, HDR.DOC_REF,HDR.FM_STORE_CODE, RBYS.SHORT_DESC REQ_BY_STORE_DESC,HDR.TO_STORE_CODE, RONS.SHORT_DESC REQ_ON_STORE_DESC, HDR.FINALIZED_YN,HDR.GL_INTERFACED_YN, HDR.TRN_TYPE, HDR.ENTRY_COMPLETED_YN,HDR.CLOSE_REQ_AFTER_ISSUE_YN, HDR.REMARKS REMARKS_CODE, HDR.ITEM_CLASS_CODE,MM.REMARKS_DESC REMARKS FROM ST_ISSUE_HDR HDR,MM_STORE_LANG_VW RBYS,MM_STORE_LANG_VW RONS,SY_DOC_TYPE_MASTER_LANG_VW SY,MM_TRN_REMARKS_LANG_VW MM WHERE HDR.DOC_TYPE_CODE = SY.DOC_TYPE_CODE AND HDR.FM_STORE_CODE = RBYS.STORE_CODE AND HDR.TO_STORE_CODE = RONS.STORE_CODE AND HDR.FACILITY_ID = ? AND HDR.DOC_TYPE_CODE = ? AND HDR.DOC_NO = ? AND HDR.SEQ_NO = ? AND RBYS.LANGUAGE_ID = ? AND RONS.LANGUAGE_ID = ? AND SY.LANGUAGE_ID = ? AND MM.LANGUAGE_ID(+) = ? AND MM.TRN_REMARKS_CODE(+) = HDR.REMARKS");
		dataMap.put("SQL_ST_ISS_DTL_SELECT","SELECT dtl.doc_srl_no, dtl.store_code, str.short_desc store_desc, dtl.item_code,	itm.short_desc item_desc, itm.gen_uom_code uom_code, uom.short_desc	uom_desc, dtl.iss_item_qty,	 dtl.ret_item_qty, dtl.item_unit_cost, dtl.item_cost_value,	dtl.print_label_yn,	dtl.stock_item_yn,	dtl.authorized_item_qty, st.expiry_yn, bsview.avail_qty stock_available FROM st_batch_search_view bsview, st_issue_dtl dtl, st_item st, mm_item itm,	am_uom uom,	mm_store str  WHERE dtl.facility_id = ?	AND	 dtl.doc_type_code = ?	AND	dtl.doc_no = ?	AND	dtl.seq_no = ? AND st.item_code=dtl.item_code AND st.sale_uom_code=uom.uom_code AND dtl.item_code = itm.item_code AND dtl.item_code=bsview.item_code AND itm.gen_uom_code =	uom.uom_code AND dtl.store_code	= str.store_code GROUP BY dtl.doc_no, dtl.doc_srl_no, dtl.item_code");

        //Modified on 02/11/2004 by panakj for ret_item_qty null.
		//dataMap.put("SQL_ST_ISS_DTL_EXP_SELECT","SELECT  exp.doc_srl_no, exp.store_code, exp.item_code, itm.short_desc item_desc,	exp.batch_id, exp.bin_location_code, bin.short_desc	bin_desc, TO_CHAR(exp.expiry_date_or_receipt_date,'dd/mm/yyyy')	expiry_date, exp.trade_id, am.short_name trade_name, exp.iss_item_qty qty, exp.ret_item_qty, exp.to_bin_location_code, (batch_vw.avail_qty+EXP.iss_item_qty)avail_qty, nod, expiry_yn  FROM st_issue_dtl_exp exp, mm_item itm, mm_bin_location bin, am_trade_name am, st_batch_search_view batch_vw	WHERE exp.facility_id =	?  AND exp.doc_type_code = ? AND exp.doc_no = ?   AND exp.seq_no = ?  AND exp.doc_srl_no = ?  AND exp.store_code = ?  AND exp.item_code	= ? AND	exp.item_code =	itm.item_code AND exp.bin_location_code	= bin.bin_location_code	AND	exp.store_code = bin.store_code	AND	exp.trade_id = am.trade_id(+) AND batch_vw.store_code = exp.store_code AND batch_vw.item_code = exp.item_code AND batch_vw.batch_id = exp.batch_id AND batch_vw.bin_location_code = exp.bin_location_code AND batch_vw.EXPIRY_DATE = exp.expiry_date_or_receipt_date");
		//commented by ganga to added barcode_id
		//dataMap.put("SQL_ST_ISS_DTL_EXP_SELECT","SELECT  EXP.FACILITY_ID,EXP.doc_srl_no, EXP.store_code, EXP.item_code, itm.short_desc item_desc, EXP.batch_id, EXP.bin_location_code, bin.short_desc bin_desc, TO_CHAR(EXP.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date, EXP.trade_id, am.short_name trade_name, EXP.iss_item_qty qty, NVL(EXP.ret_item_qty,0) ret_item_qty, EXP.to_bin_location_code, (batch_vw.avail_qty+EXP.iss_item_qty) avail_qty, nod, expiry_yn,batch_vw.batch_status batch_status  FROM st_issue_dtl_exp EXP, mm_item_lang_vw itm, mm_bin_location_lang_vw bin, am_trade_name_lang_vw am, st_batch_search_lang_view batch_vw WHERE EXP.facility_id = ?  AND EXP.doc_type_code = ? AND EXP.doc_no = ?   AND EXP.seq_no = ?  AND EXP.doc_srl_no = ?  AND EXP.store_code = ?  AND EXP.item_code = ? AND EXP.item_code = itm.item_code AND EXP.bin_location_code = bin.bin_location_code AND EXP.store_code = bin.store_code AND EXP.trade_id = am.trade_id(+) AND batch_vw.store_code = EXP.store_code AND batch_vw.item_code = EXP.item_code AND batch_vw.batch_id = EXP.batch_id AND batch_vw.bin_location_code = EXP.bin_location_code AND batch_vw.EXPIRY_DATE = EXP.expiry_date_or_receipt_date AND itm.language_id = bin.language_id AND itm.language_id = ? AND am.language_id(+)= ? AND batch_vw.language_id =? AND batch_vw.lang1 =? AND batch_vw.lang2 = ?");
		dataMap.put("SQL_ST_ISS_DTL_EXP_SELECT","SELECT  EXP.FACILITY_ID,EXP.doc_srl_no, EXP.store_code, EXP.item_code, itm.short_desc item_desc, EXP.batch_id, EXP.bin_location_code, bin.short_desc bin_desc, TO_CHAR(EXP.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date, EXP.trade_id, am.short_name trade_name, EXP.iss_item_qty qty, NVL(EXP.ret_item_qty,0) ret_item_qty, EXP.to_bin_location_code, (batch_vw.avail_qty+EXP.iss_item_qty) avail_qty, nod, expiry_yn,batch_vw.batch_status batch_status,EXP.BARCODE_ID BARCODE_ID FROM st_issue_dtl_exp EXP, mm_item_lang_vw itm, mm_bin_location_lang_vw bin, am_trade_name_lang_vw am, st_batch_search_lang_view batch_vw WHERE EXP.facility_id = ?  AND EXP.doc_type_code = ? AND EXP.doc_no = ?   AND EXP.seq_no = ?  AND EXP.doc_srl_no = ?  AND EXP.store_code = ?  AND EXP.item_code = ? AND EXP.item_code = itm.item_code AND EXP.bin_location_code = bin.bin_location_code AND EXP.store_code = bin.store_code AND EXP.trade_id = am.trade_id(+) AND batch_vw.store_code = EXP.store_code AND batch_vw.item_code = EXP.item_code AND batch_vw.batch_id = EXP.batch_id AND batch_vw.bin_location_code = EXP.bin_location_code AND batch_vw.EXPIRY_DATE = EXP.expiry_date_or_receipt_date AND itm.language_id = bin.language_id AND itm.language_id = ? AND am.language_id(+)= ? AND batch_vw.language_id =? AND batch_vw.lang1 =? AND batch_vw.lang2 = ?");

		dataMap.put("SQL_ST_ISS_EXP_SELECT_FOR_DEL","select STORE_CODE, ITEM_CODE, BATCH_ID, BIN_LOCATION_CODE, to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE_OR_RECEIPT_DATE, ISS_ITEM_QTY from st_issue_dtl_exp where facility_id =? AND doc_type_code = ? AND doc_no =? AND seq_no = ? AND doc_srl_no = ?");
		dataMap.put("SQL_ST_DTL_EXP_SELECT_FOR_BLOCK_REL",	"SELECT store_code, item_code, batch_id, bin_location_code, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, trade_id, ISS_ITEM_QTY FROM st_issue_dtl_exp WHERE  facility_id=? AND  doc_type_code =? AND doc_no=? AND seq_no= ? AND doc_srl_no LIKE ?");
		dataMap.put("SQL_ST_ISSUE_HDR_DELETE","DELETE FROM st_issue_hdr WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ?  AND	seq_no = ? ");
		dataMap.put("SQL_ST_ISSUE_DTL_DELETE_ALL","DELETE FROM st_issue_dtl  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?  AND seq_no = ?");
		dataMap.put("SQL_ST_ISSUE_DTL_EXP_DELETE_ALL","DELETE FROM st_issue_dtl_exp  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ? AND seq_no = ?");

		//TRN DOC TYPE
		dataMap.put("SQL_SY_DOC_TYPE_MASTER_SELECT_LIST",		"SELECT a.doc_type_code, b.short_desc FROM sy_doc_type_master_dtl a, sy_doc_type_master_lang_vw b, st_acc_entity_param D WHERE a.module_id = 'ST' AND a.doc_type_code = b.doc_type_code AND ((SUBSTR (a.doc_type_code, 1, 2) = ? AND b.entity_or_facility_based = 'F' ) OR b.entity_or_facility_based = 'E') AND b.status IS NULL AND b.language_id = ? AND ((a.doc_type_code NOT IN(SELECT a.doc_type_code doc_type_code FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b,sy_acc_entity_doc_type c WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code  AND a.trn_type = 'PRQ'  AND b.status IS NULL  AND a.doc_type_code = c.doc_type_code AND b.language_id = ?) OR a.doc_type_code IN(SELECT a.doc_type_code doc_type_code FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b, sy_acc_entity_doc_type c  WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.trn_type = 'PRQ' AND b.status IS NULL  AND a.doc_type_code = c.doc_type_code AND b.language_id = ?) AND d.ACC_ENTITY_ID=? and d.INTERFACE_TO_EXTERNAL_PO_YN='Y')) order by 2, 1");
		//dataMap.put("SQL_ST_TRN_DOC_TYPE_UPDATE",				"UPDATE	st_trn_doc_type	SET	applicable_to_ph_yn=?, modified_by_id=?, modified_date=SYSDATE,	modified_at_ws_no=?, modified_facility_id=?	WHERE facility_id=?	AND	doc_type_code=?" );
		// Modified on 12/1/2005 by Janet to insert Print alert Reqd
		dataMap.put("SQL_ST_TRN_DOC_TYPE_UPDATE",				"UPDATE	st_trn_doc_type	SET	applicable_to_ph_yn=?, alert_reqd_yn=? ,modified_by_id=?, modified_date=SYSDATE,	modified_at_ws_no=?, modified_facility_id=?	WHERE facility_id=?	AND	doc_type_code=?" );
		dataMap.put("SQL_ST_TRN_DOC_TYPE_COUNT",				"SELECT	COUNT(*) FROM st_trn_doc_type WHERE	facility_id= ? AND doc_type_code=? ");
	//	dataMap.put("SQL_ST_TRN_DOC_TYPE_INSERT",				"INSERT	INTO st_trn_doc_type (facility_id, doc_type_code, trn_type,	applicable_to_ph_yn, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id) VALUES	(?,?,?,	?,?,SYSDATE, ?,?,?,	SYSDATE,?,?)" );
	// Modified on 12/1/2005 by Janet to insert Print alert Reqd
		dataMap.put("SQL_ST_TRN_DOC_TYPE_INSERT",				"INSERT	INTO st_trn_doc_type (facility_id, doc_type_code, trn_type,	applicable_to_ph_yn, added_by_id, added_date,added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id,alert_reqd_yn)VALUES	(?,?,?,	?,?,SYSDATE, ?,?,?,	SYSDATE,?,?,?)" );
		dataMap.put("SQL_ST_TRN_DOC_TYPE_QUERY_RESULT",			"SELECT ss.doc_type_code doc_type_code, am.short_desc doc_type_desc, ss.trn_type trn_type, st.long_desc trn_type_desc, applicable_to_ph_yn FROM st_trn_doc_type ss,sy_doc_type_master_lang_vw am, st_trn_type_lang_vw st,st_acc_entity_param d WHERE ss.doc_type_code = am.doc_type_code AND ss.trn_type = st.trn_type AND ss.facility_id LIKE ? AND ss.doc_type_code LIKE UPPER (?) AND UPPER (am.long_desc) LIKE UPPER (?) AND ss.trn_type LIKE UPPER (?) AND UPPER (st.long_desc) LIKE UPPER (?) AND am.language_id = st.language_id AND am.language_id = ? AND (st.trn_type not in ('PRQ') OR st.trn_type = 'PRQ'  AND d.ACC_ENTITY_ID=? and d.INTERFACE_TO_EXTERNAL_PO_YN='Y')");

	//	dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT_SINGLE",		"SELECT	trn_type, applicable_to_ph_yn FROM st_trn_doc_type WHERE facility_id = ? AND doc_type_code=?");
		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT_SINGLE",		"SELECT	trn_type, applicable_to_ph_yn,alert_reqd_yn FROM st_trn_doc_type WHERE facility_id = ? AND doc_type_code =?");
		dataMap.put("SQL_ST_TRN_TYPE_SELECT_LIST",				"select trn_type, long_desc, short_desc FROM st_trn_type_lang_vw st_trn_type,st_acc_entity_param d where trn_type not in('REQ') AND language_id = ? AND ((trn_type NOT IN('PRQ') OR trn_type = 'PRQ' AND d.ACC_ENTITY_ID=? and d.INTERFACE_TO_EXTERNAL_PO_YN='Y')) ORDER BY 2");
		
		//ENTITY PARAMETER

		dataMap.put("SQL_ST_ACC_ENTITY_PARAM_COUNT",			"SELECT	COUNT(*) total FROM	ST_ACC_ENTITY_PARAM	WHERE acc_entity_id= ? ");
		dataMap.put("SQL_ST_ACC_ENTITY_PARAM_INSERT",			"INSERT	INTO st_acc_entity_param(acc_entity_id,	curr_proc_month, curr_proc_year, bl_interface_yn, gl_interface_yn, trn_across_facility_yn, expiry_warning_days,	def_grn_doc_type_code, def_rtv_doc_type_code, def_mfg_doc_type_code, def_iss_doc_type_code,	def_ret_doc_type_code, def_urg_doc_type_code, def_tfr_doc_type_code, def_adj_doc_type_code,	def_var_doc_type_code, def_prt_doc_type_code, def_sal_doc_type_code, def_srt_doc_type_code,	def_obs_doc_type_code, def_bin_doc_type_code, def_spl_doc_type_code, age_slot_1, age_slot_2, age_slot_3, age_slot_4, age_slot_5, multi_store_issue_yn, grace_days_for_hc_pat, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id,def_stk_item_con_doc_type_code,batch_sale_price_yn,sale_price_appl_yn,lesser_sale_price_yn,po_details_applicable_yn,interface_to_external_po_yn,po_req_by)VALUES(?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	?, ?, SYSDATE, ?, ?, ?,	SYSDATE, ?,	?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_ST_ACC_ENTITY_PARAM_UPDATE",			"UPDATE	st_acc_entity_param	set	bl_interface_yn=?, gl_interface_yn=?, trn_across_facility_yn=?,	expiry_warning_days=?, def_grn_doc_type_code=?,	def_rtv_doc_type_code=?, def_mfg_doc_type_code=?, def_iss_doc_type_code=?, def_ret_doc_type_code=?,	def_urg_doc_type_code=?, def_tfr_doc_type_code=?, def_adj_doc_type_code=?, def_var_doc_type_code=?,	def_prt_doc_type_code=?, def_sal_doc_type_code=?, def_srt_doc_type_code=?, def_obs_doc_type_code=?,	def_bin_doc_type_code=?, def_spl_doc_type_code=?, age_slot_1=?,	age_slot_2=?, age_slot_3=?,	age_slot_4=?, age_slot_5=?,	multi_store_issue_yn=?,	grace_days_for_hc_pat=?, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? ,def_stk_item_con_doc_type_code = ?, batch_sale_price_yn= ?,SALE_PRICE_APPL_YN=?,LESSER_SALE_PRICE_YN = ?,po_details_applicable_yn = ?,interface_to_external_po_yn=?,po_req_by=? WHERE	acc_entity_id=?");
		dataMap.put("SQL_ST_ACC_ENTITY_PARAM_SELECT_SINGLE",	"SELECT	curr_proc_month, curr_proc_year, bl_interface_yn, gl_interface_yn, trn_across_facility_yn, expiry_warning_days,	def_grn_doc_type_code, def_rtv_doc_type_code, def_mfg_doc_type_code, def_iss_doc_type_code,	def_ret_doc_type_code, def_urg_doc_type_code, def_tfr_doc_type_code, def_adj_doc_type_code,	def_var_doc_type_code, def_prt_doc_type_code, def_sal_doc_type_code, def_srt_doc_type_code,	def_obs_doc_type_code, def_bin_doc_type_code, def_spl_doc_type_code, age_slot_1, age_slot_2, age_slot_3, age_slot_4, age_slot_5, multi_store_issue_yn, grace_days_for_hc_pat,def_stk_item_con_doc_type_code,batch_sale_price_yn,sale_price_appl_yn, lesser_sale_price_yn,po_details_applicable_yn,interface_to_external_po_yn,po_req_by FROM st_acc_entity_param WHERE	acc_entity_id=?");
		dataMap.put("SQL_ST_ACC_ENTITY_PARAM_SELECT","SELECT NVL(GL_INTERFACE_YN,'N') GL_INTERFACE_YN FROM ST_ACC_ENTITY_PARAM"); 
		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT_LIST_ENT",		"SELECT	a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b WHERE a.facility_id=? AND a.doc_type_code = b.doc_type_code AND a.trn_type =	? AND b.status is NULL AND b.entity_or_facility_based='E' AND language_id = ? ORDER	BY 2,1");
		dataMap.put("SQL_ST_ITEM_BILLING_YN" , "SELECT COUNT(*) CNT FROM SM_MODULE WHERE MODULE_ID='BL' AND INSTALL_YN='Y' " );

		//FACILITY PARAMETER

		dataMap.put("SQL_ST_FACILITY_PARAM_COUNT",			"SELECT	COUNT(*) total FROM	ST_FACILITY_PARAM WHERE	facility_id= ? AND material_group_code=? ");
		dataMap.put("SQL_ST_FACILITY_PARAM_INSERT",			"INSERT	INTO st_facility_param(facility_id,	material_group_code, curr_proc_month, curr_proc_year, def_store_code_for_rec, def_grn_doc_type_code, def_rtv_doc_type_code, def_mfg_doc_type_code,	def_iss_doc_type_code, def_ret_doc_type_code, def_urg_doc_type_code, def_tfr_doc_type_code,	def_adj_doc_type_code, def_var_doc_type_code, def_prt_doc_type_code, def_sal_doc_type_code,	def_srt_doc_type_code, def_obs_doc_type_code, def_bin_doc_type_code, def_spl_doc_type_code,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id,def_stk_item_con_doc_type_code,def_adj_remarks)	VALUES (?, ?, ?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, SYSDATE, ?, ?, ?,	SYSDATE, ?,	?,?,?)");
		dataMap.put("SQL_ST_FACILITY_PARAM_UPDATE",			"UPDATE	st_facility_param SET def_store_code_for_rec=?, def_grn_doc_type_code=?, def_rtv_doc_type_code=?, def_mfg_doc_type_code=?,	def_iss_doc_type_code=?, def_ret_doc_type_code=?, def_urg_doc_type_code=?, def_tfr_doc_type_code=?,	def_adj_doc_type_code=?, def_var_doc_type_code=?, def_prt_doc_type_code=?, def_sal_doc_type_code=?,	def_srt_doc_type_code=?, def_obs_doc_type_code=?, def_bin_doc_type_code=?, def_spl_doc_type_code=?,	modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?,def_stk_item_con_doc_type_code=?,def_adj_remarks=? where facility_id=? AND material_group_code=?");
		dataMap.put("SQL_ST_FACILITY_PARAM_SELECT_SINGLE",	"SELECT	TO_CHAR( SYSDATE, 'dd/mm/yyyy' ) sys_date,curr_proc_month, curr_proc_year, curr_phy_inv_id, curr_spec_phy_inv_id, def_store_code_for_rec,	def_grn_doc_type_code, def_rtv_doc_type_code, def_mfg_doc_type_code, def_iss_doc_type_code,	def_ret_doc_type_code, def_urg_doc_type_code, def_tfr_doc_type_code, def_adj_doc_type_code,	def_var_doc_type_code, def_prt_doc_type_code, def_sal_doc_type_code, def_srt_doc_type_code,	def_obs_doc_type_code, def_spl_doc_type_code, def_bin_doc_type_code, def_stk_item_con_doc_type_code,def_adj_remarks	FROM st_facility_param WHERE facility_id=? AND material_group_code=?");

		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT_LIST",		"SELECT	distinct a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b, st_acc_entity_param c WHERE a.facility_id=? AND a.doc_type_code = b.doc_type_code AND a.trn_type =	? AND b.status is NULL  AND b.language_id = ? ORDER BY	2,1");

		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT_LIST1",		"SELECT	distinct a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b, st_acc_entity_param c WHERE a.facility_id =? AND a.doc_type_code = b.doc_type_code AND a.trn_type =	? AND b.status is NULL  AND b.language_id = ? ORDER BY	2,1");
		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT_LIST8", "SELECT   a.doc_type_code, b.short_desc FROM st_trn_doc_type a,sy_doc_type_master_lang_vw b,sy_acc_entity_doc_type c WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.trn_type  IN ('SAL', 'SRT') AND b.status IS NULL AND a.doc_type_code = c.doc_type_code AND b.language_id = 'en'  ORDER BY 2, 1");//added by sakti
		dataMap.put("SQL_ST_TRN_ALL_ISS_DOC_TYPE_SELECT_LIST",		"SELECT	a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b WHERE a.facility_id=? AND a.doc_type_code = b.doc_type_code AND a.trn_type IN (?, ?) AND b.status is NULL AND b.language_id = ? ORDER BY	2,1");
		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT_LIST_HDR",	"SELECT   a.doc_type_code, b.short_desc FROM st_trn_doc_type a,sy_doc_type_master_lang_vw b,sy_acc_entity_doc_type c WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.trn_type = ? AND b.status IS NULL AND a.doc_type_code = c.doc_type_code AND b.language_id = ?  ORDER BY 2, 1");
		dataMap.put("SQL_ST_TRN_AUTO_DOC_TYPE_SELECT_LIST_HDR",	"SELECT	a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b , sy_acc_entity_doc_type	c WHERE	a.facility_id=?	AND	a.doc_type_code	= b.doc_type_code AND a.trn_type =?	 AND b.status is NULL AND a.doc_type_code=c.doc_type_code AND doc_num_gen_flag ='Y' AND b.language_id = ? ORDER	BY 2,1");
		dataMap.put("SQL_ST_STORE_SELECT_LIST_GRN",			"SELECT	s.store_code, m.short_desc FROM	st_store s,	mm_store_lang_vw m WHERE s.store_code=m.store_code AND m.eff_status='E'	 AND	 s.grn_allowed_yn='Y' AND m.facility_id=?  AND m.language_id = ? ORDER	BY 2");
		dataMap.put("SQL_ST_TRN_AUTO_DOC_TYPE_SELECT_LIST_HDR_CONDEMN",	"SELECT	a.doc_type_code DOC_TYPE_CODE, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b , sy_acc_entity_doc_type	c WHERE	a.facility_id=?	AND	a.doc_type_code	= b.doc_type_code AND a.trn_type =?	 AND b.status is NULL AND a.doc_type_code=c.doc_type_code AND doc_num_gen_flag ='Y' AND b.language_id = ? ORDER	BY 2,1");
		//dataMap.put("SQL_ST_STORE_SELECT_LIST_GRN",			"SELECT	s.store_code, m.short_desc FROM	st_store s,	mm_store m WHERE s.store_code=m.store_code AND m.eff_status='E'	AND	 s.grn_allowed_yn='Y' AND m.facility_id=? ORDER	BY 2");
		//Item  
		dataMap.put("SQL_ST_ITEM_SELECT_SINGLE",				"SELECT	item_code,a.short_desc,a.long_desc,sole_source_yn,ps_item_yn,gen_uom_code,c.short_desc uom_desc, DECODE(sole_source_yn,'Y',a.manufacturer_id ) manufacturer,b.short_name FROM MM_ITEM_LANG_VW a, am_manufacturer_lang_vw b,am_uom_lang_vw c	WHERE a.manufacturer_id=b.manufacturer_id(+) AND a.gen_uom_code=c.uom_code(+) AND category_type_code='ST' and item_code	= ? AND a.language_id = b.language_id(+) AND a.language_id = c.language_id(+) AND a.language_id = ?");
		//added on 27/05/2005 for supplier desc
		dataMap.put("SQL_ST_ITEM_SELECT_SINGLE_1",				"SELECT	item_code,a.short_desc,a.long_desc,sole_source_yn,ps_item_yn,gen_uom_code,c.short_desc uom_desc,d.short_name supp_short_name, DECODE(sole_source_yn,'Y',a.manufacturer_id ) manufacturer,b.short_name FROM MM_ITEM a, am_manufacturer b,am_uom c, ap_supplier d WHERE a.manufacturer_id=b.manufacturer_id(+) AND a.curr_supp_code=d.supp_code AND a.gen_uom_code=c.uom_code(+) AND category_type_code='ST' and item_code	= ?");
		dataMap.put("SQL_ST_ITEM_SELECT_INV_P",					"SELECT	item_code,a.short_desc,a.long_desc,sole_source_yn,ps_item_yn,gen_uom_code,c.short_desc uom_desc, DECODE(sole_source_yn,'Y',a.manufacturer_id ) manufacturer,b.short_name FROM MM_ITEM_LANG_VW a, am_manufacturer_lang_vw b,am_uom_lang_vw c	WHERE a.manufacturer_id=b.manufacturer_id(+) AND a.gen_uom_code=c.uom_code(+) AND ps_item_yn='Y' and category_type_code='ST' AND item_code = ? AND a.language_id = b.language_id(+) AND a.language_id = c.language_id(+) AND a.language_id = ? ");
//		Added on 27/05/2005 for supplier
		dataMap.put("SQL_ST_ITEM_SELECT_INV_P_1",					"SELECT	item_code,a.short_desc,a.long_desc,sole_source_yn,ps_item_yn,gen_uom_code,c.short_desc uom_desc,d.short_name supp_short_name, DECODE(sole_source_yn,'Y',a.manufacturer_id ) manufacturer,b.short_name FROM MM_ITEM a, am_manufacturer b,am_uom c,ap_supplier d	WHERE a.manufacturer_id=b.manufacturer_id(+) AND a.curr_supp_code=d.supp_code AND a.gen_uom_code=c.uom_code(+) AND ps_item_yn='Y' and category_type_code='ST' AND item_code = ? ");
		//modified on 29/04/2005 to exclude item code in St in the lookup
		dataMap.put("SQL_ST_ITEM_SELECT_INV_P_LOOKUP",			"SELECT item_code code,  short_desc  description  FROM  MM_ITEM_LANG_VW  A   WHERE  eff_status= 'E'    AND    language_id  LIKE  ?  AND  ps_item_yn='Y'  AND  category_type_code='ST'  AND   UPPER( item_code)   LIKE                   UPPER(?)  AND  UPPER(short_desc)  LIKE	 UPPER(?) AND  NOT EXISTS  ( SELECT  ITEM_CODE  FROM ST_ITEM B WHERE A.ITEM_CODE=B.ITEM_CODE) ORDER BY 2");
		dataMap.put("SQL_ST_ITEM_SELECT_SINGLE_LOOKUP",			"SELECT item_code code,  short_desc  description  FROM  MM_ITEM_LANG_VW  A   WHERE  eff_status= 'E'    AND    language_id  LIKE  ?   AND  category_type_code='ST'  AND   UPPER( item_code)   LIKE                   UPPER(?)  AND  UPPER(short_desc)  LIKE	 UPPER(?) AND  NOT EXISTS  ( SELECT  ITEM_CODE  FROM ST_ITEM B WHERE A.ITEM_CODE=B.ITEM_CODE) ORDER BY 2");
		//dataMap.put("SQL_ST_ITEM_SELECT_SINGLE_LOOKUP",			"SELECT item_code code, short_desc description  FROM MM_ITEM_LANG_VW  A WHERE eff_status	= 'E'  AND  A.language_id  LIKE  ?  AND category_type_code='ST' and item_Code  LIKE	UPPER(?) AND UPPER(short_desc) LIKE	UPPER(?)  and NOT EXISTS  (select item_code  from ST_ITEM B WHERE A.ITEM_CODE=B.ITEM_CODE) ORDER BY 2");
		//end of modification
		dataMap.put("SQL_ST_ITEM_EXISTS",						"SELECT	count(*) count FROM	st_item	WHERE item_code	= ?	" );
		dataMap.put("SQL_MM_TRN_REM_SELECT",		"SELECT REMARKS_DESC FROM   MM_TRN_REMARKS_LANG_VW MM_TRN_REMARKS WHERE EFF_STATUS = 'E' AND TRN_REMARKS_CODE= ? AND LANGUAGE_ID = ?" );
		dataMap.put("SQL_ST_ITEM_INSERT",						"INSERT	INTO st_item (item_code, medical_item_yn,drug_item_yn,expiry_yn,trade_id_applicable_yn,mfg_item_yn,abc_class_code,insurance_item_yn,autoclaveable_yn,consignment_item_yn,refund_allow_yn,use_after_expiry_yn,label_reqd_yn,issue_int_qty_yn,batch_id_applicable_yn,min_sale_qty,mfg_base_qty,phy_inv_type,phy_inv_count_per_year,curr_pack_size,sterile_type,machine_code,spare_part_id,sale_uom_code,reorder_level,reorder_qty,min_stk_qty,max_stk_qty,lead_days,min_stock_days,buffer_perc,re_orderable_yn,added_by_id,added_date, added_at_ws_no, added_facility_id,modified_by_id,modified_date ,	modified_at_ws_no,modified_facility_id,special_req_item_yn ,repacking_group_code,repack_unit_uom,RETURN_ALLOWED_YN,IMAGE_FILE_NAME) VALUES	 ( ? , ? , ? , ? , ? , ? , ? , ?, ?	, ?	, ?	, ?	, ? , ?	, ?, ? , ? , ? , ? , ? , ? , ? ,? ,	? ,	? ,	? ,	? ,	? ,	? ,	?, ?, ?	, ?, SYSDATE , ? , ? ,?	,SYSDATE , ? , ?, ?, ?, ?, ?,?)");
		dataMap.put("SQL_ST_ITEM_UPDATE", "UPDATE	st_item	SET	medical_item_yn	= ?	, drug_item_yn = ? , expiry_yn = ? , trade_id_applicable_yn	= ?	, mfg_item_yn =	? ,	abc_class_code = ? , insurance_item_yn = ? , autoclaveable_yn =	? ,	consignment_item_yn	= ?	, refund_allow_yn =	? ,	use_after_expiry_yn	= ?	, label_reqd_yn	= ?	, issue_int_qty_yn = ? , batch_id_applicable_yn	= ?	 , min_sale_qty	= ?	, phy_inv_type= ?,  phy_inv_count_per_year = ? , curr_pack_size =	?  , sterile_type =	? ,	machine_code = ? , spare_part_id = ?  ,	sale_uom_code =	? ,	reorder_level =	? ,	reorder_qty	= ?	 , min_stk_qty = ? , max_stk_qty = ? , lead_days = ?  ,	min_stock_days = ? , buffer_perc = ? , re_orderable_yn = ?	, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	? ,special_req_item_yn = ?,repacking_group_code = ? ,repack_unit_uom = ?,RETURN_ALLOWED_YN = ?,IMAGE_FILE_NAME = ? WHERE	item_code = ?") ;
		dataMap.put("SQL_ST_AM_UOM_SELECT",						"SELECT	uom_code,short_desc	FROM Am_uom_lang_vw Am_uom	WHERE eff_status='E' and sale_uom_yn='Y' AND language_id = ? order by short_desc");
		dataMap.put("SQL_ST_AM_UOM_EQL_CONVERSION_SELECT",		"select	eqvl_value from	am_uom_eqvl	where uom_code =? and eqvl_uom_code=?");

		dataMap.put("SQL_ST_AM_UOM_EQL_CONVERSION_SELECT1","SELECT	eqvl_value FROM	am_uom_eqvl	WHERE uom_code =? AND eqvl_uom_code=? UNION  SELECT eqvl_value FROM	MM_ITEM_UOM_DEFN WHERE uom_code =? AND eqvl_uom_code=? AND item_code =? union select 1 from dual where ?=? ");

		dataMap.put("SQL_ST_MACHINE_SELECT",					"SELECT	machine_code,machine_name FROM st_machine_lang_vw st_machine where	eff_status='E' AND language_id = ?");
		dataMap.put("SQL_ST_MACHINE_SELECT1",					"SELECT	machine_code,machine_name FROM st_machine_lang_vw st_machine where	eff_status='E' and  added_facility_id  = ? AND language_id = ?");
		dataMap.put("SQL_ST_STERILE_VALIDATE_SELECT",			"SELECT	sterile_type FROM SS_STERILIZATION_TYPE	WHERE sterile_type = ?");
		dataMap.put("SQL_ST_SS_MODULE_SEARCH",					"SELECT	count(*) total FROM	sm_modules_facility	WHERE module_id='SS' AND operational_yn='Y'	and	facility_id=?");
		dataMap.put("SQL_ST_STERILE_SELECT",					"SELECT	sterile_type code,short_desc description FROM SS_STERILIZATION_TYPE	WHERE eff_status = 'E' AND sterile_type	LIKE UPPER(?) AND upper(short_desc)	LIKE upper(?) ORDER BY short_desc");
		dataMap.put("SQL_ST_STERILE_SELECT_FOR_REPORT",			"SELECT	sterile_type code,short_desc description FROM SS_STERILIZATION_TYPE	WHERE UPPER(sterile_type)	LIKE UPPER(?) AND upper(short_desc)	LIKE upper(?) ORDER BY short_desc");
		dataMap.put("SQL_ST_LOAD_QUERY",						"SELECT	item_code,medical_item_yn,drug_item_yn,expiry_yn,batch_id_applicable_yn,trade_id_applicable_yn,sale_uom_code,min_sale_qty,mfg_item_yn,mfg_base_qty,phy_inv_type,phy_inv_count_per_year,last_phy_inv_date,abc_class_code,last_issue_date,last_transfer_date,last_mfg_date,curr_pack_size,insurance_item_yn,autoclaveable_yn,sterile_type,consignment_item_yn,refund_allow_yn,use_after_expiry_yn,label_reqd_yn,machine_code,issue_int_qty_yn,spare_part_id,reorder_level,reorder_qty,min_stk_qty,max_stk_qty,lead_days,min_stock_days,buffer_perc,re_orderable_yn,special_req_item_yn,repacking_group_code,repack_unit_uom,return_allowed_yn,image_file_name FROM	st_item	WHERE item_code=?");
		dataMap.put("SQL_ST_ITEM_CHECK",						"SELECT	item_code FROM st_item WHERE item_code=?");
		dataMap.put("SQL_ST_STOCK_ITEM_YN",						"select stock_item_yn from st_item_store where  item_code=? AND store_code=?");
		dataMap.put("SQL_ST_GET_SUPPLIER",						"select b.short_name SUPP_SHORT_NAME from mm_item a, ap_supplier_lang_vw b where a.curr_supp_code=b.supp_code and a.item_code=? AND b.language_id = ?");
		dataMap.put("SQL_ST_BATCH_CONTROL_SELECT_COUNT",		"select count(*) total from st_batch_control where  item_code=?");

		//ADDED ON 23.11.2004
		dataMap.put("SQL_ST_ITEM_REPACKING_UNIT_SELECT_LIST", "SELECT repacking_group_code, short_desc FROM st_repacking_group_lang_vw st_repacking_group WHERE  eff_status ='E' and facility_id = ? AND language_id = ? order by short_desc");
		dataMap.put("SQL_ST_ITEM_EQVL_UOM_SELECT_LIST", "select b.eqvl_uom_code eqvl_uom_code,short_desc from am_uom_lang_vw a, am_uom_eqvl b where eff_status='E' and pur_uom_yn='Y' and b.eqvl_uom_code=a.uom_code and b.uom_code = ? AND a.language_id = ? order by short_desc");
	//	dataMap.put("SQL_ST_ITEM_UOM_SELECT_LIST", "select b.uom_code eqvl_uom_code,short_desc from am_uom a, am_uom_eqvl b where eff_status='E' and pur_uom_yn='Y' and b.uom_code=a.uom_code and b.eqvl_uom_code = ? union  select uom_code,short_desc from am_uom where uom_code = ?  order by short_desc ");
	
		dataMap.put("SQL_ST_ITEM_UOM_SELECT_LIST", "select b.uom_code eqvl_uom_code,short_desc from am_uom_lang_vw a, am_uom_eqvl b where eff_status='E' and b.uom_code=a.uom_code and b.eqvl_uom_code = ? AND a.language_id = ? union  select uom_code,short_desc from am_uom_lang_vw am_uom where uom_code = ?  AND language_id = ? order by short_desc");


		//Store
		dataMap.put("SQL_ST_STORE_LOOKUP",	"SELECT	  st.store_code code,  mm.short_desc description FROM mm_store_lang_vw mm, st_store st   WHERE  mm.facility_id    LIKE(?)	 AND 	 UPPER(st.store_code)   LIKE  	UPPER(?)  AND  UPPER(mm.short_desc)  LIKE	 UPPER(?)   AND  mm.eff_status='E'   AND   mm.store_code= st.store_code   AND mm.language_id = ");
		dataMap.put("SQL_ST_STORE_LOOKUP_LANG",	"SELECT st.store_code code, mm.short_desc description FROM mm_store_lang_vw mm, st_store st,st_user_access_for_store uas WHERE mm.facility_id LIKE (?) AND mm.eff_status = 'E' AND UPPER (st.store_code) LIKE UPPER (?)   AND UPPER (mm.short_desc) LIKE UPPER (?)  AND mm.store_code = st.store_code  and st.store_code = uas.store_code  AND uas.var_allowed_yn = 'Y'  ");
		dataMap.put("SQL_ST_STORE_LOOKUP_LANG_TEMP",	"SELECT     st.store_code code,  mm.short_desc  description     FROM  mm_store_lang_vw      mm, st_store st   WHERE     mm.language_id = ?  AND   mm.facility_id    LIKE(?)    	AND  mm.eff_status ='E'	  AND    UPPER(st.store_code)    LIKE	      UPPER(?)  AND  UPPER(mm.short_desc)   LIKE	    UPPER(?)    AND      mm.store_code=st.store_code   ORDER BY 2");
		dataMap.put("SQL_ST_STORE_LOOKUP_STK",	"SELECT	st.store_code code, mm.short_desc description FROM mm_store mm,st_store st   WHERE  mm.facility_id  LIKE(?)	AND	 UPPER(st.store_code) LIKE	UPPER(?) AND UPPER(mm.short_desc) LIKE	UPPER(?)  AND mm.eff_status='E' AND st.store_type_flag <> 'N' AND mm.store_code=st.store_code ORDER BY 2");
		dataMap.put("SQL_ST_STORE_LOOKUP_FOR_REPORT",	"SELECT     st.store_code code,  mm.short_desc  description     FROM  mm_store_lang_vw      mm, st_store st , st_acc_entity_param  WHERE    mm.eff_status ='E'  AND  language_id  like  ?   AND  mm.facility_id    LIKE decode(TRN_ACROSS_FACILITY_YN, 'Y',mm.facility_id,? )   	 	  AND    UPPER(st.store_code)    LIKE	      UPPER(?)  AND  UPPER(mm.short_desc)   LIKE	    UPPER(?)    AND      mm.store_code=st.store_code   ORDER BY 2");
		//Added on 26.05.2005
		dataMap.put("SQL_MM_STORE_LOOKUP",	"SELECT store_code code,short_desc description FROM mm_store a WHERE facility_id  LIKE(?) AND UPPER(store_code) LIKE UPPER(?) AND UPPER(short_desc) LIKE	UPPER(?) AND eff_status='E' and not exists (select store_code from st_store b where a.store_code=b.store_code) ORDER BY short_desc");
		dataMap.put("SQL_ST_STORE_CODE_VALIDATE",	"SELECT	store_code,short_desc,external_yn  FROM	mm_store  WHERE	 facility_id  LIKE(?)  AND	UPPER(store_code) LIKE UPPER(?)	AND	eff_status='E'	AND	STORE_CODE NOT IN (SELECT STORE_CODE FROM ST_STORE WHERE  UPPER(store_code)	LIKE UPPER(?)) ");
		dataMap.put("SQL_ST_STORE_TYPE_VALIDATE",	"select	sum(qty_on_hand)  qty_on_hand from st_item_batch where store_code	  =? ");
		dataMap.put("SQL_ST_PARENT_STORE_SELECT_LIST","SELECT a.store_code,	b.short_desc FROM st_store a, mm_store_lang_vw b where a.store_type_flag!='N'  and a.store_code	<> ? and a.store_code=b.store_code AND b.language_id = ? ORDER BY	2");
		dataMap.put("SQL_ST_STORE_DEPT","  SELECT am.short_desc	department FROM	  mm_store mm, am_dept am	WHERE mm.dept_code=am.dept_code	AND	mm.facility_id=? AND mm.store_code=? ");
		dataMap.put("SQL_ST_STORE_COUNT","SELECT COUNT(*) FROM st_store	WHERE store_code= ?	");
		//dataMap.put("SQL_ST_STORE_INSERT","INSERT INTO ST_STORE(STORE_CODE, STORE_TYPE_FLAG,  MEDICAL_ITEM_YN,NONMEDICAL_ITEM_YN,	REORDER_FREQ_DAYS, CHK_STK_LVL_FOR_PUR_YN, GRN_ALLOWED_YN	 , RTV_ALLOWED_YN,MFG_ALLOWED_YN,REQ_ALLOWED_YN, ISS_ALLOWED_YN, URG_ALLOWED_YN,RET_ALLOWED_YN, TFR_ALLOWED_YN, ADJ_ALLOWED_YN, VAR_ALLOWED_YN, PRT_ALLOWED_YN, SAL_ALLOWED_YN, SRT_ALLOWED_YN, SPLIT_BATCH_ALLOWED_YN, BIN_CHANGE_ALLOWED_YN,PARENT_STORE_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, OBS_ALLOWED_YN,AUTHORIZE_SPECIAL_REQ_YN,STK_ITEM_CON_ALLOWED_YN,ALERT_FOR_PRINT_PICKSLIP_YN,OP_SALE_APPL_YN,IP_SALE_APPL_YN,REF_SALE_APPL_YN,DC_SALE_APPL_YN, EM_SALE_APPL_YN, DIRECT_SALE_APPL_YN,PRQ_ALLOWED_YN,DFLT_BIN_LOCATION_CODE,CNDMN_EXP_BTCH_ALLOWED_YN) VALUES(?, ?, ?, ?,	?, ?, ?, ?,?, ?, ?, ?,?, ?, ?, ?,?, ?, ?, ?,?, ?, ?,SYSDATE, ?,?, ?, SYSDATE, ?, ?,?,? ,?,?,?,?,?,?,?,?,?,?,?)" );
		
		//Added by Rabbani #Bru-HIMS-CRF-112(INC no:30071) on 16-AUG-2013 Starts
		//dataMap.put("SQL_ST_STORE_INSERT","INSERT INTO ST_STORE(STORE_CODE, STORE_TYPE_FLAG,  MEDICAL_ITEM_YN,NONMEDICAL_ITEM_YN,	REORDER_FREQ_DAYS, CHK_STK_LVL_FOR_PUR_YN, GRN_ALLOWED_YN	 , RTV_ALLOWED_YN,MFG_ALLOWED_YN,REQ_ALLOWED_YN, ISS_ALLOWED_YN, URG_ALLOWED_YN,RET_ALLOWED_YN, TFR_ALLOWED_YN, ADJ_ALLOWED_YN, VAR_ALLOWED_YN, PRT_ALLOWED_YN, SAL_ALLOWED_YN, SRT_ALLOWED_YN, SPLIT_BATCH_ALLOWED_YN, BIN_CHANGE_ALLOWED_YN,PARENT_STORE_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, OBS_ALLOWED_YN,AUTHORIZE_SPECIAL_REQ_YN,STK_ITEM_CON_ALLOWED_YN,ALERT_FOR_PRINT_PICKSLIP_YN,OP_SALE_APPL_YN,IP_SALE_APPL_YN,REF_SALE_APPL_YN,DC_SALE_APPL_YN, EM_SALE_APPL_YN, DIRECT_SALE_APPL_YN,PRQ_ALLOWED_YN,DFLT_BIN_LOCATION_CODE,CNDMN_EXP_BTCH_ALLOWED_YN,ISS_ACK_REQ_YN, URG_ACK_REQ_YN ,RET_ACK_REQ_YN,TFR_ACK_REQ_YN) VALUES(?, ?, ?, ?,	?, ?, ?, ?,?, ?, ?, ?,?, ?, ?, ?,?, ?, ?, ?,?, ?, ?,SYSDATE, ?,?, ?, SYSDATE, ?, ?,?,? ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)" );
		//Modified by B.Badmavathi on 21/04/2016 against PMG2015-CRF-INT-ST-0001
		dataMap.put("SQL_ST_STORE_INSERT","INSERT INTO st_store (store_code, store_type_flag, medical_item_yn, nonmedical_item_yn, reorder_freq_days, chk_stk_lvl_for_pur_yn, grn_allowed_yn, rtv_allowed_yn, mfg_allowed_yn, req_allowed_yn, iss_allowed_yn, urg_allowed_yn, ret_allowed_yn, tfr_allowed_yn, adj_allowed_yn, var_allowed_yn, prt_allowed_yn, sal_allowed_yn, srt_allowed_yn, split_batch_allowed_yn, bin_change_allowed_yn, parent_store_code, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id, obs_allowed_yn, authorize_special_req_yn, stk_item_con_allowed_yn, alert_for_print_pickslip_yn, op_sale_appl_yn, ip_sale_appl_yn, ref_sale_appl_yn, dc_sale_appl_yn, em_sale_appl_yn, direct_sale_appl_yn, prq_allowed_yn, dflt_bin_location_code, cndmn_exp_btch_allowed_yn, iss_ack_req_yn, urg_ack_req_yn, ret_ack_req_yn, tfr_ack_req_yn, authorize_at_issue_allowed_yn, auto_rol_calc_flag, cons_period,ASSOC_INTF_ITEMS_TO_STORE_YN , RECORDS_PER_TRN_URG, RECORDS_PER_TRN_ISS , RECORDS_PER_TRN_RET, UOM_FOR_PHIS_INTERFACE) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,? , ?,?,?,? )" );// Modified for IN:071344 ,Modified for IN:072963,MO-CRF-20176,Modified for MMS-DM-CRF-0230 US002
		
		//dataMap.put("SQL_ST_STORE_UPDATE","UPDATE ST_STORE SET	STORE_TYPE_FLAG=?, MEDICAL_ITEM_YN   =?, NONMEDICAL_ITEM_YN=?, REORDER_FREQ_DAYS=?, CHK_STK_LVL_FOR_PUR_YN=?,GRN_ALLOWED_YN=?, RTV_ALLOWED_YN=?,	 MFG_ALLOWED_YN=?, REQ_ALLOWED_YN=?, ISS_ALLOWED_YN=?, URG_ALLOWED_YN=?, RET_ALLOWED_YN=?, TFR_ALLOWED_YN=?, ADJ_ALLOWED_YN=?, VAR_ALLOWED_YN=?, PRT_ALLOWED_YN=?, SAL_ALLOWED_YN=?, SRT_ALLOWED_YN=?, SPLIT_BATCH_ALLOWED_YN=?, BIN_CHANGE_ALLOWED_YN=?, OBS_ALLOWED_YN=?,PARENT_STORE_CODE=?,MODIFIED_BY_ID=?, MODIFIED_DATE= SYSDATE, MODIFIED_AT_WS_NO= ?, MODIFIED_FACILITY_ID= ?,AUTHORIZE_SPECIAL_REQ_YN = ? , STK_ITEM_CON_ALLOWED_YN = ? ,ALERT_FOR_PRINT_PICKSLIP_YN=?,OP_SALE_APPL_YN = ?,IP_SALE_APPL_YN = ?,REF_SALE_APPL_YN = ?,DC_SALE_APPL_YN=?, EM_SALE_APPL_YN=?, DIRECT_SALE_APPL_YN=?,PRQ_ALLOWED_YN=?,DFLT_BIN_LOCATION_CODE=?,CNDMN_EXP_BTCH_ALLOWED_YN=? WHERE STORE_CODE =	?");
		//Added by Rabbani #Bru-HIMS-CRF-112(INC no:30071) on 16-AUG-2013  
		//dataMap.put("SQL_ST_STORE_UPDATE","UPDATE ST_STORE SET	STORE_TYPE_FLAG=?, MEDICAL_ITEM_YN   =?, NONMEDICAL_ITEM_YN=?, REORDER_FREQ_DAYS=?, CHK_STK_LVL_FOR_PUR_YN=?,GRN_ALLOWED_YN=?, RTV_ALLOWED_YN=?,	 MFG_ALLOWED_YN=?, REQ_ALLOWED_YN=?, ISS_ALLOWED_YN=?, URG_ALLOWED_YN=?, RET_ALLOWED_YN=?, TFR_ALLOWED_YN=?, ADJ_ALLOWED_YN=?, VAR_ALLOWED_YN=?, PRT_ALLOWED_YN=?, SAL_ALLOWED_YN=?, SRT_ALLOWED_YN=?, SPLIT_BATCH_ALLOWED_YN=?, BIN_CHANGE_ALLOWED_YN=?, OBS_ALLOWED_YN=?,PARENT_STORE_CODE=?,MODIFIED_BY_ID=?, MODIFIED_DATE= SYSDATE, MODIFIED_AT_WS_NO= ?, MODIFIED_FACILITY_ID= ?,AUTHORIZE_SPECIAL_REQ_YN = ? , STK_ITEM_CON_ALLOWED_YN = ? ,ALERT_FOR_PRINT_PICKSLIP_YN=?,OP_SALE_APPL_YN = ?,IP_SALE_APPL_YN = ?,REF_SALE_APPL_YN = ?,DC_SALE_APPL_YN=?, EM_SALE_APPL_YN=?, DIRECT_SALE_APPL_YN=?, PRQ_ALLOWED_YN=?, DFLT_BIN_LOCATION_CODE=?, CNDMN_EXP_BTCH_ALLOWED_YN=?, ISS_ACK_REQ_YN = ?,URG_ACK_REQ_YN = ? ,RET_ACK_REQ_YN = ? ,TFR_ACK_REQ_YN = ? WHERE STORE_CODE =	?");
		//Modified by B.Badmavathi on 21/04/2016 against PMG2015-CRF-INT-ST-0001
		dataMap.put("SQL_ST_STORE_UPDATE","UPDATE st_store SET store_type_flag = ?, medical_item_yn = ?, nonmedical_item_yn = ?, reorder_freq_days = ?, chk_stk_lvl_for_pur_yn = ?, grn_allowed_yn = ?, rtv_allowed_yn = ?, mfg_allowed_yn = ?, req_allowed_yn = ?, iss_allowed_yn = ?, urg_allowed_yn = ?, ret_allowed_yn = ?, tfr_allowed_yn = ?, adj_allowed_yn = ?, var_allowed_yn = ?, prt_allowed_yn = ?, sal_allowed_yn = ?, srt_allowed_yn = ?, split_batch_allowed_yn = ?, bin_change_allowed_yn = ?, obs_allowed_yn = ?, parent_store_code = ?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?, modified_facility_id = ?, authorize_special_req_yn = ?, stk_item_con_allowed_yn = ?, alert_for_print_pickslip_yn = ?, op_sale_appl_yn = ?, ip_sale_appl_yn = ?, ref_sale_appl_yn = ?, dc_sale_appl_yn = ?, em_sale_appl_yn = ?, direct_sale_appl_yn = ?, prq_allowed_yn = ?, dflt_bin_location_code = ?, cndmn_exp_btch_allowed_yn = ?, iss_ack_req_yn = ?, urg_ack_req_yn = ?, ret_ack_req_yn = ?, tfr_ack_req_yn = ?, authorize_at_issue_allowed_yn = ?, AUTO_ROL_CALC_FLAG = ?, CONS_PERIOD = ?,ASSOC_INTF_ITEMS_TO_STORE_YN=?, RECORDS_PER_TRN_URG = ? , RECORDS_PER_TRN_ISS = ? , RECORDS_PER_TRN_RET = ?, UOM_FOR_PHIS_INTERFACE=?  WHERE store_code = ?");// Modified for IN:071344,Modified for IN:072963,MO-CRF-20176, Modified for MMS-DM-CRF-0230 US002

		//dataMap.put("SQL_ST_STORE_SELECT_SINGLE","SELECT   A.STORE_CODE, A.STORE_TYPE_FLAG,A.MEDICAL_ITEM_YN , A.NONMEDICAL_ITEM_YN,A.REORDER_FREQ_DAYS, A.CHK_STK_LVL_FOR_PUR_YN, A.GRN_ALLOWED_YN, A.RTV_ALLOWED_YN, A.MFG_ALLOWED_YN,  A.REQ_ALLOWED_YN,	A.ISS_ALLOWED_YN,  A.URG_ALLOWED_YN, A.RET_ALLOWED_YN,	A.TFR_ALLOWED_YN ,A.ADJ_ALLOWED_YN,	 A.VAR_ALLOWED_YN, A.PRT_ALLOWED_YN,  A.SAL_ALLOWED_YN,	A.SRT_ALLOWED_YN, A.SPLIT_BATCH_ALLOWED_YN,   A.BIN_CHANGE_ALLOWED_YN,	A.OBS_ALLOWED_YN,A.PARENT_STORE_CODE,B.SHORT_DESC STORE_DESC, C.SHORT_DESC DEPT_DESC, B.EXTERNAL_YN, A.AUTHORIZE_SPECIAL_REQ_YN, A.STK_ITEM_CON_ALLOWED_YN,A.ALERT_FOR_PRINT_PICKSLIP_YN,OP_SALE_APPL_YN, IP_SALE_APPL_YN, REF_SALE_APPL_YN,DC_SALE_APPL_YN, EM_SALE_APPL_YN, DIRECT_SALE_APPL_YN,A.PRQ_ALLOWED_YN,A.DFLT_BIN_LOCATION_CODE BIN_LOC_CODE,CNDMN_EXP_BTCH_ALLOWED_YN  FROM ST_STORE A,MM_STORE_LANG_VW B,	AM_DEPT_LANG_VW	C WHERE	A.STORE_CODE = ? AND B.FACILITY_ID=? AND A.STORE_CODE=B.STORE_CODE AND B.DEPT_CODE=C.DEPT_CODE(+) AND B.LANGUAGE_ID = C.LANGUAGE_ID(+) AND B.LANGUAGE_ID = ?");
		//Added by Rabbani #Bru-HIMS-CRF-112(INC no:30071) on 16-AUG-2013  
		//dataMap.put("SQL_ST_STORE_SELECT_SINGLE","SELECT   A.STORE_CODE, A.STORE_TYPE_FLAG,A.MEDICAL_ITEM_YN , A.NONMEDICAL_ITEM_YN,A.REORDER_FREQ_DAYS, A.CHK_STK_LVL_FOR_PUR_YN, A.GRN_ALLOWED_YN, A.RTV_ALLOWED_YN, A.MFG_ALLOWED_YN,  A.REQ_ALLOWED_YN,	A.ISS_ALLOWED_YN,  A.URG_ALLOWED_YN, A.RET_ALLOWED_YN,	A.TFR_ALLOWED_YN ,A.ADJ_ALLOWED_YN,	 A.VAR_ALLOWED_YN, A.PRT_ALLOWED_YN,  A.SAL_ALLOWED_YN,	A.SRT_ALLOWED_YN, A.SPLIT_BATCH_ALLOWED_YN,   A.BIN_CHANGE_ALLOWED_YN,	A.OBS_ALLOWED_YN,A.PARENT_STORE_CODE,B.SHORT_DESC STORE_DESC, C.SHORT_DESC DEPT_DESC, B.EXTERNAL_YN, A.AUTHORIZE_SPECIAL_REQ_YN, A.STK_ITEM_CON_ALLOWED_YN,A.ALERT_FOR_PRINT_PICKSLIP_YN,OP_SALE_APPL_YN, IP_SALE_APPL_YN, REF_SALE_APPL_YN,DC_SALE_APPL_YN, EM_SALE_APPL_YN, DIRECT_SALE_APPL_YN,A.PRQ_ALLOWED_YN,A.DFLT_BIN_LOCATION_CODE BIN_LOC_CODE,CNDMN_EXP_BTCH_ALLOWED_YN,ISS_ACK_REQ_YN, URG_ACK_REQ_YN ,RET_ACK_REQ_YN,TFR_ACK_REQ_YN  FROM ST_STORE A,MM_STORE_LANG_VW B,	AM_DEPT_LANG_VW	C WHERE	A.STORE_CODE = ? AND B.FACILITY_ID=? AND A.STORE_CODE=B.STORE_CODE AND B.DEPT_CODE=C.DEPT_CODE(+) AND B.LANGUAGE_ID = C.LANGUAGE_ID(+) AND B.LANGUAGE_ID = ?");
		//Modified by B.Badmavathi on 21/04/2016 against PMG2015-CRF-INT-ST-0001
		dataMap.put("SQL_ST_STORE_SELECT_SINGLE","SELECT a.store_code, a.store_type_flag, a.medical_item_yn, a.nonmedical_item_yn, a.reorder_freq_days, a.chk_stk_lvl_for_pur_yn, a.grn_allowed_yn, a.rtv_allowed_yn, a.mfg_allowed_yn, a.req_allowed_yn, a.iss_allowed_yn, a.urg_allowed_yn, a.ret_allowed_yn, a.tfr_allowed_yn, a.adj_allowed_yn, a.var_allowed_yn, a.prt_allowed_yn, a.sal_allowed_yn, a.srt_allowed_yn, a.split_batch_allowed_yn, a.bin_change_allowed_yn, a.obs_allowed_yn, a.parent_store_code, b.short_desc store_desc, c.short_desc dept_desc, b.external_yn, a.authorize_special_req_yn, a.stk_item_con_allowed_yn, a.alert_for_print_pickslip_yn, op_sale_appl_yn, ip_sale_appl_yn, ref_sale_appl_yn, dc_sale_appl_yn, em_sale_appl_yn, direct_sale_appl_yn, a.prq_allowed_yn, a.dflt_bin_location_code bin_loc_code, cndmn_exp_btch_allowed_yn, iss_ack_req_yn, urg_ack_req_yn, ret_ack_req_yn, tfr_ack_req_yn, authorize_at_issue_allowed_yn,A.AUTO_ROL_CALC_FLAG,A.CONS_PERIOD,A.ASSOC_INTF_ITEMS_TO_STORE_YN , A.RECORDS_PER_TRN_ISS,A.RECORDS_PER_TRN_RET,A.RECORDS_PER_TRN_URG,A.UOM_FOR_PHIS_INTERFACE  FROM st_store a, mm_store_lang_vw b, am_dept_lang_vw c WHERE a.store_code = ? AND b.facility_id = ? AND a.store_code = b.store_code AND b.dept_code = c.dept_code(+) AND b.language_id = c.language_id(+) AND b.language_id = ?");// Modified for IN:071344,Modified for IN:072963,added records_per_trn colums for MO-CRF-20176, Modified for MMS-DM-CRF-0230 US002


		dataMap.put("SQL_ST_STORE_QTY_ON_HAND","SELECT sum(nvl(qty_on_hand,0)) qty_on_hand FROM st_item_store WHERE store_code = ?");
		dataMap.put("SQL_MM_STORE_SELECT_STATUS","SELECT eff_status	FROM mm_store WHERE	store_code = ?");
		dataMap.put("SQL_ST_STORE_QUERY_RESULT","SELECT	A.STORE_CODE, B.LONG_DESC, B.SHORT_DESC, NVL(A.PARENT_STORE_CODE,'') PARENT_STORE_CODE,DECODE(A.STORE_TYPE_FLAG,'M','MAIN','S','SUB STORE','P','PHARMACY','N','NON	STOCK')	STORE_TYPE_DESC	, A.STORE_TYPE_FLAG,B.EFF_STATUS,A.MEDICAL_ITEM_YN, A.NONMEDICAL_ITEM_YN,A.CHK_STK_LVL_FOR_PUR_YN	,A.DFLT_BIN_LOCATION_CODE BIN_LOC_CODE  FROM ST_STORE A, MM_STORE_LANG_VW B WHERE A.STORE_CODE=B.STORE_CODE AND B.FACILITY_ID LIKE	? AND A.STORE_CODE LIKE	UPPER(?) AND UPPER(B.LONG_DESC)	LIKE UPPER(?) AND A.STORE_TYPE_FLAG	LIKE(?)	AND	A. CHK_STK_LVL_FOR_PUR_YN LIKE(?) AND B.EFF_STATUS LIKE	(?) AND B.LANGUAGE_ID= ?");

		//Generate Request

		dataMap.put("SQL_ST_REQ_BY_STORE_SELECT_FOR_AUTH_AT_ISS","SELECT st.store_code, mm.short_desc FROM st_store st, mm_store_lang_vw mm, ST_ACC_ENTITY_PARAM pa  WHERE st.store_code = mm.store_code AND mm.eff_status = 'E' AND st.req_allowed_yn='Y' AND (1=1 OR 'user_id'=? or 'acc_entity_id'=?) AND ((pa.trn_across_facility_yn='Y') OR mm.facility_id =? ) AND mm.language_id = ? order by 2");

	
		dataMap.put("SQL_ST_REQUEST_FROM_STORE_SELECT_FOR_AUTH_AT_ISS","SELECT   x.parent_store_code, y.short_desc FROM (SELECT DISTINCT stp.parent_store_code FROM st_store_parent_store stp, mm_store mm, st_user_access_for_store st, st_store ststr WHERE st.store_code = mm.store_code AND st.store_code = ststr.store_code AND (    st.iss_allowed_yn = 'Y' AND ststr.iss_allowed_yn = 'Y' ) AND mm.eff_status = 'E' AND stp.parent_store_code = mm.store_code AND mm.facility_id = ? AND st.user_id = ?) x, mm_store_lang_vw y WHERE x.parent_store_code = y.store_code AND language_id = ? ORDER BY 2, 1");

dataMap.put("SQL_ST_REQ_ON_STORE_SELECT_FOR_QTY_CHECK","SELECT QTY_ON_HAND  FROM ST_ITEM_STORE  WHERE STORE_CODE=? AND ITEM_CODE=?");

//commented by manish on Sunday, January 25, 2004
//		dataMap.put("SQL_ST_REQ_BY_STORE_SELECT_FOR_AUTH_AT_ISS","SELECT st.store_code,	mm.short_desc FROM st_store	st,	mm_store mm WHERE st.store_code = mm.store_code AND mm.eff_status = 'E' AND st.req_allowed_yn='Y' AND mm.facility_id	=? and ('user_id'=? or 1=1)order by	2 ");
//		dataMap.put("SQL_ST_REQ_BY_STORE_SELECT_FOR_AUTH_AT_ISS","SELECT st.store_code,	mm.short_desc FROM st_store	st,	mm_store mm, sm_appl_user sm WHERE st.store_code = mm.store_code /* AND st.user_id=sm.appl_user_id*/ AND mm.eff_status = 'E' AND sm.eff_status='E' AND st.req_allowed_yn='Y' AND mm.facility_id	=? AND sm.appl_user_id =	?  order by	2 ");

		dataMap.put("SQL_ST_REQ_BY_STORE_SELECT","SELECT st.store_code,	mm.short_desc FROM st_user_access_for_store	st,	mm_store_lang_vw mm, sm_appl_user sm, st_store ststr WHERE st.store_code = mm.store_code and st.store_code = ststr.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status='E' AND (st.req_allowed_yn='Y' and ststr.req_allowed_yn='Y') AND mm.facility_id	=? AND st.user_id =	? AND mm.language_id = ?  and st.store_code in (select store_code from st_store_parent_store) order by	2");
		dataMap.put("SQL_QRY_ST_REQ_BY_STORE_SELECT","SELECT st.store_code,	mm.short_desc FROM st_user_access_for_store	st,	mm_store_lang_vw mm, sm_appl_user sm WHERE st.store_code = mm.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status='E' AND (st.req_allowed_yn='Y' OR st.req_authorize_allowed_yn = 'Y') AND mm.facility_id	=? AND st.user_id =	?  AND mm.language_id = ? order by	2");
		dataMap.put("SQL_ST_REQ_ON_STORE_SELECT","SELECT DISTINCT stp.parent_store_code, mm.short_desc FROM ST_STORE_PARENT_STORE stp, mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st, sm_appl_user sm WHERE stp.parent_store_code = mm.store_code AND  st.store_code = mm.store_code AND st.user_id = sm.appl_user_id AND mm.eff_status = 'E'             AND sm.eff_status = 'E' AND st.iss_allowed_yn = 'Y' AND mm.facility_id = ? AND st.user_id = ?  AND mm.language_id = ?             AND stp.store_code = ? ORDER BY 2");

		dataMap.put("SQL_ST_GENERATE_REQUEST_HDR_INSERT","INSERT INTO st_request_hdr (facility_id,doc_type_code,doc_no,doc_date,doc_ref,req_by_store_code,req_on_store_code,req_raised_by_id,req_authorized_by_id, REQUEST_STATUS,ITEM_CLASS_CODE, added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) VALUES (?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_GENERATE_ITEM_STORE_UPDATE","UPDATE	st_item_store SET pending_req_qty = NVL(pending_req_qty,0) +?, last_reorder_date	= next_reorder_date, next_reorder_date = TO_DATE(?,'dd/mm/yyyy') + DECODE(stock_item_yn, 'Y', 0, NVL(reorder_freq_days,0)),modified_by_id =	?, modified_date  =	SYSDATE, modified_at_ws_no =?, modified_facility_id	= ?	WHERE item_code	 =	? AND store_code = ?");
// modified upper(?),'!' on Thursday, January 15, 2004
		dataMap.put("SQL_ST_GENERATE_REQUEST_ITEM_SELECT","SELECT a.item_code,b.short_desc item_desc,a.qty_on_hand,a.max_stk_qty,a.reorder_level,a.reorder_freq_days,a.pending_req_qty,DECODE(a.stock_item_yn,'Y', NVL(a.max_stk_qty, 0) - NVL(a.qty_on_hand, 0) - NVL(a.pending_req_qty,0)	,NVL(a.max_stk_qty,	0))	req_qty,a.stock_item_yn,b.gen_uom_code uom_code	FROM st_item_store a, mm_item_lang_vw b,st_item c,mm_item_uom_defn mm WHERE  a.item_code=b.item_code and a.item_code=c.item_code and b.eff_status='E' and a.store_code =? AND   A.ITEM_CODE IN (SELECT ITEM_CODE	FROM ST_ITEM_STORE WHERE STORE_CODE=? AND STOCK_ITEM_YN='Y') AND   ((NVL(a.next_reorder_date,TO_DATE('01/01/1800','dd/mm/yyyy')) <=  	DECODE(TO_DATE(?,'dd/mm/yyyy'),'',TO_DATE(TO_CHAR(SYSDATE,'dd/mm/yyyy'),'dd/mm/yyyy'),TO_DATE(?,'dd/mm/yyyy')) AND     a.stock_item_yn = 'N' and REQUEST_GEN_STAGE <> 'N') OR ( NVL(a.qty_on_hand, 0)+NVL(a.pending_req_qty,0) <= NVL(a.reorder_level,0)	AND	    a.stock_item_yn	= 'Y' and REQUEST_GEN_STAGE <> 'N'))	AND	NVL(a.max_stk_qty, 0) >	0 AND a.item_code BETWEEN     NVL (	?,'!') AND NVL ( ?,'~')	AND	b.alpha_code BETWEEN NVL ( upper(?),'!') AND NVL (	?,'~') AND NVL(b.item_class_code,'%') LIKE     NVL(?,'%') and special_req_item_yn = 'N' and NVL(b.item_anal1_code,'%')LIKE DECODE(?,'','%',?) AND	NVL(b.item_anal2_code,'%')LIKE     DECODE(?,'','%',?) AND NVL(b.item_anal3_code,'%')LIKE DECODE(?,'','%',?) AND b.language_id = ? AND mm.item_code =a.item_code ORDER	BY b.short_desc");
		dataMap.put("SQL_ST_GENERATE_REQUEST_ITEM_SELECT_ALL","SELECT distinct a.item_code,b.short_desc item_desc,a.qty_on_hand,a.max_stk_qty,a.reorder_level,a.reorder_freq_days,a.pending_req_qty,DECODE(a.stock_item_yn,'Y', NVL(a.max_stk_qty, 0) - NVL(a.qty_on_hand, 0) - NVL(a.pending_req_qty,0)	,NVL(a.max_stk_qty,	0))	req_qty,a.stock_item_yn,  nvl(a.def_request_uom,b.gen_uom_code) uom_code,a.reorder_qty reorder_qty	FROM st_item_store a, mm_item_lang_vw b,st_item c,mm_item_uom_defn mm WHERE  a.item_code=b.item_code AND a.item_code=c.item_code AND b.eff_status='E' and a.eff_status = 'E' AND a.store_code =? AND A.ITEM_CODE IN (SELECT ITEM_CODE	FROM ST_ITEM_STORE WHERE STORE_CODE=? and eff_status = 'E' ) AND ((NVL(a.next_reorder_date,TO_DATE('01/01/1800','dd/mm/yyyy')) <=	DECODE(TO_DATE(?,'dd/mm/yyyy'),'',TO_DATE(TO_CHAR(SYSDATE,'dd/mm/yyyy'),'dd/mm/yyyy'),TO_DATE(?,'dd/mm/yyyy')) AND a.stock_item_yn = 'N' AND REQUEST_GEN_STAGE <> 'N') OR (a.stock_item_yn	= 'Y' AND REQUEST_GEN_STAGE <> 'N'))	AND	NVL(a.max_stk_qty, 0) >	0 AND a.item_code BETWEEN NVL (	?,'!') AND NVL ( ?,'~')	AND	b.alpha_code BETWEEN NVL ( UPPER(?),'!') AND NVL (	?,'~') AND NVL(b.item_class_code,'%') LIKE NVL(?,'%') AND special_req_item_yn = 'N' AND NVL(b.item_anal1_code,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.item_anal2_code,'%')LIKE DECODE(?,'','%',?) AND  NVL(b.item_anal3_code,'%')LIKE DECODE(?,'','%',?) AND b.language_id = ? AND mm.item_code(+) =a.item_code and a.phy_inv_id is null ORDER	BY b.short_desc");

        dataMap.put("SQL_ST_GENERATE_REQUEST_ITEM_SELECT_NON_STOCK","SELECT DISTINCT a.item_code,b.short_desc item_desc,a.qty_on_hand,a.max_stk_qty,a.reorder_level,a.reorder_freq_days, a.pending_req_qty,DECODE(a.stock_item_yn,'Y', NVL(a.max_stk_qty, 0) - NVL(a.qty_on_hand, 0) - NVL(a.pending_req_qty,0)	,NVL(a.max_stk_qty,	0))	req_qty,a.stock_item_yn, nvl(a.def_request_uom,b.gen_uom_code) uom_code,a.reorder_qty reorder_qty	FROM ST_ITEM_STORE a, mm_item_lang_vw b,ST_ITEM c,mm_item_uom_defn mm WHERE  a.item_code=b.item_code AND a.item_code=c.item_code AND b.eff_status='E' and a.eff_status = 'E' AND a.store_code =? AND A.ITEM_CODE IN (SELECT ITEM_CODE	FROM ST_ITEM_STORE WHERE STORE_CODE=? and eff_status = 'E' ) AND ((NVL(a.next_reorder_date,TO_DATE('01/01/1800','dd/mm/yyyy')) <=	DECODE(TO_DATE(?,'dd/mm/yyyy'),'',TO_DATE(TO_CHAR(SYSDATE,'dd/mm/yyyy'),'dd/mm/yyyy'),TO_DATE(?,'dd/mm/yyyy')) AND a.stock_item_yn = 'N' AND REQUEST_GEN_STAGE <> 'N') OR (a.stock_item_yn	= 'Y' AND REQUEST_GEN_STAGE <> 'N'))	AND	NVL(a.max_stk_qty, 0) >	0 AND a.item_code BETWEEN NVL (	?,'!') AND NVL ( ?,'~')	AND	b.alpha_code BETWEEN NVL ( UPPER(?),'!') AND NVL (	?,'~') AND NVL(b.item_class_code,'%') LIKE NVL(?,'%') AND special_req_item_yn = 'N' AND NVL(b.item_anal1_code,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.item_anal2_code,'%') LIKE DECODE(?,'','%',?) AND  NVL(b.item_anal3_code,'%')LIKE DECODE(?,'','%',?) AND b.language_id = ? AND mm.item_code(+) =a.item_code AND a.STOCK_ITEM_YN = 'N' and a.phy_inv_id is null ORDER	BY b.short_desc");
		dataMap.put("SQL_ST_GENERATE_REQUEST_ITEM_SELECT_REORDERABLE","SELECT DISTINCT a.item_code,b.short_desc item_desc,a.qty_on_hand,a.max_stk_qty,a.reorder_level,a.reorder_freq_days,a.pending_req_qty,DECODE(a.stock_item_yn,'Y', NVL(a.max_stk_qty, 0) - NVL(a.qty_on_hand, 0) - NVL(a.pending_req_qty,0)	,NVL(a.max_stk_qty,	0))	req_qty,a.stock_item_yn, nvl(a.def_request_uom,b.gen_uom_code) uom_code	, a.REORDER_QTY FROM st_item_store a, mm_item_lang_vw b,st_item c,mm_item_uom_defn mm WHERE  a.item_code=b.item_code AND a.item_code=c.item_code AND b.eff_status='E' and a.eff_status = 'E' AND a.store_code =? AND   A.ITEM_CODE IN (SELECT ITEM_CODE	FROM ST_ITEM_STORE WHERE STORE_CODE=? AND STOCK_ITEM_YN='Y' and eff_status = 'E') AND   ((NVL(a.next_reorder_date,TO_DATE('01/01/1800','dd/mm/yyyy')) <=  	DECODE(TO_DATE(?,'dd/mm/yyyy'),'',TO_DATE(TO_CHAR(SYSDATE,'dd/mm/yyyy'),'dd/mm/yyyy'),TO_DATE(?,'dd/mm/yyyy')) AND     a.stock_item_yn = 'N' AND REQUEST_GEN_STAGE <> 'N') OR ( NVL(a.qty_on_hand, 0)+NVL(a.pending_req_qty,0) <= NVL(a.reorder_level,0)	AND	    a.stock_item_yn	= 'Y' AND REQUEST_GEN_STAGE <> 'N'))	AND	NVL(a.max_stk_qty, 0) >	0 AND a.item_code BETWEEN     NVL (	?,'!') AND NVL ( ?,'~')	AND	b.alpha_code BETWEEN NVL ( UPPER(?),'!') AND NVL (	?,'~') AND NVL(b.item_class_code,'%') LIKE     NVL(?,'%') AND special_req_item_yn = 'N' AND NVL(b.item_anal1_code,'%')LIKE DECODE(?,'','%',?) AND	NVL(b.item_anal2_code,'%')LIKE     DECODE(?,'','%',?)  AND NVL(b.item_anal3_code,'%')LIKE DECODE(?,'','%',?) AND b.language_id = ? AND mm.item_code(+) =a.item_code and re_orderable_yn = 'Y' and a.phy_inv_id is null ORDER	BY b.short_desc");

// need to change both the query ... add item analysis code 1.2.3..
		// Stock Transfer
		dataMap.put("SQL_ST_TRANSFER_HDR_INSERT","INSERT INTO st_transfer_hdr (	facility_id, doc_type_code,	doc_no,	doc_date, doc_ref, fm_store_code, to_store_code, finalized_yn,process_for_acknowledge, gl_interfaced_yn, trn_type, entry_completed_yn, item_class_code , added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id	) values ( ? , ? , ? , TO_DATE(?, 'dd/mm/yyyy')	, ?	, ?	, ?	, ?	, ?	, ? , ?	, ?	, ?	, ?	, sysdate ,	? ,	? ,	? ,	sysdate	, ?	, ?	 )");
		dataMap.put("SQL_ST_TRANSFER_HDR_UPDATE","UPDATE st_transfer_hdr SET doc_date =	TO_DATE(?,'dd/mm/yyyy')	, doc_ref =	? ,fm_store_code = ? , to_store_code = ? , finalized_yn	= ?	, process_for_acknowledge = ?, gl_interfaced_yn = ? , trn_type =	? ,entry_completed_yn =	? ,	item_class_code	= ?	, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	? WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ?");
		dataMap.put("SQL_ST_TRANSFER_HDR_DELETE","DELETE FROM st_transfer_hdr WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ? ");
		//commented by rabbani #inc no:34905 on 18/09/12
		//dataMap.put("SQL_ST_TRANSFER_DTL_INSERT","INSERT INTO st_transfer_dtl (	facility_id, doc_type_code,	doc_no,	doc_srl_no,	item_code, item_qty, item_unit_cost, store_code	, stock_item_yn	, item_cost_value, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id ) VALUES  ( ? , ? ,  ?	, ?	, ?	, ?	, ?	, ?	 , ? ,?, ? , sysdate , ? , ? , ? , sysdate , ? , ?  )");
		dataMap.put("SQL_ST_TRANSFER_DTL_INSERT","INSERT INTO st_transfer_dtl (	facility_id, doc_type_code,	doc_no,	doc_srl_no,	item_code, item_qty, item_unit_cost, store_code	, stock_item_yn	, item_cost_value, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id ,usage_type) VALUES  ( ? , ? ,  ?	, ?	, ?	, ?	, ?	, ?	 , ? ,?, ? , sysdate , ? , ? , ? , sysdate , ? , ? ,? )");
		//commented by rabbani #inc no:34905 on 18/09/12
		//dataMap.put("SQL_ST_TRANSFER_DTL_UPDATE","UPDATE st_transfer_dtl  SET item_code	= ?	, item_qty = ? , item_unit_cost	= ?	, store_code = ? ,stock_item_yn	= ?	, ITEM_COST_VALUE=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	?   WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND doc_srl_no	= ?");
		
		dataMap.put("SQL_ST_TRANSFER_DTL_UPDATE","UPDATE st_transfer_dtl  SET item_code	= ?	, item_qty = ? , item_unit_cost	= ?	, store_code = ? ,stock_item_yn	= ?	, ITEM_COST_VALUE=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	?,usage_type = ?   WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND doc_srl_no	= ?");
		dataMap.put("SQL_ST_TRANSFER_DTL_DELETE_ALL","DELETE FROM st_transfer_dtl  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	");
		dataMap.put("SQL_ST_TRANSFER_DTL_DELETE","DELETE FROM st_transfer_dtl  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND	doc_srl_no = ?");
		dataMap.put("SQL_ST_TRANSFER_DTL_EXP_INSERT","INSERT INTO st_transfer_dtl_exp (	facility_id, doc_type_code,	doc_no,	doc_srl_no,	store_code,	item_code, batch_id, bin_location_code,	expiry_date_or_receipt_date, trade_id ,	item_qty, to_bin_location_code , added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id	) VALUES  (	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	TO_DATE(?,'dd/mm/yyyy')	, ?	, ?	, ?	, ?	, sysdate ,	? ,	? ,	? ,	sysdate	, ?	, ?	)");	
		dataMap.put("SQL_ST_TRANSFER_DTL_EXP_UPDATE","UPDATE st_transfer_dtl_exp  SET  trade_id	= ?, item_qty =	? ,	to_bin_location_code = ? , modified_by_id =	? ,	modified_date =	SYSDATE	, modified_at_ws_no	= ?	, modified_facility_id = ?	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ? AND store_code	= ?	AND	item_code =	? AND batch_id = ? AND bin_location_code = ? AND expiry_date_or_receipt_date = ? ");
		dataMap.put("SQL_ST_TRANSFER_DTL_EXP_DELETE_ALL","DELETE FROM st_transfer_dtl_exp  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	");
		dataMap.put("SQL_ST_TRANSFER_DTL_EXP_DELETE","DELETE FROM st_transfer_dtl_exp  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND doc_srl_no	= ?	");
		dataMap.put("SQL_ST_STOCK_TRANSFER_HDR_SELECT","SELECT hdr.doc_type_code, sy.short_desc	doc_type_desc, hdr.doc_no,TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.doc_ref,	hdr.fm_store_code, rbys.short_desc req_fm_store_desc,hdr.to_store_code,	rons.short_desc	req_to_store_desc,item_class_code FROM st_transfer_hdr hdr,	mm_store_lang_vw rbys, mm_store_lang_vw	rons, sy_doc_type_master_lang_vw sy	WHERE hdr.doc_type_code	= sy.doc_type_code AND hdr.fm_store_code=  rbys.store_code AND hdr.to_store_code = rons.store_code AND hdr.facility_id = ? AND hdr.doc_type_code = ? AND hdr.doc_no	= ? AND rbys.language_id = rons.language_id AND rbys.language_id = sy.language_id AND rbys.language_id = ?");
		dataMap.put("SQL_ST_TRANSFER_DTL_SELECT_MULTIPLE","SELECT   dtl.doc_no, dtl.item_code, mmitem.short_desc item_desc,         stitem.expiry_yn expiry_yn, dtl.doc_srl_no, item_qty, stitem.sale_uom_code uom_code1, am.short_desc uom_desc, (SUM (avail_qty) + item_qty) stock_available, dtl.store_code, dtl.stock_item_yn, stitem.reorder_level, stitem.min_stk_qty, ROUND ((  DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand)), 3) unit_cost, ROUND (  (  DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand)) * item_qty, 3          ) item_cost_value,DEF_ISSUE_UOM UOM_CODE FROM st_transfer_dtl dtl, mm_item_lang_vw mmitem,  st_item stitem, am_uom_lang_vw am, st_batch_search_lang_view bsview, st_item_store ststr   WHERE mmitem.item_code = dtl.item_code     AND stitem.item_code = dtl.item_code      AND STSTR.DEF_ISSUE_UOM = am.uom_code(+)     AND dtl.item_code = bsview.item_code     AND dtl.item_code = ststr.item_code      AND dtl.store_code = ststr.store_code     AND dtl.facility_id = ?     AND dtl.doc_type_code = ?     AND dtl.doc_no = ?     AND bsview.store_code = ?     AND mmitem.language_id = ?     AND mmitem.language_id = bsview.language_id     AND DECODE (bsview.lang1, NULL, ?, bsview.lang1) = ? AND DECODE (bsview.lang2, NULL, ?, bsview.lang2) = ?     AND am.language_id(+) = ? GROUP BY dtl.doc_no, dtl.item_code,mmitem.short_desc,         stitem.expiry_yn, dtl.doc_srl_no, item_qty, stitem.sale_uom_code, am.short_desc,dtl.store_code, dtl.stock_item_yn,stitem.reorder_level,  stitem.min_stk_qty,DEF_ISSUE_UOM,ROUND((DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand)),3), ROUND((DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand))* item_qty, 3 )");
		dataMap.put("SQL_ST_STOCK_TRANSFER_DTL_SELECT","SELECT dtl.doc_srl_no, dtl.store_code, str.short_desc store_desc, dtl.item_code, itm.short_desc	item_desc, itm.gen_uom_code	uom_code, uom.short_desc uom_desc, dtl.item_qty, dtl.item_unit_cost,(dtl.item_unit_cost* dtl.item_qty) item_cost_value,	 dtl.stock_item_yn FROM	st_transfer_dtl	dtl, mm_item itm, am_uom uom, mm_store str WHERE dtl.facility_id = ?  AND  dtl.doc_type_code = ?  AND dtl.doc_no = ? AND dtl.item_code = itm.item_code AND itm.gen_uom_code	= uom.uom_code AND dtl.store_code =	str.store_code ORDER BY	dtl.doc_srl_no");
//		dataMap.put("SQL_ST_TRANSFER_DTL_EXP_SELECT_MULTIPLE","SELECT batchview.trade_id, batchview.qty_on_hand, batchview.use_after_expiry_yn,	batchview.expiry_yn expiry_yn, (batchview.avail_qty +stexp.item_qty)avail_qty, batchview.trade_id_applicable_yn,	batchview.manufacturer_id, stexp.item_qty qty, batchview.store_desc, batchview.trade_name, batchview.nod nod, batchview.item_desc, batchview.manufacturer_name,	 batchview.store_code, batchview.suspended_yn, batchview.item_code,	batchview.bin_location_code, batchview.bin_desc, stexp.to_bin_location_code,mm_bin.short_desc to_bin_desc ,TO_CHAR(batchview.expiry_date,'dd/mm/yyyy') expiry_date,	 batchview.batch_id 	FROM st_batch_search_view batchview, ST_TRANSFER_DTL_EXP stexp,MM_BIN_LOCATION mm_bin WHERE	batchview.store_code=stexp.store_code AND batchview.item_code=stexp.item_code AND batchview.batch_id=stexp.batch_id	AND	batchview.bin_location_code=stexp.bin_location_code	AND	batchview.expiry_date=stexp.expiry_date_or_receipt_date	AND	stexp.store_code=mm_bin.store_code(+) AND stexp.to_bin_location_code=mm_bin.bin_location_code(+) AND stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND stexp.doc_srl_no=?");
	// Modified on 2/23/2005 for Batch Status 
		dataMap.put("SQL_ST_TRANSFER_DTL_EXP_SELECT_MULTIPLE","SELECT batchview. batch_status, batchview.trade_id, batchview.qty_on_hand, batchview.use_after_expiry_yn,	batchview.expiry_yn expiry_yn, (batchview.avail_qty +stexp.item_qty)avail_qty, batchview.trade_id_applicable_yn,	batchview.manufacturer_id, stexp.item_qty qty, batchview.store_desc, batchview.trade_name, batchview.nod nod, batchview.item_desc, batchview.manufacturer_name,	 batchview.store_code, batchview.suspended_yn, batchview.item_code,	batchview.bin_location_code, batchview.bin_desc, stexp.to_bin_location_code,mm_bin.short_desc to_bin_desc ,TO_CHAR(batchview.expiry_date,'dd/mm/yyyy') expiry_date,	 batchview.batch_id FROM st_batch_search_lang_view batchview, ST_TRANSFER_DTL_EXP stexp,MM_BIN_LOCATION_LANG_VW mm_bin WHERE	batchview.store_code=stexp.store_code AND batchview.item_code=stexp.item_code AND batchview.batch_id=stexp.batch_id	AND	batchview.bin_location_code=stexp.bin_location_code	AND	batchview.expiry_date=stexp.expiry_date_or_receipt_date	AND	stexp.store_code=mm_bin.store_code(+) AND stexp.to_bin_location_code=mm_bin.bin_location_code(+) AND stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=?  AND mm_bin.language_id(+) = ? AND batchview.language_id = ? AND batchview.lang1 = ? AND batchview.lang2 = ? AND stexp.doc_srl_no=?");
		dataMap.put("SQL_ST_STOCK_TRANSFER_DTL_EXP_SELECT","SELECT	exp.doc_srl_no,	exp.store_code,	exp.item_code, itm.short_desc item_desc, exp.batch_id, exp.bin_location_code, bin.short_desc bin_desc, TO_CHAR(exp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, exp.trade_id,	am.short_name trade_name, exp.item_qty,	exp.to_bin_location_code FROM st_transfer_dtl_exp exp, mm_item itm,	mm_bin_location	bin, am_trade_name am WHERE	exp.facility_id	= ?	 AND exp.doc_type_code = ?	AND	exp.doc_no = ?	 AND exp.doc_srl_no	= ?	 AND exp.store_code	= ?	 AND exp.item_code = ? AND exp.item_code = itm.item_code AND exp.bin_location_code = bin.bin_location_code AND exp.store_code =	bin.store_code AND exp.trade_id	= am.trade_id(+)");
		dataMap.put("SQL_ST_TRANSFER_DTL_SELECT_MAX_DOC_SRL_NO", "SELECT MAX(doc_srl_no) max_doc_srl_no	FROM st_transfer_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
		dataMap.put("SQL_ST_DEF_TO_STORE_TO_BIN", "SELECT bin_location_code	FROM st_item_store WHERE bin_location_code IS NOT NULL AND store_code= ? AND item_code=	?");

		dataMap.put("SQL_ST_STOCK_TRANSFER_TO_ITEM_MOVE_SUMM_UPDATE","UPDATE	st_item_move_summ SET TFR_QTY =(nvl(TFR_QTY,0) + ?), TFR_COST =(nvl(TFR_COST,0)	+?)	, MONTH_CLOSING_QTY	= (nvl(MONTH_CLOSING_QTY,0)	+ ?), MONTH_CLOSING_VALUE =(nvl(MONTH_CLOSING_VALUE,0) + ?), modified_by_id	= ?,  modified_date	= SYSDATE,	modified_at_ws_no =	?,	modified_facility_id = ? WHERE FACILITY_ID = ? AND ITEM_CODE = ? AND STORE_CODE	= ?	AND	MOVE_MONTH=	? AND MOVE_YEAR	=?");
		dataMap.put("SQL_ST_STOCK_TRANSFER_FROM_ITEM_MOVE_SUMM_UPDATE","UPDATE st_item_move_summ	SET	TFR_QTY	=(nvl(TFR_QTY,0) + ?), TFR_COST	=(nvl(TFR_COST,0) +	?) , MONTH_CLOSING_QTY = (nvl(MONTH_CLOSING_QTY,0) + ?), MONTH_CLOSING_VALUE =(nvl(MONTH_CLOSING_VALUE,0) +	?),	modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ?	WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("SQL_STOCK_TRANSFER_ST_ITEM_MOVE_SUMM_INSERT", "INSERT into st_item_move_summ  (facility_id,	item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,tfr_qty, tfr_cost,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_FM_STOCK_TRANSFER_ST_ITEM_MOVE_SUMM_INSERT", "INSERT into st_item_move_summ  (facility_id,	item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,tfr_qty, tfr_cost,out_tfr_qty, out_tfr_cost,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_TO_STOCK_TRANSFER_ST_ITEM_MOVE_SUMM_INSERT", "INSERT into st_item_move_summ  (facility_id,	item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,tfr_qty, tfr_cost,in_tfr_qty, in_tfr_cost,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_FM_STOCK_TRANSFER_FROM_ITEM_MOVE_SUMM_UPDATE","UPDATE st_item_move_summ	SET	TFR_QTY	=(nvl(TFR_QTY,0) + ?), TFR_COST	=(nvl(TFR_COST,0) +	?) , MONTH_CLOSING_QTY = (nvl(MONTH_CLOSING_QTY,0) + ?), MONTH_CLOSING_VALUE =(nvl(MONTH_CLOSING_VALUE,0) +	?), OUT_TFR_QTY	=(nvl(OUT_TFR_QTY,0) + ?), OUT_TFR_COST	=(nvl(OUT_TFR_COST,0) +	?) , 	modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ?	WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("SQL_TO_STOCK_TRANSFER_FROM_ITEM_MOVE_SUMM_UPDATE","UPDATE st_item_move_summ	SET	TFR_QTY	=(nvl(TFR_QTY,0) + ?), TFR_COST	=(nvl(TFR_COST,0) +	?) , MONTH_CLOSING_QTY = (nvl(MONTH_CLOSING_QTY,0) + ?), MONTH_CLOSING_VALUE =(nvl(MONTH_CLOSING_VALUE,0) +	?), IN_TFR_QTY	=(nvl(IN_TFR_QTY,0) + ?), IN_TFR_COST	=(nvl(IN_TFR_COST,0) +	?) , 	modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ?	WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("SQL_ST_STOCK_TRANSFER_ITEM_TRN_DTL_INSERT","INSERT INTO st_item_trn_dtl(facility_id,		   store_code,item_code, posted_date, trn_srl_no  ,	trn_type , doc_type_code, doc_no , doc_srl_no, doc_date	, doc_ref  , batch_id  ,  expiry_date, item_qty_normal,	item_qty_bonus	, item_qty_sample  , item_unit_cost	 ,	item_unit_price	,  stk_uom_code	, pur_uom_conv ,	 supp_code	, source_doc_type_code,source_doc_no ,	source_doc_srl_no, source_doc_date ,  other_store_code ,stock_item_yn ,	lend_borrow_entity_type, lend_borrow_entity_code , added_by_id , added_date	  ,	added_at_ws_no,	added_facility_id, modified_by_id ,	 modified_date , modified_at_ws_no,	modified_facility_id,sal_trn_type,bin_location_code,trade_id )VALUES(?,?,?,sysdate,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,TO_DATE(?,'dd/mm/yyyy'),nvl(?,0),nvl(?,0),nvl(?,0),?,?,?,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?)");
		//dataMap.put("SQL_ST_TRANSFER_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.fm_store_code,  fms.short_desc fm_store_desc,hdr.to_store_code,	tos.short_desc	to_store_desc, hdr.item_class_code,	itm.short_desc item_class_desc	FROM st_transfer_hdr	hdr, mm_store_lang_vw fms,mm_store_lang_vw	tos, mm_item_class_lang_vw	itm, sy_doc_type_master_lang_vw	sy,	st_user_access_for_store uaca, st_user_access_for_store	uacb , st_acc_entity_param pa,st_facility_param st  WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.fm_store_code=	fms.store_code	AND	 hdr.to_store_code = tos.store_code AND hdr.item_class_code = itm.item_class_code(+)  AND uaca.store_code	= hdr.to_store_code	AND	hdr.finalized_yn='N' AND DECODE(st.TFR_ACK_REQ_YN, 'Y', hdr.process_for_acknowledge,'XX') = DECODE(st.TFR_ACK_REQ_YN, 'Y','N','XX') AND uaca.tfr_allowed_yn	= 'Y' AND uacb.user_id = uaca.user_id AND uacb.store_code =	hdr.fm_store_code AND uacb.tfr_allowed_yn =	'Y'	AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') like ?	AND	hdr.fm_store_code like ? AND hdr.to_store_code like	? AND  NVL(hdr.item_class_code,'X')	like ? AND uaca.user_id	= ? AND tos.facility_id like decode(trn_across_facility_yn,'Y','%',? )AND sy.language_id = fms.language_id AND sy.language_id = tos.language_id AND sy.language_id = ? AND itm.language_id(+) = ? AND st.facility_id = hdr.facility_id");
		//dataMap.put("SQL_ST_TRANSFER_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.fm_store_code,  fms.short_desc fm_store_desc,hdr.to_store_code,	tos.short_desc	to_store_desc, hdr.item_class_code,	itm.short_desc item_class_desc	FROM st_transfer_hdr	hdr, mm_store_lang_vw fms,mm_store_lang_vw	tos, mm_item_class_lang_vw	itm, sy_doc_type_master_lang_vw	sy,	st_user_access_for_store uaca, st_user_access_for_store	uacb , st_acc_entity_param pa,st_facility_param st  WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.fm_store_code=	fms.store_code	AND	 hdr.to_store_code = tos.store_code AND hdr.item_class_code = itm.item_class_code(+)  AND uaca.store_code	= hdr.to_store_code	AND	hdr.finalized_yn='N' AND DECODE(st.TFR_ACK_REQ_YN, 'Y', hdr.process_for_acknowledge,'XX') = DECODE(st.TFR_ACK_REQ_YN, 'Y','N','XX') AND uaca.tfr_allowed_yn	= 'Y' AND uacb.user_id = uaca.user_id AND uacb.store_code =	hdr.fm_store_code AND uacb.tfr_allowed_yn =	'Y'	AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') like ?	AND	hdr.fm_store_code like ? AND hdr.to_store_code like	? AND  NVL(hdr.item_class_code,'X')	like ? AND uaca.user_id	= ?  AND  (fms.facility_id = ? and hdr.facility_id like decode(trn_across_facility_yn,'Y','%',? )) AND  sy.language_id = fms.language_id AND sy.language_id = tos.language_id AND sy.language_id = ? AND itm.language_id(+) = ? AND st.facility_id = hdr.facility_id");

		//dataMap.put("SQL_ST_TRANSFER_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.fm_store_code,  fms.short_desc fm_store_desc,hdr.to_store_code,	tos.short_desc	to_store_desc, hdr.item_class_code,	itm.short_desc item_class_desc	FROM st_transfer_hdr	hdr, mm_store_lang_vw fms,mm_store_lang_vw	tos, mm_item_class_lang_vw	itm, sy_doc_type_master_lang_vw	sy,	st_user_access_for_store uaca, st_user_access_for_store	uacb , st_acc_entity_param pa,st_facility_param st  WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.fm_store_code=	fms.store_code	AND	 hdr.to_store_code = tos.store_code AND hdr.item_class_code = itm.item_class_code(+)  AND uaca.store_code	= hdr.to_store_code	AND	hdr.finalized_yn='N' AND DECODE(st.TFR_ACK_REQ_YN, 'Y', hdr.process_for_acknowledge,'XX') = DECODE(st.TFR_ACK_REQ_YN, 'Y','N','XX') AND uaca.tfr_allowed_yn	= 'Y' AND uacb.user_id = uaca.user_id AND uacb.store_code =	hdr.fm_store_code AND uacb.tfr_allowed_yn =	'Y'	AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	/*TO_CHAR(hdr.doc_date,'dd/mm/yyyy') like ?*/ TO_DATE (TO_CHAR (hdr.doc_date, 'dd/mm/yyyy'), 'dd/mm/yyyy')  BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy')	AND	hdr.fm_store_code like ? AND hdr.to_store_code like	? AND  NVL(hdr.item_class_code,'X')	like ? AND uaca.user_id	= ?  AND  (fms.facility_id = ? and hdr.facility_id like decode(trn_across_facility_yn,'Y','%',? )) AND  sy.language_id = fms.language_id AND sy.language_id = tos.language_id AND sy.language_id = ? AND itm.language_id(+) = ? AND st.facility_id = hdr.facility_id");
		//Modified by suresh.r on 10-09-2014 against KDAH-SCF-0259
		dataMap.put("SQL_ST_TRANSFER_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.fm_store_code,  fms.short_desc fm_store_desc,hdr.to_store_code,	tos.short_desc	to_store_desc, hdr.item_class_code,	itm.short_desc item_class_desc	FROM st_transfer_hdr	hdr, mm_store_lang_vw fms,mm_store_lang_vw	tos, mm_item_class_lang_vw	itm, sy_doc_type_master_lang_vw	sy,	 st_user_access_for_store	uacb , st_acc_entity_param pa,st_facility_param st  WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.fm_store_code=	fms.store_code	AND	 hdr.to_store_code = tos.store_code AND hdr.item_class_code = itm.item_class_code(+)  AND hdr.finalized_yn='N' AND DECODE(st.TFR_ACK_REQ_YN, 'Y', hdr.process_for_acknowledge,'XX') = DECODE(st.TFR_ACK_REQ_YN, 'Y','N','XX') AND uacb.store_code =	hdr.fm_store_code AND uacb.tfr_allowed_yn =	'Y'	AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	/*TO_CHAR(hdr.doc_date,'dd/mm/yyyy') like ?*/ TO_DATE (TO_CHAR (hdr.doc_date, 'dd/mm/yyyy'), 'dd/mm/yyyy')  BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy')	AND	hdr.fm_store_code like ? AND hdr.to_store_code like	? AND  NVL(hdr.item_class_code,'X')	like ? AND uacb.user_id	= ?  AND  (fms.facility_id = ? and hdr.facility_id like decode(trn_across_facility_yn,'Y','%',? )) AND  sy.language_id = fms.language_id AND sy.language_id = tos.language_id AND sy.language_id = ? AND itm.language_id(+) = ? AND st.facility_id = hdr.facility_id");

		dataMap.put("SQL_ST_TRANSFER_DTL_EXP_SELECT_FOR_BLOCK_REL",	"SELECT store_code, item_code, batch_id, bin_location_code, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, trade_id, item_qty FROM st_transfer_dtl_exp WHERE  facility_id=? AND  doc_type_code =? AND doc_no=? AND doc_srl_no LIKE ?");
		dataMap.put("SQL_QRY_ST_STOCK_TFR_FROM_STORE", "SELECT st.store_code, mm.short_desc	FROM st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user	sm WHERE st.store_code = mm.store_code	AND	st.user_id=sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status='E'  AND mm.facility_id =? AND st.user_id	= ?  AND (st.tfr_allowed_yn='Y' OR	tfr_finalize_allowed_yn='Y') AND mm.language_id = ? ORDER BY 2");
		//	dataMap.put("SQL_ST_STOCK_TFR_FROM_STORE", "SELECT st.store_code, mm.short_desc	FROM st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user sm, st_store ststr WHERE st.store_code = mm.store_code and st.store_code = ststr.store_code	AND	st.user_id=sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status='E' AND (st.tfr_allowed_yn='Y' and ststr.tfr_allowed_yn='Y') AND mm.facility_id =?  AND st.user_id	= ?	 AND mm.language_id = ? and st.store_code in (select store_code from st_store_parent_store) ORDER BY 2");
		dataMap.put("SQL_ST_STOCK_TFR_FROM_STORE", "SELECT  DISTINCT  ST.STORE_CODE, MM.SHORT_DESC FROM ST_USER_ACCESS_FOR_STORE ST, MM_STORE_LANG_VW MM, SM_APPL_USER SM, ST_STORE STSTR, ST_STORE_PARENT_STORE STP WHERE MM.STORE_CODE = STP.PARENT_STORE_CODE  AND ST.STORE_CODE = MM.STORE_CODE AND ST.STORE_CODE = STSTR.STORE_CODE AND ST.USER_ID = SM.APPL_USER_ID AND MM.EFF_STATUS = 'E' AND SM.EFF_STATUS = 'E' AND (ST.TFR_ALLOWED_YN = 'Y' AND STSTR.TFR_ALLOWED_YN = 'Y') AND MM.FACILITY_ID = ? AND ST.USER_ID = ? AND MM.LANGUAGE_ID = ? ORDER BY 2 ");
		dataMap.put("SQL_ST_STOCK_TFR_TO_STORE", "SELECT st.store_code, mm.short_desc FROM	st_user_access_for_store st, mm_store mm, st_acc_entity_param pa WHERE	st.store_code =	mm.store_code   AND mm.eff_status	= 'E' AND pa.acc_entity_id=	? AND ((pa.trn_across_facility_yn='Y') OR mm.facility_id =?) order by 2");
		//dataMap.put("SQL_ST_STOCK_TO_STORE", "SELECT DISTINCT stp.PARENT_store_code parent_store_code, mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm,st_user_access_for_store st, sm_appl_user sm, st_acc_entity_param pa WHERE st.store_code = mm.store_code AND st.user_id = sm.appl_user_id AND mm.store_code = stp.PARENT_store_code AND sm.eff_status = 'E' AND st.user_id = ? AND pa.acc_entity_id = ? AND mm.facility_id like decode(pa.trn_across_facility_yn , 'Y', '%', ?) AND mm.language_id = ? AND stp.store_code = ? ORDER BY 2 ");
		dataMap.put("SQL_ST_STOCK_TO_STORE", "SELECT DISTINCT stp.store_code PARENT_STORE_CODE, mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm,st_store st, st_acc_entity_param pa,st_user_access_for_store uas WHERE mm.eff_status = 'E' AND stp.store_code = mm.store_code AND st.store_code = mm.store_code and uas.user_id = ? AND pa.acc_entity_id = ? AND  mm.facility_id like decode(pa.trn_across_facility_yn ,'Y','%',?) AND mm.language_id = ? AND stp.parent_store_code = ? ORDER BY 2  ");

		dataMap.put("SQL_QRY_ST_STOCK_TO_STORE", "SELECT st.store_code, mm.short_desc FROM	st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user sm, st_acc_entity_param pa WHERE	st.store_code =	mm.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status	= 'E' AND sm.eff_status='E' AND mm.facility_id =? AND st.user_id = ?  AND mm.language_id = ? order by 2");
		dataMap.put("SQL_ST_STOCK_DOC_DATE_MODIFY_DETAIL" , "select ITEM_CLASS_BASED_YN,DOC_DATE_MODIFIABLE_YN from st_trn_type where TRN_TYPE= ? " );
//		dataMap.put("SQL_ST_STOCK_TRANSFER_ROL" , "SELECT REORDER_LEVEL,MIN_STK_QTY FROM st_item WHERE  item_code = ?");
		dataMap.put("SQL_ST_STOCK_TRANSFER_ROL" , "SELECT NVL(MIN_STK_QTY, 0) MIN_STK_QTY, NVL(QTY_ON_HAND, 0) QTY_ON_HAND, NVL(REORDER_LEVEL,0) REORDER_LEVEL FROM ST_ITEM_STORE WHERE  item_code = ? AND store_code = ?");


		// issue (URG/REG)

//		dataMap.put("SQL_ST_ISSUE_REQ_UPDATE_PENDING_REQ_QTY",	"update st_item_store set pending_req_qty=decode(sign(pending_req_qty+?),-1,0,(pending_req_qty+?)) where item_code=? and store_code=?");  // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_ISSUE_REQ_UPDATE_PENDING_REQ_QTY",	"update st_item_store set pending_req_qty=decode(sign(pending_req_qty+?),-1,0,(pending_req_qty+?)) , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where item_code=? and store_code=?");

		dataMap.put("SQL_ST_ISSUE_REQ_URG_FROM_STORE",	"SELECT DISTINCT stp.parent_Store_code, mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm, st_user_access_for_store st,SM_APPL_USER sm, st_store ststr WHERE mm.store_code = stp.parent_store_code and st.store_code = ststr.store_code AND mm.eff_status = 'E' AND st.store_code = mm.store_code AND st.user_id = sm.appl_user_id AND sm.eff_status = 'E' AND (st.urg_allowed_yn = 'Y' and ststr.urg_allowed_yn = 'Y') AND mm.facility_id = ? AND st.user_id = ? AND mm.language_id = ? ORDER BY 2");

		dataMap.put("SQL_ST_ISSUE_REQ_URG_TO_STORE", "SELECT DISTINCT stp.store_code, mm.short_desc FROM st_store_parent_store stp,                 mm_store_lang_vw mm,st_store st, st_acc_entity_param pa,st_user_access_for_store uas WHERE mm.eff_status = 'E' AND stp.store_code = mm.store_code AND st.store_code = mm.store_code and uas.user_id = ? AND pa.acc_entity_id = ? AND  mm.facility_id like decode(pa.trn_across_facility_yn ,'Y','%',?) AND mm.language_id = ? AND stp.parent_store_code = ? ORDER BY 2 "); 

		dataMap.put("SQL_ST_ISSUE_REQ_URG_HDR_INSERT","INSERT INTO st_issue_hdr (	facility_id, doc_type_code, doc_no, seq_no, doc_date, doc_ref, fm_store_code, to_store_code, finalized_yn,process_for_acknowledge, gl_interfaced_yn, trn_type, entry_completed_yn, authorized_by_id, close_req_after_issue_yn, remarks, added_by_id, added_date, added_at_ws_no, added_facility_id,item_class_code, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) values ( ? , ? , ? ,? , TO_DATE(?, 'dd/mm/yyyy')	, ?	, ?	, ?	, ?	, ?	, ?	, ?	, ?	, ?	,?  , ? , ? , sysdate ,	? ,	? ,	?, ? ,	sysdate	, ?	, ?	 )");

		dataMap.put("SQL_ST_ISSUE_REQ_URG_HDR_UPDATE","UPDATE st_issue_hdr SET doc_date =	TO_DATE(?,'dd/mm/yyyy')	, doc_ref =	? ,fm_store_code = ? , to_store_code = ? , finalized_yn	= ?	, process_for_acknowledge = ?, gl_interfaced_yn = ? , trn_type =	? ,entry_completed_yn =	? ,	remarks	= ?	, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	? WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ? AND seq_no = ?");

		//dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_INSERT","INSERT INTO st_issue_dtl (facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, iss_item_qty, ret_item_qty, item_unit_cost, item_cost_value, print_label_yn, stock_item_yn, authorized_item_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id ) VALUES  ( ? , ? ,  ?	, ?	, ?	, ?	, ?	, ?	 , ? , ? , ? ,? , ? ,? , ?, sysdate , ? , ? , ? , sysdate , ? , ? )");
         //18/09/12
		//dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_INSERT","INSERT INTO st_issue_dtl (facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, iss_item_qty, ret_item_qty, item_unit_cost, item_cost_value, print_label_yn, stock_item_yn, authorized_item_qty, issue_uom, issue_uom_conv , issue_uom_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id , REMARKS) VALUES  ( ? , ? ,  ?	, ?	, ?	, ?	, ?	, ?	 , ? , ? , ? ,? , ? ,? , ?,?,?,?, sysdate , ? , ? , ? , sysdate , ? , ?,?  )");
		
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_INSERT","INSERT INTO st_issue_dtl (facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, iss_item_qty, ret_item_qty, item_unit_cost, item_cost_value, print_label_yn, stock_item_yn, authorized_item_qty, issue_uom, issue_uom_conv , issue_uom_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id , REMARKS,usage_type) VALUES  ( ? , ? ,  ?	, ?	, ?	, ?	, ?	, ?	 , ? , ? , ? ,? , ? ,? , ?,?,?,?, sysdate , ? , ? , ? , sysdate , ? , ?,?,? )");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_UPDATE","UPDATE st_issue_dtl  SET item_code	= ?	, iss_item_qty = ? , item_unit_cost	= ?	item_cost_value= ?, store_code = ? ,stock_item_yn	= ?	, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	?  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND seq_no	= ? AND doc_srl_no	= ?");
		//commented by ganga to add barcode_id
		//dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_EXP_INSERT","INSERT INTO st_issue_dtl_exp (	facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, trade_id, iss_item_qty, ret_item_qty, to_bin_location_code, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id	) VALUES  (	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	?, TO_DATE(?,'dd/mm/yyyy')	, ?	, ?	, ?	, ?	, ? ,sysdate ,	? ,	? ,	? ,	sysdate	, ?	, ?	)");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_EXP_INSERT","INSERT INTO st_issue_dtl_exp (	facility_id, doc_type_code, doc_no, seq_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, trade_id, iss_item_qty, ret_item_qty, to_bin_location_code,barcode_id	, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES  (	? ,	? ,	? ,	? ,	? ,	? ,	? ,	? ,	?, TO_DATE(?,'dd/mm/yyyy')	, ?	, ?	, ?	, ?	, ?, ? ,sysdate ,	? ,	? ,	? ,	sysdate	, ?	, ?	)");
		
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_EXP_UPDATE","UPDATE st_issue_dtl_exp  SET  trade_id	= ?, iss_item_qty=	? ,	to_bin_location_code = ? , modified_by_id =	? ,	modified_date =	SYSDATE	, modified_at_ws_no	= ?	, modified_facility_id = ?	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?  AND seq_no	= ? AND doc_srl_no = ? AND store_code	= ?	AND	item_code =	? AND batch_id = ? AND bin_location_code = ? AND expiry_date_or_receipt_date = ? ");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_HDR_DELETE","DELETE FROM st_issue_hdr WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ?  AND	seq_no = ? ");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_DELETE_ALL","DELETE FROM st_issue_dtl  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?  ");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_DELETE","DELETE FROM st_issue_dtl  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND 	doc_srl_no = ? AND	seq_no = ? ");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_EXP_DELETE_ALL","DELETE FROM st_issue_dtl_exp  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?   	");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_EXP_DELETE","DELETE FROM st_issue_dtl_exp  WHERE /*facility_id = ?  AND */doc_type_code	= ?	 AND doc_no	= ?	AND	seq_no = ? AND doc_srl_no	= ?	");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_SELECT_MAX_DOC_SRL_NO", "SELECT MAX(doc_srl_no) max_doc_srl_no	FROM st_issue_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_HDR_SELECT_M","SELECT hdr.doc_type_code, sy.short_desc	doc_type_desc, hdr.doc_no,TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.doc_ref,	hdr.fm_store_code, rbys.short_desc req_fm_store_desc,hdr.to_store_code,	rons.short_desc	req_to_store_desc,item_class_code ,finalized_yn, trn_type, close_req_after_issue_yn, remarks FROM st_issue_hdr hdr,	mm_store rbys, mm_store	rons, sy_doc_type_master sy	WHERE hdr.doc_type_code	= sy.doc_type_code AND hdr.fm_store_code=  rbys.store_code AND hdr.to_store_code = rons.store_code AND hdr.facility_id = ? AND hdr.doc_type_code = ? AND hdr.doc_no	= ?");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_SELECT_MULTIPLE","SELECT dtl.doc_no, dtl.item_code, mmitem.short_desc item_desc, dtl.item_unit_cost	unit_cost,ROUND((dtl.item_unit_cost*iss_item_qty),3) item_cost_value,	stitem.expiry_yn expiry_yn,	dtl.doc_srl_no,iss_item_qty,stitem.sale_uom_code uom_code, am.short_desc uom_desc, (SUM(avail_qty)+iss_item_qty)	stock_available	,dtl.store_code,dtl.stock_item_yn FROM st_issue_dtl dtl, mm_item mmitem, st_item stitem, am_uom am, st_batch_search_view bsview WHERE mmitem.item_code=dtl.item_code AND stitem.item_code=dtl.item_code AND stitem.sale_uom_code=am.uom_code AND dtl.item_code=bsview.item_code AND dtl.facility_id=? AND dtl.doc_type_code=? AND dtl.doc_no=?	AND	bsview.store_code=?  GROUP BY dtl.doc_no, dtl.item_code, mmitem.short_desc,	dtl.item_unit_cost, stitem.expiry_yn , dtl.doc_srl_no,iss_item_qty,stitem.sale_uom_code, am.short_desc,dtl.store_code,dtl.stock_item_yn");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_DTL_EXP_SELECT_MULTIPLE","SELECT batchview.trade_id, batchview.qty_on_hand, batchview.use_after_expiry_yn,	batchview.expiry_yn, batchview.avail_qty, batchview.trade_id_applicable_yn,	batchview.manufacturer_id, stexp.item_qty qty, batchview.store_desc, batchview.trade_name, batchview.nod, batchview.item_desc, batchview.manufacturer_name,	 batchview.store_code, batchview.suspended_yn, batchview.item_code,	batchview.bin_location_code, batchview.bin_desc, stexp.to_bin_location_code,mm_bin.short_desc to_bin_desc ,TO_CHAR(batchview.expiry_date,'dd/mm/yyyy') expiry_date,	 batchview.batch_id	FROM st_batch_search_view batchview, st_issue_dtl_exp stexp,MM_BIN_LOCATION mm_bin WHERE	batchview.store_code=stexp.store_code AND batchview.item_code=stexp.item_code AND batchview.batch_id=stexp.batch_id	AND	batchview.bin_location_code=stexp.bin_location_code	AND	batchview.expiry_date=stexp.expiry_date_or_receipt_date	AND	stexp.store_code=mm_bin.store_code(+) AND stexp.to_bin_location_code=mm_bin.bin_location_code(+) AND stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND stexp.doc_srl_no=?");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_HDR_QUERY_RESULT","SELECT hdr.trn_type,HDR.DOC_TYPE_CODE, SY.SHORT_DESC DOC_TYPE_DESC, HDR.DOC_NO, HDR.SEQ_NO,TO_CHAR (HDR.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, HDR.FM_STORE_CODE,FMS.SHORT_DESC FM_STORE_DESC, HDR.TO_STORE_CODE,TOS.SHORT_DESC TO_STORE_DESC, HDR.ITEM_CLASS_CODE,ITM.SHORT_DESC ITEM_CLASS_DESC, HDR.CLOSE_REQ_AFTER_ISSUE_YN,NVL(REQ.FACILITY_ID,HDR.FACILITY_ID) REQ_STR_FACILITY_ID,SM.FACILITY_NAME REQ_STR_FACILITY_NAME FROM ST_ISSUE_HDR HDR,MM_STORE_LANG_VW FMS,MM_STORE_LANG_VW TOS,MM_ITEM_CLASS_LANG_VW ITM,SY_DOC_TYPE_MASTER_LANG_VW SY, /*ST_USER_ACCESS_FOR_STORE UACA,*/ST_USER_ACCESS_FOR_STORE UACB,ST_ACC_ENTITY_PARAM STP,SM_FACILITY_PARAM_LANG_VW SM, /*, ST_ACC_ENTITY_PARAM PA */ST_FACILITY_PARAM ST,ST_REQUEST_HDR REQ WHERE HDR.DOC_TYPE_CODE = SY.DOC_TYPE_CODE AND HDR.FM_STORE_CODE = FMS.STORE_CODE AND HDR.TO_STORE_CODE = TOS.STORE_CODE AND HDR.ITEM_CLASS_CODE = ITM.ITEM_CLASS_CODE(+) AND /*UACA.STORE_CODE = HDR.TO_STORE_CODE AND*/ HDR.FINALIZED_YN = 'N' AND DECODE (ST.ACKNOWLEDGE_REQD_YN, 'Y', HDR.PROCESS_FOR_ACKNOWLEDGE,'XX') = DECODE (ST.ACKNOWLEDGE_REQD_YN, 'Y', 'N', 'XX') AND /*UACB.USER_ID = UACA.USER_ID AND*/ UACB.STORE_CODE = HDR.FM_STORE_CODE AND HDR.DOC_TYPE_CODE LIKE ? AND TO_CHAR (HDR.DOC_NO) LIKE ? AND TO_CHAR (HDR.DOC_DATE, 'DD/MM/YYYY') LIKE ? AND HDR.FM_STORE_CODE LIKE ? AND HDR.TO_STORE_CODE LIKE ? AND NVL (HDR.ITEM_CLASS_CODE, 'X') LIKE ? AND UACB.USER_ID = ? AND (    FMS.FACILITY_ID = ? AND HDR.FACILITY_ID LIKE DECODE (TRN_ACROSS_FACILITY_YN, 'Y', '%', ? )) /*AND REQ.FACILITY_ID(+) = HDR.FACILITY_ID*/ AND FMS.LANGUAGE_ID = TOS.LANGUAGE_ID AND FMS.LANGUAGE_ID = SY.LANGUAGE_ID AND FMS.LANGUAGE_ID = SM.LANGUAGE_ID AND FMS.LANGUAGE_ID = ? AND ITM.LANGUAGE_ID(+) = ? AND ST.FACILITY_ID = HDR.FACILITY_ID AND HDR.DOC_TYPE_CODE = REQ.DOC_TYPE_CODE(+) AND HDR.DOC_NO = REQ.DOC_NO(+) AND SM.FACILITY_ID = NVL(REQ.FACILITY_ID,HDR.FACILITY_ID)"); 
		dataMap.put("SQL_FM_ISSUE_REQ_URG_ST_ITEM_MOVE_SUMM_INSERT", "INSERT into st_item_move_summ  (facility_id,	item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,urg_qty, urg_cost,out_urg_qty, out_urg_cost,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_TO_ISSUE_REQ_URG_ST_ITEM_MOVE_SUMM_INSERT", "INSERT into st_item_move_summ  (facility_id,	item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,urg_qty, urg_cost,in_urg_qty, in_urg_cost,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_REQ_URG_HDR_SELECT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, hdr.seq_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.doc_ref, hdr.fm_store_code, rbys.short_desc req_fm_store_desc, hdr.to_store_code, rons.short_desc req_to_store_desc,item_class_code FROM st_issue_hdr hdr,	mm_store rbys, mm_store	rons, sy_doc_type_master sy, st_user_access_for_store uaca, st_user_access_for_store uacb WHERE hdr.doc_type_code = sy.doc_type_code AND hdr.fm_store_code=  rbys.store_code AND hdr.to_store_code = rons.store_code AND hdr.facility_id = ? AND hdr.doc_type_code = ? AND hdr.doc_no	= ? AND	hdr.doc_date = TO_DATE(?,'dd/mm/yyyy') AND hdr.fm_store_code like ? AND hdr.to_store_code like ?  AND uaca.user_id = ? AND uaca.store_code = hdr.to_store_code AND uaca.req_allowed_yn = 'Y' AND uacb.user_id = uaca.user_id AND uacb.store_code = hdr.fm_store_code AND (uacb.iss_allowed_yn = 'Y' OR uacb.urg_allowed_yn = 'Y' AND hdr.trn_type IN ('ISS','URG')");
//
		dataMap.put("SQL_ST_URGENT_FROM_STORE",	"SELECT	st.store_code, mm.short_desc FROM st_user_access_for_store st, mm_store	mm,	sm_appl_user sm	WHERE st.store_code	= mm.store_code	 AND st.user_id=sm.appl_user_id	AND	mm.eff_status =	'E'	AND	sm.eff_status='E' AND st.urg_allowed_yn='Y'	AND	mm.facility_id =? AND st.user_id = ?  order	by 2");
		dataMap.put("SQL_ST_URGENT_TO_STORE", "SELECT st.store_code, mm.short_desc FROM	st_user_access_for_store st, mm_store mm, sm_appl_user sm, st_acc_entity_param pa WHERE	st.store_code =	mm.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status	= 'E' AND sm.eff_status='E'	AND	st.req_allowed_yn='Y' AND st.user_id = ?  AND pa.acc_entity_id=	? AND ((pa.trn_across_facility_yn='Y') OR mm.facility_id =?) order by 2");
		dataMap.put("SQL_ST_STORE_SELECT", "SELECT short_desc FROM mm_store_lang_vw	WHERE store_code=? AND language_id LIKE ?");
		dataMap.put("SQL_ST_ITEM_SELECT", "SELECT short_desc FROM mm_item_class_lang_vw	WHERE item_class_code=? AND language_id = ?");

		//dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_BATCH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	OR use_after_expiry_yn='Y' OR (expiry_yn='Y' AND (?='Y'	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");
		//Modified for PH to add barcode id 
		//dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_BATCH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	OR use_after_expiry_yn='Y' OR (expiry_yn='Y' AND (?='Y'	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) and nvl(barcode_id,'%') like (?)  ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");
		//Modified by suresh.r against ML-BRU-SCF-1005[IN:43173] on 28-04-2014
		//dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_BATCH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (   expiry_yn = 'N' /*OR use_after_expiry_yn='Y'*/ OR (    expiry_yn = 'Y'  AND (   (use_after_expiry_yn = 'Y' AND (? = 'Y')) OR expiry_date >= TRUNC (NVL (TO_DATE (?, 'dd/mm/yyyy'), SYSDATE ))))) AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) and nvl(barcode_id,'%') like (?)  ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");
		//Added barcode_id for GHL-CRF-0413
		dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_BATCH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS,barcode_id FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (   expiry_yn = 'N' /*OR use_after_expiry_yn='Y'*/ OR (    expiry_yn = 'Y'  AND (   (use_after_expiry_yn = 'Y' AND (? = 'Y')) OR expiry_date >= TRUNC (NVL (TO_DATE (?, 'dd/mm/yyyy'), SYSDATE ))))) AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) and nvl(barcode_id,'%') like (?)  ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");

		//dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_BATCH_FOR_PH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn FROM	st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	OR use_after_expiry_yn='Y' OR (expiry_yn='Y' AND (?='Y'	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 and batch_id=? and TO_CHAR(expiry_date,'dd/mm/yyyy') =? and bin_location_code=? AND language_id =? AND lang1 =? AND lang2 = ? ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");

		//dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_BATCH_FOR_PH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn FROM	st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	OR use_after_expiry_yn='Y' OR (expiry_yn='Y' AND (?='Y'	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 and batch_id=? and TO_CHAR(expiry_date,'dd/mm/yyyy') =? and bin_location_code=? AND language_id =? AND lang1 =? AND lang2 = ?  and nvl(barcode_id,'%') like (?)  ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");		
		//Modified by suresh.r against ML-BRU-SCF-1005[IN:43173] on 28-04-2014 beg
		dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_BATCH_FOR_PH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn FROM	st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	/*OR use_after_expiry_yn='Y'*/ OR (expiry_yn='Y' AND ((use_after_expiry_yn='Y' AND (?='Y'))	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 and batch_id=? and TO_CHAR(expiry_date,'dd/mm/yyyy') =? and bin_location_code=? AND language_id =? AND lang1 =? AND lang2 = ?  and nvl(barcode_id,'%') like (?)  ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");


	
		
		dataMap.put("SQL_ST_URG_ISS_HDR_INSERT", "INSERT INTO st_issue_hdr(facility_id,	doc_type_code, doc_no, seq_no,doc_date,	doc_ref, fm_store_code,to_store_code,  finalized_yn, gl_interfaced_yn, trn_type, entry_completed_yn, authorized_by_id,close_req_after_issue_yn,	remarks, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no,modified_facility_id)VALUES(?, ?,	?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, ?,	?, ?, ?, ?,	?, ?, ?, ?,	SYSDATE, ?,	?, ?, SYSDATE, ?, ?)");
		//dataMap.put("SQL_QRY_ST_ISSUE_REQ_URG_TO_STORE", "SELECT st.store_code, mm.short_desc FROM	st_store st, mm_store mm/*, sm_appl_user sm*/, st_acc_entity_param pa WHERE	st.store_code =	mm.store_code  AND /*st.user_id=sm.appl_user_id AND*/ mm.eff_status	= 'E' AND /*sm.eff_status='E' AND*/ mm.facility_id =? /*AND sm.appl_user_id = ?*/ and st.req_allowed_yn='Y'  order by 2");
		dataMap.put("SQL_QRY_ST_ISSUE_REQ_URG_TO_STORE" , "SELECT ST.STORE_CODE, MM.SHORT_DESC FROM	ST_STORE ST, MM_STORE_LANG_VW MM, ST_ACC_ENTITY_PARAM PA WHERE	ST.STORE_CODE =	MM.STORE_CODE  AND  MM.EFF_STATUS	= 'E' AND  PA.ACC_ENTITY_ID = (?) AND (TRN_ACROSS_FACILITY_YN='Y'  OR  MM.FACILITY_ID = ? ) AND ST.REQ_ALLOWED_YN='Y'  	 AND mm.language_id = ? ORDER BY 1");
		dataMap.put("SQL_ST_QRY_ST_ISSUE_REQ_URG_FROM_STORE",	"SELECT DISTINCT stp.parent_store_code, mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm , st_user_access_for_store st, SM_APPL_USER sm WHERE stp.parent_store_code = mm.store_code AND mm.eff_Status = 'E' AND st.store_code = mm.store_code AND st.user_id = sm.appl_user_id AND sm.eff_status = 'E' AND (   st.urg_allowed_yn = 'Y' OR st.urg_finalize_allowed_yn = 'Y' OR st.iss_allowed_yn = 'Y' OR  st.iss_finalize_allowed_yn = 'Y') AND mm.facility_id = ? AND st.user_id = ? AND mm.language_id = ? ORDER BY 2");
//		dataMap.put("SQL_ST_QRY_ST_ISSUE_REQ_URG_FROM_STORE",	"SELECT	st.store_code, mm.short_desc FROM st_user_access_for_store st, mm_store	mm,	sm_appl_user sm	WHERE st.store_code	= mm.store_code	 AND st.user_id=sm.appl_user_id	AND	mm.eff_status =	'E'	AND	sm.eff_status='E' AND (st.urg_allowed_yn='Y' OR st.urg_finalize_allowed_yn='Y' OR st.req_allowed_yn='Y' OR st.req_authorize_allowed_yn='Y')	AND	mm.facility_id =? AND st.user_id = ?  order	by 2");

		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE", "UPDATE st_item_move_summ SET ISS_QTY = ISS_QTY+?, ISS_COST = ISS_COST+?, MONTH_CLOSING_QTY =	MONTH_CLOSING_QTY+?, MONTH_CLOSING_VALUE = MONTH_CLOSING_VALUE+?, IN_ISS_QTY = IN_ISS_QTY+?, IN_ISS_COST = IN_ISS_COST+?, OUT_ISS_QTY_ST = OUT_ISS_QTY_ST+?, OUT_ISS_COST_ST = OUT_ISS_COST_ST+?, OUT_ISS_QTY_NS = OUT_ISS_QTY_NS+?, OUT_ISS_COST_NS = OUT_ISS_COST_NS+?, CONS_QTY = CONS_QTY+?, CONS_COST =CONS_COST+?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_FROM_NS_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, OUT_URG_QTY_NS = nvl(OUT_URG_QTY_NS,0)+?, OUT_URG_COST_NS =nvl(OUT_URG_COST_NS,0)+? ,modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_FROM_ST_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, OUT_URG_QTY_ST = nvl(OUT_URG_QTY_ST,0)+?, OUT_URG_COST_ST =nvl(OUT_URG_COST_ST,0)+? ,modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_TO_NS_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, IN_URG_QTY = nvl(IN_URG_QTY,0)+?, IN_URG_COST = nvl(IN_URG_COST,0)+?, CONS_QTY = nvl(CONS_QTY,0)+?, CONS_COST =nvl(CONS_COST,0)+?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_TO_ST_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, IN_URG_QTY = nvl(IN_URG_QTY,0)+?, IN_URG_COST = nvl(IN_URG_COST,0)+?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_INSERT", "INSERT into st_item_move_summ  (facility_id, item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,iss_qty, iss_cost, IN_ISS_QTY, IN_ISS_COST, OUT_ISS_QTY_ST, OUT_ISS_COST_ST, OUT_ISS_QTY_NS, OUT_ISS_COST_NS, CONS_QTY, CONS_COST, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");

		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_FROM_NS", "UPDATE st_item_move_summ SET ISS_QTY = nvl(ISS_QTY,0)+?, ISS_COST = nvl(ISS_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, OUT_ISS_QTY_NS = nvl(OUT_ISS_QTY_NS,0)+?, OUT_ISS_COST_NS =nvl(OUT_ISS_COST_NS,0)+? ,modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_FROM_ST", "UPDATE st_item_move_summ SET ISS_QTY = nvl(ISS_QTY,0)+?, ISS_COST = nvl(ISS_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, OUT_ISS_QTY_ST = nvl(OUT_ISS_QTY_ST,0)+?, OUT_ISS_COST_ST =nvl(OUT_ISS_COST_ST,0)+? ,modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_TO_NS", "UPDATE st_item_move_summ SET ISS_QTY = nvl(ISS_QTY,0)+?, ISS_COST = nvl(ISS_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, IN_ISS_QTY = nvl(IN_ISS_QTY,0)+?, IN_ISS_COST = nvl(IN_ISS_COST,0)+?, CONS_QTY = nvl(CONS_QTY,0)+?, CONS_COST =nvl(CONS_COST,0)+?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_TO_ST", "UPDATE st_item_move_summ SET ISS_QTY = nvl(ISS_QTY,0)+?, ISS_COST = nvl(ISS_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, IN_ISS_QTY = nvl(IN_ISS_QTY,0)+?, IN_ISS_COST = nvl(IN_ISS_COST,0)+?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
/*		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_FROM_NS_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, OUT_URG_QTY_NS = nvl(OUT_URG_QTY_NS,0)+?, OUT_URG_COST_NS =nvl(OUT_URG_COST_NS,0)+? ,modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_FROM_ST_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, OUT_URG_QTY_ST = nvl(OUT_URG_QTY_ST,0)+?, OUT_URG_COST_ST =nvl(OUT_URG_COST_ST,0)+? ,modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_TO_NS_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, IN_URG_QTY = nvl(IN_URG_QTY,0)+?, IN_URG_COST = nvl(IN_URG_COST,0)+?, CONS_QTY = nvl(CONS_QTY,0)+?, CONS_COST =nvl(CONS_COST,0)+?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_UPDATE_TO_ST_URG", "UPDATE st_item_move_summ SET URG_QTY = nvl(URG_QTY,0)+?, URG_COST = nvl(URG_COST,0)+?, MONTH_CLOSING_QTY =	nvl(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE = nvl(MONTH_CLOSING_VALUE,0)+?, IN_URG_QTY = nvl(IN_URG_QTY,0)+?, IN_URG_COST = nvl(IN_URG_COST,0)+?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?,  modified_facility_id = ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
*/
		dataMap.put("ST_SQL_ISSUE_ITEM_MOV_SUM_INSERT_URG", "INSERT into st_item_move_summ  (facility_id, item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,urg_qty, urg_cost, IN_urg_QTY, IN_urg_COST, OUT_urg_QTY_ST, OUT_urg_COST_ST, OUT_urg_QTY_NS, OUT_urg_COST_NS, CONS_QTY, CONS_COST, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_ITEM_TRN_DTL_INSERT",	"INSERT	into st_item_trn_dtl(facility_id, store_code, item_code, posted_date, trn_srl_no,trn_type,doc_type_code,doc_no,doc_srl_no,doc_date,doc_ref,batch_id,expiry_date,item_qty_normal,item_unit_cost,stk_uom_code,stock_item_yn,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id, bin_location_code, trade_id,other_store_code, seq_no) VALUES(?,?,?,SYSDATE,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?)");

		dataMap.put("SQL_ST_BATCH_STATUS_SELECT_QUERY",	"select batch_status from st_batch_control where ITEM_CODE=? and BATCH_ID=? AND expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy') ");
//
// issue end
// Added for Requisition Issue

		/* ADDED BY	PANKAJ */

		/* For Administration-->USER ACCESS FOR STORE */

		dataMap.put("SQL_SM_APPL_USER_USER_LOOK_UP", " SELECT appl_user_id code,	appl_user_name  description             FROM	   sm_appl_user_lang_vw sm_appl_user  where   language_id like ?   AND      eff_status='E'  AND appl_user_id	 like    UPPER(?)  AND  UPPER(appl_user_name)	  like  UPPER(?) ");
		//dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SELECT_SINGLE", "SELECT user_id,store_code,obs_allowed_yn,grn_allowed_yn,grn_finalize_allowed_yn,rtv_allowed_yn,rtv_finalize_allowed_yn,mfg_allowed_yn,req_allowed_yn,req_authorize_allowed_yn,iss_allowed_yn,urg_allowed_yn,urg_finalize_allowed_yn,ret_allowed_yn,ret_finalize_allowed_yn,tfr_allowed_yn,tfr_finalize_allowed_yn,adj_allowed_yn,adj_finalize_allowed_yn,var_allowed_yn,prt_allowed_yn,sal_allowed_yn,sal_authorize_allowed_yn,srt_allowed_yn,srt_finalize_allowed_yn,split_batch_allowed_yn,bin_change_allowed_yn,iss_finalize_allowed_yn,mfg_finalize_allowed_yn,authorize_special_req_yn,stk_item_con_allowed_yn FROM	ST_USER_ACCESS_FOR_STORE where user_id = ? AND store_code =? ");
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SELECT_STORE_SINGLE","SELECT   A.STORE_CODE, A.STORE_TYPE_FLAG,	A.MEDICAL_ITEM_YN ,	  A.NONMEDICAL_ITEM_YN,	A.REORDER_FREQ_DAYS, A.CHK_STK_LVL_FOR_PUR_YN, A.GRN_ALLOWED_YN, A.RTV_ALLOWED_YN, A.MFG_ALLOWED_YN,  A.REQ_ALLOWED_YN,	A.ISS_ALLOWED_YN,  A.URG_ALLOWED_YN, A.RET_ALLOWED_YN,	A.TFR_ALLOWED_YN ,A.ADJ_ALLOWED_YN,	 A.VAR_ALLOWED_YN, A.PRT_ALLOWED_YN,  A.SAL_ALLOWED_YN,	A.SRT_ALLOWED_YN, A.SPLIT_BATCH_ALLOWED_YN,   A.BIN_CHANGE_ALLOWED_YN,	A.OBS_ALLOWED_YN,	A.PARENT_STORE_CODE	,B.SHORT_DESC STORE_DESC, C.SHORT_DESC DEPT_DESC, B.EXTERNAL_YN,A.AUTHORIZE_SPECIAL_REQ_YN, A.STK_ITEM_CON_ALLOWED_YN, A.ALERT_FOR_PRINT_PICKSLIP_YN,A.PRQ_ALLOWED_YN FROM ST_STORE A,MM_STORE B,	AM_DEPT	C WHERE	A.STORE_CODE = ? AND /* B.FACILITY_ID=? AND */ A.STORE_CODE=B.STORE_CODE AND B.DEPT_CODE=C.DEPT_CODE(+)");
//		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SELECT_SINGLE", "SELECT user_id,store_code,obs_allowed_yn,grn_allowed_yn,grn_finalize_allowed_yn,rtv_allowed_yn,rtv_finalize_allowed_yn,mfg_allowed_yn,req_allowed_yn,req_authorize_allowed_yn,iss_allowed_yn,urg_allowed_yn,urg_finalize_allowed_yn,ret_allowed_yn,ret_finalize_allowed_yn,tfr_allowed_yn,tfr_finalize_allowed_yn,adj_allowed_yn,adj_finalize_allowed_yn,var_allowed_yn,prt_allowed_yn,sal_allowed_yn,sal_authorize_allowed_yn,srt_allowed_yn,srt_finalize_allowed_yn,split_batch_allowed_yn,bin_change_allowed_yn,iss_finalize_allowed_yn,mfg_finalize_allowed_yn,authorize_special_req_yn,stk_item_con_allowed_yn,process_expired_items_yn,process_suspended_items_yn  FROM	ST_USER_ACCESS_FOR_STORE where user_id = ? AND store_code =? "); Commented for ML-MMOH-CRF-0448 B.Badmavathi
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SELECT_SINGLE", "SELECT user_id,store_code,obs_allowed_yn,grn_allowed_yn,grn_finalize_allowed_yn,rtv_allowed_yn,rtv_finalize_allowed_yn,mfg_allowed_yn,req_allowed_yn,req_authorize_allowed_yn,iss_allowed_yn,urg_allowed_yn,urg_finalize_allowed_yn,ret_allowed_yn,ret_finalize_allowed_yn,tfr_allowed_yn,tfr_finalize_allowed_yn,adj_allowed_yn,adj_finalize_allowed_yn,var_allowed_yn,prt_allowed_yn,sal_allowed_yn,sal_authorize_allowed_yn,srt_allowed_yn,srt_finalize_allowed_yn,split_batch_allowed_yn,bin_change_allowed_yn,iss_finalize_allowed_yn,mfg_finalize_allowed_yn,authorize_special_req_yn,stk_item_con_allowed_yn,process_expired_items_yn,process_suspended_items_yn,PRT_FINALIZE_ALLOWED_YN  FROM	ST_USER_ACCESS_FOR_STORE where user_id = ? AND store_code =? ");
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_COUNT", "SELECT COUNT(*) cnt FROM	st_user_access_for_store WHERE store_code= ? and user_id= ?	");
		//dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_INSERT", "INSERT INTO	ST_USER_ACCESS_FOR_STORE(user_id,store_code,obs_allowed_yn,grn_allowed_yn,grn_finalize_allowed_yn,rtv_allowed_yn,rtv_finalize_allowed_yn,mfg_allowed_yn,req_allowed_yn,req_authorize_allowed_yn,iss_allowed_yn,urg_allowed_yn,urg_finalize_allowed_yn,ret_allowed_yn,ret_finalize_allowed_yn,tfr_allowed_yn,tfr_finalize_allowed_yn,adj_allowed_yn,adj_finalize_allowed_yn,var_allowed_yn,prt_allowed_yn,sal_allowed_yn,sal_authorize_allowed_yn,srt_allowed_yn,srt_finalize_allowed_yn,split_batch_allowed_yn,bin_change_allowed_yn,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,iss_finalize_allowed_yn,mfg_finalize_allowed_yn,authorize_special_req_yn,stk_item_con_allowed_yn) values(?, ?,	?, ?, ?, ?,	?, ?, ?, ?,?, ?, ?,	?, ?, ?, ?,	?, ?, ?,?, ?, ?, ?,	?, ?, ?, ?, SYSDATE,	?, ?, ?, SYSDATE, ?, ?,	?, ?, ?, ? )"	);
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_INSERT", "INSERT INTO	ST_USER_ACCESS_FOR_STORE (USER_ID,STORE_CODE,OBS_ALLOWED_YN,GRN_ALLOWED_YN, GRN_FINALIZE_ALLOWED_YN, RTV_ALLOWED_YN,RTV_FINALIZE_ALLOWED_YN,MFG_ALLOWED_YN,REQ_ALLOWED_YN,REQ_AUTHORIZE_ALLOWED_YN,ISS_ALLOWED_YN,URG_ALLOWED_YN,URG_FINALIZE_ALLOWED_YN,RET_ALLOWED_YN,RET_FINALIZE_ALLOWED_YN,TFR_ALLOWED_YN,TFR_FINALIZE_ALLOWED_YN,ADJ_ALLOWED_YN,ADJ_FINALIZE_ALLOWED_YN,VAR_ALLOWED_YN,PRT_ALLOWED_YN,SAL_ALLOWED_YN,SAL_AUTHORIZE_ALLOWED_YN,SRT_ALLOWED_YN,SRT_FINALIZE_ALLOWED_YN,SPLIT_BATCH_ALLOWED_YN,BIN_CHANGE_ALLOWED_YN,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ISS_FINALIZE_ALLOWED_YN,MFG_FINALIZE_ALLOWED_YN,AUTHORIZE_SPECIAL_REQ_YN,STK_ITEM_CON_ALLOWED_YN,PROCESS_EXPIRED_ITEMS_YN,PROCESS_SUSPENDED_ITEMS_YN,ISS_ACKNOWLEDGE_YN, ISS_CONFIRM_YN, URG_ACKNOWLEDGE_YN, URG_CONFIRM_YN, RET_ACKNOWLEDGE_YN, RET_CONFIRM_YN, TFR_ACKNOWLEDGE_YN, TFR_CONFIRM_YN,CANCL_ALLOWED_YN,PRQ_ALLOWED_YN,PRQ_FINALIZE_ALLOWED_YN) VALUES(?, ?,?, ?, ?, ?,	?, ?, ?, ?,?, ?, ?,	?, ?, ?, ?,	?, ?, ?,?, ?, ?, ?,	?, ?, ?, ?, SYSDATE,	?, ?, ?, SYSDATE, ?, ?,	?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?) "	);
		//dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_UPDATE", "UPDATE st_user_access_for_store	 SET  obs_allowed_yn=?,grn_allowed_yn=?,grn_finalize_allowed_yn=?,rtv_allowed_yn=?,rtv_finalize_allowed_yn=?,mfg_allowed_yn=?,req_allowed_yn=?,req_authorize_allowed_yn=?,iss_allowed_yn=?,urg_allowed_yn=?,urg_finalize_allowed_yn=?,ret_allowed_yn=?,ret_finalize_allowed_yn=?,tfr_allowed_yn=?,tfr_finalize_allowed_yn=?,adj_allowed_yn=?,adj_finalize_allowed_yn=?,var_allowed_yn=?,prt_allowed_yn=?,sal_allowed_yn=?,sal_authorize_allowed_yn=?,srt_allowed_yn=?,srt_finalize_allowed_yn=?,split_batch_allowed_yn=?,bin_change_allowed_yn=?,modified_by_id=?,modified_date=SYSDATE,modified_at_ws_no=?,modified_facility_id=?,iss_finalize_allowed_yn=?,mfg_finalize_allowed_yn=?,authorize_special_req_yn=? ,stk_item_con_allowed_yn = ? where user_id=? and store_code=?	");
		
		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_UPDATE", "UPDATE ST_USER_ACCESS_FOR_STORE	 SET  OBS_ALLOWED_YN=?,GRN_ALLOWED_YN=?,GRN_FINALIZE_ALLOWED_YN=?, RTV_ALLOWED_YN=?, RTV_FINALIZE_ALLOWED_YN=?,MFG_ALLOWED_YN=?,REQ_ALLOWED_YN=?,REQ_AUTHORIZE_ALLOWED_YN=?,ISS_ALLOWED_YN=?,URG_ALLOWED_YN=?,URG_FINALIZE_ALLOWED_YN=?,RET_ALLOWED_YN=?,RET_FINALIZE_ALLOWED_YN=?,TFR_ALLOWED_YN=?,TFR_FINALIZE_ALLOWED_YN=?,ADJ_ALLOWED_YN=?,ADJ_FINALIZE_ALLOWED_YN=?,VAR_ALLOWED_YN=?,PRT_ALLOWED_YN=?,SAL_ALLOWED_YN=?,SAL_AUTHORIZE_ALLOWED_YN=?,SRT_ALLOWED_YN=?,SRT_FINALIZE_ALLOWED_YN=?,SPLIT_BATCH_ALLOWED_YN=?,BIN_CHANGE_ALLOWED_YN=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?,ISS_FINALIZE_ALLOWED_YN=?,MFG_FINALIZE_ALLOWED_YN=?,AUTHORIZE_SPECIAL_REQ_YN=? ,STK_ITEM_CON_ALLOWED_YN = ?,PROCESS_EXPIRED_ITEMS_YN=?, PROCESS_SUSPENDED_ITEMS_YN=?, ISS_ACKNOWLEDGE_YN=?, ISS_CONFIRM_YN=?, URG_ACKNOWLEDGE_YN=?, URG_CONFIRM_YN=?, RET_ACKNOWLEDGE_YN=?, RET_CONFIRM_YN=?, TFR_ACKNOWLEDGE_YN=?, TFR_CONFIRM_YN=?,CANCL_ALLOWED_YN=?, PRQ_ALLOWED_YN=?, PRQ_FINALIZE_ALLOWED_YN=?  WHERE USER_ID=? AND STORE_CODE=?  ");

		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_QUERY_RESULT","SELECT apu.appl_user_id user_id, apu.appl_user_name appl_user_name,   mm.store_code store_code, mm.short_desc short_desc, ua.obs_allowed_yn,ua.grn_allowed_yn, ua.grn_finalize_allowed_yn, ua.rtv_allowed_yn, ua.rtv_finalize_allowed_yn, ua.mfg_allowed_yn, ua.req_allowed_yn,ua.req_authorize_allowed_yn, ua.iss_allowed_yn, ua.urg_allowed_yn,ua.urg_finalize_allowed_yn, ua.ret_allowed_yn,ua.ret_finalize_allowed_yn, ua.tfr_allowed_yn,      ua.tfr_finalize_allowed_yn, ua.adj_allowed_yn, ua.adj_finalize_allowed_yn, ua.var_allowed_yn, ua.prt_allowed_yn,    ua.sal_allowed_yn, ua.sal_authorize_allowed_yn, ua.srt_allowed_yn,ua.srt_finalize_allowed_yn, ua.split_batch_allowed_yn,ua.bin_change_allowed_yn, ua.iss_finalize_allowed_yn,ua.mfg_finalize_allowed_yn, ua.stk_item_con_allowed_yn,ST.OBS_ALLOWED_YN st_obs_allowed_yn, ST.GRN_ALLOWED_YN st_grn_allowed_yn, ST.GRN_ALLOWED_YN st_grn_finalize_allowed_yn, ST.RTV_ALLOWED_YN st_rtv_allowed_yn, ST.RTV_ALLOWED_YN st_rtv_finalize_allowed_yn,ST.MFG_ALLOWED_YN st_mfg_allowed_yn, ST.REQ_ALLOWED_YN st_req_allowed_yn, ST.REQ_ALLOWED_YN st_req_authorize_allowed_yn,ST.ISS_ALLOWED_YN st_iss_allowed_yn, ST.URG_ALLOWED_YN st_urg_allowed_yn, ST.URG_ALLOWED_YN st_urg_finalize_allowed_yn,ST.RET_ALLOWED_YN st_ret_allowed_yn, ST.RET_ALLOWED_YN st_ret_finalize_allowed_yn,ST.TFR_ALLOWED_YN st_tfr_allowed_yn, ST.TFR_ALLOWED_YN st_tfr_finalize_allowed_yn,ST.ADJ_ALLOWED_YN st_adj_allowed_yn, ST.ADJ_ALLOWED_YN st_adj_finalize_allowed_yn,ST.VAR_ALLOWED_YN st_var_allowed_yn, ST.PRT_ALLOWED_YN st_prt_allowed_yn, ST.SAL_ALLOWED_YN st_sal_allowed_yn, ST.SAL_ALLOWED_YN st_sal_authorize_allowed_yn,ST.SRT_ALLOWED_YN st_srt_allowed_yn, ST.SRT_ALLOWED_YN st_srt_finalize_allowed_yn,ST.SPLIT_BATCH_ALLOWED_YN st_split_batch_allowed_yn,ST.BIN_CHANGE_ALLOWED_YN st_bin_change_allowed_yn,ST.ISS_ALLOWED_YN st_iss_finalize_allowed_yn,ST.MFG_ALLOWED_YN st_mfg_finalize_allowed_yn,ST.STK_ITEM_CON_ALLOWED_YN st_stk_item_con_allowed_yn,ua.CANCL_ALLOWED_YN,ua.prq_allowed_yn,  ua.prq_finalize_allowed_yn FROM st_user_access_for_store ua,  st_store st, mm_store_lang_vw mm, sm_appl_user_lang_vw apu  WHERE mm.eff_status = 'E'   AND mm.store_code = st.store_code   AND ua.store_code = st.store_code   AND ua.user_id = apu.appl_user_id   AND apu.eff_status = 'E'  AND UPPER (apu.appl_user_id) LIKE UPPER (?)   AND UPPER (apu.appl_user_name) LIKE UPPER (?)   AND UPPER (mm.store_code) LIKE UPPER (?) AND UPPER (mm.short_desc) LIKE UPPER (?) AND mm.language_id = apu.language_id AND mm.language_id = ? " );

		/* For Master function...Prepare Location */

		dataMap.put("SQL_ST_PREPARE_LOCATION_INSERT", "INSERT INTO st_prepare_location ( prepare_location_code,	long_desc, short_desc,facility_id, eff_status, added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id , auto_gen_batch_yn , next_batch_id , batch_id_series )	VALUES ( ?,	?, ?, ?, ?,	?, SYSDATE,	?, ?, ?, SYSDATE, ?, ?, ?, ?, ? )");
		dataMap.put("SQL_ST_PREPARE_LOCATION_SELECT_SINGLE", "SELECT prepare_location_code,	long_desc, short_desc, facility_id,	eff_status FROM	st_prepare_location_lang_vw st_prepare_location	WHERE prepare_location_code	= ? AND language_id = ?");
		dataMap.put("SQL_ST_PREPARE_LOCATION_UPDATE", "UPDATE st_prepare_location SET long_desc	= ?, short_desc	= ?, eff_status	= ?, modified_by_id	= ?, modified_date = SYSDATE, modified_at_ws_no	=?,	modified_facility_id = ? WHERE prepare_location_code = ?");
		dataMap.put("SQL_ST_PREPARE_LOCATION_COUNT", "SELECT COUNT(*) COUNT	FROM st_prepare_location WHERE prepare_location_code = ?");
		dataMap.put("SQL_ST_PREPARE_LOCATION_QUERY_RESULT",	"SELECT	prepare_location_code, long_desc, short_desc, eff_status, auto_gen_batch_yn, batch_id_series , next_batch_id FROM st_prepare_location_lang_vw st_prepare_location WHERE	prepare_location_code LIKE UPPER(?)	AND	UPPER(long_desc) LIKE UPPER(?) AND eff_status LIKE ? AND language_id = ?");
		dataMap.put("SQL_ST_PREPARE_LOCATION_SELECT_LIST", "SELECT prepare_location_code, short_desc FROM st_prepare_location WHERE	eff_status='E' AND facility_id=? ORDER BY prepare_location_code");
//		dataMap.put("SQL_ST_PREPARE_LOCATION_UPDATE_BATCH","UPDATE st_prepare_location SET   next_batch_id = ?  WHERE prepare_location_code = ?"); // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_PREPARE_LOCATION_UPDATE_BATCH","UPDATE st_prepare_location SET   next_batch_id = ? , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE prepare_location_code = ?");
		dataMap.put("SQL_ST_PREPARE_LOCATION_SELECT_BATCH_ID", "SELECT auto_gen_batch_yn , next_batch_id, batch_id_series FROM	st_prepare_location	WHERE prepare_location_code	= ? ");
		

		/* For Master function.... Repacking Groop */
		dataMap.put("SQL_ST_REPACKING_GROUP_INSERT", "INSERT INTO st_repacking_group ( repacking_group_code,	long_desc, short_desc,facility_id, auto_gen_batch_yn, next_batch_id, eff_status, added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,batch_id_series )	VALUES ( ?,	?, ?, ?, ? , ? , ?,	?, SYSDATE,	?, ?, ?, SYSDATE, ?, ?, ? )");
		dataMap.put("SQL_ST_REPACKING_GROUP_SELECT_SINGLE", "SELECT repacking_group_code,	long_desc, short_desc, facility_id,	eff_status FROM	st_repacking_group_lang_vw st_repacking_group	WHERE repacking_group_code	= ? AND language_id = ?");
        dataMap.put("SQL_ST_REPACKING_GROUP_SELECT_BATCH_ID", "SELECT auto_gen_batch_yn , next_batch_id, batch_id_series FROM	st_repacking_group	WHERE repacking_group_code	= ? ");

//		dataMap.put("SQL_ST_REPACKING_GROUP_UPDATE", "UPDATE st_repacking_group SET long_desc	= ?, short_desc	= ?, auto_gen_batch_yn = ? , next_batch_id = ?, eff_status	= ?, modified_by_id	= ?, modified_date = SYSDATE, modified_at_ws_no	=?,	modified_facility_id = ? WHERE repacking_group_code = ?");
		dataMap.put("SQL_ST_REPACKING_GROUP_UPDATE", "UPDATE st_repacking_group SET long_desc	= ?, short_desc	= ?,  eff_status	= ?, modified_by_id	= ?, modified_date = SYSDATE, modified_at_ws_no	=?,	modified_facility_id = ? WHERE repacking_group_code = ?");
//		dataMap.put("SQL_ST_REPACKING_GROUP_UPDATE_BATCH","UPDATE st_repacking_group SET   next_batch_id = ?  WHERE repacking_group_code = ?"); // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_REPACKING_GROUP_UPDATE_BATCH","UPDATE st_repacking_group SET   next_batch_id = ? , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE repacking_group_code = ?");
		dataMap.put("SQL_ST_REPACKING_GROUP_COUNT", "SELECT COUNT(*) COUNT	FROM st_repacking_group WHERE repacking_group_code = ?");
		dataMap.put("SQL_ST_REPACKING_GROUP_QUERY_RESULT",	"SELECT	repacking_group_code, long_desc, short_desc, auto_gen_batch_yn, batch_id_series,next_batch_id, eff_status FROM st_repacking_group_lang_vw st_repacking_group WHERE	repacking_group_code LIKE UPPER(?)	AND	UPPER(long_desc) LIKE UPPER(?) AND eff_status LIKE ? AND language_id = ?");
		dataMap.put("SQL_ST_REPACKING_GROUP_SELECT_LIST", "SELECT repacking_group_code, short_desc FROM st_repacking_group WHERE	eff_status='E' AND facility_id=? ORDER BY repacking_group_code");
		/* For Reports Function......	*/

		dataMap.put("SQL_SM_MASTER_CODE_SELECT_REPORTS", "SELECT table_id, master_code_desc	 FROM sm_master_code WHERE module_id= ?	  order	by master_code ");
		dataMap.put("SQL_SM_MASTER_CODE_SELECT_REPORTS_LANG", "SELECT table_id, master_code_desc	 FROM sm_master_code_lang_vw WHERE module_id= ?	  AND language_id = ? order	by master_code");
		dataMap.put("SQL_ST_MACHINE_CODE_LOOKUP", "SELECT machine_code code, machine_name description FROM st_machine_lang_vw st_machine WHERE	eff_status='E' AND UPPER(added_facility_id)	LIKE UPPER(?) AND machine_code LIKE	UPPER(?) AND machine_name LIKE ? AND language_id = ");
		dataMap.put("SQL_ST_MACHINE_CODE_LOOKUP_FOR_REPROT", "SELECT machine_code code, machine_name description FROM st_machine_lang_vw st_machine WHERE UPPER(added_facility_id)	LIKE UPPER(?) AND upper(machine_code) LIKE	UPPER(?) AND upper(machine_name) LIKE upper(?) AND language_id = ");
		dataMap.put("SQL_ST_MANUFACTURER_ID_LOOKUP", "SELECT DISTINCT am.manufacturer_id	code, am.short_name	description	 FROM  am_manufacturer am,st_machine st	WHERE st.manufacturer_id=am.manufacturer_id	 AND st.eff_status='E' AND UPPER(st.added_facility_id) LIKE	UPPER(?) AND UPPER(am.manufacturer_id) LIKE	UPPER(?) AND UPPER(am.short_name) LIKE UPPER(?)	ORDER BY 1 ");
		dataMap.put("SQL_ST_MANUFACTURER_ID_LOOKUP_FOR_REPORT", "SELECT DISTINCT am.manufacturer_id	code, am.short_name	description	 FROM  am_manufacturer_lang_vw am,st_machine st	WHERE st.manufacturer_id=am.manufacturer_id	AND am.language_id = ? AND UPPER(st.added_facility_id) LIKE	UPPER(?) AND UPPER(am.manufacturer_id) LIKE	UPPER(?) AND UPPER(am.short_name) LIKE UPPER(?)	ORDER BY 2");
		dataMap.put("SQL_ST_DEPT_LOOKUP",	"SELECT	a.dept_code	code,  a.short_desc	description	FROM am_dept a ,am_facility_dept b WHERE a.dept_code =b.dept_code and b.operating_facility_id like ? and  a.dept_code LIKE upper(?)	AND	upper(a.short_desc)	like upper(?)  order by	2");
		dataMap.put("SQL_ST_ITEM_CLASS_LOOKUP",	"SELECT	item_class_code	code,short_desc	description	FROM mm_item_class WHERE eff_status='E'	AND	item_class_code	LIKE upper(?) AND upper(short_desc)	LIKE upper(?)  ");
		dataMap.put("SQL_ST_ITEM_CLASS_LOOKUP_LANG",	"SELECT MM_ITEM_CLASS.ITEM_CLASS_CODE CODE,MM_ITEM_CLASS.SHORT_DESC DESCRIPTION FROM MM_ITEM_CLASS_LANG_VW MM_ITEM_CLASS WHERE MM_ITEM_CLASS.EFF_STATUS='E' AND UPPER(MM_ITEM_CLASS.ITEM_CLASS_CODE) LIKE UPPER(?) AND UPPER(MM_ITEM_CLASS.SHORT_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_ST_ITEM_CLASS_LOOKUP_FOR_REPORT",	"SELECT ITEM_CLASS_CODE CODE,SHORT_DESC DESCRIPTION FROM MM_ITEM_CLASS_LANG_VW MM_ITEM_CLASS WHERE EFF_STATUS='E' AND UPPER(ITEM_CLASS_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND LANGUAGE_ID= ");
		dataMap.put("SQL_ST_PREPARE_LOCATION_LOOKUP", "SELECT  prepare_location_code   	code, short_desc     description    FROM    st_prepare_location_lang_vw st_prepare_location   WHERE    eff_status='E'	  AND   language_id  like ?   AND  	 prepare_location_code LIKE upper(?)	AND	  upper(short_desc) LIKE upper(?)	ORDER BY 2");
		dataMap.put("SQL_ST_TRN_DOC_TYPE_LOOKUP", "Select   a.doc_type_code    code, 	b.short_desc  description    FROM    st_trn_doc_type a, sy_doc_type_master_lang_vw  b     Where   b.language_id like  ?    AND   a.facility_id  like (?)    AND   a.doc_type_code LIKE	  upper(?) AND   upper(b.short_desc)   like upper(?)   and  a.doc_type_code = b.doc_type_code and A.TRN_TYPE not in ('PRQ','SPB','CBL','SAL','SRT','CEB') order by 	2");
		dataMap.put("SQL_ST_ALPHA_LOOKUP","SELECT mm.alpha_code	code, mm.short_desc	description	FROM mm_item_lang_vw mm	WHERE mm.eff_status	= 'E' AND mm.language_id = ? AND mm.alpha_code	LIKE UPPER(?) AND upper(mm.short_desc) LIKE	upper(?) ORDER BY mm.short_desc" );
		dataMap.put("SQL_ST_STERILE_TYPE_LOOKUP","SELECT ss.sterile_type code,ss.short_desc	description	FROM SS_STERILIZATION_TYPE ss ,st_item st WHERE	ss.eff_status =	'E'	AND	 st.sterile_type=ss.sterile_type AND ss.sterile_type LIKE UPPER(?) AND upper(ss.short_desc)	LIKE upper(?)");
		dataMap.put("SQL_ST_ITEM_ANAL_CODE_SELECT_SINGLE", "SELECT item_anal_code,short_desc FROM MM_ITEM_ANALYSIS_LANG_VW mm_item_analysis_lang WHERE eff_status='E' AND language_id= ? order by short_desc");
		// Added on 11/25/2005 
		dataMap.put("SQL_ST_MFG_ITEM_LABEL_REPORT","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date,a.doc_ref, a.store_code, c.short_desc store_desc FROM ST_MFG_HDR  a, sy_doc_type_master b, mm_store c  WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.store_code  = c.store_code AND  a.finalized_yn ='Y' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%')  AND a.store_code LIKE NVL(upper(?),'%') AND TRUNC(A.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
		dataMap.put("SQL_ST_REPACK_LABEL_REPORT", "SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc  FROM ST_PROD_TRANSFER_HDR  a, sy_doc_type_master b, mm_store c  WHERE  a.facility_id =?  AND a.doc_type_code = b.doc_type_code  AND a.store_code  = c.store_code  AND a.finalized_yn ='Y'  AND a.doc_type_code LIKE NVL(?,'%')   AND a.doc_no LIKE NVL(?,'%')  AND a.store_code LIKE NVL(upper(?),'%')  AND TRUNC(A.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR')  ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

		/* For Transaction Function	-->	Change Bin Location	 */

		 dataMap.put("SQL_ST_CHANGE_BIN_LOCATION_HDR_INSERT","INSERT INTO ST_CHANGE_BIN_LOC_HDR(facility_id,doc_type_code,doc_no,doc_date,doc_ref,store_code,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) values (?	, ?	,? ,to_date(?,'dd/mm/yyyy')	,? , ? ,? ,SYSDATE ,? ,? ,?	,SYSDATE ,?	,?)");
		 dataMap.put("SQL_ST_CHANGE_BIN_LOCATION_DTL_INSERT","INSERT INTO ST_CHANGE_BIN_LOC_DTL( facility_id,doc_type_code,doc_no,doc_srl_no,store_code,item_code,batch_id,fm_bin_location_code,to_bin_location_code,expiry_date_or_receipt_date,item_qty,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,trade_id,barcode_id) VALUES( ? ,?	,? ,? ,? ,?	,? ,? ,? ,TO_DATE(?,'dd/mm/yyyy') ,? ,?	,SYSDATE ,?	,? ,? ,SYSDATE ,? ,?,?,?)");
//		 dataMap.put("SQL_ST_CHANGE_BIN_LOCATION_ITEM_BATCH_UPDATE","UPDATE	ST_ITEM_BATCH SET qty_on_hand  = ? WHERE store_code= ?,item_code=?,batch_id=?,bin_location_code	=?,expiry_date_or_receipt_date =?" );  // Modified on 5/29/2006 for updating modification details  Not Used
		 dataMap.put("SQL_ST_CHANGE_BIN_LOCATION_ITEM_BATCH_UPDATE","UPDATE	ST_ITEM_BATCH SET qty_on_hand  = ? modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE store_code= ?,item_code=?,batch_id=?,bin_location_code	=?,expiry_date_or_receipt_date =?" );
		 dataMap.put("SQL_ST_CHANGE_BIN_STORE_SELECT","SELECT st.store_code, mm.short_desc FROM	st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user sm, st_store ststr WHERE	st.store_code =	mm.store_code and st.store_code = ststr.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status	= 'E' AND sm.eff_status='E'	AND	(st.BIN_CHANGE_ALLOWED_YN='Y' and ststr.BIN_CHANGE_ALLOWED_YN='Y') AND mm.facility_id	=? AND st.user_id =	?  AND mm.language_id = ? ORDER BY	2");
		 dataMap.put("SQL_ST_CHANGE_BIN_LOCATION_ITEM_TRN_DTL_INSERT","INSERT INTO st_item_trn_dtl(facility_id, store_code, item_code, posted_date, trn_srl_no,trn_type, doc_type_code, doc_no, doc_srl_no, doc_date, doc_ref, batch_id,expiry_date, item_qty_normal, stk_uom_code, stock_item_yn, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,modified_facility_id, bin_location_code, trade_id,item_unit_cost) values ( ?, ?, ?,SYSDATE , ?, ?, ?, ?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, ?,?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ?, ?, ? )");

		/* for Administration function --> Transaction Type	*/

		dataMap.put("SQL_ST_TRN_TYPE_SELECT","SELECT   trn_type, long_desc, short_desc, item_class_based_yn, doc_date_modifiable_yn, records_per_trn  FROM st_trn_type_lang_vw st_trn_type,st_acc_entity_param D WHERE language_id = ? AND trn_type NOT IN ('REQ') AND ((trn_type NOT IN('PRQ') OR trn_type = 'PRQ' AND d.ACC_ENTITY_ID=? and d.INTERFACE_TO_EXTERNAL_PO_YN='Y')) order by 3");

		dataMap.put("SQL_ST_TRN_TYPE_UPDATE", "UPDATE st_trn_type  SET item_class_based_yn=	?  , doc_date_modifiable_yn= ?, records_per_trn =?,item_class_wise_documents_yn = ?	, modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ? WHERE trn_type = ? ");

		/* For Transaction function	-->	Product	Transfer  */

		dataMap.put("SQL_ST_PRODUCT_TRANSFER_STORE_SELECT","SELECT   st.store_code, mm.short_desc FROM st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user sm, st_store ststr WHERE st.store_code = mm.store_code AND st.store_code = ststr.store_code AND st.user_id = sm.appl_user_id      AND mm.eff_status = 'E' AND sm.eff_status = 'E' AND (NVL(st.prt_allowed_yn,'N') = 'Y' AND NVL(ststr.prt_allowed_yn,'N') = 'Y') AND mm.facility_id = ? AND st.user_id = ? AND mm.language_id = ? order BY 2 ");

		dataMap.put("SQL_ST_PRODUCT_TRANSFER_HDR_INSERT","INSERT INTO ST_PROD_TRANSFER_HDR (facility_id,doc_type_code,doc_no,doc_date,doc_ref,store_code,fm_item_code,to_item_code,fm_stk_uom_code,to_stk_uom_code,fm_stk_uom_conv_factor,to_stk_uom_conv_factor,fm_item_batch_id,to_item_batch_id,fm_expiry_date,to_expiry_date,fm_item_qty,to_item_qty,finalized_yn,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,to_item_exp_qty, fm_item_exp_bal_qty, fm_item_act_bal_qty,time_taken, packed_by,counter_checked, authorized_by,remarks,prepare_location_code,no_of_labels,prod_tfr_request_no) VALUES (	? ,	? ,? , TO_DATE(?,'dd/mm/yyyy') ,? ,	? ,? , ? ,?	, ?	,? , ? ,? ,	? ,TO_DATE(?,'dd/mm/yyyy') , TO_DATE(?,'dd/mm/yyyy') ,?	, ?	,? , ? ,SYSDATE	, ?	,? , ? ,SYSDATE	,  ?, ?, ?,  ?,  ?,TO_DATE(?,'HH24:MI'), ? , ? , ? , ? , ?,?,?)");
		dataMap.put("SQL_ST_PRODUCT_TRANSFER_DTL_INSERT","INSERT INTO ST_PROD_TRANSFER_DTL(facility_id,doc_type_code,doc_no,doc_srl_no,store_code,item_code,item_qty,item_unit_cost,item_cost_value,stock_item_yn,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) VALUES(?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_BIN_LOCATION_SELECT", "SELECT bin_location_code FROM st_item_store	WHERE store_code= ?	AND	item_code= ? " );
		dataMap.put("SQL_ST_PRODUCT_TRANSFER_DTL_EXP_INSERT","INSERT INTO st_prod_transfer_dtl_exp(facility_id,doc_type_code,doc_no,doc_srl_no,store_code,item_code,batch_id,bin_location_code,expiry_date_or_receipt_date,item_qty,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,trade_id,barcode_id) VALUES ( ? , ? ,?	, ?	,? , ? ,? ,	? ,TO_DATE(?,'dd/mm/yyyy') , ? ,? ,	SYSDATE	,? , ? ,? ,	SYSDATE	,? , ? ,?,? )" );
        dataMap.put("SQL_ST_PRODUCT_TRANSFER_ITEM_TRN_DTL_INSERT","INSERT INTO st_item_trn_dtl(facility_id,		   store_code,item_code, posted_date, trn_srl_no  ,	trn_type , doc_type_code, doc_no , doc_srl_no, doc_date	, doc_ref  , batch_id  ,  expiry_date, item_qty_normal,	item_qty_bonus	, item_qty_sample  , item_unit_cost	 ,	item_unit_price	,  stk_uom_code	, pur_uom_conv ,	 supp_code	, source_doc_type_code,source_doc_no ,	source_doc_srl_no, source_doc_date ,  other_store_code ,stock_item_yn ,	lend_borrow_entity_type, lend_borrow_entity_code , added_by_id , added_date	  ,	added_at_ws_no,	added_facility_id, modified_by_id ,	 modified_date , modified_at_ws_no,	modified_facility_id,sal_trn_type,bin_location_code,trade_id		   )VALUES(?,?,?,sysdate,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,TO_DATE(?,'dd/mm/yyyy'),nvl(?,0),nvl(?,0),nvl(?,0),?,?,?,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?)");
//		dataMap.put("SQL_ST_REPACKGROUP_NEXT_BATCH_ID_UPDATE", "UPDATE	st_repacking_group  SET  next_batch_id = next_batch_id + 1 WHERE repacking_group_code = ?");  // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_REPACKGROUP_NEXT_BATCH_ID_UPDATE", "UPDATE	st_repacking_group  SET  next_batch_id = next_batch_id + 1 , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE repacking_group_code = ?");

		dataMap.put("SQL_TRADE_ID_APPLICABLE_SELECT", "SELECT TRADE_ID_APPLICABLE_YN  FROM st_item WHERE item_code=	? "	);
		dataMap.put("SQL_DFLT_TRADE_ID_SELECT",	"SELECT	DFLT_TRADE_ID FROM mm_parameter");
		dataMap.put("SQL_ITEM_TRADE_SELECT", "SELECT COUNT(*) FROM mm_trade_name_for_item WHERE	item_code =	? AND trade_id=	? "	);
		dataMap.put("SQL_ITEM_CODE_TRADE_ID_INSERT", "INSERT INTO  mm_trade_name_for_item(item_code,trade_id,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) VALUES (?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) " );
		dataMap.put("SQL_ST_PROD_TRANSFER_TO_ITEM_MOVE_SUMM_UPDATE","UPDATE	st_item_move_summ SET PRT_QTY =(nvl(PRT_QTY,0) + ?), PRT_COST =(nvl(PRT_COST,0)	+?)	, MONTH_CLOSING_QTY	= (nvl(MONTH_CLOSING_QTY,0)	+ ?), MONTH_CLOSING_VALUE =(nvl(MONTH_CLOSING_VALUE,0) + ?), modified_by_id	= ?,  modified_date	= SYSDATE,	modified_at_ws_no =	?,	modified_facility_id = ? WHERE FACILITY_ID = ? AND ITEM_CODE = ? AND STORE_CODE	= ?	AND	MOVE_MONTH=	? AND MOVE_YEAR	=?");
		dataMap.put("SQL_ST_PROD_TRANSFER_FROM_ITEM_MOVE_SUMM_UPDATE","UPDATE st_item_move_summ	SET	PRT_QTY	=(nvl(PRT_QTY,0) + ?), PRT_COST	=(nvl(PRT_COST,0) +	?) , MONTH_CLOSING_QTY = (nvl(MONTH_CLOSING_QTY,0) + ?), MONTH_CLOSING_VALUE =(nvl(MONTH_CLOSING_VALUE,0) +	?),	modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ?	WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("SQL_PROD_TRANSFER_ST_ITEM_MOVE_SUMM_INSERT", "INSERT into st_item_move_summ  (facility_id,	item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,prt_qty, prt_cost,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_REPACK_UOM_SELECT", "SELECT repacking_group_code,repack_unit_uom   FROM   st_item  WHERE item_code LIKE UPPER(?)");
		dataMap.put("SQL_EQVL_UOM_VALUE_SELECT", "SELECT eqvl_value FROM am_uom_eqvl WHERE	   eqvl_uom_code = ? AND uom_code = ?"	);
		dataMap.put("SQL_ST_ITEM_GEN_BATCH_SELECT", "SELECT auto_gen_batch_yn , next_batch_id ,batch_id_series FROM st_repacking_group WHERE repacking_group_code = ? ");	
		dataMap.put("SQL_ST_PROD_TFR_REQUEST_SEARCH_SELECT","SELECT prod_tfr_request_no , store_code, fm_item_code, A.short_desc fm_item_desc , to_item_code, B.short_desc to_item_desc, fm_stk_uom_conv_factor , to_stk_uom_conv_factor , fm_item_qty , to_item_qty ,requested_by , remarks , request_status, (SELECT NVL(ALLOW_DECIMALS_YN,'N')  FROM ST_ITEM WHERE ITEM_CODE = FM_ITEM_CODE) FROM_ALLOW_DECIMALS_YN,(SELECT NVL(ALLOW_DECIMALS_YN,'N') FROM ST_ITEM WHERE ITEM_CODE = TO_ITEM_CODE) TO_ALLOW_DECIMALS_YN FROM st_prod_tfr_request_hdr , mm_item_lang_vw A ,mm_item_lang_vw B WHERE prod_tfr_request_no LIKE NVL( ? ,'%') AND store_code = ? AND fm_item_code = A.item_code AND to_item_code = B.item_code AND request_status = 'E' AND b.language_id = a.language_id AND b.language_id = ?");
//        dataMap.put("SQL_ST_PROD_REQUEST_HDR_REQUEST_STATUS_UPDATE","UPDATE st_prod_tfr_request_hdr SET request_status='C' WHERE prod_tfr_request_no= ? "); // Modified on 5/29/2006 for updating modification details
        dataMap.put("SQL_ST_PROD_REQUEST_HDR_REQUEST_STATUS_UPDATE","UPDATE st_prod_tfr_request_hdr SET request_status='C', modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE prod_tfr_request_no= ?  ");
		dataMap.put("SQL_ST_PROD_REQUEST_HDR_REQUEST_STATUS_UPDATE1","Update ST_PROD_TFR_REQUEST_HDR set  REQUEST_STATUS='D', modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where PROD_TFR_REQUEST_NO=? ");



		/* For Transaction function	-->	Product	Transfer  Request  added on 12/2/2004*/

		dataMap.put("SQL_ST_PROD_TRANS_REQ_INSERT",	"INSERT	INTO ST_PROD_TFR_REQUEST_HDR(prod_tfr_request_no,store_code, fm_item_code, to_item_code, fm_stk_uom_conv_factor, to_stk_uom_conv_factor,	fm_item_qty, to_item_qty, requested_by, remarks,	request_status,added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id)VALUES(?,?,?,?, ?, ?, ?,?, ?, ?,?, ?,SYSDATE, ?, ?, ?,	SYSDATE,?, ?)");
		dataMap.put("SQL_ST_PROD_TRANS_REQ_COUNT","SELECT	COUNT(*) total FROM	st_prod_tfr_request_hdr	WHERE prod_tfr_request_no= ? ");
		dataMap.put("SQL_ST_PROD_TRANS_REQ_SELECT_MAX_REQ_NO","SELECT	nvl(MAX(prod_tfr_request_no),0) max_prod_tfr_request_no FROM ST_PROD_TFR_REQUEST_HDR");





       /* For Transaction function	-->	Issue Return */

        dataMap.put("SQL_QRY_ST_ISSUE_RET_FROM_STORE", "SELECT st.store_code, mm.short_desc	FROM st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user_lang_vw	sm WHERE st.store_code = mm.store_code	AND	st.user_id=sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status='E' AND (st.ret_allowed_yn='Y' or st.ret_finalize_allowed_yn='Y')  AND mm.facility_id =? AND st.user_id	= ?	AND sm.language_id = mm.language_id AND mm.language_id = ? order by 2");
		dataMap.put("SQL_ST_ISSUE_RET_FROM_STORE", "SELECT st.store_code, mm.short_desc FROM st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user_lang_vw sm, st_store ststr WHERE st.store_code = mm.store_code and st.store_code = ststr.store_code AND st.user_id=sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status='E' AND (st.ret_allowed_yn='Y' and ststr.ret_allowed_yn='Y') AND mm.facility_id =? AND st.user_id = ?  AND mm.language_id =sm.language_id AND mm.language_id =? and st.store_code in (select store_code from st_store_parent_store) ORDER BY 2");

//		dataMap.put("SQL_ST_ISSUE_RET_TO_STORE", "SELECT st.store_code, mm.short_desc FROM	st_store st, mm_store mm, sm_appl_user sm, st_acc_entity_param pa WHERE	st.store_code =	mm.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status	= 'E' AND sm.eff_status='E'	AND (st.iss_allowed_yn='Y' OR st.urg_allowed_yn='Y' )  AND st.user_id = ?  AND pa.acc_entity_id=	? AND ((pa.trn_across_facility_yn='Y') OR mm.facility_id =?) ORDER BY 2");
//      modified by manish on Thursday, January 15, 2004
		dataMap.put("SQL_ST_ISSUE_RET_TO_STORE", "SELECT DISTINCT stp.parent_store_code ,mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm, st_store st, sm_appl_user_lang_vw sm, st_acc_entity_param pa WHERE mm.store_code = stp.parent_store_code             AND mm.eff_status = 'E' AND st.store_code = mm.store_code AND sm.eff_status = 'E' AND (st.iss_allowed_yn = 'Y' OR st.urg_allowed_yn = 'Y') AND sm.appl_user_id = ? AND pa.acc_entity_id = ? AND mm.facility_id like decode(   pa.trn_across_facility_yn,'Y','%', ?) AND mm.language_id = sm.language_id AND mm.language_id = ? AND stp.store_code = ? ORDER BY 2");

		dataMap.put("SQL_ST_ISSUE_RET_CALCULATE_PENDING_QTY", "SELECT nvl(LEAST( SUM( nvl(ide.iss_item_qty,0)-NVL(ide.ret_item_qty,0)),SUM(nvl(sbv.avail_qty,0))),0)  pending_ret_qty FROM st_issue_dtl_exp ide,st_issue_hdr ihr, st_batch_search_lang_view sbv WHERE  ide.FACILITY_ID = ? AND (ide.FACILITY_ID = ihr.FACILITY_ID AND ide.DOC_TYPE_CODE  =  ihr.DOC_TYPE_CODE AND ide.DOC_NO = ihr.DOC_NO AND ide.SEQ_NO =ihr.SEQ_NO) AND  ihr.fm_store_code= ? AND ihr.to_store_code= ?  AND ihr.finalized_yn='Y' AND ide.item_code= ?    AND sbv.language_id = ?   AND sbv.language_id = sbv.lang1  AND sbv.language_id = sbv.lang2 AND (ihr.to_store_code=sbv.store_code AND ide.item_code=sbv.item_code AND ide.batch_id=sbv.batch_id AND   ide.to_bin_location_code=sbv.bin_location_code AND ide.expiry_date_or_receipt_date=sbv.expiry_date ) " ); 

		dataMap.put("SQL_ST_ISSUE_RET_CALCULATE_PENDING_QTY_NONSTK", "SELECT nvl(SUM( nvl(ide.iss_item_qty,0)-NVL(ide.ret_item_qty,0)),0)  pending_ret_qty FROM st_issue_dtl_exp ide,st_issue_hdr ihr WHERE  ide.FACILITY_ID = ? AND (ide.FACILITY_ID = ihr.FACILITY_ID AND ide.DOC_TYPE_CODE  =  ihr.DOC_TYPE_CODE AND ide.DOC_NO = ihr.DOC_NO AND ide.SEQ_NO =ihr.SEQ_NO) AND  ihr.fm_store_code= ? AND ihr.to_store_code= ?  AND ihr.finalized_yn='Y' AND ide.item_code= ? " ); 

 //		dataMap.put("SQL_ST_ISSUE_RETURN_BATCH_SEARCH_QUERY", "SELECT ide.item_code, sbv.item_desc item_desc, ide.batch_id, ide.bin_location_code issue_fm_bin_location_code, mmb.short_desc bin_desc, ide.to_bin_location_code  issue_to_bin_location_code, mmb1.short_desc to_bin_desc, TO_CHAR(ide.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt, ide.trade_id, sbv.trade_name trade_name, ide.iss_item_qty, NVL(ide.ret_item_qty,0) ret_item_qty, LEAST((ide.iss_item_qty-NVL(ide.ret_item_qty,0)),sbv.avail_qty) AVAIL_QTY, ide.DOC_TYPE_CODE doc_type_code, ide.DOC_NO doc_no, ide.SEQ_NO seq_no, TO_CHAR(ihr.doc_date,'dd/mm/yyyy') doc_date, item_unit_cost FROM ST_ISSUE_DTL_EXP ide, ST_ISSUE_HDR ihr, st_batch_search_view sbv,MM_BIN_LOCATION mmb,MM_BIN_LOCATION mmb1, ST_ISSUE_DTL idtl WHERE ide.FACILITY_ID = ?  AND (ide.FACILITY_ID = ihr.FACILITY_ID AND ide.DOC_TYPE_CODE = ihr.DOC_TYPE_CODE AND ide.DOC_NO = ihr.DOC_NO AND ide.SEQ_NO =ihr.SEQ_NO) AND ihr.finalized_yn='Y' AND ihr.fm_store_code= ? AND ihr.to_store_code= ? AND (ide.iss_item_qty-ide.ret_item_qty) > 0 AND (ihr.to_store_code=sbv.store_code AND  ide.item_code=sbv.item_code AND ide.batch_id=sbv.batch_id AND  ide.to_bin_location_code=sbv.bin_location_code AND ide.expiry_date_or_receipt_date=sbv.expiry_date ) AND (ihr.fm_store_code=mmb.store_code AND ide.bin_location_code=mmb.bin_location_code) AND (ihr.to_store_code=mmb1.store_code AND  ide.to_bin_location_code=mmb1.bin_location_code) AND idtl.facility_id=ide.facility_id AND idtl.doc_type_code=ide.doc_type_code AND idtl.doc_no=ide.doc_no AND idtl.item_code=ide.item_code AND ide.item_code= ?" ); 
 //     dataMap.put("SQL_ST_ISSUE_RETURN_BATCH_SEARCH_QUERY", "SELECT ide.item_code, sbv.item_desc item_desc, ide.batch_id, ide.bin_location_code issue_fm_bin_location_code, mmb.short_desc bin_desc, ide.to_bin_location_code  issue_to_bin_location_code, mmb1.short_desc to_bin_desc, TO_CHAR(ide.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt, ide.trade_id, sbv.trade_name trade_name, ide.iss_item_qty, NVL(ide.ret_item_qty,0) ret_item_qty, LEAST((ide.iss_item_qty-NVL(ide.ret_item_qty,0)),sbv.avail_qty) AVAIL_QTY, ide.DOC_TYPE_CODE doc_type_code, ide.DOC_NO doc_no, ide.SEQ_NO seq_no, TO_CHAR(ihr.doc_date,'dd/mm/yyyy') doc_date, item_unit_cost, ide.doc_srl_no FROM ST_ISSUE_DTL_EXP ide, ST_ISSUE_HDR ihr, st_batch_search_view sbv,MM_BIN_LOCATION mmb,MM_BIN_LOCATION mmb1, ST_ISSUE_DTL idtl WHERE ide.FACILITY_ID = ?  AND (ide.FACILITY_ID = ihr.FACILITY_ID AND ide.DOC_TYPE_CODE = ihr.DOC_TYPE_CODE AND ide.DOC_NO = ihr.DOC_NO AND ide.SEQ_NO =ihr.SEQ_NO) AND ihr.finalized_yn='Y' AND ihr.fm_store_code= ? AND ihr.to_store_code= ? AND (ide.iss_item_qty-ide.ret_item_qty) > 0 AND (ihr.to_store_code=sbv.store_code AND  ide.item_code=sbv.item_code AND ide.batch_id=sbv.batch_id AND  ide.to_bin_location_code=sbv.bin_location_code AND ide.expiry_date_or_receipt_date=sbv.expiry_date ) AND (ihr.fm_store_code=mmb.store_code AND ide.bin_location_code=mmb.bin_location_code) AND (ihr.to_store_code=mmb1.store_code AND  ide.to_bin_location_code=mmb1.bin_location_code) AND idtl.facility_id=ide.facility_id AND idtl.doc_type_code=ide.doc_type_code AND idtl.doc_no=ide.doc_no AND idtl.item_code=ide.item_code AND ide.item_code= ?" ); 
 //     for bin location 
        dataMap.put("SQL_ST_ISSUE_RETURN_BATCH_SEARCH_QUERY", "SELECT   ide.item_code, sbv.item_desc item_desc, ide.batch_id,          ide.bin_location_code issue_fm_bin_location_code, ide.bin_location_code new_bin_location_code, mmb.short_desc bin_desc, sbv.bin_location_code bin_location_code, ide.to_bin_location_code issue_to_bin_location_code, mmb1.short_desc to_bin_desc, TO_CHAR (ide.expiry_date_or_receipt_date, 'dd/mm/yyyy') expiry_receipt_dt, ide.trade_id, sbv.trade_name trade_name, ide.iss_item_qty, NVL (ide.ret_item_qty, 0) ret_item_qty, LEAST ((ide.iss_item_qty - NVL (ide.ret_item_qty, 0)),sbv.avail_qty) + ST_COMM_QTY_FOR_DOCNO (?,?, ?, ?,ihr.to_store_code , sbv.bin_location_code, ide.batch_id, ide.expiry_date_or_receipt_date, ide.item_code)avail_qty, ide.doc_type_code doc_type_code, ide.doc_no doc_no, ide.seq_no seq_no, TO_CHAR (ihr.doc_date, 'dd/mm/yyyy') doc_date, item_unit_cost, ide.doc_srl_no FROM ST_ISSUE_DTL_EXP ide, ST_ISSUE_HDR ihr, st_batch_search_lang_view sbv, mm_bin_location_lang_vw mmb, mm_bin_location_lang_vw mmb1, ST_ISSUE_DTL idtl WHERE ide.facility_id =?  AND (    ide.facility_id = ihr.facility_id AND ide.doc_type_code = ihr.doc_type_code AND ide.doc_no = ihr.doc_no AND ide.seq_no = ihr.seq_no) AND ihr.finalized_yn = 'Y' AND ihr.fm_store_code = ? AND ihr.to_store_code =? AND (ide.iss_item_qty - ide.ret_item_qty) > 0 AND (    ihr.to_store_code = sbv.store_code AND ide.item_code = sbv.item_code AND ide.batch_id = sbv.batch_id /* AND  ide.to_bin_location_code=sbv.bin_location_code*/ AND ide.expiry_date_or_receipt_date = sbv.expiry_date) AND (    ihr.fm_store_code = mmb.store_code AND ide.bin_location_code = mmb.bin_location_code) AND (    ihr.to_store_code = mmb1.store_code AND sbv.bin_location_code = mmb1.bin_location_code) AND idtl.facility_id = ide.facility_id AND idtl.doc_type_code = ide.doc_type_code AND idtl.doc_no = ide.doc_no AND idtl.seq_no = ihr.seq_no AND idtl.item_code =  ide.item_code AND ide.item_code = ? AND sbv.language_id = mmb.language_id AND sbv.language_id = mmb1.language_id AND sbv.language_id =? AND sbv.lang1 =? AND sbv.lang2 = ? AND ide.doc_no = ? and ide.doc_Type_code=? ORDER BY ihr.added_date " ); 

 //     dataMap.put("SQL_ST_ISSUE_RETURN_BATCH_SEARCH_QUERY_NONSTK", "SELECT ide.item_code,  mmitm.short_desc item_desc,  ide.batch_id,  ide.bin_location_code issue_fm_bin_location_code,  mmb.short_desc bin_desc,  ide.to_bin_location_code  issue_to_bin_location_code,  '' to_bin_desc, TO_CHAR(ide.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt,  ide.trade_id,  NVL(long_name,ide.trade_id) trade_name,  ide.iss_item_qty, NVL(ide.ret_item_qty,0) ret_item_qty,  (ide.iss_item_qty-NVL(ide.ret_item_qty,0)) AVAIL_QTY,  ide.DOC_TYPE_CODE doc_type_code, ide.DOC_NO doc_no, ide.SEQ_NO seq_no,  TO_CHAR(ihr.doc_date,'dd/mm/yyyy') doc_date,  item_unit_cost,  stock_item_yn  FROM ST_ISSUE_DTL_EXP ide, ST_ISSUE_HDR ihr, MM_BIN_LOCATION mmb, ST_ISSUE_DTL idtl, MM_ITEM mmitm, AM_TRADE_NAME amtrade WHERE ide.FACILITY_ID = ? AND idtl.item_code=mmitm.item_code AND ide.trade_id=amtrade.trade_id(+) AND (ide.FACILITY_ID = ihr.FACILITY_ID AND ide.DOC_TYPE_CODE = ihr.DOC_TYPE_CODE AND ide.DOC_NO = ihr.DOC_NO AND ide.SEQ_NO =ihr.SEQ_NO) AND ihr.finalized_yn='Y' AND ihr.fm_store_code= ? AND ihr.to_store_code = ? AND (ide.iss_item_qty-NVL(ide.ret_item_qty,0)) >= 0 AND (ihr.fm_store_code=mmb.store_code AND ide.bin_location_code=mmb.bin_location_code) AND idtl.facility_id=ide.facility_id AND idtl.doc_type_code=ide.doc_type_code AND idtl.doc_no=ide.doc_no AND idtl.item_code=ide.item_code AND ide.item_code= ?" ); 
        dataMap.put("SQL_ST_ISSUE_RETURN_BATCH_SEARCH_QUERY_NONSTK", "SELECT ide.item_code,  mmitm.short_desc item_desc,  ide.batch_id,  ide.bin_location_code issue_fm_bin_location_code,  mmb.short_desc bin_desc,  ide.to_bin_location_code  issue_to_bin_location_code,  '' to_bin_desc, TO_CHAR(ide.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt,  ide.trade_id,  NVL(long_name,ide.trade_id) trade_name,  ide.iss_item_qty, NVL(ide.ret_item_qty,0) ret_item_qty,  (ide.iss_item_qty-NVL(ide.ret_item_qty,0)) +ST_COMM_QTY_FOR_DOCNO(?, ?, ?,?, ihr.to_store_code, ide.to_bin_location_code , ide.batch_id, ide.expiry_date_or_receipt_date, ide.item_code ) AVAIL_QTY,  ide.DOC_TYPE_CODE doc_type_code, ide.DOC_NO doc_no, ide.SEQ_NO seq_no,  TO_CHAR(ihr.doc_date,'dd/mm/yyyy') doc_date,  item_unit_cost,  stock_item_yn, ide.doc_srl_no  FROM ST_ISSUE_DTL_EXP ide, ST_ISSUE_HDR ihr, MM_BIN_LOCATION_LANG_VW mmb, ST_ISSUE_DTL idtl, MM_ITEM_LANG_VW mmitm, AM_TRADE_NAME_LANG_VW amtrade WHERE ide.FACILITY_ID = ? AND idtl.item_code=mmitm.item_code AND ide.trade_id=amtrade.trade_id(+) AND (ide.FACILITY_ID = ihr.FACILITY_ID AND ide.DOC_TYPE_CODE = ihr.DOC_TYPE_CODE AND ide.DOC_NO = ihr.DOC_NO AND ide.SEQ_NO =ihr.SEQ_NO) AND ihr.finalized_yn='Y' AND ihr.fm_store_code= ? AND ihr.to_store_code = ? AND (ide.iss_item_qty-NVL(ide.ret_item_qty,0)) >= 0 AND (ihr.fm_store_code=mmb.store_code AND ide.bin_location_code=mmb.bin_location_code) AND idtl.facility_id=ide.facility_id AND idtl.doc_type_code=ide.doc_type_code AND idtl.doc_no=ide.doc_no AND  idtl.seq_no=ihr.seq_no AND idtl.item_code=ide.item_code AND ide.item_code= ? AND mmb.language_id = mmitm.language_id AND mmb.language_id = ? AND amtrade.language_id(+) = ? and ide.doc_no =? and ide.doc_type_code=?" ); 
		dataMap.put("SQL_ST_ISSUE_RETURN_HDR_INSERT", "INSERT INTO ST_ISSUE_RET_HDR ( facility_id,doc_type_code,doc_no,doc_date,doc_ref,fm_store_code,to_store_code,finalized_yn,gl_interfaced_yn,trn_type,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) values( ?,?,?,TO_DATE(?, 'dd/mm/yyyy'),?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,? )" );
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_INSERT", "INSERT INTO ST_ISSUE_RET_DTL ( facility_id,doc_type_code,doc_no,doc_srl_no,item_code,ret_item_qty,item_unit_cost,item_cost_value,stock_item_yn,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,remarks) values (?,?,?,?,?,?,?,?,?,?,SYSDATE, ?,?,?,SYSDATE,?,?,?)" );
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_EXP_INSERT", "INSERT INTO ST_ISSUE_RET_DTL_EXP (facility_id,doc_type_code,doc_no,doc_srl_no,store_code,item_code,batch_id,bin_location_code,expiry_date_or_receipt_date,trade_id,item_qty,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,org_doc_type_code,org_doc_no,org_seq_no,to_bin_location_code ) VALUES ( ?,?,?,?,?,?,?,?,TO_DATE(?, 'dd/mm/yyyy'),?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,? )" );
		dataMap.put("SQL_ST_ISSUE_RET_ITEM_TRN_DTL_INSERT", "INSERT INTO st_item_trn_dtl(facility_id,store_code,item_code,posted_date,trn_srl_no,trn_type,doc_type_code,doc_no,doc_srl_no,doc_date,doc_ref,batch_id,expiry_date,item_qty_normal,item_unit_cost,stk_uom_code,source_doc_type_code,source_doc_no,source_doc_srl_no,source_doc_date,other_store_code,stock_item_yn,added_by_id, added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,bin_location_code, trade_id, source_seq_no  ) VALUES (?,?,?,SYSDATE,?,?,?,?,?,TO_DATE(?, 'dd/mm/yyyy') ,?,?,TO_DATE(?, 'dd/mm/yyyy') ,?,?,?,?,?,?,TO_DATE(?, 'dd/mm/yyyy'),?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,? ) " );
// 		dataMap.put("SQL_ST_ISSUE_RET_DTL_EXP_UPDATE", "UPDATE st_issue_dtl_exp SET ret_item_qty= ( NVL(ret_item_qty,0) + ?) WHERE facility_id= ? AND doc_type_code= ? AND doc_no = ? AND seq_no = ? AND  item_code = ? AND batch_id=? AND expiry_date_or_receipt_date=to_date(?,'dd/mm/yyyy')" ) ; // Modified on 5/29/2006 for updating modification details
 		dataMap.put("SQL_ST_ISSUE_RET_DTL_EXP_UPDATE", "UPDATE st_issue_dtl_exp SET ret_item_qty= ( NVL(ret_item_qty,0) + ?)  , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id= ? AND doc_type_code= ? AND doc_no = ? AND seq_no = ? AND  item_code = ? AND batch_id=? AND expiry_date_or_receipt_date=to_date(?,'dd/mm/yyyy') and bin_location_code=?" ) ;
//		dataMap.put("SQL_ST_ISSUE_RET_DTL_UPDATE", "UPDATE st_issue_dtl SET ret_item_qty= ( NVL(ret_item_qty,0) + ?) WHERE facility_id= ? AND doc_type_code= ? AND doc_no = ? AND seq_no = ? AND  ITEM_code = ?" ); // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_ISSUE_RET_DTL_UPDATE", "UPDATE st_issue_dtl SET ret_item_qty= ( NVL(ret_item_qty,0) + ?) , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE facility_id= ? AND doc_type_code= ? AND doc_no = ? AND seq_no = ? AND  ITEM_code = ?" );
		dataMap.put("SQL_ISSUE_RETURN_ST_ITEM_MOVE_SUMM_INSERT_ST", "INSERT INTO st_item_move_summ(facility_id,	item_code, store_code, move_year, move_month, month_closing_qty, month_closing_value,ret_qty, ret_cost,out_ret_qty_st,out_ret_cost_st,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ISSUE_RETURN_ST_ITEM_MOVE_SUMM_INSERT_NS", "INSERT INTO st_item_move_summ(facility_id,	item_code, store_code, move_year, move_month, cons_qty, cons_cost,ret_qty, ret_cost,out_ret_qty_ns,out_ret_cost_ns,added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_ISSUE_RETURN_FROM_STORE_ITEM_MOVE_SUMM_UPDATE_ST","UPDATE st_item_move_summ	SET	RET_QTY	=(NVL(RET_QTY,0) - ?), RET_COST	=(NVL(RET_COST,0) -	?) , MONTH_CLOSING_QTY = (NVL(MONTH_CLOSING_QTY,0) - ?), MONTH_CLOSING_VALUE =(NVL(MONTH_CLOSING_VALUE,0) -	?), out_ret_qty_st= (NVL(out_ret_qty_st,0) - ? ) ,out_ret_cost_st= (NVL(out_ret_cost_st,0) - ? ) ,	modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ?	WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =? ");
		dataMap.put("SQL_ST_ISSUE_RETURN_TO_STORE_ITEM_MOVE_SUMM_UPDATE_ST","UPDATE st_item_move_summ	SET	RET_QTY	=(NVL(RET_QTY,0) + ?), RET_COST	=(NVL(RET_COST,0) +	?) , MONTH_CLOSING_QTY = (NVL(MONTH_CLOSING_QTY,0) + ?), MONTH_CLOSING_VALUE =(NVL(MONTH_CLOSING_VALUE,0) +	?), in_ret_qty= (NVL(in_ret_qty,0) + ? ) ,in_ret_cost= (NVL(in_ret_cost,0) + ? ) ,	modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ?	WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =? ");
		dataMap.put("SQL_ST_ISSUE_RETURN_FROM_STORE_ITEM_MOVE_SUMM_UPDATE_NS","UPDATE st_item_move_summ	SET	RET_QTY	=(NVL(RET_QTY,0) - ?), RET_COST	=(NVL(RET_COST,0) -	?) , CONS_QTY = (NVL(CONS_QTY,0) + ?), CONS_COST =(NVL(CONS_COST,0) +	?), OUT_RET_QTY_NS= (NVL(OUT_RET_QTY_NS,0) - ? ) , OUT_RET_COST_NS = (NVL( OUT_RET_COST_NS,0) - ? ) ,	modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ?	WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =? ");
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_SELECT_MAX_DOC_SRL_NO", "SELECT MAX(doc_srl_no) max_doc_srl_no	FROM st_issue_ret_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
		dataMap.put("SQL_ST_ISSUE_RETURN_HDR_SELECT","SELECT hdr.doc_type_code,sy.short_desc doc_type_desc,hdr.doc_no,TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.doc_ref doc_reference, hdr.fm_store_code,rbys.short_desc fm_store_desc,hdr.to_store_code, rons.short_desc	to_store_desc FROM st_issue_ret_hdr hdr,sy_doc_type_master_lang_vw sy,mm_store_lang_vw rbys, mm_store_lang_vw rons WHERE sy.doc_type_code=hdr.doc_type_code AND rbys.store_code=hdr.fm_store_code AND rons.store_code=hdr.fm_store_code AND hdr.facility_id = ? AND hdr.doc_type_code = ? AND hdr.doc_no	= ? AND sy.language_id = rons.language_id AND rons.language_id = rbys.language_id AND rons.language_id = ?" );
		dataMap.put("SQL_ST_ISSUE_RETURN_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.fm_store_code,  fms.short_desc  fm_store_desc,hdr.to_store_code,tos.short_desc	to_store_desc, hdr.item_class_code, itmcls.SHORT_DESC item_class_desc FROM st_issue_ret_hdr	hdr, mm_store_lang_vw fms,mm_store_lang_vw	tos,  sy_doc_type_master_lang_vw	sy,	/*st_user_access_for_store uaca,*/ st_user_access_for_store	uacb /*, st_acc_entity_param pa */ , mm_item_class itmcls WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.fm_store_code=	fms.store_code	AND	 hdr.to_store_code = tos.store_code AND /*uaca.store_code	= hdr.to_store_code	AND*/	hdr.finalized_yn='N' AND uacb.ret_allowed_yn	= 'Y' AND /*uacb.user_id = uaca.user_id AND*/ uacb.store_code =	hdr.fm_store_code AND uacb.ret_allowed_yn =	'Y' AND hdr.doc_type_code LIKE ?	AND	TO_CHAR(hdr.doc_no)	LIKE  ?	AND	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') LIKE ?  AND	hdr.fm_store_code LIKE ? AND hdr.to_store_code LIKE	? AND uacb.user_id	= ? AND fms.facility_id=? AND fms.language_id = tos.language_id AND fms.language_id = sy.language_id AND tos.language_id = ? AND hdr.item_class_code = itmcls.ITEM_CLASS_CODE(+) " ) ;
		dataMap.put("SQL_ST_ISSUE_RETURN_HDR_QUERY_RESULT_SRR","SELECT count(dtl.item_code)no_of_items, hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.fm_store_code,  fms.short_desc  fm_store_desc,hdr.to_store_code,tos.short_desc	to_store_desc, hdr.item_class_code, itmcls.SHORT_DESC item_class_desc FROM st_issue_ret_hdr	hdr, st_issue_ret_dtl dtl, mm_store_lang_vw fms,mm_store_lang_vw	tos,  sy_doc_type_master_lang_vw	sy,	/*st_user_access_for_store uaca,*/ st_user_access_for_store	uacb /*, st_acc_entity_param pa */ , mm_item_class itmcls WHERE hdr.facility_id = dtl.facility_id and hdr.doc_type_code = dtl.doc_type_code and hdr.doc_no=dtl.doc_no and hdr.doc_type_code = sy.doc_type_code	AND	hdr.fm_store_code=	fms.store_code	AND	 hdr.to_store_code = tos.store_code AND /*uaca.store_code	= hdr.to_store_code	AND*/	hdr.finalized_yn='N' AND uacb.ret_allowed_yn	= 'Y' AND /*uacb.user_id = uaca.user_id AND*/ uacb.store_code =	hdr.fm_store_code AND uacb.ret_allowed_yn =	'Y' AND hdr.doc_type_code LIKE ?	AND	TO_CHAR(hdr.doc_no)	LIKE  ?	AND	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') LIKE ?  AND	hdr.fm_store_code LIKE ? AND hdr.to_store_code LIKE	? AND uacb.user_id	= ? AND fms.facility_id=? AND fms.language_id = tos.language_id AND fms.language_id = sy.language_id AND tos.language_id = ? AND hdr.item_class_code = itmcls.ITEM_CLASS_CODE(+) group by hdr.doc_type_code, sy.short_desc , hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') , hdr.fm_store_code, fms.short_desc , hdr.to_store_code, tos.short_desc , hdr.item_class_code, itmcls.short_desc " ) ;
		dataMap.put("SQL_ST_ITEM_BATCH_ISSUE_RET_UPDATE","UPDATE	st_item_batch SET committed_qty	= NVL(committed_qty,0) +  ?	, modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	?  WHERE store_code	= ?	 AND item_code = ?	AND	batch_id = ?  AND bin_location_code	= ?	 AND expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy')");

		dataMap.put("SQL_ST_ISSUE_RET_DTL_SELECT_MULTIPLE", "SELECT hdr.fm_store_code,dtl.doc_no, dtl.item_code, mmitem.short_desc item_desc,dtl.item_unit_cost unit_cost, dtl.item_cost_value cost_value, dtl.doc_srl_no, dtl.ret_item_qty item_qty, (  SUM (NVL (iss_dtl.iss_item_qty, 0) - NVL (iss_dtl.ret_item_qty, 0)) + NVL (dtl.ret_item_qty, 0) ) pend_qty, dtl.remarks remarks, am.uom_code uom_code, am.short_desc uom_desc,stitm.DEF_ISSUE_UOM,am1.short_desc stock_uom FROM st_issue_ret_dtl dtl, mm_item_lang_vw mmitem,        st_issue_dtl_exp iss_exp, st_issue_ret_hdr hdr, am_uom_lang_vw am,       am_uom_lang_vw am1, st_issue_dtl iss_dtl, st_item_store stitm WHERE mmitem.item_code = dtl.item_code AND iss_exp.item_code = dtl.item_code AND (iss_exp.facility_id, iss_exp.doc_type_code, iss_exp.doc_no, iss_exp.seq_no ) IN ( SELECT facility_id, doc_type_code, doc_no, seq_no FROM st_issue_hdr WHERE fm_store_code = ? AND to_store_code = ? AND finalized_yn = 'Y') AND dtl.facility_id = ? AND dtl.doc_no = ? AND dtl.doc_type_code = ? AND hdr.doc_no = dtl.doc_no AND dtl.item_code = mmitem.item_code and dtl.item_code = stitm.item_code and hdr.fm_store_code = stitm.store_code AND mmitem.gen_uom_code = am.uom_code and am1.uom_code = stitm.def_issue_uom AND iss_dtl.doc_no = iss_exp.doc_no AND iss_dtl.doc_type_code = iss_exp.doc_type_code AND mmitem.language_id = ? AND am.language_id = ? and am.language_id = am1.language_id GROUP BY hdr.fm_store_code,dtl.doc_no, dtl.item_code, mmitem.short_desc, dtl.item_unit_cost, dtl.item_cost_value,dtl.doc_srl_no, dtl.ret_item_qty,dtl.remarks,am.uom_code,am.short_desc,stitm.DEF_ISSUE_UOM,am1.short_desc" ) ;
//		dataMap.put("SQL_ST_ISSUE_RET_DTL_SELECT_MULTIPLE", "SELECT dtl.doc_no, dtl.item_code, mmitem.short_desc item_desc, dtl.item_unit_cost unit_cost,dtl.item_cost_value cost_value,dtl.doc_srl_no, dtl.ret_item_qty  item_qty,(SUM(iss_exp.iss_item_qty-iss_exp.ret_item_qty)+dtl.ret_item_qty) pend_qty , dtl.remarks remarks,am.uom_code uom_code, am.short_desc uom_desc FROM st_issue_ret_dtl dtl,mm_item_lang_vw mmitem, st_issue_dtl_exp iss_exp,st_issue_ret_hdr hdr,am_uom_lang_vw am WHERE mmitem.item_code=dtl.item_code AND iss_exp.item_code=dtl.item_code AND (iss_exp.facility_id,iss_exp.doc_type_code,iss_exp.doc_no,iss_exp.seq_no) IN (SELECT FACILITY_ID,DOC_TYPE_CODE,DOC_NO,SEQ_NO FROM st_issue_hdr WHERE fm_store_code= ? AND to_store_code= ? AND finalized_yn='Y') AND dtl.facility_id= ? AND dtl.doc_no= ? AND dtl.doc_type_code= ? AND hdr.doc_no=dtl.doc_no AND dtl.item_code=mmitem.item_code AND  mmitem.gen_uom_code=am.uom_code   AND mmitem.language_id = ? AND am.language_id = ? GROUP BY dtl.doc_no, dtl.item_code, mmitem.short_desc, dtl.item_unit_cost,dtl.item_cost_value,dtl.doc_srl_no, dtl.ret_item_qty,dtl.remarks,am.uom_code,am.short_desc" ) ;
//		dataMap.put("SQL_ST_ISSUE_RET_DTL_SELECT_MULTIPLE", "SELECT dtl.doc_no, dtl.item_code, mmitem.short_desc item_desc, dtl.item_unit_cost	unit_cost,dtl.item_cost_value cost_value,dtl.doc_srl_no, dtl.ret_item_qty  item_qty,(SUM(iss_exp.iss_item_qty-iss_exp.ret_item_qty)-dtl.ret_item_qty) pend_qty , dtl.remarks remarks,am.uom_code uom_code, am.short_desc uom_desc FROM st_issue_ret_dtl dtl,mm_item mmitem, st_issue_dtl_exp iss_exp,st_issue_ret_hdr hdr,am_uom am WHERE mmitem.item_code=dtl.item_code AND iss_exp.item_code=dtl.item_code AND (iss_exp.facility_id,iss_exp.doc_type_code,iss_exp.doc_no,iss_exp.seq_no) IN (SELECT FACILITY_ID,DOC_TYPE_CODE,DOC_NO,SEQ_NO FROM st_issue_hdr WHERE fm_store_code= ? AND to_store_code= ? AND finalized_yn='Y') AND dtl.facility_id= ? AND dtl.doc_no= ? AND dtl.doc_type_code= ? AND hdr.doc_no=dtl.doc_no AND dtl.item_code=mmitem.item_code AND  mmitem.gen_uom_code=am.uom_code GROUP BY dtl.doc_no, dtl.item_code, mmitem.short_desc, dtl.item_unit_cost,dtl.item_cost_value,dtl.doc_srl_no, dtl.ret_item_qty,dtl.remarks,am.uom_code,am.short_desc " ) ;

//		dataMap.put("SQL_ST_ISSUE_RET_DTL_EXP_SELECT_MULTIPLE", "SELECT a.item_code,  f.short_desc item_desc,a.batch_id,a.bin_location_code issue_to_bin_location_code, (case when a.bin_location_code is null then null else (select short_desc from mm_bin_location where bin_location_code=a.bin_location_code and store_code=a.store_code) end)  TO_BIN_DESC,a.to_bin_location_code issue_fm_bin_location_code, e.short_desc  bin_desc,TO_CHAR(a.expiry_date_or_receipt_date,'dd/mm/yyyy')  expiry_receipt_dt,a.trade_id, NVL(long_name,a.trade_id) trade_name,c.iss_item_qty, NVL(c.ret_item_qty,0) ret_item_qty, a.item_qty QTY,(c.iss_item_qty-c.ret_item_qty)+a.item_qty avail_qty,a.org_doc_type_code doc_type_code, a.org_doc_no doc_no, a.org_seq_no seq_no,i.item_unit_cost FROM st_issue_ret_dtl_exp a,st_issue_dtl_exp c,st_issue_ret_hdr  d,mm_bin_location e, mm_item f, am_trade_name h, st_issue_ret_dtl i WHERE a.item_code=f.item_code AND a.trade_id=h.trade_id(+) AND a.facility_id=c.facility_id AND    a.org_doc_type_code=c.doc_type_code AND a.org_doc_no=c.doc_no AND a.org_seq_no=c.seq_no AND  a.item_code=c.item_code AND a.batch_id=c.batch_id AND a.expiry_date_or_receipt_date =c.expiry_date_or_receipt_date AND a.facility_id=d.facility_id AND a.doc_type_code=d.doc_type_code AND a.doc_no=d.doc_no AND   d.to_store_code=e.store_code AND a.to_bin_location_code=e.bin_location_code  AND (c.iss_item_qty-c.ret_item_qty) > 0 AND a.facility_id=i.facility_id and a.doc_type_code=i.doc_type_code and a.doc_no=i.doc_no and a.item_code=i.item_code and a.facility_id= ?  AND a.doc_no= ? AND  a.doc_type_code= ?  AND a.doc_srl_no= ? " ) ; 
//		dataMap.put("SQL_ST_ISSUE_RET_DTL_EXP_SELECT_MULTIPLE", "SELECT k.FM_STORE_CODE STORE_CODE, k.TO_STORE_CODE,a.item_code,  f.short_desc item_desc,a.batch_id,a.bin_location_code issue_to_bin_location_code, (CASE WHEN a.bin_location_code IS NULL THEN NULL ELSE (SELECT short_desc FROM mm_bin_location_lang_vw WHERE bin_location_code=a.bin_location_code AND store_code=a.store_code AND language_id = f.language_id) END)  TO_BIN_DESC,a.to_bin_location_code issue_fm_bin_location_code,a.to_bin_location_code new_bin_location_code,  e.short_desc  bin_desc,TO_CHAR(a.expiry_date_or_receipt_date,'dd/mm/yyyy')  expiry_receipt_dt,a.trade_id, NVL(long_name,a.trade_id) trade_name,c.iss_item_qty, NVL(c.ret_item_qty,0) ret_item_qty, a.item_qty QTY,(c.iss_item_qty-c.ret_item_qty)+a.item_qty avail_qty,a.org_doc_type_code doc_type_code, a.org_doc_no doc_no, a.org_seq_no  seq_no,i.item_unit_cost,c.doc_srl_no,TO_CHAR(k.doc_date,'dd/mm/yyyy') doc_date FROM st_issue_ret_dtl_exp a,st_issue_dtl_exp c,st_issue_ret_hdr  d,mm_bin_location_lang_vw e, mm_item_lang_vw f, am_trade_name_lang_vw h, st_issue_ret_dtl i,st_issue_hdr k WHERE  a.item_code=f.item_code AND a.trade_id=h.trade_id(+) AND a.facility_id=c.facility_id AND    a.org_doc_type_code=c.doc_type_code AND a.org_doc_no=c.doc_no AND a.org_seq_no=c.seq_no AND  a.item_code=c.item_code AND a.batch_id=c.batch_id AND a.expiry_date_or_receipt_date =c.expiry_date_or_receipt_date AND a.facility_id=d.facility_id AND a.doc_type_code=d.doc_type_code AND a.doc_no=d.doc_no AND   d.to_store_code=e.store_code AND a.to_bin_location_code=e.bin_location_code  and a.to_bin_location_code=c.bin_location_code AND /* (c.iss_item_qty-c.ret_item_qty) > 0 AND */ a.facility_id=i.facility_id AND a.doc_type_code=i.doc_type_code AND a.doc_no=i.doc_no AND a.item_code=i.item_code AND a.facility_id= ?  AND a.doc_no= ? AND  a.doc_type_code= ?  AND a.doc_srl_no= ? AND (c.FACILITY_ID = k.FACILITY_ID AND c.DOC_TYPE_CODE = k.DOC_TYPE_CODE AND c.DOC_NO = k.DOC_NO AND c.SEQ_NO =k.SEQ_NO) AND e.language_id = ? AND f.language_id = ? AND h.language_id(+) = ?" ) ; 
		//Added by suresh.r on 24-02-2013 against AMS-CRF-0054
		dataMap.put("SQL_ST_ISSUE_RET_DTL_EXP_SELECT_MULTIPLE", "SELECT k.FM_STORE_CODE STORE_CODE, k.TO_STORE_CODE,a.item_code,  f.short_desc item_desc,a.batch_id,a.bin_location_code issue_to_bin_location_code, (CASE WHEN a.bin_location_code IS NULL THEN NULL ELSE (SELECT short_desc FROM mm_bin_location_lang_vw WHERE bin_location_code=a.bin_location_code AND store_code=a.store_code AND language_id = f.language_id) END)  TO_BIN_DESC,a.to_bin_location_code issue_fm_bin_location_code,a.to_bin_location_code new_bin_location_code,  e.short_desc  bin_desc,TO_CHAR(a.expiry_date_or_receipt_date,'dd/mm/yyyy')  expiry_receipt_dt,a.trade_id, NVL(long_name,a.trade_id) trade_name,c.iss_item_qty, NVL(c.ret_item_qty,0) ret_item_qty, a.item_qty QTY,(c.iss_item_qty-c.ret_item_qty)+a.item_qty avail_qty,a.org_doc_type_code doc_type_code, a.org_doc_no doc_no, a.org_seq_no  seq_no,i.item_unit_cost,c.doc_srl_no,TO_CHAR(k.doc_date,'dd/mm/yyyy') doc_date FROM st_issue_ret_dtl_exp a,st_issue_dtl_exp c,st_issue_ret_hdr  d,mm_bin_location_lang_vw e, mm_item_lang_vw f, am_trade_name_lang_vw h, st_issue_ret_dtl i,st_issue_hdr k WHERE  a.item_code=f.item_code AND a.trade_id=h.trade_id(+) /*AND a.facility_id=c.facility_id*/ AND    a.org_doc_type_code=c.doc_type_code AND a.org_doc_no=c.doc_no AND a.org_seq_no=c.seq_no AND  a.item_code=c.item_code AND a.batch_id=c.batch_id AND a.expiry_date_or_receipt_date =c.expiry_date_or_receipt_date AND a.facility_id=d.facility_id AND a.doc_type_code=d.doc_type_code AND a.doc_no=d.doc_no AND   d.to_store_code=e.store_code AND a.to_bin_location_code=e.bin_location_code  and a.to_bin_location_code=c.bin_location_code AND /* (c.iss_item_qty-c.ret_item_qty) > 0 AND */ a.facility_id=i.facility_id AND a.doc_type_code=i.doc_type_code AND a.doc_no=i.doc_no AND a.item_code=i.item_code AND a.facility_id= ?  AND a.doc_no= ? AND  a.doc_type_code= ? AND a.item_code = ? AND (c.FACILITY_ID = k.FACILITY_ID AND c.DOC_TYPE_CODE = k.DOC_TYPE_CODE AND c.DOC_NO = k.DOC_NO AND c.SEQ_NO =k.SEQ_NO) AND e.language_id = ? AND f.language_id = ? AND h.language_id(+) = ?" ) ;
//		dataMap.put("SQL_ST_ISSUE_RET_DTL_EXP_SELECT_MULTIPLE", "SELECT a.item_code,  f.short_desc item_desc,a.batch_id,a.bin_location_code issue_to_bin_location_code, g.short_desc TO_BIN_DESC,a.to_bin_location_code issue_fm_bin_location_code, e.short_desc  bin_desc,TO_CHAR(a.expiry_date_or_receipt_date,'dd/mm/yyyy')  expiry_receipt_dt,a.trade_id, NVL(long_name,a.trade_id) trade_name,c.iss_item_qty, NVL(c.ret_item_qty,0) ret_item_qty, a.item_qty QTY,(c.iss_item_qty-c.ret_item_qty)+a.item_qty avail_qty,a.org_doc_type_code doc_type_code, a.org_doc_no doc_no, a.org_seq_no seq_no FROM st_issue_ret_dtl_exp a,st_issue_dtl_exp c,st_issue_ret_hdr  d,mm_bin_location e, mm_item f, mm_bin_location g, am_trade_name h WHERE a.item_code=f.item_code AND a.trade_id=h.trade_id(+) AND a.facility_id=c.facility_id AND    a.org_doc_type_code=c.doc_type_code AND a.org_doc_no=c.doc_no AND a.org_seq_no=c.seq_no AND  a.item_code=c.item_code AND a.batch_id=c.batch_id AND a.expiry_date_or_receipt_date =c.expiry_date_or_receipt_date AND c.to_bin_location_code=g.bin_location_code(+) AND  a.facility_id=d.facility_id AND a.doc_type_code=d.doc_type_code AND a.doc_no=d.doc_no AND   d.to_store_code=e.store_code AND a.to_bin_location_code=e.bin_location_code  AND (c.iss_item_qty-c.ret_item_qty) > 0 AND a.facility_id= ?  AND a.doc_no= ? AND  a.doc_type_code= ?  AND a.doc_srl_no= ? " ) ; 

		dataMap.put("SQL_ST_ISSUE_RETURN_HDR_UPDATE","UPDATE st_issue_ret_hdr SET doc_date =	TO_DATE(?,'dd/mm/yyyy')	,doc_ref =	? ,finalized_yn	= ?	,process_for_acknowledge = ?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	? WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ? ");
		dataMap.put("SQL_ST_ISSUE_RETURN_HDR_DELETE","DELETE FROM st_issue_ret_hdr WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ? ");
        dataMap.put("SQL_ST_ISSUE_RETURN_DTL_UPDATE","UPDATE st_issue_ret_dtl  SET ret_item_qty = ? , item_cost_value = ? ,remarks = ?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	?  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND doc_srl_no	= ?" );
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_DELETE","DELETE FROM st_issue_ret_dtl  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND	doc_srl_no = ? ");
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_DELETE_ALL","DELETE FROM st_issue_ret_dtl  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	"); 
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_EXP_UPDATE","UPDATE st_issue_ret_dtl_exp  SET   item_qty =	? ,	to_bin_location_code = ? , modified_by_id =	? ,	modified_date =	SYSDATE	, modified_at_ws_no	= ?	, modified_facility_id = ?	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ? AND batch_id = ? AND  expiry_date_or_receipt_date =to_date(?,'dd/mm/yyyy') ");
//		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_EXP_DELETE","DELETE FROM st_issue_ret_dtl_exp  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND doc_srl_no	= ?	");
		//Added by suresh.r on 24-02-2013 against AMS-CRF-0054
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_EXP_DELETE","DELETE FROM st_issue_ret_dtl_exp  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	 AND item_code = ?	");
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_EXP_DELETE_ALL","DELETE FROM st_issue_ret_dtl_exp  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	");        
//		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_EXP_SELECT_FOR_BLOCK_REL",	"SELECT store_code, item_code, batch_id, bin_location_code, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, trade_id, item_qty FROM st_issue_ret_dtl_exp WHERE  facility_id=? AND  doc_type_code =? AND doc_no=? AND doc_srl_no LIKE ?");
		//Added by suresh.r on 24-02-2013 against AMS-CRF-0054
		dataMap.put("SQL_ST_ISSUE_RETURN_DTL_EXP_SELECT_FOR_BLOCK_REL",	"SELECT store_code, item_code, batch_id, bin_location_code, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, trade_id, item_qty FROM st_issue_ret_dtl_exp WHERE  facility_id=? AND  doc_type_code =? AND doc_no=? AND item_code = ?");

	     /* For Transaction function	-->	Sales Return */

		dataMap.put("SQL_ST_SALES_RET_STORE_SELECT", "SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st , st_store ststr, st_acc_entity_param stpa WHERE	mm.store_code=st.store_code	AND mm.store_code = ststr.store_code AND	mm.eff_status='E' AND st.SRT_ALLOWED_YN = 'Y' AND ststr.SRT_ALLOWED_YN = 'Y'	AND	mm.facility_id = ? AND st.user_id=? AND mm.language_id = ? ORDER	BY 2");

		dataMap.put("SQL_ST_SALES_RET_CALCULATE_PENDING_QTY", "SELECT SUM(sal_item_qty-NVL(ret_item_qty,0)) pending_ret_qty FROM st_sal_dtl_exp WHERE  FACILITY_ID = ? AND (FACILITY_ID,DOC_TYPE_CODE,DOC_NO) IN (SELECT FACILITY_ID,DOC_TYPE_CODE,DOC_NO FROM st_sal_hdr WHERE patient_id = ? AND nvl(ENCOUNTER_ID,0)= nvl(?,0) AND finalized_yn='Y') AND item_code = ? AND store_code= ? " ); 

//		dataMap.put("SQL_ST_SALES_RETURN_BATCH_SEARCH_QUERY", "SELECT sde.item_code,mmi.short_desc item_desc, sde.batch_id, sde.bin_location_code bin_location_code ,mmb.short_desc  bin_desc,TO_CHAR(sde.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt , sde.trade_id,DECODE(sti.trade_id_applicable_yn,'Y', (SELECT short_name FROM am_trade_name WHERE trade_id=sde.trade_id),sde.trade_id) trade_name, sde.sal_item_qty, sde.sal_item_qty-NVL(sde.ret_item_qty,0) AVAIL_QTY,sde.DOC_TYPE_CODE sal_doc_type_code ,sde.DOC_NO sal_doc_no FROM st_sal_dtl_exp sde, mm_item mmi,mm_bin_location mmb,st_item sti WHERE (sde.sal_item_qty-NVL(sde.ret_item_qty,0)) > 0 AND sde.FACILITY_ID = ?  AND sde.FACILITY_ID ||'-' || sde.DOC_TYPE_CODE || '-' || sde.DOC_NO IN (SELECT FACILITY_ID || '-' || DOC_TYPE_CODE || '-' || DOC_NO FROM st_sal_hdr WHERE patient_id= ?  AND  encounter_id= ? AND finalized_yn='Y') AND mmi.item_code=sde.item_code AND sde.store_code=mmb.store_code AND mmb.bin_location_code=sde.bin_location_code AND sde.item_code=sti.item_code AND sde.item_code= ? and sde.store_code = ?" ); 
//changed for source doc/no/srl/date by Pankaj 
//		dataMap.put("SQL_ST_SALES_RETURN_BATCH_SEARCH_QUERY", "SELECT sde.item_code,mmi.short_desc item_desc, sde.batch_id, sde.bin_location_code bin_location_code ,mmb.short_desc  bin_desc,TO_CHAR(sde.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt , sde.trade_id,DECODE(sti.trade_id_applicable_yn,'Y', (SELECT short_name FROM am_trade_name WHERE trade_id=sde.trade_id),sde.trade_id) trade_name, sde.sal_item_qty, sde.sal_item_qty-NVL(sde.ret_item_qty,0) AVAIL_QTY,sde.DOC_TYPE_CODE sal_doc_type_code ,sde.DOC_NO sal_doc_no,sde.doc_srl_no sal_doc_srl_no, TO_CHAR(sdh.doc_date,'dd/mm/yyyy') sal_doc_date FROM st_sal_dtl_exp sde, mm_item mmi,mm_bin_location mmb,st_item sti,st_sal_hdr sdh WHERE (sde.sal_item_qty-NVL(sde.ret_item_qty,0)) > 0 AND sde.FACILITY_ID = ?  AND sde.FACILITY_ID ||'-' || sde.DOC_TYPE_CODE || '-' || sde.DOC_NO IN (SELECT FACILITY_ID || '-' || DOC_TYPE_CODE || '-' || DOC_NO FROM st_sal_hdr WHERE patient_id= ?  AND  NVL(encounter_id,0) LIKE NVL(?,'0') AND finalized_yn='Y') AND mmi.item_code=sde.item_code AND sde.store_code=mmb.store_code AND  mmb.bin_location_code=sde.bin_location_code AND sde.item_code=sti.item_code AND sde.item_code= ? AND sde.store_code = ? AND (sde.facility_id = sdh.facility_id AND sde.doc_type_code = sdh.doc_type_code AND sde.doc_no = sdh.doc_no) " ); 
//changed for change Bin Location by Pankaj 
//        dataMap.put("SQL_ST_SALES_RETURN_BATCH_SEARCH_QUERY", "SELECT sde.item_code,mmi.short_desc item_desc, sde.batch_id, sde.bin_location_code prev_bin_location_code, mmb.short_desc  bin_desc,sbv.bin_location_code bin_location_code, TO_CHAR(sde.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt , sde.trade_id,DECODE(sti.trade_id_applicable_yn,'Y', (SELECT short_name FROM am_trade_name WHERE trade_id=sde.trade_id),sde.trade_id) trade_name, sde.sal_item_qty, sde.sal_item_qty-NVL(sde.ret_item_qty,0) AVAIL_QTY,sde.DOC_TYPE_CODE sal_doc_type_code ,sde.DOC_NO sal_doc_no,sde.doc_srl_no sal_doc_srl_no, TO_CHAR(sdh.doc_date,'dd/mm/yyyy') sal_doc_date FROM st_sal_dtl_exp sde, mm_item mmi,mm_bin_location mmb,st_item sti,st_sal_hdr sdh,st_batch_search_view sbv WHERE (sde.sal_item_qty-NVL(sde.ret_item_qty,0)) > 0 AND sde.FACILITY_ID = ?  AND sde.FACILITY_ID ||'-' || sde.DOC_TYPE_CODE || '-' || sde.DOC_NO IN (SELECT FACILITY_ID || '-' || DOC_TYPE_CODE || '-' || DOC_NO FROM st_sal_hdr WHERE patient_id= ?  AND  NVL(encounter_id,0) LIKE NVL(?,'0') AND  finalized_yn='Y' ) AND  mmi.item_code=sde.item_code AND sde.store_code=mmb.store_code AND    mmb.bin_location_code=sbv.bin_location_code AND  sde.item_code=sti.item_code AND sde.item_code= ? AND sde.store_code = ? AND (sde.facility_id = sdh.facility_id AND sde.doc_type_code = sdh.doc_type_code AND sde.doc_no = sdh.doc_no) AND (sdh.store_code=sbv.store_code AND sde.item_code=sbv.item_code AND sde.batch_id=sbv.batch_id  AND /* sde.bin_location_code=sbv.bin_location_code  AND */ sde.expiry_date_or_receipt_date=sbv.expiry_date ) AND sdh.sal_trn_type = ? " ); 
//changed as batch may not be available and stock_ite_yn must be "Y" . Modified on 15_07_2004  
        dataMap.put("SQL_ST_SALES_RETURN_BATCH_SEARCH_QUERY", "SELECT   sde.item_code, mmi.short_desc item_desc, sde.batch_id, sde.bin_location_code bin_location_code, mmb.short_desc bin_desc, TO_CHAR (sde.expiry_date_or_receipt_date, 'dd/mm/yyyy') expiry_receipt_dt, sde.trade_id, DECODE(sti.trade_id_applicable_yn, 'Y', (SELECT short_name FROM am_trade_name_lang_vw  am_trade_name WHERE trade_id = sde.trade_id AND mmi.language_id = am_trade_name.language_id), sde.trade_id) trade_name, sde.sal_item_qty, sde.sal_item_qty - NVL (sde.ret_item_qty, 0)+ ST_COMM_QTY_FOR_DOCNO(?, ?, ?, ?, sde.store_code, srexp.bin_location_code, sde.batch_id, sde.EXPIRY_DATE_OR_RECEIPT_DATE , sde.item_code )avail_qty, sde.doc_type_code sal_doc_type_code, sde.doc_no sal_doc_no, sde.doc_srl_no sal_doc_srl_no, TO_CHAR (sdh.doc_date, 'dd/mm/yyyy') sal_doc_date, srexp.bin_location_code ret_bin_locn FROM ST_SAL_DTL_EXP sde, mm_item_lang_vw mmi, ST_ITEM sti, ST_SAL_HDR sdh,          ST_SAL_DTL ssd, mm_bin_location_lang_vw mmb, ST_SAL_RET_DTL_EXP srexp WHERE (sde.sal_item_qty - NVL (sde.ret_item_qty, 0)) > 0 AND sde.facility_id = ? AND sde.facility_id || '-' || sde.doc_type_code || '-' || sde.doc_no IN (SELECT facility_id || '-' || doc_type_code || '-' || doc_no FROM ST_SAL_HDR WHERE patient_id = ? AND NVL (encounter_id, 0) LIKE NVL (?, '0') AND finalized_yn = 'Y') AND mmi.item_code = sde.item_code AND sde.item_code = sti.item_code AND sde.item_code = ? AND sde.store_code = ? AND mmb.bin_location_code = sde.bin_location_code AND mmb.store_code = sde.store_code AND (    sde.facility_id = ssd.facility_id AND sde.doc_type_code = ssd.doc_type_code AND sde.doc_no = ssd.doc_no AND sde.doc_srl_no = ssd.doc_srl_no) AND sdh.sal_trn_type = ? AND ssd.stock_item_yn = 'Y' AND (    sdh.facility_id = ssd.facility_id AND sdh.doc_type_code = ssd.doc_type_code AND sdh.doc_no = ssd.doc_no) AND mmi.language_id = mmb.language_id AND mmi.language_id = ? AND sde.doc_type_code = ? AND sde.doc_no = ? AND sde.batch_id = srexp.batch_id(+) AND sde.trade_id = srexp.trade_id(+) 	 AND sde.doc_no = srexp.sal_doc_no(+) AND sde.doc_type_code = srexp.sal_doc_type_code(+) AND  TRUNC(sde.EXPIRY_DATE_OR_RECEIPT_DATE) = TRUNC(srexp.EXPIRY_DATE_OR_RECEIPT_DATE(+)) ORDER BY sdh.added_date" ); 

        /*  Need to copy in ejbStRepo starts here */
        /*
		dataMap.put("SQL_ST_SAL_RET_HDR_INSERT_FOR_SAL_RET", "INSERT INTO  st_sal_ret_hdr(facility_id,doc_type_code,doc_no,doc_date,doc_ref,store_code,finalized_yn,gl_interfaced_yn,trn_type,remarks,item_class_code,module_id,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,patient_id,encounter_id) VALUES (?,?,?,TO_DATE(?, 'dd/mm/yyyy'),?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ?, ? ) " );
		dataMap.put("SQL_ST_SAL_RET_DTL_INSERT_FOR_SAL_RET", "INSERT INTO st_sal_ret_dtl( FACILITY_ID, DOC_TYPE_CODE, DOC_NO, DOC_SRL_NO, ITEM_CODE, STOCK_ITEM_YN, ITEM_QTY, ITEM_UNIT_COST, ITEM_COST_VALUE, REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_ST_SAL_RET_DTL_EXP_INSERT_FOR_SAL_RET", "INSERT INTO st_sal_ret_dtl_exp ( FACILITY_ID, DOC_TYPE_CODE, DOC_NO, DOC_SRL_NO, STORE_CODE, ITEM_CODE, BATCH_ID, BIN_LOCATION_CODE, EXPIRY_DATE_OR_RECEIPT_DATE, TRADE_ID, ITEM_QTY, SAL_DOC_TYPE_CODE, SAL_DOC_NO, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ? )");
		dataMap.put("SQL_ST_SAL_DTL_EXP_UPDATE_FOR_SAL_RET", "UPDATE st_sal_dtl_exp SET ret_item_qty = ( NVL(ret_item_qty,0) + ? ) , modified_by_id = ?,	 modified_date = SYSDATE,  modified_at_ws_no = ?,  modified_facility_id	= ? WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? AND DOC_NO = ?  AND STORE_CODE = ? AND ITEM_CODE = ? AND BATCH_ID = ? AND BIN_LOCATION_CODE =  ? AND EXPIRY_DATE_OR_RECEIPT_DATE = TO_DATE(?,'dd/mm/yyyy')  " ) ;
		dataMap.put("SQL_ST_ITEM_MOVE_SUMM_INSERT_FOR_SAL_RET", "INSERT INTO st_item_move_summ( facility_id, item_code, store_code, move_year, move_month, srt_qty, srt_cost, srt_value, srt_qty_ns, srt_cost_ns, srt_value_ns, month_closing_qty, month_closing_value, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?) " ) ;
		dataMap.put("SQL_ST_ITEM_MOVE_SUMM_UPDATE_FOR_SAL_RET", "UPDATE st_item_move_summ SET srt_qty=NVL(srt_qty,0)+?, srt_cost=NVL(srt_cost,0)+?, srt_value=NVL(srt_value,0)+?, srt_qty_ns=NVL(srt_qty_ns,0)+?, srt_cost_ns=NVL(srt_cost_ns,0)+?, srt_value_ns=NVL(srt_value_ns,0)+?, month_closing_qty=NVL(month_closing_qty,0)+?, month_closing_value=NVL(month_closing_value,0)+?, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id=? AND item_code=? AND store_code=? AND move_year=? AND move_month=?");
		dataMap.put("SQL_ST_ITEM_TRN_DTL_INSERT_FOR_SAL_RET",	"INSERT INTO st_item_trn_dtl(facility_id, store_code, item_code, posted_date, trn_srl_no, trn_type, doc_type_code, doc_no, doc_srl_no, doc_date, doc_ref, batch_id, expiry_date, item_qty_normal, item_unit_cost, stk_uom_code, stock_item_yn,  bin_location_code, trade_id, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
        dataMap.put("SQL_ST_SAL_RET_HDR_DELETE_FOR_SAL_RET", "DELETE FROM st_sal_ret_hdr WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ? " );
		dataMap.put("SQL_ST_SAL_RET_DTL_DELETE_FOR_SAL_RET", "DELETE FROM st_sal_ret_dtl WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");
		dataMap.put("SQL_ST_SAL_RET_DTL_DELETE_ALL_FOR_SAL_RET", "DELETE FROM st_sal_ret_dtl WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ? ");
		dataMap.put("SQL_ST_SAL_RET_DTL_EXP_DELETE_FOR_SAL_RET", "DELETE FROM st_sal_ret_dtl_exp WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ? " );
		dataMap.put("SQL_ST_SAL_RET_DTL_EXP_DELETE_ALL_FOR_SAL_RET", "DELETE FROM st_sal_ret_dtl_exp WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  " );
		dataMap.put("SQL_ST_SAL_RET_HDR_UPDATE_FOR_SAL_RET",	"UPDATE st_sal_ret_hdr SET doc_ref = ? , finalized_yn = ? , remarks=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ? WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ? ");
		dataMap.put("SQL_ST_SAL_RET_DTL_UPDATE_FOR_SAL_RET",	"UPDATE st_sal_ret_dtl SET item_qty = ? , item_unit_cost=? , item_cost_value=?,  remarks = ? , modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ? WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ? AND doc_srl_no = ? ");
        
        */
        /*  Need to copy in ejbStRepo ends here */

		dataMap.put("SQL_ST_SAL_RET_HDR_QUERY_RESULT", " SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.store_code,  fms.short_desc to_store_desc, hdr.patient_id,NVL(hdr.encounter_id,'') encounter_id FROM st_sal_ret_hdr hdr, mm_store_lang_vw fms, sy_doc_type_master_lang_vw sy, st_user_access_for_store uaca /* ,  st_acc_entity_param pa */ WHERE hdr.doc_type_code = sy.doc_type_code AND hdr.store_code= fms.store_code AND uaca.store_code = hdr.store_code AND hdr.finalized_yn='N' AND hdr.module_id='ST' AND uaca.srt_allowed_yn = 'Y' AND hdr.doc_type_code LIKE ? AND TO_CHAR(hdr.doc_no) LIKE  ? AND TO_CHAR(hdr.doc_date,'dd/mm/yyyy') LIKE ? AND hdr.store_code LIKE ? AND  NVL(hdr.item_class_code,'X') LIKE ? AND uaca.user_id = ? AND hdr.facility_id=?  AND sy.language_id = fms.language_id AND fms.language_id = ?  and NVL(hdr.LOCN_CODE,'%') like(?) and NVL(hdr.patient_id,'%') like (?)");

		dataMap.put("SQL_ST_SAL_RET_DTL_SELECT_MAX_DOC_SRL_NO",	"SELECT	MAX(doc_srl_no)	max_doc_srl_no FROM	st_sal_ret_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
		
		//dataMap.put("SQL_ST_SAL_RET_HDR_SELECT_SINGLE",	"SELECT	TO_CHAR(st.doc_date,'dd/mm/yyyy') doc_date, st.doc_ref, st.store_code, st.patient_id, st.encounter_id, st.trn_type, decode(hdr.SAL_TRN_TYPE,'X', hdr.PATIENT_NAME, mp.patient_name)patient_name ,st.remarks ,st.item_class_code,st.sal_trn_type,st.sales_doc_no,st.LOCN_CODE FROM st_sal_ret_hdr st, mp_patient	mp, st_sal_hdr hdr where mp.patient_id=st.patient_id AND st.SALES_DOC_NO = hdr.DOC_NO AND st.patient_id = hdr.patient_id AND st.facility_id=? AND st.doc_type_code=? AND st.doc_no=?");
         dataMap.put("SQL_ST_SAL_RET_HDR_SELECT_SINGLE",	"SELECT	TO_CHAR(st.doc_date,'dd/mm/yyyy') doc_date, st.doc_ref, st.store_code, st.patient_id, st.encounter_id, st.trn_type, decode(hdr.SAL_TRN_TYPE,'X', hdr.PATIENT_NAME, mp.patient_name)patient_name ,st.remarks ,st.item_class_code,st.sal_trn_type,st.sales_doc_no,st.LOCN_CODE,hdr.DOC_TYPE_CODE SALES_DOC_TYPE_CODE ,hdr.FACILITY_ID FROM st_sal_ret_hdr st, mp_patient	mp, st_sal_hdr hdr where mp.patient_id=st.patient_id AND st.SALES_DOC_NO = hdr.DOC_NO AND st.patient_id = hdr.patient_id AND st.facility_id=? AND st.doc_type_code=? AND st.doc_no=?");

		dataMap.put("SQL_ST_SAL_RET_DTL_SELECT_MULTIPLE",	"SELECT a.doc_no,a.doc_srl_no, a.item_code, b.short_desc item_desc,a.stock_item_yn, a.item_qty, a.item_unit_cost,a.item_cost_value,a.PAT_NET_AMT,a.GROSS_CHARGE_AMT, c.sale_uom_code uom_code, d.short_desc uom_desc,a.remarks,DECODE(a.stock_item_yn,'Y', (SELECT SUM(sal_item_qty-NVL(ret_item_qty,0)) FROM st_sal_dtl_exp WHERE facility_id=a.facility_id AND (facility_id,doc_type_code,doc_no,item_code) IN (SELECT facility_id,sal_doc_type_code, sal_doc_no, item_code FROM st_sal_ret_dtl_exp WHERE  facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=a.item_code)))+a.item_qty stock_available FROM st_sal_ret_dtl a, mm_item_lang_vw b, st_item c, am_uom_lang_vw d WHERE a.facility_id=? AND a.doc_type_code=? AND a.doc_no=?  AND a.item_code=b.item_code AND a.item_code=c.item_code AND c.sale_uom_code=d.uom_code AND b.language_id = d.language_id AND b.language_id = ?" );
		//changed by Pankaj on 08/07/2004 . Remodified on 14/07/2004
//		dataMap.put("SQL_ST_SAL_RET_DTL_EXP_SELECT_MULTIPLE",		"SELECT srde.item_code,mmi.short_desc item_desc, srde.batch_id, srde.bin_location_code bin_location_code ,mmb.short_desc  bin_desc,TO_CHAR(srde.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt , srde.trade_id,DECODE(sti.trade_id_applicable_yn,'Y', (SELECT short_name FROM am_trade_name WHERE trade_id=srde.trade_id),srde.trade_id) trade_name,srde.item_qty qty, sde.sal_item_qty-NVL(sde.ret_item_qty,0) AVAIL_QTY, srde.sal_doc_type_code,srde.sal_doc_no,TO_CHAR(sdh.doc_date,'dd/mm/yyyy') sal_doc_date,sde.doc_srl_no sal_doc_srl_no FROM st_sal_ret_dtl_exp srde,st_sal_dtl_exp sde,st_sal_hdr sdh,mm_item mmi,mm_bin_location mmb,st_item sti  WHERE srde.FACILITY_ID = ? AND mmi.item_code=srde.item_code AND srde.store_code=mmb.store_code AND mmb.bin_location_code=srde.bin_location_code AND srde.item_code=sti.item_code AND sde.doc_no=srde.sal_doc_no AND sde.doc_type_code=srde.sal_doc_type_code AND  sde.batch_id=srde.batch_id AND sde.bin_location_code=srde.bin_location_code AND sde.expiry_date_or_receipt_date=srde.expiry_date_or_receipt_date AND srde.doc_no=? AND srde.doc_type_code=? AND srde.doc_srl_no=? AND  (sdh.doc_no=sde.doc_no AND sdh.doc_type_code = sde.doc_type_code AND sdh.facility_id = sde.facility_id)");
		dataMap.put("SQL_ST_SAL_RET_DTL_EXP_SELECT_MULTIPLE",		"SELECT srde.item_code,mmi.short_desc item_desc, srde.batch_id, srde.bin_location_code bin_location_code ,srde.bin_location_code new_bin_location_code,mmb.short_desc  bin_desc,TO_CHAR(srde.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_receipt_dt , srde.trade_id,DECODE(sti.trade_id_applicable_yn,'Y', (SELECT short_name FROM am_trade_name_lang_vw am_trade_name WHERE trade_id=srde.trade_id AND mmi.language_id = am_trade_name.language_id),srde.trade_id) trade_name,srde.item_qty qty, sde.sal_item_qty-NVL(sde.ret_item_qty,0) AVAIL_QTY, srde.sal_doc_type_code,srde.sal_doc_no,TO_CHAR(sdh.doc_date,'dd/mm/yyyy') sal_doc_date,sde.doc_srl_no sal_doc_srl_no FROM st_sal_ret_dtl_exp srde,st_sal_dtl_exp sde,st_sal_hdr sdh,mm_item_lang_vw mmi,mm_bin_location_lang_vw mmb,st_item sti  WHERE srde.FACILITY_ID = ? AND mmi.item_code=srde.item_code AND srde.store_code=mmb.store_code AND mmb.bin_location_code=srde.bin_location_code AND srde.item_code=sti.item_code AND sde.doc_no=srde.sal_doc_no AND sde.doc_type_code=srde.sal_doc_type_code AND  sde.batch_id=srde.batch_id AND /* sde.bin_location_code=srde.bin_location_code AND */ sde.expiry_date_or_receipt_date=srde.expiry_date_or_receipt_date AND srde.doc_no=? AND srde.doc_type_code=? AND srde.doc_srl_no=? AND  (sdh.doc_no=sde.doc_no AND sdh.doc_type_code = sde.doc_type_code AND sdh.facility_id = sde.facility_id) AND mmi.language_id = mmb.language_id AND mmi.language_id = ?");
		/* END ....BY PANKAJ */


		//Item Search
		dataMap.put("SQL_ST_ITEM_CLASS","SELECT	ITEM_CLASS_CODE	code,short_desc	description	FROM mm_item_class_lang_vw WHERE EFF_STATUS='E' AND language_id = ? ORDER BY short_desc");
		dataMap.put("SQL_ST_ITEM_STORE","SELECT STORE_CODE code,SHORT_DESC description  FROM mm_store_lang_vw mm_store WHERE STORE_CODE	LIKE UPPER(?) AND UPPER(SHORT_DESC)	LIKE UPPER(?) AND eff_status='E' AND language_id = ");
		dataMap.put("SQL_ST_ITEM_ANALYSIS","SELECT ITEM_ANAL_CODE code,short_desc description FROM mm_item_analysis_lang_vw	where EFF_STATUS='E'  AND language_id = ? order	by short_desc");
	//	dataMap.put("SQL_ITEM_SEARCH_QUERY",	"SELECT	 distinct  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost,d.short_desc	 uom_desc ,e.short_name	 manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code ,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn FROM st_item a,mm_item	b,mm_item_class	c,am_uom d ,am_manufacturer	e,mm_trade_name_for_item f,am_trade_name g,st_item_store h WHERE a.item_code=b.item_code AND b.eff_status='E'  AND nvl(h.eff_status,'E') = 'E' AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+) AND	b.manufacturer_id=e.manufacturer_id(+) AND a.item_code=f.item_code(+) AND	   f.trade_id=g.trade_id(+)	 AND a.item_code=h.item_code(+)	AND	UPPER(a.item_code) LIKE	UPPER(nvl(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(nvl(?,'%')) AND UPPER(b.alpha_code) LIKE UPPER(nvl(?,'%'))	AND	UPPER(NVL(a.machine_code,'%')) LIKE	UPPER(nvl(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%')) LIKE	UPPER(nvl(?,'%')) AND  UPPER(nvl(f.trade_id,'%'))  LIKE	UPPER(nvl(?,'%'))  AND	UPPER(NVL(g.short_name,'%')) LIKE UPPER(nvl(?,'%'))	 AND NVL(a.abc_class_code,'%') LIKE	DECODE(?,'','%',?) AND a.medical_item_yn like DECODE(?,'A','%',?) AND b.ps_item_yn like	DECODE(?,'A','%',?)	AND	b.sole_source_yn like DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE DECODE(?,'','%',?)	 AND a.mfg_item_yn like	DECODE(?,'A','%',?)	AND	NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	a.expiry_yn	LIKE DECODE(?,'A','%',?) AND nvl(h.store_code,'%') LIKE	  UPPER(nvl(?,'%'))	 AND a.consignment_item_yn like	DECODE(?,'A','%',?)	");
//		Added on 01/05/2005b for supplier_code
		dataMap.put("SQL_ITEM_SEARCH_QUERY","SELECT	 DISTINCT  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost, (select SHORT_DESC from am_uom_lang_vw WHERE LANGUAGE_ID= ? and UOM_CODE IN (SELECT DEF_ISSUE_UOM FROM st_item_store where item_code= ? AND STORE_CODE= ? )) uom_desc ,e.short_name	 manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code ,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn,b.curr_supp_code ,NVL(A.ALLOW_DECIMALS_YN,'N')ALLOW_DECIMALS_YN  FROM st_item a,mm_item_lang_vw	b,mm_item_class_lang_vw	c,am_uom_lang_vw d ,am_manufacturer_lang_vw	e,mm_trade_name_for_item f,am_trade_name_lang_vw g,st_item_store h WHERE a.item_code=b.item_code AND b.eff_status='E'  AND NVL(h.eff_status,'E') = 'E' AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+) AND	b.manufacturer_id=e.manufacturer_id(+) AND a.item_code=f.item_code(+) AND	   f.trade_id=g.trade_id(+)	 AND a.item_code=h.item_code(+)	AND	UPPER(a.item_code) LIKE	UPPER(NVL(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(NVL(?,'%')) AND UPPER(b.alpha_code) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(a.machine_code,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(f.trade_id,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(g.short_name,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(a.abc_class_code,'%') LIKE	DECODE(?,'','%',?) AND a.medical_item_yn LIKE DECODE(?,'A','%',?) AND b.ps_item_yn LIKE	DECODE(?,'A','%',?)	AND	b.sole_source_yn LIKE DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE DECODE(?,'','%',?)	 AND a.mfg_item_yn LIKE	DECODE(?,'A','%',?)	AND	NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	a.expiry_yn	LIKE DECODE(?,'A','%',?) AND NVL(h.store_code,'%') LIKE	  UPPER(NVL(?,'%'))	 AND a.consignment_item_yn LIKE	DECODE(?,'A','%',?)  AND  b.language_id = ?  AND b.language_id = c.language_id(+)  AND b.language_id = d.language_id(+) AND b.language_id = e.language_id(+)  AND g.language_id(+) = ?");//modified for ML-MMOH-SCF-1065
//		Added on 9/30/2005 for Assembly  Detail 
		dataMap.put("SQL_ITEM_SEARCH_QUERY_FOR_ASSM_DTL",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 GEN_UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE,K.SHORT_DESC UOM_DESC  FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ACC_ENTITY_PARAM J,AM_UOM_LANG_VW K WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND H.DEF_ISSUE_UOM = K.UOM_CODE AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND A.ITEM_CODE NOT IN (SELECT ITEM_CODE FROM ST_ASSEMBLY_HDR) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+) AND B.LANGUAGE_ID = K.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		
		
		//Added by sakti against AMS-CRF-0028
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_FOR_ASSM_DTL_STORE",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty  FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ACC_ENTITY_PARAM J WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND A.ITEM_CODE NOT IN (SELECT ITEM_CODE FROM ST_ASSEMBLY_HDR) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		//Added by Rabbani#AMS-CRF-0068(49822) on 11-AUG-2014
		dataMap.put("SQL_ITEM_SEARCH_QUERY_FOR_ASSM_DTL_STORE",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 GEN_UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty,(NVL(H.MAX_STK_QTY,0)*ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MAX_STR_QTY  ,(NVL(H.MIN_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MIN_STR_QTY ,(NVL (H.REORDER_LEVEL, 0) * ST_GET_UOM_CONV_FAC_SING_STR (h.item_code,h.store_code)) REORDER_LEVEL,K.SHORT_DESC UOM_DESC  FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ACC_ENTITY_PARAM J,AM_UOM_LANG_VW K WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND H.DEF_ISSUE_UOM = K.UOM_CODE AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND A.ITEM_CODE NOT IN (SELECT ITEM_CODE FROM ST_ASSEMBLY_HDR) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+) AND B.LANGUAGE_ID = K.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
	dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_FOR_ASSM_DTL",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N')  ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS,A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 GEN_UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE,K.SHORT_DESC UOM_DESC  FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ACC_ENTITY_PARAM J,AM_UOM_LANG_VW K WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND H.DEF_ISSUE_UOM = K.UOM_CODE AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND A.ITEM_CODE NOT IN (SELECT ITEM_CODE FROM ST_ASSEMBLY_HDR)  AND (MATERIAL_GROUP_CODE IN (SELECT MATERIAL_GROUP_CODE FROM MM_USER_MATERIAL_GROUP WHERE USER_ID = ?)) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+) AND B.LANGUAGE_ID = K.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
	
	    
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_FOR_ASSM_DTL_STORE",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N')  ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS,A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE, (SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ACC_ENTITY_PARAM J WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND A.ITEM_CODE NOT IN (SELECT ITEM_CODE FROM ST_ASSEMBLY_HDR)  AND (MATERIAL_GROUP_CODE IN (SELECT MATERIAL_GROUP_CODE FROM MM_USER_MATERIAL_GROUP WHERE USER_ID = ?)) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		
		//Added by Rabbani#AMS-CRF-0068(49822) on 11-AUG-2014
		dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_FOR_ASSM_DTL_STORE",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N')  ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS,A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 GEN_UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE, (SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty,(NVL(H.MAX_STK_QTY,0)*ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MAX_STR_QTY  ,(NVL(H.MIN_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MIN_STR_QTY ,(NVL (H.REORDER_LEVEL, 0) * ST_GET_UOM_CONV_FAC_SING_STR (h.item_code,h.store_code)) REORDER_LEVEL,K.SHORT_DESC UOM_DESC FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ACC_ENTITY_PARAM J, AM_UOM_LANG_VW K  WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND H.DEF_ISSUE_UOM = K.UOM_CODE AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND A.ITEM_CODE NOT IN (SELECT ITEM_CODE FROM ST_ASSEMBLY_HDR)  AND (MATERIAL_GROUP_CODE IN (SELECT MATERIAL_GROUP_CODE FROM MM_USER_MATERIAL_GROUP WHERE USER_ID = ?)) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+) AND B.LANGUAGE_ID = K.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
//		Added on 9/30/2005 for Manufacturing Request
//		dataMap.put("SQL_ITEM_SEARCH_QUERY_FOR_MFG_REQ",	"SELECT	 distinct  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost,d.short_desc	 uom_desc ,e.short_name	 manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code ,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn,b.curr_supp_code  FROM st_item a,mm_item	b,mm_item_class	c,am_uom d ,am_manufacturer	e,mm_trade_name_for_item f,am_trade_name g,st_item_store h, st_assembly_hdr i WHERE a.item_code=b.item_code AND b.eff_status='E'  AND nvl(h.eff_status,'E') = 'E' AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+) AND	b.manufacturer_id=e.manufacturer_id(+) AND a.item_code=f.item_code(+) AND	   f.trade_id=g.trade_id(+)	 AND a.item_code=h.item_code(+)	AND h.item_code = i.item_code  AND	UPPER(a.item_code) LIKE	UPPER(nvl(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(nvl(?,'%')) AND UPPER(b.alpha_code) LIKE UPPER(nvl(?,'%'))	AND	UPPER(NVL(a.machine_code,'%')) LIKE	UPPER(nvl(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%')) LIKE	UPPER(nvl(?,'%')) AND  UPPER(nvl(f.trade_id,'%'))  LIKE	UPPER(nvl(?,'%'))  AND	UPPER(NVL(g.short_name,'%')) LIKE UPPER(nvl(?,'%'))	 AND NVL(a.abc_class_code,'%') LIKE	DECODE(?,'','%',?) AND a.medical_item_yn like DECODE(?,'A','%',?) AND b.ps_item_yn like	DECODE(?,'A','%',?)	AND	b.sole_source_yn like DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE DECODE(?,'','%',?)	 AND a.mfg_item_yn like	DECODE(?,'A','%',?)	AND	NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	a.expiry_yn	LIKE DECODE(?,'A','%',?) AND nvl(h.store_code,'%') LIKE	  UPPER(nvl(?,'%'))	 AND a.consignment_item_yn like	DECODE(?,'A','%',?) AND	i.PREPARATION_TYPE = upper(?) and i.PREPARATION_MODE = upper(?)	");
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_FOR_MFG_REQ",	"SELECT  DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC  UOM_DESC ,E.SHORT_NAME  MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE ,I.PREPARATION_TYPE, I.PREPARATION_MODE FROM ST_ITEM A,MM_ITEM_LANG_VW B,MM_ITEM_CLASS_LANG_VW C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H, ST_ASSEMBLY_HDR I,ST_ACC_ENTITY_PARAM J WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND    F.TRADE_ID=G.TRADE_ID(+)  AND A.ITEM_CODE=H.ITEM_CODE(+) AND H.ITEM_CODE = I.ITEM_CODE  AND UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(NVL(A.MACHINE_CODE,'%')) LIKE UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE UPPER(NVL(?,'%'))  AND UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))  AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)  AND A.MFG_ITEM_YN LIKE DECODE(?,'A','%',?) AND NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND A.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE   UPPER(NVL(?,'%'))  AND A.CONSIGNMENT_ITEM_YN LIKE DECODE(?,'A','%',?) AND UPPER(I.PREPARATION_TYPE ) LIKE UPPER(NVL(?,'%')) AND UPPER(I.PREPARATION_MODE) LIKE UPPER(NVL(?,'%'))     AND B.LANGUAGE_ID = ? AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		//Modified by sakti against AMS-crf-0028
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_FOR_MFG_REQ",	"SELECT  DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC  UOM_DESC ,E.SHORT_NAME  MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE ,I.PREPARATION_TYPE, I.PREPARATION_MODE,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty FROM ST_ITEM A,MM_ITEM_LANG_VW B,MM_ITEM_CLASS_LANG_VW C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H, ST_ASSEMBLY_HDR I,ST_ACC_ENTITY_PARAM J WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND    F.TRADE_ID=G.TRADE_ID(+)  AND A.ITEM_CODE=H.ITEM_CODE(+) AND H.ITEM_CODE = I.ITEM_CODE  AND UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(NVL(A.MACHINE_CODE,'%')) LIKE UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE UPPER(NVL(?,'%'))  AND UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))  AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)  AND A.MFG_ITEM_YN LIKE DECODE(?,'A','%',?) AND NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND A.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE   UPPER(NVL(?,'%'))  AND A.CONSIGNMENT_ITEM_YN LIKE DECODE(?,'A','%',?) AND UPPER(I.PREPARATION_TYPE ) LIKE UPPER(NVL(?,'%')) AND UPPER(I.PREPARATION_MODE) LIKE UPPER(NVL(?,'%'))     AND B.LANGUAGE_ID = ? AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		
		//Added by Rabbani#AMS-CRF-0068(49822) on 11-AUG-2014
		dataMap.put("SQL_ITEM_SEARCH_QUERY_FOR_MFG_REQ",	"SELECT  DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC  GEN_UOM_DESC ,E.SHORT_NAME  MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE ,I.PREPARATION_TYPE, I.PREPARATION_MODE,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty, (NVL(H.MAX_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MAX_STR_QTY  ,(NVL(H.MIN_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MIN_STR_QTY ,(NVL (H.REORDER_LEVEL, 0) * ST_GET_UOM_CONV_FAC_SING_STR (h.item_code,h.store_code)) REORDER_LEVEL,K.SHORT_DESC UOM_DESC FROM ST_ITEM A,MM_ITEM_LANG_VW B,MM_ITEM_CLASS_LANG_VW C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H, ST_ASSEMBLY_HDR I,ST_ACC_ENTITY_PARAM J,AM_UOM_LANG_VW K WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND    F.TRADE_ID=G.TRADE_ID(+)  AND A.ITEM_CODE=H.ITEM_CODE(+) AND H.ITEM_CODE = I.ITEM_CODE AND H.DEF_ISSUE_UOM = K.UOM_CODE  AND UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(NVL(A.MACHINE_CODE,'%')) LIKE UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE UPPER(NVL(?,'%'))  AND UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))  AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)  AND A.MFG_ITEM_YN LIKE DECODE(?,'A','%',?) AND NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND A.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE   UPPER(NVL(?,'%'))  AND A.CONSIGNMENT_ITEM_YN LIKE DECODE(?,'A','%',?) AND UPPER(I.PREPARATION_TYPE ) LIKE UPPER(NVL(?,'%')) AND UPPER(I.PREPARATION_MODE) LIKE UPPER(NVL(?,'%'))     AND B.LANGUAGE_ID = ? AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+) AND B.LANGUAGE_ID = K.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)  AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
//		Added on 6/1/2005 for Item combination check and qty_on_hand >0
		dataMap.put("SQL_ITEM_SEARCH_QUERY_ITM_CMB_CHK",	"SELECT    DISTINCT  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost,d.short_desc        uom_desc,e.short_name       manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn  FROM st_item a,mm_item_lang_vw      b,mm_item_class_lang_vw       c,am_uom_lang_vw d ,am_manufacturer_lang_vw  e,mm_trade_name_for_item f,am_trade_name_lang_vw g,st_item_store h,st_item_store I   WHERE a.item_code=b.item_code AND b.eff_status='E'   AND NVL(h.eff_status,'E') = 'E' AND NVL(i.eff_status,'E') = 'E'   AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+)  AND b.manufacturer_id=e.manufacturer_id(+)  AND a.item_code=f.item_code(+) AND f.trade_id=g.trade_id(+)         AND a.item_code=h.item_code(+)    AND a.item_code=I.item_code(+)  AND h.qty_on_hand > 0  AND UPPER(a.item_code) LIKE UPPER(NVL(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(NVL(?,'%'))   AND UPPER(b.alpha_code) LIKE UPPER(NVL(?,'%'))       AND     UPPER(NVL(a.machine_code,'%'))  LIKE      UPPER(NVL(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%'))     LIKE    UPPER(NVL(?,'%'))   AND UPPER(NVL(f.trade_id,'%')) LIKE    UPPER(NVL(?,'%'))   AND     UPPER(NVL(g.short_name,'%')) LIKE UPPER(NVL(?,'%'))        AND NVL(a.abc_class_code,'%') LIKE DECODE(?,'','%',?) AND a.medical_item_yn LIKE DECODE(?,'A','%',?) AND b.ps_item_yn LIKE   DECODE(?,'A','%',?)     AND      b.sole_source_yn LIKE DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE  DECODE(?,'','%',?) AND a.mfg_item_yn LIKE  DECODE(?,'A','%',?)    AND       NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)  AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)  AND       NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND      a.expiry_yn  LIKE DECODE(?,'A','%',?)   AND NVL(h.store_code,'%') LIKE  UPPER(NVL(?,'%'))       AND NVL(I.store_code,'%') LIKE  UPPER(NVL(?,'%'))  AND a.consignment_item_yn LIKE  DECODE(?,'A','%',?)  AND b.language_id = ?  AND b.language_id = c.language_id(+)  AND b.language_id = d.language_id(+)  AND b.language_id = e.language_id(+)	 AND g.language_id(+) = ? ");
		dataMap.put("SQL_ITEM_SEARCH_QUERY_ITM_C",	"SELECT    distinct  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost,d.short_desc        uom_desc,e.short_name       manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn  FROM st_item a,mm_item      b,mm_item_class       c,am_uom d ,am_manufacturer  e,mm_trade_name_for_item f,am_trade_name g,st_item_store h,st_item_store I   WHERE a.item_code=b.item_code AND b.eff_status='E'   AND nvl(h.eff_status,'E') = 'E' AND nvl(i.eff_status,'E') = 'E'   AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+)  AND b.manufacturer_id=e.manufacturer_id(+)  AND a.item_code=f.item_code(+) AND f.trade_id=g.trade_id(+)         AND a.item_code=h.item_code(+)    AND a.item_code=I.item_code(+)  AND h.qty_on_hand > 0  AND UPPER(a.item_code) LIKE UPPER(nvl(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(nvl(?,'%'))   AND UPPER(b.alpha_code) LIKE UPPER(nvl(?,'%'))       AND     UPPER(NVL(a.machine_code,'%'))  LIKE      UPPER(nvl(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%'))     LIKE    UPPER(nvl(?,'%'))   AND UPPER(nvl(f.trade_id,'%')) LIKE    UPPER(nvl(?,'%'))   AND     UPPER(NVL(g.short_name,'%')) LIKE UPPER(nvl(?,'%'))        AND NVL(a.abc_class_code,'%') LIKE DECODE(?,'','%',?) AND a.medical_item_yn like DECODE(?,'A','%',?) AND b.ps_item_yn like   DECODE(?,'A','%',?)     AND      b.sole_source_yn like DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE  DECODE(?,'','%',?) AND a.mfg_item_yn like  DECODE(?,'A','%',?)    AND       NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)  AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)  AND       NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND      a.expiry_yn  LIKE DECODE(?,'A','%',?)   AND nvl(h.store_code,'%') LIKE  UPPER(nvl(?,'%'))       AND nvl(I.store_code,'%') LIKE  UPPER(nvl(?,'%'))  AND a.consignment_item_yn like  DECODE(?,'A','%',?)");
		dataMap.put("SQL_ST_ITEM_SEARCH_MANUFACTURER",	"SELECT	 a.MANUFACTURER_ID,a.SHORT_NAME	 FROM am_manufacturer_lang_vw a	WHERE  a.EFF_STATUS='E'	AND language_id = ? order by SHORT_NAME");
// Added on 11/16/2005
		dataMap.put("SQL_ST_ITEM_SEARCH_MANUFACTURER_CMPLNT",	"SELECT DISTINCT a.manufacturer_id, b.short_name FROM mm_item a, am_manufacturer_lang_vw b WHERE a.item_code = ? AND a.manufacturer_id = b.manufacturer_id AND a.sole_source_yn = 'Y' AND b.eff_status = 'E' AND b.language_id = ? UNION ALL SELECT DISTINCT a.manufacturer_id, b.short_name FROM am_trade_name a, am_manufacturer_lang_vw b WHERE a.manufacturer_id = b.manufacturer_id AND trade_id IN ( SELECT trade_id FROM mm_trade_name_for_item a, mm_item b WHERE a.item_code = b.item_code AND a.item_code = ? AND sole_source_yn = 'N') AND b.eff_status = 'E' AND b.language_id = ?  ORDER BY SHORT_NAME");

		dataMap.put("SQL_ST_ADJ_HDR_INSERT_FOR_CON_EXP", "INSERT	INTO st_adj_hdr(facility_id, doc_type_code,	doc_no,	doc_date, doc_ref, store_code, authorized_by_id, finalized_yn, gl_interfaced_yn, trn_type, sale_to_ext_yn, ext_agency_name,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id, condemn_remarks, condemn_id)VALUES(?, ?,	?, to_date(?,'dd/mm/yyyy'),	?, ?, ?, ?,	?, ?, ?, ?,	?, SYSDATE,	?, ?, ?, SYSDATE, ?, ?,?,?)");
		dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV",	"SELECT DISTINCT a.item_code, a.expiry_yn, b.alpha_code,                 b.item_class_code, b.short_desc item_desc, (SELECT short_desc FROM mm_item_class_lang_vw WHERE b.item_class_code =  item_class_code AND b.language_id = language_id) item_class_desc,  a.mfg_base_qty, a.machine_code, a.min_stk_qty, a.max_stk_qty, b.long_desc, b.ps_item_yn, b.sole_source_yn, b.manufacturer_id, b.gen_uom_code, b.unit_cost,                 DECODE (?,'%', (SELECT short_desc FROM am_uom_lang_vw WHERE b.gen_uom_code = uom_code AND b.language_id = language_id), i.short_desc) uom_desc, (SELECT short_name FROM am_manufacturer_lang_vw WHERE b.manufacturer_id = manufacturer_id AND b.language_id = language_id) manufacture_desc, a.spare_part_id, a.mfg_item_yn, a.medical_item_yn, a.abc_class_code, a.trade_id_applicable_yn, a.batch_id_applicable_yn, a.consignment_item_yn, (SELECT short_desc FROM am_uom_lang_vw WHERE b.gen_uom_code = uom_code AND b.language_id = language_id) gen_uom_desc FROM ST_ITEM a, mm_item_lang_vw b, mm_trade_name_for_item f, am_trade_name_lang_vw g, ST_ITEM_STORE h, am_uom_lang_vw i WHERE a.item_code = b.item_code AND b.eff_status = 'E' AND NVL (h.eff_status, 'E') = 'E' AND a.item_code = f.item_code(+) AND f.trade_id = g.trade_id(+) AND a.item_code = h.item_code(+) AND UPPER (a.item_code) LIKE UPPER (NVL (?, '%')) AND UPPER (b.short_desc) LIKE UPPER (NVL (?, '%')) AND UPPER (b.alpha_code) LIKE UPPER (NVL (?, '%')) AND UPPER (NVL (a.machine_code, '%')) LIKE UPPER (NVL (?, '%')) AND UPPER (NVL (a.spare_part_id, '%')) LIKE UPPER (NVL (?, '%')) AND UPPER (NVL (f.trade_id, '%')) LIKE UPPER (NVL (?, '%')) AND UPPER (NVL (g.short_name, '%')) LIKE UPPER (NVL (?, '%')) AND NVL (a.abc_class_code, '%') LIKE  DECODE (?,'', '%',?) AND a.medical_item_yn LIKE DECODE (?, 'A', '%', ?) AND b.ps_item_yn LIKE DECODE (?, 'A', '%', ?) AND b.sole_source_yn LIKE DECODE (?, 'A', '%', ?) AND NVL (b.manufacturer_id, '%') LIKE DECODE (?,'', '%',? ) AND a.mfg_item_yn LIKE DECODE (?, 'A', '%', ?) AND NVL (b.item_class_code, '%') LIKE  DECODE (?, '', '%',?) AND NVL (b.item_anal1_code, '%') LIKE  DECODE (?,'', '%',?) AND NVL (b.item_anal2_code, '%') LIKE  DECODE (?,'', '%',?) AND NVL (b.item_anal3_code, '%') LIKE  DECODE (?,'', '%',?) AND a.expiry_yn LIKE DECODE (?, 'A', '%', ?) AND NVL (h.store_code, '%') LIKE UPPER (NVL (?, '%')) AND a.consignment_item_yn LIKE DECODE (?, 'A', '%', ?) AND (material_group_code IN ( SELECT material_group_code FROM mm_user_material_group WHERE user_id = ? AND eff_status = 'E')) AND b.language_id = ? AND h.def_issue_uom = i.uom_code(+) AND NVL (direct_sale_allowed_yn, 'N') = DECODE (?, 'X', 'Y', NVL (direct_sale_allowed_yn, 'N')) AND g.language_id(+) = ? AND i.language_id(+) = ?");

//		Added on  6/1/2005 for Item combination check and qty_on_hand >0
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_ITM_CMB_CHK",	"SELECT	 distinct  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost,d.short_desc uom_desc,e.short_name manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code ,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn FROM st_item a,mm_item	b,mm_item_class	c,am_uom d ,am_manufacturer	e,mm_trade_name_for_item f,am_trade_name g,st_item_store h,st_item_store I	WHERE a.item_code=b.item_code AND b.eff_status='E'  AND nvl(h.eff_status,'E') = 'E' AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+) AND b.manufacturer_id=e.manufacturer_id(+) AND a.item_code=f.item_code(+) AND f.trade_id=g.trade_id(+)  AND a.item_code=h.item_code(+)	AND a.item_code=I.item_code(+)	And h.qty_on_hand > 0 	AND UPPER(a.item_code) LIKE	UPPER(nvl(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(nvl(?,'%')) AND UPPER(b.alpha_code) LIKE UPPER(nvl(?,'%'))	AND	UPPER(NVL(a.machine_code,'%')) LIKE	UPPER(nvl(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%')) LIKE	UPPER(nvl(?,'%')) AND  UPPER(nvl(f.trade_id,'%'))  LIKE	UPPER(nvl(?,'%'))  AND	UPPER(NVL(g.short_name,'%')) LIKE UPPER(nvl(?,'%'))	AND NVL(a.abc_class_code,'%') LIKE	DECODE(?,'','%',?) AND a.medical_item_yn like DECODE(?,'A','%',?) AND b.ps_item_yn like	DECODE(?,'A','%',?)	AND	b.sole_source_yn like DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE DECODE(?,'','%',?)	 AND a.mfg_item_yn like	DECODE(?,'A','%',?)	AND	NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	a.expiry_yn	LIKE DECODE(?,'A','%',?) AND nvl(h.store_code,'%') LIKE	  UPPER(nvl(?,'%'))     AND nvl(I.store_code,'%') LIKE  UPPER(nvl(?,'%'))	 	AND a.consignment_item_yn like	DECODE(?,'A','%',?)	AND (material_group_code IN (SELECT material_group_code FROM mm_user_material_group WHERE user_id= ?) )");
		dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_ITM_CMB_CHK",	"SELECT	 distinct  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost,DECODE (?,NULL, d.short_desc,j.short_desc) uom_desc,e.short_name manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code ,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn, d.short_desc gen_uom_desc,h.DEF_REQUEST_UOM FROM st_item a,mm_item_lang_vw b,mm_item_class_lang_vw c,am_uom_lang_vw d,am_manufacturer_lang_vw e,mm_trade_name_for_item f,am_trade_name_lang_vw g,st_item_store h,st_item_store i,am_uom_lang_vw j	WHERE a.item_code=b.item_code AND b.eff_status='E'  AND nvl(h.eff_status,'E') = 'E' AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+) AND b.manufacturer_id=e.manufacturer_id(+) AND a.item_code=f.item_code(+) AND f.trade_id=g.trade_id(+)  AND a.item_code=h.item_code(+)	AND a.item_code=I.item_code(+)	/*And h.qty_on_hand > 0 */	AND UPPER(a.item_code) LIKE	UPPER(nvl(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(nvl(?,'%')) AND UPPER(b.alpha_code) LIKE UPPER(nvl(?,'%'))	AND	UPPER(NVL(a.machine_code,'%')) LIKE	UPPER(nvl(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%')) LIKE	UPPER(nvl(?,'%')) AND  UPPER(nvl(f.trade_id,'%'))  LIKE	UPPER(nvl(?,'%'))  AND	UPPER(NVL(g.short_name,'%')) LIKE UPPER(nvl(?,'%'))	AND NVL(a.abc_class_code,'%') LIKE	DECODE(?,'','%',?) AND a.medical_item_yn like DECODE(?,'A','%',?) AND b.ps_item_yn like	DECODE(?,'A','%',?)	AND	b.sole_source_yn like DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE DECODE(?,'','%',?)	 AND a.mfg_item_yn like	DECODE(?,'A','%',?)	AND	NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	a.expiry_yn	LIKE DECODE(?,'A','%',?) AND nvl(h.store_code,'%') LIKE	  UPPER(nvl(?,'%'))     AND nvl(I.store_code,'%') LIKE  UPPER(nvl(?,'%'))	 	AND a.consignment_item_yn like	DECODE(?,'A','%',?)	AND (material_group_code IN (SELECT material_group_code FROM mm_user_material_group WHERE user_id= ?) ) AND b.language_id = ? AND b.language_id = c.language_id(+) AND b.language_id = d.language_id(+) AND b.language_id = e.language_id(+)  AND h.def_issue_uom = j.uom_code(+) AND g.language_id(+) = ?  AND j.language_id(+) = ?");
//     Added on 9/30/2005 for Assembly Dtl function 
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_FOR_ASSM_DTL",	"SELECT	 distinct  a.item_code,a.expiry_yn,b.alpha_code,b.item_class_code,b.short_desc item_desc,c.short_desc item_class_desc,a.mfg_base_qty,a.machine_code,a.min_stk_qty,a.max_stk_qty,b.long_desc,b.ps_item_yn,b.sole_source_yn,b.manufacturer_id,b.gen_uom_code,b.unit_cost,d.short_desc	 uom_desc ,e.short_name	 manufacture_desc,a.spare_part_id,a.mfg_item_yn,a.medical_item_yn,a.abc_class_code ,a.trade_id_applicable_yn ,a.batch_id_applicable_yn,a.consignment_item_yn FROM st_item a,mm_item	b,mm_item_class	c,am_uom d ,am_manufacturer	e,mm_trade_name_for_item f,am_trade_name g,st_item_store h WHERE a.item_code=b.item_code AND b.eff_status='E'  AND nvl(h.eff_status,'E') = 'E' AND  b.ITEM_CLASS_CODE=c.ITEM_CLASS_CODE(+) AND b.gen_uom_code=d.uom_code(+) AND	b.manufacturer_id=e.manufacturer_id(+) AND a.item_code=f.item_code(+) AND	   f.trade_id=g.trade_id(+)	 AND a.item_code=h.item_code(+)	AND	UPPER(a.item_code) LIKE	UPPER(nvl(?,'%')) AND UPPER(b.short_desc) LIKE UPPER(nvl(?,'%')) AND UPPER(b.alpha_code) LIKE UPPER(nvl(?,'%'))	AND	UPPER(NVL(a.machine_code,'%')) LIKE	UPPER(nvl(?,'%'))  AND UPPER(NVL(a.spare_part_id,'%')) LIKE	UPPER(nvl(?,'%')) AND  UPPER(nvl(f.trade_id,'%'))  LIKE	UPPER(nvl(?,'%'))  AND	UPPER(NVL(g.short_name,'%')) LIKE UPPER(nvl(?,'%'))	 AND NVL(a.abc_class_code,'%') LIKE	DECODE(?,'','%',?) AND a.medical_item_yn like DECODE(?,'A','%',?) AND b.ps_item_yn like	DECODE(?,'A','%',?)	AND	b.sole_source_yn like DECODE(?,'A','%',?) AND NVL(b.manufacturer_id,'%')LIKE DECODE(?,'','%',?)	 AND a.mfg_item_yn like	DECODE(?,'A','%',?)	AND	NVL(b.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(b.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(b.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	a.expiry_yn	LIKE DECODE(?,'A','%',?) AND nvl(h.store_code,'%') LIKE	  UPPER(nvl(?,'%'))	 AND a.consignment_item_yn like	DECODE(?,'A','%',?)	AND (material_group_code IN (SELECT material_group_code FROM mm_user_material_group WHERE user_id= ?) ) and a.item_code not in (select item_code from ST_ASSEMBLY_HDR)");
//		Modified on 12/27/2005 for Manufacturing Request 
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_FOR_MFG_REQ",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE ,I.PREPARATION_TYPE, I.PREPARATION_MODE FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H, ST_ASSEMBLY_HDR I,ST_ACC_ENTITY_PARAM J WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND H.ITEM_CODE = I.ITEM_CODE AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)  AND  (MATERIAL_GROUP_CODE IN (SELECT MATERIAL_GROUP_CODE FROM MM_USER_MATERIAL_GROUP WHERE USER_ID= ?) ) AND	UPPER(I.PREPARATION_TYPE ) LIKE UPPER(NVL(?,'%')) AND UPPER(I.PREPARATION_MODE) LIKE UPPER(NVL(?,'%')) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+) AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+) AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		//Modified by sakti against AMS-CRF-0028
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_FOR_MFG_REQ",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE ,I.PREPARATION_TYPE, I.PREPARATION_MODE,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H, ST_ASSEMBLY_HDR I,ST_ACC_ENTITY_PARAM J WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND H.ITEM_CODE = I.ITEM_CODE AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)  AND  (MATERIAL_GROUP_CODE IN (SELECT MATERIAL_GROUP_CODE FROM MM_USER_MATERIAL_GROUP WHERE USER_ID= ?) ) AND	UPPER(I.PREPARATION_TYPE ) LIKE UPPER(NVL(?,'%')) AND UPPER(I.PREPARATION_MODE) LIKE UPPER(NVL(?,'%')) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+) AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+) AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		//Added by Rabbani#AMS-CRF-0068(49822) on 11-AUG-2014
		dataMap.put("SQL_ITEM_SEARCH_QUERY_C_INV_FOR_MFG_REQ",	"SELECT	 DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,B.GEN_UOM_CODE,B.UNIT_COST,D.SHORT_DESC	 GEN_UOM_DESC ,E.SHORT_NAME	 MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE ,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,B.CURR_SUPP_CODE ,I.PREPARATION_TYPE, I.PREPARATION_MODE,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty, (NVL(H.MAX_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MAX_STR_QTY  ,(NVL(H.MIN_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MIN_STR_QTY ,(NVL (H.REORDER_LEVEL, 0) * ST_GET_UOM_CONV_FAC_SING_STR (h.item_code,h.store_code)) REORDER_LEVEL,K.SHORT_DESC UOM_DESC FROM ST_ITEM A,MM_ITEM_LANG_VW	B,MM_ITEM_CLASS_LANG_VW	C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW	E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H, ST_ASSEMBLY_HDR I,ST_ACC_ENTITY_PARAM J,AM_UOM_LANG_VW K WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'  AND NVL(H.EFF_STATUS,'E') = 'E' AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+) AND	B.MANUFACTURER_ID=E.MANUFACTURER_ID(+) AND A.ITEM_CODE=F.ITEM_CODE(+) AND	   F.TRADE_ID=G.TRADE_ID(+)	 AND A.ITEM_CODE=H.ITEM_CODE(+)	AND H.ITEM_CODE = I.ITEM_CODE AND H.DEF_ISSUE_UOM = K.UOM_CODE AND	UPPER(A.ITEM_CODE) LIKE	UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%')) AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))	AND	UPPER(NVL(A.MACHINE_CODE,'%')) LIKE	UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE	UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE	UPPER(NVL(?,'%'))  AND	UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))	 AND NVL(A.ABC_CLASS_CODE,'%') LIKE	DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)	 AND A.MFG_ITEM_YN LIKE	DECODE(?,'A','%',?)	AND	NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)	AND	NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?)	AND	A.EXPIRY_YN	LIKE DECODE(?,'A','%',?) AND NVL(H.STORE_CODE,'%') LIKE	  UPPER(NVL(?,'%'))	 AND A.CONSIGNMENT_ITEM_YN LIKE	DECODE(?,'A','%',?)  AND  (MATERIAL_GROUP_CODE IN (SELECT MATERIAL_GROUP_CODE FROM MM_USER_MATERIAL_GROUP WHERE USER_ID= ?) ) AND	UPPER(I.PREPARATION_TYPE ) LIKE UPPER(NVL(?,'%')) AND UPPER(I.PREPARATION_MODE) LIKE UPPER(NVL(?,'%')) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+) AND B.LANGUAGE_ID = D.LANGUAGE_ID(+) AND B.LANGUAGE_ID = K.LANGUAGE_ID  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+) AND G.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		//Opening Stock
		dataMap.put("SQL_ST_ITEM_TRN_DTL_COUNT_FOR_ITEM", "SELECT COUNT(*) total FROM st_item_trn_dtl WHERE	item_code =	?");
		dataMap.put("SQL_ST_OBS_STORE_SELECT", "SELECT   st.store_code, mm.short_desc FROM mm_store_lang_vw mm, st_user_access_for_store st, st_store ststr WHERE mm.store_code = st.store_code AND st.store_code = ststr.store_code AND mm.eff_status = 'E' AND ( nvl(st.obs_allowed_yn,'N') = 'Y' AND nvl(ststr.obs_allowed_yn,'N') = 'Y' ) AND mm.facility_id = ? AND st.user_id = ? AND mm.language_id =? order BY 2");

		dataMap.put("SQL_ST_ADJ_STORE_SELECT", "SELECT   st.store_code, mm.short_desc FROM mm_store_lang_vw mm, st_user_access_for_store st, st_store ststr, st_acc_entity_param stpa WHERE mm.store_code = st.store_code AND mm.store_code = ststr.store_code AND mm.eff_status = 'E' AND NVL(st.adj_allowed_yn,'N') = 'Y' AND NVL(ststr.ADJ_ALLOWED_YN,'N') = 'Y' AND mm.facility_id =? AND st.user_id = ? AND mm.language_id = ? ORDER BY 2");

		dataMap.put("SQL_QRY_ST_ADJ_STORE_SELECT", "SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st WHERE	mm.store_code=st.store_code	AND	mm.eff_status='E' AND (st.adj_allowed_yn='Y' OR st.adj_finalize_allowed_yn ='Y') AND	mm.facility_id=? AND st.user_id=? AND mm.language_id = ? ORDER	BY 2");
		dataMap.put("SQL_ST_OPENING_STOCK_STORE", "SELECT mm.short_desc FROM mm_store_lang_vw mm, st_Store st WHERE mm.store_code=st.store_code AND st.store_code= ? AND language_id = ?");
		dataMap.put("SQL_SY_DOC_TYPE_MASTER_SELECT_DESC", "SELECT short_desc FROM sy_doc_type_master_lang_vw sy_doc_type_master WHERE doc_type_code=? AND language_id = ?");
		dataMap.put("SQL_ST_OPENING_STOCK_HEADER_SELECT_SINGLE", "select doc_type_code,doc_no,doc_date,doc_ref,store_code from st_adj_hdr where	doc_type_code=?	and	doc_no=?");
		dataMap.put("SQL_ST_ITEM_DETAILS", "select 'Y' expiry_yn, 'Y' batch_id_applicable_yn, 'Y' trade_id_applicable_yn , 'NOT_APPL' default_batch_id from	dual where 'whateverupass'<>?");
		dataMap.put("SQL_ST_TRADE_DETAILS",	"select	mm.trade_id, am.short_name from	mm_trade_name_for_item mm, am_trade_name_lang_vw am	where mm.trade_id=am.trade_id and mm.item_code=?  AND am.language_id = ? order by am.short_name");
		//commented by Rabbani #Inc no:29954(Bru-HIMS-CRF-088) on 04-MAR-2013 Starts
		//dataMap.put("SQL_ST_ADJ_HDR_INSERT",		"INSERT	INTO st_adj_hdr(facility_id, doc_type_code,	doc_no,	doc_date,doc_ref, store_code, authorized_by_id, finalized_yn,gl_interfaced_yn, trn_type, sale_to_ext_yn, ext_agency_name,item_class_code, added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id)VALUES(?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		
		//Added by Rabbani #Inc no:29954(Bru-HIMS-CRF-088) on 04-MAR-2013 Starts
		dataMap.put("SQL_ST_ADJ_HDR_INSERT",		"INSERT	INTO st_adj_hdr(facility_id, doc_type_code,	doc_no,	doc_date,doc_ref, store_code, authorized_by_id, finalized_yn,gl_interfaced_yn, trn_type, sale_to_ext_yn, ext_agency_name,item_class_code, added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id,Disposable_yn)VALUES(?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		
		dataMap.put("SQL_ST_ADJ_DTL_INSERT",		"INSERT	INTO st_adj_dtl( facility_id,  doc_type_code,  doc_no,	doc_srl_no,	 item_code,	 adj_item_qty,	item_unit_cost,	 item_cost_value,  remarks,	 added_by_id,  added_date,	added_at_ws_no,	 added_facility_id,	 modified_by_id,  modified_date,  modified_at_ws_no,  modified_facility_id)	VALUES ( ?, ?, ?, ?,	?, ?, ?, ?,	?, ?, SYSDATE,	?, ?, ?, SYSDATE, ?, ?)");
//		dataMap.put("SQL_ST_ADJ_DTL_UPDATE",		"UPDATE	st_adj_dtl SET adj_item_qty	= ?,  item_unit_cost = ?,  item_cost_value = ?,	 remarks = ?,  modified_by_id =	?,	modified_date =	to_date(SYSDATE,'dd/mm/yyyy'),	modified_at_ws_no =	?,	modified_facility_id = ? WHERE facility_id = ? AND doc_type_code = ? AND doc_no	= ?	AND	doc_srl_no = ? AND item_code = ?");  // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_ADJ_DTL_UPDATE",		"UPDATE	st_adj_dtl SET adj_item_qty	= ?,  item_unit_cost = ?,  item_cost_value = ?,	 remarks = ?,  modified_by_id =	?,	modified_date =SYSDATE, modified_at_ws_no =	?,	modified_facility_id = ? WHERE facility_id = ? AND doc_type_code = ? AND doc_no	= ?	AND	doc_srl_no = ? AND item_code = ?");
		//added barcode_id
		//dataMap.put("SQL_ST_ADJ_DTL_EXP_INSERT",	"INSERT	INTO st_adj_dtl_exp(facility_id, doc_type_code,	doc_no,	doc_srl_no,	store_code,	item_code, batch_id, bin_location_code,	expiry_date_or_receipt_date, trade_id, item_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id) VALUES	(?,	?, ?, ?, ?,	?, ?, ?, to_date(?,'dd/mm/yyyy'), ?, ?,	?, SYSDATE,? , ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_ST_ADJ_DTL_EXP_INSERT",	"INSERT	INTO st_adj_dtl_exp(facility_id, doc_type_code,	doc_no,	doc_srl_no,	store_code,	item_code, batch_id, bin_location_code,	expiry_date_or_receipt_date, trade_id, item_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id,barcode_id) VALUES	(?,	?, ?, ?, ?,	?, ?, ?, to_date(?,'dd/mm/yyyy'), ?, ?,	?, SYSDATE,? , ?, ?, SYSDATE, ?, ?, ?)");

		dataMap.put("SQL_SY_ACC_ENTITY_DOC_TYPE_SELECT", "SELECT next_doc_no, doc_print_flag FROM sy_acc_entity_doc_type WHERE doc_type_code = ?");
		dataMap.put("SQL_SY_ACC_ENTITY_DOC_TYPE_UPDATE", "UPDATE sy_acc_entity_doc_type	SET	next_doc_no=next_doc_no+1, modified_by_id =?, modified_date	=sysdate, modified_at_ws_no	=?,	modified_facility_id =?	WHERE doc_type_code=?");
		dataMap.put("SQL_ST_DEFAULT_BATCH_ID", "SELECT dflt_batch_id, dflt_batch_id FROM	mm_parameter");
		dataMap.put("SQL_ST_DEFAULT_TRADE_ID", "SELECT dflt_trade_id, dflt_trade_id FROM mm_parameter");
		dataMap.put("SQL_ST_ITEM_TRN_DTL_INSERT",	"INSERT	into st_item_trn_dtl(facility_id, store_code, item_code, posted_date, trn_srl_no,					trn_type,doc_type_code,doc_no,doc_srl_no,doc_date,doc_ref,						batch_id,expiry_date,item_qty_normal,item_unit_cost,stk_uom_code,				stock_item_yn,added_by_id,added_date,added_at_ws_no,							added_facility_id,modified_by_id,modified_date,modified_at_ws_no,				modified_facility_id, bin_location_code, trade_id) VALUES													(?,?,?,SYSDATE,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_ST_GET_ITEM_STORE_STOCK_POS", "SELECT nvl(qty_on_hand,0) qty_on_hand, nvl(item_value,0) item_value, stock_item_yn FROM st_item_store WHERE item_code=? AND store_code=?");
//		dataMap.put("SQL_ST_ITEM_STORE_QTY_UPDATE","UPDATE st_item_store SET bin_location_code = decode (?,NULL,bin_location_code,?) , last_receipt_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_receipt_date,TO_DATE(?,'dd/mm/yyyy')) , last_issue_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_issue_date,TO_DATE(?,'dd/mm/yyyy')), pending_req_qty = decode(?,0,pending_req_qty,(pending_req_qty-?)), qty_on_hand = ? , item_value = round(?,3)  ,modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id = ?  WHERE item_code = ? AND store_code = ?");
		//dataMap.put("SQL_ST_ITEM_STORE_QTY_UPDATE","UPDATE st_item_store SET bin_location_code = decode (?,NULL,bin_location_code,?) , last_receipt_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_receipt_date,TO_DATE(?,'dd/mm/yyyy')) , last_issue_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_issue_date,TO_DATE(?,'dd/mm/yyyy')), pending_req_qty = decode(sign(pending_req_qty-?),-1,0,(pending_req_qty-?)), qty_on_hand = ? , item_value = round(?,3)  ,modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id = ?  WHERE item_code = ? AND store_code = ?");  
		dataMap.put("SQL_ST_ITEM_STORE_QTY_UPDATE","UPDATE st_item_store SET bin_location_code = decode (?,NULL,bin_location_code,?) , last_receipt_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_receipt_date,TO_DATE(?,'dd/mm/yyyy')) , last_issue_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_issue_date,TO_DATE(?,'dd/mm/yyyy')), pending_req_qty = decode(sign(pending_req_qty-?),-1,0 ,  (pending_req_qty-?)),  qty_on_hand = ? ,  item_value = st_get_cost_decimals(?,'N'), modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id = ?  WHERE item_code = ? AND store_code = ?");
		
		dataMap.put("SQL_ST_ITEM_STORE_QTY_UPDATE_FOR_ISSUING_STORE", "UPDATE st_item_store	SET	last_issue_date	= decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_issue_date,TO_DATE(?,'dd/mm/yyyy'))	, pending_req_qty =	decode (?,NULL,pending_req_qty,(pending_req_qty	- ?)), qty_on_hand = ? , item_value	= round(?,3),  modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	? WHERE	store_code = ?	AND	item_code =	?");
//		dataMap.put("SQL_ST_ITEM_MASTER_UPDATE", "Update mm_item SET unit_cost = round(?,6), last_trn_type=?, modified_by_id = ?, modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id=?	WHERE item_code	= ?");
//		Modified  SQL_ST_ITEM_MASTER_UPDATE on 4/16/2005 for last_cost,next_lost_codt updation
		dataMap.put("SQL_ST_ITEM_MASTER_UPDATE", "Update mm_item SET  NEXT_LAST_COST = LAST_COST ,NEXT_LAST_COST_DATE=LAST_COST_DATE, LAST_COST= UNIT_COST,LAST_COST_DATE=CURRENT_COST_DATE,unit_cost = round(?,6),CURRENT_COST_DATE =sysdate, last_trn_type=?, modified_by_id = ?, modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id=? WHERE item_code = ?");
		dataMap.put("SQL_ST_ITEM_MOVE_SUMM_INSERT",	"INSERT into st_item_move_summ (facility_id, item_code, store_code, move_year, move_month,month_opening_qty, month_opening_value, month_closing_qty, month_closing_value,obs_qty, obs_cost, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_ITEM_MOVE_SUMM_INSERT_FOR_ADJ",	"INSERT into st_item_move_summ (facility_id, item_code, store_code, move_year, move_month,  month_closing_qty, month_closing_value, adj_qty, adj_cost, pos_adj_qty, pos_adj_cost, neg_adj_qty, neg_adj_cost, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		//dataMap.put("SQL_ST_CHECK_BATCH_EXISTS", "SELECT count (*) count FROM st_batch_control WHERE item_code=? AND batch_id =? AND expiry_date_or_receipt_date =to_date(?,'dd/mm/yyyy')");
		// added trunc for exp date to avoid exp date with time by ganga on Tuesday, April 02, 2013
		dataMap.put("SQL_ST_CHECK_BATCH_EXISTS", "SELECT count (*) count FROM st_batch_control WHERE item_code=? AND batch_id =? AND trunc(expiry_date_or_receipt_date) =to_date(?,'dd/mm/yyyy')");
		
		//dataMap.put("SQL_ST_BATCH_CONTROL_INSERT", "INSERT into	st_batch_control (item_code,	batch_id, expiry_date_or_receipt_date, trade_id, batch_status, discount_perc, added_by_id, added_date, added_at_ws_no,added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id,sale_price) VALUES(?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,sysdate,?,?,?,sysdate,?,?,? )");
		//dataMap.put("SQL_ST_BATCH_CONTROL_INSERT", "INSERT into	st_batch_control (item_code,	batch_id, expiry_date_or_receipt_date, trade_id, batch_status, discount_perc, added_by_id, added_date, added_at_ws_no,added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id,sale_price,barcode_id,supp_code) VALUES(?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?)");
		//added by Ganga Monday, November 26, 2012 IN035661	PMG2012-CRF-0012
		//dataMap.put("SQL_ST_BATCH_CONTROL_INSERT", "INSERT into	st_batch_control (item_code,	batch_id, expiry_date_or_receipt_date, trade_id, batch_status, discount_perc, added_by_id, added_date, added_at_ws_no,added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id,sale_price,barcode_id,supp_code,pur_uom_code,pur_uom_conv) VALUES(?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?,?)");//Commented by suresh.r on 03-01-2014 against KDAH for update batch_cost into st_batch_control
		dataMap.put("SQL_ST_BATCH_CONTROL_INSERT", "INSERT into	st_batch_control (item_code,	batch_id, expiry_date_or_receipt_date, trade_id, batch_status, discount_perc, added_by_id, added_date, added_at_ws_no,added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id,sale_price,barcode_id,supp_code,pur_uom_code,pur_uom_conv,batch_cost) VALUES(?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?,?,?)");//Added by suresh.r on 03-01-2014 against KDAH for update batch_cost into st_batch_control

		dataMap.put("SQL_ST_CHECK_ITEM_BATCH_EXISTS", "SELECT count	(*)	count FROM st_item_batch WHERE store_code=?	AND	item_code=?	AND	batch_id =?	AND	bin_location_code=?	AND	trunc(expiry_date_or_receipt_date) =to_date(?,'dd/mm/yyyy')");
		
		//dataMap.put("SQL_ST_ITEM_BATCH_INSERT","INSERT into st_item_batch (store_code, item_code, batch_id,	bin_location_code, expiry_date_or_receipt_date,trade_id, qty_on_hand, replace_on_expiry_yn, GRN_DOC_TYPE_CODE, GRN_DOC_NO, GRN_DOC_SRL_NO, GRN_UNIT_COST_IN_STK_UOM,LAST_ISSUE_DATE, LAST_RECEIPT_DATE, PO_NO, added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),to_date(?,'dd/mm/yyyy'),?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		//dataMap.put("SQL_ST_ITEM_BATCH_INSERT","INSERT into st_item_batch (store_code, item_code, batch_id,	bin_location_code, expiry_date_or_receipt_date,trade_id, qty_on_hand, replace_on_expiry_yn, GRN_DOC_TYPE_CODE, GRN_DOC_NO, GRN_DOC_SRL_NO, GRN_UNIT_COST_IN_STK_UOM,LAST_ISSUE_DATE, LAST_RECEIPT_DATE, PO_NO, added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,barcode_id) VALUES (?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),to_date(?,'dd/mm/yyyy'),?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		//added by Ganga Monday, November 26, 2012 IN035661	PMG2012-CRF-0012
		dataMap.put("SQL_ST_ITEM_BATCH_INSERT","INSERT into st_item_batch (store_code, item_code, batch_id,	bin_location_code, expiry_date_or_receipt_date,trade_id, qty_on_hand, replace_on_expiry_yn, GRN_DOC_TYPE_CODE, GRN_DOC_NO, GRN_DOC_SRL_NO, GRN_UNIT_COST_IN_STK_UOM,LAST_ISSUE_DATE, LAST_RECEIPT_DATE, PO_NO, added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,barcode_id,pur_uom_code,pur_uom_conv) VALUES (?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),to_date(?,'dd/mm/yyyy'),?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?)");
		
		
		dataMap.put("SQL_ST_GET_ITEM_BATCH_STOCK_POS","SELECT qty_on_hand,COMMITTED_QTY,suspended_yn,phy_inv_id FROM st_item_batch WHERE store_code=?	 AND  item_code=?  AND	batch_id =?	 AND  bin_location_code=? AND  expiry_date_or_receipt_date =to_date(?,'dd/mm/yyyy')");// added for AMS-SCF-0648 AND GHL-SCF-1158.1
		//commented by ganga to add barcode_id
		//dataMap.put("SQL_ST_ITEM_BATCH_UPDATE","UPDATE st_item_batch SET qty_on_hand = ? , committed_qty = committed_qty + nvl(?,0) , last_receipt_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_receipt_date,TO_DATE(?,'dd/mm/yyyy')), last_issue_date	= decode (TO_DATE(?,'dd/mm/yyyy'), NULL, last_issue_date, TO_DATE(?,'dd/mm/yyyy')), GRN_DOC_TYPE_CODE = ?, GRN_DOC_NO = ?, GRN_DOC_SRL_NO = ?, GRN_UNIT_COST_IN_STK_UOM = ?, modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	?  WHERE store_code	= ?	 AND item_code = ?	AND	batch_id = ?  AND bin_location_code	= ?	 AND trunc(expiry_date_or_receipt_date)	= TO_DATE(?,'dd/mm/yyyy')");
		dataMap.put("SQL_ST_ITEM_BATCH_UPDATE","UPDATE st_item_batch SET qty_on_hand = ? , committed_qty = committed_qty + nvl(?,0) , last_receipt_date = decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_receipt_date,TO_DATE(?,'dd/mm/yyyy')), last_issue_date	= decode (TO_DATE(?,'dd/mm/yyyy'), NULL, last_issue_date, TO_DATE(?,'dd/mm/yyyy')), GRN_DOC_TYPE_CODE = nvl(?,GRN_DOC_TYPE_CODE), GRN_DOC_NO = nvl(?,GRN_DOC_NO), GRN_DOC_SRL_NO = nvl(?,GRN_DOC_SRL_NO), GRN_UNIT_COST_IN_STK_UOM = nvl(?,GRN_UNIT_COST_IN_STK_UOM), modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	?, barcode_id = NVL(?,barcode_id) ,pur_uom_code = NVL(?,pur_uom_code) ,pur_uom_conv = NVL(?,pur_uom_conv)  WHERE store_code	= ?	 AND item_code = ?	AND	batch_id = ?  AND bin_location_code	= ?	 AND trunc(expiry_date_or_receipt_date)	= TO_DATE(?,'dd/mm/yyyy')");
		
		dataMap.put("SQL_ST_ITEM_BATCH_UPDATE_FOR_ISSUEING_STORE","UPDATE st_item_batch	SET	qty_on_hand	= ?	, committed_qty	= decode (?,NULL,committed_qty,(committed_qty-?)) ,	last_issue_date	= decode (TO_DATE(?,'dd/mm/yyyy'),NULL,last_issue_date,TO_DATE(?,'dd/mm/yyyy'))	, modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id =	?  WHERE store_code	= ?	 AND item_code = ?	AND	batch_id = ?  AND bin_location_code	= ?	 AND trunc(expiry_date_or_receipt_date)	= TO_DATE(?,'dd/mm/yyyy')");
		dataMap.put("SQL_ST_STOCK_UOM_CODE_SELECT","SELECT gen_uom_code	code FROM mm_item WHERE	item_code=?");
		dataMap.put("SQL_ST_ITEM_ALREADY_EXISTS","SELECT count(*) count	FROM st_item_trn_dtl WHERE item_code=? AND store_code=?	AND	facility_id=?");

		//Adjust Stock
		dataMap.put("SQL_ST_ADJ_DTL_SELECT"," SELECT item_unit_cost	from st_adj_dtl	WHERE facility_id=?	and	doc_type_code=?	AND	doc_no=? AND doc_srl_no=? AND item_code=?");
		dataMap.put("SQL_ST_ITEM_LAST_COST_SELECT_FOR_ADJ" , " SELECT  LAST_COST from mm_item  WHERE  item_code=? ");
		
		//dataMap.put("SQL_ST_ITEM_VALUE_SELECT1","select sum(QTY_ON_HAND) qty_on_hand, sum(item_value) item_value FROM st_item_store WHERE item_code = ? group by item_code");
		dataMap.put("SQL_ST_ITEM_VALUE_SELECT1","SELECT SUM (  ST.QTY_ON_HAND * ST_GET_UOM_CONV_FAC_SING_STR (ST.ITEM_CODE,ST.STORE_CODE) ) QTY_ON_HAND, SUM (ST.ITEM_VALUE) ITEM_VALUE FROM ST_ITEM_STORE ST WHERE ST.ITEM_CODE = ?");

        //dataMap.put("SQL_ST_ITEM_VALUE_SELECT","SELECT SUM(st.QTY_ON_HAND * NVL((SELECT eqvl_value FROM MM_ITEM_UOM_DEFN mid WHERE st.def_issue_uom = mid.eqvl_uom_code AND  mm.gen_uom_code = mid.uom_code AND mid.item_code = st.item_code UNION SELECT eqvl_value FROM am_uom_eqvl WHERE st.def_issue_uom = eqvl_uom_code AND  mm.gen_uom_code = uom_code),1))qty_on_hand , SUM(st.item_value) item_value  FROM st_item_store st, mm_item_lang_vw mm   WHERE st.item_code = ?   AND st.item_code = mm.item_code  AND mm.language_id = ?");
        dataMap.put("SQL_ST_ITEM_VALUE_SELECT","SELECT SUM (  ST.QTY_ON_HAND * ST_GET_UOM_CONV_FAC_SING_STR (ST.ITEM_CODE,ST.STORE_CODE) ) QTY_ON_HAND, SUM (ST.ITEM_VALUE) ITEM_VALUE FROM ST_ITEM_STORE ST WHERE ST.ITEM_CODE = ?");

		dataMap.put("SQL_ST_CHECK_SUMMARY_EXISTS","SELECT count(*) count FROM st_item_move_summ	WHERE facility_id =	? AND item_code=? AND store_code = ? AND move_month= ? AND move_year =?");
//		dataMap.put("SQL_ST_ITEM_MOVE_SUMM_UPDATE","UPDATE st_item_move_summ SET ADJ_QTY = ADJ_QTY+?, ADJ_COST = ADJ_COST+?, MONTH_CLOSING_QTY =	MONTH_CLOSING_QTY+?, MONTH_CLOSING_VALUE = MONTH_CLOSING_VALUE+?, POS_ADJ_QTY = POS_ADJ_QTY+?, POS_ADJ_COST = POS_ADJ_COST+?, NEG_ADJ_QTY = NEG_ADJ_QTY + ?, NEG_ADJ_COST = NEG_ADJ_COST + ? WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");  // Modified on 5/30/2006 for updating modification details
		dataMap.put("SQL_ST_ITEM_MOVE_SUMM_UPDATE","UPDATE st_item_move_summ SET ADJ_QTY = ADJ_QTY+?, ADJ_COST = ADJ_COST+?, MONTH_CLOSING_QTY =	MONTH_CLOSING_QTY+?, MONTH_CLOSING_VALUE = MONTH_CLOSING_VALUE+?, POS_ADJ_QTY = POS_ADJ_QTY+?, POS_ADJ_COST = POS_ADJ_COST+?, NEG_ADJ_QTY = NEG_ADJ_QTY + ?, NEG_ADJ_COST = NEG_ADJ_COST + ? , modified_by_id = (?), modified_date	= SYSDATE, modified_at_ws_no =(?),	modified_facility_id = (?)  WHERE FACILITY_ID =	? AND ITEM_CODE	= ?	AND	STORE_CODE = ? AND MOVE_MONTH= ? AND MOVE_YEAR =?");
		dataMap.put("SQL_ST_ADJ_HEADER_SELECT","SELECT count(*)	count FROM st_adj_hdr WHERE	facility_id	= ?	AND	doc_type_code =	? AND doc_no = ? ");
//		dataMap.put("SQL_ST_ADJ_HEADER_UPDATE","UPDATE st_adj_hdr SET doc_date = to_date(?,'dd/mm/yyyy'), doc_ref =?, trn_type = ?,	finalized_yn = ?, modified_by_id = ?, modified_date	= to_date(SYSDATE,'dd/mm/yyyy'), modified_at_ws_no = ?,	modified_facility_id = ? WHERE facility_id = ? AND doc_type_code = ? AND doc_no	= ?	"); // Modified on 5/29/2006 for updating modification details
		dataMap.put("SQL_ST_ADJ_HEADER_UPDATE","UPDATE st_adj_hdr SET doc_date = to_date(?,'dd/mm/yyyy'), doc_ref =?, trn_type = ?,	finalized_yn = ?, modified_by_id = ?, modified_date	= SYSDATE, modified_at_ws_no = ?,	modified_facility_id = ? WHERE facility_id = ? AND doc_type_code = ? AND doc_no	= ?	");
		dataMap.put("SQL_ST_ADJ_DETAIL_DELETE","DELETE FROM	st_adj_dtl WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND	doc_srl_no = ?");
		dataMap.put("SQL_ST_ADJ_HEADER_DELETE","DELETE FROM	st_adj_hdr WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?");
		dataMap.put("SQL_ST_ADJ_DETAIL_EXP_DELETE","DELETE FROM	st_adj_dtl_exp WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? AND DOC_NO =	? AND DOC_SRL_NO = ? AND ITEM_CODE = ?");
		
		
		//dataMap.put("SQL_ST_GET_MONTH_AND_YEAR","select	substr(st_get_post_mth_yr(to_char(to_date(sysdate,'dd/mm/yyyy'))),1,2) mm, substr(st_get_post_mth_yr(to_char(to_date(sysdate,'dd/mm/yyyy'))),3,4) yyyy from	dual");
		dataMap.put("SQL_ST_GET_MONTH_AND_YEAR","SELECT SUBSTR (st_get_post_mth_yr (SYSDATE), 1, 2) mm, SUBSTR (st_get_post_mth_yr (SYSDATE), 3, 4) yyyy FROM DUAL");

		dataMap.put("SQL_ST_ITEM_BATCH_DELETE","DELETE FROM	st_item_batch WHERE	store_code=?  AND  item_code=?	AND	 batch_id =?  AND  bin_location_code=? AND	expiry_date_or_receipt_date	=to_date(?,'dd/mm/yyyy')");
		dataMap.put("SQL_ST_ADJUST_STOCK_ITEMS_SELECT","SELECT   st.doc_srl_no, st.item_code, st.adj_item_qty, st.item_unit_cost,st.item_cost_value, st.remarks, mm.short_desc item_desc, mm.gen_uom_code stock_uom_code, am_uom.short_desc uom, st_item.expiry_yn, st_item.batch_id_applicable_yn, st_item.trade_id_applicable_yn, stitm.min_stk_qty, stitm.max_stk_qty, stitm.qty_on_hand - SUM (NVL (committed_qty, 0)) available_qty FROM st_adj_dtl st, mm_item_lang_vw mm, st_item, am_uom_lang_vw am_uom, st_item_store stitm, st_adj_hdr sthdr, st_item_batch stbt WHERE st.item_code = mm.item_code AND st.item_code = st_item.item_code AND mm.gen_uom_code = am_uom.uom_code AND st.doc_no = sthdr.doc_no AND st.doc_type_code = sthdr.doc_type_code AND st.facility_id = sthdr.facility_id AND stitm.item_code = st.item_code AND stitm.store_code = sthdr.store_code AND st.facility_id =? AND st.doc_type_code = ? AND st.doc_no = ? AND stbt.item_code(+) = stitm.item_code AND stbt.store_code(+) = stitm.store_code AND mm.language_id = am_uom.language_id AND mm.language_id = ? GROUP BY st.doc_srl_no,  st.item_code,  st.adj_item_qty,  st.item_unit_cost,  st.item_cost_value,  st.remarks,  mm.short_desc,  mm.gen_uom_code,  am_uom.short_desc,  st_item.expiry_yn,  st_item.batch_id_applicable_yn,  st_item.trade_id_applicable_yn,  stitm.min_stk_qty,  stitm.max_stk_qty,  stitm.qty_on_hand ORDER BY doc_srl_no");
		dataMap.put("SQL_ST_ADJUST_STOCK_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.store_code, mm.short_desc store_desc, hdr.doc_ref, hdr.item_class_code FROM ST_ADJ_HDR hdr, sy_doc_type_master_lang_vw sy, mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE uacc WHERE hdr.doc_type_code = sy.doc_type_code AND hdr.store_code = mm.store_code AND hdr.finalized_yn = 'N' AND hdr.doc_type_code LIKE ? AND TO_CHAR (hdr.doc_no) LIKE ? AND hdr.store_code LIKE ? AND TO_DATE (TO_CHAR (hdr.doc_date, 'dd/mm/yyyy'), 'dd/mm/yyyy') BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy') AND hdr.trn_type = 'ADJ' AND uacc.store_code = mm.store_code AND uacc.user_id = ? AND adj_allowed_yn = 'Y' AND sy.language_id = mm.language_id AND sy.language_id = ? AND mm.facility_id = ? ");

		dataMap.put("SQL_ST_ADJUST_STOCK_BATCH_SELECT","SELECT trade_id, TO_CHAR (expiry_date_or_receipt_date,'dd/mm/yyyy')	expiry_date,batch_id,doc_srl_no, bin_location_code,item_qty	FROM st_adj_dtl_exp	WHERE doc_type_code	= ?	AND	to_char(doc_no)	= ?	AND	to_char(doc_srl_no)	= ?	AND	item_code =	?");
		dataMap.put("SQL_ST_STOCK_ITEM_YN_FLAG", "SELECT stock_item_yn FROM st_item_store WHERE item_code = ? AND store_code = ?");
		dataMap.put("SQL_ST_SELECT_BATCH_FOR_DELETE", "SELECT store_code, item_code, batch_id, bin_location_code, to_char(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, item_qty FROM st_adj_dtl_exp WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ? AND doc_srl_no = ?");
		dataMap.put("SQL_ST_STOCK_NEGATIVE_ADJUSTMENT_ALLOWED" , "select QTY_ON_HAND from st_item_batch where store_code= ? and ITEM_CODE = ? and BATCH_ID = ? and TRADE_ID = ? and to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') = ? and bin_location_code = ? ");
		dataMap.put("SQL_ST_ITEM_STORE_VALUE", "SELECT item_value FROM st_item_store WHERE item_code=? and store_code =? ");

		// added to defaulting the remarks in Adjustment on 02/07/2004
		//dataMap.put("SQL_ST_ADJUST_STOCK_DEFAULT_REMARKS_SELECT" , "SELECT def_adj_remarks remarks FROM st_facility_param WHERE  facility_id = ? AND material_group_code = ? ");

		// Modified on 5/15/2006 for bring the description
		dataMap.put("SQL_ST_ADJUST_STOCK_DEFAULT_REMARKS_SELECT" , "SELECT MMTR.TRN_REMARKS_CODE REMARKS_CODE,MMTR.REMARKS_DESC REMARKS FROM ST_FACILITY_PARAM STFP, MM_TRN_REMARKS_LANG_VW MMTR WHERE  FACILITY_ID = ? AND MATERIAL_GROUP_CODE = ? AND MMTR.TRN_REMARKS_CODE = STFP.DEF_ADJ_REMARKS AND MMTR.LANGUAGE_ID= ?");


		// Condemn Expired Batches
		//dataMap.put("SQL_ST_EXPIRED_BATCHES_SELECT","SELECT	item_code, item_desc, store_code, store_desc, batch_id,	bin_location_code, bin_desc, to_char(expiry_date,'dd/mm/yyyy') expiry_date,	expiry_date ex_date, trade_id, trade_name, qty_on_hand, replace_on_expiry_yn	FROM st_batch_search_view WHERE	expiry_yn =	'Y'	AND	qty_on_hand	> 0	AND	expiry_date	 BETWEEN TO_DATE(nvl(?,'01/01/1901'),'dd/mm/yyyy') AND TO_DATE(nvl(?,sysdate),'dd/mm/yyyy')	AND	store_code BETWEEN NVL(?,'!') AND NVL(?,'~') AND item_code BETWEEN NVL(?,'!') AND NVL(?,'~') AND batch_id LIKE DECODE(?,'','%',?) AND PHY_INV_ID is null order by ex_date");
		//Modified on 14/09/2004 
        dataMap.put("SQL_ST_EXPIRED_BATCHES_SELECT","SELECT	btvw.item_code, item_desc, btvw.store_code, store_desc, batch_id,	bin_location_code, bin_desc, TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date,	expiry_date ex_date, trade_id, trade_name, qty_on_hand, replace_on_expiry_yn	FROM st_batch_search_lang_view btvw, mm_store_lang_vw mmvw WHERE	expiry_yn =	'Y'	AND	qty_on_hand	> 0	AND	expiry_date	 BETWEEN TO_DATE(NVL(?,'01/01/1901'),'dd/mm/yyyy') AND TO_DATE(NVL(?,TO_CHAR(SYSDATE,'DD/MM/YYYY')),'dd/mm/yyyy')	AND	btvw.store_code BETWEEN NVL(?,'!') AND NVL(?,'~') AND item_code BETWEEN NVL(?,'!') AND NVL(?,'~') AND batch_id LIKE DECODE(?,'','%',?) AND PHY_INV_ID IS NULL AND btvw.store_code IN (SELECT  DISTINCT store_code FROM st_user_access_for_store WHERE user_id= ? AND CNDMN_EXP_BTCH_ALLOWED_YN='Y') AND btvw.language_id = ? AND btvw.lang1=? AND btvw.lang2=? AND btvw.store_code = mmvw.store_code AND btvw.language_id = mmvw.language_id AND mmvw.facility_id = ? ORDER BY ex_date");

		dataMap.put("SQL_ST_STORE_LOOKUP_FOR_CONDEMN", "SELECT a.store_code	code, b.short_desc description FROM	st_store a,	mm_store b WHERE a.store_code =	b.store_code AND b.eff_status='E' AND UPPER(a.store_code) LIKE UPPER(?)	 AND UPPER(b.short_desc) like UPPER(?) order by 2,1 ");
		dataMap.put("SQL_ST_FETCH_MAX_DOC_NO", "SELECT max(doc_no) doc_no FROM st_adj_hdr");
		dataMap.put("SQL_ST_CONDEMN_ID_SELECT",	"SELECT	curr_condemn_id+1 curr_condemn_id FROM st_acc_entity_param");
		dataMap.put("SQL_ST_EXPIRED_ITEM_INSERT", "INSERT INTO ST_EXPIRED_ITEM (CONDEMN_ID,ITEM_CODE,STORE_CODE,BATCH_ID,BIN_LOCATION_CODE,EXPIRY_DATE_OR_RECEIPT_DATE,TRADE_ID,REPLACE_ON_EXPIRY_YN,ITEM_QTY,TRN_REMARKS_CODE,ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)	VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_CONDEMN_ID_UPDATE",	"Update	st_acc_entity_param	SET	curr_condemn_id	= curr_condemn_id+1, MODIFIED_BY_ID	= ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO	= ?, MODIFIED_FACILITY_ID =	?");
		dataMap.put("SQL_ST_ITEM_STORE_QTY_ON_HAND_UPDATE","UPDATE st_item_store SET qty_on_hand = qty_on_hand - ? ,item_value=item_value-?,modified_by_id = ? , modified_date = sysdate , modified_at_ws_no = ? , modified_facility_id = ?  WHERE item_code = ? AND store_code = ?");

		//Assembly Dtls
		dataMap.put("SQL_ST_ASSEMBLY_DTL_CONV_FACT","select	(case when (?=?) then 1	else (case when	 (?!=?)	then (select eqvl_value	from am_uom_eqvl where uom_code=? and eqvl_uom_code=?) end ) end) conv_factor from dual	");
		dataMap.put("SQL_ST_ASM_DTL_MFG_UOM_LIST","SELECT uom_code,short_desc FROM am_uom_lang_vw WHERE	qty_uom_yn='Y' AND language_id = ? order by	 short_desc	");
		dataMap.put("SQL_ST_ASM_DTL_MFG_UOM_LIST_WT_LANG","SELECT uom_code,short_desc FROM am_uom WHERE	qty_uom_yn='Y' order by	 short_desc	");
		//Commented by Rabbani #Incno:33366 on:18/10/2012
		//dataMap.put("SQL_ST_ASSEMBLY_HDR_QUERY_RESULT",	"SELECT A.ITEM_CODE, BASE_QTY,DECODE (PREPARATION_TYPE,'P', 'PRE PACKING','S', 'STANDARD	FORMULARY','E', 'EXTEMPORANEOUS','O', 'OTHERS') PREP_TYPE_DESC,DECODE (PREPARATION_MODE,'S', 'STERILE','N', 'NON STERILE','O', 'OTHERS') PREP_MODE_DESC,PROCESS_LOSS_PERCENT, PREPARATION_TYPE, PREPARATION_MODE, LABEL_TYPE,B.SHORT_DESC ITEM_DESC, C.SHORT_DESC UOM_DESC FROM ST_ASSEMBLY_HDR A, MM_ITEM_LANG_VW B, AM_UOM_LANG_VW C WHERE A.ITEM_CODE = B.ITEM_CODE AND B.GEN_UOM_CODE = C.UOM_CODE(+) AND UPPER (A.ITEM_CODE) LIKE (? || '%') AND UPPER (B.SHORT_DESC) LIKE (? || '%') AND PREPARATION_TYPE LIKE (?) AND PREPARATION_MODE LIKE (?) AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND UPPER (B.SHORT_DESC) LIKE UPPER(?)");
		
		//Added by Rabbani #Incno:33366 on:18/10/2012
		//dataMap.put("SQL_ST_ASSEMBLY_HDR_QUERY_RESULT",	"SELECT A.ITEM_CODE, BASE_QTY,DECODE (PREPARATION_TYPE,'P', 'PRE PACKING','S', 'STANDARD	FORMULARY','E', 'EXTEMPORANEOUS','O', 'OTHERS') PREP_TYPE_DESC,DECODE (PREPARATION_MODE,'S', 'STERILE','N', 'NON STERILE','O', 'OTHERS') PREP_MODE_DESC,PROCESS_LOSS_PERCENT, PREPARATION_TYPE, PREPARATION_MODE, LABEL_TYPE,B.SHORT_DESC ITEM_DESC, C.SHORT_DESC UOM_DESC ,A.INSTRUCTION_TEXT FROM ST_ASSEMBLY_HDR A, MM_ITEM_LANG_VW B, AM_UOM_LANG_VW C WHERE A.ITEM_CODE = B.ITEM_CODE AND B.GEN_UOM_CODE = C.UOM_CODE(+) AND UPPER (A.ITEM_CODE) LIKE (? || '%') AND UPPER (B.SHORT_DESC) LIKE (? || '%') AND PREPARATION_TYPE LIKE (?) AND PREPARATION_MODE LIKE (?) AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND UPPER (B.SHORT_DESC) LIKE UPPER(?)");
		dataMap.put("SQL_ST_ASSEMBLY_HDR_QUERY_RESULT",	"SELECT A.ITEM_CODE, BASE_QTY,DECODE (PREPARATION_TYPE,'P', 'PRE PACKING','S', 'STANDARD	FORMULARY','E', 'EXTEMPORANEOUS','O', 'OTHERS') PREP_TYPE_DESC,DECODE (PREPARATION_MODE,'S', 'STERILE','N', 'NON STERILE','O', 'OTHERS') PREP_MODE_DESC,PROCESS_LOSS_PERCENT, PREPARATION_TYPE, PREPARATION_MODE, LABEL_TYPE,B.SHORT_DESC ITEM_DESC, C.SHORT_DESC UOM_DESC ,A.INSTRUCTION_TEXT,A.SHELF_LIFE_VALUE,A.SHELF_LIFE_FLAG FROM ST_ASSEMBLY_HDR A, MM_ITEM_LANG_VW B, AM_UOM_LANG_VW C WHERE A.ITEM_CODE = B.ITEM_CODE AND B.GEN_UOM_CODE = C.UOM_CODE(+) AND UPPER (A.ITEM_CODE) LIKE (? || '%') AND UPPER (B.SHORT_DESC) LIKE (? || '%') AND PREPARATION_TYPE LIKE (?) AND PREPARATION_MODE LIKE (?) AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND UPPER (B.SHORT_DESC) LIKE UPPER(?)");//Added for ML-MMOH-CRF-1909
		
		//dataMap.put("SQL_ST_ASSEMBLY_HDR_QUERY_RESULT1",	"SELECT	 a.item_code ,  base_qty ,		DECODE(preparation_type,'P','Pre Packing','S','Standard	Formulary','E','Extemporaneous','O','Others')prep_type_desc	,DECODE(preparation_mode,'S','Sterile','N','Non	Sterile','O','Others') prep_mode_desc,process_loss_percent,preparation_type,preparation_mode,label_type,b.short_desc item_desc,c.short_desc uom_desc FROM st_assembly_hdr a,mm_item b,am_uom c	WHERE  a.item_code=b.item_code	 AND b.gen_uom_code=c.uom_code(+) AND  UPPER(a.item_code) LIKE (?||'%')	AND UPPER(b.short_desc) like(?||'%') AND	 preparation_type LIKE (?) AND	preparation_mode LIKE (?)");
		dataMap.put("SQL_ST_ASSEMBLY_HDR_QUERY_RESULT1",	"SELECT	 a.item_code ,  base_qty ,		DECODE(preparation_type,'P','Pre Packing','S','Standard	Formulary','E','Extemporaneous','O','Others')prep_type_desc	,DECODE(preparation_mode,'S','Sterile','N','Non	Sterile','O','Others') prep_mode_desc,process_loss_percent,preparation_type,preparation_mode,label_type,b.short_desc item_desc,c.short_desc uom_desc,a.shelf_life_value,a.shelf_life_flag FROM st_assembly_hdr a,mm_item b,am_uom c	WHERE  a.item_code=b.item_code	 AND b.gen_uom_code=c.uom_code(+) AND  UPPER(a.item_code) LIKE (?||'%')	AND UPPER(b.short_desc) like(?||'%') AND	 preparation_type LIKE (?) AND	preparation_mode LIKE (?)");//Added for ML-MMOH-CRF-1909
		//dataMap.put("SQL_ST_ASSEMBLY_DTL_QUERY_RESULT",	"SELECT	b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,b.component_yn component,b.mandatory_item_yn	mandatory,d.short_desc mfg_desc	,'update' func_mode,(CASE WHEN (c.gen_uom_code=b.mfg_uom_code) THEN	1 ELSE	(CASE WHEN	(c.gen_uom_code!=b.mfg_uom_code) THEN (SELECT eqvl_value FROM am_uom_eqvl WHERE	uom_code=c.gen_uom_code	AND	eqvl_uom_code=b.mfg_uom_code) END )	END) conv_factor,e.short_desc stock_uom	,c.gen_uom_code	uom_code,a.instruction_text instruction_text FROM  st_assembly_hdr_lang_vw a, st_assembly_dtl b,mm_item_lang_vw	c,am_uom_lang_vw d ,am_uom_lang_vw e WHERE	a.item_code=? AND a.item_code=b.assembly_item_code AND b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+) AND c.gen_uom_code=e.uom_code(+) AND a.language_id = c.language_id AND c.language_id = ? AND d.language_id(+) = ? AND e.language_id(+) = ? ");
		dataMap.put("SQL_ST_ASSEMBLY_DTL_QUERY_RESULT",	"SELECT	b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,b.component_yn component,b.mandatory_item_yn	mandatory,d.short_desc mfg_desc	,'update' func_mode,(CASE WHEN (c.gen_uom_code=b.mfg_uom_code) THEN	1 ELSE	(CASE WHEN	(c.gen_uom_code!=b.mfg_uom_code) THEN (SELECT eqvl_value FROM am_uom_eqvl WHERE	uom_code=c.gen_uom_code	AND	eqvl_uom_code=b.mfg_uom_code) END )	END) conv_factor,e.short_desc stock_uom	,c.gen_uom_code	uom_code,a.instruction_text instruction_text,a.shelf_life_value,a.shelf_life_flag FROM  st_assembly_hdr_lang_vw a, st_assembly_dtl b,mm_item_lang_vw	c,am_uom_lang_vw d ,am_uom_lang_vw e WHERE	a.item_code=? AND a.item_code=b.assembly_item_code AND b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+) AND c.gen_uom_code=e.uom_code(+) AND a.language_id = c.language_id AND c.language_id = ? AND d.language_id(+) = ? AND e.language_id(+) = ? ");//Added for ML-MMOH-CRF-1909
		//dataMap.put("SQL_ST_ASSEMBLY_DTL_QUERY_RESULT1",	"SELECT	b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,b.component_yn component,b.mandatory_item_yn	mandatory,d.short_desc mfg_desc	,'update' func_mode,(CASE WHEN (c.gen_uom_code=b.mfg_uom_code) THEN	1 ELSE	(CASE WHEN	(c.gen_uom_code!=b.mfg_uom_code) THEN (SELECT eqvl_value FROM am_uom_eqvl WHERE	uom_code=c.gen_uom_code	AND	eqvl_uom_code=b.mfg_uom_code) END )	END) conv_factor,e.short_desc stock_uom	,c.gen_uom_code	uom_code,a.instruction_text instruction_text,b.seq_no FROM  st_assembly_hdr_lang_vw a, st_assembly_dtl b,mm_item_lang_vw	c,am_uom_lang_vw d ,am_uom_lang_vw e WHERE	a.item_code=? AND a.item_code=b.assembly_item_code AND b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+) AND c.gen_uom_code=e.uom_code(+) AND a.language_id = c.language_id AND c.language_id = e.language_id(+) AND c.language_id = ? AND d.language_id (+) =?");
		//dataMap.put("SQL_ST_ASSEMBLY_DTL_QUERY_RESULT1",	"SELECT	b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,b.component_yn component,b.mandatory_item_yn	mandatory,d.short_desc mfg_desc	,'update' func_mode,(CASE WHEN (c.gen_uom_code=b.mfg_uom_code) THEN	1 ELSE	(CASE WHEN	(c.gen_uom_code!=b.mfg_uom_code) THEN (SELECT eqvl_value FROM am_uom_eqvl WHERE	uom_code=c.gen_uom_code	AND	eqvl_uom_code=b.mfg_uom_code) END )	END) conv_factor,e.short_desc stock_uom	,c.gen_uom_code	uom_code,a.instruction_text instruction_text,b.seq_no,b.PRINT_ON_LABEL_YN,b.INSTRN_CODE FROM  st_assembly_hdr_lang_vw a, st_assembly_dtl b,mm_item_lang_vw	c,am_uom_lang_vw d ,am_uom_lang_vw e WHERE	a.item_code=? AND a.item_code=b.assembly_item_code AND b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+) AND c.gen_uom_code=e.uom_code(+) AND a.language_id = c.language_id AND c.language_id = e.language_id(+) AND c.language_id = ? AND d.language_id (+) =?");
		dataMap.put("SQL_ST_ASSEMBLY_DTL_QUERY_RESULT1",	"SELECT	b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,b.component_yn component,b.mandatory_item_yn	mandatory,d.short_desc mfg_desc	,'update' func_mode,(CASE WHEN (c.gen_uom_code=b.mfg_uom_code) THEN	1 ELSE	(CASE WHEN	(c.gen_uom_code!=b.mfg_uom_code) THEN (SELECT eqvl_value FROM am_uom_eqvl WHERE	uom_code=c.gen_uom_code	AND	eqvl_uom_code=b.mfg_uom_code) END )	END) conv_factor,e.short_desc stock_uom	,c.gen_uom_code	uom_code,b.seq_no,b.PRINT_ON_LABEL_YN,b.INSTRN_CODE FROM  st_assembly_hdr_lang_vw a, st_assembly_dtl b,mm_item_lang_vw	c,am_uom_lang_vw d ,am_uom_lang_vw e WHERE	a.item_code=? AND a.item_code=b.assembly_item_code AND b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+) AND c.gen_uom_code=e.uom_code(+) AND a.language_id = c.language_id AND c.language_id = e.language_id(+) AND c.language_id = ? AND d.language_id (+) =? ORDER BY 12");

//		dataMap.put("SQL_ST_ASSEMBLY_HDR_INSERT", "INSERT into ST_ASSEMBLY_HDR	(ITEM_CODE ,   base_qty	,preparation_type ,preparation_mode	,process_loss_percent ,added_by_id ,added_date ,added_at_ws_no ,added_facility_id  ,modified_by_id ,modified_date ,modified_at_ws_no ,modified_facility_id	,label_type  )values(?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?)");
		dataMap.put("SQL_ST_ASSEMBLY_HDR_INSERT", "INSERT INTO ST_ASSEMBLY_HDR	(ITEM_CODE ,   base_qty	,preparation_type ,preparation_mode	,process_loss_percent ,added_by_id ,added_date ,added_at_ws_no ,added_facility_id  ,modified_by_id ,modified_date ,modified_at_ws_no ,modified_facility_id	,label_type,instruction_text ,shelf_life_value,shelf_life_flag )VALUES(?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?)");
		
		//dataMap.put("SQL_ST_ASSEMBLY_DTL_INSERT", "INSERT into ST_ASSEMBLY_DTL	(assembly_item_code,child_item_code	,component_qty ,mfg_uom_code  ,COMPONENT_YN,mandatory_item_yn ,added_by_id ,added_date ,added_at_ws_no ,added_facility_id ,modified_by_id ,modified_date ,	modified_at_ws_no  ,modified_facility_id	 )values(?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?)");
		dataMap.put("SQL_ST_ASSEMBLY_DTL_INSERT", "INSERT into ST_ASSEMBLY_DTL	(assembly_item_code,child_item_code	,component_qty ,mfg_uom_code  ,COMPONENT_YN,mandatory_item_yn ,added_by_id ,added_date ,added_at_ws_no ,added_facility_id ,modified_by_id ,modified_date ,	modified_at_ws_no  ,modified_facility_id,PRINT_ON_LABEL_YN,INSTRN_CODE,SEQ_NO)values(?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?)");

		dataMap.put("SQL_ST_ASSEMBLY_DTL_DELETE", "delete ST_ASSEMBLY_DTL  where assembly_item_code=? and child_item_code=?	");
		//dataMap.put("SQL_ST_ASSEMBLY_HDR_UPDATE", "UPDATE st_assembly_hdr set  base_qty=? ,preparation_type=? ,preparation_mode=? ,process_loss_percent=? ,	modified_by_id=? ,modified_date=sysdate	,  modified_at_ws_no=?	,modified_facility_id=? , label_type =? , instruction_text = ? 	where item_code=? ");
		dataMap.put("SQL_ST_ASSEMBLY_HDR_UPDATE", "UPDATE st_assembly_hdr set  base_qty=? ,preparation_type=? ,preparation_mode=? ,process_loss_percent=? ,	modified_by_id=? ,modified_date=sysdate	,  modified_at_ws_no=?	,modified_facility_id=? , label_type =? , instruction_text = ? , shelf_life_value = ? , shelf_life_flag = ? where item_code=? ");//Added for ML-MMOH-CRF-1909
		//dataMap.put("SQL_ST_ASSEMBLY_DTL_UPDATE", "UPDATE st_assembly_dtl set component_qty=?,mfg_uom_code=?, component_yn=?,mandatory_item_yn=?, modified_by_id=? ,modified_date=sysdate ,	 modified_at_ws_no=?  ,modified_facility_id=? where	assembly_item_code=? and child_item_code=? ");
		dataMap.put("SQL_ST_ASSEMBLY_DTL_UPDATE", "UPDATE st_assembly_dtl set component_qty=?,mfg_uom_code=?, component_yn=?,mandatory_item_yn=?, modified_by_id=? ,modified_date=sysdate ,	 modified_at_ws_no=?  ,modified_facility_id=?,PRINT_ON_LABEL_YN=?,SEQ_NO=?,INSTRN_CODE=?  where	assembly_item_code=? and child_item_code=? ");


//		dataMap.put("SQL_ST_ASM_DTL_LABEL_TYPE_SELECT", "select LABEL_TYPE from st_assembly_hdr where ITEM_CODE =?");

		//Split	Batch

		dataMap.put("SQL_ST_SPLIT_BATCH_HDR_INSERT","INSERT	INTO st_split_batch_hdr(facility_id, doc_type_code,	doc_no,	doc_date, doc_ref, store_code, added_by_id,	added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES(?, ?,	?, to_date(?,'dd/mm/yyyy'),	?, ?, ?, SYSDATE, ?, ?,	?, SYSDATE,	?, ?)");
		dataMap.put("SQL_ST_SPLIT_BATCH_DTL_INSERT","INSERT	INTO st_split_batch_dtl( facility_id,doc_type_code,doc_no,doc_srl_no,store_code,item_code,batch_id,	bin_location_code,expiry_date_or_receipt_date,item_qty,remarks,	 added_by_id,  added_date,added_at_ws_no, added_facility_id,modified_by_id,	 modified_date,	 modified_at_ws_no,	 modified_facility_id,trade_id,SUPP_CODE ) VALUES (	?, ?, ?, ?,	?, ?, ?, ?,	to_date(?,'dd/mm/yyyy'), ?,	?, ?, SYSDATE, ?, ?, ?,	SYSDATE, ?,	?, ?, ?)");
		dataMap.put("SQL_ST_SPLIT_BATCH_DTL_EXP_INSERT","INSERT	INTO st_split_batch_dtl_exp	(facility_id, doc_type_code, doc_no, doc_srl_no, store_code, item_code,	batch_id, bin_location_code, expiry_date_or_receipt_date, trade_id,	item_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,	modified_facility_id,barcode_id) VALUES (?, ?,	?, ?, ?, ?,	?, ?, to_date(?,'dd/mm/yyyy'), ?, ?, ?,	SYSDATE,? ,	?, ?, SYSDATE, ?, ?,?)");
		dataMap.put("SQL_ST_ITEM_TRN_DTL_COM_INSERT","INSERT INTO st_item_trn_dtl(facility_id,		  store_code,item_code,	posted_date, trn_srl_no	 , trn_type	, doc_type_code, doc_no	, doc_srl_no, doc_date , doc_ref  ,	batch_id  ,	 expiry_date, item_qty_normal, item_qty_bonus  , item_qty_sample  ,	item_unit_cost	,  item_unit_price ,  stk_uom_code , 	supp_code  , source_doc_type_code,source_doc_no	,  source_doc_srl_no, source_doc_date ,	 other_store_code ,stock_item_yn , lend_borrow_entity_type,	lend_borrow_entity_code	, added_by_id ,	added_date	 , added_at_ws_no, added_facility_id, modified_by_id ,	modified_date ,	modified_at_ws_no, modified_facility_id,bin_location_code,trade_id)VALUES(?,?,?,sysdate,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,TO_DATE(?,'dd/mm/yyyy'),nvl(?,0),nvl(?,0),nvl(?,0),?,?,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
//		dataMap.put("SQL_ST_SPLIT_BATCH_ITEM_BATCH_UPDATE","UPDATE st_item_batch SET qty_on_hand=?	WHERE store_code=? ,item_code=?,batch_id=?,bin_location_code=?,expiry_date_or_receipt_date=?  ");  // Modified on 5/29/2006 for updating modification details   Not Used
		dataMap.put("SQL_ST_SPLIT_BATCH_ITEM_BATCH_UPDATE","UPDATE st_item_batch SET qty_on_hand=?	, modified_by_id = ?, modified_date	= SYSDATE, modified_at_ws_no = ?,	modified_facility_id = ? WHERE store_code=? ,item_code=?,batch_id=?,bin_location_code=?,expiry_date_or_receipt_date=? ");
		dataMap.put("SQL_ST_SPLIT_BATCH_SELECT","SELECT	st.store_code, mm.short_desc FROM st_user_access_for_store st, mm_store_lang_vw	mm,	sm_appl_user sm, st_store ststr WHERE st.store_code	= mm.store_code	AND st.store_code = ststr.store_code AND st.user_id=sm.appl_user_id	AND	mm.eff_status =	'E'	AND	sm.eff_status='E' AND (st.SPLIT_BATCH_ALLOWED_YN='Y' and ststr.SPLIT_BATCH_ALLOWED_YN='Y' ) AND	mm.facility_id =? AND st.user_id = ?  AND mm.language_id=? ORDER	BY 2");

		//Batch	Search
		dataMap.put("SQL_ST_BATCH_SEARCH_QUERY", "SELECT item_code,item_desc, a.store_code, store_desc, trade_id_applicable_yn, batch_id,	 TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date,	bin_location_code, bin_desc, trade_id, trade_name,	uom_code , uom_desc ,qty_on_hand, nod, manufacturer_id, manufacturer_name,  (avail_qty + ST_COMM_QTY_FOR_DOCNO(?,?,?,?,a.store_code, bin_location_code, batch_id , expiry_date, item_code)) avail_qty,expiry_yn,batch_status  FROM	st_batch_search_lang_view a, mm_store_lang_vw b WHERE	item_code BETWEEN NVL(UPPER(?),'!') AND NVL(UPPER(?),'~')	AND		   a.store_code BETWEEN NVL(UPPER(?),'!') AND NVL(UPPER(?),'~')	AND		   manufacturer_id LIKE	NVL(UPPER(?),'%') AND		  (?='Y' OR	avail_qty +ST_COMM_QTY_FOR_DOCNO(?,?,?,?,a.store_code, bin_location_code, batch_id , expiry_date, item_code) >	0) AND	 (expiry_yn	= 'N' OR use_after_expiry_yn='Y' OR	(expiry_yn='Y'	AND	((?='Y') OR	expiry_date	>= TRUNC(NVL(TO_DATE(?,'dd/mm/yyyy'),SYSDATE)))))   AND expiry_date <= TRUNC(SYSDATE)+ NVL(?,99999)	AND	(?='Y' OR suspended_yn='N') AND UPPER(batch_id) LIKE UPPER(?) AND a.language_id = ? AND a.lang1 = ? AND a.lang2 = ? and trade_id like nvl(?,'%') and a.store_code = b.store_code and b.facility_id = ? and b.language_id = a.language_id ORDER BY item_code,store_code,TO_DATE(expiry_date,'dd/mm/yyyy'),bin_location_code,batch_id");
		dataMap.put("SQL_ST_BATCH_SEARCH_PROCESS"," SELECT process_expired_items_yn,process_suspended_items_yn from st_user_access_for_store where store_code=? and user_id = ? ");
		dataMap.put("SQL_ST_SELECT_EXPIRY_WARNING_DAYS", "select EXPIRY_WARNING_DAYS from st_acc_entity_param where ACC_ENTITY_ID=?");

		//Suspend Batch
		dataMap.put("SQL_ST_SUSPEND_BATCH_QUERY","SELECT   b.batch_status, a.batch_id, TO_CHAR (a.expiry_date, 'dd/mm/yyyy') expiry_date, trade_name, manufacturer_name, SUM (qty_on_hand) qtyonhand, 'N' selected, a.item_code, b.remarks, status_updated_by, status_remarks_oth FROM st_batch_search_lang_view a, ST_BATCH_CONTROL b , mm_store_lang_vw c, ST_ACC_ENTITY_PARAM d WHERE a.item_code = b.item_code AND a.batch_id = b.batch_id AND a.expiry_date = b.expiry_date_or_receipt_date AND a.item_code = ?    AND b.batch_status IN (?, ?) AND a.manufacturer_id LIKE (? || '%') AND a.batch_id LIKE (? || '%') AND a.language_id = c.language_id AND c.store_code = a.store_code AND a.language_id = ? AND DECODE (a.lang1, NULL, ?, a.lang1) = ? AND DECODE (a.lang2, NULL, ?, a.lang2) = ? AND c.facility_id = ?  GROUP BY a.batch_id,        a.expiry_date, trade_name, manufacturer_name, b.batch_status, a.item_code, b.remarks, status_updated_by, status_remarks_oth ORDER BY 1, 2");
		dataMap.put("SQL_ST_SUSPEND_UPDATE_CONTROL","UPDATE	st_batch_control SET BATCH_STATUS=?	,REMARKS=?,STATUS_UPDATED_BY = ? ,STATUS_REMARKS_OTH = ?, EXTERNAL_COMP_YN= ?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ITEM_CODE=? AND BATCH_ID=?	AND	EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy')");
		//dataMap.put("SQL_ST_SUSPEND_UPDATE_ITEM_BATCH","UPDATE st_item_batch SET SUSPENDED_YN=?	,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ITEM_CODE=? AND BATCH_ID=?	AND	EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy')");
		//Added by Rabbani #Bru-HIMS-CRF-111[Inc no :30070] on  05-AUG-2013 Starts
		//dataMap.put("SQL_ST_SUSPEND_UPDATE_ITEM_BATCH","UPDATE st_item_batch SET SUSPENDED_YN=?	,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ITEM_CODE=? AND BATCH_ID=?	AND	EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy') and  store_code  IN  (select store_code  from mm_store where facility_id LIKE ?  and store_code LIKE ?)");
		 //Added by Rabbani #CRF-ST- Bru-HIMS-CRF-111/01 (Inc no:42634) on 22-AUG-2013
		dataMap.put("SQL_ST_SUSPEND_UPDATE_ITEM_BATCH","UPDATE st_item_batch SET SUSPENDED_YN=?	,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ITEM_CODE=? AND BATCH_ID=?	AND	EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy') and  store_code  IN  (select store_code  from mm_store where facility_id LIKE ?  and store_code LIKE ?) AND  suspended_yn IN (?,?)");
		

		//added by pankaj on 25/11/2004 -modified by Janet on 04/10/2005
		//dataMap.put("SQL_ST_SUSPEND_BATCH_HISTORY_QUERY","SELECT DECODE (A.new_batch_status,'C','Notified','S','Suspended','A','Reinstated') batch_status ,A.expiry_date_or_receipt_date,A.REMARKS REMARKS,A.status_updated_by user_name,TO_CHAR(A.added_date,'DD/MM/YYYY HH24:MI') added_date ,A.item_code,NVL(A.status_remarks_oth,'') status_remarks_oth  FROM st_batch_status_upd_history A,st_batch_control B  WHERE A.item_code = B.item_code AND A.batch_id = B.batch_id AND A.expiry_date_or_receipt_date = B.expiry_date_or_receipt_date AND  A.trade_id = B.trade_id   AND A.item_code=?   AND A.batch_id = ? AND A.expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy') order by A.added_date");
		
		//dataMap.put("SQL_ST_SUSPEND_BATCH_HISTORY_QUERY","SELECT DECODE (A.new_batch_status,'C','Notified','S','Suspended','A','Reinstated') batch_status ,A.expiry_date_or_receipt_date,A.REMARKS REMARKS,A.status_updated_by user_name,TO_CHAR(A.added_date,'DD/MM/YYYY HH24:MI') added_date ,A.item_code,NVL(A.status_remarks_oth,'') status_remarks_oth  FROM st_batch_status_upd_history A,st_batch_control B  WHERE A.item_code = B.item_code AND A.batch_id = B.batch_id AND A.expiry_date_or_receipt_date = B.expiry_date_or_receipt_date AND  A.trade_id = B.trade_id   AND A.item_code=?   AND A.batch_id = ? AND A.expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy')  AND  (a.facility_id IS NULL OR  a.facility_id LIKE ?)  and (a.STORE_CODE IS NULL OR  a.STORE_CODE LIKE ? )  order by A.added_date");
		 
		//Added by Rabbani #CRF-ST- Bru-HIMS-CRF-111/01 (Inc no:42634) on 22-AUG-2013
		dataMap.put("SQL_ST_SUSPEND_BATCH_HISTORY_QUERY","SELECT DECODE (A.new_batch_status,'C','Notified','S','Suspended','A','Reinstated') batch_status ,A.expiry_date_or_receipt_date,A.REMARKS REMARKS,A.status_updated_by user_name,TO_CHAR(A.added_date,'DD/MM/YYYY HH24:MI') added_date ,A.item_code,NVL(A.status_remarks_oth,'') status_remarks_oth,(SELECT mm.short_desc from mm_store_lang_vw mm   where MM.LANGUAGE_ID = ? and a.store_code = mm.store_code) store_desc,(SELECT facility_name FROM sm_facility_param_lang_vw vw  WHERE a.facility_id = vw.facility_id AND language_id = ?)facility_name  FROM st_batch_status_upd_history A,st_batch_control B  WHERE A.item_code = B.item_code AND A.batch_id = B.batch_id AND A.expiry_date_or_receipt_date = B.expiry_date_or_receipt_date AND  A.trade_id = B.trade_id   AND A.item_code=?   AND A.batch_id = ? AND A.expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy')  AND  (a.facility_id IS NULL OR  a.facility_id LIKE ?)  and (a.STORE_CODE IS NULL OR  a.STORE_CODE LIKE ? )  order by A.added_date");

		//added by Janet on 01/08/2005
		//dataMap.put("SQL_ST_JOB_PROFILE","select job_title from am_practitioner where practitioner_id = ?");

		//added by Janet on 20/10/2005
		dataMap.put("SQL_ST_SUSPEND_REINSTATE_PROFILE","select func_role from sm_appl_user where appl_user_id = ?");
		dataMap.put("SQL_ST_SUSPEND_REINSTATE_PROFILE11","select a.position_code,b.position_desc from am_practitioner a, am_position_lang_vw b ,sm_appl_user c where a.position_code=b.position_code and  c.appl_user_id =a.practitioner_id and c.appl_user_id =? AND b.language_id = ?");
		dataMap.put("SQL_ST_SUSPEND_REINSTATE_PROFILE22","select a.position_code,b.position_desc from am_other_staff a, am_position_lang_vw b , sm_appl_user c where a.position_code=b.position_code and  a.other_staff_id=c.appl_user_id and c.appl_user_id = ? AND b.language_id = ?");

		//ended by Janet on 20/10/2005



//Manufacturing	Request

dataMap.put("SQL_ST_MAN_REQ_STORE_SELECT","SELECT   st.store_code, mm.short_desc FROM st_user_access_for_store st, mm_store_lang_vw mm, sm_appl_user sm , st_store ststr WHERE st.store_code = mm.store_code AND mm.store_code = ststr.store_code AND st.user_id = sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status = 'E' AND NVL(st.mfg_allowed_yn,'N') = 'Y' AND NVL(ststr.MFG_ALLOWED_YN,'N') = 'Y' AND mm.facility_id =?   AND st.user_id = ? AND mm.language_id = ? ORDER BY 2");

dataMap.put("SQL_ST_MAN_REQ_PRELOC_SELECT","SELECT   prepare_location_code, short_desc FROM st_prepare_location_lang_vw WHERE eff_status = 'E' AND facility_id = ?  AND language_id = ? ORDER BY short_desc");

dataMap.put("SQL_ST_MAN_REQ_MFG_REQUEST_NO","SELECT NVL(MAX(MFG_REQUEST_NO),0)+1 item_seq	FROM st_mfg_request_hdr	");

dataMap.put("SQL_ST_MAN_REQ_ENCOUNTER_SELECT_LIST","SELECT	encounter_id, encounter_id ItIsToPopulateListBox  FROM pr_encounter	WHERE facility_id=?	AND	patient_id=upper(?) AND ( visit_status	IN ('01', '02',	'04') OR adt_status	='01' )	and patient_class= decode(?, 'I', 'IP','O','OP','E','EM','D','DC') order by encounter_id desc");
dataMap.put("SQL_ST_MAN_REQ_ENCOUNTER_SELECT_LIST_1","SELECT	encounter_id, encounter_id ItIsToPopulateListBox  FROM pr_encounter	WHERE facility_id=?	AND	patient_id=upper(?) AND ( visit_status	IN ('01', '02',	'04') OR adt_status	='01' )	order by encounter_id desc");
dataMap.put("SQL_ST_MAN_REQ_ENCOUNTER_SELECT_LIST_2" , "SELECT	 ENCOUNTER_ID ITISTOPOPULATELISTBOX , ENCOUNTER_ID, TO_CHAR(VISIT_ADM_DATE_TIME,'DD/MM/YYYY HH24:MI')DT_TIME,   RPAD(CLINIC_NAME,15,' ')  CLINIC_NAME ,RPAD(PRACTITIONER_NAME,30,' ') PRACTITIONER_NAME  FROM PR_ENCOUNTER_VW	WHERE FACILITY_ID = ?	AND	PATIENT_ID = upper(?) AND ( VISIT_STATUS != '99' OR ADT_STATUS != '09' ) ORDER BY ENCOUNTER_ID DESC ");
dataMap.put("SQL_ST_MAN_REQ_PATIENT_SELECT_SINGLE",	"SELECT	patient_name FROM mp_patient WHERE patient_id =	upper(?)");
//added by ganga
dataMap.put("SQL_ST_MAN_REQ_PATIENT_SELECT_SINGLE_AGE",	"SELECT  patient_name,to_char(date_of_birth,'dd/mm/yyyy') date_of_birth ,sex, substr(get_age(date_of_birth),1,length(get_age(date_of_birth))-1) age ,substr(get_age(date_of_birth),length(get_age(date_of_birth)),length(get_age(date_of_birth))) age_type FROM mp_patient WHERE patient_id = upper(?)");

dataMap.put("SQL_ST_MAN_REQ_PR_ENCOUNTER_SELECT_MAX","SELECT max(encounter_id)encounter_id FROM	pr_encounter WHERE facility_id=? AND patient_id=? AND (	visit_status IN	('01', '02', '04') OR adt_status ='01' )");
dataMap.put("SQL_ST_MAN_REQ_ASSMBL_DTL_RESULT",	"SELECT	b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,d.short_desc	mfg_desc,e.short_desc STOCK_UOM	 ,e.UOM_CODE , 'DB'	datatype  FROM	st_assembly_hdr	a, st_assembly_dtl b,mm_item c,am_uom d	,am_uom	e WHERE	 a.item_code=? AND a.item_code=b.assembly_item_code	AND	b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+)	AND	c.gen_uom_code=e.uom_code(+) ");
//dataMap.put("SQL_ST_MAN_REQ_HDR_RESULT", "SELECT a.item_code,request_qty,preparation_type,preparation_mode,a.patient_id	,a.requesting_store_code,a.prepare_location_code,MFG_REQUEST_NO,item_desc,encounter_id,b.short_desc,'DB' datatype,'N'	selected ,c.short_desc stock_uom ,d.PATIENT_NAME ,a.item_desc remarks ,e.SHORT_DESC loc_desc ,f.SHORT_DESC store_desc,b.UNIT_COST,nvl(g.EXPIRY_YN,'N')EXPIRY_YN,b.GEN_UOM_CODE uom_code  FROM st_mfg_request_hdr a,mm_item	b,am_uom c,mp_patient d,st_prepare_location e,mm_store f,st_item g 	WHERE request_status ='E' AND a.ITEM_CODE=b.ITEM_CODE(+) AND	b.gen_uom_code =c.uom_code(+)  AND a.PATIENT_ID=d.PATIENT_ID(+) AND a.prepare_location_code=e.PREPARE_LOCATION_CODE(+) AND a.requesting_store_code=f.STORE_CODE(+) AND a.ITEM_CODE=g.ITEM_CODE(+)	  AND	a.requesting_store_code LIKE (?||'%')	AND	 a.prepare_location_code LIKE	(?||'%') AND preparation_type LIKE (?||'%')	AND	preparation_mode LIKE (?||'%')  order by MFG_REQUEST_NO ");
//dataMap.put("SQL_ST_MAN_REQ_HDR_RESULT", "SELECT a.item_code,request_qty,preparation_type,preparation_mode,a.patient_id	,a.requesting_store_code,a.prepare_location_code,MFG_REQUEST_NO,item_desc,encounter_id,b.short_desc,'DB' datatype,'N'	selected ,c.short_desc stock_uom ,d.PATIENT_NAME ,a.item_desc remarks ,e.SHORT_DESC loc_desc ,f.SHORT_DESC store_desc,b.UNIT_COST,NVL(g.EXPIRY_YN,'N')EXPIRY_YN,b.GEN_UOM_CODE uom_code , f.SHORT_DESC STORE_DESC, TO_CHAR(a.MODIFIED_DATE,'dd/mm/yyyy') REQ_DATE ,REQUEST_STATUS FROM st_mfg_request_hdr a,mm_item	b,am_uom c,mp_patient d,st_prepare_location e,mm_store f,st_item g 	WHERE request_status LIKE ? AND a.ITEM_CODE=b.ITEM_CODE(+) AND	b.gen_uom_code =c.uom_code(+)  AND a.PATIENT_ID=d.PATIENT_ID(+) AND a.prepare_location_code=e.PREPARE_LOCATION_CODE(+) AND a.requesting_store_code=f.STORE_CODE(+) AND a.ITEM_CODE=g.ITEM_CODE(+)	  AND	a.requesting_store_code LIKE (?||'%')	AND	 a.prepare_location_code LIKE	(?||'%') AND preparation_type LIKE (?||'%')	AND	preparation_mode LIKE (?||'%')  ORDER BY MFG_REQUEST_NO ");
  dataMap.put("SQL_ST_MAN_REQ_HDR_RESULT", "SELECT   a.item_code, request_qty, preparation_type, preparation_mode,          a.patient_id, a.requesting_store_code, a.prepare_location_code, mfg_request_no, item_desc, DECODE (a.preparation_type,                  'E', a.item_code, b.short_desc) mfg_item_desc, encounter_id, b.short_desc, 'DB' datatype, 'N' selected, c.short_desc stock_uom, d.patient_name, a.item_desc remarks,e.short_desc loc_desc, f.short_desc store_desc, b.unit_cost, NVL (g.expiry_yn, 'N') expiry_yn, b.gen_uom_code uom_code, f.short_desc store_desc, TO_CHAR (a.modified_date, 'dd/mm/yyyy') req_date, request_status FROM ST_MFG_REQUEST_HDR a, mm_item_lang_vw b, am_uom_lang_vw c, mp_patient d, st_prepare_location_lang_vw e, mm_store_lang_vw f,          ST_ITEM g, mm_store_lang_vw mmvw WHERE request_status LIKE ? AND a.item_code = b.item_code(+) AND b.gen_uom_code = c.uom_code(+) AND a.patient_id = d.patient_id(+) AND b.language_id = c.language_id(+) AND a.prepare_location_code = e.prepare_location_code(+) AND a.requesting_store_code = f.store_code(+) AND a.item_code = g.item_code(+) AND a.requesting_store_code LIKE (? || '%') AND a.prepare_location_code LIKE (? || '%') AND preparation_type LIKE (? || '%') AND preparation_mode LIKE (? || '%') AND (mfg_request_no BETWEEN NVL (?, 0) AND NVL (?, 999999)) AND (trunc(a.modified_date) BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND b.language_id(+) = ? AND e.language_id(+) = ? AND f.language_id(+) = ? AND a.requesting_store_code = mmvw.store_code AND mmvw.language_id = ? AND mmvw.facility_id = ? ORDER BY mfg_request_no");

dataMap.put("SQL_ST_MAN_REQ_DTL_RESULT", "SELECT a.child_item_code, a.component_qty, a.mfg_uom_code,b.short_desc, c.short_desc mfg_desc, mfg_request_no,'DB' datatype, 'N' selected, d.short_desc stock_uom  FROM st_mfg_request_dtl a, mm_item_lang_vw b, am_uom_lang_vw c, am_uom_lang_vw d   WHERE a.child_item_code = b.item_code AND a.mfg_uom_code = c.uom_code(+) AND b.gen_uom_code = d.uom_code(+) AND b.language_id = ? AND c.language_id(+) = ? AND d.language_id(+) = ?");
dataMap.put("SQL_ST_MAN_REQ_CHECK_ASSEMB_DTL", "SELECT preparation_type,	preparation_mode FROM st_assembly_hdr  WHERE item_code =?  ");
dataMap.put("SQL_ST_MAN_REQ_HDR_INSERT","INSERT	INTO st_mfg_request_hdr	 (requesting_store_code,prepare_location_code,preparation_type,preparation_mode,item_code,request_qty,patient_id,encounter_id,MFG_REQUEST_NO,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,item_desc) VALUES	(?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?) ");
dataMap.put("SQL_ST_MAN_REQ_DTL_INSERT","INSERT	INTO st_mfg_request_dtl (MFG_REQUEST_NO,child_item_code,component_qty,mfg_uom_code,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
dataMap.put("SQL_ST_MAN_REQ_HDR_UPDATE","UPDATE	 st_mfg_request_hdr	 set requesting_store_code=?,prepare_location_code=?,preparation_type=?,preparation_mode=?,request_qty=?,patient_id=?,encounter_id=?,modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=?,item_desc=?	WHERE MFG_REQUEST_NO=?	");
dataMap.put("SQL_ST_MAN_REQ_DTL_UPDATE","UPDATE	 st_mfg_request_dtl set component_qty=?,mfg_uom_code=?,modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=? where MFG_REQUEST_NO=? AND	child_item_code	=? ");
dataMap.put("SQL_ST_MAN_REQ_DTL_DELETE","DELETE	 st_mfg_request_dtl  where MFG_REQUEST_NO=? AND	child_item_code	=? ");
dataMap.put("SQL_ST_MAN_REQ_DTL_ALL_DELETE","DELETE	 st_mfg_request_dtl where	MFG_REQUEST_NO=? ");
dataMap.put("SQL_ST_MAN_REQ_HDR_ALL_DELETE","DELETE	 st_mfg_request_hdr	 where MFG_REQUEST_NO=? ");

/*	Change Expiry Flag	from here*/

dataMap.put("SQL_ST_GRN_COUNT",	"select	count(*) grn_count from	st_grn_hdr a where (finalized_yn='N') and trn_type='GRN' and facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no in (select facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no from st_grn_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id = ? ");
dataMap.put("SQL_ST_RTV_COUNT",	"select	count(*) rtv_count from	st_rtv_hdr a where (finalized_yn='N') and trn_type='RTV' and facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no in (select facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no from st_rtv_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id = ? ");
dataMap.put("SQL_ST_ISS_COUNT",	"select	count(*) iss_count from	st_issue_hdr a where (finalized_yn='N')	and	trn_type='ISS' and facility_id || '-' || doc_type_code || '-' || doc_no	in (select facility_id || '-' || doc_type_code || '-' || doc_no	from st_issue_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id =? ");
dataMap.put("SQL_ST_URG_COUNT",	"select	count(*) urg_count from	st_issue_hdr a where (finalized_yn='N')	and	trn_type='URG' and facility_id || '-' || doc_type_code || '-' || doc_no	in (select facility_id || '-' || doc_type_code || '-' || doc_no	from st_issue_dtl where	 facility_id=a.facility_id and doc_type_code=a.doc_type_code and doc_no=a.doc_no and item_code=?) and a.facility_id =? ");
dataMap.put("SQL_ST_RET_COUNT",	"select	count(*) ret_count from	st_issue_ret_hdr a where (finalized_yn='N')	and	trn_type='RET' and facility_id || '-' || doc_type_code || '-' || doc_no	in (select facility_id || '-' || doc_type_code || '-' || doc_no	from st_issue_ret_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id =? ");
dataMap.put("SQL_ST_ADJ_COUNT",	"select	count(*) adj_count from	st_adj_hdr a where (finalized_yn='N') and trn_type='ADJ' and facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no in (select facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no from st_adj_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id =?");
//Modified against GHL-CRF-0413.7 Change Expiry Flag Performance Issue
//dataMap.put("SQL_ST_SAL_COUNT",	"select	count(*) sal_count from	st_sal_hdr a where (finalized_yn='N') and trn_type='SAL' and facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no in (select facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no from st_sal_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id=? ");
dataMap.put("SQL_ST_SAL_COUNT",	"select COUNT(*) sal_count FROM    st_sal_hdr A, st_sal_dtl b WHERE (finalized_yn='N') AND trn_type='SAL' and a.facility_id=b.facility_id  AND a.doc_type_code=b.doc_type_code  AND    a.doc_no=b.doc_no AND    item_code= ? AND a.facility_id=?");
dataMap.put("SQL_ST_SRT_COUNT",	"select	count(*) srt_count from	st_sal_ret_hdr a where (finalized_yn='N') and trn_type='SRT' and facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no in (select facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no from st_sal_ret_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id =? ");
dataMap.put("SQL_ST_TFR_COUNT",	"select	count(*) tfr_count from	st_transfer_hdr	a where	(finalized_yn='N') and trn_type='TFR' and facility_id || '-' ||	doc_type_code || '-' ||	doc_no in (select facility_id || '-' ||	doc_type_code || '-' ||	doc_no from	st_transfer_dtl	where  facility_id=a.facility_id and doc_type_code=a.doc_type_code and doc_no=a.doc_no and item_code=?) and a.facility_id =? ");
dataMap.put("SQL_ST_PRT_COUNT",	"select	count(*) prt_count from	st_prod_transfer_hdr a where (finalized_yn='N')	and	trn_type='PRT' and facility_id || '-' || doc_type_code || '-' || doc_no	in (select facility_id || '-' || doc_type_code || '-' || doc_no	from st_prod_transfer_dtl where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id =?");
dataMap.put("SQL_ST_MFG_COUNT",	"select	count(*) mfg_count from	ST_MFG_HDR a where (finalized_yn='N') and trn_type='MFG' and facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no in (select facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no from ST_MFG_DTL where	facility_id=a.facility_id and doc_type_code=a.doc_type_code	and	doc_no=a.doc_no	and	item_code=?) and a.facility_id =?");

//QOH
dataMap.put("SQL_ST_ITEM_BATCH_QOH", "SELECT NVL(SUM(QTY_ON_HAND),0) qty FROM st_item_batch A , MM_store_LANG_VW B WHERE item_code=? AND  A.store_CODE = B.store_CODE AND b.LANGUAGE_ID = ? AND b.facility_id = ? ");
//ADDED ON 24/08/2004 TO CHECK ITEM LINKING WITH PH TRANSACTION 
dataMap.put("SQL_ST_ITEM_PH_ASSOCIATION_CHECK", "SELECT INSTALL_YN FROM SM_MODULE WHERE  MODULE_ID= 'PH' ");
dataMap.put("SQL_ST_ITEM_ASSOCIATED_WITH_PH_COUNT", "SELECT COUNT(*) COUNT FROM PH_INVENTORY_ITEM_FOR_DRUG WHERE inventory_item_code= ? ");

//STORE	LEVEL
//Modified against GHL-CRF-0413.7 Change Expiry Flag Performance Issue
//dataMap.put("SQL_ST_STORE_LEVEL_COUNT",	"SELECT	a.store_code, a.short_desc,	b.qty_on_hand, a.adj_count,	a.grn_count,a.iss_count,a.urg_count, a.ret_count, a.sal_count, a.tfr_count,	a.prt_count,a.mfg_count,a.rtv_count, a.srt_count FROM (SELECT a.store_code,	b.short_desc, SUM(a.adj_count) adj_count, SUM(a.grn_count) grn_count, SUM(a.iss_count) iss_count, SUM(a.urg_count) urg_count, SUM(a.ret_count) ret_count, SUM(a.sal_count) sal_count, SUM(a.tfr_count) tfr_count, SUM(a.prt_count) prt_count, SUM(a.mfg_count) mfg_count, SUM(a.rtv_count) rtv_count, SUM(a.srt_count) srt_count FROM	( SELECT store_code, COUNT(*) adj_count, 0 grn_count ,0	iss_count ,0 urg_count ,0 ret_count	, 0	sal_count ,0 tfr_count ,0 prt_count	,0 mfg_count, 0 rtv_count, 0 srt_count  FROM st_adj_hdr a	WHERE (finalized_yn='N') AND trn_type='ADJ'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_adj_dtl WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=? ) GROUP BY store_code UNION SELECT store_code,0 adj_count ,COUNT(*) grn_count ,0	iss_count ,0 urg_count ,0 ret_count	,0 sal_count ,0	tfr_count  ,0 prt_count	,0 mfg_count, 0 rtv_count, 0 srt_count   FROM st_grn_hdr a	 WHERE (finalized_yn='N') AND trn_type='GRN' AND facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no IN (SELECT facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no FROM st_grn_dtl WHERE	facility_id=a.facility_id AND doc_type_code=a.doc_type_code	AND	doc_no=a.doc_no	AND	item_code=?) GROUP BY store_code UNION SELECT fm_store_code	store_code,0 adj_count ,0 grn_count	, COUNT(*) iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,0 prt_count ,0 mfg_count, 0 rtv_count, 0 srt_count FROM st_issue_hdr a WHERE (finalized_yn='N') AND trn_type='ISS' AND facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no IN (SELECT facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no FROM st_issue_dtl	WHERE facility_id=a.facility_id	AND	doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP BY	fm_store_code UNION	SELECT fm_store_code store_code,0 adj_count,0 grn_count	,0 iss_count ,COUNT(*) urg_count ,0	ret_count ,0 sal_count ,0 tfr_count	,0 prt_count ,0	mfg_count, 0 rtv_count, 0 srt_count FROM st_issue_hdr a	WHERE (finalized_yn='N') AND trn_type='URG'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_issue_dtl WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY fm_store_code UNION SELECT fm_store_code	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,COUNT(*)	ret_count ,0 sal_count ,0 tfr_count	,0 prt_count ,0	mfg_count, 0 rtv_count, 0 srt_count FROM st_issue_ret_hdr a	WHERE (finalized_yn='N') AND trn_type='RET'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_issue_ret_dtl WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY fm_store_code UNION SELECT store_code,0 adj_count ,0	grn_count ,0 iss_count ,0 urg_count	,0 ret_count , COUNT(*)	sal_count ,0 tfr_count	,0 prt_count ,0	mfg_count, 0 rtv_count, 0 srt_count  FROM	st_sal_hdr a WHERE (finalized_yn='N') AND trn_type='SAL' AND facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no IN (SELECT facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no FROM st_sal_dtl WHERE	facility_id=a.facility_id AND doc_type_code=a.doc_type_code	AND	doc_no=a.doc_no	AND	item_code=?) GROUP BY store_code UNION SELECT fm_store_code	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,COUNT(*)  tfr_count ,0	prt_count ,0 mfg_count, 0 rtv_count, 0 srt_count FROM st_transfer_hdr a	WHERE (finalized_yn='N') AND trn_type='TFR'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_transfer_dtl WHERE	facility_id=a.facility_id AND doc_type_code=a.doc_type_code	AND	doc_no=a.doc_no	AND	item_code=?) GROUP BY fm_store_code	UNION SELECT store_code, 0 adj_count ,0	grn_count ,0 iss_count ,0 urg_count	,0 ret_count ,0	sal_count ,0  tfr_count	,COUNT(*) prt_count	,0 mfg_count, 0 rtv_count, 0 srt_count  FROM st_prod_transfer_hdr a WHERE (finalized_yn='N') AND trn_type='PRT' AND facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no IN (SELECT facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no FROM st_prod_transfer_dtl	WHERE facility_id=a.facility_id	AND	doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP BY	store_code UNION SELECT	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,	0 prt_count, COUNT(*) mfg_count, 0 rtv_count, 0 srt_count FROM ST_MFG_HDR	a WHERE	(finalized_yn='N') AND trn_type='MFG' AND facility_id || '-' ||	doc_type_code || '-' ||	doc_no IN (SELECT facility_id || '-' ||	doc_type_code || '-' ||	doc_no FROM	ST_MFG_DTL WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY store_code UNION SELECT	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,	0 prt_count, 0 mfg_count, COUNT(*) rtv_count, 0 srt_count FROM ST_RTV_HDR	a WHERE	(finalized_yn='N') AND trn_type='RTV' AND facility_id || '-' ||	doc_type_code || '-' ||	doc_no IN (SELECT facility_id || '-' ||	doc_type_code || '-' ||	doc_no FROM	ST_RTV_DTL WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY store_code UNION SELECT	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,	0 prt_count, 0 mfg_count, 0 rtv_count, COUNT(*) srt_count FROM ST_SAL_RET_HDR	a WHERE	(finalized_yn='N') AND trn_type='SRT' AND facility_id || '-' ||	doc_type_code || '-' ||	doc_no IN (SELECT facility_id || '-' ||	doc_type_code || '-' ||	doc_no FROM	ST_SAL_RET_DTL WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY store_code)	 a,	mm_store_lang_vw b WHERE a.store_code=b.store_code AND b.language_id = ? GROUP BY	a.store_code, b.short_desc)	a, st_item_store b, mm_store_lang_vw c WHERE a.store_code=b.store_code AND b.store_code = c.store_code AND b.item_code=? and c.facility_id =? and c.language_id = ? ");
dataMap.put("SQL_ST_STORE_LEVEL_COUNT",	"SELECT	a.store_code, a.short_desc,	b.qty_on_hand, a.adj_count,	a.grn_count,a.iss_count,a.urg_count, a.ret_count, a.sal_count, a.tfr_count,	a.prt_count,a.mfg_count,a.rtv_count, a.srt_count FROM (SELECT a.store_code,	b.short_desc, SUM(a.adj_count) adj_count, SUM(a.grn_count) grn_count, SUM(a.iss_count) iss_count, SUM(a.urg_count) urg_count, SUM(a.ret_count) ret_count, SUM(a.sal_count) sal_count, SUM(a.tfr_count) tfr_count, SUM(a.prt_count) prt_count, SUM(a.mfg_count) mfg_count, SUM(a.rtv_count) rtv_count, SUM(a.srt_count) srt_count FROM	( SELECT store_code, COUNT(*) adj_count, 0 grn_count ,0	iss_count ,0 urg_count ,0 ret_count	, 0	sal_count ,0 tfr_count ,0 prt_count	,0 mfg_count, 0 rtv_count, 0 srt_count  FROM st_adj_hdr a	WHERE (finalized_yn='N') AND trn_type='ADJ'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_adj_dtl WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=? ) GROUP BY store_code UNION SELECT store_code,0 adj_count ,COUNT(*) grn_count ,0	iss_count ,0 urg_count ,0 ret_count	,0 sal_count ,0	tfr_count  ,0 prt_count	,0 mfg_count, 0 rtv_count, 0 srt_count   FROM st_grn_hdr a	 WHERE (finalized_yn='N') AND trn_type='GRN' AND facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no IN (SELECT facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no FROM st_grn_dtl WHERE	facility_id=a.facility_id AND doc_type_code=a.doc_type_code	AND	doc_no=a.doc_no	AND	item_code=?) GROUP BY store_code UNION SELECT fm_store_code	store_code,0 adj_count ,0 grn_count	, COUNT(*) iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,0 prt_count ,0 mfg_count, 0 rtv_count, 0 srt_count FROM st_issue_hdr a WHERE (finalized_yn='N') AND trn_type='ISS' AND facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no IN (SELECT facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no FROM st_issue_dtl	WHERE facility_id=a.facility_id	AND	doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP BY	fm_store_code UNION	SELECT fm_store_code store_code,0 adj_count,0 grn_count	,0 iss_count ,COUNT(*) urg_count ,0	ret_count ,0 sal_count ,0 tfr_count	,0 prt_count ,0	mfg_count, 0 rtv_count, 0 srt_count FROM st_issue_hdr a	WHERE (finalized_yn='N') AND trn_type='URG'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_issue_dtl WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY fm_store_code UNION SELECT fm_store_code	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,COUNT(*)	ret_count ,0 sal_count ,0 tfr_count	,0 prt_count ,0	mfg_count, 0 rtv_count, 0 srt_count FROM st_issue_ret_hdr a	WHERE (finalized_yn='N') AND trn_type='RET'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_issue_ret_dtl WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY fm_store_code UNION SELECT   a.store_code, 0 adj_count, 0 grn_count, 0 iss_count,  0 urg_count, 0 ret_count, COUNT (*) sal_count, 0 tfr_count, 0 prt_count, 0 mfg_count, 0 rtv_count, 0 srt_count FROM st_sal_hdr a, st_sal_dtl b  WHERE (a.finalized_yn = 'N') and a.trn_type = 'SAL' AND a.facility_id = b.facility_id AND a.doc_type_code = b.doc_type_code AND a.doc_no = b.doc_no AND b.item_code = ? GROUP BY a.store_code  UNION SELECT fm_store_code	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,COUNT(*)  tfr_count ,0	prt_count ,0 mfg_count, 0 rtv_count, 0 srt_count FROM st_transfer_hdr a	WHERE (finalized_yn='N') AND trn_type='TFR'	AND	facility_id	|| '-' || doc_type_code	|| '-' || doc_no IN	(SELECT	facility_id	|| '-' || doc_type_code	|| '-' || doc_no FROM st_transfer_dtl WHERE	facility_id=a.facility_id AND doc_type_code=a.doc_type_code	AND	doc_no=a.doc_no	AND	item_code=?) GROUP BY fm_store_code	UNION SELECT store_code, 0 adj_count ,0	grn_count ,0 iss_count ,0 urg_count	,0 ret_count ,0	sal_count ,0  tfr_count	,COUNT(*) prt_count	,0 mfg_count, 0 rtv_count, 0 srt_count  FROM st_prod_transfer_hdr a WHERE (finalized_yn='N') AND trn_type='PRT' AND facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no IN (SELECT facility_id ||	'-'	|| doc_type_code ||	'-'	|| doc_no FROM st_prod_transfer_dtl	WHERE facility_id=a.facility_id	AND	doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP BY	store_code UNION SELECT	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,	0 prt_count, COUNT(*) mfg_count, 0 rtv_count, 0 srt_count FROM ST_MFG_HDR	a WHERE	(finalized_yn='N') AND trn_type='MFG' AND facility_id || '-' ||	doc_type_code || '-' ||	doc_no IN (SELECT facility_id || '-' ||	doc_type_code || '-' ||	doc_no FROM	ST_MFG_DTL WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY store_code UNION SELECT	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,	0 prt_count, 0 mfg_count, COUNT(*) rtv_count, 0 srt_count FROM ST_RTV_HDR	a WHERE	(finalized_yn='N') AND trn_type='RTV' AND facility_id || '-' ||	doc_type_code || '-' ||	doc_no IN (SELECT facility_id || '-' ||	doc_type_code || '-' ||	doc_no FROM	ST_RTV_DTL WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY store_code UNION SELECT	store_code,0 adj_count ,0 grn_count	,0 iss_count ,0	urg_count ,0 ret_count ,0 sal_count	,0 tfr_count  ,	0 prt_count, 0 mfg_count, 0 rtv_count, COUNT(*) srt_count FROM ST_SAL_RET_HDR	a WHERE	(finalized_yn='N') AND trn_type='SRT' AND facility_id || '-' ||	doc_type_code || '-' ||	doc_no IN (SELECT facility_id || '-' ||	doc_type_code || '-' ||	doc_no FROM	ST_SAL_RET_DTL WHERE facility_id=a.facility_id AND doc_type_code=a.doc_type_code AND doc_no=a.doc_no AND item_code=?) GROUP	BY store_code)	 a,	mm_store_lang_vw b WHERE a.store_code=b.store_code AND b.language_id = ? GROUP BY	a.store_code, b.short_desc)	a, st_item_store b, mm_store_lang_vw c WHERE a.store_code=b.store_code AND b.store_code = c.store_code AND b.item_code=? and c.facility_id =? and c.language_id = ? ");
dataMap.put("SQL_ST_ITEM_BATCH_SELECT_MULTIPLE_FOR_CHANGE_EXPIRY", "select a.store_code, store_desc,batch_id,trade_id, trade_name, bin_location_code,to_char(expiry_date,'dd/mm/yyyy') old_exp_rec_dt,qty_on_hand, replace_on_expiry_yn from st_batch_search_lang_view a, mm_store_lang_vw b where a.store_code = b.store_code and a.language_id = b.language_id and item_code=? AND a.language_id=? AND a.lang1(+)=? AND a.lang2(+)=? and b.facility_id = ?");
dataMap.put("SQL_ST_ITEM_UPDATE_FOR_CHANGE_EXPIRY",	"update	st_item	set	expiry_yn=?, MODIFIED_BY_ID=?,MODIFIED_DATE=sysdate,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?	where item_code=?");
dataMap.put("SQL_ST_ITEM_UPDATE_BATCH_ID_FOR_CHANGE_EXPIRY",	"UPDATE	st_item	SET batch_id_applicable_yn=DECODE(expiry_yn,'N',DECODE(batch_id_applicable_yn,'E','N',batch_id_applicable_yn),'Y',DECODE(batch_id_applicable_yn,'N','E',batch_id_applicable_yn),batch_id_applicable_yn),  MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?	WHERE item_code=?");
dataMap.put("SQL_ST_ITEM_BATCH_DELETE_FOR_CHANGE_EXPIRY", "DELETE FROM	st_item_batch WHERE	store_code=? AND item_code=? AND batch_id=?	AND	bin_location_code=?	and	expiry_date_or_receipt_date=to_date(?,'dd/mm/yyyy')");
dataMap.put("SQL_ST_BATCH_CONTROL_UPDATE_FOR_CHANGE_EXPIRY", "UPDATE st_batch_control  SET EXPIRY_DATE_OR_RECEIPT_DATE=nvl(to_date(?,'dd/mm/yyyy'),SYSDATE),modified_by_id=?, modified_date	= SYSDATE, modified_at_ws_no=?,	 modified_facility_id=?	  WHERE	item_code=?	  AND batch_id=?   AND EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy')");
dataMap.put("SQL_ST_ITEM_BATCH_INSERT_FOR_CHANGE_EXPIRY","INSERT into st_item_batch	(store_code, item_code,	batch_id, bin_location_code, expiry_date_or_receipt_date,trade_id, qty_on_hand,	replace_on_expiry_yn,added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date,	modified_at_ws_no, modified_facility_id) VALUES	(?,?,?,?,nvl(to_date(?,'dd/mm/yyyy'),SYSDATE),?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
dataMap.put("SQL_ST_ITEM_EXPIRY_DETAILS" , " select  distinct a.ITEM_CODE,a.EXPIRY_YN from st_item a, st_item_store b, st_batch_control c where a.item_code=b.item_code and a.item_code=c.item_code and a.item_code = ? " );
/*	Change Expiry Flag	till here*/
// Manufacturing Receipts
dataMap.put("SQL_ST_MAN_REQ_STORE_QRY_SELECT","SELECT st.store_code, mm.short_desc FROM	st_user_access_for_store st, mm_store_lang_vw mm, SM_APPL_USER sm WHERE	st.store_code =	mm.store_code  AND st.user_id=sm.appl_user_id AND mm.eff_status	= 'E' AND sm.eff_status='E'	AND	(st.mfg_allowed_yn='Y' OR  st.mfg_finalize_allowed_yn='Y')  AND mm.facility_id = ?	AND	st.user_id = ?	AND mm.language_id = ? ORDER BY 2");
dataMap.put("SQL_ST_MFG_RECEIPT_BIN_LOCATION", "SELECT bin_location_code,short_desc FROM mm_bin_location_lang_vw mm_bin_location WHERE eff_status='E'	AND language_id = ? ORDER BY 2");
dataMap.put("SQL_ST_MFG_RECEIPT_DOC_TYPE", "SELECT a.doc_type_code,	b.short_desc,a.trn_type	FROM st_trn_doc_type a,	sy_doc_type_master b , sy_acc_entity_doc_type c	WHERE a.facility_id=? AND a.doc_type_code =	b.doc_type_code	AND	a.trn_type =?  AND b.status	IS NULL	AND	a.doc_type_code=c.doc_type_code	ORDER BY 2,1");
//dataMap.put("SQL_ST_MFG_RECEIPT_ASMB_HDR", "SELECT base_qty,process_loss_percent FROM st_assembly_hdr WHERE	item_code=?	");


//Added on 22.07.2005 for validating Patient Id length
dataMap.put("SQL_ST_PATIENT_ID_LENGTH", "SELECT PATIENT_ID_LENGTH from MP_PARAM");
//ended

// Modified on 11/30/2004 for getting label type
dataMap.put("SQL_ST_MFG_RECEIPT_ASMB_HDR", "SELECT base_qty,process_loss_percent,label_type FROM st_assembly_hdr WHERE	item_code=?	");

dataMap.put("SQL_ST_MFG_RECEIPT_STOCK_ITEM_YN", "SELECT STOCK_ITEM_YN FROM st_item_store WHERE STORE_CODE=? AND ITEM_CODE=? 	");
//dataMap.put("SQL_ST_MAN_RECEIPT_ASSMBL_DTL_RESULT",	"SELECT f.item_value ,b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,d.short_desc mfg_desc,e.short_desc STOCK_UOM  ,e.UOM_CODE , 'DB' datatype , NVL(f.item_value,0)/DECODE(NVL(f.qty_on_hand,0),0,1,NVL(f.qty_on_hand,0)) unit_cost ,TO_CHAR((NVL(NVL(f.item_value,0)/DECODE(NVL(f.qty_on_hand,0),0,1,NVL(f.qty_on_hand,0)),0)*NVL(b.component_qty,0)),'999999999.99') val,b.MANDATORY_ITEM_YN  MANDATORY_ITEM, (CASE WHEN (c.gen_uom_code=b.mfg_uom_code)  THEN 1 ELSE (CASE WHEN (c.gen_uom_code!=b.mfg_uom_code) THEN  (SELECT eqvl_value FROM am_uom_eqvl WHERE uom_code=c.gen_uom_code AND  eqvl_uom_code=b.mfg_uom_code) END ) END) conv_factor,e.short_desc STOCK_UOM , c.gen_uom_code uom_code,b.component_qty PREP_QTY FROM  st_assembly_hdr a, st_assembly_dtl b,mm_item_lang_vw c, am_uom_lang_vw d ,am_uom_lang_vw e,st_item_store f  WHERE a.item_code=? AND a.item_code=b.assembly_item_code AND  b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+)  AND c.gen_uom_code=e.uom_code(+) AND   b.child_item_code=f.item_code(+) AND f.store_code(+)=?  AND c.language_id = ? AND d.language_id(+) = ? AND e.language_id(+) = ? ORDER BY seq_no");
//Modified by suresh.r on 14-11-2014 against Inc 52256(Added ST_DISPLAY_UNIT_COST for unit_cost and value)
dataMap.put("SQL_ST_MAN_RECEIPT_ASSMBL_DTL_RESULT",	"SELECT f.item_value ,b.child_item_code,c.short_desc ,b.component_qty,b.mfg_uom_code,d.short_desc mfg_desc,e.short_desc STOCK_UOM  ,e.UOM_CODE , 'DB' datatype ,trim(st_display_unit_cost (f.item_code,sysdate,'CURRENT_STOCK')*st_get_uom_conv_fac_sing_str(f.item_code, f.store_code)) unit_cost ,trim(st_display_unit_cost (f.item_code,sysdate,'CURRENT_STOCK')*st_get_uom_conv_fac_sing_str(f.item_code, f.store_code))*NVL(b.component_qty,0) val,b.MANDATORY_ITEM_YN  MANDATORY_ITEM, (CASE WHEN (c.gen_uom_code=b.mfg_uom_code)  THEN 1 ELSE (CASE WHEN (c.gen_uom_code!=b.mfg_uom_code) THEN  (SELECT eqvl_value FROM am_uom_eqvl WHERE uom_code=c.gen_uom_code AND  eqvl_uom_code=b.mfg_uom_code) END ) END) conv_factor,e.short_desc STOCK_UOM , c.gen_uom_code uom_code,b.component_qty PREP_QTY FROM  st_assembly_hdr a, st_assembly_dtl b,mm_item_lang_vw c, am_uom_lang_vw d ,am_uom_lang_vw e,st_item_store f  WHERE a.item_code=? AND a.item_code=b.assembly_item_code AND  b.child_item_code=c.item_code AND  b.mfg_uom_code=d.uom_code(+)  AND c.gen_uom_code=e.uom_code(+) AND   b.child_item_code=f.item_code(+) AND f.store_code(+)=?  AND c.language_id = ? AND d.language_id(+) = ? AND e.language_id(+) = ? ORDER BY seq_no");
//dataMap.put("SQL_ST_MAN_RECEIPT_ASSMBL_TEMP_DTL_RESULT",	"SELECT d.ITEM_CODE,a.CHILD_ITEM_CODE,a.MFG_REQUEST_NO,COMPONENT_QTY,MFG_UOM_CODE,b.short_desc ,c.short_desc mfg_desc,b.unit_cost,TO_CHAR((NVL(b.unit_cost,0)*NVL(component_qty,0)),'999999999.99')val ,'E' MANDATORY_ITEM ,(CASE WHEN (cc.gen_uom_code=b.gen_uom_code)  THEN 1 ELSE(CASE WHEN(cc.gen_uom_code!=b.gen_uom_code) THEN  (SELECT eqvl_value FROM am_uom_eqvl WHERE uom_code=b.gen_uom_code  AND eqvl_uom_code=b.gen_uom_code) END )END)conv_factor,cc.gen_uom_code UOM_CODE   FROM st_mfg_request_dtl a,mm_item b,mm_item cc, am_uom c,st_mfg_request_hdr d  WHERE d.ITEM_CODE LIKE ? AND   a.CHILD_ITEM_CODE=b.item_code AND   a.CHILD_ITEM_CODE=cc.item_code  AND a.MFG_REQUEST_NO=d.MFG_REQUEST_NO  AND a.mfg_uom_code=c.uom_code(+)  ");
//dataMap.put("SQL_ST_MAN_RECEIPT_ASSMBL_TEMP_DTL_RESULT",	"SELECT d.ITEM_CODE,a.CHILD_ITEM_CODE,a.MFG_REQUEST_NO,COMPONENT_QTY,MFG_UOM_CODE,b.short_desc ,c.short_desc mfg_desc, nvl(e.item_value,0)/decode(nvl(e.qty_on_hand,0),0,1,nvl(e.qty_on_hand,0)) unit_cost,TO_CHAR((NVL(nvl(e.item_value,0)/decode(nvl(e.qty_on_hand,0),0,1,nvl(e.qty_on_hand,0)),0)*NVL(component_qty,0)),'999999999.99')val ,'E' MANDATORY_ITEM ,(CASE WHEN (cc.gen_uom_code=b.gen_uom_code)  THEN 1 ELSE(CASE WHEN(cc.gen_uom_code!=b.gen_uom_code) THEN  (SELECT eqvl_value FROM am_uom_eqvl WHERE uom_code=b.gen_uom_code  AND eqvl_uom_code=b.gen_uom_code) END )END)conv_factor,cc.gen_uom_code UOM_CODE,COMPONENT_QTY PREP_QTY  FROM st_mfg_request_dtl a,mm_item b,mm_item cc, am_uom c,st_mfg_request_hdr d, st_item_store e  WHERE d.ITEM_CODE LIKE ? AND a.CHILD_ITEM_CODE=b.item_code AND   a.CHILD_ITEM_CODE=cc.item_code  AND a.MFG_REQUEST_NO=d.MFG_REQUEST_NO  AND a.mfg_uom_code=c.uom_code(+) AND e.store_code=? and e.item_code=a.child_item_code");
//dataMap.put("SQL_ST_MAN_RECEIPT_ASSMBL_TEMP_DTL_RESULT",	"SELECT DISTINCT d.item_code, a.child_item_code, a.mfg_request_no,a.component_qty, a.mfg_uom_code, b.short_desc,       c.short_desc mfg_desc, NVL (e.item_value, 0)/ DECODE (NVL (e.qty_on_hand, 0), 0, 1, NVL (e.qty_on_hand, 0)) unit_cost,       TO_CHAR ((NVL (NVL (e.item_value, 0) / DECODE (NVL (e.qty_on_hand, 0),  0, 1, NVL (e.qty_on_hand, 0)),                      0) * NVL (a.component_qty, 0)),'999999999.99') val, 'E' mandatory_item,(CASE WHEN (cc.gen_uom_code = b.gen_uom_code) THEN 1   ELSE (CASE   WHEN (cc.gen_uom_code != b.gen_uom_code) THEN (SELECT eqvl_value  FROM am_uom_eqvl    WHERE uom_code = b.gen_uom_code AND eqvl_uom_code =b.gen_uom_code)  END)  END) conv_factor, cc.gen_uom_code uom_code,  b.gen_uom_code uom_code,   a.component_qty prep_qty,  c.short_desc stock_uom FROM ST_MFG_REQUEST_DTL a, mm_item_lang_vw b, mm_item cc,       am_uom_lang_vw c, ST_MFG_REQUEST_HDR d, ST_ITEM_STORE e WHERE d.item_code LIKE ?  AND a.child_item_code = b.item_code   AND a.child_item_code = cc.item_code  AND a.mfg_request_no = d.mfg_request_no  AND a.mfg_uom_code = c.uom_code(+)   AND e.store_code = ?   AND e.item_code = a.child_item_code   AND b.gen_uom_code = c.uom_code    AND b.language_id = ?   AND c.language_id(+) = ?");
//Modified by suresh.r on 14-11-2014 against Inc 52256(Added ST_DISPLAY_UNIT_COST for unit_cost and value)
dataMap.put("SQL_ST_MAN_RECEIPT_ASSMBL_TEMP_DTL_RESULT",	"SELECT DISTINCT d.item_code, a.child_item_code, a.mfg_request_no,a.component_qty, a.mfg_uom_code, b.short_desc,       c.short_desc mfg_desc, trim(st_display_unit_cost (e.item_code,sysdate,'CURRENT_STOCK')*st_get_uom_conv_fac_sing_str(e.item_code, e.store_code)) unit_cost,       trim(st_display_unit_cost (e.item_code,sysdate,'CURRENT_STOCK')*st_get_uom_conv_fac_sing_str(e.item_code, e.store_code)) * NVL (a.component_qty, 0) val, 'E' mandatory_item,(CASE WHEN (cc.gen_uom_code = b.gen_uom_code) THEN 1   ELSE (CASE   WHEN (cc.gen_uom_code != b.gen_uom_code) THEN (SELECT eqvl_value  FROM am_uom_eqvl    WHERE uom_code = b.gen_uom_code AND eqvl_uom_code =b.gen_uom_code)  END)  END) conv_factor, cc.gen_uom_code uom_code,  b.gen_uom_code uom_code,   a.component_qty prep_qty,  c.short_desc stock_uom FROM ST_MFG_REQUEST_DTL a, mm_item_lang_vw b, mm_item cc,       am_uom_lang_vw c, ST_MFG_REQUEST_HDR d, ST_ITEM_STORE e WHERE d.item_code LIKE ?  AND a.child_item_code = b.item_code   AND a.child_item_code = cc.item_code  AND a.mfg_request_no = d.mfg_request_no  AND a.mfg_uom_code = c.uom_code(+)   AND e.store_code = ?   AND e.item_code = a.child_item_code   AND b.gen_uom_code = c.uom_code    AND b.language_id = ?   AND c.language_id(+) = ?");

dataMap.put("SQL_ST_MAN_RECEIPT_HDR_INSERT", "INSERT INTO st_mfg_hdr (facility_id ,	doc_type_code  , doc_no	 , doc_date	,	doc_ref	 , store_code ,	item_code ,	item_qty ,	  expiry_date,batch_id	, bin_location_code, finalized_yn ,	 gl_interfaced_yn, trn_type	,stock_item_yn,	preparation_type  ,      preparation_mode	,  prepare_location_code,  patient_id ,	encounter_id, mfg_item_unit_cost, prepare_desc , process_loss_percent, prepare_qty , added_by_id , added_date ,	added_at_ws_no,	added_facility_id, modified_by_id ,	modified_date ,	modified_at_ws_no, modified_facility_id,MFG_REQUEST_NO,trade_id) values (?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,? ,?,?)	");
dataMap.put("SQL_ST_MAN_RECEIPT_DTL_INSERT", "INSERT INTO st_mfg_dtl (facility_id  , doc_type_code , doc_no	, doc_srl_no, child_item_code, child_item_qty  , item_unit_cost	 , stock_item_yn  ,mfg_uom_code	, child_item_trans_qty,mfg_cost_value ,added_by_id	,added_date	, added_at_ws_no, added_facility_id,modified_by_id , modified_date , modified_at_ws_no,modified_facility_id			  )values (?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?)");
dataMap.put("SQL_ST_MAN_RECEIPT_EXP_INSERT", "INSERT INTO st_mfg_dtl_exp ( FACILITY_ID , DOC_TYPE_CODE , DOC_NO , DOC_SRL_NO , STORE_CODE , ITEM_CODE , BATCH_ID , BIN_LOCATION_CODE , EXPIRY_DATE_OR_RECEIPT_DATE, TRADE_ID  , ITEM_QTY                       ,added_by_id	,added_date	, added_at_ws_no, added_facility_id,modified_by_id , modified_date , modified_at_ws_no,modified_facility_id			  )values (?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,sysdate,?,?,?,sysdate,?,?)");
dataMap.put("SQL_ST_MAN_RECEIPT_STATUS_UPDATE", "UPDATE st_mfg_request_hdr SET REQUEST_STATUS='C' WHERE mfg_request_no=? ");
//added on 11/01/05
dataMap.put("SQL_ST_MAN_RECEIPT_STATUS_UPDATE", "UPDATE st_mfg_request_hdr SET REQUEST_STATUS='C' WHERE mfg_request_no=? ");

dataMap.put("SQL_ST_MAN_RECEIPT_TRADE_DETAILS",	"select	mm.trade_id, am.short_name from	mm_trade_name_for_item mm, am_trade_name_lang_vw am	where mm.trade_id=am.trade_id AND am.language_id = ?");

//dataMap.put("SQL_ST_MAN_RECEIPT_HDR_QUERY",	"SELECT a.DOC_TYPE_CODE,a.DOC_NO,a.STORE_CODE,a.ITEM_CODE,a.ITEM_QTY,a.PREPARE_LOCATION_CODE,PROCESS_LOSS_PERCENT,BATCH_ID,TO_CHAR(EXPIRY_DATE,'dd/mm/yyyy')EXPIRY_DATE,BIN_LOCATION_CODE,TRADE_ID,b.*,c.SHORT_DESC LOC_DESC,d.unit_cost,d.short_desc itemdesc, nvl(e.expiry_yn,'N')expiry_yn,a.PREPARE_QTY,d.GEN_UOM_CODE uom_code  FROM st_mfg_hdr  a, st_mfg_request_hdr b,mm_item d ,st_prepare_location c,st_item e WHERE a.mfg_request_no=b.mfg_request_no  AND a.FINALIZED_YN ='N'  AND a.PREPARE_LOCATION_CODE=c.PREPARE_LOCATION_CODE(+) AND a.ITEM_CODE=d.ITEM_CODE(+) AND a.STORE_CODE like ?  AND a.DOC_TYPE_CODE like ? AND a.ITEM_CODE=e.ITEM_CODE(+)  AND   a.DOC_NO like ?  order by a.mfg_request_no ");

//Added by Rabbani #Inc no:29950(Bru-HIMS-CRF-084) on 18-FEB-2013  
//dataMap.put("SQL_ST_MAN_RECEIPT_HDR_QUERY",	"SELECT   a.doc_type_code, a.doc_no, a.store_code, a.item_code, a.item_qty, a.prepare_location_code, process_loss_percent, batch_id, TO_CHAR (expiry_date, 'dd/mm/yyyy') expiry_date, bin_location_code, trade_id, b.*, c.short_desc loc_desc, d.unit_cost, d.short_desc itemdesc, NVL (e.expiry_yn, 'N') expiry_yn, a.prepare_qty, d.gen_uom_code uom_code, a.remarks, a.packed_by, a.counter_checked_by,a.barcode_id,a.no_of_labels  FROM ST_MFG_HDR a, ST_MFG_REQUEST_HDR b, mm_item_lang_vw d,          st_prepare_location_lang_vw c, ST_ITEM e, mm_store_lang_vw mmvw WHERE a.mfg_request_no = b.mfg_request_no AND a.finalized_yn = 'N' AND a.prepare_location_code = c.prepare_location_code(+) AND a.item_code = d.item_code(+) AND a.store_code LIKE ? AND a.doc_type_code LIKE ? AND a.item_code = e.item_code(+) AND a.doc_no LIKE ? AND d.language_id = ? AND c.language_id(+) = ? 	 AND d.language_id = mmvw.language_id AND a.store_code = mmvw.store_code  AND mmvw.facility_id =? ORDER BY a.mfg_request_no");

//Added by Rabbani #Inc no:38409 on 07-MAR-2013  
dataMap.put("SQL_ST_MAN_RECEIPT_HDR_QUERY",	"SELECT   a.doc_type_code, a.doc_no, a.store_code, a.item_code, a.item_qty, a.prepare_location_code, process_loss_percent, batch_id, TO_CHAR (expiry_date, 'dd/mm/yyyy') expiry_date, bin_location_code, trade_id, b.*, c.short_desc loc_desc, d.unit_cost, d.short_desc itemdesc, NVL (e.expiry_yn, 'N') expiry_yn, a.prepare_qty, d.gen_uom_code uom_code, a.remarks, a.packed_by, a.counter_checked_by,a.barcode_id,a.no_of_labels  FROM ST_MFG_HDR a, ST_MFG_REQUEST_HDR b, mm_item_lang_vw d,          st_prepare_location_lang_vw c, ST_ITEM e, mm_store_lang_vw mmvw WHERE a.mfg_request_no = b.mfg_request_no AND a.finalized_yn = 'N' AND a.prepare_location_code = c.prepare_location_code(+) AND a.item_code = d.item_code(+) AND a.store_code LIKE ? AND a.doc_type_code LIKE ? AND a.item_code = e.item_code(+) AND a.doc_no LIKE ? AND d.language_id(+) = ? AND c.language_id(+) = ? AND mmvw.language_id(+) = ? 	AND a.store_code = mmvw.store_code  AND mmvw.facility_id =? ORDER BY a.mfg_request_no");


//Added by Rabbani #Inc no:29950(Bru-HIMS-CRF-084) on 18-FEB-2013  
dataMap.put("SQL_ST_MAN_RECEIPT_HDR_QUERY_DIRECT_MFG",	"SELECT   TO_CHAR(expiry_date, 'dd/mm/yyyy')expiry_date,  a.store_code requesting_store_code, a.*, c.short_desc loc_desc, d.unit_cost, d.short_desc itemdesc, NVL (e.expiry_yn, 'N') expiry_yn,  d.gen_uom_code uom_code,a.ITEM_QTY REQUEST_QTY, a.doc_no,a.doc_date  FROM ST_MFG_HDR a,  mm_item_lang_vw d,   st_prepare_location_lang_vw c, ST_ITEM e, mm_store_lang_vw mmvw WHERE a.finalized_yn = 'N' AND a.prepare_location_code = c.prepare_location_code(+) AND a.item_code = d.item_code(+) AND a.store_code LIKE ? AND a.doc_type_code LIKE ? AND a.item_code = e.item_code(+) AND a.doc_no LIKE ? AND d.language_id(+) = ? AND c.language_id(+) = ? AND   mmvw.language_id  = ? AND a.store_code = mmvw.store_code  AND mmvw.facility_id =?  and a.MFG_REQUEST_NO IS NULL ORDER BY a.doc_no,a.doc_date");

// modified on 11/01/2005 to select the trans qty -- sri.
//dataMap.put("SQL_ST_MAN_RECEIPT_DTL_QUERY","SELECT a.DOC_TYPE_CODE,a.DOC_NO,a.CHILD_ITEM_CODE,a.CHILD_ITEM_QTY COMPONENT_QTY,ITEM_UNIT_COST UNIT_COST,b.short_desc ,a.DOC_SRL_NO  ,'Y' MANDATORY_ITEM ,b.GEN_UOM_CODE uom_code  FROM st_mfg_dtl a,mm_item b,st_mfg_hdr d  WHERE  a.FACILITY_ID=d.FACILITY_ID AND a.DOC_TYPE_CODE=d.DOC_TYPE_CODE AND a.DOC_NO=d.DOC_NO AND a.CHILD_ITEM_CODE=b.item_code AND  preparation_type = 'E'	UNION SELECT a.DOC_TYPE_CODE,a.DOC_NO,a.CHILD_ITEM_CODE,a.CHILD_ITEM_QTY COMPONENT_QTY,ITEM_UNIT_COST UNIT_COST,b.short_desc ,a.DOC_SRL_NO  ,MANDATORY_ITEM_YN MANDATORY_ITEM,b.GEN_UOM_CODE uom_code  FROM st_mfg_dtl a,mm_item b ,st_assembly_dtl c ,st_mfg_hdr d  WHERE  a.FACILITY_ID=d.FACILITY_ID AND a.DOC_TYPE_CODE=d.DOC_TYPE_CODE AND a.DOC_NO=d.DOC_NO  AND a.CHILD_ITEM_CODE=b.item_code  AND a.CHILD_ITEM_CODE=c.CHILD_ITEM_CODE  AND d.ITEM_CODE=c.ASSEMBLY_ITEM_CODE AND preparation_type <> 'E' AND  a.FACILITY_ID=? ");
// modified on 04/03/2005 to select the UOM DESC -- sri.
//dataMap.put("SQL_ST_MAN_RECEIPT_DTL_QUERY","SELECT a.DOC_TYPE_CODE,a.DOC_NO,a.CHILD_ITEM_CODE,a.CHILD_ITEM_QTY COMPONENT_QTY,a.CHILD_ITEM_TRANS_QTY TRANS_QTY,ITEM_UNIT_COST UNIT_COST,b.short_desc ,a.DOC_SRL_NO  ,'Y' MANDATORY_ITEM ,b.GEN_UOM_CODE uom_code  FROM st_mfg_dtl a,mm_item b,st_mfg_hdr d  WHERE  a.FACILITY_ID=d.FACILITY_ID AND a.DOC_TYPE_CODE=d.DOC_TYPE_CODE AND a.DOC_NO=d.DOC_NO AND a.CHILD_ITEM_CODE=b.item_code AND  preparation_type = 'E'	UNION SELECT a.DOC_TYPE_CODE,a.DOC_NO,a.CHILD_ITEM_CODE,a.CHILD_ITEM_QTY COMPONENT_QTY,a.CHILD_ITEM_TRANS_QTY TRANS_QTY,ITEM_UNIT_COST UNIT_COST,b.short_desc ,a.DOC_SRL_NO  ,MANDATORY_ITEM_YN MANDATORY_ITEM,b.GEN_UOM_CODE uom_code  FROM st_mfg_dtl a,mm_item b ,st_assembly_dtl c ,st_mfg_hdr d  WHERE  a.FACILITY_ID=d.FACILITY_ID AND a.DOC_TYPE_CODE=d.DOC_TYPE_CODE AND a.DOC_NO=d.DOC_NO  AND a.CHILD_ITEM_CODE=b.item_code  AND a.CHILD_ITEM_CODE=c.CHILD_ITEM_CODE  AND d.ITEM_CODE=c.ASSEMBLY_ITEM_CODE AND preparation_type <> 'E' AND  a.FACILITY_ID=? ");
dataMap.put("SQL_ST_MAN_RECEIPT_DTL_QUERY","SELECT a.DOC_TYPE_CODE,a.DOC_NO,a.CHILD_ITEM_CODE,a.CHILD_ITEM_QTY COMPONENT_QTY,a.CHILD_ITEM_TRANS_QTY TRANS_QTY, ROUND(DECODE(f.qty_on_hand, 0, 0,f.ITEM_VALUE)/ DECODE(f.qty_on_hand,0,1,f.qty_on_hand), 3)unit_cost,  b.short_desc ,a.DOC_SRL_NO  ,'Y' MANDATORY_ITEM ,b.GEN_UOM_CODE uom_code, e.short_desc STOCK_UOM  FROM st_mfg_dtl a,mm_item_lang_vw b,st_mfg_hdr d , AM_UOM_LANG_VW e,st_item_store f  WHERE  a.FACILITY_ID=d.FACILITY_ID  AND a.DOC_TYPE_CODE=d.DOC_TYPE_CODE AND a.DOC_NO=d.DOC_NO AND a.CHILD_ITEM_CODE=b.item_code  AND  preparation_type = 'E'	AND e.uom_code=b.gen_uom_code AND f.item_code = b.item_code AND f.store_code = d.store_code AND b.language_id = e.language_id AND b.language_id = ? UNION SELECT a.DOC_TYPE_CODE,a.DOC_NO,a.CHILD_ITEM_CODE,a.CHILD_ITEM_QTY COMPONENT_QTY,a.CHILD_ITEM_TRANS_QTY TRANS_QTY, ROUND(DECODE(f.qty_on_hand, 0, 0,f.ITEM_VALUE)/ DECODE(f.qty_on_hand,0,1,f.qty_on_hand), 3)unit_cost, b.short_desc ,a.DOC_SRL_NO  ,MANDATORY_ITEM_YN MANDATORY_ITEM,b.GEN_UOM_CODE uom_code ,  e.short_desc STOCK_UOM  FROM st_mfg_dtl a,mm_item_lang_vw b ,st_assembly_dtl c ,st_mfg_hdr d , AM_UOM_LANG_VW e, st_item_store f WHERE  a.FACILITY_ID=d.FACILITY_ID AND a.DOC_TYPE_CODE=d.DOC_TYPE_CODE  AND a.DOC_NO=d.DOC_NO  AND a.CHILD_ITEM_CODE=b.item_code  AND a.CHILD_ITEM_CODE=c.CHILD_ITEM_CODE  AND d.ITEM_CODE=c.ASSEMBLY_ITEM_CODE AND preparation_type <> 'E' AND  a.FACILITY_ID= ?	AND e.uom_code=b.gen_uom_code AND f.item_code = b.item_code AND f.store_code = d.store_code AND b.language_id = e.language_id AND b.language_id = ?");

dataMap.put("SQL_ST_MAN_RECEIPT_EXP_QUERY","SELECT batchview.trade_id, batchview.qty_on_hand, batchview.use_after_expiry_yn,	batchview.expiry_yn, batchview.avail_qty, batchview.trade_id_applicable_yn,	batchview.manufacturer_id, stexp.ITEM_QTY QTY,stexp.ITEM_CODE,stexp.DOC_TYPE_CODE,stexp.DOC_NO,DOC_SRL_NO, batchview.store_desc, batchview.trade_name, batchview.nod, batchview.item_desc, batchview.manufacturer_name,	 batchview.store_code, batchview.suspended_yn, batchview.item_code,	batchview.bin_location_code, TO_CHAR(batchview.expiry_date,'dd/mm/yyyy') expiry_date, batchview.bin_desc, batchview.batch_id,BATCH_STATUS FROM st_batch_search_lang_view batchview, ST_MFG_DTL_EXP stexp WHERE batchview.store_code=stexp.store_code AND batchview.item_code=stexp.item_code AND batchview.batch_id=stexp.batch_id AND batchview.bin_location_code=stexp.bin_location_code AND batchview.expiry_date=stexp.expiry_date_or_receipt_date   AND stexp.FACILITY_ID=? AND batchview.language_id = ? AND batchview.lang1 = ? AND batchview.lang2 = ?");

//added on 19/11/04
dataMap.put("SQL_ST_MAN_RECEIPT_BATCH_GEN","SELECT AUTO_GEN_BATCH_YN, NEXT_BATCH_ID, BATCH_ID_SERIES FROM ST_PREPARE_LOCATION WHERE PREPARE_LOCATION_CODE = ?");
//dataMap.put("SQL_ST_MAN_RECEIPT_BATCH_GEN","select ITEM_CODE from ST_MFG_REQUEST_HDR where MFG_REQUEST_NO=?");

// Sales
//SALES	TRANSACTION
dataMap.put("SQL_ST_SAL_STORE_SELECT", "SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st, st_store ststr, st_acc_entity_param stpa WHERE	mm.store_code=st.store_code	AND mm.store_code = ststr.store_code AND	mm.eff_status='E' AND st.sal_allowed_yn='Y'	AND ststr.sal_allowed_yn='Y' AND	mm.facility_id = ? AND st.user_id=? AND mm.language_id = ? ORDER	BY 2");

dataMap.put("SQL_ST_OT_SAL_STORE_SELECT", "SELECT ST.STORE_CODE, MM.SHORT_DESC FROM MM_STORE_LANG_VW MM,ST_USER_ACCESS_FOR_STORE ST,ST_STORE STSTR,ST_ACC_ENTITY_PARAM STPA WHERE MM.STORE_CODE = ST.STORE_CODE AND MM.STORE_CODE = STSTR.STORE_CODE AND MM.EFF_STATUS = 'E' AND ST.SAL_ALLOWED_YN = 'Y' AND STSTR.SAL_ALLOWED_YN = 'Y' AND MM.FACILITY_ID LIKE DECODE( TRN_ACROSS_FACILITY_YN, 'Y','%',?) AND ST.USER_ID = ? AND MM.LANGUAGE_ID = ? ORDER BY 2");

dataMap.put("SQL_ST_STK_ITEM_CON_STORE_SELECT", "SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st,st_store ststr, st_acc_entity_param stpa WHERE	mm.store_code=st.store_code	AND mm.store_code = ststr.store_code AND mm.eff_status='E' AND st.STK_ITEM_CON_ALLOWED_YN='Y' AND ststr.STK_ITEM_CON_ALLOWED_YN='Y' AND	mm.facility_id LIKE DECODE( TRN_ACROSS_FACILITY_YN, 'Y','%',?) AND st.user_id=? AND mm.language_id = ? ORDER	BY 2 ");

dataMap.put("SQL_QRY_ST_SAL_STORE_SELECT", "SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st WHERE	mm.store_code=st.store_code	AND	mm.eff_status='E' AND (st.sal_allowed_yn='Y' OR sal_authorize_allowed_yn='Y')	AND	mm.facility_id=? AND st.user_id=? AND mm.language_id= ? ORDER	BY 2");
dataMap.put("SQL_ST_SAL_HDR_SELECT_SINGLE",	"SELECT	TO_CHAR(doc_date,'dd/mm/yyyy') doc_date, doc_ref, store_code, st.patient_id, encounter_id, sal_trn_type, DECODE(SAL_TRN_TYPE,'X', st.PATIENT_NAME, mp.patient_name)patient_name , item_class_code,BILLABLE_TRN_YN,TAKE_HOME_YN FROM ST_SAL_HDR st, mp_patient	mp WHERE mp.patient_id=st.patient_id AND facility_id=? AND doc_type_code=? AND doc_no=?");
dataMap.put("SQL_ST_SAL_DTL_SELECT_MULTIPLE", "SELECT  dtl.doc_no, dtl.item_code, mmitem.short_desc item_desc, stitem.expiry_yn expiry_yn, dtl.doc_srl_no, dtl.remarks, dtl.stock_item_yn, item_qty, SUM (avail_qty)/* + item_qty*/ stock_available, ROUND ((  DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand)),3) unit_cost, ROUND (  (  DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand))* item_qty,3) item_sal_value, pat_net_amt, pat_gross_charge_amt,ststr.def_issue_uom uom_code, (SELECT short_desc FROM am_uom WHERE uom_code =  ststr.def_issue_uom)uom_desc FROM st_sal_dtl dtl, mm_item_lang_vw mmitem, st_item stitem, st_batch_search_lang_view bsview, st_item_store ststr WHERE mmitem.item_code = dtl.item_code AND stitem.item_code = dtl.item_code AND dtl.item_code = ststr.item_code AND bsview.store_code = ststr.store_code  AND dtl.item_code = bsview.item_code(+) AND dtl.facility_id = ? AND dtl.doc_type_code = ? AND dtl.doc_no = ? AND (dtl.stock_item_yn = 'N' OR bsview.store_code = ?) AND mmitem.language_id = bsview.language_id AND mmitem.language_id = ?  AND bsview.lang1 = ?  AND bsview.lang2 = ? GROUP BY dtl.doc_no, dtl.item_code, mmitem.short_desc, stitem.expiry_yn, dtl.doc_srl_no, dtl.remarks, dtl.stock_item_yn, item_qty, ROUND ((  DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand)),3), ROUND (  (  DECODE (ststr.qty_on_hand, 0, 0, ststr.item_value)/ DECODE (ststr.qty_on_hand, 0, 1, ststr.qty_on_hand))* item_qty, 3), pat_net_amt, pat_gross_charge_amt,ststr.def_issue_uom ");
// Modified on 06/12/2004 
dataMap.put("SQL_ST_SAL_DTL_EXP_SELECT_MULTIPLE", "SELECT batchview.trade_id, batchview.qty_on_hand, batchview.use_after_expiry_yn,	batchview.expiry_yn expiry_yn, (batchview.avail_qty+stexp.sal_item_qty)avail_qty, batchview.trade_id_applicable_yn,	batchview.manufacturer_id, stexp.sal_item_qty qty, batchview.store_desc, batchview.trade_name, batchview.nod nod, batchview.item_desc, batchview.manufacturer_name,	 batchview.store_code, batchview.suspended_yn, batchview.item_code,	batchview.bin_location_code, TO_CHAR(batchview.expiry_date,'dd/mm/yyyy') expiry_date, batchview.bin_desc, batchview.batch_id,batchview.batch_status batch_status FROM st_batch_search_lang_view batchview, ST_SAL_DTL_EXP stexp WHERE batchview.store_code=stexp.store_code AND batchview.item_code=stexp.item_code AND batchview.batch_id=stexp.batch_id AND batchview.bin_location_code=stexp.bin_location_code AND batchview.expiry_date=stexp.expiry_date_or_receipt_date AND stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND batchview.language_id = ? AND batchview.lang1 = ? AND batchview.lang2 = ? AND stexp.doc_srl_no=?");
dataMap.put("SQL_ST_SAL_DTL_SELECT_MAX_DOC_SRL_NO",	"SELECT	MAX(doc_srl_no)	max_doc_srl_no FROM	st_sal_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
dataMap.put("SQL_ST_SAL_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.store_code,  fms.short_desc fm_store_desc, hdr.patient_id	FROM st_sal_hdr hdr, mm_store_lang_vw fms, sy_doc_type_master_lang_vw	sy,	st_user_access_for_store uaca  /*, st_acc_entity_param pa*/ WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.store_code=	fms.store_code	AND	uaca.store_code	= hdr.store_code	AND hdr.finalized_yn='N' AND hdr.module_id='ST' AND	uaca.sal_allowed_yn	= 'Y' AND hdr.doc_type_code LIKE ?	AND	TO_CHAR(hdr.doc_no)	LIKE  ?	AND	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') LIKE ?	AND	hdr.store_code LIKE ? AND  NVL(hdr.item_class_code,'X')	LIKE ? AND uaca.user_id	= ? AND hdr.facility_id=? AND sy.language_id = fms.language_id AND sy.language_id = ?");
dataMap.put("SQL_ST_SAL_CHARGEABLE_YN" , "SELECT BL_INTERFACE_YN FROM ST_ACC_ENTITY_PARAM");
/*Function specific	SQL	ends*/


//Goods Receipt Note 

dataMap.put("SQL_SY_FOREIGN_CURRENCY_SELECT_LIST","SELECT currency_code, short_desc FROM sy_foreign_currency_lang_vw WHERE language_id = ? ORDER BY 2");
dataMap.put("SQL_AP_SUPPLIER_SELECT_LIST","SELECT supp_code, short_name FROM ap_supplier_lang_vw WHERE status IS NULL AND language_id = ? ORDER BY short_name");
dataMap.put("SQL_AP_SUPPLIER_SELECT_LIST_WT_LANG","SELECT supp_code, short_name FROM ap_supplier_lang_vw ap_supplier WHERE status IS NULL AND language_id LIKE ? ORDER BY short_name");
dataMap.put("SQL_ST_GRN_STORE_SELECT", "SELECT   st.store_code, mm.short_desc FROM mm_store_lang_vw mm, st_user_access_for_store st, st_store ststr WHERE mm.store_code = st.store_code AND mm.store_code = ststr.store_code AND mm.eff_status = 'E' AND NVL(st.grn_allowed_yn,'N') = 'Y' AND NVL(ststr.GRN_ALLOWED_YN,'N') = 'Y' AND mm.facility_id LIKE (?) AND st.user_id = ? AND language_id = ? order BY 2 ");

dataMap.put("SQL_QRY_ST_GRN_STORE_SELECT", "SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st, st_store ststr WHERE	mm.store_code=st.store_code	AND mm.store_code = ststr.store_code  AND	mm.eff_status='E' AND (st.grn_allowed_yn='Y' OR grn_finalize_allowed_yn='Y') AND ststr.GRN_ALLOWED_YN = 'Y'	AND	mm.facility_id =? AND st.user_id=? AND mm.language_id = ? ORDER	BY 2 ");

dataMap.put("SQL_ST_AM_UOM_SELECT_FOR_GRN",	"SELECT	uom_code,short_desc	FROM am_uom_lang_vw am_uom	WHERE eff_status='E' and pur_uom_yn='Y' AND language_id = ? order by short_desc");
dataMap.put("SQL_ST_ITEM_STORE_SELECT_FOR_GRN","SELECT stock_item_yn, bin_location_code FROM st_item_store WHERE item_code = ? AND store_code = ?");
dataMap.put("SQL_ST_ITEM_SELECT_FOR_GRN","SELECT batch_id_applicable_yn, trade_id_applicable_yn, expiry_yn FROM st_item WHERE item_code = ?");
dataMap.put("SQL_ST_ITEM_BATCH_FOR_GRN",	"UPDATE st_item_batch SET committed_qty = nvl(committed_qty,0) + ?, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id= ? WHERE store_code=? AND  item_code=? AND batch_id=? AND bin_location_code=? AND TRUNC(expiry_date_or_receipt_date)=TO_DATE(?,'dd/mm/yyyy')");
dataMap.put("SQL_ST_ITEM_MOVE_SUMM_INSERT_FOR_GRN",	"INSERT INTO st_item_move_summ( facility_id, item_code, store_code, move_year, move_month, grn_qty, grn_cost, month_closing_qty, month_closing_value, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
dataMap.put("SQL_ST_ITEM_MOVE_SUMM_UPDATE_FOR_GRN", "UPDATE st_item_move_summ SET grn_qty=NVL(grn_qty,0)+?, grn_cost=NVL(grn_cost,0)+?, month_closing_qty=NVL(month_closing_qty,0)+?, month_closing_value=NVL(month_closing_value,0)+?, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id=? AND item_code=? AND store_code=? AND move_year=? AND move_month=?");
//dataMap.put("SQL_MM_ITEM_UPDATE_FOR_GRN", "UPDATE mm_item SET curr_supp_code=?, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE  item_code=?");
// Modified on 4/18/2005 to update the last_receipt_date
dataMap.put("SQL_MM_ITEM_UPDATE_FOR_GRN", "UPDATE mm_item SET curr_supp_code=?, last_receipt_date=SYSDATE,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE  item_code=?");
//dataMap.put("SQL_ST_ITEM_LAST_COST_SELECT_FOR_GRN","SELECT  LAST_GRN_COST  FROM st_item_store WHERE  store_code =? and item_code = ? ");
dataMap.put("SQL_ST_ITEM_LAST_COST_SELECT_FOR_GRN","select ST_GET_WAC_OR_UNIT_COST(?,?) LAST_GRN_COST from dual ");//Added forPMG2023-COMN-CRF-0039-US002 and PMG2023-COMN-CRF-0039-US003
// Added on 4/20/2005 by Ram to update  the last_pur_cost only for GRN
dataMap.put("SQL_MM_ITEM_UPDATE_FOR_GRN_LAST_PUR_COST", "UPDATE mm_item SET  last_pur_cost = ? WHERE  item_code=?");
dataMap.put("SQL_ST_ITEM_STORE_UPDATE_FOR_GRN_LAST_PUR_COST", "UPDATE st_item_store SET  LAST_GRN_COST = ? WHERE store_code =? and item_code = ? ");

dataMap.put("SQL_ST_ITEM_TRN_DTL_INSERT_FOR_GRN",	"INSERT INTO st_item_trn_dtl(facility_id, store_code, item_code, posted_date, trn_srl_no, trn_type, doc_type_code, doc_no, doc_srl_no, doc_date, doc_ref, batch_id, expiry_date, item_qty_normal, item_qty_bonus, item_qty_sample, item_unit_cost, item_unit_price, stk_uom_code, supp_code, stock_item_yn, bin_location_code, trade_id, po_no, pur_uom_code, pur_uom_conv, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, TO_DATE(?,'dd/mm/yyyy'), nvl(?,0), nvl(?,0), nvl(?,0), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
//dataMap.put("SQL_ST_GRN_HDR_INSERT",	"INSERT INTO st_grn_hdr ( facility_id, doc_type_code, doc_no, doc_date, doc_ref, store_code, finalized_yn, gl_interfaced_yn, trn_type, supp_code, currency_code, entry_completed_yn,  receipt_date, po_no, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? , ?  )");
//Added on 2/27/2006 by Janet
  //dataMap.put("SQL_ST_GRN_HDR_INSERT",	"INSERT INTO st_grn_hdr ( facility_id, doc_type_code, doc_no, doc_date, doc_ref, store_code, item_class_code, finalized_yn, gl_interfaced_yn, trn_type, supp_code, currency_code, entry_completed_yn,  receipt_date , remarks_code , po_no, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,conversion_rate) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? , ? ,? )");
  dataMap.put("SQL_ST_GRN_HDR_INSERT",	"INSERT INTO st_grn_hdr ( facility_id, doc_type_code, doc_no, doc_date, doc_ref, store_code, item_class_code, finalized_yn, gl_interfaced_yn, trn_type, supp_code, currency_code, entry_completed_yn,  receipt_date , remarks_code , po_no, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,conversion_rate,do_no,invoice_no,invoice_recd_by,grn_mode,REMARKS_DESC) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? , ? ,? ,?, ?, ?, ? , ? )");//added REMARKS_DESC for MO-CRF-20165 

dataMap.put("SQL_ST_GRN_DTL_INSERT",	"INSERT INTO st_grn_dtl ( facility_id, doc_type_code, doc_no, doc_srl_no, item_code, item_qty_normal, item_qty_bonus, item_qty_sample, item_cost_value, stock_item_yn, label_reqd_yn, grn_unit_cost_in_pur_uom, pur_uom_code, pur_uom_conv, replace_on_expiry_yn, grn_unit_cost_in_stk_uom, no_of_labels, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,po_cost,po_discount,po_tax, MANUFACTURER_ID , REMARKS_DESC,CATALOG_CODE, MANUFAC_REMARKS_DESC) VALUES  ( ? , ? , ? , ? , ? , ? , ?, ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? , ? , ? , ? , ?, ? , ? ,?, ? )");//modified for MO-CRF-20165 , added MANUFAC_REMARKS_DESC for MO-CRF-20178  
// Modified on 2/4/2005 please use this query  if GRN has Remarks field
// dataMap.put("SQL_ST_GRN_DTL_INSERT",	"INSERT INTO st_grn_dtl ( facility_id, doc_type_code, doc_no, doc_srl_no, item_code, item_qty_normal, item_qty_bonus, item_qty_sample, item_cost_value, stock_item_yn, label_reqd_yn, grn_unit_cost_in_pur_uom, pur_uom_code, pur_uom_conv, replace_on_expiry_yn, grn_unit_cost_in_stk_uom, no_of_labels,remarks, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES  ( ? , ? , ? , ? , ? , ? , ?, ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ?,? , SYSDATE , ? , ? , ? , SYSDATE , ? , ?  )");
// End of 2/4/2005
//dataMap.put("SQL_ST_GRN_DTL_EXP_INSERT","INSERT INTO st_grn_dtl_exp ( facility_id, doc_type_code, doc_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, trade_id, grn_item_qty, rtv_item_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,sale_price ) VALUES ( ? , ? , ? , ? , ? , ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? , ?,?  )");
//added barcodeid
//MO-CRF-20171 Start.
//dataMap.put("SQL_ST_GRN_DTL_EXP_INSERT","INSERT INTO st_grn_dtl_exp ( facility_id, doc_type_code, doc_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, trade_id, grn_item_qty, rtv_item_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,sale_price ,barcode_id,MANUFACTURED_DATE) VALUES ( ? , ? , ? , ? , ? , ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? ,?,?,? , TO_DATE(?,'dd/mm/yyyy')  )");//modified for MO-CRF-20165 
dataMap.put("SQL_ST_GRN_DTL_EXP_INSERT","INSERT INTO st_grn_dtl_exp ( facility_id, doc_type_code, doc_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, trade_id, grn_item_qty, rtv_item_qty, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,sale_price ,barcode_id,MANUFACTURED_DATE,IMAGE_REF) VALUES ( ? , ? , ? , ? , ? , ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? ,?,?,? , TO_DATE(?,'dd/mm/yyyy'),?  )");//modified for MO-CRF-20165 
//MO-CRF-20171 End.
dataMap.put("SQL_ST_ITEM_MOVE_SUMM_SELECT_COUNT",	"SELECT  COUNT(*) total FROM st_item_move_summ WHERE facility_id = ?  AND item_code = ?  AND store_code = ?  AND move_year = ?  AND move_month = ?");
dataMap.put("SQL_ST_GRN_DTL_SELECT_MAX_DOC_SRL_NO",	"SELECT	MAX(doc_srl_no)	max_doc_srl_no FROM	st_grn_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
//dataMap.put("SQL_ST_GRN_HDR_SELECT_SINGLE",	"SELECT	TO_CHAR(doc_date,'dd/mm/yyyy') doc_date, doc_ref, store_code, finalized_yn, gl_interfaced_yn, trn_type, supp_code, currency_code, entry_completed_yn, TO_CHAR(receipt_date,'dd/mm/yyyy') receipt_date, po_no FROM st_grn_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
//Added on 2/27/2006
//dataMap.put("SQL_ST_GRN_HDR_SELECT_SINGLE",	"SELECT	TO_CHAR(doc_date,'dd/mm/yyyy') doc_date, doc_ref, store_code, item_class_code, finalized_yn, gl_interfaced_yn, trn_type, supp_code, currency_code, entry_completed_yn, TO_CHAR(receipt_date,'dd/mm/yyyy') receipt_date, po_no , remarks_code,conversion_rate FROM st_grn_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
dataMap.put("SQL_ST_GRN_HDR_SELECT_SINGLE",	"SELECT	TO_CHAR(doc_date,'dd/mm/yyyy') doc_date, doc_ref, store_code, item_class_code, finalized_yn, gl_interfaced_yn, trn_type, supp_code, currency_code, entry_completed_yn, TO_CHAR(receipt_date,'dd/mm/yyyy') receipt_date, po_no , remarks_code,conversion_rate,do_no,invoice_no,invoice_recd_by,grn_mode,REMARKS_DESC FROM st_grn_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?");

dataMap.put("SQL_ST_GRN_DTL_SELECT_MULTIPLE", "SELECT DTL.DOC_SRL_NO, DTL.ITEM_CODE, MMITEM.SHORT_DESC ITEM_DESC,DTL.ITEM_QTY_NORMAL, DTL.ITEM_QTY_BONUS, DTL.ITEM_QTY_SAMPLE,DTL.ITEM_COST_VALUE, DTL.STOCK_ITEM_YN, DTL.LABEL_REQD_YN,DTL.GRN_UNIT_COST_IN_PUR_UOM, DTL.PUR_UOM_CODE, DTL.PUR_UOM_CONV,DTL.REPLACE_ON_EXPIRY_YN, DTL.GRN_UNIT_COST_IN_STK_UOM,AM.SHORT_DESC GEN_UOM_DESC, AM.UOM_CODE, STITEM.EXPIRY_YN,DTL.NO_OF_LABELS,AM1.SHORT_DESC UOM_DESC,DTL.PO_COST,DTL.PO_DISCOUNT,DTL.PO_TAX FROM ST_GRN_HDR HDR,ST_GRN_DTL DTL,MM_ITEM_LANG_VW MMITEM,ST_ITEM STITEM,AM_UOM_LANG_VW AM,AM_UOM_LANG_VW AM1,ST_ITEM_STORE ST WHERE MMITEM.ITEM_CODE = DTL.ITEM_CODE AND STITEM.ITEM_CODE = DTL.ITEM_CODE AND MMITEM.GEN_UOM_CODE = AM.UOM_CODE AND DTL.FACILITY_ID = ? AND DTL.DOC_TYPE_CODE = ? AND DTL.DOC_NO = ? AND MMITEM.LANGUAGE_ID = AM.LANGUAGE_ID AND MMITEM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = AM1.LANGUAGE_ID AND AM1.UOM_CODE = ST.DEF_ISSUE_UOM AND ST.ITEM_CODE = DTL.ITEM_CODE AND ST.STORE_CODE = HDR.STORE_CODE AND DTL.FACILITY_ID = HDR.FACILITY_ID AND DTL.DOC_NO = HDR.DOC_NO AND DTL.DOC_TYPE_CODE = HDR.DOC_TYPE_CODE");
//MO-CRF-20171 Start.
//dataMap.put("SQL_ST_GRN_DTL_EXP_SELECT_MULTIPLE", "select grn_item_qty, trade_id, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, item_code, store_code, batch_id, bin_location_code,sale_price,barcode_id,  TO_CHAR(MANUFACTURED_DATE,'dd/mm/yyyy') MANUFACTURED_DATE from st_grn_dtl_exp stexp WHERE stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND stexp.doc_srl_no=?");//Modified for MO-CRF-20165 
dataMap.put("SQL_ST_GRN_DTL_EXP_SELECT_MULTIPLE", "select grn_item_qty, trade_id, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, item_code, store_code, batch_id, bin_location_code,sale_price,barcode_id,  TO_CHAR(MANUFACTURED_DATE,'dd/mm/yyyy') MANUFACTURED_DATE,IMAGE_REF from st_grn_dtl_exp stexp WHERE stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND stexp.doc_srl_no=?");
//MO-CRF-20171 End.
//dataMap.put("SQL_ST_GRN_HDR_QUERY_RESULT",	"SELECT HDR.DOC_TYPE_CODE, SY.SHORT_DESC DOC_TYPE_DESC,HDR.DOC_NO, TO_CHAR(HDR.DOC_DATE,'DD/MM/YYYY')	DOC_DATE, HDR.STORE_CODE,  FMS.SHORT_DESC STORE_DESC, APS.SHORT_NAME SUPP_DESC FROM ST_GRN_HDR HDR, MM_STORE_LANG_VW FMS, SY_DOC_TYPE_MASTER_LANG_VW	SY,	ST_USER_ACCESS_FOR_STORE UACA, AP_SUPPLIER_LANG_VW APS WHERE HDR.DOC_TYPE_CODE = SY.DOC_TYPE_CODE	AND	HDR.STORE_CODE=	FMS.STORE_CODE	AND	UACA.STORE_CODE	= HDR.STORE_CODE	AND HDR.FINALIZED_YN='N' AND UACA.GRN_ALLOWED_YN	= 'Y' AND HDR.DOC_TYPE_CODE LIKE ?	AND	TO_CHAR(HDR.DOC_NO)	LIKE  ?	AND	TO_CHAR(HDR.DOC_DATE,'DD/MM/YYYY') LIKE ?	AND	HDR.STORE_CODE LIKE ? AND UACA.USER_ID	= ? AND HDR.FACILITY_ID=? AND HDR.ENTRY_COMPLETED_YN LIKE ? AND HDR.SUPP_CODE LIKE ? AND HDR.SUPP_CODE=APS.SUPP_CODE AND SY.LANGUAGE_ID = APS.LANGUAGE_ID AND SY.LANGUAGE_ID = FMS.LANGUAGE_ID AND FMS.LANGUAGE_ID = ?");

dataMap.put("SQL_ST_GRN_HDR_QUERY_RESULT",	"SELECT HDR.DOC_TYPE_CODE, SY.SHORT_DESC DOC_TYPE_DESC,HDR.DOC_NO, TO_CHAR(HDR.DOC_DATE,'DD/MM/YYYY')	DOC_DATE, HDR.STORE_CODE,  FMS.SHORT_DESC STORE_DESC, APS.SHORT_NAME SUPP_DESC FROM ST_GRN_HDR HDR, MM_STORE_LANG_VW FMS, SY_DOC_TYPE_MASTER_LANG_VW	SY,	ST_USER_ACCESS_FOR_STORE UACA, AP_SUPPLIER_LANG_VW APS WHERE HDR.DOC_TYPE_CODE = SY.DOC_TYPE_CODE	AND	HDR.STORE_CODE=	FMS.STORE_CODE	AND	UACA.STORE_CODE	= HDR.STORE_CODE	AND HDR.FINALIZED_YN='N' AND UACA.GRN_ALLOWED_YN	= 'Y' AND HDR.DOC_TYPE_CODE LIKE ?	AND	TO_CHAR(HDR.DOC_NO)	LIKE  ?	AND	/*TO_CHAR(HDR.DOC_DATE,'DD/MM/YYYY') LIKE ?*/ TO_DATE (TO_CHAR (hdr.doc_date, 'dd/mm/yyyy'), 'dd/mm/yyyy')  BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy')	AND	HDR.STORE_CODE LIKE ? AND UACA.USER_ID	= ? AND HDR.FACILITY_ID=? AND HDR.ENTRY_COMPLETED_YN LIKE ? AND HDR.SUPP_CODE LIKE ? AND HDR.SUPP_CODE=APS.SUPP_CODE AND SY.LANGUAGE_ID = APS.LANGUAGE_ID AND SY.LANGUAGE_ID = FMS.LANGUAGE_ID AND FMS.LANGUAGE_ID = ?");

dataMap.put("SQL_ST_GRN_DTL_EXP_DELETE_ALL",	"DELETE FROM st_grn_dtl_exp WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
dataMap.put("SQL_ST_GRN_DTL_DELETE_ALL",	"DELETE FROM st_grn_dtl WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
dataMap.put("SQL_ST_GRN_HDR_DELETE",	"DELETE FROM st_grn_hdr WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
//dataMap.put("SQL_ST_GRN_HDR_UPDATE",	"UPDATE st_grn_hdr SET doc_date = TO_DATE(?,'dd/mm/yyyy') , doc_ref = ? , store_code = ? , finalized_yn= ? , gl_interfaced_yn = ? , trn_type = ? , supp_code= ? , currency_code= ? , entry_completed_yn= ? , receipt_date= TO_DATE(?, 'dd/mm/yyyy'), po_no=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ? WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
//Added on 2/27/2006 by Janet
//dataMap.put("SQL_ST_GRN_HDR_UPDATE",	"UPDATE st_grn_hdr SET doc_date = TO_DATE(?,'dd/mm/yyyy') , doc_ref = ? , store_code = ? , item_class_code = ?, finalized_yn= ? , gl_interfaced_yn = ? , trn_type = ? , supp_code= ? , currency_code= ? , entry_completed_yn= ? , receipt_date= TO_DATE(?, 'dd/mm/yyyy'), remarks_code=?, po_no=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ? , CONVERSION_RATE = ?  WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
 
dataMap.put("SQL_ST_GRN_HDR_UPDATE",	"UPDATE st_grn_hdr SET doc_date = TO_DATE(?,'dd/mm/yyyy') , doc_ref = ? , store_code = ? , item_class_code = ?, finalized_yn= ? , gl_interfaced_yn = ? , trn_type = ? , supp_code= ? , currency_code= ? , entry_completed_yn= ? , receipt_date= TO_DATE(?, 'dd/mm/yyyy'), remarks_code=?, po_no=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ? , CONVERSION_RATE = ?  , DO_NO = ? , INVOICE_NO = ? , INVOICE_RECD_BY = ?, REMARKS_DESC = ? WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");//MODIFIED FOR MO-CRF-20165 

dataMap.put("SQL_ST_GRN_DTL_UPDATE",	"UPDATE st_grn_dtl SET item_code = ? , item_qty_normal = ? ,item_qty_bonus= ? ,item_qty_sample= ? , item_cost_value= ? , stock_item_yn = ? , label_reqd_yn=?, grn_unit_cost_in_pur_uom=?, pur_uom_code=?, pur_uom_conv=?,  replace_on_expiry_yn=?, grn_unit_cost_in_stk_uom=?, no_of_labels=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ?  ,po_cost = ? , po_discount = ? ,po_tax = ? , MANUFACTURER_ID = ? , REMARKS_DESC = ?, CATALOG_CODE = ?, MANUFAC_REMARKS_DESC = ?  WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");//MODIFIED FOR MO-CRF-20165. added MANUFAC_REMARKS_DESC for MO-CRF-20178  
// Modified on 2/4/2005  please use this query  if Replacement GRN has Remarks field
//dataMap.put("SQL_ST_GRN_DTL_UPDATE",	"UPDATE st_grn_dtl SET item_code = ? , item_qty_normal = ? ,item_qty_bonus= ? ,item_qty_sample= ? , item_cost_value= ? , stock_item_yn = ? , label_reqd_yn=?, grn_unit_cost_in_pur_uom=?, pur_uom_code=?, pur_uom_conv=?,  replace_on_expiry_yn=?, grn_unit_cost_in_stk_uom=?, no_of_labels=?, remarks =?,modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ?  WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");
//dataMap.put("SQL_ST_GRN_DTL_SELECT_MULTIPLE", "SELECT dtl.doc_srl_no, dtl.item_code, mmitem.short_desc item_desc, dtl.item_qty_normal, dtl.item_qty_bonus, dtl.item_qty_sample, dtl.item_cost_value, dtl.stock_item_yn, dtl.label_reqd_yn, dtl.grn_unit_cost_in_pur_uom, dtl.pur_uom_code, dtl.pur_uom_conv, dtl.replace_on_expiry_yn, dtl.grn_unit_cost_in_stk_uom, am.short_desc uom_desc, am.uom_code ,stitem.expiry_yn, dtl.no_of_labels ,dtl.remarks FROM st_grn_dtl dtl, mm_item mmitem, st_item stitem, am_uom am  WHERE	mmitem.item_code=dtl.item_code AND stitem.item_code=dtl.item_code AND mmitem.gen_uom_code=am.uom_code AND dtl.facility_id=? AND dtl.doc_type_code=? AND	dtl.doc_no=?");
// End of 2/4/2005
dataMap.put("SQL_ST_GRN_DTL_DELETE",	"DELETE FROM st_grn_dtl WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ? AND doc_srl_no = ?");
dataMap.put("SQL_ST_GRN_DTL_EXP_DELETE",	"DELETE FROM st_grn_dtl_exp WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");
dataMap.put("SQL_ST_GRN_ITEM_BATCH_STATUS","select BATCH_STATUS from ST_BATCH_CONTROL where EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy')  and BATCH_ID=? and ITEM_CODE=?");

//Goods Return To Vendor

dataMap.put("SQL_ST_RTV_STORE_SELECT", "	 SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st , st_store ststr, st_acc_entity_param stpa WHERE	mm.store_code=st.store_code	AND mm.store_code = ststr.store_code AND	mm.eff_status='E' AND NVL(st.rtv_allowed_yn,'N') = 'Y'	AND NVL(ststr.RTV_ALLOWED_YN,'N') = 'Y' AND	mm.facility_id LIKE DECODE( TRN_ACROSS_FACILITY_YN, 'Y','%',?) AND st.user_id=? AND mm.language_id= ? ORDER	BY 2 ");

//dataMap.put("SQL_ST_RTV_BATCH_SEARCH_QUERY","SELECT grnexp.item_code, sbv.item_desc, grnexp.batch_id, grnexp.bin_location_code bin_location_code,  mmb.short_desc bin_location_desc, TO_CHAR(grnexp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, grnexp.trade_id, sbv.trade_name, grnexp.grn_item_qty, NVL(grnexp.rtv_item_qty,0) rtv_item_qty, grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0) ret_qty,grndtl.pur_uom_conv, grndtl.pur_uom_code, least(sbv.avail_qty/grndtl.pur_uom_conv,grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0)) avail_qty, grnexp.doc_type_code grn_doc_type_code, grnexp.doc_no grn_doc_no, grndtl.grn_unit_cost_in_pur_uom,grnhdr.po_no, grnexp.doc_srl_no grn_doc_srl_no, to_char(grnhdr.doc_date,'dd/mm/yyyy') grn_doc_date FROM st_grn_dtl_exp grnexp, st_grn_hdr grnhdr, st_grn_dtl grndtl, st_batch_search_view sbv, mm_bin_location mmb WHERE grnexp.facility_id = ? AND grnexp.doc_type_code LIKE ? AND grnexp.doc_no LIKE ? AND nvl(grnhdr.po_no,-1) like ? AND grnhdr.supp_code LIKE ?  AND (grnexp.facility_id = grnhdr.facility_id AND grnexp.doc_type_code = grnhdr.doc_type_code AND grnexp.doc_no = grnhdr.doc_no) AND (grndtl.facility_id = grndtl.facility_id AND grndtl.doc_type_code = grnhdr.doc_type_code AND grndtl.doc_no = grnhdr.doc_no AND grndtl.doc_srl_no = grnexp.doc_srl_no) AND grnhdr.finalized_yn='Y' AND grnhdr.store_code=? AND (grnexp.grn_item_qty-grnexp.rtv_item_qty) > 0 AND (grnhdr.store_code=sbv.store_code AND grnexp.item_code=sbv.item_code AND grnexp.batch_id=sbv.batch_id AND grnexp.bin_location_code=sbv.bin_location_code AND grnexp.expiry_date_or_receipt_date=sbv.expiry_date ) AND (grnhdr.store_code=mmb.store_code AND grnexp.bin_location_code=mmb.bin_location_code) AND grnexp.item_code= ?");
//For Bin location change BY PANKAJ ON 29/06
//dataMap.put("SQL_ST_RTV_BATCH_SEARCH_QUERY","SELECT grnexp.item_code, sbv.item_desc, grnexp.batch_id, grnexp.bin_location_code prev_bin_location_code,sbv.expiry_yn expiry_yn,TO_CHAR(sbv.expiry_date,'dd/mm/yyyy') expiry_date, sbv.bin_location_code bin_location_code,  mmb.short_desc bin_location_desc, TO_CHAR(grnexp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, grnexp.trade_id, sbv.trade_name, grnexp.grn_item_qty, NVL(grnexp.rtv_item_qty,0) rtv_item_qty, grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0) ret_qty,grndtl.pur_uom_conv, grndtl.pur_uom_code, LEAST(sbv.avail_qty/grndtl.pur_uom_conv,grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0)) avail_qty, grnexp.doc_type_code grn_doc_type_code, grnexp.doc_no grn_doc_no, grndtl.grn_unit_cost_in_pur_uom,grnhdr.po_no, grnexp.doc_srl_no grn_doc_srl_no, TO_CHAR(grnhdr.doc_date,'dd/mm/yyyy') grn_doc_date FROM st_grn_dtl_exp grnexp, st_grn_hdr grnhdr, st_grn_dtl grndtl, st_batch_search_view sbv, mm_bin_location mmb WHERE grnexp.facility_id = ? AND grnexp.doc_type_code LIKE ? AND grnexp.doc_no LIKE ? AND NVL(grnhdr.po_no,-1) LIKE ? AND grnhdr.supp_code LIKE ?  AND (grnexp.facility_id = grnhdr.facility_id AND grnexp.doc_type_code = grnhdr.doc_type_code AND grnexp.doc_no = grnhdr.doc_no) AND (grndtl.facility_id = grndtl.facility_id AND grndtl.doc_type_code = grnhdr.doc_type_code AND grndtl.doc_no = grnhdr.doc_no AND grndtl.doc_srl_no = grnexp.doc_srl_no) AND grnhdr.finalized_yn='Y' AND grnhdr.store_code= ? AND (grnexp.grn_item_qty-grnexp.rtv_item_qty) > 0 AND (grnhdr.store_code=sbv.store_code AND grnexp.item_code=sbv.item_code AND grnexp.batch_id=sbv.batch_id /* AND grnexp.bin_location_code=sbv.bin_location_code */ AND grnexp.expiry_date_or_receipt_date=sbv.expiry_date ) AND (grnhdr.store_code=mmb.store_code AND sbv.bin_location_code=mmb.bin_location_code) AND grnexp.item_code= ? ORDER BY grnhdr.added_date ");
//Added on 20.05.2005
dataMap.put("SQL_ST_RTV_BATCH_SEARCH_QUERY","SELECT grnexp.item_code, sbv.item_desc, grnexp.batch_id, grnexp.bin_location_code prev_bin_location_code,sbv.expiry_yn expiry_yn,TO_CHAR(sbv.expiry_date,'dd/mm/yyyy') expiry_date, sbv.bin_location_code bin_location_code,  mmb.short_desc bin_location_desc, TO_CHAR(grnexp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, grnexp.trade_id, sbv.trade_name, grnexp.grn_item_qty, NVL(grnexp.rtv_item_qty,0) rtv_item_qty, grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0) ret_qty,grndtl.pur_uom_conv, grndtl.pur_uom_code, LEAST(sbv.avail_qty/grndtl.pur_uom_conv,grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0)) + ST_COMM_QTY_FOR_DOCNO (?, ?,?,  ?,grnhdr.store_code, sbv.bin_location_code, grnexp.batch_id, grnexp.expiry_date_or_receipt_date,grnexp.item_code) avail_qty, grnexp.doc_type_code grn_doc_type_code, grnexp.doc_no grn_doc_no, grndtl.grn_unit_cost_in_pur_uom,grnhdr.po_no, grnexp.doc_srl_no grn_doc_srl_no, TO_CHAR(grnhdr.doc_date,'dd/mm/yyyy') grn_doc_date, a.short_desc FROM st_grn_dtl_exp grnexp, st_grn_hdr grnhdr, st_grn_dtl grndtl, st_batch_search_lang_view sbv, mm_bin_location_lang_vw mmb, am_uom a WHERE grnexp.facility_id = ? AND grnexp.doc_type_code LIKE ? AND grnexp.doc_no LIKE ? AND NVL(grnhdr.po_no,-1) LIKE ? AND grnhdr.supp_code LIKE ?  AND (grnexp.facility_id = grnhdr.facility_id AND grnexp.doc_type_code = grnhdr.doc_type_code AND grnexp.doc_no = grnhdr.doc_no) AND (grndtl.facility_id = grndtl.facility_id AND grndtl.doc_type_code = grnhdr.doc_type_code AND grndtl.doc_no = grnhdr.doc_no AND grndtl.doc_srl_no = grnexp.doc_srl_no) AND grnhdr.finalized_yn='Y' AND grnhdr.store_code= ? AND (grnexp.grn_item_qty-grnexp.rtv_item_qty) > 0 AND (grnhdr.store_code=sbv.store_code AND grnexp.item_code=sbv.item_code AND grnexp.batch_id=sbv.batch_id  AND grnexp.bin_location_code=sbv.bin_location_code  AND grnexp.expiry_date_or_receipt_date=sbv.expiry_date ) AND (grnhdr.store_code=mmb.store_code AND sbv.bin_location_code=mmb.bin_location_code) AND grnexp.item_code= ? AND sbv.language_id = mmb.language_id AND sbv.language_id = ? AND DECODE(sbv.lang1,NULL,?,sbv.lang1) = ? AND DECODE(sbv.lang2,NULL,?,sbv.lang2) = ? and a.uom_code = grndtl.pur_uom_code ORDER BY grnhdr.added_date");

dataMap.put("SQL_ST_EXPYN_SELECT","SELECT expiry_yn from st_item where item_code=?");

//dataMap.put("SQL_ST_RTV_MAX_RETURNABLE_SELECT","SELECT SUM(item_qty_normal-NVL(rtv_item_qty_normal,0)) max_returnable_normal, SUM(NVL(item_qty_bonus,0)-NVL(rtv_item_qty_bonus,0)) max_returnable_bonus FROM ST_GRN_HDR grnhdr, ST_GRN_DTL grndtl WHERE grnhdr.facility_id=grndtl.facility_id AND grnhdr.doc_type_code=grndtl.doc_type_code AND grnhdr.doc_no=grndtl.doc_no AND grnhdr.finalized_yn='Y' AND grnhdr.facility_id=? AND grndtl.item_code=? AND grnhdr.supp_code=? and grnhdr.store_code=?");

//Added by Sakti against HSA-SCF-0016 [IN:047999] max_returnable_qty need to show as base uom qty. item_qty_normal multiplied with PUR_UOM_CONV  
dataMap.put("SQL_ST_RTV_MAX_RETURNABLE_SELECT","SELECT SUM ((item_qty_normal*PUR_UOM_CONV) - (NVL (rtv_item_qty_normal, 0)*PUR_UOM_CONV)) max_returnable_normal, SUM ((NVL (item_qty_bonus, 0)*PUR_UOM_CONV) - (NVL (rtv_item_qty_bonus, 0)*PUR_UOM_CONV)) max_returnable_bonus FROM ST_GRN_HDR grnhdr, ST_GRN_DTL grndtl WHERE grnhdr.facility_id=grndtl.facility_id AND grnhdr.doc_type_code=grndtl.doc_type_code AND grnhdr.doc_no=grndtl.doc_no AND grnhdr.finalized_yn='Y' AND grnhdr.facility_id=? AND grndtl.item_code=? AND grnhdr.supp_code=? and grnhdr.store_code=?");

dataMap.put("SQL_QRY_ST_RTV_STORE_SELECT",	"SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st, st_store ststr, st_acc_entity_param stpa WHERE	mm.store_code=st.store_code	AND mm.store_code = ststr.store_code AND mm.eff_status='E' AND (st.rtv_allowed_yn='Y' OR rtv_finalize_allowed_yn='Y') AND ststr.RTV_ALLOWED_YN = 'Y'	AND	mm.facility_id=? AND st.user_id=? AND mm.language_id=? ORDER BY 2 ");

dataMap.put("SQL_ST_ITEM_BATCH_FOR_RTV",	"UPDATE st_item_batch SET committed_qty = nvl(committed_qty,0) + ?, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id= ? WHERE store_code=? AND  item_code=? AND batch_id=? AND bin_location_code=? AND TRUNC(expiry_date_or_receipt_date)=TO_DATE(?,'dd/mm/yyyy')");
dataMap.put("SQL_ST_ITEM_MOVE_SUMM_INSERT_FOR_RTV",	"INSERT INTO st_item_move_summ( facility_id, item_code, store_code, move_year, move_month, rtv_qty, rtv_cost, month_closing_qty, month_closing_value, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
dataMap.put("SQL_ST_ITEM_MOVE_SUMM_UPDATE_FOR_RTV", "UPDATE st_item_move_summ SET rtv_qty=NVL(rtv_qty,0)+?, rtv_cost=NVL(rtv_cost,0)+?, month_closing_qty=NVL(month_closing_qty,0)+?, month_closing_value=NVL(month_closing_value,0)+?, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id=? AND item_code=? AND store_code=? AND move_year=? AND move_month=?");
dataMap.put("SQL_ST_ITEM_TRN_DTL_INSERT_FOR_RTV",	"INSERT INTO st_item_trn_dtl(facility_id, store_code, item_code, posted_date, trn_srl_no, trn_type, doc_type_code, doc_no, doc_srl_no, doc_date, doc_ref, batch_id, expiry_date, item_qty_normal, item_qty_bonus, item_qty_sample, item_unit_cost, item_unit_price, stk_uom_code, supp_code, stock_item_yn, bin_location_code, trade_id, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id, pur_uom_code, pur_uom_conv,source_doc_type_code,source_doc_no,source_doc_srl_no,source_doc_date) VALUES (?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, TO_DATE(?,'dd/mm/yyyy'), ?, ?, TO_DATE(?,'dd/mm/yyyy'), nvl(?,0), nvl(?,0), nvl(?,0), ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ?, ?,?,?,?,TO_DATE(?,'dd/mm/yyyy')) ");

dataMap.put("SQL_ST_RTV_HDR_INSERT",	"INSERT INTO st_rtv_hdr ( facility_id, doc_type_code, doc_no, doc_date, doc_ref, store_code, supp_code, finalized_yn, gl_interfaced_yn, trn_type, entry_completed_yn, item_class_code, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,rtv_for_replacement_yn) VALUES  ( ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ? , ? , ?, ?, ?, SYSDATE , ? , ? , ? , SYSDATE , ? , ? ,? )");
dataMap.put("SQL_ST_RTV_DTL_INSERT",	"INSERT INTO st_rtv_dtl ( facility_id, doc_type_code, doc_no, doc_srl_no, item_code, item_qty_normal, item_qty_bonus, item_qty_sample, item_cost_value, stock_item_yn, rtv_unit_cost, remarks, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,rtv_repl_qty,pend_repl_qty) VALUES  ( ? , ? , ? , ? , ? , ?, ? , ? , ? , ? , ? , ? , ?, SYSDATE , ? , ? , ? , SYSDATE , ? , ? ,?,? )");

dataMap.put("SQL_ST_RTV_DTL_EXP_INSERT","INSERT INTO st_rtv_dtl_exp ( facility_id, doc_type_code, doc_no, doc_srl_no, store_code, item_code, batch_id, bin_location_code, expiry_date_or_receipt_date, trade_id, item_qty, grn_doc_type_code, grn_doc_no,  added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id ) VALUES ( ? , ? , ? , ? , ? , ? , ? , ? , TO_DATE(?,'dd/mm/yyyy') , ? , ? , ? , ? , ?, SYSDATE , ? , ? , ? , SYSDATE , ? , ?  )");
dataMap.put("SQL_ST_RTV_DTL_SELECT_MAX_DOC_SRL_NO",	"SELECT	MAX(doc_srl_no)	max_doc_srl_no FROM	st_rtv_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
dataMap.put("SQL_ST_RTV_HDR_SELECT_SINGLE",	"SELECT	TO_CHAR(doc_date,'dd/mm/yyyy') doc_date, doc_ref, store_code, finalized_yn, gl_interfaced_yn, trn_type, supp_code,  entry_completed_yn, item_class_code,rtv_for_replacement_yn FROM st_rtv_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?");
//dataMap.put("SQL_ST_RTV_DTL_SELECT_MULTIPLE", "SELECT dtl.doc_srl_no, dtl.item_code, mmitem.short_desc item_desc, dtl.item_qty_normal, dtl.item_qty_bonus, dtl.item_qty_sample, dtl.item_cost_value, dtl.stock_item_yn, dtl.rtv_unit_cost, am.short_desc uom_desc, am.uom_code FROM st_rtv_dtl dtl, mm_item mmitem, st_item stitem, am_uom am WHERE	mmitem.item_code=dtl.item_code AND stitem.item_code=dtl.item_code AND mmitem.gen_uom_code=am.uom_code AND dtl.facility_id=? AND dtl.doc_type_code=? AND	dtl.doc_no=?");
dataMap.put("SQL_ST_RTV_DTL_SELECT_MULTIPLE", "SELECT dtl.doc_srl_no, dtl.item_code, mmitem.short_desc item_desc, dtl.item_qty_normal, dtl.item_qty_bonus, dtl.item_qty_sample, dtl.item_cost_value, dtl.stock_item_yn, dtl.rtv_unit_cost, am.short_desc gen_uom_desc, am.uom_code, dtl.remarks, DECODE(dtl.item_code,NULL,0, (SELECT SUM(item_qty_normal-NVL(rtv_item_qty_normal,0))+NVL(dtl.item_qty_normal,0) max_returnable_normal FROM st_grn_hdr grnhdr, st_grn_dtl grndtl WHERE grnhdr.facility_id=grndtl.facility_id AND grnhdr.doc_type_code=grndtl.doc_type_code AND grnhdr.doc_no=grndtl.doc_no AND grnhdr.finalized_yn='Y' AND grnhdr.facility_id=dtl.facility_id AND grndtl.item_code=dtl.item_code AND grnhdr.supp_code=?)) max_item_qty_normal, DECODE(dtl.item_code,NULL,0, (SELECT SUM(NVL(item_qty_bonus,0)-NVL(rtv_item_qty_bonus,0)) max_item_qty_bonus FROM st_grn_hdr grnhdr, st_grn_dtl grndtl WHERE grnhdr.facility_id=grndtl.facility_id AND grnhdr.doc_type_code=grndtl.doc_type_code AND grnhdr.doc_no=grndtl.doc_no AND grnhdr.finalized_yn='Y' AND grnhdr.facility_id=dtl.facility_id AND grndtl.item_code=dtl.item_code AND grnhdr.supp_code=?))+NVL(dtl.item_qty_bonus,0) max_item_qty_bonus, am1.short_desc uom_desc  /*,(SELECT pur_uom_conv FROM ST_GRN_DTL grndtl WHERE (facility_id, doc_type_code, doc_no, item_code) IN (SELECT facility_id, grn_doc_type_code, grn_doc_no, item_code FROM ST_RTV_DTL_EXP rtvexp WHERE rtvexp.facility_id=dtl.facility_id AND rtvexp.doc_type_code=dtl.doc_type_code AND rtvexp.doc_no=dtl.doc_no AND rtvexp.item_code=dtl.item_code)) pur_uom_conv */FROM st_rtv_dtl dtl, mm_item_lang_vw mmitem, st_item stitem, am_uom_lang_vw am, ST_ITEM_STORE stst, ST_RTV_HDR hdr, am_uom_lang_vw am1 WHERE mmitem.item_code=dtl.item_code AND stitem.item_code=dtl.item_code AND mmitem.gen_uom_code=am.uom_code AND dtl.facility_id=? AND dtl.doc_type_code=? AND dtl.doc_no= ? AND mmitem.language_id = am.language_id AND am.language_id = ?   AND am1.language_id = am.language_id   AND stst.item_code = stitem.item_code   AND hdr.store_code = stst.store_code    AND hdr.doc_no = dtl.DOC_NO    AND hdr.doc_type_code = dtl.doc_type_code  AND am1.uom_code = stst.def_issue_uom order by doc_srl_no");

//dataMap.put("SQL_ST_RTV_DTL_EXP_SELECT_MULTIPLE", "select item_qty, trade_id, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, item_code, store_code, batch_id, bin_location_code from st_rtv_dtl_exp stexp WHERE stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND stexp.doc_srl_no=?");
//dataMap.put("SQL_ST_RTV_DTL_EXP_SELECT_MULTIPLE", "SELECT rtvexp.item_code, sbv.item_desc, rtvexp.batch_id, rtvexp.bin_location_code bin_location_code, sbv.bin_desc bin_location_desc, TO_CHAR(rtvexp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, rtvexp.trade_id, sbv.trade_name, grnexp.grn_item_qty, rtvexp.item_qty rtv_item_qty, grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0) ret_qty, grndtl.pur_uom_conv, grndtl.pur_uom_code, rtvexp.item_qty+LEAST(sbv.avail_qty/grndtl.pur_uom_conv,grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0)) avail_qty, rtvexp.grn_doc_type_code, rtvexp.grn_doc_no, grndtl.grn_unit_cost_in_pur_uom FROM st_rtv_dtl_exp rtvexp, st_grn_dtl_exp grnexp, st_grn_dtl grndtl, st_batch_search_view sbv WHERE (rtvexp.facility_id = grnexp.facility_id AND rtvexp.grn_doc_type_code = grnexp.doc_type_code AND rtvexp.grn_doc_no = grnexp.doc_no AND rtvexp.store_code = grnexp.store_code AND rtvexp.item_code = grnexp.item_code AND rtvexp.batch_id = grnexp.batch_id AND rtvexp.bin_location_code=grnexp.bin_location_code AND rtvexp.expiry_date_or_receipt_date=grnexp.expiry_date_or_receipt_date) AND (grndtl.facility_id = grnexp.facility_id AND grndtl.doc_type_code =grnexp.doc_type_code AND grndtl.doc_no =grnexp.doc_no AND grndtl.doc_srl_no = grnexp.doc_srl_no) AND (rtvexp.store_code=sbv.store_code AND rtvexp.item_code=sbv.item_code AND rtvexp.batch_id=sbv.batch_id AND rtvexp.bin_location_code=sbv.bin_location_code AND rtvexp.expiry_date_or_receipt_date=sbv.expiry_date) AND rtvexp.facility_id=? AND rtvexp.doc_type_code=? AND rtvexp.doc_no=? AND rtvexp.doc_srl_no=?");

// Modified above query by Pankaj on 23/06/2004 
dataMap.put("SQL_ST_RTV_DTL_EXP_SELECT_MULTIPLE", "SELECT rtvexp.item_code, sbv.item_desc, rtvexp.batch_id, rtvexp.bin_location_code bin_location_code,grnexp.bin_location_code prev_bin_location_code, sbv.bin_desc bin_location_desc, TO_CHAR(rtvexp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, rtvexp.trade_id, sbv.trade_name, grnexp.grn_item_qty, rtvexp.item_qty rtv_item_qty, grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0) ret_qty, grndtl.pur_uom_conv, grndtl.pur_uom_code, rtvexp.item_qty+LEAST(sbv.avail_qty/grndtl.pur_uom_conv,grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0)) avail_qty, rtvexp.grn_doc_type_code, rtvexp.grn_doc_no, grndtl.grn_unit_cost_in_pur_uom,grnexp.doc_srl_no grn_doc_srl_no, TO_CHAR(grnhdr.doc_date,'dd/mm/yyyy') grn_doc_date, am.short_desc FROM st_rtv_dtl_exp rtvexp, st_grn_dtl_exp grnexp, st_grn_dtl grndtl,st_grn_hdr grnhdr, st_batch_search_lang_view sbv,  am_uom_lang_vw am WHERE  (rtvexp.facility_id = grnexp.facility_id AND rtvexp.grn_doc_type_code = grnexp.doc_type_code AND rtvexp.grn_doc_no = grnexp.doc_no AND rtvexp.store_code = grnexp.store_code AND rtvexp.item_code = grnexp.item_code AND rtvexp.batch_id = grnexp.batch_id AND /* rtvexp.bin_location_code=grnexp.bin_location_code AND */ rtvexp.expiry_date_or_receipt_date=grnexp.expiry_date_or_receipt_date) AND (grndtl.facility_id = grnexp.facility_id AND grndtl.doc_type_code =grnexp.doc_type_code AND grndtl.doc_no =grnexp.doc_no AND grndtl.doc_srl_no = grnexp.doc_srl_no) AND (rtvexp.store_code=sbv.store_code AND rtvexp.item_code=sbv.item_code AND rtvexp.batch_id=sbv.batch_id AND rtvexp.bin_location_code=sbv.bin_location_code AND rtvexp.expiry_date_or_receipt_date=sbv.expiry_date) AND rtvexp.facility_id=? AND rtvexp.doc_type_code=? AND rtvexp.doc_no=? AND rtvexp.doc_srl_no=? AND (grnexp.facility_id = grnhdr.facility_id AND grnexp.doc_type_code = grnhdr.doc_type_code AND grnexp.doc_no = grnhdr.doc_no) AND sbv.language_id = ? AND DECODE(sbv.lang1,NULL,?,sbv.lang1) = ? AND DECODE(sbv.lang2,NULL,?,sbv.lang2) = ?  AND am.uom_code = grndtl.pur_uom_code AND am.language_id = sbv.language_id" );


//dataMap.put("SQL_ST_RTV_DTL_EXP_SELECT_MULTIPLE", "SELECT batchview.trade_id, batchview.qty_on_hand GRN_ITEM_QTY, batchview.expiry_yn, (batchview.avail_qty+stexp.item_qty)avail_qty, stexp.item_qty rtv_item_qty, batchview.store_desc, batchview.trade_name, batchview.item_desc, batchview.store_code, batchview.item_code,	batchview.bin_location_code, TO_CHAR(batchview.expiry_date,'dd/mm/yyyy') EXPIRY_DATE_OR_RECEIPT_DATE, batchview.bin_desc BIN_LOCATION_DESC, batchview.batch_id, stexp.grn_doc_no, stexp.grn_doc_type_code FROM st_batch_search_view batchview, ST_rtv_DTL_EXP stexp WHERE batchview.store_code=stexp.store_code AND batchview.item_code=stexp.item_code AND batchview.batch_id=stexp.batch_id AND batchview.bin_location_code=stexp.bin_location_code AND batchview.expiry_date=stexp.expiry_date_or_receipt_date AND stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND stexp.doc_srl_no=?");

//dataMap.put("SQL_ST_RTV_HDR_QUERY_RESULT",	"SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.store_code,  fms.short_desc store_desc FROM st_rtv_hdr hdr, mm_store_lang_vw fms, sy_doc_type_master_lang_vw	sy,	st_user_access_for_store uaca WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.store_code=	fms.store_code	AND	uaca.store_code	= hdr.store_code	AND hdr.finalized_yn='N' AND uaca.rtv_allowed_yn	= 'Y' AND hdr.doc_type_code LIKE ?	AND	TO_CHAR(hdr.doc_no)	LIKE  ?	AND	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') LIKE ?	AND	hdr.store_code LIKE ? AND uaca.user_id	= ? AND hdr.facility_id=? AND hdr.entry_completed_yn LIKE ? AND fms.language_id = sy.language_id AND sy.language_id = ?");

dataMap.put("SQL_ST_RTV_HDR_QUERY_RESULT",	"SELECT hdr.doc_type_code, sy.short_desc doc_type_desc,hdr.doc_no, TO_CHAR(hdr.doc_date,'dd/mm/yyyy')	doc_date, hdr.store_code,  fms.short_desc store_desc FROM st_rtv_hdr hdr, mm_store_lang_vw fms, sy_doc_type_master_lang_vw	sy,	st_user_access_for_store uaca WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.store_code=	fms.store_code	AND	uaca.store_code	= hdr.store_code	AND hdr.finalized_yn='N' AND uaca.rtv_allowed_yn	= 'Y' AND hdr.doc_type_code LIKE ?	AND	TO_CHAR(hdr.doc_no)	LIKE  ?	AND	/*TO_CHAR(hdr.doc_date,'dd/mm/yyyy') LIKE ?*/ TO_DATE (TO_CHAR (hdr.doc_date, 'dd/mm/yyyy'), 'dd/mm/yyyy')  BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy')	AND	hdr.store_code LIKE ? AND uaca.user_id	= ? AND hdr.facility_id=? AND hdr.entry_completed_yn LIKE ? AND fms.language_id = sy.language_id AND sy.language_id = ?");

dataMap.put("SQL_ST_RTV_DTL_EXP_DELETE_ALL",	"DELETE FROM st_rtv_dtl_exp WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
dataMap.put("SQL_ST_RTV_DTL_DELETE_ALL",	"DELETE FROM st_rtv_dtl WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
dataMap.put("SQL_ST_RTV_HDR_DELETE",	"DELETE FROM st_rtv_hdr WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
dataMap.put("SQL_ST_RTV_HDR_UPDATE",	"UPDATE st_rtv_hdr SET doc_date = TO_DATE(?,'dd/mm/yyyy') , doc_ref = ? , store_code = ? ,supp_code= ? , finalized_yn= ? , gl_interfaced_yn = ? , trn_type = ? ,  entry_completed_yn= ? ,modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ?,rtv_for_replacement_yn = ? WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?");
dataMap.put("SQL_ST_RTV_DTL_UPDATE",	"UPDATE st_rtv_dtl SET item_code = ? , item_qty_normal = ? ,item_qty_bonus= ? ,item_qty_sample= ? , item_cost_value= ? , stock_item_yn = ? , rtv_unit_cost=?, remarks=?, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id = ? , rtv_repl_qty=?, pend_repl_qty=?  WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");
dataMap.put("SQL_ST_RTV_DTL_DELETE",	"DELETE FROM st_rtv_dtl WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ? AND doc_srl_no = ?");
dataMap.put("SQL_ST_RTV_DTL_EXP_DELETE",	"DELETE FROM st_rtv_dtl_exp WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");
dataMap.put("SQL_ST_GRN_DTL_UPDATE_FOR_RTV","UPDATE st_grn_dtl SET rtv_item_qty_normal = rtv_item_qty_normal+NVL(?,0), rtv_item_qty_bonus = rtv_item_qty_bonus+NVL(?,0), rtv_item_qty_sample= rtv_item_qty_sample+NVL(?,0), modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id=? AND doc_type_code=? AND doc_no=? AND item_code=?"); 
dataMap.put("SQL_ST_GRN_DTL_EXP_UPDATE_FOR_RTV","UPDATE st_grn_dtl_exp SET rtv_item_qty= NVL(rtv_item_qty,0)+?, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id=? AND doc_type_code=? AND doc_no=? AND store_code=? AND item_code=? AND batch_id=? AND bin_location_code=? AND TRUNC(expiry_date_or_receipt_date)=TO_DATE(?,'dd/mm/yyyy') AND trade_id=?");

dataMap.put("SQL_ST_RTV_DTL_SELECT_GRN_UPDATE","SELECT item_qty_normal, item_qty_bonus, item_qty_sample FROM st_rtv_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=? AND item_code=?"); 


//dataMap.put("SQL_ST_RTV_BATCH_SEARCH_QUERY","SELECT grnexp.item_code, sbv.item_desc, grnexp.batch_id, grnexp.bin_location_code bin_location_code,  mmb.short_desc bin_location_desc, TO_CHAR(grnexp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, grnexp.trade_id, sbv.trade_name, grnexp.grn_item_qty, NVL(grnexp.rtv_item_qty,0), grnexp.grn_item_qty-NVL(grnexp.rtv_item_qty,0) ret_qty, sbv.avail_qty avail_qty, grnexp.doc_type_code grn_doc_type_code, grnexp.doc_no grn_doc_no FROM st_grn_dtl_exp grnexp, st_grn_hdr grnhdr, st_batch_search_view sbv, mm_bin_location mmb WHERE grnexp.facility_id = ? AND (grnexp.facility_id = grnhdr.facility_id AND grnexp.doc_type_code = grnhdr.doc_type_code AND grnexp.doc_no = grnhdr.doc_no) AND grnhdr.finalized_yn='Y' AND grnhdr.store_code=? AND (grnexp.grn_item_qty-grnexp.rtv_item_qty) > 0 AND (grnhdr.store_code=sbv.store_code AND grnexp.item_code=sbv.item_code AND grnexp.batch_id=sbv.batch_id AND grnexp.bin_location_code=sbv.bin_location_code AND grnexp.expiry_date_or_receipt_date=sbv.expiry_date ) AND (grnhdr.store_code=mmb.store_code AND grnexp.bin_location_code=mmb.bin_location_code) AND grnexp.item_code= ?");
//dataMap.put("SQL_ST_RTV_DTL_EXP_SELECT_FOR_BLOCK_REL",	"SELECT exp.store_code, exp.item_code, exp.batch_id, exp.bin_location_code, to_char(exp.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date , exp.trade_id, (exp.item_qty*dtl.pur_uom_conv) item_qty, grn_doc_type_code, grn_doc_no FROM st_rtv_dtl_exp exp, st_grn_dtl dtl WHERE  dtl.facility_id=exp.facility_id AND  dtl.doc_type_code =exp.grn_doc_type_code and dtl.item_code=exp.item_code AND dtl.doc_no=exp.grn_doc_no and exp.facility_id=? AND  exp.doc_type_code =? AND exp.doc_no=? AND exp.doc_srl_no LIKE ? order by exp.item_code");
dataMap.put("SQL_ST_RTV_DTL_EXP_SELECT_FOR_BLOCK_REL",	"SELECT EXP.store_code, EXP.item_code, EXP.batch_id, EXP.bin_location_code, TO_CHAR(EXP.expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date , EXP.trade_id, (EXP.item_qty*dtl.pur_uom_conv) item_qty, grn_doc_type_code, grn_doc_no,grn_exp.bin_location_code prev_bin_location_code FROM st_rtv_dtl_exp EXP, st_grn_dtl dtl, st_grn_dtl_exp grn_exp WHERE  dtl.facility_id=EXP.facility_id AND  dtl.doc_type_code =EXP.grn_doc_type_code AND dtl.item_code=EXP.item_code AND dtl.doc_no=EXP.grn_doc_no AND dtl.facility_id=grn_exp.facility_id AND dtl.doc_type_code=grn_exp.doc_type_code AND dtl.doc_no=grn_exp.doc_no AND EXP.batch_id=grn_exp.batch_id AND  EXP.expiry_date_or_receipt_date=grn_exp.expiry_date_or_receipt_date AND EXP.item_code=grn_exp.item_code AND EXP.store_code=grn_exp.store_code AND EXP.facility_id=? AND  EXP.doc_type_code =? AND EXP.doc_no=? AND EXP.doc_srl_no LIKE ? ORDER BY EXP.item_code ");

//Stock Status by Item 

dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_SELECT","SELECT b.sole_source_yn sole_source, b.special_item_yn special_item, b.item_remarks item_remarks, a.autoclaveable_yn autoclaveable, f.short_name manufacturer_name, g.short_desc anal1_desc, h.short_desc anal2_desc, i.short_desc anal3_desc, b.item_class_code, c.short_desc item_class_desc, a.curr_pack_size curr_pack_size, a.reorder_level reorder_level, SUM(d.qty_on_hand) qty_on_hand, TO_CHAR(MAX(d.last_issue_date),'dd/mm/yyyy') last_issue_date, SUM(CASE WHEN e.CHK_STK_LVL_FOR_PUR_YN='Y' THEN d.qty_on_hand ELSE 0 END) qty_reorder_store, SUM(CASE WHEN e.CHK_STK_LVL_FOR_PUR_YN='N' THEN d.qty_on_hand ELSE 0 END) qty_other_store, SUM(CASE WHEN d.store_code =? THEN d.qty_on_hand ELSE 0 END) qty_primary_store FROM st_item a, mm_item_lang_vw b, mm_item_class_lang_vw c, st_item_store d, st_store e, am_manufacturer_lang_vw f, mm_item_analysis_lang_vw g, mm_item_analysis_lang_vw h, mm_item_analysis_lang_vw i WHERE a.item_code=b.item_code AND b.item_class_code=c.item_class_code AND d.store_code=e.store_code AND a.item_code=d.item_code AND b.EFF_STATUS = 'E' AND b.manufacturer_id=f.manufacturer_id (+) AND b.item_anal1_code=g.item_anal_code (+) AND b.item_anal2_code=h.item_anal_code (+) AND b.item_anal3_code=i.item_anal_code (+) AND a.item_code=?      AND b.language_id = f.language_id(+) AND b.language_id = g.language_id(+) AND b.language_id = h.language_id(+) AND b.language_id = i.language_id(+) AND b.language_id = c.language_id AND b.language_id = ? GROUP BY b.item_class_code, c.short_desc, a.curr_pack_size, a.reorder_level, b.sole_source_yn, b.special_item_yn, b.item_remarks, a.autoclaveable_yn, f.short_name, g.short_desc, h.short_desc, i.short_desc");
dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_SELECT2","SELECT   sole_source, special_item, item_remarks, autoclaveable,          manufacturer_name, anal1_desc, anal2_desc, anal3_desc, item_class_code, item_class_desc, curr_pack_size, reorder_level,          SUM(NVL(qty_on_hand, 0) * eqvl_value) qty_on_hand, MAX(last_issue_date) last_issue_date, SUM(NVL(qty_reorder_store,0) * eqvl_value) qty_reorder_store, SUM(NVL(qty_other_store,0) * eqvl_value) qty_other_store, SUM(NVL(qty_primary_store,0) * eqvl_value)  qty_primary_store FROM (SELECT  d.store_code, b.sole_source_yn sole_source, b.special_item_yn special_item,                    b.item_remarks item_remarks, a.autoclaveable_yn autoclaveable, f.short_name manufacturer_name, g.short_desc anal1_desc, h.short_desc anal2_desc, i.short_desc anal3_desc, b.item_class_code, c.short_desc item_class_desc, a.curr_pack_size curr_pack_size, a.reorder_level reorder_level, SUM (d.qty_on_hand) qty_on_hand, TO_CHAR (NVL (d.last_issue_date, TO_DATE ('01/01/1800', 'dd/mm/yyyy')), 'dd/mm/yyyy') last_issue_date, SUM(CASE WHEN e.chk_stk_lvl_for_pur_yn = 'Y' THEN NVL (d.qty_on_hand, 0) ELSE 0 END ) qty_reorder_store, SUM (CASE WHEN e.chk_stk_lvl_for_pur_yn = 'N' THEN NVL (d.qty_on_hand, 0) ELSE 0 END ) qty_other_store, SUM (CASE WHEN d.store_code = '' THEN NVL (d.qty_on_hand, 0) ELSE 0 END ) qty_primary_store, (SELECT eqvl_value FROM mm_item_uom_defn WHERE item_code = d.item_code AND eqvl_uom_code = d.def_issue_uom AND uom_code = b.gen_uom_code UNION SELECT eqvl_value FROM am_uom_eqvl WHERE eqvl_uom_code = d.def_issue_uom AND uom_code = b.gen_uom_code UNION SELECT 1 FROM DUAL WHERE d.def_issue_uom = b.gen_uom_code) eqvl_value FROM ST_ITEM a, mm_item_lang_vw b, mm_item_class_lang_vw c, ST_ITEM_STORE d, ST_STORE e, am_manufacturer_lang_vw f, mm_item_analysis_lang_vw g, mm_item_analysis_lang_vw h, mm_item_analysis_lang_vw i, mm_store_lang_vw j WHERE a.item_code = b.item_code AND b.item_class_code = c.item_class_code AND d.store_code = e.store_code AND a.item_code = d.item_code AND b.eff_status = 'E' AND b.manufacturer_id = f.manufacturer_id(+) AND b.item_anal1_code = g.item_anal_code(+) AND b.item_anal2_code = h.item_anal_code(+) AND b.item_anal3_code = i.item_anal_code(+) AND a.item_code = ? AND b.language_id = f.language_id(+) AND b.language_id = g.language_id(+) AND b.language_id = h.language_id(+) AND b.language_id = i.language_id(+) AND b.language_id = c.language_id AND b.language_id = ? AND j.facility_id = ? AND j.store_code = d.store_code AND j.language_id = b.language_id GROUP BY b.item_class_code, c.short_desc, a.curr_pack_size, a.reorder_level, b.sole_source_yn, b.special_item_yn, b.item_remarks, a.autoclaveable_yn, f.short_name, g.short_desc, h.short_desc, i.short_desc, d.item_code, d.def_issue_uom, b.gen_uom_code, d.last_issue_date, d.store_code) GROUP BY sole_source, special_item, item_remarks, autoclaveable, manufacturer_name, anal1_desc, anal2_desc, anal3_desc, item_class_code, item_class_desc,          curr_pack_size, reorder_level");

dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_BIN_LOC","select b.short_desc bin_desc from st_item_batch a, mm_bin_location_lang_vw b where a.store_code=b.store_code and a.store_code = b.store_code and a.store_code=? and item_code=? AND b.language_id = ? and rownum<2");
dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_BIN_LOC2","select b.short_desc bin_desc from st_item_batch a, mm_bin_location b where a.store_code=b.store_code and a.store_code = b.store_code and item_code=? and rownum<2");
//dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_STORE_LEVEL","SELECT A.item_code item_code, A.store_code store_code, B.short_desc store_desc, A.qty_on_hand qty_on_hand, A.stock_item_yn stock_item_yn, A.bin_location_code,C.short_desc  bin_desc,NVL(a.reorder_level,'0') reorder_level,a.item_value item_value FROM ST_ITEM_STORE A,mm_store B, mm_bin_location C, ST_USER_ACCESS_FOR_STORE D WHERE A.store_code=B.store_code AND A.store_code=C.store_code(+) AND A.bin_location_code=C.bin_location_code(+) AND A.item_code= ?  AND D.user_id = ? and D.store_code = B.store_code");  // Modifed on 1/5/2006 by Ram to avoid listing Non Stock  Store
dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_STORE_LEVEL","SELECT a.item_code item_code, a.store_code store_code, b.short_desc store_desc, a.qty_on_hand qty_on_hand, a.stock_item_yn stock_item_yn, a.bin_location_code, c.short_desc bin_desc, NVL (a.reorder_level,'0') reorder_level,a.item_value item_value,(SELECT eqvl_value FROM MM_ITEM_UOM_DEFN WHERE item_code = a.item_code AND eqvl_uom_code = a.def_issue_uom AND uom_code = f.gen_uom_code UNION SELECT eqvl_value FROM AM_UOM_EQVL WHERE eqvl_uom_code = a.def_issue_uom AND uom_code = f.gen_uom_code UNION SELECT 1 FROM dual WHERE a.def_issue_uom = f.gen_uom_code  )eqvl_value,g.short_desc stock_uom_desc FROM st_item_store a, mm_store_lang_vw b, mm_bin_location_lang_vw c, st_user_access_for_store d, st_store e, mm_item_lang_vw f, am_uom g  WHERE a.store_code = b.store_code    AND a.store_code = c.store_code(+) AND a.bin_location_code = c.bin_location_code(+) AND a.item_code = ? AND d.user_id = ? AND d.store_code = b.store_code AND b.store_code = e.store_code AND e.store_type_flag != 'N' AND b.language_id = c.language_id AND b.language_id = ? AND b.language_id = f.language_id AND a.item_code = f.item_code AND a.def_issue_uom = g.uom_code and b.facility_id =? ");

dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_STORE_SP","select ITEM_SPECIFICATION from mm_item_lang_vw where item_code=? AND language_id= ?");
//dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_YTD","select sum(case when curr_proc_month = move_month then grn_qty else 0 end) Mtd_rec_qty, sum(case when curr_proc_month =  move_month then nvl(out_iss_qty_ns,0)+nvl(out_iss_qty_st,0)+nvl(out_urg_qty_ns,0)+nvl(out_urg_qty_st,0)+nvl(sal_qty,0) else 0 end) Mtd_iss_qty, sum(nvl(out_iss_qty_ns,0)+nvl(out_iss_qty_st,0)+nvl(out_urg_qty_ns,0)+nvl(out_urg_qty_st,0)+nvl(sal_qty,0)) ytd_issue_qty from st_item_move_summ a,st_facility_param b where b.facility_id=? and a.item_code=?  and a.move_year=b.curr_proc_year");
//dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_YTD","select sum(case when curr_proc_month = move_month then grn_qty else 0 end) Mtd_rec_qty, sum(case when curr_proc_month =  move_month then nvl(abs(out_iss_qty_ns),0)+nvl(abs(out_iss_qty_st),0)+nvl(abs(out_urg_qty_ns),0)+nvl(abs(out_urg_qty_st),0)+nvl(abs(sal_qty),0) else 0 end) Mtd_iss_qty, sum(nvl(abs(out_iss_qty_ns),0)+nvl(abs(out_urg_qty_ns),0)+nvl(abs(sal_qty),0)) ytd_issue_qty from st_item_move_summ a,st_facility_param b where b.facility_id=? and a.item_code=?  and a.move_year=b.curr_proc_year");
dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_YTD","select sum(case when curr_proc_month = move_month then grn_qty else 0 end) Mtd_rec_qty, sum(case when curr_proc_month =  move_month  and curr_proc_year = move_year then nvl(abs(out_iss_qty_ns),0)+nvl(abs(out_iss_qty_st),0)+nvl(abs(out_urg_qty_ns),0)+nvl(abs(out_urg_qty_st),0)+ nvl(abs(sal_qty),0) else 0 end) Mtd_iss_qty, sum(case when curr_proc_year = move_year then nvl(abs(cons_qty+sal_qty+srt_qty),0)else 0 end) ytd_issue_qty from st_item_move_summ a,st_facility_param b where b.facility_id=? and a.item_code=? and a.move_year=b.curr_proc_year");
//Wednesday, June 29, 2004 Added by Phaniraj
dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_CONSUMPTION","SELECT  move_month,move_year, -1 * (SUM(NVL(cons_qty,0)+NVL(sal_qty,0)+NVL(srt_qty,0))) consumption_qty , -1 * (SUM(NVL(cons_cost,0)+NVL(sal_cost,0)+NVL(srt_cost,0))) consumption_cost FROM st_item_move_summ  where item_code= ? and facility_id = ? group by move_year,move_month having (SUM(NVL(cons_qty,0)+NVL(sal_qty,0)+NVL(srt_qty,0))) != 0 OR (SUM(NVL(cons_cost,0)+NVL(sal_cost,0)+NVL(srt_cost,0))) != 0 order by move_year||'/'||move_month desc");
dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_SELECT_LIST","SELECT   b.short_desc STORE, -1 * (SUM (NVL (a.cons_qty, 0))) issue,-1 * (SUM (NVL (a.cons_cost, 0))) issue_cost,-1 * (SUM (NVL (a.sal_qty, 0) + NVL (a.srt_qty, 0))) salespatient,-1* (SUM (NVL (a.sal_cost, 0) + NVL(a.srt_cost,0)))salespatient_value FROM st_item_move_summ a, mm_store_lang_vw b WHERE a.store_code = b.store_code AND a.item_code = ? AND a.move_year = ? AND a.move_month = ? AND b.language_id= ? and a.facility_id =? GROUP BY b.short_desc having -1 * (SUM (NVL (a.cons_qty, 0))) !=0 or -1 * (SUM (NVL (a.cons_cost, 0))) !=0 or -1 * (SUM (NVL (a.sal_qty, 0) + NVL (a.srt_qty, 0))) !=0 or -1* (SUM (NVL (a.sal_cost, 0) + NVL(a.srt_cost,0))) !=0");

//Item Movement Query
dataMap.put("SQL_ST_ITEM_MOVEMENT_NO_STORE_CODE","SELECT  move_year||TO_CHAR(move_month,'00') orderbyperiod, TO_CHAR(move_month,'00') || '/' || move_year period, SUM(month_opening_qty)+NVL(SUM(obs_qty),0) In_Open_bal, SUM(grn_qty) In_grn, SUM(pos_adj_qty) In_adj, SUM(pos_var_qty) In_var, SUM(CASE WHEN mfg_qty > 0 THEN mfg_qty ELSE 0 END) In_mfg_rec, SUM(srt_qty) In_sale_ret, SUM(CASE WHEN prt_qty > 0 THEN prt_qty ELSE 0 END) In_prod,SUM(IN_TFR_QTY) in_tfr, SUM(rtv_qty) Out_rtv, SUM(neg_adj_qty) Out_adj, SUM(neg_var_qty) Out_var, SUM(CASE WHEN mfg_qty < 0 THEN mfg_qty ELSE 0 END) Out_mfg, SUM(CASE WHEN prt_qty < 0 THEN prt_qty ELSE 0 END) Out_prod, SUM(sal_qty) Out_sale, SUM(cons_qty+sal_qty+srt_qty) Out_cons, SUM(month_closing_qty) Out_clos_bal, SUM(in_iss_qty+in_urg_qty) In_inv_iss_store, SUM(in_ret_qty) In_inv_ret_store, SUM(out_iss_qty_st+out_urg_qty_st) Out_inv_iss_store, SUM(out_iss_qty_ns+out_urg_qty_ns) Out_ns_iss_store, SUM(out_ret_qty_st) Out_inv_ret_store, SUM(out_ret_qty_ns) Out_ns_ret_store,SUM(OUT_TFR_QTY) out_tfr FROM st_item_move_summ a,mm_item b WHERE a.item_code=b.item_code AND (b.item_code =? OR (? IS NULL AND b.item_class_code=?)) AND a.store_code = NVL(?,a.store_code) AND move_year *100 + move_month BETWEEN ? AND ? and a.facility_id =? GROUP BY move_month , move_year ORDER BY orderbyperiod");
dataMap.put("SQL_ST_ITEM_MOVEMENT_NO_STORE_VALUE","SELECT  move_year||TO_CHAR(move_month,'00') orderbyperiod, TO_CHAR(move_month,'00') || '/' || move_year period, SUM(month_opening_value) +NVL(SUM(obs_cost),0) In_Open_bal, SUM(grn_cost) In_grn, SUM(pos_adj_cost) In_adj, SUM(pos_var_cost) In_var, SUM(CASE WHEN mfg_cost > 0 THEN mfg_cost ELSE 0 END) In_mfg_rec, SUM(srt_cost) In_sale_ret, SUM(CASE WHEN prt_cost > 0 THEN prt_cost ELSE 0 END) In_prod, SUM(rtv_cost) Out_rtv, SUM(neg_adj_cost) Out_adj, SUM(neg_var_cost) Out_var, SUM(CASE WHEN mfg_cost < 0 THEN mfg_cost ELSE 0 END) Out_mfg, SUM(CASE WHEN prt_cost < 0 THEN prt_cost ELSE 0 END) Out_prod,SUM(IN_TFR_COST) in_tfr, SUM(sal_cost) Out_sale, SUM(cons_cost+sal_cost+srt_cost) Out_cons, SUM(month_closing_value) Out_clos_bal, SUM(in_iss_cost+in_urg_cost) In_inv_iss_store, SUM(in_ret_cost) In__inv_ret_store, SUM(out_iss_cost_st+out_urg_cost_st) Out_inv_iss_store, SUM(out_iss_cost_ns+out_urg_cost_ns) Out_ns_iss_store, SUM(out_ret_cost_st) Out_inv_ret_store, SUM(out_ret_cost_ns) Out_ns_ret_store,SUM(OUT_TFR_COST) out_tfr FROM st_item_move_summ a,mm_item b WHERE a.item_code=b.item_code AND (b.item_code =? OR (? IS NULL AND b.item_class_code=?)) AND a.store_code = NVL(?,a.store_code) AND move_year *100 + move_month BETWEEN ? AND ? and a.facility_id = ? GROUP BY move_month , move_year ORDER BY orderbyperiod");
//dataMap.put("SQL_ST_ITEM_MOVEMENT_DETAIL","SELECT b.short_desc trn_type, a.doc_type_code doc_type, a.doc_no doc_no, TO_CHAR(a.doc_date,'DD/MM/YYYY') doc_date, a.posted_date orderbycolumn, (NVL(a.item_Qty_NORMAL,0)+NVL(a.item_qty_bonus,0)+NVL(a.item_qty_sample,0))  item_qty, TO_CHAR(a.expiry_date,'DD/MM/YYYY') expiry_date, c.short_desc other_store_desc, a.batch_id batch_id, nvl(d.short_name, a.trade_id) trade_id, e.short_desc bin_location, a.po_no po_no, DECODE(a.sal_trn_type,'I','Inpatient','O','Outpatient','R','Referral','C','Consumption') sale_type, a.supp_code supp_type, sum(item_qty_normal) over (partition by a.item_code,a.store_code order by a.posted_date,a.BIN_LOCATION_CODE,a.batch_id,a.trade_id,a.expiry_date) balance FROM st_item_trn_dtl a , st_trn_type b,mm_store c,am_trade_name d,mm_bin_location e WHERE SUBSTR(st_get_post_mth_yr(a.doc_date),3)||SUBSTR(st_get_post_mth_yr(a.doc_date),1,2) BETWEEN ? AND ? AND item_code =? AND a.store_code=? AND (? IS NULL OR a.trn_type =?) AND (?='B' OR stock_item_yn =?) AND a.trn_type = b.trn_type AND c.store_code (+)= a.other_store_code AND a.trade_id= d.trade_id(+) AND e.store_code(+)= a.store_code AND e.bin_location_code(+)=a.bin_location_code ORDER BY orderbycolumn");
//the above query is modified from doc_Date to posted_Date  by Ganga Tuesday, August 14, 2012 for Medicity
dataMap.put("SQL_ST_ITEM_MOVEMENT_DETAIL","SELECT b.short_desc trn_type, a.doc_type_code doc_type, a.doc_no doc_no, TO_CHAR(a.doc_date,'DD/MM/YYYY') doc_date, a.posted_date orderbycolumn, (NVL(a.item_Qty_NORMAL,0)+NVL(a.item_qty_bonus,0)+NVL(a.item_qty_sample,0))  item_qty, TO_CHAR(a.expiry_date,'DD/MM/YYYY') expiry_date, c.short_desc other_store_desc, a.batch_id batch_id, nvl(d.short_name, a.trade_id) trade_id, e.short_desc bin_location, a.po_no po_no, DECODE(a.sal_trn_type,'I','Inpatient','O','Outpatient','R','Referral','C','Consumption') sale_type, a.supp_code supp_type, sum(item_qty_normal) over (partition by a.item_code,a.store_code order by a.posted_date,a.BIN_LOCATION_CODE,a.batch_id,a.trade_id,a.expiry_date) balance FROM st_item_trn_dtl a , st_trn_type b,mm_store c,am_trade_name d,mm_bin_location e WHERE SUBSTR(st_get_post_mth_yr(a.posted_date),3)||SUBSTR(st_get_post_mth_yr(a.posted_date),1,2) BETWEEN ? AND ? AND item_code =? AND a.store_code=? AND (? IS NULL OR a.trn_type =?) AND (?='B' OR stock_item_yn =?) AND a.trn_type = b.trn_type AND c.store_code (+)= a.other_store_code AND a.trade_id= d.trade_id(+) AND e.store_code(+)= a.store_code AND e.bin_location_code(+)=a.bin_location_code ORDER BY orderbycolumn");

dataMap.put("SQL_ST_ITEM_MOVEMENT_MONTH_OPENING_QTY","SELECT MONTH_OPENING_QTY FROM ST_ITEM_MOVE_SUMM WHERE move_year *100 + move_month = ? AND ITEM_CODE=? AND STORE_CODE=?");
dataMap.put("SQL_ST_ITEM_MOVEMENT_MONTH_CLOSING_QTY","SELECT MONTH_CLOSING_QTY FROM ST_ITEM_MOVE_SUMM WHERE move_year *100 + move_month = ?  AND ITEM_CODE=? AND STORE_CODE=?");

//print count status
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_MODE","SELECT curr_phy_inv_id+1 curr_phy FROM st_facility_param WHERE facility_id=?");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_INSERT","INSERT INTO st_phy_inv_param(FACILITY_ID, PHY_INV_ID, FM_STORE_CODE, TO_STORE_CODE, FM_ITEM_CODE, TO_ITEM_CODE, PHY_INV_COUNT, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, PHY_INV_TYPE, EXPIRY_FLAG,     FM_ITEM_CLASS_CODE, TO_ITEM_CLASS_CODE, FM_ITEM_VALUE, TO_ITEM_VALUE, FM_UNIT_COST, TO_UNIT_COST, ITEM_ANAL1_CODE, ITEM_ANAL2_CODE, ITEM_ANAL3_CODE, ABC_CLASS_CODE, PHY_INV_PROC_MODE, FM_ALPHA_CODE, TO_ALPHA_CODE, COUNT_SHEET_DATE) values(?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT","select ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,TO_CHAR(SYSDATE,'dd/mm/yyyy')  ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID, TO_CHAR(SYSDATE,'dd/mm/yyyy') MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) order by a.store_code,a.item_code"); // Modified on 2/6/2006 for date pblm
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ZERO","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND = 0 order by a.store_code,a.item_code");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_NON_ZERO","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND > 0 order by a.store_code,a.item_code");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND >= 0 order by a.store_code,a.item_code");
// dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR","INSERT into st_phy_inv_hdr(FACILITY_ID, PHY_INV_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, STORE_CODE, ITEM_CODE) values(?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?)");  //Modified on 2/6/2006 for date pblm
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR","INSERT into st_phy_inv_hdr(FACILITY_ID, PHY_INV_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, STORE_CODE, ITEM_CODE) values(?,?,?,sysdate,?,?,?,sysdate,?,?,?,?)"); 


//NEW ADDED BY GANGA FOR 29974	Bru-HIMS-CRF-099  Wednesday, September 05

//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ZERO_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND = 0");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_NON_ZERO_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND > 0");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND >= 0");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ZERO_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE,d.short_desc ITEM_DESC,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND = 0");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_NON_ZERO_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE,d.short_desc ITEM_DESC,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND > 0");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE,d.short_desc ITEM_DESC,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value  from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.QTY_ON_HAND >= 0");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL_TEMP","SELECT DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE in (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))");

//Modified by suresh.r added NVL(,0) to D.UNIT_COST for the bleow SQL_ST_PRINT_COUNT_PHY_INV_UPDATE starting name 12 queries on 30-01-2015 against 53162(MMS-QF-SCF-0469)
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ZERO_NEW","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_NON_ZERO_NEW","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ALL_NEW","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");

//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ZERO_NEW","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_NON_ZERO_NEW","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ALL_NEW","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");

//ENDED






//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE","Update ST_ITEM_STORE set phy_inv_id=?, phy_inv_start_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), modified_at_ws_no=?, modified_facility_id=? where (store_code, item_code) in(select a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (d.unit_cost between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (a.item_value between NVL(?,0) and NVL(?,999999999999))) and phy_inv_id is null"); // Modified on 2/6/2006 for date pblm
//Commented By Mahesh ON 2/24/2009 for the CRF SRR20056-CRF-0264

//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE","Update ST_ITEM_STORE set phy_inv_id=?, phy_inv_start_date=SYSDATE,phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=SYSDATE,modified_at_ws_no=?, modified_facility_id=? where (store_code, item_code) in(select a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (d.unit_cost between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (a.item_value between NVL(?,0) and NVL(?,999999999999))) and phy_inv_id is null");

//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ZERO","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.UNIT_COST BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (A.ITEM_VALUE BETWEEN NVL(?,0) AND NVL(?,999999999999))AND A.QTY_ON_HAND = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_NON_ZERO","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.UNIT_COST BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (A.ITEM_VALUE BETWEEN NVL(?,0) AND NVL(?,999999999999))AND A.QTY_ON_HAND > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ALL","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.UNIT_COST BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (A.ITEM_VALUE BETWEEN NVL(?,0) AND NVL(?,999999999999))AND A.QTY_ON_HAND >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");

//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ZERO","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_NON_ZERO","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ALL","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");

// dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH","Update ST_ITEM_BATCH set phy_inv_id=?, phy_inv_start_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), modified_at_ws_no=?, modified_facility_id=? where (store_code, item_code) in(select a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (d.unit_cost between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (a.item_value between NVL(?,0) and NVL(?,999999999999))) and phy_inv_id is null"); // Modified on 2/6/2006 for date pblm
//Commented By Mahesh ON 2/24/2009 for the CRF SRR20056-CRF-0264

//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH","Update ST_ITEM_BATCH set phy_inv_id=?, phy_inv_start_date=SYSDATE, phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where (store_code, item_code) in(select a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (d.unit_cost between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (a.item_value between NVL(?,0) and NVL(?,999999999999))) and phy_inv_id is null");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ZERO","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.UNIT_COST BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (A.ITEM_VALUE BETWEEN NVL(?,0) AND NVL(?,999999999999))AND A.QTY_ON_HAND = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_NON_ZERO","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.UNIT_COST BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (A.ITEM_VALUE BETWEEN NVL(?,0) AND NVL(?,999999999999))AND A.QTY_ON_HAND > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ALL","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.UNIT_COST BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (A.ITEM_VALUE BETWEEN NVL(?,0) AND NVL(?,999999999999))AND A.QTY_ON_HAND >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ZERO","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_NON_ZERO","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");
//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ALL","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE) AND PHY_INV_ID IS NULL");

//dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_PARAM","Update ST_FACILITY_PARAM set curr_phy_inv_id=? where facility_id=?"); // Modified on 2/6/2006 for date pblm
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_PARAM","Update ST_FACILITY_PARAM set curr_phy_inv_id=?,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where facility_id=?");

//Phy Inv for specific Item

dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_TEMP_ID","SELECT SPEC_PHY_INV_ID,SPEC_PHY_INV_ID FROM ST_PHY_INV_SPEC_ITEM_HDR WHERE facility_id=?");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_ADDED_ITEM","SELECT a.store_code store_code, B.short_desc store_desc,a.item_code item_code,c.short_desc item_desc FROM st_item_store a,mm_store_lang_vw B,mm_item_lang_vw c WHERE phy_inv_id  IS NULL AND (a.item_code BETWEEN NVL(?,'!') AND NVL(?,'~')) AND a.store_code =NVL(?,a.store_code) AND a.item_code = c.item_code AND a.store_code = b.store_code AND b.language_id = c.language_id AND b.language_id = ?");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_ADDED_ITEM","SELECT DISTINCT A.STORE_CODE STORE_CODE, B.SHORT_DESC STORE_DESC,A.ITEM_CODE ITEM_CODE, C.SHORT_DESC ITEM_DESC FROM ST_ITEM_STORE A, MM_STORE_LANG_VW B, MM_ITEM_LANG_VW C,ST_ITEM_TRN_DTL D WHERE PHY_INV_ID IS NULL AND (A.ITEM_CODE BETWEEN NVL (?, '!') AND NVL (?, '~')) AND A.STORE_CODE = ? AND A.ITEM_CODE = C.ITEM_CODE AND A.STORE_CODE = B.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND A.QTY_ON_HAND >= 0 AND A.STORE_CODE = D.STORE_CODE AND A.ITEM_CODE = D.ITEM_CODE");
//ADDED BY RABBANI #AMRI-CRF-100019(43320) ON 10-JULY-2014 STARTS

//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_ADDED_ITEM","SELECT DISTINCT A.STORE_CODE STORE_CODE, B.SHORT_DESC STORE_DESC,A.ITEM_CODE ITEM_CODE, C.SHORT_DESC ITEM_DESC FROM ST_ITEM_STORE A, MM_STORE_LANG_VW B, MM_ITEM_LANG_VW C,ST_ITEM_TRN_DTL D WHERE PHY_INV_ID IS NULL AND (A.ITEM_CODE BETWEEN NVL (?, '!') AND NVL (?, '~')) AND A.STORE_CODE = ? AND A.ITEM_CODE = C.ITEM_CODE AND A.STORE_CODE = B.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND A.QTY_ON_HAND >= 0 AND A.STORE_CODE = D.STORE_CODE AND A.ITEM_CODE = D.ITEM_CODE ORDER BY ITEM_DESC");
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_ADDED_ITEM","SELECT DISTINCT A.STORE_CODE STORE_CODE, B.SHORT_DESC STORE_DESC,A.ITEM_CODE ITEM_CODE, C.SHORT_DESC ITEM_DESC,E.SHORT_DESC item_class_desc FROM ST_ITEM_STORE A, MM_STORE_LANG_VW B, MM_ITEM_LANG_VW C,ST_ITEM_TRN_DTL D ,MM_ITEM_CLASS_LANG_VW e WHERE PHY_INV_ID IS NULL AND (A.ITEM_CODE BETWEEN NVL (UPPER(?), '!') AND NVL (UPPER(?), '~')) AND A.STORE_CODE = ? AND A.ITEM_CODE = C.ITEM_CODE AND A.STORE_CODE = B.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID and b.language_id = e.language_id AND B.LANGUAGE_ID = ? AND A.QTY_ON_HAND >= 0 AND A.STORE_CODE = D.STORE_CODE AND A.ITEM_CODE = D.ITEM_CODE  and c.ITEM_CLASS_CODE = E.ITEM_CLASS_CODE ORDER BY ITEM_DESC");


//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_BY_ITEM_CLASS","SELECT DISTINCT A.STORE_CODE STORE_CODE, B.SHORT_DESC STORE_DESC,A.ITEM_CODE ITEM_CODE, C.SHORT_DESC ITEM_DESC FROM ST_ITEM_STORE A, MM_STORE_LANG_VW B, MM_ITEM_LANG_VW C,ST_ITEM_TRN_DTL D WHERE PHY_INV_ID IS NULL AND (A.ITEM_CODE BETWEEN NVL (?, '!') AND NVL (?, '~')) AND A.STORE_CODE = ? AND A.ITEM_CODE = C.ITEM_CODE AND A.STORE_CODE = B.STORE_CODE AND C.ITEM_CLASS_CODE = ? AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND A.QTY_ON_HAND >= 0 AND A.STORE_CODE = D.STORE_CODE AND A.ITEM_CODE = D.ITEM_CODE ORDER BY ITEM_DESC");
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_BY_ITEM_CLASS","SELECT DISTINCT A.STORE_CODE STORE_CODE, B.SHORT_DESC STORE_DESC,A.ITEM_CODE ITEM_CODE, C.SHORT_DESC ITEM_DESC,E.SHORT_DESC item_class_desc FROM ST_ITEM_STORE A, MM_STORE_LANG_VW B, MM_ITEM_LANG_VW C,ST_ITEM_TRN_DTL D,MM_ITEM_CLASS_LANG_VW E WHERE PHY_INV_ID IS NULL AND (A.ITEM_CODE BETWEEN NVL (UPPER(?), '!') AND NVL (UPPER(?), '~')) AND A.STORE_CODE = ? AND A.ITEM_CODE = C.ITEM_CODE AND A.STORE_CODE = B.STORE_CODE AND C.ITEM_CLASS_CODE = UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID and B.language_id = E.language_id AND B.LANGUAGE_ID = ? AND A.QTY_ON_HAND >= 0 AND A.STORE_CODE = D.STORE_CODE AND A.ITEM_CODE = D.ITEM_CODE AND C.ITEM_CLASS_CODE = E.ITEM_CLASS_CODE ORDER BY ITEM_DESC");

dataMap.put("SQL_ST_ITEM_CLASS_LOOKUP_LANG_PHY","SELECT DISTINCT mm_item.item_class_code code, mm.short_desc description FROM mm_item_class_lang_vw mm,mm_item_lang_vw mm_item ,st_item_store str WHERE mm.eff_status = 'E'  AND mm_item.item_code = STR.item_code  AND UPPER(str.store_code) LIKE  UPPER(?) and mm_item.language_id = mm.language_id AND    UPPER(mm.language_id) LIKE  UPPER(?) AND mm_item.item_class_code LIKE UPPER (?) AND UPPER (mm.short_desc) LIKE UPPER (?) AND mm.item_class_code = mm_item.item_class_code");
//ENDS
//Modified by B.Badmavathi on 02-04-2015 against HSA-CRF-0220
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_INSERT_PRINTSHEET","INSERT INTO st_phy_inv_param(FACILITY_ID, PHY_INV_ID, FM_STORE_CODE, TO_STORE_CODE, FM_BIN_LOCATION_CODE, TO_BIN_LOCATION_CODE, FM_ITEM_CODE, TO_ITEM_CODE, PHY_INV_COUNT, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, PHY_INV_TYPE, EXPIRY_FLAG,     FM_ITEM_CLASS_CODE, TO_ITEM_CLASS_CODE, FM_ITEM_VALUE, TO_ITEM_VALUE, FM_UNIT_COST, TO_UNIT_COST, ITEM_ANAL1_CODE, ITEM_ANAL2_CODE, ITEM_ANAL3_CODE, ABC_CLASS_CODE, PHY_INV_PROC_MODE, FM_ALPHA_CODE, TO_ALPHA_CODE, COUNT_SHEET_DATE) values(?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ZERO_NEW","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE, BIN_LOCATION_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B, ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND  (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ZERO_NEW","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_NON_ZERO_NEW","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND  A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_NON_ZERO_NEW","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ALL_NEW","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ALL_NEW","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE  AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE IN (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ZERO","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND  A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ZERO","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE  FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_NON_ZERO","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_NON_ZERO","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_STORE_ALL","UPDATE ST_ITEM_STORE SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE,PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND  (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_UPDATE_BATCH_ALL","UPDATE ST_ITEM_BATCH SET PHY_INV_ID=?, PHY_INV_START_DATE=SYSDATE, PHY_INV_START_QTY=QTY_ON_HAND, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE (STORE_CODE, ITEM_CODE) IN(SELECT DISTINCT A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE and A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y') AND PHY_INV_ID IS NULL");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ZERO_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE,d.short_desc ITEM_DESC,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y' AND A.QTY_ON_HAND = 0");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_NON_ZERO_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE,d.short_desc ITEM_DESC,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code and  TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND  A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y' AND A.QTY_ON_HAND > 0");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL_NEW","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE,d.short_desc ITEM_DESC,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND  TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value  from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code IN (@)) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND  A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y' AND A.QTY_ON_HAND >= 0");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL_TEMP","SELECT DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE,(SELECT   SUM (  -1  * (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))  FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ?, 'mm/yyyy') )consumption_qty,(SELECT  SUM (  -1 * (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) FROM st_item_move_summ mv  WHERE mv.item_code = a.item_code AND mv.store_code = a.store_code AND TO_DATE (move_month || '/' || move_year, 'mm/yyyy')  BETWEEN TO_DATE (? || '/' || ?, 'mm/yyyy') AND TO_DATE (? || '/' || ? , 'mm/yyyy') )consumption_value FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D, st_item_store_bin_locn E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE and A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE  AND (A.ITEM_CODE in (@)) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (E.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ZERO","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND  A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y' AND A.QTY_ON_HAND = 0 order by a.store_code,a.item_code");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_NON_ZERO","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE,  a.item_code ITEM_CODE from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F where a.item_code=b.item_code and a.store_code=c.store_code and  a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE  AND  A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y' AND A.QTY_ON_HAND > 0 order by a.store_code,a.item_code");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL","select DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, a.store_code STORE_CODE, a.item_code ITEM_CODE  from st_item_store a, st_item b,st_store c, mm_item d,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F where a.item_code=b.item_code and a.store_code=c.store_code and a.item_code=d.item_code and (a.item_code between NVL(?,'!') and NVL(?,'~')) and (c.store_code between NVL(?,'!') and NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) and (d.item_class_code between NVL(?,'!') and NVL(?,'~')) and (d.alpha_code between NVL(?,'!') and NVL(?,'~')) and (NVL(d.unit_cost,0) between NVL(?,0) and NVL(?,999999999999)) and a.phy_inv_id is null and a.stock_item_yn='Y' and c.var_allowed_yn='Y' and NVL(b.phy_inv_type,'%') like NVL(?,'%') and b.phy_inv_count_per_year=nvl(?,b.phy_inv_count_per_year) and b.expiry_yn like decode(?,'A','%',?) and nvl(d.item_anal1_code,'*') = nvl(?,nvl(d.item_anal1_code,'*')) and nvl(d.item_anal2_code,'*') = nvl(?,nvl(d.item_anal2_code,'*')) and nvl(d.item_anal3_code,'*') = nvl(?,nvl(d.item_anal3_code,'*')) and b.abc_class_code = nvl(?,b.abc_class_code) and (NVL(a.item_value,0) between NVL(?,0) and NVL(?,999999999999)) AND A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND  A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND A.QTY_ON_HAND >= 0 AND F.EFF_STATUS='Y' order by a.store_code,a.item_code");
//Modified ends
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_CURR_SPEC","SELECT curr_spec_phy_inv_id+1 curr_spec_phy FROM st_facility_param WHERE facility_id=?");
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_INSERT_HDR","INSERT INTO st_phy_inv_spec_item_hdr(FACILITY_ID,REMARKS,ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,SPEC_PHY_INV_ID) values(?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_INSERT_DTL","INSERT INTO st_phy_inv_spec_item_dtl(FACILITY_ID,ITEM_CODE, STORE_CODE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO, ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,SPEC_PHY_INV_ID) values(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_PARAM_SPEC","Update ST_FACILITY_PARAM set curr_spec_phy_inv_id=? where facility_id=?");   // Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_PARAM_SPEC","Update ST_FACILITY_PARAM set curr_spec_phy_inv_id=?, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=?  where facility_id=?");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_SELECT_DTL","SELECT DISTINCT a.item_code item_code,c.short_desc item_desc, a.store_code store_code,B.short_desc store_desc FROM st_phy_inv_spec_item_dtl a,mm_store_lang_vw B,mm_item_lang_vw c WHERE a.facility_id =? AND a.SPEC_PHY_INV_ID =?  AND a.item_code = c.item_code AND a.store_code = b.store_code AND b.language_id = c.language_id AND c.language_id = ?");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_SELECT_DTL","SELECT DISTINCT a.item_code item_code,c.short_desc item_desc, a.store_code store_code,B.short_desc store_desc FROM st_phy_inv_spec_item_dtl a,mm_store_lang_vw B,mm_item_lang_vw c WHERE a.facility_id =? AND a.SPEC_PHY_INV_ID =?  AND a.item_code = c.item_code AND a.store_code = b.store_code AND b.language_id = c.language_id AND c.language_id = ? ORDER BY ITEM_DESC");
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_SELECT_DTL","SELECT DISTINCT a.item_code item_code,c.short_desc item_desc, a.store_code store_code,B.short_desc store_desc,D.SHORT_DESC item_class_desc FROM st_phy_inv_spec_item_dtl a,mm_store_lang_vw B,mm_item_lang_vw c,MM_ITEM_CLASS_LANG_VW D WHERE a.facility_id =? AND a.SPEC_PHY_INV_ID =?  AND a.item_code = c.item_code AND a.store_code = b.store_code AND C.ITEM_CLASS_CODE = D.ITEM_CLASS_CODE AND b.language_id = c.language_id and c.language_id = D.language_id  AND c.language_id = ? ORDER BY ITEM_DESC");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_HDR","UPDATE st_phy_inv_spec_item_hdr set REMARKS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=TO_DATE(SYSDATE,'dd/mm/yyyy'), MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? where FACILITY_ID = ? and SPEC_PHY_INV_ID = ?");  //  Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_HDR","UPDATE st_phy_inv_spec_item_hdr set REMARKS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? where FACILITY_ID = ? and SPEC_PHY_INV_ID = ?"); 
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_DELETE_DTL_TEMP","delete from st_phy_inv_spec_item_dtl where spec_phy_inv_id=? and FACILITY_ID=?");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_STORE","Update ST_ITEM_STORE set phy_inv_id=?, phy_inv_start_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), modified_at_ws_no=?, modified_facility_id=? where store_code=? and item_code=?"); // Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_STORE","Update ST_ITEM_STORE set phy_inv_id=?, phy_inv_start_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where store_code=? and item_code=?");
//dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_BATCH","Update ST_ITEM_BATCH set phy_inv_id=?, phy_inv_start_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), modified_at_ws_no=?, modified_facility_id=? where store_code=? and item_code=?"); // Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_UPDATE_BATCH","Update ST_ITEM_BATCH set phy_inv_id=?, phy_inv_start_date=TO_DATE(SYSDATE,'dd/mm/yyyy'), phy_inv_start_qty=qty_on_hand, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where store_code=? and item_code=?");
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_DELETE_HDR_TEMP","delete from st_phy_inv_spec_item_hdr where spec_phy_inv_id=? and FACILITY_ID = ?");
dataMap.put("SQL_ST_PHY_INV_FOR_SPECIFIC_ITEM_DTL_MAX_MIN","select MAX(item_code) max_item ,MIN(item_code) min_item ,MAX(store_code) max_store ,MIN(store_code) min_store from st_phy_inv_spec_item_dtl where facility_id=? and spec_phy_inv_id=?");

dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR22","INSERT into st_phy_inv_hdr(FACILITY_ID, PHY_INV_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, STORE_CODE, ITEM_CODE) values(?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_REMARKS","select remarks from st_phy_inv_spec_item_hdr where FACILITY_ID= ? and SPEC_PHY_INV_ID= ?");

//Physical Inventory Entry

dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_PHY_ID_HDR","SELECT PHY_INV_ID,PHY_INV_ID FROM st_phy_inv_param WHERE facility_id=? and posted_date is null and cancelled_date is null AND ENTRY_COMPLETED_YN = 'N' ORDER BY 1");
dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_PHY_ID_SELECT_HDR","SELECT a.phy_inv_id phy_inv_id, b.short_desc store_desc,c.short_desc item_desc, a.store_code store_code ,a.item_code item_code FROM st_phy_inv_hdr a, mm_store_lang_vw b, mm_item_lang_vw c WHERE a.phy_inv_id = NVL(?,a.phy_inv_id) AND a.store_code = NVL(?,a.store_code) AND a.item_code =NVL(?,a.item_code) AND a.facility_id=? AND a.item_code = c.item_code AND a.store_code = b.store_code AND b.language_id = c.language_id AND b.language_id = ? ORDER BY ITEM_DESC");
dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_COUNT_SHEET_DATE","SELECT TO_CHAR(COUNT_SHEET_DATE,'dd/mm/yyyy') COUNT_SHEET_DATE FROM st_phy_inv_param WHERE facility_id=? AND PHY_INV_ID=?");
dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_COUNT_SHEET_INSERT_DTL","INSERT INTO ST_PHY_INV_DTL(FACILITY_ID,PHY_INV_ID,STORE_CODE,ITEM_CODE,BATCH_ID,STOCK_ITEM_YN,ITEM_QTY,EXPIRY_DATE_OR_RECEIPT_DATE,BIN_LOCATION_CODE,TRADE_ID,NEW_BATCH_YN,ITEM_VALUE,ENTRY_COMPLETED_YN,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,'Y',?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_COUNT_SHEET_TRADE_ID_BY_ITEM","SELECT a.trade_id trade_id, b.short_name trade_name from mm_trade_name_for_item a, am_trade_name_lang_vw b, st_item c where a.trade_id=b.trade_id and a.item_code=c.item_code and c.trade_id_applicable_yn='Y' and c.item_code=? AND b.language_id = ? UNION SELECT a.dflt_trade_id trade_id, a.dflt_trade_id trade_name from mm_parameter a, st_item b where  b.trade_id_applicable_yn='N' and b.item_code=?");
dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_BIN_BY_BIN_CODE","SELECT short_desc FROM mm_bin_location_lang_vw WHERE bin_location_code =? AND eff_status ='E' AND language_id = ?");
dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_SELECT_PHY_INV_DTL","SELECT BATCH_ID,ITEM_QTY,TO_CHAR(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,BIN_LOCATION_CODE BIN_LOC_CODE,TRADE_ID,NEW_BATCH_YN  FROM st_phy_inv_dtl WHERE FACILITY_ID=? AND PHY_INV_ID=? AND STORE_CODE=? AND ITEM_CODE=? AND STOCK_ITEM_YN ='Y'");
dataMap.put("SQL_ST_PHYSICAL_INVENTORY_ENTRY_DELETE_PHY_INV_DTL","DELETE FROM st_phy_inv_dtl WHERE FACILITY_ID=? AND PHY_INV_ID=? AND STORE_CODE=? AND ITEM_CODE=? AND STOCK_ITEM_YN ='Y'");

//Added on 25.05.2005
dataMap.put("SQL_ST_PHY_INV_COUNT","select count(*) total from st_item_store where item_code=? and store_code in(?,?) and phy_inv_id IS NOT NULL");

//Period End 
dataMap.put("SQL_ST_ADJ_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_adj_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_GRN_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_grn_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_ISSUE_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_issue_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_ISSUE_RET_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_issue_ret_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_MFG_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_mfg_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_PROD_TRANSFER_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_prod_transfer_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_RTV_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_rtv_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_SAL_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_sal_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_SAL_RET_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_sal_ret_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_ST_TRANSFER_HDR_SELECT_FOR_PERIOD_END",	"SELECT COUNT(*) total FROM st_transfer_hdr WHERE st_get_post_mth_yr(doc_date)=? AND facility_id IN (@)");
dataMap.put("SQL_SM_ACC_ENTITY_PARAM_FACL_SELECT_FACILITY","SELECT facility_id FROM sm_acc_entity_param_facl WHERE acc_entity_id=?");
dataMap.put("SQL_ST_PARAMETER_UPDATE_FOR_PERIOD_END",	"UPDATE ST_FACILITY_PARAM SET curr_proc_month=?, curr_proc_year=?, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id IN (@)");
dataMap.put("SQL_ST_ACC_ENTITY_PARAM_UPDATE_FOR_PERIOD_END",	"UPDATE ST_ACC_ENTITY_PARAM SET curr_proc_month=?, curr_proc_year=?, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE acc_entity_id=?");
dataMap.put("SQL_ST_PARAMETER_SELECT_VALID_FOR_PERIOD_END",	"SELECT SIGN(TRUNC(SYSDATE)-TRUNC(acc_per_end_date)) days FROM ST_FACILITY_PARAM ss, sy_acc_period_defn sy WHERE ss.curr_proc_month=sy.acc_per_month AND ss.curr_proc_year=sy.acc_per_year AND ss.facility_id=?");
//dataMap.put("SQL_ST_ITM_MOV_SUMM_INSERT_FOR_PERIOD_END","insert into st_item_move_summ (FACILITY_ID, ITEM_CODE, STORE_CODE, MOVE_YEAR, MOVE_MONTH, MONTH_OPENING_QTY, MONTH_OPENING_VALUE, MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) select FACILITY_ID, ITEM_CODE, STORE_CODE, decode(move_month,12,MOVE_YEAR+1,move_year), decode(MOVE_MONTH,12,1,move_month+1), MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, ?, SYSDATE, ?, FACILITY_ID, ?, SYSDATE, ?, FACILITY_ID from st_item_move_summ where move_year=? and move_month=? and (MONTH_CLOSING_QTY > 0 or MONTH_CLOSING_VALUE > 0) and facility_id IN (@)");

dataMap.put("SQL_ST_ITM_MOV_SUMM_INSERT_FOR_PERIOD_END","insert into st_item_move_summ (FACILITY_ID, ITEM_CODE, STORE_CODE, MOVE_YEAR, MOVE_MONTH, MONTH_OPENING_QTY, MONTH_OPENING_VALUE, MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) select FACILITY_ID, ITEM_CODE, STORE_CODE, decode(move_month,12,MOVE_YEAR+1,move_year), decode(MOVE_MONTH,12,1,move_month+1), MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, ?, SYSDATE, ?, FACILITY_ID, ?, SYSDATE, ?, FACILITY_ID from st_item_move_summ where move_year=? and move_month=? and (MONTH_CLOSING_QTY > 0 or MONTH_CLOSING_VALUE > 0) and facility_id = ?");

dataMap.put("SQL_ST_CHECK_VALUE_PERIOD_END","select MONTH_OPENING_QTY, MONTH_OPENING_VALUE, MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, STORE_CODE, ITEM_CODE from st_item_move_summ where move_year=decode(?,12,?+1,?) and move_month=decode(?,12,1,?+1) and facility_id =?");

//PRATYUS PERIOD END
dataMap.put("SQL_ST_UPDATE_VALUE_PERIOD_END","update st_item_move_summ set MONTH_OPENING_QTY = MONTH_OPENING_QTY+?, MONTH_OPENING_VALUE = MONTH_OPENING_VALUE+?, MONTH_CLOSING_QTY = MONTH_CLOSING_QTY+?, MONTH_CLOSING_VALUE = MONTH_CLOSING_VALUE+?,modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=? Where move_year=? and move_month=? and facility_id=?  and STORE_CODE =? and ITEM_CODE =?");
//dataMap.put("SQL_ST_ITEM_MOVE_SUMM_CHECK_VALUE_PERIOD_END","SELECT MONTH_OPENING_QTY,MONTH_OPENING_VALUE,MONTH_CLOSING_QTY,MONTH_CLOSING_VALUE,FACILITY_ID,ITEM_CODE,STORE_CODE,MOVE_YEAR,MOVE_MONTH FROM ST_ITEM_MOVE_SUMM WHERE MOVE_MONTH = ? AND MOVE_YEAR = ? ");
//Modified by suresh.r on 24-11-2014 against Inc 52256
dataMap.put("SQL_ST_ITEM_MOVE_SUMM_CHECK_VALUE_PERIOD_END","SELECT MONTH_OPENING_QTY,MONTH_OPENING_VALUE,MONTH_CLOSING_QTY,MONTH_CLOSING_VALUE,FACILITY_ID,ITEM_CODE,STORE_CODE,MOVE_YEAR,MOVE_MONTH FROM ST_ITEM_MOVE_SUMM WHERE MOVE_MONTH = ? AND MOVE_YEAR = ? AND FACILITY_ID= ?");
dataMap.put("SQL_ST_ITEM_MOVE_SUMM_COUNT_CHECK","SELECT COUNT(*) TOTAL FROM ST_ITEM_MOVE_SUMM WHERE MOVE_MONTH = ? AND MOVE_YEAR = ? AND FACILITY_ID = ? AND STORE_CODE = ? AND ITEM_CODE = ?");
dataMap.put("SQL_ST_ITM_MOV_SUMM_INSERT_PERIOD_END","insert into st_item_move_summ (FACILITY_ID, ITEM_CODE, STORE_CODE, MOVE_YEAR, MOVE_MONTH, MONTH_OPENING_QTY, MONTH_OPENING_VALUE, MONTH_CLOSING_QTY, MONTH_CLOSING_VALUE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?, ?, ?,?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");


//Query for Stock Status by Store - senthil kumar

//dataMap.put("SQL_ST_STOCK_STATUS_BY_STORE_ITEM_STORE","SELECT A.STORE_CODE code,A.SHORT_DESC description  FROM mm_store A, ST_USER_ACCESS_FOR_STORE B WHERE  USER_ID LIKE ? AND A.STORE_CODE	LIKE UPPER(?) AND UPPER(A.SHORT_DESC)	LIKE UPPER(?) AND A.eff_status='E' AND A.STORE_CODE = B.STORE_CODE ORDER BY 2	");  // Modified By Ram on 1/6/2006 for restricting Non Stock Store
dataMap.put("SQL_ST_STOCK_STATUS_BY_STORE_ITEM_STORE","SELECT A.STORE_CODE  code,A.SHORT_DESC  description  FROM  mm_store_lang_vw  A, ST_STORE  C  WHERE A.language_id LIKE   ?  and a.facility_id like ?  AND                           A.STORE_CODE	 LIKE  UPPER (?)   AND  UPPER(A.SHORT_DESC)	 LIKE  UPPER(?)  AND  A.eff_status='E' AND  A.STORE_CODE = C.STORE_CODE  AND  C.STORE_TYPE_FLAG != 'N' ORDER BY 2");

// dataMap.put("SQL_ST_STOCK_STATUS_BY_STORE","SELECT A.STORE_CODE, B.SHORT_DESC STORE_DESC, A.ITEM_CODE, C.SHORT_DESC ITEM_DESC, A.STOCK_ITEM_YN, NVL(A.QTY_ON_HAND,0) QTY_ON_HAND,C.GEN_UOM_CODE, D.SHORT_DESC UOM_DESC, ROUND((NVL((ROUND(A.ITEM_VALUE,3)),0)/DECODE(NVL(A.QTY_ON_HAND,0),0,1,A.QTY_ON_HAND)),3) UNIT_COST, ITEM_VALUE FROM ST_ITEM_STORE A, MM_STORE B, MM_ITEM C, AM_UOM D WHERE A.STORE_CODE=B.STORE_CODE AND A.ITEM_CODE=C.ITEM_CODE AND C.GEN_UOM_CODE=D.UOM_CODE AND A.STORE_CODE LIKE UPPER(?) AND A.ITEM_CODE LIKE UPPER(?) AND ( (NVL(A.qty_on_hand,0) >= 0 AND 'A'= ? ) OR (NVL(A.qty_on_hand,0) >0   AND 'S' = ? ) OR (NVL(A.qty_on_hand,0) =0   AND 'Z' = ? ) OR (NVL(A.qty_on_hand,0) < NVL(reorder_level,0) AND 'B' = ? )) AND (A.STOCK_ITEM_YN LIKE UPPER(?)  ) AND B.EFF_STATUS='E' ");  // Modified By Ram on 1/6/2006 for restricting Non Stock Store
dataMap.put("SQL_ST_STOCK_STATUS_BY_STORE","SELECT a.store_code, b.short_desc store_desc, a.item_code,c.short_desc item_desc, a.stock_item_yn,NVL (a.qty_on_hand, 0) qty_on_hand, c.gen_uom_code,d.short_desc uom_desc,ROUND ((NVL ((ROUND (a.item_value, 3)), 0)/ DECODE (NVL (a.qty_on_hand, 0), 0, 1, a.qty_on_hand)),3) unit_cost, item_value,nvl((SELECT eqvl_value FROM mm_item_uom_defn WHERE item_code = a.item_code AND eqvl_uom_code = a.def_issue_uom AND uom_code = c.gen_uom_code UNION SELECT eqvl_value FROM AM_UOM_EQVL WHERE eqvl_uom_code = a.def_issue_uom AND uom_code = c.gen_uom_code ),1)eqvl_value, f.short_desc stock_uom_desc FROM st_item_store a, mm_store_lang_vw b, mm_item_lang_vw c, am_uom_lang_vw d, am_uom_lang_vw f, st_store e WHERE a.store_code = b.store_code AND a.item_code = c.item_code AND c.gen_uom_code = d.uom_code AND a.def_issue_uom = f.uom_code AND f.language_id = d.language_id AND a.store_code LIKE UPPER (?) AND a.item_code LIKE UPPER (?) AND (   (NVL (a.qty_on_hand, 0) >= 0 AND 'A' = ?)       OR (NVL (a.qty_on_hand, 0) > 0 AND 'S' = ?) OR (NVL (a.qty_on_hand, 0) = 0 AND 'Z' = ?) OR (NVL (a.qty_on_hand, 0) < NVL (reorder_level, 0) AND 'B' = ?)) AND (a.stock_item_yn LIKE UPPER (?)) AND b.eff_status = 'E' AND e.store_code = b.store_code AND e.store_type_flag != 'N' AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ? AND NVL (c.item_class_code, 'X') BETWEEN NVL(?,NVL (c.item_class_code,'X')) AND NVL(?,NVL (c.item_class_code,'X')) AND NVL (c.item_anal1_code, 'X') BETWEEN NVL(?,NVL (c.item_anal1_code,'X')) AND NVL(?,NVL (c.item_anal1_code,'X')) AND NVL (c.item_anal2_code, 'X') BETWEEN NVL(?,NVL (c.item_anal2_code,'X')) AND NVL(?,NVL (c.item_anal2_code,'X')) AND NVL (c.item_anal3_code, 'X') BETWEEN NVL(?,NVL (c.item_anal3_code,'X')) AND NVL(?,NVL (c.item_anal3_code,'X')) and b.facility_id =? ");
//Query for Stock Status by Store List Detail
dataMap.put("SQL_ST_STOCK_STATUS_BY_STORE_DETAIL_LIST","select store_desc,item_desc,batch_id, to_char(expiry_date,'dd/mm/yyyy') expiry_date , bin_desc , NVL(qty_on_hand,0) qty_on_hand , trade_name  from st_batch_search_lang_view  where store_code=? and item_code =? AND language_id = ? AND DECODE(lang1,NULL,?,lang1)=? AND DECODE(lang2,NULL,?,lang2)=?");
//Query for RequestStatus 
dataMap.put("SQL_ST_REQUEST_STATUS_HDR_QUERY_RESULT","SELECT hdr.doc_type_code,	sy.short_desc doc_type_desc,hdr.doc_no,	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.req_by_store_code,	 rbys.short_desc req_by_store_desc,hdr.req_on_store_code,  rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc ,DECODE(hdr.request_status,'E','Request Entered','W','Authorized at Req by Store','A','Authorized at Issue Store','P','Partially Issued','C','Fully Issued','L','Closed/Cancelled') request_status, hdr.cancelled_remarks, hdr.cancelled_by_id, hdr.added_by_id, hdr.req_authorized_by_id, hdr.modified_by_id, TO_CHAR(hdr.modified_date,'dd/mm/yyyy') modified_date,   sm.appl_user_name cancelled_by_name, sn.appl_user_name authorized_by_name,  so.appl_user_name added_by_name,  sp.appl_user_name modified_by_name,hdr.SCH_CODE SCH_CODE   FROM	ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm,	sy_doc_type_master_lang_vw sy, sm_appl_user_lang_vw sm, 	   sm_appl_user_lang_vw sn, sm_appl_user_lang_vw so, sm_appl_user_lang_vw sp WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.doc_type_code like ?	AND	TO_CHAR(hdr.doc_no)	like  ?	AND	(doc_date BETWEEN TO_DATE(nvl(?,'01/01/1901'),'dd/mm/yyyy')	AND	TO_DATE(nvl(?,'31/12/3012'),'dd/mm/yyyy')) AND hdr.req_by_store_code like ?	AND	hdr.req_on_store_code like ? AND  NVL(hdr.item_class_code, '%') like  ? AND rbys.external_yn LIKE DECODE(?,'Y','Y','N','N','%') AND hdr.request_status LIKE ?  AND hdr.request_type like ? AND (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) in (select facility_id, doc_type_code, doc_no from st_request_dtl where facility_id=hdr.facility_id and doc_type_code=hdr.doc_type_code and  doc_no=hdr.doc_no and item_code LIKE upper(?)) AND rbys.language_id = ? AND rbys.language_id = rons.language_id AND rbys.language_id = sy.language_id AND itm.language_id(+) = ? and rons.facility_id = ? AND sm.appl_user_id(+) = cancelled_by_id AND sn.appl_user_id(+) = hdr.req_authorized_by_id AND so.appl_user_id(+) = hdr.added_by_id AND sp.appl_user_id(+) = hdr.modified_by_id AND sm.language_id(+) = ? AND sn.language_id(+) = ? AND so.language_id(+) = ? AND sp.language_id(+) = ?");

//added Monday, August 27, 2012
//dataMap.put("SQL_ST_REQUEST_STATUS_HDR_QUERY_RESULT_FOR_ALL","SELECT hdr.doc_type_code,	sy.short_desc doc_type_desc,hdr.doc_no,	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.req_by_store_code,	 rbys.short_desc req_by_store_desc,hdr.req_on_store_code,  rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc ,DECODE((st_req_status_chk (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)), 'PAI', 'Partially Authorised/Issued At Issue Store', 'PA', 'Partially Authorised at Issue Store',    'FAPI', 'Fully Authorised/Partially Issued At Issue Store', 'FA', 'Fully Authorized at Issue Store',           'L', 'Cancelled','C','Issue Closed','E', 'Request Entered At Request Store', 'W', 'Authorised At Request By Store','FAFI','Fully Authorized/Issued at Issue Store') request_status, hdr.cancelled_remarks, hdr.cancelled_by_id, hdr.added_by_id, hdr.req_authorized_by_id, hdr.modified_by_id,DECODE((St_Req_Ack_Status (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)),'FAK','Fully Acknowledged',					  'PA','Partially Acknowledged', 'AKP','Acknowledgement Pending',	'PACP','Partially Acknowledged/Confirmation Pending',	'FACC','Fully Acknowledged/Confirmation Complete',					'PACC','Partially Acknowledged/Confirmation Complete',	'FACP','Fully Acknowledged/Confirmation Pending') ack_status, TO_CHAR(hdr.modified_date,'dd/mm/yyyy') modified_date,   sm.appl_user_name cancelled_by_name, sn.appl_user_name authorized_by_name,  so.appl_user_name added_by_name,  sp.appl_user_name modified_by_name,hdr.SCH_CODE SCH_CODE ,hdr.TRN_TYPE  FROM	ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm,	sy_doc_type_master_lang_vw sy, sm_appl_user_lang_vw sm, 	   sm_appl_user_lang_vw sn, sm_appl_user_lang_vw so, sm_appl_user_lang_vw sp,ST_ACC_ENTITY_PARAM sa WHERE hdr.doc_type_code = sy.doc_type_code	AND	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) And hdr.facility_id LIKE DECODE (sa.trn_across_facility_yn, 'Y', '%', ?) AND hdr.doc_type_code = nvl(?,hdr.doc_type_code)	AND	TO_CHAR(hdr.doc_no)	= nvl(?,TO_CHAR(hdr.doc_no))	AND	(doc_date BETWEEN TO_DATE(?,'dd/mm/yyyy')	AND	TO_DATE(nvl(?,'31/12/3012'),'dd/mm/yyyy')) AND hdr.req_by_store_code = nvl(?,hdr.req_by_store_code)	AND	hdr.req_on_store_code = nvl(?,hdr.req_on_store_code) AND  NVL(hdr.item_class_code, '%') like  ? AND rbys.external_yn LIKE DECODE(?,'Y','Y','N','N','%') AND  (st_req_status_chk (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)) LIKE ? AND hdr.request_type like ? AND (St_Req_Ack_Status (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)) LIKE ? AND (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) in (select facility_id, doc_type_code, doc_no from st_request_dtl where facility_id=hdr.facility_id and doc_type_code=hdr.doc_type_code and  doc_no=hdr.doc_no and item_code LIKE upper(?)) AND rbys.language_id = ? AND rbys.language_id = rons.language_id AND rbys.language_id = sy.language_id AND itm.language_id(+) = ? /*and rons.facility_id = ? */AND sm.appl_user_id(+) = cancelled_by_id AND sn.appl_user_id(+) = hdr.req_authorized_by_id AND so.appl_user_id(+) = hdr.added_by_id AND sp.appl_user_id(+) = hdr.modified_by_id AND sm.language_id(+) = ? AND sn.language_id(+) = ? AND so.language_id(+) = ? AND sp.language_id(+) = ?");
//Modified by Sakti to pass the parameters dynamically for performance issue
//dataMap.put("SQL_ST_REQUEST_STATUS_HDR_QUERY_RESULT_FOR_ALL","SELECT hdr.doc_type_code,(select sy.short_desc from  sy_doc_type_master_lang_vw  sy where   sy.doc_type_code =hdr.doc_type_code and  sy.language_id=rbys.language_id)doc_type_desc,hdr.doc_no,	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.req_by_store_code,	 rbys.short_desc req_by_store_desc,hdr.req_on_store_code,  rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc ,DECODE((st_req_status_chk (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)), 'PAI', 'Partially Authorised/Issued At Issue Store', 'PA', 'Partially Authorised at Issue Store',    'FAPI', 'Fully Authorised/Partially Issued At Issue Store', 'FA', 'Fully Authorized at Issue Store',           'L', 'Cancelled','C','Issue Closed','E', 'Request Entered At Request Store', 'W', 'Authorised At Request By Store','FAFI','Fully Authorized/Issued at Issue Store','I','Force Closed') request_status, hdr.cancelled_remarks, hdr.cancelled_by_id, hdr.added_by_id, hdr.req_authorized_by_id, hdr.modified_by_id,DECODE((St_Req_Ack_Status (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)),'FAK','Fully Acknowledged',  'PA','Partially Acknowledged', 'AKP','Acknowledgement Pending',	'PACP','Partially Acknowledged/Confirmation Pending',	'FACC','Fully Acknowledged/Confirmation Complete',	'PACC','Partially Acknowledged/Confirmation Complete',	'FACP','Fully Acknowledged/Confirmation Pending') ack_status, TO_CHAR(hdr.modified_date,'dd/mm/yyyy') modified_date,  (select sm.appl_user_name  from sm_appl_user_lang_vw sm where   sm.appl_user_id= cancelled_by_id  and sm.language_id=?) cancelled_by_name,  (select  sn.appl_user_name  from sm_appl_user_lang_vw sn where  sn.appl_user_id= hdr.req_authorized_by_id   and sn.language_id=?) authorized_by_name,  (select so.appl_user_name from sm_appl_user_lang_vw so where   so.appl_user_id = hdr.added_by_id and   so.language_id = ?) added_by_name,  (select sp.appl_user_name  from sm_appl_user_lang_vw sp  where   sp.appl_user_id = hdr.modified_by_id  and sp.language_id = ?)  modified_by_name,hdr.SCH_CODE SCH_CODE ,hdr.TRN_TYPE  FROM	ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm,ST_ACC_ENTITY_PARAM sa WHERE 	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) And hdr.facility_id = DECODE (sa.trn_across_facility_yn, 'Y', '%', ?) AND	(doc_date BETWEEN TO_DATE(?,'dd/mm/yyyy')	AND	TO_DATE(nvl(?,'31/12/3012'),'dd/mm/yyyy')) AND rbys.external_yn = DECODE(?,'Y','Y','N','N','%') AND rbys.language_id = ? AND rbys.language_id = rons.language_id AND itm.language_id(+) = ?");// commented for BRU-SCF-1492 - LK
dataMap.put("SQL_ST_REQUEST_STATUS_HDR_QUERY_RESULT_FOR_ALL","SELECT hdr.doc_type_code,(select sy.short_desc from  sy_doc_type_master_lang_vw  sy where   sy.doc_type_code =hdr.doc_type_code and  sy.language_id=rbys.language_id)doc_type_desc,hdr.doc_no,	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.req_by_store_code,	 rbys.short_desc req_by_store_desc,hdr.req_on_store_code,  rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc ,DECODE((st_req_status_chk (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)), 'PAI', 'Partially Authorised/Issued At Issue Store', 'PA', 'Partially Authorised at Issue Store',    'FAPI', 'Fully Authorised/Partially Issued At Issue Store', 'FA', 'Fully Authorized at Issue Store',           'L', 'Cancelled','C','Issue Closed','E', 'Request Entered At Request Store', 'W', 'Authorised At Request By Store','FAFI','Fully Authorized/Issued at Issue Store','I','Force Closed','R', 'Rejected At Issue Store ') request_status, hdr.cancelled_remarks, hdr.cancelled_by_id, hdr.added_by_id, hdr.req_authorized_by_id, hdr.modified_by_id,DECODE((St_Req_Ack_Status (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)),'FAK','Fully Acknowledged',  'PA','Partially Acknowledged', 'AKP','Acknowledgement Pending',	'PACP','Partially Acknowledged/Confirmation Pending',	'FACC','Fully Acknowledged/Confirmation Complete',	'PACC','Partially Acknowledged/Confirmation Complete',	'FACP','Fully Acknowledged/Confirmation Pending') ack_status, TO_CHAR(hdr.modified_date,'dd/mm/yyyy') modified_date,  (select sm.appl_user_name  from sm_appl_user_lang_vw sm where   sm.appl_user_id= cancelled_by_id  and sm.language_id=?) cancelled_by_name,  (select  sn.appl_user_name  from sm_appl_user_lang_vw sn where  sn.appl_user_id= hdr.req_authorized_by_id   and sn.language_id=?) authorized_by_name,  (select so.appl_user_name from sm_appl_user_lang_vw so where   so.appl_user_id = hdr.added_by_id and   so.language_id = ?) added_by_name,  (select sp.appl_user_name  from sm_appl_user_lang_vw sp  where   sp.appl_user_id = hdr.modified_by_id  and sp.language_id = ?)  modified_by_name,hdr.SCH_CODE SCH_CODE ,hdr.TRN_TYPE , REJECTED_BY_ID FROM	ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm,ST_ACC_ENTITY_PARAM sa WHERE 	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) And hdr.facility_id = DECODE (sa.trn_across_facility_yn, 'Y', hdr.facility_id, ?) AND	(doc_date BETWEEN TO_DATE(?,'dd/mm/yyyy')	AND	TO_DATE(nvl(?,'31/12/3012'),'dd/mm/yyyy')) AND rbys.external_yn = DECODE(?,'Y','Y','N','N','%') AND rbys.language_id = ? AND rbys.language_id = rons.language_id AND itm.language_id(+) = ?"); // modified for BRU-SCF-1492 - LK//added 'R' status for MO-CRF-20174 


dataMap.put("SQL_ST_REQUEST_STATUS_HDR_QUERY_RESULT_FOR_PARTIAL_ISSUE","SELECT hdr.doc_type_code,	(select  sy.short_desc from  sy_doc_type_master_lang_vw sy where sy.doc_type_code = hdr.doc_type_code and  sy.language_id = rbys.language_id) doc_type_desc,hdr.doc_no,	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.req_by_store_code,	 rbys.short_desc req_by_store_desc,hdr.req_on_store_code,  rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc ,DECODE((st_req_status_chk (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)), 'PAI', 'Partially Authorised/Issued At Issue Store', 'PA', 'Partially Authorised',    'FAPI', 'Fully Authorised/Partially Issued At Issue Store', 'FA', 'Fully Authorised','L', 'Closed/Canceled','E', 'Request Entered At Request Store', 'W', 'Authorised At Requesting Store' ,'I','Force Closed') request_status, hdr.cancelled_remarks, hdr.cancelled_by_id, hdr.added_by_id, hdr.req_authorized_by_id, hdr.modified_by_id,DECODE((St_Req_Ack_Status (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)),'FAK','Fully Acknowledged',	'PA','Partially Acknowledged', 'AKP','Acknowledgement Pending',	'PACP','Partially Acknowledged/Confirmation Pending',	'FACC','Fully Acknowledged/Confirmation Complete',	'PACC','Partially Acknowledged/Confirmation Complete',	'FACP','Fully Acknowledged/Confirmation Pending') ack_status, TO_CHAR(hdr.modified_date,'dd/mm/yyyy') modified_date,(select sm.appl_user_name from sm_appl_user_lang_vw sm  where  sm.appl_user_id = cancelled_by_id and sm.language_id = ? ) cancelled_by_name, (select  sn.appl_user_name from sm_appl_user_lang_vw sn where sn.appl_user_id = hdr.req_authorized_by_id and sn.language_id = ?)   authorized_by_name,       (select so.appl_user_name  from sm_appl_user_lang_vw so  where    so.appl_user_id = hdr.added_by_id    AND so.language_id = ?)added_by_name,  (select  sp.appl_user_name from sm_appl_user_lang_vw sp  where  sp.appl_user_id = hdr.modified_by_id  and sp.language_id = ?)   modified_by_name,      hdr.SCH_CODE SCH_CODE ,hdr.TRN_TYPE  FROM	ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm,	ST_ACC_ENTITY_PARAM sa WHERE  	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) And hdr.facility_id = DECODE (sa.trn_across_facility_yn, 'Y', hdr.facility_id, ?) AND	(doc_date BETWEEN TO_DATE(?,'dd/mm/yyyy')	AND	TO_DATE(nvl(?,'31/12/3012'),'dd/mm/yyyy')) AND rbys.external_yn = DECODE(?,'Y','Y','N','N','%') AND  (ST_REQ_STATUS_CHK (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) = 'FAPI' OR  ST_REQ_STATUS_CHK (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) = 'PAI') AND rbys.language_id = ? AND rbys.language_id = rons.language_id  AND  itm.language_id(+) = ?");

dataMap.put("SQL_ST_REQUEST_STATUS_HDR_QUERY_RESULT_FOR_PRO","SELECT hdr.doc_type_code,	sy.short_desc doc_type_desc,hdr.doc_no,	TO_CHAR(hdr.doc_date,'dd/mm/yyyy') doc_date, hdr.req_by_store_code,	 rbys.short_desc req_by_store_desc,hdr.req_on_store_code,  rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc ,DECODE((st_req_status_chk (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)), 'PAI', 'Partially Authorised/Issued At Issue Store', 'PA', 'Partially Authorised',    'FAPI', 'Fully Authorised/Partially Issued At Issue Store', 'FA', 'Fully Authorised','L', 'Closed/Canceled','E', 'Request Entered At Request Store', 'W', 'Authorised At Requesting Store') request_status, hdr.cancelled_remarks, hdr.cancelled_by_id, hdr.added_by_id, hdr.req_authorized_by_id, hdr.modified_by_id,DECODE((St_Req_Ack_Status (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)),'FAK','Fully Acknowledged',					  'PA','Partially Acknowledged', 'AKP','Acknowledgement Pending',	'PACP','Partially Acknowledged/Confirmation Pending',	'FACC','Fully Acknowledged/Confirmation Complete',					'PACC','Partially Acknowledged/Confirmation Complete',	'FACP','Fully Acknowledged/Confirmation Pending') ack_status, TO_CHAR(hdr.modified_date,'dd/mm/yyyy') modified_date,   sm.appl_user_name cancelled_by_name, sn.appl_user_name authorized_by_name,  so.appl_user_name added_by_name,  sp.appl_user_name modified_by_name,hdr.SCH_CODE SCH_CODE ,hdr.TRN_TYPE  FROM	ST_REQUEST_HDR hdr, mm_store_lang_vw rbys,mm_store_lang_vw rons, mm_item_class_lang_vw itm,	sy_doc_type_master_lang_vw sy, sm_appl_user_lang_vw sm, 	   sm_appl_user_lang_vw sn, sm_appl_user_lang_vw so, sm_appl_user_lang_vw sp,ST_ACC_ENTITY_PARAM sa WHERE  hdr.doc_type_code = sy.doc_type_code	AND	hdr.req_by_store_code=	rbys.store_code	AND	 hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) And hdr.facility_id LIKE DECODE (sa.trn_across_facility_yn, 'Y', '%', ?) AND    hdr.doc_type_code = nvl(?,hdr.doc_type_code)  AND	TO_CHAR(hdr.doc_no)	= nvl(?,TO_CHAR(hdr.doc_no)) AND	(doc_date BETWEEN TO_DATE(?,'dd/mm/yyyy')	AND	TO_DATE(nvl(?,'31/12/3012'),'dd/mm/yyyy')) AND hdr.req_by_store_code = nvl(?,hdr.req_by_store_code)	AND	hdr.req_on_store_code = nvl(?,hdr.req_on_store_code)  AND  NVL(hdr.item_class_code, '%') like  ? AND rbys.external_yn LIKE DECODE(?,'Y','Y','N','N','%') AND  hdr.request_status like ? AND  (ST_REQ_STATUS_CHK (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) = 'FAPI' OR  ST_REQ_STATUS_CHK (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) = 'PAI') AND hdr.request_type like ? AND (St_Req_Ack_Status (hdr.facility_id, hdr.doc_type_code, hdr.doc_no)) LIKE ? AND (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) in (select facility_id, doc_type_code, doc_no from st_request_dtl where facility_id=hdr.facility_id and doc_type_code=hdr.doc_type_code and  doc_no=hdr.doc_no and item_code LIKE upper(?)) AND rbys.language_id = ? AND rbys.language_id = rons.language_id AND rbys.language_id = sy.language_id AND itm.language_id(+) = ? /*and rons.facility_id = ? */AND sm.appl_user_id(+) = cancelled_by_id AND sn.appl_user_id(+) = hdr.req_authorized_by_id AND so.appl_user_id(+) = hdr.added_by_id AND sp.appl_user_id(+) = hdr.modified_by_id AND sm.language_id(+) = ? AND sn.language_id(+) = ? AND so.language_id(+) = ? AND sp.language_id(+) = ?");


//Query for Request status Detail list
dataMap.put("SQL_ST_REQUEST_STATUS_BY_STORE_SELECT_LIST","SELECT st.store_code,	mm.short_desc FROM st_store	st, mm_store_lang_vw mm WHERE st.store_code = mm.store_code  AND st.req_allowed_yn='Y' AND mm.facility_id	=? AND mm.language_id = ? order by	 2");
dataMap.put("SQL_ST_REQUEST_STATUS_ON_STORE_SELECT_LIST","SELECT DISTINCT STP.PARENT_STORE_CODE, MM.SHORT_DESC FROM ST_STORE_PARENT_STORE STP,MM_STORE_LANG_VW MM, ST_STORE ST,ST_ACC_ENTITY_PARAM SP WHERE STP.PARENT_STORE_CODE = MM.STORE_CODE AND MM.EFF_STATUS = 'E'  AND ST.STORE_CODE = MM.STORE_CODE  AND ST.ISS_ALLOWED_YN = 'Y' AND MM.FACILITY_ID LIKE DECODE(SP.TRN_ACROSS_FACILITY_YN,'Y','%',?) AND MM.LANGUAGE_ID = ? AND STP.STORE_CODE = ? ORDER BY 2");

dataMap.put("SQL_ST_REQUEST_STATUS_DTL_SELECT","SELECT   doc_no, doc_srl_no, dtl.item_code, itm.short_desc item_desc, req_item_qty, iss_item_qty, NVL (pending_item_qty, 0) pending_item_qty, gen_uom_code, am.short_desc gen_short_desc FROM st_request_dtl dtl, mm_item_lang_vw itm, am_uom_lang_vw am WHERE doc_type_code = ? AND doc_no = ? AND dtl.item_code = itm.item_code AND itm.language_id = ? AND itm.language_id = am.language_id AND itm.gen_uom_code = am.UOM_CODE order BY doc_srl_no");
//dataMap.put("SQL_ST_REQUEST_STATUS_DETAIL_LIST","SELECT	facility_id, doc_type_code,	doc_no,	to_char(doc_date,'dd/mm/yyyy'),	doc_ref, item_class_code, req_by_store_code, req_on_store_code , NVL(pending_item_qty,0) pending_item_qty FROM	st_request_hdr WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?");

//Query for Sales History
dataMap.put("SQL_ST_SALES_HISTORY","select a.doc_type_code, c.short_desc doc_type_desc,a.doc_no, to_char(a.DOC_DATE,'dd/mm/yyyy') doc_date,a.store_code, d.short_desc store_desc, b.item_code, e.short_desc item_desc, a.patient_id, f.patient_name, b.item_qty sale_qty, ROUND(NVL(b.item_sal_value,0),3) item_sal_value , 	  ROUND(NVL(b.item_cost_value,0),3)  item_cost_value  from  st_sal_hdr a, st_sal_dtl b, sy_doc_type_master c, mm_store d, mm_item e, mp_patient f where a.facility_id=b.facility_id and a.doc_type_code=b.doc_type_code and a.doc_no=b.doc_no and a.doc_type_code=c.doc_type_code and  a.store_code=d.store_code and b.item_code=e.item_code and a.patient_id=f.patient_id and a.facility_id = (?) and a.store_code LIKE UPPER(?) and b.item_code LIKE UPPER(?) and a.sal_trn_type like ?  and a.patient_id LIKE UPPER(?) and (a.doc_date BETWEEN to_date(TO_CHAR(nvl(?,'01/01/1901')),'dd/mm/yyyy') and to_date(TO_CHAR(nvl(?,'31/12/3012')),'dd/mm/yyyy')) and to_char(encounter_id) LIKE ? ");  
//Query for sales history - grand total
dataMap.put("SQL_ST_GRD_TOTAL_SALES_HISTORY","select  sum(b.item_sal_value) grand_tot from  st_sal_hdr a, st_sal_dtl b, sy_doc_type_master c, mm_store d, mm_item e, mp_patient f where a.facility_id=b.facility_id and a.doc_type_code=b.doc_type_code and a.doc_no=b.doc_no and a.doc_type_code=c.doc_type_code and  a.store_code=d.store_code and b.item_code=e.item_code and a.patient_id=f.patient_id and a.facility_id = (?) and a.store_code LIKE UPPER(?) and b.item_code LIKE UPPER(?) and a.sal_trn_type like ?  and a.patient_id LIKE UPPER(?) and (a.doc_date BETWEEN to_date(TO_CHAR(nvl(?,'01/01/1901')),'dd/mm/yyyy') and to_date(TO_CHAR(nvl(?,'31/12/3012')),'dd/mm/yyyy')) and to_char(encounter_id) LIKE ? ");

//Query for Cancel Count sheet
dataMap.put("SQL_ST_CANCEL_COUNT_SHEET_QUERY_RESULT","SELECT  a.STORE_CODE,  b.ITEM_CODE ,a.SHORT_DESC STORE_DESC,b.SHORT_DESC ITEM_DESC, e.short_desc  UOM ,c.PHY_INV_ID ,'N' SELECTED FROM mm_store_lang_vw a,mm_item_lang_vw b,st_phy_inv_hdr c ,st_phy_inv_param d, am_uom_lang_vw e  WHERE c.facility_id = ? AND c.facility_id = D.FACILITY_ID AND TO_CHAR(c.phy_inv_id) = ?   AND a.store_code LIKE ? AND b.item_code LIKE ? AND a.store_code=c.store_code AND b.item_code=c.item_code AND c.phy_inv_id=d.phy_inv_id AND b.gen_uom_code=e.uom_code AND a.language_id = b.language_id AND a.language_id = e.language_id AND a.language_id = ? order by a.short_desc");
dataMap.put("SQL_ST_CANCEL_COUNT_PHY_INV_ID","select PHY_INV_ID from ST_PHY_INV_PARAM where facility_id = ? and POSTED_DATE is null and cancelled_date is null order by PHY_INV_ID");
dataMap.put("SQL_ST_CANCEL_COUNT_STORE","select distinct a.store_code,b.short_desc from st_phy_inv_hdr a , mm_store_lang_vw b where a.store_code=b.store_code and  to_char(PHY_INV_ID )= ? AND b.language_id = ?");
dataMap.put("SQL_ST_CANCEL_COUNT_DTL" , " DELETE FROM st_phy_inv_dtl WHERE facility_id= ? AND PHY_INV_ID= ? AND STORE_CODE= ? AND ITEM_CODE= ?");
dataMap.put("SQL_ST_CANCEL_COUNT_HDR" , "DELETE FROM st_phy_inv_hdr WHERE facility_id= ? AND PHY_INV_ID= ? AND STORE_CODE= ? AND ITEM_CODE= ? ");
dataMap.put("SQL_ST_CANCEL_COUNT_STORE_UPDATE" , " UPDATE st_item_batch SET phy_inv_id=NULL, phy_inv_start_qty= NULL, phy_inv_start_date=NULL, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE PHY_INV_ID= ?  AND STORE_CODE= ? AND ITEM_CODE= ? ");
dataMap.put("SQL_ST_CANCEL_COUNT_ITEM_UPDATE" , " UPDATE st_item_store SET phy_inv_id=NULL, phy_inv_start_qty=NULL, phy_inv_start_date=NULL, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=?   WHERE PHY_INV_ID= ?  AND STORE_CODE= ? AND ITEM_CODE= ? ");
dataMap.put("SQL_ST_PHY_INV_PARAM_UPDATE_FOR_CANCEL" , " UPDATE st_phy_inv_param SET cancelled_date= SYSDATE, modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE facility_id=? AND phy_inv_id=?");
dataMap.put("SQL_ST_PHY_INV_HDR_SELECT_COUNT" , "SELECT count(*) total from st_phy_inv_hdr WHERE facility_id=? AND PHY_INV_ID= ?");
dataMap.put("SQL_ST_PHY_INV_DTL_SELECT_COUNT" , "SELECT count(*) total from st_phy_inv_dtl WHERE facility_id=? AND PHY_INV_ID= ?");

// Added on 1/20/2005 for inserting records into ST_CANC_PHY_INV_ITEMS while cancelling the count sheet 

dataMap.put("SQL_ST_CANC_PHY_INV_ITEMS" , "INSERT INTO ST_CANC_PHY_INV_ITEMS (FACILITY_ID, PHY_INV_ID, STORE_CODE, ITEM_CODE, PHY_INV_DATE,     ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,SYSDATE,?,?,?,SYSDATE,?,?)");
dataMap.put("SQL_ST_PHY_INV_HDR_SELECT_DATE" , "SELECT DISTINCT to_char(ADDED_DATE,'dd/mm/yyyy') ADDED_DATE FROM  ST_PHY_INV_HDR WHERE  PHY_INV_ID=?");

// End of 1/20/2005






//Query for Reprint Count sheet
dataMap.put("SQL_ST_REPRINT_COUNT_SHEET_PHY" , " select phy_inv_id from st_phy_inv_param where facility_id=? AND posted_date is null and cancelled_date is null ");
dataMap.put("SQL_ST_REPRINT_COUNT_SHEET_DATE" , " select to_char(count_sheet_date,'dd/mm/yyyy') count_sheet_date , phy_inv_proc_mode from st_phy_inv_param where facility_id= ? AND to_char(phy_inv_id) = ? " );

// Query for Post Variance
dataMap.put("SQL_ST_POST_VARIANCE_PHY_INV_ID","select PHY_INV_ID,PHY_INV_ID from ST_PHY_INV_PARAM where facility_id = ? and entry_completed_yn = 'Y' and POSTED_DATE is null and Cancelled_date is null");
//dataMap.put("SQL_ST_POST_VARIANCE_DOC_TYPE","SELECT a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master b  WHERE a.facility_id=? AND a.doc_type_code = b.doc_type_code AND a.trn_type = ? AND b.status IS NULL ORDER BY 1,2");
dataMap.put("SQL_ST_POST_VARIANCE_DOC_TYPE","SELECT A.doc_type_code, b.short_desc FROM st_trn_doc_type A, sy_doc_type_master_lang_vw b,sy_acc_entity_doc_type c  WHERE A.facility_id=? AND  A.doc_type_code = b.doc_type_code  AND  A.doc_type_code = c.doc_type_code  AND A.trn_type = ?  AND DOC_NUM_GEN_FLAG='Y'  AND b.status IS NULL AND b.language_id = ? ORDER BY 1,2");
dataMap.put("SQL_ST_POST_VARIANCE_STORE_CODE","select distinct store_code from st_phy_inv_hdr where facility_id=? and phy_inv_id=?");
dataMap.put("SQL_ST_POST_VARIANCE_INSERT","INSERT INTO  st_adj_hdr( facility_id  , doc_type_code,           doc_no    ,              doc_date   ,             doc_ref     ,            store_code   ,           authorized_by_id,        finalized_yn     ,       gl_interfaced_yn  ,      trn_type           ,     sale_to_ext_yn      ,    ext_agency_name      ,   condemn_id            ,  condemn_remarks        , added_by_id            , added_date             , added_at_ws_no         , added_facility_id      , modified_by_id         , modified_date          , modified_at_ws_no      , modified_facility_id   )values(?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
dataMap.put("SQL_ST_POST_VARIANCE_INSERT_DTL","INSERT INTO  st_adj_dtl( facility_id  , doc_type_code  ,  doc_no          ,        doc_srl_no       ,      item_code         ,      stock_item_yn      ,     adj_item_qty        ,    item_unit_cost       ,   item_cost_value       ,  remarks                , added_by_id            , added_date             , added_at_ws_no         , added_facility_id      , modified_by_id         , modified_date          , modified_at_ws_no      , modified_facility_id   ) values(?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
dataMap.put("SQL_ST_POST_VARIANCE_SELECT_ITEM","SELECT item_code FROM st_phy_inv_hdr WHERE facility_id=? AND phy_inv_id=? AND 	store_code=? ");
dataMap.put("SQL_ST_POST_VARIANCE_SELECT_PISQ","SELECT PHY_INV_START_QTY,ITEM_VALUE  FROM st_item_store WHERE phy_inv_id=? AND  		store_code=? AND item_code=? "); 
dataMap.put("SQL_ST_POST_VARIANCE_SUM_QTY","SELECT nvl(SUM(ITEM_QTY),0)  inv_qty FROM st_phy_inv_dtl WHERE facility_id=?		AND phy_inv_id=? AND store_code=? AND item_code=? "); 
// dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_STORE","UPDATE St_Item_Store SET QTY_ON_HAND=? , item_value =nvl(item_value,0)+round(?,3), phy_inv_id=null,phy_inv_start_date=null,phy_inv_start_qty=null WHERE PHY_INV_ID=? AND  		STORE_CODE=? AND ITEM_CODE=? ");  // Modified on 1/3/2006 by Ram for updating present_phy_inv_count
//dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_STORE","UPDATE St_Item_Store SET QTY_ON_HAND=? , item_value =nvl(item_value,0)+round(?,3), phy_inv_id=null,phy_inv_start_date=null,phy_inv_start_qty=null, present_phy_inv_count = present_phy_inv_count +1, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE PHY_INV_ID=? AND  		STORE_CODE=? AND ITEM_CODE=? ");//commented for MMS-ICN-00110 
dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_STORE","UPDATE St_Item_Store SET QTY_ON_HAND=? , item_value =?, phy_inv_id=null,phy_inv_start_date=null,phy_inv_start_qty=null, present_phy_inv_count = present_phy_inv_count +1, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE PHY_INV_ID=? AND  		STORE_CODE=? AND ITEM_CODE=? ");//added for MMS-ICN-00110
//dataMap.put("SQL_ST_POST_VARIANCE_SELECT_BATCH","SELECT store_code, ITEM_CODE, BATCH_ID, STOCK_ITEM_YN, 	ITEM_QTY , 		EXPIRY_DATE_OR_RECEIPT_DATE, BIN_LOCATION_CODE, TRADE_ID FROM  		st_phy_inv_dtl WHERE facility_id=? AND phy_inv_id=? AND store_code=? AND item_code=?"); 
dataMap.put("SQL_ST_POST_VARIANCE_SELECT_BATCH","SELECT A.item_code,A.store_code, TO_CHAR(A.expiry_date_or_receipt_date,'dd/mm/yyyy') EXPIRY_DATE, A.batch_id, A.bin_location_code, A.trade_id,ROUND(NVL(a.phy_inv_start_qty,0),3) comp_qty,ROUND(NVL(item_qty,0),3) phy_stk_qty,ROUND(NVL(a.phy_inv_start_qty,0)* NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),3) item_val,ROUND(NVL(item_qty,0)*NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),3) comp_val,ROUND(NVL(item_qty,0) - NVL(a.phy_inv_start_qty,0),3) var_qty,ROUND(NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),6)unit_cost,ROUND((NVL(item_qty,0) - NVL(a.phy_inv_start_qty,0))*NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),3) var_val,A.phy_inv_id  FROM ST_ITEM_BATCH A, ST_PHY_INV_DTL b, st_item_store c  ,st_phy_inv_param d WHERE A.item_code=b.item_code (+) AND A.store_code=b.store_code (+) AND A.phy_inv_id = b.phy_inv_id(+) AND  A.batch_id = b.batch_id (+) AND  A.expiry_date_or_receipt_date = b.expiry_date_or_receipt_date(+) AND  A.bin_location_code=b.bin_location_code (+) AND  A.item_code=c.item_code AND A.store_code=c.store_code and A.phy_inv_id=?   AND  round(NVL(item_qty,0) - NVL(a.phy_inv_start_qty,0),3)<>0 AND a.phy_inv_id=d.phy_inv_id and d.posted_date is null  UNION  SELECT A.item_code,A.store_code,  TO_CHAR(A.expiry_date_or_receipt_date,'dd/mm/yyyy') EXPIRY_DATE,A.batch_id,A.bin_location_code, A.trade_id,ROUND(NVL(b.phy_inv_start_qty,0),3) comp_qty,ROUND(NVL(item_qty,0),3) phy_stk_qty,ROUND(NVL(b.phy_inv_start_qty,0)*NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),3) item_val,ROUND(NVL(item_qty,0)*NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),3) comp_val,ROUND(NVL(item_qty,0) - NVL(b.phy_inv_start_qty,0),3) var_qty,ROUND(NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),6)unit_cost,ROUND((NVL(item_qty,0) - NVL(b.phy_inv_start_qty,0))*NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand),3) var_val,A.phy_inv_id FROM ST_ITEM_BATCH b, ST_PHY_INV_DTL A, st_item_store c ,st_phy_inv_param d  WHERE A.item_code=b.item_code (+) AND A.store_code=b.store_code (+) AND A.phy_inv_id = b.phy_inv_id(+) AND  A.batch_id = b.batch_id (+) AND  A.expiry_date_or_receipt_date = b.expiry_date_or_receipt_date(+) AND  A.bin_location_code=b.bin_location_code (+) AND  A.item_code=c.item_code and  a.store_code=c.store_code AND  A.phy_inv_id=?  AND  round(NVL(item_qty,0) - NVL(b.phy_inv_start_qty,0),3)<>0  AND a.phy_inv_id=d.phy_inv_id and d.posted_date is null ORDER BY STORE_CODE, ITEM_CODE, BATCH_ID, BIN_LOCATION_CODE, EXPIRY_DATE "); 

//dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_BATCH","UPDATE St_Item_Batch SET /*qty_on_hand=? ,*/phy_inv_id=null,phy_inv_start_date=null,phy_inv_start_qty=null WHERE phy_inv_id=? AND    store_code=? AND item_code=? AND batch_id=? AND    bin_location_code=? AND EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy')");  // Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_BATCH","UPDATE St_Item_Batch SET /*qty_on_hand=? ,*/phy_inv_id=null,phy_inv_start_date=null,phy_inv_start_qty=null , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE phy_inv_id=? AND    store_code=? AND item_code=? AND batch_id=? AND    bin_location_code=? AND EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy')"); 
//dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_ALL_BATCH","update st_item_batch set PHY_INV_ID=null, PHY_INV_START_DATE=null, PHY_INV_START_QTY=null where PHY_INV_ID=?");  // Modified on 2/6/2006 for date correction
dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_ALL_BATCH","update st_item_batch set PHY_INV_ID=null, PHY_INV_START_DATE=null, PHY_INV_START_QTY=null, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where PHY_INV_ID=? and store_code = ?"); 
dataMap.put("SQL_ST_POST_VARIANCE_SELECT_PHY_START_QTY","SELECT PHY_INV_START_QTY FROM St_Item_Batch WHERE  			phy_inv_id=? AND store_code=?  AND Item_Code=? AND  			batch_id=?  AND Bin_location_Code=? AND expiry_date_or_receipt_date=? "); 
dataMap.put("SQL_ST_POST_VARIANCE_ITEM_MOMENT_INSERT","INSERT INTO st_item_move_summ (FACILITY_ID,ITEM_CODE,STORE_CODE,MOVE_YEAR, MOVE_MONTH,MONTH_CLOSING_QTY,MONTH_CLOSING_VALUE,VAR_QTY,VAR_COST,POS_VAR_QTY ,   POS_VAR_COST ,NEG_VAR_QTY, NEG_VAR_COST ,  ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)  "); 
dataMap.put("SQL_ST_POST_VARIANCE_ITEM_MOMENT_UPDATE","UPDATE st_item_move_summ SET MONTH_CLOSING_QTY=NVL(MONTH_CLOSING_QTY,0)+?, MONTH_CLOSING_VALUE=NVL(MONTH_CLOSING_VALUE,0)+?,VAR_QTY=NVL(VAR_QTY,0)+?, VAR_COST=NVL(VAR_COST,0)+?,POS_VAR_QTY =NVL(POS_VAR_QTY,0)+?,   POS_VAR_COST =NVL(POS_VAR_COST,0)+?,NEG_VAR_QTY=NVL(NEG_VAR_QTY,0)+?, NEG_VAR_COST=NVL(NEG_VAR_COST,0)+? ,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=? , MODIFIED_FACILITY_ID =?  WHERE FACILITY_ID=? AND ITEM_CODE=? AND   STORE_CODE=?  AND MOVE_YEAR=? AND MOVE_MONTH=? "); 
dataMap.put("SQL_ST_POST_VARIANCE_INSERT_BATCH","INSERT INTO st_adj_dtl_exp (facility_id  ,  doc_type_code    ,              doc_no ,                       doc_srl_no     ,                store_code  ,                   item_code ,                     batch_id  ,                     bin_location_code   ,           expiry_date_or_receipt_date,trade_id   ,                    item_qty  ,                     phy_inv_id  ,                   phy_inv_start_qty   ,           phy_inv_item_cost_value  ,      added_by_id    ,                added_date   ,                  added_at_ws_no  ,               added_facility_id  ,            modified_by_id  ,               modified_date  ,                modified_at_ws_no   ,           modified_facility_id   )values(?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) "); 
dataMap.put("SQL_ST_POST_VARIANCE_SUM_VAR_QTY","SELECT A.store_code,A.item_code,ROUND(SUM(NVL(item_qty,0) - NVL(A.phy_inv_start_Qty,0)),3) var_qty, ROUND(SUM((NVL(item_qty,0) - NVL(A.phy_inv_start_Qty,0))*NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand)) ,3)var_val,ROUND(NVL(A.phy_inv_start_qty,0),3) comp_qty ,ROUND(NVL(item_qty,0),3) phy_stk_qty FROM ST_ITEM_BATCH A, ST_PHY_INV_DTL b, ST_ITEM_STORE c WHERE A.item_code=b.item_code (+)   AND  A.store_code=b.store_code (+) AND  A.phy_inv_id = b.phy_inv_id(+)   AND  A.batch_id = b.batch_id (+) AND   A.expiry_date_or_receipt_date = b.expiry_date_or_receipt_date(+)   AND  A.bin_location_code=b.bin_location_code (+) AND  A.item_code=c.item_code AND A.store_code=c.store_code AND  A.phy_inv_id=? AND A.store_code =? AND  A.item_code =?   AND  ROUND(NVL(item_qty,0) - NVL(A.phy_inv_start_Qty,0),3)<>0  GROUP BY  A.store_code  , A.item_code,A.phy_inv_start_qty,item_qty UNION SELECT A.store_code,A.item_code,ROUND(SUM(NVL(item_qty,0) - NVL(b.phy_inv_start_Qty,0)),3)  var_qty,	ROUND(SUM((NVL(item_qty,0)  - NVL(b.phy_inv_start_Qty,0))*NVL(c.item_value,0)/DECODE(NVL(c.qty_on_hand,0),0,1,c.qty_on_hand)),3)var_val ,ROUND(NVL(b.phy_inv_start_qty,0),3) comp_qty,ROUND(NVL(item_qty,0),3) phy_stk_qty  FROM ST_ITEM_BATCH b, ST_PHY_INV_DTL A, ST_ITEM_STORE c WHERE A.item_code=b.item_code (+)   AND A.store_code=b.store_code (+) AND A.phy_inv_id = b.phy_inv_id(+)   AND A.batch_id = b.batch_id (+) AND   A.expiry_date_or_receipt_date = b.expiry_date_or_receipt_date(+)   AND  A.bin_location_code=b.bin_location_code (+) AND  A.item_code=c.item_code AND A.store_code=c.store_code(+) AND  A.phy_inv_id=? AND A.store_code=?  AND  A.item_code=?  AND  ROUND(NVL(item_qty,0) - NVL(b.phy_inv_start_Qty,0),3)<>0  GROUP BY  A.store_code  , A.item_code,b.phy_inv_start_qty,item_qty "); 
dataMap.put("SQL_ST_POST_VARIANCE_DTL_DELETE","delete from st_phy_inv_dtl where facility_id=? and phy_inv_id=? ");
dataMap.put("SQL_ST_POST_VARIANCE_HDR_DELETE","delete from st_phy_inv_hdr where facility_id=? and phy_inv_id=? ");
//dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_PARAM","Update St_Phy_Inv_Param Set POSTED_DATE=sysdate where facility_id=? and phy_inv_id=?"); // Modified on 2/6/2006 for date
dataMap.put("SQL_ST_POST_VARIANCE_UPDATE_PARAM","Update St_Phy_Inv_Param Set POSTED_DATE=sysdate , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? where facility_id=? and phy_inv_id=?");
dataMap.put("SQL_ST_MATERIAL_GROUP_LIST" , "select a.MATERIAL_GROUP_CODE,a.short_desc from mm_material_group a,mm_user_material_group b where a.MATERIAL_GROUP_CODE = b.MATERIAL_GROUP_CODE   AND b.USER_ID = ? ");
dataMap.put("SQL_ST_POSTVARIANCE_ITEM_QTY" , "select NVL(QTY_ON_HAND,0) QTY_ON_HAND from ST_ITEM_BATCH WHERE STORE_CODE = ? AND ITEM_CODE = ? AND BATCH_ID = ? AND BIN_LOCATION_CODE = ? AND TO_CHAR(EXPIRY_DATE_OR_RECEIPT_DATE , 'dd/mm/yyyy') = ? " );

//dataMap.put("SQL_ST_ITEM_STORE_UPDATE_QTY_ON_HAND" , "update st_item_store set qty_on_hand=? where store_code=? and item_code=?" ); //// Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_ST_ITEM_STORE_UPDATE_QTY_ON_HAND" , "update st_item_store set qty_on_hand=?,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  where store_code=? and item_code=?" );
//dataMap.put("SQL_ST_ITEM_BATCH_UPDATE_PHY_INV" , "update st_item_batch set phy_inv_id=null, PHY_INV_START_DATE=null, PHY_INV_START_QTY=null where phy_inv_id=? and added_facility_id=?" ); // Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_ST_ITEM_BATCH_UPDATE_PHY_INV" , "update st_item_batch set phy_inv_id=null, PHY_INV_START_DATE=null, PHY_INV_START_QTY=null , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  where phy_inv_id=? and store_code=?" );
dataMap.put("SQL_ST_ITEM_BATCH_SELECT_QTY_ON_HAND" , "select item_code, store_code, sum(qty_on_hand) qty_on_hand from st_item_batch group by item_code, store_code" );

// update statement executed when no qty as per the system/physical observation[exceptional case]
dataMap.put("SQL_ST_ITEM_STORE_UPDATE_FOR_POST_VARIANCE" , "UPDATE st_item_store SET qty_on_hand=0, item_value=0, phy_inv_id=NULL,phy_inv_start_date=NULL, phy_inv_start_qty=NULL,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?   WHERE added_facility_id=? AND phy_inv_id=?" ); // Not Used
//dataMap.put("SQL_ST_ITEM_STORE_UPDATE_FOR_POST_VARIANCE_2" , "UPDATE st_item_store SET  phy_inv_id=NULL,phy_inv_start_date=NULL, phy_inv_start_qty=NULL WHERE added_facility_id=? AND phy_inv_id=?" ); // Modified on 2/6/2006 for date correction
dataMap.put("SQL_ST_ITEM_STORE_UPDATE_FOR_POST_VARIANCE_2" , "UPDATE st_item_store SET  phy_inv_id=NULL,phy_inv_start_date=NULL, phy_inv_start_qty=NULL ,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE added_facility_id=? AND phy_inv_id=?" );
// used in condemn expired batches
//dataMap.put("SQL_MM_ITEM_UNIT_COST_UPDATE_FOR_POST_VARIANCE" , "UPDATE MM_ITEM SET unit_cost = ROUND((SELECT NVL(SUM(item_value),0)/DECODE(NVL(SUM(qty_on_hand),0),0,1,SUM(qty_on_hand)) FROM ST_ITEM_STORE WHERE item_code =?),6) WHERE item_code=?" );  //// Modified on 5/26/2006 for updating modification details
dataMap.put("SQL_MM_ITEM_UNIT_COST_UPDATE_FOR_POST_VARIANCE" , "UPDATE MM_ITEM SET unit_cost = ROUND((SELECT NVL(SUM(item_value),0)/DECODE(NVL(SUM(qty_on_hand),0),0,1,SUM(qty_on_hand)) FROM ST_ITEM_STORE WHERE item_code =?),6) ,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?   WHERE item_code=?" );
dataMap.put("SQL_MM_ITEM_UNIT_COST_SELECT_POST_VARIANCE" , "SELECT UNIT_COST FROM MM_ITEM WHERE ITEM_CODE=?" );//added for MMS-ICN-00110






// Transaction Summary Report added by Murali 
dataMap.put("SQL_ST_TRANS_SUMM_ADJ_REPORT","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,TO_CHAR(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc FROM ST_ADJ_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.store_code  = c.store_code AND a.finalized_yn ='Y' AND a.trn_type = ? AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.store_code LIKE NVL(UPPER(?),'%') AND TRUNC(A.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND 	TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND c.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
dataMap.put("SQL_ST_TRANS_SUMM_ADJ_REPORT_SRR","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,TO_CHAR(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc FROM ST_ADJ_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.store_code  = c.store_code AND a.finalized_yn ='Y' AND a.trn_type = ? AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.store_code between NVL(?,'!!!!!!!!!') AND nvl(?,'~~~~~~~~~~') AND TRUNC(A.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND 	TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND c.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

//dataMap.put("SQL_ST_TRANS_SUMM_ISS_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,a.seq_no issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref,a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM st_issue_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code AND a.finalized_yn ='Y'  AND a.trn_type= 'ISS'  AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ?  ORDER BY a.doc_type_code,a.doc_no,a.seq_no,a.doc_date");

//Commented by Rabbani #Inc no : 39100 on 18-APR-2013
//dataMap.put("SQL_ST_TRANS_SUMM_ISS_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,a.seq_no issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref,a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM st_issue_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code   AND a.trn_type= 'ISS'  AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ?  ");

//Added by Rabbani #Inc no : 39100 on 18-APR-2013
dataMap.put("SQL_ST_TRANS_SUMM_ISS_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,a.seq_no issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref,a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM st_issue_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d ,st_acc_entity_param e WHERE  a.facility_id LIKE  decode(e.trn_across_facility_yn,'Y','%', ?)  AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code   AND a.trn_type= 'ISS'  AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ?  ");

dataMap.put("SQL_ST_TRANS_SUMM_ISS_REPORT_SRR","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,a.seq_no issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref,a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM st_issue_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code AND a.finalized_yn ='Y'  AND a.trn_type= 'ISS'  AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.to_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ?  ORDER BY a.doc_type_code,a.doc_no,a.seq_no,a.doc_date");

dataMap.put("SQL_ST_TRANS_SUMM_MFG_REPORT","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc FROM ST_MFG_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.store_code  = c.store_code AND a.finalized_yn ='Y'   AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND c.store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

//Commented by Rabbani #Inc no : 39100 on 18-APR-2013
//dataMap.put("SQL_ST_TRANS_SUMM_REQ_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,  to_char(a.doc_date,'dd/mm/yyyy') doc_date,a.doc_ref, a.req_by_store_code, c.short_desc req_by_store_desc,a.req_on_store_code, d.short_desc req_on_store_desc FROM st_request_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id= ? AND a.doc_type_code=b.doc_type_code AND a.req_by_store_code=c.store_code AND a.req_on_store_code=d.store_code AND a.REQ_AUTHORIZED_BY_ID IS NOT NULL AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.req_by_store_code LIKE NVL(upper(?),'%') AND a.req_by_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

//Added by Rabbani #Inc no : 39100 on 18-APR-2013
dataMap.put("SQL_ST_TRANS_SUMM_REQ_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,  to_char(a.doc_date,'dd/mm/yyyy') doc_date,a.doc_ref, a.req_by_store_code, c.short_desc req_by_store_desc,a.req_on_store_code, d.short_desc req_on_store_desc FROM st_request_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d,st_acc_entity_param e WHERE a.facility_id LIKE  decode(e.trn_across_facility_yn,'Y','%', ?) AND a.doc_type_code=b.doc_type_code AND a.req_by_store_code=c.store_code AND a.req_on_store_code=d.store_code AND a.REQ_AUTHORIZED_BY_ID IS NOT NULL AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.req_by_store_code LIKE NVL(upper(?),'%') AND a.req_by_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

//Commented by Rabbani #Inc no : 39100 on 18-APR-2013
//dataMap.put("SQL_ST_TRANS_SUMM_PICK_SLIP_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no, a.SEQ_NO issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date,a.doc_ref, a.TO_STORE_CODE, c.short_desc req_by_store_desc,a.FM_STORE_CODE, d.short_desc req_on_store_desc FROM ST_ISSUE_HDR a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id= ? AND a.doc_type_code=b.doc_type_code AND a.TO_STORE_CODE=c.store_code AND a.FM_STORE_CODE=d.store_code AND a.AUTHORIZED_BY_ID IS NOT NULL AND nvl(a.SEQ_NO,0)>0 AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.TO_STORE_CODE LIKE NVL(upper(?),'%') AND a.TO_STORE_CODE LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.SEQ_NO,a.doc_date");

//Added by Rabbani #Inc no : 39100 on 18-APR-2013
dataMap.put("SQL_ST_TRANS_SUMM_PICK_SLIP_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no, a.SEQ_NO issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date,a.doc_ref, a.TO_STORE_CODE, c.short_desc req_by_store_desc,a.FM_STORE_CODE, d.short_desc req_on_store_desc FROM ST_ISSUE_HDR a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d ,st_acc_entity_param e WHERE a.facility_id LIKE  decode(e.trn_across_facility_yn,'Y','%', ?) AND a.doc_type_code=b.doc_type_code AND a.TO_STORE_CODE=c.store_code AND a.FM_STORE_CODE=d.store_code AND a.AUTHORIZED_BY_ID IS NOT NULL AND nvl(a.SEQ_NO,0)>0 AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.TO_STORE_CODE LIKE NVL(upper(?),'%') AND a.TO_STORE_CODE LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.SEQ_NO,a.doc_date");

dataMap.put("SQL_ST_TRANS_SUMM_REQ_REPORT_SRR","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no, to_char(a.doc_date,'dd/mm/yyyy') doc_date,a.doc_ref, a.req_by_store_code, c.short_desc req_by_store_desc,a.req_on_store_code, d.short_desc req_on_store_desc FROM st_request_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id= ? AND a.doc_type_code=b.doc_type_code AND a.req_by_store_code=c.store_code AND a.req_on_store_code=d.store_code AND a.REQ_AUTHORIZED_BY_ID IS NOT NULL AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.req_by_store_code LIKE NVL(upper(?),'%') AND a.req_on_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

dataMap.put("SQL_ST_TRANS_SUMM_SAL_REPORT","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc FROM st_sal_hdr  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.store_code  = c.store_code AND module_id = 'ST' AND a.finalized_yn ='Y'   AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND c.store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
dataMap.put("SQL_ST_TRANS_SUMM_SRT_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc,a.patient_id patient_id FROM st_sal_ret_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE a.facility_id= ? AND a.doc_type_code = b.doc_type_code AND a.store_code    = c.store_code AND a.finalized_yn ='Y' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND c.store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
//Commented By Sakti Sankar on 11/02/2013 against SCF#ML-BRU-SCF-0640 inc#36859
//dataMap.put("SQL_ST_TRANS_SUMM_TFR_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM st_transfer_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code AND a.finalized_yn ='Y' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
//Passed PROCESS_FOR_ACKNOWLEDGE Dynamically through code  By Sakti Sankar on 11/02/2013 against SCF#ML-BRU-SCF-0640 inc#36859
//Commented by Rabbani #Inc no: 39100 on 18-APR-2013
//dataMap.put("SQL_ST_TRANS_SUMM_TFR_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM st_transfer_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code  AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ? ");
//Added by Rabbani #Inc no: 39100 on 18-APR-2013
dataMap.put("SQL_ST_TRANS_SUMM_TFR_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM st_transfer_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d , st_acc_entity_param e WHERE a.facility_id LIKE  decode(e.trn_across_facility_yn,'Y','%', ?) AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code  AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ? ");
//Commented By Sakti Sankar on 11/02/2013 against SCF#ML-BRU-SCF-0640 inc#36859
//dataMap.put("SQL_ST_TRANS_SUMM_URG_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,a.seq_no issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref,a.fm_store_code, c.short_desc fm_store_desc, a.to_store_code, d.short_desc to_store_desc FROM st_issue_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code AND a.finalized_yn ='Y'  AND a.trn_type= 'URG' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
//Passed PROCESS_FOR_ACKNOWLEDGE Dynamically through code  By Sakti Sankar on 11/02/2013 against SCF#ML-BRU-SCF-0640 inc#36859

//Commented by Rabbani #Inc no: 39100 on 18-APR-2013
//dataMap.put("SQL_ST_TRANS_SUMM_URG_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,a.seq_no issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref,a.fm_store_code, c.short_desc fm_store_desc, a.to_store_code, d.short_desc to_store_desc FROM st_issue_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code  AND a.trn_type= 'URG' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ");

//Added by Rabbani #Inc no: 39100 on 18-APR-2013
dataMap.put("SQL_ST_TRANS_SUMM_URG_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,a.seq_no issue_seq,  to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref,a.fm_store_code, c.short_desc fm_store_desc, a.to_store_code, d.short_desc to_store_desc FROM st_issue_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d, st_acc_entity_param e WHERE a.facility_id LIKE  decode(e.trn_across_facility_yn,'Y','%', ?) AND a.doc_type_code = b.doc_type_code AND a.fm_store_code = c.store_code AND a.to_store_code = d.store_code  AND a.trn_type= 'URG' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id = d.language_id AND b.language_id = ? ");


dataMap.put("SQL_ST_TRANS_SUMM_VAR_REPORT","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc FROM ST_ADJ_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE  a.facility_id = ?  AND a.doc_type_code = b.doc_type_code  AND a.store_code  = c.store_code AND a.finalized_yn ='Y' AND a.trn_type = 'VAR' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND c.store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id=c.language_id AND b.language_id =? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

//Commented by Rabbani #Inc no: 39100 on 18-APR-2013 
//dataMap.put("SQL_ST_TRANS_SUMM_RET_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM ST_ISSUE_RET_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code  = c.store_code AND a.to_store_code  = d.store_code AND a.finalized_yn ='Y' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id =? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

//Added by Rabbani #Inc no: 39100 on 18-APR-2013 
//dataMap.put("SQL_ST_TRANS_SUMM_RET_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM ST_ISSUE_RET_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d ,st_acc_entity_param e WHERE a.facility_id LIKE  decode(e.trn_across_facility_yn,'Y','%', ?) AND a.doc_type_code = b.doc_type_code AND a.fm_store_code  = c.store_code AND a.to_store_code  = d.store_code AND a.finalized_yn ='Y' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id =? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");

//Added by Rabbani #Inc no: 41448(ML-BRU-SCF-0924) on 06-SEP-13
dataMap.put("SQL_ST_TRANS_SUMM_RET_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM ST_ISSUE_RET_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d ,st_acc_entity_param e WHERE a.facility_id LIKE  decode(e.trn_across_facility_yn,'Y','%', ?) AND a.doc_type_code = b.doc_type_code AND a.fm_store_code  = c.store_code AND a.to_store_code  = d.store_code  AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id =? ");

dataMap.put("SQL_ST_TRANS_SUMM_RET_REPORT_SRR","SELECT count(e.item_code)no_of_items, a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.fm_store_code, c.short_desc fm_store_desc,a.to_store_code, d.short_desc to_store_desc FROM ST_ISSUE_RET_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c, mm_store_lang_vw d,st_issue_ret_dtl e WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.fm_store_code  = c.store_code AND a.to_store_code  = d.store_code AND a.finalized_yn ='Y' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.fm_store_code LIKE NVL(upper(?),'%') AND a.to_store_code LIKE NVL(upper(?),'%') AND TRUNC(a.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id =? and a.facility_id = e.facility_id  and a.doc_type_code = e.doc_type_code  and a.doc_no = e.doc_no group by a.doc_type_code, b.short_desc , a.doc_no, TO_CHAR (a.doc_date, 'dd/mm/yyyy') , a.doc_ref, a.fm_store_code, c.short_desc , a.to_store_code, d.short_desc ORDER BY a.doc_type_code,a.doc_no,TO_CHAR (a.doc_date, 'dd/mm/yyyy')");

// Added on Wednesday, December 08, 2004 By PhaniRaj
dataMap.put("SQL_ST_TRANS_SUMM_PRT_REPORT","SELECT a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,TO_CHAR (a.doc_date, 'dd/mm/yyyy') doc_date, a.doc_ref,a.store_code,c.short_desc store_desc FROM st_PROD_TRANSFER_hdr a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c   WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.STORE_CODE = c.store_code AND a.doc_type_code LIKE NVL (?, '%') AND a.doc_no LIKE NVL (?, '%') AND a.STORE_CODE LIKE NVL (?, '%')  AND TRUNC (a.doc_date) BETWEEN TO_DATE (NVL (?, '01/01/1472'),'DD/MM/RRRR')AND TO_DATE (NVL (?, '31/12/9999'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = ? ORDER BY a.doc_type_code, a.doc_no, a.doc_date");

//Commented by Rabbani #Inc no : 39100 on 18-APR-2013
//dataMap.put("SQL_ST_TRN_DOC_TYPE_SUMM_SELECT_LIST",		"SELECT	a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b WHERE a.facility_id=? AND b.language_id = ? AND a.doc_type_code = b.doc_type_code AND a.trn_type = DECODE(?,'REQ','ISS','CON','SAL',?) AND b.status is NULL ORDER BY	2,1");

//Added by Rabbani #Inc no : 39100 on 18-APR-2013
dataMap.put("SQL_ST_TRN_DOC_TYPE_SUMM_SELECT_LIST",		"SELECT	DISTINCT a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b ,st_acc_entity_param c WHERE  a.facility_id LIKE  decode(c.trn_across_facility_yn,'Y','%', ?) AND b.language_id = ? AND a.doc_type_code = b.doc_type_code AND a.trn_type = DECODE(?,'REQ','ISS','CON','SAL',?) AND b.status is NULL ORDER BY	2,1");

//Added for Blocked batches Friday, July 16, 2004
dataMap.put("SQL_ST_TRN_DOC_TYPE_BLOCK_LIST",		"SELECT	a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b WHERE a.facility_id=? AND a.doc_type_code = b.doc_type_code AND a.trn_type = DECODE(?,'REQ','ISS',?) AND b.status is NULL AND b.language_id = ? ORDER BY	2,1");

dataMap.put("SQL_ST_TRANS_SUMM_GRN_REPORT","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc FROM ST_GRN_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.store_code  = c.store_code AND a.finalized_yn ='Y' AND a.trn_type = 'GRN' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.store_code LIKE NVL(upper(?),'%') AND TRUNC(A.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND 	TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id = c.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
dataMap.put("SQL_ST_TRANS_SUMM_RTV_REPORT","SELECT  a.doc_type_code, b.short_desc doc_type_desc, a.doc_no,to_char(a.doc_date,'dd/mm/yyyy') doc_date, a.doc_ref, a.store_code, c.short_desc store_desc FROM ST_RTV_HDR  a, sy_doc_type_master_lang_vw b, mm_store_lang_vw c WHERE  a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.store_code  = c.store_code AND a.finalized_yn ='Y' AND a.trn_type = 'RTV' AND a.doc_type_code LIKE NVL(?,'%') AND a.doc_no LIKE NVL(?,'%') AND a.store_code LIKE NVL(upper(?),'%') AND TRUNC(A.doc_date) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND 	TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND b.language_id= c.language_id AND b.language_id = ? ORDER BY a.doc_type_code,a.doc_no,a.doc_date");
dataMap.put("SQL_ST_TRN_TYPE_SELECT_LIST2","SELECT trn_type, long_desc FROM st_trn_type WHERE trn_type NOT IN ('PRT','OBS') ORDER BY 2");

///for reprint document exclude sal and srt
dataMap.put("SQL_ST_TRN_TYPE_SELECT_LIST3","SELECT trn_type, long_desc FROM st_trn_type_lang_vw  st_trn_type WHERE trn_type NOT IN ('OBS','SAL','SRT','SPB','CBL','PRQ') AND language_id = ? ORDER BY 2");

dataMap.put("SQL_AP_SUPPLIER_SELECT_LOOKUP","SELECT supp_code code, short_name description FROM ap_supplier_lang_vw ap_supplier where status is null AND language_id LIKE ? AND supp_code LIKE UPPER(?) AND UPPER(short_name) LIKE UPPER(?) order by short_name");

//QUERY BLOCKED BATCHES
//commented by Rabbani on 19/11/12 changed TO_DATE Parameter as SYSDATE
//dataMap.put("SQL_ST_BLOCKED_BATCHES_VIEW_QUERY_RESULT","SELECT STBV.DOC_TYPE_CODE, STBV.DOC_NO, STBV.SEQ_NO, STBV.TRN_TYPE, STBV.DOC_SRL_NO, STBV.STORE_CODE, STBV.ITEM_CODE, STBV.BATCH_ID, STBV.BIN_LOCATION_CODE, TO_CHAR (STBV.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE_OR_RECEIPT_DATE, STBV.BLOCKED_QTY, STBV.DOC_TYPE_DESC, STBV.STORE_DESC, STBV.ITEM_DESC, STBV.TRN_TYPE_DESC, STBV.BIN_DESC, TO_CHAR (STBV.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, AM.SHORT_DESC GEN_UOM_DESC  FROM ST_BLOCKED_BATCHES_LANG_VIEW STBV,MM_ITEM_LANG_VW MM, AM_UOM AM WHERE STBV.FACILITY_ID = ? AND STBV.TRN_TYPE LIKE ? AND STBV.DOC_TYPE_CODE LIKE ? AND STBV.DOC_NO LIKE ? AND STBV.STORE_CODE LIKE UPPER (?) AND STBV.ITEM_CODE LIKE UPPER (?) AND STBV.BATCH_ID LIKE UPPER (?) AND (STBV.DOC_DATE BETWEEN TO_DATE (NVL (?, '01/01/1901'),'DD/MM/YYYY') AND TO_DATE (NVL (?, '31/12/3012'),'DD/MM/YYYY')) AND STBV.LANGUAGE_ID = ? AND STBV.LANGUAGE_ID = MM.LANGUAGE_ID AND STBV.ITEM_CODE = MM.ITEM_CODE AND MM.GEN_UOM_CODE = AM.UOM_CODE ");

dataMap.put("SQL_ST_BLOCKED_BATCHES_VIEW_QUERY_RESULT","SELECT STBV.DOC_TYPE_CODE, STBV.DOC_NO, STBV.SEQ_NO, STBV.TRN_TYPE, STBV.DOC_SRL_NO, STBV.STORE_CODE, STBV.ITEM_CODE, STBV.BATCH_ID, STBV.BIN_LOCATION_CODE, TO_CHAR (STBV.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE_OR_RECEIPT_DATE, STBV.BLOCKED_QTY, STBV.DOC_TYPE_DESC, STBV.STORE_DESC, STBV.ITEM_DESC, STBV.TRN_TYPE_DESC, STBV.BIN_DESC, TO_CHAR (STBV.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, AM.SHORT_DESC GEN_UOM_DESC  FROM ST_BLOCKED_BATCHES_LANG_VIEW STBV,MM_ITEM_LANG_VW MM, AM_UOM AM WHERE STBV.FACILITY_ID = ? AND STBV.TRN_TYPE LIKE ? AND STBV.DOC_TYPE_CODE LIKE ? AND STBV.DOC_NO LIKE ? AND STBV.STORE_CODE LIKE UPPER (?) AND STBV.ITEM_CODE LIKE UPPER (?) AND STBV.BATCH_ID LIKE UPPER (?) AND (STBV.DOC_DATE BETWEEN TO_DATE (NVL (?, '01/01/1901'),'DD/MM/YYYY') AND TO_DATE (NVL (?, TO_CHAR(sysdate,'DD/MM/YYYY')),'DD/MM/YYYY')) AND STBV.LANGUAGE_ID = ? AND STBV.LANGUAGE_ID = MM.LANGUAGE_ID AND STBV.ITEM_CODE = MM.ITEM_CODE AND MM.GEN_UOM_CODE = AM.UOM_CODE ");


//Friday, July 02, 2004 Query to find whether item is expired or not
dataMap.put("SQL_ST_BATCH_SEARCH_DATE_VALIDATE","select TO_DATE(?,'DD/MM/YYYY') - trunc(sysdate) dt_value from dual ");
dataMap.put("SQL_ST_BATCH_SEARCH_SUSPEND_YN","SELECT suspended_yn suspend_yn  FROM st_item_batch  WHERE  STORE_CODE =? and item_code = ?    AND batch_id = ?    AND bin_location_code = ?   AND trunc(expiry_date_or_receipt_date)= TO_DATE(?,'dd/mm/yyyy') ");
//QUERY ITEM STORE BIN LOCATION
		dataMap.put("SQL_MM_BIN_LOCATION_SELECT_ALL","SELECT bin_location_code,short_desc FROM mm_bin_location_lang_vw mm_bin_location WHERE eff_status ='E' AND store_code=? AND UPPER(short_desc) like UPPER(?) AND language_id = ? ORDER BY short_desc");
		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_SELECT_ALL","SELECT	bin_location_code FROM st_item_store_bin_locn WHERE  store_code=? AND item_code=?");
	// Commented by B.Badmavathi against HSA-CRF-0220
	//	dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_QUERY_RESULT","SELECT stisbl.bin_location_code, mmbl.short_desc bin_location_desc, stisbl.store_code, mmst.short_desc store_desc, stisbl.item_code,	mmit.short_desc	item_desc FROM st_item_store_bin_locn stisbl, mm_store_lang_vw mmst, mm_item_lang_vw mmit, mm_bin_location_lang_vw mmbl WHERE  stisbl.store_code = mmst.store_code AND stisbl.item_code = mmit.item_code AND stisbl.store_code=mmbl.store_code AND stisbl.bin_location_code=mmbl.bin_location_code AND stisbl.store_code LIKE UPPER(?) AND UPPER(mmst.long_desc) LIKE UPPER(?) AND stisbl.item_code LIKE UPPER(?) AND UPPER(mmit.long_desc) LIKE UPPER(?) AND stisbl.bin_location_code LIKE UPPER(?) AND UPPER(mmbl.long_desc) LIKE UPPER(?) AND mmst.language_id = mmit.language_id AND mmst.language_id = mmbl.language_id AND mmst.language_id = ? group by mmit.short_desc, mmst.short_desc, mmbl.short_desc, stisbl.bin_location_code, stisbl.store_code, stisbl.item_code");
		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_QUERY_RESULT","SELECT stisbl.bin_location_code, mmbl.short_desc bin_location_desc, stisbl.store_code, mmst.short_desc store_desc, stisbl.item_code,	mmit.short_desc	item_desc FROM st_item_store_bin_locn stisbl, mm_store_lang_vw mmst, mm_item_lang_vw mmit, mm_bin_location_lang_vw mmbl WHERE  stisbl.store_code = mmst.store_code AND stisbl.item_code = mmit.item_code AND stisbl.store_code=mmbl.store_code AND stisbl.bin_location_code=mmbl.bin_location_code AND stisbl.store_code LIKE UPPER(?) AND UPPER(mmst.long_desc) LIKE UPPER(?) AND stisbl.item_code LIKE UPPER(?) AND UPPER(mmit.long_desc) LIKE UPPER(?) AND stisbl.bin_location_code LIKE UPPER(?) AND UPPER(mmbl.long_desc) LIKE UPPER(?) AND mmst.language_id = mmit.language_id AND mmst.language_id = mmbl.language_id AND mmst.language_id = ? AND stisbl.eff_status='Y' group by mmit.short_desc, mmst.short_desc, mmbl.short_desc, stisbl.bin_location_code, stisbl.store_code, stisbl.item_code");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_INSERT","INSERT INTO st_item_store_bin_locn ( store_code, item_code, bin_location_code, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id,eff_status ) VALUES  ( ?, ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ?,? )");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_COUNT" , "SELECT COUNT(BIN_LOCATION_CODE) BIN_LOCATION_CODE  FROM st_item_store_bin_locn WHERE item_code = ? AND store_code = ?");

		
//CALCULATE STOCK LEVELS
		//   dataMap.put("SQL_ST_ITEM_FOR_CALCULATE_STOCK_LEVELS","SELECT a.item_code, d.short_desc item_desc, qty_on_hand, NVL(min_stk_qty,0) min_stk_qty, NVL(max_stk_qty,0) max_stk_qty, NVL(reorder_level,0) reorder_level, NVL(reorder_qty,0) reorder_qty, lead_days, min_stock_days, buffer_perc, unit_cost, -1 * (SUM(NVL(cons_qty,0)+NVL(sal_qty,0)+NVL(srt_qty,0))) / (? * 30 ) avg_cons_day FROM st_item_move_summ a, st_item c, mm_item d, (SELECT item_code,SUM(qty_on_hand) qty_on_hand FROM st_item_store WHERE  item_code BETWEEN ? AND ? AND stock_item_yn='Y' GROUP BY item_code ) e, WHERE a.item_code=e.item_code AND a.item_code=c.item_code AND c.item_code=d.item_code AND c.item_code BETWEEN ? AND ?  AND d.item_class_code BETWEEN ? AND ? AND d.eff_status= 'E' AND lead_days IS NOT NULL AND min_stock_days IS NOT NULL AND buffer_perc IS NOT NULL AND move_year * 100 + move_month BETWEEN TO_CHAR(ADD_MONTHS(SYSDATE, -?+1),'yyyymm') AND  TO_CHAR(SYSDATE ,'yyyymm') GROUP BY a.item_code,d.short_desc,min_stk_qty,max_stk_qty,reorder_level,reorder_qty, lead_days, min_stock_days,d.item_class_code,buffer_perc,unit_cost,qty_on_hand");
//Added on 16/04/2005 for Exclude Ext.Stores
		  dataMap.put("SQL_ST_ITEM_FOR_CALCULATE_STOCK_LEVELS","SELECT a.item_code, d.short_desc item_desc, qty_on_hand, NVL(min_stk_qty,0) min_stk_qty, NVL(max_stk_qty,0) max_stk_qty, NVL(reorder_level,0) reorder_level, NVL(reorder_qty,0) reorder_qty, lead_days, min_stock_days, buffer_perc, unit_cost, -1 * (SUM(NVL(cons_qty,0)+NVL(sal_qty,0)+NVL(srt_qty,0))) / (? * 30 ) avg_cons_day FROM st_item_move_summ a, st_item c,mm_item_lang_vw d, (SELECT item_code,SUM(qty_on_hand) qty_on_hand FROM st_item_store WHERE  item_code BETWEEN ? AND ? AND stock_item_yn='Y' 	GROUP BY item_code ) e,mm_store f WHERE a.item_code=e.item_code AND a.item_code=c.item_code AND c.item_code=d.item_code AND c.item_code BETWEEN ? AND ?  AND d.item_class_code BETWEEN ? AND ? AND d.eff_status= 'E' AND lead_days IS NOT NULL AND min_stock_days IS NOT NULL AND buffer_perc IS NOT NULL AND move_year * 100 + move_month BETWEEN TO_CHAR(ADD_MONTHS(SYSDATE, -?+1),'yyyymm') AND  TO_CHAR(SYSDATE ,'yyyymm') and f.store_code=a.store_code(+) and f.EXTERNAL_YN like NVL(?,'%') AND d.language_id = ? GROUP BY a.item_code,d.short_desc,min_stk_qty,max_stk_qty,reorder_level,reorder_qty, lead_days,min_stock_days,d.item_class_code,buffer_perc,unit_cost,qty_on_hand");
		dataMap.put("SQL_ST_ITEM_UPDATE_FOR_CALCULATE_STOCK_LEVELS","UPDATE st_item SET reorder_level=?, reorder_qty=?, min_stk_qty=?, max_stk_qty=?, lead_days=NVL(?,lead_days), min_stock_days=NVL(?,min_stock_days), buffer_perc=NVL(?,buffer_perc), modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE item_code=?");
		dataMap.put("SQL_ST_BIN_LOCATION_DESC" ,"SELECT SHORT_DESC FROM MM_BIN_LOCATION_LANG_VW MM_BIN_LOCATION WHERE BIN_LOCATION_CODE = ? AND language_id = ?");


//COMPUTE STOCK LEVELS STORES
		dataMap.put("SQL_ST_STORES_LOOKUP","SELECT	st.store_code code, mm.short_desc description FROM mm_store mm,st_store st   WHERE  mm.facility_id  LIKE ?	AND	 UPPER(st.store_code) LIKE	UPPER (?) AND UPPER(mm.short_desc) LIKE	UPPER(?)  AND mm.eff_status='E' AND STORE_TYPE_FLAG <> 'N' AND mm.store_code=st.store_code ORDER BY 2");

		//Comented By Sakti against TPid# 287263 AMS-SCF-0266 [IN:041352] included st_get_post_mth_yr()
		//dataMap.put("SQL_ST_ITEM_FOR_CALCULATE_STOCK_LEVELS_STORES","SELECT   a.item_code,  d.short_desc item_desc,  qty_on_hand,  NVL(min_stk_qty,  0) min_stk_qty,  NVL(max_stk_qty,  0) max_stk_qty,  NVL(reorder_level,  0) reorder_level,nvl(reorder_qty,0) reorder_qty,  lead_days,  min_stock_days,  percent_min_stock,  unit_cost,  -1 * (SUM(DECODE(?, 'Y', NVL(OUT_ISS_QTY_ST, 0) + NVL(OUT_URG_QTY_ST,0),  0)+NVL(OUT_ISS_QTY_NS, 0) + NVL(OUT_URG_QTY_NS, 0)+NVL(sal_qty, 0)+NVL(srt_qty, 0))) / (? * 30 ) avg_cons_day FROM   ST_ITEM_MOVE_SUMM a,  MM_ITEM_LANG_VW d,  ST_ITEM_STORE c WHERE   a.item_code=c.item_code AND  a.store_code = c.store_code AND  c.item_code=d.item_code AND  c.store_code=? AND d.item_code BETWEEN ? AND ?  AND  d.item_class_code BETWEEN ? AND  ?   AND  d.eff_status= 'E' AND  lead_days IS NOT NULL AND  min_stock_days IS NOT NULL AND  percent_min_stock IS NOT NULL AND  STOCK_ITEM_YN = 'Y' AND  move_year * 100 + move_month BETWEEN TO_CHAR(ADD_MONTHS(SYSDATE, -?+1),'yyyymm') AND  TO_CHAR(SYSDATE ,'yyyymm') AND d.language_id = ? GROUP BY a.item_code, d.short_desc, qty_on_hand, NVL(min_stk_qty,0) , NVL(max_stk_qty,0) , NVL(reorder_level,0) , lead_days, min_stock_days, percent_min_stock, unit_cost,reorder_qty");

		dataMap.put("SQL_ST_ITEM_FOR_CALCULATE_STOCK_LEVELS_STORES","SELECT   a.item_code,  d.short_desc item_desc,  qty_on_hand,  NVL(min_stk_qty,  0) min_stk_qty,  NVL(max_stk_qty,  0) max_stk_qty,  NVL(reorder_level,  0) reorder_level,nvl(reorder_qty,0) reorder_qty,  lead_days,  min_stock_days,  percent_min_stock,  unit_cost,  -1 * (SUM(DECODE(?, 'Y', NVL(OUT_ISS_QTY_ST, 0) + NVL(OUT_URG_QTY_ST,0),  0)+NVL(OUT_ISS_QTY_NS, 0) + NVL(OUT_URG_QTY_NS, 0)+NVL(sal_qty, 0)+NVL(srt_qty, 0))) / (? * 30 ) avg_cons_day FROM   ST_ITEM_MOVE_SUMM a,  MM_ITEM_LANG_VW d,  ST_ITEM_STORE c WHERE   a.item_code=c.item_code AND  a.store_code = c.store_code AND  c.item_code=d.item_code AND  c.store_code=? AND d.item_code BETWEEN ? AND ?  AND  d.item_class_code BETWEEN ? AND  ?   AND  d.eff_status= 'E' AND  lead_days IS NOT NULL AND  min_stock_days IS NOT NULL AND  percent_min_stock IS NOT NULL AND  STOCK_ITEM_YN = 'Y' AND  TO_CHAR(move_year * 100 + move_month) BETWEEN to_char(ADD_MONTHS(TO_DATE((SUBSTR (st_get_post_mth_yr (trunc(SYSDATE)), 3, 4)  || SUBSTR(st_get_post_mth_yr (trunc(SYSDATE)),1,2)),'YYYY/MM'), -? + 1 ),'YYYYMM')AND to_char(ADD_MONTHS(TO_DATE((SUBSTR(st_get_post_mth_yr (trunc(SYSDATE)), 3, 4)  || SUBSTR(st_get_post_mth_yr (trunc(SYSDATE)),1,2)),'YYYY/MM'), 0 ),'YYYYMM') AND d.language_id = ? GROUP BY a.item_code, d.short_desc, qty_on_hand, NVL(min_stk_qty,0) , NVL(max_stk_qty,0) , NVL(reorder_level,0) , lead_days, min_stock_days, percent_min_stock, unit_cost,reorder_qty");

		dataMap.put("SQL_ST_ITEM_UPDATE_FOR_CALCULATE_STOCK_LEVELS_STORES","UPDATE ST_ITEM_STORE SET reorder_level=?, reorder_qty = ?,min_stk_qty=?, max_stk_qty=?, lead_days=NVL(?,lead_days), min_stock_days=NVL(?,min_stock_days), percent_min_stock=NVL(?,percent_min_stock), modified_by_id=?, modified_date= SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE store_code=? AND STOCK_ITEM_YN = 'Y' AND item_code= ? ");

//Replacement GRN
//		dataMap.put("SQL_ST_REPLACE_GRN_BATCH_SEARCH" , "SELECT RTVDTL.ITEM_CODE, RTVHDR.STORE_CODE, RTVDTL.DOC_TYPE_CODE, RTVDTL.DOC_NO, RTVDTL.DOC_SRL_NO, RTVDTL.RTV_REPL_QTY, RTVDTL.PEND_REPL_QTY, RTVDTL.ITEM_QTY_NORMAL, RTVHDR.RTV_FOR_REPLACEMENT_YN , MM.SHORT_DESC ITEM_DESC, STS.SHORT_DESC STORE_DESC FROM ST_RTV_HDR RTVHDR , ST_RTV_DTL RTVDTL, MM_ITEM MM,MM_STORE STS WHERE RTVDTL.ITEM_CODE = (?)  AND  RTVDTL.DOC_TYPE_CODE LIKE  (?) AND  RTVDTL.DOC_NO LIKE (?)  AND RTVHDR.SUPP_CODE LIKE (?) AND RTVDTL.FACILITY_ID = ? AND RTVHDR.RTV_FOR_REPLACEMENT_YN = 'Y' AND RTVDTL.DOC_NO = RTVHDR.DOC_NO AND RTVDTL.DOC_TYPE_CODE = RTVHDR.DOC_TYPE_CODE AND  RTVDTL.ITEM_CODE = MM.ITEM_CODE AND RTVHDR.STORE_CODE = STS.STORE_CODE AND RTVDTL.REPL_COMPLETED_YN !=  'Y' AND RTVDTL.PEND_REPL_QTY > 0 AND FINALIZED_YN='Y'");
		 // Modified by Ram 4/18/2005 to include the RTV_unit cost
		dataMap.put("SQL_ST_REPLACE_GRN_BATCH_SEARCH" , "SELECT distinct rtvdtl.item_code, rtvhdr.store_code, rtvdtl.doc_type_code,        rtvdtl.doc_no, rtvdtl.doc_srl_no, rtvdtl.rtv_repl_qty, rtvdtl.pend_repl_qty, rtvdtl.item_qty_normal,        rtvdtl.rtv_unit_cost, rtvhdr.rtv_for_replacement_yn, mm.short_desc item_desc, sts.short_desc store_desc, am.short_desc pur_uom_desc FROM st_rtv_hdr rtvhdr, st_rtv_dtl rtvdtl, mm_item mm, mm_store sts, st_rtv_dtl_exp rtvexp, st_grn_dtl grndtl, am_uom am WHERE rtvdtl.item_code = (?) AND rtvdtl.doc_type_code LIKE (?) AND rtvdtl.doc_no LIKE (?) AND rtvhdr.supp_code LIKE (?) AND rtvdtl.facility_id = ? AND rtvhdr.rtv_for_replacement_yn = 'Y' AND rtvdtl.doc_no = rtvhdr.doc_no AND rtvdtl.doc_type_code = rtvhdr.doc_type_code AND rtvdtl.item_code = mm.item_code AND rtvhdr.store_code = sts.store_code AND rtvdtl.repl_completed_yn != 'Y' AND rtvdtl.pend_repl_qty > 0 AND finalized_yn = 'Y' AND rtvdtl.facility_id = rtvexp.FACILITY_ID AND rtvdtl.DOC_NO = rtvexp.DOC_NO AND rtvdtl.DOC_type_code = rtvexp.DOC_type_code AND grndtl.doc_no = rtvexp.GRN_DOC_NO    AND grndtl.doc_type_code = rtvexp.GRN_DOC_type_code AND am.uom_code = grndtl.PUR_UOM_CODE ");
//		dataMap.put("ST_SQL_REPLACE_GRN_UPDATE_RTV" , "UPDATE ST_RTV_DTL SET PEND_REPL_QTY = (?) ,  REPL_COMPLETED_YN = (?) WHERE ITEM_CODE = (?) AND  DOC_TYPE_CODE = (?) AND DOC_NO = (?) AND DOC_SRL_NO = (?) AND FACILITY_ID = (?)" );  // Modified on 5/29/2006 for updating modification details
		dataMap.put("ST_SQL_REPLACE_GRN_UPDATE_RTV" , "UPDATE ST_RTV_DTL SET PEND_REPL_QTY = (?) ,  REPL_COMPLETED_YN = (?) , modified_by_id = (?), modified_date	= SYSDATE, modified_at_ws_no =(?),	modified_facility_id = (?)  WHERE ITEM_CODE = (?) AND  DOC_TYPE_CODE = (?) AND DOC_NO = (?) AND DOC_SRL_NO = (?) AND FACILITY_ID = (?)" );
		dataMap.put("ST_SQL_REPLACE_GRN_RTV_INSERT" , "INSERT INTO  ST_REPL_GRN_RTV_DTL (FACILITY_ID , DOC_TYPE_CODE ,DOC_NO ,DOC_SRL_NO,ITEM_CODE,RTV_DOC_TYPE_CODE,RTV_DOC_NO,RTV_DOC_SRL_NO,REPL_GRN_QTY,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");

/*Added by  Phani on Wednesday, September 01, 2004 */
/*GRN History Query Function*/

	//	dataMap.put("ST_SQL_GRN_HISTORY" , "SELECT  b.item_code, f.short_desc,b.PUR_UOM_CODE,TO_CHAR (a.doc_date, 'DD/MM/RRRR') doc_date, a.po_no,a.doc_no, a.doc_type_code, a.supp_code, b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus,ROUND (b.grn_unit_cost_in_pur_uom, 3) grn_unit_cost_in_pur_uom,ROUND(SUM (b.item_qty_bonus + b.item_qty_normal)* grn_unit_cost_in_pur_uom,3) grn_val,DECODE (b.replace_on_expiry_yn,       'N', 'No','Y', 'Yes') replace_on_expiry_yn,a.store_code, d.short_name supp_name, e.short_desc store_desc,TO_CHAR (expiry_date_or_receipt_date,'dd/mm/rrrr') expiry_date_or_receipt_date, c.batch_id, a.finalized_yn,SUM (rtv_item_qty_normal + rtv_item_qty_bonus) rtv_dtl , NVL(grn_rtv_cnt,0) grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE FROM st_grn_hdr a,st_grn_dtl b,st_grn_dtl_exp c,ap_supplier_lang_vw d,mm_store_lang_vw e, mm_item_lang_vw f,(SELECT doc_type_code,doc_no,COUNT(*) grn_rtv_cnt FROM st_repl_grn_rtv_dtl GROUP BY doc_type_code,doc_no) g WHERE g.doc_type_code(+)=a.doc_type_code AND g.doc_no(+)=a.doc_no AND a.facility_id = b.facility_id      AND b.facility_id = c.facility_id AND a.doc_type_code = b.doc_type_code AND a.doc_type_code = c.doc_type_code AND a.doc_no = b.doc_no AND a.doc_no = c.doc_no AND a.store_code = c.store_code AND b.item_code = c.item_code AND b.doc_srl_no = c.doc_srl_no AND d.supp_code = a.supp_code AND a.store_code = e.store_code AND b.item_code = f.item_code AND b.item_code LIKE NVL (?, '%')  AND a.doc_no LIKE NVL (?,'%') AND NVL(A.EXT_DOC_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~')  AND a.supp_code LIKE NVL (?, '%')    AND a.doc_date BETWEEN TO_DATE (NVL (?, '01/01/1900'), 'dd/mm/yyyy') AND NVL (TO_DATE (?,'dd/mm/yyyy'), SYSDATE) AND a.finalized_yn LIKE DECODE (?, 'A', '%', ?)AND a.store_code LIKE NVL (?, '%') AND NVL(A.PO_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~') AND d.language_id = e.language_id AND d.language_id = f.language_id AND d.language_id = ? GROUP BY b.item_code,a.doc_date,a.po_no, a.doc_no,a.doc_type_code, a.supp_code ,GRN_UNIT_COST_IN_PUR_UOM,b.replace_on_expiry_yn,a.store_code,d.SHORT_NAME,e.SHORT_DESC,  EXPIRY_DATE_OR_RECEIPT_DATE,c.BATCH_ID ,a.finalized_yn,b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus , f.short_desc,b.PUR_UOM_CODE, grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE 	HAVING ? = 'A' AND (NVL(grn_rtv_cnt,0) > 0 OR NVL(grn_rtv_cnt,0) < = 0)  OR ?= 'Y' AND (NVL(grn_rtv_cnt,0) > 0 ) OR ?= 'N' AND (grn_rtv_cnt IS NULL)  ORDER BY b.item_code,f.short_desc,b.PUR_UOM_CODE,a.doc_no,a.doc_type_code"); // Modified on 1/20/2005 By RAM 
	
	// The above query commented and the below query added by Padmapriya for adding sale_price and sale_value
	//commented by Rabbani #Inc no:43683(ML-BRU-SCF-1029) on 03-OCT-2013
	//dataMap.put("ST_SQL_GRN_HISTORY" , "SELECT  b.item_code, f.short_desc,b.PUR_UOM_CODE,TO_CHAR (a.doc_date, 'DD/MM/RRRR') doc_date, a.po_no,a.doc_no, a.doc_type_code, a.supp_code, b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus,ROUND (b.grn_unit_cost_in_pur_uom, 3) grn_unit_cost_in_pur_uom,ROUND(SUM (b.item_qty_bonus + b.item_qty_normal)* grn_unit_cost_in_pur_uom,3) grn_val,DECODE (b.replace_on_expiry_yn,       'N', 'No','Y', 'Yes') replace_on_expiry_yn,a.store_code, d.short_name supp_name, e.short_desc store_desc,TO_CHAR (expiry_date_or_receipt_date,'dd/mm/rrrr') expiry_date_or_receipt_date, c.batch_id, a.finalized_yn,SUM (rtv_item_qty_normal + rtv_item_qty_bonus) rtv_dtl , NVL(grn_rtv_cnt,0) grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE,c.sale_price,(b.item_qty_normal*c.sale_price) sale_value  FROM st_grn_hdr a,st_grn_dtl b,st_grn_dtl_exp c,ap_supplier_lang_vw d,mm_store_lang_vw e, mm_item_lang_vw f,(SELECT doc_type_code,doc_no,COUNT(*) grn_rtv_cnt FROM st_repl_grn_rtv_dtl GROUP BY doc_type_code,doc_no) g WHERE g.doc_type_code(+)=a.doc_type_code AND g.doc_no(+)=a.doc_no AND a.facility_id = b.facility_id      AND b.facility_id = c.facility_id AND a.doc_type_code = b.doc_type_code AND a.doc_type_code = c.doc_type_code AND a.doc_no = b.doc_no AND a.doc_no = c.doc_no AND a.store_code = c.store_code AND b.item_code = c.item_code AND b.doc_srl_no = c.doc_srl_no AND d.supp_code = a.supp_code AND a.store_code = e.store_code AND b.item_code = f.item_code AND b.item_code LIKE NVL (?, '%')  AND a.doc_no LIKE NVL (?,'%') AND NVL(A.EXT_DOC_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~')  AND a.supp_code LIKE NVL (?, '%')    AND a.doc_date BETWEEN TO_DATE (NVL (?, '01/01/1900'), 'dd/mm/yyyy') AND NVL (TO_DATE (?,'dd/mm/yyyy'), SYSDATE) AND a.finalized_yn LIKE DECODE (?, 'A', '%', ?)AND a.store_code LIKE NVL (?, '%') AND NVL(A.PO_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~') AND d.language_id = e.language_id AND d.language_id = f.language_id AND d.language_id = ? GROUP BY b.item_code,a.doc_date,a.po_no, a.doc_no,a.doc_type_code, a.supp_code ,GRN_UNIT_COST_IN_PUR_UOM,b.replace_on_expiry_yn,a.store_code,d.SHORT_NAME,e.SHORT_DESC,  EXPIRY_DATE_OR_RECEIPT_DATE,c.BATCH_ID ,a.finalized_yn,b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus , f.short_desc,b.PUR_UOM_CODE, grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE,c.sale_price 	HAVING ? = 'A' AND (NVL(grn_rtv_cnt,0) > 0 OR NVL(grn_rtv_cnt,0) < = 0)  OR ?= 'Y' AND (NVL(grn_rtv_cnt,0) > 0 ) OR ?= 'N' AND (grn_rtv_cnt IS NULL)  ORDER BY b.item_code,f.short_desc,b.PUR_UOM_CODE,a.doc_no,a.doc_type_code");
	
	//Added by Rabbani #Inc no:43683(ML-BRU-SCF-1029) on 03-OCT-2013
	//dataMap.put("ST_SQL_GRN_HISTORY" , "SELECT  b.item_code, f.short_desc,b.PUR_UOM_CODE,(SELECT short_desc FROM am_uom_lang_vw  WHERE uom_code = b.pur_uom_code AND language_id = ?) pur_uom_desc,TO_CHAR (a.doc_date, 'DD/MM/RRRR') doc_date, a.po_no,a.doc_no, a.doc_type_code, a.supp_code, b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus,ROUND (b.grn_unit_cost_in_pur_uom, 3) grn_unit_cost_in_pur_uom,ROUND(SUM (b.item_qty_bonus + b.item_qty_normal)* grn_unit_cost_in_pur_uom,3) grn_val,DECODE (b.replace_on_expiry_yn,       'N', 'No','Y', 'Yes') replace_on_expiry_yn,a.store_code, d.short_name supp_name, e.short_desc store_desc,TO_CHAR (expiry_date_or_receipt_date,'dd/mm/rrrr') expiry_date_or_receipt_date, c.batch_id, a.finalized_yn,SUM (rtv_item_qty_normal + rtv_item_qty_bonus) rtv_dtl , NVL(grn_rtv_cnt,0) grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE,c.sale_price,(b.item_qty_normal*c.sale_price) sale_value  FROM st_grn_hdr a,st_grn_dtl b,st_grn_dtl_exp c,ap_supplier_lang_vw d,mm_store_lang_vw e, mm_item_lang_vw f,(SELECT doc_type_code,doc_no,COUNT(*) grn_rtv_cnt FROM st_repl_grn_rtv_dtl GROUP BY doc_type_code,doc_no) g WHERE g.doc_type_code(+)=a.doc_type_code AND g.doc_no(+)=a.doc_no AND a.facility_id = b.facility_id      AND b.facility_id = c.facility_id AND a.doc_type_code = b.doc_type_code AND a.doc_type_code = c.doc_type_code AND a.doc_no = b.doc_no AND a.doc_no = c.doc_no AND a.store_code = c.store_code AND b.item_code = c.item_code AND b.doc_srl_no = c.doc_srl_no AND d.supp_code = a.supp_code AND a.store_code = e.store_code AND b.item_code = f.item_code AND b.item_code LIKE NVL (?, '%')  AND a.doc_no LIKE NVL (?,'%') AND NVL(A.EXT_DOC_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~')  AND a.supp_code LIKE NVL (?, '%')    AND a.doc_date BETWEEN TO_DATE (NVL (?, '01/01/1900'), 'dd/mm/yyyy') AND NVL (TO_DATE (?,'dd/mm/yyyy'), SYSDATE) AND a.finalized_yn LIKE DECODE (?, 'A', '%', ?)AND a.store_code LIKE NVL (?, '%') AND NVL(A.PO_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~') AND d.language_id = e.language_id AND d.language_id = f.language_id AND d.language_id = ? GROUP BY b.item_code,a.doc_date,a.po_no, a.doc_no,a.doc_type_code, a.supp_code ,GRN_UNIT_COST_IN_PUR_UOM,b.replace_on_expiry_yn,a.store_code,d.SHORT_NAME,e.SHORT_DESC,  EXPIRY_DATE_OR_RECEIPT_DATE,c.BATCH_ID ,a.finalized_yn,b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus , f.short_desc,b.PUR_UOM_CODE, grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE,c.sale_price 	HAVING ? = 'A' AND (NVL(grn_rtv_cnt,0) > 0 OR NVL(grn_rtv_cnt,0) < = 0)  OR ?= 'Y' AND (NVL(grn_rtv_cnt,0) > 0 ) OR ?= 'N' AND (grn_rtv_cnt IS NULL)  ORDER BY b.item_code,f.short_desc,b.PUR_UOM_CODE,a.doc_no,a.doc_type_code");//Commented by suresh.r 27-11-2013 against MMS-SCF-0166
	dataMap.put("ST_SQL_GRN_HISTORY" , "SELECT  b.item_code, f.short_desc,b.PUR_UOM_CODE,(SELECT short_desc FROM am_uom_lang_vw  WHERE uom_code = b.pur_uom_code AND language_id = ?) pur_uom_desc,TO_CHAR (a.doc_date, 'DD/MM/RRRR') doc_date, a.po_no,a.doc_no, a.doc_type_code, a.supp_code, b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus,ROUND (b.grn_unit_cost_in_pur_uom, 3) grn_unit_cost_in_pur_uom,ROUND(SUM (b.item_qty_bonus + b.item_qty_normal)* grn_unit_cost_in_pur_uom,3) grn_val,DECODE (b.replace_on_expiry_yn,       'N', 'No','Y', 'Yes') replace_on_expiry_yn,a.store_code, d.short_name supp_name, e.short_desc store_desc,TO_CHAR (expiry_date_or_receipt_date,'dd/mm/rrrr') expiry_date_or_receipt_date, c.batch_id, a.finalized_yn,SUM (rtv_item_qty_normal + rtv_item_qty_bonus) rtv_dtl , NVL(grn_rtv_cnt,0) grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE,c.grn_item_qty,(c.sale_price*b.pur_uom_conv) sale_price,(c.grn_item_qty*c.sale_price*b.pur_uom_conv) sale_value  FROM st_grn_hdr a,st_grn_dtl b,st_grn_dtl_exp c,ap_supplier_lang_vw d,mm_store_lang_vw e, mm_item_lang_vw f,(SELECT doc_type_code,doc_no,COUNT(*) grn_rtv_cnt FROM st_repl_grn_rtv_dtl GROUP BY doc_type_code,doc_no) g WHERE g.doc_type_code(+)=a.doc_type_code AND g.doc_no(+)=a.doc_no AND a.facility_id = b.facility_id      AND b.facility_id = c.facility_id AND a.doc_type_code = b.doc_type_code AND a.doc_type_code = c.doc_type_code AND a.doc_no = b.doc_no AND a.doc_no = c.doc_no AND a.store_code = c.store_code AND b.item_code = c.item_code AND b.doc_srl_no = c.doc_srl_no AND d.supp_code = a.supp_code AND a.store_code = e.store_code AND b.item_code = f.item_code AND b.item_code LIKE NVL (?, '%')  AND a.doc_no LIKE NVL (?,'%') AND NVL(A.EXT_DOC_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~')  AND a.supp_code LIKE NVL (?, '%')    AND a.doc_date BETWEEN TO_DATE (NVL (?, '01/01/1900'), 'dd/mm/yyyy') AND NVL (TO_DATE (?,'dd/mm/yyyy'), SYSDATE) AND a.finalized_yn LIKE DECODE (?, 'A', '%', ?)AND a.store_code LIKE NVL (?, '%') AND NVL(A.PO_NO,0) BETWEEN NVL(?,'!') AND NVL(?,'~') AND d.language_id = e.language_id AND d.language_id = f.language_id AND d.language_id = ? GROUP BY b.item_code,a.doc_date,a.po_no, a.doc_no,a.doc_type_code, a.supp_code ,GRN_UNIT_COST_IN_PUR_UOM,b.replace_on_expiry_yn,a.store_code,d.SHORT_NAME,e.SHORT_DESC,  EXPIRY_DATE_OR_RECEIPT_DATE,c.BATCH_ID ,a.finalized_yn,b.item_qty_normal, b.item_qty_sample, b.item_qty_bonus , f.short_desc,b.PUR_UOM_CODE, grn_rtv_cnt,A.EXT_DOC_NO,A.EXT_DOC_TYPE_CODE,c.sale_price,b.pur_uom_conv,c.grn_item_qty 	HAVING ? = 'A' AND (NVL(grn_rtv_cnt,0) > 0 OR NVL(grn_rtv_cnt,0) < = 0)  OR ?= 'Y' AND (NVL(grn_rtv_cnt,0) > 0 ) OR ?= 'N' AND (grn_rtv_cnt IS NULL)  ORDER BY b.item_code,f.short_desc,b.PUR_UOM_CODE,a.doc_no,a.doc_type_code");//Added by suresh.r 27-11-2013 against MMS-SCF-0166
	
	
	
//		dataMap.put("ST_SQL_GRN_HISTORY_BATCH_DTLS" , "SELECT to_char(expiry_date_or_receipt_date,'DD/MM/RRRR')expiry_date_or_receipt_date, round(SUM (grn_item_qty) * d.unit_cost,3) GRN_COST,batch_id, bin_location_code, a.trade_id, c.short_name trade_name, b.short_name man_name FROM ST_GRN_DTL_EXP a, am_manufacturer b, AM_TRADE_NAME c, mm_item d WHERE  a.trade_id = c.trade_id(+) AND c.manufacturer_id = b.manufacturer_id(+) AND a.item_code = d.item_code and doc_no = ? AND doc_type_code = ? and batch_id = ? GROUP BY expiry_date_or_receipt_date,batch_id,bin_location_code,a.trade_id,c.short_name,b.short_name,d.unit_cost ");
		dataMap.put("ST_SQL_GRN_HISTORY_RTV_DTLS" , "SELECT A.Doc_Type_Code, A.Doc_No,item_Qty_Normal, Item_Qty_Bonus, round(Rtv_Unit_Cost,3)Rtv_Unit_Cost,item_qty*ROUND(Rtv_Unit_Cost,3) item_Cost_Value,TO_CHAR (Expiry_Date_Or_Receipt_Date,'dd/mm/yyyy') Expiry_Date_Or_Receipt_Date, Batch_Id  ,c.short_desc , item_qty FROM St_Rtv_Dtl A,st_Rtv_Dtl_Exp B ,mm_store c WHERE A. Doc_Type_Code= B.Doc_Type_Code AND A.Doc_No= B.Doc_No AND A.Doc_Srl_No = B.Doc_Srl_No AND c.STORE_CODE = b.STORE_CODE and Grn_Doc_Type_Code =? AND Grn_Doc_No = ? AND a.ITEM_CODE = ? ");
		dataMap.put("ST_SQL_REPL_GRN_RTV_DTLS" , "SELECT rtv_doc_type_code, rtv_doc_no, rtv_doc_srl_no, repl_grn_qty,SUM (rtv_item_qty_normal + rtv_item_qty_bonus) rtv_item_qty FROM st_repl_grn_rtv_dtl a, st_grn_dtl b WHERE a.doc_type_code = b.doc_type_code AND a.doc_no = b.doc_no AND a.item_code = ? AND a.doc_type_code = ? AND a.doc_no = ? GROUP BY rtv_doc_type_code, rtv_doc_no, rtv_doc_srl_no,repl_grn_qty ORDER BY rtv_doc_no");

//RTV History Function
		dataMap.put("ST_SQL_RTV_HISTORY" , "SELECT  b.item_code,f.short_desc,a.DOC_TYPE_CODE,a.doc_no,TO_CHAR (a.doc_date, 'DD/MM/RRRR') doc_date,a.SUPP_CODE,ROUND(RTV_UNIT_COST,3)RTV_UNIT_COST ,ITEM_QTY_NORMAL, ITEM_QTY_BONUS, ITEM_COST_VALUE,e.short_desc STORE_CODE,TO_CHAR(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/rrrr')EXPIRY_DATE_OR_RECEIPT_DATE,c.batch_id , grn_doc_type_code, grn_doc_no,a.finalized_yn , NVL(rtv_grn_cnt,0)rtv_grn_cnt , ITEM_QTY FROM st_rtv_hdr a, st_rtv_dtl b, st_rtv_dtl_exp c,ap_supplier d,mm_store e  ,mm_item f ,(SELECT   rtv_doc_type_code, rtv_doc_no, COUNT (*) rtv_grn_cnt FROM st_repl_grn_rtv_dtl GROUP BY rtv_doc_type_code, rtv_doc_no)g WHERE a.facility_id = b.facility_id    AND b.facility_id = c.facility_id    AND a.doc_type_code = b.doc_type_code    AND a.doc_type_code = c.doc_type_code    AND a.doc_no = b.doc_no    AND a.doc_no = c.doc_no    AND a.store_code = c.store_code    AND b.item_code = c.item_code   AND b.item_code = f.item_code   AND b.doc_srl_no = c.doc_srl_no    AND d.SUPP_CODE = a.SUPP_CODE    AND a.STORE_CODE = e.STORE_CODE AND b.item_code LIKE NVL (?, '%') AND a.supp_code LIKE NVL (?, '%')    AND a.doc_date BETWEEN TO_DATE (NVL (?, '01/01/1900'), 'dd/mm/yyyy') AND NVL (TO_DATE (?,'dd/mm/yyyy'), SYSDATE) AND a.finalized_yn LIKE DECODE (?, 'A', '%', ?) AND rtv_for_replacement_yn LIKE DECODE (?,'A', '%',?) AND a.store_code LIKE NVL (?, '%') and g.rtv_doc_type_code(+) =a.doc_type_code and  g.rtv_doc_no(+) = a.doc_no  ORDER BY b.item_code,f.short_desc,a.doc_no,a.doc_type_code");
		dataMap.put("ST_SQL_RTV_HISTORY_GRN_DTLS" , "SELECT a.doc_type_code, a.doc_no, item_qty_normal, item_qty_bonus,round(grn_unit_cost_in_pur_uom,3)grn_unit_cost_in_pur_uom, batch_id, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy')expiry_date_or_receipt_date,round(grn_item_qty * grn_unit_cost_in_pur_uom,3) grn_cost ,grn_item_qty FROM st_grn_dtl a, st_grn_dtl_exp b WHERE a.doc_no = b.doc_no  AND a.doc_type_code = b.doc_type_code AND a.doc_srl_no = b.doc_srl_no AND a.doc_no= ? AND a.doc_type_code = ? AND a.ITEM_CODE = ? ");
		dataMap.put("ST_SQL_REPL_RTV_GRN_DTLS" , "SELECT   a.doc_type_code, a.doc_no,a.doc_srl_no,rtv_repl_qty, pend_repl_qty ,repl_grn_qty FROM st_repl_grn_rtv_dtl a, st_rtv_dtl b WHERE a.rtv_doc_type_code = b.doc_type_code AND a.rtv_doc_no = b.doc_no AND a.rtv_doc_srl_no = b.doc_srl_no AND a.ITEM_CODE = ? AND a.rtv_doc_type_code = ? AND a.rtv_doc_no = ? ");
// Query for Selecting Facility_names from Sm_facility_param Tuesday, November 09, 2004 Added By Phani
	//	dataMap.put("ST_SQL_SM_FACILITY_PARAM" , "SELECT facility_id, facility_name FROM sm_facility_param order by facility_name ");
// Modified on 7/1/2005 to restrict the facility ID based upon the user rights
		dataMap.put("ST_SQL_SM_FACILITY_PARAM" , "SELECT  A.FACILITY_ID,B.FACILITY_NAME  FROM SM_FACILITY_FOR_USER A, SM_FACILITY_PARAM B  WHERE   A.FACILITY_ID=B.FACILITY_ID AND APPL_USER_ID =? AND   (ACCESS_EFF_DATE_TO IS NULL OR ACCESS_EFF_DATE_TO>=SYSDATE)");
// Query For  Selecting Atc Classification Tuesday, November 16, 2004 Added By Phaniraj
		dataMap.put("ST_SQL_ATC_CLASS_LEV1" , "SELECT   atc_class_lev1_code code, atc_class_lev1_desc description FROM ph_atc_class_lev1_lang_vw ph_atc_class_lev1 WHERE  language_id LIKE ?  AND atc_class_lev1_code LIKE UPPER (?) AND UPPER (atc_class_lev1_desc) LIKE UPPER (?) ORDER BY atc_class_lev1_desc");
		dataMap.put("ST_SQL_ATC_CLASS_LEV2" , "SELECT   atc_class_lev2_code code, atc_class_lev2_desc description FROM ph_atc_class_lev2_lang_vw ph_atc_class_lev2 WHERE language_id LIKE ? AND atc_class_lev2_code LIKE UPPER (?) AND UPPER (atc_class_lev2_desc) LIKE UPPER (?)   ORDER BY atc_class_lev2_desc");
		dataMap.put("ST_SQL_ATC_CLASS_LEV3" , "SELECT   atc_class_lev3_code code, atc_class_lev3_desc description FROM ph_atc_class_lev3_lang_vw ph_atc_class_lev3 WHERE  language_id LIKE ? AND atc_class_lev3_code LIKE UPPER (?) AND UPPER (atc_class_lev3_desc) LIKE UPPER (?)  ORDER BY atc_class_lev3_desc");
		dataMap.put("ST_SQL_ATC_CLASS_LEV4" , "SELECT   atc_class_lev4_code code, atc_class_lev4_desc description FROM ph_atc_class_lev4_lang_vw ph_atc_class_lev4 WHERE  language_id LIKE ? AND atc_class_lev4_code LIKE UPPER (?) AND UPPER (atc_class_lev4_desc) LIKE UPPER (?)  ORDER BY atc_class_lev4_desc");
		dataMap.put("ST_SQL_ATC_CLASS_LEV5" , "SELECT   atc_class_lev5_code code, atc_class_lev5_desc description FROM ph_atc_class_lev5_lang_vw ph_atc_class_lev5 WHERE  language_id LIKE ? AND atc_class_lev5_code LIKE UPPER (?) AND UPPER (atc_class_lev5_desc) LIKE UPPER (?)  ORDER BY atc_class_lev5_desc");
// LookUp for Repacking Location  Thursday, November 25, 2004 Added BY PhaniRaj
		dataMap.put("SQL_ST_REPACK_LOCATION_LOOKUP", "SELECT      REPACKING_GROUP_CODE	     code,   short_desc    description   FROM    ST_REPACKING_GROUP_LANG_VW      ST_REPACKING_GROUP    			WHERE    eff_status='E'	  AND    language_id like  ?     AND  	REPACKING_GROUP_CODE   LIKE   upper(?)	   AND	  upper(short_desc)   LIKE   upper(?)	ORDER BY  2");
		dataMap.put("SQL_ST_ITEM_STORE_MIN_MAX_SELECT","SELECT   a.min_stk_qty, a.max_stk_qty, a.reorder_level, a.qty_on_hand, SUM (NVL (committed_qty, 0)), (a.qty_on_hand - SUM (NVL (committed_qty, 0))/? )available_qty FROM st_item_store a, st_item_batch b WHERE a.item_code = ? AND a.store_code = ? AND a.item_code = b.item_code(+) AND a.store_code = b.store_code(+) GROUP BY a.min_stk_qty, a.max_stk_qty, a.reorder_level, a.qty_on_hand, b.item_code, b.store_code");
		dataMap.put("SQL_ST_ITEM_STORE_MIN_MAX_SELECT1","SELECT   a.min_stk_qty, a.max_stk_qty, a.reorder_level, a.qty_on_hand, SUM (NVL (committed_qty, 0)), a.qty_on_hand available_qty FROM st_item_store a, st_item_batch b WHERE a.item_code = ? AND a.store_code = ? AND a.item_code = b.item_code(+) AND a.store_code = b.store_code(+) GROUP BY a.min_stk_qty, a.max_stk_qty, a.reorder_level, a.qty_on_hand, b.item_code, b.store_code");

        dataMap.put("SQL_ST_ASSEMBLY_INSTRN_UPDATE","UPDATE ST_ASSEMBLY_INSTRN SET instrn_text = ?, eff_status = ?, modified_by_id = ?, modified_date = SYSDATE, modified_at_ws_no = ?, modified_facility_id = ? WHERE instrn_code = ? ");
        dataMap.put("SQL_ST_ASSEMBLY_INSTRN_SELECT","SELECT COUNT(*) FROM ST_ASSEMBLY_INSTRN WHERE INSTRN_CODE=? ");
        dataMap.put("SQL_ST_ASSEMBLY_INSTRN_INSERT","INSERT INTO ST_ASSEMBLY_INSTRN (INSTRN_CODE,INSTRN_TEXT,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
        dataMap.put("SQL_ST_ASSEMBLY_INSTRN_QRY_SELECT","SELECT  INSTRN_CODE ASSM_INSTRN_CODE, INSTRN_TEXT, EFF_STATUS FROM ST_ASSEMBLY_INSTRN WHERE UPPER(INSTRN_CODE) LIKE UPPER(?) AND UPPER(INSTRN_TEXT) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?)");

		dataMap.put("SQL_ST_CONV_FACTOR_SELECT","SELECT EQVL_VALUE CONV_FACTOR  FROM MM_ITEM_UOM_DEFN WHERE UOM_CODE = ? AND EQVL_UOM_CODE= (SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE STORE_CODE= ? AND ITEM_CODE=  ?) AND ITEM_CODE = ? UNION SELECT	eqvl_value FROM	am_uom_eqvl	WHERE uom_code = ? AND eqvl_uom_code= (SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE STORE_CODE=? AND ITEM_CODE=?)");
		dataMap.put("SQL_ST_CONV_FACTOR_SELECT1","SELECT EQVL_VALUE CONV_FACTOR FROM MM_ITEM_UOM_DEFN WHERE UOM_CODE = ? AND EQVL_UOM_CODE = (SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE STORE_CODE = ? AND ITEM_CODE = ?) AND ITEM_CODE = ? UNION SELECT EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE = ? AND EQVL_UOM_CODE = (SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE STORE_CODE = ? AND ITEM_CODE = ?) UNION SELECT 1 FROM DUAL WHERE ? = (SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE STORE_CODE = ? AND ITEM_CODE = ?)");
		dataMap.put("SQL_ST_GEN_UOM_CODE_SELECT","SELECT GEN_UOM_CODE FROM MM_ITEM_LANG_VW WHERE ITEM_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_ST_UOM_SHORT_DESC_SELECT","SELECT SHORT_DESC FROM AM_UOM_LANG_VW WHERE UOM_CODE=(SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE STORE_CODE=? AND ITEM_CODE=?) AND LANGUAGE_ID=? ");
		dataMap.put("SQL_ST_ITEM_DETAIL_SELECT1","SELECT DISTINCT sbys.eqvl_value a, sons.eqvl_value b, itm.short_desc item_desc, uom.short_desc uom_desc,(CASE WHEN ('1' = '1') THEN (SELECT SUM (avail_qty) / ? FROM st_batch_search_lang_view WHERE store_code = rbys.store_code AND item_code = sitm.item_code AND language_id =  itm.language_id AND LANG1= ITM.LANGUAGE_ID AND LANG2=ITM.LANGUAGE_ID) ELSE 0 END) req_by_qty_on_hand, (CASE WHEN ('1' = '1') THEN (SELECT SUM (avail_qty) /? FROM st_batch_search_lang_view  WHERE store_code = rons.store_code AND item_code = sitm.item_code AND language_id =  itm.language_id AND LANG1= ITM.LANGUAGE_ID AND LANG2=ITM.LANGUAGE_ID ) ELSE 0 END) req_on_qty_on_hand, sitm.curr_pack_size, rons.min_stk_qty req_on_min_stk_qty,rons.max_stk_qty req_on_max_stk_qty,rons.reorder_level req_on_reorder_level,                itm.unit_cost, rons.stock_item_yn, rbys.bin_location_code to_bin_location_code, rbys.qty_on_hand req_by_qty_on_hand, rbys.max_stk_qty req_by_max_stk_qty, rbys.min_stk_qty req_by_min_stk_qty, rbys.reorder_level req_by_reorder_level, rons.qty_on_hand req_on_qty_on_hand FROM mm_item_lang_vw itm, am_uom_lang_vw uom, st_item_store rbys, st_item_store rons, st_item sitm, mm_item_uom_defn sbys, mm_item_uom_defn sons WHERE rbys.store_code = ? AND rons.store_code = ? AND sitm.item_code = ? AND itm.gen_uom_code = uom.uom_code AND sitm.item_code = itm.item_code AND rons.item_code = sitm.item_code AND rbys.item_code = sitm.item_code AND itm.language_id = uom.language_id AND itm.language_id = ? AND sitm.item_code = sbys.item_code(+) AND sitm.item_code = sons.item_code(+) AND sbys.uom_code(+) = ? AND sbys.eqvl_uom_code(+) = ? AND sons.uom_code(+) = ? AND sons.eqvl_uom_code(+) = ?");

		//dataMap.put("SQL_ITEM_SEARCH_QUERY_ITM_CMB_CHK1","SELECT    DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,H.DEF_ISSUE_UOM,B.GEN_UOM_CODE,B.UNIT_COST,DECODE( ?, NULL, D.SHORT_DESC,J.SHORT_DESC) UOM_DESC,E.SHORT_NAME       MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,  D.SHORT_DESC GEN_UOM_DESC,h.DEF_REQUEST_UOM  FROM ST_ITEM A,MM_ITEM_LANG_VW      B,MM_ITEM_CLASS_LANG_VW       C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW  E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ITEM_STORE I,AM_UOM_LANG_VW J,ST_ACC_ENTITY_PARAM K   WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'   AND NVL(H.EFF_STATUS,'E') = 'E' AND NVL(I.EFF_STATUS,'E') = 'E'   AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+)  AND B.MANUFACTURER_ID=E.MANUFACTURER_ID(+)  AND A.ITEM_CODE=F.ITEM_CODE(+) AND F.TRADE_ID=G.TRADE_ID(+)         AND A.ITEM_CODE=H.ITEM_CODE(+)    AND A.ITEM_CODE=I.ITEM_CODE(+)  AND /*H.QTY_ON_HAND > 0  AND*/ UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%'))   AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))       AND     UPPER(NVL(A.MACHINE_CODE,'%'))  LIKE      UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%'))     LIKE    UPPER(NVL(?,'%'))   AND UPPER(NVL(F.TRADE_ID,'%')) LIKE    UPPER(NVL(?,'%'))   AND     UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))        AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE   DECODE(?,'A','%',?)     AND      B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE  DECODE(?,'','%',?) AND A.MFG_ITEM_YN LIKE  DECODE(?,'A','%',?)    AND       NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)  AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)  AND       NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND      A.EXPIRY_YN  LIKE DECODE(?,'A','%',?)   AND NVL(H.STORE_CODE,'%') LIKE  UPPER(NVL(?,'%'))       AND NVL(I.STORE_CODE,'%') LIKE  UPPER(NVL(?,'%'))  AND A.CONSIGNMENT_ITEM_YN LIKE  DECODE(?,'A','%',?)  AND H.DEF_ISSUE_UOM = J.UOM_CODE(+) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)	 AND G.LANGUAGE_ID(+) = ? AND J.LANGUAGE_ID(+) = ? AND K.ACC_ENTITY_ID = 'ZZ'");
		//Modified by sakti against AMS-CRF-0028
		
		dataMap.put("SQL_ITEM_SEARCH_QUERY_ITM_CMB_CHK1","SELECT    DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,H.DEF_ISSUE_UOM,B.GEN_UOM_CODE,B.UNIT_COST,DECODE( ?, NULL, D.SHORT_DESC,J.SHORT_DESC) UOM_DESC,E.SHORT_NAME       MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,  D.SHORT_DESC GEN_UOM_DESC,h.DEF_REQUEST_UOM,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty  FROM ST_ITEM A,MM_ITEM_LANG_VW      B,MM_ITEM_CLASS_LANG_VW       C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW  E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ITEM_STORE I,AM_UOM_LANG_VW J,ST_ACC_ENTITY_PARAM K   WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'   AND NVL(H.EFF_STATUS,'E') = 'E' AND NVL(I.EFF_STATUS,'E') = 'E'   AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+)  AND B.MANUFACTURER_ID=E.MANUFACTURER_ID(+)  AND A.ITEM_CODE=F.ITEM_CODE(+) AND F.TRADE_ID=G.TRADE_ID(+)         AND A.ITEM_CODE=H.ITEM_CODE(+)    AND A.ITEM_CODE=I.ITEM_CODE(+)  AND /*H.QTY_ON_HAND > 0  AND*/ UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%'))   AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))       AND     UPPER(NVL(A.MACHINE_CODE,'%'))  LIKE      UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%'))     LIKE    UPPER(NVL(?,'%'))   AND UPPER(NVL(F.TRADE_ID,'%')) LIKE    UPPER(NVL(?,'%'))   AND     UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))        AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE   DECODE(?,'A','%',?)     AND      B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE  DECODE(?,'','%',?) AND A.MFG_ITEM_YN LIKE  DECODE(?,'A','%',?)    AND       NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)  AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)  AND       NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND      A.EXPIRY_YN  LIKE DECODE(?,'A','%',?)   AND NVL(H.STORE_CODE,'%') LIKE  UPPER(NVL(?,'%'))       AND NVL(I.STORE_CODE,'%') LIKE  UPPER(NVL(?,'%'))  AND A.CONSIGNMENT_ITEM_YN LIKE  DECODE(?,'A','%',?)  AND H.DEF_ISSUE_UOM = J.UOM_CODE(+) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)	 AND G.LANGUAGE_ID(+) = ? AND J.LANGUAGE_ID(+) = ? AND K.ACC_ENTITY_ID = 'ZZ'");
		
		//Added by Rabbani#AMS-CRF-0068(49822) on 11-AUG-2014
		//dataMap.put("SQL_ITEM_SEARCH_QUERY_ITM_CMB_CHK1","SELECT    DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS, A.ITEM_CODE,A.EXPIRY_YN,B.ALPHA_CODE,B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC,C.SHORT_DESC ITEM_CLASS_DESC,A.MFG_BASE_QTY,A.MACHINE_CODE,A.MIN_STK_QTY,A.MAX_STK_QTY,B.LONG_DESC,B.PS_ITEM_YN,B.SOLE_SOURCE_YN,B.MANUFACTURER_ID,H.DEF_ISSUE_UOM,B.GEN_UOM_CODE,B.UNIT_COST,DECODE( ?, NULL, D.SHORT_DESC,J.SHORT_DESC) UOM_DESC,E.SHORT_NAME       MANUFACTURE_DESC,A.SPARE_PART_ID,A.MFG_ITEM_YN,A.MEDICAL_ITEM_YN,A.ABC_CLASS_CODE,A.TRADE_ID_APPLICABLE_YN ,A.BATCH_ID_APPLICABLE_YN,A.CONSIGNMENT_ITEM_YN,  D.SHORT_DESC GEN_UOM_DESC,h.DEF_REQUEST_UOM,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty, (NVL(H.MAX_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MAX_STR_QTY  ,(NVL(H.MIN_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MIN_STR_QTY ,(NVL (H.REORDER_LEVEL, 0) * ST_GET_UOM_CONV_FAC_SING_STR (h.item_code,h.store_code)) REORDER_LEVEL  FROM ST_ITEM A,MM_ITEM_LANG_VW      B,MM_ITEM_CLASS_LANG_VW       C,AM_UOM_LANG_VW D ,AM_MANUFACTURER_LANG_VW  E,MM_TRADE_NAME_FOR_ITEM F,AM_TRADE_NAME_LANG_VW G,ST_ITEM_STORE H,ST_ITEM_STORE I,AM_UOM_LANG_VW J,ST_ACC_ENTITY_PARAM K   WHERE A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E'   AND NVL(H.EFF_STATUS,'E') = 'E' AND NVL(I.EFF_STATUS,'E') = 'E'   AND  B.ITEM_CLASS_CODE=C.ITEM_CLASS_CODE(+) AND B.GEN_UOM_CODE=D.UOM_CODE(+)  AND B.MANUFACTURER_ID=E.MANUFACTURER_ID(+)  AND A.ITEM_CODE=F.ITEM_CODE(+) AND F.TRADE_ID=G.TRADE_ID(+)         AND A.ITEM_CODE=H.ITEM_CODE(+)    AND A.ITEM_CODE=I.ITEM_CODE(+)  AND /*H.QTY_ON_HAND > 0  AND*/ UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%'))   AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))       AND     UPPER(NVL(A.MACHINE_CODE,'%'))  LIKE      UPPER(NVL(?,'%'))  AND UPPER(NVL(A.SPARE_PART_ID,'%'))     LIKE    UPPER(NVL(?,'%'))   AND UPPER(NVL(F.TRADE_ID,'%')) LIKE    UPPER(NVL(?,'%'))   AND     UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))        AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?) AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE   DECODE(?,'A','%',?)     AND      B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE  DECODE(?,'','%',?) AND A.MFG_ITEM_YN LIKE  DECODE(?,'A','%',?)    AND       NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)  AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?)  AND       NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?) AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND      A.EXPIRY_YN  LIKE DECODE(?,'A','%',?)   AND NVL(H.STORE_CODE,'%') LIKE  UPPER(NVL(?,'%'))       AND NVL(I.STORE_CODE,'%') LIKE  UPPER(NVL(?,'%'))  AND A.CONSIGNMENT_ITEM_YN LIKE  DECODE(?,'A','%',?)  AND H.DEF_ISSUE_UOM = J.UOM_CODE(+) AND B.LANGUAGE_ID = ?  AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)  AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)	 AND G.LANGUAGE_ID(+) = ? AND J.LANGUAGE_ID(+) = ? AND K.ACC_ENTITY_ID = 'ZZ'");
		dataMap.put("SQL_ITEM_SEARCH_QUERY1","SELECT DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS,A.ITEM_CODE, A.EXPIRY_YN, B.ALPHA_CODE, B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC, C.SHORT_DESC ITEM_CLASS_DESC,                 A.MFG_BASE_QTY, A.MACHINE_CODE, A.MIN_STK_QTY, A.MAX_STK_QTY,                B.LONG_DESC, B.PS_ITEM_YN, B.SOLE_SOURCE_YN,                B.MANUFACTURER_ID,         B.GEN_UOM_CODE, B.UNIT_COST,                DECODE( ?, '%', D.SHORT_DESC,I.SHORT_DESC) UOM_DESC,     E.SHORT_NAME MANUFACTURE_DESC,                A.SPARE_PART_ID, A.MFG_ITEM_YN, A.MEDICAL_ITEM_YN,                A.ABC_CLASS_CODE, A.TRADE_ID_APPLICABLE_YN,                A.BATCH_ID_APPLICABLE_YN, A.CONSIGNMENT_ITEM_YN,                B.CURR_SUPP_CODE ,D.SHORT_DESC gen_uom_desc              FROM ST_ITEM A,                MM_ITEM_LANG_VW B,                MM_ITEM_CLASS_LANG_VW C,                AM_UOM_LANG_VW D,                AM_MANUFACTURER_LANG_VW E,                MM_TRADE_NAME_FOR_ITEM F,                AM_TRADE_NAME_LANG_VW G,                ST_ITEM_STORE H,     AM_UOM_LANG_VW I,ST_ACC_ENTITY_PARAM J          WHERE A.ITEM_CODE = B.ITEM_CODE            AND B.EFF_STATUS = 'E'            AND NVL (H.EFF_STATUS, 'E') = 'E'            AND B.ITEM_CLASS_CODE = C.ITEM_CLASS_CODE(+)            AND B.GEN_UOM_CODE = D.UOM_CODE(+)            AND B.MANUFACTURER_ID = E.MANUFACTURER_ID(+)            AND A.ITEM_CODE = F.ITEM_CODE(+)            AND F.TRADE_ID = G.TRADE_ID(+)            AND A.ITEM_CODE = H.ITEM_CODE(+)AND UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%'))AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))  AND   UPPER(NVL(A.MACHINE_CODE,'%')) LIKE UPPER(NVL(?,'%'))AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE  UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE  UPPER(NVL(?,'%'))AND   UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))    AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?)AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE DECODE(?,'A','%',?)AND   B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)AND A.MFG_ITEM_YN LIKE  DECODE(?,'A','%',?)  AND   NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?) AND   NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?)AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND   A.EXPIRY_YN LIKE DECODE(?,'A','%',?)AND NVL(H.STORE_CODE,'%') LIKE     UPPER(NVL(?,'%'))   AND A.CONSIGNMENT_ITEM_YN LIKE  DECODE(?,'A','%',?)AND  B.LANGUAGE_ID = ?             AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)            AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)            AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)   AND H.DEF_ISSUE_UOM = I.UOM_CODE(+)AND G.LANGUAGE_ID(+) = ? AND I.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		
		
		//dataMap.put("SQL_ITEM_SEARCH_QUERY2","SELECT DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS,A.ITEM_CODE, A.EXPIRY_YN, B.ALPHA_CODE, B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC, C.SHORT_DESC ITEM_CLASS_DESC,                 A.MFG_BASE_QTY, A.MACHINE_CODE, A.MIN_STK_QTY, A.MAX_STK_QTY,                B.LONG_DESC, B.PS_ITEM_YN, B.SOLE_SOURCE_YN,                B.MANUFACTURER_ID,         B.GEN_UOM_CODE, B.UNIT_COST,                DECODE( ?, '%', D.SHORT_DESC,I.SHORT_DESC) UOM_DESC,     E.SHORT_NAME MANUFACTURE_DESC,                A.SPARE_PART_ID, A.MFG_ITEM_YN, A.MEDICAL_ITEM_YN,                A.ABC_CLASS_CODE, A.TRADE_ID_APPLICABLE_YN,                A.BATCH_ID_APPLICABLE_YN, A.CONSIGNMENT_ITEM_YN,                B.CURR_SUPP_CODE ,D.SHORT_DESC gen_uom_desc ,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty              FROM ST_ITEM A,                MM_ITEM_LANG_VW B,                MM_ITEM_CLASS_LANG_VW C,                AM_UOM_LANG_VW D,                AM_MANUFACTURER_LANG_VW E,                MM_TRADE_NAME_FOR_ITEM F,                AM_TRADE_NAME_LANG_VW G,                ST_ITEM_STORE H,     AM_UOM_LANG_VW I,ST_ACC_ENTITY_PARAM J          WHERE A.ITEM_CODE = B.ITEM_CODE            AND B.EFF_STATUS = 'E'            AND NVL (H.EFF_STATUS, 'E') = 'E'            AND B.ITEM_CLASS_CODE = C.ITEM_CLASS_CODE(+)            AND B.GEN_UOM_CODE = D.UOM_CODE(+)            AND B.MANUFACTURER_ID = E.MANUFACTURER_ID(+)            AND A.ITEM_CODE = F.ITEM_CODE(+)            AND F.TRADE_ID = G.TRADE_ID(+)            AND A.ITEM_CODE = H.ITEM_CODE(+)AND UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%'))AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))  AND   UPPER(NVL(A.MACHINE_CODE,'%')) LIKE UPPER(NVL(?,'%'))AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE  UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE  UPPER(NVL(?,'%'))AND   UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))    AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?)AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE DECODE(?,'A','%',?)AND   B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)AND A.MFG_ITEM_YN LIKE  DECODE(?,'A','%',?)  AND   NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?) AND   NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?)AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND   A.EXPIRY_YN LIKE DECODE(?,'A','%',?)AND NVL(H.STORE_CODE,'%') LIKE     UPPER(NVL(?,'%'))   AND A.CONSIGNMENT_ITEM_YN LIKE  DECODE(?,'A','%',?)AND  B.LANGUAGE_ID = ?             AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)            AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)            AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)   AND H.DEF_ISSUE_UOM = I.UOM_CODE(+)AND G.LANGUAGE_ID(+) = ? AND I.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");
		
		//Added by Rabbani#AMS-CRF-0068(49822) on 11-AUG-2014
		dataMap.put("SQL_ITEM_SEARCH_QUERY2","SELECT DISTINCT DECODE(DISP_DECIMAL_DTLS_YN,'Y',ALLOW_DECIMALS_YN,'N') ALLOW_DECIMALS_YN,DECODE(DISP_DECIMAL_DTLS_YN,'Y',NO_OF_DECIMALS,0) NO_OF_DECIMALS,A.ITEM_CODE, A.EXPIRY_YN, B.ALPHA_CODE, B.ITEM_CLASS_CODE,B.SHORT_DESC ITEM_DESC, C.SHORT_DESC ITEM_CLASS_DESC,                 A.MFG_BASE_QTY, A.MACHINE_CODE, A.MIN_STK_QTY, A.MAX_STK_QTY,                B.LONG_DESC, B.PS_ITEM_YN, B.SOLE_SOURCE_YN,                B.MANUFACTURER_ID,         B.GEN_UOM_CODE, B.UNIT_COST,                DECODE( ?, '%', D.SHORT_DESC,I.SHORT_DESC) UOM_DESC,     E.SHORT_NAME MANUFACTURE_DESC,                A.SPARE_PART_ID, A.MFG_ITEM_YN, A.MEDICAL_ITEM_YN,                A.ABC_CLASS_CODE, A.TRADE_ID_APPLICABLE_YN,                A.BATCH_ID_APPLICABLE_YN, A.CONSIGNMENT_ITEM_YN,                B.CURR_SUPP_CODE ,D.SHORT_DESC gen_uom_desc ,(SELECT nvl(SUM (qty_on_hand),0)  FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code)qty_on_hand,(SELECT (  nvl(SUM (qty_on_hand),0)- nvl(SUM (committed_qty),0) ) FROM st_item_batch WHERE item_code = h.item_code AND store_code = h.store_code) available_qty, (NVL(H.MAX_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MAX_STR_QTY  ,(NVL(H.MIN_STK_QTY,0) *ST_GET_UOM_CONV_FAC_SING_STR(h.item_code,h.store_code)) MIN_STR_QTY ,(NVL (H.REORDER_LEVEL, 0) * ST_GET_UOM_CONV_FAC_SING_STR (h.item_code,h.store_code)) REORDER_LEVEL             FROM ST_ITEM A,                MM_ITEM_LANG_VW B,                MM_ITEM_CLASS_LANG_VW C,                AM_UOM_LANG_VW D,                AM_MANUFACTURER_LANG_VW E,                MM_TRADE_NAME_FOR_ITEM F,                AM_TRADE_NAME_LANG_VW G,                ST_ITEM_STORE H,     AM_UOM_LANG_VW I,ST_ACC_ENTITY_PARAM J          WHERE A.ITEM_CODE = B.ITEM_CODE            AND B.EFF_STATUS = 'E'            AND NVL (H.EFF_STATUS, 'E') = 'E'            AND B.ITEM_CLASS_CODE = C.ITEM_CLASS_CODE(+)            AND B.GEN_UOM_CODE = D.UOM_CODE(+)            AND B.MANUFACTURER_ID = E.MANUFACTURER_ID(+)            AND A.ITEM_CODE = F.ITEM_CODE(+)            AND F.TRADE_ID = G.TRADE_ID(+)            AND A.ITEM_CODE = H.ITEM_CODE(+)AND UPPER(A.ITEM_CODE) LIKE UPPER(NVL(?,'%')) AND UPPER(B.SHORT_DESC) LIKE UPPER(NVL(?,'%'))AND UPPER(B.ALPHA_CODE) LIKE UPPER(NVL(?,'%'))  AND   UPPER(NVL(A.MACHINE_CODE,'%')) LIKE UPPER(NVL(?,'%'))AND UPPER(NVL(A.SPARE_PART_ID,'%')) LIKE  UPPER(NVL(?,'%')) AND  UPPER(NVL(F.TRADE_ID,'%'))  LIKE  UPPER(NVL(?,'%'))AND   UPPER(NVL(G.SHORT_NAME,'%')) LIKE UPPER(NVL(?,'%'))    AND NVL(A.ABC_CLASS_CODE,'%') LIKE DECODE(?,'','%',?)AND A.MEDICAL_ITEM_YN LIKE DECODE(?,'A','%',?) AND B.PS_ITEM_YN LIKE DECODE(?,'A','%',?)AND   B.SOLE_SOURCE_YN LIKE DECODE(?,'A','%',?) AND NVL(B.MANUFACTURER_ID,'%')LIKE DECODE(?,'','%',?)AND A.MFG_ITEM_YN LIKE  DECODE(?,'A','%',?)  AND   NVL(B.ITEM_CLASS_CODE,'%')LIKE DECODE(?,'','%',?)AND NVL(B.ITEM_ANAL1_CODE,'%')LIKE DECODE(?,'','%',?) AND   NVL(B.ITEM_ANAL2_CODE,'%')LIKE DECODE(?,'','%',?)AND NVL(B.ITEM_ANAL3_CODE,'%')LIKE DECODE(?,'','%',?) AND   A.EXPIRY_YN LIKE DECODE(?,'A','%',?)AND NVL(H.STORE_CODE,'%') LIKE     UPPER(NVL(?,'%'))   AND A.CONSIGNMENT_ITEM_YN LIKE  DECODE(?,'A','%',?)AND  B.LANGUAGE_ID = ?             AND B.LANGUAGE_ID = C.LANGUAGE_ID(+)            AND B.LANGUAGE_ID = D.LANGUAGE_ID(+)            AND B.LANGUAGE_ID = E.LANGUAGE_ID(+)   AND H.DEF_ISSUE_UOM = I.UOM_CODE(+)AND G.LANGUAGE_ID(+) = ? AND I.LANGUAGE_ID(+) = ? AND J.ACC_ENTITY_ID = 'ZZ'");


		dataMap.put("SQL_ST_DIR_SALE_PATIENT_PARAM_INSERT","INSERT INTO ST_DIR_SALE_PATIENT_PARAM(patient_id,eff_status,added_by_id,added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no,modified_facility_id) VALUES(?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_DIR_SALE_PATIENT_PARAM_UPDATE","UPDATE ST_DIR_SALE_PATIENT_PARAM SET EFF_STATUS=?, MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE PATIENT_ID=?");
		dataMap.put("SQL_ST_DIR_SALE_PATIENT_PARAM_QUERY_RESULT","SELECT  A.PATIENT_ID , A.EFF_STATUS,B.PATIENT_NAME FROM ST_DIR_SALE_PATIENT_PARAM A,MP_PATIENT B WHERE A.PATIENT_ID=B.PATIENT_ID ORDER BY A.ADDED_DATE ");
		dataMap.put("SQL_ST_MP_PATIENT_LOOKUP","SELECT PATIENT_ID CODE,(CASE WHEN  'lang_id' = 'en' THEN PATIENT_NAME ELSE Nvl(PATIENT_NAME_loc_lang,PATIENT_NAME) END) DESCRIPTION FROM MP_PATIENT WHERE Upper(PATIENT_ID) LIKE UPPER(?)  AND      Upper(PATIENT_NAME) LIKE UPPER(?) AND PATIENT_ID NOT IN (SELECT PATIENT_ID FROM ST_DIR_SALE_PATIENT_PARAM)ORDER BY 2");
//Kit Template Code
		dataMap.put("SQL_ST_KIT_TEMPLATE_INSERT","INSERT INTO ST_KIT_TEMPLATE(KIT_TEMPLATE_CODE,KIT_TEMPLATE_DESC,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		
		//dataMap.put("SQL_ST_KIT_TEMPLATE_DTL_INSERT","INSERT INTO ST_KIT_TEMPLATE_DTL(KIT_TEMPLATE_CODE,ITEM_CODE,QUANTITY,UOM_CODE,SEQ_NO,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_KIT_TEMPLATE_DTL_INSERT","INSERT INTO ST_KIT_TEMPLATE_DTL(KIT_TEMPLATE_CODE,ITEM_CODE,QUANTITY,UOM_CODE,SEQ_NO,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,USAGE_TYPE) VALUES(?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)"); //27/07/12
				
		dataMap.put("SQL_ST_KIT_TEMPLATE_UPDATE","UPDATE ST_KIT_TEMPLATE SET EFF_STATUS=?, MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE KIT_TEMPLATE_CODE=?");
		
		//dataMap.put("SQL_ST_KIT_TEMPLATE_DTL_UPDATE","UPDATE ST_KIT_TEMPLATE_DTL SET QUANTITY=?,UOM_CODE=?,SEQ_NO=?,EFF_STATUS=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE KIT_TEMPLATE_CODE=? AND ITEM_CODE=?");
		dataMap.put("SQL_ST_KIT_TEMPLATE_DTL_UPDATE","UPDATE ST_KIT_TEMPLATE_DTL SET QUANTITY=?,UOM_CODE=?,SEQ_NO=?,EFF_STATUS=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?,USAGE_TYPE = ? WHERE KIT_TEMPLATE_CODE=? AND ITEM_CODE=?"); //27/07/12
		
		//dataMap.put("SQL_ST_KIT_TEMPLATE_DTL_SELECT","SELECT KIT_TEMPLATE_CODE,A.ITEM_CODE,B.SHORT_DESC ITEM_DESC,QUANTITY,UOM_CODE,SEQ_NO,A.EFF_STATUS FROM ST_KIT_TEMPLATE_DTL A,MM_ITEM B WHERE KIT_TEMPLATE_CODE=? AND A.ITEM_CODE=B.ITEM_CODE ORDER BY SEQ_NO,A.ITEM_CODE");
		dataMap.put("SQL_ST_KIT_TEMPLATE_DTL_SELECT","SELECT KIT_TEMPLATE_CODE,A.ITEM_CODE,B.SHORT_DESC ITEM_DESC,QUANTITY,UOM_CODE,SEQ_NO,A.EFF_STATUS,A.USAGE_TYPE FROM ST_KIT_TEMPLATE_DTL A,MM_ITEM B WHERE KIT_TEMPLATE_CODE=? AND A.ITEM_CODE=B.ITEM_CODE ORDER BY SEQ_NO,A.ITEM_CODE");
		

		dataMap.put("SQL_ST_UOM_SHORT_DESC_SELECT1","SELECT SHORT_DESC FROM AM_UOM_LANG_VW WHERE UOM_CODE=? AND LANGUAGE_ID=?");
		dataMap.put("SQL_ST_KIT_TEMPLATE_QUERY_RESULT","SELECT   KIT_TEMPLATE_CODE ,  KIT_TEMPLATE_DESC , EFF_STATUS FROM  ST_KIT_TEMPLATE_LANG_VW WHERE    UPPER(KIT_TEMPLATE_CODE) LIKE  UPPER(?) AND      UPPER(KIT_TEMPLATE_DESC) LIKE  UPPER(?) AND EFF_STATUS LIKE  ? AND LANGUAGE_ID LIKE ?");
		//Parent store for store
		dataMap.put("SQL_ST_PARENT_STORE_QUERY_RESULT","SELECT B.STORE_CODE STORE_CODE,D.LONG_DESC STORE_DESC, B.PARENT_STORE_CODE PARENT_STORE_CODE,A.LONG_DESC PARENT_STORE_DESC , C.ITEM_CLASS_CODE  ITEM_CLASS_CODE , C.LONG_DESC ITEM_CLASS_DESC,B.EFF_STATUS  EFF_STATUS FROM MM_STORE  A, ST_STORE_PARENT_STORE B,MM_ITEM_CLASS C,  MM_STORE  D  WHERE A.STORE_CODE=B.PARENT_STORE_CODE      AND  B.STORE_CODE = D.STORE_CODE AND C.ITEM_CLASS_CODE=B.ITEM_CLASS_CODE    AND UPPER(B.STORE_CODE) LIKE UPPER(?) AND UPPER(D.LONG_DESC) LIKE   UPPER(?) AND  UPPER(B.PARENT_STORE_CODE) LIKE   UPPER(?) AND UPPER(A.LONG_DESC) LIKE  UPPER(?)");
		dataMap.put("SQL_ST_PARENT_STORE_STORE_LOOKUP","SELECT MM.STORE_CODE CODE , MM.LONG_DESC  DESCRIPTION FROM MM_STORE_LANG_VW  MM WHERE  MM.EFF_STATUS = 'E'  AND UPPER(MM.STORE_CODE) LIKE UPPER(?) AND UPPER(MM.LONG_DESC) LIKE UPPER(?)  AND LANGUAGE_ID =");
		dataMap.put("SQL_ST__PARENT_STORE_PARENT_STORE_LOOKUP","SELECT MM.STORE_CODE CODE , MM.LONG_DESC  DESCRIPTION FROM MM_STORE_LANG_VW  MM WHERE  MM.EFF_STATUS = 'E' AND UPPER(MM.STORE_CODE) NOT LIKE  UPPER(?) AND UPPER(MM.STORE_CODE) LIKE UPPER(?) AND UPPER(MM.LONG_DESC) LIKE UPPER(?)  AND  LANGUAGE_ID =");
		dataMap.put("SQL_ST_PARENT_STORE_SELECT","SELECT ITEM_CLASS_CODE, LONG_DESC, 'I' DB_ACTION, 'D' EFF_STATUS FROM MM_ITEM_CLASS WHERE ITEM_CLASS_CODE IN   ( (SELECT ITEM_CLASS_CODE   FROM ST_ITEM_CLASS_STORE      WHERE STORE_CODE LIKE ? )   INTERSECT(SELECT ITEM_CLASS_CODE      FROM ST_ITEM_CLASS_STORE       WHERE STORE_CODE  LIKE ? ))AND ITEM_CLASS_CODE NOT IN    (SELECT ITEM_CLASS_CODE         FROM ST_STORE_PARENT_STORE         WHERE STORE_CODE LIKE ? AND PARENT_STORE_CODE LIKE ? )UNION ALL SELECT A.ITEM_CLASS_CODE, B.LONG_DESC, 'U' DB_ACTION, A.EFF_STATUS     FROM ST_STORE_PARENT_STORE A, MM_ITEM_CLASS B WHERE A.STORE_CODE LIKE ?      AND A.PARENT_STORE_CODE LIKE ?      AND A.ITEM_CLASS_CODE = B.ITEM_CLASS_CODE   ORDER BY LONG_DESC");
		dataMap.put("SQL_ST_PARENT_STORE_INSERT","INSERT INTO ST_STORE_PARENT_STORE(STORE_CODE, PARENT_STORE_CODE,ITEM_CLASS_CODE ,EFF_STATUS, ADDED_BY_ID , ADDED_DATE  ,ADDED_AT_WS_NO  ,ADDED_FACILITY_ID, MODIFIED_BY_ID ,MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID )  VALUES( ?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_ST_PARENT_STORE_UPDATE","UPDATE ST_STORE_PARENT_STORE SET EFF_STATUS=? , MODIFIED_BY_ID=? ,MODIFIED_DATE=SYSDATE ,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ITEM_CLASS_CODE=? AND STORE_CODE=? AND  PARENT_STORE_CODE=?");
        dataMap.put("ST_SQL_VIEW_COST_YN_SELECT","SELECT VIEW_COST_YN FROM MM_VIEW_COST_FOR_USER WHERE APPL_USER_ID=? ");
		//Added By Rabbani #inc no:28266 on 19/09/11
		//Starts Here
		dataMap.put("ST_SQL_VIEW_COST_SELECT","SELECT VIEW_COST_YN FROM ST_USER_ACCESS_FOR_STORE WHERE USER_ID =? AND STORE_CODE =?");
		dataMap.put("ST_SQL_VIEW_SALE_YN_SELECT","SELECT VIEW_SALE_YN FROM ST_USER_ACCESS_FOR_STORE  WHERE USER_ID =? AND STORE_CODE = ?");
		//Ends here
		dataMap.put("SQL_ST_USER_LOOKUP_USERACCESS","SELECT appl_user_id code,	appl_user_name  description              FROM	   sm_appl_user_lang_vw sm_appl_user  where    eff_status='E'  AND appl_user_id	 like    UPPER(?)  AND  UPPER(appl_user_name)	like  UPPER(?) AND language_id = ");
		dataMap.put("SQL_ST_RECORDS_PER_TRN_SELECT","SELECT RECORDS_PER_TRN FROM ST_TRN_TYPE WHERE TRN_TYPE=?");
		dataMap.put("ST_ITEM_SEARCH_ITEM_CLASS_DESC_SELECT","SELECT SHORT_DESC FROM MM_ITEM_CLASS WHERE ITEM_CLASS_CODE = ?");
		dataMap.put("ST_GENERATE_REQUEST_DEF_ISSUE_REQUEST_UOM","SELECT A.DEF_ISSUE_UOM, A.DEF_REQUEST_UOM, B.GEN_UOM_CODE	FROM ST_ITEM_STORE A, MM_ITEM B WHERE A.ITEM_CODE = B.ITEM_CODE AND A.ITEM_CODE = ? AND A.STORE_CODE = ?");
		dataMap.put("ST_GENERATE_REQUEST_EQVL_VALUE_1","SELECT MM.EQVL_VALUE FROM MM_ITEM_UOM_DEFN MM,ST_ITEM_STORE ST WHERE MM.UOM_CODE = ? AND MM.EQVL_UOM_CODE = ? AND MM.ITEM_CODE = ? AND ST.ITEM_CODE=MM.ITEM_CODE");
		dataMap.put("ST_GENERATE_REQUEST_CONV_FACTOR_1","SELECT   EQVL_VALUE CONV_FACTOR FROM    MM_ITEM_UOM_DEFN WHERE UOM_CODE = ? AND EQVL_UOM_CODE= (SELECT DEF_REQUEST_UOM FROM ST_ITEM_STORE WHERE STORE_CODE= ? AND  ITEM_CODE=  ?)AND ITEM_CODE = ? UNION SELECT	eqvl_value FROM	am_uom_eqvl	WHERE uom_code = ?  AND eqvl_uom_code= (SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE STORE_CODE=? AND ITEM_CODE=?)");
		dataMap.put("ST_GENERATE_REQUEST_EQVL_VALUE_SELECT","SELECT EQVL_VALUE FROM    mm_item_uom_defn WHERE ITEM_CODE = ?    AND       EQVL_UOM_CODE=?");
		dataMap.put("ST_GENERATE_REQUEST_DEFAULT_UOM_SELECT","Select DEF_ISSUE_UOM,DEF_REQUEST_UOM from st_item_store where store_code = ? and item_code = ?");
		dataMap.put("ST_GENERATE_REQUEST_ISSUE_UOM_DESC_SELECT","Select am.SHORT_DESC SHORT_DESC from st_item_store st,am_uom am,mm_item_uom_defn mm where st.store_code = ? and st.item_code = ? and st.DEF_ISSUE_UOM = ? AND st.DEF_ISSUE_UOM=AM.UOM_CODE  and st.item_code=mm.item_code(+)");
		dataMap.put("ST_GENERATE_REQUEST_REQ_UOM_DESC_SELECT","Select am.SHORT_DESC SHORT_DESC from st_item_store st,am_uom am,mm_item_uom_defn mm where st.store_code = ? and st.item_code = ? and st.DEF_REQUEST_UOM = ? AND st.DEF_REQUEST_UOM=AM.UOM_CODE and st.item_code=mm.item_code(+)");
		dataMap.put("ST_GENERATE_REQUEST_DEF_ISSUE_UOM_SELECT","Select DEF_ISSUE_UOM from st_item_store where store_code = ? and item_code = ?");
		dataMap.put("ST_GENERATE_REQUEST_DEF_ISSUE_UOM_CONVERSION_SELECT","SELECT EQVL_UOM_CODE,EQVL_VALUE FROM MM_ITEM_UOM_DEFN WHERE ITEM_CODE = ? AND UOM_CODE=(SELECT GEN_UOM_CODE FROM MM_ITEM_LANG_VW WHERE ITEM_CODE=? AND LANGUAGE_ID=?) AND EQVL_UOM_CODE=(SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE ITEM_CODE=? AND STORE_CODE=?) UNION SELECT EQVL_UOM_CODE,EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE=(SELECT GEN_UOM_CODE FROM MM_ITEM_LANG_VW WHERE ITEM_CODE=? AND LANGUAGE_ID=?) AND EQVL_UOM_CODE=(SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE WHERE ITEM_CODE=? AND STORE_CODE=?)");
		dataMap.put("ST_GENERATE_REQUEST_DEF_REQUEST_UOM_CONVERSION_SELECT","SELECT EQVL_UOM_CODE,EQVL_VALUE FROM MM_ITEM_UOM_DEFN WHERE ITEM_CODE = ? AND UOM_CODE=(SELECT GEN_UOM_CODE FROM MM_ITEM_LANG_VW WHERE ITEM_CODE=? AND LANGUAGE_ID=?) AND EQVL_UOM_CODE=(SELECT DEF_REQUEST_UOM FROM ST_ITEM_STORE WHERE ITEM_CODE=? AND STORE_CODE=?) UNION SELECT EQVL_UOM_CODE,EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE=(SELECT GEN_UOM_CODE FROM MM_ITEM_LANG_VW WHERE ITEM_CODE=? AND LANGUAGE_ID=?) AND EQVL_UOM_CODE=(SELECT DEF_REQUEST_UOM FROM ST_ITEM_STORE WHERE ITEM_CODE=? AND STORE_CODE=?)");
		
		dataMap.put("SQL_ST_AUTH_AT_REQ_ON_STORE_SELECT","SELECT DISTINCT stp.store_code PARENT_STORE_CODE, mm.short_desc FROM ST_STORE_PARENT_STORE stp, mm_store_lang_vw mm ,ST_STORE st, ST_ACC_ENTITY_PARAM pa WHERE  st.store_code = mm.store_code AND stp.store_code = mm.store_code AND mm.eff_status = 'E' AND st.req_allowed_yn = 'Y' AND  (1 = 1 OR 'user_id' = ? OR 'acc_entity_id' = ?) AND mm.facility_id  like decode(pa.trn_across_facility_yn,'Y','%',?) AND mm.language_id = ? AND stp.parent_store_code = ? ORDER BY 2");
		
		//modified by sakti
		//dataMap.put("SQL_ST_ISSUE_REQ_URG_TO_STORE1","SELECT DISTINCT stp.store_code parent_store_code, mm.short_desc   FROM st_store_parent_store stp,  mm_store_lang_vw mm,  st_acc_entity_param pa,st_store st  WHERE mm.store_code = stp.store_code AND st.store_code = mm.store_code  AND mm.eff_status = 'E'  AND pa.acc_entity_id = (?) AND mm.facility_id like decode(trn_across_facility_yn ,'Y','%',?)  AND st.req_allowed_yn = 'Y'   AND mm.language_id = ?  AND stp.parent_store_code = ?");
		dataMap.put("SQL_ST_ISSUE_REQ_URG_TO_STORE1","SELECT DISTINCT stp.store_code parent_store_code, mm.short_desc   FROM st_store_parent_store stp,  mm_store_lang_vw mm,  st_acc_entity_param pa,st_store st  WHERE mm.store_code = stp.store_code AND st.store_code = mm.store_code  AND mm.eff_status = 'E'  AND pa.acc_entity_id = (?) AND mm.facility_id like decode(trn_across_facility_yn ,'Y','%',?)  AND st.req_allowed_yn = 'Y'   AND mm.language_id = ?  AND stp.parent_store_code = ? ORDER BY 2");

		dataMap.put("SQL_ST_PHY_INV_UNIT_COST","SELECT UNIT_COST FROM MM_ITEM_LANG_VW WHERE ITEM_CODE = ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_ST_ITEM_STORE_MODIFY_BIN_LOCN_COUNT","SELECT COUNT(BIN_LOCATION_CODE) BIN_LOCATION_CODE  FROM st_item_store_bin_locn WHERE item_code = ? AND store_code = ? and BIN_LOCATION_CODE=? ");
		dataMap.put("SQL_ST_KIT_DTL_SELECT","SELECT DISTINCT  KIT.ITEM_CODE, KIT.QUANTITY, MM.SHORT_DESC, MM.GEN_UOM_CODE UOM_CODE,ST.EXPIRY_YN, AM1.SHORT_DESC GEN_UOM_DESC, MM.UNIT_COST,(SELECT SHORT_DESC FROM ST_ITEM_STORE A, ST_KIT_TEMPLATE_DTL B, AM_UOM C WHERE A.ITEM_CODE = B.ITEM_CODE AND KIT_TEMPLATE_CODE = ? AND A.ITEM_CODE = KIT.ITEM_CODE AND STORE_CODE = ? AND C.UOM_CODE = A.DEF_ISSUE_UOM )STOCK_UOM_DESC, (SELECT DEF_ISSUE_UOM FROM ST_ITEM_STORE A, ST_KIT_TEMPLATE_DTL B WHERE A.ITEM_CODE = B.ITEM_CODE AND KIT_TEMPLATE_CODE = ? AND A.ITEM_CODE = KIT.ITEM_CODE AND STORE_CODE = ? )def_issue_uom, SEQ_NO FROM ST_KIT_TEMPLATE_DTL KIT, MM_ITEM_LANG_VW MM, ST_ITEM ST, AM_UOM_LANG_VW AM, AM_UOM_LANG_VW AM1 WHERE KIT_TEMPLATE_CODE = ? AND MM.ITEM_CODE = KIT.ITEM_CODE AND MM.LANGUAGE_ID = ? AND KIT.EFF_STATUS = 'E' AND ST.ITEM_CODE = KIT.ITEM_CODE AND MM.LANGUAGE_ID = AM.LANGUAGE_ID AND MM.GEN_UOM_CODE = AM1.UOM_CODE AND MM.LANGUAGE_ID = AM1.LANGUAGE_ID ORDER BY SEQ_NO,MM.SHORT_DESC");
		dataMap.put("SQL_ST_GRN_ITEM_CLASS_BASED_YN","SELECT     ITEM_CLASS_BASED_YN   FROM     st_trn_type_lang_vw   WHERE   TRN_TYPE= ? AND LANGUAGE_ID=? ");
		dataMap.put("SQL_ST_KIT_TEMPLATE_UOM_CODE","SELECT   b.eqvl_uom_code eqvl_uom_code, short_desc FROM am_uom_lang_vw a, am_uom_eqvl b WHERE eff_status = 'E'  AND b.eqvl_uom_code = a.uom_code AND b.uom_code = ? AND a.language_id = ?  UNION SELECT   uom_code, short_desc   FROM am_uom_lang_vw WHERE uom_code = ? AND language_id = ? UNION  SELECT eqvl_uom_code, short_desc FROM MM_ITEM_UOM_DEFN a, am_uom_lang_vw b WHERE a.uom_code = ? AND a.eqvl_uom_code = b.uom_code AND a.eff_status = 'E' AND b.language_id = ? AND item_code = ? ORDER BY short_desc");
		dataMap.put("SQL_ST_STORE_SELECT1","SELECT NVL (OP_SALE_APPL_YN, 'N') OUTPATIENT_YN,NVL (IP_SALE_APPL_YN, 'N') INPATIENT_YN,NVL (REF_SALE_APPL_YN, 'N') REFERRAL_YN,NVL (DC_SALE_APPL_YN, 'N') DAYCARE_YN,NVL (EM_SALE_APPL_YN, 'N') EMERGENCY_YN,NVL (DIRECT_SALE_APPL_YN, 'N') DIRECTSALE_YN FROM ST_STORE WHERE STORE_CODE = ? ");

		dataMap.put("ST_SQL_SALES_DOC_NO_SELECT","SELECT HDR.DOC_NO SALES_DOC_NO FROM ST_SAL_HDR HDR, ST_SAL_DTL_EXP DTLEXP WHERE HDR.PATIENT_ID = ? AND HDR.FACILITY_ID = ?  AND NVL(HDR.ENCOUNTER_ID,1) = NVL(?,NVL(HDR.ENCOUNTER_ID,1)) AND HDR.SAL_TRN_TYPE = ? AND HDR.STORE_CODE = ? AND HDR.FINALIZED_YN = 'Y' AND SAL_TRN_TYPE != 'C' AND  HDR.DOC_TYPE_CODE = DTLEXP.DOC_TYPE_CODE AND  HDR.DOC_NO = DTLEXP.DOC_NO HAVING SUM(SAL_ITEM_QTY- NVL(RET_ITEM_QTY,0))>0 GROUP BY HDR.DOC_NO ORDER BY HDR.DOC_NO");
		dataMap.put("ST_SQL_SAL_RET_DOC_NO_SELECT_MULTIPLE","SELECT DISTINCT SH.PATIENT_ID,SH.ENCOUNTER_ID,SH.SAL_TRN_TYPE,SH.PATIENT_NAME, SH.STORE_CODE,SD.ITEM_CODE,SD.STOCK_ITEM_YN,SD.ITEM_QTY,SD.DOC_SRL_NO,MM.SHORT_DESC ITEM_DESC,ST.EXPIRY_YN,SD.GROSS_CHARGE_AMT,SD.PAT_NET_AMT,SD.ITEM_UNIT_COST,SD.ITEM_COST_VALUE,STITM.DEF_ISSUE_UOM UOM_CODE, AM.SHORT_DESC UOM_DESC,SUM(SAL_ITEM_QTY - NVL(RET_ITEM_QTY,0)) STOCK_AVAILABLE FROM ST_SAL_HDR SH,ST_SAL_DTL SD,MM_ITEM_LANG_VW MM,ST_ITEM ST,ST_ITEM_STORE STITM,AM_UOM_LANG_VW AM,ST_SAL_DTL_EXP STEXP WHERE MM.ITEM_CODE = SD.ITEM_CODE AND   ST.ITEM_CODE = MM.ITEM_CODE AND	  SH.DOC_NO    = SD.DOC_NO AND	  SH.DOC_TYPE_CODE    = SD.DOC_TYPE_CODE AND	  STITM.ITEM_CODE = SD.ITEM_CODE AND   STITM.STORE_CODE = SH.STORE_CODE AND   AM.UOM_CODE	   = STITM.DEF_ISSUE_UOM AND   MM.LANGUAGE_ID = AM.LANGUAGE_ID AND   SH.DOC_NO		 = ? AND   MM.LANGUAGE_ID = ? AND   SH.DOC_TYPE_CODE = (SELECT DOC_TYPE_CODE FROM ST_SAL_HDR WHERE MODULE_ID = ? AND DOC_NO = ?) AND   SD.DOC_NO = STEXP.DOC_NO AND   SD.DOC_TYPE_CODE = STEXP.DOC_TYPE_CODE AND   SD.DOC_SRL_NO = STEXP.DOC_SRL_NO GROUP BY SH.STORE_CODE,SH.ENCOUNTER_ID,SD.ITEM_CODE,SD.STOCK_ITEM_YN,SD.ITEM_QTY,MM.SHORT_DESC,ST.EXPIRY_YN, SD.GROSS_CHARGE_AMT,SD.PAT_NET_AMT,STITM.DEF_ISSUE_UOM, AM.SHORT_DESC,SD.ITEM_UNIT_COST,SH.PATIENT_NAME,SD.ITEM_COST_VALUE,SD.DOC_SRL_NO,SH.PATIENT_ID,SH.ENCOUNTER_ID,SH.SAL_TRN_TYPE");
		dataMap.put("ST_SQL_SAL_RET_DOC_NO_EXP_SELECT","SELECT BATCHVIEW.TRADE_ID, BATCHVIEW.QTY_ON_HAND, BATCHVIEW.USE_AFTER_EXPIRY_YN,	BATCHVIEW.EXPIRY_YN EXPIRY_YN, STEXP.SAL_ITEM_QTY AVAIL_QTY, BATCHVIEW.TRADE_ID_APPLICABLE_YN,	BATCHVIEW.MANUFACTURER_ID, (STEXP.SAL_ITEM_QTY-NVL(STEXP.RET_ITEM_QTY,0)) QTY, BATCHVIEW.STORE_DESC, BATCHVIEW.TRADE_NAME, BATCHVIEW.NOD NOD, BATCHVIEW.ITEM_DESC, BATCHVIEW.MANUFACTURER_NAME,	 BATCHVIEW.STORE_CODE, BATCHVIEW.SUSPENDED_YN, BATCHVIEW.ITEM_CODE,	BATCHVIEW.BIN_LOCATION_CODE NEW_BIN_LOCATION_CODE,STEXP.BIN_LOCATION_CODE, TO_CHAR(BATCHVIEW.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_RECEIPT_DT, BATCHVIEW.BIN_DESC, BATCHVIEW.BATCH_ID,BATCHVIEW.BATCH_STATUS BATCH_STATUS,STEXP.DOC_TYPE_CODE SAL_DOC_TYPE_CODE,STEXP.DOC_NO SAL_DOC_NO FROM ST_BATCH_SEARCH_LANG_VIEW BATCHVIEW, ST_SAL_DTL_EXP STEXP WHERE BATCHVIEW.STORE_CODE=STEXP.STORE_CODE AND BATCHVIEW.ITEM_CODE=STEXP.ITEM_CODE AND BATCHVIEW.BATCH_ID=STEXP.BATCH_ID AND BATCHVIEW.BIN_LOCATION_CODE=STEXP.BIN_LOCATION_CODE AND BATCHVIEW.EXPIRY_DATE=STEXP.EXPIRY_DATE_OR_RECEIPT_DATE AND STEXP.FACILITY_ID=? AND STEXP.DOC_TYPE_CODE=(SELECT DOC_TYPE_CODE FROM ST_SAL_HDR WHERE MODULE_ID = ? AND DOC_NO = ?) AND STEXP.DOC_NO=? AND BATCHVIEW.LANGUAGE_ID = ? AND BATCHVIEW.LANG1 = ? AND BATCHVIEW.LANG2 = ? AND STEXP.DOC_SRL_NO=?");
		dataMap.put("ST_SQL_DIR_SAL_PATIENT_SELECT","SELECT	PATIENT_ID FROM ST_DIR_SALE_PATIENT_PARAM WHERE PATIENT_ID =	UPPER(?) AND EFF_STATUS = 'E'");
		dataMap.put("ST_SQL_DIR_SAL_PAT_LOOKUP","SELECT A.PATIENT_ID CODE, B.PATIENT_NAME DESCRIPTION FROM ST_DIR_SALE_PATIENT_PARAM A, MP_PATIENT B WHERE A.PATIENT_ID LIKE UPPER(?) AND UPPER(B.PATIENT_NAME) LIKE UPPER(?) AND A.EFF_STATUS = 'E' AND A.PATIENT_ID = B.PATIENT_ID");
		dataMap.put("SQL_ST_PARENT_STORE_DESC_CHECK","SELECT COUNT(*) COUNT FROM MM_STORE_LANG_VW WHERE STORE_CODE =? AND LANGUAGE_ID=? AND EFF_STATUS = 'E'");

		dataMap.put("ST_SQL_SALES_DOC_NO_SELECT1","SELECT HDR.DOC_NO DOC_NO,HDR.DOC_NO ItIsToPopulateListBox FROM ST_SAL_HDR HDR, ST_SAL_DTL_EXP DTLEXP WHERE HDR.PATIENT_ID = ? AND HDR.FACILITY_ID = ?  AND NVL(HDR.ENCOUNTER_ID,1) = NVL(?,NVL(HDR.ENCOUNTER_ID,1)) AND HDR.SAL_TRN_TYPE = ? AND HDR.STORE_CODE = ? AND HDR.FINALIZED_YN = 'Y' AND SAL_TRN_TYPE != 'C' AND  HDR.DOC_TYPE_CODE = DTLEXP.DOC_TYPE_CODE AND  HDR.DOC_NO = DTLEXP.DOC_NO /*HAVING SUM(SAL_ITEM_QTY- NVL(RET_ITEM_QTY,0))>0 */GROUP BY HDR.DOC_NO ORDER BY HDR.DOC_NO");
		dataMap.put("SQL_ST_SALES_TYPE_STORE_CMB","SELECT OP_SALE_APPL_YN,REF_SALE_APPL_YN,IP_SALE_APPL_YN from ST_STORE WHERE STORE_CODE=? ");
		//NEW QUERIES BY MAHESH 10/15/2007 ONWARDS
		dataMap.put("SQL_ST_PHY_INV_ID_SELECT","SELECT PHY_INV_ID FROM ST_ITEM_STORE WHERE ITEM_CODE =? AND STORE_CODE=?");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_SELECT","SELECT PHY_INV_ID  FROM st_item_store WHERE store_code IN (SELECT fm_store_code store_code FROM st_issue_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ? AND seq_no = ? UNION SELECT to_store_code store_code FROM st_issue_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ? AND seq_no = ?) AND item_code IN (SELECT item_code FROM st_issue_dtl WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ? AND seq_no = ?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_ISS_RET","SELECT PHY_INV_ID  FROM st_item_store WHERE store_code IN (SELECT fm_store_code store_code FROM st_issue_RET_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?  UNION SELECT to_store_code store_code FROM st_issue_RET_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND item_code IN (SELECT item_code FROM st_issue_RET_dtl WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_TFR","SELECT PHY_INV_ID  FROM st_item_store WHERE store_code IN (SELECT fm_store_code store_code FROM st_transfer_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?  UNION SELECT to_store_code store_code FROM st_transfer_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND item_code IN (SELECT item_code FROM st_transfer_dtl WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_ADJ","SELECT PHY_INV_ID FROM st_item_store WHERE STORE_CODE = (SELECT store_code FROM st_adj_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND item_code IN (SELECT item_code FROM st_ADJ_dtl WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_REQ","SELECT PHY_INV_ID FROM st_item_store WHERE store_code IN (SELECT req_by_store_code store_code FROM st_request_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=? UNION SELECT req_on_store_code store_code FROM st_request_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_request_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_SAL","SELECT PHY_INV_ID FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_sal_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_sal_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_RET","SELECT PHY_INV_ID FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_sal_ret_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_sal_ret_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_GRN","SELECT PHY_INV_ID FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_grn_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_grn_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("SQL_ST_PHY_INV_ID_FRAME_RTV","SELECT PHY_INV_ID FROM st_item_store WHERE store_code IN (SELECT store_code FROM st_rtv_hdr WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND item_code IN (SELECT item_code FROM st_rtv_dtl WHERE facility_id=? AND doc_type_code=? AND doc_no=?) AND phy_inv_id IS NOT NULL");
		dataMap.put("ST_SQL_PHY_INV_ID_STORE_SELECT","SELECT FM_STORE_CODE STORE_CODE,ST.SHORT_DESC FROM ST_PHY_INV_PARAM,MM_STORE_LANG_VW ST WHERE PHY_INV_ID=? AND ST.FACILITY_ID = ? AND FM_STORE_CODE = STORE_CODE AND ST.LANGUAGE_ID=?");
		dataMap.put("ST_SQL_PHY_INV_BATCH_DETAIL_SELECT","SELECT * FROM (SELECT ITEM_CODE,BATCH_ID,TO_CHAR (EXPIRY_DATE_OR_RECEIPT_DATE, 'DD/MM/YYYY') EXPIRY_DATE,BIN_LOCATION_CODE BIN_LOC_CODE,TRADE_ID, ITEM_QTY, NEW_BATCH_YN, 'Y' CHECK_YN,ENTRY_COMPLETED_YN FROM ST_PHY_INV_DTL WHERE STORE_CODE = ? AND ITEM_CODE = ? AND PHY_INV_ID = ? UNION (SELECT ITEM_CODE,BATCH_ID,TO_CHAR (EXPIRY_DATE_OR_RECEIPT_DATE, 'DD/MM/YYYY') EXPIRY_DATE,BIN_LOCATION_CODE BIN_LOC_CODE, TRADE_ID, to_number('') ITEM_QTY,'N' NEW_BATCH_YN  , 'N' CHECK_YN,'N' ENTRY_COMPLETED_YN FROM ST_ITEM_BATCH WHERE STORE_CODE = ? AND ITEM_CODE = ? MINUS SELECT ITEM_CODE,BATCH_ID,TO_CHAR (EXPIRY_DATE_OR_RECEIPT_DATE, 'DD/MM/YYYY') EXPIRY_DATE, BIN_LOCATION_CODE BIN_LOC_CODE,TRADE_ID, to_number('') ITEM_QTY,'N' NEW_BATCH_YN, 'N' CHECK_YN,'N' ENTRY_COMPLETED_YN FROM ST_PHY_INV_DTL WHERE STORE_CODE = ? AND ITEM_CODE = ? AND PHY_INV_ID = ?) ORDER BY BATCH_ID) ORDER BY NEW_BATCH_YN");
		dataMap.put("ST_SQL_PHY_INV_ID_TRADE_SELECT","SELECT  B.SHORT_NAME TRADE_NAME FROM MM_TRADE_NAME_FOR_ITEM A, AM_TRADE_NAME_LANG_VW B, ST_ITEM C WHERE A.TRADE_ID=B.TRADE_ID AND A.ITEM_CODE=C.ITEM_CODE AND C.TRADE_ID_APPLICABLE_YN='Y' AND B.TRADE_ID = ? AND C.ITEM_CODE=? AND B.LANGUAGE_ID = ? UNION SELECT A.DFLT_TRADE_ID TRADE_NAME FROM MM_PARAMETER A, ST_ITEM B WHERE  B.TRADE_ID_APPLICABLE_YN='N' AND B.ITEM_CODE=? AND MODULE_ID ='MM'");
		dataMap.put("SQL_OR_ST_COUNT_CHECK", "SELECT ORDER_CATALOG_CODE FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=?");

		dataMap.put("SQL_ST_REQUEST_FROM_STORE_SELECT_FROMST_STORE1","SELECT DISTINCT stp.parent_store_code, mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm, st_acc_entity_param WHERE mm.store_code = stp.parent_store_code AND  mm.eff_status = 'E' AND mm.facility_id LIKE DECODE (trn_across_facility_yn, 'Y', '%', ?) AND mm.language_id = ? AND stp.store_code = ? ORDER BY 2, 1");
		dataMap.put("SQL_ST_DEF_DOC_GEN_YN_SELECT","SELECT DOC_NUM_GEN_FLAG FROM SY_ACC_ENTITY_DOC_TYPE WHERE DOC_TYPE_CODE = ?");
		dataMap.put("SQL_ST_PARENT_STORE_DESC_SELECT","SELECT ST.STORE_CODE,MM.SHORT_DESC FROM ST_STORE ST, MM_STORE_LANG_VW MM WHERE ST.STORE_CODE != ? AND ST.STORE_CODE = MM.STORE_CODE AND MM.EFF_STATUS = 'E' AND MM.LANGUAGE_ID = ? ORDER BY MM.SHORT_DESC");
		dataMap.put("SQL_ST_STORE_PARENT_STORE_SELECT","SELECT STORE_CODE,PARENT_STORE_CODE FROM ST_STORE_PARENT_STORE WHERE STORE_CODE=?");
		dataMap.put("SQL_ST_STORE_PARENT_STORE_ITEM_CLASS_SELECT","SELECT ITEM_CLASS_CODE FROM ST_STORE_PARENT_STORE WHERE STORE_CODE=? AND PARENT_STORE_CODE = ?");
		
        //commented by Rabbani INC NO:34758(RUT-CRF-0082) on 07/FEB/2013
		//dataMap.put("SQL_ST_TRN_TYPE_FOR_REMARKS_INSERT","INSERT INTO ST_TRN_TYPE_FOR_REMARKS (TRN_TYPE,TRN_REMARKS_CODE,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		
		//Added by Rabbani INC NO:34758(RUT-CRF-0082) on 07/FEB/2013
		dataMap.put("SQL_ST_TRN_TYPE_FOR_REMARKS_INSERT","INSERT INTO ST_TRN_TYPE_FOR_REMARKS (TRN_TYPE,TRN_REMARKS_CODE,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,HDR_REMARKS_REQD) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_ST_TRN_TYPE_FOR_REMARKS_INSERT_2","INSERT INTO ST_TRN_TYPE_FOR_REMARKS (TRN_TYPE,TRN_REMARKS_CODE,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,HDR_REMARKS_REQD,REJECT_STATUS) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");//MO-CRF-20174
 
		dataMap.put("SQL_ST_TRN_TYPE_FOR_REMARKS_UPDATE","UPDATE ST_TRN_TYPE_FOR_REMARKS SET EFF_STATUS=?, ADDED_BY_ID=?,ADDED_DATE=SYSDATE,ADDED_AT_WS_NO=?,ADDED_FACILITY_ID=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID =? WHERE TRN_TYPE=? AND TRN_REMARKS_CODE=?");
		dataMap.put("SQL_ST_TRN_TYPE_FOR_REMARKS_UPDATE_2","UPDATE ST_TRN_TYPE_FOR_REMARKS SET EFF_STATUS=?, ADDED_BY_ID=?,ADDED_DATE=SYSDATE,ADDED_AT_WS_NO=?,ADDED_FACILITY_ID=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID =? , REJECT_STATUS=? WHERE TRN_TYPE=? AND TRN_REMARKS_CODE=?");//MO-CRF-20174  

		dataMap.put("SQL_ST_TRN_TYPE_FOR_REMARKS_EFFSTATUS_YN","SELECT EFF_STATUS FROM ST_TRN_TYPE_FOR_REMARKS WHERE TRN_REMARKS_CODE=? AND TRN_TYPE=?");

		dataMap.put("SQL_MM_TRN_REMARKS_LANG_COUNT","SELECT COUNT(*) TOTAL FROM MM_TRN_REMARKS_LANG WHERE LANGUAGE_ID=?");

		dataMap.put("SQL_MM_TRN_REMARKS_LANG_SELECT","SELECT TRN_REMARKS_CODE,REMARKS_DESC FROM MM_TRN_REMARKS_LANG_VW WHERE MODULE_ID=?  AND LANGUAGE_ID =?");

		//dataMap.put("SQL_MM_TRN_REMARKS_LANG_SELECT_REMARKS_DESC","SELECT REMARKS_DESC FROM MM_TRN_REMARKS_LANG WHERE  TRN_REMARKS_CODE=?  AND LANGUAGE_ID =?");
		
		dataMap.put("SQL_ST_TRN_TYPE_FOR_REMARKS_SELECT","SELECT TRN_TYPE, TRN_REMARKS_CODE, EFF_STATUS , REJECT_STATUS FROM ST_TRN_TYPE_FOR_REMARKS WHERE TRN_TYPE=?");//MO-CRF-20174

		dataMap.put("SQL_ST_TRN_REMARKS_LOOKUP_SELECT","SELECT DISTINCT mm.trn_remarks_code  code,mm.remarks_desc  description FROM  mm_trn_remarks_lang_vw  mm, ST_TRN_TYPE_FOR_REMARKS st WHERE  st.eff_status = 'E'   AND  st.trn_remarks_code = mm.trn_remarks_code AND   UPPER(mm.language_id) LIKE  UPPER(?) AND UPPER(mm.module_id) LIKE  UPPER(?)   AND  UPPER(st.trn_type)  LIKE  UPPER(?)     AND  mm.trn_remarks_code LIKE   UPPER(?)     AND  UPPER(mm.remarks_desc) LIKE  UPPER(?)");

		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SELECT_SINGLE1","SELECT USER_ID,STORE_CODE,OBS_ALLOWED_YN,GRN_ALLOWED_YN,GRN_FINALIZE_ALLOWED_YN, RTV_ALLOWED_YN, RTV_FINALIZE_ALLOWED_YN,MFG_ALLOWED_YN,REQ_ALLOWED_YN,REQ_AUTHORIZE_ALLOWED_YN,ISS_ALLOWED_YN,URG_ALLOWED_YN,URG_FINALIZE_ALLOWED_YN,RET_ALLOWED_YN,RET_FINALIZE_ALLOWED_YN,TFR_ALLOWED_YN,TFR_FINALIZE_ALLOWED_YN,ADJ_ALLOWED_YN,ADJ_FINALIZE_ALLOWED_YN,VAR_ALLOWED_YN,PRT_ALLOWED_YN,SAL_ALLOWED_YN,SAL_AUTHORIZE_ALLOWED_YN,SRT_ALLOWED_YN,SRT_FINALIZE_ALLOWED_YN,SPLIT_BATCH_ALLOWED_YN,BIN_CHANGE_ALLOWED_YN,ISS_FINALIZE_ALLOWED_YN,MFG_FINALIZE_ALLOWED_YN,AUTHORIZE_SPECIAL_REQ_YN,STK_ITEM_CON_ALLOWED_YN,PROCESS_EXPIRED_ITEMS_YN,PROCESS_SUSPENDED_ITEMS_YN,ISS_ACKNOWLEDGE_YN, ISS_CONFIRM_YN, URG_ACKNOWLEDGE_YN, URG_CONFIRM_YN, RET_ACKNOWLEDGE_YN, RET_CONFIRM_YN, TFR_ACKNOWLEDGE_YN, TFR_CONFIRM_YN,CANCL_ALLOWED_YN,PRQ_ALLOWED_YN,PRQ_FINALIZE_ALLOWED_YN  FROM	ST_USER_ACCESS_FOR_STORE WHERE USER_ID = ? AND STORE_CODE =?");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_UPDATE","UPDATE st_item_store_bin_locn SET  EFF_STATUS=? ,modified_by_id=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,modified_facility_id=? WHERE bin_location_code=? and item_code=? AND store_code=?");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_STOCK_STATUS","SELECT STORE_CODE, ITEM_CODE, BIN_LOCATION_CODE ,SUM(QTY_ON_HAND) QTY FROM ST_ITEM_BATCH WHERE ITEM_CODE = ?  AND STORE_CODE = ? AND BIN_LOCATION_CODE = ? GROUP BY STORE_CODE, ITEM_CODE ,BIN_LOCATION_CODE");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_EFF_STATUS","SELECT EFF_STATUS FROM ST_ITEM_STORE_BIN_LOCN WHERE ITEM_CODE = ? AND STORE_CODE = ? and BIN_LOCATION_CODE=?");

		dataMap.put("SQL_ST_ITEM_STORE_BIN_LOCN_COUNT1","SELECT COUNT(*) TOTAL FROM mm_bin_location_lang_vw WHERE STORE_CODE=? AND LANGUAGE_ID=? AND eff_status ='E'");

		dataMap.put("SQL_ST_REQUEST_DTL_SELECT1", "SELECT st.short_desc, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, rbys.short_desc req_by_store_desc, rons.short_desc req_on_store_desc, dtl.pending_item_qty, dtl.req_item_qty, dtl.committed_item_qty,       hdr.req_raised_by_id, DECODE (hdr.request_status,'E', 'Request Entered', 'W', 'Authorized at Req by Store','A', 'Authorized at Issue Store','P', 'Partially Issued' ) request_status, itm.short_desc item_class_desc, am.SHORT_DESC req_uom_desc FROM st_request_hdr hdr,  st_request_dtl dtl,mm_store_lang_vw rbys,mm_store_lang_vw rons,mm_item_class_lang_vw itm, mm_item_lang_vw st, am_uom_lang_vw am  WHERE hdr.doc_no = dtl.doc_no AND dtl.doc_no = ?  AND st.item_code = dtl.item_code AND hdr.facility_id = dtl.facility_id  AND hdr.doc_type_code = dtl.doc_type_code  AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code  AND hdr.item_class_code = itm.item_class_code(+)   AND hdr.request_status IN ('E', 'W', 'A', 'P') AND dtl.facility_id = ? AND st.language_id = rbys.language_id AND st.language_id = rons.language_id AND  st.language_id = ? AND itm.language_id(+) = ? AND am.uom_code = request_uom AND am.language_id =? ");

//Queries Added By Mahesh on 6/12/2008 for Acknowledgement
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TRN_HDR_INSERT", "INSERT INTO ST_ACKNOWLEDGE_TRN_HDR(FACILITY_ID, DOC_TYPE_CODE, DOC_NO,DOC_DATE, TRN_TYPE, ISSUING_STORE, RECEIVING_STORE, ACKNOWLEDGE_YN, ACKNOWLEDGE_DATE, ADJUST_DOC_TYPE_CODE, ADJUST_DOC_NO, CONFIRM_YN, CONFIRM_DATE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SEQ_NO) VALUES(?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,SYSDATE,?,?,?,NVL(TO_DATE(?,'DD/MM/YYYY'),''),?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TRN_DTL_INSERT", "INSERT INTO ST_ACKNOWLEDGE_TRN_DTL(FACILITY_ID, DOC_TYPE_CODE, DOC_NO, DOC_SRL_NO, DOC_DATE, BATCH_ID, EXPIRY_DATE_OR_RECEIPT_DATE, TRADE_ID, ITEM_CODE, ISSUE_QTY, ISS_RCVD_UOM, RECEIVED_QTY, NEW_BIN_LOCATION_CODE, REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TRN_HDR_UPDATE", "UPDATE ST_ACKNOWLEDGE_TRN_HDR SET ADJUST_DOC_TYPE_CODE=?, ADJUST_DOC_NO=?,CONFIRM_YN = ?, CONFIRM_DATE = NVL(TO_DATE(?,'DD/MM/YYYY'),'') ,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE DOC_NO = ? AND DOC_TYPE_CODE=? AND SEQ_NO = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TRN_DTL_UPDATE", "UPDATE ST_ACKNOWLEDGE_TRN_DTL SET RECEIVED_QTY = ?, REMARKS = ?, NEW_BIN_LOCATION_CODE = ?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE DOC_NO = ? AND DOC_TYPE_CODE=? AND DOC_SRL_NO = ? AND BATCH_ID =? AND TO_CHAR(EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY')=? AND TRADE_ID =? AND SEQ_NO = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TRN_HDR_UPDATE_1", "UPDATE ST_ACKNOWLEDGE_TRN_HDR SET ADJUST_DOC_TYPE_CODE=?, ADJUST_DOC_NO=?,ACKNOWLEDGE_YN = ?, ACKNOWLEDGE_DATE = SYSDATE, CONFIRM_YN = ?, CONFIRM_DATE = NVL(TO_DATE(?,'DD/MM/YYYY'),'') ,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE DOC_NO = ? AND DOC_TYPE_CODE=? AND SEQ_NO = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_DOC_TYPE_LIST_SELECT", "SELECT  DOC.TRN_TYPE TRN_TYPE,SHORT_DESC FROM ST_TRN_DOC_TYPE DOC,ST_TRN_TYPE TRN WHERE DOC.TRN_TYPE IN('URG','ISS','TFR','RET') AND DOC.TRN_TYPE = TRN.TRN_TYPE AND FACILITY_ID = ? ORDER BY DECODE(DOC.TRN_TYPE,'ISS',1,'URG',2,'RET', 3, 'TFR', 4)");
		
		
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_STORE_LIST_ACK_SELECT", "SELECT   ST.STORE_CODE, MM.SHORT_DESC FROM MM_STORE_LANG_VW MM, ST_USER_ACCESS_FOR_STORE ST WHERE MM.STORE_CODE = ST.STORE_CODE AND MM.EFF_STATUS = 'E' AND MM.FACILITY_ID = ? AND ST.USER_ID = ? AND MM.LANGUAGE_ID = ? AND DECODE(?, 'URG', URG_ACKNOWLEDGE_YN, 'ISS',ISS_ACKNOWLEDGE_YN,'TFR', TFR_ACKNOWLEDGE_YN, 'RET',RET_ACKNOWLEDGE_YN,'N') = 'Y' ORDER BY 2");
		//Added by Rabbani #Bru-HIMS-CRF-112(INC no:30071) on 13-AUG-2013 Starts
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_STORE_LIST_ACK_SELECT", "SELECT   ST.STORE_CODE, MM.SHORT_DESC FROM MM_STORE_LANG_VW MM, ST_USER_ACCESS_FOR_STORE ST,ST_STORE SM WHERE MM.STORE_CODE = ST.STORE_CODE AND MM.STORE_CODE = SM.STORE_CODE AND MM.EFF_STATUS = 'E' AND MM.FACILITY_ID = ? AND ST.USER_ID = ? AND MM.LANGUAGE_ID = ? AND (DECODE(?, 'URG', URG_ACKNOWLEDGE_YN, 'ISS',ISS_ACKNOWLEDGE_YN,'TFR', TFR_ACKNOWLEDGE_YN, 'RET',RET_ACKNOWLEDGE_YN,'N') = 'Y' AND DECODE(?, 'URG', URG_ACK_REQ_YN, 'ISS',ISS_ACK_REQ_YN,'TFR', TFR_ACK_REQ_YN, 'RET',RET_ACK_REQ_YN,'N') = 'Y') ORDER BY 2");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_STORE_LIST_CFM_SELECT", "SELECT   ST.STORE_CODE, MM.SHORT_DESC FROM MM_STORE_LANG_VW MM, ST_USER_ACCESS_FOR_STORE ST WHERE MM.STORE_CODE = ST.STORE_CODE AND MM.EFF_STATUS = 'E' AND MM.FACILITY_ID = ? AND ST.USER_ID = ? AND MM.LANGUAGE_ID = ? AND DECODE(?, 'URG', URG_CONFIRM_YN, 'ISS',ISS_CONFIRM_YN,'TFR', TFR_CONFIRM_YN, 'RET',RET_CONFIRM_YN,'N') = 'Y' ORDER BY 2");
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TFR_DTL_SELECT", "SELECT   DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'dd/mm/yyyy') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC FROM     ST_TRANSFER_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C WHERE    FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ?*/ AND (A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO) NOT IN (SELECT FACILITY_ID, DOC_TYPE_CODE, DOC_NO FROM ST_ACKNOWLEDGE_TRN_HDR WHERE ACKNOWLEDGE_YN = 'Y') AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'dd/mm/yyyy'),TO_DATE ('01/01/1800', 'dd/mm/yyyy')) AND NVL (TO_DATE (?, 'dd/mm/yyyy'), SYSDATE) AND A.DOC_NO LIKE NVL(?,'%') AND A.DOC_TYPE_CODE = ? AND A.TO_STORE_CODE = ? AND A.FACILITY_ID = ? AND B.LANGUAGE_ID = ? AND FM_STORE_CODE = B.STORE_CODE AND TO_STORE_CODE = C.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID ORDER BY DOC_NO");
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_URG_DTL_SELECT", "SELECT   DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'DD/MM/YYYY') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC FROM     ST_ISSUE_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C WHERE    FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ? */AND (A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO) NOT IN (SELECT FACILITY_ID, DOC_TYPE_CODE, DOC_NO FROM ST_ACKNOWLEDGE_TRN_HDR WHERE ACKNOWLEDGE_YN = 'Y') AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'DD/MM/YYYY'),TO_DATE ('01/01/1800', 'DD/MM/YYYY')) AND NVL (TO_DATE (?, 'DD/MM/YYYY'), SYSDATE) AND A.DOC_NO LIKE NVL(?,'%') AND A.DOC_TYPE_CODE = ? AND A.TO_STORE_CODE = ? AND A.FACILITY_ID = ? AND B.LANGUAGE_ID = ? AND FM_STORE_CODE = B.STORE_CODE AND TO_STORE_CODE = C.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID ORDER BY DOC_NO");
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_ISS_DTL_SELECT", "SELECT   DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'DD/MM/YYYY') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC FROM ST_ISSUE_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C WHERE FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ?*/ AND (A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO) NOT IN (SELECT FACILITY_ID, DOC_TYPE_CODE, DOC_NO FROM ST_ACKNOWLEDGE_TRN_HDR WHERE ACKNOWLEDGE_YN = 'Y') AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'DD/MM/YYYY'),TO_DATE ('01/01/1800', 'DD/MM/YYYY')) AND NVL (TO_DATE (?, 'DD/MM/YYYY'), SYSDATE) AND A.DOC_NO LIKE NVL(?,'%') AND A.DOC_TYPE_CODE = ? AND A.TO_STORE_CODE = ? AND A.FACILITY_ID = ? AND B.LANGUAGE_ID = ? AND FM_STORE_CODE = B.STORE_CODE AND TO_STORE_CODE = C.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID ORDER BY DOC_NO");
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_RET_DTL_SELECT", "SELECT   DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'dd/mm/yyyy') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC FROM ST_ISSUE_RET_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C WHERE FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ?*/ AND (A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO) NOT IN (SELECT FACILITY_ID, DOC_TYPE_CODE, DOC_NO FROM ST_ACKNOWLEDGE_TRN_HDR WHERE ACKNOWLEDGE_YN = 'Y') AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'dd/mm/yyyy'),TO_DATE ('01/01/1800', 'dd/mm/yyyy')) AND NVL (TO_DATE (?, 'dd/mm/yyyy'), SYSDATE) AND A.DOC_NO LIKE NVL(?,'%') AND A.DOC_TYPE_CODE = ? AND A.TO_STORE_CODE = ? AND A.FACILITY_ID = ? AND B.LANGUAGE_ID = ? AND FM_STORE_CODE = B.STORE_CODE AND TO_STORE_CODE = C.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID ORDER BY DOC_NO");
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_CFM_DTL_SELECT", "SELECT   DOC_NO, DOC_TYPE_CODE,TO_CHAR (DOC_DATE, 'DD/MM/YYYY') DOC_DATE,ISSUING_STORE FM_STORE_CODE, RECEIVING_STORE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC,CONFIRM_YN FROM ST_ACKNOWLEDGE_TRN_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C WHERE A.ACKNOWLEDGE_YN = 'Y' AND CONFIRM_YN = 'N' /*AND TRN_TYPE = ?*/ AND	   DOC_DATE BETWEEN NVL (TO_DATE (?, 'DD/MM/YYYY'),TO_DATE ('01/01/1800', 'DD/MM/YYYY')) AND NVL (TO_DATE (?, 'DD/MM/YYYY'), SYSDATE) AND A.DOC_NO LIKE NVL(?,'%') AND A.DOC_TYPE_CODE = ? AND A.ISSUING_STORE = ? AND  A.FACILITY_ID = ? AND B.LANGUAGE_ID = ? AND ISSUING_STORE = B.STORE_CODE AND RECEIVING_STORE = C.STORE_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID ORDER BY DOC_NO");
		//Modified by suresh.r on 16-09-2014 against Perf tuning Inc 51157
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TFR_DTL_SELECT", "SELECT   1 SEQ_NO,DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'dd/mm/yyyy') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC,A.FACILITY_ID FACILITY_ID FROM     ST_TRANSFER_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C, ST_ACC_ENTITY_PARAM PA WHERE    FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ?*/ AND (A.DOC_TYPE_CODE, A.DOC_NO) NOT IN (SELECT   DOC_TYPE_CODE, DOC_NO FROM ST_ACKNOWLEDGE_TRN_DTL WHERE 'A' = 'A' HAVING (  SUM (ISSUE_QTY) - (SUM (NVL(REJECTED_QTY,0)) + SUM (NVL(RECEIVED_QTY,0))+SUM (NVL(TMP_REJECTED_QTY_2,0)) + SUM (NVL(TMP_RECEIVED_QTY_2,0)))) = 0 GROUP BY DOC_TYPE_CODE, DOC_NO) AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'dd/mm/yyyy'),TO_DATE ('01/01/1800', 'dd/mm/yyyy')) AND NVL (TO_DATE (?, 'dd/mm/yyyy'), SYSDATE) ");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_URG_DTL_SELECT", "SELECT   SEQ_NO,DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'DD/MM/YYYY') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC,A.FACILITY_ID FACILITY_ID FROM     ST_ISSUE_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C, ST_ACC_ENTITY_PARAM PA WHERE    FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ? */AND (A.DOC_TYPE_CODE, A.DOC_NO) NOT IN (SELECT   DOC_TYPE_CODE, DOC_NO FROM ST_ACKNOWLEDGE_TRN_DTL WHERE 'A' = 'A' HAVING (  SUM (ISSUE_QTY) - (SUM (NVL(REJECTED_QTY,0)) + SUM (NVL(RECEIVED_QTY,0))+SUM (NVL(TMP_REJECTED_QTY_2,0)) + SUM (NVL(TMP_RECEIVED_QTY_2,0)))) = 0 GROUP BY DOC_TYPE_CODE, DOC_NO) AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'DD/MM/YYYY'),TO_DATE ('01/01/1800', 'DD/MM/YYYY')) AND NVL (TO_DATE (?, 'DD/MM/YYYY'), SYSDATE) ");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_ISS_DTL_SELECT", "SELECT   SEQ_NO,DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'DD/MM/YYYY') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC ,A.FACILITY_ID FACILITY_ID FROM ST_ISSUE_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C, ST_ACC_ENTITY_PARAM PA WHERE FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ?*/ AND (A.DOC_TYPE_CODE, A.DOC_NO,A.SEQ_NO) NOT IN (SELECT   DOC_TYPE_CODE, DOC_NO,SEQ_NO FROM ST_ACKNOWLEDGE_TRN_DTL WHERE 'A' = 'A' HAVING (  SUM (ISSUE_QTY) - (SUM (NVL(REJECTED_QTY,0)) + SUM (NVL(RECEIVED_QTY,0))+SUM (NVL(TMP_REJECTED_QTY_2,0)) + SUM (NVL(TMP_RECEIVED_QTY_2,0)))) = 0 GROUP BY DOC_TYPE_CODE, DOC_NO, SEQ_NO) AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'DD/MM/YYYY'),TO_DATE ('01/01/1800', 'DD/MM/YYYY')) AND NVL (TO_DATE (?, 'DD/MM/YYYY'), SYSDATE) ");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_RET_DTL_SELECT", "SELECT   1 SEQ_NO,DOC_NO, DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'dd/mm/yyyy') DOC_DATE,FM_STORE_CODE, TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC, C.SHORT_DESC TO_STORE_DESC,A.FACILITY_ID FACILITY_ID FROM ST_ISSUE_RET_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C, ST_ACC_ENTITY_PARAM PA WHERE FINALIZED_YN = 'N' AND PROCESS_FOR_ACKNOWLEDGE = 'Y' /*AND TRN_TYPE = ?*/ AND (A.DOC_TYPE_CODE, A.DOC_NO) NOT IN (SELECT   DOC_TYPE_CODE, DOC_NO FROM ST_ACKNOWLEDGE_TRN_DTL WHERE 'A' = 'A' HAVING (  SUM (ISSUE_QTY) - (SUM (NVL(REJECTED_QTY,0)) + SUM (NVL(RECEIVED_QTY,0))+SUM (NVL(TMP_REJECTED_QTY_2,0)) + SUM (NVL(TMP_RECEIVED_QTY_2,0)))) = 0 GROUP BY DOC_TYPE_CODE, DOC_NO) AND DOC_DATE BETWEEN NVL (TO_DATE (?, 'dd/mm/yyyy'),TO_DATE ('01/01/1800', 'dd/mm/yyyy')) AND NVL (TO_DATE (?, 'dd/mm/yyyy'), SYSDATE)");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_CFM_DTL_SELECT", "SELECT   A.SEQ_NO, A.DOC_NO, A.DOC_TYPE_CODE,TO_CHAR (A.DOC_DATE, 'DD/MM/YYYY') DOC_DATE,ISSUING_STORE FM_STORE_CODE, RECEIVING_STORE,RECEIVING_STORE TO_STORE_CODE, B.SHORT_DESC FM_STORE_DESC,C.SHORT_DESC TO_STORE_DESC, CONFIRM_YN FROM ST_ACKNOWLEDGE_TRN_HDR A, MM_STORE_LANG_VW B, MM_STORE_LANG_VW C,ST_ACKNOWLEDGE_TRN_DTL D WHERE A.DOC_DATE BETWEEN NVL (TO_DATE (?, 'DD/MM/YYYY'),TO_DATE ('01/01/1800', 'DD/MM/YYYY')) AND NVL (TO_DATE (?, 'DD/MM/YYYY'), SYSDATE)");
		
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TFR_EXP_SELECT", "SELECT TO_CHAR(HDR.DOC_DATE,'DD/MM/YYYY') DOC_DATE,HDR.FM_STORE_CODE STORE_CODE,EXP.DOC_NO,EXP.DOC_TYPE_CODE,EXP.DOC_SRL_NO,EXP.ITEM_CODE, MM.SHORT_DESC ITEM_DESC,EXP.BATCH_ID, TO_CHAR (EXP.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE, EXP.TRADE_ID, MM.SHORT_DESC ITEM_DESC, ITEM_QTY QTY,STSTR.DEF_ISSUE_UOM UOM_CODE, AM.SHORT_DESC UOM,ACK.RECEIVED_QTY, (ITEM_QTY-ACK.RECEIVED_QTY) REJECTED_QTY,ITEM_QTY ISSUE_QTY,ROUND ((DECODE (STSTR.QTY_ON_HAND, 0, 0, STSTR.ITEM_VALUE)/ DECODE (STSTR.QTY_ON_HAND,0, 1,STSTR.QTY_ON_HAND)),3) ITEM_UNIT_COST,ACK.REMARKS,EXP.BIN_LOCATION_CODE,EXP.TO_BIN_LOCATION_CODE,EXP.TO_BIN_LOCATION_CODE NEW_BIN_LOCATION_CODE,STSTR1.DEF_ISSUE_UOM TO_UOM_CODE FROM ST_TRANSFER_HDR HDR,ST_TRANSFER_DTL_EXP EXP,AM_TRADE_NAME_LANG_VW TRD,MM_ITEM_LANG_VW MM,AM_UOM_LANG_VW AM,ST_ACKNOWLEDGE_TRN_DTL ACK,ST_ITEM_STORE STSTR,ST_ITEM_STORE STSTR1 WHERE 	HDR.FACILITY_ID = EXP.FACILITY_ID AND HDR.DOC_TYPE_CODE = EXP.DOC_TYPE_CODE AND HDR.DOC_NO = EXP.DOC_NO AND HDR.DOC_NO = ? AND HDR.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = ? AND TRD.TRADE_ID(+) = EXP.TRADE_ID AND TRD.LANGUAGE_ID(+) = ? AND MM.ITEM_CODE = EXP.ITEM_CODE AND MM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = MM.LANGUAGE_ID AND AM.UOM_CODE = MM.GEN_UOM_CODE AND EXP.FACILITY_ID = ACK.FACILITY_ID(+) AND EXP.DOC_TYPE_CODE = ACK.DOC_TYPE_CODE(+) AND EXP.DOC_NO = ACK.DOC_NO(+) AND EXP.DOC_SRL_NO = ACK.DOC_SRL_NO(+) AND EXP.ITEM_CODE = ACK.ITEM_CODE(+) AND EXP.BATCH_ID = ACK.BATCH_ID(+) AND 	TRUNC (EXP.EXPIRY_DATE_OR_RECEIPT_DATE) = TRUNC (ACK.EXPIRY_DATE_OR_RECEIPT_DATE(+)) AND 		STSTR.STORE_CODE = EXP.STORE_CODE AND STSTR.ITEM_CODE = EXP.ITEM_CODE  AND STSTR1.STORE_CODE = HDR.TO_STORE_CODE AND STSTR1.ITEM_CODE = EXP.ITEM_CODE ORDER BY EXP.DOC_SRL_NO");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_URG_ISS_EXP_SELECT", "SELECT   TO_CHAR (HDR.DOC_DATE, 'DD/MM/YYYY') DOC_DATE,HDR.FM_STORE_CODE STORE_CODE, EXP.DOC_NO, EXP.DOC_TYPE_CODE,EXP.DOC_SRL_NO, EXP.ITEM_CODE, MM.SHORT_DESC ITEM_DESC, EXP.BATCH_ID,TO_CHAR (EXP.EXPIRY_DATE_OR_RECEIPT_DATE, 'DD/MM/YYYY') EXPIRY_DATE,EXP.TRADE_ID, MM.SHORT_DESC ITEM_DESC, ISS_ITEM_QTY QTY,RET_ITEM_QTY,STSTR.DEF_ISSUE_UOM UOM_CODE, AM.SHORT_DESC UOM, ACK.RECEIVED_QTY,(ISS_ITEM_QTY - ACK.RECEIVED_QTY) REJECTED_QTY,ISS_ITEM_QTY ISSUE_QTY,ROUND ((  DECODE (STSTR.QTY_ON_HAND, 0, 0, STSTR.ITEM_VALUE)/ DECODE (STSTR.QTY_ON_HAND, 0, 1, STSTR.QTY_ON_HAND)),3) ITEM_UNIT_COST,ACK.REMARKS, EXP.BIN_LOCATION_CODE, EXP.TO_BIN_LOCATION_CODE NEW_BIN_LOCATION_CODE,EXP.TO_BIN_LOCATION_CODE,HDR.SEQ_NO,STSTR1.DEF_ISSUE_UOM TO_UOM_CODE FROM ST_ISSUE_HDR HDR,ST_ISSUE_DTL_EXP EXP,AM_TRADE_NAME_LANG_VW TRD,MM_ITEM_LANG_VW MM,AM_UOM_LANG_VW AM,ST_ACKNOWLEDGE_TRN_DTL ACK,ST_ITEM_STORE STSTR,ST_ITEM_STORE STSTR1 WHERE HDR.FACILITY_ID = EXP.FACILITY_ID AND HDR.DOC_TYPE_CODE = EXP.DOC_TYPE_CODE AND HDR.DOC_NO = EXP.DOC_NO AND HDR.DOC_NO = ? AND HDR.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = ? AND TRD.TRADE_ID(+) = EXP.TRADE_ID AND TRD.LANGUAGE_ID(+) = ? AND MM.ITEM_CODE = EXP.ITEM_CODE AND MM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = MM.LANGUAGE_ID AND AM.UOM_CODE = MM.GEN_UOM_CODE AND EXP.FACILITY_ID = ACK.FACILITY_ID(+) AND EXP.DOC_TYPE_CODE = ACK.DOC_TYPE_CODE(+) AND EXP.DOC_NO = ACK.DOC_NO(+) AND EXP.DOC_SRL_NO = ACK.DOC_SRL_NO(+) AND EXP.ITEM_CODE = ACK.ITEM_CODE(+) AND EXP.BATCH_ID = ACK.BATCH_ID(+) AND TRUNC(EXP.EXPIRY_DATE_OR_RECEIPT_DATE) = TRUNC (ACK.EXPIRY_DATE_OR_RECEIPT_DATE(+)) AND STSTR.STORE_CODE = EXP.STORE_CODE AND STSTR.ITEM_CODE = EXP.ITEM_CODE AND STSTR1.ITEM_CODE = EXP.ITEM_CODE AND STSTR1.STORE_CODE = HDR.TO_STORE_CODE ORDER BY EXP.DOC_SRL_NO");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_RET_EXP_SELECT", "SELECT A.DOC_NO RET_DOC_NO,K.FM_STORE_CODE TO_STORE_CODE, K.TO_STORE_CODE STORE_CODE, A.ITEM_CODE,F.SHORT_DESC ITEM_DESC, A.BATCH_ID,A.BIN_LOCATION_CODE ISSUE_TO_BIN_LOCATION_CODE,(CASE WHEN A.BIN_LOCATION_CODE IS NULL THEN NULL ELSE (SELECT SHORT_DESC FROM MM_BIN_LOCATION_LANG_VW WHERE BIN_LOCATION_CODE = A.BIN_LOCATION_CODE AND STORE_CODE = A.STORE_CODE AND LANGUAGE_ID = F.LANGUAGE_ID) END) TO_BIN_DESC,A.TO_BIN_LOCATION_CODE ISSUE_FM_BIN_LOCATION_CODE,A.TO_BIN_LOCATION_CODE NEW_BIN_LOCATION_CODE, E.SHORT_DESC BIN_DESC,TO_CHAR (A.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_RECEIPT_DT,TO_CHAR (A.EXPIRY_DATE_OR_RECEIPT_DATE, 'DD/MM/YYYY') EXPIRY_DATE,A.TRADE_ID, NVL (LONG_NAME, A.TRADE_ID) TRADE_NAME, C.ISS_ITEM_QTY,NVL (C.RET_ITEM_QTY, 0) RET_ITEM_QTY, A.ITEM_QTY QTY,(C.ISS_ITEM_QTY - C.RET_ITEM_QTY) + A.ITEM_QTY AVAIL_QTY,A.ORG_DOC_TYPE_CODE DOC_TYPE_CODE, A.ORG_DOC_NO DOC_NO,A.ORG_SEQ_NO SEQ_NO, I.ITEM_UNIT_COST, C.DOC_SRL_NO,TO_CHAR (K.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, ACK.RECEIVED_QTY,(A.ITEM_QTY - ACK.RECEIVED_QTY) REJECTED_QTY, A.ITEM_QTY ISSUE_QTY,L.DEF_ISSUE_UOM UOM_CODE,M.DEF_ISSUE_UOM TO_UOM_CODE,ACK.REMARKS, AM.SHORT_DESC UOM FROM ST_ISSUE_RET_DTL_EXP A,ST_ISSUE_DTL_EXP C,ST_ISSUE_RET_HDR D,MM_BIN_LOCATION_LANG_VW E,MM_ITEM_LANG_VW F,AM_TRADE_NAME_LANG_VW H,ST_ISSUE_RET_DTL I,ST_ISSUE_HDR K,ST_ACKNOWLEDGE_TRN_DTL ACK,AM_UOM_LANG_VW AM,ST_ITEM_STORE L,ST_ITEM_STORE M WHERE A.ITEM_CODE = F.ITEM_CODE AND A.TRADE_ID = H.TRADE_ID(+) AND A.FACILITY_ID = C.FACILITY_ID AND A.ORG_DOC_TYPE_CODE = C.DOC_TYPE_CODE AND A.ORG_DOC_NO = C.DOC_NO AND A.ORG_SEQ_NO = C.SEQ_NO AND A.ITEM_CODE = C.ITEM_CODE AND A.BATCH_ID = C.BATCH_ID AND A.EXPIRY_DATE_OR_RECEIPT_DATE = C.EXPIRY_DATE_OR_RECEIPT_DATE AND A.FACILITY_ID = D.FACILITY_ID AND A.DOC_TYPE_CODE = D.DOC_TYPE_CODE AND A.DOC_NO = D.DOC_NO AND D.TO_STORE_CODE = E.STORE_CODE AND A.TO_BIN_LOCATION_CODE = E.BIN_LOCATION_CODE AND /* (C.ISS_ITEM_QTY-C.RET_ITEM_QTY) > 0 AND */ A.FACILITY_ID = I.FACILITY_ID AND A.DOC_TYPE_CODE = I.DOC_TYPE_CODE AND A.DOC_NO = I.DOC_NO AND A.ITEM_CODE = I.ITEM_CODE AND A.DOC_NO = ? AND A.DOC_TYPE_CODE = ? AND A.FACILITY_ID = ? AND (C.FACILITY_ID = K.FACILITY_ID AND C.DOC_TYPE_CODE = K.DOC_TYPE_CODE AND C.DOC_NO = K.DOC_NO AND C.SEQ_NO = K.SEQ_NO ) AND E.LANGUAGE_ID = ? AND F.LANGUAGE_ID = ? AND H.LANGUAGE_ID(+) = ? AND A.ITEM_CODE = ACK.ITEM_CODE(+) AND A.TRADE_ID = ACK.TRADE_ID(+) AND A.BATCH_ID = ACK.BATCH_ID(+) AND A.DOC_NO = ACK.DOC_NO(+) AND A.DOC_TYPE_CODE = ACK.DOC_TYPE_CODE(+) AND A.EXPIRY_DATE_OR_RECEIPT_DATE = ACK.EXPIRY_DATE_OR_RECEIPT_DATE(+) AND AM.UOM_CODE = F.GEN_UOM_CODE AND AM.LANGUAGE_ID = F.LANGUAGE_ID AND A.ITEM_CODE = L.ITEM_CODE AND A.STORE_CODE = L.STORE_CODE AND K.FM_STORE_CODE = M.STORE_CODE AND A.ITEM_CODE = M.ITEM_CODE");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_DOC_TYPE_CODE_SELECT", "SELECT   FACILITY_ID,DOC.DOC_TYPE_CODE, B.SHORT_DESC FROM ST_TRN_DOC_TYPE DOC,SY_DOC_TYPE_MASTER_LANG_VW B WHERE DOC.TRN_TYPE = ? AND DOC.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND FACILITY_ID = ? AND B.LANGUAGE_ID = ? ORDER BY 2,1");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_DOC_TYPE_CODE_SELECT1", "SELECT   FACILITY_ID,DOC.DOC_TYPE_CODE, B.SHORT_DESC FROM ST_TRN_DOC_TYPE DOC,SY_DOC_TYPE_MASTER_LANG_VW B WHERE DOC.TRN_TYPE = ? AND DOC.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND FACILITY_ID = ? AND B.LANGUAGE_ID = ? ORDER BY 2,1");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TRN_TYPE_SELECT", "SELECT   TRN_TYPE, SHORT_DESC FROM ST_TRN_TYPE_LANG_VW TRN WHERE TRN_TYPE IN (?) AND LANGUAGE_ID = ? ORDER BY DECODE (TRN_TYPE, 'ISS', 1, 'URG', 2, 'RET', 3, 'TFR', 4)");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_ORG_TFR_DTL_SELECT", "SELECT DOC_TYPE_CODE, DOC_NO, DOC_SRL_NO, STORE_CODE, ITEM_CODE, STOCK_ITEM_YN, ITEM_QTY, ITEM_UNIT_COST, ITEM_COST_VALUE,FACILITY_ID FROM ST_TRANSFER_DTL, ST_ACC_ENTITY_PARAM PA WHERE /*FACILITY_ID = ?*/((PA.TRN_ACROSS_FACILITY_YN='Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_ORG_URG_ISS_DTL_SELECT", "SELECT SEQ_NO,DOC_TYPE_CODE, DOC_NO, DOC_SRL_NO, STORE_CODE, ITEM_CODE, STOCK_ITEM_YN, ISS_ITEM_QTY ITEM_QTY, ITEM_UNIT_COST, ITEM_COST_VALUE,FACILITY_ID FROM ST_ISSUE_DTL, ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN='Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE = ? AND SEQ_NO=?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_ORG_RET_DTL_SELECT", "SELECT DOC_TYPE_CODE, DOC_NO, DOC_SRL_NO, ITEM_CODE, STOCK_ITEM_YN, RET_ITEM_QTY ITEM_QTY, ITEM_UNIT_COST, ITEM_COST_VALUE,FACILITY_ID FROM ST_ISSUE_RET_DTL, ST_ACC_ENTITY_PARAM PA WHERE /*FACILITY_ID = ?*/((PA.TRN_ACROSS_FACILITY_YN='Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_HDR_COUNT_SELECT", "SELECT COUNT(*) COUNT FROM ST_ACKNOWLEDGE_TRN_HDR,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE=? AND SEQ_NO = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_DTL_COUNT_SELECT", "SELECT COUNT(*) COUNT FROM ST_ACKNOWLEDGE_TRN_DTL,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE=? AND SEQ_NO = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_TFR_HDR_SELECT", "SELECT DOC_TYPE_CODE, DOC_NO, TO_CHAR(DOC_DATE,'DD/MM/YYYY') DOC_DATE, DOC_REF, FM_STORE_CODE, TO_STORE_CODE,FINALIZED_YN, GL_INTERFACED_YN, TRN_TYPE, ENTRY_COMPLETED_YN,ITEM_CLASS_CODE,FACILITY_ID FROM ST_TRANSFER_HDR,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE = ?");
		//commented by Rabbani on 11/07/2012 
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_TFR_DTL_SELECT", "SELECT HDR.TO_STORE_CODE,DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO, STORE_CODE, ITEM_CODE,STOCK_ITEM_YN, ITEM_QTY, ITEM_UNIT_COST, ITEM_COST_VALUE,TO_CHAR (HDR.DOC_DATE, 'DD/MM/YYYY') DOC_DATE FROM ST_TRANSFER_DTL DTL,ST_TRANSFER_HDR HDR,ST_ACC_ENTITY_PARAM PA  WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?)/*DTL.FACILITY_ID = ?*/ AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.FACILITY_ID = DTL.FACILITY_ID");
		//Added by Rabbani on 11/07/2012
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_TFR_DTL_SELECT", "SELECT HDR.TO_STORE_CODE,DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO, STORE_CODE, ITEM_CODE,STOCK_ITEM_YN, ITEM_QTY, TRIM(ST_DISPLAY_COST_DECIMALS (DTL.ITEM_CODE, DTL.STORE_CODE )) ITEM_UNIT_COST, TRIM(ST_DISPLAY_COST_DECIMALS (DTL.ITEM_CODE, DTL.STORE_CODE )) * (ITEM_QTY) ITEM_COST_VALUE,TO_CHAR (HDR.DOC_DATE, 'DD/MM/YYYY') DOC_DATE FROM ST_TRANSFER_DTL DTL,ST_TRANSFER_HDR HDR,ST_ACC_ENTITY_PARAM PA  WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?)/*DTL.FACILITY_ID = ?*/ AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.FACILITY_ID = DTL.FACILITY_ID");
		//Modified by suresh.r on 18-08-2014 against 50616
		//Modified by suresh.r on 13-11-2014 against Inc 52256(Added 2 args to ST_DISPLAY_UNIT_COST)
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_TFR_DTL_SELECT", "SELECT HDR.TO_STORE_CODE,DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO, STORE_CODE, ITEM_CODE,STOCK_ITEM_YN, ITEM_QTY, TRIM(ST_DISPLAY_UNIT_COST (DTL.ITEM_CODE,SYSDATE,'CURRENT_STOCK' )*ST_GET_UOM_CONV_FAC_SING_STR (DTL.ITEM_CODE, DTL.STORE_CODE )) ITEM_UNIT_COST, TRIM(ST_DISPLAY_UNIT_COST (DTL.ITEM_CODE,SYSDATE,'CURRENT_STOCK' )*ST_GET_UOM_CONV_FAC_SING_STR (DTL.ITEM_CODE, DTL.STORE_CODE )) * (ITEM_QTY) ITEM_COST_VALUE,TO_CHAR (HDR.DOC_DATE, 'DD/MM/YYYY') DOC_DATE FROM ST_TRANSFER_DTL DTL,ST_TRANSFER_HDR HDR,ST_ACC_ENTITY_PARAM PA  WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?)/*DTL.FACILITY_ID = ?*/ AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.FACILITY_ID = DTL.FACILITY_ID");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_URG_ISS_HDR_SELECT", "SELECT FACILITY_ID,DOC_TYPE_CODE, DOC_NO, TO_CHAR(DOC_DATE,'DD/MM/YYYY') DOC_DATE, DOC_REF, FINALIZED_YN,CLOSE_REQ_AFTER_ISSUE_YN,REMARKS,SEQ_NO FROM ST_ISSUE_HDR,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE = ? AND SEQ_NO = ?");
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_URG_ISS_DTL_SELECT", "SELECT hdr.facility_id,HDR.TO_STORE_CODE,DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO, STORE_CODE, ITEM_CODE,STOCK_ITEM_YN, ISS_ITEM_QTY ITEM_QTY,RET_ITEM_QTY,ISSUE_UOM_CONV,ISSUE_UOM,ISSUE_UOM_QTY,ITEM_UNIT_COST, ITEM_COST_VALUE,DTL.REMARKS,TO_CHAR (DOC_DATE, 'DD/MM/YYYY') DOC_DATE,HDR.SEQ_NO FROM ST_ISSUE_DTL DTL,ST_ISSUE_HDR HDR,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?)/*DTL.FACILITY_ID = ?*/ AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = DTL.FACILITY_ID AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.SEQ_NO = DTL.SEQ_NO AND HDR.SEQ_NO = ?");
		//this is commented due to calculate cost and value during ack time also
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_URG_ISS_DTL_SELECT", "SELECT hdr.facility_id,HDR.TO_STORE_CODE,DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO, STORE_CODE, ITEM_CODE,STOCK_ITEM_YN, ISS_ITEM_QTY ITEM_QTY,RET_ITEM_QTY,ISSUE_UOM_CONV,ISSUE_UOM,ISSUE_UOM_QTY,TRIM(ST_DISPLAY_COST_DECIMALS (DTL.ITEM_CODE, DTL.STORE_CODE )) ITEM_UNIT_COST, TRIM(ST_DISPLAY_COST_DECIMALS (DTL.ITEM_CODE, DTL.STORE_CODE )) * (DECODE (DTL.iss_item_qty, 0, DTL.authorized_item_qty, DTL.iss_item_qty ))  ITEM_COST_VALUE,DTL.REMARKS,TO_CHAR (DOC_DATE, 'DD/MM/YYYY') DOC_DATE,HDR.SEQ_NO FROM ST_ISSUE_DTL DTL,ST_ISSUE_HDR HDR,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?)/*DTL.FACILITY_ID = ?*/ AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = DTL.FACILITY_ID AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.SEQ_NO = DTL.SEQ_NO AND HDR.SEQ_NO = ?");
		//Modified by suresh.r added st_display_unit_cost for item_unit_cost against inc#50521
		//Modified by suresh.r on 13-11-2014 against Inc 52256(Added 2 args to ST_DISPLAY_UNIT_COST)
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_URG_ISS_DTL_SELECT", "SELECT hdr.facility_id,HDR.TO_STORE_CODE,DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO, STORE_CODE, ITEM_CODE,STOCK_ITEM_YN, ISS_ITEM_QTY ITEM_QTY,RET_ITEM_QTY,ISSUE_UOM_CONV,ISSUE_UOM,ISSUE_UOM_QTY,TRIM(ST_DISPLAY_UNIT_COST (DTL.ITEM_CODE,SYSDATE,'CURRENT_STOCK')* DTL.ISSUE_UOM_CONV) ITEM_UNIT_COST, TRIM(ST_DISPLAY_UNIT_COST (DTL.ITEM_CODE,SYSDATE,'CURRENT_STOCK')* DTL.ISSUE_UOM_CONV) * (DECODE (DTL.iss_item_qty, 0, DTL.authorized_item_qty, DTL.iss_item_qty ))  ITEM_COST_VALUE,DTL.REMARKS,TO_CHAR (DOC_DATE, 'DD/MM/YYYY') DOC_DATE,HDR.SEQ_NO FROM ST_ISSUE_DTL DTL,ST_ISSUE_HDR HDR,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?)/*DTL.FACILITY_ID = ?*/ AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = DTL.FACILITY_ID AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.SEQ_NO = DTL.SEQ_NO AND HDR.SEQ_NO = ?");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_RET_HDR_SELECT", "SELECT DOC_TYPE_CODE, DOC_NO, TO_CHAR(DOC_DATE,'DD/MM/YYYY') DOC_DATE, DOC_REF, FM_STORE_CODE, TO_STORE_CODE,FINALIZED_YN, GL_INTERFACED_YN, TRN_TYPE,ITEM_CLASS_CODE,FACILITY_ID FROM ST_ISSUE_RET_HDR,ST_ACC_ENTITY_PARAM PA WHERE ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR FACILITY_ID = ?) AND DOC_NO = ? AND DOC_TYPE_CODE = ?");
		//commented by Rabbani on 11/07/2012 
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_RET_DTL_SELECT", "SELECT HDR.TO_STORE_CODE, DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO,HDR.FM_STORE_CODE, DTL.ITEM_CODE, DTL.STOCK_ITEM_YN,RET_ITEM_QTY ITEM_QTY, ITEM_UNIT_COST,ITEM_COST_VALUE, DTL.REMARKS, TO_CHAR (DOC_DATE,'DD/MM/YYYY') DOC_DATE,DEF_ISSUE_UOM UOM_CODE FROM ST_ISSUE_RET_DTL DTL, ST_ISSUE_RET_HDR HDR,ST_ITEM_STORE STSTR,ST_ACC_ENTITY_PARAM PA WHERE /*DTL.FACILITY_ID = ?*/ ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?) AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = DTL.FACILITY_ID AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.FM_STORE_CODE = STSTR.STORE_CODE AND DTL.ITEM_CODE = STSTR.ITEM_CODE");
		//Added by Rabbani on 11/07/2012 
		//dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_RET_DTL_SELECT", "SELECT HDR.TO_STORE_CODE, DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO,HDR.FM_STORE_CODE, DTL.ITEM_CODE, DTL.STOCK_ITEM_YN,RET_ITEM_QTY ITEM_QTY, TRIM(ST_DISPLAY_COST_DECIMALS (STSTR.ITEM_CODE, STSTR.STORE_CODE ))ITEM_UNIT_COST, TRIM(ST_DISPLAY_COST_DECIMALS (STSTR.ITEM_CODE, STSTR.STORE_CODE )) * (DTL.RET_ITEM_QTY) ITEM_COST_VALUE, DTL.REMARKS, TO_CHAR (DOC_DATE,'DD/MM/YYYY') DOC_DATE,DEF_ISSUE_UOM UOM_CODE FROM ST_ISSUE_RET_DTL DTL, ST_ISSUE_RET_HDR HDR,ST_ITEM_STORE STSTR,ST_ACC_ENTITY_PARAM PA WHERE /*DTL.FACILITY_ID = ?*/ ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?) AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = DTL.FACILITY_ID AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.FM_STORE_CODE = STSTR.STORE_CODE AND DTL.ITEM_CODE = STSTR.ITEM_CODE");
		
		//Modified by Sakti added st_display_unit_cost for item_unit_cost against inc#50521
		//Modified by suresh.r on 13-11-2014 against Inc 52256(Added 2 args to ST_DISPLAY_UNIT_COST)
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_FINAL_RET_DTL_SELECT", "SELECT HDR.TO_STORE_CODE, DTL.DOC_TYPE_CODE, DTL.DOC_NO, DTL.DOC_SRL_NO,HDR.FM_STORE_CODE, DTL.ITEM_CODE, DTL.STOCK_ITEM_YN,RET_ITEM_QTY ITEM_QTY, /*TRIM(ST_DISPLAY_COST_DECIMALS (STSTR.ITEM_CODE, STSTR.STORE_CODE ))ITEM_UNIT_COST*/ TRIM(ST_DISPLAY_UNIT_COST(DTL.ITEM_CODE,SYSDATE,'CURRENT_STOCK')* ST_GET_UOM_CONV_FAC_SING_STR(STSTR.ITEM_CODE, STSTR.STORE_CODE)) ITEM_UNIT_COST, /*TRIM(ST_DISPLAY_COST_DECIMALS (STSTR.ITEM_CODE, STSTR.STORE_CODE ))*/TRIM(ST_DISPLAY_UNIT_COST(DTL.ITEM_CODE,SYSDATE,'CURRENT_STOCK')* ST_GET_UOM_CONV_FAC_SING_STR(STSTR.ITEM_CODE, STSTR.STORE_CODE)) * (DTL.RET_ITEM_QTY) ITEM_COST_VALUE, DTL.REMARKS, TO_CHAR (DOC_DATE,'DD/MM/YYYY') DOC_DATE,DEF_ISSUE_UOM UOM_CODE FROM ST_ISSUE_RET_DTL DTL, ST_ISSUE_RET_HDR HDR,ST_ITEM_STORE STSTR,ST_ACC_ENTITY_PARAM PA WHERE /*DTL.FACILITY_ID = ?*/ ((PA.TRN_ACROSS_FACILITY_YN = 'Y') OR DTL.FACILITY_ID = ?) AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.FACILITY_ID = DTL.FACILITY_ID AND HDR.DOC_NO = DTL.DOC_NO AND HDR.DOC_TYPE_CODE = DTL.DOC_TYPE_CODE AND HDR.FM_STORE_CODE = STSTR.STORE_CODE AND DTL.ITEM_CODE = STSTR.ITEM_CODE");
   
	     dataMap.put("SQL_ST_ITEM_STORE_COUNT_SELECT","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE WHERE ITEM_CODE = ?  AND STORE_CODE = ? AND BIN_LOCATION_CODE =? AND EFF_STATUS = 'E'");

		//dataMap.put("SQL_ST_PATIENT_CLASS_SELECT","SELECT 	A.PATIENT_CLASS PATIENT_CLASS_CODE, B.SHORT_DESC PATIENT_CLASS, VISIT_ADM_TYPE_IND, ASSIGN_CARE_LOCN_TYPE,ASSIGN_CARE_LOCN_CODE, ASSIGN_ROOM_NUM, ASSIGN_BED_NUM   FROM 	PR_ENCOUNTER A, AM_PATIENT_CLASS_LANG_VW B  WHERE 	A.PATIENT_CLASS = B.PATIENT_CLASS    AND A.FACILITY_ID =? AND A.ENCOUNTER_ID =? AND 	A.PATIENT_ID =? AND B.LANGUAGE_ID = ?");
		//commented for practitioner id by ganga
		dataMap.put("SQL_ST_PATIENT_CLASS_SELECT","SELECT 	A.PATIENT_CLASS PATIENT_CLASS_CODE, B.SHORT_DESC PATIENT_CLASS, VISIT_ADM_TYPE_IND, ASSIGN_CARE_LOCN_TYPE,ASSIGN_CARE_LOCN_CODE, ASSIGN_ROOM_NUM, ASSIGN_BED_NUM ,ATTEND_PRACTITIONER_ID,(select PRACTITIONER_NAME from am_practitioner_lang_vw  where practitioner_id = a.attend_practitioner_id and language_id = ?) ATTEND_PRACTITIONER_NAME  FROM	PR_ENCOUNTER A, AM_PATIENT_CLASS_LANG_VW B  WHERE 	A.PATIENT_CLASS = B.PATIENT_CLASS    AND A.FACILITY_ID =? AND A.ENCOUNTER_ID =? AND A.PATIENT_ID =? AND B.LANGUAGE_ID = ?");//Modified for GHL-SCF-1369


		dataMap.put("SQL_ST_NURSING_UINIT_SELECT","SELECT 	SHORT_DESC FROM IP_NURSING_UNIT_LANG_VW WHERE 	FACILITY_ID =? AND NURSING_UNIT_CODE =? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_ST_CLINIC_SELECT","SELECT 	SHORT_DESC FROM OP_CLINIC_LANG_VW WHERE FACILITY_ID =? AND CLINIC_CODE =? AND LANGUAGE_ID = ?");
//PORequest Related Queries.....
		dataMap.put("SQL_ST_PO_REQUEST_FROM_STORE_SELECT","SELECT ST.STORE_CODE,MM.SHORT_DESC FROM ST_USER_ACCESS_FOR_STORE ST,MM_STORE_LANG_VW MM,SM_APPL_USER SM, ST_STORE STSTR WHERE ST.STORE_CODE = MM.STORE_CODE AND ST.STORE_CODE = STSTR.STORE_CODE AND ST.USER_ID=SM.APPL_USER_ID AND MM.EFF_STATUS = 'E' AND SM.EFF_STATUS='E' AND (ST.PRQ_ALLOWED_YN='Y' AND STSTR.PRQ_ALLOWED_YN='Y') AND MM.FACILITY_ID	=? AND ST.USER_ID =? AND MM.LANGUAGE_ID = ?  ORDER BY 2");

		dataMap.put("SQL_ST_PO_REQUEST_TO_DEPT_SELECT","SELECT DEPT_CODE,SHORT_DESC FROM AM_DEPT_LANG_VW WHERE   EFF_STATUS='E'AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");

		dataMap.put("SQL_ST_ACC_ENTITY_PARAM_SELECT1","select INTERFACE_TO_EXTERNAL_PO_YN,PO_INTERFACE_YN from st_acc_entity_param where acc_entity_id=?");

		dataMap.put("SQL_ST_ITEM_STORE_COUNT1","SELECT COUNT (*) TOTAL FROM ST_ITEM_STORE WHERE STORE_CODE IN (SELECT REQ_STORE_CODE STORE_CODE FROM PO_REQUEST_HDR  WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? AND DOC_NO = ?  UNION  SELECT PUR_DEPT_CODE STORE_CODE FROM PO_REQUEST_HDR  WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? AND DOC_NO = ?) AND ITEM_CODE IN (SELECT ITEM_CODE FROM PO_REQUEST_DTL WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? AND DOC_NO = ?) AND PHY_INV_ID IS NOT NULL" );

		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT","SELECT   a.DOC_TYPE_CODE DOC_TYPE_CODE FROM st_trn_doc_type a,sy_doc_type_master_lang_vw b,sy_acc_entity_doc_type c WHERE a.facility_id = ? AND a.doc_type_code = b.doc_type_code AND a.trn_type = 'PRQ' AND b.status IS NULL AND a.doc_type_code = c.doc_type_code AND b.language_id = ?" );

		dataMap.put("SQL_ST_AM_DEPT_SELECT","SELECT short_desc FROM am_dept_lang_vw WHERE dept_code =? AND language_id LIKE ?");

		dataMap.put("SQL_ST_ITEM_CLASS_STORE_SELECT","SELECT st.item_class_code, mm.short_desc   FROM st_item_class_store st, mm_item_class_lang_vw mm  WHERE st.store_code = ? AND mm.item_class_code = st.item_class_code AND mm.language_id = ? ORDER	BY short_desc");

		dataMap.put("SQL_ST_MM_STORE_SELECT","SELECT mm.po_dept_code PARENT_STORE_CODE, am.short_desc FROM mm_store_lang_vw mm, am_dept_lang_vw am WHERE  mm.language_id = am.language_id   AND mm.po_dept_code =  am.dept_code  AND mm.language_id = ? and  mm.store_code = ? ORDER BY 2, 1");

		dataMap.put("SQL_ST_ITEM_STORE_SELECT2","SELECT phy_inv_id  FROM st_item_store WHERE store_code IN (SELECT REQ_STORE_CODE store_code FROM po_request_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ? UNION SELECT PUR_DEPT_CODE store_code FROM po_request_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND item_code IN (SELECT item_code FROM po_request_dtl WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?) AND phy_inv_id IS NOT NULL");

		dataMap.put("SQL_ST_PO_REQUEST_HDR_SELECT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no,TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_store_code, rbys.short_desc req_by_store_desc, hdr.PUR_DEPT_CODE, am.short_desc req_on_dept_desc, hdr.item_class_code, itm.short_desc item_class_desc FROM po_request_hdr hdr, mm_store_lang_vw rbys,  mm_item_class_lang_vw itm,sy_doc_type_master_lang_vw sy, st_user_access_for_store uacb, am_dept_lang_vw am WHERE hdr.doc_type_code = sy.doc_type_code  AND hdr.req_store_code = rbys.store_code  AND hdr.item_class_code = itm.item_class_code(+)  AND hdr.curr_status = 'U' AND hdr.doc_type_code LIKE ?  AND TO_CHAR (hdr.doc_no) LIKE ?  AND TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') LIKE ?  AND hdr.req_store_code LIKE ?  AND hdr.PUR_DEPT_CODE LIKE ? AND NVL (hdr.item_class_code, 'X') LIKE ? AND uacb.user_id = ? AND uacb.store_code = hdr.req_store_code AND uacb.prq_allowed_yn = 'Y' AND rbys.facility_id = ?  AND sy.language_id = ? AND itm.language_id(+) = ? AND am.dept_code = hdr.pur_dept_code  AND sy.language_id = am.language_id AND sy.language_id = rbys.language_id");

		dataMap.put("SQL_ST_USER_ACCESS_FOR_STORE_SELECT","SELECT st.store_code,	mm.short_desc FROM st_user_access_for_store	st,mm_store_lang_vw mm,sm_appl_user sm, st_store ststr WHERE st.store_code = mm.store_code AND st.store_code = ststr.store_code AND st.user_id=sm.appl_user_id AND mm.eff_status = 'E' AND sm.eff_status='E' AND (st.PRQ_allowed_yn='Y' AND ststr.PRQ_allowed_yn='Y') AND mm.facility_id	=? AND st.user_id =? AND mm.language_id = ?  ORDER BY 2");

		dataMap.put("SQL_ST_PO_REQUEST_HDR_INSERT","INSERT INTO po_request_hdr (FACILITY_ID, DOC_TYPE_CODE, DOC_NO, DOC_DATE, DOC_REF, MATERIAL_GROUP_CODE, ITEM_CLASS_CODE, REQ_STORE_CODE, PUR_DEPT_CODE, CURR_STATUS, CURR_STATUS_BY_ID, CURR_STATUS_DATE, CURR_STATUS_REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,REQUEST_TYPE)VALUES(?, ?,?, TO_DATE(?,'DD/MM/YYYY'), ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?,?)");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_INSERT","INSERT INTO po_request_dtl (FACILITY_ID, DOC_TYPE_CODE, DOC_NO, DOC_SRL_NO, ITEM_CODE, REQ_QTY, REQ_UOM, REQ_GEN_UOM_CONV_FACTOR, REQ_GEN_UOM_QTY, GRN_QTY, GRN_UOM, GRN_GEN_UOM_QTY, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");

		dataMap.put("SQL_ST_PO_REQUEST_STATUS_INSERT","INSERT INTO po_request_status (FACILITY_ID, DOC_TYPE_CODE, DOC_NO, STATUS_SRL_NO, STATUS, STATUS_BY_ID, STATUS_DATE, STATUS_REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");

		dataMap.put("SQL_ST_PO_REQUEST_HDR_SELECT1","SELECT facility_id, doc_type_code, doc_no,TO_CHAR (doc_date, 'dd/mm/yyyy'), doc_ref, item_class_code,   req_store_code, pur_dept_code,request_type FROM po_request_hdr WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_SELECT","SELECT   doc_srl_no, dtl.item_code, itm.short_desc item_desc, dtl.REQ_QTY, itstr1.def_issue_uom uom,uom.short_desc uom_desc, dtl.req_uom,dtl.REQ_GEN_UOM_CONV_FACTOR, dtl.REQ_GEN_UOM_QTY,itstr1.qty_on_hand, itstr1.max_stk_qty, itm.gen_uom_code FROM po_request_dtl dtl,mm_item_lang_vw itm,am_uom_lang_vw uom, po_request_hdr hdr, st_item_store itstr1 WHERE dtl.facility_id = ? AND dtl.doc_type_code = ? AND dtl.doc_no = ?  AND dtl.item_code = itm.item_code  AND itstr1.def_issue_uom = uom.uom_code  AND dtl.facility_id = hdr.facility_id  AND dtl.doc_type_code = hdr.doc_type_code   AND dtl.doc_no = hdr.doc_no  AND hdr.req_store_code = itstr1.store_code  AND dtl.item_code = itstr1.item_code AND itm.language_id = uom.language_id AND itm.language_id = ? ORDER BY doc_srl_no");

		dataMap.put("SQL_ST_PO_REQUEST_HDR_UPDATE","UPDATE PO_REQUEST_HDR SET DOC_DATE= TO_DATE(?,'DD/MM/YYYY') ,DOC_REF= ? ,CURR_STATUS=?,CURR_STATUS_BY_ID=?,CURR_STATUS_DATE=TO_DATE(?,'DD/MM/YYYY'),CURR_STATUS_REMARKS=?, MODIFIED_BY_ID = ? , MODIFIED_DATE = SYSDATE , MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID =?  WHERE FACILITY_ID = ?  AND DOC_TYPE_CODE= ? AND DOC_NO= ?");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_COUNT","SELECT COUNT(*) COUNT FROM PO_REQUEST_DTL WHERE DOC_NO =? AND FACILITY_ID=? AND DOC_TYPE_CODE = ?");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_SELECT1","SELECT REQ_QTY FROM po_request_dtl WHERE facility_id = ? AND doc_type_code = ? AND doc_no = ?  AND doc_srl_no = ?");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_UPDATE","UPDATE	po_request_dtl SET REQ_QTY	= ?,REQ_UOM=? ,REQ_GEN_UOM_CONV_FACTOR=?  ,REQ_GEN_UOM_QTY=?,GRN_QTY=?,GRN_UOM=?, GRN_GEN_UOM_QTY=? ,modified_by_id =? ,modified_date =	SYSDATE	, modified_at_ws_no	= ?	, modified_facility_id = ? WHERE facility_id = ?  AND doc_type_code = ?  AND doc_no = ?  AND doc_srl_no = ?");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_DELETE","DELETE FROM	po_request_dtl WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND	doc_srl_no = ?");

		dataMap.put("SQL_ST_PO_REQUEST_HDR_SELECT2","SELECT req_store_code, item_code, req_qty FROM po_request_hdr hdr, po_request_dtl dtl WHERE hdr.facility_id = dtl.facility_id AND hdr.doc_type_code = dtl.doc_type_code AND hdr.doc_no = dtl.doc_no AND hdr.facility_id = ? AND hdr.doc_type_code = ? AND hdr.doc_no = ?");

		dataMap.put("SQL_ST_PO_REQUEST_HDR_DELETE","DELETE	FROM po_request_hdr	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_DELETE1","DELETE	FROM po_request_dtl	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?");

		dataMap.put("SQL_ST_PO_REQUEST_STATUS_DELETE","DELETE	FROM po_request_status	WHERE facility_id =	?  AND doc_type_code = ?  AND doc_no = ?");

		dataMap.put("SQL_ST_XI_TRN_GRN_SELECT","select DOC_TYPE_CODE from PO_REQUEST_HDR where FACILITY_ID=? and DOC_NO=? and REQ_STORE_CODE=? ");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_UPDATE_FOR_GRN_QTY","UPDATE PO_REQUEST_DTL SET GRN_QTY=?, GRN_UOM=?, GRN_GEN_UOM_QTY=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID =? AND DOC_NO=? AND ITEM_CODE=? AND DOC_TYPE_CODE=?");

		dataMap.put("SQL_ST_TRN_DOC_TYPE_SELECT1","SELECT   a.doc_type_code, b.short_desc FROM st_trn_doc_type a,sy_doc_type_master_lang_vw b,sy_acc_entity_doc_type c,st_acc_entity_param d WHERE a.facility_id = ?  AND a.doc_type_code = b.doc_type_code  AND (a.trn_type = 'GRN' OR a.trn_type = 'PRQ' AND d.ACC_ENTITY_ID=? and d.INTERFACE_TO_EXTERNAL_PO_YN='Y') AND b.status IS NULL AND a.doc_type_code = c.doc_type_code  AND b.language_id = ? ORDER BY 2");
		
		dataMap.put("SQL_ST_XI_TRN_GRN_SELECT_MAX","SELECT	MAX(doc_srl_no)	max_doc_srl_no FROM	XI_TRN_GRN WHERE facility_id=? AND doc_type_code=? AND doc_no=?");

		dataMap.put("SQL_ST_XI_TRN_GRN_SELECT1","SELECT	TO_CHAR(doc_date,'dd/mm/yyyy') doc_date, doc_ref, store_code, item_class_code, 'N' finalized_yn,'N' gl_interfaced_yn, '' trn_type,'' supp_code,''currency_code,'N' entry_completed_yn,  '' receipt_date, '' po_no FROM XI_TRN_GRN WHERE facility_id=? AND doc_type_code=? AND doc_no=? ");

		dataMap.put("SQL_ST_XI_TRN_GRN_SELECT2","SELECT dtl.doc_srl_no, dtl.item_code, mmitem.short_desc item_desc,dtl.ITEM_QTY item_qty_normal, '0' item_qty_bonus, '0' item_qty_sample,dtl.item_cost_value, '' stock_item_yn, 'N' label_reqd_yn, dtl.grn_unit_cost_in_pur_uom, dtl.pur_uom_code, dtl.pur_uom_conv,'N' replace_on_expiry_yn,  dtl.grn_unit_cost_in_stk_uom,am.short_desc gen_uom_desc, am.uom_code, stitem.expiry_yn,'0' no_of_labels, am1.short_desc uom_desc, dtl.po_cost, dtl.po_discount, dtl.po_tax FROM XI_TRN_GRN dtl, mm_item_lang_vw mmitem, st_item stitem, am_uom_lang_vw am, am_uom_lang_vw am1, st_item_store st WHERE mmitem.item_code = dtl.item_code AND stitem.item_code = dtl.item_code AND mmitem.gen_uom_code = am.uom_code AND dtl.facility_id = ? AND dtl.doc_type_code = ? AND dtl.doc_no = ? AND mmitem.language_id = am.language_id  AND mmitem.language_id =? AND am.language_id = am1.language_id AND am1.uom_code = st.def_issue_uom AND st.item_code = dtl.item_code AND st.store_code = dtl.store_code ");

		dataMap.put("SQL_ST_XI_TRN_GRN_SELECT3","select grn_item_qty, trade_id, TO_CHAR(EXPIRY_DATE ,'dd/mm/yyyy') expiry_date_or_receipt_date, item_code, store_code, XI_BATCH_ID batch_id,'' bin_location_code,sale_price from XI_TRN_GRN stexp WHERE stexp.facility_id=? AND stexp.doc_type_code=? AND stexp.doc_no=? AND stexp.doc_srl_no=?");

		dataMap.put("SQL_ST_PO_REQUEST_DTL_SELECT2","SELECT   dtl.doc_no, dtl.doc_srl_no, dtl.item_code, itm.short_desc item_desc,dtl.req_qty req_item_qty, gen_uom_code, am.short_desc gen_short_desc,hdr.curr_status_remarks remarks  FROM po_request_dtl dtl, mm_item_lang_vw itm, am_uom_lang_vw am,po_request_hdr hdr WHERE dtl.doc_type_code = ? AND dtl.doc_no = ? AND dtl.item_code = itm.item_code AND itm.language_id = ? AND itm.language_id = am.language_id AND itm.gen_uom_code = am.uom_code AND hdr.doc_no=dtl.doc_no AND hdr.doc_type_code=dtl.doc_type_code AND hdr.facility_id=dtl.facility_id ORDER BY doc_srl_no");

		dataMap.put("SQL_ST_PO_REQUEST_HDR_SELECT3","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no,TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_store_code,rbys.short_desc req_by_store_desc, hdr.pur_dept_code,am.short_desc req_on_dept_desc, hdr.item_class_code,itm.short_desc item_class_desc, DECODE (hdr.curr_status, 'U', 'Unfinalized', 'P', 'Pending For Approval', 'R', 'Request Rejected by PO Dept', 'L', 'Request Received Partially','C', 'Request Received Completely', 'X', 'Request Cancelled') request_status,hdr.modified_by_id, TO_CHAR (hdr.modified_date, 'dd/mm/yyyy') modified_date, so.appl_user_name added_by_name,sp.appl_user_name modified_by_name,hdr.added_by_id,hdr.curr_status_remarks FROM po_request_hdr hdr, mm_store_lang_vw rbys, mm_item_class_lang_vw itm,sy_doc_type_master_lang_vw sy,am_dept_lang_vw am,sm_appl_user_lang_vw so, sm_appl_user_lang_vw sp WHERE hdr.doc_type_code = sy.doc_type_code  AND hdr.req_store_code = rbys.store_code  AND hdr.item_class_code = itm.item_class_code(+) AND hdr.curr_status like (?) AND hdr.doc_type_code LIKE (?)  AND TO_CHAR (hdr.doc_no) LIKE (?)  AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy') ) AND (hdr.facility_id, hdr.doc_type_code, hdr.doc_no) IN (SELECT facility_id, doc_type_code, doc_no  FROM po_request_dtl WHERE facility_id = hdr.facility_id AND doc_type_code = hdr.doc_type_code AND doc_no = hdr.doc_no AND item_code LIKE UPPER (?)) AND hdr.req_store_code LIKE (?) AND hdr.pur_dept_code LIKE (?) AND NVL (hdr.item_class_code, 'X') LIKE (?) AND rbys.store_code = hdr.req_store_code AND rbys.facility_id = ? AND sy.language_id = ? AND itm.language_id(+) = ? AND am.dept_code = hdr.pur_dept_code AND sy.language_id = am.language_id AND sy.language_id = rbys.language_id AND so.appl_user_id(+) = hdr.added_by_id AND sp.appl_user_id(+) = hdr.modified_by_id AND so.language_id(+) = ? AND sp.language_id(+) = ?");

		dataMap.put("SQL_ST_STORE_SELECT2","SELECT   st.store_code, mm.short_desc FROM st_store st,mm_store_lang_vw mm WHERE st.store_code = mm.store_code  AND st.prq_allowed_yn = 'Y' AND mm.facility_id = ? AND mm.language_id = ? ORDER BY 2");

		dataMap.put("SQL_ST_AM_DEPT_SELECT1","SELECT mm.po_dept_code po_dept_code, am.short_desc FROM mm_store_lang_vw mm, am_dept_lang_vw am WHERE  mm.language_id = am.language_id   AND mm.po_dept_code =  am.dept_code  AND mm.language_id = ? and  mm.store_code = ? ORDER BY 2");
		dataMap.put("SQL_ST_CANCEL_POREQUEST_REQ_BY_STORE_SELECT","SELECT ST.STORE_CODE,MM.SHORT_DESC FROM ST_USER_ACCESS_FOR_STORE ST,MM_STORE_LANG_VW MM,SM_APPL_USER SM, ST_STORE STSTR WHERE ST.STORE_CODE = MM.STORE_CODE AND ST.STORE_CODE = STSTR.STORE_CODE AND ST.USER_ID=SM.APPL_USER_ID AND MM.EFF_STATUS = 'E' AND SM.EFF_STATUS='E' AND (ST.PRQ_ALLOWED_YN='Y' AND STSTR.PRQ_ALLOWED_YN='Y')  and st.cancl_allowed_yn = 'Y' AND MM.FACILITY_ID	=? AND MM.LANGUAGE_ID = ? AND ST.USER_ID =?   ORDER BY 2,1");
/*
	Auto Schedule Request 12/11/2008
*/
		dataMap.put("SQL_SCHDULE_REQUEST_BY_STORE_SELECT","SELECT ST.STORE_CODE,	MM.SHORT_DESC FROM ST_USER_ACCESS_FOR_STORE	ST,	MM_STORE_LANG_VW MM, SM_APPL_USER SM, ST_STORE STSTR WHERE ST.STORE_CODE = MM.STORE_CODE AND ST.STORE_CODE = STSTR.STORE_CODE  AND ST.USER_ID=SM.APPL_USER_ID AND MM.EFF_STATUS = 'E' AND SM.EFF_STATUS='E' AND MM.FACILITY_ID	=? AND ST.USER_ID =	? AND MM.LANGUAGE_ID = ?  ORDER BY 2");
		dataMap.put("SQL_SCHDULE_ITEMS_LOAD_SELECT","SELECT ST_ITEM_STORE.ITEM_CODE ITEM_CODE,MM_ITEM_LANG_VW.SHORT_DESC ITEM_DESC, 'N' FLAG,MM_ITEM_LANG_VW.ALPHA_CODE  FROM ST_ITEM_STORE ST_ITEM_STORE, MM_ITEM_LANG_VW MM_ITEM_LANG_VW, ST_ITEM_STORE ST_ITEM_STORE1,ST_ITEM ST_ITEM WHERE ST_ITEM_STORE.STORE_CODE = ?  AND ST_ITEM_STORE.ITEM_CODE = MM_ITEM_LANG_VW.ITEM_CODE AND MM_ITEM_LANG_VW.LANGUAGE_ID = ? AND UPPER(ST_ITEM_STORE.ITEM_CODE) LIKE UPPER(?) AND MM_ITEM_LANG_VW.ITEM_CLASS_CODE LIKE (?) AND NVL (MM_ITEM_LANG_VW.ITEM_ANAL1_CODE, '%') LIKE  DECODE (?,'', '%',?) AND NVL (MM_ITEM_LANG_VW.ITEM_ANAL2_CODE, '%') LIKE DECODE (?,'', '%', ?) AND NVL (MM_ITEM_LANG_VW.ITEM_ANAL3_CODE, '%') LIKE DECODE (?, '', '%', ? ) AND (ST_ITEM_STORE.MAX_STK_QTY IS NOT NULL OR ST_ITEM_STORE.REORDER_QTY IS NOT NULL)  AND ST_ITEM_STORE1.STORE_CODE = ?  AND UPPER(MM_ITEM_LANG_VW.ALPHA_CODE) LIKE UPPER(?) AND UPPER(MM_ITEM_LANG_VW.SHORT_DESC) LIKE UPPER(?)  AND ST_ITEM_STORE1.ITEM_CODE = ST_ITEM_STORE.ITEM_CODE  AND ST_ITEM_STORE1.EFF_STATUS = 'E' AND ST_ITEM_STORE.EFF_STATUS = 'E' AND ST_ITEM.ITEM_CODE=ST_ITEM_STORE.ITEM_CODE AND ST_ITEM.CONSIGNMENT_ITEM_YN LIKE(?) AND NOT EXISTS (SELECT item_code  FROM st_auto_req_rule_dtl a,st_auto_req_rule_hdr b WHERE a.item_code = st_item_store.item_code and  a.SCH_CODE=b.SCH_CODE and  b.REQ_BY_STORE_CODE=?) ORDER BY MM_ITEM_LANG_VW.SHORT_DESC");
		dataMap.put("SQL_SCHDULE_AUTO_REQUEST_HDR_INSERT","INSERT INTO ST_AUTO_REQ_RULE_HDR(FACILITY_ID, SCH_CODE, SCH_DESC, REQ_BY_STORE_CODE, REQ_ON_STORE_CODE, FREQUENCY, SCH_START_DATE, AUTO_AUTHORIZE_YN, STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, DOC_TYPE_CODE) VALUES(?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_SCHDULE_AUTO_REQUEST_DTL_INSERT","INSERT INTO ST_AUTO_REQ_RULE_DTL(FACILITY_ID, SCH_CODE, ITEM_CODE, STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_SCHDULE_AUTO_REQUEST_HDR_SELECT","SELECT SCH_CODE SCHEDULE_CODE,SCH_DESC SCHEDULE_DESC,REQ_BY_STORE_CODE REQUISITION_BY_STORE ,REQ_ON_STORE_CODE REQUISITION_ON_STORE, STATUS EFF_STATUS,DOC_TYPE_CODE DOC_TYPE_CODE ,AUTO_AUTHORIZE_YN AUTO_AUTHORISED,TO_CHAR (SCH_START_DATE, 'dd/mm/yyyy') STARTING_FROM,FREQUENCY FREQUENCY FROM ST_AUTO_REQ_RULE_HDR WHERE FACILITY_ID=? AND  SCH_CODE =? ORDER BY SCH_CODE");
		dataMap.put("SQL_SCHDULE_AUTO_REQUEST_DTL_SELECT","SELECT DTL.ITEM_CODE ITEM_CODE ,MM_ITEM_LANG_VW.SHORT_DESC ITEM_DESC ,'Y' FLAG FROM ST_AUTO_REQ_RULE_DTL DTL,MM_ITEM_LANG_VW MM_ITEM_LANG_VW WHERE DTL.FACILITY_ID=? AND  DTL.SCH_CODE=? AND DTL.ITEM_CODE =MM_ITEM_LANG_VW.ITEM_CODE AND MM_ITEM_LANG_VW.LANGUAGE_ID=? AND DTL.STATUS=MM_ITEM_LANG_VW.EFF_STATUS ORDER BY MM_ITEM_LANG_VW.SHORT_DESC");
		dataMap.put("SQL_SCHDULE_AUTO_REQUEST_HDR_UPDATE","UPDATE ST_AUTO_REQ_RULE_HDR SET FREQUENCY=?, SCH_START_DATE=TO_DATE(?,'DD/MM/YYYY'), AUTO_AUTHORIZE_YN=?, STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND SCH_CODE=?");
		dataMap.put("SQL_SCHDULE_AUTO_REQUEST_DTL_DELETE","DELETE FROM ST_AUTO_REQ_RULE_DTL WHERE FACILITY_ID=? AND SCH_CODE=? AND ITEM_CODE=?");
		dataMap.put("SQL_SCHDULE_AUTO_REQUEST_HDR_QUERY","SELECT SHDR.SCH_CODE SCHDULE_CODE,SHDR.SCH_DESC SCHDULE_DESC , MM.SHORT_DESC REQ_BY_STORE_DESC,  MM1.SHORT_DESC REQ_ON_STORE_DESC , SHDR.STATUS EFF_STATUS FROM ST_AUTO_REQ_RULE_HDR SHDR,MM_STORE_LANG_VW MM,MM_STORE_LANG_VW MM1 WHERE SHDR.FACILITY_ID=? AND UPPER(SHDR.SCH_CODE) LIKE UPPER(?) AND UPPER(SHDR.SCH_DESC) LIKE UPPER(?) AND SHDR.REQ_BY_STORE_CODE LIKE (?) AND SHDR.REQ_ON_STORE_CODE LIKE(?) AND SHDR.STATUS LIKE(?) AND SHDR.REQ_BY_STORE_CODE=MM.STORE_CODE AND SHDR.REQ_ON_STORE_CODE=MM1.STORE_CODE AND MM.LANGUAGE_ID=? AND MM1.LANGUAGE_ID=?");
		dataMap.put("SQL_SCHDULE_AUTO_CODE_LOOKUP","SELECT SCH_CODE CODE,SCH_DESC  DESCRIPTION FROM  ST_AUTO_REQ_RULE_HDR WHERE STATUS = 'E' AND  UPPER(SCH_CODE) LIKE UPPER(?) AND UPPER(SCH_DESC) LIKE UPPER(?) AND FACILITY_ID =");
		dataMap.put("SQL_SCHDULE_AUTO_STORE_LOOKUP","SELECT ST.STORE_CODE CODE,	MM.SHORT_DESC DESCRIPTION FROM ST_USER_ACCESS_FOR_STORE	 ST,	MM_STORE_LANG_VW MM, SM_APPL_USER SM, ST_STORE STSTR WHERE ST.STORE_CODE = MM.STORE_CODE AND ST.STORE_CODE = STSTR.STORE_CODE  AND ST.USER_ID=SM.APPL_USER_ID AND MM.EFF_STATUS = 'E' AND SM.EFF_STATUS='E' AND  UPPER(ST.STORE_CODE) LIKE UPPER (?) AND UPPER(MM.SHORT_DESC) LIKE UPPER(?)	AND mm.facility_id=");
       //Added By Rabbani,  #inc no:29537 on 11/11/11
		//starts here
		dataMap.put("PROCESS_SUSPENDED_YN","SELECT PROCESS_SUSPENDED_ITEMS_YN FROM ST_USER_ACCESS_FOR_STORE WHERE USER_ID= ? AND STORE_CODE= ?");
	  //ends here
		dataMap.put("SQL_ST_ITEM_BATCH_FOR_COMMITED_QTY", "SELECT A.ITEM_CODE ITEM_CODE, B.SHORT_DESC ITEM_DESC , NVL(A.COMMITTED_QTY,0) COMMITTED_QTY , NVL(A.QTY_ON_HAND,0)  QTY_ON_HAND , NVL(A.QTY_ON_HAND,0)-NVL(A.COMMITTED_QTY,0) AVAIL_QTY  FROM ST_ITEM_BATCH A,MM_ITEM_LANG_VW B WHERE A.STORE_CODE = ? AND A.ITEM_CODE = ? AND A.BATCH_ID = ? AND A.BIN_LOCATION_CODE = ? AND A.EXPIRY_DATE_OR_RECEIPT_DATE = to_date(?,'dd/mm/yyyy') AND A.ITEM_CODE = B.ITEM_CODE AND B.language_id= ? ");
		//Added By Sakti against Inc# - 29421 starts
		dataMap.put("SQL_ST_FACILITY_PARAM_FOR_ISS_ACK_YN","SELECT	ISS_ACK_REQ_YN FROM	st_facility_param WHERE facility_id=?");
		//Added By Sakti against Inc# - 29421 ends
		
		//addeed for Barcode
		dataMap.put("SQL_ST_TRANS_APPL_FOR_BARCODE_APPL", "SELECT BARCODE_APPL FROM ST_TRANS_APPL WHERE  TRN_TYPE = ?  AND  BARCODE_APPL LIKE 'BARCODE%'" );
		dataMap.put("SQL_ST_TRANS_APPL_FOR_BARCODE_DFLTVAL_APPL", "SELECT BARCODE_APPL FROM ST_TRANS_APPL WHERE  TRN_TYPE = ?  AND  BARCODE_APPL = 'DFLTVAL' " );
		dataMap.put("SQL_ST_TRANS_APPL_FOR_BARCODE_EDITVAL_APPL", "SELECT BARCODE_APPL FROM ST_TRANS_APPL WHERE  TRN_TYPE = ?  AND  BARCODE_APPL = 'EDITVAL' " );

		//dataMap.put("SQL_ST_ITEM_BATCH_SELECT_FOR_BAR_CODE", "SELECT BARCODE_ID,ITEM_CODE,STORE_CODE,BATCH_ID,BIN_LOCATION_CODE, to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,TRADE_ID,NVL(QTY_ON_HAND,0) QTY_ON_HAND,NVL(COMMITTED_QTY,0) COMMITTED_QTY,NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0)AVAIL_QTY FROM ST_ITEM_BATCH WHERE BARCODE_ID = ?  AND STORE_CODE = ? " );
		//dataMap.put("SQL_ST_ITEM_BATCH_SELECT_FOR_BAR_CODE", "SELECT BARCODE_ID,ITEM_CODE,STORE_CODE,BATCH_ID,BIN_LOCATION_CODE, to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,TRADE_ID,NVL(QTY_ON_HAND,0) QTY_ON_HAND,NVL(COMMITTED_QTY,0) COMMITTED_QTY,NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0)AVAIL_QTY FROM ST_ITEM_BATCH WHERE BARCODE_ID like (?)  AND STORE_CODE = ? " );
		//Added SUSPENDED_YN against IN:062247 
		dataMap.put("SQL_ST_ITEM_BATCH_SELECT_FOR_BAR_CODE", "SELECT BARCODE_ID,ITEM_CODE,STORE_CODE,BATCH_ID,BIN_LOCATION_CODE, to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,TRADE_ID,NVL(QTY_ON_HAND,0) QTY_ON_HAND,NVL(COMMITTED_QTY,0) COMMITTED_QTY,NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0)AVAIL_QTY,SUSPENDED_YN FROM ST_ITEM_BATCH WHERE BARCODE_ID =?  AND STORE_CODE = ? " );//modified for MMS-QF-SCF-0636 Removed Barcode_id like = for TH-KW-CRF-0043
		dataMap.put("SQL_ST_ITEM_BATCH_SELECT_FOR_BAR_CODE_NEW", "SELECT BARCODE_ID,ITEM_CODE,STORE_CODE,BATCH_ID,BIN_LOCATION_CODE, to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,TRADE_ID,NVL(QTY_ON_HAND,0) QTY_ON_HAND,NVL(COMMITTED_QTY,0) COMMITTED_QTY,NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0)AVAIL_QTY,SUSPENDED_YN FROM ST_ITEM_BATCH WHERE BARCODE_ID = ?  AND STORE_CODE = ? " );//added for for GHL-SCF-1857
		//HERE IF REQUIRED WE HAVE TO ADD AND (NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0)) > 0 

		//dataMap.put("SQL_ST_ITEM_SELECT_FOR_BAR_CODE", "SELECT  a.item_code, b.short_desc item_desc, a.expiry_yn, b.unit_cost, a.trade_id_applicable_yn,a.batch_id_applicable_yn,b.gen_uom_code,(SELECT short_desc FROM am_uom_lang_vw  WHERE b.gen_uom_code = uom_code AND b.language_id = language_id) gen_uom_desc  FROM st_item a,mm_item_lang_vw b WHERE a.item_code = b.item_code  AND b.eff_status = 'E'  AND  b.language_id = ?  and a.item_code = ?" );
		dataMap.put("SQL_ST_ITEM_SELECT_FOR_BAR_CODE", "SELECT  a.item_code, b.short_desc item_desc, a.expiry_yn, b.unit_cost, a.trade_id_applicable_yn,a.batch_id_applicable_yn,b.gen_uom_code,(SELECT short_desc FROM am_uom_lang_vw  WHERE uom_code = b.gen_uom_code AND language_id = b.language_id) gen_uom_desc,c.def_issue_uom,(SELECT short_desc FROM am_uom_lang_vw  WHERE uom_code = c.def_issue_uom  AND language_id=b.language_id)def_issue_uom_desc,b.manufacturer_id  FROM st_item a,mm_item_lang_vw b,st_item_store c WHERE a.item_code = b.item_code  AND b.eff_status = 'E'  AND  b.language_id = ?  and a.item_code = ? and a.item_code=c.item_code and c.store_code = ?" );
		//commented to add barcode by ganga
		//dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_FOR_BARCODE", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	OR use_after_expiry_yn='Y' OR (expiry_yn='Y' AND (?='Y'	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) AND BATCH_ID = NVL (?, BATCH_ID) and EXPIRY_DATE = TO_DATE (?, 'dd/mm/yyyy') ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");
		//dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_FOR_BARCODE", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS,BARCODE_ID FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	OR use_after_expiry_yn='Y' OR (expiry_yn='Y' AND (?='Y'	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) AND BATCH_ID = NVL (?, BATCH_ID) and EXPIRY_DATE = TO_DATE (?, 'dd/mm/yyyy') ORDER BY  to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");
		//Modified  by suresh.r against ML-BRU-SCF-1005[IN:43173]  on 28-04-2014
		dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_SELECT_FOR_BARCODE", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS,BARCODE_ID FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=? AND (?='Y'	OR suspended_yn='N') AND (expiry_yn='N'	/*OR use_after_expiry_yn='Y'*/ OR (expiry_yn='Y' AND ((use_after_expiry_yn='Y' AND (?='Y'))	OR expiry_date >= TRUNC( nvl(to_date(?,'dd/mm/yyyy'),SYSDATE) )))) AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) AND BATCH_ID = NVL (?, BATCH_ID) and EXPIRY_DATE = TO_DATE (?, 'dd/mm/yyyy') ORDER BY  to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");
		//added end
		dataMap.put("SQL_ST_ITEM_BATCH_LEVEL_SALES_PRICE", "SELECT  ST_ITEM_CHARGE_MRP_PRICE(?,?,?,?,?) MRP_PRICE FROM DUAL ");
		dataMap.put("SQL_ST_TRANS_APPL_FOR_ADD_GRN_APPL", "SELECT BARCODE_APPL FROM ST_TRANS_APPL WHERE  TRN_TYPE = ?  AND  BARCODE_APPL = 'ADDGRN' ");
		dataMap.put("SQL_ST_BATCH_CONTROL_SELECT_FOR_BAR_CODE", "SELECT A.BARCODE_ID,A.ITEM_CODE,B.SHORT_DESC,A.BATCH_ID, to_char(A.EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.TRADE_ID FROM ST_BATCH_CONTROL A,MM_ITEM_LANG_VW B  WHERE A.ITEM_CODE=B.ITEM_CODE AND B.LANGUAGE_ID= ? AND BARCODE_ID = ? ");

//Added By sakti Sankar on 03/05/2012 against inc#29972
		dataMap.put("SQL_ST_ITEM_BARCODE_RULES_COUNT",			"SELECT	COUNT(*) total FROM	ST_ITEM_BARCODE_RULES	WHERE facility_id= ? ");

		dataMap.put("ST_ITEM_BARCODE_RULES_UPDATE",	"UPDATE	ST_ITEM_BARCODE_RULES SET BARCODE_GEN_RULE=?,ITEM_YN=?, BATCH_ID_YN=?, EXPIRY_DT_YN=?, FACILITY_ID_YN=?, TRADE_ID_YN=?, MFG_ID_YN=?, SUPP_ID_YN=?,	STORE_CODE_YN=?, BIN_LOCN_YN=?, MRP_YN=?,BARCODE_SEQ=?,	MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=?");
		//Added ends

		dataMap.put("SQL_ST_SALES_DTL_EXP_SELECT_FOR_BAR_CODE", "SELECT distinct A.BARCODE_ID,A.ITEM_CODE,B.SHORT_DESC,A.BATCH_ID, to_char(A.EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.TRADE_ID,A.BIN_LOCATION_CODE FROM ST_SAL_DTL_EXP A,MM_ITEM_LANG_VW B  WHERE A.ITEM_CODE=B.ITEM_CODE AND B.LANGUAGE_ID= ? AND A.BARCODE_ID = ? AND A.STORE_CODE = ? AND ROWNUM <=1 ");
		dataMap.put("SQL_ST_ISSUE_DTL_EXP_SELECT_FOR_BAR_CODE", "SELECT distinct A.BARCODE_ID,A.ITEM_CODE,B.SHORT_DESC,A.BATCH_ID, to_char(A.EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.TRADE_ID,A.BIN_LOCATION_CODE FROM ST_ISSUE_DTL_EXP A,MM_ITEM_LANG_VW B  WHERE A.ITEM_CODE=B.ITEM_CODE AND B.LANGUAGE_ID= ? AND A.BARCODE_ID = ? AND A.STORE_CODE = ? AND ROWNUM <=1 ");
		dataMap.put("SQL_ST_ITEM_BARCODE_RULES_SELECT_FOR_BAR_CODE", "SELECT FACILITY_ID,BARCODE_GEN_RULE,ITEM_YN,BATCH_ID_YN,EXPIRY_DT_YN,FACILITY_ID_YN,TRADE_ID_YN,MFG_ID_YN,SUPP_ID_YN,STORE_CODE_YN,BIN_LOCN_YN,MRP_YN,BARCODE_SEQ FROM ST_ITEM_BARCODE_RULES WHERE FACILITY_ID=? ");
		dataMap.put("SQL_ST_BATCH_CONTROL_SELECT_FOR_BAR_CODE_RULE", "Select SUPP_CODE  from st_batch_control where ITEM_CODE=? and BATCH_ID=? AND expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy') ");
		dataMap.put("SQL_ST_SELECT_BARCODE_SEQUENCE", "select ST_BARCODE_SEQUENCE.nextval newbarcode from dual");
		
		//Added By sakti Sankar on 25/04/2012 against inc#32464
		dataMap.put("SQL_ST_ITEM_BATCH_COUNT_CHECK","SELECT COUNT(*) COUNT FROM ST_ITEM_BATCH WHERE STORE_CODE = ? AND ITEM_CODE = ? AND BATCH_ID = ? AND BIN_LOCATION_CODE = ? AND EXPIRY_DATE_OR_RECEIPT_DATE = to_date(?,'dd/mm/yyyy')  ");
		//Added ends

		//Added By Sakti Sankar against CRF#28759
		dataMap.put("SQL_AM_TRADE_NAME_SELECT_LIST","SELECT TRADE_ID, short_name FROM am_trade_name_lang_vw WHERE EFF_STATUS='E' AND language_id = ? ORDER BY short_name");

		dataMap.put("SQL_MM_BIN_LOCATION_SELECT_LIST_1","SELECT BIN_LOCATION_CODE, short_desc FROM mm_bin_location_lang_vw WHERE EFF_STATUS='E' AND language_id = ? ORDER BY short_desc");
		//ended
		
		
		//added for GRN Po
		dataMap.put("SQL_PO_NUMBER_SELECT_LIST", "SELECT DISTINCT POH.PO_DOC_NO FROM ST_PO_ORDER_HDR POH,ST_PO_ORDER_FCY_DTL POD,ST_PO_REQUEST_DTL PRD WHERE POH.PUR_UNIT_CODE=POD.PUR_UNIT_CODE AND POH.PO_DOC_NO=POD.PO_DOC_NO AND POD.REQ_DOC_NO = PRD.DOC_NO AND POD.REQ_DOC_TYPE_CODE = PRD.DOC_TYPE_CODE  AND POD.REQ_DOC_SRL_NO=PRD.DOC_SRL_NO AND POD.REQ_FACILITY_ID=PRD.FACILITY_ID AND (NVL(PRD.REQ_QTY,0)-NVL(PRD.GRN_QTY,0))>0  AND POD.REQ_STORE_CODE = ? AND POH.SUPP_CODE = ?  AND POD.REQ_FACILITY_ID = ? ");		
		dataMap.put("SQL_PO_NUMBER_DETAILS_SELECT", "SELECT DTL.PO_DOC_NO,DTL.PO_DOC_SRL_NO DOC_SRL_NO, DTL.ITEM_CODE,MMITEM.SHORT_DESC ITEM_DESC,(NVL(DTL.PO_QTY,0)-NVL(DTL.GRN_QTY,0))ITEM_QTY_NORMAL,DTL.ITEM_UNIT_COST,((NVL(DTL.PO_QTY,0)-NVL(DTL.GRN_QTY,0)) * NVL(DTL.ITEM_UNIT_COST,0))ITEM_COST_VALUE, STOCK_ITEM_YN, PO_UOM PUR_UOM_CODE,AM1.SHORT_DESC PUR_UOM_DESC,AM.UOM_CODE,AM.SHORT_DESC GEN_UOM_DESC, DTL.PO_GEN_UOM_CONV_FACTOR,DTL.PO_GEN_UOM_QTY,STITEM.EXPIRY_YN, '0' ITEM_QTY_BONUS, '0' ITEM_QTY_SAMPLE , STITEM.ALLOW_DECIMALS_YN,HDR.CURRENCY_CODE,to_char(DTL.DELIVERY_DATE,'dd/mm/yyyy') DELIVERY_DATE FROM st_po_order_hdr HDR ,st_po_order_fcy_dtl DTL,MM_ITEM_LANG_VW MMITEM,ST_ITEM STITEM,AM_UOM_LANG_VW AM,ST_ITEM_STORE ST, AM_UOM_LANG_VW AM1 WHERE HDR.PUR_UNIT_CODE=DTL.PUR_UNIT_CODE AND HDR.PO_DOC_NO=DTL.PO_DOC_NO and MMITEM.ITEM_CODE = DTL.ITEM_CODE AND  STITEM.ITEM_CODE = DTL.ITEM_CODE AND  MMITEM.GEN_UOM_CODE = AM.UOM_CODE AND DTL.PO_DOC_NO = ? AND MMITEM.LANGUAGE_ID = AM.LANGUAGE_ID AND  MMITEM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = AM1.LANGUAGE_ID AND DTL.PO_UOM = AM1.UOM_CODE AND ST.ITEM_CODE = DTL.ITEM_CODE AND ST.STORE_CODE = DTL.REQ_STORE_CODE AND DTL.REQ_STORE_CODE = ? AND DTL.REQ_FACILITY_ID = ?  AND (NVL(DTL.PO_QTY,0)-NVL(DTL.GRN_QTY,0)) > 0  ORDER BY 2");
		dataMap.put("SQL_PO_REQUEST_DETAILS_SELECT", "SELECT POD.PUR_UNIT_CODE,POD.PO_DOC_NO,POD.ITEM_CODE, MMITEM.SHORT_DESC ITEM_DESC,nvl(POD.PO_QTY,0)-nvl(POD.GRN_QTY,0)PO_QTY,PRD.DOC_NO REQ_DOC_NO,NVL(PRD.REQ_QTY,0)-NVL(PRD.GRN_QTY,0)REQ_QTY,PRD.DOC_TYPE_CODE,PRD.DOC_SRL_NO,PRD.FACILITY_ID,POD.REQ_STORE_CODE,POD.PO_DOC_SRL_NO FROM ST_PO_ORDER_HDR POH,ST_PO_ORDER_FCY_DTL POD,ST_PO_REQUEST_DTL PRD, MM_ITEM_LANG_VW MMITEM  WHERE POH.PUR_UNIT_CODE=POD.PUR_UNIT_CODE AND POH.PO_DOC_NO=POD.PO_DOC_NO AND POD.ITEM_CODE=MMITEM.ITEM_CODE AND POD.REQ_DOC_NO = PRD.DOC_NO  AND POD.REQ_DOC_TYPE_CODE = PRD.DOC_TYPE_CODE AND POD.ITEM_CODE = PRD.ITEM_CODE AND MMITEM.LANGUAGE_ID= ? AND POD.ITEM_CODE = ? AND POD.PO_DOC_NO= ? AND POD.REQ_STORE_CODE = ? AND POD.REQ_FACILITY_ID= ? ");
		dataMap.put("SQL_UPDATE_PO_REQUEST_DETAIL_GRN_QTY", "UPDATE PO_REQUEST_DETAIL SET GRN_QTY = NVL(GRN_QTY,0)+? , GRN_UOM = ? ,GRN_GEN_UOM_QTY = NVL(GRN_GEN_UOM_QTY,0)+? , MODIFIED_BY_ID = ? ,MODIFIED_DATE = sysdate , MODIFIED_AT_WS_NO = ? ,MODIFIED_FACILITY_ID = ? WHERE FACILITY_ID = ? AND REQ_NO = ? AND REQ_SRL_NO = ? ");	
		dataMap.put("SQL_ST_PURCHASE_UNIT_SELECT", "SELECT pur_unit_code,long_desc short_desc FROM po_purchase_unit	WHERE pur_unit_code=? ");	
		dataMap.put("SQL_ST_UOM_DESC_SELECT", "SELECT UOM_CODE,SHORT_DESC FROM AM_UOM WHERE UOM_CODE=?");
		dataMap.put("SQL_PO_PARAMETER_OVERRIDE_ALLOW", "SELECT ALLOW_OVERRIDE_PO_DLVDT,ALLOW_PRICE_OVERRIDE_IN_GRN,ALLOW_QTY_OVERRIDE_IN_GRN FROM PO_PARAMETER");
		dataMap.put("SQL_ST_PO_PURCHASE_UNIT_LIST",	"SELECT   b.pur_unit_code code, a.long_desc description  FROM po_purchase_unit a, po_pur_unit_facility b  WHERE a.pur_unit_code = b.pur_unit_code   AND a.eff_status = 'E'  AND b.facility_id =  ?  ORDER BY 2");
		dataMap.put("SQL_UPDATE_PO_ORDER_HDR_FOR_NEXT_DEL_DATE", "UPDATE PO_ORDER_HDR SET EXPECTED_DELV_DATE = to_date(NVL(?,EXPECTED_DELV_DATE),'dd/mm/yyyy'), MODIFIED_BY_ID = ? ,MODIFIED_DATE = sysdate , MODIFIED_AT_WS_NO = ? ,MODIFIED_FACILITY_ID = ? WHERE  PO_NO = ? ");			
	   // dataMap.put("SQL_INSERT_PO_ORDER_UNF_GRN_RECORDS",	"INSERT INTO PO_ORDER_UNF_GRN  ( FACILITY_ID, GRN_DOC_TYPE_CODE, GRN_NO, PO_NO, REQ_NO, ITEM_CODE, BLOCKED_QTY, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES  ( ? , ? , ? , ? , ? , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? , ? ) ");
	    dataMap.put("SQL_INSERT_PO_ORDER_UNF_GRN_RECORDS",	"INSERT INTO PO_ORDER_UNF_GRN  ( FACILITY_ID, GRN_DOC_TYPE_CODE, GRN_NO, PO_NO, REQ_NO, ITEM_CODE, BLOCKED_QTY,DO_NO, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES  ( ? , ? , ? , ? , ? , ? , ? , ? , ? , SYSDATE , ? , ? , ? , SYSDATE , ? , ? ) ");

		//dataMap.put("SQL_COUNT_PO_ORDER_UNF_GRN_RECORDS","SELECT COUNT(*) COUNT FROM PO_ORDER_UNF_GRN WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ? AND PO_NO = ?  AND REQ_NO = ? AND ITEM_CODE = ? ");
		dataMap.put("SQL_COUNT_PO_ORDER_UNF_GRN_RECORDS","SELECT COUNT(*) COUNT FROM PO_ORDER_UNF_GRN WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ? AND PO_NO = ?  AND REQ_NO = ? AND ITEM_CODE = ? AND DO_NO = ? ");

		//dataMap.put("SQL_UPDATE_PO_ORDER_UNF_GRN_RECORDS","UPDATE PO_ORDER_UNF_GRN  SET  BLOCKED_QTY = ?  WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ? AND PO_NO = ?  AND REQ_NO = ? AND ITEM_CODE = ? ");
		dataMap.put("SQL_UPDATE_PO_ORDER_UNF_GRN_RECORDS","UPDATE PO_ORDER_UNF_GRN  SET  BLOCKED_QTY = NVL(BLOCKED_QTY,0) + ?  WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ? AND PO_NO = ?  AND REQ_NO = ? AND ITEM_CODE = ? AND DO_NO = ? ");

		//dataMap.put("SQL_DELETE_PO_ORDER_UNF_GRN_RECORDS","DELETE PO_ORDER_UNF_GRN  WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ? AND PO_NO = ?  AND REQ_NO = ? AND ITEM_CODE = ? ");
		dataMap.put("SQL_DELETE_PO_ORDER_UNF_GRN_RECORDS","DELETE PO_ORDER_UNF_GRN  WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ? AND PO_NO = ?  AND REQ_NO = ? AND ITEM_CODE = ? AND DO_NO = ? ");

		dataMap.put("SQL_DELETE_PO_ORDER_UNF_GRN_RECORDS1","DELETE PO_ORDER_UNF_GRN  WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ?  AND ITEM_CODE = ? ");
		dataMap.put("SQL_DELETE_PO_ORDER_UNF_GRN_RECORDS2","DELETE PO_ORDER_UNF_GRN  WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ?  ");
		dataMap.put("SQL_UPDATE_PO_ORDER_FCY_DTL_GRN_QTY", "UPDATE PO_ORDER_FCY_DTL SET  GRN_QTY = NVL(GRN_QTY,0)+? , GRN_UOM = ? ,GRN_UOM_CONV_FACTOR = ? ,PO_LINE_STATUS = ? , MODIFIED_BY_ID = ? ,MODIFIED_DATE = sysdate , MODIFIED_AT_WS_NO = ? ,MODIFIED_FACILITY_ID = ? WHERE PUR_UNIT_CODE = ? AND PO_NO = ? AND REQ_FACILITY_ID = ? AND REQ_STORE_CODE = ? AND ITEM_CODE = ? AND PO_SRL_NO = ?");	
		dataMap.put("SQL_PO_PURCHASE_UNIT_LIST",	"SELECT A.pur_unit_code code, A.long_desc description FROM PO_PURCHASE_UNIT A,PO_USER_FOR_PUNIT B where A.PUR_UNIT_CODE = B.PUR_UNIT_CODE  AND  A.eff_status='E' AND B.USER_ID= ? ORDER BY 2");
		dataMap.put("SQL_UPDATE_PO_ORDER_FCY_DTL_STATUS", "UPDATE PO_ORDER_FCY_DTL SET  PO_LINE_STATUS = ? WHERE PUR_UNIT_CODE = ? AND PO_NO = ? AND REQ_FACILITY_ID = ? AND REQ_STORE_CODE = ? AND ITEM_CODE = ? AND PO_SRL_NO = ?");
		dataMap.put("SQL_UPDATE_PO_ORDER_HDR_STATUS", "UPDATE PO_ORDER_HDR SET PO_STATUS = ?  WHERE PO_NO = ? ");
		//ended
		dataMap.put("SQL_ST_BATCH_AVAIL_QTY_SELECT", "SELECT SUM(QTY_ON_HAND-COMMITTED_QTY) AVAILABLE_QTY FROM st_item_batch WHERE item_code=? AND store_code=?");
		dataMap.put("SQL_ST_BATCH_AND_REMARKS_SELECT", "SELECT ALLOW_BATCH_CHANGE_ON_AUTH,ALLOW_PARTIALQTY_WO_RMKS FROM ST_FACILITY_PARAM WHERE FACILITY_ID=?");
		// Added by Padmapriya for INC # 29976 on 31/08/2012
		dataMap.put("SQL_ST_PHYSICAL_INVENTORY_HDR_UPDATE", "UPDATE ST_PHY_INV_HDR SET modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=? WHERE FACILITY_ID=? and PHY_INV_ID=? and store_code=? and item_code=?");
		dataMap.put("SQL_ST_ITEM_BATCH_FOR_PHY_INV_HDR_UPDATE", "SELECT  ITEM_QTY, ITEM_CODE, BATCH_ID, BIN_LOCATION_CODE, EXPIRY_DATE_OR_RECEIPT_DATE, TRADE_ID, NEW_BATCH_YN, ENTRY_COMPLETED_YN, STOCK_ITEM_YN FROM ST_PHY_INV_DTL WHERE FACILITY_ID = ? AND PHY_INV_ID = ? AND STORE_CODE = ? AND ITEM_CODE = ?");
		
		//Added by Sakti for INC#29966 CRF#12
		dataMap.put("SQL_ST_ITEM_IMAGE_CATLG_PATH_SELECT", "SELECT ITEM_IMAGE_CATLG_PATH FROM ST_FACILITY_PARAM WHERE FACILITY_ID =?");
		dataMap.put("SQL_IMAGE_FILE_NAME_SELECT", "SELECT FILE_NAME FROM MM_ITEM_IMAGE_CATLG WHERE ITEM_CODE = ? AND FACILITY_ID=? ORDER BY SRL_NO");
		//Added ends
		  //Added  by Rabbani #inc no :35661 (PMG2012-CRF-0012) on 23/11/2012 
         dataMap.put("SQL_MM_ITEM_UPDATE_PUR_UOM", "UPDATE mm_item SET pur_uom_code = ? WHERE  item_code=?");

    	dataMap.put("SQL_UPDATE_PO_DELV_ORD_DTL_BAT_GRN_QTY", "UPDATE PO_DELV_ORD_DTL_BAT  SET GRN_QTY = NVL (GRN_QTY, 0) + ?,  GRN_UOM = ?,  GRN_UOM_CONV_FACTOR = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE,  MODIFIED_AT_WS_NO = ?,  MODIFIED_FACILITY_ID = ?  ,GRN_BLOCKED_QTY = 0 WHERE DO_NO = ?  AND ITEM_CODE = ? AND DO_SRL_NO = ? AND TRUNC(SCH_DELV_DATE) = TO_DATE(?,'DD/MM/YYYY')  AND PO_NO = ?  AND PO_SRL_NO = ?  AND BATCH_ID = ?   AND TRUNC(EXPIRY_DATE)=TO_DATE(?,'DD/MM/YYYY')  AND DIST_FACILITY_ID=?   AND DIST_STORE_CODE=?");
		dataMap.put("SQL_UPDATE_PO_DELV_ORD_DTL_BAT_GRN_BLOCK_QTY", "UPDATE PO_DELV_ORD_DTL_BAT  SET GRN_BLOCKED_QTY = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE,  MODIFIED_AT_WS_NO = ?,  MODIFIED_FACILITY_ID = ?  WHERE DO_NO = ?  AND ITEM_CODE = ? AND DO_SRL_NO = ? AND TRUNC(SCH_DELV_DATE) = TO_DATE(?,'DD/MM/YYYY')  AND PO_NO = ?  AND PO_SRL_NO = ?  AND BATCH_ID = ?   AND TRUNC(EXPIRY_DATE)=TO_DATE(?,'DD/MM/YYYY')  AND DIST_FACILITY_ID=?   AND DIST_STORE_CODE=?");
		dataMap.put("SQL_UPDATE_PO_DELV_ORD_HDR_STATUS", "UPDATE PO_DELV_ORD_HDR SET DO_STATUS = ? WHERE DO_NO = ?");
		dataMap.put("SQL_UPDATE_PO_DELV_ORD_DTL_STATUS", "UPDATE PO_DELV_ORD_DTL SET DO_LINE_STATUS = ? WHERE DO_NO = ? AND ITEM_CODE = ? AND DO_SRL_NO = ? AND TRUNC(SCH_DELV_DATE)= TO_DATE(?,'DD/MM/YYYY') AND PO_NO = ? AND PO_SRL_NO = ?");
		dataMap.put("SQL_UPDATE_PO_ORDER_UNF_GRN_DO_QTY_IN_DO_BAT1", "UPDATE PO_DELV_ORD_DTL_BAT  SET GRN_BLOCKED_QTY = 0, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE,  MODIFIED_AT_WS_NO = ?,  MODIFIED_FACILITY_ID = ?  WHERE DO_NO = ?  AND ITEM_CODE = ?  AND DIST_FACILITY_ID=?   AND DIST_STORE_CODE=?");
		dataMap.put("SQL_ST_GRN_HDR_DTL_SELECT_FOR_DO_BATCH_UPDATE", "SELECT HDR.DO_NO,DTL.ITEM_CODE FROM ST_GRN_HDR HDR,ST_GRN_DTL DTL WHERE HDR.DOC_NO=DTL.DOC_NO AND HDR.DOC_TYPE_CODE=DTL.DOC_TYPE_CODE AND HDR.FACILITY_ID=DTL.FACILITY_ID AND HDR.FACILITY_ID=? AND HDR.DOC_TYPE_CODE=?  AND  HDR.DOC_NO= ?  AND HDR.DO_NO IS NOT NULL");
		
		//Added by Rabbani #Bru-HIMS-CRF-088(Inc no:29954) on 04-MAR-2013  Starts
		dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_INSERT", "INSERT INTO ST_STORE_DISPOSE_BATCH (store_code, eff_status, added_by_id, added_date,	added_at_ws_no,	added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id , auto_gen_batch_yn , next_batch_id , batch_id_series )	VALUES ( ?,	?, ?, SYSDATE,	?, ?, ?, SYSDATE, ?, ?, ?, ?, ? )");
		dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_SELECT_SINGLE", "SELECT store_code, eff_status FROM	ST_STORE_DISPOSE_BATCH 	WHERE store_code = ?");
		dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_UPDATE", "UPDATE ST_STORE_DISPOSE_BATCH SET  eff_status	= ?, modified_by_id	= ?, modified_date = SYSDATE, modified_at_ws_no	=?,	modified_facility_id = ? WHERE store_code = ?");
		dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_COUNT", "SELECT COUNT(*) COUNT	FROM ST_STORE_DISPOSE_BATCH WHERE store_code = ? ");
		//dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_BATCH","UPDATE ST_STORE_DISPOSE_BATCH SET   next_batch_id = ? , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE store_code = ?");
		
		dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_BATCH","UPDATE ST_STORE_DISPOSE_BATCH SET  auto_gen_batch_yn = ?, next_batch_id = ? ,eff_status = ?,  modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  WHERE store_code = ?");
		
		//dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_SELECT_BATCH_ID", "SELECT store_code ,auto_gen_batch_yn , batch_id_series,next_batch_id, EFF_STATUS FROM    ST_STORE_DISPOSE_BATCH	WHERE store_code	= ? ");
		dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_SELECT_BATCH_ID", "SELECT store_code ,auto_gen_batch_yn , batch_id_series,next_batch_id, EFF_STATUS FROM    ST_STORE_DISPOSE_BATCH	WHERE store_code	= ? ");
		//dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_QUERY_RESULT",	"SELECT	store_code, eff_status, auto_gen_batch_yn, batch_id_series , next_batch_id FROM ST_STORE_DISPOSE_BATCH  WHERE	store_code LIKE UPPER(?)  AND eff_status LIKE ?");
		
         	dataMap.put("SQL_ST_DISPOSABLE_ADJUSTMENT_QUERY_RESULT",	"SELECT	a.store_code,b.short_desc store_desc ,a.eff_status, auto_gen_batch_yn, batch_id_series , next_batch_id FROM ST_STORE_DISPOSE_BATCH a,mm_store_lang_vw b  WHERE a.store_code = b.store_code and B.FACILITY_ID = ? AND a.store_code LIKE UPPER(?)   AND UPPER(b.SHORT_DESC)	LIKE UPPER(?) AND next_batch_id LIKE ?  AND a.eff_status LIKE ? AND B.LANGUAGE_ID = ?");
		 
		dataMap.put("SQL_ST_ADJUSTMENT_DISPOSABLE_BATCH_UPDATE","UPDATE ST_STORE_DISPOSE_BATCH SET   next_batch_id = ? WHERE store_code = ?");
		//ends
		//Added By Sakti Sankar on 06/03/2013 against Inc#
		dataMap.put("SQL_SM_NO_OF_COPIES_SELECT_FOR_PRINT" , " select NO_OF_COPIES from sm_print_routing where report_id=? and module_id = ? ");
		//Added by Rabbani #Inc no :39203 on 18-APR-2013  
		dataMap.put("SQL_ST_TRN_DOC_TYPE_LIST_FOR_REQ_STATUS", "SELECT	distinct a.doc_type_code, b.short_desc FROM st_trn_doc_type a, sy_doc_type_master_lang_vw b, st_acc_entity_param c WHERE a.facility_id LIKE  decode(c.trn_across_facility_yn,'Y','%', ?) AND a.doc_type_code = b.doc_type_code AND a.trn_type =	? AND b.status is NULL  AND b.language_id = ? ORDER BY	2,1");
		//Added by Rabbani #Inc no :40572 (Ref:37445(RUT-CRF-0097)) on 05-JUN-2013
		dataMap.put("SQL_ST_TRANS_APPL_FOR_MFG_PROCESS_LOSS_NA", "SELECT BARCODE_APPL FROM ST_TRANS_APPL WHERE  TRN_TYPE = ?  AND  BARCODE_APPL = 'MFG_PROCESS_LOSS_NA' ");
		
		//Added by Rabbani #Inc no :40572 (Ref:30075(Bru-HIMS-CRF-116)) on 05-JUN-2013
		dataMap.put("SQL_ST_TRANS_APPL_FOR_ACPT_GRNNO_BACKORD", "SELECT BARCODE_APPL FROM ST_TRANS_APPL WHERE  TRN_TYPE = ?  AND  BARCODE_APPL = 'ACPT_GRNNO_BACKORD'" );
		
		//Added by Rabbani # Bru-HIMS-CRF-118[INC NO:30077] on 19-JULY-2013 
		dataMap.put("SQL_ST_REVERT_DTL_SELECT_CANCEL_REQUEST","SELECT hdr.req_by_store_code, dtl.pending_item_qty,dtl.item_code FROM st_request_hdr hdr, st_request_dtl dtl WHERE hdr.doc_no = dtl.doc_no AND hdr.doc_no = ? and hdr.doc_type_code = ? and dtl.item_code = ?");
		
		//Added by Rabbani #RUT-CRF-0068.1[Inc no:36976] on 22-July-2013 Starts
		//dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_QUERY_RESULT","SELECT DISTINCT x.store_code, store_desc, itm_code, item_desc, stock_item_yn,qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom,unit_cost, item_value, avail_qty, base_uom_qoh, issue_uom_avl, reorder_level,generic_name,generic_id,atc_class_lev4_desc FROM (SELECT   store_code, store_desc,  itm_code, item_desc, stock_item_yn, qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom, unit_cost, item_value, (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) avail_qty, base_uom_qoh,ROUND (NVL(  (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) / NVL ((st_get_uom_conv_fac_sing_str (itm_code, store_code ) ), 1 ),0 ), 4 ) issue_uom_avl, reorder_level,generic_name,generic_id,atc_class_lev4_desc FROM (SELECT DISTINCT stb.batch_id, a.store_code, b.short_desc store_desc, a.item_code itm_code, c.short_desc item_desc, a.stock_item_yn,NVL (a.qty_on_hand, 0) qty_on_hand, c.gen_uom_code gen_uom_code, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = c.gen_uom_code AND language_id = ?) uom_desc, a.def_issue_uom def_issue_uom, TRIM (st_display_cost_decimals (a.item_code, a.store_code ) ) unit_cost, item_value, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = a.def_issue_uom AND language_id = ?) issue_uom, stb.qty_on_hand bt_qty_on_hand, stb.committed_qty committed_qty, NVL (  NVL (a.qty_on_hand, 0) * NVL ((st_get_uom_conv_fac_sing_str (a.item_code, a.store_code ) ), 1 ), 0 ) base_uom_qoh, a.reorder_level reorder_level,(SELECT generic_name FROM ph_generic_name_lang_vw phg, ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phg.language_id = phd.language_id AND phd.language_id = ? AND phd.drug_code = k.item_code ) generic_name,(SELECT phg.generic_id FROM ph_generic_name_lang_vw phg,ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code  AND phg.language_id = phd.language_id  AND phd.language_id = ? AND phd.drug_code = k.item_code)generic_id, (SELECT phatc.ATC_CLASS_LEV4_DESC FROM PH_GENERIC_NAME_BY_ATC_CLASS phg, ph_drug_lang_vw phd,PH_ATC_CLASS_LEV4_LANG_VW phatc WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phatc.language_id =  phd.language_id AND phd.language_id = ? and phg.SRL_NO = '1'  and phatc.ATC_CLASS_LEV1_CODE = phg.ATC_CLASS_LEV1_CODE  and phatc.ATC_CLASS_LEV2_CODE = phg.ATC_CLASS_LEV2_CODE   and phatc.ATC_CLASS_LEV3_CODE = phg.ATC_CLASS_LEV3_CODE  and phatc.ATC_CLASS_LEV4_CODE = phg.ATC_CLASS_LEV4_CODE AND phd.drug_code = k.item_code)atc_class_lev4_desc  FROM st_item_store a, mm_store_lang_vw b, mm_item_lang_vw c, st_store e, st_item_batch stb, st_item k WHERE a.store_code = b.store_code AND a.item_code = c.item_code AND a.store_code BETWEEN ? AND ? AND a.item_code = NVL (?, a.item_code)");
		
		//Added by Rabbani #INC NO:42028,42039 and 42041 on 30-JULY-2013
		//dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_QUERY_RESULT","SELECT DISTINCT x.store_code, store_desc, itm_code, item_desc, stock_item_yn,qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom,unit_cost, item_value, avail_qty, base_uom_qoh, issue_uom_avl, reorder_level,generic_name,generic_id, atc_class_lev4_desc, medical_item_yn,drug_item_yn FROM (SELECT   store_code, store_desc,  itm_code, item_desc, stock_item_yn, qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom, unit_cost, item_value, (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) avail_qty, base_uom_qoh,ROUND (NVL(  (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) / NVL ((st_get_uom_conv_fac_sing_str (itm_code, store_code ) ), 1 ),0 ), 4 ) issue_uom_avl, reorder_level,generic_name,generic_id,atc_class_lev4_desc,medical_item_yn,drug_item_yn FROM (SELECT DISTINCT stb.batch_id, a.store_code, b.short_desc store_desc, a.item_code itm_code, c.short_desc item_desc, a.stock_item_yn,NVL (a.qty_on_hand, 0) qty_on_hand, c.gen_uom_code gen_uom_code, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = c.gen_uom_code AND language_id = ?) uom_desc, a.def_issue_uom def_issue_uom, TRIM (st_display_cost_decimals (a.item_code, a.store_code ) ) unit_cost, item_value, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = a.def_issue_uom AND language_id = ?) issue_uom, stb.qty_on_hand bt_qty_on_hand, stb.committed_qty committed_qty, NVL (  NVL (a.qty_on_hand, 0) * NVL ((st_get_uom_conv_fac_sing_str (a.item_code, a.store_code ) ), 1 ), 0 ) base_uom_qoh, a.reorder_level reorder_level,(SELECT generic_name FROM ph_generic_name_lang_vw phg, ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phg.language_id = phd.language_id AND phd.language_id = ? AND phd.drug_code = k.item_code ) generic_name,(SELECT phg.generic_id FROM ph_generic_name_lang_vw phg,ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code  AND phg.language_id = phd.language_id  AND phd.language_id = ? AND phd.drug_code = k.item_code)generic_id, (SELECT phatc.ATC_CLASS_LEV4_DESC FROM PH_GENERIC_NAME_BY_ATC_CLASS phg, ph_drug_lang_vw phd,PH_ATC_CLASS_LEV4_LANG_VW phatc WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phatc.language_id =  phd.language_id AND phd.language_id = ? and   phatc.ATC_CLASS_LEV1_CODE = phg.ATC_CLASS_LEV1_CODE  and phatc.ATC_CLASS_LEV2_CODE = phg.ATC_CLASS_LEV2_CODE   and phatc.ATC_CLASS_LEV3_CODE = phg.ATC_CLASS_LEV3_CODE  and phatc.ATC_CLASS_LEV4_CODE = phg.ATC_CLASS_LEV4_CODE AND phd.drug_code = k.item_code and rownum <=1)atc_class_lev4_desc ,k.MEDICAL_ITEM_YN medical_item_yn,k.DRUG_ITEM_YN drug_item_yn FROM st_item_store a, mm_store_lang_vw b, mm_item_lang_vw c, st_store e, st_item_batch stb, st_item k WHERE a.store_code = b.store_code AND a.item_code = c.item_code AND a.store_code BETWEEN ? AND ? AND a.item_code = NVL (?, a.item_code)");
		
		//Added by Rabbani #Inc no:44420(RUT-SCF-0307) on 22-OCT-2013
		//dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_QUERY_RESULT","SELECT DISTINCT x.store_code, store_desc, itm_code, item_desc, stock_item_yn,qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom,unit_cost, item_value, avail_qty, base_uom_qoh, issue_uom_avl, reorder_level,generic_name,generic_id, atc_class_lev4_desc, medical_item_yn,drug_item_yn FROM (SELECT   store_code, store_desc,  itm_code, item_desc, stock_item_yn, qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom, unit_cost, item_value, (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) avail_qty, base_uom_qoh,ROUND (NVL(  (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) / NVL ((st_get_uom_conv_fac_sing_str (itm_code, store_code ) ), 1 ),0 ), 4 ) issue_uom_avl, reorder_level,generic_name,generic_id,atc_class_lev4_desc,medical_item_yn,drug_item_yn FROM (SELECT DISTINCT stb.batch_id, a.store_code, b.short_desc store_desc, a.item_code itm_code, c.short_desc item_desc, a.stock_item_yn,NVL (a.qty_on_hand, 0) qty_on_hand, c.gen_uom_code gen_uom_code, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = c.gen_uom_code AND language_id = ?) uom_desc, a.def_issue_uom def_issue_uom, NVL(to_number(TRIM (st_display_cost_decimals (a.item_code, a.store_code ) )),0)unit_cost, item_value, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = a.def_issue_uom AND language_id = ?) issue_uom, stb.qty_on_hand bt_qty_on_hand, stb.committed_qty committed_qty, NVL (  NVL (a.qty_on_hand, 0) * NVL ((st_get_uom_conv_fac_sing_str (a.item_code, a.store_code ) ), 1 ), 0 ) base_uom_qoh, a.reorder_level reorder_level,(SELECT generic_name FROM ph_generic_name_lang_vw phg, ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phg.language_id = phd.language_id AND phd.language_id = ? AND phd.drug_code = k.item_code ) generic_name,(SELECT phg.generic_id FROM ph_generic_name_lang_vw phg,ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code  AND phg.language_id = phd.language_id  AND phd.language_id = ? AND phd.drug_code = k.item_code)generic_id, (SELECT phatc.ATC_CLASS_LEV4_DESC FROM PH_GENERIC_NAME_BY_ATC_CLASS phg, ph_drug_lang_vw phd,PH_ATC_CLASS_LEV4_LANG_VW phatc WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phatc.language_id =  phd.language_id AND phd.language_id = ? and   phatc.ATC_CLASS_LEV1_CODE = phg.ATC_CLASS_LEV1_CODE  and phatc.ATC_CLASS_LEV2_CODE = phg.ATC_CLASS_LEV2_CODE   and phatc.ATC_CLASS_LEV3_CODE = phg.ATC_CLASS_LEV3_CODE  and phatc.ATC_CLASS_LEV4_CODE = phg.ATC_CLASS_LEV4_CODE AND phd.drug_code = k.item_code and rownum <=1)atc_class_lev4_desc ,k.MEDICAL_ITEM_YN medical_item_yn,k.DRUG_ITEM_YN drug_item_yn FROM st_item_store a, mm_store_lang_vw b, mm_item_lang_vw c, st_store e, st_item_batch stb, st_item k WHERE a.store_code = b.store_code AND a.item_code = c.item_code AND a.store_code BETWEEN ? AND ? AND a.item_code = NVL (?, a.item_code)");
		
		//Modified by Sakti against TTM-SCF-0106 to get (base uom unit_cost*qty)item_value_new,base_unit_cost
		//Modified by suresh.r on 13-11-2014 against Inc 52256(Added 2 args to ST_DISPLAY_UNIT_COST)
		dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_QUERY_RESULT","SELECT DISTINCT x.store_code, store_desc, itm_code, item_desc, stock_item_yn,qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom,unit_cost, item_value, avail_qty, base_uom_qoh, issue_uom_avl, reorder_level,generic_name,generic_id, atc_class_lev4_desc, medical_item_yn,drug_item_yn,base_unit_cost,item_value_new FROM (SELECT   store_code, store_desc,  itm_code, item_desc, stock_item_yn, qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom, unit_cost,base_unit_cost, item_value, (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) avail_qty,((SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) )*ST_DISPLAY_UNIT_COST(itm_code,SYSDATE,'CURRENT_STOCK'))item_value_new, base_uom_qoh,ROUND (NVL(  (SUM (  NVL (bt_qty_on_hand, 0) - NVL (committed_qty, 0) ) ) / NVL ((st_get_uom_conv_fac_sing_str (itm_code, store_code ) ), 1 ),0 ), 4 ) issue_uom_avl, reorder_level,generic_name,generic_id,atc_class_lev4_desc,medical_item_yn,drug_item_yn FROM (SELECT DISTINCT stb.batch_id, a.store_code, b.short_desc store_desc, a.item_code itm_code, c.short_desc item_desc, a.stock_item_yn,NVL (a.qty_on_hand, 0) qty_on_hand, c.gen_uom_code gen_uom_code, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = c.gen_uom_code AND language_id = ?) uom_desc, a.def_issue_uom def_issue_uom, NVL(to_number(TRIM (st_display_cost_decimals (a.item_code, a.store_code ) )),0)unit_cost,TRIM(ST_DISPLAY_UNIT_COST(a.item_code,SYSDATE,'CURRENT_STOCK'))base_unit_cost, item_value, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = a.def_issue_uom AND language_id = ?) issue_uom, stb.qty_on_hand bt_qty_on_hand, stb.committed_qty committed_qty, NVL (  NVL (a.qty_on_hand, 0) * NVL ((st_get_uom_conv_fac_sing_str (a.item_code, a.store_code ) ), 1 ), 0 ) base_uom_qoh, a.reorder_level reorder_level,(SELECT generic_name FROM ph_generic_name_lang_vw phg, ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phg.language_id = phd.language_id AND phd.language_id = ? AND phd.drug_code = k.item_code ) generic_name,(SELECT phg.generic_id FROM ph_generic_name_lang_vw phg,ph_drug_lang_vw phd WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code  AND phg.language_id = phd.language_id  AND phd.language_id = ? AND phd.drug_code = k.item_code)generic_id, (SELECT phatc.ATC_CLASS_LEV4_DESC FROM PH_GENERIC_NAME_BY_ATC_CLASS phg, ph_drug_lang_vw phd,PH_ATC_CLASS_LEV4_LANG_VW phatc WHERE phg.generic_id = phd.generic_id AND phd.item_code = a.item_code AND phatc.language_id =  phd.language_id AND phd.language_id = ? and   phatc.ATC_CLASS_LEV1_CODE = phg.ATC_CLASS_LEV1_CODE  and phatc.ATC_CLASS_LEV2_CODE = phg.ATC_CLASS_LEV2_CODE   and phatc.ATC_CLASS_LEV3_CODE = phg.ATC_CLASS_LEV3_CODE  and phatc.ATC_CLASS_LEV4_CODE = phg.ATC_CLASS_LEV4_CODE AND phd.drug_code = k.item_code and rownum <=1)atc_class_lev4_desc ,k.MEDICAL_ITEM_YN medical_item_yn,k.DRUG_ITEM_YN drug_item_yn FROM st_item_store a, mm_store_lang_vw b, mm_item_lang_vw c, st_store e, st_item_batch stb, st_item k WHERE a.store_code = b.store_code AND a.item_code = c.item_code AND a.store_code BETWEEN ? AND ? AND a.item_code = NVL (?, a.item_code)");
		
		//dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_ATC_DESC","SELECT a.atc_class_lev4_code lev4_code, a.atc_class_lev4_desc lev4_desc FROM ph_atc_class_lev4_lang_vw a, PH_GENERIC_NAME_BY_ATC_CLASS phg  WHERE PHG.ATC_CLASS_LEV4_CODE = A.ATC_CLASS_LEV4_CODE and   PHG.GENERIC_ID = ?  AND a.language_id = ? GROUP BY a.atc_class_lev4_code, a.atc_class_lev4_desc ORDER BY  a.atc_class_lev4_desc");
		
		dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_ATC_DESC","SELECT a.atc_class_lev4_code lev4_code, a.atc_class_lev4_desc lev4_desc FROM ph_atc_class_lev4_lang_vw a, PH_GENERIC_NAME_BY_ATC_CLASS phg  WHERE PHG.ATC_CLASS_LEV1_CODE = A.ATC_CLASS_LEV1_CODE AND PHG.ATC_CLASS_LEV2_CODE = A.ATC_CLASS_LEV2_CODE and PHG.ATC_CLASS_LEV3_CODE = A.ATC_CLASS_LEV3_CODE and PHG.ATC_CLASS_LEV4_CODE = A.ATC_CLASS_LEV4_CODE and   PHG.GENERIC_ID = ?  AND a.language_id = ? GROUP BY a.atc_class_lev4_code, a.atc_class_lev4_desc ORDER BY  a.atc_class_lev4_desc");
		
		//dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_ATC_COUNT","SELECT COUNT(*) COUNT FROM ph_atc_class_lev4_lang_vw a, PH_GENERIC_NAME_BY_ATC_CLASS phg WHERE  PHG.ATC_CLASS_LEV4_CODE = A.ATC_CLASS_LEV4_CODE  and   PHG.GENERIC_ID = ? AND a.language_id = ?");
		
		dataMap.put("SQL_ST_DRUG_STOCK_STATUS_BY_STORE_ATC_COUNT","SELECT COUNT(*) COUNT FROM ph_atc_class_lev4_lang_vw a, PH_GENERIC_NAME_BY_ATC_CLASS phg WHERE a.atc_class_lev1_code = phg.atc_class_lev1_code AND a.atc_class_lev2_code = phg.atc_class_lev2_code AND a.atc_class_lev3_code = phg.atc_class_lev3_code and  PHG.ATC_CLASS_LEV4_CODE = A.ATC_CLASS_LEV4_CODE  and   PHG.GENERIC_ID = ? AND a.language_id = ?");
	
		//ends
		
		//Added by Rabbani #Bru-HIMS-CRF-111[Inc no :30070] on  05-AUG-2013 Starts
		dataMap.put("SQL_ST_FACILITY_NAME_QUERY","SELECT a.FACILITY_ID,FACILITY_NAME FROM SM_FACILITY_PARAM_LANG_VW a,st_facility_param b ,SM_FACILITY_FOR_USER c WHERE A.facility_id = B.facility_id AND LANGUAGE_ID = ?  and a.FACILITY_ID = c.FACILITY_ID AND c.appl_user_id = ? ORDER BY 2");
		 
         dataMap.put("SQL_ST_SUSPEND_BATCH_DETAILS_QUERY","SELECT   b.batch_status, a.batch_id, TO_CHAR (a.expiry_date, 'dd/mm/yyyy') expiry_date, trade_name, manufacturer_name, SUM (qty_on_hand) qtyonhand,SUM (AVAIL_QTY) availqty,a.store_code,A.STORE_DESC,c.facility_id,(SELECT facility_name FROM sm_facility_param_lang_vw vw  WHERE vw.facility_id = c.facility_id AND language_id = ?) facility_name,A.SUSPENDED_YN FROM st_batch_search_lang_view a, ST_BATCH_CONTROL b , mm_store_lang_vw c, ST_ACC_ENTITY_PARAM d,SM_FACILITY_FOR_USER e WHERE a.item_code = b.item_code AND a.batch_id = b.batch_id AND a.expiry_date = b.expiry_date_or_receipt_date AND a.item_code = ?    AND A.SUSPENDED_YN IN (?, ?) AND a.manufacturer_id LIKE (? || '%') AND a.batch_id = ? and A.EXPIRY_DATE = to_date(?,'dd/mm/yyyy') AND a.language_id = c.language_id AND c.store_code = a.store_code AND a.language_id = ? AND DECODE (a.lang1, NULL, ?, a.lang1) = ? AND DECODE (a.lang2, NULL, ?, a.lang2) = ? and C.STORE_CODE LIKE ? AND c.facility_id LIKE ? AND C.FACILITY_ID = E.FACILITY_ID and E.APPL_USER_ID = ? GROUP BY a.batch_id, a.expiry_date, trade_name, manufacturer_name, b.batch_status, a.store_code,A.STORE_DESC,c.facility_id,A.SUSPENDED_YN ORDER BY 1, 2");
		 
		 dataMap.put("SQL_ST_STORE_LOOKUP_FOR_SUSPEND_BATCH",	"SELECT     st.store_code code,  mm.short_desc  description     FROM  mm_store_lang_vw      mm, st_store st , st_acc_entity_param  WHERE    mm.eff_status ='E'  AND  language_id  like  ?   AND  mm.facility_id   LIKE ?  	 	  AND    UPPER(st.store_code)    LIKE	 UPPER(?)  AND  UPPER(mm.short_desc)   LIKE	    UPPER(?)    AND      mm.store_code=st.store_code   ORDER BY 2");
		 
		//Added by RAbbani #Bru-HIMS-CRF-111[Inc no :30070] Insert st_batch_status_upd_history on 13-AUG-13
		dataMap.put("SQL_ST_SUSPEND_INSERT_BATCH_STATUS","INSERT INTO st_batch_status_upd_history (item_code,batch_id, expiry_date_or_receipt_date,trade_id,prev_batch_status,new_batch_status,remarks,status_updated_by,status_remarks_oth, external_comp_yn,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id, modified_date, modified_at_ws_no,modified_facility_id,facility_id,store_code) VALUES(?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		
		
		dataMap.put("SQL_ST_SUSPEND_SHOW_BATCH_STATUS","SELECT  a.store_desc, a.suspended_yn FROM st_batch_search_lang_view a,st_batch_control b,mm_store_lang_vw c, st_acc_entity_param d WHERE a.item_code = b.item_code  AND a.batch_id = b.batch_id AND a.expiry_date = b.expiry_date_or_receipt_date AND a.item_code = ?  AND A.SUSPENDED_YN IN (?, ?) AND a.batch_id = ?   and A.EXPIRY_DATE = to_date(?,'dd/mm/yyyy')  AND a.language_id = c.language_id AND c.store_code = a.store_code  AND a.language_id =  ? AND DECODE (a.lang1, NULL, ?, a.lang1) = ?  AND DECODE (a.lang2, NULL, ?, a.lang2) = ? AND c.store_code LIKE ?  AND c.facility_id LIKE ? GROUP BY a.store_code, a.store_desc,a.suspended_yn");
		//Added By Ganga for RUT-CRF-0079 On Aug 1st 2013
		//dataMap.put("SQL_ST_ITEM_BATCH_TOGET_BARCODE_ITEMS", "SELECT DISTINCT ITEM_CODE FROM ST_ITEM_BATCH WHERE  STORE_CODE = ?  AND  BARCODE_ID = ? and rownum <=1" );
		dataMap.put("SQL_ST_ITEM_BATCH_GET_BARCODE_ID", "select barcode_id from st_item_batch where store_code = ?  AND item_code = ?	AND	batch_id = ?  AND bin_location_code	= ?	 AND expiry_date_or_receipt_date = TO_DATE(?,'dd/mm/yyyy')" );
		dataMap.put("SQL_ST_TRANS_APPL_FOR_BARCODE_VALIDATION_APPL", "SELECT BARCODE_APPL FROM ST_TRANS_APPL WHERE  TRN_TYPE = ?  AND  BARCODE_APPL = ? ");
		
		//Added by Rabbani #43360  on 13-SEP-2013 
		dataMap.put("SQL_ST_ITEM_REPACKING_GROUP_SELECT_LIST", "SELECT repacking_group_code, short_desc FROM st_repacking_group_lang_vw st_repacking_group WHERE  eff_status ='E'  AND language_id = ? order by short_desc");
		
		//Added by Rabbani #Inc no : 30304(Bru-HIMS-CRF-185) on 13-NOV-2013
		
		dataMap.put("SQL_ST_CEB_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.CONDEMN_ID doc_no, TO_CHAR (hdr.ADDED_DATE, 'dd/mm/yyyy') doc_date,  hdr.doc_ref, hdr.CONDEMN_HDR_REMARKS FROM ST_EXPIRED_ITEM hdr, sy_doc_type_master_lang_vw sy, mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE uacc WHERE HDR.FACILITY_ID = ? and HDR.FACILITY_ID = MM.FACILITY_ID and  hdr.doc_type_code = sy.doc_type_code AND hdr.store_code = mm.store_code AND hdr.finalized_yn = 'N' AND hdr.doc_type_code LIKE ? AND TO_CHAR (hdr.CONDEMN_ID) LIKE ?  AND TO_DATE (TO_CHAR (hdr.ADDED_DATE, 'dd/mm/yyyy'), 'dd/mm/yyyy') BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy') AND   uacc.store_code = mm.store_code AND uacc.user_id = ? AND CNDMN_EXP_BTCH_ALLOWED_YN = 'Y' AND sy.language_id = mm.language_id AND sy.language_id = ? "); 
		dataMap.put("SQL_ST_EXP_ITEM_DELETE_CONDEMN","DELETE   FROM	st_expired_item  WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? and CONDEMN_ID =	?");
		dataMap.put("SQL_ST_EXP_ITEM_UPDATE_CONDEMN","Update st_expired_item set  FINALIZED_YN ='D' WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? and CONDEMN_ID = ?");
		//dataMap.put("SQL_ST_EXPIRED_ITEM_INSERT_CONDEMN", "INSERT INTO ST_EXPIRED_ITEM (CONDEMN_ID,ITEM_CODE,STORE_CODE,BATCH_ID,BIN_LOCATION_CODE,EXPIRY_DATE_OR_RECEIPT_DATE,TRADE_ID,REPLACE_ON_EXPIRY_YN,ITEM_QTY,TRN_REMARKS_CODE,ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,FACILITY_ID,DOC_TYPE_CODE,FINALIZED_YN,CONDEMN_HDR_REMARKS,DOC_REF)	VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?)");
		//Added by Rabbani # Inc no:45705 and 45727 on 19/12/2013
		dataMap.put("SQL_ST_EXPIRED_ITEM_INSERT_CONDEMN", "INSERT INTO ST_EXPIRED_ITEM (CONDEMN_ID,ITEM_CODE,STORE_CODE,BATCH_ID,BIN_LOCATION_CODE,EXPIRY_DATE_OR_RECEIPT_DATE,TRADE_ID,REPLACE_ON_EXPIRY_YN,ITEM_QTY,TRN_REMARKS_CODE,ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,FACILITY_ID,DOC_TYPE_CODE,FINALIZED_YN,CONDEMN_HDR_REMARKS,DOC_REF,ITEM_UNIT_COST,LAST_RECEIPT_DATE)	VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,NVL(?,0),TO_DATE(?,'dd/mm/yyyy'))");
		dataMap.put("SQL_ST_ITEM_BATCH_CONDEMN", "Update ST_ITEM_BATCH set SUSPENDED_YN = ?, modified_by_id= ?, modified_date = SYSDATE, modified_at_ws_no = ?, modified_facility_id = ? where store_code=? and item_code= ? and BATCH_ID = ? and BIN_LOCATION_CODE = ? and  EXPIRY_DATE_OR_RECEIPT_DATE=to_date(?,'dd/mm/yyyy')");
		dataMap.put("SQL_ST_EXP_BATCH_CONDEMN_SQL","SELECT STORE_CODE,ITEM_CODE,BATCH_ID,BIN_LOCATION_CODE,to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy')EXPIRY_DATE  FROM ST_EXPIRED_ITEM WHERE FACILITY_ID = ? AND DOC_TYPE_CODE = ? AND  CONDEMN_ID = ?");
		//ends
		dataMap.put("SQL_ST_DISP_CURR_ENCNTR_FIN_DTL_YN"," SELECT  DISP_CURR_ENCNTR_FIN_DTL_YN  FROM  ST_USER_ACCESS_FOR_STORE WHERE STORE_CODE=? AND USER_ID=?");//Added by suresh.r 07-11-2013 against JD-CRF-156
		dataMap.put("SQL_ST_SELECT_EPISODE_VISITID","SELECT EPISODE_ID,OP_EPISODE_VISIT_NUM FROM PR_ENCOUNTER WHERE PATIENT_ID=? AND ENCOUNTER_ID=?");//Added by suresh.r #Inc no:45645(JD-CRF-156) on 16-12-2013
		//Added by suresh.r on 23-01-2014 against AMS-CRF-0054 beg
		dataMap.put("SQL_ST_ISS_RET_BASED_ON_SELECT", "SELECT ISS_RET_BASED_ON FROM ST_FACILITY_PARAM WHERE FACILITY_ID =?");
		dataMap.put("SQL_ST_FACILITY_ID_SELECT", "SELECT facility_id FROM mm_store WHERE store_code=?");
		dataMap.put("SQL_ST_ISSUE_RET_DTL_SELECT_MULTIPLE_ITEM_BASE", "SELECT   REMARKS, REMARKS_CODE, FM_STORE_CODE, DOC_NO, ITEM_CODE, ITEM_DESC, UNIT_COST, COST_VALUE, DOC_SRL_NO, ITEM_QTY, UOM_CODE, UOM_DESC, DEF_ISSUE_UOM, STOCK_UOM, /*SUM (NVL (PEND_QTY, 0)) PEND_QTY, */ SUM ((CASE WHEN (  NVL (ACK_ISSUE_QTY, ISS_QTY) - NVL (ACK_RET_QTY, RET_ITM_QTY) ) < (BATCH_QTY - BATCH_COMMT_QTY) THEN ((  NVL (ACK_ISSUE_QTY, ISS_QTY) - NVL (ACK_RET_QTY, RET_ITM_QTY)+ RET_QTY ) ) ELSE BATCH_QTY - BATCH_COMMT_QTY+ RET_QTY END )) PEND_QTY,facility_id  FROM (SELECT   (SELECT TRM.REMARKS_DESC FROM MM_TRN_REMARKS_LANG TRM WHERE DTL.REMARKS = TRM.TRN_REMARKS_CODE AND TRM.LANGUAGE_ID = ?) REMARKS, HDR.FM_STORE_CODE, DTL.DOC_NO, DTL.ITEM_CODE, MMITEM.SHORT_DESC ITEM_DESC, DTL.ITEM_UNIT_COST UNIT_COST, DTL.ITEM_COST_VALUE COST_VALUE, DTL.DOC_SRL_NO, DTL.RET_ITEM_QTY ITEM_QTY,  ACK.RECEIVED_QTY ACK_ISSUE_QTY, /*SUM (NVL (ACK1.RECEIVED_QTY, 0)) ACK_RET_QTY,*/ (ACK1.RECEIVED_QTY) ACK_RET_QTY ,  NVL (DTL_EXP.ITEM_QTY, 0) RET_QTY, (NVL (ISS_EXP.RET_ITEM_QTY, 0)) RET_ITM_QTY,NVL (STB.QTY_ON_HAND, 0) BATCH_QTY, NVL (STB.COMMITTED_QTY, 0) BATCH_COMMT_QTY, NVL (ISS_EXP.ISS_ITEM_QTY, 0) ISS_QTY, /*  (  SUM (  NVL (ACK.RECEIVED_QTY, (CASE WHEN NVL (ISS_EXP.ISS_ITEM_QTY, 0) > NVL (STB.QTY_ON_HAND, 0) THEN NVL (STB.QTY_ON_HAND, 0) ELSE NVL (ISS_EXP.ISS_ITEM_QTY, 0) END ) ) - NVL (ACK.RECEIVED_QTY, NVL (ISS_EXP.RET_ITEM_QTY, 0) ) ) + NVL (DTL_EXP.ITEM_QTY, 0) ) PEND_QTY,*/ DTL.REMARKS REMARKS_CODE, AM.UOM_CODE UOM_CODE, AM.SHORT_DESC UOM_DESC, STITM.DEF_ISSUE_UOM, AM1.SHORT_DESC STOCK_UOM, ISS_EXP.BATCH_ID ,iss_dtl.facility_id facility_id FROM ST_ISSUE_RET_DTL DTL, MM_ITEM_LANG_VW MMITEM, ST_ISSUE_DTL_EXP ISS_EXP, ST_ISSUE_RET_HDR HDR, AM_UOM_LANG_VW AM, AM_UOM_LANG_VW AM1, ST_ISSUE_DTL ISS_DTL, ST_ITEM_STORE STITM, ST_ISSUE_RET_DTL_EXP DTL_EXP, ST_ACKNOWLEDGE_TRN_DTL ACK, ST_ACKNOWLEDGE_TRN_DTL ACK1, ST_ITEM_BATCH STB,ST_ACC_ENTITY_PARAM pa WHERE MMITEM.ITEM_CODE = DTL.ITEM_CODE AND ISS_EXP.ITEM_CODE = DTL.ITEM_CODE AND (ISS_EXP.FACILITY_ID, ISS_EXP.DOC_TYPE_CODE, ISS_EXP.DOC_NO, ISS_EXP.SEQ_NO ) IN ( SELECT FACILITY_ID, DOC_TYPE_CODE, DOC_NO, SEQ_NO FROM ST_ISSUE_HDR WHERE FM_STORE_CODE = ? AND TO_STORE_CODE = ? AND FINALIZED_YN = 'Y') AND DTL.FACILITY_ID = ? AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.DOC_NO = DTL.DOC_NO AND DTL.ITEM_CODE = MMITEM.ITEM_CODE AND DTL.ITEM_CODE = STITM.ITEM_CODE AND HDR.FM_STORE_CODE = STITM.STORE_CODE AND MMITEM.GEN_UOM_CODE = AM.UOM_CODE AND AM1.UOM_CODE = STITM.DEF_ISSUE_UOM AND ISS_DTL.DOC_NO = ISS_EXP.DOC_NO AND ISS_DTL.DOC_TYPE_CODE = ISS_EXP.DOC_TYPE_CODE AND ISS_DTL.SEQ_NO = ISS_EXP.SEQ_NO AND MMITEM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = AM1.LANGUAGE_ID AND ISS_EXP.SEQ_NO = DTL_EXP.ORG_SEQ_NO(+) AND ISS_EXP.DOC_TYPE_CODE = DTL_EXP.ORG_DOC_TYPE_CODE(+) AND ISS_EXP.DOC_NO = DTL_EXP.ORG_DOC_NO(+) AND ISS_EXP.BATCH_ID = DTL_EXP.BATCH_ID(+) AND   iss_exp.expiry_date_or_receipt_date =  dtl_exp.expiry_date_or_receipt_date(+) AND iss_exp.facility_id =  decode(pa.TRN_ACROSS_FACILITY_YN,'Y',iss_exp.facility_id, dtl_exp.facility_id) AND ACK.DOC_NO(+) = ISS_EXP.DOC_NO AND ACK.DOC_TYPE_CODE(+) = ISS_EXP.DOC_TYPE_CODE AND ACK.BATCH_ID(+) = ISS_EXP.BATCH_ID AND ACK.EXPIRY_DATE_OR_RECEIPT_DATE(+) = ISS_EXP.EXPIRY_DATE_OR_RECEIPT_DATE AND ACK.DOC_SRL_NO(+) = ISS_EXP.DOC_SRL_NO AND ACK.NEW_BIN_LOCATION_CODE(+) = ISS_EXP.TO_BIN_LOCATION_CODE AND DTL.DOC_NO = DTL_EXP.DOC_NO AND DTL.DOC_TYPE_CODE = DTL_EXP.DOC_TYPE_CODE AND DTL_EXP.DOC_NO = ACK1.DOC_NO(+) AND DTL_EXP.DOC_TYPE_CODE = ACK1.DOC_TYPE_CODE(+) AND DTL_EXP.BATCH_ID = ACK1.BATCH_ID(+) AND STB.ITEM_CODE = ISS_EXP.ITEM_CODE AND STB.STORE_CODE = HDR.FM_STORE_CODE AND STB.BATCH_ID = ISS_EXP.BATCH_ID AND STB.TRADE_ID = ISS_EXP.TRADE_ID AND STB.EXPIRY_DATE_OR_RECEIPT_DATE = ISS_EXP.EXPIRY_DATE_OR_RECEIPT_DATE GROUP BY HDR.FM_STORE_CODE, DTL.DOC_NO, DTL.ITEM_CODE, MMITEM.SHORT_DESC, DTL.ITEM_UNIT_COST, DTL.ITEM_COST_VALUE, DTL.DOC_SRL_NO, DTL.RET_ITEM_QTY, DTL.REMARKS, AM.UOM_CODE,AM.SHORT_DESC, STITM.DEF_ISSUE_UOM, AM1.SHORT_DESC, DTL_EXP.ITEM_QTY, ISS_EXP.BATCH_ID, ACK.RECEIVED_QTY,ACK1.RECEIVED_QTY, ORG_SEQ_NO,STB.QTY_ON_HAND,STB.COMMITTED_QTY ,ISS_EXP.ISS_ITEM_QTY  ,ISS_EXP.RET_ITEM_QTY,iss_dtl.facility_id UNION SELECT   (SELECT TRM.REMARKS_DESC FROM MM_TRN_REMARKS_LANG TRM WHERE DTL.REMARKS = TRM.TRN_REMARKS_CODE AND TRM.LANGUAGE_ID = ?) REMARKS, HDR.FM_STORE_CODE, DTL.DOC_NO, DTL.ITEM_CODE, MMITEM.SHORT_DESC ITEM_DESC, DTL.ITEM_UNIT_COST UNIT_COST, DTL.ITEM_COST_VALUE COST_VALUE, DTL.DOC_SRL_NO, DTL.RET_ITEM_QTY ITEM_QTY,  ACK.RECEIVED_QTY ACK_ISSUE_QTY, /*SUM (NVL (ACK1.RECEIVED_QTY, 0)) ACK_RET_QTY,*/ (ACK1.RECEIVED_QTY) ACK_RET_QTY ,  NVL (DTL_EXP.ITEM_QTY, 0) RET_QTY, (NVL (ISS_EXP.RET_ITEM_QTY, 0)) RET_ITM_QTY,10000000 BATCH_QTY, 0 BATCH_COMMT_QTY, NVL (ISS_EXP.ISS_ITEM_QTY, 0) ISS_QTY, /*  (  SUM (  NVL (ACK.RECEIVED_QTY, (CASE WHEN NVL (ISS_EXP.ISS_ITEM_QTY, 0) > NVL (STB.QTY_ON_HAND, 0) THEN NVL (STB.QTY_ON_HAND, 0) ELSE NVL (ISS_EXP.ISS_ITEM_QTY, 0) END ) ) - NVL (ACK.RECEIVED_QTY, NVL (ISS_EXP.RET_ITEM_QTY, 0) ) ) + NVL (DTL_EXP.ITEM_QTY, 0) ) PEND_QTY,*/ DTL.REMARKS REMARKS_CODE, AM.UOM_CODE UOM_CODE, AM.SHORT_DESC UOM_DESC, STITM.DEF_ISSUE_UOM, AM1.SHORT_DESC STOCK_UOM, ISS_EXP.BATCH_ID ,iss_dtl.facility_id facility_id FROM ST_ISSUE_RET_DTL DTL, MM_ITEM_LANG_VW MMITEM, ST_ISSUE_DTL_EXP ISS_EXP, ST_ISSUE_RET_HDR HDR, AM_UOM_LANG_VW AM, AM_UOM_LANG_VW AM1, ST_ISSUE_DTL ISS_DTL, ST_ITEM_STORE STITM, ST_ISSUE_RET_DTL_EXP DTL_EXP, ST_ACKNOWLEDGE_TRN_DTL ACK, ST_ACKNOWLEDGE_TRN_DTL ACK1,ST_ACC_ENTITY_PARAM pa WHERE MMITEM.ITEM_CODE = DTL.ITEM_CODE AND ISS_EXP.ITEM_CODE = DTL.ITEM_CODE AND (ISS_EXP.FACILITY_ID, ISS_EXP.DOC_TYPE_CODE, ISS_EXP.DOC_NO, ISS_EXP.SEQ_NO ) IN ( SELECT FACILITY_ID, DOC_TYPE_CODE, DOC_NO, SEQ_NO FROM ST_ISSUE_HDR WHERE FM_STORE_CODE = ? AND TO_STORE_CODE = ? AND FINALIZED_YN = 'Y') AND DTL.FACILITY_ID = ? AND DTL.DOC_NO = ? AND DTL.DOC_TYPE_CODE = ? AND HDR.DOC_NO = DTL.DOC_NO AND DTL.ITEM_CODE = MMITEM.ITEM_CODE AND DTL.ITEM_CODE = STITM.ITEM_CODE AND HDR.FM_STORE_CODE = STITM.STORE_CODE AND MMITEM.GEN_UOM_CODE = AM.UOM_CODE AND AM1.UOM_CODE = STITM.DEF_ISSUE_UOM AND ISS_DTL.DOC_NO = ISS_EXP.DOC_NO AND ISS_DTL.DOC_TYPE_CODE = ISS_EXP.DOC_TYPE_CODE AND ISS_DTL.SEQ_NO = ISS_EXP.SEQ_NO AND MMITEM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = AM1.LANGUAGE_ID AND ISS_EXP.SEQ_NO = DTL_EXP.ORG_SEQ_NO(+) AND ISS_EXP.DOC_TYPE_CODE = DTL_EXP.ORG_DOC_TYPE_CODE(+) AND ISS_EXP.DOC_NO = DTL_EXP.ORG_DOC_NO(+) AND ISS_EXP.BATCH_ID = DTL_EXP.BATCH_ID(+) AND   iss_exp.expiry_date_or_receipt_date =  dtl_exp.expiry_date_or_receipt_date(+) AND iss_exp.facility_id =  decode(pa.TRN_ACROSS_FACILITY_YN,'Y',iss_exp.facility_id, dtl_exp.facility_id) AND ACK.DOC_NO(+) = ISS_EXP.DOC_NO AND ACK.DOC_TYPE_CODE(+) = ISS_EXP.DOC_TYPE_CODE AND ACK.BATCH_ID(+) = ISS_EXP.BATCH_ID AND ACK.EXPIRY_DATE_OR_RECEIPT_DATE(+) = ISS_EXP.EXPIRY_DATE_OR_RECEIPT_DATE AND ACK.DOC_SRL_NO(+) = ISS_EXP.DOC_SRL_NO AND ACK.NEW_BIN_LOCATION_CODE(+) = ISS_EXP.TO_BIN_LOCATION_CODE AND DTL.DOC_NO = DTL_EXP.DOC_NO AND DTL.DOC_TYPE_CODE = DTL_EXP.DOC_TYPE_CODE AND DTL_EXP.DOC_NO = ACK1.DOC_NO(+) AND DTL_EXP.DOC_TYPE_CODE = ACK1.DOC_TYPE_CODE(+) AND DTL_EXP.BATCH_ID = ACK1.BATCH_ID(+)  AND DTL.stock_item_yn='N' GROUP BY HDR.FM_STORE_CODE, DTL.DOC_NO, DTL.ITEM_CODE, MMITEM.SHORT_DESC, DTL.ITEM_UNIT_COST, DTL.ITEM_COST_VALUE, DTL.DOC_SRL_NO, DTL.RET_ITEM_QTY, DTL.REMARKS, AM.UOM_CODE,AM.SHORT_DESC, STITM.DEF_ISSUE_UOM, AM1.SHORT_DESC, DTL_EXP.ITEM_QTY, ISS_EXP.BATCH_ID,ACK.RECEIVED_QTY,ACK1.RECEIVED_QTY,ORG_SEQ_NO,ISS_EXP.ISS_ITEM_QTY  ,ISS_EXP.RET_ITEM_QTY,iss_dtl.facility_id  ) GROUP BY FM_STORE_CODE, DOC_NO, ITEM_CODE, ITEM_DESC, UNIT_COST, COST_VALUE, DOC_SRL_NO, ITEM_QTY, REMARKS, UOM_CODE, UOM_DESC, DEF_ISSUE_UOM, STOCK_UOM, REMARKS_CODE, facility_id ");
		dataMap.put("SQL_ST_ISSUE_RET_CALCULATE_RETUNABLE_QTY", "SELECT SUM (NVL (ack.received_qty, NVL (ide.iss_item_qty, 0))) - SUM (NVL (ack1.received_qty,NVL (ide.ret_item_qty, 0)))  pending_ret_qty FROM st_issue_dtl_exp ide, st_issue_hdr ihr, st_acknowledge_trn_dtl ack, st_acknowledge_trn_dtl ack1, st_issue_ret_dtl_exp retexp WHERE ide.facility_id = ? AND ( ide.facility_id = ihr.facility_id AND ide.doc_type_code = ihr.doc_type_code AND ide.doc_no = ihr.doc_no AND ide.seq_no = ihr.seq_no ) AND ihr.fm_store_code = ? AND ihr.to_store_code = ? AND ( ihr.finalized_yn = 'Y' OR ( ihr.process_for_acknowledge = 'Y' AND NVL (ack.received_qty, 0) > 0 )) AND ide.item_code = ? AND ack.doc_no(+) = ide.doc_no AND ack.doc_type_code(+) = ide.doc_type_code AND ack.doc_srl_no(+) = ide.doc_srl_no AND ack.item_code(+) = ide.item_code AND ack.batch_id(+) = ide.batch_id  AND ack.expiry_date_or_receipt_date(+) = ide.expiry_date_or_receipt_date AND ack.seq_no(+) = ide.seq_no AND ack.bin_location_code(+) = ide.bin_location_code AND retexp.org_doc_no(+) = ide.doc_no AND retexp.org_doc_type_code(+) = ide.doc_type_code AND retexp.org_seq_no(+) = ide.seq_no AND retexp.expiry_date_or_receipt_date(+) = ide.expiry_date_or_receipt_date AND retexp.item_code(+) = ide.item_code AND retexp.batch_id(+) = ide.batch_id AND retexp.bin_location_code(+) = ide.bin_location_code AND retexp.doc_no = ack1.doc_no(+) AND retexp.doc_type_code = ack1.doc_type_code(+) AND retexp.batch_id = ack1.batch_id(+) AND retexp.item_code = ack1.item_code(+) AND retexp.doc_srl_no = ack1.doc_srl_no(+) AND retexp.expiry_date_or_receipt_date = ack1.expiry_date_or_receipt_date(+) AND retexp.bin_location_code = ack1.bin_location_code(+)");
		//Added by suresh.r on 23-01-2014 against AMS-CRF-0054 end
		//Added by Sakti against ML-BRU-SCF-1005[IN:43173] on 28-04-2014
		dataMap.put("SQL_ST_BATCH_SEARCH_PROCESS_YN"," SELECT process_expired_items_yn,process_suspended_items_yn,use_after_expiry_yn from st_user_access_for_store,st_item where item_code = ? and store_code= ? and user_id = ?");

		//Added by Sakti for performance tuning. passing some more parameters to this query based on availability of the same from the application Inc# 51157
		dataMap.put("SQL_ST_ACKNOWLEDGMENT_TRANSACTION_QUERY_RESULT","SELECT MM.SHORT_DESC ITEM_DESC, AM.SHORT_DESC UOM_DESC, STOCK_ITEM_YN,TO_CHAR (ACKNOWLEDGE_DATE, 'DD/MM/YYYY HH24:MI:SS') ACK_DATE, ACK.DOC_TYPE_CODE,DOC_NO, ACK.ITEM_CODE, SUM(ACK.PENDING_QTY) PENDING_QTY, (SELECT SUM (ISSUE_QTY) FROM ST_ACKNOWLEDGE_TRN_DTL WHERE DOC_NO=ACK.DOC_NO AND DOC_TYPE_CODE=ACK.DOC_TYPE_CODE AND DOC_SRL_NO = ACK.DOC_SRL_NO AND SEQ_NO = ACK.SEQ_NO) ISSUE_QTY, SUM(RECEIVED_QTY) RECEIVED_QTY,SUM(REJECTED_QTY) REJECTED_QTY, ISSUING_STORE, RECEIVING_STORE, ACK.ADDED_BY_ID,CONFIRM_YN, ST1.SHORT_DESC ISS_STORE_DESC,ST2.SHORT_DESC REC_STORE_DESC, SY.SHORT_DESC DOC_TYPE_DESC,US.APPL_USER_NAME USER_NAME FROM ST_ACKNOWLEDGE_TRN_DTL_LOG ACK,ST_ITEM_STORE SIS,MM_ITEM_LANG_VW MM,AM_UOM_LANG_VW AM,MM_STORE_LANG_VW ST1,MM_STORE_LANG_VW ST2,SY_DOC_TYPE_MASTER_LANG_VW SY,SM_APPL_USER US,ST_ITEM STI WHERE SIS.STORE_CODE = ACK.ISSUING_STORE AND SIS.ITEM_CODE = ACK.ITEM_CODE AND MM.ITEM_CODE = ACK.ITEM_CODE AND MM.GEN_UOM_CODE = AM.UOM_CODE AND ST1.STORE_CODE = ACK.ISSUING_STORE AND ST2.STORE_CODE = ACK.RECEIVING_STORE AND SY.DOC_TYPE_CODE = ACK.DOC_TYPE_CODE AND ACK.ADDED_BY_ID = US.APPL_USER_ID AND STI.ITEM_CODE = ACK.ITEM_CODE AND TO_DATE (TO_CHAR (ACK.ACKNOWLEDGE_DATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'DD/MM/YYYY') AND TO_DATE (NVL (?, TO_CHAR (SYSDATE,'DD/MM/YYYY')),'DD/MM/YYYY') AND SY.LANGUAGE_ID = ? AND ST2.LANGUAGE_ID = ? AND ST1.LANGUAGE_ID = ? AND MM.LANGUAGE_ID = ? AND MM.LANGUAGE_ID = AM.LANGUAGE_ID AND (   (? = 'N' AND REJECTED_QTY <> 0) OR (? = 'Z' AND REJECTED_QTY = 0) OR (? = 'B' AND 1 = 1)) ");
		dataMap.put("SQL_ST_ACKNOWLEDGMENT_TRANSACTION_QUERY_RESULT_RESTRICT_USER_ACCESS","SELECT MM.SHORT_DESC ITEM_DESC, AM.SHORT_DESC UOM_DESC, STOCK_ITEM_YN,TO_CHAR (ACKNOWLEDGE_DATE, 'DD/MM/YYYY HH24:MI:SS') ACK_DATE, ACK.DOC_TYPE_CODE,DOC_NO, ACK.ITEM_CODE, SUM(ACK.PENDING_QTY) PENDING_QTY, (SELECT SUM (ISSUE_QTY) FROM ST_ACKNOWLEDGE_TRN_DTL WHERE DOC_NO=ACK.DOC_NO AND DOC_TYPE_CODE=ACK.DOC_TYPE_CODE AND DOC_SRL_NO = ACK.DOC_SRL_NO AND SEQ_NO = ACK.SEQ_NO) ISSUE_QTY, SUM(RECEIVED_QTY) RECEIVED_QTY,SUM(REJECTED_QTY) REJECTED_QTY, ISSUING_STORE, RECEIVING_STORE, ACK.ADDED_BY_ID,CONFIRM_YN, ST1.SHORT_DESC ISS_STORE_DESC,ST2.SHORT_DESC REC_STORE_DESC, SY.SHORT_DESC DOC_TYPE_DESC,US.APPL_USER_NAME USER_NAME FROM ST_ACKNOWLEDGE_TRN_DTL_LOG ACK,ST_ITEM_STORE SIS,MM_ITEM_LANG_VW MM,AM_UOM_LANG_VW AM,MM_STORE_LANG_VW ST1,MM_STORE_LANG_VW ST2,SY_DOC_TYPE_MASTER_LANG_VW SY,SM_APPL_USER US,ST_ITEM STI, st_acc_entity_param acc  WHERE SIS.STORE_CODE = ACK.ISSUING_STORE AND SIS.ITEM_CODE = ACK.ITEM_CODE AND MM.ITEM_CODE = ACK.ITEM_CODE AND MM.GEN_UOM_CODE = AM.UOM_CODE AND ST1.STORE_CODE = ACK.ISSUING_STORE AND ST2.STORE_CODE = ACK.RECEIVING_STORE AND SY.DOC_TYPE_CODE = ACK.DOC_TYPE_CODE AND ACK.ADDED_BY_ID = US.APPL_USER_ID AND STI.ITEM_CODE = ACK.ITEM_CODE AND TO_DATE (TO_CHAR (ACK.ACKNOWLEDGE_DATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'DD/MM/YYYY') AND TO_DATE (NVL (?, TO_CHAR (SYSDATE,'DD/MM/YYYY')),'DD/MM/YYYY') AND SY.LANGUAGE_ID = ? AND ST2.LANGUAGE_ID = ? AND ST1.LANGUAGE_ID = ? AND MM.LANGUAGE_ID = ? AND MM.LANGUAGE_ID = AM.LANGUAGE_ID AND (   (? = 'N' AND REJECTED_QTY <> 0) OR (? = 'Z' AND REJECTED_QTY = 0) OR (? = 'B' AND 1 = 1)) ");//MOHE-CRF-0084.1 
		//Added by Sakti for performance tuning. passing some more parameters to this query based on availability of the same from the application Inc# 51157
		dataMap.put("SQL_ST_ACKNOWLEDGE_TRN_DTL_LOG_COUNT","SELECT COUNT(*) COUNT FROM ST_ACKNOWLEDGE_TRN_DTL_LOG WHERE DOC_NO = ? AND DOC_TYPE_CODE = ? /*AND PENDING_QTY = ? */AND ITEM_CODE = ? AND TO_CHAR(ACKNOWLEDGE_DATE,'DD/MM/YYYY HH24:MI:SS') = TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI:SS'),'DD/MM/YYYY HH24:MI:SS') AND (REJECTED_QTY+RECEIVED_QTY) > 0 ");
		//Added by suresh.r on 16-09-2014 against Perf tuning Inc 51157 beg
		//dataMap.put("SQL_ST_BLOCKED_BATCHES_QUERY","SELECT STBV.DOC_TYPE_CODE, STBV.DOC_NO, STBV.SEQ_NO, STBV.TRN_TYPE,STBV.DOC_SRL_NO, STBV.STORE_CODE, STBV.ITEM_CODE, STBV.BATCH_ID,STBV.BIN_LOCATION_CODE,TO_CHAR (STBV.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE_OR_RECEIPT_DATE,(CASE WHEN ACK.TMP_REJECTED_QTY_2 IS NULL THEN STBV.BLOCKED_QTY ELSE (NVL(ACK.TMP_RECEIVED_QTY_2,0) + NVL(ACK.TMP_REJECTED_QTY_2,0)) END ) BLOCKED_QTY,STBV.DOC_TYPE_DESC, STBV.STORE_DESC, (CASE WHEN STBV.PROCESS_FOR_ACKNOWLEDGE = 'Y' THEN 'PA' ELSE 'NA' END) ACK_STATUS,(CASE WHEN (NVL  (ACK.TMP_REJECTED_QTY_2, 0)) > 0 THEN 'CP' ELSE 'NA' END ) ACK_STATUS2, STBV.ITEM_DESC, STBV.TRN_TYPE_DESC, STBV.BIN_DESC, TO_CHAR (STBV.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, AM.SHORT_DESC GEN_UOM_DESC,to_facility_id, fm_facility_id  FROM (SELECT * FROM (SELECT A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, A.SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ISS_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_ISSUE_HDR A, ST_ISSUE_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.SEQ_NO = B.SEQ_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, NVL((SELECT MAX(seq_no) FROM st_acknowledge_trn_dtl where facility_id = a.facility_id and doc_no = a.doc_no and doc_type_code = a.doc_type_code),0) SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID ,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_ISSUE_RET_HDR A,ST_ISSUE_RET_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, NVL((SELECT MAX(seq_no) FROM st_acknowledge_trn_dtl where facility_id = a.facility_id and doc_no = a.doc_no and doc_type_code = a.doc_type_code),0) SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_TRANSFER_HDR A,ST_TRANSFER_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID, B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_ADJ_HDR A,ST_ADJ_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE =  G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_RTV_HDR A, ST_RTV_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G  WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.SAL_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID ,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_SAL_HDR A,ST_SAL_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID, B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id  FROM ST_MFG_HDR A, ST_MFG_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE, B.GRN_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC, D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC, F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE, C.LANGUAGE_ID ,A.facility_id fm_facility_id,A.facility_id to_facility_id  FROM ST_GRN_HDR A, ST_GRN_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID  ,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_SAL_RET_HDR A,ST_SAL_RET_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID) WHERE LANGUAGE_ID = ? ) STBV, MM_ITEM_LANG_VW MM,AM_UOM_lang_vw AM,ST_ACKNOWLEDGE_TRN_DTL ACK WHERE  (to_facility_id = ? OR fm_facility_id = ?) ");
		//Modified by suresh.r on 16-10-2014 against Inc 51460
		dataMap.put("SQL_ST_BLOCKED_BATCHES_QUERY","SELECT STBV.DOC_TYPE_CODE, STBV.DOC_NO, STBV.SEQ_NO, STBV.TRN_TYPE,STBV.DOC_SRL_NO, STBV.STORE_CODE, STBV.ITEM_CODE, STBV.BATCH_ID,STBV.BIN_LOCATION_CODE,TO_CHAR (STBV.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE_OR_RECEIPT_DATE,(CASE WHEN ACK.TMP_REJECTED_QTY_2 IS NULL THEN STBV.BLOCKED_QTY ELSE (NVL(ACK.TMP_RECEIVED_QTY_2,0) + NVL(ACK.TMP_REJECTED_QTY_2,0)) END ) BLOCKED_QTY,STBV.DOC_TYPE_DESC, STBV.STORE_DESC, (CASE WHEN STBV.PROCESS_FOR_ACKNOWLEDGE = 'Y' THEN 'PA' ELSE 'NA' END) ACK_STATUS,(CASE WHEN (NVL  (ACK.TMP_REJECTED_QTY_2, 0)) > 0 THEN 'CP' ELSE 'NA' END ) ACK_STATUS2, STBV.ITEM_DESC, STBV.TRN_TYPE_DESC, STBV.BIN_DESC, TO_CHAR (STBV.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, AM.SHORT_DESC GEN_UOM_DESC,to_facility_id, fm_facility_id,STBV.MODULE_ID  FROM (SELECT * FROM (SELECT 'ST' MODULE_ID,A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, A.SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ISS_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_ISSUE_HDR A, ST_ISSUE_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.SEQ_NO = B.SEQ_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, NVL((SELECT MAX(seq_no) FROM st_acknowledge_trn_dtl where facility_id = a.facility_id and doc_no = a.doc_no and doc_type_code = a.doc_type_code),0) SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID ,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_ISSUE_RET_HDR A,ST_ISSUE_RET_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, NVL((SELECT MAX(seq_no) FROM st_acknowledge_trn_dtl where facility_id = a.facility_id and doc_no = a.doc_no and doc_type_code = a.doc_type_code),0) SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_TRANSFER_HDR A,ST_TRANSFER_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID, B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_ADJ_HDR A,ST_ADJ_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE =  G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_RTV_HDR A, ST_RTV_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G  WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT A.MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.SAL_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID ,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_SAL_HDR A,ST_SAL_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID AND NOT EXISTS (SELECT 'Y' FROM ST_ITEM_TRN_DTL WHERE FACILITY_ID = B.FACILITY_ID AND DOC_TYPE_CODE = B.DOC_TYPE_CODE AND DOC_NO = B.DOC_NO AND DOC_SRL_NO = B.DOC_SRL_NO AND ITEM_CODE = B.ITEM_CODE AND STORE_CODE = B.STORE_CODE AND BATCH_ID = B.BATCH_ID AND EXPIRY_DATE = B.EXPIRY_DATE_OR_RECEIPT_DATE AND BIN_LOCATION_CODE = B.BIN_LOCATION_CODE) UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID, B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id  FROM ST_MFG_HDR A, ST_MFG_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE, B.GRN_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC, D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC, F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE, C.LANGUAGE_ID ,A.facility_id fm_facility_id,A.facility_id to_facility_id  FROM ST_GRN_HDR A, ST_GRN_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT A.MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID  ,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_SAL_RET_HDR A,ST_SAL_RET_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID AND NOT EXISTS (SELECT 'Y' FROM ST_ITEM_TRN_DTL WHERE FACILITY_ID = B.FACILITY_ID AND DOC_TYPE_CODE = B.DOC_TYPE_CODE AND DOC_NO = B.DOC_NO AND DOC_SRL_NO = B.DOC_SRL_NO AND ITEM_CODE = B.ITEM_CODE AND STORE_CODE = B.STORE_CODE AND BATCH_ID = B.BATCH_ID AND EXPIRY_DATE = B.EXPIRY_DATE_OR_RECEIPT_DATE AND BIN_LOCATION_CODE = B.BIN_LOCATION_CODE)) WHERE LANGUAGE_ID = ? ) STBV, MM_ITEM_LANG_VW MM,AM_UOM_lang_vw AM,ST_ACKNOWLEDGE_TRN_DTL ACK WHERE  (to_facility_id = ? OR fm_facility_id = ?) ");
		dataMap.put("SQL_ST_BLOCKED_BATCHES_QUERY_RESTRICT_USER_ACCESS","SELECT STBV.DOC_TYPE_CODE, STBV.DOC_NO, STBV.SEQ_NO, STBV.TRN_TYPE,STBV.DOC_SRL_NO, STBV.STORE_CODE, STBV.ITEM_CODE, STBV.BATCH_ID,STBV.BIN_LOCATION_CODE,TO_CHAR (STBV.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE_OR_RECEIPT_DATE,(CASE WHEN ACK.TMP_REJECTED_QTY_2 IS NULL THEN STBV.BLOCKED_QTY ELSE (NVL(ACK.TMP_RECEIVED_QTY_2,0) + NVL(ACK.TMP_REJECTED_QTY_2,0)) END ) BLOCKED_QTY,STBV.DOC_TYPE_DESC, STBV.STORE_DESC, (CASE WHEN STBV.PROCESS_FOR_ACKNOWLEDGE = 'Y' THEN 'PA' ELSE 'NA' END) ACK_STATUS,(CASE WHEN (NVL  (ACK.TMP_REJECTED_QTY_2, 0)) > 0 THEN 'CP' ELSE 'NA' END ) ACK_STATUS2, STBV.ITEM_DESC, STBV.TRN_TYPE_DESC, STBV.BIN_DESC, TO_CHAR (STBV.DOC_DATE, 'DD/MM/YYYY') DOC_DATE, AM.SHORT_DESC GEN_UOM_DESC,to_facility_id, fm_facility_id,STBV.MODULE_ID  FROM (SELECT * FROM (SELECT 'ST' MODULE_ID,A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, A.SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ISS_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_ISSUE_HDR A, ST_ISSUE_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.SEQ_NO = B.SEQ_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, NVL((SELECT MAX(seq_no) FROM st_acknowledge_trn_dtl where facility_id = a.facility_id and doc_no = a.doc_no and doc_type_code = a.doc_type_code),0) SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID ,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_ISSUE_RET_HDR A,ST_ISSUE_RET_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,A.PROCESS_FOR_ACKNOWLEDGE,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',D.FACILITY_ID,A.FACILITY_ID) FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, NVL((SELECT MAX(seq_no) FROM st_acknowledge_trn_dtl where facility_id = a.facility_id and doc_no = a.doc_no and doc_type_code = a.doc_type_code),0) SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) STORE_CODE, B.ITEM_CODE, B.BATCH_ID,DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,(Select facility_id  from mm_store where store_code = a.to_store_code)to_facility_id, (Select facility_id  from mm_store where store_code = a.fm_store_code)fm_facility_id FROM ST_TRANSFER_HDR A,ST_TRANSFER_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',A.TO_STORE_CODE,B.STORE_CODE) = G.STORE_CODE AND DECODE(A.PROCESS_FOR_ACKNOWLEDGE , 'Y',B.TO_BIN_LOCATION_CODE,B.BIN_LOCATION_CODE) = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID, B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_ADJ_HDR A,ST_ADJ_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE =  G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_RTV_HDR A, ST_RTV_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C, MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G  WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT A.MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.SAL_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID ,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_SAL_HDR A,ST_SAL_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID AND NOT EXISTS (SELECT 'Y' FROM ST_ITEM_TRN_DTL WHERE FACILITY_ID = B.FACILITY_ID AND DOC_TYPE_CODE = B.DOC_TYPE_CODE AND DOC_NO = B.DOC_NO AND DOC_SRL_NO = B.DOC_SRL_NO AND ITEM_CODE = B.ITEM_CODE AND STORE_CODE = B.STORE_CODE AND BATCH_ID = B.BATCH_ID AND EXPIRY_DATE = B.EXPIRY_DATE_OR_RECEIPT_DATE AND BIN_LOCATION_CODE = B.BIN_LOCATION_CODE) UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID, B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID,A.facility_id fm_facility_id,A.facility_id to_facility_id  FROM ST_MFG_HDR A, ST_MFG_DTL_EXP B,SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT 'ST' MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE, B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE, B.GRN_ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC, D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC, F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE, C.LANGUAGE_ID ,A.facility_id fm_facility_id,A.facility_id to_facility_id  FROM ST_GRN_HDR A, ST_GRN_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D, MM_ITEM_LANG_VW E, ST_TRN_TYPE_LANG_VW F, MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID UNION SELECT A.MODULE_ID,'N' PROCESS_FOR_ACKNOWLEDGE,A.FACILITY_ID, A.DOC_TYPE_CODE, A.DOC_NO, 0 SEQ_NO, A.TRN_TYPE,B.DOC_SRL_NO, B.STORE_CODE, B.ITEM_CODE, B.BATCH_ID,B.BIN_LOCATION_CODE, B.EXPIRY_DATE_OR_RECEIPT_DATE,B.ITEM_QTY BLOCKED_QTY, C.SHORT_DESC DOC_TYPE_DESC,D.SHORT_DESC STORE_DESC, E.SHORT_DESC ITEM_DESC,F.SHORT_DESC TRN_TYPE_DESC, G.SHORT_DESC BIN_DESC, A.DOC_DATE,C.LANGUAGE_ID  ,A.facility_id fm_facility_id,A.facility_id to_facility_id FROM ST_SAL_RET_HDR A,ST_SAL_RET_DTL_EXP B, SY_DOC_TYPE_MASTER_LANG_VW C,MM_STORE_LANG_VW D,MM_ITEM_LANG_VW E,ST_TRN_TYPE_LANG_VW F,MM_BIN_LOCATION_LANG_VW G WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_NO = B.DOC_NO AND A.FINALIZED_YN = 'N' AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.STORE_CODE = D.STORE_CODE AND B.ITEM_CODE = E.ITEM_CODE AND A.TRN_TYPE = F.TRN_TYPE AND B.STORE_CODE = G.STORE_CODE AND B.BIN_LOCATION_CODE = G.BIN_LOCATION_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID AND NOT EXISTS (SELECT 'Y' FROM ST_ITEM_TRN_DTL WHERE FACILITY_ID = B.FACILITY_ID AND DOC_TYPE_CODE = B.DOC_TYPE_CODE AND DOC_NO = B.DOC_NO AND DOC_SRL_NO = B.DOC_SRL_NO AND ITEM_CODE = B.ITEM_CODE AND STORE_CODE = B.STORE_CODE AND BATCH_ID = B.BATCH_ID AND EXPIRY_DATE = B.EXPIRY_DATE_OR_RECEIPT_DATE AND BIN_LOCATION_CODE = B.BIN_LOCATION_CODE)) WHERE LANGUAGE_ID = ? ) STBV, MM_ITEM_LANG_VW MM,AM_UOM_lang_vw AM,ST_ACKNOWLEDGE_TRN_DTL ACK, st_acc_entity_param acc WHERE  (to_facility_id = ? OR fm_facility_id = ?) ");//MOHE-CRF-0084.1
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_COUNT_QUERY","SELECT COUNT(*) COUNT FROM ST_ACKNOWLEDGE_TRN_DTL WHERE DOC_NO = ? AND DOC_TYPE_CODE = ? AND SEQ_NO = ? OR (RECEIVED_QTY IS NULL AND REJECTED_QTY IS NULL AND TMP_RECEIVED_QTY_1 IS NULL AND TMP_REJECTED_QTY_1 IS NULL)");
		dataMap.put("ST_SQL_ST_ACKNOWLEDGE_TRN_DETAIL_QUERY","SELECT MM.SHORT_DESC ITEM_DESC,AM.SHORT_DESC UOM_DESC,BIN.SHORT_DESC BIN_LOCATION,LOG.RECEIVED_QTY,LOG.REJECTED_QTY,LOG.ITEM_CODE, LOG.BATCH_ID, LOG.BIN_LOCATION_CODE, LOG.REMARKS,TO_CHAR(LOG.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXP_DATE FROM ST_ACKNOWLEDGE_TRN_DTL_LOG LOG,MM_ITEM_LANG_VW MM,AM_UOM_LANG_VW AM,MM_BIN_LOCATION_LANG_VW BIN WHERE DOC_NO = ? AND DOC_TYPE_CODE = ? /*AND PENDING_QTY = ? */AND LOG.ITEM_CODE = ? AND LOG.ITEM_CODE = MM.ITEM_CODE AND LOG.BIN_LOCATION_CODE =  BIN.BIN_LOCATION_CODE AND MM.GEN_UOM_CODE = AM.UOM_CODE AND MM.LANGUAGE_ID = ? AND AM.LANGUAGE_ID = ? AND BIN.LANGUAGE_ID = ? AND LOG.ISSUING_STORE = BIN.STORE_CODE AND TO_CHAR(ACKNOWLEDGE_DATE,'DD/MM/YYYY HH24:MI:SS') = TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI:SS'),'DD/MM/YYYY HH24:MI:SS') AND (REJECTED_QTY+RECEIVED_QTY) > 0 ORDER BY EXP_DATE");
		//Added by suresh.r on 16-09-2014 against Perf tuning Inc 51157 end
		//Added by suresh.r on 03-03-2015 against MMS-QH-CRF-0205 Inc 52253
		dataMap.put("SQL_ST_STOCK_BASE_UOM_SELECT","SELECT ST.DEF_ISSUE_UOM STOCK_UOM,MM.GEN_UOM_CODE BASE_UOM  FROM ST_ITEM_STORE ST ,MM_ITEM MM WHERE ST.ITEM_CODE=MM.ITEM_CODE AND ST.ITEM_CODE = ? AND ST.STORE_CODE = ?");
		dataMap.put("SQL_ALLOW_EQVL_UOMS_PHY_INV_ENTRY_YN","SELECT ALLOW_EQVL_UOMS_PHY_INV_ENTRY FROM ST_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_ST_PHYSICAL_INV_INSERT_DTL_ALLOW_EQL_UOM","INSERT INTO ST_PHY_INV_DTL(FACILITY_ID,PHY_INV_ID,STORE_CODE,ITEM_CODE,BATCH_ID,STOCK_ITEM_YN,ITEM_QTY,EXPIRY_DATE_OR_RECEIPT_DATE,BIN_LOCATION_CODE,TRADE_ID,NEW_BATCH_YN,ITEM_VALUE,ENTRY_COMPLETED_YN,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,PHY_UOM_CODE,PHY_UOM_ITEM_QTY) VALUES(?,?,?,?,?,'Y',?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_ST_PHY_UOM_SELECT","SELECT   uom_code, short_desc FROM am_uom_lang_vw,st_item_store WHERE language_id = ? and uom_code=DEF_ISSUE_UOM  and item_code=? and store_code=?  UNION SELECT   uom_code, short_desc   FROM am_uom_lang_vw WHERE uom_code = ? AND language_id = ? UNION  SELECT eqvl_uom_code, short_desc FROM MM_ITEM_UOM_DEFN a, am_uom_lang_vw b WHERE a.uom_code = ? AND a.eqvl_uom_code = b.uom_code AND a.eff_status = 'E' AND b.language_id = ? AND item_code = ? ORDER BY short_desc");
		//Added by B.Badmavathi on HSA_CRF-0220
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ZERO_FOR_NORECORD_NEW","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE  AND A.ITEM_CODE=D.ITEM_CODE AND A.ITEM_CODE IN (@) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) /*AND A.PHY_INV_ID IS NULL */AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ZERO_FOR_OVERLAP_NEW","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND  A.ITEM_CODE=D.ITEM_CODE AND A.ITEM_CODE IN (@) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_NON_ZERO_FOR_NORECORD_NEW","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND  A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND A.ITEM_CODE IN (@) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) /*AND A.PHY_INV_ID IS NULL */AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_NON_ZERO_FOR_OVERLAP_NEW","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F  WHERE A.ITEM_CODE=B.ITEM_CODE AND  A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND  A.ITEM_CODE IN (@) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ALL_FOR_NORECORD_NEW","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F  WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND A.ITEM_CODE IN (@) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) /*AND A.PHY_INV_ID IS NULL */AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ALL_FOR_OVERLAP_NEW","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F  WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND A.ITEM_CODE IN (@) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND  (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ZERO_FOR_NORECORD","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) /*AND A.PHY_INV_ID IS NULL */AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ZERO_FOR_OVERLAP","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) = 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_NON_ZERO_FOR_NORECORD","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) /*AND A.PHY_INV_ID IS NULL */AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_NON_ZERO_FOR_OVERLAP","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) > 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ALL_FOR_NORECORD","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) /*AND A.PHY_INV_ID IS NULL */AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_COUNT_ALL_FOR_OVERLAP","SELECT COUNT(*) COUNT FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D,ST_ITEM_TRN_DTL E, st_item_store_bin_locn F WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) and (F.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999))AND NVL(A.QTY_ON_HAND,0) >= 0 AND E.STORE_CODE = C.STORE_CODE AND E.ITEM_CODE = A.ITEM_CODE AND A.STORE_CODE = F.STORE_CODE AND A.ITEM_CODE = F.ITEM_CODE AND F.EFF_STATUS='Y'");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ZERO_TEMP","SELECT DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D, st_item_store_bin_locn E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (E.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) and (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND  A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND E.EFF_STATUS='Y' ORDER BY A.STORE_CODE,A.ITEM_CODE");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_NON_ZERO_TEMP","SELECT DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D, st_item_store_bin_locn E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (E.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) and (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND  A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND E.EFF_STATUS='Y' ORDER BY A.STORE_CODE,A.ITEM_CODE");
		dataMap.put("SQL_ST_PRINT_COUNT_PHY_INV_HDR_SELECT_ALL_TEMP","SELECT DISTINCT ? FACILITY_ID, ? PHY_INV_ID, ? ADDED_BY_ID,SYSDATE ADDED_DATE, ? ADDED_AT_WS_NO, ? ADDED_FACILITY_ID, ? MODIFIED_BY_ID,SYSDATE MODIFIED_DATE, ? MODIFIED_AT_WS_NO, ? MODIFIED_FACILITY_ID, A.STORE_CODE STORE_CODE, A.ITEM_CODE ITEM_CODE FROM ST_ITEM_STORE A, ST_ITEM B,ST_STORE C, MM_ITEM D, st_item_store_bin_locn E WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=C.STORE_CODE AND A.ITEM_CODE=D.ITEM_CODE AND (A.ITEM_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (C.STORE_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) and (E.BIN_LOCATION_CODE between NVL(?,'!') and NVL(?,'~')) AND (D.ITEM_CLASS_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (D.ALPHA_CODE BETWEEN NVL(?,'!') AND NVL(?,'~')) AND (NVL(D.UNIT_COST,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND A.PHY_INV_ID IS NULL AND A.STOCK_ITEM_YN='Y' AND C.VAR_ALLOWED_YN='Y' AND NVL(B.PHY_INV_TYPE,'%') LIKE NVL(?,'%') AND B.PHY_INV_COUNT_PER_YEAR=NVL(?,B.PHY_INV_COUNT_PER_YEAR) AND B.EXPIRY_YN LIKE DECODE(?,'A','%',?) AND NVL(D.ITEM_ANAL1_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL1_CODE,'*')) AND NVL(D.ITEM_ANAL2_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL2_CODE,'*')) AND NVL(D.ITEM_ANAL3_CODE,'*') = NVL(?,NVL(D.ITEM_ANAL3_CODE,'*')) AND B.ABC_CLASS_CODE = NVL(?,B.ABC_CLASS_CODE) AND (NVL(A.ITEM_VALUE,0) BETWEEN NVL(?,0) AND NVL(?,999999999999)) AND  A.STORE_CODE = E.STORE_CODE AND A.ITEM_CODE = E.ITEM_CODE AND E.EFF_STATUS='Y' ORDER BY A.STORE_CODE,A.ITEM_CODE");
		//Added ends
		//Added by B.Badmavathi against ML-BRU-SCF-1555 
		dataMap.put("SQL_ST_REQUEST_HDR_STATUS_ISS_AUTH_UPDATE","UPDATE st_request_hdr	SET	 modified_by_id	= ?	, modified_date	= sysdate ,	modified_at_ws_no =	? ,	modified_facility_id = ?  WHERE	doc_type_code = ?	AND	doc_no = ?");
		//Added by suresh.r on 04-05-2015 against Inc 53228	AMS-SCF-0333 beg
		//dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_QUERY","SELECT   item_code, store_code, store_desc, SUM (NVL (qty_on_hand, 0)) qty_on_hand, stock_item_yn, bin_location_code, bin_desc, DECODE (TRIM (TO_CHAR (NVL (reorder_level, '0'), '999,999,999,999,999,999,999' ) ), '0', '', TRIM (TO_CHAR (NVL (reorder_level, '0'), '999,999,999,999,999,999,999' ))) reorder_level, item_value,sum(item_value_new) item_value_new, SUM (  NVL (qty_on_hand, 0)  - NVL (committed_qty, 0)),DECODE (?,'Y', SUM (NVL (qty_on_hand, 0) - NVL (committed_qty, 0)), SUM (DECODE (suspended_yn, 'N', qty_on_hand, 0)) - SUM (DECODE (suspended_yn, 'N', committed_qty, 0))) available_qty, stock_uom_desc,facility_id ,facility_name FROM (SELECT distinct h.batch_id, a.item_code item_code, a.store_code store_code, b.short_desc store_desc, h.qty_on_hand, a.stock_item_yn stock_item_yn, a.bin_location_code, c.short_desc bin_desc, a.reorder_level, a.item_value,(h.qty_on_hand*ST_DISPLAY_UNIT_COST(a.item_code,sysdate,'CURRENT_STOCK'))item_value_new, h.committed_qty, g.short_desc stock_uom_desc,h.expiry_date_or_receipt_date ,h.SUSPENDED_YN,b.facility_id facility_id,(SELECT facility_name FROM sm_facility_param_lang_vw vw  WHERE vw.facility_id = b.facility_id AND language_id = ?) facility_name FROM st_item_store a, mm_store_lang_vw b, mm_bin_location_lang_vw c, st_store e, mm_item_lang_vw f, am_uom g, st_item_batch h, st_acc_entity_param i, st_item j WHERE a.store_code = b.store_code AND a.store_code = c.store_code(+) AND a.bin_location_code = c.bin_location_code(+) AND a.item_code = ? AND b.store_code = e.store_code AND e.store_type_flag != 'N' AND c.language_id(+) = ? AND b.language_id = ? AND b.language_id = f.language_id AND a.item_code = f.item_code AND a.def_issue_uom = g.uom_code AND b.facility_id LIKE ? AND e.store_code BETWEEN NVL (UPPER (?), '!') AND NVL (UPPER (?), '~') AND (   (? = 'Z' AND a.qty_on_hand = 0) OR (? = 'S' AND a.qty_on_hand > 0) OR (? = 'B' AND a.qty_on_hand < NVL (a.reorder_level, '0') ) OR ? = 'A' ) AND a.store_code = h.store_code(+) AND a.item_code = h.item_code(+) and exists (select 'Y' from st_user_access_for_store where store_code = e.store_Code and user_id = DECODE (i.restrict_view_stk_status, 'ALL', user_id, ? )) AND j.item_code = a.item_code AND (   expiry_yn = 'N'    OR (    expiry_yn = 'Y' AND (   (    /* use_after_expiry_yn = 'Y' AND */ ('Y' = 'Y') ) OR decode(a.qty_on_hand,0,sysdate,expiry_date_or_receipt_date) >= TRUNC (NVL (TO_DATE ('', 'dd/mm/yyyy'), SYSDATE ) ) )))) GROUP BY item_code, store_code, store_desc, stock_item_yn, bin_location_code, bin_desc, reorder_level, item_value, stock_uom_desc ,facility_id ,facility_name ORDER BY store_desc, qty_on_hand, item_value ");
		//Modified for ML-MMOH-SCF-0355 on 08/03/2016 by B.Badmavathi - added eff_Status for st_item_store and mm_store
		//dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_QUERY","SELECT   item_code, store_code, store_desc, SUM (NVL (qty_on_hand, 0)) qty_on_hand, stock_item_yn, bin_location_code, bin_desc, DECODE (TRIM (TO_CHAR (NVL (reorder_level, '0'), '999,999,999,999,999,999,999' ) ), '0', '', TRIM (TO_CHAR (NVL (reorder_level, '0'), '999,999,999,999,999,999,999' ))) reorder_level, item_value,sum(item_value_new) item_value_new, SUM (  NVL (qty_on_hand, 0)  - NVL (committed_qty, 0)),DECODE (?,'Y', SUM (NVL (qty_on_hand, 0) - NVL (committed_qty, 0)), SUM (DECODE (suspended_yn, 'N', qty_on_hand, 0)) - SUM (DECODE (suspended_yn, 'N', committed_qty, 0))) available_qty, stock_uom_desc,facility_id ,facility_name FROM (SELECT  h.batch_id, a.item_code item_code, a.store_code store_code, b.short_desc store_desc, h.qty_on_hand, a.stock_item_yn stock_item_yn, a.bin_location_code, c.short_desc bin_desc, a.reorder_level, a.item_value,(h.qty_on_hand*ST_DISPLAY_UNIT_COST(a.item_code,sysdate,'CURRENT_STOCK'))item_value_new, h.committed_qty, g.short_desc stock_uom_desc,h.expiry_date_or_receipt_date ,h.SUSPENDED_YN,b.facility_id facility_id,(SELECT facility_name FROM sm_facility_param_lang_vw vw  WHERE vw.facility_id = b.facility_id AND language_id = ?) facility_name FROM st_item_store a, mm_store_lang_vw b, mm_bin_location_lang_vw c, st_store e, mm_item_lang_vw f, am_uom g, st_item_batch h, st_acc_entity_param i, st_item j WHERE  A.EFF_STATUS = 'E' and B.EFF_STATUS = 'E' and a.store_code = b.store_code AND a.store_code = c.store_code(+) AND a.bin_location_code = c.bin_location_code(+) AND a.item_code = ? AND b.store_code = e.store_code AND e.store_type_flag != 'N' AND c.language_id(+) = ? AND b.language_id = ? AND b.language_id = f.language_id AND a.item_code = f.item_code AND a.def_issue_uom = g.uom_code AND b.facility_id LIKE ? AND e.store_code BETWEEN NVL (UPPER (?), '!') AND NVL (UPPER (?), '~') AND (   (? = 'Z' AND a.qty_on_hand = 0) OR (? = 'S' AND a.qty_on_hand > 0) OR (? = 'B' AND a.qty_on_hand < NVL (a.reorder_level, '0') ) OR ? = 'A' ) AND a.store_code = h.store_code(+) AND a.item_code = h.item_code(+) and exists (select 'Y' from st_user_access_for_store where store_code = e.store_Code and user_id = DECODE (i.restrict_view_stk_status, 'ALL', user_id, ? )) AND j.item_code = a.item_code AND (   expiry_yn = 'N'    OR (    expiry_yn = 'Y' AND (   (    /* use_after_expiry_yn = 'Y' AND */ ('Y' = 'Y') ) OR decode(a.qty_on_hand,0,sysdate,expiry_date_or_receipt_date) >= TRUNC (NVL (TO_DATE ('', 'dd/mm/yyyy'), SYSDATE ) ) )))) GROUP BY item_code, store_code, store_desc, stock_item_yn, bin_location_code, bin_desc, reorder_level, item_value, stock_uom_desc ,facility_id ,facility_name ORDER BY store_desc, qty_on_hand, item_value ");//mODIFIED FOR IN:073185
		dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_QUERY","SELECT   item_code, store_code, store_desc, SUM (NVL (qty_on_hand, 0)) qty_on_hand, stock_item_yn, bin_location_code, bin_desc, DECODE (TRIM (TO_CHAR (NVL (reorder_level, '0'), '999,999,999,999,999,999,999' ) ), '0', '', TRIM (TO_CHAR (NVL (reorder_level, '0'), '999,999,999,999,999,999,999' ))) reorder_level, item_value,sum(item_value_new) item_value_new, SUM (  NVL (qty_on_hand, 0)  - NVL (committed_qty, 0)),DECODE (?,'Y', SUM (NVL (qty_on_hand, 0) - NVL (committed_qty, 0)), SUM (DECODE (suspended_yn, 'N', qty_on_hand, 0)) - SUM (DECODE (suspended_yn, 'N', committed_qty, 0))) available_qty, stock_uom_desc,facility_id ,facility_name FROM (SELECT  h.batch_id, a.item_code item_code, a.store_code store_code, b.short_desc store_desc, h.qty_on_hand, a.stock_item_yn stock_item_yn, a.bin_location_code, c.short_desc bin_desc, a.reorder_level, a.item_value,(h.qty_on_hand*ST_DISPLAY_UNIT_COST(a.item_code,sysdate,'CURRENT_STOCK'))item_value_new, h.committed_qty, g.short_desc stock_uom_desc,h.expiry_date_or_receipt_date ,h.SUSPENDED_YN,b.facility_id facility_id,(SELECT facility_name FROM sm_facility_param_lang_vw vw  WHERE vw.facility_id = b.facility_id AND language_id = ?) facility_name FROM st_item_store a, mm_store_lang_vw b, mm_bin_location_lang_vw c, st_store e, mm_item_lang_vw f, am_uom g, st_item_batch h, st_item j WHERE  A.EFF_STATUS = 'E' and B.EFF_STATUS = 'E' and a.store_code = b.store_code AND a.store_code = c.store_code(+) AND a.bin_location_code = c.bin_location_code(+) AND a.item_code = ? AND b.store_code = e.store_code AND e.store_type_flag != 'N' AND c.language_id(+) = ? AND b.language_id = ? AND b.language_id = f.language_id AND a.item_code = f.item_code AND a.def_issue_uom = g.uom_code AND b.facility_id LIKE ? AND e.store_code BETWEEN NVL (UPPER (?), '!') AND NVL (UPPER (?), '~') AND (   (? = 'Z' AND a.qty_on_hand = 0) OR (? = 'S' AND a.qty_on_hand > 0) OR (? = 'B' AND a.qty_on_hand < NVL (a.reorder_level, '0') ) OR ? = 'A' ) AND a.store_code = h.store_code(+) AND a.item_code = h.item_code(+) and exists (select 'Y' from st_user_access_for_store where store_code = e.store_Code and user_id = nvl(?, user_id)) AND j.item_code = a.item_code AND (   expiry_yn = 'N'    OR (    expiry_yn = 'Y' AND (   (    /* use_after_expiry_yn = 'Y' AND */ ('Y' = 'Y') ) OR decode(a.qty_on_hand,0,sysdate,expiry_date_or_receipt_date) >= TRUNC (NVL (TO_DATE ('', 'dd/mm/yyyy'), SYSDATE ) ) )))) GROUP BY item_code, store_code, store_desc, stock_item_yn, bin_location_code, bin_desc, reorder_level, item_value, stock_uom_desc ,facility_id ,facility_name ORDER BY store_desc, qty_on_hand, item_value ");//MODIFIED FOR IN:073185 - MOHE-ICN-0015 
		dataMap.put("SQL_ST_STOCK_STATUS_BY_STORE_QUERY","SELECT DISTINCT x.store_code, store_desc, itm_code, item_desc, stock_item_yn,qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom,unit_cost, item_value, avail_qty, base_uom_qoh, issue_uom_avl, reorder_level,facility_id, facility_name,base_unit_cost,item_value_new FROM (SELECT   store_code, store_desc,  itm_code, item_desc, stock_item_yn, qty_on_hand, gen_uom_code, uom_desc, def_issue_uom, issue_uom, unit_cost,base_unit_cost, item_value, (SUM (  avail_qty ) ) avail_qty, ((SUM (  avail_qty ) )  * base_unit_cost ) item_value_new, base_uom_qoh,ROUND (NVL(  (SUM (  avail_qty) ) / NVL ((st_get_uom_conv_fac_sing_str (itm_code, store_code ) ), 1 ),0 ), 4 ) issue_uom_avl, reorder_level,facility_id, facility_name FROM (SELECT   a.store_code, b.short_desc store_desc, a.item_code itm_code, c.short_desc item_desc, a.stock_item_yn,NVL (a.qty_on_hand, 0) qty_on_hand, c.gen_uom_code gen_uom_code, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = c.gen_uom_code AND language_id = ?) uom_desc, a.def_issue_uom def_issue_uom, TRIM (st_display_cost_decimals (a.item_code, a.store_code ) ) unit_cost,TRIM(ST_DISPLAY_UNIT_COST(a.item_code,sysdate,'CURRENT_STOCK'))base_unit_cost, item_value, (SELECT short_desc FROM am_uom_lang_vw WHERE uom_code = a.def_issue_uom AND language_id = ?) issue_uom, stb.qty_on_hand bt_qty_on_hand, stb.committed_qty committed_qty,  (  NVL (stb.qty_on_hand, 0)  - NVL (stb.committed_qty, 0)  ) avail_qty, NVL (  NVL (a.qty_on_hand, 0) * NVL ((st_get_uom_conv_fac_sing_str (a.item_code, a.store_code ) ), 1 ), 0 ) base_uom_qoh, a.reorder_level reorder_level,b.facility_id facility_id, (SELECT facility_name FROM sm_facility_param_lang_vw vw WHERE  vw.facility_id = b.facility_id AND language_id = ?) facility_name FROM st_item_store a, mm_store_lang_vw b, mm_item_lang_vw c, st_store e, st_item_batch stb, st_item k WHERE a.store_code = b.store_code AND a.item_code = c.item_code AND a.store_code BETWEEN ? AND ? AND a.item_code = NVL (?, a.item_code) "); //ST_DISPLAY_UNIT_COST avoided as already taken once and same value can be utilized - MOHE-ICN-0015 
		//dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_CONS_QUERY","SELECT   move_month, move_year,  ST_DISPLAY_DECIMALS((-1 * (SUM (  NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0) ) )),'N') consumption_qty, /*DECODE ((  -1 * (SUM (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0) ) )), '.00', '0.00', (  -1 * (SUM (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0) ) ) ) ) consumption_cost*/ (st_display_decimals ((  -1 * (SUM (  NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))),'N')*st_display_unit_cost(?,LAST_DAY (TO_DATE (move_month || '/' || move_year, 'mm/yyyy')),'CURRENT_STOCK'))consumption_cost FROM (SELECT distinct a.move_month move_month, a.move_year move_year, a.cons_qty cons_qty, a.sal_qty sal_qty, a.srt_qty srt_qty, a.cons_cost cons_cost, a.sal_cost sal_cost, a.srt_cost srt_cost from st_item_move_summ a, st_acc_entity_param b WHERE a.item_code = ? AND a.facility_id LIKE ? AND a.store_code BETWEEN NVL (UPPER (?), '!') AND NVL (UPPER (?), '~') AND exists (select 'Y' from st_user_access_for_store where store_code = a.store_code and user_id = DECODE( b.restrict_view_stk_status, 'ALL', user_id, ? ))) GROUP BY move_year, move_month   HAVING (SUM (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0))) != 0 OR (SUM (NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) != 0 ORDER BY move_year DESC, move_month DESC ");
		//Modified by B.Badmavathi on 21/03/2016 against ML-MMOH-SCF-0364 Inc 059650 - Added store_Code in sub query
		dataMap.put("SQL_ST_STOCK_STATUS_BY_ITEM_CONS_QUERY","SELECT   move_month, move_year,  ST_DISPLAY_DECIMALS((-1 * (SUM (  NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0) ) )),'N') consumption_qty, /*DECODE ((  -1 * (SUM (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0) ) )), '.00', '0.00', (  -1 * (SUM (  NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0) ) ) ) ) consumption_cost*/ (st_display_decimals ((  -1 * (SUM (  NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0)))),'N')*st_display_unit_cost(?,LAST_DAY (TO_DATE (move_month || '/' || move_year, 'mm/yyyy')),'CURRENT_STOCK'))consumption_cost FROM (SELECT distinct a.store_code, a.move_month move_month, a.move_year move_year, a.cons_qty cons_qty, a.sal_qty sal_qty, a.srt_qty srt_qty, a.cons_cost cons_cost, a.sal_cost sal_cost, a.srt_cost srt_cost from st_item_move_summ a, st_acc_entity_param b WHERE a.item_code = ? AND a.facility_id LIKE ? AND a.store_code BETWEEN NVL (UPPER (?), '!') AND NVL (UPPER (?), '~') AND exists (select 'Y' from st_user_access_for_store where store_code = a.store_code and user_id = DECODE( b.restrict_view_stk_status, 'ALL', user_id, ? ))) GROUP BY move_year, move_month   HAVING (SUM (NVL (cons_qty, 0) + NVL (sal_qty, 0) + NVL (srt_qty, 0))) != 0 OR (SUM (NVL (cons_cost, 0) + NVL (sal_cost, 0) + NVL (srt_cost, 0))) != 0 ORDER BY move_year DESC, move_month DESC ");
		/*GHL-CRF-0557 STARTS*/
		dataMap.put("SQL_ST_SALES_HISTORY_QUERY","SELECT DISTINCT a.doc_type_code, (select short_desc from sy_doc_type_master_lang_vw where doc_type_code = a.doc_type_code and language_id= ?) doc_type_desc, a.doc_no,b.doc_srl_no,TO_CHAR (a.doc_date, 'dd/mm/yyyy') doc_date, a.store_code,(select short_desc from mm_store_lang_vw where store_code=a.store_code and language_id= ?) store_desc, b.item_code, e.short_desc item_desc,a.patient_id, f.patient_name,(CASE WHEN a.sal_trn_type = 'X'  THEN (SELECT patient_name  FROM  st_sal_hdr  WHERE  patient_id = a.patient_id AND DOC_NO= a.doc_no AND doc_type_code = a.doc_type_code) END)  patient_name1, b.item_qty sale_qty,(CASE WHEN a.module_id = 'ST' OR a.module_id = 'OT'  THEN ROUND (NVL (b.gross_charge_amt, 0), 2) WHEN a.module_id = 'PH' THEN ST_DISPLAY_SALE_ITEM_VALUE(a.facility_id,b.doc_type_code,b.doc_no,b.doc_srl_no,a.patient_id,b.item_code) END ) gross_charge_amt, ROUND (NVL (b.item_sal_value, 0), 2) item_sal_value, ROUND (NVL (b.item_cost_value, 0), 2) item_cost_value, ROUND ((  (  b.item_qty * (st_display_unit_cost(b.item_code,a.modified_date))) * st_get_uom_conv_fac_sing_str (b.item_code, a.store_code)),3) item_cost_value_new, a.sal_trn_type, b.take_home_yn, NVL (b.sale_req_qty, 0) sale_req_qty, (CASE WHEN (NVL (b.sale_req_qty, 0) - b.item_qty) < 0 THEN 0 ELSE (NVL (b.sale_req_qty, 0) - b.item_qty) END ) pen_sal_req_qty,a.added_by_id,TO_CHAR (a.ADDED_DATE, 'DD/MM/YYYY HH24:MI:SS') ADDED_DATE FROM st_sal_hdr a, st_sal_dtl b, mm_item e, mp_patient f WHERE a.facility_id = b.facility_id  AND a.doc_type_code = b.doc_type_code AND a.doc_no = b.doc_no AND b.item_code = e.item_code AND a.patient_id = f.patient_id AND a.facility_id = ? AND a.finalized_yn = 'Y' AND  a.doc_date BETWEEN to_date(?,'dd/mm/yyyy') AND to_date (?,'dd/mm/yyyy')  "); //Modified for AMS-SCF-0970
		dataMap.put("SQL_ST_SALES_HISTORY_QUERY1","SELECT DISTINCT a.doc_type_code, (select short_desc from sy_doc_type_master_lang_vw where doc_type_code = a.doc_type_code and language_id= ?) doc_type_desc, a.doc_no,b.doc_srl_no,TO_CHAR (a.doc_date, 'dd/mm/yyyy') doc_date, a.store_code,(select short_desc from mm_store_lang_vw where store_code=a.store_code and language_id= ?) store_desc, b.item_code, e.short_desc item_desc,a.patient_id, f.patient_name,(CASE WHEN a.sal_trn_type = 'X'  THEN (SELECT patient_name  FROM  st_sal_hdr  WHERE  patient_id = a.patient_id AND DOC_NO= a.doc_no AND doc_type_code = a.doc_type_code) END)  patient_name1, b.item_qty sale_qty,ST_DISPLAY_SALE_ITEM_VALUE(a.facility_id,b.doc_type_code,b.doc_no,b.doc_srl_no,a.patient_id,b.item_code)gross_charge_amt, ROUND (NVL (b.item_sal_value, 0), 2) item_sal_value, ROUND (NVL (b.item_cost_value, 0), 2) item_cost_value, ROUND ((  (  b.item_qty * (st_display_unit_cost(b.item_code,a.modified_date))) * st_get_uom_conv_fac_sing_str (b.item_code, a.store_code)),3) item_cost_value_new, a.sal_trn_type, b.take_home_yn, NVL (b.sale_req_qty, 0) sale_req_qty, (CASE WHEN (NVL (b.sale_req_qty, 0) - b.item_qty) < 0 THEN 0 ELSE (NVL (b.sale_req_qty, 0) - b.item_qty) END ) pen_sal_req_qty,a.added_by_id,TO_CHAR (a.ADDED_DATE, 'DD/MM/YYYY HH24:MI:SS') ADDED_DATE FROM st_sal_hdr a, st_sal_dtl b, mm_item e, mp_patient f WHERE a.facility_id = b.facility_id  AND a.doc_type_code = b.doc_type_code AND a.doc_no = b.doc_no AND b.item_code = e.item_code AND a.patient_id = f.patient_id AND a.facility_id = ? AND a.finalized_yn = 'Y' AND  a.doc_date BETWEEN to_date(?,'dd/mm/yyyy') AND to_date (?,'dd/mm/yyyy')  "); //Modified for AMS-SCF-0970
		/*GHL-CRF-00557 ENDS*/
		//Added by suresh.r on 04-05-2015 against Inc 53228	AMS-SCF-0333 end
		//Added for ML-MMOH-CRF-0448 [IN:57461] by B.Badmavathi on 04/02/2016 Starts
		dataMap.put("SQL_QRY_ST_PRT_STORE_SELECT","SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st WHERE	mm.store_code=st.store_code	AND	mm.eff_status='E' AND (st.prt_allowed_yn='Y' OR st.PRT_FINALIZE_ALLOWED_YN ='Y') AND	mm.facility_id=? AND st.user_id=? AND mm.language_id = ? ORDER	BY 2");
		dataMap.put("SQL_ST_PROD_TRANS_HDR_QUERY_RESULT","SELECT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.store_code, mm.short_desc store_desc, hdr.doc_ref,hdr.PREPARE_LOCATION_CODE,(select SHORT_DESC from ST_PREPARE_LOCATION where PREPARE_LOCATION_CODE = hdr.prepare_location_code)PREP_DESC,(select appl_user_name from sm_appl_user_vw where APPL_USER_ID = hdr.ADDED_BY_ID)added_by,TO_CHAR (hdr.added_date, 'DD/MM/YYYY HH24:MI:SS') added_date FROM st_prod_transfer_hdr hdr, sy_doc_type_master_lang_vw sy, mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE uacc WHERE hdr.doc_type_code = sy.doc_type_code AND hdr.store_code = mm.store_code AND hdr.finalized_yn = 'N' AND hdr.doc_type_code LIKE ? AND TO_CHAR (hdr.doc_no) LIKE ? AND hdr.store_code LIKE ?  AND NVL (hdr.PREPARE_LOCATION_CODE, 'X') LIKE ? AND TO_DATE (TO_CHAR (hdr.doc_date, 'dd/mm/yyyy'), 'dd/mm/yyyy') BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/5000'), 'dd/mm/yyyy') AND hdr.trn_type = 'PRT' AND uacc.store_code = mm.store_code AND uacc.user_id = ? AND uacc.PRT_ALLOWED_YN = 'Y' AND sy.language_id = mm.language_id AND sy.language_id = ? AND mm.facility_id = ?  ");
		//Added for ML-MMOH-CRF-0448 [IN:57461] by B.Badmavathi on 04/02/2016 ends
		//Added for ML-MMOH-CRF-0448 [IN:57461] by B.Badmavathi on  starts
		//dataMap.put("SQL_ST_SITE_SPEC_PROD_TRANSFER","SELECT rownum FROM ST_PROD_TRANSFER");
		dataMap.put("SQL_ST_SITE_SPEC_PROD_TRANSFER","SELECT count(*) FROM ST_PROD_TRANSFER");
		dataMap.put("SQL_STORE_DESC_PROD_TRF","select b.short_desc,a.PREPARE_LOCATION_CODE,a.PROD_TFR_REQUEST_NO from  ST_PROD_TRANSFER_hdr a,mm_store b where doc_no = ?  and a.DOC_TYPE_CODE=? and a.FACILITY_ID=? and A.FACILITY_ID=b.FACILITY_ID   and A.STORE_CODE=b.store_code");
		dataMap.put("SQL_FM_ITEM_DESC_PROD_TRF","select  a.item_code,a.short_desc,b.FM_STK_UOM_CONV_FACTOR from mm_item a,ST_PROD_TRANSFER_HDR b where a.item_code = b.FM_ITEM_CODE and  b.doc_no = ? and b.DOC_TYPE_CODE=? and b.FACILITY_ID=?");
		dataMap.put("SQL_TO_ITEM_DESC_PROD_TRF","select  a.item_code,a.short_desc,b.TO_STK_UOM_CONV_FACTOR ,c.UOM_CODE,c.short_desc uom_desc from mm_item a,ST_PROD_TRANSFER_HDR b,am_uom c where c.UOM_CODE = b.TO_STK_UOM_CODE and a.item_code = b.TO_ITEM_CODE and  b.doc_no = ? and b.DOC_TYPE_CODE=? and b.FACILITY_ID=?");
		dataMap.put("SQL_FM_UOM_DESC_PROD_TRF","select ( D.QTY_ON_HAND  - D.COMMITTED_QTY) AVAIL_QTY, a.UOM_CODE,a.short_desc, C.EXPIRY_YN,d.qty_on_hand,D.COMMITTED_QTY from am_uom a,ST_PROD_TRANSFER_HDR b,st_item c,st_item_batch d,ST_PROD_TRANSFER_DTL_EXP e  where a.UOM_CODE = b.FM_STK_UOM_CODE and  c.item_code = b.FM_ITEM_CODE and d.item_code = b.FM_ITEM_CODE and B.STORE_CODE = D.STORE_CODE and B.FM_ITEM_CODE = D.ITEM_CODE and b.FM_ITEM_BATCH_ID= d.BATCH_ID  and B.DOC_NO = E.DOC_NO and E.DOC_SRL_NO =1 and E.BIN_LOCATION_CODE = D.BIN_LOCATION_CODE and E.EXPIRY_DATE_OR_RECEIPT_DATE = D.EXPIRY_DATE_OR_RECEIPT_DATE and b.doc_no = ? and b.DOC_TYPE_CODE=? and b.FACILITY_ID=?");
		dataMap.put("SQL_EXP_DATE_PROD_TRF","select TO_CHAR(FM_EXPIRY_DATE,'DD/MM/YYYY')FM_EXPIRY_DATE,TO_CHAR(TO_EXPIRY_DATE,'DD/MM/YYYY')TO_EXPIRY_DATE,FM_ITEM_BATCH_ID,TO_ITEM_BATCH_ID,FM_ITEM_QTY,TO_ITEM_QTY,TO_ITEM_EXP_QTY,FM_ITEM_EXP_BAL_QTY,FM_ITEM_ACT_BAL_QTY,NO_OF_LABELS from ST_PROD_TRANSFER_HDR where doc_no =?  and DOC_TYPE_CODE=? and FACILITY_ID=?");
		dataMap.put("SQL_FM_TRADE_DESC_PROD_TRF","SELECT b.trade_id, b.short_name, a.bin_location_code, c.short_desc,b.manufacturer_id, d.short_name manu_desc  FROM st_prod_transfer_dtl_exp a,am_trade_name b,mm_bin_location c,am_manufacturer d WHERE a.doc_srl_no = 1   AND a.doc_no = ? AND a.trade_id = b.trade_id    AND a.bin_location_code = c.bin_location_code AND a.STORE_CODE = c.STORE_CODE   AND b.manufacturer_id = d.manufacturer_id");
		dataMap.put("SQL_TO_TRADE_DESC_PROD_TRF","select b.SHORT_NAME,A.BIN_LOCATION_CODE,c.SHORT_DESC,a.BARCODE_ID from ST_PROD_TRANSFER_DTL_EXP a, AM_TRADE_NAME b,MM_BIN_LOCATION c where DOC_SRL_NO = 2 and doc_no =? and a.trade_id = b.trade_id and a.BIN_LOCATION_CODE = c.BIN_LOCATION_CODE and A.STORE_CODE = C.STORE_CODE");
		dataMap.put("SQL_FOOTER_PROD_TRF","select REMARKS,PACKED_BY,COUNTER_CHECKED,AUTHORIZED_BY,NO_OF_LABELS, TO_CHAR (TIME_TAKEN, 'HH24:MI')TIME_TAKEN from ST_PROD_TRANSFER_hdr where doc_no = ? and FACILITY_ID=? and DOC_TYPE_CODE = ?");
		dataMap.put("SQL_NOD_EXP_PROD_TRF","select distinct NOD from st_batch_search_lang_view a,ST_PROD_TRANSFER_dtl_exp b where A.ITEM_CODE = B.ITEM_CODE and b.doc_no =? and B.DOC_SRL_NO=1 and A.BATCH_ID=B.BATCH_ID and A.BIN_LOCATION_CODE = B.BIN_LOCATION_CODE and A.EXPIRY_DATE = B.EXPIRY_DATE_OR_RECEIPT_DATE and A.STORE_CODE =B.STORE_CODE and A.TRADE_ID = B.TRADE_ID");
		dataMap.put("SQL_ST_PRODUCT_TRANSFER_HDR_UPDATE","UPDATE ST_PROD_TRANSFER_HDR SET doc_date=TO_DATE(?,'dd/mm/yyyy'), doc_ref=?, STORE_CODE = ?, fm_stk_uom_conv_factor=?, to_stk_uom_conv_factor=?, fm_item_batch_id=?, to_item_batch_id=?, fm_expiry_date=TO_DATE(?,'dd/mm/yyyy'), to_expiry_date=TO_DATE(?,'dd/mm/yyyy'), fm_item_qty=?, to_item_qty=?, finalized_yn=?, modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?, to_item_exp_qty=?, fm_item_exp_bal_qty=?, fm_item_act_bal_qty=?, time_taken=TO_DATE(?,'HH24:MI'), packed_by=?,counter_checked=?, authorized_by=?, remarks=?, prepare_location_code=?, no_of_labels=? WHERE	facility_id	= ?	 AND doc_type_code = ?	AND	doc_no = ?");
		dataMap.put("SQL_ST_PRODUCT_TRANSFER_DTL_UPDATE","UPDATE ST_PROD_TRANSFER_DTL  SET item_code	= ?	, item_qty = ? , item_unit_cost	= ?,	item_cost_value= ?, store_code = ? ,stock_item_yn	= ?	, modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	?  WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND doc_srl_no	= ?");
		dataMap.put("SQL_ST_PRODUCT_TRANSFER_DTL_EXP_UPDATE","UPDATE st_prod_transfer_dtl_exp  SET  store_code	= ?	, item_code	= ?	, batch_id = ? , bin_location_code	= ?	,expiry_date_or_receipt_date= TO_DATE(?,'dd/mm/yyyy'), item_qty = ? ,modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ? , modified_facility_id =	? , TRADE_ID=?, BARCODE_ID =? WHERE facility_id = ?  AND doc_type_code	= ?	 AND doc_no	= ?	AND doc_srl_no	= ?");
		//Added for ML-MMOH-CRF-0448 [IN:57461] by B.Badmavathi on  ends
		dataMap.put("SQL_ST_FACILITY_PARAM_SELECT_AUTH_ISS_STORE","SELECT ALLOW_AUTHORIZE_AT_ISSUE_STORE FROM ST_FACILITY_PARAM WHERE FACILITY_ID = ?");//Added by B.Badmavathi on 21/04/2016 against PMG2015-CRF-INT-ST-0001 
		//Added for MMS-DM-SCF-0244 by B.Badmavathi on 06/06/2016 starts
		dataMap.put("SQL_ST_BATCH_EXPIRED_USER_ACCESS","select PROCESS_EXPIRED_ITEMS_YN from ST_USER_ACCESS_FOR_STORE where store_code = ? and user_id = ?");
		dataMap.put("SQL_ST_BATCH_EXPIRED_OR_NOT","select USE_AFTER_EXPIRY_YN from ST_ITEM where item_code = ? ");
		//Added for MMS-DM-SCF-0244 by B.Badmavathi on 06/06/2016 ends
		//Added for ML-BRU-SCF-1686 by B.Badmavathi on 26/07/2016 starts
		dataMap.put("SQL_ITEM_CLASS_CODE_MM_ITEM", "select ITEM_CLASS_CODE from mm_item where item_code = ?");
		dataMap.put("SQL_MM_ITEM_CLASS_CODE_FOR_STORE_SELECT_LIST","SELECT stp.item_class_code FROM st_store_parent_store stp, mm_item_class_lang_vw mm WHERE mm.item_class_code = stp.item_class_code AND stp.store_code =? AND stp.parent_store_code =? AND stp.eff_status = 'E'  AND language_id =?");
		//Added for ML-BRU-SCF-1686 by B.Badmavathi on 26/07/2016 ends
		dataMap.put("SQL_ST_BATCH_SEARCH_VIEW_ALL_BATCH", "SELECT item_code,	item_desc, suspended_yn, store_code, store_desc, trade_id_applicable_yn,  batch_id,	TO_CHAR(expiry_date,'dd/mm/yyyy') expiry_date, bin_location_code, bin_desc,	trade_id, trade_name, qty_on_hand, nod,	 manufacturer_id, manufacturer_name, avail_qty,	expiry_yn, use_after_expiry_yn,BATCH_STATUS,barcode_id FROM	st_batch_search_lang_view st_batch_search_lang_view WHERE	item_code=?	AND	store_code=?  AND avail_qty>0 AND language_id =? AND lang1 =? AND lang2 = ? AND trade_id = NVL(?,trade_id) and nvl(barcode_id,'%') like (?)  ORDER BY	 to_date(expiry_date,'dd/mm/yyyy'), bin_location_code, batch_id");//Added for IN062242
		dataMap.put("SQL_ITEM_INSERT_ISSUE_HDR_COUNT", " select count (*) CNT from st_issue_hdr where facility_id=? and doc_type_code=? and doc_no=? and seq_no=? "); // Added for GHL-SCF-1103
//		dataMap.put("SQL_ITEM_TRN_DTL_INSERT_ISSUE_COUNT", " select count (*) CNT from st_item_trn_dtl where facility_id=? and doc_type_code=? and doc_no=? and item_code=? and store_code=? and batch_id=? "); //GHL-SCF-1103
//		dataMap.put("SQL_ITEM_TRN_DTL_INSERT_ISSUE_COUNT", " select count (*) CNT from st_item_trn_dtl where facility_id=? and doc_type_code=? and doc_no=? and item_code=? and store_code=? and batch_id=?  and EXPIRY_DATE =TO_DATE(?,'dd/mm/yyyy') and BIN_LOCATION_CODE =? and seq_no =?"); //GHL-SCF-1172
		dataMap.put("SQL_ITEM_TRN_DTL_INSERT_ISSUE_COUNT", " select count (*) CNT from st_item_trn_dtl where facility_id=? and doc_type_code=? and doc_no=? and item_code=? and store_code=? and batch_id=?  and EXPIRY_DATE =TO_DATE(?,'dd/mm/yyyy') and BIN_LOCATION_CODE =? and seq_no =? and trn_type=?"); //KDAH-SCF-0433
		dataMap.put("SQL_ST_REQUEST_DTL_INSERT_AUTH","INSERT	INTO st_request_dtl	( facility_id, doc_type_code, doc_no, doc_srl_no, item_code, req_item_qty, stock_item_yn,  pending_item_qty,	added_by_id, added_date, added_at_ws_no, added_facility_id,	modified_by_id,	modified_date, modified_at_ws_no, modified_facility_id,request_uom,request_uom_conv,request_uom_qty,auth_trn_remarks_code,usage_type,CLOSE_ITEM_YN ) VALUES	 ( ? , ? , ? , ? , ? , ? , ? , ? , ? , sysdate , ? , ? , ? , sysdate , ? , ?,?,?,?,?,?,?  )");//Added against ML-MMOH-SCF-0634 ,added CLOSE_ITEM_YN for MO-CRF-20173 
		dataMap.put("SQL_MM_PO_MANDATORY","SELECT PO_MANDATORY_YN FROM MM_PARAMETER WHERE MODULE_ID = ?");//Added against GDOH-CRF-0109
		dataMap.put("SQL_ST_ITEMMASTER","SELECT direct_sale_allowed_yn FROM mm_item_lang_vw  WHERE  item_code = ? AND language_id = ?" );//Added for GHL-CRF-0456 
		dataMap.put("SQL_ST_MULTIUSER","SELECT ISSUE_QTY,(RECEIVED_QTY+REJECTED_QTY+TMP_RECEIVED_QTY_2+TMP_REJECTED_QTY_2) ACK_QTY FROM st_acknowledge_trn_dtl WHERE facility_id = ? AND doc_no = ? AND doc_type_code = ? AND seq_no = ? AND doc_srl_no = ? and item_code= ? and batch_id= ? and EXPIRY_DATE_OR_RECEIPT_DATE = TO_DATE(?,'DD/MM/YYYY') and bin_location_code= ? " ); //Added for AMS-SCF-0692
		dataMap.put("SQL_ST_MULTIUSER1","SELECT (tmp_received_qty_2 + tmp_rejected_qty_2 ) CNFM_QTY FROM st_acknowledge_trn_dtl WHERE facility_id = ? AND doc_no = ? AND doc_type_code = ? AND seq_no = ? AND doc_srl_no = ? and item_code= ? and batch_id= ? and EXPIRY_DATE_OR_RECEIPT_DATE = TO_DATE(?,'DD/MM/YYYY') and bin_location_code= ? " ); //Added for AMS-SCF-0692
		dataMap.put("SQL_ST_PO_COUNT","select count(*) as CHK from PO_ORDER_UNF_GRN  WHERE FACILITY_ID = ? AND GRN_DOC_TYPE_CODE = ? AND GRN_NO = ?" );//Added for ML-BRU-SCF-1924
		dataMap.put("SQL_ST_STORE_AUTO_ROL_SELECT","select auto_rol_calc_flag from st_store where store_code=?");//Added for  IN:071344 
		dataMap.put("SQL_ST_AUTH_SEARCH_HISTORY_INSERT","INSERT INTO st_auth_search_history (facility_id, user_id, req_type, doc_type_code, req_on_store, req_by_store, from_doc_date, to_doc_date, doc_no, item_class, item_code, req_status, added_by_id, added_date, added_at_ws_no, modified_by_id, modified_date, modified_at_ws_no ) VALUES (?, ?, ?, ?, ?, ?, TO_DATE(?,'dd/mm/yyyy'), TO_DATE(?,'dd/mm/yyyy'), ?, ?, ?, ?, ?,SYSDATE, ?, ?,SYSDATE, ? )");//Added for IN072061
		dataMap.put("SQL_ST_ITEM_STORE_UPDATE_QTY_ON_HAND_1" , "update st_item_store set qty_on_hand=?,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?,  phy_inv_id = NULL, phy_inv_start_date = NULL, phy_inv_start_qty = NULL  where store_code=? and item_code=?" );//Added for IN072061
		dataMap.put("SQL_ST_ITEM_BATCH_UPDATE_PHY_INV_1" , "update st_item_batch set phy_inv_id=null, PHY_INV_START_DATE=null, PHY_INV_START_QTY=null , modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?, modified_facility_id=?  where phy_inv_id=? and store_code=? AND item_code IN (?)" );//Added for IN072061
		dataMap.put("SQL_ST_ST_PROD_TRANSFER_DTL_EXP_DELETE" , "DELETE FROM ST_PROD_TRANSFER_DTL_EXP WHERE	FACILITY_ID	= ?	 AND DOC_TYPE_CODE = ?	AND	DOC_NO = ? " );//Added for ML-MMOH-SCF-1861
		dataMap.put("SQL_ST_ST_PROD_TRANSFER_DTL_DELETE" , "DELETE FROM ST_PROD_TRANSFER_DTL WHERE	FACILITY_ID	= ?	 AND DOC_TYPE_CODE = ?	AND	DOC_NO = ? " );
		dataMap.put("SQL_ST_ST_PROD_TRANSFER_HDR_DELETE" , "DELETE FROM ST_PROD_TRANSFER_HDR WHERE	FACILITY_ID	= ?	 AND DOC_TYPE_CODE = ?	AND	DOC_NO = ? " ); 
		dataMap.put("SQL_ST_PROD_DTL_EXP_SELECT_FOR_BLOCK_REL",	"SELECT store_code, item_code, batch_id, bin_location_code, TO_CHAR(expiry_date_or_receipt_date,'dd/mm/yyyy') expiry_date_or_receipt_date, trade_id, ITEM_QTY FROM ST_PROD_TRANSFER_DTL_EXP WHERE  facility_id=? AND  doc_type_code =? AND doc_no=?  AND doc_srl_no like ?");
		dataMap.put("SQL_ST_PROD_EXP_SELECT_FOR_DEL","select STORE_CODE, ITEM_CODE, BATCH_ID, BIN_LOCATION_CODE, to_char(EXPIRY_DATE_OR_RECEIPT_DATE,'dd/mm/yyyy') EXPIRY_DATE_OR_RECEIPT_DATE, ITEM_QTY from ST_PROD_TRANSFER_DTL_EXP where facility_id =? AND doc_type_code = ? AND doc_no =?  AND doc_srl_no = ?");//ML-MMOH-SCF-1861 end  
		dataMap.put("SQL_SELECT_BATCH_FOR_MAT_GROUP_ACCESS","SELECT material_group_code  FROM mm_item WHERE item_code = ? AND material_group_code IN (SELECT material_group_code  FROM MM_USER_MATERIAL_GROUP    WHERE material_group_code = ? and user_id= ? AND EFF_STATUS ='E') ");//GHL-SCF-1587   
		dataMap.put("SQL_SELECT_ITEM_STORE_LAST_ISSUED_DATE","select DOC_NO,DOC_DATE,FM_STORE_CODE,TO_STORE_CODE,FINALIZED_YN,MODIFIED_DATE from st_issue_hdr where FM_STORE_CODE= ? AND FINALIZED_YN = 'Y' AND FACILITY_ID = ? AND FM_STORE_CODE IN (SELECT STORE_CODE FROM st_issue_dtl WHERE STORE_CODE =? and ITEM_CODE= ?) ORDER BY MODIFIED_DATE DESC FETCH FIRST 1 ROWS ONLY");//MO-CRF-20172 
		dataMap.put("SQL_ST_STORE_LOOKUP_SELECT","SELECT store_code  code,short_desc  description  FROM  mm_store_lang_vw a  WHERE facility_id   =  '~FACILITY_ID`'   AND  UPPER(store_code)     LIKE  UPPER(?)  AND  UPPER(short_desc)  LIKE UPPER(?)  AND  eff_status='E'  AND  not exists  ( select  store_code     from  st_store b  where  a.store_code=b.store_code)  and a.language_id ='~LOCALE_ID`' ");//GHL-SCF-1587   
		dataMap.put("SQL_ST_STORE_LOOKUP_SELECT_01", "SELECT st.store_code code,  mm.short_desc description FROM mm_store_lang_vw mm, st_store st   WHERE  mm.facility_id    LIKE(?)	 AND 	 UPPER(st.store_code)   LIKE  	UPPER(?)  AND  UPPER(mm.short_desc)  LIKE	 UPPER(?)   AND  mm.eff_status='E'   AND   mm.store_code= st.store_code   AND mm.language_id = '~LOCALE_ID`' ORDER BY 2 "); //23465
		dataMap.put("SQL_ST_STORE_BINLOCATION_LOOKUP_SELECT","select BIN_LOCATION_CODE code , SHORT_DESC Description from MM_BIN_LOCATION_lang_vw where EFF_STATUS='E' and upper (SHORT_DESC) like upper(?) and upper(BIN_LOCATION_CODE) like upper(?) and store_code='~STORE_ID`' and language_id='~LOCALE_ID`' ");
		dataMap.put("SQL_ST_USER_ACCESS_FOR_USER_LOOKUP_SELECT","SELECT appl_user_id code,	appl_user_name  description FROM sm_appl_user_lang_vw sm_appl_user where  UPPER(eff_status)='E' AND UPPER(appl_user_id) like UPPER(?) AND UPPER(appl_user_name)	like  UPPER(?) AND language_id = '~LOCALE_ID`' ");
		dataMap.put("SQL_ST_PARENTSTORE_FOR_STORE_LOOKUP_SELECT","SELECT MM.STORE_CODE CODE , MM.LONG_DESC  DESCRIPTION FROM MM_STORE_LANG_VW  MM WHERE  MM.EFF_STATUS = 'E'  AND UPPER(MM.STORE_CODE) LIKE UPPER(?) AND UPPER(MM.LONG_DESC) LIKE UPPER(?)  AND LANGUAGE_ID ='~LOCALE_ID`' ");
		dataMap.put("SQL_ST_TRN_REMARKS_REJECT_REQUEST_SELECT","SELECT REJECT_STATUS from ST_TRN_TYPE_FOR_REMARKS where TRN_TYPE='ISS' and TRN_REMARKS_CODE=? ");//MO-CRF-20174  
		dataMap.put("SQL_ST_TRN_REMARKS_REJECT_REQUEST_LIST_SELECT","SELECT TRN_REMARKS_CODE from ST_TRN_TYPE_FOR_REMARKS where TRN_TYPE=? and REJECT_STATUS='E' ");//MO-CRF-20174
		dataMap.put("SQL_ST_REJECT_REQUEST_REQ_BY_STORE_SELECT","SELECT   st.store_code, mm.short_desc FROM st_store st, mm_store_lang_vw mm, st_user_access_for_store su  WHERE st.store_code = mm.store_code    AND mm.eff_status = 'E' AND st.req_allowed_yn = 'Y' AND su.req_allowed_yn = 'Y' AND su.REJECT_REQUEST_ISS_ALLOW_YN = 'Y' AND su.store_code = st.store_code AND mm.facility_id = ? AND mm.language_id = ? AND user_id = ? ORDER BY 2, 1");//MO-CRF-20174
		dataMap.put("SQL_ST_REJECT_REQUEST_HDR_QUERY_RESULT","SELECT DISTINCT hdr.doc_type_code, sy.short_desc doc_type_desc, hdr.doc_no, TO_CHAR (hdr.doc_date, 'dd/mm/yyyy') doc_date, hdr.req_by_store_code, rbys.short_desc req_by_store_desc, hdr.req_on_store_code, rons.short_desc req_on_store_desc, hdr.item_class_code, itm.short_desc item_class_desc, DECODE (request_status,'W', 'Authorized at Req. by Store','P', 'Partially Issued',request_status) request_status ,hdr.facility_id facility_id FROM st_request_hdr hdr,st_request_dtl dtl, mm_store rbys, mm_store rons, mm_item_class itm, SY_DOC_TYPE_MASTER sy, st_store uaca, st_store uacb, st_acc_entity_param stpa, st_user_access_for_store uast ,mm_item_lang_vw mm WHERE hdr.doc_type_code = sy.doc_type_code AND HDR.DOC_TYPE_CODE =  DTL.DOC_TYPE_CODE AND HDR.DOC_NO = DTL.DOC_NO AND hdr.req_by_store_code = rbys.store_code AND hdr.req_on_store_code = rons.store_code AND hdr.item_class_code = itm.item_class_code(+) AND hdr.cancelled_by_id IS NULL    AND hdr.req_authorized_by_id IS NOT NULL AND (doc_date BETWEEN TO_DATE (NVL (?, '01/01/1901'), 'dd/mm/yyyy') AND TO_DATE (NVL (?, '31/12/3012'), 'dd/mm/yyyy')) AND uaca.store_code = hdr.req_on_store_code AND uaca.iss_allowed_yn = 'Y' AND uacb.store_code = hdr.req_by_store_code AND uast.REJECT_REQUEST_ISS_ALLOW_YN = 'Y' AND uast.store_code = hdr.req_on_store_code AND uacb.req_allowed_yn = 'Y' AND uast.req_allowed_yn = 'Y' AND hdr.request_status IN ('W', 'P') AND rons.facility_id = DECODE (stpa.trn_across_facility_yn, 'Y', rons.facility_id, ?) AND rbys.facility_id = DECODE (stpa.trn_across_facility_yn, 'Y', rbys.facility_id, ?) AND uast.USER_ID = ? and mm.language_id = ? and dtl.pending_item_qty > 0 AND DTL.COMMITTED_ITEM_QTY = 0 ");//MO-CRF-20174//uast.store_code = hdr.req_by_store_code changed uast.store_code = hdr.req_on_store_code for ICN-37990
		dataMap.put("SQL_ST_REJECT_REQUEST_BY_ITEM","UPDATE st_request_dtl SET pending_item_qty=pending_item_qty - NVL(?,0) , modified_by_id = ?,modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id = ?, REJECT_REMARKS = ?, REJECT_REMARKS_DESC = ? WHERE  item_code=? AND doc_no = ? AND doc_type_code	= ?");//MO-CRF-20174  
		dataMap.put("SQL_ST_ISSUE_REQ_URG_TO_STORE2","SELECT DISTINCT stp.store_code parent_store_code, mm.short_desc   FROM st_store_parent_store stp,  mm_store_lang_vw mm,  st_acc_entity_param pa,st_store st  WHERE mm.store_code = stp.store_code AND st.store_code = mm.store_code  AND mm.eff_status = 'E'  AND pa.acc_entity_id = (?) AND mm.facility_id =?  AND st.req_allowed_yn = 'Y'   AND mm.language_id = ?  AND stp.parent_store_code = ? ORDER BY 2");//Added for NMC-JD-CRF-0174 
		dataMap.put("SQL_ST_STOCK_TO_STORE_DIFFERENT_FACILITYID", "SELECT DISTINCT stp.store_code PARENT_STORE_CODE, mm.short_desc FROM st_store_parent_store stp, mm_store_lang_vw mm,st_store st, st_acc_entity_param pa,st_user_access_for_store uas WHERE mm.eff_status = 'E' AND stp.store_code = mm.store_code AND st.store_code = mm.store_code and uas.user_id = ? AND pa.acc_entity_id = ? AND  mm.facility_id != ? AND mm.language_id = ? AND stp.parent_store_code = ? ORDER BY 2  ");//Added for NMC-JD-CRF-0174 
	 }
/*
	Auto Schedule Request End
*/
}


