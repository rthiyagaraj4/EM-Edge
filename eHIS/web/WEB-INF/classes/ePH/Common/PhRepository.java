/*******************************************************************************
 * Copyright 1999-2015, Computer Sciences Corporation. All rights reserved.
 *  
 * Warning: This computer program is protected by copyright law and international treaties.
 * Unauthorized reproduction or distribution of this program, or any portion of it, 
 * may result in severe civil and criminal penalties, and will be prosecuted to 
 * the maximum extent possible under the law.
 ******************************************************************************/
/*
----------------------------------------------------------------------------------------------------------------------------------------------------------
Date       Edit History      Name        	Rev.Date		Rev.Name		Description
----------------------------------------------------------------------------------------------------------------------------------------------------------
09/04/2019	IN069511     Haribabu	     								 Available Quantity for drugs need to take from interface table
26/06/2019  IN:070451    Haribabu                                        ML-MMOH-CRF-1408
07/08/2019  IN071022    Manickavasagam j                                 SKR-SCF-1260
13/08/2019  IN:070451    B Haribabu          13/08/2019      Manickam       ML-MMOH-CRF-1408
10/09/2019  IN:070451    B Haribabu          13/08/2019      Manickam       ML-MMOH-CRF-1408
05/11/2019	IN070606	Ramesh Goli											MMS-KH-CRF-0029	
28/11/2019    IN059899        PRATHYUSHA                          JD-CRF-0200
3/12/2019	IN071727	Shazana												SKR-SCF-1293
28/04/2020  IN:071537    B Haribabu                                       GHL-CRF-0614
09/06/2020  IN:072715      Haribabu                                        MMS-DM-CRF-0165
08/07/2020  IN:073201      Prabha										  SKR-SCF-1342
23/08/2020	IN073641		Manickavasagam			MMS-KH-CRF-0034 
10/11/2020		6041				Shazana       							NMC-JD-CRF-0063
06/01/2021	TFS-7345       Prabha         06/01/2020	  Manickavasagam J   MMS-DM-CRF-0177
16/04/2021  	TFS id:-16341    Haribabu	 16/04/2021	 	 Manickavasagam J          NMC-JD-CRF-0097
13/04/2023      43567           SREENADH.M            Ramesh.G      PMG2022-MMS-CRF-0002
21/04/2023        40016          HARIHARAN     21/04/2023       ramesh goli          ML-MMOH-CRF-1823.V1.0
22/11/2023      51468           Hariharan          23/11/2023        ramesh goli         ML-MMOH-CRF-1994
--------------------------------------------------------------------------------------------------------------------
*/ 
package ePH.Common; 
 
import java.util.HashMap;

public class PhRepository {
	private static HashMap dataMap ;
	static {
		i = 0;
		dataMap = new HashMap(); 
		load();
	}

	public static  String getPhKeyValue(String s) throws Exception {
		return getValue(s);
	}

	private static String getValue(String s) throws Exception {
		String s1 = "";
		try {
			s1 = (String)dataMap.get(s);

			if(s1 == null)
				throw new Exception(s + " : Key not found");
		}
		catch(Exception exception) {
			throw new Exception(s + " : Key not found");
		}
		return s1;
	}

	protected void finalize() throws Throwable {
		if(dataMap != null)
			dataMap = null;
	}

	private static void load() {
		dataMap.put("SQL_PH_FORM_OF_DRUG_SELECT", "SELECT A.FORM_CODE,A.FORM_DESC FROM PH_FORM_LANG_VW A WHERE A.EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY FORM_DESC");
		dataMap.put("SQL_PH_UOM_FOR_FORM_SELECT1", "SELECT A.UOM_CODE, A.SHORT_DESC FROM AM_UOM_LANG_VW A WHERE A.DOSAGE_UOM_YN='Y' AND EFF_STATUS='E' AND STRENGTH_UOM_YN = 'N' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_UOM_FOR_FORM_SELECT2", "SELECT A.FORM_CODE,A.UOM_CODE,A.DFLT_UOM_YN FROM PH_UOM_FOR_FORM A WHERE A.FORM_CODE = ? ");
		dataMap.put("SQL_PH_UOM_FOR_FORM_INSERT", "INSERT INTO PH_UOM_FOR_FORM (FORM_CODE, UOM_CODE, DFLT_UOM_YN, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,SYSDATE,?,?,?, SYSDATE,?,?)");
		dataMap.put("SQL_PH_UOM_FOR_FORM_DELETE", "DELETE FROM PH_UOM_FOR_FORM WHERE FORM_CODE=?");
		dataMap.put("SQL_PH_UOM_FOR_FORM_UPDATE", "UPDATE PH_UOM_FOR_FORM SET DFLT_UOM_YN=? WHERE UOM_CODE= ? AND FORM_CODE=?");
		dataMap.put("SQL_PH_UOM_FOR_FORM_SELECT3", "SELECT A.FORM_CODE, B.FORM_DESC, A.UOM_CODE, C.SHORT_DESC,A.DFLT_UOM_YN FROM PH_UOM_FOR_FORM A, PH_FORM_LANG_VW B, AM_UOM_LANG_VW C WHERE A.FORM_CODE=B.FORM_CODE AND A.UOM_CODE=C.UOM_CODE AND UPPER(A.FORM_CODE) LIKE UPPER(?) AND UPPER(B.FORM_DESC) LIKE UPPER(?) AND UPPER(A.UOM_CODE) LIKE UPPER(?) AND UPPER(C.SHORT_DESC) LIKE UPPER(?) AND  C.DOSAGE_UOM_YN = 'Y' AND   C.STRENGTH_UOM_YN = 'N' AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_UOM_FOR_FORM_SELECT4", "SELECT UOM_CODE,LONG_DESC,SHORT_DESC,PUR_UOM_YN,STOCK_UOM_YN,SALE_UOM_YN,STRENGTH_UOM_YN,QTY_UOM_YN FROM AM_UOM_LANG_VW WHERE DOSAGE_UOM_YN='Y' AND  STRENGTH_UOM_YN = 'N' AND LANGUAGE_ID = ?");
		dataMap.put("JNDI_PH_UOM_FOR_FORM", "java:comp/env/UomForForm");
		dataMap.put("SQL_PH_ATC_LEVEL1_SELECT", "SELECT A.ATC_CLASS_LEV1_CODE lev1_code, A.ATC_CLASS_LEV1_DESC lev1_desc, COUNT(B.ATC_CLASS_LEV2_CODE) TOT_REC_CNT, A.DISPLAY_SEQ_NO FROM PH_ATC_CLASS_LEV1_LANG_VW A , PH_ATC_CLASS_LEV2 B WHERE A.ATC_CLASS_LEV1_CODE = B.ATC_CLASS_LEV1_CODE(+) AND A.LANGUAGE_ID = ? GROUP BY A.ATC_CLASS_LEV1_CODE ,A.ATC_CLASS_LEV1_DESC,A.DISPLAY_SEQ_NO ORDER BY A.DISPLAY_SEQ_NO");
		dataMap.put("SQL_PH_ATC_LEVEL2_SELECT", "SELECT A.ATC_CLASS_LEV2_CODE lev2_code, A.ATC_CLASS_LEV2_DESC lev2_desc,COUNT(B.ATC_CLASS_LEV3_CODE) TOT_REC_CNT,A.DISPLAY_SEQ_NO FROM PH_ATC_CLASS_LEV2_LANG_VW A , PH_ATC_CLASS_LEV3 B WHERE A.ATC_CLASS_LEV2_CODE = B.ATC_CLASS_LEV2_CODE(+) AND B.ATC_CLASS_LEV1_CODE(+)=A.ATC_CLASS_LEV1_CODE AND A.ATC_CLASS_LEV1_CODE = ? AND A.LANGUAGE_ID = ? GROUP BY A.ATC_CLASS_LEV2_CODE ,A.ATC_CLASS_LEV2_DESC,A.DISPLAY_SEQ_NO ORDER BY A.DISPLAY_SEQ_NO");
		dataMap.put("SQL_PH_ATC_LEVEL3_SELECT", "SELECT A.ATC_CLASS_LEV3_CODE lev3_code, A.ATC_CLASS_LEV3_DESC lev3_desc, COUNT(B.ATC_CLASS_LEV4_CODE) TOT_REC_CNT,A.DISPLAY_SEQ_NO FROM PH_ATC_CLASS_LEV3_LANG_VW A , PH_ATC_CLASS_LEV4 B WHERE A.ATC_CLASS_LEV3_CODE = B.ATC_CLASS_LEV3_CODE(+) AND B.ATC_CLASS_LEV2_CODE(+) = A.ATC_CLASS_LEV2_CODE AND B.ATC_CLASS_LEV1_CODE(+) = A.ATC_CLASS_LEV1_CODE AND A.ATC_CLASS_LEV1_CODE = ? AND A.ATC_CLASS_LEV2_CODE = ? AND A.LANGUAGE_ID = ? GROUP BY A.ATC_CLASS_LEV3_CODE ,A.ATC_CLASS_LEV3_DESC,A.DISPLAY_SEQ_NO ORDER BY A.DISPLAY_SEQ_NO");
		dataMap.put("SQL_PH_ATC_LEVEL4_SELECT", "SELECT A.ATC_CLASS_LEV4_CODE lev4_code, A.ATC_CLASS_LEV4_DESC lev4_desc,COUNT(B.ATC_CLASS_LEV5_CODE) TOT_REC_CNT ,A.DISPLAY_SEQ_NO FROM PH_ATC_CLASS_LEV4_LANG_VW A , PH_ATC_CLASS_LEV5 B WHERE A.ATC_CLASS_LEV4_CODE = B.ATC_CLASS_LEV4_CODE(+) AND B.ATC_CLASS_LEV3_CODE(+)=A.ATC_CLASS_LEV3_CODE AND B.ATC_CLASS_LEV2_CODE(+)=A.ATC_CLASS_LEV2_CODE AND B.ATC_CLASS_LEV1_CODE(+)= A.ATC_CLASS_LEV1_CODE AND A.ATC_CLASS_LEV1_CODE = ? AND A.ATC_CLASS_LEV2_CODE = ? AND A.ATC_CLASS_LEV3_CODE = ? AND A.LANGUAGE_ID = ? GROUP BY A.ATC_CLASS_LEV4_CODE ,A.ATC_CLASS_LEV4_DESC,A.DISPLAY_SEQ_NO ORDER BY A.DISPLAY_SEQ_NO ");
		dataMap.put("SQL_PH_ATC_LEVEL5_SELECT", "SELECT A.ATC_CLASS_LEV5_CODE lev5_code ,A.ATC_CLASS_LEV5_DESC lev5_desc,A.DISPLAY_SEQ_NO FROM PH_ATC_CLASS_LEV5_LANG_VW A  WHERE  A.ATC_CLASS_LEV1_CODE = ? AND A.ATC_CLASS_LEV2_CODE = ? AND A.ATC_CLASS_LEV3_CODE = ? AND A.ATC_CLASS_LEV4_CODE = ? AND A.LANGUAGE_ID = ? ORDER BY A.DISPLAY_SEQ_NO");
		dataMap.put("SQL_PH_ATC_LEVEL1_SELECT2", "SELECT COUNT(ROWID) FROM PH_ATC_CLASS_LEV1 WHERE ATC_CLASS_LEV1_CODE = ? OR DISPLAY_SEQ_NO= ?");
		dataMap.put("SQL_PH_ATC_LEVEL2_SELECT2", "SELECT COUNT(ROWID) FROM PH_ATC_CLASS_LEV2 WHERE ATC_CLASS_LEV1_CODE = ? AND (ATC_CLASS_LEV2_CODE = ? OR DISPLAY_SEQ_NO=? )");
		dataMap.put("SQL_PH_ATC_LEVEL3_SELECT2", "SELECT COUNT(ROWID) FROM PH_ATC_CLASS_LEV3 WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND (ATC_CLASS_LEV3_CODE = ? OR       DISPLAY_SEQ_NO=? )");
		dataMap.put("SQL_PH_ATC_LEVEL4_SELECT2", "SELECT COUNT(ROWID) FROM PH_ATC_CLASS_LEV4 WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ? AND (ATC_CLASS_LEV4_CODE = ? OR DISPLAY_SEQ_NO=? )");
		dataMap.put("SQL_PH_ATC_LEVEL5_SELECT2", "SELECT COUNT(ROWID) FROM PH_ATC_CLASS_LEV5 WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ? AND  ATC_CLASS_LEV4_CODE = ? AND (ATC_CLASS_LEV5_CODE = ? OR DISPLAY_SEQ_NO=? )");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL1_INSERT", "INSERT INTO PH_ATC_CLASS_LEV1 (ATC_CLASS_LEV1_CODE, ATC_CLASS_LEV1_DESC, DISPLAY_SEQ_NO, ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL2_INSERT", "INSERT INTO PH_ATC_CLASS_LEV2 (ATC_CLASS_LEV1_CODE, ATC_CLASS_LEV2_CODE, ATC_CLASS_LEV2_DESC, DISPLAY_SEQ_NO, ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL3_INSERT", "INSERT INTO PH_ATC_CLASS_LEV3 (ATC_CLASS_LEV1_CODE, ATC_CLASS_LEV2_CODE, ATC_CLASS_LEV3_CODE, ATC_CLASS_LEV3_DESC, DISPLAY_SEQ_NO, ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL4_INSERT", "INSERT INTO PH_ATC_CLASS_LEV4 (ATC_CLASS_LEV1_CODE, ATC_CLASS_LEV2_CODE, ATC_CLASS_LEV3_CODE, ATC_CLASS_LEV4_CODE, ATC_CLASS_LEV4_DESC, DISPLAY_SEQ_NO, ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL5_INSERT", "INSERT INTO PH_ATC_CLASS_LEV5 (ATC_CLASS_LEV1_CODE, ATC_CLASS_LEV2_CODE, ATC_CLASS_LEV3_CODE, ATC_CLASS_LEV4_CODE, ATC_CLASS_LEV5_CODE, ATC_CLASS_LEV5_DESC, DISPLAY_SEQ_NO, ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL1_UPDATE", "UPDATE PH_ATC_CLASS_LEV1 SET ATC_CLASS_LEV1_DESC = ?, DISPLAY_SEQ_NO = ? , MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ATC_CLASS_LEV1_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL2_UPDATE", "UPDATE PH_ATC_CLASS_LEV2 SET ATC_CLASS_LEV2_DESC = ?, DISPLAY_SEQ_NO = ? , MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL3_UPDATE", "UPDATE PH_ATC_CLASS_LEV3 SET ATC_CLASS_LEV3_DESC = ?, DISPLAY_SEQ_NO = ? , MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL4_UPDATE", "UPDATE PH_ATC_CLASS_LEV4 SET ATC_CLASS_LEV4_DESC = ?, DISPLAY_SEQ_NO = ? , MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ?  AND ATC_CLASS_LEV4_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL5_UPDATE", "UPDATE PH_ATC_CLASS_LEV5 SET ATC_CLASS_LEV5_DESC = ?, DISPLAY_SEQ_NO = ? , MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ?  AND ATC_CLASS_LEV4_CODE = ? AND ATC_CLASS_LEV5_CODE = ?  ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL1_DELETE", "DELETE FROM PH_ATC_CLASS_LEV1 WHERE ATC_CLASS_LEV1_CODE =  ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL2_DELETE", "DELETE FROM PH_ATC_CLASS_LEV2 WHERE ATC_CLASS_LEV1_CODE =  ? AND ATC_CLASS_LEV2_CODE =  ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL3_DELETE", "DELETE FROM PH_ATC_CLASS_LEV3 WHERE ATC_CLASS_LEV1_CODE =  ? AND ATC_CLASS_LEV2_CODE =  ? AND ATC_CLASS_LEV3_CODE =  ?  ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL4_DELETE", "DELETE FROM PH_ATC_CLASS_LEV4 WHERE ATC_CLASS_LEV1_CODE =  ? AND ATC_CLASS_LEV2_CODE =  ? AND ATC_CLASS_LEV3_CODE =  ?  AND ATC_CLASS_LEV4_CODE =  ?  ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL5_DELETE", "DELETE FROM PH_ATC_CLASS_LEV5 WHERE ATC_CLASS_LEV1_CODE =  ? AND ATC_CLASS_LEV2_CODE =  ? AND ATC_CLASS_LEV3_CODE =  ?  AND ATC_CLASS_LEV4_CODE =  ?  AND ATC_CLASS_LEV5_CODE =  ?  ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL1_DISP_SELECT", "SELECT DISPLAY_SEQ_NO, ATC_CLASS_LEV1_CODE FROM PH_ATC_CLASS_LEV1 WHERE DISPLAY_SEQ_NO= ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL2_DISP_SELECT", "SELECT DISPLAY_SEQ_NO, ATC_CLASS_LEV2_CODE FROM PH_ATC_CLASS_LEV2 WHERE DISPLAY_SEQ_NO=? AND ATC_CLASS_LEV1_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL3_DISP_SELECT", "SELECT DISPLAY_SEQ_NO, ATC_CLASS_LEV3_CODE FROM PH_ATC_CLASS_LEV3 WHERE DISPLAY_SEQ_NO=? AND ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL4_DISP_SELECT", "SELECT DISPLAY_SEQ_NO, ATC_CLASS_LEV4_CODE FROM PH_ATC_CLASS_LEV4 WHERE DISPLAY_SEQ_NO=? AND ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL5_DISP_SELECT", "SELECT DISPLAY_SEQ_NO, ATC_CLASS_LEV5_CODE FROM PH_ATC_CLASS_LEV5 WHERE DISPLAY_SEQ_NO=? AND ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ? AND ATC_CLASS_LEV4_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CHILD_CHECK_SELECT1", "SELECT (SELECT COUNT(B.ATC_CLASS_LEV2_CODE) FROM PH_ATC_CLASS_LEV2 B WHERE A.ATC_CLASS_LEV1_CODE = B.ATC_CLASS_LEV1_CODE AND ROWNUM<2) + (SELECT COUNT(ROWID) FROM PH_GENERIC_NAME_BY_ATC_CLASS C WHERE C.ATC_CLASS_LEV1_CODE = A.ATC_CLASS_LEV1_CODE AND ROWNUM < 2) TOT_REC_CNT FROM PH_ATC_CLASS_LEV1 A WHERE A.ATC_CLASS_LEV1_CODE=?");
		dataMap.put("SQL_PH_ATC_CHILD_CHECK_SELECT2", "SELECT (SELECT COUNT(B.ATC_CLASS_LEV3_CODE) FROM PH_ATC_CLASS_LEV3 B WHERE A.ATC_CLASS_LEV2_CODE = B.ATC_CLASS_LEV2_CODE AND B.ATC_CLASS_LEV1_CODE=A.ATC_CLASS_LEV1_CODE AND ROWNUM<2) + (SELECT COUNT(ROWID) FROM PH_GENERIC_NAME_BY_ATC_CLASS C WHERE C.ATC_CLASS_LEV2_CODE = A.ATC_CLASS_LEV2_CODE AND C.ATC_CLASS_LEV1_CODE=A.ATC_CLASS_LEV1_CODE AND ROWNUM < 2) TOT_REC_CNT FROM PH_ATC_CLASS_LEV2 A WHERE A.ATC_CLASS_LEV1_CODE=? AND a.atc_class_lev2_code=?");
		dataMap.put("SQL_PH_ATC_CHILD_CHECK_SELECT3", "SELECT (SELECT COUNT(B.ATC_CLASS_LEV4_CODE) FROM PH_ATC_CLASS_LEV4 B WHERE A.ATC_CLASS_LEV3_CODE = B.ATC_CLASS_LEV3_CODE AND B.ATC_CLASS_LEV2_CODE=A.ATC_CLASS_LEV2_CODE AND B.ATC_CLASS_LEV1_CODE=A.ATC_CLASS_LEV1_CODE AND ROWNUM<2) + (SELECT COUNT(ROWID) FROM PH_GENERIC_NAME_BY_ATC_CLASS C WHERE C.ATC_CLASS_LEV3_CODE = A.ATC_CLASS_LEV3_CODE AND C.ATC_CLASS_LEV2_CODE=A.ATC_CLASS_LEV2_CODE AND C.ATC_CLASS_LEV1_CODE=A.ATC_CLASS_LEV1_CODE AND ROWNUM < 2) TOT_REC_CNT FROM PH_ATC_CLASS_LEV3 A WHERE A.ATC_CLASS_LEV1_CODE=? AND A.ATC_CLASS_LEV2_CODE=? AND A.ATC_CLASS_LEV3_CODE=?");
		dataMap.put("SQL_PH_ATC_CHILD_CHECK_SELECT4", "SELECT (SELECT COUNT(B.ATC_CLASS_LEV5_CODE) FROM PH_ATC_CLASS_LEV5 B WHERE A.ATC_CLASS_LEV4_CODE = B.ATC_CLASS_LEV4_CODE AND B.ATC_CLASS_LEV3_CODE=A.ATC_CLASS_LEV3_CODE AND B.ATC_CLASS_LEV2_CODE=A.ATC_CLASS_LEV2_CODE AND B.ATC_CLASS_LEV1_CODE=A.ATC_CLASS_LEV1_CODE AND ROWNUM<2)+ (SELECT COUNT(ROWID) FROM PH_GENERIC_NAME_BY_ATC_CLASS C WHERE C.ATC_CLASS_LEV4_CODE = A.ATC_CLASS_LEV4_CODE AND C.ATC_CLASS_LEV3_CODE=A.ATC_CLASS_LEV3_CODE AND C.ATC_CLASS_LEV2_CODE=A.ATC_CLASS_LEV2_CODE AND C.ATC_CLASS_LEV1_CODE=A.ATC_CLASS_LEV1_CODE AND ROWNUM < 2) TOT_REC_CNT FROM PH_ATC_CLASS_LEV4 A WHERE A.ATC_CLASS_LEV1_CODE=? AND A.ATC_CLASS_LEV2_CODE=? AND A.ATC_CLASS_LEV3_CODE=? AND A.ATC_CLASS_LEV4_CODE=? ");
		dataMap.put("SQL_PH_ATC_CHILD_CHECK_SELECT5", "SELECT COUNT(ROWID) FROM PH_GENERIC_NAME_BY_ATC_CLASS A WHERE A.ATC_CLASS_LEV1_CODE=? AND A.ATC_CLASS_LEV2_CODE=? AND A.ATC_CLASS_LEV3_CODE=? AND A.ATC_CLASS_LEV4_CODE=? AND A.ATC_CLASS_LEV5_CODE=? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL1_DISP_SELECT2", "SELECT MAX(DISPLAY_SEQ_NO) SEQ_NO FROM PH_ATC_CLASS_LEV1 ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL2_DISP_SELECT2", "SELECT MAX(DISPLAY_SEQ_NO) SEQ_NO FROM PH_ATC_CLASS_LEV2 WHERE ATC_CLASS_LEV1_CODE = ?");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL3_DISP_SELECT2", "SELECT MAX(DISPLAY_SEQ_NO) SEQ_NO FROM PH_ATC_CLASS_LEV3 WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL4_DISP_SELECT2", "SELECT MAX(DISPLAY_SEQ_NO) SEQ_NO FROM PH_ATC_CLASS_LEV4 WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ? ");
		dataMap.put("SQL_PH_ATC_CLASS_LEVEL5_DISP_SELECT2", "SELECT MAX(DISPLAY_SEQ_NO) SEQ_NO FROM PH_ATC_CLASS_LEV5 WHERE ATC_CLASS_LEV1_CODE = ? AND ATC_CLASS_LEV2_CODE = ? AND ATC_CLASS_LEV3_CODE = ? AND ATC_CLASS_LEV4_CODE = ? ");
		dataMap.put("JNDI_PH_ATC_CLASS_LEVEL", "java:comp/env/PhATCClassLevel");

		dataMap.put("SQL_PH_PHARMACO_SEARCH_SELECT11","SELECT DRUG_CLASS_GROUP_NO,DRUG_CLASS_GROUP_DESC FROM PH_DRUG_CLASS_HDR_LANG_VW PH_DRUG_CLASS_HDR WHERE LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PHARMACO_SEARCH_SELECT12","SELECT DRUG_CLASS_GROUP_NO ,DRUG_CLASS_DTL_GROUP_NO_1 ,DRUG_CLASS_DTL_GROUP_DESC_1 FROM PH_DRUG_CLASS_DTL_1_LANG_VW PH_DRUG_CLASS_DTL_1 WHERE DRUG_CLASS_GROUP_NO =? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PHARMACO_SEARCH_SELECT13","SELECT DRUG_CLASS_GROUP_NO,DRUG_CLASS_DTL_GROUP_NO_1,DRUG_CLASS_DTL_GROUP_NO_2,DRUG_CLASS_DTL_GROUP_DESC_2 FROM PH_DRUG_CLASS_DTL_2_LANG_VW PH_DRUG_CLASS_DTL_2 WHERE DRUG_CLASS_GROUP_NO = ? AND DRUG_CLASS_DTL_GROUP_NO_1=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PHARMACO_SEARCH_SELECT14","SELECT DISTINCT T.GEN_DRUG_CODE||'  ' || T.STR_TEXT ||'  ('||T.FORM_CODE||')' DRUG, T.ITEM_DESC,T.FORM_CODE,DF.FORM_DESC,T.DFLT_ROUTE_CODE,R.ROUTE_DESC,T.DFLT_FREQ_CODE, T.ITEM_CODE , T.DFLT_DOSE_STRENGTH, T.STRENGTH_UNIT, T.IP_AUTO_STOP_DURN,T.DFLT_DURN,T.ORDER_TYPE_CODE,T.GEN_DRUG_CODE,T.REPEAT_ALLOWED_YN,NVL(T.TAPER_DRUG_YN,'N') TAPER_DRUG_YN FROM PH_TRADE_DRUG_MAST T, PH_GENERIC_DRUG_MAST A,PH_GENERIC_DRUG_CLASS_GROUP E,PH_DOSAGE_FORM_MAST DF, PH_ROUTE_MAST R WHERE 	NVL(T.STATUS,'X')	!='S' AND 	NVL(A.STATUS,'X')	!='S' AND NVL(BASE_PACK_YN,'N') ='Y' AND T.GEN_DRUG_CODE =A.GEN_DRUG_CODE AND T.GEN_DRUG_CODE =E.GEN_DRUG_CODE AND A.GEN_DRUG_CODE =E.GEN_DRUG_CODE AND DF.FORM_CODE =T.FORM_CODE AND R.ROUTE_CODE=T.DFLT_ROUTE_CODE AND NVL(DF.STATUS,'X')!='S' AND	NVL(R.STATUS,'X')!='S' AND E.DRUG_CLASS_GROUP_NO=?");

		dataMap.put("SQL_AM_UOM_SELECT1", "SELECT UOM_CODE, LONG_DESC FROM AM_UOM WHERE EFF_STATUS='E' AND DOSAGE_UOM_YN='Y'  ORDER BY 2");
		dataMap.put("SQL_AM_UOM_SELECT2", "SELECT UOM_CODE, LONG_DESC FROM AM_UOM WHERE EFF_STATUS='E' AND STRENGTH_UOM_YN='N' AND UOM_CODE != ? ORDER BY 2");
		dataMap.put("SQL_AM_UOM_EQVL_INSERT", "INSERT INTO AM_UOM_EQVL (UOM_CODE, EQVL_UOM_CODE, EQVL_VALUE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_AM_UOM_EQVL_SELECT_VW", "SELECT A.UOM_CODE, B.SHORT_DESC UOM_DESC, A.EQVL_UOM_CODE, C.SHORT_DESC EQVL_UOM_DESC, TO_CHAR(A.EQVL_VALUE,'999999.999999') EQVL_VALUE FROM AM_UOM_EQVL A, AM_UOM B, AM_UOM C WHERE A.UOM_CODE = B.UOM_CODE AND A.EQVL_UOM_CODE = C.UOM_CODE AND A.UOM_CODE LIKE UPPER(?) AND A.EQVL_UOM_CODE LIKE UPPER(?) AND UPPER(B.SHORT_DESC) LIKE UPPER(?) AND UPPER(C.SHORT_DESC) LIKE UPPER(?)");
		dataMap.put("SQL_AM_UOM_EQVL_SELECT", "SELECT A.UOM_CODE, A.EQVL_UOM_CODE, A.EQVL_VALUE FROM AM_UOM_EQVL A WHERE ((A.UOM_CODE = UPPER(?) AND A.EQVL_UOM_CODE = UPPER(?)) OR (A.UOM_CODE = UPPER(?) AND A.EQVL_UOM_CODE = UPPER(?)))");
		dataMap.put("SQL_AM_UOM_EQVL_UPDATE", "UPDATE AM_UOM_EQVL SET EQVL_VALUE = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE UOM_CODE = ? AND EQVL_UOM_CODE = ?");
		dataMap.put("SQL_AM_UOM_EQVL_DELETE", "DELETE FROM AM_UOM_EQVL WHERE UOM_CODE = ? AND EQVL_UOM_CODE = ?");
		dataMap.put("SQL_AM_UOM_EQVL_KEY", "SELECT A.UOM_CODE,A.EQVL_UOM_CODE FROM AM_UOM_EQVL A, AM_UOM B, AM_UOM C WHERE A.UOM_CODE = B.UOM_CODE AND A.EQVL_UOM_CODE = C.UOM_CODE  AND A.UOM_CODE LIKE UPPER(?) AND UPPER(B.SHORT_DESC) LIKE UPPER(?) AND A.EQVL_UOM_CODE LIKE UPPER(?) AND UPPER(C.SHORT_DESC) LIKE UPPER(?)");
		dataMap.put("JNDI_PH_AM_UOM_EQVL", "java:comp/env/UomForEqvl");

		dataMap.put("SQL_PH_OR_ORDER_TYPE_SELECT", "SELECT A.ORDER_TYPE_CODE, A.LONG_DESC,B.DRUG_CLASS, (CASE WHEN B.DRUG_CLASS IN ('G','N','C') THEN 'Y' ELSE 'N' END ) AVAILABLE_DB_YN FROM OR_ORDER_TYPE  A,PH_ORDER_TYPE_FOR_DRUG_CLASS B WHERE A.ORDER_CATEGORY = 'PH' AND A.EFF_STATUS = 'E' AND A.ORDER_TYPE_CODE = B.ORDER_TYPE_CODE(+) ORDER BY 2");
		dataMap.put("SQL_PH_ORDER_TYPE_FOR_DRUG_CLASS_INSERT", "INSERT INTO PH_ORDER_TYPE_FOR_DRUG_CLASS (ORDER_TYPE_CODE, DRUG_CLASS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_ORDER_TYPE_FOR_DRUG_CLASS_UPDATE", "UPDATE PH_ORDER_TYPE_FOR_DRUG_CLASS SET DRUG_CLASS = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDER_TYPE_CODE = ?");
		dataMap.put("SQL_PH_ORDER_TYPE_FOR_DRUG_CLASS_DELETE", "DELETE PH_ORDER_TYPE_FOR_DRUG_CLASS WHERE ORDER_TYPE_CODE = ?");
		dataMap.put("SQL_PH_ORDER_TYPE_FOR_DRUG_CLASS_SELECT1", "SELECT A.ORDER_TYPE_CODE, B.SHORT_DESC, B.LONG_DESC, A.DRUG_CLASS, DECODE(A.DRUG_CLASS,'G','General','N','Narcotics','C','Controlled') DRUG_CLASS_ABBR FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A, OR_ORDER_TYPE_LANG_VW B WHERE  B.LANGUAGE_ID = ? AND A.ORDER_TYPE_CODE = B.ORDER_TYPE_CODE AND A.ORDER_TYPE_CODE LIKE UPPER(?) AND UPPER(B.LONG_DESC) LIKE UPPER(?) AND A.DRUG_CLASS LIKE UPPER(DECODE(?,'A',A.DRUG_CLASS,?)) ");
		dataMap.put("SQL_PH_ORDER_TYPE_FOR_DRUG_CLASS_SELECT3", "SELECT A.LONG_DESC,B.SHORT_DESC ORDER_CATEGORY_DESC, A.FREQ_APPLICABLE_YN, A.SOFT_STOP_YN, A.CONT_ORDER_YN, A.PIN_APPLICABLE_ON_ORDER_YN, A.PIN_APPLICABLE_ON_RESULT_YN, A.REGN_REQD_YN FROM OR_ORDER_TYPE A, OR_ORDER_CATEGORY B WHERE A.ORDER_TYPE_CODE =  UPPER(?) AND A.ORDER_CATEGORY=B.ORDER_CATEGORY");
		dataMap.put("SQL_PH_ORDER_TYPE_FOR_DRUG_CLASS_KEY", "SELECT A.ORDER_TYPE_CODE FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A, OR_ORDER_TYPE B WHERE A.ORDER_TYPE_CODE = B.ORDER_TYPE_CODE AND B.ORDER_CATEGORY='PH' AND A.ORDER_TYPE_CODE LIKE UPPER(?) AND UPPER(B.LONG_DESC) LIKE UPPER(?) AND A.DRUG_CLASS = UPPER(?)");
		dataMap.put("JNDI_PH_DRUG_CLASS_FOR_ORDER_TYPE", "java:comp/env/DrugClassForOrderType");

		dataMap.put("SQL_PH_PRES_REMARK_FORM", "SELECT A.FORM_CODE, A.FORM_DESC FROM PH_FORM_LANG_VW A WHERE A.EFF_STATUS='E' AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_PRES_REMARK_ROUTE_FORM", "SELECT A.FORM_CODE, A.ROUTE_CODE,B.ROUTE_DESC, B.ROUTE_COLOR FROM PH_ROUTE_FOR_FORM A, PH_ROUTE B WHERE A.ROUTE_CODE=B.ROUTE_CODE ORDER BY 3");
		dataMap.put("SQL_PH_PRES_REMARK_SELECT1", "SELECT A.REMARK_CODE, A.REMARK_DESC,A.FORM_CODE,B.FORM_DESC,A.ROUTE_CODE,C.ROUTE_DESC,C.ROUTE_COLOR,A.APPL_SLIDING_SCALE_YN FROM PH_PRES_REMARK_LANG_VW A, PH_FORM_LANG_VW B, PH_ROUTE_LANG_VW C WHERE A.FORM_CODE=B.FORM_CODE(+) AND A.ROUTE_CODE=C.ROUTE_CODE(+) AND A.REMARK_CODE LIKE UPPER(?)AND UPPER(A.REMARK_DESC) LIKE UPPER(?)AND NVL(A.FORM_CODE,'X') LIKE UPPER(?)AND UPPER(NVL(B.FORM_DESC,'X')) LIKE UPPER(?)  AND NVL(A.ROUTE_CODE,'X') LIKE UPPER(?) AND UPPER(NVL(C.ROUTE_DESC,'X')) LIKE UPPER(?)AND NVL(A.APPL_SLIDING_SCALE_YN,'X') LIKE UPPER(?) AND A.LANGUAGE_ID = B.LANGUAGE_ID(+) AND A.LANGUAGE_ID = C.LANGUAGE_ID(+) AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRES_REMARK_SELECT2", "SELECT COUNT(ROWID) FROM PH_PRES_REMARK WHERE REMARK_CODE = UPPER(?)");
		dataMap.put("SQL_PH_PRES_REMARK_INSERT", "INSERT INTO PH_PRES_REMARK(REMARK_CODE, REMARK_DESC,FORM_CODE, ROUTE_CODE,APPL_SLIDING_SCALE_YN, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_PRES_REMARK_UPDATE", "UPDATE PH_PRES_REMARK SET REMARK_DESC =?, FORM_CODE=?, ROUTE_CODE=?, APPL_SLIDING_SCALE_YN=?,MODIFIED_BY_ID=? , MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE REMARK_CODE=?");
		dataMap.put("SQL_PH_PRES_REMARK_DELETE", "DELETE FROM PH_PRES_REMARK WHERE REMARK_CODE=?");
		dataMap.put("SQL_PH_PRES_REMARK_KEY", "");
		dataMap.put("SQL_PH_PRES_REMARK_SELECT5", "SELECT APPL_SLIDING_SCALE_YN FROM PH_PRES_REMARK WHERE REMARK_CODE=? ");

		dataMap.put("SQL_PH_GENERIC_NAME_INSERT", "INSERT INTO PH_GENERIC_NAME (GENERIC_ID, GENERIC_NAME, DRUG_CLASS, EXTERNAL_PRODUCT_ID, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_INSERT", "INSERT INTO PH_GENERIC_NAME_BY_ATC_CLASS (GENERIC_ID, SRL_NO, ATC_CLASS_LEV1_CODE, ATC_CLASS_LEV2_CODE, ATC_CLASS_LEV3_CODE, ATC_CLASS_LEV4_CODE, ATC_CLASS_LEV5_CODE,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT1", "SELECT A.SRL_NO,A.GENERIC_ID,G.GENERIC_NAME,DECODE(G.DRUG_CLASS,'G','General','N','Narcotics','C','Controlled')DRUG_CLASS,G.EFF_STATUS,A.ATC_CLASS_LEV1_CODE,B.ATC_CLASS_LEV1_DESC, A.ATC_CLASS_LEV2_CODE,C.ATC_CLASS_LEV2_DESC,A.ATC_CLASS_LEV3_CODE,D.ATC_CLASS_LEV3_DESC, A.ATC_CLASS_LEV4_CODE,E.ATC_CLASS_LEV4_DESC, A.ATC_CLASS_LEV5_CODE,F.ATC_CLASS_LEV5_DESC FROM PH_GENERIC_NAME_BY_ATC_CLASS A, PH_ATC_CLASS_LEV1_LANG_VW B , PH_ATC_CLASS_LEV2_LANG_VW C, PH_ATC_CLASS_LEV3_LANG_VW D, PH_ATC_CLASS_LEV4_LANG_VW E, PH_ATC_CLASS_LEV5_LANG_VW F, PH_GENERIC_NAME_LANG_VW G WHERE A.GENERIC_ID = G.GENERIC_ID AND A.ATC_CLASS_LEV1_CODE = B.ATC_CLASS_LEV1_CODE AND (A.ATC_CLASS_LEV1_CODE = C.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = C.ATC_CLASS_LEV2_CODE (+)) AND (A.ATC_CLASS_LEV1_CODE = D.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = D.ATC_CLASS_LEV2_CODE (+) AND A.ATC_CLASS_LEV3_CODE = D.ATC_CLASS_LEV3_CODE (+))AND (A.ATC_CLASS_LEV1_CODE = E.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = E.ATC_CLASS_LEV2_CODE (+) AND A.ATC_CLASS_LEV3_CODE = E.ATC_CLASS_LEV3_CODE (+) AND A.ATC_CLASS_LEV4_CODE = E.ATC_CLASS_LEV4_CODE (+)) AND (A.ATC_CLASS_LEV1_CODE = F.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = F.ATC_CLASS_LEV2_CODE (+) AND A.ATC_CLASS_LEV3_CODE = F.ATC_CLASS_LEV3_CODE (+) AND A.ATC_CLASS_LEV4_CODE = F.ATC_CLASS_LEV4_CODE (+) AND A.ATC_CLASS_LEV5_CODE = F.ATC_CLASS_LEV5_CODE (+)) AND A.ATC_CLASS_LEV1_CODE = ?  AND b.language_id = g.language_id AND b.language_id = ? AND c.language_id(+) = ? AND d.language_id(+) = ? AND e.language_id(+) = ? AND f.language_id(+) = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT2", "SELECT DISTINCT B.GENERIC_ID,B.GENERIC_NAME,DECODE(B.DRUG_CLASS,'G','General','N','Narcotics','C','Controlled')DRUG_CLASS,B.EFF_STATUS FROM PH_GENERIC_NAME_BY_ATC_CLASS A, PH_GENERIC_NAME_LANG_VW B WHERE A.GENERIC_ID(+)=B.GENERIC_ID AND UPPER(B.GENERIC_NAME) LIKE UPPER(?) AND B.DRUG_CLASS LIKE ? AND B.EFF_STATUS LIKE ? AND B.LANGUAGE_ID = ? ORDER BY B.GENERIC_NAME");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT3", "SELECT NVL(MAX(TO_NUMBER(GENERIC_ID))+1,1) NEXT_GENERIC_ID FROM PH_GENERIC_NAME WHERE GENERIC_ID not in ( 'MEDICALITEM','*EXTGID') and regexp_like(generic_id, '^-?[[:digit:],.]*$')");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT4", "SELECT NVL(MAX(SRL_NO) + 1,1) NEXT_SRL_NO FROM PH_GENERIC_NAME_BY_ATC_CLASS WHERE GENERIC_ID= ? ");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT5", "SELECT A.SRL_NO,A.GENERIC_ID,G.GENERIC_NAME,G.EFF_STATUS,G.DRUG_CLASS,A.ATC_CLASS_LEV1_CODE,B.ATC_CLASS_LEV1_DESC, A.ATC_CLASS_LEV2_CODE,C.ATC_CLASS_LEV2_DESC,A.ATC_CLASS_LEV3_CODE,D.ATC_CLASS_LEV3_DESC, A.ATC_CLASS_LEV4_CODE,E.ATC_CLASS_LEV4_DESC, A.ATC_CLASS_LEV5_CODE,F.ATC_CLASS_LEV5_DESC FROM PH_GENERIC_NAME_BY_ATC_CLASS A, PH_ATC_CLASS_LEV1_LANG_VW B , PH_ATC_CLASS_LEV2_LANG_VW C, PH_ATC_CLASS_LEV3_LANG_VW D, PH_ATC_CLASS_LEV4_LANG_VW E, PH_ATC_CLASS_LEV5_LANG_VW F, PH_GENERIC_NAME_LANG_VW G WHERE A.GENERIC_ID(+) = G.GENERIC_ID  AND A.ATC_CLASS_LEV1_CODE = B.ATC_CLASS_LEV1_CODE(+) AND (A.ATC_CLASS_LEV1_CODE = C.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = C.ATC_CLASS_LEV2_CODE (+)) AND (A.ATC_CLASS_LEV1_CODE = D.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = D.ATC_CLASS_LEV2_CODE (+) AND A.ATC_CLASS_LEV3_CODE = D.ATC_CLASS_LEV3_CODE (+))AND (A.ATC_CLASS_LEV1_CODE = E.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = E.ATC_CLASS_LEV2_CODE (+) AND A.ATC_CLASS_LEV3_CODE = E.ATC_CLASS_LEV3_CODE (+) AND A.ATC_CLASS_LEV4_CODE = E.ATC_CLASS_LEV4_CODE (+)) AND (A.ATC_CLASS_LEV1_CODE = F.ATC_CLASS_LEV1_CODE (+) AND A.ATC_CLASS_LEV2_CODE = F.ATC_CLASS_LEV2_CODE (+) AND A.ATC_CLASS_LEV3_CODE = F.ATC_CLASS_LEV3_CODE (+) AND A.ATC_CLASS_LEV4_CODE = F.ATC_CLASS_LEV4_CODE (+) AND A.ATC_CLASS_LEV5_CODE = F.ATC_CLASS_LEV5_CODE (+))  AND G.GENERIC_ID = ? AND G.LANGUAGE_ID = ? AND B.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT6", "SELECT COUNT(ROWID) FROM PH_GENERIC_NAME WHERE UPPER(GENERIC_NAME) = UPPER(?)");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT7", "SELECT COUNT(*) COUNT FROM PH_GENERIC_NAME_FOR_SERVICE WHERE GENERIC_ID = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_SELECT8", "SELECT COUNT(*) COUNT FROM PH_DRUG WHERE GENERIC_ID = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_UPDATE", "UPDATE PH_GENERIC_NAME SET GENERIC_NAME = ?, DRUG_CLASS = ? , EFF_STATUS = ? , MODIFIED_BY_ID = ?, MODIFIED_DATE =  SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE GENERIC_ID = ? ");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_DELETE", "DELETE FROM PH_GENERIC_NAME_BY_ATC_CLASS WHERE GENERIC_ID = ? AND SRL_NO = ? ");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_ATC_CLASS_KEY", "SELECT A.GENERIC_ID FROM PH_GENERIC_NAME_BY_ATC_CLASS A, PH_GENERIC_NAME B WHERE A.GENERIC_ID=B.GENERIC_ID ");
		dataMap.put("JNDI_PH_GENERIC_NAME_BY_ATC_CLASS", "java:comp/env/GenericNameByATC");
		dataMap.put("JNDI_PH_GENERIC_NAME_BY_PHARMACO_CLASS", "java:comp/env/GenericNameByPharmaco");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_PHARMACO_CLASS_INSERT", "INSERT INTO PH_GEN_BY_PHARMACO_CLASS (GENERIC_ID, SRL_NO, DRUG_CLASS_GROUP_NO, DRUG_CLASS_DTL_GROUP_NO_1, DRUG_CLASS_DTL_GROUP_NO_2, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_PHARMACO_CLASS_SELECT4", "SELECT NVL(MAX(SRL_NO) + 1,1) NEXT_SRL_NO FROM PH_GEN_BY_PHARMACO_CLASS WHERE GENERIC_ID= ? ");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_PHARMACO_CLASS_SELECT5", "SELECT A.SRL_NO, A.GENERIC_ID, G.GENERIC_NAME, G.EFF_STATUS, G.DRUG_CLASS, A.DRUG_CLASS_GROUP_NO, B.DRUG_CLASS_GROUP_DESC, A.DRUG_CLASS_DTL_GROUP_NO_1, C.DRUG_CLASS_DTL_GROUP_DESC_1, A.DRUG_CLASS_DTL_GROUP_NO_2, D.DRUG_CLASS_DTL_GROUP_DESC_2 FROM PH_GEN_BY_PHARMACO_CLASS A, PH_DRUG_CLASS_HDR B, PH_DRUG_CLASS_DTL_1 C, PH_DRUG_CLASS_DTL_2 D, PH_GENERIC_NAME G WHERE  A.GENERIC_ID = G.GENERIC_ID  AND  A.DRUG_CLASS_GROUP_NO = B.DRUG_CLASS_GROUP_NO(+) AND (A.DRUG_CLASS_GROUP_NO = C.DRUG_CLASS_GROUP_NO (+) AND  A.DRUG_CLASS_DTL_GROUP_NO_1 = C.DRUG_CLASS_DTL_GROUP_NO_1 (+)) AND (A.DRUG_CLASS_GROUP_NO = D.DRUG_CLASS_GROUP_NO (+) AND  A.DRUG_CLASS_DTL_GROUP_NO_1 = D.DRUG_CLASS_DTL_GROUP_NO_1 (+) AND A.DRUG_CLASS_DTL_GROUP_NO_2 = D.DRUG_CLASS_DTL_GROUP_NO_2 (+))AND  G.GENERIC_ID = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_PHARMA_CLASS_SELECT6", "SELECT COUNT(*) COUNT FROM PH_GEN_BY_PHARMACO_CLASS WHERE GENERIC_ID = ?");

		dataMap.put("SQL_PH_AM_SERVICE_SELECT_LOOKUP", "SELECT DISTINCT A.SERVICE_CODE code, B.LONG_DESC description FROM OP_CLINIC A, AM_SERVICE_LANG_VW B WHERE A.SERVICE_CODE=B.SERVICE_CODE AND A.EFF_STATUS='E' AND A.FACILITY_ID like ? AND A.SERVICE_CODE like upper(?) AND upper(B.LONG_DESC) like upper(?) AND B.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_AM_SERVICE_IP_OP_LOOKUP", "SELECT SERVICE_CODE code,LONG_DESC description FROM AM_SERVICE_LANG_VW AM_SERVICE WHERE EFF_STATUS='E' AND SERVICE_CODE like upper(?) AND upper(LONG_DESC) like upper(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_AM_SERVICE_SELECT", "SELECT DISTINCT A.SERVICE_CODE, B.LONG_DESC FROM OP_CLINIC A, AM_SERVICE_LANG_VW B WHERE A.SERVICE_CODE=B.SERVICE_CODE AND A.EFF_STATUS='E' AND A.FACILITY_ID = ? AND B.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_SERVICE_SELECT1", "SELECT A.SERVICE_CODE, A.GENERIC_ID, C.GENERIC_NAME, A.EFF_STATUS FROM PH_GENERIC_NAME_FOR_SERVICE A,AM_SERVICE B,PH_GENERIC_NAME_LANG_VW C WHERE A.SERVICE_CODE=B.SERVICE_CODE AND A.GENERIC_ID=C.GENERIC_ID AND B.SERVICE_CODE=? AND C.LANGUAGE_ID = ? ORDER BY A.SERVICE_CODE");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_SERVICE_SELECT3", "SELECT A.SERVICE_CODE, B.LONG_DESC, A.GENERIC_ID, C.GENERIC_NAME, A.EFF_STATUS FROM PH_GENERIC_NAME_FOR_SERVICE A,AM_SERVICE_LANG_VW B,PH_GENERIC_NAME_LANG_VW C WHERE A.SERVICE_CODE=B.SERVICE_CODE AND A.GENERIC_ID=C.GENERIC_ID AND B.SERVICE_CODE LIKE UPPER(?) AND UPPER(B.LONG_DESC) LIKE UPPER(?) AND UPPER(C.GENERIC_NAME) LIKE UPPER(?) AND A.EFF_STATUS LIKE UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_SELECT1", "select A.GENERIC_ID,A.GENERIC_NAME, A.EFF_STATUS FROM PH_GENERIC_NAME_LANG_VW A WHERE UPPER(A.EFF_STATUS)='E' AND UPPER(A.GENERIC_NAME) LIKE UPPER(?) AND UPPER(A.LANGUAGE_ID) = UPPER(?) ORDER BY 2");
		dataMap.put("SQL_PH_GENERIC_NAME_COUNT_SELECT1", "select COUNT(GENERIC_ID) FROM PH_GENERIC_NAME A WHERE UPPER(A.EFF_STATUS)='E' AND UPPER(A.GENERIC_NAME) LIKE UPPER(?) ");
		dataMap.put("SQL_PH_GENERIC_NAME_SELECT3", "SELECT GENERIC_ID, GENERIC_NAME, EFF_STATUS FROM PH_GENERIC_NAME_LANG_VW PH_GENERIC_NAME WHERE EFF_STATUS='E' AND UPPER(SUBSTR(GENERIC_NAME,1,1)) NOT BETWEEN 'A' AND 'Z' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_GENERIC_NAME_COUNT_SELECT3", "select COUNT(GENERIC_ID) FROM PH_GENERIC_NAME A WHERE A.EFF_STATUS='E' AND UPPER(A.GENERIC_NAME) NOT BETWEEN 'A'  AND 'Z' ");
		dataMap.put("SQL_PH_GENERIC_NAME_SELECT2", "select A.GENERIC_ID,A.GENERIC_NAME, A.EFF_STATUS FROM PH_GENERIC_NAME_LANG_VW A WHERE A.EFF_STATUS='E' AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_SELECT_LOOKUP", "select A.GENERIC_ID code,A.GENERIC_NAME description FROM PH_GENERIC_NAME_LANG_VW A WHERE A.EFF_STATUS like 'E'  AND upper(A.GENERIC_ID) like upper(?) AND upper(A.GENERIC_NAME) like upper(?) AND A.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_SERVICE_SELECT2", "SELECT A.SERVICE_CODE, B.LONG_DESC, A.GENERIC_ID, C.GENERIC_NAME, A.EFF_STATUS FROM PH_GENERIC_NAME_FOR_SERVICE A,AM_SERVICE B,PH_GENERIC_NAME_LANG_VW C WHERE A.SERVICE_CODE=B.SERVICE_CODE AND A.GENERIC_ID=C.GENERIC_ID AND A.GENERIC_ID=? AND C.LANGUAGE_ID =? ORDER BY  2,1");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_SERVICE_INSERT", "INSERT INTO PH_GENERIC_NAME_FOR_SERVICE(SERVICE_CODE,GENERIC_ID,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_SERVICE_UPDATE", "UPDATE PH_GENERIC_NAME_FOR_SERVICE SET EFF_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE SERVICE_CODE=? AND GENERIC_ID=? ");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_SERVICE_DELETE", "DELETE PH_GENERIC_NAME_FOR_SERVICE WHERE SERVICE_CODE=? AND GENERIC_ID=? ");
		dataMap.put("SQL_PH_GENERIC_NAME_LOOKUP_SELECT", "SELECT A.GENERIC_ID,G.GENERIC_NAME,A.SRL_NO,DECODE(G.DRUG_CLASS,'G','General','C','Controlled','N','Narcotics') DRUG_CLASS, A.ATC_CLASS_LEV1_CODE,B.ATC_CLASS_LEV1_DESC,A.ATC_CLASS_LEV2_CODE,C.ATC_CLASS_LEV2_DESC,A.ATC_CLASS_LEV3_CODE,D.ATC_CLASS_LEV3_DESC,A.ATC_CLASS_LEV4_CODE,E.ATC_CLASS_LEV4_DESC,A.ATC_CLASS_LEV5_CODE,F.ATC_CLASS_LEV5_DESC FROM PH_GENERIC_NAME_BY_ATC_CLASS A,PH_ATC_CLASS_LEV1 B,PH_ATC_CLASS_LEV2 C ,PH_ATC_CLASS_LEV3 D,PH_ATC_CLASS_LEV4 E,PH_ATC_CLASS_LEV5 F, PH_GENERIC_NAME G WHERE G.GENERIC_ID=A.GENERIC_ID AND A.GENERIC_ID=? AND A.ATC_CLASS_LEV1_CODE=B.ATC_CLASS_LEV1_CODE AND A.ATC_CLASS_LEV2_CODE=C.ATC_CLASS_LEV2_CODE(+) AND A.ATC_CLASS_LEV3_CODE=D.ATC_CLASS_LEV3_CODE(+) AND A.ATC_CLASS_LEV4_CODE=E.ATC_CLASS_LEV4_CODE(+) AND A.ATC_CLASS_LEV5_CODE=F.ATC_CLASS_LEV5_CODE(+) GROUP BY A.SRL_NO,A.GENERIC_ID,G.GENERIC_NAME,G.DRUG_CLASS,A.ATC_CLASS_LEV1_CODE,B.ATC_CLASS_LEV1_DESC, A.ATC_CLASS_LEV2_CODE,C.ATC_CLASS_LEV2_DESC, A.ATC_CLASS_LEV3_CODE,D.ATC_CLASS_LEV3_DESC, A.ATC_CLASS_LEV4_CODE,E.ATC_CLASS_LEV4_DESC, A.ATC_CLASS_LEV5_CODE,F.ATC_CLASS_LEV5_DESC ORDER BY 2,1");
		dataMap.put("SQL_PH_GENERIC_NAME_BY_PHARMACO_SELECT" , "SELECT GENERIC_NAME, DRUG_CLASS, EFF_STATUS FROM PH_GENERIC_NAME WHERE GENERIC_ID IN (SELECT GENERIC_ID FROM PH_GEN_BY_PHARMACO_CLASS WHERE DRUG_CLASS_GROUP_NO= ? ");
		dataMap.put("JNDI_PH_GENERIC_NAME_FOR_SERVICE", "java:comp/env/GenericNameForService");
		
		//param
		dataMap.put("SQL_PH_PARAM_SELECT1", "SELECT FREQ_CODE,FREQ_DESC FROM AM_FREQUENCY WHERE REPEAT_DURN_TYPE='D' ORDER BY 2 ");
		dataMap.put("SQL_PH_PARAM_SELECT2", "SELECT FREQ_CODE,FREQ_DESC FROM AM_FREQUENCY WHERE REPEAT_VALUE=1 AND REPEAT_DURN_TYPE='D' ORDER BY 2");
		dataMap.put("SQL_PH_PARAM_SELECT3", "SELECT ROUTE_CODE,ROUTE_DESC,ROUTE_COLOR FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_PARAM_SELECT4", "SELECT COUNT(ROWID) COUNT FROM SM_MODULE WHERE MODULE_ID='ST' AND INSTALL_YN='Y' ");
		dataMap.put("SQL_PH_PARAM_SELECT5", "SELECT DRUG_ITEM_CODE_LINK_REQD_YN, DRUG_AND_ITEM_CODE_SAME_IND, DRUG_CODE_GEN_RULE, DRUG_TO_ITEM_MAPPING,DFLT_SPLIT_DOSE_FREQ_CODE, DFLT_STAT_DOSE_FREQ_CODE, DFLT_IV_ROUTE_CODE, MEDN_ORDER_BY, MAX_DURN_FOR_OP_PRES,REFILL_YN, MAX_REFILLS_FOR_PRES, PRINT_REFILL_PRES_WITH_MAIN_YN, MAX_DURN_FOR_REFILL_PRES, MAX_DURN_FOR_IP_PRES,ALLOW_SEL_BY_ATC_YN, DISP_MULTI_STRENGTH_YN, DISP_BEFORE_START_DATE_YN, DISP_BEFORE_NO_OF_DAYS,DISP_BEYOND_EARLIEST_START_YN,DISP_BEYOND_NO_OF_DAYS,ALLOW_SEL_BY_ATC_YN,DISP_ALT_FORM_YN,DRUG_DB_INTERFACE_YN,REGN_STAGE_PROMPT, VERIFY_STAGE_PROMPT, FILL_STAGE_PROMPT, ALLOCATE_STAGE_PROMPT, BILL_RECEIPT_STAGE_PROMPT,DELIVER_STAGE_PROMPT, APPL_FREQ_FOR_TPN,ELAPSED_PRD_OF_ORD_FOR_ADR,IV_DRUG_FLUID_CONTINUOUS_LG,IV_DRUG_FLUID_INTERMITTENT_LG,IV_WITHOUT_ADDITIVES_LG, BUILD_SETUP_LOG_YN,ITEM_IMAGE_PATH FROM PH_PARAM_LANG_VW PH_PARAM WHERE MODULE_ID='PH' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PARAM_SELECT5A","select DFLT_IV_ROUTE_CODE FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_PARAM_SELECT6", "SELECT COUNT(ROWID) FROM SM_MODULE WHERE MODULE_ID='IP' AND INSTALL_YN='Y' ");
		dataMap.put("SQL_PH_PARAM_SELECT7", "SELECT PRODUCT_ID, PRODUCT_DESC FROM PH_EXTERNAL_PRODUCT_LANG_VW PH_EXTERNAL_PRODUCT WHERE EFF_STATUS = 'E' AND LANGUAGE_ID = ?");
        dataMap.put("SQL_PH_PARAM_SELECT8", "SELECT DRUG_ITEM_CODE_LINK_REQD_YN, DRUG_AND_ITEM_CODE_SAME_IND, DRUG_CODE_GEN_RULE, DRUG_TO_ITEM_MAPPING,DFLT_SPLIT_DOSE_FREQ_CODE, DFLT_STAT_DOSE_FREQ_CODE, DFLT_IV_ROUTE_CODE, MEDN_ORDER_BY, MAX_DURN_FOR_OP_PRES,REFILL_YN, MAX_REFILLS_FOR_PRES, PRINT_REFILL_PRES_WITH_MAIN_YN, MAX_DURN_FOR_REFILL_PRES, MAX_DURN_FOR_IP_PRES,ALLOW_SEL_BY_ATC_YN, DISP_MULTI_STRENGTH_YN, DISP_BEFORE_START_DATE_YN, DISP_BEFORE_NO_OF_DAYS,DISP_BEYOND_EARLIEST_START_YN,DISP_BEYOND_NO_OF_DAYS,ALLOW_SEL_BY_ATC_YN,DISP_ALT_FORM_YN,DRUG_DB_INTERFACE_YN,REGN_STAGE_PROMPT, VERIFY_STAGE_PROMPT, FILL_STAGE_PROMPT, ALLOCATE_STAGE_PROMPT, BILL_RECEIPT_STAGE_PROMPT,DELIVER_STAGE_PROMPT, APPL_FREQ_FOR_TPN,ELAPSED_PRD_OF_ORD_FOR_ADR,IV_DRUG_FLUID_CONTINUOUS_LG,IV_DRUG_FLUID_INTERMITTENT_LG,IV_WITHOUT_ADDITIVES_LG, BUILD_SETUP_LOG_YN,ITEM_IMAGE_PATH,PRINT_ALT_DRUG_DOSAGE_QTY_YN,ISSUE_UOM_BY,MAX_DURN_FOR_DM_PRES,TRADE_DISPLAY_YN FROM PH_PARAM_LANG_VW PH_PARAM WHERE MODULE_ID='PH' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PARAM_INSERT", "INSERT INTO PH_PARAM(MODULE_ID, DRUG_ITEM_CODE_LINK_REQD_YN, DRUG_AND_ITEM_CODE_SAME_IND, DRUG_CODE_GEN_RULE, DRUG_TO_ITEM_MAPPING, DFLT_SPLIT_DOSE_FREQ_CODE, DFLT_STAT_DOSE_FREQ_CODE, DFLT_IV_ROUTE_CODE, MEDN_ORDER_BY, MAX_DURN_FOR_OP_PRES, REFILL_YN, MAX_REFILLS_FOR_PRES, PRINT_REFILL_PRES_WITH_MAIN_YN, MAX_DURN_FOR_REFILL_PRES, MAX_DURN_FOR_IP_PRES,  DISP_MULTI_STRENGTH_YN, DISP_BEFORE_START_DATE_YN, DISP_BEFORE_NO_OF_DAYS, DISP_BEYOND_EARLIEST_START_YN, DISP_BEYOND_NO_OF_DAYS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,ALLOW_SEL_BY_ATC_YN,DISP_ALT_FORM_YN,DRUG_DB_INTERFACE_YN, REGN_STAGE_PROMPT, VERIFY_STAGE_PROMPT, FILL_STAGE_PROMPT, ALLOCATE_STAGE_PROMPT, BILL_RECEIPT_STAGE_PROMPT, DELIVER_STAGE_PROMPT,APPL_FREQ_FOR_TPN,ELAPSED_PRD_OF_ORD_FOR_ADR,IV_DRUG_FLUID_CONTINUOUS_LG,IV_DRUG_FLUID_INTERMITTENT_LG,IV_WITHOUT_ADDITIVES_LG, BUILD_SETUP_LOG_YN,ITEM_IMAGE_PATH,PRINT_ALT_DRUG_DOSAGE_QTY_YN,ISSUE_UOM_BY,MAX_DURN_FOR_DM_PRES,TRADE_DISPLAY_YN) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_PARAM_UPDATE", "UPDATE PH_PARAM SET DRUG_ITEM_CODE_LINK_REQD_YN=?, DRUG_AND_ITEM_CODE_SAME_IND =?, DRUG_CODE_GEN_RULE = ?, DRUG_TO_ITEM_MAPPING =?, DFLT_SPLIT_DOSE_FREQ_CODE = ?, DFLT_STAT_DOSE_FREQ_CODE =?, DFLT_IV_ROUTE_CODE = ?, MEDN_ORDER_BY= ?, MAX_DURN_FOR_OP_PRES =?, REFILL_YN =?, MAX_REFILLS_FOR_PRES = ?, PRINT_REFILL_PRES_WITH_MAIN_YN = ?, MAX_DURN_FOR_REFILL_PRES = ?, MAX_DURN_FOR_IP_PRES = ?, DISP_MULTI_STRENGTH_YN = ?,  DISP_BEFORE_START_DATE_YN  = ?, DISP_BEFORE_NO_OF_DAYS = ?, DISP_BEYOND_EARLIEST_START_YN = ?, DISP_BEYOND_NO_OF_DAYS = ?,ALLOW_SEL_BY_ATC_YN=?,DISP_ALT_FORM_YN=?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? ,DRUG_DB_INTERFACE_YN=?,REGN_STAGE_PROMPT=?, VERIFY_STAGE_PROMPT=?, FILL_STAGE_PROMPT=?, ALLOCATE_STAGE_PROMPT=?, BILL_RECEIPT_STAGE_PROMPT=?, DELIVER_STAGE_PROMPT=?, APPL_FREQ_FOR_TPN=? ,ELAPSED_PRD_OF_ORD_FOR_ADR=?,    IV_DRUG_FLUID_CONTINUOUS_LG =?,IV_DRUG_FLUID_INTERMITTENT_LG= ?,    IV_WITHOUT_ADDITIVES_LG= ?, BUILD_SETUP_LOG_YN=?,ITEM_IMAGE_PATH = ?,PRINT_ALT_DRUG_DOSAGE_QTY_YN=?, ISSUE_UOM_BY=?,MAX_DURN_FOR_DM_PRES=?,TRADE_DISPLAY_YN=? WHERE MODULE_ID='PH'");

		dataMap.put("SQL_PH_DRUG_UOM_SELECT1", "SELECT UOM_CODE, EQVL_UOM_CODE, EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE = UPPER(?) ORDER BY EQVL_VALUE");
		dataMap.put("SQL_PH_DRUG_CATG_INSERT", "INSERT INTO PH_DRUG_CATG (DRUG_CATG_CODE, LONG_DESC, SHORT_DESC, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_DRUG_CATG_SELECT1", "SELECT A.DRUG_CATG_CODE, A.LONG_DESC, A.SHORT_DESC, A.EFF_STATUS FROM PH_DRUG_CATG_LANG_VW A WHERE UPPER(DRUG_CATG_CODE) LIKE UPPER(?) AND UPPER(LONG_DESC) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?) AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_CATG_SELECT2", "SELECT A.DRUG_CATG_CODE, A.LONG_DESC, A.SHORT_DESC, A.EFF_STATUS FROM PH_DRUG_CATG A WHERE A.DRUG_CATG_CODE = ? ");
		dataMap.put("SQL_PH_DRUG_CATG_SELECT3", "SELECT COUNT(ROWID) FROM PH_DRUG_CATG WHERE DRUG_CATG_CODE = UPPER(?) ");
		dataMap.put("SQL_PH_DRUG_CATG_SELECT4", "SELECT A.DRUG_CATG_CODE, A.LONG_DESC, A.SHORT_DESC, A.EFF_STATUS FROM PH_DRUG_CATG A WHERE A.DRUG_CATG_CODE = ? ");
		dataMap.put("SQL_PH_DRUG_CATG_UPDATE", "UPDATE PH_DRUG_CATG SET LONG_DESC = ?, SHORT_DESC = ?, EFF_STATUS = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE DRUG_CATG_CODE = ? ");
		dataMap.put("SQL_PH_DRUG_CATG_KEY", "SELECT A.DRUG_CATG_CODE FROM PH_DRUG_CATG A WHERE A.DRUG_CATG_CODE LIKE UPPER(?) AND UPPER(A.LONG_DESC) LIKE UPPER(?) AND UPPER(A.EFF_STATUS) LIKE UPPER(?) ");
		dataMap.put("JNDI_PH_DRUG_CATG", "java:comp/env/DrugCategory");

		dataMap.put("SQL_PH_SM_MODULE_IP_SELECT", "SELECT COUNT(ROWID) TOTAL_RECORDS FROM SM_MODULE WHERE MODULE_ID='IP' ");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT", "SELECT 'N' PAT_INSTR_LOC_LANG_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID= ?");
		dataMap.put("SQL_PH_LABEL_TEXT_CAUTION_MAX_200_SELECT", "select CRIT_FIELD_VAL, CRIT_FIELD_ID from  PH_DISP_MEDN_DFLT where facility_id=? and FUNCTION_ID = ? and  CRIT_FIELD_ID in( ?)");
		dataMap.put("SQL_PH_FORM_SELECT1", "SELECT FORM_CODE, FORM_DESC, FORM_CODE_LOC_LANG, FORM_DESC_LOC_LANG , EFF_STATUS FROM PH_FORM_LANG_VW PH_FORM WHERE FORM_CODE LIKE UPPER(?) AND UPPER(FORM_DESC) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_FORM_SELECT2", "SELECT FORM_CODE, FORM_DESC, FORM_CODE_LOC_LANG, FORM_DESC_LOC_LANG , EFF_STATUS FROM PH_FORM WHERE FORM_CODE = UPPER(?)  ");
		dataMap.put("SQL_PH_FORM_SELECT3", "SELECT COUNT(ROWID) FROM PH_FORM WHERE FORM_CODE = UPPER(?)  ");

		dataMap.put("SQL_PH_DRUG_NAME_SELECT1", "select PROMPT_ALERT_YN,PROMPT_ALERT_MSG from or_order_Catalog where order_Catalog_code = UPPER(?)  ");
		dataMap.put("SQL_PH_DRUG_SLIDING_SCALE_TMPL_DELETE1", "DELETE  FROM PH_DRUG_SLIDING_SCALE_TMPL WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DRUG_SLIDING_SCALE_TMPL_INSERT", "INSERT INTO PH_DRUG_SLIDING_SCALE_TMPL(DRUG_CODE, TEMPLATE_ID,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_SELECT1", "SELECT TEMPLATE_ID, TEMPLATE_DESC, EFF_STATUS FROM PH_SLIDING_SCALE_TMPL");
		dataMap.put("SQL_PH_DRUG_SLIDING_SCALE_TMPL_SELECT", "SELECT TEMPLATE_ID FROM PH_DRUG_SLIDING_SCALE_TMPL WHERE DRUG_CODE=?");


		dataMap.put("SQL_PH_FORM_KEY", "SELECT FORM_CODE FROM PH_FORM WHERE FORM_CODE LIKE UPPER(?) AND UPPER(FORM_DESC) LIKE (?) AND FORM_CODE_LOC_LANG LIKE (?) AND  UPPER(FORM_DESC_LOC_LANG) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?)  ");
		dataMap.put("SQL_PH_FORM_INSERT", "INSERT INTO PH_FORM (FORM_CODE, FORM_DESC, FORM_CODE_LOC_LANG, FORM_DESC_LOC_LANG, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_FORM_UPDATE", "UPDATE PH_FORM SET FORM_DESC = ?, FORM_CODE_LOC_LANG = ?, FORM_DESC_LOC_LANG = ?, EFF_STATUS = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE FORM_CODE= ? ");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT1", "SELECT DRUG_ITEM_CODE_LINK_REQD_YN, REFILL_YN, MAX_REFILLS_FOR_PRES, PRINT_REFILL_PRES_WITH_MAIN_YN, MAX_DURN_FOR_REFILL_PRES , DISP_BEFORE_START_DATE_YN,DISP_BEFORE_NO_OF_DAYS,DISP_BEYOND_EARLIEST_START_YN,DISP_BEYOND_NO_OF_DAYS,MAX_DURN_FOR_IP_PRES FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT2", "SELECT MODULE_ID, COUNT(ROWID) FROM SM_MODULE WHERE MODULE_ID IN ('IP','BL') AND INSTALL_YN='Y'    GROUP BY MODULE_ID");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT2A", "SELECT DISCR_MSR_ID,SHORT_DESC FROM AM_DISCR_MSR WHERE result_type='Z' and eff_status='E' ORDER BY 2");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT2B", "SELECT SHORT_DESC FROM AM_DISCR_MSR_LANG_VW AM_DISCR_MSR WHERE  DISCR_MSR_ID=? AND LANGUAGE_ID = ?");
        dataMap.put("SQL_PH_FACILITY_PARAM_SELECT2C", "SELECT NOTE_TYPE_DESC FROM CA_NOTE_TYPE_LANG_VW CA_NOTE_TYPE WHERE  NOTE_TYPE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT2D", "SELECT DISCR_MSR_ID CODE,SHORT_DESC DESCRIPTION FROM AM_DISCR_MSR_LANG_VW AM_DISCR_MSR WHERE  UPPER(DISCR_MSR_ID) LIKE UPPER(?) AND UPPER(SHORT_DESC)LIKE UPPER(?) and RESULT_TYPE='Z' AND EFF_STATUS='E'  AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT2E", "SELECT NOTE_TYPE CODE,NOTE_TYPE_DESC DESCRIPTION FROM CA_NOTE_TYPE_LANG_VW CA_NOTE_TYPE WHERE UPPER(NOTE_TYPE)LIKE UPPER(?)AND UPPER(NOTE_TYPE_DESC) LIKE UPPER(?) AND NOTE_GROUP_ID = '*PH01'   AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT3", "SELECT FACILITY_ID, INTERFACE_TO_ST_YN, 'N' PAT_INSTR_LOC_LANG_YN, CONSIDER_STOCK_FOR_PRES_YN, ALLOW_PRES_WITHOUT_STOCK_YN, REFILL_YN, MAX_REFILLS_FOR_PRES, PRINT_REFILL_PRES_WITH_MAIN_YN, MAX_DURN_FOR_REFILL_PRES, DISP_BEFORE_START_DATE_YN, DISP_BEFORE_NO_OF_DAYS, DISP_BEYOND_EARLIEST_START_YN, DISP_BEYOND_NO_OF_DAYS, DISP_REGN_REQD_YN, DISP_FLNG_REQD_YN, DISP_DELV_REQD_YN, PRINT_DISP_SHEET_OP_YN, DFLT_LANG_FOR_DISP_LABEL, LABEL_FORMAT_OP, ALLOW_DRUG_RETURN_YN, MAX_DRUG_RETENTION_BEF_RTN, MAX_DURN_FOR_OP_MED_RTN, IP_VERF_YN, IP_FILL_PRD_AHEAD, IP_FILL_PRD_UNIT, IP_FILL_EXCL_PRD_BEHIND, IP_DELV_REQD_YN, TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') IP_FILL_DFLT_START_TIME, DFLT_LANG_FOR_DISP_LABEL_IP, IP_LABEL_FORMAT, IP_DISP_LOCN_RTN_ORD, IP_DISP_LOCN_STAT_ORD, INTERFACE_TO_BL_YN,              OP_DISP_LOCN_RTN_ORD,OP_DISP_LOCN_STAT_ORD,IP_DISP_LOCN_RTN_ORD,IP_DISP_LOCN_STAT_ORD,DISCH_MED_DISP_LOCN ,PRINT_BAL_MED_SHEET_OP_YN,DISP_VERF_STAGE,DISP_FILL_STAGE,MED_ADMIN_REQD_YN, VERF_REQD_BEF_MED_ADMIN_YN, REC_ADMIN_WITHIN_HRS, ALLOW_MED_ADMIN_WO_ORD_YN,IP_CONSIDER_STOCK_PRES_YN,IP_PRES_WITHOUT_STOCK_YN,ALLOW_DUPLICATE_DRUG, ALLOW_MEDN_ORDER_WITHOUT_DIAG,'Y' ALLOW_MEDN_ORDER_WITHOUT_WT,DISP_UNALLOC_DRUGS_AT_DEL_STG,PRINT_EXP_DATE_FOR_EXP_ITEM,IV_ADMIXTURE_APPL_YN,CDR_ADMIXTURE_APPL_YN,TPN_REGIMEN_APPL_YN,TO_CHAR(WORKING_HRS_OF_PREP_ROOM_FROM,'HH24:MI') WORKING_HRS_OF_PREP_ROOM_FROM,TO_CHAR(WORKING_HRS_OF_PREP_ROOM_TO,'HH24:MI') WORKING_HRS_OF_PREP_ROOM_TO,ALERT_PRACTITIONER_YN,VERIFY_TDM_ORDER_YN,TDM_RESULT_TYPE, TDM_RESULT_TYPE_ID ,START_ADR_NO,LAST_ADR_NO,PAT_COUNS_RESULT_TYPE, PAT_COUNS_RESULT_TYPE_ID ,DIR_DISP_ALLOWED, APPL_PT_CLASS, APPL_ENCTRS, HOW_MANY_ENCTRS,  ENCTRS_DTLS_REQD_DUR_DIR_DISP, DUPLICATE_CHECK_AT_ATC_YN,MANDATORY_REM_ON_PRN_FREQ_YN,COMP_RX_APPL_YN, IV_RX_APPL_YN,ONCOLOGY_RX_APPL_YN,TPN_RX_APPL_YN,	TDM_APPL_YN,DC_MAR_APPL_YN,EM_MAR_APPL_YN,IP_MAR_APPL_YN,OP_MAR_APPL_YN,DISP_CHARGE_DTL_IN_DRUG_LKP_YN,DISP_CHARGE_DTL_IN_RX_YN,DISP_PRICE_TYPE_IN_DRUG_LKP, DISCH_MED_MAR_APPL_YN,ADMX_PREP_CHARGES_APPL_YN,SPLIT_BASED_PRIORITY_YN, SPLIT_BASED_DRUG_CLASS_YN,DFLT_DIR_DISP_LOCN,DFLT_EXT_RX_DISP_LOCN,TPN_SCREENING_FORM_ID,TPN_SCREENING_TYPE,ONCOLOGY_SCREENING_FORM_ID,ONCOLOGY_SCREENING_TYPE,DRUG_CAT_PIN_AUTH_REQD_YN,ALLOW_SHORT_EXPIRY_DRUGS_YN,COPY_PRES_UPTO_NO_OF_DAYS FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT4", "SELECT COUNT(ROWID) FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT5", "SELECT COUNT(ROWID) FROM PH_FACILITY_PARAM WHERE FACILITY_ID=? ");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT6", "SELECT A.DISP_LOCN_CODE ,A.SHORT_DESC FROM PH_DISP_LOCN_LANG_VW A WHERE A.FACILITY_ID=? AND  A.DISP_LOCN_CATEGORY IN ('O','B') and A.DISP_LOCN_TYPE IN ('P','C') AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT7", "SELECT INSTALL_YN FROM SM_MODULE WHERE MODULE_ID = 'BL' ");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT8", "SELECT A.DISP_LOCN_CODE ,A.SHORT_DESC FROM PH_DISP_LOCN_LANG_VW A WHERE A.FACILITY_ID=? AND A.DISP_LOCN_CATEGORY IN ('I','B') and A.DISP_LOCN_TYPE IN ('P','N') AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT9", "SELECT A.DISP_LOCN_CODE ,A.SHORT_DESC FROM PH_DISP_LOCN_LANG_VW A WHERE A.FACILITY_ID=? AND A.DISP_LOCN_CATEGORY IN ('I','O','B') and A.DISP_LOCN_TYPE IN ('P') AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT10", "SELECT COUNT(ROWID) FROM SM_MODULE WHERE MODULE_ID='PH' AND INSTALL_YN='Y' ");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT11","SELECT REFILL_YN FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_FACILITY_PARAM_SELECT12","SELECT DRUG_DB_INTERFACE_YN,DRUG_DB_PRODUCT_ID,DRUG_DB_DOSECHECK_YN,DRUG_DB_DUPTHERAPY_YN,DRUG_DB_INTERACT_CHECK_YN,DRUG_DB_CONTRAIND_CHECK_YN,DRUG_DB_ALLERGY_CHECK_YN FROM PH_FACILITY_PARAM  WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_FACILITY_PARAM_DIRECT_DISP_LOCN_SELECT","Select disp_locn_code,SHORT_DESC from ph_disp_locn_lang_vw where facility_id=? and eff_status='E' AND DIRECT_DISP_ALLOWED_YN ='Y' and language_id=? and DISP_LOCN_TYPE='P' Order by short_desc");
		dataMap.put("SQL_PH_FACILITY_PARAM_EXT_PRES_DISP_LOCN_SELECT","Select disp_locn_code,SHORT_DESC from ph_disp_locn_lang_vw where facility_id=? and eff_status='E' AND EXTERNAL_RX_ALLOWED_YN='Y' and language_id=? and DISP_LOCN_TYPE='P' Order by short_desc");
		dataMap.put("SQL_PH_FACILITY_PARAM_INSERT", "INSERT INTO PH_FACILITY_PARAM(FACILITY_ID, INTERFACE_TO_ST_YN, PAT_INSTR_LOC_LANG_YN, CONSIDER_STOCK_FOR_PRES_YN, ALLOW_PRES_WITHOUT_STOCK_YN, REFILL_YN, MAX_REFILLS_FOR_PRES, PRINT_REFILL_PRES_WITH_MAIN_YN, MAX_DURN_FOR_REFILL_PRES, DISP_BEFORE_START_DATE_YN, DISP_BEFORE_NO_OF_DAYS, DISP_BEYOND_EARLIEST_START_YN, DISP_BEYOND_NO_OF_DAYS, DISP_FLNG_REQD_YN,DISP_FILL_STAGE,DISP_DELV_REQD_YN, PRINT_DISP_SHEET_OP_YN, DFLT_LANG_FOR_DISP_LABEL, LABEL_FORMAT_OP, ALLOW_DRUG_RETURN_YN, MAX_DRUG_RETENTION_BEF_RTN, MAX_DURN_FOR_OP_MED_RTN, IP_VERF_YN, IP_FILL_PRD_UNIT, IP_FILL_PRD_AHEAD, IP_FILL_EXCL_PRD_BEHIND, IP_DELV_REQD_YN, IP_FILL_DFLT_START_TIME, DFLT_LANG_FOR_DISP_LABEL_IP, IP_LABEL_FORMAT, INTERFACE_TO_BL_YN, OP_DISP_LOCN_RTN_ORD, OP_DISP_LOCN_STAT_ORD, DISP_REGN_REQD_YN, DISP_VERF_STAGE, PRINT_BAL_MED_SHEET_OP_YN, IP_DISP_LOCN_RTN_ORD, IP_DISP_LOCN_STAT_ORD, DISCH_MED_DISP_LOCN, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,MED_ADMIN_REQD_YN, VERF_REQD_BEF_MED_ADMIN_YN, REC_ADMIN_WITHIN_HRS, ALLOW_MED_ADMIN_WO_ORD_YN,IP_CONSIDER_STOCK_PRES_YN,  IP_PRES_WITHOUT_STOCK_YN,ALLOW_DUPLICATE_DRUG,ALLOW_MEDN_ORDER_WITHOUT_DIAG,ALLOW_MEDN_ORDER_WITHOUT_WT,DISP_UNALLOC_DRUGS_AT_DEL_STG,PRINT_EXP_DATE_FOR_EXP_ITEM,DIR_DISP_ALLOWED, APPL_PT_CLASS, APPL_ENCTRS, HOW_MANY_ENCTRS,  ENCTRS_DTLS_REQD_DUR_DIR_DISP,DUPLICATE_CHECK_AT_ATC_YN,MANDATORY_REM_ON_PRN_FREQ_YN, COMP_RX_APPL_YN, IV_RX_APPL_YN, ONCOLOGY_RX_APPL_YN, TPN_RX_APPL_YN, TDM_APPL_YN, TDM_RESULT_TYPE, PAT_COUNS_RESULT_TYPE ,tdm_result_type_id, pat_couns_result_type_id,DRUG_DB_INTERFACE_YN,DRUG_DB_PRODUCT_ID,DRUG_DB_DOSECHECK_YN,DRUG_DB_DUPTHERAPY_YN,DRUG_DB_INTERACT_CHECK_YN,DRUG_DB_CONTRAIND_CHECK_YN,DRUG_DB_ALLERGY_CHECK_YN,DC_MAR_APPL_YN,EM_MAR_APPL_YN,IP_MAR_APPL_YN,OP_MAR_APPL_YN,DISP_CHARGE_DTL_IN_DRUG_LKP_YN,DISP_CHARGE_DTL_IN_RX_YN,DISP_PRICE_TYPE_IN_DRUG_LKP,DISCH_MED_MAR_APPL_YN,ADMX_PREP_CHARGES_APPL_YN,SPLIT_BASED_PRIORITY_YN,SPLIT_BASED_DRUG_CLASS_YN,DFLT_DIR_DISP_LOCN,DFLT_EXT_RX_DISP_LOCN,TPN_SCREENING_FORM_ID,TPN_SCREENING_TYPE,ONCOLOGY_SCREENING_FORM_ID,ONCOLOGY_SCREENING_TYPE,DRUG_CAT_PIN_AUTH_REQD_YN,ALLOW_SHORT_EXPIRY_DRUGS_YN,COPY_PRES_UPTO_NO_OF_DAYS) VALUES (?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, TO_DATE(TO_CHAR(SYSDATE,'DD/MM/RRRR') ||?,'DD/MM/RRRR HH24:MI'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,SYSDATE, ?, ?, ?, SYSDATE, ?, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_FACILITY_PARAM_UPDATE", "UPDATE PH_FACILITY_PARAM SET INTERFACE_TO_ST_YN =?, PAT_INSTR_LOC_LANG_YN=?, CONSIDER_STOCK_FOR_PRES_YN=?, ALLOW_PRES_WITHOUT_STOCK_YN=?, REFILL_YN=?,  MAX_REFILLS_FOR_PRES=?, PRINT_REFILL_PRES_WITH_MAIN_YN=?, MAX_DURN_FOR_REFILL_PRES=?,  DISP_BEFORE_START_DATE_YN=?, DISP_BEFORE_NO_OF_DAYS=?, DISP_BEYOND_EARLIEST_START_YN=?,   DISP_BEYOND_NO_OF_DAYS=?, DISP_FLNG_REQD_YN=?,DISP_FILL_STAGE=?, DISP_DELV_REQD_YN=?, PRINT_DISP_SHEET_OP_YN=?, DFLT_LANG_FOR_DISP_LABEL=?,   LABEL_FORMAT_OP=?, ALLOW_DRUG_RETURN_YN=?, MAX_DRUG_RETENTION_BEF_RTN=?,   MAX_DURN_FOR_OP_MED_RTN=?, IP_VERF_YN=?, IP_FILL_PRD_UNIT=?, IP_FILL_PRD_AHEAD=?,    IP_FILL_EXCL_PRD_BEHIND=?, IP_DELV_REQD_YN=?,    IP_FILL_DFLT_START_TIME=TO_DATE(TO_CHAR(SYSDATE,'DD/MM/RRRR') ||?,'DD/MM/RRRR HH24:MI'),    DFLT_LANG_FOR_DISP_LABEL_IP=?, IP_LABEL_FORMAT=?, INTERFACE_TO_BL_YN=?,	 OP_DISP_LOCN_RTN_ORD=?, OP_DISP_LOCN_STAT_ORD=?, DISP_REGN_REQD_YN=?, 	 DISP_VERF_STAGE=?, PRINT_BAL_MED_SHEET_OP_YN=?, IP_DISP_LOCN_RTN_ORD=?, 	 IP_DISP_LOCN_STAT_ORD=?, DISCH_MED_DISP_LOCN=?, MODIFIED_BY_ID=?, 	 MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID =? ,	 IV_ADMIXTURE_APPL_YN=?,CDR_ADMIXTURE_APPL_YN=?,TPN_REGIMEN_APPL_YN=?,	 WORKING_HRS_OF_PREP_ROOM_FROM=TO_DATE(TO_CHAR(SYSDATE,'DD/MM/RRRR') ||?,'DD/MM/RRRR HH24:MI'),	 WORKING_HRS_OF_PREP_ROOM_TO=TO_DATE(TO_CHAR(SYSDATE,'DD/MM/RRRR') ||?,'DD/MM/RRRR HH24:MI'),	 ALERT_PRACTITIONER_YN=?,VERIFY_TDM_ORDER_YN=?,tdm_result_type_id=?,	 pat_couns_result_type_id=?,START_ADR_NO=?,LAST_ADR_NO=?,MED_ADMIN_REQD_YN=?, 	 VERF_REQD_BEF_MED_ADMIN_YN=?, REC_ADMIN_WITHIN_HRS=?, ALLOW_MED_ADMIN_WO_ORD_YN=?,	 IP_CONSIDER_STOCK_PRES_YN=?, IP_PRES_WITHOUT_STOCK_YN=?,ALLOW_DUPLICATE_DRUG=?,	 ALLOW_MEDN_ORDER_WITHOUT_DIAG=?,ALLOW_MEDN_ORDER_WITHOUT_WT=?,	 DISP_UNALLOC_DRUGS_AT_DEL_STG = ?,PRINT_EXP_DATE_FOR_EXP_ITEM=? ,	  DIR_DISP_ALLOWED=?, APPL_PT_CLASS=?, APPL_ENCTRS=?, HOW_MANY_ENCTRS=?, ENCTRS_DTLS_REQD_DUR_DIR_DISP=?, DUPLICATE_CHECK_AT_ATC_YN=?,MANDATORY_REM_ON_PRN_FREQ_YN=?,COMP_RX_APPL_YN=?, IV_RX_APPL_YN=?,ONCOLOGY_RX_APPL_YN=?,TPN_RX_APPL_YN=?,	TDM_APPL_YN=?, tdm_result_type=?,pat_couns_result_type=?,DRUG_DB_INTERFACE_YN=?,DRUG_DB_PRODUCT_ID=?,DRUG_DB_DOSECHECK_YN=?,DRUG_DB_DUPTHERAPY_YN=?,DRUG_DB_INTERACT_CHECK_YN=?,DRUG_DB_CONTRAIND_CHECK_YN=?,DRUG_DB_ALLERGY_CHECK_YN=?,DC_MAR_APPL_YN=?,EM_MAR_APPL_YN=?,IP_MAR_APPL_YN=?,OP_MAR_APPL_YN=?,DISP_CHARGE_DTL_IN_DRUG_LKP_YN = ?,DISP_CHARGE_DTL_IN_RX_YN=?,DISP_PRICE_TYPE_IN_DRUG_LKP=?, DISCH_MED_MAR_APPL_YN=?,ADMX_PREP_CHARGES_APPL_YN=?,SPLIT_BASED_PRIORITY_YN=?,SPLIT_BASED_DRUG_CLASS_YN=?, DFLT_DIR_DISP_LOCN=?,DFLT_EXT_RX_DISP_LOCN=?,TPN_SCREENING_FORM_ID=?,TPN_SCREENING_TYPE=?,ONCOLOGY_SCREENING_FORM_ID=?,ONCOLOGY_SCREENING_TYPE=?,DRUG_CAT_PIN_AUTH_REQD_YN=?,ALLOW_SHORT_EXPIRY_DRUGS_YN=?,COPY_PRES_UPTO_NO_OF_DAYS=? WHERE FACILITY_ID = ?");		

		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT1", "SELECT A.DRUG_CATG_CODE, A.SHORT_DESC FROM         PH_DRUG_CATG A WHERE EFF_STATUS = 'E' ORDER BY 2 ");
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT2", "SELECT PATIENT_CLASS, SHORT_DESC FROM AM_PATIENT_CLASS_LANG_VW AM_PATIENT_CLASS WHERE LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT3", "SELECT A.DRUG_CATG_CODE, B.SHORT_DESC DRUG_CATG_DESC, A.PATIENT_CLASS, NVL(C.SHORT_DESC,'*All') PATIENT_CLASS_DESC, A.MAX_DURN_VALUE, DECODE(A.MAX_DURN_TYPE,'D','Days','W','Weeks','M','Minutes','L','Months','H','Hours') MAX_DURN_TYPE_ABBR, A.ACTION, DECODE(A.ACTION,'W','Warning','R','Reject','A','Authorize') ACTION_LEVEL_ABBR, A.ORD_AUTH_LEVEL FROM PH_DRUG_CATG_RULE_BY_PATCL A, PH_DRUG_CATG_LANG_VW B, AM_PATIENT_CLASS_LANG_VW C WHERE A.DRUG_CATG_CODE = B.DRUG_CATG_CODE AND A.PATIENT_CLASS = C.PATIENT_CLASS(+)  AND UPPER(B.SHORT_DESC) LIKE UPPER(?) AND A.PATIENT_CLASS LIKE UPPER(?) AND MAX_DURN_VALUE LIKE ? AND MAX_DURN_TYPE LIKE UPPER(?) AND ACTION LIKE UPPER(?) AND UPPER(NVL(ORD_AUTH_LEVEL,'X')) LIKE UPPER(?) AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT4", "SELECT A.DRUG_CATG_CODE,B.SHORT_DESC DRUG_CATG_DESC, A.PATIENT_CLASS,C.SHORT_DESC PATIENT_CLASS_DESC, A.MAX_DURN_TYPE, A.MAX_DURN_VALUE, A.ACTION, A.ORD_AUTH_LEVEL, A.PROMPT_MSG FROM PH_DRUG_CATG_RULE_BY_PATCL A,PH_DRUG_CATG B,AM_PATIENT_CLASS C WHERE A.DRUG_CATG_CODE =  B.DRUG_CATG_CODE AND A.PATIENT_CLASS = C.PATIENT_CLASS(+)  AND A.DRUG_CATG_CODE = UPPER(?) AND A.PATIENT_CLASS = UPPER(?) ");
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT5", "SELECT DURN_TYPE,DURN_DESC, DECODE(DURN_TYPE,'M',1,'H',2,'D',3,'W',4,5)DURN_ORDER FROM AM_DURATION_TYPE ORDER BY 3 ");
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT6", "SELECT COUNT(A.ROWID) FROM PH_DRUG_CATG_RULE_BY_PATCL A,PH_DRUG_CATG B,AM_PATIENT_CLASS C WHERE A.DRUG_CATG_CODE =  B.DRUG_CATG_CODE AND A.PATIENT_CLASS = C.PATIENT_CLASS(+) AND A.DRUG_CATG_CODE = UPPER(?) AND A.PATIENT_CLASS = UPPER(?) ");
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT7", "(SELECT '*A' PATIENT_CLASS,'*All' SHORT_DESC FROM DUAL) UNION (SELECT PATIENT_CLASS, SHORT_DESC FROM AM_PATIENT_CLASS ORDER BY 2 )");
		// The SQL 8 is not used ...
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT8", "SELECT DURN_TYPE,DURN_DESC from OR_DURATION_TYPE");
		dataMap.put("SQL_PH_RULE_BY_PATCL_SELECT9", "SELECT MAX_DURN_FOR_OP_PRES, MAX_DURN_FOR_IP_PRES FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_RULE_BY_PATCL_KEY", "SELECT A.DRUG_CATG_CODE,A.PATIENT_CLASS FROM PH_DRUG_CATG_RULE_BY_PATCL A  WHERE A.DRUG_CATG_CODE LIKE UPPER(?) AND A.PATIENT_CLASS LIKE UPPER(?) AND UPPER(A.MAX_DURN_VALUE) LIKE  UPPER(?) AND UPPER(A.MAX_DURN_TYPE) LIKE UPPER(?) AND UPPER(A.ACTION) LIKE UPPER(?) AND UPPER(A.ORD_AUTH_LEVEL) LIKE UPPER(?)  ");
		dataMap.put("SQL_PH_RULE_BY_PATCL_INSERT", "INSERT INTO PH_DRUG_CATG_RULE_BY_PATCL (DRUG_CATG_CODE,PATIENT_CLASS,MAX_DURN_VALUE,MAX_DURN_TYPE,ACTION,ORD_AUTH_LEVEL,PROMPT_MSG,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,? ) ");
		dataMap.put("SQL_PH_RULE_BY_PATCL_UPDATE", "UPDATE PH_DRUG_CATG_RULE_BY_PATCL A SET A.MAX_DURN_VALUE = ?, A.MAX_DURN_TYPE = ?, A.ACTION = ?, A.ORD_AUTH_LEVEL = ?, A.PROMPT_MSG = ? , A.MODIFIED_BY_ID = ?, A.MODIFIED_AT_WS_NO = ?, A.MODIFIED_DATE = SYSDATE, A.MODIFIED_FACILITY_ID= ? WHERE A.DRUG_CATG_CODE = ? AND A.PATIENT_CLASS = ?");
		dataMap.put("SQL_PH_RULE_BY_PATCL_DELETE", "DELETE PH_DRUG_CATG_RULE_BY_PATCL A WHERE A.DRUG_CATG_CODE = ? AND A.PATIENT_CLASS = ? ");

		dataMap.put("SQL_PH_ROUTE_FOR_FORM_SELECT1", "SELECT A.FORM_CODE,A.FORM_DESC FROM PH_FORM_LANG_VW A WHERE A.EFF_STATUS='E' AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_SELECT2", "SELECT A.ROUTE_CODE,A.ROUTE_DESC,A.ROUTE_COLOR FROM PH_ROUTE_LANG_VW A WHERE A.EFF_STATUS='E' AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_SELECT3", "SELECT A.FORM_CODE,B.FORM_DESC,A.ROUTE_CODE,C.ROUTE_DESC,A.ACTION_TEXT_LABEL, A.ACTION_TEXT_LABEL_LOC_LANG,C.ROUTE_COLOR FROM PH_ROUTE_FOR_FORM_LANG_VW A, PH_FORM_LANG_VW B , PH_ROUTE_LANG_VW C WHERE A.FORM_CODE=B.FORM_CODE AND A.ROUTE_CODE=C.ROUTE_CODE AND A.FORM_CODE LIKE UPPER(?) AND A.ROUTE_CODE LIKE UPPER(?) AND UPPER(B.FORM_DESC) LIKE UPPER(?) AND UPPER(C.ROUTE_DESC) LIKE UPPER(?) AND UPPER(A.ACTION_TEXT_LABEL) LIKE UPPER(?) AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = C.LANGUAGE_ID AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_SELECT4", "SELECT A.FORM_CODE,B.FORM_DESC,A.ROUTE_CODE,C.ROUTE_DESC,A.ACTION_TEXT_LABEL, A.ACTION_TEXT_LABEL_LOC_LANG,C.ROUTE_COLOR FROM PH_ROUTE_FOR_FORM A, PH_FORM B , PH_ROUTE C WHERE A.FORM_CODE=B.FORM_CODE AND A.ROUTE_CODE=C.ROUTE_CODE AND A.FORM_CODE = NVL(UPPER(?),A.FORM_CODE) AND A.ROUTE_CODE = NVL(UPPER(?),A.ROUTE_CODE)");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_SELECT5", "SELECT COUNT(ROWID) FROM PH_ROUTE_FOR_FORM WHERE FORM_CODE = UPPER(?)  AND ROUTE_CODE = UPPER(?)");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_KEY", "SELECT A.FORM_CODE,A.ROUTE_CODE FROM PH_ROUTE_FOR_FORM A, PH_FORM B , PH_ROUTE C WHERE A.FORM_CODE=B.FORM_CODE AND A.ROUTE_CODE=C.ROUTE_CODE AND A.FORM_CODE LIKE UPPER(?) AND UPPER(A.ROUTE_CODE) LIKE UPPER(?) AND UPPER(B.FORM_DESC) LIKE UPPER(?) AND UPPER(C.ROUTE_DESC) LIKE UPPER(?) AND UPPER(A.ACTION_TEXT_LABEL) LIKE UPPER(?) ");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_INSERT", "INSERT INTO PH_ROUTE_FOR_FORM (FORM_CODE,ROUTE_CODE,ACTION_TEXT_LABEL,ACTION_TEXT_LABEL_LOC_LANG,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_UPDATE", "UPDATE PH_ROUTE_FOR_FORM SET ACTION_TEXT_LABEL = ? , ACTION_TEXT_LABEL_LOC_LANG = ? , MODIFIED_BY_ID = ?, MODIFIED_DATE = sysdate, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE FORM_CODE = ? AND ROUTE_CODE = ? ");
		dataMap.put("SQL_PH_ROUTE_FOR_FORM_DELETE", "DELETE PH_ROUTE_FOR_FORM WHERE FORM_CODE= ? AND ROUTE_CODE = ?");
		dataMap.put("SQL_PH_ROUTE_INSERT", "INSERT INTO PH_ROUTE (ROUTE_CODE, ROUTE_DESC,EXT_ROUTE_CODE,EXT_ROUTE_DESC, EFF_STATUS,ROUTE_COLOR,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,ROUTE_DESC_LOCAL_LANG) VALUES (?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_ROUTE_SELECT1", "SELECT ROUTE_CODE route_code , ROUTE_DESC route_desc ,ROUTE_DESC_LOCAL_LANG route_local, EFF_STATUS eff_status, EXT_ROUTE_DESC ext_route_desc, ROUTE_COLOR FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE upper(ROUTE_CODE) LIKE UPPER(?)  AND UPPER(ROUTE_DESC)  LIKE UPPER(?) AND NVL(UPPER(ROUTE_DESC_LOCAL_LANG),?) LIKE UPPER(?) AND EFF_STATUS LIKE UPPER(?) AND NVL(EXT_ROUTE_CODE,?) LIKE (?) AND NVL(UPPER(EXT_ROUTE_DESC),?) LIKE UPPER(?) AND LANGUAGE_ID = ?");

		dataMap.put("SQL_PH_ROUTE_SELECT2", "SELECT ROUTE_CODE,ROUTE_DESC, EFF_STATUS, EXT_ROUTE_CODE ,ROUTE_DESC_LOCAL_LANG, ROUTE_COLOR FROM PH_ROUTE_LANG_VW A  WHERE A.ROUTE_CODE = ? and language_id=?");

		dataMap.put("SQL_PH_ROUTE_SELECT3", "SELECT COUNT(ROWID) FROM PH_ROUTE WHERE ROUTE_CODE = UPPER(?)");
		dataMap.put("SQL_PH_ROUTE_UPDATE", "UPDATE PH_ROUTE SET ROUTE_DESC = ?, EFF_STATUS = ? , 	EXT_ROUTE_CODE=?,EXT_ROUTE_DESC=?,ROUTE_COLOR=?,MODIFIED_BY_ID = ?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?,ROUTE_DESC_LOCAL_LANG=? WHERE ROUTE_CODE = ?");
		dataMap.put("SQL_PH_ROUTE_KEY", "SELECT A.ROUTE_CODE FROM PH_ROUTE A   WHERE A.ROUTE_CODE LIKE UPPER(?) AND UPPER(A.ROUTE_DESC) LIKE UPPER(?) AND UPPER(A.EFF_STATUS) LIKE UPPER(?)");

		dataMap.put("SQL_PH_DRUG_SCHEDULE_SELECT1", "SELECT A.SCHEDULE_ID, A.SCHEDULE_DESC, A.ORDER_AUTH_REQD_YN, A.ORDER_AUTH_LEVEL, A.ORDER_COSIGN_REQD_YN, A.ORDER_COSIGN_LEVEL, A.SPL_APPR_REQD_YN, A.SPL_APPR_LEVEL, A.REPEAT_SINGLE_CONT_ORDER_YN, A.DISP_AUTH_REQD_YN, A.EFF_STATUS FROM PH_DRUG_SCHEDULE_LANG_VW A  WHERE A.SCHEDULE_ID LIKE UPPER(?) AND UPPER(A.SCHEDULE_DESC) LIKE UPPER(?) AND UPPER(A.ORDER_AUTH_REQD_YN) LIKE UPPER(?) AND UPPER(NVL(A.ORDER_AUTH_LEVEL,'X')) LIKE UPPER(?)  AND UPPER(A.ORDER_COSIGN_REQD_YN) LIKE UPPER(?) AND UPPER(NVL(A.ORDER_COSIGN_LEVEL,'X')) LIKE UPPER(?) AND UPPER(A.SPL_APPR_REQD_YN) LIKE UPPER(?) AND UPPER(NVL(A.SPL_APPR_LEVEL,'X')) LIKE UPPER(?) AND UPPER(A.REPEAT_SINGLE_CONT_ORDER_YN) LIKE UPPER(?) AND UPPER(A.DISP_AUTH_REQD_YN) LIKE UPPER(?) AND UPPER(A.EFF_STATUS) LIKE UPPER(?) AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_SCHEDULE_SELECT2", "SELECT A.SCHEDULE_ID, A.SCHEDULE_DESC, A.ORDER_AUTH_REQD_YN, A.ORDER_AUTH_LEVEL, A.ORDER_COSIGN_REQD_YN, A.ORDER_COSIGN_LEVEL, A.SPL_APPR_REQD_YN, A.SPL_APPR_LEVEL, A.REPEAT_SINGLE_CONT_ORDER_YN, A.DISP_AUTH_REQD_YN, A.EFF_STATUS FROM PH_DRUG_SCHEDULE A  WHERE A.SCHEDULE_ID =  UPPER(?)");
		dataMap.put("SQL_PH_DRUG_SCHEDULE_SELECT3", "SELECT COUNT(ROWID) FROM PH_DRUG_SCHEDULE A  WHERE A.SCHEDULE_ID =  UPPER(?)");
		dataMap.put("SQL_PH_DRUG_SCHEDULE_SELECT4", "SELECT REFILL_YN FROM PH_PARAM");
		dataMap.put("SQL_PH_DRUG_SCHEDULE_KEY", "SELECT A.SCHEDULE_ID FROM PH_DRUG_SCHEDULE A  WHERE A.SCHEDULE_ID LIKE UPPER(?) AND UPPER(A.SCHEDULE_DESC) LIKE UPPER(?) AND UPPER(A.ORDER_AUTH_REQD_YN) LIKE UPPER(?) AND UPPER(A.ORDER_AUTH_LEVEL) LIKE UPPER(?)  AND UPPER(A.ORDER_COSIGN_REQD_YN) LIKE UPPER(?) AND UPPER(A.ORDER_COSIGN_LEVEL) LIKE UPPER(?) AND UPPER(A.SPL_APPR_REQD_YN) LIKE UPPER(?) AND UPPER(A.SPL_APPR_LEVEL) LIKE UPPER(?) AND UPPER(A.REPEAT_SINGLE_CONT_ORDER_YN) LIKE UPPER(?) AND UPPER(A.DISP_AUTH_REQD_YN) LIKE UPPER(?) AND UPPER(A.EFF_STATUS) LIKE UPPER(?) ");
		dataMap.put("SQL_PH_DRUG_SCHEDULE_INSERT", "INSERT INTO PH_DRUG_SCHEDULE(SCHEDULE_ID,SCHEDULE_DESC,ORDER_AUTH_REQD_YN,ORDER_AUTH_LEVEL,ORDER_COSIGN_REQD_YN,ORDER_COSIGN_LEVEL,SPL_APPR_REQD_YN,SPL_APPR_LEVEL,REPEAT_SINGLE_CONT_ORDER_YN,DISP_AUTH_REQD_YN,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_DRUG_SCHEDULE_UPDATE", "UPDATE PH_DRUG_SCHEDULE  A SET A.SCHEDULE_DESC = ? , A.ORDER_AUTH_REQD_YN = ? , A.ORDER_AUTH_LEVEL = ? , A.ORDER_COSIGN_REQD_YN = ? , A.ORDER_COSIGN_LEVEL = ?, A.SPL_APPR_REQD_YN = ?, A.SPL_APPR_LEVEL = ?, A.REPEAT_SINGLE_CONT_ORDER_YN = ?, A.DISP_AUTH_REQD_YN = ?, A.EFF_STATUS = ?, A.MODIFIED_BY_ID = ?, A.MODIFIED_DATE = SYSDATE, A.MODIFIED_AT_WS_NO = ?, A.MODIFIED_FACILITY_ID = ? WHERE A.SCHEDULE_ID = ?");

		dataMap.put("SQL_PH_LABEL_TEXT_INSERT", "INSERT INTO PH_LABEL_TEXT (LABEL_TEXT_ID, LABEL_TEXT_TYPE, LABEL_TEXT_1, LABEL_TEXT_2, LABEL_TEXT_1_LOC_LANG, LABEL_TEXT_2_LOC_LANG, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)  ");
		dataMap.put("SQL_PH_LABEL_TEXT_UPDATE", "UPDATE PH_LABEL_TEXT SET LABEL_TEXT_TYPE = ?, LABEL_TEXT_1 = ?, LABEL_TEXT_2 = ?, LABEL_TEXT_1_LOC_LANG = ?, LABEL_TEXT_2_LOC_LANG = ?, EFF_STATUS = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE LABEL_TEXT_ID = UPPER(?)");
		dataMap.put("SQL_PH_LABEL_TEXT_SELECT1", "SELECT LABEL_TEXT_ID, DECODE(LABEL_TEXT_TYPE,'C','Cautions','S','SpecialInstructions') LABEL_TEXT_TYPE, LABEL_TEXT_1, LABEL_TEXT_2, LABEL_TEXT_1_LOC_LANG, LABEL_TEXT_2_LOC_LANG, EFF_STATUS FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE LABEL_TEXT_ID LIKE UPPER(?) AND LABEL_TEXT_TYPE LIKE DECODE(UPPER(?),'B',LABEL_TEXT_TYPE,UPPER(?)) AND UPPER(LABEL_TEXT_1) LIKE UPPER(?) AND UPPER(LABEL_TEXT_2) LIKE UPPER(?) AND EFF_STATUS LIKE UPPER(?) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_LABEL_TEXT_SELECT2", "SELECT LABEL_TEXT_ID, DECODE(LABEL_TEXT_TYPE,'C','Cautions','S','SpecialInstructions') LABEL_TEXT_TYPE, LABEL_TEXT_1, LABEL_TEXT_2, LABEL_TEXT_1_LOC_LANG, LABEL_TEXT_2_LOC_LANG, EFF_STATUS FROM PH_LABEL_TEXT WHERE LABEL_TEXT_ID = UPPER(?)  ");
		dataMap.put("SQL_PH_LABEL_TEXT_SELECT2A", "SELECT LABEL_TEXT_ID, DECODE(LABEL_TEXT_TYPE,'C','Cautions','S','SpecialInstructions') LABEL_TEXT_TYPE, LABEL_TEXT_1, LABEL_TEXT_2, LABEL_TEXT_1_LOC_LANG, LABEL_TEXT_2_LOC_LANG, EFF_STATUS FROM ph_label_text_lang_vw PH_LABEL_TEXT WHERE LABEL_TEXT_ID = UPPER(?) and language_id='en' ");
		dataMap.put("SQL_PH_LABEL_TEXT_SELECT3", "SELECT LABEL_TEXT_ID, DECODE(LABEL_TEXT_TYPE,'C','Cautions','S','SpecialInstructions') LABEL_TEXT_TYPE, LABEL_TEXT_1, LABEL_TEXT_2, LABEL_TEXT_1_LOC_LANG, LABEL_TEXT_2_LOC_LANG, EFF_STATUS FROM PH_LABEL_TEXT ");
		dataMap.put("SQL_PH_LABEL_TEXT_SELECT4", "SELECT COUNT(ROWID) FROM PH_LABEL_TEXT WHERE LABEL_TEXT_ID = UPPER(?) ");
		dataMap.put("SQL_PH_LABEL_TEXT_KEY", "SELECT LABEL_TEXT_ID FROM PH_LABEL_TEXT WHERE LABEL_TEXT_ID LIKE UPPER(?) AND LABEL_TEXT_TYPE LIKE UPPER(?) AND LABEL_TEXT_1 LIKE (?) AND LABEL_TEXT_2 LIKE UPPER(?) AND LABEL_TEXT_1_LOC_LANG LIKE UPPER(?) AND LABEL_TEXT_2_LOC_LANG LIKE UPPER(?) AND EFF_STATUS LIKE UPPER(?) ");

		dataMap.put("SQL_PH_DRUG_SELECT1", "SELECT FORM_CODE, FORM_DESC FROM PH_FORM WHERE EFF_STATUS='E' ORDER BY FORM_DESC");
		dataMap.put("SQL_PH_DRUG_SELECT2", "SELECT A.ROUTE_CODE,B.ROUTE_DESC,B.ROUTE_COLOR FROM PH_ROUTE_FOR_FORM A, PH_ROUTE B WHERE A.ROUTE_CODE=B.ROUTE_CODE AND A.FORM_CODE=? AND B.EFF_STATUS = 'E' ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT3", "SELECT SCHEDULE_ID, SCHEDULE_DESC,DISP_AUTH_REQD_YN FROM PH_DRUG_SCHEDULE WHERE EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT4", "SELECT UOM_CODE, SHORT_DESC FROM AM_UOM WHERE DOSAGE_UOM_YN='Y' AND EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT5", "SELECT UOM_CODE, SHORT_DESC FROM AM_UOM WHERE STRENGTH_UOM_YN='Y' AND EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT6", "SELECT DRUG_CATG_CODE, SHORT_DESC FROM PH_DRUG_CATG_LANG_VW PH_DRUG_CATG WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");

		//dataMap.put("SQL_PH_DRUG_SELECT6", "SELECT DRUG_CATG_CODE, SHORT_DESC FROM PH_DRUG_CATG_LANG_VW PH_DRUG_CATG WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");

		dataMap.put("SQL_PH_DRUG_SELECT7", "SELECT A.STK_UOM_CODE UOM_CODE,B.SHORT_DESC SHORT_DESC FROM ST_ITEM A, AM_UOM B WHERE A.DRUG_ITEM_YN ='Y' AND A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND A.STK_UOM_CODE=B.UOM_CODE AND A.ITEM_CODE = ? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT8", "SELECT LABEL_TEXT_ID, LABEL_TEXT_1,LABEL_TEXT_2 FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE LABEL_TEXT_TYPE='C' AND EFF_STATUS='E' AND LANGUAGE_ID= ? ORDER BY 2,3");

		//dataMap.put("SQL_PH_DRUG_SELECT8", "SELECT LABEL_TEXT_ID, LABEL_TEXT_1,LABEL_TEXT_2 FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE LABEL_TEXT_TYPE='C' AND EFF_STATUS='E' AND LANGUAGE_ID= ? ORDER BY 2,3");

		dataMap.put("SQL_PH_DRUG_SELECT8A", "SELECT   LABEL_TEXT_ID, LABEL_TEXT_1, LABEL_TEXT_2,LABEL_TEXT_1_LOC_LANG,LABEL_TEXT_2_LOC_LANG  FROM PH_LABEL_TEXT  WHERE LABEL_TEXT_TYPE = 'C' AND EFF_STATUS = 'E'  ORDER BY 2, 3");
		dataMap.put("SQL_PH_DRUG_SELECT9", "SELECT LABEL_TEXT_ID, LABEL_TEXT_1 FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE LABEL_TEXT_TYPE='S' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT9B", "SELECT   LABEL_TEXT_ID, LABEL_TEXT_1, LABEL_TEXT_2,LABEL_TEXT_1_LOC_LANG,LABEL_TEXT_2_LOC_LANG  FROM PH_LABEL_TEXT  WHERE LABEL_TEXT_TYPE = 'S' AND EFF_STATUS = 'E'  ORDER BY 2, 3");
		dataMap.put("SQL_PH_DRUG_SELECT9A", "SELECT LABEL_TEXT_ID, LABEL_TEXT_2 FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE LABEL_TEXT_TYPE='S' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT10", "SELECT GENERIC_NAME, DECODE(DRUG_CLASS,'G','General','C','Controlled','N','Narcotics') DRUG_CLASS FROM PH_GENERIC_NAME WHERE GENERIC_ID = ?  AND EFF_STATUS='E'");
		dataMap.put("SQL_PH_DRUG_SELECT11", "SELECT MODULE_ID FROM SM_MODULE WHERE MODULE_ID IN ('ST','IP','OR') AND INSTALL_YN ='Y' GROUP BY MODULE_ID");
		dataMap.put("SQL_PH_DRUG_SELECT12", "SELECT DRUG_ITEM_CODE_LINK_REQD_YN,DRUG_TO_ITEM_MAPPING, DRUG_AND_ITEM_CODE_SAME_IND, DRUG_CODE_GEN_RULE,ITEM_IMAGE_PATH FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_DRUG_SELECT13", "SELECT UOM_CODE,EQVL_UOM_CODE,EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE = ? AND EQVL_UOM_CODE = ?   ");
		dataMap.put("SQL_PH_DRUG_SELECT14", "SELECT A.GENERIC_ID code,A.GENERIC_NAME description FROM PH_GENERIC_NAME_LANG_VW A WHERE  upper(A.GENERIC_ID) like upper(?) AND upper(A.GENERIC_NAME) like upper(?) AND A.EFF_STATUS='E' AND A.LANGUAGE_ID =");
		dataMap.put("SQL_PH_DRUG_SELECT15", "SELECT DFLT_IP_FILL_PROCESS FROM PH_FORM WHERE FORM_CODE=? AND EFF_STATUS='E'");
		dataMap.put("SQL_PH_DRUG_SELECT16", "SELECT UOM_CODE, SHORT_DESC FROM AM_UOM WHERE STOCK_UOM_YN='Y' AND EFF_STATUS='E' ORDER BY 2");
	
		dataMap.put("SQL_PH_DRUG_SELECT17", "SELECT   A.ITEM_CODE,  B.LONG_DESC,  B.SHORT_DESC,  B.GEN_UOM_CODE,   C.SHORT_DESC FROM   ST_ITEM A,  MM_ITEM B,  AM_UOM C WHERE   B.PS_ITEM_YN='Y' AND  A.ITEM_CODE = B.ITEM_CODE   AND  B.GEN_UOM_CODE = C.UOM_CODE ORDER BY 2,3");
		dataMap.put("SQL_PH_DRUG_SELECT18", "SELECT A.DRUG_CODE, A.INVENTORY_ITEM_CODE, A.STOCK_UOM, B.SHORT_DESC, A.CONTENT_IN_PRES_BASE_UOM, A.CONTENT_IN_STRENGTH_UOM FROM PH_INVENTORY_ITEM_FOR_DRUG A, AM_UOM B WHERE A.STOCK_UOM=B.UOM_CODE");
		dataMap.put("SQL_PH_DRUG_SELECT19", "SELECT A.TRADE_ID code,A.SHORT_NAME description FROM AM_TRADE_NAME_LANG_VW A, MM_TRADE_NAME_FOR_ITEM B WHERE ITEM_CODE like ? AND A.TRADE_ID = B.TRADE_ID AND A.EFF_STATUS='E' and drug_yn = 'Y' AND upper(A.TRADE_ID) like upper(?) AND upper(A.SHORT_NAME) like upper(?) AND A.LANGUAGE_ID =");
		dataMap.put("SQL_PH_DRUG_SELECT20", "SELECT A.GENERIC_ID,B.GENERIC_NAME, DECODE(B.DRUG_CLASS,'G','General','C','Controlled','N','Narcotics') DRUG_CLASS FROM PH_GENERIC_NAME_FOR_DRUG A, PH_GENERIC_NAME B WHERE A.GENERIC_ID=B.GENERIC_ID");
		dataMap.put("SQL_PH_DRUG_SELECT21", "SELECT A.TRADE_ID,A.SHORT_NAME,A.MANUFACTURER_ID,C.SHORT_NAME FROM AM_TRADE_NAME A, PH_TRADE_NAME_FOR_DRUG B , AM_MANUFACTURER C WHERE A.TRADE_ID=B.TRADE_CODE AND A.MANUFACTURER_ID=C.MANUFACTURER_ID(+)");
		dataMap.put("SQL_PH_DRUG_SELECT22", "SELECT A.GENERIC_ID,B.GENERIC_NAME, DECODE(B.DRUG_CLASS,'G','General','C','Controlled','N','Narcotics') DRUG_CLASS FROM PH_GENERIC_NAME_FOR_DRUG A, PH_GENERIC_NAME B WHERE A.GENERIC_ID<>B.GENERIC_ID");
		dataMap.put("SQL_PH_DRUG_SELECT23", "SELECT COUNT(ROWID) TOT_COUNT FROM PH_DRUG WHERE ITEM_CODE = ? ");
		dataMap.put("SQL_PH_DRUG_SELECT24", " SELECT A.MANUFACTURER_ID code, B.SHORT_NAME description FROM AM_TRADE_NAME A , AM_MANUFACTURER_LANG_VW B WHERE A.MANUFACTURER_ID=B.MANUFACTURER_ID AND A.TRADE_ID = ? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_SELECT25", "SELECT A.ITEM_CODE code,B.LONG_DESC description FROM ST_ITEM A,MM_ITEM_LANG_VW B WHERE A.DRUG_ITEM_YN='Y' AND B.ITEM_CODE=A.ITEM_CODE AND A.ITEM_CODE LIKE UPPER(?) AND upper(B.LONG_DESC) LIKE upper(?) AND A.ITEM_CODE NOT IN(SELECT INVENTORY_ITEM_CODE FROM PH_INVENTORY_ITEM_FOR_DRUG) AND B.LANGUAGE_ID=");
	
		dataMap.put("SQL_PH_DRUG_SELECT26", "SELECT  B.GEN_UOM_CODE code, B.SHORT_DESC description FROM   MM_ITEM_LANG_VW B  WHERE   B.ITEM_CODE=? AND B.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SELECT27", "SELECT A.UOM_CODE,A.DFLT_UOM_YN, B.SHORT_DESC FROM PH_UOM_FOR_FORM A, AM_UOM B WHERE A.FORM_CODE=? AND A.UOM_CODE = B.UOM_CODE AND B.EFF_STATUS='E'");
		dataMap.put("SQL_PH_DRUG_SELECT28", "SELECT REFILL_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID= ?");
		dataMap.put("SQL_PH_DRUG_SELECT29","SELECT DISTINCT A.UOM_CODE,A.SHORT_DESC,ROUND(B.EQVL_VALUE,1) EQVL_VALUE FROM AM_UOM A,AM_UOM_EQVL B WHERE A.STOCK_UOM_YN='Y' AND (A.UOM_CODE=B.UOM_CODE AND B.EQVL_UOM_CODE=? ) OR (A.UOM_CODE=B.EQVL_UOM_CODE AND B.UOM_CODE=?) ORDER BY A.SHORT_DESC");
		dataMap.put("SQL_PH_DRUG_SELECT30","SELECT DRUG_CODE,DRUG_DESC FROM PH_DRUG WHERE IV_FLUID_YN='Y' AND IV_INGREDIENT_YN='N' AND DISCONTINUED_YN='N' AND NPB_DRUG_YN <>'Y' ORDER BY DRUG_DESC");

		dataMap.put("SQL_PH_DRUG_SELECT31","SELECT DFLT_IV_ROUTE_CODE FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_DRUG_SELECT32","SELECT AGE_GROUP_CODE, SHORT_DESC FROM AM_AGE_GROUP_LANG_VW AM_AGE_GROUP WHERE EFF_STATUS = 'E' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_DRUG_SELECT33","SELECT NOTE_TYPE CODE, NOTE_TYPE_DESC DESCRIPTION FROM CA_NOTE_TYPE_LANG_VW CA_NOTE_TYPE WHERE NOTE_GROUP_ID = '*PH01' AND EFF_STATUS = 'E' AND LANGUAGE_ID = ? ORDER BY NOTE_TYPE_DESC");

		dataMap.put("SQL_PH_DRUG_SELECT_ITEM_CODE","SELECT A.ITEM_CODE code,B.LONG_DESC description FROM ST_ITEM A,MM_ITEM B WHERE A.DRUG_ITEM_YN='Y' AND B.ITEM_CODE=A.ITEM_CODE AND A.ITEM_CODE =?");

		dataMap.put("SQL_PH_TRADE_NAME_FOR_DRUG_SELECT", "SELECT A.TRADE_ID,A.SHORT_NAME SHORT_DESC1,B.EFF_STATUS,A.MANUFACTURER_ID,B.DISPLAY_SEQ_NO, C.SHORT_NAME SHORT_DESC2,TRADE_IMAGE_FILENAME  FROM AM_TRADE_NAME A,PH_TRADE_NAME_FOR_DRUG B , AM_MANUFACTURER C WHERE A.TRADE_ID=B.TRADE_CODE  AND A.MANUFACTURER_ID = C.MANUFACTURER_ID AND B.DRUG_CODE= ? ORDER BY UPPER(a.short_name)");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_DRUG_SELECT", "SELECT A.GENERIC_ID,B.GENERIC_NAME,DECODE(B.DRUG_CLASS,'G','General','C','Controlled','N','Narcotics') DRUG_CLASS, DISPLAY_SEQ_NO FROM PH_GENERIC_NAME_FOR_DRUG A,PH_GENERIC_NAME B WHERE A.GENERIC_ID=B.GENERIC_ID AND A.DRUG_CODE=? order by display_seq_no ");
		dataMap.put("SQL_PH_INVENTORY_ITEM_FOR_DRUG_SELECT", "SELECT A.INVENTORY_ITEM_CODE,B.LONG_DESC INVENTORY_ITEM_DESC,A.STOCK_UOM,C.SHORT_DESC STOCK_UOM_DESC,A.CONTENT_IN_PRES_BASE_UOM, A.CONTENT_IN_STRENGTH_UOM FROM PH_INVENTORY_ITEM_FOR_DRUG A, ST_ITEM B, AM_UOM C WHERE A.INVENTORY_ITEM_CODE = B.ITEM_CODE AND A.STOCK_UOM = C.UOM_CODE AND A.DRUG_CODE= ?");
		dataMap.put("SQL_OR_PH_SELECT1", "SELECT A.ORDER_TYPE_CODE code,B.SHORT_DESC short_desc FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A,OR_ORDER_TYPE_LANG_VW B WHERE A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND B.EFF_STATUS='E' AND A.DRUG_CLASS=? AND B.LANGUAGE_ID =? ORDER BY 2");
		dataMap.put("SQL_OR_PH_SELECT2", "SELECT A.DRUG_CATG_CODE,A.PATIENT_CLASS,A.MAX_DURN_VALUE,A.MAX_DURN_TYPE,A.ACTION CHK_FOR_MAX_DURN_ACTION,A.ORD_AUTH_LEVEL,A.PROMPT_MSG FROM PH_DRG_CTG_RLE_BY_PTCL_LANG_VW A WHERE A.DRUG_CATG_CODE=? AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_OR_PH_SELECT3", "SELECT A.ORDER_AUTH_LEVEL ord_auth_level,A.ORDER_COSIGN_LEVEL ord_cosign_level,A.SPL_APPR_LEVEL ord_spl_appr_level,A.DISP_AUTH_REQD_YN RESULT_AUTH_REQD_YN,A.REPEAT_SINGLE_CONT_ORDER_YN FROM PH_DRUG_SCHEDULE_LANG_VW A WHERE SCHEDULE_ID=? AND EFF_STATUS='E' AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_OR_PH_COUNT_CHECK", "SELECT ORDER_CATALOG_CODE FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_DRUG_INSERT", "INSERT INTO PH_DRUG(DRUG_CODE, DRUG_DESC, IN_FORMULARY_YN, LINK_TO_EXISTING_ITEM, ITEM_CODE, GENERIC_ID, DRUG_CLASS,COMPOUND_DRUG_YN, FORM_CODE, ROUTE_CODE,DRUG_TYPE, SCHEDULE_ID, RESTRICTED_DRUG_YN, TRIAL_DRUG_YN, AFFECTS_PREGNANCY_YN, AFFECTS_BREAST_FEEDING_YN, AFFECTS_LAB_RESULTS_YN, STABILITY_REQD_YN, STABILITY_HRS,PT_COUN_REQD_YN,PRES_BASE_UOM, CALC_DOSG_BY_FREQ_DURN_YN,STRENGTH_VALUE, STRENGTH_UOM, STRENGTH_PER_PRES_UOM,STRENGTH_PER_VALUE_PRES_UOM,PRES_CATG_CODE,FRACT_DOSE_ROUND_UP_YN,STOCK_UOM,CONTENT_IN_PRES_BASE_UOM,CALC_DEF_DOSAGE_YN,DISP_ALT_FORM_YN,DISP_MULTI_STRENGTH_YN,PRN_DOSES_PRES_PRD_FILL, PRN_DOSES_CONT_DAILY_FILL, DISP_AUTH_REQD_YN, DISP_VIA_PRES_ONLY_YN, DISP_AGAINST_DAMAGE_YN, CAUTION_LABEL_TEXT_ID_1, CAUTION_LABEL_TEXT_ID_2, SPL_INSTR_LABEL_TEXT_ID, HOW_TO_TAKE_TEXT,HOW_TO_TAKE_TEXT_LOCAL,SPL_INSTR_LABEL_TEXT_ID1,IV_INGREDIENT_YN, IV_FLUID_YN, INFUSE_OVER_VALUE, INFUSE_OVER_DURN_TYPE,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,PHYSICAL_FORM,IV_FLUID_FOR_ONCO_YN,DFLT_FLUID_CODE,APPL_PIGGY_BACK_YN,APPL_TO_RECONST_FLUID_YN,APPL_TO_TDM_YN,APPL_TO_VERBAL_ORDER_YN,APPL_FOR_COMPOUNDING_RX_YN,MEDN_ADMN_DTL_REQD_YN,DRUG_INFORMATION,PATIENT_EDUCATION,WEIGHT_REC_APPL_AGE_GROUP,DIAG_REC_APPL,DIAG_SCR_NOTE_TYPE,FRACT_DOSE_APPL_YN,ITEM_IMAGE_FILENAME,VERIFICATION_REQD_YN, EDL_CODES,EDL_REMARKS,ALLOW_MORETHAN_PRES_QTY_YN ) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_COMP_FLUIDS_DRUG_UPDATE","UPDATE PH_DRUG_COMPATIBILITY_FLUID SET DRUG_CODE=?,DEFAULT_YN=?,EFF_STATUS=?,MODIFIED_BY_ID=?,MODIFIED_DATE= SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?,DEFAULT_INFUSE_OVER_VALUE=? WHERE DRUG_CODE=? AND FLUID_CODE=?");//Added DEFAULT_INFUSE_OVER_VALUE=? for ML-MMOH-CRF-1223
		dataMap.put("SQL_PH_COMP_FLUIDS_DRUG_INSERT","INSERT INTO PH_DRUG_COMPATIBILITY_FLUID(DRUG_CODE,FLUID_CODE,DEFAULT_YN,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,DEFAULT_INFUSE_OVER_VALUE)VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");//Added DEFAULT_INFUSE_OVER_VALUE for ML-MMOH-CRF-1223
		dataMap.put("SQL_PH_COMP_FLUIDS_DRUG_SELECT","SELECT ? DRUG_CODE, DRUG_CODE FLUID_CODE, DRUG_DESC FLUID_DESC, 'N' DEFAULT_YN, 'D' EFF_STATUS , 'I' DB_ACTION, INFUSE_OVER_VALUE DEFAULT_INFUSE_OVER_VALUE FROM PH_DRUG_LANG_VW PH_DRUG WHERE DRUG_CODE NOT IN (SELECT FLUID_CODE FROM PH_DRUG_COMPATIBILITY_FLUID WHERE DRUG_CODE = ?)AND IV_FLUID_YN='Y' AND IV_INGREDIENT_YN='N' AND DISCONTINUED_YN='N' AND LANGUAGE_ID = ? UNION ALL SELECT A.DRUG_CODE, A.FLUID_CODE, B.DRUG_DESC FLUID_DESC, A.DEFAULT_YN, A.EFF_STATUS, 'U' DB_ACTION,DECODE(A.EFF_STATUS,'D',B.INFUSE_OVER_VALUE,'E',A.DEFAULT_INFUSE_OVER_VALUE) DEFAULT_INFUSE_OVER_VALUE FROM PH_DRUG_COMPATIBILITY_FLUID A, PH_DRUG_LANG_VW B WHERE A.DRUG_CODE = ? AND A.FLUID_CODE = B.DRUG_CODE AND B.LANGUAGE_ID = ? AND B.NPB_DRUG_YN <>'Y' ORDER BY FLUID_DESC");//Added DEFAULT_INFUSE_OVER_VALUE  for ML-MMOH-CRF-1223
		dataMap.put("SQL_PH_COMP_FLUIDS_STATUS_SELECT","SELECT COUNT(1) CNT FROM PH_DRUG_COMPATIBILITY_FLUID  WHERE FLUID_CODE = ? AND ( EFF_STATUS = 'E' OR DEFAULT_YN = 'Y') AND NOT EXISTS (SELECT 1 FROM PH_DRUG WHERE PH_DRUG.DRUG_CODE = PH_DRUG_COMPATIBILITY_FLUID.DRUG_CODE  AND PH_DRUG.DISCONTINUED_YN = 'Y') ");
		dataMap.put("SQL_PH_COMP_FLUIDS_STATUS_UPDATE","UPDATE PH_DRUG_COMPATIBILITY_FLUID SET EFF_STATUS = 'D', DEFAULT_YN = 'N', MODIFIED_BY_ID=?,MODIFIED_DATE= SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FLUID_CODE = ?");
		dataMap.put("SQL_PH_DFLT_FLUID_UPDATE","UPDATE PH_DRUG SET DFLT_FLUID_CODE = NULL, MODIFIED_BY_ID=?,MODIFIED_DATE= SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE DFLT_FLUID_CODE = ?");
		dataMap.put("SQL_PH_INVENTORY_ITEM_FOR_DRUG_INSERT", "INSERT INTO PH_INVENTORY_ITEM_FOR_DRUG(DRUG_CODE, INVENTORY_ITEM_CODE, STOCK_UOM, CONTENT_IN_PRES_BASE_UOM, CONTENT_IN_STRENGTH_UOM, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)  ");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_DRUG_INSERT", "INSERT INTO PH_GENERIC_NAME_FOR_DRUG (DRUG_CODE, GENERIC_ID, DISPLAY_SEQ_NO, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TRADE_NAME_FOR_DRUG_INSERT", "INSERT INTO PH_TRADE_NAME_FOR_DRUG (DRUG_CODE, TRADE_CODE, DISPLAY_SEQ_NO, ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,TRADE_IMAGE_FILENAME, EFF_STATUS ) VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_PH_DRUG_UPDATE", "UPDATE PH_DRUG SET DRUG_DESC = ?, IN_FORMULARY_YN=?, LINK_TO_EXISTING_ITEM=?, ITEM_CODE=?, DRUG_TYPE = ?, SCHEDULE_ID = ?, RESTRICTED_DRUG_YN = ?, TRIAL_DRUG_YN=?, AFFECTS_PREGNANCY_YN = ?, AFFECTS_BREAST_FEEDING_YN = ?, AFFECTS_LAB_RESULTS_YN = ?, STABILITY_REQD_YN = ?, STABILITY_HRS = ?, PT_COUN_REQD_YN = ?,PRES_BASE_UOM = ?,CALC_DOSG_BY_FREQ_DURN_YN = ?, STRENGTH_VALUE = ?, STRENGTH_UOM = ?, STRENGTH_PER_PRES_UOM = ?, STRENGTH_PER_VALUE_PRES_UOM = ?, PRES_CATG_CODE = ?,  FRACT_DOSE_ROUND_UP_YN = ?,STOCK_UOM = ?, CONTENT_IN_PRES_BASE_UOM = ?,CALC_DEF_DOSAGE_YN =?, DISP_ALT_FORM_YN=?,  DISP_MULTI_STRENGTH_YN = ?, PRN_DOSES_PRES_PRD_FILL = ?, PRN_DOSES_CONT_DAILY_FILL = ?, DISP_AUTH_REQD_YN = ?, DISP_VIA_PRES_ONLY_YN = ?, DISP_AGAINST_DAMAGE_YN = ?, CAUTION_LABEL_TEXT_ID_1 = ?, CAUTION_LABEL_TEXT_ID_2 = ?, SPL_INSTR_LABEL_TEXT_ID = ?,   HOW_TO_TAKE_TEXT = ?,HOW_TO_TAKE_TEXT_LOCAL = ?, SPL_INSTR_LABEL_TEXT_ID1 = ? ,IV_INGREDIENT_YN = ?, IV_FLUID_YN = ?, INFUSE_OVER_VALUE = ?, INFUSE_OVER_DURN_TYPE = ?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?,PHYSICAL_FORM=?,IV_FLUID_FOR_ONCO_YN=?,DFLT_FLUID_CODE=?,APPL_PIGGY_BACK_YN=?,APPL_TO_RECONST_FLUID_YN=?,APPL_TO_TDM_YN=?,APPL_TO_VERBAL_ORDER_YN=?,APPL_FOR_COMPOUNDING_RX_YN=? ,MEDN_ADMN_DTL_REQD_YN=?,DRUG_INFORMATION = ?,PATIENT_EDUCATION = ?,WEIGHT_REC_APPL_AGE_GROUP =?,DIAG_REC_APPL=?,DIAG_SCR_NOTE_TYPE=?,FRACT_DOSE_APPL_YN=?,ITEM_IMAGE_FILENAME = ?  ,VERIFICATION_REQD_YN=?, EDL_CODES=?,EDL_REMARKS=?,ALLOW_MORETHAN_PRES_QTY_YN=? WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_INVENTORY_ITEM_FOR_DRUG_UPDATE", "UPDATE PH_INVENTORY_ITEM_FOR_DRUG SET STOCK_UOM = ?, CONTENT_IN_PRES_BASE_UOM = ?, CONTENT_IN_STRENGTH_UOM = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID =? WHERE DRUG_CODE = ? AND  INVENTORY_ITEM_CODE = ? ");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_DRUG_UPDATE", "UPDATE PH_GENERIC_NAME_FOR_DRUG SET DISPLAY_SEQ_NO=? , MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE DRUG_CODE= ? AND GENERIC_ID= ? ");
		dataMap.put("SQL_PH_TRADE_NAME_FOR_DRUG_UPDATE", "UPDATE PH_TRADE_NAME_FOR_DRUG SET DISPLAY_SEQ_NO = ?, EFF_STATUS=?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?,TRADE_IMAGE_FILENAME  = ? WHERE DRUG_CODE = ? AND  TRADE_CODE = ?");
		dataMap.put("SQL_PH_TRADE_NAME_FOR_DRUG_DELETE", "DELETE FROM PH_TRADE_NAME_FOR_DRUG WHERE DRUG_CODE = ? AND TRADE_CODE = ?");
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_DRUG_DELETE", "DELETE FROM PH_GENERIC_NAME_FOR_DRUG WHERE DRUG_CODE = ? AND GENERIC_ID = ?");
		dataMap.put("SQL_PH_INVENTORY_ITEM_FOR_DRUG_DELETE", "DELETE FROM PH_INVENTORY_ITEM_FOR_DRUG WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_FACILITY_PARAM_SETUP_SELECT", "SELECT COUNT(ROWID) FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("JNDI_PH_DRUG", "java:comp/env/DrugMaster");

		dataMap.put("SQL_PH_DOSG_LMT_SELECT1", "SELECT A.DRUG_CODE,A.DRUG_DESC,A.GENERIC_ID,C.GENERIC_NAME,A.FORM_CODE,B.FORM_DESC, A.STRENGTH_VALUE,A.STRENGTH_UOM,A.PRES_BASE_UOM, D.SHORT_DESC FROM PH_DRUG_LANG_VW A, PH_FORM_LANG_VW B, PH_GENERIC_NAME_LANG_VW C, AM_UOM_LANG_VW D WHERE A.FORM_CODE = B.FORM_CODE(+)  AND A.GENERIC_ID = C.GENERIC_ID(+) AND A.PRES_BASE_UOM = D.UOM_CODE (+) AND DRUG_CODE = ? AND A.LANGUAGE_ID = ? AND B.LANGUAGE_ID(+)= ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DOSG_LMT_SELECT1_TEST", "SELECT A.DRUG_CODE code,A.DRUG_DESC description,A.GENERIC_ID generic_id FROM PH_DRUG A WHERE UPPER(A.drug_code) like UPPER(?) and UPPER(A.drug_desc) like UPPER(?)");
		dataMap.put("SQL_PH_DOSG_LMT_SELECT2", "SELECT AGE_GROUP_CODE,SHORT_DESC,DECODE(GENDER,'M','male','F','female','U','unknown') GENDER,AGE_UNIT, MIN_AGE,MAX_AGE,AGE_UNIT_MAX FROM AM_AGE_GROUP_LANG_VW AM_AGE_GROUP where eff_status = 'E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DOSG_LMT_SELECT3", " SELECT A.DRUG_CODE,B.DRUG_DESC, A.AGE_GROUP_CODE,C.SHORT_DESC AGE_GROUP_DESC, A.LOW_OF_UNIT_DOSAGE, A.HIGH_OF_UNIT_DOSAGE, A.LOW_OF_DAILY_DOSAGE, A.HIGH_OF_DAILY_DOSAGE, B.FORM_CODE,D.FORM_DESC , E.GENERIC_NAME,B.STRENGTH_VALUE, DECODE(A.GENDER,'M','male','F','female','U','unknown') GENDER, B.PRES_BASE_UOM, F.SHORT_DESC PRES_BASE_DESC, A.MIN_AGE,A.MAX_AGE,A.AGE_UNIT, G.ROUTE_DESC FROM PH_DOSAGE_LIMIT_FOR_AGE_GROUP A, PH_DRUG_LANG_VW B, AM_AGE_GROUP_LANG_VW C, PH_FORM_LANG_VW D ,PH_GENERIC_NAME_LANG_VW E, AM_UOM_LANG_VW F, PH_ROUTE_LANG_VW G WHERE  A.DRUG_CODE=B.DRUG_CODE AND A.AGE_GROUP_CODE=C.AGE_GROUP_CODE AND B.FORM_CODE=D.FORM_CODE(+) AND B.GENERIC_ID=E.GENERIC_ID(+) AND B.PRES_BASE_UOM=F.UOM_CODE(+) AND B.ROUTE_CODE = G.ROUTE_CODE (+) AND A.DRUG_CODE LIKE UPPER(?) AND UPPER(B.DRUG_DESC) LIKE UPPER(?) AND UPPER(E.GENERIC_NAME) LIKE UPPER(?)  AND UPPER(D.FORM_DESC) LIKE UPPER(?) AND UPPER(C.SHORT_DESC) LIKE UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ? AND G.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DOSG_LMT_SELECT4", " SELECT A.DRUG_CODE,B.DRUG_DESC, A.AGE_GROUP_CODE,C.SHORT_DESC, TO_CHAR(A.LOW_OF_UNIT_DOSAGE,'999999999.999') LOW_OF_UNIT_DOSAGE, TO_CHAR(A.HIGH_OF_UNIT_DOSAGE,'999999999.999') HIGH_OF_UNIT_DOSAGE,			TO_CHAR(A.DOSAGE_STD, '999999999.999') DOSAGE_STD, 	TO_CHAR(A.LOW_OF_DAILY_DOSAGE,'999999999.999') LOW_OF_DAILY_DOSAGE, A.CALC_BY_IND, A.DOSAGE_UNIT, TO_CHAR(A.HIGH_OF_DAILY_DOSAGE,'999999999.999') HIGH_OF_DAILY_DOSAGE, B.FORM_CODE,D.FORM_DESC , E.GENERIC_NAME,B.STRENGTH_VALUE, DECODE(A.GENDER,'M','male','F','female','U','unknown') GENDER, B.PRES_BASE_UOM, F.SHORT_DESC PRES_BASE_DESC, A.MIN_AGE,A.MAX_AGE,A.AGE_UNIT,A.MONOGRAPH,A.LIMIT_IND FROM PH_DOSAGE_LIMIT_FOR_AGE_GROUP A, PH_DRUG_LANG_VW B, AM_AGE_GROUP_LANG_VW C, PH_FORM_LANG_VW D ,PH_GENERIC_NAME_LANG_VW E, AM_UOM_LANG_VW F WHERE  A.DRUG_CODE=B.DRUG_CODE AND A.AGE_GROUP_CODE=C.AGE_GROUP_CODE AND B.FORM_CODE=D.FORM_CODE(+) AND B.GENERIC_ID=E.GENERIC_ID(+) AND B.PRES_BASE_UOM=F.UOM_CODE(+) AND A.DRUG_CODE = ? AND A.AGE_GROUP_CODE = ? AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DOSG_LMT_SELECT5", "SELECT COUNT(ROWID) FROM PH_DOSAGE_LIMIT_FOR_AGE_GROUP WHERE DRUG_CODE = ? AND AGE_GROUP_CODE = ?");

		dataMap.put("SQL_PH_DOSG_LMT_SELECT6", "SELECT AGE_GROUP_CODE,SHORT_DESC, GENDER,AGE_UNIT, MIN_AGE,MAX_AGE FROM AM_AGE_GROUP_LANG_VW AM_AGE_GROUP where AGE_GROUP_CODE=? AND LANGUAGE_ID = ?");

		dataMap.put("SQL_PH_DOSG_LMT_SELECT7", "SELECT MIN_AGE, MAX_AGE, AGE_UNIT, GENDER FROM PH_DOSAGE_LIMIT_FOR_AGE_GROUP WHERE DRUG_CODE=? ");

		dataMap.put("SQL_PH_DOSG_LMT_SELECT8", "SELECT COUNT(*)  COUNT1 FROM  PH_DOSAGE_LIMIT_FOR_AGE_GROUP  WHERE DRUG_CODE=? ");

		dataMap.put("SQL_PH_DOSG_LMT_SELECT9","SELECT STRENGTH_UOM,PRES_BASE_UOM FROM PH_DRUG WHERE DRUG_CODE=?");

		dataMap.put("SQL_PH_DOSG_LMT_INSERT", "INSERT INTO ph_dosage_limit_for_age_group (drug_code, age_group_code, low_of_unit_dosage, high_of_unit_dosage, low_of_daily_dosage, high_of_daily_dosage, monograph, limit_ind, calc_by_ind, dosage_std, dosage_unit, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id, min_age, max_age, age_unit, gender, low_celling_of_unit_dosage,high_celling_of_unit_dosage, low_celling_of_daily_dosage, high_celling_of_daily_dosage ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, ?, ?,?,?,? ) "); //Modified for IN:070451

		dataMap.put("SQL_PH_DOSG_LMT_UPDATE", "UPDATE PH_DOSAGE_LIMIT_FOR_AGE_GROUP SET  LOW_OF_UNIT_DOSAGE = ?, HIGH_OF_UNIT_DOSAGE = ?, LOW_OF_DAILY_DOSAGE = ?, HIGH_OF_DAILY_DOSAGE = ?, MONOGRAPH = ?,LIMIT_IND=?,CALC_BY_IND =?, DOSAGE_STD=?, DOSAGE_UNIT=?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?,MIN_AGE=?,MAX_AGE=?,AGE_UNIT=?,GENDER=? WHERE DRUG_CODE = ? AND AGE_GROUP_CODE=?");
		dataMap.put("SQL_PH_DOSG_LMT_DELETE", "DELETE PH_DOSAGE_LIMIT_FOR_AGE_GROUP WHERE DRUG_CODE = ? AND AGE_GROUP_CODE = ?");
		dataMap.put("SQL_PH_TPN_DRUG_SEARCH_SELECT", "SELECT DISTINCT A.TPN_REGIMEN_CODE code, A.LONG_NAME description FROM PH_TPN_REGIMEN_LANG_VW A,OR_ORDER_CATALOG B WHERE A.TPN_REGIMEN_CODE = B.ORDER_CATALOG_CODE AND A.LONG_NAME LIKE UPPER(?) AND A.TPN_REGIMEN_CODE LIKE UPPER(?) AND A.TPN_REGIMEN_CODE = NVL('',A.TPN_REGIMEN_CODE) AND B.EFF_STATUS='E' AND A.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT1", "SELECT  GENERIC_ID  code,  GENERIC_NAME  description  FROM  PH_GENERIC_NAME_LANG_VW  PH_GENERIC_NAME    WHERE   UPPER(GENERIC_ID)  LIKE  UPPER(?)  AND  UPPER(GENERIC_NAME)  LIKE  UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT2", "SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG_LANG_VW PH_DRUG WHERE  DISCONTINUED_YN='N' AND UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DRUG_YN='Y' AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT2A", "SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG_LANG_VW PH_DRUG WHERE  DISCONTINUED_YN='N' AND UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?)  AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT3", "SELECT A.TRADE_CODE code,B.LONG_NAME description FROM PH_TRADE_NAME_FOR_DRUG A, AM_TRADE_NAME_LANG_VW B WHERE UPPER(A.TRADE_CODE) LIKE UPPER(?) AND UPPER(B.LONG_NAME) LIKE UPPER(?) AND A.TRADE_CODE = B.TRADE_ID AND B.EFF_STATUS ='E' AND B.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT4", "SELECT FORM_CODE, FORM_DESC FROM PH_FORM WHERE EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT4A", "SELECT FORM_CODE CODE, FORM_DESC DESCRIPTION FROM PH_FORM_LANG_VW PH_FORM WHERE EFF_STATUS='E' and upper(FORM_CODE) like upper(?) and upper(FORM_DESC) like upper(?) AND LANGUAGE_ID =	");

		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT5", "SELECT UOM_CODE, SHORT_DESC FROM AM_UOM WHERE STRENGTH_UOM_YN='Y' AND EFF_STATUS='E' ORDER BY 2 ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT6", "SELECT ROUTE_CODE, ROUTE_DESC FROM PH_ROUTE WHERE EFF_STATUS='E' ORDER BY 2 ");

		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT6A", "SELECT ROUTE_CODE CODE, ROUTE_DESC DESCRIPTION FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE EFF_STATUS='E' and upper(ROUTE_CODE) like upper(?) and upper(ROUTE_DESC) like upper(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_BLCORE_GET_DECIMAL_PLACE", "SELECT BLCORE.GET_DECIMAL_PLACE(?) decimal_place FROM dual");

		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT7", "SELECT SCHEDULE_ID,SCHEDULE_DESC,DISP_AUTH_REQD_YN FROM PH_DRUG_SCHEDULE_LANG_VW PH_DRUG_SCHEDULE WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");

       //dataMap.put("SQL_PH_DRUG_SEARCH_SELECT7", "SELECT SCHEDULE_ID,SCHEDULE_DESC,DISP_AUTH_REQD_YN FROM PH_DRUG_SCHEDULE_LANG_VW PH_DRUG_SCHEDULE WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");



		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT8", "SELECT C.MANUFACTURER_ID code,B.SHORT_NAME description FROM PH_TRADE_NAME_FOR_DRUG A, AM_MANUFACTURER B, AM_TRADE_NAME C WHERE UPPER(C.MANUFACTURER_ID) LIKE UPPER(?) AND UPPER(B.SHORT_NAME) LIKE UPPER(?) AND A.TRADE_CODE=C.TRADE_ID AND C.MANUFACTURER_ID= B.MANUFACTURER_ID AND B.EFF_STATUS ='E'");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT9", "SELECT DISP_LOCN_CODE,SHORT_DESC FROM PH_DISP_LOCN WHERE EFF_STATUS='E'  AND UPPER(FACILITY_ID) LIKE UPPER(?) ");		
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT11", "SELECT A.TRADE_CODE , B.LONG_NAME FROM PH_TRADE_NAME_FOR_DRUG A, AM_TRADE_NAME B WHERE A.TRADE_CODE = B.TRADE_ID AND A.EFF_STATUS = 'E' ORDER BY 2");		
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT12", "SELECT MANUFACTURER_ID code, SHORT_NAME description FROM AM_MANUFACTURER_LANG_VW AM_MANUFACTURER WHERE UPPER(MANUFACTURER_ID) LIKE UPPER(?) AND UPPER(SHORT_NAME) LIKE UPPER(?) AND EFF_STATUS='E' AND LANGUAGE_ID = ");
		//A.STRENGTH_UOM DRUG_STRENGTH ADDED FOR GHL-CRF-0548
		//MMS-DM-SCF-0806 Start.
		//dataMap.put("SQL_PH_DRUG_SEARCH_SELECT13", "SELECT A.DRUG_CODE,A.STRENGTH_UOM DRUG_STRENGTH, A.DRUG_DESC,A.FORM_CODE, A.FORM_DESC,A.STRENGTH_VALUE,A.STRENGTH_UOM_DESC,A.ROUTE_CODE,A.ROUTE_DESC,A.GENERIC_NAME,A.GENERIC_ID, A.TRADE_CODE, A.TRADE_NAME,A.PRES_BASE_UOM, A.IN_FORMULARY_YN,R.ROUTE_COLOR, NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ?), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = a.drug_code and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, A.DRUG_CLASS, (select Ph_Drug_Appl_For_Pat_age_grp(A.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn , PROMPT_ALERT_PREFERRED_DRUG,(select short_desc from am_uom_lang_vw where uom_code =stock_uom and language_id =? ) stock_uom_desc,ph_get_ext_prod_drug_code(a.drug_code,?)EXTERNAL_PRODUCT_ID  FROM ph_drug_vw_lang_vw A, PH_GENERIC_NAME_BY_ATC_CLASS B,ph_route_lang_vw r WHERE A.GENERIC_ID = B.GENERIC_ID AND A.DISCONTINUED_YN = 'N' AND UPPER(B.ATC_CLASS_LEV1_CODE) = UPPER(?) and a.ROUTE_CODE= R.ROUTE_CODE AND A.LANG1 = R.LANGUAGE_ID");// added r.ROUTE_COLOR and a.ROUTE_CODE= R.ROUTE_CODE AND A.LANG1 = R.LANGUAGE_ID ,ph_route_lang_vw r for CRF RUT-CRF-0034.1[IN:037389] 
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT13", "SELECT A.DRUG_CODE,A.STRENGTH_UOM DRUG_STRENGTH, A.DRUG_DESC,A.FORM_CODE, A.FORM_DESC,A.STRENGTH_VALUE,A.STRENGTH_UOM_DESC,A.ROUTE_CODE,A.ROUTE_DESC,A.GENERIC_NAME,A.GENERIC_ID, A.TRADE_CODE, A.TRADE_NAME,A.PRES_BASE_UOM, A.IN_FORMULARY_YN,R.ROUTE_COLOR, NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ?  AND pr_diag.curr_status!='E'  ##DIAGNOSISLEVEL##  ), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = a.drug_code and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, A.DRUG_CLASS, (select Ph_Drug_Appl_For_Pat_age_grp(A.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn , PROMPT_ALERT_PREFERRED_DRUG,(select short_desc from am_uom_lang_vw where uom_code =stock_uom and language_id =? ) stock_uom_desc,ph_get_ext_prod_drug_code(a.drug_code,?)EXTERNAL_PRODUCT_ID  FROM ph_drug_vw_lang_vw A, PH_GENERIC_NAME_BY_ATC_CLASS B,ph_route_lang_vw r WHERE A.GENERIC_ID = B.GENERIC_ID AND A.DISCONTINUED_YN = 'N' AND UPPER(B.ATC_CLASS_LEV1_CODE) = UPPER(?) and a.ROUTE_CODE= R.ROUTE_CODE AND A.LANG1 = R.LANGUAGE_ID");// added r.ROUTE_COLOR and a.ROUTE_CODE= R.ROUTE_CODE AND A.LANG1 = R.LANGUAGE_ID ,ph_route_lang_vw r for CRF RUT-CRF-0034.1[IN:037389] 
		//MMS-DM-SCF-0806 End.
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT13A", "SELECT A.DRUG_CODE, A.DRUG_DESC,A.FORM_CODE, A.FORM_DESC,A.STRENGTH_VALUE,A.STRENGTH_UOM_DESC,A.ROUTE_CODE,A.ROUTE_DESC,A.GENERIC_NAME,A.GENERIC_ID, A.TRADE_CODE, A.TRADE_NAME,A.PRES_BASE_UOM, A.IN_FORMULARY_YN, NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ? ), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = a.drug_code and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, A.DRUG_CLASS, (select Ph_Drug_Appl_For_Pat_age_grp(A.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn FROM PH_DRUG_VW A, PH_GEN_BY_PHARMACO_CLASS B WHERE A.GENERIC_ID = B.GENERIC_ID AND A.DISCONTINUED_YN = 'N' AND UPPER(B.DRUG_CLASS_GROUP_NO) = UPPER(?)");		
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT14", "SELECT ORDER_TYPE_CODE, SHORT_DESC FROM OR_ORDER_TYPE WHERE ORDER_CATEGORY='PH' AND EFF_STATUS='E'");		
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT", "SELECT DRUG_CODE, ITEM_CODE, DRUG_DESC, FORM_CODE, FORM_DESC, STRENGTH_VALUE, STRENGTH_UOM, STRENGTH_UOM_DESC,STRENGTH_PER_PRES_UOM, STRENGTH_PER_VALUE_PRES_UOM,PRES_BASE_UOM,ROUTE_CODE, ROUTE_DESC,TRADE_NAME,GENERIC_NAME,GENERIC_ID,PRES_BASE_UOM,IN_FORMULARY_YN,TRADE_CODE,ITEM_CODE, DRUG_CLASS FROM  PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE DISCONTINUED_YN = 'N' AND UPPER(GENERIC_ID) LIKE UPPER(?) AND UPPER(GENERIC_NAME) LIKE UPPER(?) AND UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND UPPER(FORM_CODE) LIKE UPPER(?) AND UPPER(ROUTE_CODE) LIKE UPPER(?)   AND NVL(STRENGTH_UOM,'X') LIKE UPPER(?) AND NVL(DRUG_CLASS,'X') LIKE ? AND NVL(SCHEDULE_ID,'X') LIKE UPPER(?) AND NVL(RESTRICTED_DRUG_YN,'X') LIKE DECODE(?,'B',RESTRICTED_DRUG_YN,?) AND NVL(DRUG_TYPE,'X') LIKE DECODE(?,'A',DRUG_TYPE,?) AND NVL(IV_INGREDIENT_YN,'X') LIKE DECODE(?,'B',IV_INGREDIENT_YN,?) AND NVL(IV_FLUID_YN,'X') LIKE DECODE(?,'B',IV_FLUID_YN,?) AND NVL(COMPOUND_DRUG_YN,'X') LIKE DECODE(?,'B',COMPOUND_DRUG_YN,?) AND NVL(IN_FORMULARY_YN,'X') LIKE DECODE(?,'B',IN_FORMULARY_YN,?) AND NVL(AFFECTS_PREGNANCY_YN,'X') LIKE DECODE(?,'B',AFFECTS_PREGNANCY_YN,?) AND NVL(AFFECTS_LAB_RESULTS_YN,'X') LIKE DECODE(?,'B',AFFECTS_LAB_RESULTS_YN,?) AND NVL(AFFECTS_BREAST_FEEDING_YN,'X') LIKE DECODE(?,'B',AFFECTS_BREAST_FEEDING_YN,?) AND  UPPER(NVL(MANUFACTURER_ID,'X')) LIKE UPPER(?) AND UPPER(NVL(MANUFACTURER_NAME,'X')) LIKE UPPER(?) AND   UPPER(NVL(TRADE_CODE,'X')) LIKE UPPER(?) AND  UPPER(NVL(TRADE_NAME,'X')) LIKE UPPER(?) AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_ALL_DRUG_SEARCH_SELECT", "SELECT DRUG_CODE, ITEM_CODE, DRUG_DESC, FORM_CODE, FORM_DESC, STRENGTH_VALUE, STRENGTH_UOM, STRENGTH_UOM_DESC,STRENGTH_PER_PRES_UOM, STRENGTH_PER_VALUE_PRES_UOM,PRES_BASE_UOM,ROUTE_CODE, ROUTE_DESC,TRADE_NAME,GENERIC_NAME,GENERIC_ID,PRES_BASE_UOM,IN_FORMULARY_YN,TRADE_CODE, DRUG_CLASS FROM  PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE DISCONTINUED_YN = 'N' AND UPPER(GENERIC_ID) LIKE UPPER(?) AND (UPPER(GENERIC_NAME) LIKE UPPER(?) OR UPPER(DRUG_DESC) LIKE UPPER(?) OR UPPER(NVL(TRADE_NAME,'X')) LIKE UPPER(?)) AND UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(FORM_CODE) LIKE UPPER(?) AND UPPER(ROUTE_CODE) LIKE UPPER(?)   AND NVL(STRENGTH_UOM,'X') LIKE UPPER(?) AND NVL(DRUG_CLASS,'X') LIKE ? AND NVL(SCHEDULE_ID,'X') LIKE UPPER(?) AND NVL(RESTRICTED_DRUG_YN,'X') LIKE DECODE(?,'B',RESTRICTED_DRUG_YN,?) AND NVL(DRUG_TYPE,'X') LIKE DECODE(?,'A',DRUG_TYPE,?) AND NVL(IV_INGREDIENT_YN,'X') LIKE DECODE(?,'B',IV_INGREDIENT_YN,?) AND NVL(IV_FLUID_YN,'X') LIKE DECODE(?,'B',IV_FLUID_YN,?) AND NVL(COMPOUND_DRUG_YN,'X') LIKE DECODE(?,'B',COMPOUND_DRUG_YN,?) AND NVL(IN_FORMULARY_YN,'X') LIKE DECODE(?,'B',IN_FORMULARY_YN,?) AND NVL(AFFECTS_PREGNANCY_YN,'X') LIKE DECODE(?,'B',AFFECTS_PREGNANCY_YN,?) AND NVL(AFFECTS_LAB_RESULTS_YN,'X') LIKE DECODE(?,'B',AFFECTS_LAB_RESULTS_YN,?) AND NVL(AFFECTS_BREAST_FEEDING_YN,'X') LIKE DECODE(?,'B',AFFECTS_BREAST_FEEDING_YN,?) AND  UPPER(NVL(MANUFACTURER_ID,'X')) LIKE UPPER(?) AND UPPER(NVL(MANUFACTURER_NAME,'X')) LIKE UPPER(?) AND   UPPER(NVL(TRADE_CODE,'X')) LIKE UPPER(?) AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ? ORDER BY DRUG_DESC,FORM_DESC");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT21", "SELECT A.ORDER_TYPE_CODE code,B.SHORT_DESC short_desc FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A,OR_ORDER_TYPE_LANG_VW B WHERE A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND B.EFF_STATUS='E' AND A.DRUG_CLASS= ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT22", "SELECT A.DRUG_CATG_CODE,A.PATIENT_CLASS,A.MAX_DURN_VALUE,A.MAX_DURN_TYPE ,A.ACTION chk_for_max_durn_action,A.ORD_AUTH_LEVEL,A.PROMPT_MSG FROM PH_DRG_CTG_RLE_BY_PTCL_LANG_VW A WHERE A.DRUG_CATG_CODE= ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT23", "SELECT A.ORDER_AUTH_LEVEL ord_auth_level,A.ORDER_COSIGN_LEVEL ord_cosign_level,A.SPL_APPR_LEVEL ord_spl_appr_level,A.DISP_AUTH_REQD_YN result_auth_reqd_yn,A.REPEAT_SINGLE_CONT_ORDER_YN FROM PH_DRUG_SCHEDULE_LANG_VW A WHERE SCHEDULE_ID= ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT24", "SELECT A.ORDER_TYPE_CODE code,B.SHORT_DESC short_desc FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A,OR_ORDER_TYPE_LANG_VW B WHERE A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND B.EFF_STATUS='E' AND A.DRUG_CLASS='G' AND B.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT25", "SELECT A.DRUG_CATG_CODE,A.PATIENT_CLASS,A.MAX_DURN_VALUE,A.MAX_DURN_TYPE,A.ACTION,A.ORD_AUTH_LEVEL,A.PROMPT_MSG FROM PH_DRG_CTG_RLE_BY_PTCL_LANG_VW A WHERE A.DRUG_CATG_CODE= ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT26", "SELECT A.ORDER_AUTH_LEVEL,A.ORDER_COSIGN_LEVEL,A.SPL_APPR_LEVEL,A.DISP_AUTH_REQD_YN,A.REPEAT_SINGLE_CONT_ORDER_YN FROM PH_DRUG_SCHEDULE WHERE SCHEDULE_ID= ");

        dataMap.put("SQL_PH_DRUG_SEARCH_SELECT27", "select  DISP_LOCN_CODE, SHORT_DESC from  ph_disp_locn_LANG_VW  where disp_locn_code= ? and facility_id= ? AND LANGUAGE_ID =?");

		dataMap.put("SQL_PH_DRUG_SEARCH_ORDER_TYPE_SELECT", "SELECT /*+ ORDERED */ B.DRUG_CODE,B.DRUG_DESC,B.FORM_CODE,C.FORM_DESC,B.STRENGTH_VALUE,B.STRENGTH_UOM,B.STRENGTH_PER_PRES_UOM, B.STRENGTH_PER_VALUE_PRES_UOM,B.PRES_BASE_UOM, D.SHORT_DESC STRENGTH_UOM_DESC, B.ROUTE_CODE,E.ROUTE_DESC,F.TRADE_CODE,G.SHORT_NAME  TRADE_NAME, B.GENERIC_ID,H.GENERIC_NAME,B.PRES_BASE_UOM,B.IN_FORMULARY_YN,TRADE_CODE,B.ITEM_CODE,NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ?), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = b.drug_code and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, B.DRUG_CLASS, (select Ph_Drug_Appl_For_Pat_age_grp(B.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn, B.DISP_MULTI_STRENGTH_YN, B.DISP_ALT_FORM_YN  FROM OR_ORDER_CATALOG A, PH_DRUG_LANG_VW B,PH_FORM_LANG_VW C,AM_UOM_LANG_VW D,PH_ROUTE_LANG_VW E, PH_TRADE_NAME_FOR_DRUG F, AM_TRADE_NAME_LANG_VW G, PH_GENERIC_NAME_LANG_VW H,  OR_CATALOG_BY_PTCL_LANG_VW I,PH_PARAM_LANG_VW J WHERE B.DRUG_YN='Y'  AND B.DISCONTINUED_YN = 'N' AND A.ORDER_CATEGORY='PH' AND A.EFF_STATUS='E' 	AND B.DRUG_CODE = A.ORDER_CATALOG_CODE AND C.FORM_CODE = B.FORM_CODE  AND D.UOM_CODE(+) = B.STRENGTH_UOM AND E.ROUTE_CODE = B.ROUTE_CODE AND F.DRUG_CODE(+) = B.DRUG_CODE AND F.TRADE_CODE = G.TRADE_ID(+) AND H.GENERIC_ID = B.GENERIC_ID  AND B.GENERIC_ID = NVL(?,B.GENERIC_ID)	AND UPPER(H.GENERIC_NAME) LIKE UPPER(NVL(?,H.GENERIC_NAME))AND UPPER(B.DRUG_CODE) =UPPER(NVL(?,B.DRUG_CODE))AND UPPER(B.DRUG_DESC) LIKE UPPER(NVL(?,B.DRUG_DESC)) AND UPPER(B.FORM_CODE) = UPPER(NVL(?,B.FORM_CODE))  AND B.ROUTE_CODE = NVL(?,B.ROUTE_CODE) AND NVL(F.TRADE_CODE,'X') LIKE DECODE(?,'X',F.TRADE_CODE,?)AND NVL(B.STRENGTH_UOM,'X') LIKE DECODE(?,'X',B.STRENGTH_UOM,?) AND NVL(UPPER(G.SHORT_NAME),'X') LIKE DECODE(UPPER(?),'X',UPPER(G.SHORT_NAME),UPPER(?)) AND  I.PATIENT_CLASS =OR_PATIENT_ORDER_APPLICABLE( ?,A.ORDER_CATALOG_CODE) AND A.ORDER_CATALOG_CODE = I.ORDER_CATALOG_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = H.LANGUAGE_ID AND B.LANGUAGE_ID = I.LANGUAGE_ID AND B.LANGUAGE_ID = J.LANGUAGE_ID AND F.EFF_STATUS(+) = 'E' AND G.EFF_STATUS(+) = 'E' AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ? AND G.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_ALL_DRUG_SEARCH_ORDER_TYPE_SELECT", "SELECT /*+ ORDERED */ B.DRUG_CODE,B.DRUG_DESC,B.FORM_CODE,C.FORM_DESC,B.STRENGTH_VALUE,B.STRENGTH_UOM,B.STRENGTH_PER_PRES_UOM, B.STRENGTH_PER_VALUE_PRES_UOM,B.PRES_BASE_UOM, D.SHORT_DESC STRENGTH_UOM_DESC, B.ROUTE_CODE,E.ROUTE_DESC,F.TRADE_CODE,G.SHORT_NAME  TRADE_NAME, B.GENERIC_ID,H.GENERIC_NAME,B.PRES_BASE_UOM,B.IN_FORMULARY_YN,TRADE_CODE,B.ITEM_CODE,NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ?), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = b.drug_code and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, B.DRUG_CLASS, (select Ph_Drug_Appl_For_Pat_age_grp(B.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn, B.DISP_MULTI_STRENGTH_YN, B.DISP_ALT_FORM_YN  FROM OR_ORDER_CATALOG A, PH_DRUG_LANG_VW B,PH_FORM_LANG_VW C,AM_UOM_LANG_VW D,PH_ROUTE_LANG_VW E, PH_TRADE_NAME_FOR_DRUG F, AM_TRADE_NAME_LANG_VW G, PH_GENERIC_NAME_LANG_VW H,  OR_CATALOG_BY_PTCL_LANG_VW I,PH_PARAM_LANG_VW J WHERE B.DRUG_YN='Y'  AND B.DISCONTINUED_YN = 'N' AND A.ORDER_CATEGORY='PH' AND A.EFF_STATUS='E' 	AND B.DRUG_CODE = A.ORDER_CATALOG_CODE AND C.FORM_CODE = B.FORM_CODE  AND D.UOM_CODE(+) = B.STRENGTH_UOM AND E.ROUTE_CODE = B.ROUTE_CODE AND F.DRUG_CODE(+) = B.DRUG_CODE AND F.TRADE_CODE = G.TRADE_ID(+) AND H.GENERIC_ID = B.GENERIC_ID  AND B.GENERIC_ID = NVL(?,B.GENERIC_ID)	AND (UPPER(H.GENERIC_NAME) LIKE UPPER(NVL(?,H.GENERIC_NAME)) OR UPPER(B.DRUG_DESC) LIKE UPPER(NVL(?,B.DRUG_DESC)) OR NVL(UPPER(G.SHORT_NAME),'X') LIKE DECODE(UPPER(?),'X',NVL(UPPER(G.SHORT_NAME),'X'),UPPER(?))) AND UPPER(B.DRUG_CODE) =UPPER(NVL(?,B.DRUG_CODE)) AND UPPER(B.FORM_CODE) = UPPER(NVL(?,B.FORM_CODE))  AND B.ROUTE_CODE = NVL(?,B.ROUTE_CODE) AND NVL(F.TRADE_CODE,'X') LIKE DECODE(?,'X',NVL(F.TRADE_CODE,'X'),?)AND NVL(B.STRENGTH_UOM,'X') LIKE DECODE(?,'X',B.STRENGTH_UOM,?)  AND  I.PATIENT_CLASS =OR_PATIENT_ORDER_APPLICABLE( ?,A.ORDER_CATALOG_CODE) AND A.ORDER_CATALOG_CODE = I.ORDER_CATALOG_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = H.LANGUAGE_ID AND B.LANGUAGE_ID = I.LANGUAGE_ID AND B.LANGUAGE_ID = J.LANGUAGE_ID AND F.EFF_STATUS(+) = 'E' AND G.EFF_STATUS(+) = 'E' AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ? AND G.LANGUAGE_ID(+) = ?");
		//A.STRENGTH_UOM DRUG_STRENGTH, ADDED FOR GHL-CRF-0548
		//MMS-DM-SCF-0806 Start.
		//dataMap.put("SQL_PH_DRUG_SEARCH_ORDER_TYPE_ATC_SELECT", "SELECT   A.DRUG_CODE,A.STRENGTH_UOM DRUG_STRENGTH, A.ITEM_CODE,  A.DRUG_DESC,  A.FORM_CODE,  A.FORM_DESC,  A.STRENGTH_VALUE,  A.STRENGTH_UOM_DESC,  A.ROUTE_CODE,  A.ROUTE_DESC,  A.GENERIC_NAME,  A.GENERIC_ID,A.TRADE_CODE,A.TRADE_NAME,A.PRES_BASE_UOM, A.IN_FORMULARY_YN, NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ?), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = a.drug_code     and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, A.DRUG_CLASS , (select Ph_Drug_Appl_For_Pat_age_grp(A.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn, A.DISP_MULTI_STRENGTH_YN, A.DISP_ALT_FORM_YN, or_get_priv_appl_yn(?,?,'OR',A.DRUG_CODE,?,C.ORDER_TYPE_CODE,'PH') DRUG_PRIV_GRP_YN, a.PROMPT_ALERT_PREFERRED_DRUG,(select short_desc from am_uom_lang_vw where uom_code =stock_uom and language_id =a.lang1 ) stock_uom_desc,ph_get_ext_prod_drug_code(a.drug_code,?)EXTERNAL_PRODUCT_ID, A.BILLABLE_ITEM_YN,R.ROUTE_COLOR FROM  ph_drug_vw_lang_vw A,  PH_GENERIC_NAME_BY_ATC_CLASS B,   OR_ORDER_CATALOG C ,OR_ORDER_CATALOG_BY_PTCL D,PH_PARAM E,ph_route_lang_vw r WHERE    C.ORDER_CATALOG_CODE = A.DRUG_CODE AND   C.ORDER_CATEGORY='PH'AND C.EFF_STATUS='E' AND   A.GENERIC_ID = B.GENERIC_ID AND   A.DISCONTINUED_YN = 'N' AND  UPPER(NVL(C.ORDER_TYPE_CODE,'X'))LIKE UPPER(DECODE(?,'X',C.ORDER_TYPE_CODE,?)) AND    UPPER(B.ATC_CLASS_LEV1_CODE) = UPPER(?) AND  D.PATIENT_CLASS =OR_PATIENT_ORDER_APPLICABLE( ?,C.ORDER_CATALOG_CODE) AND C.ORDER_CATALOG_CODE = D.ORDER_CATALOG_CODE AND a.ROUTE_CODE= R.ROUTE_CODE AND A.LANG1 = R.LANGUAGE_ID"); // added r.ROUTE_COLOR and a.ROUTE_CODE= R.ROUTE_CODE AND A.LANG1 = R.LANGUAGE_ID ,ph_route_lang_vw r for CRF RUT-CRF-0034.1[IN:037389] 
		dataMap.put("SQL_PH_DRUG_SEARCH_ORDER_TYPE_ATC_SELECT", "SELECT   A.DRUG_CODE,A.STRENGTH_UOM DRUG_STRENGTH, A.ITEM_CODE,  A.DRUG_DESC,  A.FORM_CODE,  A.FORM_DESC,  A.STRENGTH_VALUE,  A.STRENGTH_UOM_DESC,  A.ROUTE_CODE,  A.ROUTE_DESC,  A.GENERIC_NAME,  A.GENERIC_ID,A.TRADE_CODE,A.TRADE_NAME,A.PRES_BASE_UOM, A.IN_FORMULARY_YN, NVL((SELECT MAX(DECODE ((SELECT DISTINCT 'Y' FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ? AND pr_diag.curr_status!='E' ##DIAGNOSISLEVEL## ), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = a.drug_code     and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, A.DRUG_CLASS , (select Ph_Drug_Appl_For_Pat_age_grp(A.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn, A.DISP_MULTI_STRENGTH_YN, A.DISP_ALT_FORM_YN, or_get_priv_appl_yn(?,?,'OR',A.DRUG_CODE,?,C.ORDER_TYPE_CODE,'PH') DRUG_PRIV_GRP_YN, a.PROMPT_ALERT_PREFERRED_DRUG,(select short_desc from am_uom_lang_vw where uom_code =stock_uom and language_id =a.lang1 ) stock_uom_desc,ph_get_ext_prod_drug_code(a.drug_code,?)EXTERNAL_PRODUCT_ID, A.BILLABLE_ITEM_YN,R.ROUTE_COLOR FROM  ph_drug_vw_lang_vw A,  PH_GENERIC_NAME_BY_ATC_CLASS B,   OR_ORDER_CATALOG C ,OR_ORDER_CATALOG_BY_PTCL D,PH_PARAM E,ph_route_lang_vw r WHERE    C.ORDER_CATALOG_CODE = A.DRUG_CODE AND   C.ORDER_CATEGORY='PH'AND C.EFF_STATUS='E' AND   A.GENERIC_ID = B.GENERIC_ID AND   A.DISCONTINUED_YN = 'N' AND  UPPER(NVL(C.ORDER_TYPE_CODE,'X'))LIKE UPPER(DECODE(?,'X',C.ORDER_TYPE_CODE,?)) AND    UPPER(B.ATC_CLASS_LEV1_CODE) = UPPER(?) AND  D.PATIENT_CLASS =OR_PATIENT_ORDER_APPLICABLE( ?,C.ORDER_CATALOG_CODE) AND C.ORDER_CATALOG_CODE = D.ORDER_CATALOG_CODE AND a.ROUTE_CODE= R.ROUTE_CODE AND A.LANG1 = R.LANGUAGE_ID"); 
		//MMS-DM-SCF-0806
		
		dataMap.put("SQL_PH_DRUG_SEARCH_ORDER_TYPE_PHARMA_SELECT", "SELECT   A.DRUG_CODE,  A.DRUG_DESC,  A.FORM_CODE,  A.FORM_DESC,  A.STRENGTH_VALUE,  A.STRENGTH_UOM_DESC,  A.ROUTE_CODE,  A.ROUTE_DESC,  A.GENERIC_NAME,  A.GENERIC_ID,A.TRADE_CODE,A.TRADE_NAME,A.PRES_BASE_UOM, A.IN_FORMULARY_YN, NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ?), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = a.drug_code     and ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, A.DRUG_CLASS, (select Ph_Drug_Appl_For_Pat_age_grp(A.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn  FROM   PH_DRUG_VW A,  PH_GEN_BY_PHARMACO_CLASS B,   OR_ORDER_CATALOG C ,OR_ORDER_CATALOG_BY_PTCL D,PH_PARAM E WHERE    C.ORDER_CATALOG_CODE = A.DRUG_CODE AND   C.ORDER_CATEGORY='PH'AND C.EFF_STATUS='E' AND   A.GENERIC_ID = B.GENERIC_ID AND   A.DISCONTINUED_YN = 'N' AND  UPPER(NVL(C.ORDER_TYPE_CODE,'X'))LIKE UPPER(DECODE(?,'X',C.ORDER_TYPE_CODE,?)) AND    UPPER(B.DRUG_CLASS_GROUP_NO) = UPPER(?) AND  D.PATIENT_CLASS =OR_PATIENT_ORDER_APPLICABLE( ?,C.ORDER_CATALOG_CODE) AND C.ORDER_CATALOG_CODE = D.ORDER_CATALOG_CODE");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT15","SELECT CONSIDER_STOCK_FOR_PRES_YN, ALLOW_PRES_WITHOUT_STOCK_YN,FACILITY_ID, IP_CONSIDER_STOCK_PRES_YN,IP_PRES_WITHOUT_STOCK_YN, DISP_CHARGE_DTL_IN_DRUG_LKP_YN,DISP_PRICE_TYPE_IN_DRUG_LKP  FROM ph_facility_param WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT16","SELECT RTN_ORD_DISP_LOCN_CODE,STAT_ORD_DISP_LOCN_CODE,DISCH_ORD_DISP_LOCN_CODE FROM PH_ORDER_ROUTING WHERE ORDERING_SOURCE_TYPE = ? and ORDERING_FACILITY_ID=? and ORDERING_SOURCE_CODE=? ");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT16A","SELECT PH_DISP_STOCK_LOCN(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) DISP_LOCN from dual ");//ADDED FOR GHL-CRF-0509,modified for NMC-JD-CRF-0063
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT17","SELECT STORE_CODE,LONG_DESC FROM PH_DISP_LOCN WHERE DISP_LOCN_CODE=? and facility_id=?");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT18","SELECT COUNT(*) COUNT FROM AM_STAT_GROUP A, AM_STAT_GRP_DETAIL B, MP_PATIENT C WHERE A.STAT_GRP_CAT='N' AND A.STAT_GRP_ID=B.STAT_GRP_ID AND B.MEMBER_ID=C.NATIONALITY_CODE AND C.PATIENT_ID=?");		
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT19","SELECT MEDN_ORDER_BY FROM PH_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_DRUG_SEARCH_SELECT20","SELECT a.store_code, b.short_desc,  SUM (a.qty_on_hand - committed_qty) avl_qty FROM st_item_batch a, ph_disp_locn_lang_vw b, st_item_store c, st_item d WHERE a.item_code = ?  AND ( (  d.USE_AFTER_EXPIRY_YN = 'N'  AND a.expiry_date_or_receipt_date >= SYSDATE ) OR ( d.USE_AFTER_EXPIRY_YN = 'Y' ) )  AND a.store_code = b.store_code  AND a.trade_id = NVL (?, a.trade_id)  AND b.language_id = ?  AND c.store_code = a.store_code  AND c.item_code = a.item_code  AND c.eff_status = 'E'  AND c.phy_inv_id IS NULL AND d.item_code = a.item_code and a.SUSPENDED_YN ='N' GROUP BY a.store_code, b.short_desc");
		dataMap.put("SQL_PH_DISC_DRUG_SELECT1", "SELECT A.DRUG_CODE, A.DRUG_DESC, A.GENERIC_ID, C.GENERIC_NAME, A.FORM_CODE, B.FORM_DESC, A.STRENGTH_VALUE, A.PRES_BASE_UOM, D.SHORT_DESC, E.ROUTE_DESC, A.COMPOUND_DRUG_YN FROM PH_DRUG A, PH_FORM B, PH_GENERIC_NAME C, AM_UOM D, PH_ROUTE E WHERE A.FORM_CODE=B.FORM_CODE(+)  AND A.GENERIC_ID=C.GENERIC_ID(+) AND A.PRES_BASE_UOM=D.UOM_CODE (+) AND A.DRUG_CODE=? AND A.DISCONTINUED_YN='N'");
		dataMap.put("SQL_PH_DISC_DRUG_SELECT2", "SELECT B.DRUG_CODE, B.DRUG_DESC, B.FORM_CODE, D.FORM_DESC, E.GENERIC_NAME, B.STRENGTH_VALUE, B.PRES_BASE_UOM, F.SHORT_DESC PRES_BASE_DESC, G.ROUTE_DESC, B.COMPOUND_DRUG_YN FROM  PH_DRUG B, PH_FORM D, PH_GENERIC_NAME E, AM_UOM F, PH_ROUTE G WHERE  B.FORM_CODE=D.FORM_CODE(+) AND B.GENERIC_ID=E.GENERIC_ID(+) AND B.PRES_BASE_UOM=F.UOM_CODE(+) AND B.ROUTE_CODE=G.ROUTE_CODE (+) AND B.DRUG_CODE LIKE UPPER(?) AND UPPER(B.DRUG_DESC) LIKE UPPER(?) AND UPPER(E.GENERIC_NAME) LIKE UPPER(?) AND UPPER(D.FORM_DESC) LIKE UPPER(?) AND NVL(B.COMPOUND_DRUG_YN,'X') LIKE DECODE(?,'B',B.COMPOUND_DRUG_YN,?) AND B.DISCONTINUED_YN='Y'");
		dataMap.put("SQL_PH_DISC_DRUG_SELECT3", "SELECT B.DRUG_CODE, B.DRUG_DESC, B.FORM_CODE, D.FORM_DESC, E.GENERIC_NAME, B.STRENGTH_VALUE, B.PRES_BASE_UOM, F.SHORT_DESC PRES_BASE_DESC, G.ROUTE_DESC, B.COMPOUND_DRUG_YN, B.DISCONTINUED_YN, B.DISCONTINUED_REASON FROM PH_DRUG_LANG_VW B, PH_FORM_LANG_VW D, PH_GENERIC_NAME_LANG_VW E, AM_UOM_LANG_VW F, PH_ROUTE_LANG_VW G WHERE B.FORM_CODE=D.FORM_CODE(+) AND B.GENERIC_ID=E.GENERIC_ID(+) AND B.PRES_BASE_UOM=F.UOM_CODE(+) AND B.ROUTE_CODE=G.ROUTE_CODE(+) AND B.DRUG_CODE=? AND B.LANGUAGE_ID = D.LANGUAGE_ID(+) AND B.LANGUAGE_ID = E.LANGUAGE_ID(+) AND B.LANGUAGE_ID = G.LANGUAGE_ID(+) AND B.LANGUAGE_ID = F.LANGUAGE_ID(+) AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISC_DRUG_SELECT4", "SELECT MODULE_ID FROM SM_MODULE WHERE MODULE_ID='OR' AND INSTALL_YN ='Y'");
		dataMap.put("SQL_PH_DISC_DRUG_SELECT5", "SELECT ORDER_CATALOG_CODE FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_DISC_DRUG_UPDATE", "UPDATE PH_DRUG SET DISCONTINUED_YN=?, DISCONTINUED_REASON=?, DISCONTINUED_DATE=SYSDATE, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,DISCONTINUED_BY_ID=? WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISC_OR_ORDER_UPDATE", "UPDATE OR_ORDER_CATALOG SET EFF_STATUS='D' WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("JNDI_PH_DISC_DRUG", "java:comp/env/DiscontinueDrug");
		dataMap.put("SQL_PH_DRUG_SEARCH_ALT_DRUG", "SELECT DRUG_CODE , ITEM_CODE, DRUG_DESC,STRENGTH_PER_PRES_UOM,STRENGTH_UOM_DESC,FORM_CODE,FORM_DESC,ROUTE_CODE,ROUTE_DESC,GENERIC_NAME,GENERIC_ID,TRADE_CODE, TRADE_NAME,PH_GET_UOM_DISPLAY(?,PRES_BASE_UOM) PRES_BASE_UOM,PH_GET_UOM_DISPLAY(?,STRENGTH_UOM) STRENGTH_UOM,STRENGTH_PER_VALUE_PRES_UOM,IN_FORMULARY_YN, NVL((SELECT MAX(DECODE ((SELECT pr_diag.term_set_id FROM pr_diagnosis pr_diag WHERE pr_diag.term_set_id = ph_elig.term_set_id AND pr_diag.term_code = ph_elig.term_code AND pr_diag.patient_id = ?), NULL, 'N','Y' )) diag FROM ph_drug_eligible_term_code ph_elig WHERE ph_elig.drug_code = drug_code and  ph_elig.eff_status = 'E'),'Y') DIAGNOSIS_FOUND_YN, DRUG_CLASS, (select Ph_Drug_Appl_For_Pat_age_grp(PH_DRUG_VW.DRUG_CODE,?,?) from dual) appl_for_age_grp_yn  FROM PH_DRUG_VW WHERE GENERIC_ID = ? AND ROUTE_CODE = ? AND DRUG_CODE !=? ORDER BY DRUG_DESC");
		dataMap.put("SQL_PH_DRUG_SEARCH_EXT_PRODUCT_ID", "SELECT ph_get_ext_prod_drug_code(?,?)EXTERNAL_PRODUCT_ID FROM dual");
		dataMap.put("SQL_PH_DISC_DRUG_SELECT6", "SELECT A.DRUG_CODE,A.DRUG_DESC,A.GENERIC_ID,C.GENERIC_NAME,A.FORM_CODE,B.FORM_DESC, A.STRENGTH_VALUE,A.PRES_BASE_UOM, E.ROUTE_DESC, A.COMPOUND_DRUG_YN FROM PH_DRUG A, PH_FORM B, PH_GENERIC_NAME C, AM_UOM D, PH_ROUTE E WHERE A.FORM_CODE = B.FORM_CODE(+)  AND A.GENERIC_ID = C.GENERIC_ID(+) AND A.PRES_BASE_UOM = D.UOM_CODE (+) AND A.DISCONTINUED_YN='N' ");
		dataMap.put("SQL_PH_DRUG_DETAILS_SELECT1", "SELECT DRUG_CODE, DRUG_DESC, IN_FORMULARY_YN, LINK_TO_EXISTING_ITEM, ITEM_CODE, GENERIC_ID, GENERIC_NAME, DRUG_CLASS, COMPOUND_DRUG_YN, FORM_CODE, FORM_DESC, ROUTE_CODE, ROUTE_DESC, DRUG_TYPE, SCHEDULE_ID, SCHEDULE_DESC, RESTRICTED_DRUG_YN,TRIAL_DRUG_YN, AFFECTS_PREGNANCY_YN, AFFECTS_BREAST_FEEDING_YN, AFFECTS_LAB_RESULTS_YN, STABILITY_REQD_YN, STABILITY_HRS, PT_COUN_REQD_YN,PRES_BASE_UOM, PRES_BASE_UOM_DESC,CALC_DOSG_BY_FREQ_DURN_YN, STRENGTH_VALUE, STRENGTH_UOM, STRENGTH_UOM_DESC, STRENGTH_PER_PRES_UOM, STRENGTH_PER_VALUE_PRES_UOM, PRES_CATG_CODE, PRES_CATG_DESC, STOCK_UOM, STOCK_UOM_DESC, CONTENT_IN_PRES_BASE_UOM, FRACT_DOSE_ROUND_UP_YN,DISP_ALT_FORM_YN, DISP_MULTI_STRENGTH_YN, PRN_DOSES_PRES_PRD_FILL, PRN_DOSES_CONT_DAILY_FILL, DISP_AUTH_REQD_YN, DISP_VIA_PRES_ONLY_YN, DISP_AGAINST_DAMAGE_YN, CAUTION_LABEL_TEXT_ID_1, CAUTION_LABEL_TEXT_ID1_DESC, CAUTION_LABEL_TEXT_ID_2, CAUTION_LABEL_TEXT_ID2_DESC, SPL_INSTR_LABEL_TEXT_ID, SPL_INSTR_LABEL_TEXT_ID1,SPL_INSTR_LABEL_TEXT_ID_DESC, HOW_TO_TAKE_TEXT, IV_INGREDIENT_YN, IV_FLUID_YN, INFUSE_OVER_VALUE, INFUSE_OVER_DURN_TYPE,PHYSICAL_FORM, ORDER_TYPE_CODE, DISCONTINUED_YN, DISCONTINUED_REASON, DISCONTINUED_DATE, DISCONTINUED_BY_ID, TRADE_CODE, MANUFACTURER_ID,PHYSICAL_FORM,CALC_DEF_DOSAGE_YN, IV_FLUID_FOR_ONCO_YN,DFLT_FLUID_CODE,APPL_PIGGY_BACK_YN,APPL_TO_RECONST_FLUID_YN,APPL_TO_TDM_YN, APPL_TO_VERBAL_ORDER_YN, APPL_FOR_COMPOUNDING_RX_YN,HOW_TO_TAKE_TEXT_LOCAL,MEDN_ADMN_DTL_REQD_YN,DRUG_INFORMATION,PATIENT_EDUCATION,WEIGHT_REC_APPL_AGE_GROUP, DIAG_REC_APPL,DIAG_SCR_NOTE_TYPE,DRUG_INFORMATION, PATIENT_EDUCATION,FRACT_DOSE_APPL_YN,ITEM_IMAGE_FILENAME,verification_reqd_yn,EDL_CODES, EDL_REMARKS, ALLOW_MORETHAN_PRES_QTY_YN FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE DRUG_CODE = ? AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_DRUG_DETAILS_SELECT2", "SELECT A.GENERIC_ID,B.GENERIC_NAME, A.DISPLAY_SEQ_NO FROM PH_GENERIC_NAME_FOR_DRUG A, PH_GENERIC_NAME_LANG_VW B WHERE A.GENERIC_ID=B.GENERIC_ID AND A.DRUG_CODE = ? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_DETAILS_SELECT3", "SELECT A.LONG_NAME LONG_DESC,C.LONG_NAME LONG_NAME,B.DISPLAY_SEQ_NO,B.TRADE_CODE FROM AM_TRADE_NAME_LANG_VW A, PH_TRADE_NAME_FOR_DRUG B , AM_MANUFACTURER_LANG_VW C WHERE A.TRADE_ID=B.TRADE_CODE AND A.MANUFACTURER_ID=C.MANUFACTURER_ID(+) AND B.EFF_STATUS='E' AND B.DRUG_CODE=? AND A.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? ORDER BY B.DISPLAY_SEQ_NO");
		dataMap.put("SQL_PH_DRUG_DETAILS_SELECT4", "SELECT   A.DRUG_CODE,  A.INVENTORY_ITEM_CODE,  D.LONG_DESC INVENTORY_ITEM_DESC,  A.STOCK_UOM,  C.SHORT_DESC STOCK_UOM_DESC ,  A.CONTENT_IN_PRES_BASE_UOM,  A.CONTENT_IN_STRENGTH_UOM FROM   PH_INVENTORY_ITEM_FOR_DRUG A,  ST_ITEM B,  AM_UOM_LANG_VW C,  MM_ITEM_LANG_VW D WHERE   A.INVENTORY_ITEM_CODE = B.ITEM_CODE AND   B.ITEM_CODE = D.ITEM_CODE AND   A.STOCK_UOM = C.UOM_CODE AND   A.DRUG_CODE= ? AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_DETAILS_SELECT5", "SELECT COUNT(ROWID) FROM SM_MODULE WHERE MODULE_ID='ST' AND INSTALL_YN='Y'");
		dataMap.put("SQL_PH_DRUG_DIGNOSIS_SELECT", "SELECT a.term_set_id term_set, long_desc diag_desc FROM ph_drug_eligible_term_code a, MR_TERM_CODE b WHERE a.drug_code = ? AND a.term_set_id = b.term_set_id AND a.term_code = b.term_code and a.EFF_STATUS = 'E' ORDER BY a.term_set_id, short_desc");
		dataMap.put("SQL_PH_DRUG_AGE_GROUP_SELECT", "SELECT a.age_group_code,b.SHORT_DESC, DECODE(nvl(b.GENDER,'A'),'M','Male','F','Female','U','Unknown','A','All')GENDER, b.MIN_AGE ,DECODE(b.AGE_UNIT,'D','Day(s)','W','Week(s)','M','Month(s)','Y','Year(s)')MIN_AGE_UNIT, b.MAX_AGE, DECODE(b.AGE_UNIT_MAX,'D','Day(s)','W','Week(s)','M','Month(s)','Y','Year(s)') MAX_AGE_UNIT,a.WT_MAND_YN, a.DRUG_APPL_YN,a.EFF_STATUS,a.HT_MAND_YN FROM ph_drug_age_group a, am_age_group b WHERE a.drug_code = ? AND a.AGE_GROUP_CODE = b.AGE_GROUP_CODE  ORDER BY b.SHORT_DESC");
		//dispense location
		dataMap.put("SQL_PH_DISP_MEDI_CH_FLD_RMKS", "SELECT CHNGD_FLUID_REMARKS FROM OR_ORDER_LINE_PH WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT1", "SELECT 'X' FROM PH_FACILITY_PARAM WHERE FACILITY_ID=UPPER(?)");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT2", "SELECT MODULE_ID FROM SM_MODULE WHERE MODULE_ID IN ('ST', 'IP', 'BL') AND INSTALL_YN ='Y'");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT3", "SELECT DISP_REGN_REQD_YN, DISP_FLNG_REQD_YN, DISP_FILL_STAGE, DISP_VERF_STAGE,DISP_DELV_REQD_YN, PRINT_DISP_SHEET_OP_YN, PRINT_BAL_MED_SHEET_OP_YN, ALLOW_DRUG_RETURN_YN, MAX_DURN_FOR_OP_MED_RTN, MAX_DRUG_RETENTION_BEF_RTN, IP_VERF_YN, IP_FILL_PRD_AHEAD, IP_FILL_PRD_UNIT, IP_DELV_REQD_YN, IP_FILL_EXCL_PRD_BEHIND, TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') IP_FILL_DFLT_START_TIME FROM PH_FACILITY_PARAM WHERE FACILITY_ID = UPPER(?)");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT4", "SELECT DISP_LOCN_CODE, STORE_CODE, LONG_DESC, SHORT_DESC, DISP_LOCN_TYPE, DISP_LOCN_CATEGORY, EFF_STATUS, DISP_GENL_DRUG_YN, DISP_NARCOTICS_DRUG_YN, DISP_CONTROLLED_DRUG_YN, DISP_REGN_REQD_YN, PRINT_PRES_ON_REGN_YN, ISSUE_TOKEN_ON_REGN_YN, DISP_FLNG_REQD_YN, DISP_FILL_STAGE, DISP_VERF_STAGE, DISP_DELV_REQD_YN, PRINT_DISP_SHEET_OP_YN, PRINT_BAL_MED_SHEET_YN, ALLOW_DRUG_RETURN_YN, MAX_DURN_FOR_OP_MED_RTN, MAX_DRUG_RETENTION_BEF_RTN, PRINTER_LOCN_NAME_STAT_ORD, PRINTER_LOCN_NAME_RTN_ORD, IP_VERF_YN, IP_FILL_PRD_AHEAD, IP_FILL_PRD_UNIT, IP_DELV_REQD_YN, IP_FILL_EXCL_PRD_BEHIND, TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') IP_FILL_DFLT_START_TIME, IP_PRINTER_LOCN_NAME_STAT_ORD, IP_PRINTER_LOCN_NAME_RTN_ORD,DISP_STAGE,IP_ALLOC_YN,AUTO_DISP_AT_ADMIN_YN, IP_ALLOW_DRUG_RETURN_YN, IP_FILL_ALLOCATE_BATHCES_YN, ALLOW_USAGE_OF_SPIL_QTY_YN, DISP_LEVEL,TO_CHAR(WORKING_HOURS_FROM,'HH24:MI') WORKING_HOURS_FROM,TO_CHAR(WORKING_HOURS_TO,'HH24:MI') WORKING_HOURS_TO,OP_DISP_PERIOD,ADMX_PREP_ALLOWED_YN,GEN_TOKEN_UPON_REISSUE_YN,GEN_TOKEN_UPON_RET_MEDN_YN,GEN_TOKEN_UPON_DIR_DISP_YN,DIRECT_DISP_ALLOWED_YN,CHARGE_PAT_FOR_SPILL_QTY_YN,DISP_BILL_STAGE,DISP_CASH_COLL_STAGE,DISP_BILL_STAGE_OP,DISP_CASH_COLL_STAGE_OP,EXTERNAL_RX_ALLOWED_YN,VERIFY_REGULAR_IP_RX_YN,ALLOC_DISP_SHEET_DEFAULT_YN,ALLOC_DISP_LABEL_DEFAULT_YN,ALLOC_DRUG_LABEL_DEFAULT_YN,DEL_DISP_SHEET_DEFAULT_YN,DEL_DISP_LABEL_DEFAULT_YN,DEL_DRUG_LABEL_DEFAULT_YN,IP_DSN_FROM, IP_DSN_TO, IP_FILL_DISP_PRD, IP_FILL_DISP_PRD_UNIT, IP_DFLT_PRTY_DISP, BAR_CODE_SCAN_YN, MARK_PATIENT_ARRIVE_YN, GENERATE_ACTUAL_TOKEN_YN, PRINT_TOKEN_ON_LABEL_YN, STORAGE_LOCN_APPL_YN,DISP_AUTH_REQD_YN,DEFAULT_BMS_LOCATION,EXT_DISP_YN  FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID = UPPER(?) AND DISP_LOCN_CODE = UPPER(?) AND LANGUAGE_ID = ?");   // Added DISP_AUTH_REQD_YN for RUT-CRF-0035 [IN029926],Added DEFAULT_BMS_LOCATION for HSA-CRF-0113 [IN:048166],Modified for NMC-JD-CRF-0008[IN069511]
		dataMap.put("SQL_PH_DISP_LOCN_SELECT5", "SELECT A.STORE_CODE CODE, B.LONG_DESC DESCRIPTION FROM ST_STORE A,MM_STORE_LANG_VW B WHERE A.STORE_TYPE_FLAG='P' AND A.MEDICAL_ITEM_YN ='Y' AND UPPER(B.FACILITY_ID) LIKE UPPER(?) AND B.STORE_CODE = A.STORE_CODE AND UPPER(A.STORE_CODE) LIKE UPPER(?) AND UPPER(B.SHORT_DESC) LIKE UPPER(?) AND B.LANGUAGE_ID =");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT6", "SELECT 'X' FROM PH_DISP_LOCN WHERE FACILITY_ID = UPPER(?) AND DISP_LOCN_CODE = UPPER(?)");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT7", "SELECT DISP_LOCN_CODE, SHORT_DESC, DECODE(DISP_LOCN_TYPE, 'P', 'pharmacy', 'N', 'nursingUnit', 'C', 'clinic') DISP_LOCN_TYPE, PRINTER_LOCN_NAME_STAT_ORD, PRINTER_LOCN_NAME_RTN_ORD, IP_PRINTER_LOCN_NAME_STAT_ORD, IP_PRINTER_LOCN_NAME_RTN_ORD, EFF_STATUS FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID = UPPER(?) AND DISP_LOCN_CODE LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND DISP_LOCN_TYPE LIKE DECODE( UPPER(?), 'A', DISP_LOCN_TYPE, UPPER(?) ) AND EFF_STATUS LIKE DECODE( UPPER(?), 'B', EFF_STATUS, UPPER(?) ) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT8", "SELECT SHORT_DESC, LONG_DESC FROM ST_STORE WHERE STORE_TYPE_FLAG='P' AND EFF_STATUS='E' AND FACILITY_ID = UPPER(?) AND STORE_CODE = UPPER(?)");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT9", "SELECT LONG_DESC, SHORT_DESC FROM MM_STORE_LANG_VW MM_STORE WHERE STORE_CODE=? AND LANGUAGE_ID = ? AND facility_id = ? ");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT10", "SELECT PRACTITIONER_ID CODE,PRACTITIONER_NAME  DESCRIPTION FROM AM_PRACTITIONER WHERE PRACT_TYPE IN('NS','MD','DN','PH') AND UPPER(PRACTITIONER_ID) LIKE UPPER(?)  AND UPPER(PRACTITIONER_NAME) LIKE UPPER(?) ORDER BY 2 ");
		dataMap.put("SQL_PH_DISP_LOCN_SELECT10_A", "SELECT PRACTITIONER_ID CODE,PRACTITIONER_NAME  DESCRIPTION FROM AM_PRACTITIONER WHERE UPPER(PRACTITIONER_ID) LIKE UPPER(?)  AND UPPER(PRACTITIONER_NAME) LIKE UPPER(?) AND EFF_STATUS='E' ORDER BY 2 ");
		dataMap.put("SQL_PH_DISP_PRACT_REFERRAL_SELECT", "SELECT PRACTITIONER_ID CODE,PRACTITIONER_NAME  DESCRIPTION FROM AM_PRACTITIONER WHERE PRACT_TYPE IN('PH') AND UPPER(PRACTITIONER_ID) LIKE UPPER(?)  AND UPPER(PRACTITIONER_NAME) LIKE UPPER(?) ORDER BY 2 ");
		dataMap.put("SQL_PH_DISP_LOCN_BMS_DEFAULT_SELECT", "SELECT DEFAULT_BMS_LOCATION FROM PH_DISP_LOCN WHERE FACILITY_ID = UPPER (?) AND DISP_LOCN_CODE = UPPER (?)");//Added for HSA-CRF-0113 [IN:048166] 
		dataMap.put("SQL_PH_DISP_LOCN_SELECT11", "SELECT  reason_code CODE , reason_desc DESCRIPTION FROM ph_medn_trn_reason_lang_vw ph_medn_trn_reason  WHERE appl_trn_type = 'BR' AND UPPER(reason_code) LIKE UPPER(?) AND UPPER(reason_desc) LIKE UPPER(?)  AND eff_status='E' and language_id = ");

		dataMap.put("SQL_PH_DISP_LOCN_SELECT12", "select BMS_REMARKS_CODE, REASON_DESC, REMARKS from ph_disp_locn a ,ph_medn_trn_reason_lang_vw b where facility_id=? and disp_locn_code =? and a.BMS_REMARKS_CODE=b.REASON_CODE and b.APPL_TRN_TYPE='BR' and b.LANGUAGE_ID=? ");

		dataMap.put("SQL_PH_DISP_LOCN_INSERT", "INSERT INTO PH_DISP_LOCN(FACILITY_ID, DISP_LOCN_CODE, STORE_CODE, LONG_DESC, SHORT_DESC, DISP_LOCN_TYPE, DISP_LOCN_CATEGORY, EFF_STATUS, DISP_GENL_DRUG_YN, DISP_NARCOTICS_DRUG_YN, DISP_CONTROLLED_DRUG_YN, DISP_REGN_REQD_YN, PRINT_PRES_ON_REGN_YN, ISSUE_TOKEN_ON_REGN_YN, DISP_FLNG_REQD_YN, DISP_FILL_STAGE, DISP_VERF_STAGE,  DISP_DELV_REQD_YN, PRINT_DISP_SHEET_OP_YN, PRINT_BAL_MED_SHEET_YN, ALLOW_DRUG_RETURN_YN, MAX_DURN_FOR_OP_MED_RTN, MAX_DRUG_RETENTION_BEF_RTN, PRINTER_LOCN_NAME_STAT_ORD, PRINTER_LOCN_NAME_RTN_ORD, IP_VERF_YN, IP_FILL_PRD_AHEAD, IP_FILL_PRD_UNIT, IP_DELV_REQD_YN, IP_FILL_EXCL_PRD_BEHIND, IP_FILL_DFLT_START_TIME, IP_PRINTER_LOCN_NAME_STAT_ORD, IP_PRINTER_LOCN_NAME_RTN_ORD, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, DISP_STAGE, IP_ALLOC_YN,AUTO_DISP_AT_ADMIN_YN, IP_ALLOW_DRUG_RETURN_YN, IP_FILL_ALLOCATE_BATHCES_YN, ALLOW_USAGE_OF_SPIL_QTY_YN, DISP_LEVEL,WORKING_HOURS_FROM,WORKING_HOURS_TO,OP_DISP_PERIOD,ADMX_PREP_ALLOWED_YN,GEN_TOKEN_UPON_REISSUE_YN,GEN_TOKEN_UPON_RET_MEDN_YN,GEN_TOKEN_UPON_DIR_DISP_YN,DIRECT_DISP_ALLOWED_YN,CHARGE_PAT_FOR_SPILL_QTY_YN,DISP_BILL_STAGE,DISP_CASH_COLL_STAGE,BMS_REMARKS_CODE,EXTERNAL_RX_ALLOWED_YN,VERIFY_REGULAR_IP_RX_YN,ALLOC_DISP_SHEET_DEFAULT_YN,ALLOC_DISP_LABEL_DEFAULT_YN,ALLOC_DRUG_LABEL_DEFAULT_YN,DEL_DISP_SHEET_DEFAULT_YN,DEL_DISP_LABEL_DEFAULT_YN,DEL_DRUG_LABEL_DEFAULT_YN,IP_DSN_FROM,IP_DSN_TO, IP_FILL_DISP_PRD, IP_FILL_DISP_PRD_UNIT, IP_DFLT_PRTY_DISP,DISP_BILL_STAGE_OP,DISP_CASH_COLL_STAGE_OP,BAR_CODE_SCAN_YN, MARK_PATIENT_ARRIVE_YN, GENERATE_ACTUAL_TOKEN_YN, PRINT_TOKEN_ON_LABEL_YN, STORAGE_LOCN_APPL_YN,DISP_AUTH_REQD_YN,DEFAULT_BMS_LOCATION,EXT_DISP_YN) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, TO_DATE( TO_CHAR( SYSDATE, 'DD/MM/YYYY' ) || ?, 'DD/MM/YYYY HH24:MI' ), ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, ?, ?, ?,  ?,TO_DATE( TO_CHAR( SYSDATE, 'DD/MM/YYYY' ) || ?, 'DD/MM/YYYY HH24:MI' ),TO_DATE( TO_CHAR( SYSDATE, 'DD/MM/YYYY' ) || ?, 'DD/MM/YYYY HH24:MI' ),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");//insert column BAR_CODE_SCAN_YN added for KDAH-CRF-0231 [IN-034551]   Added DISP_AUTH_REQD_YN for RUT-CRF-0035 [IN029926] , Added DEFAULT_BMS_LOCATION for HSA-CRF-0113 [IN:048166],Modified for NMC-JD-CRF-0008[IN069511]    		
		dataMap.put("SQL_PH_DISP_LOCN_UPDATE", "UPDATE PH_DISP_LOCN SET LONG_DESC = ?, SHORT_DESC = ?, EFF_STATUS = ?, DISP_GENL_DRUG_YN = ?, DISP_NARCOTICS_DRUG_YN = ?, DISP_CONTROLLED_DRUG_YN = ?, DISP_REGN_REQD_YN = ?, PRINT_PRES_ON_REGN_YN = ?, ISSUE_TOKEN_ON_REGN_YN = ?, DISP_FLNG_REQD_YN = ?, DISP_FILL_STAGE = ?, DISP_VERF_STAGE = ?, DISP_DELV_REQD_YN = ?, PRINT_DISP_SHEET_OP_YN = ?, PRINT_BAL_MED_SHEET_YN = ?,  ALLOW_DRUG_RETURN_YN = ?, MAX_DURN_FOR_OP_MED_RTN = ?, MAX_DRUG_RETENTION_BEF_RTN = ?, PRINTER_LOCN_NAME_STAT_ORD = ?, PRINTER_LOCN_NAME_RTN_ORD = ?,IP_VERF_YN = ?, IP_FILL_PRD_AHEAD = ?, IP_FILL_PRD_UNIT = ?, IP_DELV_REQD_YN = ?, IP_FILL_EXCL_PRD_BEHIND = ?, IP_FILL_DFLT_START_TIME = TO_DATE( TO_CHAR( SYSDATE, 'DD/MM/YYYY' ) || ?, 'DD/MM/YYYY HH24:MI' ), IP_PRINTER_LOCN_NAME_STAT_ORD = ?, IP_PRINTER_LOCN_NAME_RTN_ORD = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?, IP_ALLOC_YN = ?, AUTO_DISP_AT_ADMIN_YN = ?, IP_ALLOW_DRUG_RETURN_YN = ?, IP_FILL_ALLOCATE_BATHCES_YN = ?, ALLOW_USAGE_OF_SPIL_QTY_YN = ?, DISP_LEVEL=? ,WORKING_HOURS_FROM=TO_DATE( TO_CHAR( SYSDATE, 'DD/MM/YYYY' ) || ?, 'DD/MM/YYYY HH24:MI' ),WORKING_HOURS_TO=TO_DATE( TO_CHAR( SYSDATE, 'DD/MM/YYYY' ) || ?, 'DD/MM/YYYY HH24:MI' ),OP_DISP_PERIOD=?,ADMX_PREP_ALLOWED_YN=?,GEN_TOKEN_UPON_REISSUE_YN=?,GEN_TOKEN_UPON_RET_MEDN_YN=?,GEN_TOKEN_UPON_DIR_DISP_YN=?,DIRECT_DISP_ALLOWED_YN=?,CHARGE_PAT_FOR_SPILL_QTY_YN=?,DISP_BILL_STAGE=?,DISP_CASH_COLL_STAGE=?,BMS_REMARKS_CODE=?,EXTERNAL_RX_ALLOWED_YN=?,VERIFY_REGULAR_IP_RX_YN=?,ALLOC_DISP_SHEET_DEFAULT_YN=?, ALLOC_DISP_LABEL_DEFAULT_YN=?, ALLOC_DRUG_LABEL_DEFAULT_YN=?, DEL_DISP_SHEET_DEFAULT_YN=?, DEL_DISP_LABEL_DEFAULT_YN=?, DEL_DRUG_LABEL_DEFAULT_YN=?,IP_DSN_FROM=?,IP_DSN_TO=?, IP_FILL_DISP_PRD=?, IP_FILL_DISP_PRD_UNIT=?, IP_DFLT_PRTY_DISP=?, DISP_BILL_STAGE_OP=?,DISP_CASH_COLL_STAGE_OP=?,BAR_CODE_SCAN_YN=? ,MARK_PATIENT_ARRIVE_YN=?,GENERATE_ACTUAL_TOKEN_YN=?,PRINT_TOKEN_ON_LABEL_YN=? ,STORAGE_LOCN_APPL_YN=?,DISP_AUTH_REQD_YN=?,DEFAULT_BMS_LOCATION=?,EXT_DISP_YN=?  WHERE FACILITY_ID = ? AND DISP_LOCN_CODE = ?");//update column BAR_CODE_SCAN_YN added for KDAH-CRF-0231 [IN-034551]    Added DISP_AUTH_REQD_YN for RUT-CRF-0035 [IN029926], Added DEFAULT_BMS_LOCATION for HSA-CRF-0113 [IN:048166], Modified for NMC-JD-CRF-0008[IN069511]
		dataMap.put("JNDI_PH_DISP_LOCN", "java:comp/env/DispenseLocation");
		dataMap.put("SQL_PH_TOKEN_SERIES_SELECT1", "SELECT A.DISP_LOCN_CODE,B.SHORT_DESC, A.TOKEN_SERIES_CODE,A.DESCRIPTION, A.APPLICABLE_SEX_IND,A.NATIONALITY_IND, A.EFF_STATUS,A.GEN_TOKEN_YN,A.TOKEN_GEN_STAGE FROM PH_TOKEN_SERIES_LANG_VW A, PH_DISP_LOCN_LANG_VW B WHERE  A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID=B.FACILITY_ID AND  A.DISP_LOCN_CODE LIKE UPPER(?) AND   UPPER(B.SHORT_DESC) LIKE UPPER(?) AND  A.TOKEN_SERIES_CODE LIKE UPPER(?) AND  UPPER(A.DESCRIPTION) LIKE UPPER(?) AND  UPPER(A.EFF_STATUS) LIKE DECODE(A.EFF_STATUS,'B',A.EFF_STATUS,?) AND A.FACILITY_ID = ? AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TOKEN_SERIES_SELECT2", "SELECT A.DISP_LOCN_CODE, B.SHORT_DESC, A.TOKEN_SERIES_CODE, A.DESCRIPTION,A.NEXT_SERIAL_NO, A.START_SERIAL_NO, A.APPLICABLE_SEX_IND, A.NATIONALITY_IND, A.EFF_STATUS,A.GEN_TOKEN_YN, A.QMS_REQUIRED_YN, A.QMS_EDIT_TOKEN_YN FROM PH_TOKEN_SERIES_LANG_VW A , PH_DISP_LOCN_LANG_VW B WHERE A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID=B.FACILITY_ID AND  A.FACILITY_ID = ? AND  A.DISP_LOCN_CODE = ? AND  A.TOKEN_SERIES_CODE = ? AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TOKEN_SERIES_SELECT3", "SELECT A.DISP_LOCN_CODE,A.SHORT_DESC FROM PH_DISP_LOCN_LANG_VW A WHERE  A.EFF_STATUS='E' AND A.FACILITY_ID = UPPER(?) AND DISP_LOCN_TYPE='P' AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_TOKEN_SERIES_INSERT", "INSERT INTO PH_TOKEN_SERIES(FACILITY_ID, DISP_LOCN_CODE, TOKEN_SERIES_CODE, DESCRIPTION,NEXT_SERIAL_NO,START_SERIAL_NO, APPLICABLE_SEX_IND, NATIONALITY_IND,TOKEN_GEN_STAGE, EFF_STATUS,GEN_TOKEN_YN, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, QMS_REQUIRED_YN, QMS_EDIT_TOKEN_YN) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ? , ?)");
		dataMap.put("SQL_PH_TOKEN_SERIES_SELECT4", "SELECT COUNT(ROWID) FROM PH_TOKEN_SERIES WHERE DISP_LOCN_CODE = UPPER(?) AND TOKEN_SERIES_CODE = UPPER(?) ");
		dataMap.put("SQL_PH_TOKEN_SERIES_SELECT5", "SELECT WS_NO FROM PH_WS_NO_FOR_DISP_LOCN WHERE DISP_LOCN_CODE = UPPER(?) AND FACILITY_ID = UPPER(?)");
		dataMap.put("SQL_PH_TOKEN_SERIES_UPDATE", "UPDATE PH_TOKEN_SERIES SET DESCRIPTION = ?,  NEXT_SERIAL_NO = ?, START_SERIAL_NO = ?, APPLICABLE_SEX_IND = ? , NATIONALITY_IND = ? , EFF_STATUS = ?,GEN_TOKEN_YN=? ,TOKEN_GEN_STAGE=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, QMS_REQUIRED_YN =?, QMS_EDIT_TOKEN_YN =?  WHERE FACILITY_ID = ? AND DISP_LOCN_CODE = ? AND TOKEN_SERIES_CODE = ? ");
		dataMap.put("SQL_PH_TOKEN_SERIES_COUNT", "Select nvl(count(*),0) cnt from ph_token_series where facility_id = ? and disp_locn_code = ? and token_gen_stage = 'OR' ");
		dataMap.put("SQL_PH_TOKEN_SERIES_COUNT1", "Select nvl(count(*),0) cnt  from ph_token_series where facility_id =? and disp_locn_code = ? and token_gen_stage in ('OR','RI','RM','DD') and token_series_code <> ? ");

		dataMap.put("SQL_PH_TOKEN_SERIES_NEW_COUNT1", "SELECT  NVL (COUNT (*), 0) cnt from ph_token_series WHERE facility_id = ? AND disp_locn_code = ? AND token_gen_stage =? AND token_series_code <> ? and eff_status=?");
		dataMap.put("SQL_PH_TOKEN_SERIES_COUNT2", "Select nvl(count(*),0) cnt from ph_token_series where facility_id = ? and disp_locn_code = ? and token_gen_stage = 'RI'");

		dataMap.put("SQL_PH_TOKEN_SERIES_STAGE_WISE_COUNT", "SELECT NVL(COUNT(*),0) CNT,TOKEN_GEN_STAGE FROM PH_TOKEN_SERIES WHERE facility_id=? and DISP_LOCN_CODE=? and TOKEN_SERIES_CODE <> ? group by TOKEN_GEN_STAGE");
		dataMap.put("SQL_PH_TOKEN_SERIES_COUNT3", "Select nvl(count(*),0) cnt from ph_token_series where facility_id = ? and disp_locn_code = ? and token_gen_stage = 'RM'");

		dataMap.put("SQL_PH_TOKEN_SERIES_COUNT4", "Select nvl(count(*),0) cnt from ph_token_series where facility_id = ? and disp_locn_code = ? and token_gen_stage = 'DD'");

		dataMap.put("SQL_PH_TOKEN_GENTOKEN_YN", "SELECT  GEN_TOKEN_UPON_REISSUE_YN,GEN_TOKEN_UPON_RET_MEDN_YN,GEN_TOKEN_UPON_DIR_DISP_YN  FROM PH_DISP_LOCN_LANG_VW WHERE FACILITY_ID = ? AND  DISP_LOCN_CODE=?  AND  LANGUAGE_ID=?");
		// dispense rights
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT1", "SELECT A.APPL_USER_ID CODE, A.APPL_USER_NAME DESCRIPTION FROM SM_APPL_USER A, AM_PRACTITIONER B WHERE A.FUNC_ROLE_ID=B.PRACTITIONER_ID AND B.PRACT_TYPE IN('PH', 'NS') AND B.EFF_STATUS='E' AND A.EFF_STATUS='E' AND A.APPL_USER_ID LIKE UPPER(?) AND UPPER(A.APPL_USER_NAME) LIKE UPPER(?)");
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT2", "SELECT DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE DISP_LOCN_TYPE='P' AND EFF_STATUS='E' AND FACILITY_ID=? AND LANGUAGE_ID = ? order by upper(short_desc)");
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT3", "SELECT DISP_VERF_STAGE, DISP_GENL_DRUG_YN, DISP_NARCOTICS_DRUG_YN, DISP_CONTROLLED_DRUG_YN, DISP_REGN_REQD_YN, ISSUE_TOKEN_ON_REGN_YN, DISP_FLNG_REQD_YN, DISP_CASH_COLL_STAGE, DISP_DELV_REQD_YN, ALLOW_DRUG_RETURN_YN, IP_VERF_YN, IP_ALLOC_YN, IP_DELV_REQD_YN, IP_ALLOW_DRUG_RETURN_YN, GENERATE_ACTUAL_TOKEN_YN FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID LIKE ? AND DISP_LOCN_CODE LIKE ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT4", "SELECT APP_PASSWORD.DECRYPT(A.DISP_PASSWORD) PASSWORD FROM PH_DISP_USERS A WHERE A.APPL_USER_ID=?");
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT5", "SELECT A.APPL_USER_ID, B.APPL_USER_NAME, A.DISP_LOCN_CODE, C.SHORT_DESC, A.DISP_AUTH_REQD_DRUG_YN, A.DISP_NARCOTIC_YN, A.DISP_CONTROLLED_DRUG_YN, A.ACK_YN, A.VERIFY_YN, A.FILL_YN, A.ALLOCATE_YN, A.BILL_RECEIPT_YN, A.DELIVER_YN, A.ALLOW_REPRINT_YN, A.NO_OF_REPRINTS, A.ACCEPT_MEDN_RTN_YN, A.IP_VERIFY_YN, A.IP_ALLOCATE_YN, A.IP_DELIVER_YN,A.TRADE_CHANGE_ALLOWED_YN,MULTI_TRADE_ALLOWED_YN,A.REROUTE_ORDER_YN ,A.OP_REISSUE_MED_YN,A.IP_REISSUE_MED_YN FROM PH_DISP_RIGHTS A, SM_APPL_USER_LANG_VW B, PH_DISP_LOCN_LANG_VW C WHERE A.APPL_USER_ID=B.APPL_USER_ID AND A.DISP_LOCN_CODE=C.DISP_LOCN_CODE AND A.FACILITY_ID=C.FACILITY_ID AND A.FACILITY_ID=UPPER(?) AND UPPER(A.APPL_USER_ID) LIKE UPPER(?) AND UPPER(B.APPL_USER_NAME) LIKE UPPER(?) AND C.SHORT_DESC LIKE UPPER(?) AND UPPER(A.DISP_LOCN_CODE) LIKE UPPER(?) AND A.ACK_YN LIKE UPPER(DECODE(?,'B',A.ACK_YN,?)) AND A.VERIFY_YN LIKE UPPER(DECODE(?,'B',A.VERIFY_YN,?)) AND A.FILL_YN LIKE UPPER(DECODE(?,'B',A.FILL_YN,?)) AND A.DELIVER_YN LIKE UPPER(DECODE(?,'B',A.DELIVER_YN,?)) AND A.ACCEPT_MEDN_RTN_YN LIKE UPPER(DECODE(?,'B',A.ACCEPT_MEDN_RTN_YN,?)) AND A.BILL_RECEIPT_YN LIKE UPPER(DECODE(?,'B',A.BILL_RECEIPT_YN,?)) AND A.ALLOCATE_YN LIKE UPPER(DECODE(?,'B',A.ALLOCATE_YN,?)) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT6", "SELECT B.DISP_GENL_DRUG_YN GEN, A.DISP_AUTH_REQD_DRUG_YN GEN1, B.DISP_NARCOTICS_DRUG_YN NARC, A.DISP_NARCOTIC_YN NARC1, B.DISP_CONTROLLED_DRUG_YN CONT, A.DISP_CONTROLLED_DRUG_YN CONT1, B.DISP_REGN_REQD_YN REGN, A.ACK_YN REGN1, A.VERIFY_YN VERFN1, B.DISP_FLNG_REQD_YN FILL, A.FILL_YN FILL1, A.ALLOCATE_YN ALLOC1, B.DISP_CASH_COLL_STAGE BILL, A.BILL_RECEIPT_YN BILL1, B.DISP_DELV_REQD_YN DELVY, A.DELIVER_YN DELVY1, A.ALLOW_REPRINT_YN PRINT1, A.NO_OF_REPRINTS COPIES1, B.ALLOW_DRUG_RETURN_YN MEDRET, A.ACCEPT_MEDN_RTN_YN MEDRET1, B.IP_VERF_YN IPVERF, A.IP_VERIFY_YN IPVERF1, B.IP_ALLOC_YN IPALLOC, A.IP_ALLOCATE_YN IPALLOC1, B.IP_DELV_REQD_YN IPDELVY, A.IP_DELIVER_YN IPDELVY1,IP_ACCEPT_MEDN_RTN_YN,CHANGE_DOSE_DURN_VERIFY_YN,TRADE_CHANGE_ALLOWED_YN,MULTI_TRADE_ALLOWED_YN,REROUTE_ORDER_YN,VIEW_PAT_HIST_YN,OP_REISSUE_MED_YN,IP_REISSUE_MED_YN FROM PH_DISP_RIGHTS A, PH_DISP_LOCN_LANG_VW B WHERE A.FACILITY_ID=B.FACILITY_ID AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID=UPPER(?) AND UPPER(A.DISP_LOCN_CODE)=UPPER(?) AND UPPER(A.APPL_USER_ID)=UPPER(?) AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT7", "SELECT APP_PASSWORD.ENCRYPT(?) ENCR_PASSWD FROM DUAL ");
		dataMap.put("SQL_PH_DISP_RIGHTS_SELECT8", "SELECT DISP_LOCN_CATEGORY FROM PH_DISP_LOCN WHERE DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_DISP_RIGHTS_INSERTUSER", "INSERT INTO PH_DISP_USERS(APPL_USER_ID, DISP_PASSWORD, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_PH_DISP_RIGHTS_UPDATEUSER", "UPDATE PH_DISP_USERS SET DISP_PASSWORD=?,MODIFIED_BY_ID=?, MODIFIED_DATE=sysdate, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE APPL_USER_ID=?");
		dataMap.put("SQL_PH_DISP_RIGHTS_DELETERIGHTS", "DELETE FROM PH_DISP_RIGHTS WHERE facility_id=? AND DISP_LOCN_CODE=? AND  APPL_USER_ID=?");
		dataMap.put("SQL_PH_DISP_RIGHTS_DELETEUSERS", "DELETE FROM PH_DISP_USERS WHERE APPL_USER_ID NOT IN (SELECT APPL_USER_ID FROM PH_DISP_RIGHTS)");
     	//auth_amend_pres_yn added for ml-mmoh-crf-0863
		dataMap.put("SQL_PH_DISP_RIGHTS_INSERTRIGHTS", "INSERT INTO ph_disp_rights(facility_id, disp_locn_code, appl_user_id,disp_auth_reqd_drug_yn,disp_narcotic_yn,disp_controlled_drug_yn, ack_yn, verify_yn, fill_yn,allocate_yn, bill_receipt_yn, deliver_yn, allow_reprint_yn,no_of_reprints, accept_medn_rtn_yn, ip_verify_yn,ip_allocate_yn, ip_deliver_yn,added_by_id, added_date,added_at_ws_no, added_facility_id, modified_by_id,modified_date, modified_at_ws_no,modified_facility_id,ip_accept_medn_rtn_yn, change_dose_durn_verify_yn,trade_change_allowed_yn, multi_trade_allowed_yn,reroute_order_yn, view_pat_hist_yn, op_reissue_med_yn,ip_reissue_med_yn,auth_amend_pres_yn) VALUES (?, ?, ?,?, ?,?, ?, ?, ?,?, ?, ?, ?,?, ?, ?,?, ?, ?,SYSDATE,?, ?,?,SYSDATE,?,?,?, ?,?, ?,?, ?, ?,?,?)");
		dataMap.put("SQL_PH_DISP_RIGHTS_USERRIGHTS", "SELECT COUNT(*)  COUNT1 FROM  PH_DISP_RIGHTS  WHERE facility_id=? AND DISP_LOCN_CODE=? AND  APPL_USER_ID=? ");
		/* This query is for updating the user rights */
		//auth_amend_pres_yn added for ml-mmoh-crf-0863
		dataMap.put("SQL_PH_DISP_RIGHTS_UPDATERIGHTS", "update PH_DISP_RIGHTS  set DISP_AUTH_REQD_DRUG_YN=?, DISP_NARCOTIC_YN=?, DISP_CONTROLLED_DRUG_YN=?,  ACK_YN=?, VERIFY_YN=?, FILL_YN=?,ALLOCATE_YN=?, BILL_RECEIPT_YN=?, DELIVER_YN=?, ALLOW_REPRINT_YN=?, NO_OF_REPRINTS=?, ACCEPT_MEDN_RTN_YN=?,  IP_VERIFY_YN=?,IP_ALLOCATE_YN=?,IP_DELIVER_YN=?, MODIFIED_BY_ID=?, MODIFIED_DATE=sysdate, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,IP_ACCEPT_MEDN_RTN_YN=?, CHANGE_DOSE_DURN_VERIFY_YN=?,TRADE_CHANGE_ALLOWED_YN = ?,MULTI_TRADE_ALLOWED_YN= ? ,REROUTE_ORDER_YN = ? ,VIEW_PAT_HIST_YN=? ,OP_REISSUE_MED_YN=?,IP_REISSUE_MED_YN=?,AUTH_AMEND_PRES_YN=? WHERE FACILITY_ID=?  AND DISP_LOCN_CODE=? AND APPL_USER_ID=?");
		dataMap.put("JNDI_PH_DISP_RIGHTS", "java:comp/env/DispenseRights");

		//End of Dispense Rights
         //pin authorization rights
        //dataMap.put("SQL_PH_PIN_AUTH_RIGHTS_SELECT1","SELECT APPL_USER_ID CODE , APPL_USER_NAME DESCRIPTION FROM SM_APPL_USER_LANG_VW SM_APPL_USER WHERE PIN_NO IS NOT NULL AND UPPER(APPL_USER_ID) LIKE UPPER(?) AND UPPER(APPL_USER_NAME) LIKE UPPER(?) AND UPPER(LANGUAGE_ID) = ");
		dataMap.put("SQL_PH_PIN_AUTH_RIGHTS_SELECT1","SELECT APPL_USER_ID CODE , APPL_USER_NAME DESCRIPTION FROM SM_APPL_USER_LANG_VW SM_APPL_USER WHERE PIN_NO IS NOT NULL AND UPPER(APPL_USER_ID) LIKE UPPER(?) AND UPPER(APPL_USER_NAME) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_PIN_AUTH_RIGHTS_INSERT", "INSERT INTO ph_pin_authorization (USER_ID, USER_NAME, PIN_NO, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		 dataMap.put("SQL_PH_PIN_NO_AUTH_RIGHTS_SELECT2", "SELECT  PIN_NO from SM_APPL_USER WHERE APPL_USER_ID=? ");
		 dataMap.put("SQL_PH_PIN_AUTH_RIGHTS_SELECT3", "SELECT USER_ID,USER_NAME from ph_pin_authorization WHERE UPPER(USER_ID) like UPPER(?) AND UPPER(USER_NAME) like UPPER(?)");
		 dataMap.put("SQL_PH_PIN_AUTH_RIGHTS_SELECT4", "SELECT COUNT(ROWID) FROM ph_pin_authorization WHERE USER_ID =? ");
		dataMap.put("SQL_PH_PIN_AUTH_RIGHTS_DELETE", "DELETE FROM ph_pin_authorization WHERE USER_ID =?");
		 //End of pin authorization rights
		dataMap.put("SQL_PH_DISP_RULE_SELECT1", "SELECT MAX_DURN_FOR_DISP FROM PH_PARAM WHERE MODULE_ID='PH' ");
		dataMap.put("SQL_PH_DISP_RULE_SELECT2", "SELECT COUNT(ROWID) FROM PH_DISP_DURATION_RULE WHERE DRUG_CATG_CODE = UPPER(?) AND PATIENT_CLASS = UPPER(?) AND STAT_GROUP_ID = UPPER(?) ");
		dataMap.put("SQL_PH_DISP_RULE_SELECT3", "SELECT b.short_desc drug_catg_desc, c.short_desc, d.stat_grp_desc,a.max_disp_duration, DECODE (a.action, 'E', 'Error', 'Warning') action,a.MESSAGE FROM ph_disp_duration_rule a,ph_drug_catg_lang_vw b,am_patient_class_lang_vw c,am_stat_group d WHERE a.drug_catg_code = b.drug_catg_code(+) AND a.patient_class = c.patient_class(+) AND a.stat_group_id = d.stat_grp_id AND  DECODE(UPPER(a.drug_catg_code),NULL,'%',UPPER(a.drug_catg_code)) like UPPER(?) AND a.patient_class LIKE UPPER (?) AND a.stat_group_id LIKE UPPER (?) AND UPPER (a.action) LIKE UPPER (?) AND b.language_id(+) = ? AND c.language_id(+) = ?");
		dataMap.put("SQL_PH_DISP_RULE_SELECT4", "SELECT A.DRUG_CATG_CODE,B.SHORT_DESC DRUG_CATG_DESC, A.PATIENT_CLASS,C.SHORT_DESC, A.STAT_GROUP_ID,	D.STAT_GRP_DESC ,A.MAX_DISP_DURATION,DECODE(A.ACTION,'E','Error','Warning') ACTION,A.MESSAGE FROM 	PH_DISP_DURATION_RULE A,PH_DRUG_CATG_LANG_VW B , AM_PATIENT_CLASS_LANG_VW C,AM_STAT_GROUP D WHERE A.DRUG_CATG_CODE =B.DRUG_CATG_CODE (+) AND A.PATIENT_CLASS=C.PATIENT_CLASS (+)AND A.STAT_GROUP_ID = D.STAT_GRP_ID AND A.DRUG_CATG_CODE LIKE UPPER(?) AND A.PATIENT_CLASS LIKE UPPER(?) AND A.STAT_GROUP_ID LIKE UPPER(?) AND UPPER(D.STAT_GRP_DESC) LIKE UPPER(?) AND UPPER(A.ACTION) LIKE UPPER(?)AND DECODE(UPPER(B.SHORT_DESC),NULL,'%',UPPER(B.SHORT_DESC)) like UPPER(?) AND B.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DISP_RULE_SELECT5", "SELECT '*A' PATIENT_CLASS,'*All' SHORT_DESC FROM DUAL UNION SELECT PATIENT_CLASS, SHORT_DESC FROM AM_PATIENT_CLASS_LANG_VW AM_PATIENT_CLASS WHERE LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_RULE_SELECT6", "SELECT DRUG_CATG_CODE,SHORT_DESC FROM PH_DRUG_CATG_LANG_VW PH_DRUG_CATG WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_RULE_SELECT7", "SELECT STAT_GRP_ID,STAT_GRP_DESC FROM AM_STAT_GROUP ORDER BY 2 ");
		dataMap.put("SQL_PH_DISP_RULE_INSERT", "INSERT INTO PH_DISP_DURATION_RULE (DRUG_CATG_CODE,PATIENT_CLASS,STAT_GROUP_ID,MAX_DISP_DURATION,ACTION,MESSAGE,ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?, SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_DISP_RULE_UPDATE", "UPDATE PH_DISP_DURATION_RULE SET MAX_DISP_DURATION = ? , ACTION = ?, MESSAGE = ? , MODIFIED_BY_ID = ? , MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE DRUG_CATG_CODE = ? AND PATIENT_CLASS = ? AND STAT_GROUP_ID = ? ");
		dataMap.put("SQL_PH_DISP_RULE_DELETE", "DELETE FROM PH_DISP_DURATION_RULE WHERE DRUG_CATG_CODE = ? AND PATIENT_CLASS = ? AND STAT_GROUP_ID = ? ");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT1", "SELECT FACILITY_ID,FACILITY_NAME FROM SM_FACILITY_PARAM_LANG_VW  SM_FACILITY_PARAM WHERE LANGUAGE_ID  =  ? ORDER BY 2");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT1A", "SELECT FACILITY_ID,FACILITY_NAME FROM SM_FACILITY_PARAM_LANG_VW SM_FACILITY_PARAM WHERE FACILITY_ID<>? AND LANGUAGE_ID = ? ORDER BY 2 ");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT2", "SELECT NURSING_UNIT_CODE,LONG_DESC SHORT_DESC FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE EFF_STATUS='E' AND FACILITY_ID = ? AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT3", "SELECT CLINIC_CODE , LONG_DESC SHORT_DESC FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE FACILITY_ID like ? AND EFF_STATUS='E' AND CLINIC_TYPE='C' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT4", "SELECT A.ORDER_TYPE_CODE, B.SHORT_DESC, A.DRUG_CLASS FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A,OR_ORDER_TYPE_LANG_VW B WHERE A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND B.EFF_STATUS='E' AND B.LANGUAGE_ID =? UNION ALL SELECT ORDER_TYPE_CODE, SHORT_DESC, null drug_class FROM OR_ORDER_TYPE_LANG_VW WHERE ORDER_CATEGORY = 'CN' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT5", "SELECT A.ORDER_TYPE_CODE code, B.SHORT_DESC description FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A,OR_ORDER_TYPE B WHERE A.ORDER_TYPE_CODE LIKE ? AND B.SHORT_DESC LIKE ? AND A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND B.EFF_STATUS='E' UNION ALL SELECT ORDER_TYPE_CODE, SHORT_DESC description FROM OR_ORDER_TYPE WHERE ORDER_CATEGORY = 'CN' ORDER BY 2 ");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT6", "SELECT A.DISP_LOCN_CODE,A.SHORT_DESC FROM PH_DISP_LOCN_LANG_VW A WHERE A.EFF_STATUS='E' AND A.FACILITY_ID=? AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT6A", "SELECT A.DISP_LOCN_CODE,A.SHORT_DESC FROM PH_DISP_LOCN_LANG_VW A WHERE A.EFF_STATUS='E' AND A.FACILITY_ID=? AND ADMX_PREP_ALLOWED_YN = 'Y' AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT7","SELECT  A.ORDERING_FACILITY_ID   ,B.FACILITY_NAME ORDERING_FACILITY_NAME   , A.ORDERING_SOURCE_TYPE   , A.ORDERING_SOURCE_CODE   ,(   CASE   WHEN LTRIM(RTRIM(A.ORDERING_SOURCE_TYPE))='C'   THEN    (     CASE     WHEN A.ORDERING_SOURCE_CODE!='*A'     THEN      H.LONG_DESC     ELSE '*A'     END)   ELSE (     CASE     WHEN A.ORDERING_SOURCE_CODE!='*A'     THEN      I.LONG_DESC     ELSE '*A'     END)   END) ORDERING_SOURCE_DESC   ,A.PERFORMING_FACILITY_ID   ,C.FACILITY_NAME PERFORMING_FACILITY_NAME   , A.RTN_ORD_DISP_LOCN_CODE   ,(   SELECT    SHORT_DESC   FROM    PH_DISP_LOCN_LANG_VW PH_DISP_LOCN   WHERE DISP_LOCN_CODE=A.RTN_ORD_DISP_LOCN_CODE     AND FACILITY_ID=A.ORDERING_FACILITY_ID AND LANGUAGE_ID = ?   ) RTN_ORD_DISP_LOCN_DESC   , A.STAT_ORD_DISP_LOCN_CODE   ,(   SELECT    SHORT_DESC   FROM    PH_DISP_LOCN_LANG_VW PH_DISP_LOCN   WHERE DISP_LOCN_CODE=A.STAT_ORD_DISP_LOCN_CODE     AND FACILITY_ID=A.ORDERING_FACILITY_ID AND LANGUAGE_ID = ?   ) STAT_ORD_DISP_LOCN_DESC   , A.DISCH_ORD_DISP_LOCN_CODE   , (   SELECT    SHORT_DESC   FROM    PH_DISP_LOCN_LANG_VW PH_DISP_LOCN   WHERE DISP_LOCN_CODE=A.DISCH_ORD_DISP_LOCN_CODE     AND FACILITY_ID=A.ORDERING_FACILITY_ID  AND LANGUAGE_ID = ? )DISCH_ORD_DISP_LOCN_DESC FROM  PH_ORDER_ROUTING A   , SM_FACILITY_PARAM_LANG_VW B   , SM_FACILITY_PARAM_LANG_VW C   ,OP_CLINIC_LANG_VW H   , IP_NURSING_UNIT_LANG_VW I   ,ph_disp_locn r   , ph_disp_locn s   , ph_disp_locn d WHERE A.ORDERING_FACILITY_ID=B.FACILITY_ID   AND A.PERFORMING_FACILITY_ID=C.FACILITY_ID   AND A.ORDERING_SOURCE_CODE=H.CLINIC_CODE(+)   AND A.ORDERING_FACILITY_ID=H.FACILITY_ID(+)   AND A.ORDERING_SOURCE_CODE=I.NURSING_UNIT_CODE(+)   AND A.ORDERING_FACILITY_ID=I.FACILITY_ID(+)   AND a.performing_facility_id = r.facility_id   AND a.rtn_ord_disp_locn_code = r.disp_locn_code   AND a.performing_facility_id = s.facility_id   AND a.stat_ord_disp_locn_code = s.disp_locn_code   AND a.performing_facility_id = d.facility_id   AND a.stat_ord_disp_locn_code = d.disp_locn_code   AND A.ORDERING_FACILITY_ID LIKE UPPER(?)   AND A.ORDERING_SOURCE_TYPE LIKE UPPER(?)   AND A.ORDERING_SOURCE_CODE LIKE UPPER(?)   AND (CASE     WHEN LTRIM(RTRIM(A.ORDERING_SOURCE_TYPE))='C'     THEN      (       CASE       WHEN A.ORDERING_SOURCE_CODE!='*A'       THEN        UPPER(H.LONG_DESC)       ELSE '*A'       END)     ELSE (       CASE       WHEN A.ORDERING_SOURCE_CODE!='*A'       THEN        UPPER(I.LONG_DESC)       ELSE '*A'       END)     END   ) LIKE UPPER(?)   AND UPPER(A.RTN_ORD_DISP_LOCN_CODE) LIKE UPPER(?)   AND UPPER(A.STAT_ORD_DISP_LOCN_CODE) LIKE UPPER(?)   AND UPPER(A.DISCH_ORD_DISP_LOCN_CODE) LIKE UPPER(?) AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND I.LANGUAGE_ID(+) = ? AND H.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT8", "SELECT A.ORDERING_FACILITY_ID,B.FACILITY_NAME ORDERING_FACILITY_NAME, A.ORDERING_SOURCE_TYPE, A.ORDERING_SOURCE_CODE, DECODE(A.ROUTING_LEVEL,'D','DrugClass','O','OrderType') ROUTING_LEVEL, A.ROUTING_CODE,A.PERFORMING_FACILITY_ID,C.FACILITY_NAME PERFORMING_FACILITY_NAME, A.NORM_DISP_LOCN_CODE,E.SHORT_DESC NORM_DISP_LOCN_DESC, A.DISCH_DISP_LOCN_CODE , G.SHORT_DESC DISCH_DISP_LOCN_DESC FROM PH_ORDER_ROUTING A, SM_FACILITY_PARAM B, SM_FACILITY_PARAM C,PH_DISP_LOCN D, MM_STORE E,PH_DISP_LOCN F, MM_STORE G WHERE A.ORDERING_FACILITY_ID=B.FACILITY_ID AND A.PERFORMING_FACILITY_ID=C.FACILITY_ID AND A.PERFORMING_FACILITY_ID=D.FACILITY_ID AND A.NORM_DISP_LOCN_CODE=D.DISP_LOCN_CODE AND D.FACILITY_ID=E.FACILITY_ID AND D.DISP_LOCN_CODE=E.STORE_CODE AND A.DISCH_DISP_LOCN_CODE=F.DISP_LOCN_CODE(+) AND A.PERFORMING_FACILITY_ID=F.FACILITY_ID(+) AND F.FACILITY_ID=G.FACILITY_ID(+) AND F.DISP_LOCN_CODE=G.STORE_CODE(+) AND A.ORDERING_FACILITY_ID = UPPER(?) AND A.ORDERING_SOURCE_TYPE = UPPER(?) AND A.ORDERING_SOURCE_CODE = UPPER(?) AND A.ROUTING_LEVEL = UPPER(?) AND A.ROUTING_CODE = UPPER(?) ");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT9", "SELECT COUNT(ROWID) FROM PH_ORDER_ROUTING WHERE ORDERING_FACILITY_ID = UPPER(?) AND ORDERING_SOURCE_TYPE = UPPER(?) AND ORDERING_SOURCE_CODE = UPPER(?) AND ROUTING_LEVEL = UPPER(?) AND ROUTING_CODE = UPPER(?)");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT10", "SELECT FACILITY_NAME FROM SM_FACILITY_PARAM_LANG_VW SM_FACILITY_PARAM WHERE FACILITY_ID=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT11", "SELECT COUNT(ROWID) count FROM PH_ORDER_ROUTING WHERE ORDERING_FACILITY_ID = UPPER(?) AND ORDERING_SOURCE_TYPE = UPPER(?) AND ORDERING_SOURCE_CODE = UPPER(?)");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT12", "SELECT COUNT(ROWID) count FROM PH_ORDER_ROUTING_DTL WHERE ORDERING_FACILITY_ID = UPPER(?) AND ORDERING_SOURCE_TYPE = UPPER(?) AND ORDERING_SOURCE_CODE = UPPER(?) AND ROUTING_LEVEL = UPPER(?) AND ROUTING_CODE = UPPER(?)");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT13", "SELECT A.DRUG_CLASS FROM PH_GENERIC_NAME A,PH_DRUG B WHERE A.GENERIC_ID = B.GENERIC_ID AND B.DRUG_CODE=?");
		//dataMap.put("SQL_PH_ORDER_ROUTING_SELECT14", "SELECT A.ORDERING_FACILITY_ID,B.FACILITY_NAME ORDERING_FACILITY_NAME, A.ORDERING_SOURCE_TYPE, A.ORDERING_SOURCE_CODE,(CASE WHEN LTRIM(RTRIM(A.ORDERING_SOURCE_TYPE))='C' THEN (CASE WHEN A.ORDERING_SOURCE_CODE!='*A' THEN H.LONG_DESC ELSE '*A' END)  ELSE (CASE WHEN A.ORDERING_SOURCE_CODE!='*A' THEN I.LONG_DESC ELSE '*A' END) END) ORDERING_SOURCE_DESC, A.PERFORMING_FACILITY_ID,C.FACILITY_NAME PERFORMING_FACILITY_NAME, A.RTN_ORD_DISP_LOCN_CODE,J.SHORT_DESC RTN_ORD_DISP_LOCN_DESC, A.STAT_ORD_DISP_LOCN_CODE,K.SHORT_DESC STAT_ORD_DISP_LOCN_DESC, A.DISCH_ORD_DISP_LOCN_CODE,L.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC,A.ROUTING_CODE,DECODE(A.ROUTING_LEVEL,'G',UPPER(M.DRUG_DESC),'O',UPPER(N.SHORT_DESC),'D', DECODE(A.ROUTING_CODE,'G','General','N','Narcotic','C','Controlled')) ROUTING_CODE_DESC,A.ROUTING_LEVEL FROM PH_ORDER_ROUTING_DTL A, SM_FACILITY_PARAM B, SM_FACILITY_PARAM C,OP_CLINIC H , IP_NURSING_UNIT I,PH_DISP_LOCN J,PH_DISP_LOCN K,PH_DISP_LOCN L, PH_DRUG M, OR_ORDER_TYPE N WHERE A.ORDERING_FACILITY_ID=B.FACILITY_ID AND A.PERFORMING_FACILITY_ID=C.FACILITY_ID AND A.ORDERING_SOURCE_CODE=H.CLINIC_CODE(+) AND A.ORDERING_FACILITY_ID=H.FACILITY_ID(+) AND A.ORDERING_SOURCE_CODE=I.NURSING_UNIT_CODE(+) AND A.ORDERING_FACILITY_ID=I.FACILITY_ID(+) AND A.PERFORMING_FACILITY_ID=J.FACILITY_ID AND A.RTN_ORD_DISP_LOCN_CODE=J.DISP_LOCN_CODE AND A.PERFORMING_FACILITY_ID=K.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=K.DISP_LOCN_CODE AND A.PERFORMING_FACILITY_ID=L.FACILITY_ID(+) AND A.DISCH_ORD_DISP_LOCN_CODE=L.DISP_LOCN_CODE(+) AND  A.ORDERING_FACILITY_ID LIKE UPPER(?) AND  A.ORDERING_SOURCE_TYPE LIKE UPPER(?) AND  A.ORDERING_SOURCE_CODE LIKE UPPER(?) AND  (CASE WHEN LTRIM(RTRIM(A.ORDERING_SOURCE_TYPE))='C' THEN (CASE WHEN A.ORDERING_SOURCE_CODE!='*A' THEN UPPER(H.LONG_DESC) ELSE '*A' END)  ELSE (CASE WHEN A.ORDERING_SOURCE_CODE!='*A' THEN UPPER(I.LONG_DESC) ELSE '*A' END) END) LIKE UPPER(?) AND A.ROUTING_LEVEL LIKE UPPER(?) AND  A.ROUTING_CODE  LIKE UPPER(?) AND A.ROUTING_CODE=M.DRUG_CODE(+) AND A.ROUTING_CODE=N.ORDER_TYPE_CODE(+)   AND (J.SHORT_DESC LIKE UPPER(?) OR L.SHORT_DESC LIKE UPPER(?) OR K.SHORT_DESC LIKE UPPER(?)) AND A.RTN_ORD_DISP_LOCN_CODE LIKE ? AND A.STAT_ORD_DISP_LOCN_CODE LIKE ? AND NVL(A.DISCH_ORD_DISP_LOCN_CODE,'X') LIKE ?");

		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT14", "SELECT A.ORDERING_FACILITY_ID  ,B.FACILITY_NAME ORDERING_FACILITY_NAME  , A.ORDERING_SOURCE_TYPE  , A.ORDERING_SOURCE_CODE  ,(  CASE  WHEN LTRIM(RTRIM(A.ORDERING_SOURCE_TYPE))='C'  THEN  (   CASE   WHEN A.ORDERING_SOURCE_CODE!='*A'   THEN   H.LONG_DESC   ELSE '*A'   END)  ELSE (   CASE   WHEN A.ORDERING_SOURCE_CODE!='*A'   THEN   I.LONG_DESC   ELSE '*A'   END)  END) ORDERING_SOURCE_DESC  , A.PERFORMING_FACILITY_ID  ,C.FACILITY_NAME PERFORMING_FACILITY_NAME  , A.RTN_ORD_DISP_LOCN_CODE  ,J.SHORT_DESC RTN_ORD_DISP_LOCN_DESC  , A.STAT_ORD_DISP_LOCN_CODE  ,K.SHORT_DESC STAT_ORD_DISP_LOCN_DESC  , A.DISCH_ORD_DISP_LOCN_CODE  ,L.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC  ,A.ROUTING_CODE  ,DECODE(A.ROUTING_LEVEL,'M', UPPER(O.SHORT_DESC), 'G',UPPER(M.DRUG_DESC),'O',UPPER(N.SHORT_DESC),'D', DECODE(A.ROUTING_CODE,'G','General','N','Narcotics','C','Controlled'),'L',DECODE(A.ROUTING_CODE,'ALLD','AllDirectOrders','ALLA','AllAdmixtures','CMPA','CompoundingOrder','IVOA','IVOrderAdmixture','IVOD','IVOrderDirect','ONCA','OncologyOrderAdmixture','ONCD','OncologyOrderDirect','TPND','TPNStandardRegimen','TPNA','TPNNONStandardRegimen')) ROUTING_CODE_DESC  ,A.ROUTING_LEVEL FROM PH_ORDER_ROUTING_DTL A  , SM_FACILITY_PARAM_LANG_VW B  , SM_FACILITY_PARAM_LANG_VW C  ,OP_CLINIC_LANG_VW H  , IP_NURSING_UNIT_LANG_VW I  ,PH_DISP_LOCN_LANG_VW J  ,PH_DISP_LOCN_LANG_VW K  ,PH_DISP_LOCN_LANG_VW L  , PH_DRUG_LANG_VW M  , OR_ORDER_TYPE_LANG_VW N,  MM_ITEM_LANG_VW O WHERE A.ORDERING_FACILITY_ID=B.FACILITY_ID  AND A.PERFORMING_FACILITY_ID=C.FACILITY_ID  AND A.ORDERING_SOURCE_CODE=H.CLINIC_CODE(+)  AND A.ORDERING_FACILITY_ID=H.FACILITY_ID(+)  AND A.ORDERING_SOURCE_CODE=I.NURSING_UNIT_CODE(+)  AND A.ORDERING_FACILITY_ID=I.FACILITY_ID(+)  AND A.PERFORMING_FACILITY_ID=J.FACILITY_ID  AND A.RTN_ORD_DISP_LOCN_CODE=J.DISP_LOCN_CODE  AND A.PERFORMING_FACILITY_ID=K.FACILITY_ID  AND A.STAT_ORD_DISP_LOCN_CODE=K.DISP_LOCN_CODE  AND A.PERFORMING_FACILITY_ID=L.FACILITY_ID(+)  AND A.DISCH_ORD_DISP_LOCN_CODE=L.DISP_LOCN_CODE(+)  AND A.ORDERING_FACILITY_ID LIKE UPPER(?)  AND A.ORDERING_SOURCE_TYPE LIKE UPPER(?)  AND A.ORDERING_SOURCE_CODE LIKE UPPER(?)  AND  (    CASE   WHEN LTRIM(RTRIM(A.ORDERING_SOURCE_TYPE))='C'   THEN   (    CASE    WHEN A.ORDERING_SOURCE_CODE!='*A'    THEN    UPPER(H.LONG_DESC)    ELSE '*A'    END)   ELSE (    CASE    WHEN A.ORDERING_SOURCE_CODE!='*A'    THEN    UPPER(I.LONG_DESC)    ELSE '*A'    END)   END  ) LIKE UPPER(?)  AND A.ROUTING_LEVEL LIKE UPPER(?)  AND A.ROUTING_CODE LIKE UPPER(?)  AND A.ROUTING_CODE=M.DRUG_CODE(+) AND A.ROUTING_CODE=O.ITEM_CODE(+)  AND A.ROUTING_CODE=N.ORDER_TYPE_CODE(+)  AND A.RTN_ORD_DISP_LOCN_CODE LIKE ?  AND A.STAT_ORD_DISP_LOCN_CODE LIKE ?  AND NVL(A.DISCH_ORD_DISP_LOCN_CODE,'X') LIKE ? AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = J.LANGUAGE_ID AND B.LANGUAGE_ID = K.LANGUAGE_ID  AND B.LANGUAGE_ID = ? AND H.LANGUAGE_ID(+) = ? AND I.LANGUAGE_ID(+) = ? AND L.LANGUAGE_ID(+) = ? AND M.LANGUAGE_ID(+) = ? AND N.LANGUAGE_ID(+) = ? AND O.LANGUAGE_ID(+) = ? ");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT15", "SELECT PERFORMING_FACILITY_ID, RTN_ORD_DISP_LOCN_CODE, STAT_ORD_DISP_LOCN_CODE, DISCH_ORD_DISP_LOCN_CODE FROM PH_ORDER_ROUTING_DTL WHERE ORDERING_FACILITY_ID = UPPER(?) AND ORDERING_SOURCE_TYPE = UPPER(?) AND ORDERING_SOURCE_CODE = UPPER(?) AND ROUTING_LEVEL = UPPER(?) AND ROUTING_CODE = UPPER(?)");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT16", "SELECT A.DISP_LOCN_CODE,A.SHORT_DESC FROM PH_DISP_LOCN_LANG_VW A WHERE A.EFF_STATUS='E' AND A.FACILITY_ID=? AND A.LANGUAGE_ID = ? AND DISP_LOCN_TYPE='P' OR DISP_LOCN_TYPE='N'");
		dataMap.put("SQL_PH_ORDER_ROUTING_SELECT17","SELECT A.PERFORMING_FACILITY_ID, A.RTN_ORD_DISP_LOCN_CODE, A.STAT_ORD_DISP_LOCN_CODE,A.DISCH_ORD_DISP_LOCN_CODE FROM PH_ORDER_ROUTING A,PH_DISP_LOCN D,PH_DISP_LOCN B,PH_DISP_LOCN C WHERE A.ORDERING_FACILITY_ID = UPPER(?) AND A.ORDERING_SOURCE_TYPE = UPPER(?) AND A.ORDERING_SOURCE_CODE = UPPER(?)  AND A.RTN_ORD_DISP_LOCN_CODE=D.DISP_LOCN_CODE AND A.PERFORMING_FACILITY_ID=D.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.PERFORMING_FACILITY_ID=B.FACILITY_ID AND A.DISCH_ORD_DISP_LOCN_CODE=C.DISP_LOCN_CODE(+)  AND A.ORDERING_FACILITY_ID=C.FACILITY_ID(+)"); 
		dataMap.put("SQL_PH_ORDER_ROUTING_INSERT", "INSERT INTO PH_ORDER_ROUTING (ORDERING_FACILITY_ID, ORDERING_SOURCE_TYPE, ORDERING_SOURCE_CODE, PERFORMING_FACILITY_ID, RTN_ORD_DISP_LOCN_CODE, STAT_ORD_DISP_LOCN_CODE, DISCH_ORD_DISP_LOCN_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, ?, ?, ?, ?,?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?) ");
		dataMap.put("SQL_PH_ORDER_ROUTING_DTL_INSERT", "INSERT INTO PH_ORDER_ROUTING_DTL(ORDERING_FACILITY_ID, ORDERING_SOURCE_TYPE, ORDERING_SOURCE_CODE, ROUTING_LEVEL, ROUTING_CODE, PERFORMING_FACILITY_ID, RTN_ORD_DISP_LOCN_CODE, STAT_ORD_DISP_LOCN_CODE, DISCH_ORD_DISP_LOCN_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?,?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?) "); 
		dataMap.put("SQL_PH_ORDER_ROUTING_DTL_UPDATE", "UPDATE PH_ORDER_ROUTING_DTL SET PERFORMING_FACILITY_ID =? , RTN_ORD_DISP_LOCN_CODE= ? ,STAT_ORD_DISP_LOCN_CODE=?, DISCH_ORD_DISP_LOCN_CODE = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? AND  ROUTING_LEVEL = ? AND ROUTING_CODE = ? ");
		dataMap.put("SQL_PH_ORDER_ROUTING_DELETE", "DELETE PH_ORDER_ROUTING WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? ");
		dataMap.put("SQL_PH_ORDER_ROUTING_DTL_DELETE", "DELETE PH_ORDER_ROUTING_DTL WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? AND  ROUTING_LEVEL = ? AND ROUTING_CODE = ? ");
		dataMap.put("JNDI_PH_ORDER_ROUTING", "java:comp/env/OrderRouting");

		dataMap.put("DISPLAY_SIZE_MATCHING_RECORDS", "8");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT1", "SELECT   st.item_code code, 	 mm.short_desc description    FROM   mm_item_lang_vw  mm,    st_item  st 	WHERE    st.item_code = mm.item_code  and 	mm.eff_status =	'E'	     AND  st.drug_item_yn='Y'  AND    mm.language_id LIKE  ?      AND	    st .item_code   LIKE   UPPER(?)    AND upper(mm.short_desc)	 LIKE   upper(?)   order by 2");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT2", "SELECT A.ITEM_CODE,C.LONG_DESC ,B.DRUG_CODE,B.DRUG_DESC,B.IN_FORMULARY_YN,A.DRUG_ITEM_YN, B.CONTENT_IN_PRES_BASE_UOM,B. PRES_BASE_UOM_DESC,B.STOCK_UOM ,B.STOCK_UOM_DESC FROM ST_ITEM A,PH_DRUG_VW_LANG_VW B,MM_ITEM C WHERE A.ITEM_CODE=C.ITEM_CODE AND UPPER(A.ITEM_CODE) BETWEEN NVL(?,'!') AND NVL(?,'~') AND A.ITEM_CODE=B.DRUG_CODE AND A.DRUG_ITEM_YN='Y' AND B.LANG1 = ? AND DECODE(B.LANG2,NULL,?,B.LANG2) = ? AND DECODE(B.LANG3,NULL,?,B.LANG3)= ?");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT3", "SELECT COUNT(A.ITEM_CODE) FROM ST_ITEM A,PH_DRUG_VW B,MM_ITEM C WHERE A.ITEM_CODE=C.ITEM_CODE AND UPPER(A.ITEM_CODE) BETWEEN NVL(?,'!') AND NVL(?,'~') AND A.ITEM_CODE=B.DRUG_CODE AND A.DRUG_ITEM_YN='Y' AND ROWNUM <= ?");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT3_DMY", "SELECT COUNT(A.ITEM_CODE) FROM ST_ITEM A,PH_DRUG_VW B,MM_ITEM C WHERE A.ITEM_CODE=C.ITEM_CODE AND UPPER(A.ITEM_CODE) BETWEEN NVL(?,'!') AND NVL(?,'~') AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM <= ?");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT2_DMY", "SELECT A.ITEM_CODE,A.LONG_DESC ,B.DRUG_CODE,B.DRUG_DESC,B.IN_FORMULARY_YN,A.DRUG_ITEM_YN, B.CONTENT_IN_PRES_BASE_UOM,B. PRES_BASE_UOM_DESC,B.STOCK_UOM ,B.STOCK_UOM_DESC FROM ST_ITEM A,PH_DRUG_VW B WHERE A.ITEM_CODE=B.DRUG_CODE AND A.DRUG_ITEM_YN='Y' AND UPPER(A.ITEM_CODE) BETWEEN NVL(?,'!') AND NVL(?,'~')  AND ROWNUM <= ? ");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT4", "SELECT DRUG_TO_ITEM_MAPPING FROM PH_PARAM WHERE MODULE_ID='PH' ");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT5_DMY", "SELECT    A.DRUG_CODE,   A.DRUG_DESC,   A.IN_FORMULARY_YN,   A.CONTENT_IN_PRES_BASE_UOM,   A. PRES_BASE_UOM_DESC,   A.STOCK_UOM ,   A.STOCK_UOM_DESC FROM    PH_DRUG_VW_LANG_VW A WHERE    A.IN_FORMULARY_YN='Y' AND   A.ITEM_CODE IS NULL AND   A.DRUG_CODE NOT IN (SELECT ITEM_CODE FROM ST_ITEM WHERE    DRUG_ITEM_YN='Y' ) AND A.LANG1 = ? AND DECODE(A.LANG2,NULL,?,A.LANG2) = ? AND DECODE(A.LANG3,NULL,?,A.LANG3) = ?");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT6_DMY", "SELECT COUNT(A.DRUG_CODE) FROM PH_DRUG A WHERE A.IN_FORMULARY_YN='Y' AND A.ITEM_CODE IS NULL AND A.DRUG_CODE NOT IN (SELECT ITEM_CODE FROM ST_ITEM WHERE  DRUG_ITEM_YN ='Y')");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT7_DMY", "SELECT   A.ITEM_CODE,   C.LONG_DESC,  A.SALE_UOM_CODE,   A.DRUG_ITEM_YN,   B.SHORT_DESC FROM    ST_ITEM A,   AM_UOM_LANG_VW B,   MM_ITEM_LANG_VW C WHERE    A.DRUG_ITEM_YN='Y' AND   A.ITEM_CODE=C.ITEM_CODE    AND   A.SALE_UOM_CODE=B.UOM_CODE(+) AND   A.ITEM_CODE NOT IN (SELECT DRUG_CODE FROM PH_DRUG WHERE NVL(DISCONTINUED_YN,'N')='N') AND C.LANGUAGE_ID = ? AND B.LANGUAGE_ID(+) = ? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT8_DMY", "SELECT COUNT(A.ITEM_CODE) FROM ST_ITEM A,AM_UOM B,MM_ITEM C WHERE A.DRUG_ITEM_YN ='Y' AND A.ITEM_CODE=C.ITEM_CODE  AND A.SALE_UOM_CODE=B.UOM_CODE(+)  AND A.ITEM_CODE NOT IN (SELECT DRUG_CODE FROM PH_DRUG WHERE NVL(DISCONTINUED_YN,'N')='N')");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT9_DMY", "SELECT    A.DRUG_CODE CODE,   A.DRUG_DESC DESCRIPTION,   A.IN_FORMULARY_YN,   A.CONTENT_IN_PRES_BASE_UOM,   PRES_BASE_UOM_DESC,   A.stock_uom ,   A.STOCK_UOM_DESC,   'D' CODE_FLAG,   TO_CHAR('N') DRUG_ITEM_YN FROM    PH_DRUG_VW_LANG_VW A WHERE    A.IN_FORMULARY_YN='Y' AND   A.ITEM_CODE IS NULL AND   A.DRUG_CODE NOT IN (SELECT ITEM_CODE FROM ST_ITEM WHERE    DRUG_ITEM_YN ='Y' ) AND A.LANG1= ? AND DECODE(A.LANG2,NULL,?,A.LANG2) = ? AND DECODE(A.LANG3,NULL,?,A.LANG3) = ? UNION    SELECT A.ITEM_CODE CODE,C.LONG_DESC  DESCRIPTION,'#',0,'#',A.SALE_UOM_CODE,   B.SHORT_DESC,'I' CODE_FLAG,A.DRUG_ITEM_YN DRUG_YN FROM ST_ITEM A,am_uom_lang_vw b,MM_ITEM_LANG_VW C    WHERE A.DRUG_ITEM_YN ='Y' AND   A.ITEM_CODE=C.ITEM_CODE AND   a.sale_uom_code=b.uom_code(+)   AND   A.ITEM_CODE NOT IN (SELECT DRUG_CODE FROM PH_DRUG WHERE NVL(DISCONTINUED_YN,'N')='N')  AND B.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_SELECT10_DMY", "SELECT   COUNT(A.DRUG_CODE), 'D' FROM    PH_DRUG A WHERE    A.IN_FORMULARY_YN='Y' AND   A.ITEM_CODE IS NULL AND   A.DRUG_CODE NOT IN (SELECT ITEM_CODE FROM ST_ITEM WHERE    DRUG_ITEM_YN ='Y' )     UNION   SELECT COUNT(A.ITEM_CODE),'I' FROM ST_ITEM A,MM_ITEM C   WHERE A.DRUG_ITEM_YN ='Y' AND  A.ITEM_CODE=C.ITEM_CODE  AND  A.ITEM_CODE NOT IN (SELECT DRUG_CODE FROM PH_DRUG WHERE NVL(DISCONTINUED_YN,'N')='N')");
		dataMap.put("SQL_PH_DRUG_ITEM_LINK_UPDATE", "UPDATE PH_DRUG SET ITEM_CODE = ?, DRUG_DESC = ? WHERE DRUG_CODE = ?");
		dataMap.put("JNDI_PH_DRUG_ITEM_LINK", "java:comp/env/DrugItemLink");
		dataMap.put("SQL_PH_TRN_TYPE_SELECT1", "SELECT PH_TRN_TYPE,LONG_DESC,SHORT_DESC, ST_TRN_TYPE_CODE FROM PH_TRN_TYPE_LANG_VW PH_TRN_TYPE WHERE LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT1", "SELECT A.PH_TRN_TYPE,A.SHORT_DESC FROM PH_TRN_TYPE_LANG_VW A WHERE A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT2", "SELECT LONG_DESC FROM SY_DOC_TYPE_MASTER_LANG_VW SY_DOC_TYPE_MASTER WHERE DOC_TYPE_CODE= ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT3", "SELECT A.DOC_TYPE_CODE, B.SHORT_DESC FROM ST_TRN_DOC_TYPE A, SY_DOC_TYPE_MASTER_LANG_VW B,SY_ACC_ENTITY_DOC_TYPE C WHERE A.FACILITY_ID=? AND A.TRN_TYPE = ? AND A.APPLICABLE_TO_PH_YN='Y' AND B.STATUS IS NULL AND C.DOC_NUM_GEN_FLAG = 'Y'  AND A.DOC_TYPE_CODE = B.DOC_TYPE_CODE AND A.DOC_TYPE_CODE = C.DOC_TYPE_CODE AND B.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT4", "SELECT A.PH_TRN_TYPE,A.SHORT_DESC, A.ST_TRN_TYPE_CODE, B.SHORT_DESC Short,C.ST_DOC_TYPE_CODE FROM PH_TRN_TYPE_LANG_VW A,ST_TRN_TYPE_LANG_VW B, PH_TRN_DOC_TYPE C WHERE  A.PH_TRN_TYPE=C.PH_TRN_TYPE_CODE AND A.ST_TRN_TYPE_CODE=B.TRN_TYPE_CODE AND A.PH_TRN_TYPE = ? AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ? AND C.FACILITY_ID IN('*A' , ?) AND ROWNUM <=1 ORDER BY C.FACILITY_ID DESC ");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT5", "SELECT TRN_TYPE_CODE, TRN_TYPE_CODE TRN_TYPE_DESC FROM ST_TRN_DOC_TYPE WHERE FACILITY_ID =? AND PH_MODULE_YN='Y' AND EFF_STATUS ='E' AND DOC_TYPE_CODE = ? ");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT6", "SELECT COUNT(ROWID) FROM PH_TRN_DOC_TYPE WHERE PH_TRN_TYPE_CODE = UPPER(?) AND ST_DOC_TYPE_CODE = UPPER(?)");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT7","SELECT A.PH_TRN_TYPE_CODE,C.LONG_DESC PH_TRN_DESC,A.ST_DOC_TYPE_CODE,B.LONG_DESC ST_DOC_DESC FROM  PH_TRN_DOC_TYPE A, SY_DOC_TYPE_MASTER_LANG_VW B,PH_TRN_TYPE_LANG_VW C WHERE A.PH_TRN_TYPE_CODE=C.PH_TRN_TYPE AND A.ST_DOC_TYPE_CODE=B.DOC_TYPE_CODE AND UPPER(A.PH_TRN_TYPE_CODE) LIKE UPPER(?) AND   UPPER(B.LONG_DESC) LIKE UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND A.FACILITY_ID IN('*A' , ?) ");// removed AND ROWNUM <=1 for incident 33949
		dataMap.put("SQL_PH_TRN_DOC_TYPE_SELECT8","SELECT A.PH_TRN_TYPE_CODE, C.LONG_DESC PH_TRN_DESC,A.ST_DOC_TYPE_CODE, B.LONG_DESC ST_DOC_DESC FROM  PH_TRN_DOC_TYPE A,SY_DOC_TYPE_MASTER_LANG_VW B,PH_TRN_TYPE_LANG_VW C WHERE A.PH_TRN_TYPE_CODE=C.PH_TRN_TYPE AND A.ST_DOC_TYPE_CODE=B.DOC_TYPE_CODE AND A.PH_TRN_TYPE_CODE=? AND A.ST_DOC_TYPE_CODE=? AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND A.FACILITY_ID IN('*A' , ?) AND ROWNUM <=1 ORDER BY A.FACILITY_ID DESC");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_INSERT", "INSERT INTO PH_TRN_DOC_TYPE(PH_TRN_TYPE_CODE, ST_DOC_TYPE_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,FACILITY_ID) VALUES (?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?,?)");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_UPDATE", "UPDATE PH_TRN_DOC_TYPE SET ST_DOC_TYPE_CODE=? , MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE PH_TRN_TYPE_CODE=? AND FACILITY_ID=?  ");
		dataMap.put("SQL_PH_TRN_DOC_TYPE_DELETE", "DELETE PH_TRN_DOC_TYPE WHERE  PH_TRN_TYPE_CODE = ?  AND ST_DOC_TYPE_CODE=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_OR_ORDER_CATALOG_SELECT1", "SELECT A.ORDER_TYPE_CODE,B.SHORT_DESC FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A,OR_ORDER_TYPE B WHERE A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND B.EFF_STATUS='E' AND A.DRUG_CLASS = ? ORDER BY 2");
		dataMap.put("SQL_PH_OR_ORDER_CATALOG_SELECT2", "SELECT A.ORDER_AUTH_LEVEL,A.ORDER_COSIGN_LEVEL,A.SPL_APPR_LEVEL,A.DISP_AUTH_REQD_YN,A.REPEAT_SINGLE_CONT_ORDER_YN FROM PH_DRUG_SCHEDULE A WHERE A.SCHEDULE_ID=? AND A.EFF_STATUS='E'");
		dataMap.put("SQL_PH_OR_ORDER_CATALOG_SELECT3", "SELECT A.DRUG_CATG_CODE,A.PATIENT_CLASS,A.MAX_DURN_VALUE,A.MAX_DURN_TYPE,A.ACTION,A.ORD_AUTH_LEVEL,A.PROMPT_MSG FROM PH_DRUG_CATG_RULE_BY_PATCL A WHERE A.DRUG_CATG_CODE=? ");

		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT1", " SELECT FACILITY_ID,FACILITY_NAME FROM SM_FACILITY_PARAM_LANG_VW SM_FACILITY_PARAM WHERE LANGUAGE_ID = ?  ORDER BY 2");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT1A", "SELECT A.RTN_ORD_DISP_LOCN_CODE RTN_ORD_DISP_LOCN_CODE,B.SHORT_DESC RTN_ORD_DISP_LOCN_DESC,A.STAT_ORD_DISP_LOCN_CODE STAT_ORD_DISP_LOCN_CODE,C.SHORT_DESC STAT_ORD_DISP_LOCN_DESC,A.DISCH_ORD_DISP_LOCN_CODE DISCH_ORD_DISP_LOCN_CODE,D.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC FROM PH_ORDER_ROUTING A, PH_DISP_LOCN_LANG_VW B, PH_DISP_LOCN_LANG_VW C, PH_DISP_LOCN_LANG_VW D WHERE A.ORDERING_FACILITY_ID=? AND A.ORDERING_SOURCE_TYPE=? AND A.ORDERING_SOURCE_CODE=?  AND  A.ORDERING_FACILITY_ID=B.FACILITY_ID AND A.RTN_ORD_DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=C.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=C.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=D.FACILITY_ID(+) AND A.DISCH_ORD_DISP_LOCN_CODE=D.DISP_LOCN_CODE(+) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT1B", "SELECT A.RTN_ORD_DISP_LOCN_CODE RTN_ORD_DISP_LOCN_CODE,B.SHORT_DESC RTN_ORD_DISP_LOCN_DESC,A.STAT_ORD_DISP_LOCN_CODE STAT_ORD_DISP_LOCN_CODE,C.SHORT_DESC STAT_ORD_DISP_LOCN_DESC,A.DISCH_ORD_DISP_LOCN_CODE DISCH_ORD_DISP_LOCN_CODE,D.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC FROM PH_ORDER_ROUTING_DTL A, PH_DISP_LOCN_LANG_VW B, PH_DISP_LOCN_LANG_VW C, PH_DISP_LOCN_LANG_VW D WHERE A.ORDERING_FACILITY_ID=? AND A.ORDERING_SOURCE_TYPE=? AND A.ORDERING_SOURCE_CODE=? AND A.ORDERING_FACILITY_ID=B.FACILITY_ID AND A.RTN_ORD_DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=C.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=C.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=D.FACILITY_ID(+) AND A.DISCH_ORD_DISP_LOCN_CODE=D.DISP_LOCN_CODE(+) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT1C","select to_char(WORKING_HOURS_FROM,'hh24:mi') WORKING_HOURS_FROM,to_char(WORKING_HOURS_TO,'hh24:mi') WORKING_HOURS_TO from ph_disp_locn where FACILITY_ID=? and DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT1D","SELECT NURSING_UNIT_CODE CODE, LONG_DESC DESCRIPTION  FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE UPPER(FACILITY_ID) LIKE UPPER(?)  AND Upper(NURSING_UNIT_CODE) like Upper(?) AND Upper(LONG_DESC) LIKE Upper(?) AND EFF_STATUS='E' AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT1E","SELECT CLINIC_CODE CODE, LONG_DESC DESCRIPTION  FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE  UPPER(FACILITY_ID) LIKE UPPER(?)  AND Upper(CLINIC_CODE) like Upper(?) AND Upper(LONG_DESC) LIKE Upper(?) AND EFF_STATUS='E'  AND CLINIC_TYPE ='C' AND  LANGUAGE_ID = ");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT1F","SELECT ph_alt_disp_locn_overlaps_yn(?) FROM DUAL");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT2", "SELECT NURSING_UNIT_CODE LOCN_CODE, SHORT_DESC SHORT_DESC FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE EFF_STATUS='E' AND FACILITY_ID = ? AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT3", "SELECT CLINIC_CODE LOCN_CODE, SHORT_DESC SHORT_DESC FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE EFF_STATUS='E' AND FACILITY_ID = ? AND CLINIC_TYPE='C' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT4","SELECT DISP_LOCN_CODE LOCN_CODE, SHORT_DESC SHORT_DESC, DISP_LOCN_TYPE FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID = ? AND EFF_STATUS='E' AND DISP_LOCN_TYPE IN ( 'P') AND DISP_LOCN_CODE NOT IN(?) AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT5", "SELECT DISTINCT A.DISP_LOCN_CODE, A.SHORT_DESC, DECODE(A.DISP_LOCN_TYPE, 'P', 'pharmacy', 'N', 'nursingUnit', 'C', 'clinic') DISP_LOCN_TYPE, (CASE WHEN(A.DISP_LOCN_CODE=B.ALT_DISP_LOCN_CODE AND A.FACILITY_ID=B.PERFORMING_FACILITY_ID) THEN 'Y' ELSE 'N' END) ASSO_YN FROM PH_DISP_LOCN A, PH_ALT_DISP_LOCN B WHERE A.FACILITY_ID = ? AND A.DISP_LOCN_TYPE IN ( 'P', ? ) AND A.DISP_LOCN_CODE <> ? AND A.FACILITY_ID=B.PERFORMING_FACILITY_ID(+) AND A.DISP_LOCN_CODE=B.ALT_DISP_LOCN_CODE(+) AND EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT6","SELECT ORDERING_FACILITY_ID, ORDERING_FACILITY_NAME,ORDERING_SOURCE_CODE, ORDERING_SOURCE_TYPE_NAME, ORDERING_SOURCE_DESC, PERFORMING_FACILITY_ID, PERFORMING_FACILITY_NAME, DISP_LOCN_CODE, DISP_LOCN_DESC,ALT_DISP_LOCN_CODE,ALT_DISP_LOCN_DESC,EFF_STATUS FROM PH_ALT_DISP_LOCN_LANG_VW   WHERE ORDERING_FACILITY_ID LIKE UPPER(?) AND ORDERING_SOURCE_TYPE LIKE DECODE( UPPER(?), 'B', ORDERING_SOURCE_TYPE, UPPER(?) ) AND UPPER(ORDERING_SOURCE_DESC) LIKE UPPER(?)  AND PERFORMING_FACILITY_ID LIKE UPPER(?) AND ALT_DISP_LOCN_CODE LIKE UPPER(?) AND   UPPER(ALT_DISP_LOCN_DESC) LIKE UPPER(?) AND EFF_STATUS LIKE DECODE( UPPER(?), 'B', EFF_STATUS, UPPER(?) ) AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2) = ? AND DECODE(LANG3,NULL,?,LANG3) = ?");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT7","SELECT RTN_ORD_DISP_LOCN_CODE FROM PH_ORDER_ROUTING WHERE ORDERING_FACILITY_ID=? AND ORDERING_SOURCE_TYPE=? AND ORDERING_SOURCE_CODE=?");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT8","SELECT ORDERING_FACILITY_ID,ORDERING_FACILITY_NAME,ORDERING_SOURCE_TYPE,ORDERING_SOURCE_TYPE_NAME,ORDERING_SOURCE_CODE,ORDERING_SOURCE_DESC,PERFORMING_FACILITY_ID,PERFORMING_FACILITY_NAME,DISP_LOCN_CODE,DISP_LOCN_DESC,ALT_DISP_LOCN_CODE,ALT_DISP_LOCN_DESC,to_char(TIME_FROM,'hh24:mi') TIME_FROM,to_char(TIME_TO,'hh24:mi')TIME_TO,EFF_STATUS  FROM PH_ALT_DISP_LOCN_LANG_VW PH_ALT_DISP_LOCN_VW  WHERE ORDERING_FACILITY_ID=? AND ORDERING_SOURCE_TYPE=? AND PERFORMING_FACILITY_ID=? AND  ORDERING_SOURCE_CODE=? AND ALT_DISP_LOCN_CODE=? AND DISP_LOCN_CODE=? AND LANG1= ? AND DECODE(LANG2,NULL,?,LANG2) = ? AND DECODE(LANG3,NULL,?,LANG3) = ?");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_SELECT9","SELECT ALT_DISP_LOCN_CODE,EFF_STATUS,to_char(TIME_FROM,'hh24:mi') TIME_FROM,to_char(TIME_TO,'hh24:mi')TIME_TO  FROM PH_ALT_DISP_LOCN  WHERE ORDERING_FACILITY_ID=? AND  ORDERING_SOURCE_TYPE=?  AND ORDERING_SOURCE_CODE=? AND PERFORMING_FACILITY_ID=? AND DAY_TYPE=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_INSERT", "INSERT INTO PH_ALT_DISP_LOCN(ORDERING_FACILITY_ID, ORDERING_SOURCE_TYPE, ORDERING_SOURCE_CODE, PERFORMING_FACILITY_ID, DISP_LOCN_CODE,ALT_DISP_LOCN_CODE, DAY_TYPE,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,  MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,TIME_FROM,TIME_TO,EFF_STATUS)VALUES (?, ?, ?, ?, ?, ?, ?, ?,SYSDATE, ?, ?, ?, SYSDATE, ?, ?,TO_DATE(?,'hh24:mi'),TO_DATE(?,'hh24:mi'),?)");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_DELETE", "DELETE PH_ALT_DISP_LOCN WHERE ORDERING_FACILITY_ID = ? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? AND PERFORMING_FACILITY_ID =? AND DISP_LOCN_CODE = ? ");
		dataMap.put("SQL_PH_ALT_DISP_LOCN_UPDATE", "UPDATE PH_ALT_DISP_LOCN SET  MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, TIME_FROM=TO_DATE(?,'hh24:mi'),TIME_TO=TO_DATE(?,'hh24:mi'),EFF_STATUS=? WHERE DISP_LOCN_CODE=? AND PERFORMING_FACILITY_ID=? AND ORDERING_SOURCE_CODE =?  AND ORDERING_SOURCE_TYPE=? AND ORDERING_FACILITY_ID=? AND ALT_DISP_LOCN_CODE=? AND DAY_TYPE=?");
		dataMap.put("JNDI_PH_ALT_DISP_LOCN", "java:comp/env/AlternateDispLocn");
		dataMap.put("SQL_PH_WS_NO_FOR_DISP_LOCN_SELECT1", "SELECT A.DISP_LOCN_CODE code, B.SHORT_DESC short, A.WS_NO wsno FROM PH_WS_NO_FOR_DISP_LOCN A, PH_DISP_LOCN_LANG_VW B WHERE A.FACILITY_ID=B.FACILITY_ID AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID = ? AND A.DISP_LOCN_CODE LIKE UPPER(?) AND UPPER(B.SHORT_DESC) LIKE UPPER(?) AND UPPER(A.WS_NO) LIKE UPPER (?) AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_WS_NO_FOR_DISP_LOCN_SELECT2", "SELECT A.DISP_LOCN_CODE code, B.SHORT_DESC des, A.WS_NO wsno FROM PH_WS_NO_FOR_DISP_LOCN A, PH_DISP_LOCN_LANG_VW B WHERE A.FACILITY_ID=B.FACILITY_ID AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID = ? AND A.DISP_LOCN_CODE = ? AND A.WS_NO = ? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_WS_NO_FOR_DISP_LOCN_SELECT3", "SELECT DISP_LOCN_CODE,SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID = ? AND DISP_LOCN_TYPE = 'P' AND EFF_STATUS = 'E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_WS_NO_FOR_DISP_LOCN_INSERT", "INSERT INTO PH_WS_NO_FOR_DISP_LOCN (FACILITY_ID, DISP_LOCN_CODE, WS_NO, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_PH_WS_NO_FOR_DISP_LOCN_DELETE", "DELETE FROM PH_WS_NO_FOR_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND WS_NO = ? ");
		dataMap.put("SQL_PH_WS_NO_FOR_DISP_LOCN_KEY", "SELECT COUNT(ROWID) FROM PH_WS_NO_FOR_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND WS_NO=? ");

		//PH-Register prescriptions...
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT1", "SELECT A.PRACT_TYPE FROM AM_PRACTITIONER A,SM_APPL_USER B WHERE A.PRACTITIONER_ID=B.FUNC_ROLE_ID AND A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND APPL_USER_ID=?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT2", "SELECT COUNT(ROWID) count FROM SM_MODULE WHERE MODULE_ID='OR' AND INSTALL_YN='Y'");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT3", "SELECT DISP_LOCN_CODE FROM PH_WS_NO_FOR_DISP_LOCN WHERE FACILITY_ID=? AND WS_NO=? ");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT4", "SELECT DISP_REGN_REQD_YN, DISP_LOCN_CODE, SHORT_DESC, ISSUE_TOKEN_ON_REGN_YN FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE = (?) AND EFF_STATUS='E' AND LANGUAGE_ID = ?  ORDER BY UPPER(SHORT_DESC)");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT4A", "SELECT  a.DISP_LOCN_CODE, a.SHORT_DESC, c.ACK_YN FROM PH_DISP_LOCN_LANG_VW a, PH_WS_NO_FOR_DISP_LOCN b, PH_DISP_RIGHTS c WHERE a.DISP_LOCN_CODE = b.DISP_LOCN_CODE and a.DISP_LOCN_CODE = c.DISP_LOCN_CODE and b.facility_id = ? and a.FACILITY_ID=? and c.FACILITY_ID = ? and c.APPL_USER_ID = ? and b.WS_NO = ? AND a.EFF_STATUS='E' and a.DIRECT_DISP_ALLOWED_YN='Y' AND a.LANGUAGE_ID = ?  ORDER BY UPPER(2)");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT5", "SELECT ACK_YN FROM PH_DISP_RIGHTS WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND APPL_USER_ID=?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT6", "SELECT   DECODE(A.PRIORITY,  'U',  'urgent',   'R',  'routine')PRIORITY,  A.ORDER_TYPE_CODE,  B.SHORT_DESC ORDER_TYPE_DESC,  A.ORDER_ID,  TO_CHAR(G.START_DATE_TIME,  'DD/MM/RRRR') START_DATE_TIME,  PH_ORDER_SOURCE(A.SOURCE_CODE,   A.PATIENT_CLASS,  A.ORDERING_FACILITY_ID,   A.SOURCE_TYPE,B.LANGUAGE_ID) SOURCE_DESC,  A.ORD_PRACT_ID,  E.PRACTITIONER_NAME,  G.ORDER_LINE_STATUS,  A.CHILD_ORDER_YN,  A.DISCHARGE_IND,  A.ENCOUNTER_ID FROM   OR_ORDER A,  OR_ORDER_TYPE_LANG_VW B,  AM_PRACTITIONER_LANG_VW E,  OR_ORDER_LINE G,PH_FACILITY_PARAM H,		OR_ORDER_LINE_PH I WHERE   A.ORDER_TYPE_CODE = B.ORDER_TYPE_CODE AND  A.ORD_PRACT_ID	= E.PRACTITIONER_ID AND  A.ORDERING_FACILITY_ID=H.FACILITY_ID AND A.ORDER_ID = G.ORDER_ID  AND A.PATIENT_ID = ? AND G.ORDER_ID=I.ORDER_ID AND G.ORDER_LINE_NUM=I.ORDER_LINE_NUM AND  PH_CHECK_ORD_DATE_DISPENSING(G.START_DATE_TIME,G.END_DATE_TIME,?,?,?,?,?)=1  AND A.ORDER_CATEGORY='PH' AND A.PERFORMING_DEPTLOC_CODE=?  AND A.ORDER_TYPE_CODE IN (SELECT ORDER_TYPE_CODE FROM PH_ORDER_TYPE_FOR_DRUG_CLASS) AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = ?");//code 'TO_CHAR(A.ORD_DATE_TIME,  'DD/MM/RRRR') ORD_DATE_TIME '  replaced by TO_CHAR(G.START_DATE_TIME,  'DD/MM/RRRR') START_DATE_TIME for Bru-HIMS-CRF-418[IN045564] //Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT7", "SELECT A.PATIENT_ID,nvl( decode(?,'en',g.patient_name, g.patient_name_loc_lang),g.patient_name)patient_name ,DECODE(G.SEX,'M','male','F','female','U','unknown')SEX,G.SEX GENDER, F.COUNTRY_CODE,F.LONG_DESC NATIONALITY_DESC,	 COUNT(DISTINCT B.ORDER_ID) TOTAL_PRES,GET_AGE(G.DATE_OF_BIRTH) AGE, A.PATIENT_CLASS, A.ENCOUNTER_ID FROM OR_ORDER A, OR_ORDER_LINE B,OR_ORDER_LINE_PH C,PH_FACILITY_PARAM E,MP_PATIENT G,MP_COUNTRY_LANG_VW F WHERE A.ORDERING_FACILITY_ID=E.FACILITY_ID AND G.PATIENT_ID = A.PATIENT_ID AND A.ORDER_ID = B.ORDER_ID AND A.ORDER_ID=C.ORDER_ID AND B.ORDER_ID=C.ORDER_ID AND B.ORDER_LINE_NUM=C.ORDER_LINE_NUM AND G.NATIONALITY_CODE = F.COUNTRY_CODE(+) AND PH_CHECK_ORD_DATE_DISPENSING(B.START_DATE_TIME,B.END_DATE_TIME,?,?,?,?,?)=1  AND A.ORDER_CATEGORY='PH' AND A.PERFORMING_DEPTLOC_CODE=? AND A.ORDER_TYPE_CODE IN (SELECT ORDER_TYPE_CODE FROM PH_ORDER_TYPE_FOR_DRUG_CLASS) AND F.LANGUAGE_ID(+) = ?");//code 'A.PATIENT_CLASS, A.ENCOUNTER_ID' added for JD-CRF-0156[IN041737]//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		//dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT8", "SELECT COUNT(DISTINCT A.PATIENT_ID) TOTAL_COUNT FROM OR_ORDER A,OR_ORDER_LINE B, PH_ORDER_TYPE_FOR_DRUG_CLASS C WHERE A.ORDER_CATEGORY='PH' AND  (A.ORDER_STATUS <> '97' OR A.ORDER_STATUS <> '98' OR A.ORDER_STATUS <> '99' OR A.ORDER_STATUS <> '93' ) AND A.ORDER_ID=B.ORDER_ID AND B.END_DATE_TIME > SYSDATE AND A.ORDER_TYPE_CODE=C.ORDER_TYPE_CODE");

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT9", "SELECT /*+ Index(a or_order_line_i22) */ a.order_line_num, a.order_catalog_code, a.catalog_desc, b.drug_desc || (select decode(short_name,null,null,' ('||substr(short_name,1,20)||')') from am_trade_name_lang_vw k where k.trade_id = j.trade_code and k.language_id = c.language_id) drug_desc, DECODE (INSTR (a.qty_value, '.'),0, TO_CHAR (a.qty_value),RTRIM (TO_CHAR (a.qty_value, '9999999990.00000000'),'0')) qty_value, a.qty_unit, c.short_desc qty_unit_desc, d.freq_desc, a.durn_value, e.durn_desc, a.order_line_status,i.iv_prep_yn,ph_get_ext_prod_drug_code(b.drug_code,?)EXTERNAL_PRODUCT_ID,NVL(ph_calculatebalance(a.order_id,a.order_line_num),A.ORDER_QTY)   BMS_QTY ,j.trade_code trade_code,b.IN_FORMULARY_YN IN_FORMULARY_YN,j.BL_INCL_EXCL_OVERRIDE_VALUE, j.BL_INCL_EXCL_OVERRIDE_REASON FROM or_order_line a,ph_drug_lang_vw b,am_uom_lang_vw c,am_frequency_lang_vw d,am_duration_type_lang_vw e,ph_facility_param f,or_order_status_code_lang_vw g,ph_order_type_for_drug_class h, or_order i,or_order_line_ph j WHERE g.order_status_type IN ('10', '56', '25','94')AND a.order_type_code = h.order_type_code(+) AND a.order_id = i.order_id AND a.order_line_status = g.order_status_code AND a.order_catalog_code = b.drug_code(+) AND a.order_id = ? AND a.qty_unit = c.uom_code AND a.freq_code = d.freq_code  AND a.durn_type = e.durn_type  AND f.facility_id = ?   AND ph_check_ord_date_dispensing (a.start_date_time, a.end_date_time, ?,?,?,?,?) > 0 AND c.language_id = d.language_id AND c.language_id = e.language_id AND c.language_id = e.language_id AND c.language_id = g.language_id AND c.language_id = ? AND b.language_id(+) = ? and j.order_id = a.order_id and j.order_line_num = a.order_line_num");//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT10","SELECT A.NATIONALITY_IND ,A.TOKEN_SERIES_CODE,A.DESCRIPTION, (CASE WHEN TO_CHAR(A.RECYCLED_DATE, 'DD-MM-YYYY') = TO_CHAR(SYSDATE, 'DD-MM-YYYY') THEN A.NEXT_SERIAL_NO ELSE A.START_SERIAL_NO END)  NEXT_SERIAL_NO, B.DEFAULT_TOKEN_YN FROM PH_TOKEN_SERIES_LANG_VW A,PH_WS_FOR_TOKEN_SERIES B WHERE A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID=B.FACILITY_ID AND A.TOKEN_SERIES_CODE=B.TOKEN_SERIES_CODE AND B.WS_NO=? AND A.DISP_LOCN_CODE=? and a.TOKEN_GEN_STAGE='RG' AND A.FACILITY_ID=? AND A.EFF_STATUS='E' AND  A.APPLICABLE_SEX_IND IN ('B',(SELECT SEX FROM MP_PATIENT WHERE PATIENT_ID=?)) AND  A.NATIONALITY_IND  IN ('B',DECODE((SELECT NATIONALITY_CODE FROM MP_PATIENT WHERE PATIENT_ID=?), (SELECT CITIZEN_NATIONALITY_CODE FROM MP_PARAM),'N','E')) AND A.LANGUAGE_ID = ?  ");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT11","SELECT  COUNTRY_CODE,LONG_NAME SHORT_NAME FROM MP_COUNTRY_LANG_VW MP_COUNTRY WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_NUR_UNIT_SELECT","SELECT NURSING_UNIT_CODE,LONG_DESC FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE FACILITY_ID=? AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY LONG_DESC");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT12","SELECT PRINT_PRES_ON_REGN_YN,ISSUE_TOKEN_ON_REGN_YN FROM PH_DISP_LOCN WHERE  DISP_LOCN_CODE = ? AND FACILITY_ID = ? ");


		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT13","SELECT A.ALT_ID1_TYPE ALT_ID ,B.LONG_DESC SHORT_DESC,A.NATIONALITY_CODE,C.LONG_DESC NATIONALITY_DESC,A.NATIONAL_ID_NO NAT_ID_NO,  A.ALT_ID1_NO HEALTH_CARD_NO FROM MP_PATIENT A,MP_ALTERNATE_ID_TYPE_LANG_VW B, MP_COUNTRY_LANG_VW C WHERE A.PATIENT_ID=? AND A.ALT_ID1_TYPE=B.ALT_ID_TYPE(+) AND  A.NATIONALITY_CODE=C.COUNTRY_CODE(+) AND B.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID(+) = ?");



		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT14","SELECT COUNT(ROWID) COUNT FROM PH_DISP_QUEUE_SUMM WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE)");
		
		//dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT15","SELECT A.TOKEN_SERIES_CODE,A.DESCRIPTION,  	   (CASE WHEN TO_CHAR(A.RECYCLED_DATE, 'DD-MM-YYYY') = TO_CHAR(SYSDATE, 'DD-MM-YYYY')    		 THEN A.NEXT_SERIAL_NO+1 			 ELSE A.START_SERIAL_NO 			 END)  NEXT_SERIAL_NO FROM PH_TOKEN_SERIES_LANG_VW A	  WHERE A.FACILITY_ID = UPPER(?) AND  A.DISP_LOCN_CODE = ? AND    A.TOKEN_SERIES_CODE=? AND  A.EFF_STATUS = 'E' AND A.LANGUAGE_ID = ?");

       dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT15","SELECT A.TOKEN_SERIES_CODE,A.DESCRIPTION,(CASE WHEN A.RECYCLED_DATE is null THEN a.start_serial_no WHEN TO_CHAR(A.RECYCLED_DATE, 'DD-MM-YYYY') = TO_CHAR(SYSDATE, 'DD-MM-YYYY') THEN A.NEXT_SERIAL_NO+1  ELSE  a.start_serial_no  END)  NEXT_SERIAL_NO FROM PH_TOKEN_SERIES_LANG_VW A	  WHERE A.FACILITY_ID = UPPER(?) AND  A.DISP_LOCN_CODE = ? AND    A.TOKEN_SERIES_CODE=? AND  A.EFF_STATUS = 'E' AND A.LANGUAGE_ID = ?");

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT16","SELECT  DISP_AUTH_REQD_DRUG_YN, DISP_NARCOTIC_YN, DISP_CONTROLLED_DRUG_YN FROM  PH_DISP_RIGHTS WHERE  APPL_USER_ID = ? AND  FACILITY_ID = ? AND  DISP_LOCN_CODE =?");
    	//	dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT17","SELECT A.TOKEN_SERIES_CODE,A.DESCRIPTION, (CASE WHEN TO_CHAR(A.RECYCLED_DATE, 'DD-MM-YYYY') = TO_CHAR(SYSDATE, 'DD-MM-YYYY') THEN A.NEXT_SERIAL_NO 	ELSE A.START_SERIAL_NO 	END)  NEXT_SERIAL_NO FROM PH_TOKEN_SERIES_LANG_VW A WHERE DISP_LOCN_CODE=? AND FACILITY_ID=?  AND EFF_STATUS='E' AND  APPLICABLE_SEX_IND IN ('B',?) AND  NATIONALITY_IND IN ('B',DECODE((SELECT CITIZEN_NATIONALITY_CODE FROM MP_PARAM ), ?,'N','E')) AND A.LANGUAGE_ID = ? and TOKEN_GEN_STAGE ='RG' ");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT17","SELECT a.token_series_code, a.description, (CASE WHEN TO_CHAR (a.recycled_date, 'DD-MM-YYYY') = TO_CHAR (SYSDATE, 'DD-MM-YYYY')  THEN a.next_serial_no  ELSE a.start_serial_no  END ) next_serial_no FROM ph_token_series_lang_vw a,    ph_ws_for_token_series b WHERE   a.disp_locn_code = b.disp_locn_code AND a.facility_id = b.facility_id   AND a.token_series_code = b.token_series_code  AND b.ws_no = ?   AND A.disp_locn_code = ?   AND A.facility_id = ? AND A.eff_status = 'E' AND applicable_sex_ind IN ('B', ?)  AND  NATIONALITY_IND IN ('B',DECODE((SELECT CITIZEN_NATIONALITY_CODE FROM MP_PARAM ), ?,'N','E'))  AND a.language_id = ?   AND token_gen_stage = 'RG' ");

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT18","SELECT DESCRIPTION FROM PH_TOKEN_SERIES_LANG_VW PH_TOKEN_SERIES WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND TOKEN_SERIES_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT19","select max(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO  from ph_disp_queue	where FACILITY_ID=? AND DISP_LOCN_CODE=? AND TRUNC(QUEUE_DATE)=TRUNC(SYSDATE) AND QUEUE_SHIFT=? AND TOKEN_SERIES_CODE=?");

		//dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT20","SELECT to_char(SYSDATE +(select DISP_BEYOND_NO_OF_DAYS from ph_facility_param WHERE FACILITY_ID=?),'dd/mm/yyyy') SYS_DATE_TIME from dual");

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT20","SELECT TO_CHAR (SYSDATE - nvl(disp_beyond_no_of_days,0),'dd/mm/yyyy') FROM_DATE,TO_CHAR (SYSDATE + nvl(disp_before_no_of_days ,0),'dd/mm/yyyy') TO_DATE, DISP_EXPIRIED_ORDERS  FROM ph_facility_param where facility_id = ?");

		dataMap.put("SQL_PH_SELECT_DISP_ORDER_DATE_RANGE_IP","SELECT TO_CHAR (SYSDATE - nvl(disp_beyond_no_of_days_ip,0),'dd/mm/yyyy') FROM_DATE,TO_CHAR (SYSDATE + nvl(disp_before_no_of_days_ip ,0),'dd/mm/yyyy') TO_DATE, DISP_EXPIRIED_ORDERS  FROM ph_facility_param where facility_id = ?");

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT21","select nat_id_prompt from mp_param_lang_vw mp_param where language_id = ?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT22"," select long_desc alt_id1_desc    from mp_alternate_id_type_lang_vw mp_alternate_id_type  where alt_id_type = (select alt_id1_type from mp_param) and language_id = ?");

        dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT23"," SELECT GEN_TOKEN_YN, QMS_REQUIRED_YN,QMS_EDIT_TOKEN_YN FROM PH_TOKEN_SERIES WHERE FACILITY_ID=? AND  DISP_LOCN_CODE=? AND  TOKEN_SERIES_CODE=? ");

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT24"," SELECT COUNT(*) count FROM ph_disp_queue WHERE FACILITY_ID=? and DISP_LOCN_CODE=? and QUEUE_DATE=trunc(sysdate) and TOKEN_SERIES_CODE=? and TOKEN_SERIAL_NO=? ");

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT25","  select DFLT_DIR_DISP_LOCN  from ph_facility_param where facility_id=? ");

		

		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_UPDATE_OR_ORDER","UPDATE OR_ORDER SET ORDER_STATUS = (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_TYPE = '25'),MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDER_ID = ?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_UPDATE_OR_ORDER_LINE","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS = (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE 	ORDER_STATUS_TYPE = '25'),MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=? AND ORDER_LINE_STATUS NOT IN('DF','HD','DC','CN') ");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_UPDATE_TOKEN_SERIES","UPDATE PH_TOKEN_SERIES SET NEXT_SERIAL_NO = (CASE WHEN TO_CHAR(RECYCLED_DATE, 'DD-MM-YYYY') = TO_CHAR(SYSDATE, 'DD-MM-YYYY')    		 THEN NEXT_SERIAL_NO + 1 			 ELSE START_SERIAL_NO 			 END) , RECYCLED_DATE = SYSDATE,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE  FACILITY_ID =? AND DISP_LOCN_CODE = ? AND TOKEN_SERIES_CODE = ? AND EFF_STATUS = 'E'");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_UPDATE_DISP_QUEUE_SUMM","UPDATE PH_DISP_QUEUE_SUMM  SET  TOT_REGD = TOT_REGD+1, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE,  MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_INSERT_DISP_QUEUE","INSERT INTO PH_DISP_QUEUE(FACILITY_ID, DISP_LOCN_CODE, QUEUE_DATE,QUEUE_SHIFT, TOKEN_SERIES_CODE, TOKEN_SERIAL_NO, NO_OF_PRES, PATIENT_ID,COLLECTOR_SAME_AS_PATIENT,COLLECTOR_NAME, COLLECTOR_NATIONALITY, ENCOUNTER_ID, REGN_DATE_TIME,  ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,  MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,COLLECTOR_GENDER,TOKEN_STATUS,PATIENT_ARRIVED_YN,TMP_TOKEN_SERIAL_NO) VALUES(?,?,TRUNC(SYSDATE),'*ALL',?,?,?,?,?,?,?,?,SYSDATE,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_INSERT_DISP_QUEUE_SUMM","INSERT INTO PH_DISP_QUEUE_SUMM(FACILITY_ID, DISP_LOCN_CODE, QUEUE_DATE, QUEUE_SHIFT, TOKEN_SERIES_CODE, TOT_REGD, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID,  MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,TRUNC(SYSDATE),'*ALL',?,1,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_INSERT_ORD_FOR_DISP_QUEUE","INSERT INTO PH_ORD_FOR_DISP_QUEUE (FACILITY_ID,DISP_LOCN_CODE, QUEUE_DATE, QUEUE_SHIFT, TOKEN_SERIES_CODE, TOKEN_SERIAL_NO, ORDER_ID, PATIENT_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,ORDER_LINE_NUM,TOKEN_LINE_STATUS) VALUES(?,?,TRUNC(SYSDATE),'*ALL',?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		//TOKEN_LINE_STATUS,ORDER_LINE_NUM added for PMG2020-ML-MMOH-CRF-0002
		dataMap.put( "JNDI_PH_REG_PRESCRIPTIONS", "java:comp/env/RegPrescriptions") ;
		
		//PH - TRANSACTION :
		// Prescription starts
		
		dataMap.put("SQL_PH_EXT_PRESCRIPTION_DISP_LOCN_SELECT", "SELECT  DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE DISP_LOCN_CATEGORY IN('O','B') AND DISP_LOCN_TYPE='P' AND EFF_STATUS='E' AND FACILITY_ID=? AND LANGUAGE_ID = ? and EXTERNAL_RX_ALLOWED_YN='Y' order by 2");
		dataMap.put("SQL_PH_EXT_PRESCRIPTION_DEFLT_DISP_LOCN_SELECT", "select a.DFLT_EXT_RX_DISP_LOCN, b.SHORT_DESC from ph_facility_param a, PH_DISP_LOCN_LANG_VW b where a.facility_id=? and a.DFLT_EXT_RX_DISP_LOCN = b.DISP_LOCN_CODE and b.language_id=?");
		dataMap.put("SQL_PH_PRESCRIPTION_DRUG_LOOKUP", "SELECT ORDER_CATALOG_CODE code, LONG_DESC description FROM OR_ORDER_CATALOG WHERE ORDER_CATEGORY='PH' AND EFF_STATUS='E' AND ORDER_TYPE_CODE like ?  AND ORDER_CATALOG_CODE LIKE UPPER(?) AND LONG_DESC LIKE UPPER(?)");
		dataMap.put("SQL_PH_PRESCRIPTION_DRUG_LOOKUP_FOR_DRUG_CLASS", "SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG WHERE DISCONTINUED_YN='N' AND DRUG_CLASS like ? AND DRUG_CODE LIKE UPPER(?) AND DRUG_DESC LIKE UPPER(?) ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT1", "SELECT GENERIC_ID, GENERIC_NAME, FORM_CODE,FORM_DESC,ROUTE_CODE,ROUTE_DESC,STRENGTH_VALUE,STRENGTH_UOM,PRES_BASE_UOM,PRES_BASE_UOM_DESC,STRENGTH_UOM_DESC,CALC_DOSG_BY_FREQ_DURN_YN,DISP_ALT_FORM_YN,DRUG_CLASS,STRENGTH_PER_PRES_UOM,STRENGTH_PER_VALUE_PRES_UOM,TRADE_NAME,IN_FORMULARY_YN FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE DRUG_CODE=? AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT2", "SELECT B.FIELD_OR_TEMPLATE_MNEMONIC,D.DISCR_MSR_RESULT_NUM ,D.DISCR_MSR_RESULT_NUM_UOM,D.ENCOUNTER_ID,D.PATIENT_ID,D.PATIENT_CLASS,to_char(D.TEST_OBSERV_DT_TM,'dd/mm/yyyy hh24:mi') TEST_OBSERV_DT_TM FROM OR_ORDER_FORMAT_HDR A,OR_ORDER_FORMAT_DTL B,OR_ORDER_FIELD C, CA_ENCNTR_DISCR_MSR D WHERE A.ORDER_CATEGORY='PH' AND   A.ORDER_CATEGORY = C.ORDER_CATEGORY  AND B.FIELD_OR_TEMPLATE_MNEMONIC IN('HEIGHT','WEIGHT') AND A.FORMAT_ID=B.FORMAT_ID AND B.FIELD_OR_TEMPLATE_MNEMONIC=C.FIELD_MNEMONIC AND D.FACILITY_ID=? AND d.discr_msr_id = c.discr_msr_id AND D.PATIENT_ID=?  AND D.DISCR_MSR_RESULT_NUM_UOM IS NOT NULL AND (D.TEST_OBSERV_DT_TM) BETWEEN SYSDATE-15 AND SYSDATE+.99999 and  nvl(d.ERROR_YN,'N') != 'Y' ORDER BY D.TEST_OBSERV_DT_TM DESC,B.FIELD_OR_TEMPLATE_MNEMONIC ");//AND D.PATIENT_CLASS=? removed for SKR-SCF-1243
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT3", "SELECT ROUND(0.007184 * POWER(?,0.725) * POWER(?,0.425),2) FROM DUAL ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT4", "SELECT PRESELECT_ORDER_TYPE_CODE_YN FROM OR_PARAM_BY_CATEGORY_PTCL WHERE ORDER_CATEGORY='PH' AND PATIENT_CLASS=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT5", "SELECT ORDER_TYPE_CODE,SHORT_DESC FROM OR_ORDER_TYPE WHERE EFF_STATUS='E' AND ORDER_CATEGORY='PH' ORDER BY 2");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT6", "SELECT to_char(SYSDATE,'dd/mm/yyyy hh24:mi') SYS_DATE_TIME,to_char(SYSDATE,'dd/mm/rrrr') SYS_DATE, to_char(DECODE(SUBSTR(PLACE_ORDER_EXPIRY_RULE,1,1),'H',to_date(?,'dd/mm/rrrr hh24:mi')+((1/(24*60*60))*3600*PLACE_ORDER_EXPIRY_PERIOD),'D',to_date(?,'dd/mm/rrrr hh24:mi')+PLACE_ORDER_EXPIRY_PERIOD),'dd/mm/rrrr hh24:mi') CALCULATED_DATE FROM OR_PARAM_BY_CATEGORY_PTCL WHERE ORDER_CATEGORY='PH' AND PATIENT_CLASS=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT7", "SELECT TO_CHAR(VISIT_ADM_DATE_TIME,'DD/MM/YYYY HH24:MI') VISIT_DATE_TIME FROM PR_ENCOUNTER WHERE ENCOUNTER_ID=? AND FACILITY_ID=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT8","SELECT TO_CHAR(( to_date(?,'dd/mm/yyyy hh24:mi') + nvl(order_future_hrs_ahead/24,0)),'dd/mm/yyyy hh24:mi')  FUTURE_DATE,	TO_CHAR((to_date(?,'dd/mm/yyyy hh24:mi') - nvl(ORDER_BACKDATE_HRS_BEHIND/24,0)),'dd/mm/yyyy hh24:mi')  BACK_DATE FROM or_param");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT9", "SELECT PRESELECT_ORDER_TYPE_CODE_YN  FROM OR_PARAM_BY_CATEGORY_PTCL WHERE ORDER_CATEGORY='PH' AND PATIENT_CLASS=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT9B", "SELECT PRESEL_ORDER_CATEGORY_YN, PRESEL_ORDER_TYPE_CODE_YN FROM OR_PARAM");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT10", "SELECT ORDER_TYPE_CODE,SHORT_DESC  FROM OR_ORDER_TYPE_LANG_VW OR_ORDER_TYPE WHERE EFF_STATUS='E' AND ORDER_CATEGORY='PH' AND LANGUAGE_ID = ? ORDER BY 2 ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT10C", "SELECT SHORT_DESC  FROM OR_ORDER_TYPE_LANG_VW OR_ORDER_TYPE WHERE ORDER_TYPE_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT11", "SELECT COUNT(ROWID) FROM IP_DISCHARGE_ADVICE WHERE ENCOUNTER_ID=? AND FACILITY_ID=? AND DIS_ADV_STATUS in('0','1') ");
		//dataMap.put("SQL_PH_PRESCRIPTION_SELECT12", "SELECT COUNT(B.ROWID) FROM PH_DRUG A,PR_ALLERGY B WHERE A.DRUG_CODE=? AND A.GENERIC_ID=B.GENERIC_CODE AND B.PATIENT_ID=? AND B.ALLERGY_CLASS='D' ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT13", "SELECT COUNT(A.ROWID) FROM PH_PATIENT_DRUG_PROFILE A WHERE A.CANCEL_YN = 'N' AND A.DISCONT_DATE_TIME IS NULL AND  A.ON_HOLD_DATE_TIME IS NULL AND A.STOP_YN='N' AND A.PATIENT_ID=? AND A.GENERIC_ID=? AND (TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN START_DATE AND END_DATE OR TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN START_DATE AND END_DATE OR START_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR END_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI'))  ");//Changed for ML-BRU-SCF-0811 [IN:039394] 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT13B","SELECT COUNT(ROWID) FROM PH_PATIENT_DRUG_PROFILE WHERE (CANCEL_YN = 'Y' or DISCONT_DATE_TIME IS not NULL or ON_HOLD_DATE_TIME IS not NULL or STOP_YN='Y') AND PATIENT_ID=? AND GENERIC_ID=? AND TO_DATE(A.END_DATE,'DD/MM/YYYY HH24:MI') >= TO_DATE(SYSDATE,'DD/MM/YYYY HH24:MI') AND  TO_DATE(SYSDATE,'DD/MM/RRRR HH24:MI') BETWEEN  TO_DATE(A.START_DATE,'DD/MM/RRRR HH24:MI') AND  TO_DATE(A.END_DATE,'DD/MM/RRRR HH24:MI')");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT13C","SELECT  COUNT(ROWID) FROM  PH_PATIENT_DRUG_PROFILE A WHERE   PATIENT_ID =?  AND  (TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  START_DATE AND  END_DATE OR TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  START_DATE AND  END_DATE OR  START_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI') OR  END_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI')) AND DISCONT_DATE_TIME IS NULL AND ON_HOLD_DATE_TIME IS NULL AND  CANCEL_YN='N' AND   STOP_YN='N' AND 'O'!=(SELECT FREQ_NATURE FROM AM_FREQUENCY WHERE FREQ_CODE=?) AND GENERIC_ID=? ");//Changed for ML-BRU-SCF-0811 [IN:039394] 	
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT13D","SELECT  COUNT(a.ROWID) FROM  PH_PATIENT_DRUG_PROFILE A, or_order ord WHERE a.PATIENT_ID =? and a.orig_order_id = ord.order_id and a.patient_id = ord.patient_id AND  (TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  START_DATE AND  END_DATE OR TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  START_DATE AND  END_DATE OR  START_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI') OR  END_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI')) AND DISCONT_DATE_TIME IS NULL AND ON_HOLD_DATE_TIME IS NULL AND  CANCEL_YN='N' AND   STOP_YN='N' AND 'O'!=(SELECT FREQ_NATURE FROM AM_FREQUENCY WHERE FREQ_CODE=?) AND GENERIC_ID=? and ORD.TRN_GROUP_REF <>? ");//Added for MMS_BETA_0052 [IN:046303]
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT14", "SELECT ORD_AUTH_REQD_YN,ORD_SPL_APPR_REQD_YN,QTY_VALUE,DURN_VALUE from OR_ORDER_CATALOG_BY_PTCL WHERE ORDER_CATALOG_CODE=? AND PATIENT_CLASS IN ('*A',?) AND ROWNUM <=1");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT15", "SELECT QTY_UOM FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT16", "SELECT FREQ_CODE,FREQ_DESC FROM AM_FREQUENCY WHERE EFF_STATUS='E' AND FREQ_NATURE<>'C' ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT17", "SELECT FREQ_CODE,PATIENT_CLASS FROM OR_ORDER_CATALOG_BY_PTCL A WHERE ORDER_CATALOG_CODE=?  AND PATIENT_CLASS IN ('*A',?) AND ROWNUM <=1");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT18", "SELECT REPEAT_DURN_TYPE,SCHEDULED_YN FROM AM_FREQUENCY WHERE FREQ_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT19", "SELECT DURN_TYPE,DURN_DESC FROM AM_DURATION_TYPE");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT20", "SELECT MAX_DURN_VALUE,MAX_DURN_TYPE, CHK_FOR_MAX_DURN_ACTION, PROMPT_MSG FROM OR_ORDER_CATALOG_BY_PTCL WHERE ORDER_CATALOG_CODE=? AND PATIENT_CLASS=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT21", "SELECT FREQ_CODE, FREQ_NATURE,REPEAT_VALUE, REPEAT_DURN_TYPE, INTERVAL_VALUE,INTERVAL_DURN_TYPE,DECODE(FREQ_NATURE,'F',(CASE WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (24/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='M' AND REPEAT_DURN_TYPE ='M' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE =1 THEN REPEAT_VALUE WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (0) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (0)  END),'I',(CASE WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (24/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='M' AND REPEAT_DURN_TYPE ='M' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE =1 THEN REPEAT_VALUE WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (0) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (0)  END)) FREQ_VALUE FROM AM_FREQUENCY WHERE FREQ_CODE =? GROUP BY FREQ_CODE, FREQ_NATURE,REPEAT_VALUE, REPEAT_DURN_TYPE, INTERVAL_VALUE, INTERVAL_DURN_TYPE");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT22", "SELECT DRUG_CLASS FROM PH_ORDER_TYPE_FOR_DRUG_CLASS WHERE ORDER_TYPE_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT23", "SELECT A.RTN_ORD_DISP_LOCN_CODE,B.SHORT_DESC RTN_ORD_DISP_LOCN_DESC,A.STAT_ORD_DISP_LOCN_CODE,C.SHORT_DESC STAT_ORD_DISP_LOCN_DESC,A.DISCH_ORD_DISP_LOCN_CODE,D.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC FROM PH_ORDER_ROUTING_DTL A, PH_DISP_LOCN B, PH_DISP_LOCN C, PH_DISP_LOCN D WHERE A.ORDERING_FACILITY_ID=? AND A.ORDERING_SOURCE_TYPE=? AND (A.ORDERING_SOURCE_CODE=?  OR A.ORDERING_SOURCE_CODE='*A')AND A.ROUTING_LEVEL='G' AND A.ROUTING_CODE=? AND A.ORDERING_FACILITY_ID=B.FACILITY_ID AND A.RTN_ORD_DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=C.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=C.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=D.FACILITY_ID(+) AND A.DISCH_ORD_DISP_LOCN_CODE=D.DISP_LOCN_CODE(+) ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT24", "SELECT A.RTN_ORD_DISP_LOCN_CODE, B.SHORT_DESC RTN_ORD_DISP_LOCN_DESC,A.STAT_ORD_DISP_LOCN_CODE, C.SHORT_DESC STAT_ORD_DISP_LOCN_DESC,A.DISCH_ORD_DISP_LOCN_CODE,D.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC FROM PH_ORDER_ROUTING_DTL A, PH_DISP_LOCN B, PH_DISP_LOCN C, PH_DISP_LOCN D WHERE A.ORDERING_FACILITY_ID=? AND A.ORDERING_SOURCE_TYPE=? AND (A.ORDERING_SOURCE_CODE=?  OR A.ORDERING_SOURCE_CODE='*A') AND A.ROUTING_LEVEL='O' AND A.ROUTING_CODE=? AND A.ORDERING_FACILITY_ID=B.FACILITY_ID AND A.RTN_ORD_DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=C.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=C.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=D.FACILITY_ID(+) AND A.DISCH_ORD_DISP_LOCN_CODE=D.DISP_LOCN_CODE(+)  ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT25", "SELECT A.RTN_ORD_DISP_LOCN_CODE,B.SHORT_DESC RTN_ORD_DISP_LOCN_DESC, A.STAT_ORD_DISP_LOCN_CODE,C.SHORT_DESC STAT_ORD_DISP_LOCN_DESC, A.DISCH_ORD_DISP_LOCN_CODE,D.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC FROM PH_ORDER_ROUTING_DTL A, PH_DISP_LOCN B, PH_DISP_LOCN C, PH_DISP_LOCN D WHERE A.ORDERING_FACILITY_ID=? AND A.ORDERING_SOURCE_TYPE=? AND (A.ORDERING_SOURCE_CODE=?  OR A.ORDERING_SOURCE_CODE='*A') AND A.ROUTING_LEVEL='D' AND A.ROUTING_CODE=? AND A.ORDERING_FACILITY_ID=B.FACILITY_ID AND A.RTN_ORD_DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=C.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=C.DISP_LOCN_CODE AND A.ORDERING_FACILITY_ID=D.FACILITY_ID(+) AND A.DISCH_ORD_DISP_LOCN_CODE=D.DISP_LOCN_CODE(+) ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT26", "SELECT A.ORDERING_SOURCE_CODE,(CASE WHEN A.ORDERING_SOURCE_TYPE=? THEN C.SHORT_DESC ELSE B.SHORT_DESC END) ORDERING_SOURCE_DESC FROM PH_ORDER_ROUTING A, IP_NURSING_UNIT B, OP_CLINIC C WHERE A.ORDERING_FACILITY_ID=? AND A.ORDERING_FACILITY_ID=B.FACILITY_ID(+) AND A.ORDERING_SOURCE_CODE=B.NURSING_UNIT_CODE(+) AND A.ORDERING_FACILITY_ID=C.FACILITY_ID(+) AND A.ORDERING_SOURCE_CODE=C.CLINIC_CODE(+) AND A.ORDERING_SOURCE_TYPE=?  AND A.ORDERING_SOURCE_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT27", "SELECT A.OP_DISP_LOCN_RTN_ORD RTN_ORD_DISP_LOCN_CODE,B.SHORT_DESC RTN_ORD_DISP_LOCN_DESC, A.OP_DISP_LOCN_STAT_ORD STAT_ORD_DISP_LOCN_CODE,C.SHORT_DESC STAT_ORD_DISP_LOCN_DESC FROM PH_FACILITY_PARAM A, PH_DISP_LOCN_LANG_VW B, PH_DISP_LOCN_LANG_VW C WHERE A.FACILITY_ID=B.FACILITY_ID(+) AND A.OP_DISP_LOCN_RTN_ORD=B.DISP_LOCN_CODE(+) AND A.FACILITY_ID=C.FACILITY_ID(+) AND A.OP_DISP_LOCN_STAT_ORD=C.DISP_LOCN_CODE(+) AND A.FACILITY_ID=? AND B.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT28", "SELECT A.IP_DISP_LOCN_RTN_ORD RTN_ORD_DISP_LOCN_CODE,B.SHORT_DESC RTN_ORD_DISP_LOCN_DESC, A.IP_DISP_LOCN_STAT_ORD STAT_ORD_DISP_LOCN_CODE,C.SHORT_DESC STAT_ORD_DISP_LOCN_DESC, A.DISCH_MED_DISP_LOCN DISCH_ORD_DISP_LOCN_CODE,D.SHORT_DESC DISCH_ORD_DISP_LOCN_DESC FROM PH_FACILITY_PARAM A, PH_DISP_LOCN B, PH_DISP_LOCN C, PH_DISP_LOCN D WHERE A.FACILITY_ID=B.FACILITY_ID(+) AND A.IP_DISP_LOCN_RTN_ORD=B.DISP_LOCN_CODE(+) AND A.FACILITY_ID=C.FACILITY_ID(+) AND A.IP_DISP_LOCN_STAT_ORD=C.DISP_LOCN_CODE(+) AND A.FACILITY_ID=D.FACILITY_ID(+) AND A.DISCH_MED_DISP_LOCN=D.DISP_LOCN_CODE(+) AND A.FACILITY_ID=? ");
		//dataMap.put("SQL_PH_PRESCRIPTION_SELECT29", "SELECT TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?) WHEN 'W' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?)*7 WHEN 'L' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?)*30 END), 'DD/MM/RRRR HH24:MI') CONV_DATE FROM DUAL"); // Unused SQL 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT30","SELECT TO_CHAR((CASE WHEN 'D' = ? AND ROWNUM = 1 THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+0*ROWNUM WHEN 'D' = ? AND ROWNUM > 1 THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+(TO_NUMBER(?))*(ROWNUM-1)+0 WHEN 'W' = ? AND ROWNUM = 1 THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+0*ROWNUM WHEN 'W' = ? AND ROWNUM > 1 THEN (TO_DATE(?, 'dd/mm/yyyy 	hh24:mi'))+((TO_NUMBER(?)*7))*(ROWNUM-1)+1 WHEN 'L' = ? AND ROWNUM = 1 THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+0*ROWNUM WHEN 'L' = ? AND ROWNUM > 1 THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) +((TO_NUMBER(?)*30))*(ROWNUM-1)+1 END), 'dd/mm/yyyy hh24:mi') START_DATE , TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+((TO_NUMBER(?))*ROWNUM)WHEN 'W' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+(((TO_NUMBER(?)*7))*ROWNUM) WHEN 'L' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+(((TO_NUMBER(?)*30))*ROWNUM) END), 'dd/mm/yyyy hh24:mi') END_DATE FROM SM_FUNCTION WHERE ROWNUM <= TO_NUMBER(?)");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT31", "SELECT REFILL_YN,MAX_REFILLS_FOR_PRES FROM PH_FACILITY_PARAM WHERE FACILITY_ID=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT32", "SELECT REFILL_CONT_ORDER_YN FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE =? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT33", "SELECT ORDER_CATALOG_CODE FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE =? AND EFF_STATUS='E' ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT34", "SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY A, OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND (A.REPEAT_DURN_TYPE='D' OR A.INTERVAL_DURN_TYPE='D') AND  A.FREQ_NATURE<>'C' AND A.FREQ_CODE = B.FREQ_CODE AND B.ORDER_CATEGORY = (CASE WHEN A.FREQ_CODE <> ? THEN 'PH' ELSE B.ORDER_CATEGORY END) AND B.FREQ_SCOPE_YN = (CASE WHEN A.FREQ_CODE <> ? THEN 'Y' ELSE B.FREQ_SCOPE_YN END) ORDER BY 2");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT35", "SELECT TAPER_DOSE_YN FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=? AND EFF_STATUS='E' ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT36", "SELECT ORDER_TYPE_CODE,ORD_AUTH_LEVEL  FROM  or_order_catalog WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT37", "SELECT OR_ORDER_ID_GENERATION (?,?,?) order_id FROM DUAL "); //thrid parameter for facility added for IN[032925]
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT38", "SELECT  TO_CHAR((TO_DATE(?, 'dd/mm/yyyy hh24:mi')),'dd/mm/yyyy hh24:mi') START_DATE,TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) + TO_NUMBER(?)  WHEN 'W' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) + (TO_NUMBER(?)*7)  WHEN 'L' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) + (TO_NUMBER(?)*30) END), 'dd/mm/yyyy hh24:mi') END_DATE FROM DUAL ");//reverted for IN071727
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT39","SELECT TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) WHEN 'W' = ? THEN (TO_DATE(?,'dd/mm/yyyy hh24:mi')) WHEN 'L' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) END),'dd/mm/yyyy hh24:mi') START_DATE ,TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+((TO_NUMBER(?))*?) WHEN 'W' = ? THEN (TO_DATE(?,'dd/mm/yyyy hh24:mi'))+(((TO_NUMBER(?)*7))*?) WHEN 'L' =? THEN (TO_DATE(?,'dd/mm/yyyy hh24:mi')) +(((TO_NUMBER(?)*30))*?) END),'dd/mm/yyyy hh24:mi') END_DATE FROM DUAL");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT40", "SELECT (CASE WHEN((TO_CHAR(?,'DD/MM/RRRR') >= TO_CHAR(START_DATE,'DD/MM/RRRR')) AND (TO_CHAR(?,'DD/MM/RRRR') <= TO_CHAR(END_DATE,'DD/MM/RRRR'))) THEN 'Y' ELSE 'N' END ) DATE_RANGE_IN_LIMIT FROM PH_PATIENT_DRUG_PROFILE WHERE CANCEL_YN = 'N' AND PATIENT_ID = ? AND   GENERIC_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT41", "SELECT LONG_DESC FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE FACILITY_ID = ? AND NURSING_UNIT_CODE =? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT42", "SELECT LONG_DESC FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE FACILITY_ID = ? AND CLINIC_CODE = ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT43", "SELECT DECODE(?,'en',PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,PATIENT_NAME)) PATIENT_NAME,DECODE(SEX,'M','male','F','female','U','unknown')SEX,GET_AGE(DATE_OF_BIRTH) AGE, to_char(DATE_OF_BIRTH,'dd/mm/yyyy') DATE_OF_BIRTH FROM MP_PATIENT WHERE PATIENT_ID = ?");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT43B", "SELECT PATIENT_NAME,SEX,NATIONALITY_CODE  FROM MP_PATIENT WHERE PATIENT_ID = ?");
        
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT43A", "SELECT PATIENT_NAME,DECODE(SEX,'M','male','F','female','U','unknown')SEX,ROUND( TO_DATE(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy') - TO_DATE(to_char(date_of_birth,'dd/mm/yyyy'),'dd/mm/yyyy')) AGE, Round(( TO_DATE (TO_CHAR (SYSDATE, 'dd/mm/yyyy hh24:mi'), 'dd/mm/yyyy hh24:mi') - TO_DATE (TO_CHAR (date_of_birth, 'dd/mm/yyyy hh24:mi'), 'dd/mm/yyyy hh24:mi'))*24*60) age_in_mints FROM MP_PATIENT WHERE PATIENT_ID = ?");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT44", "SELECT B.SCHEDULED_YN,A.ORDER_CATALOG_CODE,A.FREQ_CODE,B.REPEAT_VALUE,B.REPEAT_DURN_TYPE,B.INTERVAL_VALUE, B.INTERVAL_DURN_TYPE FROM OR_ORDER_CATALOG_BY_PTCL A, AM_FREQUENCY B WHERE A.FREQ_CODE=B.FREQ_CODE(+) AND A.ORDER_CATALOG_CODE=? AND A.FREQ_CODE=? AND (A.PATIENT_CLASS=? OR A.PATIENT_CLASS='*A')");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT45", "SELECT DRUG_DESC,CONTENT_IN_PRES_BASE_UOM FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE DRUG_CODE=? AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT46", "SELECT OR_GET_FORMAT_ID(?,?,?) FORMAT_ID FROM DUAL");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT47", "SELECT DISTINCT 'X'  FROM or_review_user_categories WHERE order_category = 'PH'  and (practitioner_id = ? or resp_id = ?)");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT48", "SELECT A.REMARK_CODE   REMARK_CODE, B.REMARK_DESC  REMARK_DESC, A.DEFAULT_REMARK_YN   FROM PH_PRES_REMARK_FOR_DRUG A, PH_PRES_REMARK_LANG_VW B WHERE A.DRUG_CODE = ?   AND A.REMARK_CODE = B.REMARK_CODE   AND B.FORM_CODE = NVL(?, B.FORM_CODE)   AND B.ROUTE_CODE = NVL(?, B.ROUTE_CODE)   AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT49", "SELECT REMARK_CODE,REMARK_DESC FROM PH_PRES_REMARK_LANG_VW PH_PRES_REMARK WHERE FORM_CODE IS NULL OR ROUTE_CODE IS NULL AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT50", "SELECT DISTINCT AUTH_YN FROM or_review_user_categories WHERE order_category ='PH' and (practitioner_id = ? or resp_id = ?) AND  AUTH_YN='Y' ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT50A", "SELECT DISTINCT SPL_APPR_YN FROM or_review_user_categories WHERE order_category ='PH' and (practitioner_id = ? or resp_id = ?) AND  SPL_APPR_YN='Y' ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT50B", "SELECT DISTINCT COSIGN_YN FROM or_review_user_categories WHERE order_category ='PH' and (practitioner_id = ? or resp_id = ?) AND COSIGN_YN='Y' ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT51", "SELECT  /*+ INDEX(a ph_patient_drug_profile_pk)*/ A.DISCONT_DATE_TIME, A.PATIENT_ID,  A.ALLERGY_OVERRIDE_REASON,  A.DOSAGE_LIMIT_OVERRIDE_REASON,  A.DUPLICATE_DRUG_OVERRIDE_REASON,  A.ORIG_ORDER_ID,  A.ORIG_ORDER_LINE_NO, A.DOSAGE, A.DOSAGE_UOM_CODE, A.SPLIT_DOSE_PREVIEW,  A.FREQ_CODE,  G.FREQ_DESC,  A.PRES_PRACTITIONER_ID,  B.PRACTITIONER_NAME,  H.DISCHARGE_IND,A.DRUG_CODE,  C.DRUG_DESC,  C.IN_FORMULARY_YN, A.STRENGTH,  C.STRENGTH_UOM,  C.FORM_CODE,  TO_CHAR(A.START_DATE,  'DD/MM/YYYY hh24:mi') START_DATE,  TO_CHAR(A.END_DATE,  'DD/MM/YYYY hh24:mi') END_DATE,  A.DOSAGE,  A.DOSAGE_UOM_CODE,  A.PRESCRIBED_QTY,  A.DIAG_TEXT,  D.FACILITY_NAME,  A.PATIENT_CLASS,  DECODE( A.PATIENT_CLASS,  'IP',  F.LONG_DESC,  'EA',  F.LONG_DESC,  E.LONG_DESC ) LOCATION,I.SHORT_DESC PERF_LOCN,H.IV_PREP_YN FROM   PH_PATIENT_DRUG_PROFILE A ,  AM_PRACTITIONER_LANG_VW B  ,  SM_FACILITY_PARAM_LANG_VW D,  OP_CLINIC_LANG_VW E,  IP_NURSING_UNIT_LANG_VW F,  PH_DRUG_LANG_VW C,   AM_FREQUENCY_LANG_VW G, OR_ORDER H,  PH_DISP_LOCN_LANG_VW I WHERE   A.PATIENT_ID =? AND   A.PRES_PRACTITIONER_ID = B.PRACTITIONER_ID(+) AND   A.FACILITY_ID = D.FACILITY_ID  AND   A.FACILITY_ID = E.FACILITY_ID (+) AND  A.LOCN_CODE = E.CLINIC_CODE(+) AND   A.FACILITY_ID = F.FACILITY_ID (+) AND   A.LOCN_CODE = F.NURSING_UNIT_CODE(+) AND   A.DRUG_CODE = C.DRUG_CODE  AND   A.FREQ_CODE=G.FREQ_CODE AND    A.ORIG_ORDER_ID= H.ORDER_ID AND I.DISP_LOCN_CODE = H.PERFORMING_DEPTLOC_CODE AND A.PATIENT_ID=H.PATIENT_ID AND to_date(A.END_DATE,'dd/mm/yyyy hh24:mi') >= to_date(SYSDATE,'dd/mm/yyyy hh24:mi') AND  TO_DATE(SYSDATE,'DD/MM/RRRR HH24:MI') BETWEEN  TO_DATE(A.START_DATE,'DD/MM/RRRR HH24:MI') AND  TO_DATE(A.END_DATE,'DD/MM/RRRR HH24:MI')   AND A.DISCONT_DATE_TIME IS NULL AND   A.ON_HOLD_DATE_TIME IS NULL AND   A.CANCEL_YN='N' AND   A.STOP_YN='N' AND H.ORDER_TYPE_CODE !='MS' AND D.LANGUAGE_ID = C.LANGUAGE_ID AND D.LANGUAGE_ID = G.LANGUAGE_ID AND D.LANGUAGE_ID = I.LANGUAGE_ID AND D.LANGUAGE_ID = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ? AND B.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT51A", "SELECT  A.DISCONT_DATE_TIME, A.PATIENT_ID,  A.ALLERGY_OVERRIDE_REASON,  A.DOSAGE_LIMIT_OVERRIDE_REASON,  A.DUPLICATE_DRUG_OVERRIDE_REASON,  A.ORIG_ORDER_ID,  A.ORIG_ORDER_LINE_NO,  C.IN_FORMULARY_YN,A.DOSAGE, A.DOSAGE_UOM_CODE, A.SPLIT_DOSE_PREVIEW,  A.FREQ_CODE,  G.FREQ_DESC,  A.PRES_PRACTITIONER_ID,  B.PRACTITIONER_NAME,  H.DISCHARGE_IND,A.DRUG_CODE,  C.DRUG_DESC,  A.STRENGTH,  C.STRENGTH_UOM,  C.FORM_CODE,  TO_CHAR(A.START_DATE,  'DD/MM/YYYY hh24:mi') START_DATE,  TO_CHAR(A.END_DATE,  'DD/MM/YYYY hh24:mi') END_DATE,  A.DOSAGE,  A.DOSAGE_UOM_CODE,  A.PRESCRIBED_QTY,  A.DIAG_TEXT,  D.FACILITY_NAME,  A.PATIENT_CLASS,  DECODE( A.PATIENT_CLASS,  'IP',  F.LONG_DESC,  'EA',  F.LONG_DESC,  E.LONG_DESC ) LOCATION,H.IV_PREP_YN FROM   PH_PATIENT_DRUG_PROFILE A ,  AM_PRACTITIONER_LANG_VW B  ,  SM_FACILITY_PARAM_LANG_VW D,  OP_CLINIC_LANG_VW E,  IP_NURSING_UNIT_LANG_VW F,  PH_DRUG_LANG_VW C,   AM_FREQUENCY_LANG_VW G, OR_ORDER H  WHERE   A.PATIENT_ID =? AND   A.PRES_PRACTITIONER_ID = B.PRACTITIONER_ID(+) AND   A.FACILITY_ID = D.FACILITY_ID  AND   A.FACILITY_ID = E.FACILITY_ID (+) AND  A.LOCN_CODE = E.CLINIC_CODE(+) AND   A.FACILITY_ID = F.FACILITY_ID (+) AND   A.LOCN_CODE = F.NURSING_UNIT_CODE(+) AND   A.DRUG_CODE = C.DRUG_CODE  AND   A.FREQ_CODE=G.FREQ_CODE AND    A.ORIG_ORDER_ID= H.ORDER_ID AND  A.PATIENT_ID=H.PATIENT_ID AND to_date(A.END_DATE,'dd/mm/yyyy hh24:mi') >= to_date(SYSDATE,'dd/mm/yyyy hh24:mi') AND  TO_DATE(SYSDATE,'DD/MM/RRRR HH24:MI') BETWEEN  TO_DATE(A.START_DATE,'DD/MM/RRRR HH24:MI') AND  TO_DATE(A.END_DATE,'DD/MM/RRRR HH24:MI')   AND A.DISCONT_DATE_TIME IS NULL AND   A.ON_HOLD_DATE_TIME IS NULL AND   A.CANCEL_YN='N' AND   A.STOP_YN='N' AND H.ORDER_TYPE_CODE !='MS' AND C.LANGUAGE_ID = D.LANGUAGE_ID  AND C.LANGUAGE_ID = G.LANGUAGE_ID AND C.LANGUAGE_ID = ? AND B.LANGUAGE_ID(+) = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT52", "SELECT B.UOM_CODE, A.SHORT_DESC FROM AM_UOM A,  PH_UOM_FOR_FORM B,AM_UOM_EQVL C WHERE A.DOSAGE_UOM_YN='Y' AND A.EFF_STATUS='E' AND A.UOM_CODE=B.UOM_CODE AND A.UOM_CODE = C.UOM_CODE AND B.FORM_CODE=? ORDER BY 2");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT53", "SELECT nvl(EQVL_VALUE,'1') EQVL_VALUE FROM AM_UOM_EQVL WHERE (UOM_CODE =? AND EQVL_UOM_CODE =?) OR (EQVL_UOM_CODE =? AND UOM_CODE = ? )");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT54A", "SELECT TO_CHAR (SYSDATE, 'dd/mm/yyyy hh24:mi') sys_date_time, TO_CHAR (SYSDATE, 'dd/mm/yyyy') sys_date, TO_CHAR (SYSDATE-(SELECT nvl(COPY_PRES_UPTO_NO_OF_DAYS,0) FROM PH_FACILITY_PARAM where facility_id=?), 'dd/mm/yyyy') back_date, TO_CHAR (SYSDATE, 'dd/mm/yyyy hh24:mi:ss') sys_date_time_sec  FROM DUAL");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT54", "SELECT to_char(SYSDATE,'dd/mm/yyyy hh24:mi') SYS_DATE_TIME, to_char(SYSDATE,'dd/mm/yyyy') SYS_DATE, to_char(ADD_MONTHS(SYSDATE,-3),'dd/mm/yyyy') BACK_DATE,to_char(SYSDATE,'dd/mm/yyyy hh24:mi:ss') SYS_DATE_TIME_SEC, to_char(systimestamp,'dd/mm/yyyy hh24:mi:ss.FF6') SYS_DATE_TIME_MSEC from dual");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT55", "SELECT NVL(MAX(SRL_NO) + 1,1) NEXT_SRL_NO FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID= ? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT56", "SELECT NVL(MAX(ACTION_SEQ_NUM) + 1,1) NEXT_ACTION_SEQ_NUM FROM OR_ORDER_COMMENT WHERE ORDER_ID= ? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT56A", "SELECT NVL(MAX(ACTION_SEQ_NUM),1) NEXT_ACTION_SEQ_NUM FROM OR_ORDER_COMMENT WHERE ORDER_ID= ? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT57", "SELECT ORDER_COMMENT FROM OR_ORDER_COMMENT WHERE ORDER_ID =? AND ACTION_SEQ_NUM = ? FOR UPDATE ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT58","select * from (SELECT   a.adv_reac_code allergy_type_code, b.long_desc allergic_indications, a.SEVERITY,  TO_CHAR (reaction_date, 'DD/MM/YYYY') reac_date,reaction_date, D.ALLERGY_ALERT_BY, D.CAUSATIVE_SUBSTANCE FROM pr_adverse_event_reaction a,  am_reaction_lang_vw b,pr_allergy_sensitivity C, pr_adverse_event D WHERE a.adv_event_type in ('DA','AD')  AND a.allergen_code=?  AND a.patient_id = ? AND a.adv_reac_code <> 'Oth' AND b.reaction_code(+) = a.adv_reac_code  AND b.language_id(+) =? and a.STATUS = 'A' AND A.PATIENT_ID=C.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=C.ADV_EVENT_TYPE_IND AND A.ADV_EVENT_TYPE =C.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =C.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=C.ADV_EVENT_SRL_NO AND C.STATUS = 'A' AND A.PATIENT_ID=D.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=D.ADV_EVENT_TYPE_IND AND A.ADV_EVENT_TYPE =D.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =D.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=D.ADV_EVENT_SRL_NO union ALL SELECT adv_reac_code allergy_type_code, OTHERS_REACTION allergic_indications, a.SEVERITY, TO_CHAR (reaction_date, 'DD/MM/YYYY') reac_date,reaction_date, D.ALLERGY_ALERT_BY, D.CAUSATIVE_SUBSTANCE FROM pr_adverse_event_reaction a ,pr_allergy_sensitivity C, pr_adverse_event D WHERE a.adv_event_type = 'DA'  AND a.allergen_code=? AND a.patient_id = ?  AND a.adv_reac_code  ='Oth'and a.STATUS = 'A' AND A.PATIENT_ID=C.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=C.ADV_EVENT_TYPE_IND AND A.ADV_EVENT_TYPE =C.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =C.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=C.ADV_EVENT_SRL_NO AND C.STATUS = 'A' AND A.PATIENT_ID=D.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=D.ADV_EVENT_TYPE_IND AND A.ADV_EVENT_TYPE =D.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =D.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=D.ADV_EVENT_SRL_NO)  ORDER BY reaction_date DESC");// Changed for RUT-CRF-0065.1 [IN:43255]
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT59","SELECT A.PATIENT_ID,A.ALLERGY_OVERRIDE_REASON, A.DOSAGE_LIMIT_OVERRIDE_REASON, A.DUPLICATE_DRUG_OVERRIDE_REASON, A.ORIG_ORDER_ID, A.ORIG_ORDER_LINE_NO,A.SPLIT_DOSE_PREVIEW,A.FREQ_CODE,G.FREQ_DESC,A.PRES_PRACTITIONER_ID,B.PRACTITIONER_NAME,A.DRUG_CODE,C.DRUG_DESC,A.STRENGTH, C.STRENGTH_UOM, C.FORM_CODE,TO_CHAR(A.START_DATE,'DD/MM/YYYY hh24:mi') START_DATE, TO_CHAR(A.END_DATE,'DD/MM/YYYY hh24:mi') END_DATE,A.DOSAGE, A.DOSAGE_UOM_CODE, A.PRESCRIBED_QTY,A.DIAG_TEXT,D.FACILITY_NAME,A.PATIENT_CLASS,DECODE(H.ASSIGN_CARE_LOCN_TYPE, 'N',   F.LONG_DESC, 'C',E.LONG_DESC) LOCATION FROM PH_PATIENT_DRUG_PROFILE A ,AM_PRACTITIONER_LANG_VW B  ,SM_FACILITY_PARAM_LANG_VW D, OP_CLINIC_LANG_VW E, IP_NURSING_UNIT_LANG_VW F, PH_DRUG_LANG_VW C,AM_FREQUENCY_LANG_VW G,PR_ENCOUNTER H WHERE A.PATIENT_ID =? AND A.GENERIC_ID=? AND A.PRES_PRACTITIONER_ID = B.PRACTITIONER_ID AND A.FACILITY_ID = D.FACILITY_ID  AND A.FACILITY_ID = E.FACILITY_ID (+) AND A.LOCN_CODE = E.CLINIC_CODE(+) AND A.FACILITY_ID = F.FACILITY_ID (+) AND A.LOCN_CODE = F.NURSING_UNIT_CODE(+) AND  A.DRUG_CODE = C.DRUG_CODE AND A.FREQ_CODE=G.FREQ_CODE  AND A.FACILITY_ID  = H.FACILITY_ID(+) AND A.ENCOUNTER_ID = H.ENCOUNTER_ID(+)  AND TRUNC(A.END_DATE) >= TRUNC(SYSDATE) AND  A.DISCONT_DATE_TIME IS NULL AND  A.ON_HOLD_DATE_TIME IS NULL AND A.CANCEL_YN='N'AND A.STOP_YN='N' AND B.LANGUAGE_ID = D.LANGUAGE_ID AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ? ORDER BY END_DATE DESC");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT59A","SELECT A.PATIENT_ID,A.ALLERGY_OVERRIDE_REASON, A.DOSAGE_LIMIT_OVERRIDE_REASON, A.DUPLICATE_DRUG_OVERRIDE_REASON, A.ORIG_ORDER_ID, A.ORIG_ORDER_LINE_NO,A.SPLIT_DOSE_PREVIEW,A.FREQ_CODE,G.FREQ_DESC,A.PRES_PRACTITIONER_ID,B.PRACTITIONER_NAME,A.DRUG_CODE,C.DRUG_DESC,A.STRENGTH, C.STRENGTH_UOM, C.FORM_CODE,TO_CHAR(A.START_DATE,'DD/MM/YYYY HH24:MI') START_DATE, TO_CHAR(A.END_DATE,'DD/MM/YYYY HH24:MI') END_DATE,A.DOSAGE, A.DOSAGE_UOM_CODE, A.PRESCRIBED_QTY,A.DIAG_TEXT,D.FACILITY_NAME,A.PATIENT_CLASS,DECODE(H.ASSIGN_CARE_LOCN_TYPE, 'N',   F.LONG_DESC, 'C',E.LONG_DESC) LOCATION, I.SHORT_DESC PERF_LOCN, K.FACILITY_NAME PER_FACILITY_NAME,J.IV_PREP_YN,l.sliding_scale_yn FROM PH_PATIENT_DRUG_PROFILE A ,AM_PRACTITIONER_LANG_VW B  ,SM_FACILITY_PARAM_LANG_VW D, OP_CLINIC_LANG_VW E, IP_NURSING_UNIT_LANG_VW F, PH_DRUG_LANG_VW C,AM_FREQUENCY_LANG_VW G,PR_ENCOUNTER H, PH_DISP_LOCN_LANG_VW I, OR_ORDER J, SM_FACILITY_PARAM_LANG_VW K ,or_order_line_ph l  WHERE A.PATIENT_ID =? AND A.GENERIC_ID=? AND A.PRES_PRACTITIONER_ID = B.PRACTITIONER_ID AND a.orig_order_id = l.order_id  and a.ORIG_ORDER_LINE_NO =l.ORDER_LINE_NUM AND A.FACILITY_ID = D.FACILITY_ID AND J.PERFORMING_FACILITY_ID = K.FACILITY_ID AND A.FACILITY_ID = E.FACILITY_ID (+) AND A.LOCN_CODE = E.CLINIC_CODE(+) AND A.FACILITY_ID = F.FACILITY_ID (+) AND A.LOCN_CODE = F.NURSING_UNIT_CODE(+) AND  A.DRUG_CODE = C.DRUG_CODE AND A.FREQ_CODE=G.FREQ_CODE  AND A.FACILITY_ID  = H.FACILITY_ID(+) AND A.ENCOUNTER_ID = H.ENCOUNTER_ID(+) AND TRUNC(A.END_DATE) >= TRUNC(SYSDATE) AND  A.DISCONT_DATE_TIME IS NULL AND  A.ON_HOLD_DATE_TIME IS NULL AND A.CANCEL_YN='N'AND A.STOP_YN='N'  AND B.LANGUAGE_ID = K.LANGUAGE_ID AND B.LANGUAGE_ID = D.LANGUAGE_ID AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ? AND A.ORIG_ORDER_ID = J.ORDER_ID AND I.DISP_LOCN_CODE = J.PERFORMING_DEPTLOC_CODE AND J.PERFORMING_FACILITY_ID = I.FACILITY_ID AND I.LANGUAGE_ID = ? ORDER BY END_DATE DESC");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT60","SELECT DIAG_TEXT FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=? AND ENCOUNTER_ID=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT61","SELECT ORDER_LINE_FIELD_VALUE, ORDER_LINE_DOSE_QTY_VALUE, ORDER_LINE_DOSE_QTY_UNIT, ORDER_LINE_FREQ_DAY FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? AND ORDER_LINE_FIELD_MNEMONIC='SCHED_ADMIN_TIME' AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT62","SELECT B.ORDER_LINE_NUM ORDER_LINE_NUM, Ph_Getlocn_Name(?,?,?,?) LOCN_DESC, A.PATIENT_NAME, A.PATIENT_ID, GET_AGE(A.DATE_OF_BIRTH) AGE, DECODE(A.SEX,'M','male','F','female','U','unknown') GENDER, B.ORDER_ID, TO_CHAR(B.ORD_DATE_TIME,'DD/MM/YYYY') ORD_DATE_TIME, I.FORM_CODE || ' ' || C.DRUG_DESC || ' ' || C.STRENGTH_VALUE || ' ' || C.STRENGTH_UOM FORM_DRUG, B.QTY_VALUE || ' ' || B.QTY_UNIT DOSAGE, J.ROUTE_DESC, DECODE((SELECT COUNT(*) FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? AND ORDER_LINE_NUM=B.ORDER_LINE_NUM AND ORDER_LINE_FIELD_MNEMONIC='SCHED_ADMIN_TIME'),0,d.freq_desc,d.freq_desc) FREQ_DESC, TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY hh24:mi') START_DATE_TIME, TO_CHAR(B.END_DATE_TIME,'DD/MM/YYYY hh24:mi') END_DATE_TIME, B.DURN_VALUE || ' ' || E.DURN_DESC DURATION,B.ORDER_QTY || ' ' ||  F.SHORT_DESC ORDER_QTY, DECODE(B.LINE_FIELDS_DISPLAY_TEXT, '', '', 'Instructions : ' || Ph_Replaceinstructions(B.LINE_FIELDS_DISPLAY_TEXT)) LINE_FIELDS_DISPLAY_TEXT,G.PRACTITIONER_NAME,PH_SPlITDOSE(?,B.ORDER_LINE_NUM) DOSAGE_DTLS,K.ALLERGY_OVERRIDE_REASON,K.DOSAGE_LIMIT_OVERRIDE_REASON,	K.DUPLICATE_DRUG_OVERRIDE_REASON, H.DISCHARGE_IND   FROM MP_PATIENT A, OR_ORDER_LINE B, PH_DRUG_LANG_VW C, AM_FREQUENCY_LANG_VW D, AM_DURATION_TYPE_LANG_VW E, AM_UOM_LANG_VW F, AM_PRACTITIONER_LANG_VW G, OR_ORDER H, PH_FORM_LANG_VW I, PH_ROUTE_LANG_VW J, OR_ORDER_LINE_PH K WHERE I.FORM_CODE=B.FORM_CODE AND J.ROUTE_CODE=B.ROUTE_CODE AND H.PATIENT_ID=A.PATIENT_ID AND H.ORDER_ID=B.ORDER_ID AND K.ORDER_ID=B.ORDER_ID AND K.ORDER_LINE_NUM=B.ORDER_LINE_NUM AND C.DRUG_CODE=B.ORDER_CATALOG_CODE AND B.FREQ_CODE=D.FREQ_CODE AND B.DURN_TYPE=E.DURN_TYPE AND B.ORD_PRACT_ID=G.PRACTITIONER_ID AND B.ORDER_UOM=F.UOM_CODE AND B.ORDER_ID=? AND B.ORDER_CATALOG_CODE like(?) AND B.ORDER_LINE_NUM like(?) AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = I.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID AND C.LANGUAGE_ID = J.LANGUAGE_ID AND C.LANGUAGE_ID = ?");
		//TOTAL_DAILY_FLUID,ENTERAL_FEEDING added for ML-MMOH-CRF-1013
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT62A","SELECT B.ORDER_LINE_NUM ORDER_LINE_NUM,Ph_Getlocn_Name(?,?,?,?) LOCN_DESC, A.PATIENT_NAME, A.PATIENT_ID, GET_AGE(A.DATE_OF_BIRTH) AGE, DECODE(A.SEX, 'M', 'male', 'F', 'female', 'U', 'unknown') GENDER, B.ORDER_ID, TO_CHAR(B.ORD_DATE_TIME, 'DD/MM/YYYY') ORD_DATE_TIME, c.LONG_NAME FORM_DRUG, B.QTY_VALUE || ' ' || B.QTY_UNIT DOSAGE, DECODE(C.DFLT_TPN_ROUTE, 'C','Central','Peripheral') ROUTE_DESC, DECODE((SELECT COUNT(*) FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? AND ORDER_LINE_NUM=B.ORDER_LINE_NUM AND ORDER_LINE_FIELD_MNEMONIC='SCHED_ADMIN_TIME'),0,d.freq_desc,d.freq_desc) FREQ_DESC, TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY hh24:mi') START_DATE_TIME, TO_CHAR(B.END_DATE_TIME,'DD/MM/YYYY hh24:mi') END_DATE_TIME, B.DURN_VALUE || ' ' || E.DURN_DESC DURATION, B.ORDER_QTY || ' ' || F.SHORT_DESC ORDER_QTY, DECODE(B.LINE_FIELDS_DISPLAY_TEXT, '', '', 'Instructions : ' || Ph_Replaceinstructions(B.LINE_FIELDS_DISPLAY_TEXT)) LINE_FIELDS_DISPLAY_TEXT, G.PRACTITIONER_NAME,PH_SPlITDOSE('',B.ORDER_LINE_NUM) DOSAGE_DTLS, K.ALLERGY_OVERRIDE_REASON,K.DOSAGE_LIMIT_OVERRIDE_REASON, K.DUPLICATE_DRUG_OVERRIDE_REASON, H.DISCHARGE_IND, h.iv_prep_yn,j.ROUTE_COLOR,K.ALTERNATE_AMEND_REASON,k.TOTAL_DAILY_FLUID, k.ENTERAL_FEEDING FROM MP_PATIENT A, OR_ORDER_LINE B, PH_TPN_REGIMEN_LANG_VW C, AM_UOM_LANG_VW F,OR_ORDER H, AM_FREQUENCY_LANG_VW D, AM_DURATION_TYPE_LANG_VW E, AM_PRACTITIONER_LANG_VW G, OR_ORDER_LINE_PH K ,PH_ROUTE_LANG_VW J WHERE C.TPN_REGIMEN_CODE=B.ORDER_CATALOG_CODE AND B.ORDER_ID=? AND B.ORDER_CATALOG_CODE=? AND H.PATIENT_ID=A.PATIENT_ID AND H.ORDER_ID=B.ORDER_ID AND K.ORDER_ID=B.ORDER_ID AND K.ORDER_LINE_NUM=B.ORDER_LINE_NUM AND B.ORD_PRACT_ID=G.PRACTITIONER_ID AND B.ORDER_UOM=F.UOM_CODE AND B.FREQ_CODE=D.FREQ_CODE AND B.DURN_TYPE=E.DURN_TYPE AND J.ROUTE_CODE=B.ROUTE_CODE AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = F.LANGUAGE_ID AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = G.LANGUAGE_ID AND C.LANGUAGE_ID = J.LANGUAGE_ID AND C.LANGUAGE_ID = ?" );//added K.ALTERNATE_AMEND_REASON forJD-CRF-0198[58599]
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT63","SELECT ceil(nvl(?,0)/DECODE(content_in_pres_base_uom,0,1,NVL(content_in_pres_base_uom,1)) ) stockqty,stock_uom FROM ph_drug WHERE drug_code=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT64","SELECT DECODE(?,'S',CEIL(?*DECODE(STRENGTH_PER_VALUE_PRES_UOM,0,1,NVL(STRENGTH_PER_VALUE_PRES_UOM,1))/DECODE(content_in_pres_base_uom,0,1,NVL(content_in_pres_base_uom,1) )  ) , CEIL(?/DECODE(content_in_pres_base_uom,0,1,NVL(content_in_pres_base_uom,1))  ) ) stockqty,stock_uom,STOCK_UOM_DESC,STRENGTH_PER_VALUE_PRES_UOM  FROM ph_drug_vw_lang_vw ph_drug_vw WHERE drug_code=? AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT65","SELECT A.ROUTE_CODE,B.ROUTE_DESC,B.ROUTE_COLOR FROM PH_ROUTE_FOR_FORM A, PH_ROUTE_LANG_VW B WHERE A.ROUTE_CODE = B.ROUTE_CODE AND A.FORM_CODE=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT66","SELECT COUNT(*) TOTAL FROM AM_FREQUENCY_ADMIN_DAY_TIME WHERE FREQ_CODE=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT67","SELECT A.STOCK_UOM, B.SHORT_DESC FROM PH_DRUG A,AM_UOM B WHERE A.STOCK_UOM=B.UOM_CODE AND A.STOCK_UOM = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT68","SELECT B.ORDER_ID, B.ORDER_LINE_NUM,B.ORDER_CATALOG_CODE, B.CATALOG_DESC,DECODE(SUBSTR(B.CATALOG_DESC,1,1),?,0,1) DUP_DESC,RTRIM (RTRIM (TO_CHAR (B.QTY_VALUE, '9999999999999990.999999999999'), '0'), '.')QTY_VALUE,PH_GET_UOM_DISPLAY(?,B.QTY_UNIT,?) QTY_UNIT, B.FREQ_CODE, DECODE (j.split_yn, 'Y', c.freq_desc ||  ' (Divided)', c.freq_desc) freq_desc ,B.DURN_VALUE,B.DURN_TYPE,E.DURN_DESC, TO_CHAR (a.ord_date_time, 'DD/MM/YYYY hh24:mi') ord_date_time, TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY hh24:mi') START_DATE, TO_CHAR(B.END_DATE_TIME,'DD/MM/YYYY hh24:mi')END_DATE, A.SOURCE_CODE, A.ORD_PRACT_ID,DECODE (a.source_type, 'N', f.long_desc, g.long_desc) LOCATION,B.ORDER_LINE_STATUS,d.generic_id FROM   OR_ORDER A, OR_ORDER_LINE B, AM_FREQUENCY_LANG_VW C,ph_drug_lang_vw d, AM_DURATION_TYPE_LANG_VW E, IP_NURSING_UNIT_LANG_VW F, OP_CLINIC_LANG_VW G, ph_patient_drug_profile j WHERE A.ORDER_ID = B.ORDER_ID AND b.order_id = j.orig_order_id AND b.order_line_num = j.orig_order_line_no AND C.FREQ_CODE  = B.FREQ_CODE and d.DRUG_CODE= b.ORDER_CATALOG_CODE AND E.DURN_TYPE = B.DURN_TYPE AND F.NURSING_UNIT_CODE(+)=A.SOURCE_CODE AND G.CLINIC_CODE(+)=A.SOURCE_CODE  AND A.ORDERING_FACILITY_ID=F.FACILITY_ID(+) AND A.ORDERING_FACILITY_ID=G.FACILITY_ID(+) AND TRUNC(A.ORD_DATE_TIME) BETWEEN TO_DATE(?,'DD/MM/YYYY') AND  TO_DATE(?,'DD/MM/YYYY') AND A.ORDER_CATEGORY='PH' AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = ? AND F.LANGUAGE_ID(+) = ? and d.LANGUAGE_ID = ? AND G.LANGUAGE_ID(+) = ?");//Added ord_date_time,d.generic_id ,ph_drug_lang_vw for BRU-HIMS-CRF-403 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT68A","SELECT A.IV_PREP_YN,B.ORDER_ID, B.ORDER_LINE_NUM,B.ORDER_CATALOG_CODE, B.CATALOG_DESC,DECODE(SUBSTR(B.CATALOG_DESC,1,1),?,0,1) DUP_DESC,B.QTY_VALUE,B.QTY_UNIT,B.FREQ_CODE,C.FREQ_DESC,B.DURN_VALUE,B.DURN_TYPE,E.DURN_DESC, TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY hh24:mi') START_DATE, TO_CHAR(B.END_DATE_TIME,'DD/MM/YYYY hh24:mi')END_DATE, A.SOURCE_CODE, A.ORD_PRACT_ID,DECODE(A.PATIENT_CLASS,'IP',   F.LONG_DESC,G.LONG_DESC) LOCATION,B.ORDER_LINE_STATUS FROM   OR_ORDER A, OR_ORDER_LINE B, AM_FREQUENCY_LANG_VW C, AM_DURATION_TYPE_LANG_VW E, IP_NURSING_UNIT_LANG_VW F, OP_CLINIC_LANG_VW G WHERE A.ORDER_ID   = B.ORDER_ID AND C.FREQ_CODE  = B.FREQ_CODE AND E.DURN_TYPE     = B.DURN_TYPE AND F.NURSING_UNIT_CODE(+)=A.SOURCE_CODE AND G.CLINIC_CODE(+)=A.SOURCE_CODE  AND A.ORDERING_FACILITY_ID=F.FACILITY_ID(+) AND A.ORDERING_FACILITY_ID=G.FACILITY_ID(+) AND A.ORD_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY') AND  TO_DATE(?,'DD/MM/YYYY') + 0.99999 AND A.ORDER_CATEGORY='PH' AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = ? AND F.LANGUAGE_ID(+) = ? AND G.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT69","SELECT FREQ_CODE,DURN_VALUE,DURN_TYPE,QTY_VALUE,QTY_UNIT FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT70","SELECT A.IV_PREP_YN,B.ORDER_ID,B.ORDER_LINE_NUM,B.ORDER_CATALOG_CODE,B.CATALOG_DESC,B.QTY_VALUE,B.QTY_UNIT,B.FREQ_CODE,C.FREQ_DESC,B.DURN_VALUE,TO_CHAR(A.ORD_DATE_TIME,'DD/MM/YYYY hh24:mi')ORD_DATE_TIME,B.DURN_TYPE,E.DURN_DESC,TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY hh24:mi') START_DATE, TO_CHAR(B.END_DATE_TIME,'DD/MM/YYYY hh24:mi')END_DATE, A.SOURCE_CODE,A.ORD_PRACT_ID,DECODE(A.PATIENT_CLASS,'IP',F.LONG_DESC,G.LONG_DESC) LOCATION, B.ORDER_LINE_STATUS FROM OR_ORDER A,OR_ORDER_LINE B,AM_FREQUENCY_LANG_VW C,AM_DURATION_TYPE_LANG_VW E,IP_NURSING_UNIT_LANG_VW F,  OP_CLINIC_LANG_VW G WHERE A.ORDER_ID   = B.ORDER_ID AND C.FREQ_CODE  = B.FREQ_CODE AND E.DURN_TYPE     = B.DURN_TYPE AND F.NURSING_UNIT_CODE(+)=A.SOURCE_CODE AND G.CLINIC_CODE(+)=A.SOURCE_CODE AND A.ORDERING_FACILITY_ID=F.FACILITY_ID(+) AND A.ORDERING_FACILITY_ID=G.FACILITY_ID(+) AND A.ORD_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') + 0.99999 AND  A.ORDER_CATEGORY='PH' AND C.LANGUAGE_ID = E.LANGUAGE_ID AND C.LANGUAGE_ID = ? AND F.LANGUAGE_ID(+) = ? AND G.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT71","SELECT COUNT(*) COUNT FROM PH_MEDN_ADMIN WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND PATIENT_ID=? AND ORD_DRUG_CODE=? AND ORDER_ID=? AND ADMIN_RECORDED_YN='Y'");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT_REPEAT_VALUE", "select repeat_value from am_frequency where freq_code=?");
		dataMap.put("SQL_PH_PRESCRIPTION_DRUG_TRADES_SELECT", "SELECT A.TRADE_ID, A.SHORT_NAME TRADE_NAME    FROM AM_TRADE_NAME_LANG_VW A, PH_TRADE_NAME_FOR_DRUG B   WHERE B.DRUG_CODE = ?    AND A.TRADE_ID = B.TRADE_CODE     AND A.LANGUAGE_ID = ?    AND B.EFF_STATUS = 'E'    AND A.EFF_STATUS = 'E'  ORDER BY A.SHORT_NAME");
		dataMap.put("SQL_PH_PRESCRIPTION_TRADE_SELECT", "SELECT a.trade_id trade_code, a.long_name trade_name FROM am_trade_name_lang_vw a, or_order_line_ph b WHERE a.trade_id= b.trade_code AND b.order_id=? AND b.order_line_num=? AND a.language_id = ?");
		dataMap.put("SQL_PH_CONSUMABLERX_ITEM_SELECT", "SELECT ord_cat.order_catalog_code item_code , mm.long_desc, mtr.trade_id,(SELECT short_name FROM am_trade_name_lang_vw WHERE language_id = ? AND trade_id = mtr.trade_id) trade_name, mm.gen_uom_code uom_code, (SELECT short_desc FROM am_uom_lang_vw WHERE language_id =? AND uom_code = mm.gen_uom_code) uom_desc, ord_cat.order_type_code, ord_cat.order_category FROM or_order_catalog ord_cat, st_item st, mm_item_lang_vw mm, mm_trade_name_for_item mtr WHERE medical_item_yn = 'Y' AND drug_item_yn = 'N' AND st.item_code = mm.item_code AND mm.language_id = ? and ord_cat.order_catalog_code = mm.item_code and ord_cat.order_category='PH' and ord_cat.order_type_code='MS' AND st.item_code = mtr.item_code(+) AND mm.eff_status = 'E' AND UPPER (mm.long_desc) LIKE UPPER (?)");
		dataMap.put("SQL_PH_CONSUMABLERX_ITEM_LOOKUP_SELECT", "SELECT ord_cat.order_catalog_code item_code, mm.long_desc,mtr.trade_id, mm.gen_uom_code uom_code, (SELECT short_desc FROM am_uom_lang_vw WHERE language_id = ? AND uom_code = mm.gen_uom_code) uom_desc, ord_cat.order_type_code, ord_cat.order_category, ord_cat.CONSENT_REQD_YN, ord_cat.BILL_YN FROM or_order_catalog ord_cat, st_item st, mm_item_lang_vw mm, mm_trade_name_for_item mtr WHERE medical_item_yn = 'Y' AND drug_item_yn = 'N' AND st.item_code = mm.item_code AND mm.language_id = ? AND ord_cat.order_catalog_code = mm.item_code AND ord_cat.order_category = 'PH' AND st.item_code = mtr.item_code(+) AND ord_cat.order_catalog_code = ? and NVL(mtr.trade_id,'X') = DECODE(?,NULL,NVL (mtr.trade_id, 'X'),?)order by trade_id");
		dataMap.put("SQL_PH_CONSUMABLERX_ORDERSET_ITEM_SELECT", "SELECT QTY_VALUE, QTY_UNIT,REQD_OR_OPT_IND,(SELECT short_desc FROM am_uom_lang_vw WHERE language_id = ? AND uom_code = qty_unit) uom_desc FROM OR_ORDER_SET_COMPONENT WHERE ORDER_SET_CODE = ? AND ORDER_CATALOG_CODE = ? AND OCURRANCE_NUM = ?");
		dataMap.put("SQL_PH_CONSUMABLERX_ITEM_TRADE_SELECT", "SELECT short_name trade_name FROM am_trade_name_lang_vw WHERE language_id = ? AND trade_id = ?");
		dataMap.put("SQL_PH_CONSUMABLERX_ITEM_TRADELIST_SELECT", "select mmtrd.trade_id, amtrdvw.short_name trade_name from mm_trade_name_for_item mmtrd, am_trade_name_lang_vw amtrdvw where mmtrd.item_code=? and amtrdvw.language_id=? and mmtrd.trade_id = amtrdvw.trade_id");
		dataMap.put("SQL_PH_CONSUMABLERX_ITEM_STOCK_DTL_SELECT", "SELECT a.store_code, b.short_desc,  SUM (a.qty_on_hand - committed_qty) avl_qty FROM st_item_batch a, ph_disp_locn_lang_vw b, st_item_store c, st_item d WHERE a.item_code = ?  AND ( (  d.USE_AFTER_EXPIRY_YN = 'N'  AND a.expiry_date_or_receipt_date >= SYSDATE ) OR ( d.USE_AFTER_EXPIRY_YN = 'Y' ) )  AND a.store_code = b.store_code  AND a.trade_id = NVL (?, a.trade_id)  AND b.language_id = ?  AND c.store_code = a.store_code  AND c.item_code = a.item_code  AND c.eff_status = 'E'  AND c.phy_inv_id IS NULL AND d.item_code = a.item_code GROUP BY a.store_code, b.short_desc");


		//prescription workload statistics 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT72","SELECT COUNT(*) DLYCOUNT FROM PH_DLY_DO_WORKLOAD WHERE TRUNC(WORKLOAD_DATE)=TRUNC(SYSDATE) AND PRACTITIONER_ID=? AND FACILITY_ID=? AND PATIENT_CLASS=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT73","SELECT COUNT(*) MTHLYCOUNT FROM PH_MTHLY_DO_WORKLOAD WHERE TO_CHAR(WORKLOAD_MONTH,'MM/YYYY')=TO_CHAR(TRUNC(SYSDATE),'MM/YYYY')	AND PRACTITIONER_ID=? AND FACILITY_ID=? AND PATIENT_CLASS=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT74","SELECT COUNT(*) DLYCOUNT FROM PH_DLY_LOC_WORKLOAD WHERE TRUNC(WORKLOAD_DATE)=TRUNC(SYSDATE) AND LOCN_TYPE=? AND FACILITY_ID=? AND LOCN_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT75","SELECT COUNT(*) MTHLYCOUNT FROM PH_MTHLY_LOC_WORKLOAD WHERE TO_CHAR(WORKLOAD_MONTH,'MM/YYYY')=TO_CHAR(TRUNC(SYSDATE),'MM/YYYY') AND LOCN_TYPE=? AND FACILITY_ID=? AND LOCN_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT76","SELECT A.OP_DISP_LOCN_RTN_ORD,B.SHORT_DESC OP_RTN_DESC, A.OP_DISP_LOCN_STAT_ORD,B.SHORT_DESC OP_STAT_DESC, A.IP_DISP_LOCN_RTN_ORD,B.SHORT_DESC IP_RTN_DESC, A.IP_DISP_LOCN_STAT_ORD, B.SHORT_DESC IP_STAT_DESC, A.DISCH_MED_DISP_LOCN,B.SHORT_DESC DISCH_DESC FROM PH_FACILITY_PARAM A, PH_DISP_LOCN_LANG_VW B WHERE A.FACILITY_ID=? AND A.FACILITY_ID=B.FACILITY_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT77","SELECT ALLOW_MEDN_ORDER_WITHOUT_DIAG, 'Y' ALLOW_MEDN_ORDER_WITHOUT_WT,DISP_CHARGE_DTL_IN_RX_YN, DISP_CHARGE_DTL_IN_DRUG_LKP_YN, DISP_PRICE_TYPE_IN_DRUG_LKP, DC_MAR_APPL_YN, EM_MAR_APPL_YN, IP_MAR_APPL_YN, OP_MAR_APPL_YN, DISCH_MED_MAR_APPL_YN,SPLIT_BASED_PRIORITY_YN, SPLIT_BASED_DRUG_CLASS_YN, NARCOTIC_APRVL_FORM_REQ_YN,PRINT_NARCOTIC_FORM_BY_DEFAULT,RX_QTY_BY_PRES_BASE_UOM_YN, atc_allergy_alert_level, CAN_DISCON_DUP_ORDERS FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT78","select TERM_CODE DIAG_CODE,'' CAUSE_INDICATOR,OCCUR_SRL_NO DIAG_CODE_SCHEME,TERM_CODE_SHORT_DESC DIAG_DESC from pr_diagnosis where PATIENT_ID=? AND CURR_STATUS='A'");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT79","SELECT LABEL_TEXT FROM OR_ORDER_FORMAT_DTL WHERE FORMAT_ID='FHPH*ALL*ALL' AND (FIELD_OR_TEMPLATE_MNEMONIC='HEIGHT_UOM') OR ( FIELD_OR_TEMPLATE_MNEMONIC='WEIGHT_UOM')");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT80","SELECT AGE_GROUP_CODE FROM PH_DOSAGE_LIMIT_FOR_AGE_GROUP WHERE GENDER=? AND ? BETWEEN MIN_AGE AND MAX_AGE AND DRUG_CODE=?"); 

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT80A","SELECT AGE_GROUP_CODE FROM PH_DOSAGE_LIMIT_FOR_AGE_GROUP WHERE ((GENDER IS NULL) OR (UPPER(GENDER) = UPPER(?))) AND ? BETWEEN decode( age_unit,'N',min_age,'H',min_age * 60,'D',MIN_AGE * 24 * 60,'M',MIN_AGE*30 * 24 * 60,'Y',MIN_AGE*365 * 24 * 60) AND decode( age_unit,'N',MAX_AGE,'H',MAX_AGE * 60,'D',MAX_AGE * 24 * 60,'M',MAX_AGE*30 * 24 * 60,'Y',MAX_AGE*365 * 24 * 60) AND DRUG_CODE=?");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT81","SELECT CALC_BY_IND, DOSAGE_STD, DOSAGE_UNIT, LIMIT_IND FROM PH_DOSAGE_LIMIT_FOR_AGE_GROUP WHERE DRUG_CODE=? AND AGE_GROUP_CODE=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT82","SELECT stock_uom, b.short_desc stock_uom_desc FROM ph_drug a, am_uom_lang_vw b WHERE a.stock_uom = b.uom_code(+) AND a.drug_code = ? AND b.language_id = ? and ? = ? and ? = ?");
		//dataMap.put("SQL_PH_PRESCRIPTION_SELECT82","SELECT STOCK_UOM,STOCK_UOM_DESC  FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE DRUG_CODE=? AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT83","SELECT ORDER_ID FROM OR_ORDER_LINE WHERE CHILD_ORDER_YN='Y' AND PARENT_ORDER_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT84","SELECT NUM_OF_REFILLS,CHILD_ORDER_YN  FROM OR_ORDER_LINE WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT85","SELECT COUNT(*) COUNT FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT86","SELECT PRESCRIBED_MODE,STRENGTH FROM PH_PATIENT_DRUG_PROFILE  WHERE ORIG_ORDER_ID=? AND  ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT87","SELECT TO_CHAR(ADDED_DATE,'DD/MM/YYYY HH24:MI') ADDED_DATE,HEIGHT, HEIGHT_UOM, WEIGHT, WEIGHT_UOM FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=? AND SRL_NO=(SELECT MAX(SRL_NO) FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=?)");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT88","SELECT FREQ_NATURE FROM AM_FREQUENCY WHERE FREQ_CODE=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT89","select count(*) num from (SELECT  a.allergen_code   FROM pr_adverse_event_reaction a,  pr_allergy_sensitivity C  WHERE a.adv_event_type in ('DA', 'AD')  AND a.patient_id = ?  and a.STATUS= 'A' AND A.PATIENT_ID=C.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=C.ADV_EVENT_TYPE_IND AND  A.ADV_EVENT_TYPE =C.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =C.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=C.ADV_EVENT_SRL_NO AND C.STATUS= 'A' union ALL SELECT a.allergen_code FROM pr_adverse_event_reaction a ,pr_allergy_sensitivity C WHERE a.adv_event_type in  ('DA', 'AD') AND a.patient_id = ?  AND a.adv_reac_code  ='Oth'and a.STATUS= 'A' AND A.PATIENT_ID=C.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=C.ADV_EVENT_TYPE_IND AND A.ADV_EVENT_TYPE =C.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =C.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=C.ADV_EVENT_SRL_NO AND C.STATUS= 'A' )");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT89A","SELECT a.allergen_code,CASE WHEN a.allergen_code IS NOT NULL THEN (DECODE (a.adv_event_type,'DA',(SELECT generic_name FROM ph_generic_name_lang_vw WHERE generic_id = a.allergen_code AND language_id=?),'AD', (SELECT generic_name FROM ph_generic_name_lang_vw WHERE generic_id = a.allergen_code AND language_id=?),(SELECT long_desc FROM mr_allergen_lang_vw  WHERE allergen_code = a.allergen_code AND language_id=?))) END allergen FROM pr_allergy_sensitivity a,mr_adv_event_type_ind c,mr_adv_event_type d, pr_adverse_event e,   pr_adverse_event_reaction f,am_reaction g WHERE a.patient_id = ? AND  a.status='A'   AND a.patient_id = e.patient_id AND a.adv_event_type_ind = e.adv_event_type_ind AND a.adv_event_type = e.adv_event_type AND a.allergen_code = e.allergen_code AND a.adv_event_srl_no = e.adv_event_srl_no AND a.patient_id = f.patient_id AND a.adv_event_type_ind = f.adv_event_type_ind AND a.adv_event_type = f.adv_event_type AND a.allergen_code = f.allergen_code AND e.adv_event_srl_no = f.adv_event_srl_no AND e.adv_event_dtl_srl_no = f.adv_event_dtl_srl_no AND a.adv_event_type_ind = c.adv_event_type_ind AND a.adv_event_type = d.adv_event_type_code AND f.adv_reac_code = g.reaction_code (+) ORDER BY allergen");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT90","SELECT PRESCRIBED_MODE,STRENGTH,STRENGTH_UOM_CODE,DOSAGE,DOSAGE_UOM_CODE FROM PH_PATIENT_DRUG_PROFILE  WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT91","select IV_ADMIXTURE_APPL_YN,ALERT_PRACTITIONER_YN from ph_facility_param where FACILITY_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT92","SELECT 'X'FROM PH_FACILITY_PARAM WHERE FACILITY_ID=? group by WORKING_HRS_OF_PREP_ROOM_TO,WORKING_HRS_OF_PREP_ROOM_FROM having to_char(sysdate,'hh24:mi') between to_char(WORKING_HRS_OF_PREP_ROOM_FROM,'hh24:mi') and to_char(WORKING_HRS_OF_PREP_ROOM_TO,'hh24:mi')");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT93","SELECT COUNT(*) FROM PH_DISP_LOCN WHERE TO_CHAR(SYSDATE,'HH24:MI') BETWEEN TO_CHAR(WORKING_HOURS_FROM,'HH24:MI') AND  TO_CHAR(WORKING_HOURS_TO,'HH24:MI') AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT94","SELECT A.ALT_DISP_LOCN_CODE FROM PH_ALT_DISP_LOCN A, PH_DISP_LOCN_LANG_VW B WHERE B.DISP_LOCN_CODE=A.DISP_LOCN_CODE AND B.FACILITY_ID=A.PERFORMING_FACILITY_ID AND B.DISP_LOCN_CODE=? AND B.FACILITY_ID=? AND TO_CHAR(SYSDATE,'HH24:MI') BETWEEN TO_CHAR(A.TIME_FROM,'HH24:MI') AND TO_CHAR(A.TIME_TO,'HH24:MI') AND B.LANGUAGE_ID = ?"); 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT95","SELECT A.FREQ_CODE,B.FREQ_DESC FROM OR_ORDER_CATALOG_BY_PTCL A,AM_FREQUENCY_LANG_VW B WHERE A.FREQ_CODE=B.FREQ_CODE AND  B.EFF_STATUS='E' AND A.ORDER_CATALOG_CODE=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT96","SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A, OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND A.FREQ_CODE = B.FREQ_CODE AND A.FREQ_NATURE IN ('O') AND B.FREQ_SCOPE_YN='Y' AND A.LANGUAGE_ID = ? order by FREQ_DESC DESC"); //added DESC for IN071022 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT97","SELECT NUM_REF_LOW, NUM_REF_HIGH FROM AM_DISCR_MSR_REF_RNG_NUM WHERE DISCR_MSR_ID= ? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT98","SELECT ATC_CLASS_LEV1_CODE, ATC_CLASS_LEV2_CODE, ATC_CLASS_LEV3_CODE FROM PH_GENERIC_NAME_BY_ATC_CLASS WHERE GENERIC_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT99","select * from or_order_line_tdm where ORDER_ID=? and ORDER_LINE_NUM=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT100","SELECT * FROM(SELECT a.order_id ORDER_ID FROM or_order a, or_order_line b WHERE a.patient_id=? and a.order_type_code='TDM'  AND a.order_status in (select order_status_code from or_order_status_code  where order_status_type in ('60','85','90','91','92'))  and b.order_id = a.order_id   and b.order_catalog_code = ? ORDER BY a.added_date DESC)WHERE ROWNUM < 2 ");
		
		//added by subbulakshmi on 29/11
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT101","SELECT b.discr_msr_id discr_msr_id, DECODE(num_ref_low,NULL,b.min_value,0,b.min_value,num_ref_low) min_value, DECODE(num_ref_high,NULL,b.max_value,0,b.max_value,num_ref_high) max_value, b.NUM_DIGITS_MIN min_digits, b.NUM_DIGITS_MAX max_digits, b.NUM_DIGITS_DEC dec_digits FROM AM_DISCR_MSR_REF_RNG_NUM a, am_discr_msr b,(SELECT TRUNC(SYSDATE - date_of_birth) no_of_day,sex FROM mp_patient WHERE patient_id=?) c  WHERE b.DISCR_MSR_ID in(?) and b.DISCR_MSR_ID= a.DISCR_MSR_ID(+) and no_of_day >= (case when start_age_units = 'M' THEN start_age*30 WHEN start_age_units = 'Y' THEN start_age*365 ELSE start_age END) AND no_of_day <= (case when end_age_units = 'M' THEN end_age*30 WHEN end_age_units = 'Y' THEN end_age*365 ELSE end_age END) AND (patient_sex = sex or patient_sex='A')");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT102","select nvl(count(*),0) count from pr_adv_drug_reaction where PATIENT_ID = ?   and DRUG_CODE like(?)  and signed_by is not null and (adr_status is null or adr_status not in ('E', 'C') )");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT103","SELECT CASE WHEN MOD(NEXT_DAY(TO_DATE(?,'DD/MM/YYYY')+?, ?) - TO_DATE(?,'DD/MM/YYYY'),7) = 0 THEN CASE WHEN TO_DATE(?,'HH24:MI') > TO_DATE(?,'HH24:MI') THEN TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+?,'DD/MM/YYYY HH24:MI') ELSE TO_CHAR(NEXT_DAY(TO_DATE(?,'DD/MM/YYYY HH24:MI')+?, ?),'DD/MM/YYYY HH24:MI') END ELSE TO_CHAR(NEXT_DAY(TO_DATE(?,'DD/MM/YYYY HH24:MI')+?, ?),'DD/MM/YYYY HH24:MI') END NEXTDAY FROM DUAL");
		dataMap.put("SQL_PH_SLIDING_SCALE_TEMPLATE_ID","select tmpl.TEMPLATE_ID , tmpl.TEMPLATE_DESC, tmpl.RANGE_UOM_CODE, tmpl.ADMIN_UNITS_UOM_CODE from PH_DRUG_SLIDING_SCALE_TMPL drugTmpl,PH_SLIDING_SCALE_TMPL tmpl where tmpl.TEMPLATE_ID = drugTmpl.TEMPLATE_ID and drugTmpl.DRUG_CODE=? and EFF_STATUS='E'");
		dataMap.put("SQL_PH_SLIDING_SCALE_TEMPLATE_DETAILS","select SRL_NO, RANGE_FROM, RANGE_TO, ADMIN_UNITS, REMARKS  from PH_SLIDING_SCALE_TMPL_DTL dtl where TEMPLATE_ID = ? and EFF_STATUS='E' order by SRL_NO");
   
		//query changed for External Prescriptions....last columns newly added...
		dataMap.put("SQL_PH_PRESCRIPTION_TRN_GROUP_REF_SELECT", "SELECT OR_TRN_GROUP_REF_SEQ.NEXTVAL TRN_GROUP_REF FROM DUAL");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT1", "INSERT INTO OR_ORDER (ORDER_ID,ORDER_TYPE_CODE,ORDER_CATEGORY,CONTR_SYS_ID,PATIENT_ID,PATIENT_CLASS,ORDERING_FACILITY_ID,ENCOUNTER_ID,EPISODE_ID,EPISODE_VISIT_NUM,SOURCE_TYPE,SOURCE_CODE,DISCHARGE_IND,ORD_DATE_TIME,ORD_PRACT_ID,PRIORITY,ORD_AUTH_REQD_YN,ORD_AUTH_LEVEL,ORD_AUTH_BY_PRACT_ID,ORD_AUTH_DATE_TIME,ORD_APPR_REQD_YN,ORD_APPR_BY_USER_ID,ORD_APPR_DATE_TIME,ORD_COSIGN_REQD_YN,ORD_COSIGN_LEVEL,ORD_COSIGN_BY_PRACT_ID,ORD_COSIGN_DATE_TIME,ORD_PRINT_DATE_TIME,BILL_YN,CONT_ORDER_IND,PERFORMING_FACILITY_ID,PERFORMING_SYS_ID,PERFORMING_DEPTLOC_TYPE,PERFORMING_DEPTLOC_CODE,PERFORMING_PRACT_ID,RESULT_AUTH_REQD_YN,CHILD_ORDER_YN,PARENT_ORDER_ID,ORDER_SET_YN,ORDER_SET_ID,IV_PREP_YN,ORDER_FIELDS_DISPLAY_TEXT,ORDER_STATUS,RESULT_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ORD_CONSENT_REQD_YN,ORD_CONSENT_BY_ID,ORD_CONSENT_BY_DATE_TIME,CAN_REASON,REF_FACILITY_ID,REF_DATE_TIME,REF_SENT_PRACT_ID,REF_RECIEVED_REMARKS,REF_RECIEVED_PRACT_ID,REF_RECIEVED_DATE_TIME,TRN_GROUP_REF) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT2A", "INSERT INTO OR_ORDER_LINE (ORDER_ID,ORDER_LINE_NUM,ORDER_CATALOG_CODE,CATALOG_DESC,CATALOG_SYNONYM,ORDER_CATALOG_NATURE,ORDER_TYPE_CODE,ORDER_CATEGORY,ORD_DATE_TIME,PRIORITY,ORD_AUTH_REQD_YN,ORD_AUTH_REASON,ORD_APPR_REQD_YN,ORD_COSIGN_REQD_YN,START_DATE_TIME,FORM_CODE,ROUTE_CODE,QTY_VALUE,QTY_UNIT,FREQ_CODE,DURN_VALUE,DURN_TYPE,LINE_FIELDS_DISPLAY_TEXT,ITEM_NARRATION,NEXT_SCHED_DATE,END_DATE_TIME,AUTO_STOP_DATE_TIME,ORDER_QTY,ORDER_UOM,APPT_REQD_YN,APPT_DATE_TIME,APPT_REF_NUM,RESULT_APPLICABLE_YN,BILL_YN,BILLED_YN,CONT_ORDER_IND,REFILL_SINGLE_CONT_ORDER_YN,NUM_OF_REFILLS,CHILD_ORDER_YN,PARENT_ORDER_ID,PARENT_ORDER_LINE_NUM,ORDER_SET_ID,ORDER_SET_LINE_NUM,ORD_PRACT_ID,ORD_SET_DATE_TIME,AMD_PRACT_ID,AMD_DATE_TIME,HOLD_PRACT_ID,HOLD_DATE_TIME,RESUME_PRACT_ID,RESUME_DATE_TIME,DISC_PRACT_ID,DISC_DATE_TIME,CAN_PRACT_ID,CAN_DATE_TIME,ACCESSION_NUM,ACCESSION_LINE_NUM,ORDER_LINE_STATUS,RESULT_LINE_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ORD_CONSENT_REQD_YN,CAN_LINE_REASON,CATALOG_SYNONYM_DC,CATALOG_SYNONYM_AD,RESULT_AUTH_REQD_YN,  ORD_CONSENT_STAGE, ORD_CONSENT_STATUS, NUM_OF_CONSENT_REQ_BO, NUM_OF_CONSENT_REQ_BR) VALUES (?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?)");  
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT2", "INSERT INTO OR_ORDER_LINE (ORDER_ID,ORDER_LINE_NUM,ORDER_CATALOG_CODE,CATALOG_DESC,CATALOG_SYNONYM,ORDER_CATALOG_NATURE,ORDER_TYPE_CODE,ORDER_CATEGORY,ORD_DATE_TIME,PRIORITY,ORD_AUTH_REQD_YN,ORD_AUTH_REASON,ORD_APPR_REQD_YN,ORD_COSIGN_REQD_YN,START_DATE_TIME,FORM_CODE,ROUTE_CODE,QTY_VALUE,QTY_UNIT,FREQ_CODE,DURN_VALUE,DURN_TYPE,LINE_FIELDS_DISPLAY_TEXT,ITEM_NARRATION,NEXT_SCHED_DATE,END_DATE_TIME,AUTO_STOP_DATE_TIME,ORDER_QTY,ORDER_UOM,APPT_REQD_YN,APPT_DATE_TIME,APPT_REF_NUM,RESULT_APPLICABLE_YN,BILL_YN,BILLED_YN,CONT_ORDER_IND,REFILL_SINGLE_CONT_ORDER_YN,NUM_OF_REFILLS,CHILD_ORDER_YN,PARENT_ORDER_ID,PARENT_ORDER_LINE_NUM,ORDER_SET_ID,ORDER_SET_LINE_NUM,ORD_PRACT_ID,ORD_SET_DATE_TIME,AMD_PRACT_ID,AMD_DATE_TIME,HOLD_PRACT_ID,HOLD_DATE_TIME,RESUME_PRACT_ID,RESUME_DATE_TIME,DISC_PRACT_ID,DISC_DATE_TIME,CAN_PRACT_ID,CAN_DATE_TIME,ACCESSION_NUM,ACCESSION_LINE_NUM,ORDER_LINE_STATUS,RESULT_LINE_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ORD_CONSENT_REQD_YN,CAN_LINE_REASON,CATALOG_SYNONYM_DC,CATALOG_SYNONYM_AD,RESULT_AUTH_REQD_YN) VALUES (?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?)"); 
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT3", "INSERT INTO OR_ORDER_LINE_PH (ORDER_ID,ORDER_LINE_NUM,GENERIC_ID,FORM_CODE,TRADE_CODE,FORMULARY_ITEM_YN,DOSAGE_TYPE,SPLIT_DRUG_PREVIEW,TOT_STRENGTH,TOT_STRENGTH_UOM,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,BROUGHT_BY_PATIENT_YN,CUR_DRUG_YN,REFILL_DRUG_YN,DISPENSING_LOC_TYPE,DISPENSING_LOC,DISPENSING_STORE,IP_FILL_PROCESS,IP_FILL_PRD_AHEAD,NEXT_FILL_DATE,LAST_FILL_QTY,DISPENSED_QTY,BMS_QTY,BMS_STRENGTH,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,SPLIT_DOSE_YN,QTY_VALUE_SPLIT_DOSE,QTY_UNIT_SPLIT_DOSE,STRENGTH_VALUE,STRENGTH_UOM,PRES_QTY_VALUE,PRES_QTY_UOM,ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,DUPLICATE_DRUG_OVERRIDE_REASON,PATIENT_BROUGHT_MEDICATION_YN,AMEND_REASON_CODE, AMEND_REASON,PAT_COUNS_REQD_YN, PAT_COUNS_ORD_PRACT_ID,BL_INCL_EXCL_OVERRIDE_VALUE,BL_INCL_EXCL_OVERRIDE_REASON,BUILD_MAR_YN,DRUG_INDICATION,PREGNANCY_OVERRIDE_REASON,) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");//DRUG_INDICATION Added For  ML-BRU-CRF-072[Inc:29938] 		
		//ABUSE_EXISTS,ABUSE_DRUG_OVERRIDE_REASON added for aakh-crf-0140
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT3A", "INSERT INTO OR_ORDER_LINE_PH (ORDER_ID,ORDER_LINE_NUM,GENERIC_ID,FORM_CODE,TRADE_CODE,FORMULARY_ITEM_YN,DOSAGE_TYPE,SPLIT_DRUG_PREVIEW,TOT_STRENGTH,TOT_STRENGTH_UOM,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,BROUGHT_BY_PATIENT_YN,CUR_DRUG_YN,REFILL_DRUG_YN,DISPENSING_LOC_TYPE,DISPENSING_LOC,DISPENSING_STORE,IP_FILL_PROCESS,IP_FILL_PRD_AHEAD,NEXT_FILL_DATE,LAST_FILL_QTY,DISPENSED_QTY,BMS_QTY,BMS_STRENGTH,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,SPLIT_DOSE_YN,QTY_VALUE_SPLIT_DOSE,QTY_UNIT_SPLIT_DOSE,STRENGTH_VALUE,STRENGTH_UOM,PRES_QTY_VALUE,PRES_QTY_UOM,ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,DUPLICATE_DRUG_OVERRIDE_REASON,TOT_INFUSION_OVER, TOT_INFUSION_OVER_UNIT,ADMIN_RATE_DETAIL,CHNGD_FLUID_REMARKS,BL_INCL_EXCL_OVERRIDE_VALUE,BL_INCL_EXCL_OVERRIDE_REASON,BUILD_MAR_YN,DRUG_INDICATION,ABUSE_EXISTS,ABUSE_DRUG_OVERRIDE_REASON) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");//DRUG_INDICATION Added For  ML-BRU-CRF-072[Inc:29938] 

        dataMap.put("SQL_PH_PRESCRIPTION_INSERT3B", "INSERT INTO OR_ORDER_LINE_PH (ORDER_ID,ORDER_LINE_NUM,GENERIC_ID,FORM_CODE,TRADE_CODE,FORMULARY_ITEM_YN,DOSAGE_TYPE,SPLIT_DRUG_PREVIEW,TOT_STRENGTH,TOT_STRENGTH_UOM,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,BROUGHT_BY_PATIENT_YN,CUR_DRUG_YN,REFILL_DRUG_YN,DISPENSING_LOC_TYPE,DISPENSING_LOC,DISPENSING_STORE,IP_FILL_PROCESS,IP_FILL_PRD_AHEAD,NEXT_FILL_DATE,LAST_FILL_QTY,DISPENSED_QTY,BMS_QTY,BMS_STRENGTH,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,SPLIT_DOSE_YN,QTY_VALUE_SPLIT_DOSE,QTY_UNIT_SPLIT_DOSE,STRENGTH_VALUE,STRENGTH_UOM,PRES_QTY_VALUE,PRES_QTY_UOM,ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,DUPLICATE_DRUG_OVERRIDE_REASON,PATIENT_BROUGHT_MEDICATION_YN,AMEND_REASON_CODE, AMEND_REASON,PAT_COUNS_REQD_YN, INTENTION_CODE,STAGE_CODE, TOT_INFUSION_OVER, TOT_INFUSION_OVER_UNIT,CHNGD_FLUID_REMARKS,BUILD_MAR_YN,BL_INCL_EXCL_OVERRIDE_VALUE,BL_INCL_EXCL_OVERRIDE_REASON) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
//modified for aakh-crf-0140
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT4", "INSERT INTO PH_PATIENT_DRUG_PROFILE (PATIENT_ID,SRL_NO,FACILITY_ID,ENCOUNTER_ID,PATIENT_CLASS,LOCN_TYPE,LOCN_CODE,ROOM_TYPE,ROOM_NO,BED_NO,BED_CLASS,BED_TYPE,SPECIALITY_CODE,ATTEND_PRACTITIONER_ID,PRES_PRACTITIONER_ID,DRUG_CODE,GENERIC_ID,START_DATE,END_DATE,SPLIT_YN,TAPERED_YN,STRENGTH,STRENGTH_UOM_CODE,DOSAGE,DOSAGE_UOM_CODE,SPLIT_DOSE_PREVIEW,FREQ_CODE,DURATION,PRESCRIBED_QTY,DIAG_TEXT,DRUG_REMARKS,IV_PREP_YN,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,AMENDED_YN,AMEND_BY_ID,AMEND_DATE_TIME,CANCEL_YN,CANCEL_BY_ID,CANCEL_DATE_TIME,TRN_TYPE_IND,ORIG_FACILITY_ID,ORIG_ORDER_ID,ORIG_ORDER_LINE_NO,TOT_ISSUED_QTY,BROUGHT_BY_PATIENT_YN,ON_HOLD_DATE_TIME,ON_HOLD_BY_ID,ON_HOLD_REASON_CODE,DISCONT_DATE_TIME,DISCONT_BY_ID,DISCONT_REASON_CODE,STOP_YN,STOP_DATE_TIME,STOP_PRACTITIONER_ID,STOP_REMARKS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ROUTE_CODE,ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,IV_INGREDIENTS,DURN_TYPE,DISPENSED_DRUGS,ALTERNATE_GENERIC_ID,DISP_REMARKS,DUPLICATE_DRUG_OVERRIDE_REASON,REFILL_YN,FORM_CODE,DIAG_CODE1,DIAG_CODE1_CAUSE_IND,DIAG_CODE1_SCHEME,DIAG_CODE2,DIAG_CODE2_CAUSE_IND,DIAG_CODE2_SCHEME,DIAG_CODE3,DIAG_CODE3_CAUSE_IND,DIAG_CODE3_SCHEME,PRESCRIBED_MODE,HEIGHT,HEIGHT_UOM,WEIGHT,WEIGHT_UOM,BSA,ALLERGIC_YN,BMI,INTERACTION_OVERRIDE_REASON,CONTRAIND_OVERRIDE_REASON,DRUG_DB_PRODUCT_ID,ABUSE_EXISTS,ABUSE_DRUG_OVERRIDE_REASON) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT4A", "INSERT INTO PH_PATIENT_DRUG_PROFILE (PATIENT_ID,SRL_NO,FACILITY_ID,ENCOUNTER_ID,PATIENT_CLASS,LOCN_TYPE,LOCN_CODE,ROOM_TYPE,ROOM_NO,BED_NO,BED_CLASS,BED_TYPE,SPECIALITY_CODE,ATTEND_PRACTITIONER_ID,PRES_PRACTITIONER_ID,DRUG_CODE,GENERIC_ID,START_DATE,END_DATE,SPLIT_YN,TAPERED_YN,STRENGTH,STRENGTH_UOM_CODE,DOSAGE,DOSAGE_UOM_CODE,SPLIT_DOSE_PREVIEW,FREQ_CODE,DURATION,PRESCRIBED_QTY,DIAG_TEXT,DRUG_REMARKS,IV_PREP_YN,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,AMENDED_YN,AMEND_BY_ID,AMEND_DATE_TIME,CANCEL_YN,CANCEL_BY_ID,CANCEL_DATE_TIME,TRN_TYPE_IND,ORIG_FACILITY_ID,ORIG_ORDER_ID,ORIG_ORDER_LINE_NO,TOT_ISSUED_QTY,BROUGHT_BY_PATIENT_YN,ON_HOLD_DATE_TIME,ON_HOLD_BY_ID,ON_HOLD_REASON_CODE,DISCONT_DATE_TIME,DISCONT_BY_ID,DISCONT_REASON_CODE,STOP_YN,STOP_DATE_TIME,STOP_PRACTITIONER_ID,STOP_REMARKS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ROUTE_CODE,ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,IV_INGREDIENTS,DURN_TYPE,DISPENSED_DRUGS,ALTERNATE_GENERIC_ID,DISP_REMARKS,DUPLICATE_DRUG_OVERRIDE_REASON,REFILL_YN,FORM_CODE,DIAG_CODE1,DIAG_CODE1_CAUSE_IND,DIAG_CODE1_SCHEME,DIAG_CODE2,DIAG_CODE2_CAUSE_IND,DIAG_CODE2_SCHEME,DIAG_CODE3,DIAG_CODE3_CAUSE_IND,DIAG_CODE3_SCHEME,PRESCRIBED_MODE,HEIGHT,HEIGHT_UOM,WEIGHT,WEIGHT_UOM,BSA,ALLERGIC_YN,BMI,TPN_ADMIN_ROUTE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
		//added to insert PRN_REMARKS 
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT4B", "INSERT INTO PH_PATIENT_DRUG_PROFILE (PATIENT_ID,SRL_NO,FACILITY_ID,ENCOUNTER_ID,PATIENT_CLASS,LOCN_TYPE,LOCN_CODE,ROOM_TYPE,ROOM_NO,BED_NO,BED_CLASS,BED_TYPE,SPECIALITY_CODE,ATTEND_PRACTITIONER_ID,PRES_PRACTITIONER_ID,DRUG_CODE,GENERIC_ID,START_DATE,END_DATE,SPLIT_YN,TAPERED_YN,STRENGTH,STRENGTH_UOM_CODE,DOSAGE,DOSAGE_UOM_CODE,SPLIT_DOSE_PREVIEW,FREQ_CODE,DURATION,PRESCRIBED_QTY,DIAG_TEXT,DRUG_REMARKS,IV_PREP_YN,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,AMENDED_YN,AMEND_BY_ID,AMEND_DATE_TIME,CANCEL_YN,CANCEL_BY_ID,CANCEL_DATE_TIME,TRN_TYPE_IND,ORIG_FACILITY_ID,ORIG_ORDER_ID,ORIG_ORDER_LINE_NO,TOT_ISSUED_QTY,BROUGHT_BY_PATIENT_YN,ON_HOLD_DATE_TIME,ON_HOLD_BY_ID,ON_HOLD_REASON_CODE,DISCONT_DATE_TIME,DISCONT_BY_ID,DISCONT_REASON_CODE,STOP_YN,STOP_DATE_TIME,STOP_PRACTITIONER_ID,STOP_REMARKS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ROUTE_CODE,ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,IV_INGREDIENTS,DURN_TYPE,DISPENSED_DRUGS,ALTERNATE_GENERIC_ID,DISP_REMARKS,DUPLICATE_DRUG_OVERRIDE_REASON,REFILL_YN,FORM_CODE,DIAG_CODE1,DIAG_CODE1_CAUSE_IND,DIAG_CODE1_SCHEME,DIAG_CODE2,DIAG_CODE2_CAUSE_IND,DIAG_CODE2_SCHEME,DIAG_CODE3,DIAG_CODE3_CAUSE_IND,DIAG_CODE3_SCHEME,PRESCRIBED_MODE,HEIGHT,HEIGHT_UOM,WEIGHT,WEIGHT_UOM,BSA,ALLERGIC_YN,BMI, PRN_REMARKS,SLIDING_SCALE_REMARKS,CONTRAIND_OVERRIDE_REASON, INTERACTION_OVERRIDE_REASON, DRUG_DB_PRODUCT_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,ceil(?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");

		//fetching PRN remarks
		dataMap.put("SQL_PH_DISP_MEDICATION_PRN_REMARKS", "SELECT PRN_REMARKS FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID = (?) AND ORIG_ORDER_LINE_NO = (?)");

		dataMap.put("SQL_PH_PRESCRIPTION_INSERT5", "INSERT INTO OR_ORDER_COMMENT (ORDER_ID,ACTION_SEQ_NUM,ORDER_COMMENT,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,empty_clob(),?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT6", "INSERT INTO OR_ORDER_FIELD_VALUES (ORDER_ID,ORDER_SEQ_NUM,ORDER_FIELD_MNEMONIC,ORDER_FIELD_TYPE,ORDER_LABEL_TEXT,ORDER_FIELD_VALUE,ACCEPT_OPTION,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT7", "INSERT INTO OR_ORDER_LINE_FIELD_VALUES (ORDER_ID,ORDER_LINE_NUM,ORDER_LINE_FIELD_LEVEL,ORDER_LINE_SEQ_NUM,ORDER_LINE_FIELD_MNEMONIC,ORDER_LINE_FIELD_TYPE,ORDER_LINE_LABEL_TEXT,ORDER_LINE_FIELD_VALUE,ORDER_LINE_DOSE_QTY_VALUE,ORDER_LINE_DOSE_QTY_UNIT,ACCEPT_OPTION,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT8", "INSERT INTO PH_MEDN_ADMIN (FACILITY_ID,ENCOUNTER_ID,SCH_DATE_TIME,ORD_DRUG_CODE,DOSAGE_SEQ_NO,ORDER_ID,ORDER_LINE_NUM,PATIENT_ID,PRACT_ID,SCH_DOSAGE_QTY,SCH_DOSAGE_UOM_CODE,SCH_STRENGTH,SCH_STRENGTH_UOM,SCH_ROUTE_CODE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,VERIFY_REQD_YN,ADMINISTERED_YN) VALUES (?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT9", "INSERT INTO PH_DLY_DO_WORKLOAD (PRACTITIONER_ID, WORKLOAD_DATE, FACILITY_ID,PATIENT_CLASS, TOT_ORDERS, TOT_ORD_DRUGS,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ) VALUES (?, TRUNC(SYSDATE), ? ,?,? ,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT10", "INSERT INTO PH_MTHLY_DO_WORKLOAD (PRACTITIONER_ID, WORKLOAD_MONTH, FACILITY_ID,PATIENT_CLASS, TOT_ORDERS, TOT_ORD_DRUGS,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ) VALUES (	?, TO_DATE('01/'||TO_CHAR(SYSDATE,'MM/YYYY'),'DD/MM/YYYY'), ? ,?,? , ?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT11", "INSERT INTO PH_DLY_LOC_WORKLOAD (FACILITY_ID, LOCN_TYPE, LOCN_CODE,WORKLOAD_DATE, TOT_ORDERS, TOT_ORD_DRUGS,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID )  VALUES (? ,?,?, TRUNC(SYSDATE),? , ?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT12", "INSERT INTO PH_MTHLY_LOC_WORKLOAD (FACILITY_ID, LOCN_TYPE, LOCN_CODE,WORKLOAD_MONTH, TOT_ORDERS, TOT_ORD_DRUGS,	ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ) VALUES (?,?,?, TO_DATE('01/'||TO_CHAR(SYSDATE,'MM/YYYY'),'DD/MM/YYYY'),? , ?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY1", "UPDATE OR_ORDER SET MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?  WHERE  ORDER_ID=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY2", "UPDATE OR_ORDER_LINE SET QTY_VALUE=?,QTY_UNIT=?,FREQ_CODE=?, DURN_VALUE=?,DURN_TYPE=?, START_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), END_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ORDER_QTY=?,ORDER_UOM=?,AMD_PRACT_ID=?, AMD_DATE_TIME=SYSDATE, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, ROUTE_CODE=?  WHERE  ORDER_ID=? AND ORDER_LINE_NUM=?");
		//dataMap.put("SQL_PH_PRESCRIPTION_MODIFY3", "UPDATE OR_ORDER_LINE_PH SET  DOSAGE_TYPE=?, SPLIT_DRUG_PREVIEW=?,SPLIT_DOSE_YN=?,BMS_STRENGTH=?,STRENGTH_VALUE=?, STRENGTH_UOM=?, TOT_STRENGTH=?, BMS_QTY=?, PRES_QTY_VALUE=ceil(?),PRES_QTY_UOM=?, ALLERGY_OVERRIDE_REASON=?, DOSAGE_LIMIT_OVERRIDE_REASON=?, DUPLICATE_DRUG_OVERRIDE_REASON=?,AMEND_REASON_CODE=?, AMEND_REASON=?,  MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,BL_INCL_EXCL_OVERRIDE_VALUE = ? ,BL_INCL_EXCL_OVERRIDE_REASON = ? WHERE  ORDER_ID=? AND ORDER_LINE_NUM=? ");
		//modified for aakh-crf-0140
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY3", "UPDATE OR_ORDER_LINE_PH SET  DOSAGE_TYPE=?, SPLIT_DRUG_PREVIEW=?,SPLIT_DOSE_YN=?,BMS_STRENGTH=?,STRENGTH_VALUE=?, STRENGTH_UOM=?, TOT_STRENGTH=?, BMS_QTY=?, PRES_QTY_VALUE=ceil(?),PRES_QTY_UOM=?, ALLERGY_OVERRIDE_REASON=?, DOSAGE_LIMIT_OVERRIDE_REASON=?, DUPLICATE_DRUG_OVERRIDE_REASON=?,AMEND_REASON_CODE=?, AMEND_REASON=?,  MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,BL_INCL_EXCL_OVERRIDE_VALUE = ? ,BL_INCL_EXCL_OVERRIDE_REASON = ?, BUILD_MAR_YN =?,AMENDED_BY_ID =?, AMENDED_DATE =SYSDATE,DRUG_INDICATION=?,PREGNANCY_OVERRIDE_REASON=?, INTERACTION_OVERRIDE_REASON = ? ,LAB_INTERACT_OVERRIDE_REASON=?,FOOD_INTERACT_OVERRIDE_REASON=?,ALLERGY_OVERRIDE_REASON_CODE=?,DOSE_LIMIT_OVER_REASON_CODE=?,DUP_DRUG_OVERRIDE_REASON_CODE=?,INTER_OVERRIDE_REASON_CODE=?,LAB_INTER_OVERRIDE_REASON_CODE=?,FOOD_INTR_OVERRIDE_REASON_CODE=? ,ABUSE_EXISTS=?,ABUSE_DRUG_OVERRIDE_REASON =?,DISEASE_INTER_OVERRIDE_REASON=?,DISEASE_INTER_REASON_CODE=? WHERE  ORDER_ID=? AND ORDER_LINE_NUM=? ");//DRUG_INDICATION  Added for  ML-BRU-CRF-072[Inc:29938] ,Modified for IN:072715
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY4", "UPDATE PH_PATIENT_DRUG_PROFILE SET START_DATE=TO_DATE(?,'DD/MM/YYYY HH24:MI'), END_DATE=TO_DATE(?,'DD/MM/YYYY HH24:MI'),STRENGTH=?, PRESCRIBED_QTY=ceil(?), DURATION=?, DURN_TYPE=?,DOSAGE=?,  DOSAGE_UOM_CODE=?, SPLIT_DOSE_PREVIEW=?, FREQ_CODE=?,DIAG_TEXT=?, DRUG_REMARKS=?, BROUGHT_BY_PATIENT_YN=?, DIAG_CODE1=?, DIAG_CODE1_CAUSE_IND=?, DIAG_CODE1_SCHEME=?, DIAG_CODE2=?, DIAG_CODE2_CAUSE_IND=?, DIAG_CODE2_SCHEME=?, DIAG_CODE3=?, DIAG_CODE3_CAUSE_IND=?, DIAG_CODE3_SCHEME=?, PRESCRIBED_MODE=?, ALLERGY_OVERRIDE_REASON=?,DOSAGE_LIMIT_OVERRIDE_REASON=?,  DUPLICATE_DRUG_OVERRIDE_REASON =?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,AMENDED_YN=?, AMEND_BY_ID=?, AMEND_DATE_TIME=SYSDATE, PRN_REMARKS=?, CONTRAIND_OVERRIDE_REASON=?, INTERACTION_OVERRIDE_REASON=?,ROUTE_CODE=?  WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY5", "UPDATE OR_ORDER_LINE_FIELD_VALUES SET ORDER_LINE_FIELD_LEVEL=?,ORDER_LINE_SEQ_NUM=?,ORDER_LINE_FIELD_MNEMONIC=?,ORDER_LINE_FIELD_TYPE=?,ORDER_LINE_LABEL_TEXT=?,ORDER_LINE_FIELD_VALUE=?,ORDER_LINE_DOSE_QTY_VALUE=?,ORDER_LINE_DOSE_QTY_UNIT=?,ACCEPT_OPTION=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? and ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY6", "UPDATE PH_DLY_DO_WORKLOAD SET TOT_ORDERS=TOT_ORDERS+?, TOT_ORD_DRUGS=TOT_ORD_DRUGS+?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE TO_CHAR(WORKLOAD_DATE,'DD/MM/YYYY')=TO_CHAR(SYSDATE,'DD/MM/YYYY') AND	PRACTITIONER_ID=? AND FACILITY_ID=? AND PATIENT_CLASS=?");
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY7", "UPDATE PH_MTHLY_DO_WORKLOAD SET TOT_ORDERS=TOT_ORDERS+?, TOT_ORD_DRUGS=TOT_ORD_DRUGS+?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE 	TO_CHAR(WORKLOAD_MONTH,'DD/MM/YYYY')='01/'||TO_CHAR(SYSDATE,'MM/YYYY') AND PRACTITIONER_ID=? AND FACILITY_ID=? AND PATIENT_CLASS=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY8", "UPDATE PH_DLY_LOC_WORKLOAD SET 	TOT_ORDERS=TOT_ORDERS+?, TOT_ORD_DRUGS=TOT_ORD_DRUGS+?,	MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE  TO_CHAR(WORKLOAD_DATE,'DD/MM/YYYY')=TO_CHAR(SYSDATE,'DD/MM/YYYY') AND LOCN_TYPE=? AND FACILITY_ID=? AND LOCN_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_MODIFY9", "UPDATE PH_MTHLY_LOC_WORKLOAD SET TOT_ORDERS=TOT_ORDERS+?, TOT_ORD_DRUGS=TOT_ORD_DRUGS+?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?  WHERE  TO_CHAR(WORKLOAD_MONTH,'DD/MM/YYYY')='01/'||TO_CHAR(SYSDATE,'MM/YYYY') AND LOCN_TYPE=? AND FACILITY_ID=? AND LOCN_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT28B","SELECT COUNT(*) COUNT FROM PH_MEDN_ADMIN WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND PATIENT_ID=? AND ORD_DRUG_CODE=? AND ADMIN_RECORDED_YN IS NULL");
		dataMap.put("SQL_PH_PRESCRIPTION_DELETE1", "DELETE OR_ORDER_COMMENT WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_PRESCRIPTION_DELETE2", "DELETE FROM PH_MEDN_ADMIN WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND PATIENT_ID=? AND ORD_DRUG_CODE=? AND ORDER_ID=? AND ADMIN_RECORDED_YN IS NULL");
		dataMap.put("SQL_PH_PRESCRIPTION_DELETE3", " DELETE FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? and ORDER_LINE_NUM=? AND ORDER_LINE_SEQ_NUM < 100");
		dataMap.put("SQL_PH_PRESCRIPTION_DELETE4", " DELETE FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? and ORDER_LINE_NUM=? AND ORDER_LINE_SEQ_NUM > 200  AND ORDER_LINE_SEQ_NUM < 300");
		dataMap.put("SQL_PH_PRESCRIPTION_INSERT_FILED_VALUES", "INSERT INTO OR_ORDER_LINE_FIELD_VALUES(ORDER_LINE_FIELD_LEVEL, ORDER_LINE_SEQ_NUM, ORDER_LINE_FIELD_MNEMONIC, ORDER_LINE_FIELD_TYPE, ORDER_LINE_LABEL_TEXT, ORDER_LINE_FIELD_VALUE, ORDER_LINE_DOSE_QTY_VALUE, ORDER_LINE_DOSE_QTY_UNIT, ACCEPT_OPTION, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,ORDER_ID,ORDER_LINE_NUM) VALUES(?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_PH_PRESCRIPTION_DELETE_FIELD_VALUES","DELETE FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? and ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_PRESCRIPTION_DELETE_FIELD_VALUES_A","DELETE FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_DELETE_FIELD_VALUES_B","DELETE FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? and ORDER_LINE_FIELD_MNEMONIC='SCHED_ADMIN_TIME'");
		dataMap.put("SQL_PH_PRES_REMARKS","SELECT REMARK_DESC FROM PH_PRES_REMARK_LANG_VW PH_PRES_REMARK WHERE REMARK_CODE=? AND LANGUAGE_ID = ?");
		//to get the orderset drug details 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT_DRUGVALUES_FROM_ORDERSET","SELECT QTY_VALUE, QTY_UNIT, DURN_VALUE, DURN_TYPE, FREQ_CODE,REQD_OR_OPT_IND, to_char((SYSDATE+(DECODE(REL_START_DATE_TIME,null,0,REL_START_DATE_TIME)/24)),'dd/mm/yyyy hh24:mi') START_DATE_TIME FROM OR_ORDER_SET_COMPONENT WHERE ORDER_SET_CODE = ? AND ORDER_CATALOG_CODE = ? AND OCURRANCE_NUM = ?");
		
		//Prescription Modification
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT1A", "SELECT ITEM_CODE,DRUG_CODE, ph_get_ext_prod_drug_code(?,?) EXTERNAL_PRODUCT_ID, DRUG_DESC,STOCK_UOM_DESC, IN_FORMULARY_YN,GENERIC_ID,GENERIC_NAME,DRUG_CLASS,FORM_CODE,FORM_DESC,B.ROUTE_CODE,B.ROUTE_DESC,PRES_BASE_UOM,PRES_BASE_UOM_DESC,STRENGTH_VALUE,STRENGTH_UOM,STRENGTH_UOM_DESC,STRENGTH_PER_PRES_UOM,STRENGTH_PER_VALUE_PRES_UOM,PRES_CATG_CODE,TRADE_CODE,TRADE_NAME,CALC_DOSG_BY_FREQ_DURN_YN,IV_INGREDIENT_YN,IV_FLUID_YN,  INFUSE_OVER_VALUE,INFUSE_OVER_DURN_TYPE,FRACT_DOSE_ROUND_UP_YN,CONTENT_IN_PRES_BASE_UOM,PRN_DOSES_PRES_PRD_FILL,STOCK_UOM,STOCK_UOM_DESC,CALC_DEF_DOSAGE_YN,PT_COUN_REQD_YN,FRACT_DOSE_APPL_YN, WEIGHT_REC_APPL_AGE_GROUP,BILLABLE_ITEM_YN BILLABLE_ITEM_YN,DEFAULT_DOSAGE_BY,DRUG_INDICATION, DEFAULT_ROUTE_YN,B.ROUTE_COLOR,DEFAULT_DOSAGE_BY_YN, DISP_ALT_FORM_YN, DRUG_SEARCH_BY  FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW,ph_route_lang_vw b WHERE DRUG_CODE=? AND NVL(trade_code,'X') = DECODE(?,NULL,NVL (trade_code, 'X'),?) AND LANG1 = ?  and PH_DRUG_VW.ROUTE_CODE=B.ROUTE_CODE  and PH_DRUG_VW.LANG1=B.LANGUAGE_ID "); //add DEFAULT_DOSAGE_BY for SKR-CRF-PHIS-003[IN028182],ROUTE_COLOR for RUT-CRF-0034.1[IN:037389]   // DEFAULT_DOSAGE_BY_YN column added for AAKH-CRF-0089 //DRUG_SEARCH_BY added for MMS-DM-CRF-0177
		//DISP_ALT_FORM_YN added for GHL-CRF-0549
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT2A", "SELECT order_catalog_code, or_order_catalog.short_desc,or_order_catalog.order_type_code, security_level, qty_uom,split_dose_yn, taper_dose_yn, taper_up, bill_yn, refill_cont_order_yn,chart_result_type, result_auth_reqd_yn, qty_reqd_yn, consent_reqd_yn,consent_reqd_yn, consent_stage, num_of_consent_req_bo,num_of_consent_req_br,OR_ORDER_TYPE.SHORT_DESC order_type_desc FROM or_order_catalog_lang_vw or_order_catalog, or_order_type_lang_vw or_order_type WHERE order_catalog_code = ? AND or_order_catalog.order_type_code = or_order_type.order_type_code AND or_order_catalog.language_id = ? AND  or_order_type.language_id =? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT_CONSENT_DETAILS", "SELECT CONSENT_REQD_YN,CONSENT_STAGE , NUM_OF_CONSENT_REQ_BO,NUM_OF_CONSENT_REQ_BR  FROM or_order_catalog WHERE order_catalog_code = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT3A", "SELECT ORDER_CATALOG_CODE,PATIENT_CLASS,ORD_AUTH_REQD_YN,ORD_SPL_APPR_REQD_YN,ORD_COSIGN_REQD_YN,QTY_VALUE,QTY_UOM,FREQ_CODE,DURN_VALUE,DURN_TYPE,MAX_DURN_TYPE,CHK_FOR_MAX_DURN_ACTION,PROMPT_MSG,MAX_DURN_VALUE,ORD_AUTH_LEVEL  FROM OR_CATALOG_BY_PTCL_LANG_VW OR_ORDER_CATALOG_BY_PTCL WHERE  ORDER_CATALOG_CODE=?  and SETTING_APPLICABILITY = 'A'   AND patient_class = decode(?,patient_class, patient_class, '*A') AND LANGUAGE_ID = ?");
		//find the allergy drug
		//dataMap.put("SQL_PH_PRESCRIPTION_SELECT4A", "SELECT COUNT(B.ROWID) FROM PH_DRUG A,PR_ALLERGY B WHERE A.DRUG_CODE=? AND A.GENERIC_ID=B.GENERIC_ID AND B.PATIENT_ID=? AND B.ALLERGY_CLASS='D' AND B.CLOSE_DATE IS NULL");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT4A", "select count(*) from (SELECT   a.adv_reac_code allergy_type_code, b.long_desc allergic_indications,  TO_CHAR (reaction_date, 'DD/MM/YYYY') reac_date,reaction_date   FROM pr_adverse_event_reaction a,  am_reaction_lang_vw b,pr_allergy_sensitivity C, PH_DRUG d  WHERE a.adv_event_type in( 'DA','AD')  AND d.DRUG_CODE=? and d.GENERIC_ID=a.allergen_code  AND a.patient_id = ? AND b.reaction_code(+) = a.adv_reac_code  AND b.language_id(+) =? and a.STATUS = 'A' AND A.PATIENT_ID=C.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=C.ADV_EVENT_TYPE_IND AND A.ADV_EVENT_TYPE =C.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =C.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=C.ADV_EVENT_SRL_NO AND C.STATUS = 'A' union ALL SELECT adv_reac_code allergy_type_code, OTHERS_REACTION allergic_indications,  TO_CHAR (reaction_date, 'DD/MM/YYYY') reac_date,reaction_date   FROM pr_adverse_event_reaction a ,pr_allergy_sensitivity C , PH_DRUG d WHERE a.adv_event_type ='DA' AND d.DRUG_CODE=? and d.GENERIC_ID=a.allergen_code AND a.patient_id = ?  AND a.adv_reac_code  ='Oth'and a.STATUS = 'A' AND A.PATIENT_ID=C.PATIENT_ID AND  A.ADV_EVENT_TYPE_IND=C.ADV_EVENT_TYPE_IND AND A.ADV_EVENT_TYPE =C.ADV_EVENT_TYPE AND  A.ALLERGEN_CODE =C.ALLERGEN_CODE AND  A.ADV_EVENT_SRL_NO=C.ADV_EVENT_SRL_NO AND C.STATUS = 'A' )"); 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT5A","SELECT TO_CHAR(( to_date(?,'dd/mm/yyyy hh24:mi') + nvl(order_future_hrs_ahead/24,0)),'dd/mm/yyyy hh24:mi')  FUTURE_DATE,	TO_CHAR((to_date(?,'dd/mm/yyyy hh24:mi') - nvl(order_backdate_hrs_behind/24,0)),'dd/mm/yyyy hh24:mi')  BACK_DATE FROM or_param");
		//find the values from am_frequency
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT6A", "SELECT FREQ_CODE,FREQ_DESC,SCHEDULED_YN,FREQ_NATURE,REPEAT_VALUE, REPEAT_DURN_TYPE, INTERVAL_VALUE,INTERVAL_DURN_TYPE,DECODE(FREQ_NATURE,'F',(CASE WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (24/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='M' AND REPEAT_DURN_TYPE ='M' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE =1 THEN REPEAT_VALUE WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (0) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (0)  END),'I',(CASE WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (24/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='H' AND REPEAT_DURN_TYPE ='H' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN INTERVAL_DURN_TYPE='M' AND REPEAT_DURN_TYPE ='M' AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (REPEAT_VALUE/INTERVAL_VALUE) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE =1 THEN REPEAT_VALUE WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE =1 AND INTERVAL_VALUE <>0 THEN (0) WHEN (INTERVAL_DURN_TYPE =('D') AND REPEAT_DURN_TYPE =('D') OR INTERVAL_DURN_TYPE =('W') AND REPEAT_DURN_TYPE =('W') OR INTERVAL_DURN_TYPE =('L') AND REPEAT_DURN_TYPE =('L')) AND REPEAT_VALUE <>0 AND INTERVAL_VALUE <>0 THEN (0)  END)) FREQ_VALUE FROM AM_FREQUENCY_LANG_VW AM_FREQUENCY WHERE FREQ_CODE =? AND LANGUAGE_ID = ? GROUP BY FREQ_CODE,FREQ_DESC,SCHEDULED_YN, FREQ_NATURE,REPEAT_VALUE, REPEAT_DURN_TYPE, INTERVAL_VALUE, INTERVAL_DURN_TYPE");
		//calculate END date
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT7A", "SELECT TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?)-1 WHEN 'W' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?)*7-1 WHEN 'L' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?)*30-1 END), 'DD/MM/RRRR HH24:MI') END_DATE FROM DUAL");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT7AA", "SELECT TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?) WHEN 'W' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?)*7 WHEN 'L' = ? THEN (TO_DATE(?, 'DD/MM/RRRR HH24:MI')) + TO_NUMBER(?)*30 END), 'DD/MM/RRRR HH24:MI') END_DATE FROM DUAL");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT8A", "SELECT DURN_TYPE,DURN_DESC FROM AM_DURATION_TYPE_LANG_VW AM_DURATION_TYPE WHERE DURN_TYPE=? AND LANGUAGE_ID =?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT9A", "SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT10A", "SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC, A.FREQ_NATURE FROM AM_FREQUENCY_LANG_VW A, OR_FREQ_CATALOG_SCOPE B , am_frequency_admin_day_time c WHERE A.EFF_STATUS='E' AND A.FREQ_NATURE<>'C' AND A.FREQ_CODE = B.FREQ_CODE AND ((A.SCHEDULED_YN='Y' and b.freq_code = c.freq_code and c.admin_facility_id in (?,'*A',?)) OR (a.scheduled_yn = 'N') OR A.FREQ_NATURE IN ('P','O')) AND B.ORDER_CATALOG_CODE=? AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT10A_IP", "SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC, A.FREQ_NATURE FROM AM_FREQUENCY_LANG_VW A, OR_FREQ_CATALOG_SCOPE B , am_frequency_admin_day_time c WHERE A.EFF_STATUS='E' AND (A.FREQ_NATURE<>'C' OR A.FREQ_NATURE<>'I' ) AND A.FREQ_CODE = B.FREQ_CODE AND (A.SCHEDULED_YN='Y' and b.freq_code = c.freq_code and c.admin_facility_id in (?,'*A',?)) AND A.FREQ_NATURE<>'Y' AND B.ORDER_CATALOG_CODE=? AND A.LANGUAGE_ID = ? ORDER BY 2");
//added A.FREQ_NATURE <>'Y' on 12/14/2017
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT10B", "SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC, A.FREQ_NATURE FROM AM_FREQUENCY_LANG_VW A, OR_FREQ_CATALOG_SCOPE B , am_frequency_admin_day_time c WHERE A.EFF_STATUS='E' AND A.FREQ_NATURE<>'C' AND A.FREQ_CODE = B.FREQ_CODE AND ((A.SCHEDULED_YN='Y' and b.freq_code = c.freq_code and c.admin_facility_id in (?,'*A',?)) OR (a.scheduled_yn = 'N') OR A.FREQ_NATURE IN ('P','O')) AND  A.REPEAT_DURN_TYPE IS NOT NULL AND A.INTERVAL_DURN_TYPE IS NOT NULL AND B.ORDER_CATALOG_CODE=? AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT10B_IP", "SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC, A.FREQ_NATURE FROM AM_FREQUENCY_LANG_VW A, OR_FREQ_CATALOG_SCOPE B , am_frequency_admin_day_time c WHERE A.EFF_STATUS='E' AND A.FREQ_NATURE  NOT IN ('C','Y') AND A.FREQ_CODE = B.FREQ_CODE AND ((A.SCHEDULED_YN='Y' and b.freq_code = c.freq_code and c.admin_facility_id in (?,'*A',?)) OR (a.scheduled_yn = 'N') AND A.FREQ_NATURE IN ('I')) AND B.ORDER_CATALOG_CODE=? AND A.LANGUAGE_ID = ? ORDER BY 2");	
		//changed A.FREQ_NATURE<>'C' to	A.FREQ_NATURE NOT IN ('C','Y') on 12/14/2017
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT11A", "SELECT DRUG_CLASS FROM PH_ORDER_TYPE_FOR_DRUG_CLASS WHERE ORDER_TYPE_CODE=? ");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT12A", "SELECT A.SHORT_DESC, A.UOM_CODE, B.DFLT_UOM_YN QTY_UOM_YN FROM AM_UOM_LANG_VW A, PH_UOM_FOR_FORM B WHERE A.UOM_CODE=B.UOM_CODE AND B.FORM_CODE=? AND A.QTY_UOM_YN='Y' AND A.LANGUAGE_ID = ? UNION SELECT B.SHORT_DESC, B.UOM_CODE, C.DFLT_UOM_YN FROM AM_UOM_LANG_VW B, AM_UOM_EQVL A, PH_UOM_FOR_FORM C WHERE A.UOM_CODE IN (SELECT UOM_CODE FROM PH_UOM_FOR_FORM WHERE FORM_CODE=?) AND A.EQVL_UOM_CODE IN (SELECT UOM_CODE FROM PH_UOM_FOR_FORM WHERE FORM_CODE=?) AND A.UOM_CODE=B.UOM_CODE AND C.UOM_CODE=B.UOM_CODE AND C.FORM_CODE=? AND B.LANGUAGE_ID = ? UNION SELECT B.SHORT_DESC, B.UOM_CODE, C.DFLT_UOM_YN FROM AM_UOM_LANG_VW B, AM_UOM_EQVL A, PH_UOM_FOR_FORM C WHERE A.UOM_CODE IN (SELECT UOM_CODE FROM PH_UOM_FOR_FORM WHERE FORM_CODE=?) AND A.EQVL_UOM_CODE IN (SELECT UOM_CODE FROM PH_UOM_FOR_FORM WHERE FORM_CODE=?) AND A.EQVL_UOM_CODE=B.UOM_CODE AND C.UOM_CODE=B.UOM_CODE AND C.FORM_CODE=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT12AA", "SELECT PRES_BASE_UOM UOM_CODE,SHORT_DESC,QTY_UOM_YN   FROM PH_DRUG,AM_UOM  WHERE PH_DRUG.PRES_BASE_UOM=AM_UOM.UOM_CODE AND DRUG_CODE=?  "); 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT13A", "SELECT DURN_TYPE,DURN_DESC FROM AM_DURATION_TYPE_LANG_VW AM_DURATION_TYPE WHERE LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT14A", "SELECT med_admin_reqd_yn, consider_stock_for_pres_yn, allow_pres_without_stock_yn, refill_yn, max_refills_for_pres, max_durn_for_refill_pres, allow_duplicate_drug, mandatory_rem_on_prn_freq_yn, duplicate_check_at_atc_yn, consider_stock_for_pres_yn, allow_pres_without_stock_yn, facility_id, ip_consider_stock_pres_yn, ip_pres_without_stock_yn, disp_charge_dtl_in_drug_lkp_yn, disp_price_type_in_drug_lkp, DRUG_DB_INTERACT_CHECK_YN, drug_db_duptherapy_yn, drug_db_allergy_check_yn,DRUG_DB_CONTRAIND_CHECK_YN,DRUG_DB_DOSECHECK_YN, atc_allergy_alert_level, allow_duplicate_drug_op, drug_db_interface_yn FROM ph_facility_param WHERE facility_id = ?");//Modified for IN:071537
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT15A", "SELECT SHORT_DESC, UOM_CODE, QTY_UOM_YN FROM AM_UOM_LANG_VW AM_UOM where (UOM_CODE IN (select PRES_BASE_UOM from ph_drug where drug_code=?) OR UOM_CODE IN (select  STOCK_UOM from ph_drug where drug_code=?)) AND LANGUAGE_ID = ?");
		//calculate the taper dates
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT16A", "SELECT  TO_CHAR((TO_DATE(?, 'dd/mm/yyyy hh24:mi') + 1),'dd/mm/yyyy hh24:mi') START_DATE,TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) + TO_NUMBER(?) + 1  WHEN 'W' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) + (TO_NUMBER(?)*7) +1 WHEN 'L' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) + (TO_NUMBER(?)*30)+1 END), 'dd/mm/yyyy hh24:mi') END_DATE FROM DUAL ");
		//calculate refill details
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT17A", "SELECT TO_CHAR((CASE WHEN 'D' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) +(TO_NUMBER(?)+1)*ROWNUM WHEN 'W' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) +((TO_NUMBER(?)*7)+1)*ROWNUM WHEN 'L' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi')) +((TO_NUMBER(?)*30)+1)*ROWNUM END), 'dd/mm/yyyy hh24:mi') START_DATE ,TO_CHAR( (CASE WHEN 'D' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+((TO_NUMBER(?)+1)*ROWNUM)+TO_NUMBER(?)WHEN 'W' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+(((TO_NUMBER(?)*7)+1)*ROWNUM)+(TO_NUMBER(?)*7) WHEN 'L' = ? THEN (TO_DATE(?, 'dd/mm/yyyy hh24:mi'))+(((TO_NUMBER(?)*30)+1)*ROWNUM)+(TO_NUMBER(?)*30) END), 'dd/mm/yyyy hh24:mi') END_DATE FROM SM_FUNCTION WHERE ROWNUM <= TO_NUMBER(?) ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT18A", "SELECT PH_DrugDoseInLimit(?,?,?,?,?) FROM DUAL");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT19A", "SELECT  REGN_REQD_YN FROM OR_ORDER_TYPE WHERE ORDER_TYPE_CODE=? ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT20A", "select ORDER_STATUS_CODE, ORDER_STATUS_TYPE from or_order_status_code where order_status_type in ('00','01','03','05','10','25','58','56','30','62','64')");		//added 30 for  JD-CRF-0198 [IN:058599] //ML-MMOH-CRF-1823 US008
// Commented for ML-MMOH-CRF-0449(IN057483)  To display details of Non standard regimen in amend screen //sreenadh 1823
		/*dataMap.put("SQL_PH_PRESCRIPTION_TPN_SELECT21A","SELECT d.LONG_NAME SHORT_NAME,d.PRES_BASE_UNIT,d.CONTENT_IN_BASE_UNIT, olph.dosage_type,ot.long_desc,pdp.durn_type,o.patient_id,o.encounter_id,o.ord_pract_id,TO_CHAR (o.ord_date_time, 'dd/mm/yyyy hh24:mi') ord_date_time,pr.practitioner_name,DECODE (o.priority, 'R', 'routine', 'U', 'urgent') priority,o.child_order_yn,o.source_type, o.source_code, o.performing_deptloc_code disp_locn_code, dl.short_desc disp_locn_desc, ol.order_catalog_code drugcode,ol.qty_value, ol.qty_unit, ol.durn_value, ol.catalog_desc,TO_CHAR (ol.start_date_time, 'dd/mm/yyyy hh24:mi') start_date_time, ol.route_code, ro.route_desc, ol.line_fields_display_text,TO_CHAR (ol.end_date_time, 'dd/mm/yyyy hh24:mi') end_date_time, ol.order_line_num, ol.order_qty, ol.order_uom,(SELECT short_desc FROM am_uom WHERE uom_code = ol.qty_unit) short_desc, ol.cont_order_ind,ol.refill_single_cont_order_yn, ol.num_of_refills, ol.parent_order_line_num, pdp.strength, pdp.strength_uom_code strengthuom, diag_text,pdp.allergy_override_reason, pdp.dosage_limit_override_reason, pdp.duplicate_drug_override_reason, PDP.tapered_yn, DECODE (pdp.allergy_override_reason, NULL, 'N', 'Y') allergy_yn, o.order_type_code, ot.short_desc ordertypedesc, pdp.split_dose_preview, o.discharge_ind takehome,DECODE (ol.child_order_yn, 'Y', TO_CHAR (ol.start_date_time, 'dd/mm/yyyy hh24:mi')) refill_start_date_time, DECODE (ol.child_order_yn, 'Y', TO_CHAR (ol.end_date_time, 'dd/mm/yyyy hh24:mi')) refill_end_date_time, pdp.prescribed_mode, pdp.height, pdp.height_uom, pdp.weight,pdp.weight_uom, pdp.bsa, o.patient_class FROM or_order o,or_order_type ot,am_practitioner pr,or_order_line ol,ph_route ro, ph_patient_drug_profile pdp,ph_disp_locn dl, or_order_line_ph olph, ph_tpn_regimen d  WHERE o.order_type_code = ot.order_type_code   AND o.performing_deptloc_code = dl.disp_locn_code  AND o.ord_pract_id = pr.practitioner_id      AND ol.route_code = ro.route_code   AND pdp.orig_order_id = o.order_id AND o.order_id = ol.order_id     AND o.order_id = ?  AND o.patient_id = ?  AND dl.facility_id = ? AND o.order_id = olph.order_id     AND ol.order_line_num = olph.order_line_num AND d.TPN_REGIMEN_CODE = ol.order_catalog_code     AND ol.order_line_num = '1' AND ol.order_line_status IN ('OS', 'RG') ORDER BY ol.order_line_num ");*/
		dataMap.put("SQL_PH_PRESCRIPTION_TPN_SELECT21A","SELECT d.LONG_NAME SHORT_NAME,d.PRES_BASE_UNIT,d.CONTENT_IN_BASE_UNIT, olph.dosage_type,ot.long_desc,pdp.durn_type,o.patient_id,o.encounter_id,o.ord_pract_id,TO_CHAR (o.ord_date_time, 'dd/mm/yyyy hh24:mi') ord_date_time,pr.practitioner_name,DECODE (o.priority, 'R', 'routine', 'U', 'urgent') priority,o.child_order_yn,o.source_type, o.source_code, o.performing_deptloc_code disp_locn_code, dl.short_desc disp_locn_desc, ol.order_catalog_code drugcode,ol.qty_value, ol.qty_unit, ol.durn_value, ol.catalog_desc,TO_CHAR (ol.start_date_time, 'dd/mm/yyyy hh24:mi') start_date_time, ol.route_code, ro.route_desc, ol.line_fields_display_text,TO_CHAR (ol.end_date_time, 'dd/mm/yyyy hh24:mi') end_date_time, ol.order_line_num, ol.order_qty, ol.order_uom,(SELECT short_desc FROM am_uom WHERE uom_code = ol.qty_unit) short_desc, ol.cont_order_ind,ol.refill_single_cont_order_yn, ol.num_of_refills, ol.parent_order_line_num, pdp.strength, pdp.strength_uom_code strengthuom, diag_text,pdp.allergy_override_reason, pdp.dosage_limit_override_reason, pdp.duplicate_drug_override_reason, PDP.tapered_yn, DECODE (pdp.allergy_override_reason, NULL, 'N', 'Y') allergy_yn, o.order_type_code, ot.short_desc ordertypedesc, pdp.split_dose_preview, o.discharge_ind takehome,DECODE (ol.child_order_yn, 'Y', TO_CHAR (ol.start_date_time, 'dd/mm/yyyy hh24:mi')) refill_start_date_time, DECODE (ol.child_order_yn, 'Y', TO_CHAR (ol.end_date_time, 'dd/mm/yyyy hh24:mi')) refill_end_date_time, pdp.prescribed_mode, pdp.height, pdp.height_uom, pdp.weight,pdp.weight_uom, pdp.bsa, o.patient_class FROM or_order o,or_order_type ot,am_practitioner pr,or_order_line ol,ph_route ro, ph_patient_drug_profile pdp,ph_disp_locn dl, or_order_line_ph olph, ph_tpn_regimen d  WHERE o.order_type_code = ot.order_type_code   AND o.performing_deptloc_code = dl.disp_locn_code  AND o.ord_pract_id = pr.practitioner_id      AND ol.route_code = ro.route_code   AND pdp.orig_order_id = o.order_id AND o.order_id = ol.order_id     AND o.order_id = ?  AND o.patient_id = ?  AND dl.facility_id = ? AND o.order_id = olph.order_id     AND ol.order_line_num = olph.order_line_num AND d.TPN_REGIMEN_CODE = ol.order_catalog_code     AND ol.order_line_num = '1' AND ol.order_line_status IN ('OS', 'RG', 'VF') ORDER BY ol.order_line_num ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT21A","SELECT /*+ ORDERED */  D.DRUG_DESC,  D.PRES_BASE_UOM, D.FRACT_DOSE_ROUND_UP_YN,D.CALC_DEF_DOSAGE_YN, D.CONTENT_IN_PRES_BASE_UOM,D.STRENGTH_VALUE,D.STRENGTH_UOM,  D.STRENGTH_PER_PRES_UOM, D.STRENGTH_PER_VALUE_PRES_UOM,D.STOCK_UOM,D.PRN_DOSES_PRES_PRD_FILL,   OLPH.DOSAGE_TYPE,  OT.LONG_DESC,  PDP.DURN_TYPE ,  O.PATIENT_ID,  O.ENCOUNTER_ID,O.ORD_PRACT_ID,  FREQ.SCHEDULED_YN,  DECODE(FREQ.REPEAT_VALUE,  0,  1,  NULL,  1,  FREQ.REPEAT_VALUE) REPEAT_VALUE, FREQ.INTERVAL_VALUE, TO_CHAR(O.ORD_DATE_TIME,  'dd/mm/yyyy hh24:mi')ORD_DATE_TIME,  PR.PRACTITIONER_NAME,  DECODE(OL.PRIORITY,  'R',  'routine',  'U',  'urgent') PRIORITY,  O.CHILD_ORDER_YN,  O.SOURCE_TYPE,  O.SOURCE_CODE,  FREQ.FREQ_CODE,FREQ.INTERVAL_VALUE,  O.PERFORMING_DEPTLOC_CODE DISP_LOCN_CODE ,  DL.SHORT_DESC DISP_LOCN_DESC,  OL.ORDER_CATALOG_CODE DRUGCODE,  OL.QTY_VALUE,  OL.QTY_UNIT,  OL.DURN_VALUE,  DURTYPE.DURN_TYPE DURNTYPE, DURTYPE.DURN_DESC,  OL.CATALOG_DESC,  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')START_DATE_TIME,  FRM.FORM_DESC,  FRM.FORM_CODE, OL.ROUTE_CODE, RO.ROUTE_DESC,  FREQ.FREQ_DESC,  FREQ.FREQ_NATURE,  OL.LINE_FIELDS_DISPLAY_TEXT,  TO_CHAR(OL.END_DATE_TIME,  'dd/mm/yyyy hh24:mi')END_DATE_TIME,  OL.ORDER_LINE_NUM,OL.ORDER_QTY,  OL.ORDER_UOM,   (SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE=OL.QTY_UNIT AND AM_UOM.LANGUAGE_ID = ?) STRENGTH_UOM_DESC,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE=OL.ORDER_UOM AND AM_UOM.LANGUAGE_ID = ?) STOCK_UOM_DESC,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE=OL.QTY_UNIT AND AM_UOM.LANGUAGE_ID = ?) SHORT_DESC,  OL.CONT_ORDER_IND,  OL.REFILL_SINGLE_CONT_ORDER_YN,  OL.NUM_OF_REFILLS,  OL.PARENT_ORDER_LINE_NUM,  PDP.STRENGTH,  PDP.STRENGTH_UOM_CODE STRENGTHUOM,  DIAG_TEXT,  PDP.ALLERGY_OVERRIDE_REASON,  PDP.DOSAGE_LIMIT_OVERRIDE_REASON,  PDP.DUPLICATE_DRUG_OVERRIDE_REASON,  PDP.TAPERED_YN,  GN.GENERIC_ID,  GN.GENERIC_NAME,  DECODE(PDP.ALLERGY_OVERRIDE_REASON,  NULL,  'N',  'Y')ALLERGY_YN ,  O.ORDER_TYPE_CODE,  OT.SHORT_DESC ORDERTYPEDESC,  PDP.SPLIT_YN,  PDP.SPLIT_DOSE_PREVIEW,  O.DISCHARGE_IND TAKEHOME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')) REFILL_START_DATE_TIME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.END_DATE_TIME,  'dd/mm/yyyy hh24:mi')) REFILL_END_DATE_TIME,  PDP.PRESCRIBED_MODE,  PDP.HEIGHT, PDP.HEIGHT_UOM, PDP.WEIGHT, PDP.WEIGHT_UOM, PDP.BSA,O.PATIENT_CLASS, PDP.PRN_REMARKS, PDP.CONTRAIND_OVERRIDE_REASON, PDP.INTERACTION_OVERRIDE_REASON,  D.CALC_DOSG_BY_FREQ_DURN_YN,FRACT_DOSE_APPL_YN,D.ITEM_CODE,OLPH.BL_INCL_EXCL_OVERRIDE_VALUE,OLPH.BL_INCL_EXCL_OVERRIDE_REASON, D.IN_FORMULARY_YN, O.BILL_YN   FROM      OR_ORDER O,OR_ORDER_TYPE_LANG_VW OT,AM_PRACTITIONER_LANG_VW PR,OR_ORDER_LINE OL,   PH_FORM_LANG_VW FRM,PH_ROUTE_LANG_VW RO,PH_GENERIC_NAME_LANG_VW GN,AM_FREQUENCY_LANG_VW FREQ,    AM_DURATION_TYPE_LANG_VW DURTYPE,AM_UOM_LANG_VW UOM,PH_PATIENT_DRUG_PROFILE PDP ,     PH_DISP_LOCN_LANG_VW DL,OR_ORDER_LINE_PH OLPH,PH_DRUG_LANG_VW D WHERE O.ORDER_TYPE_CODE=OT.ORDER_TYPE_CODE AND  O.PERFORMING_DEPTLOC_CODE = DL.DISP_LOCN_CODE AND  O.ORD_PRACT_ID=PR.PRACTITIONER_ID   AND  OL.FORM_CODE=FRM.FORM_CODE AND  OL.ROUTE_CODE=RO.ROUTE_CODE   AND  OL.FREQ_CODE=FREQ.FREQ_CODE AND  OL.DURN_TYPE=DURTYPE.DURN_TYPE AND  OL.QTY_UNIT=UOM.UOM_CODE AND PDP.ORIG_ORDER_LINE_NO=OL.ORDER_LINE_NUM AND  PDP.ORIG_ORDER_ID=O.ORDER_ID AND  O.ORDER_ID=OL.ORDER_ID AND  O.ORDER_ID=? AND  O.PATIENT_ID=? AND  GN.GENERIC_ID=PDP.GENERIC_ID AND    DL.FACILITY_ID=? AND   O.ORDER_ID=OLPH.ORDER_ID AND   D.DRUG_CODE=OL.ORDER_CATALOG_CODE AND OL.ORDER_LINE_NUM = OLPH.ORDER_LINE_NUM AND OT.LANGUAGE_ID = PR.LANGUAGE_ID AND OT.LANGUAGE_ID = FRM.LANGUAGE_ID AND OT.LANGUAGE_ID = RO.LANGUAGE_ID AND OT.LANGUAGE_ID = GN.LANGUAGE_ID AND OT.LANGUAGE_ID = FREQ.LANGUAGE_ID AND OT.LANGUAGE_ID = DURTYPE.LANGUAGE_ID AND OT.LANGUAGE_ID = UOM.LANGUAGE_ID AND OT.LANGUAGE_ID = DL.LANGUAGE_ID AND OT.LANGUAGE_ID = D.LANGUAGE_ID AND OT.LANGUAGE_ID = ?  ");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT21B","SELECT /*+ ORDERED */  D.DRUG_DESC, D.PRES_BASE_UOM, D.FRACT_DOSE_ROUND_UP_YN, D.CONTENT_IN_PRES_BASE_UOM,D.CALC_DEF_DOSAGE_YN, D.STRENGTH_VALUE,D.STRENGTH_UOM,D.STRENGTH_PER_PRES_UOM, D.STRENGTH_PER_VALUE_PRES_UOM,D.STOCK_UOM,  D.PRN_DOSES_PRES_PRD_FILL,  OLPH.DOSAGE_TYPE,  OT.LONG_DESC,  PDP.DURN_TYPE ,  O.PATIENT_ID,  O.ENCOUNTER_ID,  FREQ.SCHEDULED_YN,  DECODE(FREQ.REPEAT_VALUE,  0,  1,  NULL,  1,  FREQ.REPEAT_VALUE) REPEAT_VALUE, FREQ.INTERVAL_VALUE, TO_CHAR(O.ORD_DATE_TIME,  'dd/mm/yyyy hh24:mi')ORD_DATE_TIME,  PR.PRACTITIONER_NAME,  DECODE(OL.PRIORITY,  'R',  'routine',  'U',  'urgent') PRIORITY,  O.CHILD_ORDER_YN,  O.SOURCE_TYPE,  O.SOURCE_CODE, O.ORD_PRACT_ID, FREQ.FREQ_CODE,FREQ.INTERVAL_VALUE,  O.PERFORMING_DEPTLOC_CODE DISP_LOCN_CODE ,  OL.ORDER_CATALOG_CODE DRUGCODE,  OL.QTY_VALUE,  OL.QTY_UNIT,  OL.DURN_VALUE,  DURTYPE.DURN_TYPE DURNTYPE,  DURTYPE.DURN_DESC,  OL.CATALOG_DESC,  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')START_DATE_TIME,  FRM.FORM_DESC,  FRM.FORM_CODE,  OL.ROUTE_CODE,RO.ROUTE_DESC,  FREQ.FREQ_DESC,  FREQ.FREQ_NATURE,  OL.LINE_FIELDS_DISPLAY_TEXT,  TO_CHAR(OL.END_DATE_TIME,  'dd/mm/yyyy hh24:mi')END_DATE_TIME,  OL.ORDER_QTY,   OL.ORDER_LINE_NUM, OL.ORDER_UOM,   (SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM  WHERE UOM_CODE=OL.QTY_UNIT AND AM_UOM.LANGUAGE_ID = ?) STRENGTH_UOM_DESC, (SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE=OL.ORDER_UOM AND AM_UOM.LANGUAGE_ID = ?) STOCK_UOM_DESC, (SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE=OL.QTY_UNIT AND AM_UOM.LANGUAGE_ID = ?) SHORT_DESC, OL.CONT_ORDER_IND,  OL.REFILL_SINGLE_CONT_ORDER_YN,  OL.NUM_OF_REFILLS,  OL.PARENT_ORDER_LINE_NUM,  PDP.STRENGTH,  PDP.STRENGTH_UOM_CODE STRENGTHUOM,  DIAG_TEXT,  PDP.ALLERGY_OVERRIDE_REASON,  PDP.DOSAGE_LIMIT_OVERRIDE_REASON,  PDP.DUPLICATE_DRUG_OVERRIDE_REASON,  PDP.TAPERED_YN,  GN.GENERIC_ID,  GN.GENERIC_NAME,  DECODE(PDP.ALLERGY_OVERRIDE_REASON,  NULL,  'N',  'Y')ALLERGY_YN ,  O.ORDER_TYPE_CODE,  OT.SHORT_DESC ORDERTYPEDESC, PDP.SPLIT_YN,  PDP.SPLIT_DOSE_PREVIEW,  O.DISCHARGE_IND TAKEHOME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')) REFILL_START_DATE_TIME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.END_DATE_TIME, 'dd/mm/yyyy hh24:mi')) REFILL_END_DATE_TIME,  PDP.PRESCRIBED_MODE,  PDP.HEIGHT, PDP.HEIGHT_UOM, PDP.WEIGHT, PDP.WEIGHT_UOM, PDP.BSA,O.PATIENT_CLASS, PDP.PRN_REMARKS,PDP.CONTRAIND_OVERRIDE_REASON, PDP.INTERACTION_OVERRIDE_REASON, D.CALC_DOSG_BY_FREQ_DURN_YN,FRACT_DOSE_APPL_YN,D.ITEM_CODE,OLPH.BL_INCL_EXCL_OVERRIDE_VALUE,OLPH.BL_INCL_EXCL_OVERRIDE_REASON, D.IN_FORMULARY_YN, O.BILL_YN  FROM OR_ORDER O,OR_ORDER_TYPE_LANG_VW OT,AM_PRACTITIONER_LANG_VW PR,OR_ORDER_LINE OL,  PH_FORM_LANG_VW FRM,PH_ROUTE_LANG_VW RO,PH_GENERIC_NAME_LANG_VW GN,AM_FREQUENCY_LANG_VW FREQ, AM_DURATION_TYPE_LANG_VW DURTYPE,AM_UOM_LANG_VW UOM,PH_PATIENT_DRUG_PROFILE PDP , OR_ORDER_LINE_PH OLPH,PH_DRUG_LANG_VW D WHERE  O.ORDER_TYPE_CODE=OT.ORDER_TYPE_CODE  AND   O.ORD_PRACT_ID=PR.PRACTITIONER_ID AND  OL.FORM_CODE=FRM.FORM_CODE   AND  OL.ROUTE_CODE=RO.ROUTE_CODE  AND  OL.FREQ_CODE=FREQ.FREQ_CODE AND  OL.DURN_TYPE=DURTYPE.DURN_TYPE   AND  D.DRUG_CODE=OL.ORDER_CATALOG_CODE  AND  OL.QTY_UNIT=UOM.UOM_CODE AND PDP.ORIG_ORDER_LINE_NO=OL.ORDER_LINE_NUM AND  PDP.ORIG_ORDER_ID=O.ORDER_ID  AND    O.ORDER_ID=OL.ORDER_ID  AND  O.ORDER_ID=?  AND  O.PATIENT_ID=?  AND  GN.GENERIC_ID=PDP.GENERIC_ID AND  O.ORDER_ID=OLPH.ORDER_ID  AND OL.ORDER_LINE_NUM = OLPH.ORDER_LINE_NUM AND OT.LANGUAGE_ID = PR.LANGUAGE_ID AND OT.LANGUAGE_ID = FRM.LANGUAGE_ID AND OT.LANGUAGE_ID = RO.LANGUAGE_ID AND OT.LANGUAGE_ID = GN.LANGUAGE_ID AND OT.LANGUAGE_ID = FREQ.LANGUAGE_ID AND OT.LANGUAGE_ID = DURTYPE.LANGUAGE_ID AND OT.LANGUAGE_ID = UOM.LANGUAGE_ID AND OT.LANGUAGE_ID = D.LANGUAGE_ID AND OT.LANGUAGE_ID = ? " );
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT22B","SELECT PRACT_TYPE FROM AM_PRACTITIONER WHERE PRACTITIONER_ID=?" );
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT23B","SELECT DECODE(ALLERGIC_YN,'Y','yes','no') ALLERGY_YN FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=? AND ORIG_ORDER_ID=?");
		// This SQL is for TPN Order
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT21C","SELECT OL.ORDER_CATALOG_CODE,T.TPN_REGIMEN_CODE, TO_CHAR(O.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') ORD_DATE_TIME,PR.PRACTITIONER_NAME,  DECODE(O.PRIORITY,  'R',  'routine',  'U',  'urgent') PRIORITY ,(SELECT DISTINCT ORDER_LINE_FIELD_VALUE FROM   OR_ORDER_LINE_FIELD_VALUES WHERE   ORDER_ID=O.ORDER_ID AND  ORDEr_LINE_FIELD_MNEMONIC='HEIGHT')  HEIGHT,(SELECT DISTINCT ORDER_LINE_FIELD_VALUE FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=O.ORDER_ID AND  ORDEr_LINE_FIELD_MNEMONIC='WEIGHT')  WEIGHT, (SELECT DISTINCT ORDER_LINE_FIELD_VALUE FROM OR_ORDER_LINE_FIELD_VALUES  WHERE ORDER_ID=O.ORDER_ID AND  ORDEr_LINE_FIELD_MNEMONIC='BSA')  BSA ,FREQ.SCHEDULED_YN,O.DISCHARGE_IND TAKE_HOME FROM PH_TPN_REGIMEN T, OR_ORDER O,OR_ORDER_LINE OL,AM_FREQUENCY FREQ,AM_PRACTITIONER PR WHERE OL.ORDER_ID = O.ORDER_ID AND OL.ORDER_CATALOG_CODE = T.TPN_REGIMEN_CODE AND PR.PRACTITIONER_ID = O.PERFORMING_PRACT_ID AND O.ORDER_ID=? AND OL.FREQ_CODE = FREQ.FREQ_CODE");

		// for IV AMEND
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT21A_IV_AMEND", "SELECT OLP.STRENGTH_UOM, OL.ROUTE_CODE,OLP.STRENGTH_VALUE STRENGTH_PER_PRES_UOM,PD.CONTENT_IN_PRES_BASE_UOM, PD.STRENGTH_PER_VALUE_PRES_UOM,PD.PRES_BASE_UOM, OLP.TOT_INFUSION_OVER, OLP.TOT_INFUSION_OVER_UNIT,OL.ORD_COSIGN_REQD_YN, OL.ORD_APPR_REQD_YN, OL.ORD_AUTH_REQD_YN, OLP.DOSAGE_TYPE, PD.IV_FLUID_YN, PD.IV_INGREDIENT_YN,OT.LONG_DESC,  PDP.DURN_TYPE ,O.PATIENT_ID,  O.ENCOUNTER_ID,  FREQ.SCHEDULED_YN,  DECODE(FREQ.REPEAT_VALUE,  0,  1,  NULL,  1,  FREQ.REPEAT_VALUE) REPEAT_VALUE,  TO_CHAR(O.ORD_DATE_TIME,  'dd/mm/yyyy hh24:mi')ORD_DATE_TIME,  PR.PRACTITIONER_NAME,  DECODE(O.PRIORITY,  'R',  'routine',  'U',  'urgent') PRIORITY,  O.CHILD_ORDER_YN,  O.SOURCE_TYPE,  O.SOURCE_CODE,  O.PERFORMING_DEPTLOC_CODE DISP_LOCN_CODE ,  DL.SHORT_DESC DISP_LOCN_DESC,  OL.ORDER_CATALOG_CODE DRUGCODE,  OL.QTY_VALUE,  OL.QTY_UNIT,  OL.DURN_VALUE,  DURTYPE.DURN_TYPE DURNTYPE,  DURTYPE.DURN_DESC,  OL.CATALOG_DESC,  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')START_DATE_TIME,  FRM.FORM_DESC,  FRM.FORM_CODE,  RO.ROUTE_DESC,FREQ.FREQ_CODE,  FREQ.FREQ_DESC,  FREQ.FREQ_NATURE,  OL.LINE_FIELDS_DISPLAY_TEXT,  TO_CHAR(OL.END_DATE_TIME,  'dd/mm/yyyy hh24:mi')END_DATE_TIME,  OL.ORDER_QTY,  UOM.SHORT_DESC,  OL.CONT_ORDER_IND,  OL.REFILL_SINGLE_CONT_ORDER_YN,  OL.NUM_OF_REFILLS,  OL.PARENT_ORDER_LINE_NUM,  PDP.STRENGTH,  PDP.STRENGTH_UOM_CODE STRENGTHUOM,  DIAG_TEXT,PDP.DIAG_CODE1, PDP.DIAG_CODE2, PDP.DIAG_CODE3,  PDP.ALLERGY_OVERRIDE_REASON,  PDP.DOSAGE_LIMIT_OVERRIDE_REASON,  PDP.DUPLICATE_DRUG_OVERRIDE_REASON, PDP.INFUSE_OVER, PDP.INFUSE_OVER_UNIT, PDP.INFUSION_PER_UNIT, PDP.INFUSION_RATE, PDP.INFUSION_VOL_STR_UNIT, PDP.TAPERED_YN,  GN.GENERIC_ID,  GN.GENERIC_NAME,  DECODE(PDP.ALLERGY_OVERRIDE_REASON,  NULL,  'N',  'Y')ALLERGY_YN ,  O.ORDER_TYPE_CODE,  OT.SHORT_DESC ORDERTYPEDESC,  PDP.SPLIT_DOSE_PREVIEW,  O.DISCHARGE_IND TAKEHOME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')) REFILL_START_DATE_TIME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.END_DATE_TIME,  'dd/mm/yyyy hh24:mi')) REFILL_END_DATE_TIME,  PDP.PRESCRIBED_MODE,  PDP.HEIGHT  HEIGHT,  PDP.WEIGHT  WEIGHT, PDP.BSA  BSA,PDP.HEIGHT_UOM   HEIGHT_UOM,PDP.WEIGHT_UOM   WEIGHT_UOM,O.PATIENT_CLASS ,PDP.INTERACTION_OVERRIDE_REASON,PDP.CONTRAIND_OVERRIDE_REASON, PH_GET_EXT_PROD_DRUG_CODE(PD.DRUG_CODE,?) EXTERNAL_PRODUCT_ID, PDP.DRUG_DB_PRODUCT_ID, OLP.BUILD_MAR_YN, PD.CALC_DEF_DOSAGE_YN, PD.ITEM_CODE FROM    OR_ORDER O,OR_ORDER_TYPE OT,AM_PRACTITIONER PR,OR_ORDER_LINE OL,    PH_FORM FRM,PH_ROUTE RO,PH_GENERIC_NAME GN,AM_FREQUENCY FREQ,   AM_DURATION_TYPE DURTYPE,AM_UOM UOM,PH_PATIENT_DRUG_PROFILE PDP ,  PH_DISP_LOCN DL , PH_DRUG PD ,OR_ORDER_LINE_PH OLP WHERE OL.ORDER_CATALOG_CODE=PD.DRUG_CODE AND O.ORDER_TYPE_CODE=OT.ORDER_TYPE_CODE AND  O.PERFORMING_DEPTLOC_CODE = DL.DISP_LOCN_CODE AND  O.ORD_PRACT_ID=PR.PRACTITIONER_ID   AND  OL.FORM_CODE=FRM.FORM_CODE(+) AND  OL.ROUTE_CODE=RO.ROUTE_CODE(+)   AND  OL.FREQ_CODE=FREQ.FREQ_CODE(+) AND  OL.DURN_TYPE=DURTYPE.DURN_TYPE(+) AND   OLP.STRENGTH_UOM=UOM.UOM_CODE(+) AND    PDP.ORIG_ORDER_ID=O.ORDER_ID AND  O.ORDER_ID=OL.ORDER_ID AND OL.ORDER_ID=OLP.ORDER_ID AND   OL.ORDER_LINE_NUM = OLP.ORDER_LINE_NUM AND  GN.GENERIC_ID = PD.GENERIC_ID AND O.ORDER_ID=? AND  O.PATIENT_ID=? AND  GN.GENERIC_ID=PDP.GENERIC_ID AND DL.FACILITY_ID=?");

		dataMap.put("SQL_PH_PRESCRIPTION_SELECT21B_IV_AMEND", "SELECT  OLP.STRENGTH_UOM,OL.ROUTE_CODE,  OLP.STRENGTH_VALUE STRENGTH_PER_PRES_UOM,PD.CONTENT_IN_PRES_BASE_UOM, PD.STRENGTH_PER_VALUE_PRES_UOM,PD.PRES_BASE_UOM,OLP.TOT_INFUSION_OVER, OLP.TOT_INFUSION_OVER_UNIT,OL.ORD_COSIGN_REQD_YN, OL.ORD_APPR_REQD_YN, OL.ORD_AUTH_REQD_YN, OLP.DOSAGE_TYPE, PD.IV_FLUID_YN, PD.IV_INGREDIENT_YN,OT.LONG_DESC,  PDP.DURN_TYPE ,O.PATIENT_ID,  O.ENCOUNTER_ID,  FREQ.SCHEDULED_YN,  DECODE(FREQ.REPEAT_VALUE,  0,  1,  NULL,  1,  FREQ.REPEAT_VALUE) REPEAT_VALUE,  TO_CHAR(O.ORD_DATE_TIME,  'dd/mm/yyyy hh24:mi')ORD_DATE_TIME,  PR.PRACTITIONER_NAME,  DECODE(O.PRIORITY,  'R',  'routine',  'U',  'urgent') PRIORITY,  O.CHILD_ORDER_YN,  O.SOURCE_TYPE,  O.SOURCE_CODE,    OL.ORDER_CATALOG_CODE DRUGCODE,  OL.QTY_VALUE,  OL.QTY_UNIT,  OL.DURN_VALUE,  DURTYPE.DURN_TYPE DURNTYPE,  DURTYPE.DURN_DESC,  OL.CATALOG_DESC,  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')START_DATE_TIME,  FRM.FORM_DESC,  FRM.FORM_CODE,  RO.ROUTE_DESC,FREQ.FREQ_CODE,  FREQ.FREQ_DESC,  FREQ.FREQ_NATURE,  OL.LINE_FIELDS_DISPLAY_TEXT,  TO_CHAR(OL.END_DATE_TIME,  'dd/mm/yyyy hh24:mi')END_DATE_TIME,  OL.ORDER_QTY,  UOM.SHORT_DESC,  OL.CONT_ORDER_IND,  OL.REFILL_SINGLE_CONT_ORDER_YN,  OL.NUM_OF_REFILLS,  OL.PARENT_ORDER_LINE_NUM,  PDP.STRENGTH,  PDP.STRENGTH_UOM_CODE STRENGTHUOM,  DIAG_TEXT,PDP.DIAG_CODE1, PDP.DIAG_CODE2, PDP.DIAG_CODE3,  PDP.ALLERGY_OVERRIDE_REASON,  PDP.DOSAGE_LIMIT_OVERRIDE_REASON,  PDP.DUPLICATE_DRUG_OVERRIDE_REASON, PDP.INFUSE_OVER, PDP.INFUSE_OVER_UNIT, PDP.INFUSION_PER_UNIT, PDP.INFUSION_RATE, PDP.INFUSION_VOL_STR_UNIT, PDP.TAPERED_YN,  GN.GENERIC_ID,  GN.GENERIC_NAME,  DECODE(PDP.ALLERGY_OVERRIDE_REASON,  NULL,  'N',  'Y')ALLERGY_YN ,  O.ORDER_TYPE_CODE,  OT.SHORT_DESC ORDERTYPEDESC,  PDP.SPLIT_DOSE_PREVIEW,  O.DISCHARGE_IND TAKEHOME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.START_DATE_TIME,  'dd/mm/yyyy hh24:mi')) REFILL_START_DATE_TIME,  DECODE(OL.CHILD_ORDER_YN,  'Y',  TO_CHAR(OL.END_DATE_TIME,  'dd/mm/yyyy hh24:mi')) REFILL_END_DATE_TIME,  PDP.PRESCRIBED_MODE,  PDP.HEIGHT HEIGHT,  PDP.WEIGHT WEIGHT, PDP.BSA BSA,PDP.HEIGHT_UOM HEIGHT_UOM,PDP.WEIGHT_UOM  WEIGHT_UOM,O.PATIENT_CLASS ,PDP.INTERACTION_OVERRIDE_REASON,PDP.CONTRAIND_OVERRIDE_REASON,PH_GET_EXT_PROD_DRUG_CODE(PD.DRUG_CODE,?) EXTERNAL_PRODUCT_ID,PDP.DRUG_DB_PRODUCT_ID, OLP.BUILD_MAR_YN, PD.CALC_DEF_DOSAGE_YN, PD.ITEM_CODE  FROM    OR_ORDER O,OR_ORDER_TYPE OT,AM_PRACTITIONER PR,OR_ORDER_LINE OL,    PH_FORM FRM,PH_ROUTE RO,PH_GENERIC_NAME GN,AM_FREQUENCY FREQ,   AM_DURATION_TYPE DURTYPE,AM_UOM UOM,PH_PATIENT_DRUG_PROFILE PDP ,   PH_DRUG PD ,OR_ORDER_LINE_PH OLP WHERE OL.ORDER_CATALOG_CODE=PD.DRUG_CODE AND O.ORDER_TYPE_CODE=OT.ORDER_TYPE_CODE AND  O.ORD_PRACT_ID=PR.PRACTITIONER_ID   AND  OL.FORM_CODE=FRM.FORM_CODE(+) AND  OL.ROUTE_CODE=RO.ROUTE_CODE(+)   AND  OL.FREQ_CODE=FREQ.FREQ_CODE(+) AND  OL.DURN_TYPE=DURTYPE.DURN_TYPE(+) AND    OLP.STRENGTH_UOM=UOM.UOM_CODE(+) AND     PDP.ORIG_ORDER_ID=O.ORDER_ID AND  O.ORDER_ID=OL.ORDER_ID AND OL.ORDER_ID=OLP.ORDER_ID AND   OL.ORDER_LINE_NUM = OLP.ORDER_LINE_NUM AND GN.GENERIC_ID = PD.GENERIC_ID AND  O.ORDER_ID=? AND  O.PATIENT_ID=? AND  GN.GENERIC_ID=PDP.GENERIC_ID ");
		
		//dataMap.put("SQL_PH_IV_PB_FREQ_DESC","SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A, OR_FREQ_CATALOG_SCOPE B WHERE A.FREQ_CODE=B.FREQ_CODE AND A.SCHEDULED_YN='Y' AND A.EFF_STATUS='E' AND (A.FREQ_NATURE <> 'C' AND A.FREQ_NATURE <>'P') AND A.LANGUAGE_ID = ? ORDER BY FREQ_DESC");
		dataMap.put("SQL_PH_IV_PB_FREQ_DESC","SELECT DISTINCT a.freq_code, a.freq_desc FROM am_frequency_lang_vw a, or_freq_catalog_scope b, am_frequency_admin_day_time c WHERE a.eff_status = 'E' AND (a.freq_nature <> 'C' AND a.freq_nature <> 'P' AND a.freq_nature <> 'O') AND a.freq_code = b.freq_code AND ( ( a.scheduled_yn = 'Y' AND b.freq_code = c.freq_code AND a.repeat_value = (CASE WHEN (SELECT COUNT (*) FROM am_frequency_admin_day_time WHERE freq_code = a.freq_code AND admin_facility_id = ?) = 0 THEN (SELECT COUNT (*) FROM am_frequency_admin_day_time WHERE freq_code = a.freq_code AND admin_facility_id = '*A') ELSE (SELECT COUNT (*) FROM am_frequency_admin_day_time WHERE freq_code = a.freq_code AND admin_facility_id = ?) END ) ) OR a.freq_nature IN ('P', 'O') ) AND b.order_catalog_code = ? AND a.language_id = ? ORDER BY 2");
		dataMap.put("SQL_PH_IV_PB_FREQ_DESC_OP","SELECT DISTINCT a.freq_code, a.freq_desc FROM am_frequency_lang_vw a, or_freq_catalog_scope b, am_frequency_admin_day_time c WHERE a.eff_status = 'E' AND (a.freq_nature <> 'C' AND a.freq_nature <> 'P' AND a.freq_nature <> 'O') AND a.freq_code = b.freq_code AND ( ( a.scheduled_yn = 'Y' AND b.freq_code = c.freq_code AND a.repeat_value = (CASE WHEN (SELECT COUNT (*) FROM am_frequency_admin_day_time WHERE freq_code = a.freq_code AND admin_facility_id = ?) = 0 THEN (SELECT COUNT (*) FROM am_frequency_admin_day_time WHERE freq_code = a.freq_code AND admin_facility_id = '*A') ELSE (SELECT COUNT (*) FROM am_frequency_admin_day_time WHERE freq_code = a.freq_code AND admin_facility_id = ?) END ) ) OR a.freq_nature IN ('P', 'O') ) AND b.order_catalog_code = ? AND a.language_id = ? ORDER BY 2");
		dataMap.put("SQL_PH_IV_PB_MAX_DURN","SELECT MAX_DURN_FOR_OP_PRES OP_DAYS, MAX_DURN_FOR_IP_PRES IP_DAYS FROM PH_PARAM");
		dataMap.put("SQL_PH_IV_PB_FREQ_SEL","SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A, OR_FREQ_CATALOG_SCOPE B WHERE A.FREQ_CODE=B.FREQ_CODE AND A.SCHEDULED_YN='Y' AND A.EFF_STATUS='E' AND (A.FREQ_NATURE <> 'C' AND A.FREQ_NATURE <>'P') AND B.ORDER_CATALOG_CODE IN (?,?) AND A.LANGUAGE_ID = ? ORDER BY FREQ_DESC");

		// Compound Prescriptions
		dataMap.put("SQL_PH_COMP_PRESCRIPTION_SELECT1", "SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A, OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND (A.FREQ_NATURE<>'C' AND A.FREQ_NATURE<>'I') AND A.FREQ_CODE = B.FREQ_CODE AND B.ORDER_CATEGORY = 'PH' AND B.FREQ_SCOPE_YN = 'Y' AND A.SCHEDULED_YN='Y' AND A.LANGUAGE_ID = ? ORDER BY 2");
        dataMap.put("SQL_PH_COMP_PRESCRIPTION_SELECT2","SELECT A.ORDER_CATALOG_CODE,CATALOG_DESC,A.FREQ_CODE,D.REPEAT_VALUE,QTY_VALUE,QTY_UNIT,DURN_VALUE,ORDER_QTY,ORDER_UOM, TO_CHAR(START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE_TIME,TO_CHAR(END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE_TIME, FORM_DESC,B.STRENGTH_VALUE, B.STRENGTH_UOM,ph_get_ext_prod_drug_code(b.drug_code,?)EXTERNAL_PRODUCT_ID ,E.ALLERGY_OVERRIDE_REASON, E.DOSAGE_LIMIT_OVERRIDE_REASON,E.DUPLICATE_DRUG_OVERRIDE_REASON,E.INTERACTION_OVERRIDE_REASON,E.CONTRAIND_OVERRIDE_REASON, F.BUILD_MAR_YN, A.ORDER_LINE_NUM,B.DRUG_INDICATION  FROM OR_ORDER_LINE A,PH_DRUG_LANG_VW B,PH_FORM_LANG_VW C,AM_FREQUENCY_LANG_VW D,PH_PATIENT_DRUG_PROFILE E, OR_ORDER_LINE_PH F  WHERE A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.FORM_CODE=C.FORM_CODE  AND A.FREQ_CODE = D.FREQ_CODE AND  A.ORDER_ID=? AND A.ORDER_ID = F.ORDER_ID and a.order_id=e.orig_order_id and a.order_line_num =e.orig_order_line_no AND b.language_id = c.language_id AND b.language_id = d.language_id AND b.language_id = ? AND F.order_id=e.orig_order_id and f.order_line_num =e.orig_order_line_no ORDER BY A.ORDER_LINE_NUM");//DRUG_INDICATION Added for  ML-BRU-CRF-072[Inc:29938] 
        dataMap.put("SQL_PH_COMP_PRESCRIPTION_AMEND1","UPDATE OR_ORDER_LINE SET QTY_VALUE=?,FREQ_CODE=?,DURN_VALUE=?,ORDER_QTY=?,START_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),END_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),AMD_PRACT_ID=?,AMD_DATE_TIME=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_COMP_PRESCRIPTION_AMEND2","UPDATE OR_ORDER_LINE_PH SET PRES_QTY_VALUE=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_COMP_PRESCRIPTION_AMEND3","UPDATE PH_PATIENT_DRUG_PROFILE SET PRESCRIBED_QTY=?,FREQ_CODE=?,DURATION=?,DURN_TYPE=?,START_DATE=to_date(?, 'dd/mm/yyyy hh24:mi'),END_DATE=to_date(?, 'dd/mm/yyyy hh24:mi'),MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?,DOSAGE_LIMIT_OVERRIDE_REASON=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");

	   // Renew Prescriptions
	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_SELECT1","SELECT TO_CHAR ((CASE WHEN end_date_time < SYSDATE THEN SYSDATE ELSE (end_date_time+(1 / (24 * 60)) ) END ), 'dd/mm/yyyy hh24:mi' ) start_date, TO_CHAR (((CASE WHEN end_date_time < SYSDATE THEN SYSDATE ELSE (end_date_time+(1 / (24 * 60)) ) END ) + ?) , 'dd/mm/yyyy hh24:mi' ) end_date FROM or_order_line WHERE order_id = ? AND order_catalog_code = ?");
	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_SELECT2","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+?,'DD/MM/YYYY HH24:MI') END_DATE FROM DUAL");
	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_SELECT3","SELECT ORDER_LINE_NUM FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_CATALOG_CODE=?");
	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_SELECT4","SELECT TO_CHAR(START_DATE,'DD/MM/YYYY HH24:MI') START_DATE,TO_CHAR(END_DATE,'DD/MM/YYYY HH24:MI') END_DATE FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=? AND DRUG_CODE=? AND START_DATE>=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND discont_date_time IS NULL AND on_hold_date_time IS NULL AND  cancel_yn = 'N' AND cancel_date_time IS NULL AND ROWNUM<=1  ORDER BY START_DATE");	   
	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_SELECT5","SELECT COUNT(*) COUNT FROM DUAL WHERE TO_DATE(?,'DD/MM/YYYY hh24:mi') BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR TO_DATE(?,'DD/MM/YYYY hh24:mi') BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI')");
   	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_SELECT6","SELECT TO_CHAR(END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");	   

	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_INSERT1","INSERT INTO OR_ORDER_LINE_FIELD_VALUES (ORDER_ID, ORDER_LINE_NUM, ORDER_LINE_FIELD_LEVEL, ORDER_LINE_SEQ_NUM, ORDER_LINE_FIELD_MNEMONIC, ORDER_LINE_FIELD_TYPE, ORDER_LINE_LABEL_TEXT, ORDER_LINE_FIELD_VALUE, ORDER_LINE_DOSE_QTY_VALUE, ORDER_LINE_DOSE_QTY_UNIT, ACCEPT_OPTION, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, DEPENDENCY_YN, FORMAT_SEQ_NUM  )  SELECT ?, ORDER_LINE_NUM, ORDER_LINE_FIELD_LEVEL, ORDER_LINE_SEQ_NUM, ORDER_LINE_FIELD_MNEMONIC, ORDER_LINE_FIELD_TYPE, ORDER_LINE_LABEL_TEXT, ORDER_LINE_FIELD_VALUE, ORDER_LINE_DOSE_QTY_VALUE, ORDER_LINE_DOSE_QTY_UNIT, ACCEPT_OPTION, ADDED_BY_ID, SYSDATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, SYSDATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, DEPENDENCY_YN, FORMAT_SEQ_NUM FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? ");
	   dataMap.put("SQL_PH_RENEW_PRESCRIPTION_INSERT2","INSERT INTO OR_ORDER_COMMENT SELECT ?, ?, ORDER_COMMENT, ADDED_BY_ID, SYSDATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, SYSDATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID FROM OR_ORDER_COMMENT WHERE ORDER_ID=? AND ROWNUM<=1 and action_seq_num=?");
	   
	   // Renew IVPrescriptions
	   dataMap.put("SQL_PH_RENEW_IVPRES_SELECT1", "SELECT A.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,A.CATALOG_DESC  CATALOG_DESC,A.FREQ_CODE FREQ_CODE, TO_CHAR(A.START_DATE_TIME,'DD/MM/YYYY HH24:mi')START_DATE_TIME,TO_CHAR(A.END_DATE_TIME,'DD/MM/YYYY hh24:mi') END_DATE_TIME,A.DURN_VALUE DURN_VALUE,A.DURN_TYPE DURN_TYPE,A.QTY_VALUE QTY_VALUE,A.QTY_UNIT QTY_UNIT,B.INFUSE_OVER INFUSE_OVER,B.INFUSION_RATE INFUSION_RATE,B.ORDER_LINE_NUM ORDER_LINE_NUM, B.INFUSION_PER_UNIT INFUSION_PER_UNIT,B.CHNGD_FLUID_REMARKS CHNGD_FLUID_REMARKS,A.ORD_AUTH_REQD_YN, A.ORD_APPR_REQD_YN,A.ORD_COSIGN_REQD_YN, B.BUILD_MAR_YN, d.CALC_DEF_DOSAGE_YN, d.STRENGTH_VALUE, b.DOSAGE_TYPE FROM OR_ORDER_LINE A,OR_ORDER_LINE_PH B, OR_ORDER C, ph_drug d WHERE A.ORDER_ID=C.ORDER_ID AND A.ORDER_ID=B.ORDER_ID AND A.ORDER_LINE_NUM=B.ORDER_LINE_NUM AND d.drug_code = a.order_catalog_code AND A.ORDER_ID=? ORDER BY A.ORDER_LINE_NUM");
       
       // Amend IVPrescriptions
	   dataMap.put("SQL_PH_AMEND_IVPRES_SELECT1","select count(*) count from ph_medn_admin where order_id=? and encounter_id=? and (administered_yn='Y' or admin_recorded_yn='Y')");

       dataMap.put("SQL_PH_AMEND_IVPRES__UPDATE1","UPDATE OR_ORDER SET IV_PREP_YN=?, PERFORMING_DEPTLOC_CODE = NVL(?,PERFORMING_DEPTLOC_CODE), MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ORDER_ID=?"); 
	   dataMap.put("SQL_PH_AMEND_IVPRES__UPDATE2"," UPDATE OR_ORDER_LINE SET FREQ_CODE=?,DURN_VALUE=?,DURN_TYPE=?,START_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),END_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),ORDER_QTY=?,ORDER_UOM=?,AMD_PRACT_ID=?,AMD_DATE_TIME=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,ORDER_CATALOG_CODE=?,CATALOG_DESC=?,CATALOG_SYNONYM=?,ORDER_TYPE_CODE=?,FORM_CODE=?,ROUTE_CODE=?,QTY_VALUE=?,QTY_UNIT=?,CATALOG_SYNONYM_DC=?,CATALOG_SYNONYM_AD=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=? ");
       dataMap.put("SQL_PH_AMEND_IVPRES__UPDATE3"," UPDATE OR_ORDER_LINE_PH SET SPLIT_DRUG_PREVIEW=?,TOT_STRENGTH=?,TOT_STRENGTH_UOM=?,INFUSE_OVER=?,INFUSE_OVER_UNIT=?,INFUSION_RATE=?,INFUSION_VOL_STR_UNIT=?,INFUSION_PER_UNIT=?,BMS_QTY=?,BMS_STRENGTH=?,SPLIT_DOSE_YN=?,PRES_QTY_VALUE=?,PRES_QTY_UOM=?,TOT_INFUSION_OVER=?,TOT_INFUSION_OVER_UNIT=?,AMEND_REASON_CODE=?,AMEND_REASON=?,CHNGD_FLUID_REMARKS=?,ADMIN_RATE_DETAIL=?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, BUILD_MAR_YN=? ,ABUSE_EXISTS=?,ABUSE_DRUG_OVERRIDE_REASON=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=? ");
	   dataMap.put("SQL_PH_AMEND_IVPRES__UPDATE4","UPDATE PH_PATIENT_DRUG_PROFILE SET START_DATE=to_date(?, 'dd/mm/yyyy hh24:mi'),END_DATE=to_date(?, 'dd/mm/yyyy hh24:mi'),SPLIT_YN=?,SPLIT_DOSE_PREVIEW=?,FREQ_CODE=?,DURN_TYPE=?,DURATION=?,PRESCRIBED_QTY=?,IV_PREP_YN=?,INFUSE_OVER=?,INFUSE_OVER_UNIT=?,INFUSION_RATE=?,INFUSION_VOL_STR_UNIT=?,INFUSION_PER_UNIT=?,AMENDED_YN=?,AMEND_BY_ID=?,AMEND_DATE_TIME=SYSDATE,TOT_ISSUED_QTY=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,STRENGTH=?,STRENGTH_UOM_CODE=?,DOSAGE=?,DOSAGE_UOM_CODE=?,PRESCRIBED_MODE=?,DRUG_CODE=?,GENERIC_ID=?,IV_INGREDIENTS=?,ALLERGY_OVERRIDE_REASON=?,DOSAGE_LIMIT_OVERRIDE_REASON=?,DUPLICATE_DRUG_OVERRIDE_REASON=?,INTERACTION_OVERRIDE_REASON=?,CONTRAIND_OVERRIDE_REASON=?,ABUSE_EXISTS=?, ABUSE_DRUG_OVERRIDE_REASON=?  WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
	    dataMap.put("SQL_PH_AMEND_IVPRES__UPDATE5"," UPDATE OR_ORDER_LINE SET FREQ_CODE=?,DURN_VALUE=?,DURN_TYPE=?,START_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),END_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),ORDER_QTY=?,ORDER_UOM=?,AMD_PRACT_ID=?,AMD_DATE_TIME=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,QTY_VALUE=?,QTY_UNIT=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=? ");
	   dataMap.put("SQL_PH_AMEND_IVPRES_SELECT2","select fract_dose_round_up_yn,content_in_pres_base_uom,strength_per_pres_uom,strength_per_value_pres_uom from ph_drug where drug_code=?");
	   dataMap.put("SQL_PH_AMEND_IVPRES_SELECT3","select interval_value,repeat_value from am_frequency where freq_code=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT22A", "SELECT Ph_Readlob(?) ORDER_COMMENT FROM DUAL");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT23A", "SELECT CHK_FOR_MAX_DURN_ACTION,PROMPT_MSG,MAX_DURN_VALUE FROM OR_ORDER_CATALOG_BY_PTCL WHERE  ORDER_CATALOG_CODE=? AND PATIENT_CLASS=?");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT24A", "SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+?,'DD/MM/YYYY')||' '||? FROM DUAL");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT24B", "SELECT    TO_CHAR (TO_DATE (?, 'DD/MM/YYYY HH24:MI') + ?, 'DD/MM/YYYY') || ' '|| ? scheduled_date_time FROM DUAL  WHERE    to_date(TO_CHAR (TO_DATE (?, 'DD/MM/YYYY HH24:MI') +?,'DD/MM/YYYY') || ?, 'DD/MM/YYYY HH24:MI') BETWEEN TO_DATE (?, 'DD/MM/YYYY HH24:MI') AND TO_DATE (?, 'DD/MM/YYYY HH24:MI')- 0.00069");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT25A", "SELECT VERF_REQD_BEF_MED_ADMIN_YN,MED_ADMIN_REQD_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		//end of modification
		dataMap.put("JNDI_PH_PRESCRIPTION", "java:comp/env/Prescription");
		dataMap.put("JNDI_PH_RELEASEPRESCRIPTIONS", "java:comp/env/ReleasePrescriptions");
		dataMap.put("JNDI_PH_CONSUMABLE_ORDER", "java:comp/env/ConsumableOrder");
		//End prescription

		//IV Prescription start
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT1", "SELECT MODULE_ID FROM SM_MODULE WHERE MODULE_ID='ST' AND INSTALL_YN ='Y'");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT2", "SELECT A.CONTENT_IN_PRES_BASE_UOM, A.PRES_BASE_UOM, A.STOCK_UOM, B.SHORT_DESC SHORT_DESC FROM PH_DRUG A, AM_UOM_LANG_VW B WHERE A.DRUG_CODE=? AND A.PRES_BASE_UOM=B.UOM_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT3", "SELECT UOM_CODE, SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE STOCK_UOM_YN='Y' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT4", "SELECT A.EQVL_UOM_CODE, A.EQVL_VALUE, B.SHORT_DESC FROM AM_UOM_EQVL A, AM_UOM_LANG_VW B WHERE A.EQVL_UOM_CODE=B.UOM_CODE AND ((A.EQVL_UOM_CODE=? AND A.UOM_CODE=?) OR (A.UOM_CODE=? AND A.EQVL_UOM_CODE=?)) AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT5", "SELECT A.FREQ_CODE, A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A, OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND (A.FREQ_NATURE<>'C' AND A.FREQ_NATURE<>'P') AND A.FREQ_CODE=B.FREQ_CODE AND B.ORDER_CATEGORY='PH' AND B.FREQ_SCOPE_YN='Y' AND NVL(A.REPEAT_DURN_TYPE,'X')=DECODE(A.FREQ_NATURE,'I','H',NVL(A.REPEAT_DURN_TYPE,'X')) AND NVL(A.INTERVAL_DURN_TYPE,'X')=DECODE(A.FREQ_NATURE,'I','H',NVL(A.INTERVAL_DURN_TYPE,'X')) AND A.LANGUAGE_ID = ? ORDER BY 2");

		// populates Default frequency
		dataMap.put("SQL_PH_DEFAULT_FREQUENCY_SELECT1","SELECT DISTINCT A.FREQ_CODE freq_code,A.FREQ_DESC freq_desc FROM AM_FREQUENCY_LANG_VW A, OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND A.FREQ_CODE = B.FREQ_CODE AND B.ORDER_CATEGORY = 'PH' AND B.FREQ_SCOPE_YN = 'Y' AND A.LANGUAGE_ID = ?");

		// populates continuous frequency
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT5C","SELECT IV_INGREDIENT_YN,IV_FLUID_YN FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT5D","select ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,DUPLICATE_DRUG_OVERRIDE_REASON  FROM OR_ORDER_LINE_PH WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT5A","SELECT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A,OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND A.FREQ_NATURE='C' AND A.FREQ_CODE=B.FREQ_CODE AND  B.ORDER_CATEGORY='PH' AND  B.FREQ_SCOPE_YN='Y' AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT6", "SELECT ORDER_TYPE_CODE FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT6A", "select DRUG_DESC from ph_drug_lang_vw ph_drug where drug_code=? and language_id = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT6B", "select long_name from ph_tpn_regimen_lang_vw ph_tpn_regimen where tpn_regimen_code=? and language_id = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT6C", "SELECT B.ORDER_TYPE_CODE,A.ROUTE_CODE,A.FORM_CODE FROM PH_DRUG A, OR_ORDER_CATALOG B WHERE A.DRUG_CODE = B.ORDER_CATALOG_CODE AND A.DRUG_CODE=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT7", "SELECT REPEAT_VALUE, INTERVAL_VALUE, SCHEDULED_YN, FREQ_NATURE,MAX_NO_OF_CYCLE FROM AM_FREQUENCY WHERE FREQ_CODE=?"); //MAX_NO_OF_CYCLE added for CRF-0345
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT8", "SELECT MED_ADMIN_REQD_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID=UPPER(?)");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT9", "SELECT INFUSE_OVER_VALUE, INFUSE_OVER_DURN_TYPE FROM  PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT10","SELECT A.SHORT_DESC,B.PRES_BASE_UOM FROM AM_UOM_LANG_VW A,PH_DRUG B WHERE B.DRUG_CODE=? AND A.UOM_CODE=B.PRES_BASE_UOM AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT11","SELECT STOCK_UOM,CONTENT_IN_PRES_BASE_UOM FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT12","SELECT MED_ADMIN_REQD_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT13","SELECT count(*) COUNT from PH_MEDN_ADMIN WHERE order_id=? and facility_id=? and ADMIN_RECORDED_YN='Y'");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT14","SELECT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A, OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND A.FREQ_CODE=B.FREQ_CODE AND A.FREQ_NATURE='C' AND B.ORDER_CATEGORY='PH' AND ROWNUM <2 AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT15","SELECT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A, OR_FREQUENCY_SCOPE B WHERE A.FREQ_CODE=B.FREQ_CODE AND A.FREQ_NATURE='P' AND B.ORDER_CATEGORY='PH' AND ROWNUM <2 AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_COMP_FLUID_LIST_FOR_SINGLE_DRUG","select a.fluid_code, b.DRUG_DESC, B.CONTENT_IN_PRES_BASE_UOM, a.DEFAULT_YN, c.trade_code, (SELECT short_name FROM am_trade_name_lang_vw WHERE language_id = ? AND trade_id = c.trade_code) trade_name from PH_DRUG_COMPATIBILITY_FLUID a,PH_DRUG_LANG_VW B, ph_trade_name_for_drug c where a.fluid_code = c.drug_code(+) and c.eff_status(+)='E' and a.drug_code =? and a.fluid_code = b.DRUG_CODE and B.LANGUAGE_ID = ? and a.eff_status='E' AND B.DISCONTINUED_YN='N' order by 2");
		dataMap.put("SQL_PH_COMP_FLUID_LIST_FOR_MULTI_DRUGS","SELECT distinct  a.fluid_code,b.drug_desc, b.content_in_pres_base_uom, a.default_yn, c.trade_code, (SELECT short_name FROM am_trade_name_lang_vw WHERE language_id = ? AND trade_id = c.trade_code) trade_name FROM ph_drug_compatibility_fluid a, ph_drug_lang_vw b, ph_trade_name_for_drug c WHERE a.fluid_code = c.drug_code(+) AND c.eff_status(+) = 'E' AND a.fluid_code = b.drug_code AND a.fluid_code  in (?) AND b.language_id = ? AND a.eff_status = 'E' AND b.discontinued_yn = 'N' ORDER BY 2");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT17","SELECT ORDER_CATALOG_CODE,QTY_VALUE,QTY_UNIT,FREQ_CODE,DURN_VALUE,DURN_TYPE,REQD_OR_OPT_IND, REL_START_DATE_TIME FROM OR_ORDER_SET_COMPONENT WHERE ORDER_SET_CODE=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT18","SELECT DRUG_CODE, ITEM_CODE, DRUG_DESC,FORM_CODE, STRENGTH_VALUE,STRENGTH_UOM,STRENGTH_PER_PRES_UOM, STRENGTH_PER_VALUE_PRES_UOM,PRES_BASE_UOM,ROUTE_CODE,CONTENT_IN_PRES_BASE_UOM FROM PH_DRUG_LANG_VW PH_DRUG WHERE DRUG_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_UPDATE1","UPDATE OR_ORDER SET ORDER_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? ");
		dataMap.put("SQL_PH_IVPRESCRIPTION_UPDATE2","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_UPDATE3","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS=?,DURN_TYPE=?, DURN_VALUE=?, FREQ_CODE=?, ORDER_QTY=?, ORDER_UOM=?, QTY_VALUE=?,QTY_UNIT=?,  START_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),END_DATE_TIME=to_date(?, 'dd/mm/yyyy hh24:mi'),MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,LINE_FIELDS_DISPLAY_TEXT=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		// For Order Line Ph
		dataMap.put("SQL_PH_IVPRESCRIPTION_UPDATE4","UPDATE OR_ORDER_LINE_PH SET  DOSAGE_TYPE=?, STRENGTH_VALUE=?, STRENGTH_UOM=?, ALLERGY_OVERRIDE_REASON=?, DOSAGE_LIMIT_OVERRIDE_REASON=?,	DUPLICATE_DRUG_OVERRIDE_REASON=?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,SPLIT_DRUG_PREVIEW=?,INFUSE_OVER=?,INFUSE_OVER_UNIT=?,INFUSION_RATE=?,INFUSION_VOL_STR_UNIT=?,INFUSION_PER_UNIT=?,TOT_STRENGTH=?,TOT_STRENGTH_UOM=?,SPLIT_DOSE_YN=?,QTY_VALUE_SPLIT_DOSE=?,QTY_UNIT_SPLIT_DOSE=?,TOT_INFUSION_OVER=?,TOT_INFUSION_OVER_UNIT=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		// For Patient Drug Profile
		dataMap.put("SQL_PH_IVPRESCRIPTION_UPDATE5","UPDATE PH_PATIENT_DRUG_PROFILE SET START_DATE=to_date(?, 'dd/mm/yyyy hh24:mi'), END_DATE=to_date(?, 'dd/mm/yyyy hh24:mi'), MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,DIAG_TEXT=?,DIAG_CODE1=?, DIAG_CODE1_CAUSE_IND=?, DIAG_CODE1_SCHEME=?, DIAG_CODE2=?, DIAG_CODE2_CAUSE_IND=?, DIAG_CODE2_SCHEME=?, DIAG_CODE3=?, DIAG_CODE3_CAUSE_IND=?, DIAG_CODE3_SCHEME=?,FREQ_CODE=?,DURATION=?, DURN_TYPE=?,AMENDED_YN=?,AMEND_BY_ID=?,AMEND_DATE_TIME =SYSDATE,PRESCRIBED_MODE=?,PRESCRIBED_QTY=?,SPLIT_DOSE_PREVIEW=?,INFUSE_OVER=?,INFUSE_OVER_UNIT=?,INFUSION_RATE=?,INFUSION_VOL_STR_UNIT=?,INFUSION_PER_UNIT=?,DRUG_REMARKS=?,DOSAGE=?,DOSAGE_UOM_CODE=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=? ");
		dataMap.put("SQL_PH_IVPRESCRIPTION_INSERT1", "INSERT INTO OR_ORDER (ORDER_ID, ORDER_TYPE_CODE, ORDER_CATEGORY, CONTR_SYS_ID, PATIENT_ID, PATIENT_CLASS, ORDERING_FACILITY_ID, ENCOUNTER_ID, EPISODE_ID, EPISODE_VISIT_NUM, SOURCE_TYPE, SOURCE_CODE, DISCHARGE_IND, ORD_DATE_TIME, ORD_PRACT_ID, PRIORITY, ORD_AUTH_REQD_YN, ORD_AUTH_LEVEL, ORD_AUTH_BY_PRACT_ID, ORD_AUTH_DATE_TIME, ORD_APPR_REQD_YN, ORD_APPR_BY_USER_ID, ORD_APPR_DATE_TIME, ORD_COSIGN_REQD_YN, ORD_COSIGN_LEVEL, ORD_COSIGN_BY_PRACT_ID, ORD_COSIGN_DATE_TIME, ORD_PRINT_DATE_TIME, BILL_YN, CONT_ORDER_IND, PERFORMING_FACILITY_ID, PERFORMING_SYS_ID, PERFORMING_DEPTLOC_TYPE, PERFORMING_DEPTLOC_CODE, PERFORMING_PRACT_ID, RESULT_AUTH_REQD_YN, CHILD_ORDER_YN, PARENT_ORDER_ID, ORDER_SET_YN, ORDER_SET_ID, IV_PREP_YN, ORDER_FIELDS_DISPLAY_TEXT, ORDER_STATUS, RESULT_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, ORD_CONSENT_REQD_YN, ORD_CONSENT_BY_ID, ORD_CONSENT_BY_DATE_TIME, CAN_REASON, TRN_GROUP_REF) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, to_date(?, 'dd/mm/yyyy hh24:mi'), ?, ?, ?, ?, ?, to_date(?, 'dd/mm/yyyy hh24:mi'), ?, ?, to_date(?, 'dd/mm/yyyy hh24:mi'), ?, ?, ?, to_date(?, 'dd/mm/yyyy hh24:mi'), to_date(?, 'dd/mm/yyyy hh24:mi'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, sysdate, ?, ?, ?, sysdate, ?, ?, ?, ?, to_date(?, 'dd/mm/yyyy hh24:mi'), ?,?)");
		dataMap.put("SQL_PH_IVPRESCRIPTION_INSERT2", "INSERT INTO PH_MEDN_ADMIN(FACILITY_ID, ENCOUNTER_ID, SCH_DATE_TIME, ORD_DRUG_CODE, DOSAGE_SEQ_NO, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN, IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM, SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT, VERIFY_REQD_YN, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT, administered_yn, MAR_BARCODE_ID) VALUES(?, ?, TO_DATE(?, 'dd/mm/yyyy hh24:mi'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?, ?, ?, 'N',?)");
		/*Added for ML-MMOH-CRF-1225 for PH_MEDN_ADMIN_SCH_DTL Only for Oncology Order*/
		dataMap.put("SQL_PH_IVPRESCRIPTION_INSERT3", "INSERT INTO PH_MEDN_ADMIN_SCH_DTL (FACILITY_ID,ENCOUNTER_ID,SCH_DATE_TIME,ORD_DRUG_CODE,DOSAGE_SEQ_NO,ORDER_ID,ORDER_LINE_NUM,PATIENT_ID,PRACT_ID,SCH_DOSAGE_QTY,SCH_DOSAGE_UOM_CODE,SCH_STRENGTH,SCH_STRENGTH_UOM,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_IVPRESCRIPTION_DELETE_MEDN_ADMIN", "DELETE FROM PH_MEDN_ADMIN WHERE ORDER_ID=? AND FACILITY_ID=? ");
		/*Added for ML-MMOH-CRF-1225 for PH_MEDN_ADMIN_SCH_DTL Only for Oncology Order*/
		dataMap.put("SQL_PH_IVPRESCRIPTION_DELETE_PH_MEDN_ADMIN_SCH_DTL", "DELETE FROM PH_MEDN_ADMIN_SCH_DTL WHERE ORDER_ID=? AND FACILITY_ID=? ");
		dataMap.put("SQL_PH_IVPRESCRIPTION_DELETE_OR_ORDER_COMMENT", "DELETE FROM OR_ORDER_COMMENT WHERE ORDER_ID=? AND ACTION_SEQ_NUM=? ");
		dataMap.put("SQL_PH_IVPRESCRIPTION_DURN_TYPE_SELECT","SELECT DURN_TYPE FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_GET_NEXT_DAY","select TO_CHAR(TO_DATE(?,'dd/mm/yyyy HH24:MI')+1,'DD/MM/YYYY HH24:MI') nextday from dual");
		dataMap.put("SQL_PH_IVPRESCRIPTION_FIELD_VALUES","SELECT COUNT(*) COUNT FROM or_order_line_field_values WHERE order_id=? AND order_line_num =? AND ORDER_LINE_SEQ_NUM<200");
		dataMap.put("SQL_PH_IVPRESCRIPTION_IS_SCHEDULED","SELECT COUNT(*) COUNT FROM or_order_line_field_values WHERE order_id=? AND order_line_num =? AND ORDER_LINE_SEQ_NUM>=200 AND ORDER_LINE_FIELD_MNEMONIC='SCHED_ADMIN_TIME' ");
		dataMap.put("SQL_PH_IVPRESCRIPTION_GET_SCHEDULE","SELECT ORDER_LINE_FIELD_VALUE, ORDER_LINE_DOSE_QTY_VALUE, ORDER_LINE_DOSE_QTY_UNIT FROM or_order_line_field_values WHERE order_id=? AND order_line_num =? AND ORDER_LINE_SEQ_NUM>=200 AND ORDER_LINE_FIELD_MNEMONIC='SCHED_ADMIN_TIME' ");

		dataMap.put("JNDI_PH_IVPRESCRIPTION", "java:comp/env/IVPrescription");
		//IV Prescription end

		dataMap.put("SQL_PH_GENERIC_NAME_QUERY_SELECT1", "SELECT COUNT(A.GENERIC_ID) CNT,A.GENERIC_ID, G.GENERIC_NAME, G.EFF_STATUS, DECODE(G.DRUG_CLASS,'G','General','N','Narcotics','C','Controlled') DRUG_CLASS FROM PH_GENERIC_NAME_BY_ATC_CLASS A, PH_GENERIC_NAME_LANG_VW G WHERE A.GENERIC_ID(+) = G.GENERIC_ID  AND G.GENERIC_ID = NVL(?,G.GENERIC_ID) AND UPPER(G.GENERIC_NAME) LIKE UPPER(?) AND G.DRUG_CLASS = NVL(?,G.DRUG_CLASS) AND G.EFF_STATUS='E' AND G.LANGUAGE_ID = ? GROUP BY G.GENERIC_NAME,A.GENERIC_ID, G.EFF_STATUS,G.DRUG_CLASS,ROWNUM HAVING ROWNUM <= ? ORDER BY GENERIC_NAME");
		dataMap.put("SQL_PH_DRUG_QUERY_SELECT1", "SELECT DRUG_CODE CODE, DRUG_DESC DESCRIPTION FROM PH_DRUG_LANG_VW PH_DRUG WHERE  UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DISCONTINUED_YN='Y' AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DRUG_QUERY_SELECT2", "SELECT A.DRUG_CODE DRUG_CODE, A.DRUG_DESC DRUG_DESC, C.GENERIC_NAME GENERIC_NAME, A.STRENGTH_VALUE STRENGTH_VALUE,G.SHORT_DESC STRENGTH_UOM_DESC, D.FORM_DESC FORM_DESC, E.ROUTE_DESC ROUTE_DESC, TO_CHAR (A.DISCONTINUED_DATE, 'DD/MM/YYYY HH24:MI') DISCONTINUED_DATE, A.DISCONTINUED_REASON DISCONTINUED_REASON, A.DISCONTINUED_BY_ID DISCONTINUED_BY_ID FROM PH_DRUG_LANG_VW A, PH_GENERIC_NAME_LANG_VW C, AM_UOM_LANG_VW G, PH_FORM_LANG_VW D, PH_ROUTE_LANG_VW E WHERE A.GENERIC_ID = C.GENERIC_ID AND A.STRENGTH_UOM = G.UOM_CODE(+) AND A.FORM_CODE = D.FORM_CODE AND A.ROUTE_CODE = E.ROUTE_CODE AND A.DRUG_CODE LIKE UPPER (?) AND UPPER(A.DRUG_DESC) LIKE UPPER (?) AND A.DRUG_CLASS LIKE (?) AND DISCONTINUED_YN = 'Y' AND DISCONTINUED_DATE BETWEEN TO_DATE (NVL (?, '01/01/1472'), 'DD/MM/YYYY') AND TO_DATE (NVL (?, '31/12/5000'), 'DD/MM/YYYY') + 0.99999  AND A.LANGUAGE_ID = C.LANGUAGE_ID AND A.LANGUAGE_ID = D.LANGUAGE_ID AND A.LANGUAGE_ID = E.LANGUAGE_ID  AND A.LANGUAGE_ID = G.LANGUAGE_ID(+) AND A.LANGUAGE_ID = ? ORDER BY DRUG_DESC");
		dataMap.put("SQL_PH_DRUGS_BY_DISP_LOCN_SELECT1", "SELECT DRUG_CODE CODE, DRUG_DESC DESCRIPTION FROM PH_DRUG WHERE UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DISCONTINUED_YN='N' ORDER BY 2");
		dataMap.put("SQL_PH_DRUGS_BY_DISP_LOCN_SELECT2", "SELECT DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN WHERE FACILITY_ID= UPPER(?)");
		dataMap.put("SQL_PH_DRUGS_BY_DISP_LOCN_SELECT3", "SELECT A.DRUG_CLASS, A.DRUG_CODE, A.DRUG_DESC DRUG_NAME,A.STRENGTH_VALUE, A.STRENGTH_UOM_DESC,A.FORM_DESC,A.ROUTE_DESC,A.PRES_BASE_UOM_DESC FROM PH_DRUG_VW A, PH_DISP_LOCN B WHERE B.FACILITY_ID= ? AND A.DRUG_CODE=NVL(?,A.DRUG_CODE) AND B.DISP_LOCN_CODE=NVL(?,B.DISP_LOCN_CODE) AND A.DRUG_CLASS=NVL(?,A.DRUG_CLASS) AND (A.DRUG_CLASS=(CASE WHEN B.DISP_GENL_DRUG_YN='Y' THEN 'G' ELSE 'X' END) OR A.DRUG_CLASS=(CASE WHEN B.DISP_NARCOTICS_DRUG_YN='Y' THEN 'N' ELSE 'X' END) OR A.DRUG_CLASS=(CASE WHEN B.DISP_CONTROLLED_DRUG_YN='Y' THEN 'C' ELSE 'X' END)) GROUP BY A.DRUG_CLASS, A.DRUG_CODE,A.DRUG_DESC,A.STRENGTH_VALUE,A.STRENGTH_UOM_DESC,A.FORM_DESC,A.ROUTE_DESC,A.PRES_BASE_UOM_DESC ORDER BY A.DRUG_CLASS");
		dataMap.put("SQL_PH_DRUGS_BY_DISP_LOCN_SELECT4", "SELECT SHORT_DESC FROM PH_DISP_LOCN WHERE FACILITY_ID= ? AND DECODE(?, 'G',DISP_GENL_DRUG_YN,'N',DISP_NARCOTICS_DRUG_YN,'C',DISP_CONTROLLED_DRUG_YN)='Y'");
		dataMap.put("SQL_PH_DRUGS_BY_DISP_LOCN_SELECT5", "SELECT DRUG_CLASS FROM PH_DRUG_VW WHERE DRUG_CODE =?");
		dataMap.put("SQL_PH_DRUG_ORDER_CAT_NOT_LINK_SELECT1", "SELECT DRUG_CODE CODE, DRUG_DESC DESCRIPTION FROM PH_DRUG_LANG_VW PH_DRUG WHERE  UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND UPPER(DISCONTINUED_YN)='N' AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DRUG_ORDER_CAT_NOT_LINK_SELECT2", "SELECT A.DRUG_CODE, A.DRUG_DESC, A.STRENGTH_VALUE, D.SHORT_DESC STRENGTH_UOM_DESC, B.FORM_DESC, C.ROUTE_DESC, E.SHORT_DESC PRES_BASE_UOM_DESC FROM PH_DRUG_LANG_VW A, PH_FORM_LANG_VW B, PH_ROUTE_LANG_VW C, AM_UOM_LANG_VW D, AM_UOM_LANG_VW E  WHERE EXISTS (SELECT 1 FROM OR_ORDER_CATALOG B WHERE A.DRUG_CODE = B.ORDER_CATALOG_CODE AND B.ORDER_CATEGORY = 'PH') AND A.DRUG_CODE = NVL (?, A.DRUG_CODE) AND A.FORM_CODE = B.FORM_CODE AND A.ROUTE_CODE = C.ROUTE_CODE AND A.STRENGTH_UOM = D.UOM_CODE(+) AND A.PRES_BASE_UOM = E.UOM_CODE(+) AND UPPER (A.DRUG_DESC) LIKE UPPER (?) AND A.DRUG_CLASS = NVL (?, A.DRUG_CLASS) AND A.DISCONTINUED_YN = 'N' AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = C.LANGUAGE_ID AND A.LANGUAGE_ID = D.LANGUAGE_ID(+) AND A.LANGUAGE_ID = E.LANGUAGE_ID(+) AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_ORDER_CAT_NOT_LINK_SELECT3", "SELECT A.DRUG_CODE, A.DRUG_DESC, A.STRENGTH_VALUE, D.SHORT_DESC STRENGTH_UOM_DESC, B.FORM_DESC, C.ROUTE_DESC, E.SHORT_DESC PRES_BASE_UOM_DESC FROM PH_DRUG_LANG_VW A, PH_FORM_LANG_VW B, PH_ROUTE_LANG_VW C, AM_UOM_LANG_VW D, AM_UOM_LANG_VW E WHERE NOT EXISTS (SELECT 1 FROM OR_ORDER_CATALOG B WHERE A.DRUG_CODE = B.ORDER_CATALOG_CODE AND B.ORDER_CATEGORY = 'PH') AND A.DRUG_CODE = NVL (?, A.DRUG_CODE) AND A.FORM_CODE = B.FORM_CODE AND A.ROUTE_CODE = C.ROUTE_CODE AND A.STRENGTH_UOM = D.UOM_CODE(+) AND A.PRES_BASE_UOM = E.UOM_CODE(+) AND UPPER (A.DRUG_DESC) LIKE UPPER (?) AND A.DRUG_CLASS = NVL (?, A.DRUG_CLASS) AND A.DISCONTINUED_YN = 'N' AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = C.LANGUAGE_ID AND A.LANGUAGE_ID = D.LANGUAGE_ID(+) AND A.LANGUAGE_ID = E.LANGUAGE_ID(+) AND A.LANGUAGE_ID = ? ORDER BY 2");

		// Drug Profile Query
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT1", "SELECT PATIENT_CLASS, SHORT_DESC FROM AM_PATIENT_CLASS_LANG_VW AM_PATIENT_CLASS WHERE LANGUAGE_ID = ? ORDER BY 2");	
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT2", "SELECT   /*+ NO_EXPAND */A.ORIG_ORDER_ID, A.ORIG_ORDER_LINE_NO, A.SRL_NO, A.IV_PREP_YN, Q.IV_PREP_YN LINE_IV_PREP_YN, Q.DISCHARGE_IND, O.ORDER_LINE_STATUS, O.CHILD_ORDER_YN, A.INFUSE_OVER, A.TRN_TYPE_IND, A.DRUG_CODE, C.DRUG_DESC, A.DISPENSED_DRUGS, A.ROUTE_CODE, decode(A.IV_PREP_YN,'6',' ',F.ROUTE_DESC) ROUTE_DESC, A.DOSAGE || ' ' || G.SHORT_DESC || ' , ' || CHR (13) || DECODE (A.SPLIT_YN, 'Y', NULL, H.FREQ_DESC || ' , ') || CHR (13) || DURATION || ' ' || I.DURN_DESC DOSAGE_DETAILS, TO_CHAR (A.START_DATE, 'DD/MM/YYYY HH24:MI') START_DATE, TO_CHAR (A.END_DATE, 'DD/MM/YYYY HH24:MI') END_DATE, A.PATIENT_CLASS, D.PATIENT_NAME, E.PRACTITIONER_NAME, J.FACILITY_NAME, DECODE (P.ASSIGN_CARE_LOCN_TYPE, NULL, M.SHORT_DESC,'N', L.SHORT_DESC, 'C', K.SHORT_DESC ) LOCATION,(CASE WHEN Q.CAN_REASON IS NOT NULL  THEN 'HOLD' WHEN O.CAN_DATE_TIME IS NOT NULL  THEN 'CANCEL' WHEN O.HOLD_DATE_TIME IS NOT NULL THEN 'HOLD' WHEN O.DISC_DATE_TIME IS NOT NULL THEN 'DIS-CONTINUED' WHEN SYSDATE BETWEEN A.START_DATE AND A.END_DATE AND (NVL (A.TOT_ISSUED_QTY, 0) - NVL (A.RETURNED_QTY, 0)) != 0 THEN 'ACTIVE' ELSE 'INACTIVE' END ) STATUS, (SELECT COUNT (*) FROM OR_ORDER_LINE_FIELD_VALUES B  WHERE B.ORDER_ID = A.ORIG_ORDER_ID  AND B.ORDER_LINE_NUM = A.ORIG_ORDER_LINE_NO) REMARKS, S.PRES_QTY_UOM PRES_BASE_UOM, O.LAST_ACTION_REASON_DESC, A.HEIGHT, A.HEIGHT_UOM, A.WEIGHT, A.WEIGHT_UOM, A.BSA, A.BMI, A.PRESCRIBED_QTY, A.TOT_ISSUED_QTY, A.RETURNED_QTY, A.TOT_ADMINISTERED_QTY, A.DOSAGE_UOM_CODE, A.REISSUED_QTY, TO_CHAR (A.REISSUE_DATE_TIME,        'DD/MM/YYYY HH24:MI') REISSUE_DATE_TIME, A.REISSUE_REASON_CODE, O.ORDER_UOM, TO_CHAR (A.RETURN_DATE_TIME, 'DD/MM/YYYY HH24:MI') RETURN_DATE_TIME, (NVL (A.TOT_ISSUED_QTY, 0) - NVL (A.RETURNED_QTY, 0)) RET_DIFF, C.STRENGTH_PER_VALUE_PRES_UOM, C.CONTENT_IN_PRES_BASE_UOM,R.SHORT_DESC LINE_STATUS_DESC, (select FORMULARY_ITEM_YN from or_order_line_ph where order_id = o.order_id and order_line_num = o.order_line_num) FORMULARY_ITEM_YN,  a.SLIDING_SCALE_YN, a.SLIDING_SCALE_ADM_UNIT, a.SLIDING_SCALE_ADM_UOM,ph_get_alternates(A.ORIG_ORDER_ID, A.ORIG_ORDER_LINE_NO) alternates FROM PH_PATIENT_DRUG_PROFILE A, PH_GENERIC_NAME_LANG_VW B, PH_DRUG_LANG_VW C, MP_PATIENT D, AM_PRACTITIONER_LANG_VW E, PH_ROUTE_LANG_VW F, AM_UOM_LANG_VW G, AM_FREQUENCY_LANG_VW H, AM_DURATION_TYPE_LANG_VW I, SM_FACILITY_PARAM_LANG_VW J, OP_CLINIC_LANG_VW K, IP_NURSING_UNIT_LANG_VW L, AM_REFERRAL_LANG_VW M, OR_ORDER_LINE O, PR_ENCOUNTER P, OR_ORDER Q,OR_ORDER_STATUS_CODE_LANG_VW R ,or_order_line_ph s  WHERE Q.ORDER_ID = O.ORDER_ID AND A.PATIENT_ID = ? AND A.PATIENT_CLASS BETWEEN NVL (?, '!') AND NVL (?, '~') AND A.START_DATE BETWEEN TO_DATE(NVL (?,'01/01/1472'), 'DD/MM/YYYY')   AND TO_DATE(NVL (?,'31/12/5000'), 'DD/MM/YYYY') + 0.99999 AND A.GENERIC_ID BETWEEN NVL (?, '!') AND NVL (?, '~') AND A.DRUG_CODE BETWEEN NVL (?, '!') AND NVL (?, '~') AND A.GENERIC_ID = B.GENERIC_ID AND D.PATIENT_ID = A.PATIENT_ID AND A.DRUG_CODE = C.DRUG_CODE AND E.PRACTITIONER_ID = A.PRES_PRACTITIONER_ID AND F.ROUTE_CODE = A.ROUTE_CODE AND G.UOM_CODE = A.DOSAGE_UOM_CODE AND H.FREQ_CODE = A.FREQ_CODE AND I.DURN_TYPE = A.DURN_TYPE AND J.FACILITY_ID = A.ORIG_FACILITY_ID AND K.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND K.CLINIC_CODE(+) = A.LOCN_CODE AND  M.REFERRAL_CODE(+) = A.LOCN_CODE AND L.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND L.NURSING_UNIT_CODE(+) = A.LOCN_CODE AND A.ORIG_ORDER_ID = O.ORDER_ID AND A.ORIG_ORDER_LINE_NO = O.ORDER_LINE_NUM AND P.ENCOUNTER_ID(+) = A.ENCOUNTER_ID AND P.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND O.ORDER_LINE_STATUS = R.ORDER_STATUS_CODE and o.order_id=s.order_id and O.ORDER_LINE_NUM=s.ORDER_LINE_NUM AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = H.LANGUAGE_ID AND B.LANGUAGE_ID = I.LANGUAGE_ID AND B.LANGUAGE_ID = J.LANGUAGE_ID AND B.LANGUAGE_ID = R.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND K.LANGUAGE_ID(+) = ? AND L.LANGUAGE_ID(+) = ? AND M.LANGUAGE_ID(+) = ? ");

		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT2B", " SELECT /*+ NO_EXPAND */A.ORIG_ORDER_ID, A.ORIG_ORDER_LINE_NO, A.SRL_NO, A.IV_PREP_YN, Q.IV_PREP_YN LINE_IV_PREP_YN, Q.DISCHARGE_IND, O.ORDER_LINE_STATUS, O.CHILD_ORDER_YN, A.INFUSE_OVER, A.TRN_TYPE_IND, A.DRUG_CODE, C.DRUG_DESC, A.DISPENSED_DRUGS, F.ROUTE_CODE, decode(A.IV_PREP_YN,'6',' ',F.ROUTE_DESC) ROUTE_DESC,    A.DOSAGE || ' ' || G.SHORT_DESC || ' , ' || CHR (13) || DECODE (A.SPLIT_YN, 'Y', NULL, H.FREQ_DESC || ' , ') || CHR (13) || DURATION || ' ' || I.DURN_DESC DOSAGE_DETAILS, TO_CHAR (A.START_DATE, 'DD/MM/YYYY HH24:MI') START_DATE, TO_CHAR (A.END_DATE, 'DD/MM/YYYY HH24:MI') END_DATE, A.PATIENT_CLASS, D.PATIENT_NAME, E.PRACTITIONER_NAME, J.FACILITY_NAME, K.SHORT_DESC LOCATION, (CASE WHEN Q.CAN_REASON IS NOT NULL  THEN 'HOLD'  WHEN O.CAN_DATE_TIME IS NOT NULL  THEN 'CANCEL' WHEN O.HOLD_DATE_TIME IS NOT NULL  THEN 'HOLD' WHEN O.DISC_DATE_TIME IS NOT NULL  THEN 'DIS-CONTINUED' WHEN SYSDATE BETWEEN A.START_DATE AND A.END_DATE AND (NVL (A.TOT_ISSUED_QTY, 0) - NVL (A.RETURNED_QTY, 0)) != 0  THEN 'ACTIVE' ELSE 'INACTIVE' END ) STATUS, (SELECT COUNT (*)    FROM OR_ORDER_LINE_FIELD_VALUES B   WHERE B.ORDER_ID = A.ORIG_ORDER_ID     AND B.ORDER_LINE_NUM = A.ORIG_ORDER_LINE_NO) REMARKS, S.PRES_QTY_UOM PRES_BASE_UOM , O.LAST_ACTION_REASON_DESC, A.HEIGHT, A.HEIGHT_UOM, A.WEIGHT, A.WEIGHT_UOM, A.BSA, A.BMI, A.PRESCRIBED_QTY, A.TOT_ISSUED_QTY, A.RETURNED_QTY, A.TOT_ADMINISTERED_QTY, A.DOSAGE_UOM_CODE, A.REISSUED_QTY, A.REISSUE_DATE_TIME, A.REISSUE_REASON_CODE, O.ORDER_UOM, TO_CHAR (A.RETURN_DATE_TIME, 'DD/MM/YYYY') RETURN_DATE_TIME, (NVL (A.TOT_ISSUED_QTY, 0) - NVL (A.RETURNED_QTY, 0)) RET_DIFF , c.STRENGTH_PER_VALUE_PRES_UOM, c.CONTENT_IN_PRES_BASE_UOM,R.SHORT_DESC LINE_STATUS_DESC, (select FORMULARY_ITEM_YN from or_order_line_ph where order_id = o.order_id and order_line_num = o.order_line_num) FORMULARY_ITEM_YN ,  a.SLIDING_SCALE_YN, a.SLIDING_SCALE_ADM_UNIT, a.SLIDING_SCALE_ADM_UOM  FROM PH_PATIENT_DRUG_PROFILE A, PH_GENERIC_NAME_LANG_VW B, PH_DRUG_LANG_VW C, MP_PATIENT D, AM_PRACTITIONER_LANG_VW E, PH_ROUTE_LANG_VW F, AM_UOM_LANG_VW G, AM_FREQUENCY_LANG_VW H, AM_DURATION_TYPE_LANG_VW I, SM_FACILITY_PARAM_LANG_VW J, OP_CLINIC_LANG_VW K, IP_NURSING_UNIT_LANG_VW L, OR_ORDER_LINE O, OR_ORDER Q,OR_ORDER_STATUS_CODE_LANG_VW R,or_order_line_ph s WHERE Q.ORDER_ID = O.ORDER_ID AND A.PATIENT_ID = ? AND A.PATIENT_CLASS BETWEEN  NVL (?, '!') AND NVL (?, '~') AND A.START_DATE BETWEEN TO_DATE ( NVL (?,'01/01/1472'), 'DD/MM/YYYY')  AND TO_DATE ( NVL (?,'31/12/5000'), 'DD/MM/YYYY') + 0.99999 AND A.GENERIC_ID BETWEEN NVL (?, '!') AND NVL (?, '~') AND A.DRUG_CODE BETWEEN NVL (?, '!') AND NVL (?, '~') AND A.GENERIC_ID = B.GENERIC_ID AND D.PATIENT_ID = A.PATIENT_ID AND A.DRUG_CODE = C.DRUG_CODE AND E.PRACTITIONER_ID = A.PRES_PRACTITIONER_ID AND F.ROUTE_CODE = C.ROUTE_CODE AND G.UOM_CODE = A.DOSAGE_UOM_CODE AND H.FREQ_CODE = A.FREQ_CODE AND I.DURN_TYPE = A.DURN_TYPE AND J.FACILITY_ID = A.ORIG_FACILITY_ID AND K.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND K.CLINIC_CODE(+) = A.LOCN_CODE AND L.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND L.NURSING_UNIT_CODE(+) = A.LOCN_CODE AND A.ORIG_ORDER_ID = O.ORDER_ID AND A.ORIG_ORDER_LINE_NO = O.ORDER_LINE_NUM AND O.ORDER_LINE_STATUS = R.ORDER_STATUS_CODE 	and o.order_id=s.order_id and O.ORDER_LINE_NUM=s.ORDER_LINE_NUM	AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = H.LANGUAGE_ID AND B.LANGUAGE_ID = I.LANGUAGE_ID AND B.LANGUAGE_ID = J.LANGUAGE_ID AND B.LANGUAGE_ID = R.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND B.LANGUAGE_ID = ? AND K.LANGUAGE_ID(+) = ? AND L.LANGUAGE_ID(+) = ?");

		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT2C", "SELECT /*+ NO_EXPAND */A.ORIG_ORDER_ID, A.ORIG_ORDER_LINE_NO, A.SRL_NO, Q.IV_PREP_YN IV_PREP_YN, Q.DISCHARGE_IND, O.ORDER_LINE_STATUS, O.CHILD_ORDER_YN, A.INFUSE_OVER, A.TRN_TYPE_IND, A.DRUG_CODE, C.LONG_NAME,  A.DOSAGE || CHR (13) || DECODE (A.SPLIT_YN, 'Y', NULL, H.FREQ_DESC || ' , ') || CHR (13) || DURATION || ' ' || I.DURN_DESC DOSAGE_DETAILS, TO_CHAR (A.START_DATE, 'DD/MM/YYYY HH24:MI') START_DATE, TO_CHAR (A.END_DATE, 'DD/MM/YYYY HH24:MI') END_DATE, A.PATIENT_CLASS, D.PATIENT_NAME, E.PRACTITIONER_NAME, J.FACILITY_NAME, DECODE (P.ASSIGN_CARE_LOCN_TYPE, 'N', L.SHORT_DESC, 'C', K.SHORT_DESC ) LOCATION, (CASE WHEN Q.CAN_REASON IS NOT NULL THEN 'HOLD' WHEN O.CAN_DATE_TIME IS NOT NULL  THEN 'CANCEL'  WHEN O.HOLD_DATE_TIME IS NOT NULL THEN 'HOLD' WHEN O.DISC_DATE_TIME IS NOT NULL  THEN 'DIS-CONTINUED' WHEN SYSDATE BETWEEN A.START_DATE AND A.END_DATE AND (NVL (A.TOT_ISSUED_QTY, 0) - NVL (A.RETURNED_QTY, 0)) != 0  THEN 'ACTIVE' ELSE 'INACTIVE'  END ) STATUS, C.PRES_BASE_UNIT, A.HEIGHT, A.HEIGHT_UOM, A.WEIGHT, A.WEIGHT_UOM, A.BSA, A.BMI, A.PRESCRIBED_QTY, A.TOT_ISSUED_QTY, A.TOT_ADMINISTERED_QTY, A.DOSAGE_UOM_CODE, O.ORDER_UOM, R.ROUTE_CODE, R.ROUTE_DESC FROM PH_PATIENT_DRUG_PROFILE A, PH_TPN_REGIMEN_LANG_VW C, MP_PATIENT D, AM_PRACTITIONER_LANG_VW E, AM_FREQUENCY_LANG_VW H, AM_DURATION_TYPE_LANG_VW I, SM_FACILITY_PARAM_LANG_VW J, OP_CLINIC_LANG_VW K, IP_NURSING_UNIT_LANG_VW L, OR_ORDER_LINE O, PR_ENCOUNTER P, OR_ORDER Q, PH_ROUTE_LANG_VW R, PH_PARAM_LANG_VW S,OR_ORDER_STATUS_CODE_LANG_VW T WHERE Q.ORDER_ID = O.ORDER_ID AND A.PATIENT_ID = ? AND A.PATIENT_CLASS BETWEEN NVL (?, '!') AND NVL (?, '~') AND A.START_DATE BETWEEN TO_DATE( NVL(?,'01/01/1472') , 'DD/MM/YYYY') AND TO_DATE( NVL (?,'31/12/5000') , 'DD/MM/YYYY') + 0.99999 AND A.DRUG_CODE BETWEEN NVL (?, '!') AND NVL (?, '~') AND D.PATIENT_ID = A.PATIENT_ID AND A.DRUG_CODE = C.TPN_REGIMEN_CODE AND E.PRACTITIONER_ID = A.PRES_PRACTITIONER_ID AND H.FREQ_CODE = A.FREQ_CODE AND I.DURN_TYPE = A.DURN_TYPE AND J.FACILITY_ID = A.ORIG_FACILITY_ID AND K.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND K.CLINIC_CODE(+) = A.LOCN_CODE AND L.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND L.NURSING_UNIT_CODE(+) = A.LOCN_CODE AND A.ORIG_ORDER_ID = O.ORDER_ID AND A.ORIG_ORDER_LINE_NO = O.ORDER_LINE_NUM  AND P.ENCOUNTER_ID = A.ENCOUNTER_ID AND P.FACILITY_ID = A.ORIG_FACILITY_ID AND R.ROUTE_CODE = S.DFLT_IV_ROUTE_CODE AND Q.IV_PREP_YN IN ('7', '8') AND O.ORDER_LINE_STATUS = T.ORDER_STATUS_CODE AND C.LANGUAGE_ID = E.LANGUAGE_ID  AND C.LANGUAGE_ID = H.LANGUAGE_ID AND C.LANGUAGE_ID = I.LANGUAGE_ID AND C.LANGUAGE_ID = J.LANGUAGE_ID AND C.LANGUAGE_ID = R.LANGUAGE_ID AND C.LANGUAGE_ID = S.LANGUAGE_ID  AND C.LANGUAGE_ID = ? AND K.LANGUAGE_ID(+) = ? AND L.LANGUAGE_ID(+) = ?    ");		
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT3", "SELECT A.ALLERGY_OVERRIDE_REASON, A.DISCONT_BY_ID, TO_CHAR(A.DISCONT_DATE_TIME,'DD/MM/YYYY')  DISCONT_DATE_TIME, A.DISCONT_REASON_CODE, A.CANCEL_BY_ID, TO_CHAR(A.CANCEL_DATE_TIME,'DD/MM/YYYY') CANCEL_DATE_TIME, 	    A.DOSAGE_LIMIT_OVERRIDE_REASON,A.DUPLICATE_DRUG_OVERRIDE_REASON,A.SPLIT_DOSE_PREVIEW, B.LAST_ACTION_TYPE, B.LAST_ACTION_REASON_DESC,B.HOLD_PRACT_ID, TO_CHAR(B.HOLD_DATE_TIME,'DD/MM/YYYY') HOLD_DATE_TIME,C.CAN_REASON HOLD_REASON,A.RETURN_REASON_CODE   FROM PH_PATIENT_DRUG_PROFILE A,OR_ORDER_LINE B , OR_ORDER C  WHERE A.ORIG_ORDER_ID=B.ORDER_ID AND A.ORIG_ORDER_LINE_NO=B.ORDER_LINE_NUM  AND A.ORIG_ORDER_ID=? AND   C.ORDER_ID=B.ORDER_ID AND A.ORIG_ORDER_LINE_NO=? AND	  A.PATIENT_ID=? AND	  A.SRL_NO=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT4", "SELECT B.DRUG_CODE,B.DRUG_DESC,B.FORM_CODE,C.FORM_DESC,A.STRENGTH||'-'||D.SHORT_DESC STRENGTH, PRESCRIBED_QTY,DOSAGE_UOM_CODE,A.INFUSION_RATE||'-'||A.INFUSION_VOL_STR_UNIT||' /'||A.INFUSION_PER_UNIT FLOW_RATE,A.INFUSE_OVER,A.INFUSE_OVER_UNIT,E.FREQ_DESC,A.DURATION,F.DURN_DESC FROM PH_PATIENT_DRUG_PROFILE A, PH_DRUG_LANG_VW B, PH_FORM_LANG_VW C, AM_UOM_LANG_VW D,AM_FREQUENCY_LANG_VW E,AM_DURATION_TYPE_LANG_VW F WHERE IV_PREP_YN = 'Y' AND B.DRUG_CODE = A.DRUG_CODE AND C.FORM_CODE = B.FORM_CODE AND D.UOM_CODE  = A.STRENGTH_UOM_CODE AND E.FREQ_CODE = A.FREQ_CODE AND F.DURN_TYPE = A.DURN_TYPE AND UPPER(A.ORIG_ORDER_ID) = UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = D.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT5", "SELECT A.ORDER_LINE_FIELD_MNEMONIC, A.ORDER_LINE_FIELD_VALUE,B.REMARK_DESC FROM OR_ORDER_LINE_FIELD_VALUES A,PH_PRES_REMARK_LANG_VW B WHERE A.ORDER_LINE_FIELD_VALUE = B.REMARK_CODE(+) AND A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND A.ORDER_LINE_SEQ_NUM >=1 AND A.ORDER_LINE_SEQ_NUM <=200 AND B.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT5A", "SELECT COUNT(*) COUNT FROM OR_ORDER_LINE WHERE to_date(?,'dd/mm/yyyy hh24:mi')>=TRUNC(SYSDATE) AND ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT6", "SELECT DECODE(DISP_QTY - RETURNED_QTY,0,'Y','N') RETURNED_MEDICATION FROM PH_DISP_DTL WHERE ORDER_ID=? AND ORDER_LINE_NO=? ");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT7", "SELECT COUNT(*) COUNT FROM or_order_line WHERE order_line_status IN ('DP','DF','AL','IP','DD','DE') AND END_DATE_TIME >= SYSDATE AND order_id = ? AND order_line_num = ?");//,'DD','DE' ADDED FOR MMS-KH-CRF-0014
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT8", "SELECT COUNT(*) COUNT FROM or_order_line WHERE order_line_status IN ('OS','RG') AND END_DATE_TIME >= SYSDATE AND order_id = ? AND order_line_num = ?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT9", "SELECT COUNT(*) TOTAL FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_STATUS!=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT10", "SELECT CHANGE_DOSE_DURN_VERIFY_YN FROM PH_DISP_RIGHTS WHERE FACILITY_ID = ? AND DISP_LOCN_CODE = ? AND APPL_USER_ID = ?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT11", "SELECT IV_INGREDIENTS FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT12", "SELECT A.CAN_REASON,B.HOLD_PRACT_ID,TO_CHAR(B.HOLD_DATE_TIME,'DD/MM/YYYY HH24:MI') HOLD_DATE_TIME ,B.DISC_PRACT_ID,TO_CHAR(B.DISC_DATE_TIME,'DD/MM/YYYY HH24:MI') DISC_DATE_TIME,B.CAN_PRACT_ID,TO_CHAR(B.CAN_DATE_TIME,'DD/MM/YYYY HH24:MI') CAN_DATE_TIME FROM OR_ORDER A,OR_ORDER_LINE  B WHERE A.ORDER_ID=B.ORDER_ID AND B.ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_SELECT13", "SELECT A.DISP_LOCN_CODE,B.SHORT_DESC DISP_DESC,A.RE_RTD_DISP_LOCN_CODE,C.SHORT_DESC RE_DISP_DESC,A.DISP_QTY FROM PH_DISP_DTL A, PH_DISP_LOCN_LANG_VW B,PH_DISP_LOCN_LANG_VW C WHERE ORDER_ID=? AND A.DISP_LOCN_CODE = B.DISP_LOCN_CODE(+) AND A.RE_RTD_DISP_LOCN_CODE = C.DISP_LOCN_CODE(+) AND B.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_UPDATE_ORDER_LINE_A", "UPDATE OR_ORDER_LINE SET  DISC_DATE_TIME=SYSDATE, LAST_ACTION_REASON_DESC=?, LAST_ACTION_TYPE=?,MODIFIED_AT_WS_NO=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_FACILITY_ID=?,ORDER_LINE_STATUS='DC',DISC_PRACT_ID=?  WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_UPDATE_ORDER_LINE_B", "UPDATE OR_ORDER_LINE SET   LAST_ACTION_REASON_DESC=?, LAST_ACTION_TYPE=?,MODIFIED_AT_WS_NO=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_FACILITY_ID=? ,CAN_DATE_TIME=SYSDATE, CAN_LINE_REASON=?, CAN_PRACT_ID=?,ORDER_LINE_STATUS='CN'  WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_UPDATE_OR_ORDER", " UPDATE OR_ORDER SET  ORDER_STATUS=?,CAN_REASON=?,MODIFIED_AT_WS_NO=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_FACILITY_ID=?  WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_UPDATE_DRUG_PROFILE_A", "UPDATE PH_PATIENT_DRUG_PROFILE SET DISCONT_BY_ID=?, DISCONT_DATE_TIME=SYSDATE, DISCONT_REASON_CODE=?,MODIFIED_AT_WS_NO=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_FACILITY_ID=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO =? ");		
		dataMap.put("SQL_PH_DRUG_PROFILE_QUERY_UPDATE_DRUG_PROFILE_B", "UPDATE PH_PATIENT_DRUG_PROFILE SET CANCEL_YN='Y', CANCEL_DATE_TIME=SYSDATE, CANCEL_BY_ID=?,MODIFIED_AT_WS_NO=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_FACILITY_ID=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO =?");

		//	Patients by specific drug query
		//dataMap.put("SQL_PH_PACT_BY_SPEC_DRUG_QUERY_SELECT1", "SELECT /*+ NO_EXPAND */A.PATIENT_ID, D.PATIENT_NAME, A.SRL_NO, A.ORIG_ORDER_LINE_NO, GET_AGE (D.DATE_OF_BIRTH) AGE, DECODE (D.SEX, 'M', 'MALE', 'F', 'FEMALE', 'BOTH') GENDER, A.ORIG_ORDER_ID, A.TRN_TYPE_IND, A.DRUG_CODE, C.DRUG_DESC, F.ROUTE_CODE, F.ROUTE_DESC, TO_CHAR (A.START_DATE, 'DD/MM/YYYY') START_DATE, A.PRESCRIBED_QTY, A.DOSAGE_UOM_CODE, A.PATIENT_CLASS, E.PRACTITIONER_NAME, J.FACILITY_NAME, DECODE (A.PATIENT_CLASS,'IP', L.SHORT_DESC,'EA', L.SHORT_DESC,K.SHORT_DESC) LOCATION,(CASE WHEN A.CANCEL_YN = 'Y' THEN 'CANCEL' WHEN A.ON_HOLD_DATE_TIME IS NOT NULL THEN 'HOLD' WHEN A.DISCONT_DATE_TIME IS NOT NULL THEN 'DIS-CONTINUED' WHEN SYSDATE BETWEEN A.START_DATE AND A.END_DATE THEN 'ACTIVE' ELSE 'INACTIVE' END) STATUS FROM PH_PATIENT_DRUG_PROFILE A,PH_GENERIC_NAME B,PH_DRUG C,MP_PATIENT D,AM_PRACTITIONER E,PH_ROUTE F,AM_UOM G,AM_FREQUENCY H,AM_DURATION_TYPE I,SM_FACILITY_PARAM J,OP_CLINIC K,IP_NURSING_UNIT L  WHERE A.PATIENT_CLASS BETWEEN NVL (?, '!')  AND NVL (?, '~') AND TO_DATE (NVL (?, '31/12/5000'), 'DD/MM/YYYY') >= a.start_date AND  TO_DATE (NVL (?, '01/01/1472'), 'DD/MM/YYYY') <= a.end_date AND  TO_DATE (NVL (?, '31/12/5000'), 'DD/MM/YYYY') >= a.start_date AND  TO_DATE (NVL (?, '01/01/1472'), 'DD/MM/YYYY') <= a.end_date AND A.GENERIC_ID BETWEEN NVL (?, '!') AND NVL (?, '~') AND /*B.GENERIC_NAME LIKE NVL(?,B.GENERIC_NAME) AND */ A.DRUG_CODE BETWEEN  NVL (?,'!') AND NVL (?,'~')  AND /*C.DRUG_DESC LIKE NVL(?,C.DRUG_DESC) AND*/ A.GENERIC_ID = B.GENERIC_ID AND D.PATIENT_ID = A.PATIENT_ID AND A.DRUG_CODE = C.DRUG_CODE AND E.PRACTITIONER_ID = A.PRES_PRACTITIONER_ID AND F.ROUTE_CODE = C.ROUTE_CODE AND G.UOM_CODE = A.DOSAGE_UOM_CODE AND H.FREQ_CODE = A.FREQ_CODE AND I.DURN_TYPE = A.DURN_TYPE AND J.FACILITY_ID = A.ORIG_FACILITY_ID AND K.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND K.CLINIC_CODE(+) = A.LOCN_CODE AND L.FACILITY_ID(+) = A.ORIG_FACILITY_ID  AND L.NURSING_UNIT_CODE(+) = A.LOCN_CODE");

		//dataMap.put("SQL_PH_PACT_BY_SPEC_DRUG_QUERY_SELECT1", "SELECT /*+ NO_EXPAND */A.PATIENT_ID, D.PATIENT_NAME, A.SRL_NO, A.ORIG_ORDER_LINE_NO, GET_AGE (D.DATE_OF_BIRTH) AGE, DECODE (D.SEX, 'M', 'male', 'F', 'female', 'Both') GENDER, A.ORIG_ORDER_ID, A.TRN_TYPE_IND, A.DRUG_CODE, C.DRUG_DESC, F.ROUTE_CODE, F.ROUTE_DESC, TO_CHAR (A.START_DATE, 'DD/MM/YYYY') START_DATE, A.PRESCRIBED_QTY, C.PRES_BASE_UOM DOSAGE_UOM_CODE, A.PATIENT_CLASS, E.PRACTITIONER_NAME, J.FACILITY_NAME, DECODE (A.PATIENT_CLASS,'IP', L.SHORT_DESC,'EA', L.SHORT_DESC,K.SHORT_DESC) LOCATION,(CASE WHEN A.CANCEL_YN = 'Y' THEN 'CANCEL' WHEN A.ON_HOLD_DATE_TIME IS NOT NULL THEN 'HOLD' WHEN A.DISCONT_DATE_TIME IS NOT NULL THEN 'DIS-CONTINUED' WHEN trunc(SYSDATE) BETWEEN trunc(A.START_DATE) AND trunc(A.END_DATE) THEN 'ACTIVE' ELSE 'INACTIVE' END) STATUS FROM PH_PATIENT_DRUG_PROFILE A,PH_GENERIC_NAME B,PH_DRUG C,MP_PATIENT D,AM_PRACTITIONER E,PH_ROUTE F,AM_UOM G,AM_FREQUENCY H,AM_DURATION_TYPE I,SM_FACILITY_PARAM J,OP_CLINIC K,IP_NURSING_UNIT L  WHERE A.PATIENT_CLASS BETWEEN NVL (?, '!')  AND NVL (?, '~') AND  ( A.START_DATE BETWEEN TO_DATE(NVL(?,'01/01/1900'),'DD/MM/YYYY') AND TO_DATE(NVL(?,'31/12/2300'),'DD/MM/YYYY')+ 0.99999 OR A.END_DATE   BETWEEN TO_DATE(NVL(?,'01/01/1900'),'DD/MM/YYYY') AND TO_DATE(NVL(?,'31/12/2300'),'DD/MM/YYYY')+ 0.99999 ) AND A.GENERIC_ID BETWEEN NVL (?, '!') AND NVL (?, '~') AND /*B.GENERIC_NAME LIKE NVL(?,B.GENERIC_NAME) AND */ A.DRUG_CODE BETWEEN  NVL (?,'!') AND NVL (?,'~')  AND /*C.DRUG_DESC LIKE NVL(?,C.DRUG_DESC) AND*/ A.GENERIC_ID = B.GENERIC_ID AND D.PATIENT_ID = A.PATIENT_ID AND A.DRUG_CODE = C.DRUG_CODE AND E.PRACTITIONER_ID = A.PRES_PRACTITIONER_ID AND F.ROUTE_CODE = C.ROUTE_CODE AND G.UOM_CODE = A.DOSAGE_UOM_CODE AND H.FREQ_CODE = A.FREQ_CODE AND I.DURN_TYPE = A.DURN_TYPE AND J.FACILITY_ID = A.ORIG_FACILITY_ID AND K.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND K.CLINIC_CODE(+) = A.LOCN_CODE AND L.FACILITY_ID(+) = A.ORIG_FACILITY_ID  AND L.NURSING_UNIT_CODE(+) = A.LOCN_CODE");//added for performance tunning
		dataMap.put("SQL_PH_PACT_BY_SPEC_DRUG_QUERY_SELECT1", "SELECT A.PATIENT_ID,(select PATIENT_NAME from mp_patient where patient_id = a.patient_id) patient_name,A.SRL_NO,A.ORIG_ORDER_LINE_NO, (select GET_AGE (DATE_OF_BIRTH)  from mp_patient where patient_id = a.patient_id) AGE, (select DECODE (SEX,  'M', 'male',  'F', 'female',  'unknown')  from mp_patient where patient_id = a.patient_id) GENDER, A.ORIG_ORDER_ID,A.TRN_TYPE_IND, A.DRUG_CODE, C.DRUG_DESC,F.ROUTE_CODE,F.ROUTE_DESC, TO_CHAR (A.START_DATE, 'DD/MM/YYYY') START_DATE, A.PRESCRIBED_QTY,C.PRES_BASE_UOM DOSAGE_UOM_CODE,/*A.PATIENT_CLASS */ DECODE (p.patient_class, NULL, 'XT', p.patient_class) PATIENT_CLASS,(select PRACTITIONER_NAME from AM_PRACTITIONER where practitioner_id = a.PRES_PRACTITIoner_id)  PRACTITIONER_NAME ,(select FACILITY_NAME from SM_FACILITY_PARAM where facility_id = a.orig_facility_id ) facility_name,DECODE (a.locn_type, null, (SELECT short_desc FROM am_referral WHERE a.facility_id = a.orig_facility_id AND REFERRAL_CODE = a.locn_code), 'N', (SELECT short_desc FROM ip_nursing_unit WHERE facility_id = a.orig_facility_id AND nursing_unit_code = a.locn_code), 'C', (SELECT short_desc FROM op_clinic WHERE facility_id = a.orig_facility_id AND clinic_code = a.locn_code), NULL ) LOCATION, (CASE WHEN A.CANCEL_YN = 'Y'THEN 'CANCEL' WHEN A.ON_HOLD_DATE_TIME IS NOT NULL THEN 'HOLD'WHEN A.DISCONT_DATE_TIME IS NOT NULL THEN 'DIS-CONTINUED' WHEN TRUNC (SYSDATE) BETWEEN TRUNC (A.START_DATE) AND TRUNC (A.END_DATE) THEN 'ACTIVE'  ELSE 'INACTIVE'END) STATUS FROM PH_PATIENT_DRUG_PROFILE A,PH_DRUG C,PH_ROUTE F,AM_UOM G,PR_ENCOUNTER P WHERE P.ENCOUNTER_ID(+) = A.ENCOUNTER_ID AND A.start_date BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND   TO_DATE (?,'DD/MM/YYYY') + 0.99999  ");   // Changed from Unknown to unknown for ML-BRU-SCF-1647 [IN:057554]//OR A.end_date BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND   TO_DATE (?, 'DD/MM/YYYY') + 0.99999) removed for ML-BRU-SCF-1791
// DECODE (p.patient_class, NULL, 'XT', p.patient_class) PATIENT_CLASS and pr_encounter table added for ML-BRU-SCF-1930
		dataMap.put("SQL_PH_PACT_BY_SPEC_DRUG_QUERY_SELECT2", "SELECT   A.DRUG_CODE,  B.DRUG_DESC, B.FORM_CODE, C.FORM_DESC,  A.STRENGTH||'-'||D.SHORT_DESC STRENGTH, NVL(TO_CHAR(A.DOSAGE),'-') ||' '||D.SHORT_DESC||',  '||E.FREQ_DESC||','||DURATION||' '||F.DURN_DESC DOSAGE_DETAILS,  A.ROUTE_CODE,  TO_CHAR(A.START_DATE,  'DD/MM/YYYY') START_DATE,  TO_CHAR(A.END_DATE,  'DD/MM/YYYY') END_DATE,  PRESCRIBED_QTY,  DOSAGE_UOM_CODE,  E.FREQ_DESC,  A.DURATION,  F.DURN_DESC,G.ROUTE_DESC  FROM   PH_PATIENT_DRUG_PROFILE A,  PH_DRUG_LANG_VW B, PH_FORM_LANG_VW C ,  AM_UOM_LANG_VW D,AM_FREQUENCY_LANG_VW E,  AM_DURATION_TYPE_LANG_VW F,PH_ROUTE_LANG_VW G  WHERE    B.DRUG_CODE = A.DRUG_CODE AND  C.FORM_CODE = B.FORM_CODE AND  D.UOM_CODE(+)=A.STRENGTH_UOM_CODE AND  E.FREQ_CODE = A.FREQ_CODE AND  F.DURN_TYPE = A.DURN_TYPE AND  G.ROUTE_CODE(+) = A.ROUTE_CODE   AND  UPPER(A.PATIENT_ID) = UPPER(?) AND  UPPER(A.ORIG_ORDER_ID) = UPPER(?) AND  UPPER(A.ORIG_ORDER_LINE_NO) = UPPER(?) AND  UPPER(A.SRL_NO)=UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ? AND G.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_PACT_BY_SPEC_DRUG_QUERY_SELECT3", "SELECT   A.ALLERGY_OVERRIDE_REASON,  A.DISCONT_BY_ID,  TO_CHAR(A.DISCONT_DATE_TIME,  'DD/MM/YYYY') DISCONT_DATE_TIME,  A.DISCONT_REASON_CODE,  A.DOSAGE_LIMIT_OVERRIDE_REASON,  A.SPLIT_DOSE_PREVIEW,  B.ORDER_LINE_SEQ_NUM,  B.ORDER_LINE_FIELD_VALUE FROM   PH_PATIENT_DRUG_PROFILE A,  OR_ORDER_LINE_FIELD_VALUES B WHERE  UPPER(A.PATIENT_ID)=UPPER(?) AND UPPER(A.ORIG_ORDER_ID)=UPPER(?) AND  UPPER(A.ORIG_ORDER_LINE_NO)=UPPER(?) AND  UPPER(A.SRL_NO)=UPPER(?) AND  B.ORDER_ID = A.ORIG_ORDER_ID AND  B.ORDER_LINE_NUM = A.ORIG_ORDER_LINE_NO");

		//  Reason Codes Master function
		dataMap.put("SQL_PH_REASON_CODES_SELECT1", "SELECT COUNT(ROWID) FROM PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE=? AND REASON_CODE=?");
		dataMap.put("SQL_PH_REASON_CODES_SELECT2", "SELECT  APPL_TRN_TYPE, REASON_CODE, REASON_DESC, EFF_STATUS FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE=? AND REASON_CODE  LIKE NVL(UPPER(?),REASON_CODE) AND upper(REASON_DESC) LIKE NVL(UPPER(?),upper(REASON_DESC)) AND EFF_STATUS LIKE NVL(?,EFF_STATUS) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_REASON_CODES_SELECT3", "SELECT  APPL_TRN_TYPE, REASON_CODE, REASON_DESC, EFF_STATUS,REMARKS,APPL_FOR_QAP_REPORT_YN FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE=? AND REASON_CODE  = ? AND LANGUAGE_ID = ?");	
		dataMap.put("SQL_PH_REASON_CODES_SELECT4", "SELECT REASON_CODE, REASON_DESC, APPL_TRN_TYPE FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE IN ('RP','RO') AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY REASON_DESC");
		
		dataMap.put("SQL_PH_REASON_CODES_INSERT", "INSERT INTO PH_MEDN_TRN_REASON (APPL_TRN_TYPE, REASON_CODE, REASON_DESC, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,REMARKS,APPL_FOR_QAP_REPORT_YN)  VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		
		dataMap.put("SQL_PH_REASON_CODES_UPDATE", "UPDATE PH_MEDN_TRN_REASON SET  REASON_DESC=?, EFF_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,REMARKS = ? ,APPL_FOR_QAP_REPORT_YN=? WHERE APPL_TRN_TYPE=? AND REASON_CODE=? ");

		//   Print Prescriptions
		dataMap.put("SQL_PH_PRINT_PRESCRIPTIONS_SELECT", "SELECT distinct(a.orig_order_id) orig_order_id, A.PATIENT_ID,B.PATIENT_NAME,A.ENCOUNTER_ID,A.LOCN_TYPE,A.PRES_PRACTITIONER_ID,TO_CHAR(A.START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY') ADDED_DATE, A.ADDED_DATE ORD_DATE, B.NATIONAL_ID_NO,C.ORDER_STATUS,D.PRACTITIONER_NAME,A.PATIENT_CLASS, A.LOCN_CODE , e.SHORT_DESC disp_locn_desc, C.IV_PREP_YN FROM PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B,OR_ORDER C,AM_PRACTITIONER_LANG_VW D,ph_disp_locn_lang_vw e WHERE A.PATIENT_ID = B.PATIENT_ID AND A.PATIENT_ID = C.PATIENT_ID AND A.ORIG_ORDER_ID = C.ORDER_ID AND A.ORIG_ORDER_LINE_NO='1' AND A.ORIG_ORDER_ID = NVL(?,A.ORIG_ORDER_ID) AND A.ADDED_DATE BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND   TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') + 0.99999 AND A.PATIENT_ID = ? AND A.ENCOUNTER_ID = NVL(?,A.ENCOUNTER_ID) AND A.PRES_PRACTITIONER_ID = NVL(?,A.PRES_PRACTITIONER_ID) AND A.PRES_PRACTITIONER_ID = D.PRACTITIONER_ID  AND A.LOCN_TYPE = NVL(?,A.LOCN_TYPE) AND A.LOCN_CODE = NVL(?,A.LOCN_CODE) AND A.FACILITY_ID=? AND e.FACILITY_ID=A.FACILITY_ID AND e.DISP_LOCN_CODE=c.PERFORMING_DEPTLOC_CODE AND d.LANGUAGE_ID = e.LANGUAGE_ID AND d.LANGUAGE_ID = ?");
		//dataMap.put("SQL_PH_REP_EXT_PRESCRIPTIONS_SELECT", "SELECT distinct(a.orig_order_id) orig_order_id, A.PATIENT_ID,B.PATIENT_NAME, A.ENCOUNTER_ID,A.LOCN_TYPE,A.PRES_PRACTITIONER_ID,TO_CHAR(A.START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY') ADDED_DATE,A.ADDED_DATE ORD_DATE,B.NATIONAL_ID_NO,C.ORDER_STATUS,D.PRACTITIONER_NAME,A.PATIENT_CLASS, A.LOCN_CODE ,e.SHORT_DESC,C.REF_SENT_PRACT_ID,am_get_desc.am_practitioner (a.added_by_id,d.language_id,'1')ADDED_BY_ID FROM PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B,OR_ORDER C,AM_PRACTITIONER_LANG_VW D ,ph_disp_locn_lang_vw e WHERE A.FACILITY_ID=C.ORDERING_FACILITY_ID AND A.PATIENT_ID  = B.PATIENT_ID  AND A.PATIENT_ID    = C.PATIENT_ID  AND A.ORIG_ORDER_ID = C.ORDER_ID  AND A.ORIG_ORDER_ID = NVL(?,A.ORIG_ORDER_ID)  AND A.ADDED_DATE BETWEEN TO_DATE(NVL(?,'01/01/1472 00:00'),'DD/MM/RRRR hh24:mi')  AND  TO_DATE(NVL(?,'31/12/5000 23:59'),'DD/MM/RRRR hh24:mi')  AND C.PATIENT_CLASS = 'XT'  AND  A.PATIENT_ID = NVL(?,A.PATIENT_ID)  AND A.PRES_PRACTITIONER_ID = D.PRACTITIONER_ID AND A.FACILITY_ID=? and c.PERFORMING_DEPTLOC_CODE=e.disp_locn_code and a.FACILITY_ID=e.FACILITY_ID and D.LANGUAGE_ID = E.LANGUAGE_ID AND D.LANGUAGE_ID = ? ORDER BY ORD_DATE");//C.REF_SENT_PRACT_ID,A.ADDED_BY_ID Added for ml-mmoh-crf-0510
		dataMap.put("SQL_PH_REP_EXT_PRESCRIPTIONS_SELECT", "SELECT distinct(a.orig_order_id) orig_order_id, A.PATIENT_ID,B.PATIENT_NAME, A.ENCOUNTER_ID,A.LOCN_TYPE,A.PRES_PRACTITIONER_ID,TO_CHAR(A.START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY') ADDED_DATE,A.ADDED_DATE ORD_DATE,B.NATIONAL_ID_NO,C.ORDER_STATUS,D.PRACTITIONER_NAME,A.PATIENT_CLASS, A.LOCN_CODE ,( select e.short_desc  from ph_disp_locn_lang_vw e where e.disp_locn_code = c.performing_deptloc_code AND e.language_id = ?)SHORT_DESC,C.REF_SENT_PRACT_ID,am_get_desc.am_practitioner (a.added_by_id,d.language_id,'1')ADDED_BY_ID FROM PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B,OR_ORDER C,AM_PRACTITIONER_LANG_VW D  WHERE A.FACILITY_ID=C.ORDERING_FACILITY_ID AND A.PATIENT_ID  = B.PATIENT_ID  AND A.PATIENT_ID    = C.PATIENT_ID  AND A.ORIG_ORDER_ID = C.ORDER_ID  AND A.ORIG_ORDER_ID = NVL(?,A.ORIG_ORDER_ID)  AND A.ADDED_DATE BETWEEN TO_DATE(NVL(?,'01/01/1472 00:00'),'DD/MM/RRRR hh24:mi')  AND  TO_DATE(NVL(?,'31/12/5000 23:59'),'DD/MM/RRRR hh24:mi')  AND C.PATIENT_CLASS = 'XT'  AND  A.PATIENT_ID = NVL(?,A.PATIENT_ID)  AND A.PRES_PRACTITIONER_ID = D.PRACTITIONER_ID AND A.FACILITY_ID=? and D.LANGUAGE_ID = ? ORDER BY ORD_DATE");//C.REF_SENT_PRACT_ID,A.ADDED_BY_ID Added for ml-mmoh-crf-0510//ML-MMOH-CRF-1994

		dataMap.put("SQL_PH_PRINT_PRESCRIPTIONS_SELECT1","SELECT CLINIC_CODE code, SHORT_DESC description FROM OP_CLINIC_LANG_VW OP_CLINIC  WHERE  UPPER(CLINIC_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND EFF_STATUS='E' AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_PRINT_FACILITIES_SELECT","SELECT DISP_LOCN_CODE CODE, SHORT_DESC DESCRIPTION FROM PH_DISP_LOCN WHERE  UPPER(FACILITY_ID) LIKE UPPER(?) AND UPPER(DISP_LOCN_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND EFF_STATUS='E'");
		dataMap.put("SQL_PH_PRINT_PRESCRIPTIONS_SELECT2","SELECT NURSING_UNIT_CODE code, SHORT_DESC description FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT  WHERE  UPPER(NURSING_UNIT_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND EFF_STATUS='E' AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_PRINT_PRESCRIPTIONS_SELECT3","SELECT ORDER_STATUS_CODE,LONG_DESC FROM OR_ORDER_STATUS_CODE_LANG_VW OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_CODE IN('OS','RG','DP','DF','DD','DE') AND LANGUAGE_ID = ?");//,'DD','DE' ADDED FOR MMS-KH-CRF-0014
		dataMap.put("SQL_PH_PRINT_PRESCRIPTIONS_SELECT4","SELECT A.ORIG_ORDER_ID, A.PATIENT_ID,B.PATIENT_NAME,DECODE(B.SEX,'M','male','F','female','U','unknown')SEX,GET_AGE(B.DATE_OF_BIRTH) AGE FROM   PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B WHERE  B.PATIENT_ID = A.PATIENT_ID AND A.PATIENT_ID = ? AND A.ORIG_ORDER_ID = ?");

		//IV PRESCRIPTIONS
		dataMap.put("SQL_PH_PRINT_IV_PRESCRIPTIONS_SELECT", "SELECT DISTINCT  A.PATIENT_ID,B.PATIENT_NAME,A.ORIG_ORDER_ID,A.ENCOUNTER_ID,A.LOCN_TYPE,A.PRES_PRACTITIONER_ID,TO_CHAR(A.START_DATE,'DD/MM/YYYY hh24:mi') START_DATE,TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY hh24:mi') ADDED_DATE,B.NATIONAL_ID_NO,C.ORDER_STATUS,D.PRACTITIONER_NAME,A.PATIENT_CLASS, A.LOCN_CODE, g.SHORT_DESC disp_locn_desc FROM PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B, OR_ORDER C, AM_PRACTITIONER_LANG_VW D,PH_PARAM_LANG_VW E,OR_ORDER_LINE F ,ph_disp_locn_lang_vw g WHERE A.PATIENT_ID = B.PATIENT_ID AND A.PATIENT_ID = C.PATIENT_ID AND A.ORIG_ORDER_ID = C.ORDER_ID AND F.ORDER_ID=A.ORIG_ORDER_ID AND F.ORDER_LINE_NUM=A.ORIG_ORDER_LINE_NO AND A.ORIG_ORDER_ID LIKE NVL(?,'%') AND A.ADDED_DATE BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/YYYY') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/YYYY') + 0.99999 AND A.PATIENT_ID LIKE NVL(?,'%') AND A.ENCOUNTER_ID = NVL(?,A.ENCOUNTER_ID) AND A.PRES_PRACTITIONER_ID = NVL(?,A.PRES_PRACTITIONER_ID) AND A.PRES_PRACTITIONER_ID = D.PRACTITIONER_ID AND A.LOCN_TYPE = NVL(?,A.LOCN_TYPE) AND A.LOCN_CODE = NVL(?,A.LOCN_CODE) AND A.ROUTE_CODE=E.DFLT_IV_ROUTE_CODE AND A.FACILITY_ID=?and g.FACILITY_ID=A.FACILITY_ID and g.DISP_LOCN_CODE=c.PERFORMING_DEPTLOC_CODE AND D.LANGUAGE_ID = E.LANGUAGE_ID AND D.LANGUAGE_ID = G.LANGUAGE_ID AND D.LANGUAGE_ID = ?");

       //compound Prescription
	   dataMap.put("SQL_PH_PRINT_COMPOUND_PRESCRIPTIONS_SELECT", "SELECT DISTINCT  A.PATIENT_ID,B.PATIENT_NAME,A.ORIG_ORDER_ID,A.ENCOUNTER_ID,A.LOCN_TYPE,A.PRES_PRACTITIONER_ID,TO_CHAR(A.START_DATE,'DD/MM/YYYY hh24:mi') START_DATE,TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY hh24:mi') ADDED_DATE,B.NATIONAL_ID_NO,C.ORDER_STATUS,D.PRACTITIONER_NAME,A.PATIENT_CLASS, A.LOCN_CODE , g.SHORT_DESC disp_locn_desc FROM PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B, OR_ORDER C, AM_PRACTITIONER_LANG_VW D,PH_PARAM_LANG_VW E,OR_ORDER_LINE F,ph_disp_locn_lang_vw g WHERE A.PATIENT_ID = B.PATIENT_ID AND A.PATIENT_ID = C.PATIENT_ID AND A.ORIG_ORDER_ID = C.ORDER_ID AND F.ORDER_ID=A.ORIG_ORDER_ID AND F.ORDER_LINE_NUM=A.ORIG_ORDER_LINE_NO AND A.ORIG_ORDER_ID LIKE NVL(?,'%') AND A.ADDED_DATE BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/YYYY') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/YYYY') + 0.99999 AND A.PATIENT_ID LIKE NVL(?,'%') AND A.ENCOUNTER_ID = NVL(?,A.ENCOUNTER_ID) AND A.PRES_PRACTITIONER_ID = NVL(?,A.PRES_PRACTITIONER_ID) AND A.PRES_PRACTITIONER_ID = D.PRACTITIONER_ID AND A.LOCN_TYPE = NVL(?,A.LOCN_TYPE) AND A.LOCN_CODE = NVL(?,A.LOCN_CODE)  AND A.FACILITY_ID=? and g.FACILITY_ID=A.FACILITY_ID and g.DISP_LOCN_CODE=c.PERFORMING_DEPTLOC_CODE AND D.LANGUAGE_ID = E.LANGUAGE_ID AND D.LANGUAGE_ID = G.LANGUAGE_ID AND D.LANGUAGE_ID = ? ");

		dataMap.put("SQL_PH_PRINT_TPN_PRESCRIPTIONS_SELECT", "SELECT  A.PATIENT_ID,B.PATIENT_NAME,A.ORIG_ORDER_ID,A.ENCOUNTER_ID,A.LOCN_TYPE,A.PRES_PRACTITIONER_ID,TO_CHAR(A.START_DATE,'DD/MM/YYYY hh24:mi') START_DATE,TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY hh24:mi') ADDED_DATE,B.NATIONAL_ID_NO,C.ORDER_STATUS,D.PRACTITIONER_NAME,A.PATIENT_CLASS, A.LOCN_CODE, e.SHORT_DESC disp_locn_desc FROM PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B,OR_ORDER C,AM_PRACTITIONER_LANG_VW D ,ph_disp_locn_lang_vw e WHERE A.PATIENT_ID = B.PATIENT_ID AND A.PATIENT_ID = C.PATIENT_ID AND A.ORIG_ORDER_ID = C.ORDER_ID AND A.ORIG_ORDER_LINE_NO='1' AND A.ORIG_ORDER_ID = NVL(?,A.ORIG_ORDER_ID) AND TRUNC(A.ADDED_DATE) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND   TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND A.PATIENT_ID = NVL(?,A.PATIENT_ID) AND A.ENCOUNTER_ID = NVL(?,A.ENCOUNTER_ID) AND A.PRES_PRACTITIONER_ID = NVL(?,A.PRES_PRACTITIONER_ID) AND A.PRES_PRACTITIONER_ID = D.PRACTITIONER_ID AND A.LOCN_TYPE = NVL(?,A.LOCN_TYPE) AND A.LOCN_CODE = NVL(?,A.LOCN_CODE) AND A.FACILITY_ID=? and e.FACILITY_ID=A.FACILITY_ID and e.DISP_LOCN_CODE=c.PERFORMING_DEPTLOC_CODE AND D.LANGUAGE_ID = E.LANGUAGE_ID AND D.LANGUAGE_ID = ?");


		dataMap.put("SQL_PH_PATIENT_DRUG_CHART_REP_SELECT","SELECT A.PATIENT_ID, B.PATIENT_NAME,A.NURSING_UNIT_CODE, C.LONG_DESC SHORT_DESC,TO_CHAR(A.ADMISSION_DATE_TIME,'DD/MM/YYYY hh24:mi') ADMISSION_DATE_TIME, A.ROOM_NUM, A.BED_NUM FROM IP_OPEN_ENCOUNTER A, MP_PATIENT B, IP_NURSING_UNIT_LANG_VW C  WHERE A.PATIENT_ID = B.PATIENT_ID AND A.FACILITY_ID=C.FACILITY_ID AND A.NURSING_UNIT_CODE = C.NURSING_UNIT_CODE AND A.PATIENT_ID = NVL (?, A.PATIENT_ID) AND A.NURSING_UNIT_CODE = NVL (?, A.NURSING_UNIT_CODE) AND A.FACILITY_ID = ? AND C.LANGUAGE_ID = ? AND  a.patient_class in('IP', 'DC')");
		dataMap.put("SQL_PH_PRINT_IVINTT_PRESCRIPTIONS_SELECT", "SELECT A.PATIENT_ID,B.PATIENT_NAME,A.ORIG_ORDER_ID,A.ENCOUNTER_ID,A.LOCN_TYPE,A.PRES_PRACTITIONER_ID,TO_CHAR(A.START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY') ADDED_DATE,B.NATIONAL_ID_NO,C.ORDER_STATUS,D.PRACTITIONER_NAME,A.PATIENT_CLASS, A.LOCN_CODE FROM PH_PATIENT_DRUG_PROFILE A,MP_PATIENT B,OR_ORDER C,AM_PRACTITIONER D  WHERE A.PATIENT_ID = B.PATIENT_ID AND A.PATIENT_ID = C.PATIENT_ID AND A.ORIG_ORDER_ID = C.ORDER_ID AND A.ORIG_ORDER_LINE_NO='1' AND A.ORIG_ORDER_ID = NVL(?,A.ORIG_ORDER_ID) AND TRUNC(A.ADDED_DATE) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND   TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND A.PATIENT_ID = NVL(?,A.PATIENT_ID) AND A.ENCOUNTER_ID = NVL(?,A.ENCOUNTER_ID) AND A.PRES_PRACTITIONER_ID = NVL(?,A.PRES_PRACTITIONER_ID) AND A.PRES_PRACTITIONER_ID = D.PRACTITIONER_ID AND A.LOCN_TYPE = NVL(?,A.LOCN_TYPE) AND A.LOCN_CODE = NVL(?,A.LOCN_CODE) AND A.ROUTE_CODE='IV' AND A.FREQ_CODE !='CON' AND A.FACILITY_ID=?");

		// Report Dispensing Sheet
		dataMap.put("SQL_PH_PRINT_DISP_SHEET_SELECT1","SELECT A.DISP_NO,A.PATIENT_ID,to_char(A.added_date,'dd/mm/yyyy hh24:mi') DISP_DATE_TIME, A.DISP_LOCN_CODE,B.SHORT_DESC,A.PATIENT_CLASS,DECODE( A.PATIENT_CLASS,  'IP',  C.LONG_DESC,  'EA',  D.LONG_DESC,  D.LONG_DESC ) SOURCE FROM PH_DISP_HDR A,PH_DISP_LOCN_LANG_VW B,IP_NURSING_UNIT_LANG_VW C, OP_CLINIC_LANG_VW D,OR_ORDER E WHERE B.FACILITY_ID = A.FACILITY_ID AND A.FACILITY_ID = C.FACILITY_ID(+)  AND A.FACILITY_ID = D.FACILITY_ID(+)  AND B.DISP_LOCN_CODE = A.DISP_LOCN_CODE AND A.ORDER_ID = E.ORDER_ID AND E.ORDER_STATUS = DECODE(REF_FACILITY_ID,NULL,'DP',decode(e.patient_class,'XT','DP','DF','DD','DE')) AND A.LOCN_CODE = C.NURSING_UNIT_CODE(+) AND A.LOCN_CODE = D.CLINIC_CODE(+) AND A.FACILITY_ID=? AND A.DISP_NO = NVL(?,A.DISP_NO) AND A.PATIENT_ID = NVL(?,A.PATIENT_ID) AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ?  ORDER BY A.DISP_DATE_TIME DESC");//,'DD','DE' ADDED FOR MMS-KH-CRF-0014

		dataMap.put("SQL_PH_PRINT_DISP_SHEET_SELECT2","SELECT DISP_NO,B.IV_PREP_YN FROM PH_DISP_HDR A , OR_ORDER B WHERE A.ORDER_ID = B.ORDER_ID and A.PATIENT_ID=? AND B.IV_PREP_YN IN('1','3','5','7','9') AND TRUNC(A.DISP_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND B.PATIENT_CLASS=? AND A.FACILITY_ID =? ORDER BY A.DISP_NO");// code ' AND A.FACILITY_ID =?' added for IN048930
		dataMap.put("SQL_PH_PRINT_DISP_SHEET_SELECT2A","SELECT DISP_NO,B.IV_PREP_YN FROM PH_DISP_HDR A , OR_ORDER B WHERE A.ORDER_ID = B.ORDER_ID and A.PATIENT_ID=? AND (B.IV_PREP_YN IS NULL OR B.IV_PREP_YN = 'N' ) AND TRUNC(A.DISP_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND B.PATIENT_CLASS=? AND A.FACILITY_ID =? ORDER BY A.DISP_NO");// code ' AND A.FACILITY_ID =?' added for IN048930
		dataMap.put("SQL_PH_PRINT_DISP_SHEET_SELECT3","SELECT DISP_TMP_NO,B.IV_PREP_YN FROM PH_DISP_HDR_TMP A , OR_ORDER B WHERE A.ORDER_ID = B.ORDER_ID and A.PATIENT_ID=? and b.iv_prep_yn in('1','3','7','5','9') AND TRUNC(A.RECORD_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND B.PATIENT_CLASS=? AND A.FACILITY_ID =? ORDER BY A.DISP_TMP_NO");// code ' AND A.FACILITY_ID =?' added for IN048930
		dataMap.put("SQL_PH_PRINT_DISP_SHEET_SELECT3A","SELECT DISP_TMP_NO,B.IV_PREP_YN FROM PH_DISP_HDR_TMP A , OR_ORDER B WHERE A.ORDER_ID = B.ORDER_ID AND A.PATIENT_ID= ? AND (B.IV_PREP_YN IS NULL OR B.IV_PREP_YN = 'N') AND TRUNC(A.RECORD_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND B.PATIENT_CLASS=? AND A.FACILITY_ID =? ORDER BY A.DISP_TMP_NO");// code ' AND A.FACILITY_ID =?' added for IN048930
		dataMap.put("SQL_PH_PRINT_DISP_MEDICAL_ITEM_LABEL_TMP","SELECT distinct(a.disp_tmp_no)||'' disp_no FROM ph_disp_hdr_tmp a, ph_disp_dtl_tmp b, ph_drug d WHERE a.facility_id = b.facility_id and a.disp_tmp_no = b.disp_tmp_no and B.DISP_DRUG_CODE = d.drug_code and d.drug_yn ='N' AND a.patient_id = ? AND TRUNC (a.dispensed_date_time) = TO_DATE (?, 'DD/MM/YYYY') AND a.patient_class = ? union all SELECT distinct(b.disp_no) disp_no FROM ph_disp_hdr_tmp a, ph_disp_cons_dtl b WHERE a.facility_id = b.facility_id AND b.disp_trn_seq_no = a.disp_trn_seq_no AND b.status <> 'DL' AND a.patient_id = ? AND TRUNC (a.dispensed_date_time) = TO_DATE (?, 'DD/MM/YYYY') AND a.patient_class = ? ORDER BY disp_no");

		dataMap.put("SQL_PH_PRINT_DISP_MEDICAL_ITEM_LABEL","SELECT distinct(a.disp_no)||'' disp_no FROM ph_disp_hdr a, ph_disp_dtl b, ph_drug d WHERE a.facility_id = b.facility_id and a.disp_no = b.disp_no and B.DISP_DRUG_CODE = d.drug_code and d.drug_yn ='N' AND a.patient_id = ? AND TRUNC (a.disp_date_time) = TO_DATE (?, 'DD/MM/YYYY') AND a.patient_class = ? union all SELECT distinct(b.disp_no) disp_no FROM ph_disp_hdr a, ph_disp_cons_dtl b WHERE a.facility_id = b.facility_id AND b.disp_trn_seq_no = a.disp_trn_seq_no AND b.status in('DL','AL', 'FL') AND a.patient_id = ? AND TRUNC (a.disp_date_time) = TO_DATE (?, 'DD/MM/YYYY') AND a.patient_class = ? ORDER BY disp_no");//added  AL in status for ('DL','AL') CRF392/02[047518]

		//Report Dispense Label
		dataMap.put("SQL_PH_PRINT_DISP_LABEL_SELECT1","SELECT A.DISP_NO,A.PATIENT_ID,to_char(A.DISP_DATE_TIME,'dd/mm/yyyy hh24:mi') DISP_DATE_TIME,A.DISP_LOCN_CODE,M.SHORT_DESC,DECODE( A.PATIENT_CLASS,  'IP',  N.SHORT_DESC,  'EA',  O.SHORT_DESC,  O.SHORT_DESC ) SOURCE ,A.LOCN_CODE,(CASE WHEN B.DISP_DRUG_CODE = B.PRES_DRUG_CODE THEN TO_CHAR(ROUND(TO_NUMBER(PH_CALCULATEBALANCE(B.ORDER_ID,B.ORDER_LINE_NO)),2)) ELSE ROUND(TO_NUMBER(PH_CALCULATEBALANCE(B.ORDER_ID,B.ORDER_LINE_NO)),2)||' '||'('||((D.ORDER_QTY*L.STRENGTH_VALUE)- (B.DISP_QTY*E.STRENGTH_VALUE)) ||' '||E.STRENGTH_UOM ||')' END ) BMS_QTY  FROM  PH_DISP_HDR A,PH_DISP_DTL B,OR_ORDER_LINE D ,PH_DRUG E, PH_DRUG L,PH_DISP_LOCN M, IP_NURSING_UNIT N,OP_CLINIC O WHERE A.FACILITY_ID = B.FACILITY_ID AND A.FACILITY_ID= N.FACILITY_ID(+)  AND  A.FACILITY_ID= O.FACILITY_ID(+)  AND  A.DISP_LOCN_CODE= M.DISP_LOCN_CODE AND  A.LOCN_CODE= N.NURSING_UNIT_CODE(+) AND A.LOCN_CODE= O.CLINIC_CODE(+) AND  	A.DISP_NO = B.DISP_NO  AND A.ORDER_ID = B.ORDER_ID AND   E.DRUG_CODE = B.DISP_DRUG_CODE  AND   L.DRUG_CODE = B.PRES_DRUG_CODE  AND   M.DISP_LOCN_CODE = A.DISP_LOCN_CODE  AND 	B.ORDER_ID = D.ORDER_ID  AND  	B.ORDER_LINE_NO= D.ORDER_LINE_NUM  AND  PH_CALCULATEBALANCE(B.ORDER_ID,B.ORDER_LINE_NO)  <> 0  AND  	A.DISP_NO= ?  AND  	A.FACILITY_ID= ? AND  A.PATIENT_ID = ?  ORDER BY A.DISP_DATE_TIME");
		dataMap.put("SQL_PH_PRINT_DISP_LABEL_SELECT2","SELECT SRL_NO FROM PH_DISP_DTL WHERE DISP_NO=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_PRINT_DISP_MEDICAL_ITEM_LBL_DISP_NO","SELECT DISP_NO,B.IV_PREP_YN FROM PH_DISP_HDR A , OR_ORDER B WHERE A.ORDER_ID = B.ORDER_ID and A.PATIENT_ID=? AND (B.IV_PREP_YN IS NULL OR B.IV_PREP_YN = 'N' ) AND TRUNC(A.DISP_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND B.PATIENT_CLASS=? ORDER BY A.DISP_NO");

		// ADR Type

		dataMap.put("SQL_PH_ADRTYPE_SELECT1", "SELECT A.ADR_CODE,A.ADR_DESC,A.EFF_STATUS FROM PH_ADR_TYPE_LANG_VW A  WHERE ADR_CODE = ? AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ADRTYPE_SELECT2", "SELECT COUNT(ROWID) FROM PH_ADR_TYPE WHERE ADR_CODE=?");
		dataMap.put("SQL_PH_ADRTYPE_SELECT3", "SELECT ADR_CODE,ADR_DESC,EFF_STATUS FROM PH_ADR_TYPE_LANG_VW PH_ADR_TYPE WHERE ADR_CODE like NVL(upper(?),ADR_CODE) AND ADR_DESC LIKE NVL(UPPER(?),ADR_DESC) AND EFF_STATUS LIKE NVL(?,EFF_STATUS) AND LANGUAGE_ID =?");
		dataMap.put("SQL_PH_ADRTYPE_INSERT", "INSERT INTO PH_ADR_TYPE (ADR_CODE, ADR_DESC, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_ADRTYPE_UPDATE", "UPDATE PH_ADR_TYPE SET  ADR_DESC=?, EFF_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ADR_CODE=?  ");	
		
		//Report Return Medication
		dataMap.put("SQL_PH_RETMEDICATION_SELECT1","SELECT A.DISP_NO,A.PATIENT_ID,E.DISP_DRUG_CODE,F.DRUG_DESC,E.RETURNED_QTY,to_char(E.MODIFIED_DATE,'dd/mm/yyyy hh24:mi') RETURNED_DATE, A.DISP_LOCN_CODE, B.SHORT_DESC, A.PATIENT_CLASS, DECODE( A.PATIENT_CLASS,'IP',C.LONG_DESC,'EA',D.LONG_DESC,D.LONG_DESC ) SOURCE FROM PH_DISP_HDR A,PH_DISP_DTL E,PH_DRUG_LANG_VW	 F,PH_DISP_LOCN_LANG_VW B,IP_NURSING_UNIT_LANG_VW C,OP_CLINIC_LANG_VW D WHERE A.DISP_NO= E.DISP_NO AND A.FACILITY_ID = E.FACILITY_ID AND B.FACILITY_ID    = A.FACILITY_ID AND A.FACILITY_ID    = C.FACILITY_ID(+)  AND  A.FACILITY_ID    = D.FACILITY_ID(+)  AND  E.DISP_DRUG_CODE = F.DRUG_CODE AND   B.DISP_LOCN_CODE = A.DISP_LOCN_CODE AND  A.LOCN_CODE      = C.NURSING_UNIT_CODE(+) AND  A.LOCN_CODE      = D.CLINIC_CODE(+) AND  (E.RETURNED_QTY IS NOT NULL AND E.RETURNED_QTY !='0') AND  A.FACILITY_ID=? AND  A.DISP_NO = NVL(?,A.DISP_NO) AND  A.PATIENT_ID = NVL(?,A.PATIENT_ID) AND F.LANGUAGE_ID = B.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ? ORDER BY A.DISP_DATE_TIME DESC");

		// Start Dispense Queue Management
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT1", "SELECT 1 FROM AM_PRACTITIONER A,SM_APPL_USER B WHERE A.PRACTITIONER_ID=B.FUNC_ROLE_ID AND A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND A.PRACT_TYPE='PH' AND APPL_USER_ID=?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT2", "SELECT 1 FROM SM_MODULE WHERE MODULE_ID='OR' AND INSTALL_YN='Y'");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT3", "SELECT DISP_LOCN_CODE FROM PH_WS_NO_FOR_DISP_LOCN WHERE FACILITY_ID=? AND WS_NO=?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT4", "SELECT A.SHORT_DESC, A.DISP_LOCN_CODE, A.ISSUE_TOKEN_ON_REGN_YN, (CASE WHEN A.DISP_FILL_STAGE='B' OR A.DISP_FILL_STAGE='A' THEN A.DISP_VERF_STAGE ELSE 'X' END) DISP_VERF_STAGE FROM PH_DISP_LOCN A, PH_DISP_RIGHTS B WHERE A.FACILITY_ID = ? AND B.FACILITY_ID=A.FACILITY_ID AND B.APPL_USER_ID = ? AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND B.ACK_YN <> 'N' AND A.DISP_REGN_REQD_YN <> 'N'");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT5", "SELECT D.TOKEN_SERIES_CODE, D.DESCRIPTION FROM PH_DISP_LOCN A, PH_WS_NO_FOR_DISP_LOCN B, PH_DISP_RIGHTS C,PH_TOKEN_SERIES D WHERE A.FACILITY_ID=? AND A.FACILITY_ID=B.FACILITY_ID AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND B.WS_NO=? AND A.FACILITY_ID=C.FACILITY_ID AND A.DISP_LOCN_CODE=C.DISP_LOCN_CODE  AND A.DISP_LOCN_CODE=? AND A.DISP_LOCN_CODE=D.DISP_LOCN_CODE AND C.APPL_USER_ID=? AND A.ISSUE_TOKEN_ON_REGN_YN='Y' AND A.FACILITY_ID=D.FACILITY_ID AND A.DISP_LOCN_CODE=D.DISP_LOCN_CODE AND D.EFF_STATUS='E' AND C.ACK_YN='Y'");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT6", "SELECT B.ALLOCATE_YN REVIEW_ALLOC, B.VERIFY_YN REVIEW_ORDER_HOLD, (CASE WHEN B.FILL_YN='Y' THEN A.DISP_FLNG_REQD_YN ELSE 'N' END) FILLING, (CASE WHEN B.ALLOCATE_YN='Y' THEN A.DISP_FILL_STAGE ELSE 'X' END) ALLOCATION, (CASE WHEN B.VERIFY_YN='Y' THEN A.DISP_VERF_STAGE ELSE 'C' END) VERIFICATION, (CASE WHEN B.BILL_RECEIPT_YN='Y' THEN A.DISP_CASH_COLL_STAGE ELSE 'X' END) BILLING, (CASE WHEN B.DELIVER_YN='Y' THEN A.DISP_DELV_REQD_YN ELSE 'N' END) DELIVERY,A.DISP_FILL_STAGE FROM PH_DISP_LOCN A, PH_DISP_RIGHTS B WHERE A.EFF_STATUS='E' AND B.APPL_USER_ID=? AND A.FACILITY_ID=? AND A.DISP_LOCN_CODE=? AND A.FACILITY_ID=B.FACILITY_ID AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT7", "SELECT TOT_REGD, TOT_VERIFIED, TOT_FILLED, TOT_ALLOCATED, TOT_BILLED, TOT_DELIVERED FROM PH_DISP_QUEUE_SUMM WHERE FACILITY_ID = ? AND DISP_LOCN_CODE = ? AND QUEUE_DATE = TRUNC(SYSDATE) AND QUEUE_SHIFT ='*ALL' AND TOKEN_SERIES_CODE = ?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT8", "SELECT A.INVENTORY_ITEM_CODE,B.LONG_DESC FROM PH_INVENTORY_ITEM_FOR_DRUG A,ST_ITEM B WHERE A.INVENTORY_ITEM_CODE=B.ITEM_CODE AND A.INVENTORY_ITEM_CODE =?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT9","SELECT DISTINCT A.PATIENT_ID,PH_InvokeDispenseStageButtons(A.PATIENT_CLASS,A.PATIENT_ID,?,?) STATUS,A.ENCOUNTER_ID ENCOUNTER_ID,D.PATIENT_NAME,DECODE(D.SEX,'M','male','F','female','U','unknown')GENDER,  GET_AGE(D.DATE_OF_BIRTH) AGE,E.COUNTRY_CODE,E.SHORT_NAME COUNTRY,COUNT(DISTINCT C.ORDER_ID) TOTAL_PRES,A.PRIORITY FROM OR_ORDER A, PH_FACILITY_PARAM B,OR_ORDER_LINE C,MP_PATIENT D,MP_COUNTRY E,PH_ORDER_TYPE_FOR_DRUG_CLASS F,OR_ORDER_STATUS_CODE G ,IP_NURSING_UNIT H  WHERE   A.ORDER_CATEGORY='PH' AND G.ORDER_STATUS_TYPE NOT IN ('97','95','99','93','00','03','05','58','64') AND D.PATIENT_ID=A.PATIENT_ID AND D.NATIONALITY_CODE=E.COUNTRY_CODE(+) AND C.ORDER_TYPE_CODE=F.ORDER_TYPE_CODE(+) AND A.PATIENT_CLASS = ? AND H.FACILITY_ID = ? AND A.PATIENT_ID = NVL(?,A.PATIENT_ID) AND D.NATIONAL_ID_NO = NVL(?,D.NATIONAL_ID_NO) AND A.ORDER_ID=NVL(?,A.ORDER_ID) AND A.PRIORITY=NVL(?,A.PRIORITY) AND H.NURSING_UNIT_CODE=NVL(?,NURSING_UNIT_CODE) AND TRUNC(A.ORD_DATE_TIME)  BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/RRRR') AND B.FACILITY_ID = H.FACILITY_ID AND (TRUNC(C.START_DATE_TIME) >= (CASE WHEN B.DISP_BEFORE_START_DATE_YN = 'Y' AND  G.ORDER_STATUS_TYPE<>'10' 	 THEN TRUNC(C.START_DATE_TIME) WHEN B.DISP_BEFORE_START_DATE_YN = 'Y' AND G.ORDER_STATUS_TYPE='10'	  THEN (TRUNC(SYSDATE) -B.DISP_BEFORE_NO_OF_DAYS) 	 ELSE TO_DATE('31/12/5000','DD/MM/RRRR') END)	 OR TRUNC(C.START_DATE_TIME) <= (CASE   WHEN B.DISP_BEYOND_EARLIEST_START_YN = 'Y' AND G.ORDER_STATUS_TYPE<>'10'       THEN TRUNC(C.START_DATE_TIME) WHEN B.DISP_BEYOND_EARLIEST_START_YN = 'Y' AND G.ORDER_STATUS_TYPE='10'      THEN (TRUNC(SYSDATE)+B.DISP_BEYOND_NO_OF_DAYS) 		 ELSE TO_DATE('01/01/1472','DD/MM/RRRR') END))");//,'64' added for mms-kh-crf-0014
		//NOTE FOR SQL_PH_DISP_QUEUE_MGMT_SELECT9: TO BE INCLUDED IN FUTURE:health_cardnum,fill_process_date,fill_process_type,fill_process_id,batches
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT10", "SELECT DISTINCT B.PATIENT_ID, D.PATIENT_NAME FROM PH_DISP_LOCN A, OR_ORDER B, OR_ORDER_LINE C, MP_PATIENT D WHERE B.ORDER_CATEGORY='PH' AND B.ORDER_STATUS = (CASE WHEN (A.DISP_FILL_STAGE='X' AND A.DISP_VERF_STAGE='B') THEN 'VF' WHEN (A.DISP_FILL_STAGE='X' AND A.DISP_VERF_STAGE='C' AND A.DISP_REGN_REQD_YN='Y') THEN 'RG' WHEN (A.DISP_FILL_STAGE='X' AND A.DISP_VERF_STAGE='C' AND A.DISP_REGN_REQD_YN='N') THEN 'OS' WHEN (A.DISP_FILL_STAGE = 'B' AND (A.DISP_VERF_STAGE = 'F' OR  A.DISP_VERF_STAGE = 'C')) THEN 'IP' WHEN (A.DISP_FILL_STAGE = 'A' AND A.DISP_VERF_STAGE = 'B') THEN 'VF' WHEN (A.DISP_FILL_STAGE = 'A' AND A.DISP_VERF_STAGE = 'C' AND A.DISP_REGN_REQD_YN = 'Y') THEN 'RG' WHEN (A.DISP_FILL_STAGE = 'A' AND A.DISP_VERF_STAGE = 'C' AND A.DISP_REGN_REQD_YN = 'N') THEN 'OS' END) AND D.PATIENT_ID=B.PATIENT_ID ");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT11","SELECT A.INVENTORY_ITEM_CODE, B.LONG_DESC,B.STK_UOM_CODE FROM PH_INVENTORY_ITEM_FOR_DRUG A,ST_ITEM B WHERE A.INVENTORY_ITEM_CODE=B.ITEM_CODE AND A.DRUG_CODE= ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT12","SELECT A.BATCH_ID FROM ST_ITEM_BATCH A WHERE A.ITEM_CODE=? AND A.FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT13","SELECT to_char(A.EXPIRY_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.BIN_LOCATION_CODE,B.LONG_DESC,A.QTY_ON_HAND,A.STORE_CODE FROM ST_ITEM_BATCH A,MM_BIN_LOCATION B WHERE  A.BATCH_ID=? AND B.BIN_LOCATION_CODE = A.BIN_LOCATION_CODE AND B.STORE_CODE=A.STORE_CODE");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT14","SELECT MANUFACTURER_ID FROM MM_ITEM WHERE ITEM_CODE=?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT15","SELECT A.SHORT_NAME,A.LONG_NAME,B.LONG_NAME FROM AM_TRADE_NAME A, AM_MANUFACTURER B WHERE A.DRUG_CODE=? AND A.MANUFACTURER_ID =? AND A.MANUFACTURER_ID = B.MANUFACTURER_ID");
		//AND A.DISP_MULTI_STRENGTH_YN=B.DISP_MULTI_STRENGTH_YN REMOVED FOR GHL-CRF-0548
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT16","SELECT A.DISP_MULTI_STRENGTH_YN PARAM_YN,B.DISP_MULTI_STRENGTH_YN DRUG_YN,  B.NPB_DRUG_YN, B.DISP_ALT_FORM_YN,a.disp_alt_form_yn from_param FROM PH_PARAM A, PH_DRUG B WHERE B.DRUG_CODE =?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT17","SELECT TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE QUEUE_DATE=TRUNC(SYSDATE) AND PATIENT_ID=?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT18", "SELECT DECODE(A.PRIORITY, 'U', 'urgent', 'R', 'routine')PRIORITY, B.SHORT_DESC ORDER_TYPE_DESC, A.ORDER_ID, TO_CHAR(A.ORD_DATE_TIME, 'DD/MM/RRRR') ORD_DATE_TIME, DECODE(A.SOURCE_TYPE, 'C', C.SHORT_DESC, 'N', D.SHORT_DESC) SOURCE_DESC, E.PRACTITIONER_NAME FROM  OR_ORDER A, OR_ORDER_TYPE B, OP_CLINIC C, IP_NURSING_UNIT D, AM_PRACTITIONER E, PH_ORDER_TYPE_FOR_DRUG_CLASS F, OR_ORDER_LINE G, OR_ORDER_STATUS_CODE H , PH_FACILITY_PARAM I WHERE  G.ORDER_CATEGORY='PH' AND H.ORDER_STATUS_TYPE NOT IN ('97','95','99','93','00','03','05','58','64') AND A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND A.ORDERING_FACILITY_ID=C.FACILITY_ID(+) AND A.SOURCE_CODE=C.CLINIC_CODE(+) AND A.ORDERING_FACILITY_ID=D.FACILITY_ID(+) AND A.SOURCE_CODE=D.NURSING_UNIT_CODE(+) AND A.ORD_PRACT_ID=E.PRACTITIONER_ID AND G.ORDER_TYPE_CODE=F.ORDER_TYPE_CODE(+) AND A.ORDER_ID = G.ORDER_ID AND A.PATIENT_ID=? AND A.PATIENT_CLASS=? AND A.ORDER_ID=NVL('',A.ORDER_ID) AND A.PRIORITY=NVL('',A.PRIORITY) AND TO_DATE(A.ORD_DATE_TIME,'DD/MM/RRRR') BETWEEN TO_DATE(NVL('','01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL('','31/12/5000'),'DD/MM/RRRR') AND A.ORDERING_FACILITY_ID=? AND G.ORDER_LINE_STATUS = H.ORDER_STATUS_CODE AND I.FACILITY_ID = A.ORDERING_FACILITY_ID AND (TRUNC(G.START_DATE_TIME) >= (CASE WHEN I.DISP_BEFORE_START_DATE_YN = 'Y' AND  H.ORDER_STATUS_TYPE<>'10' THEN TRUNC(G.START_DATE_TIME) WHEN I.DISP_BEFORE_START_DATE_YN = 'Y' AND H.ORDER_STATUS_TYPE='10' THEN (TRUNC(SYSDATE) -I.DISP_BEFORE_NO_OF_DAYS) ELSE TO_DATE('31/12/5000','DD/MM/RRRR') END) OR TRUNC(G.START_DATE_TIME) <= (CASE WHEN I.DISP_BEYOND_EARLIEST_START_YN = 'Y' AND H.ORDER_STATUS_TYPE<>'10' THEN TRUNC(G.START_DATE_TIME) WHEN I.DISP_BEYOND_EARLIEST_START_YN = 'Y' AND H.ORDER_STATUS_TYPE='10' THEN (TRUNC(SYSDATE)+I.DISP_BEYOND_NO_OF_DAYS) ELSE TO_DATE('01/01/1472','DD/MM/RRRR') END))");//,'64' added for mms-kh-crf-0014
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT19", "SELECT A.ORDER_ID, A.ORDER_LINE_NUM, A.ORDER_LINE_STATUS, F.ORDER_STATUS_TYPE, A.ORDER_CATALOG_CODE, B.GENERIC_ID, B.DRUG_CODE, B.DRUG_DESC, A.ORDER_QTY, A.QTY_UNIT, C.SHORT_DESC QTY_UNIT_DESC, D.FREQ_DESC,A.DURN_VALUE, E.DURN_DESC, TO_CHAR(A.START_DATE_TIME, 'DD/MM/RRRR') START_DATE_TIME, TO_CHAR(A.END_DATE_TIME, 'DD/MM/RRRR') END_DATE_TIME, A.QTY_VALUE FROM OR_ORDER_LINE A, PH_DRUG B, AM_UOM C,AM_FREQUENCY D, AM_DURATION_TYPE E, OR_ORDER_STATUS_CODE F WHERE A.ORDER_LINE_STATUS=F.ORDER_STATUS_CODE AND A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.QTY_UNIT=C.UOM_CODE(+) AND A.FREQ_CODE=D.FREQ_CODE(+) AND A.DURN_TYPE=E.DURN_TYPE(+)");
		/******Multi Strength Queries Starts*****/
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT20", "SELECT DISP_ALT_FORM_YN,ROUTE_CODE,FORM_CODE,STRENGTH_UOM FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT21","SELECT DRUG_CODE,DRUG_DESC,STRENGTH_VALUE,STRENGTH_UOM,STRENGTH_UOM_DESC,FORM_CODE,FORM_DESC,ROUTE_CODE,ROUTE_DESC,ph_get_ext_prod_drug_code(drug_code,?)EXTERNAL_PRODUCT_ID,STOCK_UOM FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE GENERIC_ID=? AND DRUG_CODE!=? AND ROUTE_CODE=? and npb_drug_yn <>'Y' AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?  ORDER BY FORM_DESC");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT22","SELECT DRUG_CODE,DRUG_DESC,STRENGTH_VALUE,STRENGTH_UOM,STRENGTH_UOM_DESC,FORM_CODE,FORM_DESC,ROUTE_CODE,ROUTE_DESC,ph_get_ext_prod_drug_code(drug_code,?)EXTERNAL_PRODUCT_ID,STOCK_UOM FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE GENERIC_ID=? AND DRUG_CODE!=? AND FORM_CODE=? AND ROUTE_CODE=? and npb_drug_yn<>'Y' AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		/******Multi Strength Queries Ends*****/
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT23", "SELECT OT.LONG_DESC,O.PATIENT_ID,TO_CHAR(O.ORD_DATE_TIME,'dd/mm/yyyy hh24:mi')ORD_DATE_TIME,PR.PRACTITIONER_NAME,DECODE(O.PRIORITY,'R','routine','U','urgent') PRIORITY,O.CHILD_ORDER_YN,OL.ORDER_CATALOG_CODE DRUGCODE,OL.QTY_VALUE,OL.QTY_UNIT,OL.DURN_VALUE,DURTYPE.DURN_DESC,OL.CATALOG_DESC,TO_CHAR(OL.START_DATE_TIME,'dd/mm/yyyy hh24:mi')START_DATE_TIME, FRM.FORM_DESC,RO.ROUTE_DESC,FREQ.FREQ_DESC,FREQ.FREQ_NATURE,OL.LINE_FIELDS_DISPLAY_TEXT,TO_CHAR(OL.END_DATE_TIME,'dd/mm/yyyy hh24:mi')END_DATE_TIME,OL.ORDER_QTY,UOM.SHORT_DESC,OL.CONT_ORDER_IND,OL.REFILL_SINGLE_CONT_ORDER_YN,OL.NUM_OF_REFILLS,OL.PARENT_ORDER_LINE_NUM,PDP.STRENGTH,PDP.STRENGTH_UOM_CODE STRENGTHUOM,DIAG_TEXT,PDP.ALLERGY_OVERRIDE_REASON,PDP.DOSAGE_LIMIT_OVERRIDE_REASON,PDP.DUPLICATE_DRUG_OVERRIDE_REASON,PDP.TAPERED_YN,GENERIC_ID,DECODE(ALLERGY_OVERRIDE_REASON,NULL,'N','Y')ALLERGY_YN ,O.ORDER_TYPE_CODE,OT.SHORT_DESC ORDERTYPEDESC,PDP.SPLIT_DOSE_PREVIEW,O.DISCHARGE_IND TAKEHOME,DECODE(OL.CHILD_ORDER_YN,'Y',OL.START_DATE_TIME) REFILL_START_DATE_TIME,DECODE(OL.CHILD_ORDER_YN,'Y',OL.END_DATE_TIME)REFILL_END_DATE_TIME,OLF.ORDER_LINE_FIELD_VALUE DRUG_REMARKS FROM OR_ORDER O,OR_ORDER_TYPE OT,AM_PRACTITIONER PR,OR_ORDER_LINE OL,PH_FORM FRM,PH_ROUTE RO,AM_FREQUENCY FREQ,AM_DURATION_TYPE DURTYPE,AM_UOM UOM,PH_PATIENT_DRUG_PROFILE PDP,OR_ORDER_LINE_FIELD_VALUES OLF WHERE O.ORDER_TYPE_CODE=OT.ORDER_TYPE_CODE AND O.ORD_PRACT_ID=PR.PRACTITIONER_ID AND OL.FORM_CODE=FRM.FORM_CODE(+) AND OL.ROUTE_CODE=RO.ROUTE_CODE(+) AND OL.FREQ_CODE=FREQ.FREQ_CODE(+) AND OL.DURN_TYPE=DURTYPE.DURN_TYPE(+) AND OL.ORDER_UOM=UOM.UOM_CODE(+) AND PDP.ORIG_ORDER_LINE_NO=OL.ORDER_LINE_NUM AND PDP.ORIG_ORDER_ID=O.ORDER_ID AND O.ORDER_ID=OL.ORDER_ID AND O.ORDER_ID=? AND O.PATIENT_ID=? AND OL.ORDER_ID=OLF.ORDER_ID(+) AND OL.ORDER_LINE_NUM=OLF.ORDER_LINE_NUM(+) ");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT27", "SELECT B.DESCRIPTION, A.TOKEN_SERIAL_NO FROM PH_DISP_QUEUE A, PH_TOKEN_SERIES B WHERE A.QUEUE_DATE=TRUNC(SYSDATE) AND A.QUEUE_SHIFT='*ALL' AND A.FACILITY_ID=? AND A.PATIENT_ID=? AND B.DISP_LOCN_CODE=? AND A.TOKEN_SERIES_CODE=B.TOKEN_SERIES_CODE AND A.FACILITY_ID=B.FACILITY_ID");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT28", "SELECT DRUG_DESC,GENERIC_ID,GENERIC_NAME,FORM_CODE,FORM_DESC,ROUTE_CODE,ROUTE_DESC FROM PH_DRUG_VW_LANG_VW PH_DRUG_VW WHERE DRUG_CODE=? AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT29", "SELECT STORE_CODE FROM ST_ITEM_BATCH WHERE ITEM_CODE = ? AND FACILITY_ID = ?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT30", "SELECT B.SHORT_DESC, C.SHORT_NAME NATIONALITY_DESC FROM MP_PATIENT A, MP_ALTERNATE_ID_TYPE B, MP_COUNTRY C WHERE A.PATIENT_ID=? AND A.ALT_ID1_TYPE=B.ALT_ID_TYPE AND A.NATIONALITY_CODE=C.COUNTRY_CODE(+)");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT31", "SELECT TOKEN_SERIES_CODE FROM PH_DISP_QUEUE WHERE PATIENT_ID = ?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT32","SELECT DECODE(A.PRIORITY,'U', 'urgent', 'R', 'routine')PRIORITY, B.SHORT_DESC ORDER_TYPE_DESC, A.ORDER_ID, TO_CHAR(A.ORD_DATE_TIME,'DD/MM/RRRR') ORD_DATE_TIME, DECODE(A.SOURCE_TYPE,'C',C.SHORT_DESC,'N',D.SHORT_DESC) SOURCE_DESC, E.PRACTITIONER_NAME,G.ORDER_LINE_NUM, G.ORDER_LINE_STATUS, H.ORDER_STATUS_TYPE, G.ORDER_CATALOG_CODE,J.GENERIC_ID, J.DRUG_CODE, J.DRUG_DESC, G.ORDER_QTY, G.QTY_UNIT, K.SHORT_DESC QTY_UNIT_DESC, L.FREQ_DESC,G.DURN_VALUE,M.DURN_DESC, TO_CHAR(G.START_DATE_TIME, 'DD/MM/RRRR') START_DATE_TIME,TO_CHAR(G.END_DATE_TIME, 'DD/MM/RRRR') END_DATE_TIME,G.QTY_VALUE, PH_DrugDoseInLimit(J.DRUG_CODE,A.PATIENT_ID,G.QTY_VALUE,G.DURN_VALUE,G.ORDER_QTY) DOSAGE_LIMIT FROM OR_ORDER A,OR_ORDER_TYPE B,OP_CLINIC C,IP_NURSING_UNIT D, AM_PRACTITIONER E, PH_ORDER_TYPE_FOR_DRUG_CLASS F, OR_ORDER_LINE G, OR_ORDER_STATUS_CODE H, PH_FACILITY_PARAM I,PH_DRUG J, AM_UOM  K, AM_FREQUENCY L, AM_DURATION_TYPE M WHERE B.ORDER_CATEGORY='PH' AND A.ORDER_CATEGORY = G.ORDER_CATEGORY AND B.ORDER_CATEGORY = G.ORDER_CATEGORY AND H.ORDER_STATUS_TYPE NOT IN ('97','95','99','93','00','03','05') AND G.ORDER_LINE_STATUS = H.ORDER_STATUS_CODE AND G.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND G.ORDER_TYPE_CODE=F.ORDER_TYPE_CODE(+) AND A.ORDERING_FACILITY_ID=C.FACILITY_ID(+) AND A.SOURCE_CODE=C.CLINIC_CODE(+) AND A.ORDERING_FACILITY_ID=D.FACILITY_ID(+) AND A.SOURCE_CODE=D.NURSING_UNIT_CODE(+) AND A.ORD_PRACT_ID=E.PRACTITIONER_ID AND A.ORDER_ID = G.ORDER_ID AND G.ORDER_CATALOG_CODE=J.DRUG_CODE(+) AND G.QTY_UNIT=K.UOM_CODE(+) AND G.FREQ_CODE=L.FREQ_CODE(+) AND G.DURN_TYPE=M.DURN_TYPE(+) AND A.PATIENT_ID=? AND A.PATIENT_CLASS=? AND A.ORDER_ID=NVL('',A.ORDER_ID) AND A.PRIORITY=NVL('',A.PRIORITY) AND TO_DATE(A.ORD_DATE_TIME,'DD/MM/RRRR') BETWEEN TO_DATE(NVL('','01/01/1472'),'DD/MM/RRRR') AND TO_DATE(NVL('','31/12/5000'),'DD/MM/RRRR') AND A.ORDERING_FACILITY_ID=? AND I.FACILITY_ID = A.ORDERING_FACILITY_ID ");
		/* This query selects alternate drugs along with the item_code and avaiable quantity from stock */
		/*
		Parameter 1:Store_code
		Parameter 2:Reqd_Qty
		Parameter 3:Effective_Expiry_date
		Parameter 4:Generic_id
		Parameter 5:drug_code
		*/
	
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT33","SELECT NURSING_UNIT_CODE CODE, SHORT_DESC DESCRIPTION FROM IP_NURSING_UNIT WHERE EFF_STATUS='E' AND FACILITY_ID LIKE UPPER(?) AND NURSING_UNIT_CODE LIKE ? AND SHORT_DESC LIKE ? ORDER BY 2");	
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT34","SELECT A.DRUG_CODE, A.GENERIC_ID, A.DRUG_DESC, ph_get_ext_prod_drug_code(a.drug_code,?)EXTERNAL_PRODUCT_ID , A.STRENGTH_VALUE, A.STRENGTH_UOM, c.SHORT_DESC, A.FORM_CODE, d.FORM_DESC, A.ROUTE_CODE, e.ROUTE_DESC ,f.INVENTORY_ITEM_CODE, (SELECT SHORT_DESC FROM MM_ITEM_LANG_VW WHERE ITEM_CODE=f.INVENTORY_ITEM_CODE AND LANGUAGE_ID = ? ) ITEM_DESCRIPTION, Ph_Ret_Stock_Avail_Status(F.INVENTORY_ITEM_CODE,?,?,'Y', ? ,'N',NULL ) AVAILABLE_QTY ,A.STOCK_UOM FROM PH_DRUG_LANG_VW A,PH_DRUG_LANG_VW B,am_uom_LANG_VW c,ph_form_LANG_VW d,ph_route_LANG_VW e,PH_INVENTORY_ITEM_FOR_DRUG f WHERE A.GENERIC_ID=B.GENERIC_ID AND A.ROUTE_CODE=B.ROUTE_CODE AND (( B.DISP_ALT_FORM_YN='N' AND b.FORM_code=a.form_code ) OR B.DISP_ALT_FORM_YN='Y') AND a.STRENGTH_UOM=c.uom_code AND d.form_code=a.form_code AND a.route_code=e.route_code AND ( EXISTS (SELECT 'Y' FROM am_uom_eqvl WHERE uom_code = a.strength_uom AND eqvl_uom_code = b.strength_uom UNION SELECT 'Y' FROM am_uom_eqvl WHERE uom_code = b.strength_uom AND eqvl_uom_code = a.strength_uom ) or a.strength_uom = b.strength_uom) AND A.STRENGTH_VALUE<>0 AND A.DRUG_CODE=f.DRUG_CODE(+) AND A.GENERIC_ID=? AND B.DRUG_CODE=? AND a.NPB_DRUG_YN <>'Y' AND A.DISP_MULTI_STRENGTH_YN='Y' AND a.language_id = b.language_id AND a.language_id = c.language_id AND a.language_id = d.language_id AND a.language_id = e.language_id AND a.language_id = ? order by to_number(nvl(available_qty,0))desc, A.DRUG_DESC");
		//dataMap.put("SQL_PH_DISP_QUEUE_MGMT_SELECT34","SELECT A.DRUG_CODE, A.GENERIC_ID, A.DRUG_DESC, ph_get_ext_prod_drug_code(a.drug_code,?)EXTERNAL_PRODUCT_ID , A.STRENGTH_VALUE, A.STRENGTH_UOM, A.FORM_CODE, d.FORM_DESC, A.ROUTE_CODE, e.ROUTE_DESC ,f.INVENTORY_ITEM_CODE, (SELECT SHORT_DESC FROM MM_ITEM_LANG_VW WHERE ITEM_CODE=f.INVENTORY_ITEM_CODE AND LANGUAGE_ID = ? ) ITEM_DESCRIPTION, Ph_Ret_Stock_Avail_Status(F.INVENTORY_ITEM_CODE,?,?,'Y', ? ,'N',NULL ) AVAILABLE_QTY ,A.STOCK_UOM FROM PH_DRUG_LANG_VW A,PH_DRUG_LANG_VW B, ph_form_LANG_VW d,ph_route_LANG_VW e,PH_INVENTORY_ITEM_FOR_DRUG f WHERE A.GENERIC_ID=B.GENERIC_ID AND A.ROUTE_CODE=B.ROUTE_CODE AND (( B.DISP_ALT_FORM_YN='N' AND b.FORM_code=a.form_code ) OR B.DISP_ALT_FORM_YN='Y') AND d.form_code=a.form_code AND a.route_code=e.route_code AND A.DRUG_CODE=f.DRUG_CODE(+) AND A.GENERIC_ID=? AND B.DRUG_CODE=? AND a.NPB_DRUG_YN <>'Y' AND A.DISP_MULTI_STRENGTH_YN='Y' AND a.language_id = b.language_id AND a.language_id = d.language_id AND a.language_id = e.language_id AND a.language_id = ? order by nvl(available_qty,0)desc, A.DRUG_DESC");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_UPDATE_OR_ORDER","UPDATE OR_ORDER SET ORDER_STATUS = (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE 	ORDER_STATUS_TYPE = ?),MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDER_ID = ?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_UPDATE_OR_ORDER_LINE","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS = (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE 	ORDER_STATUS_TYPE = ?), MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDER_ID= ? AND ORDER_LINE_NUM = ?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_UPDATE_DISP_QUEUE_SUMM","UPDATE PH_DISP_QUEUE_SUMM  SET  TOT_VERIFIED = NVL(TOT_VERIFIED,0)+1, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE,  MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		dataMap.put("SQL_PH_DISP_QUEUE_MGMT_UPDATE_DISP_QUEUE_SUMM2","UPDATE PH_DISP_QUEUE_SUMM  SET  TOT_FILLED = TOT_FILLED+1, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE,  MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		/* JNDI locations start */
		dataMap.put("JNDI_PH_DISP_QUEUE_MGMT"  , "java:comp/env/DispQueueManagement");
		/* JNDI locations end */
		// End Dispense Queue Management

		
		//Query Added to get the dispence quantity for delivery		
		dataMap.put("SQL_PH_TPN_WORKSHEET_DTL_DISP_QTY_SELECT" , "SELECT DISP_QTY DISP_QTY FROM PH_TPN_WORKSHEET_DTL WHERE  ORDER_ID=? AND ORDER_LINE_NUM=?" );
		dataMap.put("SQL_PH_DISP_MEDICATION_PRINT_DIALOG_SELECT","SELECT  DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE DISP_LOCN_CATEGORY IN('O','B') AND DISP_LOCN_TYPE='P' AND EFF_STATUS='E' AND FACILITY_ID=? AND LANGUAGE_ID = ?");
	
		/* Imp-Dont Delete
		SQL_PH_TPN_DISP_MEDICATION_SELECT1-This query is for dispensing of tpn regimen.... superflous columns have been retained in this query to maintain the same structure as that of orderline queries for drug dispensing
		*/
		//QUERY ADDED FOR CHANGE DOSE ....ON 29/4/2004
		dataMap.put("SQL_PH_DISP_MEDICATION_REASON_REMARKS" , "SELECT REMARKS FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE REASON_CODE = ? AND APPL_TRN_TYPE = ? AND LANGUAGE_ID = ?" );
		dataMap.put("SQL_PH_DISP_MEDICATION_ALL_DRUG_DOSAGE" , "SELECT CHANGE_DOSE_DURN_VERIFY_YN FROM PH_DISP_RIGHTS WHERE FACILITY_ID = ? AND DISP_LOCN_CODE = ? AND APPL_USER_ID = ?");		
		dataMap.put("SQL_PH_TPN_DISP_MEDICATION_SELECT1", "SELECT   /*+ INDEX(OR_ORDER_LINE  IN_OR_ORDER_LINE) */ H.PATIENT_ID,   A.QTY_VALUE ,B.ITEM_CODE,   b.tpn_regimen_code drug_CODE,   '' STRENGTH_VALUE, '' STRENGTH_UOM,'' GENERIC_NAME,    (SELECT SUM(DISP_QTY) FROM PH_DISP_DTL_TMP WHERE  ORDER_ID=A.ORDER_ID AND   ORDER_LINE_NO=A.ORDER_LINE_NUM ) ALLOC_QTY,   A.CATALOG_DESC drug_deSC,   A.ORDER_QTY, '' ISDUPLICATE,   A.QTY_UNIT,C.SHORT_DESC QTY_UNIT_DESC,D.FREQ_DESC,A.DURN_VALUE,    E.DURN_DESC,TO_CHAR(A.START_DATE_TIME, 'DD/MM/YYYY HH24:MI') START_DATE_TIME,   TO_CHAR(A.END_DATE_TIME, 'DD/MM/YYYY HH24:MI') END_DATE_TIME,   A.ORDER_QTY PRES_QTY_VALUE,A.ORDER_UOM PRES_QTY_UOM,  H.IV_PREP_YN,B.DRUG_CLASS, G.ALLERGY_OVERRIDE_REASON,G.DUPLICATE_DRUG_OVERRIDE_REASON,   G.DOSAGE_LIMIT_OVERRIDE_REASON,G.ORDER_LINE_NUM,A.ORDER_LINE_STATUS,   '' GENERIC_ID, g.bms_qty BMS_QTY,  A.ORDER_CATALOG_CODE, ''    DRUG_DOSAGE_LIMIT,H.SOURCE_CODE,  H.SOURCE_TYPE,H.ORDERING_FACILITY_ID,   '' EXTERNAL_PRODUCT_ID,   TO_CHAR(H.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') ORD_DATE_TIME,  H.ORD_PRACT_ID  PERFORMING_PRACT_ID,  '' MINDOSEDETAILS ,'' STKAVAILABLE ,G.BL_INCL_EXCL_OVERRIDE_VALUE, G.BL_INCL_EXCL_OVERRIDE_REASON,(CASE WHEN TRUNC(A.END_DATE_TIME)<TRUNC(SYSDATE) THEN 'Y'  ELSE 'N' END)expired_yn    FROM OR_ORDER_LINE A,    PH_TPN_REGIMEN_LANG_VW B, OR_ORDER_LINE_PH G, AM_UOM_LANG_VW C,   AM_FREQUENCY_LANG_VW D,  AM_DURATION_TYPE_LANG_VW E,     OR_ORDER H WHERE A.ORDER_ID= H.ORDER_ID AND  A.ORDER_ID= G.ORDER_ID AND  A.ORDER_LINE_NUM=G.ORDER_LINE_NUM  AND  A.ORDER_CATALOG_CODE=B.tpn_REGIMEN_CODE   AND  G.PRES_QTY_UOM=C.UOM_CODE(+)  AND  A.FREQ_CODE=D.FREQ_CODE(+)   AND  A.DURN_TYPE=E.DURN_TYPE(+)   AND  (A.ORDER_LINE_STATUS IN  (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_TYPE IN ('10','25','50','56','30','35','36')) OR    ( A.ORDER_QTY>	NVL((SELECT SUM(DISP_QTY) FROM PH_DISP_DTL_TMP M WHERE M.ORDER_LINE_NO= A.ORDER_LINE_NUM AND   M.ORDER_ID=A.ORDER_ID),0) ) 		) AND  A.ORDER_ID = NVL(?,A.ORDER_ID) AND Ph_Check_Ord_Date_Dispensing(A.START_DATE_TIME,A.END_DATE_TIME,?,?,?,?,?)=1 AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ? AND E.LANGUAGE_ID(+) = ?");//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_TPN_DISP_MEDICATION_SELECT2", "SELECT COUNT(1) cnt FROM PH_TPN_WORKSHEET_DTL WHERE facility_id = ? AND TPN_worksheet_id = ? AND disp_locn = ? AND const_generic_code  = 'LIPID' AND NVL(disp_qty,0) <> 0");
        dataMap.put("SQL_PH_TPN_DISP_MEDICATION_SELECT3" ,"SELECT QTY_VOLUME,QTY_UOM FROM PH_TPN_WORKSHEET_HDR WHERE ORDER_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT1", "SELECT 1 FROM AM_PRACTITIONER A,SM_APPL_USER B WHERE A.PRACTITIONER_ID=B.FUNC_ROLE_ID AND A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND A.PRACT_TYPE='PH' AND APPL_USER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT2", "SELECT 1 FROM SM_MODULE WHERE MODULE_ID='OR' AND INSTALL_YN='Y'");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT3", "SELECT DISP_LOCN_CODE FROM PH_WS_NO_FOR_DISP_LOCN WHERE FACILITY_ID=? AND WS_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT4", "SELECT A.SHORT_DESC, A.DISP_LOCN_CODE, A.ISSUE_TOKEN_ON_REGN_YN, (CASE WHEN A.DISP_FILL_STAGE='B' OR A.DISP_FILL_STAGE='A' THEN A.DISP_VERF_STAGE ELSE 'X' END) DISP_VERF_STAGE, B.CURR_ENC_FINANCIAL_DTL_YN FROM PH_DISP_LOCN_LANG_VW A, PH_DISP_RIGHTS B WHERE A.FACILITY_ID = ? AND B.FACILITY_ID=A.FACILITY_ID AND B.APPL_USER_ID = ? AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE  AND B.ACK_YN <> 'N' AND A.DISP_REGN_REQD_YN <> 'N'  AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT5", "SELECT DISP_LOCN_CATEGORY,ISSUE_TOKEN_ON_REGN_YN,DISP_REGN_REQD_YN, DISP_STAGE,STORE_CODE,DISP_CASH_COLL_STAGE,DISP_BILL_STAGE,CHARGE_PAT_FOR_SPILL_QTY_YN  FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN  WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT6", "SELECT A.ALT_ID1_TYPE,B.LONG_DESC SHORT_DESC,A.NATIONALITY_CODE,C.SHORT_NAME NATIONALITY_DESC,A.NATIONAL_ID_NO,  A.ALT_ID1_NO HEALTH_CARD_NO FROM MP_PATIENT A,MP_ALTERNATE_ID_TYPE_LANG_VW B, MP_COUNTRY_LANG_VW C WHERE A.PATIENT_ID=? AND A.ALT_ID1_TYPE=B.ALT_ID_TYPE(+) AND  A.NATIONALITY_CODE=C.COUNTRY_CODE(+) AND B.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT6A","SELECT   A.ALT_ID1_TYPE,  B.SHORT_DESC,  A.NATIONALITY_CODE,  C.SHORT_NAME NATIONALITY_DESC,  A.NATIONAL_ID_NO,  A.ALT_ID1_NO HEALTH_CARD_NO FROM   MP_PATIENT A,  MP_ALTERNATE_ID_TYPE B,  MP_COUNTRY C WHERE   A.PATIENT_ID=?  AND  A.ALT_ID1_TYPE=B.ALT_ID_TYPE AND  A.NATIONALITY_CODE=C.COUNTRY_CODE(+)");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT7", "SELECT  ORDER_TYPE_CODE, SHORT_DESC FROM OR_ORDER_TYPE_LANG_VW OR_ORDER_TYPE  WHERE ORDER_CATEGORY='PH' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT8", "SELECT DISP_FLNG_REQD_YN, DISP_VERF_STAGE, DISP_CASH_COLL_STAGE, DISP_DELV_REQD_YN, IP_VERF_YN, IP_DELV_REQD_YN, IP_ALLOC_YN,DISP_STAGE,DISP_FILL_STAGE FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID=?  AND DISP_LOCN_CODE = ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT9", "SELECT FILL_YN, VERIFY_YN, ALLOCATE_YN, BILL_RECEIPT_YN, DELIVER_YN, IP_VERIFY_YN, IP_DELIVER_YN, IP_ALLOCATE_YN,ALLOW_REPRINT_YN,DISP_NARCOTIC_YN ,DISP_CONTROLLED_DRUG_YN, TRADE_CHANGE_ALLOWED_YN,MULTI_TRADE_ALLOWED_YN,VIEW_PAT_HIST_YN,UNLOCK_ALL_RECORDS_YN,IP_DFLT_DISP_STAGE,OP_DFLT_DISP_STAGE, DFLT_TOKEN_SERIES_IND, SORT_TOKEN_SERIES_IND  FROM PH_DISP_RIGHTS WHERE APPL_USER_ID   = ? AND FACILITY_ID=?  AND DISP_LOCN_CODE = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT10","SELECT CLINIC_CODE code, SHORT_DESC description FROM  OP_CLINIC WHERE FACILITY_ID LIKE ? AND UPPER(CLINIC_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND  EFF_STATUS='E'");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT11","SELECT PRACTITIONER_ID code, SHORT_NAME description FROM AM_PRACTITIONER WHERE UPPER(PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(SHORT_NAME) LIKE UPPER(?)");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT12","SELECT  B.START_SERIAL_NO SERIAL_NO,B.TOKEN_SERIES_CODE FROM PH_WS_FOR_TOKEN_SERIES A,PH_TOKEN_SERIES B WHERE A.FACILITY_ID=B.FACILITY_ID AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND B.TOKEN_SERIES_CODE=A.TOKEN_SERIES_CODE AND A.FACILITY_ID=? AND A.DISP_LOCN_CODE=? AND A.WS_NO=? AND A.TOKEN_SERIES_CODE=? AND B.EFF_STATUS='E'");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT13","SELECT COUNT(ROWID) count FROM PH_DISP_QUEUE WHERE  FACILITY_ID= ? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND TOKEN_SERIAL_NO=? AND TOKEN_SERIES_CODE =?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT14","SELECT COUNT(ROWID) count FROM PH_WS_FOR_TOKEN_SERIES WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND WS_NO=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT15","SELECT REASON_CODE,REASON_DESC,REMARKS FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON  WHERE EFF_STATUS='E' AND APPL_TRN_TYPE='H' AND LANGUAGE_ID = ?");
		
		dataMap.put("SQL_PH_DISP_MEDICATION_EDIT_LABEL","SELECT PRACTITIONER_NAME FROM AM_PRACTITIONER WHERE PRACTITIONER_ID = ? ");
	
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT18","SELECT  DISP_AUTH_REQD_DRUG_YN, DISP_NARCOTIC_YN, DISP_CONTROLLED_DRUG_YN FROM  PH_DISP_RIGHTS WHERE  APPL_USER_ID = ? AND  FACILITY_ID = ? AND  DISP_LOCN_CODE =?");
		//To display the patientID's for OP,With Token
	//ph_get_token_number (a.PERFORMING_FACILITY_ID,a.PERFORMING_DEPTLOC_CODE,?, a.patient_id )	

		//To display the Orders for one particular patient ID for all stages...(Independent)
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT20","SELECT A.TRN_GROUP_REF,A.ENCOUNTER_ID,  A.PRIORITY, A.IV_PREP_YN,A.ORDER_ID,TO_CHAR(A.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') ORD_DATE_TIME,F.PRACTITIONER_NAME,DECODE(A.ORDERING_FACILITY_ID,A.PERFORMING_FACILITY_ID,'',G.FACILITY_NAME) FACILITY_NAME,PH_ORDER_SOURCE(A.SOURCE_CODE,A.PATIENT_CLASS,A.ORDERING_FACILITY_ID,A.SOURCE_TYPE,?) LOCATION,F.PRACTITIONER_ID ,TO_CHAR(a.MODIFIED_DATE,'DDMMYYYYHH24MISS') MODIFIED_DATE_TIME FROM OR_ORDER_LINE B,OR_ORDER A,SM_FACILITY_PARAM_LANG_VW G, AM_PRACTITIONER_LANG_VW F,OR_ORDER_LINE_PH K ,OR_ORDER_STATUS_CODE H,PH_DRUG I WHERE B.ORDER_ID=A.ORDER_ID AND B.ORDER_ID=K.ORDER_ID AND A.ORDER_ID=K.ORDER_ID AND B.ORDER_LINE_NUM=K.ORDER_LINE_NUM AND G.FACILITY_ID=A.ORDERING_FACILITY_ID  AND A.ORD_PRACT_ID=F.PRACTITIONER_ID   AND A.PRIORITY=NVL(?,A.PRIORITY)  AND TRUNC(A.ORD_DATE_TIME) BETWEEN TO_DATE(NVL(?,'01/01/1472'),'DD/MM/YYYY')     	AND TO_DATE(NVL(?,'31/12/5000'),'DD/MM/YYYY')  AND A.PATIENT_ID =? AND A.ORDER_ID=NVL(?,A.ORDER_ID)    AND PH_CHECK_ORD_DATE_DISPENSING(B.START_DATE_TIME,B.END_DATE_TIME,?,?,?,?,?)=1 AND A.ORDER_CATEGORY='PH'  AND A.PERFORMING_DEPTLOC_CODE=?  AND H.ORDER_STATUS_CODE=B.ORDER_LINE_STATUS AND F.LANGUAGE_ID = G.LANGUAGE_ID AND F.LANGUAGE_ID = ? AND B.ORDER_CATALOG_CODE = I.DRUG_CODE ");//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]

		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT","SELECT ORDER_ID FROM PH_DISP_HDR WHERE DISP_NO=?");		

		dataMap.put("SQL_PH_DISP_IP_MEDICATION_SELECT2A","SELECT   MAX (a.priority) priority, a.patient_id, (select long_desc from ip_nursing_unit_lang_vw where facility_id = a.ordering_facility_id  and nursing_unit_code = g.NURSING_UNIT_CODE and language_id = ?) nursing_unit, nvl(decode(?,'en', c.patient_name, c.PATIENT_NAME_LOC_LANG), c.patient_name) patient_name, COUNT (DISTINCT a.order_id) orders, get_age (c.date_of_birth) age, c.sex, c.nationality_code country_code, (select long_desc from mp_country_lang_vw where language_id = ? and country_code = c.nationality_code) nationality_desc, c.national_id_no,to_char(min(a.ADDED_DATE),'dd/mm/yyyy hh24:mi') RELEASE_DATE_TIME, a.ordering_facility_id,  A.PATIENT_CLASS, A.EPISODE_ID, A.ENCOUNTER_ID  FROM ip_open_encounter g, or_order a, or_order_line b, or_order_line_ph h, mp_patient c, or_order_status_code f, ph_drug j  WHERE  a.ordering_facility_id = ? AND a.ordering_facility_id = g.facility_id AND a.encounter_id = g.encounter_id  AND g.facility_id = ?  AND a.patient_class = 'IP'  AND a.order_category = 'PH' AND a.order_id = b.order_id  and b.order_id = h.order_id AND b.order_line_num = h.order_line_num AND g.patient_id = c.patient_id  AND b.order_line_status = f.order_status_code AND j.drug_code = b.order_catalog_code and  ph_disp_locn_appl_yn (a.orig_performing_deptloc_code,?, a.source_type,a.source_code,a.added_facility_id, a.performing_facility_id,a.performing_deptloc_code,j.drug_class, j.drug_code, b.order_type_code,  a.patient_class, a.priority, a.discharge_ind,(case when j.drug_yn = 'Y' then 'D' else 'M' end),a.iv_prep_yn,a.ORIG_PERFORMING_DEPTLOC_CODE,a.order_id, a.HOME_LEAVE_MEDN_YN, a.PATIENT_ID, a.ENCOUNTER_ID ) = 'Y' AND ph_check_ord_date_dispensing (b.start_date_time, b.end_date_time,?,?,?,?,?) = 1 "); //AND a.ord_date_time BETWEEN g.admission_date_time- 0.99999 AND SYSDATE + 365  AND b.start_date_time BETWEEN g.admission_date_time- 0.99999 AND SYSDATE + 365//Removed join ph_worksheet_hdr for ML-BRU-Performance issue//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_DISP_IP_MEDICATION_SELECT22A","SELECT   MAX (a.priority) priority, a.patient_id, (select long_desc from ip_nursing_unit_lang_vw where facility_id = a.ordering_facility_id  and nursing_unit_code = g.NURSING_UNIT_CODE and language_id = ? ) nursing_unit, nvl(decode(?,'en', c.patient_name, c.PATIENT_NAME_LOC_LANG), c.patient_name) patient_name, COUNT (DISTINCT a.order_id) orders, get_age (c.date_of_birth) age, c.sex, c.nationality_code country_code,   (select long_desc from mp_country_lang_vw where language_id = ? and country_code = c.nationality_code) nationality_desc, c.national_id_no,to_char(min(a.ADDED_DATE),'dd/mm/yyyy hh24:mi') RELEASE_DATE_TIME, a.ordering_facility_id,  A.PATIENT_CLASS, A.EPISODE_ID, A.ENCOUNTER_ID  FROM ip_open_encounter g, or_order a, or_order_line b, or_order_line_ph h, mp_patient c, or_order_status_code f, ph_drug j  WHERE  a.ordering_facility_id = ? AND a.ordering_facility_id = g.facility_id AND a.encounter_id = g.encounter_id  AND g.facility_id = ?  AND a.patient_class = 'IP'  AND a.order_category = 'PH' AND a.order_id = b.order_id  and b.order_id = h.order_id AND b.order_line_num = h.order_line_num AND g.patient_id = c.patient_id  AND b.order_line_status = f.order_status_code AND a.order_id = ? AND j.drug_code = b.order_catalog_code and  ph_disp_locn_appl_yn (a.orig_performing_deptloc_code,?, a.source_type,a.source_code,a.added_facility_id, a.performing_facility_id,a.performing_deptloc_code,j.drug_class, j.drug_code, b.order_type_code,  a.patient_class, a.priority, a.discharge_ind,(case when j.drug_yn = 'Y' then 'D' else 'M' end),a.iv_prep_yn,a.ORIG_PERFORMING_DEPTLOC_CODE,a.order_id, a.HOME_LEAVE_MEDN_YN, a.PATIENT_ID, a.ENCOUNTER_ID ) = 'Y' AND ph_check_ord_date_dispensing (b.start_date_time, b.end_date_time,?,?,?,?,?) = 1 "); //AND a.ord_date_time BETWEEN g.admission_date_time- 0.99999 AND SYSDATE + 365  AND b.start_date_time BETWEEN g.admission_date_time- 0.99999 AND SYSDATE + 365//Added condition order_id for JD-CRF-0181 [IN:40699]//Removed join ph_worksheet_hdr for ML-BRU-Performance issue//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_DISP_IP_MEDICATION_SELECT2A_TAB_BASED","SELECT   DECODE(A.PRIORITY,'R','Routine','S','Static','U','Urgent') PRIORITY, a.patient_id, (select long_desc from ip_nursing_unit_lang_vw where facility_id = a.ordering_facility_id  and nursing_unit_code = g.NURSING_UNIT_CODE and language_id = ? ) nursing_unit, nvl(decode(?,'en', c.patient_name, c.PATIENT_NAME_LOC_LANG), c.patient_name) patient_name, COUNT (DISTINCT a.order_id) orders, get_age (c.date_of_birth) age, c.sex, c.nationality_code country_code, (select long_desc from mp_country_lang_vw where language_id = ? and country_code = c.nationality_code) nationality_desc, c.national_id_no,to_char(min(a.ADDED_DATE),'dd/mm/yyyy hh24:mi') RELEASE_DATE_TIME, to_char(a.ORD_DATE_TIME,'dd/mm/yyyy') ORD_DATE_TIME, a.ordering_facility_id,  A.PATIENT_CLASS, A.EPISODE_ID, A.ENCOUNTER_ID  FROM ip_open_encounter g, or_order a, or_order_line b, or_order_line_ph h, mp_patient c, or_order_status_code f, ph_drug j  WHERE  a.ordering_facility_id = ? AND a.ordering_facility_id = g.facility_id AND a.encounter_id = g.encounter_id  AND g.facility_id = ?  AND a.patient_class = 'IP'  AND a.order_category = 'PH' AND a.order_id = b.order_id  and b.order_id = h.order_id AND b.order_line_num = h.order_line_num AND g.patient_id = c.patient_id    AND b.order_line_status = f.order_status_code AND j.drug_code = b.order_catalog_code and  ph_disp_locn_appl_yn (a.orig_performing_deptloc_code,?, a.source_type,a.source_code,a.added_facility_id, a.performing_facility_id,a.performing_deptloc_code,j.drug_class, j.drug_code, b.order_type_code,  a.patient_class, a.priority, a.discharge_ind,(case when j.drug_yn = 'Y' then 'D' else 'M' end),a.iv_prep_yn,a.ORIG_PERFORMING_DEPTLOC_CODE,a.order_id , a.HOME_LEAVE_MEDN_YN, a.PATIENT_ID, a.ENCOUNTER_ID) = 'Y' AND ph_check_ord_date_dispensing (b.start_date_time, b.end_date_time,?,?,?,?,?) = 1 ");//Removed join ph_worksheet_hdr for ML-BRU-Performance issue//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_DISP_IP_MEDICATION_SELECT22A_TAB_BASED","SELECT   DECODE(A.PRIORITY,'R','Routine','S','Static','U','Urgent') PRIORITY, a.patient_id, (select long_desc from ip_nursing_unit_lang_vw where facility_id = a.ordering_facility_id  and nursing_unit_code = g.NURSING_UNIT_CODE and language_id = ? ) nursing_unit, nvl(decode(?,'en', c.patient_name, c.PATIENT_NAME_LOC_LANG), c.patient_name) patient_name, COUNT (DISTINCT a.order_id) orders, get_age (c.date_of_birth) age, c.sex, c.nationality_code country_code,   (select long_desc from mp_country_lang_vw where language_id = ? and country_code = c.nationality_code) nationality_desc, c.national_id_no,to_char(min(a.ADDED_DATE),'dd/mm/yyyy hh24:mi') RELEASE_DATE_TIME, to_char(a.ORD_DATE_TIME,'dd/mm/yyyy') ORD_DATE_TIME, a.ordering_facility_id,  A.PATIENT_CLASS, A.EPISODE_ID, A.ENCOUNTER_ID  FROM ip_open_encounter g, or_order a, or_order_line b, or_order_line_ph h, mp_patient c, or_order_status_code f, ph_drug j  WHERE  a.ordering_facility_id = ? AND a.ordering_facility_id = g.facility_id AND a.encounter_id = g.encounter_id  AND g.facility_id = ?  AND a.patient_class = 'IP'  AND a.order_category = 'PH'  AND b.order_category = 'PH' AND a.order_id = b.order_id  and b.order_id = h.order_id AND b.order_line_num = h.order_line_num AND g.patient_id = c.patient_id    AND b.order_line_status = f.order_status_code AND a.order_id = ? AND j.drug_code = b.order_catalog_code and  ph_disp_locn_appl_yn (a.orig_performing_deptloc_code,?, a.source_type,a.source_code,a.added_facility_id, a.performing_facility_id,a.performing_deptloc_code,j.drug_class, j.drug_code, b.order_type_code,  a.patient_class, a.priority, a.discharge_ind,(case when j.drug_yn = 'Y' then 'D' else 'M' end),a.iv_prep_yn,a.ORIG_PERFORMING_DEPTLOC_CODE,a.order_id , a.HOME_LEAVE_MEDN_YN, a.PATIENT_ID, a.ENCOUNTER_ID) = 'Y' AND ph_check_ord_date_dispensing (b.start_date_time, b.end_date_time,?,?,?,?,?) = 1 ");//Added condition order_id for JD-CRF-0181 [IN:40699]//Removed join ph_worksheet_hdr for ML-BRU-Performance issue//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]

		dataMap.put("SQL_PH_DISP_IP_BED__SELECT1" , "SELECT BED_NO,decode(ph_number_yn(bed_no),'Y',to_number(bed_no),1000+ascii(bed_no)) FROM IP_NURSING_UNIT_BED WHERE NURSING_UNIT_CODE=? AND FACILITY_ID=? AND EFF_STATUS='E' ORDER BY 2,1");
		dataMap.put("SQL_PH_DISP_IP_FILL_REMARKS_SELECT6A" , "SELECT REASON_CODE, REASON_DESC, REMARKS FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE= ?	AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_IP_FILL_REMARKS_SELECT6B" , "SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE='D' AND EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DISP_IP_FILL_REMARKS_SELECT6C" , "SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE='A' AND EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DISP_IP_FILL_REMARKS_SELECT6D" , "SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE='O' AND EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DISP_IP_FILL_REMARKS_SELECT6E" , "SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE='C' AND EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_DISP_IP_FILL_REMARKS_SELECT6F" , "SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE='N' AND EFF_STATUS='E' ORDER BY 2");

		dataMap.put("SQL_PH_DISP_IP_MEDICATION_SELECT7A","SELECT A.PRIORITY, A.IV_PREP_YN, E.SHORT_DESC LOCATION,  A.ORDER_ID,  TO_CHAR(A.ORD_DATE_TIME,  'DD/MM/YYYY HH24:MI') ORD_DATE_TIME   ,  F.PRACTITIONER_NAME,  DECODE(A.ORDERING_FACILITY_ID,  A.PERFORMING_FACILITY_ID,  '',  G.FACILITY_NAME) FACILITY_NAME,  F.PRACTITIONER_ID,  F.PRACTITIONER_NAME,  A.ENCOUNTER_ID FROM   OR_ORDER_LINE B,  OR_ORDER A,  IP_NURSING_UNIT E  ,  OR_ORDER_STATUS_CODE C,  SM_FACILITY_PARAM G,  AM_PRACTITIONER F,  PH_FILL_PROCESS_PARAM H,  OR_ORDER_LINE_FIELD_VALUES I WHERE   B.ORDER_ID=A.ORDER_ID AND   G.FACILITY_ID=A.ORDERING_FACILITY_ID AND   A.ORD_PRACT_ID=F.PRACTITIONER_ID(+)     AND   E.NURSING_UNIT_CODE=A.SOURCE_CODE AND  E.FACILITY_ID=A.ORDERING_FACILITY_ID AND  C.ORDER_STATUS_CODE=B.ORDER_LINE_STATUS    AND   E.NURSING_UNIT_CODE=NVL(?,E.NURSING_UNIT_CODE)    AND   A.PATIENT_ID =NVL(?,A.PATIENT_ID)  AND   PH_CHECK_ORD_DATE_DISPENSING(B.START_DATE_TIME,B.END_DATE_TIME,?,?,?,?,?)=1  AND   C.ORDER_STATUS_TYPE IN ('10','25','30','36','35') AND   A.PATIENT_CLASS='IP' AND   A.ORDER_CATEGORY='PH'   AND   A.PERFORMING_DEPTLOC_CODE=? AND   H.PROC_TYPE=NVL(?,PROC_TYPE) AND   (B.ORD_DATE_TIME BETWEEN H.FILL_INT_START_DATE_TIME AND   FILL_INT_END_DATE_TIME) AND   (B.END_DATE_TIME) >= TRUNC(SYSDATE) AND   I.ORDER_ID = B.ORDER_ID AND   I.ORDER_LINE_NUM = B.ORDER_LINE_NUM AND   I.ORDER_LINE_FIELD_MNEMONIC = 'SCHED_ADMIN_TIME'   AND    TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY'),'DD/MM/YYYY')||' '||I.ORDER_LINE_FIELD_VALUE <= TO_DATE(?,'DD/MM/YYYY HH24:MI') ");//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]

		dataMap.put("SQL_PH_DISP_IP_MEDICATION_SELECT13","SELECT TO_CHAR (last_dispensed_date,'dd/mm/yyyy hh24:mi') last_dispensed_date, TO_CHAR (last_dispensed_date, 'dd/mm/yyyy') last_disp_date,(select  APPL_USER_NAME from sm_appl_user_lang_vw where APPL_USER_ID=dispensed_by and language_id =?) modified_by_id  FROM or_order_line_ph a,ph_disp_hdr b  WHERE a.order_id = ?  and a.order_id =b.order_id   AND order_line_num = ?    AND last_dispensed_date IS NOT NULL   ORDER BY b.DISPENSED_DATE_TIME DESC");
		dataMap.put("SQL_PH_DISP_IP_MEDICATION_SELECT14","SELECT NURSING_UNIT_CODE FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE LONG_DESC =? AND LANGUAGE_ID = ?");
		dataMap.put("JNDI_PH_DISP_MEDICATION", "java:comp/env/DispMedication");
		dataMap.put("JNDI_PH_DISP_MEDICATION_WORK_SHEET", "java:comp/env/DispMedicationWorkSheet");
		dataMap.put("JNDI_PH_DISP_MEDICATION_TPN_WORK_SHEET","java:comp/env/DispMedicationTPNWorkSheet");
		dataMap.put("JNDI_PH_TRACKING_OUTSOURCE_MEDN", "java:comp/env/TrackingOutsourceMedn");
		/* End of IP dispensing */
		dataMap.put("SQL_PH_DISP_MEDICATION_DRUG_TYPE","SELECT DRUG_TYPE FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT23","SELECT COUNT(*) COUNT FROM OR_ORDER_COMMENT WHERE Ph_Readlob(?) IS NOT NULL AND order_id =?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT24","SELECT Ph_Readlob(?) ORDER_COMMENT FROM DUAL");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT25","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY') TODAY,TO_CHAR(SYSDATE,'DD/MM/YYYY hh24:mi') TODAY_DATE_TIME,TO_CHAR(SYSDATE+365,'DD/MM/YYYY') DATE_PLUS_365 FROM DUAL");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT27","SELECT UPPER(APP_PASSWORD.DECRYPT(DISP_PASSWORD)) PASSWORD FROM PH_DISP_USERS WHERE  APPL_USER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT28","SELECT A.ON_HOLD_BY_ID, TO_CHAR(A.ON_HOLD_DATE_TIME,'DD/MM/YYYY HH24:MI') ON_HOLD_DATE_TIME, A.ON_HOLD_REASON_CODE, B.LAST_ACTION_REASON_DESC FROM	PH_PATIENT_DRUG_PROFILE A,	OR_ORDER_LINE B WHERE ON_HOLD_BY_ID IS NOT NULL  AND B.ORDER_ID = A.ORIG_ORDER_ID AND A.ORIG_ORDER_ID=?  AND A.ORIG_ORDER_LINE_NO= ? AND B.ORDER_LINE_STATUS='HD'");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT29","SELECT   C.TOKEN_SERIES_CODE,B.DESCRIPTION,C.TOKEN_SERIAL_NO,COLLECTOR_NAME,  COLLECTOR_NATIONALITY,  COLLECTOR_GENDER FROM   PH_TOKEN_SERIES_LANG_VW B,PH_DISP_QUEUE C WHERE C.FACILITY_ID=? AND  C.DISP_LOCN_CODE=?  AND  TRUNC(C.QUEUE_DATE) = TO_DATE(?,'DD/MM/YYYY') AND  C.QUEUE_SHIFT = '*ALL' AND C.TOKEN_SERIES_CODE = ?  AND    C.PATIENT_ID =? AND B.TOKEN_SERIES_CODE=C.TOKEN_SERIES_CODE AND B.LANGUAGE_ID = ? and token_status not in ('DP','DF')");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT30","SELECT  COUNTRY_CODE,LONG_DESC SHORT_DESC  FROM MP_COUNTRY_LANG_VW MP_COUNTRY WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT31","SELECT APPL_USER_NAME,APP_PASSWORD.DECRYPT(PIN_NO) PIN_NO  FROM SM_APPL_USER_LANG_VW SM_APPL_USER WHERE APPL_user_id =? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT32","SELECT NURSING_UNIT_CODE CODE, SHORT_DESC DESCRIPTION FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE EFF_STATUS='E' AND FACILITY_ID LIKE UPPER(?) AND upper(NURSING_UNIT_CODE) LIKE upper(?) AND upper(SHORT_DESC) LIKE upper(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT33","SELECT PH_TMP_DISP_NO.NEXTVAL FROM DUAL");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT34","SELECT IP_DELV_REQD_YN,DISP_DELV_REQD_YN FROM PH_DISP_LOCN WHERE DISP_LOCN_CODE = ? AND FACILITY_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT35","SELECT InitCap(REGN_STAGE_PROMPT) REGN_STAGE_PROMPT, InitCap(VERIFY_STAGE_PROMPT) VERIFY_STAGE_PROMPT, InitCap(FILL_STAGE_PROMPT) FILL_STAGE_PROMPT, InitCap(ALLOCATE_STAGE_PROMPT) ALLOCATE_STAGE_PROMPT, InitCap(BILL_RECEIPT_STAGE_PROMPT) BILL_RECEIPT_STAGE_PROMPT, InitCap(DELIVER_STAGE_PROMPT) DELIVER_STAGE_PROMPT FROM PH_PARAM_LANG_VW PH_PARAM WHERE MODULE_ID='PH' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT37","SELECT A.INVENTORY_ITEM_CODE ITEM_CODE,B.LONG_DESC ITEM_DESC FROM PH_INVENTORY_ITEM_FOR_DRUG A,MM_ITEM_LANG_VW B WHERE A.DRUG_CODE =? AND B.ITEM_CODE = A.INVENTORY_ITEM_CODE AND B.EFF_STATUS='E' AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT37A","SELECT B.ITEM_CODE,SHORT_DESC ITEM_DESC FROM PH_TPN_REGIMEN A, MM_ITEM_LANG_VW B WHERE A.ITEM_CODE=B.ITEM_CODE AND A.TPN_REGIMEN_CODE=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT38","SELECT RF_ID CODE, RF_NAME DESCRIPTION FROM PH_RECONST_FLUID WHERE RF_ID LIKE ? AND RF_NAME LIKE ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT39","SELECT LONG_DESC STORE_DESC FROM MM_STORE_LANG_VW MM_STORE WHERE STORE_CODE = ? AND FACILITY_ID=? AND EFF_STATUS='E' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT40","SELECT COUNT(ROWID) COUNT FROM SM_MODULE WHERE MODULE_ID='ST' AND INSTALL_YN='Y' ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT41","SELECT (SELECT COUNT(*) FROM PH_INVENTORY_ITEM_FOR_DRUG C WHERE C.DRUG_CODE=?) COUNT1, A.SHORT_DESC,A.ITEM_CODE FROM MM_ITEM_LANG_VW A, PH_INVENTORY_ITEM_FOR_DRUG B WHERE DRUG_CODE=? AND  A.ITEM_CODE=B.INVENTORY_ITEM_CODE AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT42","SELECT PHYSICAL_FORM FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT43","SELECT STABILITY_INFO,RF_QTY,RF_QTY_UOM FROM PH_RECNST_FLD_FR_DRUG_LANG_VW PH_RECONST_FLUID_FOR_DRUG WHERE DRUG_CODE=? AND RF_ID=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT44","SELECT C.SHORT_DESC ITEM_DESC,   A.SHORT_NAME TRADE_NAME,   (SELECT SHORT_NAME FROM    AM_MANUFACTURER_LANG_VW AM_MANUFACTURER WHERE    MANUFACTURER_ID=A.MANUFACTURER_ID AND LANGUAGE_ID = ?) MANUFACTURER_NAME    FROM AM_TRADE_NAME_LANG_VW A,ST_ITEM_BATCH B,MM_ITEM_LANG_VW C WHERE B.TRADE_ID=A.TRADE_ID(+) AND   C.ITEM_CODE=B.ITEM_CODE    AND    B.ITEM_CODE=? AND    B.BATCH_ID=? AND A.LANGUAGE_ID(+) = ? AND C.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT45","SELECT A.DRUG_CODE,A.ITEM_CODE,A.BATCH_ID,TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE, DISP_QTY,DISP_QTY_UOM,ORDER_ID,ORDER_LINE_NUM ,B.BIN_LOCATION_CODE,B.TRADE_ID, c.GEN_UOM_CODE FROM PH_DISP_DRUG_BATCH_TMP A, ST_ITEM_BATCH  B, mm_item c WHERE  A.STORE_CODE=B.STORE_CODE  AND A.ITEM_CODE=B.ITEM_CODE AND b.item_code = c.item_code AND A.BATCH_ID=B.BATCH_ID  AND A.EXPIRY_DATE = B.EXPIRY_DATE_OR_RECEIPT_DATE AND  A.BIN_LOCATION_CODE=B.BIN_LOCATION_CODE AND ORDER_ID=? AND ORDER_LINE_NUM=?  ORDER BY ORDER_ID,ORDER_LINE_NUM");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT46","SELECT A.DISP_QTY,A.DISP_DRUG_CODE,A.PRES_DRUG_CODE,B.DRUG_DESC,A.DISP_UOM_CODE FORM_CODE,B.STRENGTH_VALUE,B.STRENGTH_UOM ,a.DISP_UOM_CODE FROM PH_DISP_DTL_TMP A,PH_DRUG_LANG_VW B WHERE /*A.PRES_DRUG_CODE<>A.DISP_DRUG_CODE AND*/ A.ORDER_ID=? AND A.ORDER_LINE_NO=? AND A.DISP_DRUG_CODE=B.DRUG_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT47","SELECT COUNT(*) COUNT FROM PH_DISP_HDR_TMP WHERE ORDER_ID=? and disp_locn_code = ? and facility_id = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT48","SELECT DISP_DELV_REQD_YN DELIVERY,DISP_FLNG_REQD_YN FILLING FROM PH_DISP_LOCN A WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT49", "SELECT PRINT_DISP_SHEET_OP_YN, LABEL_FORMAT_OP, PRINT_BAL_MED_SHEET_OP_YN,IP_LABEL_FORMAT  FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT50", "SELECT disp_no FROM ph_disp_hdr WHERE  disp_no IN (SELECT disp_no FROM ph_disp_dtl WHERE print_seq_no=?) UNION ALL SELECT disp_no FROM ph_disp_cons_dtl WHERE disp_trn_seq_no IN (SELECT disp_trn_seq_no FROM ph_disp_hdr WHERE disp_no IN (SELECT disp_no FROM ph_disp_dtl WHERE print_seq_no=?)) ORDER BY disp_no");// Query altered for [IN:047652]
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT50A","SELECT TO_CHAR(disp_tmp_no) disp_no FROM ph_disp_hdr_tmp WHERE  disp_tmp_no IN (SELECT disp_tmp_no FROM ph_disp_dtl_tmp WHERE print_seq_no=?) UNION ALL SELECT disp_no FROM ph_disp_cons_dtl WHERE disp_trn_seq_no IN (SELECT disp_trn_seq_no FROM ph_disp_hdr_tmp WHERE disp_tmp_no IN (SELECT disp_tmp_no FROM ph_disp_dtl_tmp WHERE print_seq_no=?)) ORDER BY disp_no");// ORDER BY DISP_TMP_NO added  for ML-BRU-SCF-0992 [IN:042805] //// Query altered for [IN:047652] 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT51","SELECT 1 FROM ph_disp_locn WHERE ISSUE_TOKEN_ON_REGN_YN='Y' AND DISP_LOCN_CODE=? AND FACILITY_ID= ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT52","SELECT A.ORDER_ID,A.ORDER_LINE_NUM,B.DRUG_CODE,B.DRUG_DESC,B.IV_INGREDIENT_YN, B.IV_FLUID_YN,A.ORDER_QTY, A.ORDER_UOM, B.PHYSICAL_FORM ,ph_get_ext_prod_drug_code(b.drug_code,?)EXTERNAL_PRODUCT_ID FROM OR_ORDER_LINE A, PH_DRUG_LANG_VW B WHERE A.ORDER_ID = ? AND A.ORDER_CATALOG_CODE = B.DRUG_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT53","SELECT A.ITEM_CODE,B.SHORT_DESC FROM PH_INV_ITEM_FOR_RECONST_FLUID A,MM_ITEM_LANG_VW B  WHERE RF_ID=? AND A.ITEM_CODE=B.ITEM_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT54","SELECT A.SHORT_DESC, A.DISP_LOCN_CODE, A.ISSUE_TOKEN_ON_REGN_YN,A.DISP_REGN_REQD_YN,  (CASE WHEN A.DISP_FILL_STAGE='B' OR A.DISP_FILL_STAGE='A' THEN A.DISP_VERF_STAGE ELSE 'X' END) DISP_VERF_STAGE, B.CURR_ENC_FINANCIAL_DTL_YN FROM PH_DISP_LOCN_LANG_VW A, PH_DISP_RIGHTS B WHERE A.FACILITY_ID = ? AND B.FACILITY_ID=A.FACILITY_ID AND B.APPL_USER_ID = ? AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.LANGUAGE_ID = ?");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT54A","SELECT A.SHORT_DESC, A.DISP_LOCN_CODE, A.ISSUE_TOKEN_ON_REGN_YN,A.DISP_REGN_REQD_YN,   DISP_VERF_STAGE  FROM PH_DISP_LOCN_LANG_VW A,PH_DISP_RIGHTS B  WHERE A.FACILITY_ID = ?  AND B.FACILITY_ID=A.FACILITY_ID  AND B.APPL_USER_ID = ?  AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE  AND B.VERIFY_YN = 'Y' AND A.DISP_VERF_STAGE !='C' AND A.LANGUAGE_ID = ?");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT54B","SELECT A.SHORT_DESC, A.DISP_LOCN_CODE, A.ISSUE_TOKEN_ON_REGN_YN,A.DISP_REGN_REQD_YN,  (CASE WHEN A.DISP_FILL_STAGE='B' OR A.DISP_FILL_STAGE='A' THEN A.DISP_VERF_STAGE ELSE 'X' END) DISP_VERF_STAGE, B.CURR_ENC_FINANCIAL_DTL_YN FROM PH_DISP_LOCN_LANG_VW A, PH_DISP_RIGHTS B WHERE A.FACILITY_ID = ? AND B.FACILITY_ID=A.FACILITY_ID AND B.APPL_USER_ID = ? AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.LANGUAGE_ID = ? and (VERIFY_YN='Y' or IP_VERIFY_YN='Y')");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT54C","SELECT A.SHORT_DESC, A.DISP_LOCN_CODE, A.ISSUE_TOKEN_ON_REGN_YN,A.DISP_REGN_REQD_YN,  (CASE WHEN A.DISP_FILL_STAGE='B' OR A.DISP_FILL_STAGE='A' THEN A.DISP_VERF_STAGE ELSE 'X' END) DISP_VERF_STAGE, B.CURR_ENC_FINANCIAL_DTL_YN FROM PH_DISP_LOCN_LANG_VW A, PH_DISP_RIGHTS B WHERE A.FACILITY_ID = ? AND B.FACILITY_ID=A.FACILITY_ID AND B.APPL_USER_ID = ? AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.LANGUAGE_ID = ? and  VERIFY_YN='Y' ");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT54D","SELECT A.SHORT_DESC, A.DISP_LOCN_CODE, A.ISSUE_TOKEN_ON_REGN_YN,A.DISP_REGN_REQD_YN,  (CASE WHEN A.DISP_FILL_STAGE='B' OR A.DISP_FILL_STAGE='A' THEN A.DISP_VERF_STAGE ELSE 'X' END) DISP_VERF_STAGE, B.CURR_ENC_FINANCIAL_DTL_YN FROM PH_DISP_LOCN_LANG_VW A, PH_DISP_RIGHTS B WHERE A.FACILITY_ID = ? AND B.FACILITY_ID=A.FACILITY_ID AND B.APPL_USER_ID = ? AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.LANGUAGE_ID = ? and  IP_VERIFY_YN='Y' ");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT55","SELECT INVENTORY_ITEM_CODE FROM PH_INVENTORY_ITEM_FOR_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT56","SELECT ST_DOC_TYPE_CODE FROM PH_TRN_DOC_TYPE A, ST_TRN_DOC_TYPE B WHERE A.PH_TRN_TYPE_CODE=? AND B.FACILITY_ID=? AND A.FACILITY_ID IN('*A', ?) AND A.ST_DOC_TYPE_CODE=B.DOC_TYPE_CODE AND ROWNUM <=1 ORDER BY A.FACILITY_ID DESC");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT57","SELECT ORDER_LINE_STATUS FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT57A","SELECT ORDER_LINE_STATUS FROM OR_ORDER_LINE A,PH_PATIENT_DRUG_PROFILE B WHERE A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND B.ORIG_ORDER_ID=A.ORDER_ID AND B.ORIG_ORDER_LINE_NO=A.ORDER_LINE_NUM AND (TOT_ISSUED_QTY IS NULL OR TOT_ISSUED_QTY='0')");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT58","SELECT DOC_NO,DOC_TYPE FROM  PH_DISP_HDR_TMP WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT59","SELECT DOC_NO,DOC_TYPE FROM  PH_DISP_HDR WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT60","SELECT ITEM_UNIT_COST, ITEM_COST_VALUE FROM ST_SAL_DTL WHERE FACILITY_ID=? AND DOC_TYPE_CODE=? AND DOC_NO =? AND DOC_SRL_NO= ?"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT61","SELECT  PHYSICAL_FORM, B.ORDER_QTY,B.ORDER_UOM, A.ORDER_ID, A.ORDER_LINE_NUM,  A.DISP_DRUG_CODE, A.SPIL_QTY_AVAIL SPILL_QTY ,  A.QTY_USED_FROM_STOCK DRUG_QTY_DRAWN, A.USED_QTY PREPARED_QTY FROM OR_ORDER_LINE B,   PH_WORKSHEET_DTL A WHERE A.ORDER_ID=B.ORDER_ID AND A.ORDER_LINE_NUM=B.ORDER_LINE_NUM AND A.ORDER_ID=? AND A.WORKSHEET_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT62","SELECT DECODE (INSTR (ORDER_LINE_DOSE_QTY_VALUE, '.'),0, TO_CHAR (ORDER_LINE_DOSE_QTY_VALUE),RTRIM (TO_CHAR (ORDER_LINE_DOSE_QTY_VALUE, '9999999990.00000000'),'0')) ORDER_LINE_DOSE_QTY_VALUE FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND ORDER_LINE_SEQ_NUM>200");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT63","SELECT COUNT(*) FROM ST_ITEM WHERE ITEM_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT64","SELECT DISP_LEVEL,IP_FILL_PRD_AHEAD, IP_FILL_PRD_UNIT FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE DISP_LOCN_CODE =? AND FACILITY_ID= ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT65","SELECT COUNT(*) COUNT FROM PH_DISP_DTL_TMP A,PH_DRUG B WHERE A.PRES_DRUG_CODE<>A.DISP_DRUG_CODE AND A.ORDER_ID=? AND A.ORDER_LINE_NO=? AND A.DISP_DRUG_CODE=B.DRUG_CODE");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT66"," SELECT TO_CHAR(A.FILL_INT_START_DATE_TIME+?,'DD/MM/YYYY HH24:MI')  NEXT_DATE FROM PH_FILL_PROCESS_PARAM A,OR_ORDER_LINE_PH B WHERE B.FILL_PROC_ID=A.FILL_PROC_ID AND B.ORDER_ID=? AND B.ORDER_LINE_NUM=?");
		// Query changed to avoid the delete sales failed in second stage while giving alternatge drug
		//dataMap.put("SQL_PH_DISP_MEDICATION_SELECT67XX","SELECT DOC_SRL_NO FROM PH_DISP_DTL_TMP WHERE ORDER_ID=? AND DISP_DRUG_CODE=? AND ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT67","SELECT DOC_SRL_NO FROM PH_DISP_DTL_TMP WHERE ORDER_ID=? AND ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT68","SELECT DOC_SRL_NO FROM PH_DISP_DRUG_BATCH_TMP WHERE ORDER_ID=? AND DRUG_CODE=? AND ITEM_CODE=? AND BATCH_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT69","SELECT PATIENT_CLASS,PATIENT_ID FROM PH_DISP_HDR WHERE DISP_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT70","SELECT HEIGHT,HEIGHT_UOM,WEIGHT,WEIGHT_UOM FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=? AND SRL_NO=(SELECT MAX(SRL_NO) FROM PH_PATIENT_DRUG_PROFILE WHERE PATIENT_ID=?)");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT71","SELECT DISP_UNALLOC_DRUGS_AT_DEL_STG FROM PH_FACILITY_PARAM WHERE FACILITY_ID = ? " );
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT72","SELECT A.QTY_VALUE,A.QTY_UNIT,B.FREQ_DESC,A.DURN_VALUE,C.DURN_DESC FROM OR_ORDER_LINE A, AM_FREQUENCY_LANG_VW B,AM_DURATION_TYPE_LANG_VW C WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT73","SELECT A.TOKEN_SERIES_CODE, A.DEFAULT_TOKEN_YN, B.DESCRIPTION FROM PH_WS_FOR_TOKEN_SERIES A, PH_TOKEN_SERIES_LANG_VW B WHERE A.FACILITY_ID=? AND A.DISP_LOCN_CODE=? AND A.WS_NO=? AND A.FACILITY_ID=B.FACILITY_ID AND b.TOKEN_GEN_STAGE in('OR','RG')  and A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.TOKEN_SERIES_CODE=B.TOKEN_SERIES_CODE AND B.LANGUAGE_ID = ? and B.EFF_STATUS='E' ");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT73A","SELECT A.TOKEN_SERIES_CODE, B.DESCRIPTION,c.DISP_CASH_COLL_STAGE,c.DISP_CASH_COLL_STAGE_OP FROM PH_WS_FOR_TOKEN_SERIES A, PH_TOKEN_SERIES_LANG_VW B,ph_disp_locn c WHERE A.FACILITY_ID=? AND A.DISP_LOCN_CODE=? AND A.WS_NO=? AND A.FACILITY_ID=B.FACILITY_ID AND b.facility_id  =c.facility_id AND a.disp_locn_code=c.disp_locn_code AND c.GEN_TOKEN_UPON_REISSUE_YN ='Y' AND b.TOKEN_GEN_STAGE ='RI' and A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.TOKEN_SERIES_CODE=B.TOKEN_SERIES_CODE AND B.LANGUAGE_ID = ?"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT73B","SELECT A.TOKEN_SERIES_CODE, B.DESCRIPTION,c.DISP_CASH_COLL_STAGE, c.DISP_CASH_COLL_STAGE_OP FROM PH_WS_FOR_TOKEN_SERIES A, PH_TOKEN_SERIES_LANG_VW B,ph_disp_locn c WHERE A.FACILITY_ID=? AND A.DISP_LOCN_CODE=? AND A.WS_NO=? AND A.FACILITY_ID=B.FACILITY_ID AND b.facility_id  =c.facility_id AND a.disp_locn_code=c.disp_locn_code AND c.GEN_TOKEN_UPON_RET_MEDN_YN ='Y' AND b.TOKEN_GEN_STAGE ='RM' and A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.TOKEN_SERIES_CODE=B.TOKEN_SERIES_CODE AND B.LANGUAGE_ID = ?"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT73C","SELECT A.TOKEN_SERIES_CODE, B.DESCRIPTION,c.DISP_CASH_COLL_STAGE FROM PH_WS_FOR_TOKEN_SERIES A, PH_TOKEN_SERIES_LANG_VW B,ph_disp_locn c WHERE A.FACILITY_ID=? AND A.DISP_LOCN_CODE=? AND A.WS_NO=? AND A.FACILITY_ID=B.FACILITY_ID AND b.facility_id  =c.facility_id AND a.disp_locn_code=c.disp_locn_code AND c.GEN_TOKEN_UPON_DIR_DISP_YN ='Y' AND b.TOKEN_GEN_STAGE ='DD' and A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.TOKEN_SERIES_CODE=B.TOKEN_SERIES_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT74","SELECT MAX(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO,TOKEN_SERIES_CODE FROM PH_ORD_FOR_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND PATIENT_ID=? AND ORDER_ID=? AND QUEUE_SHIFT='*ALL'");//Added TOKEN_SERIES_CODE for HSA-CRF-0136 [IN:048412]
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT75","SELECT DOC_SRL_NO FROM PH_DISP_DTL_TMP WHERE ORDER_ID=? AND ORDER_LINE_NO=?");
		// FOR DEFAULTING TOKEN NO //
		// VERFICATION
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT75","SELECT MIN(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL AND VERIFY_DATE_TIME IS NULL ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT75A","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL'  AND TOKEN_SERIAL_NO=?");

		// ALLOCATION BEFORE FILLING / FILLING BEFORE ALLOCATION
			// allocation is combined with verification
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT76","SELECT MIN(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT76A","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL AND (ALLOCATE_DATE_TIME IS NULL OR FILL_DATE_TIME IS NULL) AND TOKEN_SERIAL_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT76B","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL AND (ALLOCATE_DATE_TIME IS NULL ) AND TOKEN_SERIAL_NO=?");
		// verification is seperate before allocation
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT80","SELECT MIN(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL AND VERIFY_DATE_TIME IS NOT NULL AND (ALLOCATE_DATE_TIME IS NULL OR FILL_DATE_TIME IS NULL OR TOKEN_STATUS='VF')");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT80A","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL AND VERIFY_DATE_TIME IS NOT NULL AND (ALLOCATE_DATE_TIME IS NULL OR FILL_DATE_TIME IS NULL OR TOKEN_STATUS='VF') AND TOKEN_SERIAL_NO=?");
		// All Stages
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT86","SELECT MIN(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL AND TOKEN_STATUS IN ('IP','AL','RG','VF')");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT86A","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND REGN_DATE_TIME IS NOT NULL AND (ALLOCATE_DATE_TIME IS NULL OR FILL_DATE_TIME IS NULL OR TOKEN_STATUS IN ('IP','AL','RG','VF')) AND TOKEN_SERIAL_NO=?  ");
		// ALLOCATION AFTER FILLING  
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT77","SELECT MIN(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND FILL_DATE_TIME IS NOT NULL AND (ALLOCATE_DATE_TIME IS NULL OR TOKEN_STATUS='IP')"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT77A","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND FILL_DATE_TIME IS NOT NULL AND( ALLOCATE_DATE_TIME IS NULL OR TOKEN_STATUS='IP') AND TOKEN_SERIAL_NO=?");
		//DELIVERY (FILLING AFTER ALLOCATION)  
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT78","SELECT MAX(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND FILL_DATE_TIME IS NOT NULL AND (DELIVER_DATE_TIME IS NULL OR TOKEN_STATUS='IP')"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT78A","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND FILL_DATE_TIME IS NOT NULL AND (DELIVER_DATE_TIME IS NULL OR TOKEN_STATUS='IP') AND TOKEN_SERIAL_NO=?"); 
		// DELIVERY ALLOCATION AFTER FILLING 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT79","SELECT MAX(TOKEN_SERIAL_NO) TOKEN_SERIAL_NO FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND ALLOCATE_DATE_TIME IS NOT NULL AND (DELIVER_DATE_TIME IS NULL OR TOKEN_STATUS='AL')");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT79A","SELECT COUNT(*) COUNT FROM PH_DISP_QUEUE WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND ALLOCATE_DATE_TIME IS NOT NULL AND (DELIVER_DATE_TIME IS NULL OR TOKEN_STATUS='AL') AND TOKEN_SERIAL_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT81","SELECT APP_PASSWORD.DECRYPT(PIN_NO) PIN_NO FROM SM_APPL_USER WHERE APPL_USER_ID=?");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT91","SELECT COUNT(*) RESU FROM PH_PIN_AUTHORIZATION WHERE (?) IN APP_PASSWORD.DECRYPT(PIN_NO)");		
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT92","SELECT FRACT_DOSE_ROUND_UP_YN FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT82","SELECT distinct TO_CHAR(FILL_INT_START_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT, FILL_INT_START_DATE_TIME   FROM PH_FILL_PROCESS_PARAM   WHERE SYSDATE <= FILL_INT_END_DATE_TIME   AND PROC_TYPE='R' and disp_locn_code =? order by FILL_INT_START_DATE_TIME desc");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT83","SELECT COUNT(*) COUNT FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND TO_DATE(TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI'),'HH24:MI')<=TO_DATE(TO_CHAR(SYSDATE,'HH24:MI'),'HH24:MI')");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT84","SELECT distinct TO_CHAR(FILL_INT_END_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_END_DATE_TIME FROM PH_LAST_FILL_INT_DTL WHERE FILL_INT_END_DATE_TIME  BETWEEN TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY')||' 00:01','DD/MM/YYYY HH24:MI') AND SYSDATE  ");
		//dataMap.put("SQL_PH_DISP_MEDICATION_SELECT85","SELECT distinct TO_CHAR(FILL_INT_END_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_END_DATE_TIME FROM PH_LAST_FILL_INT_DTL WHERE FILL_INT_END_DATE_TIME > TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY')||(SELECT TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI')  FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?),'DD/MM/YYYY HH24:MI')  AND  FILL_INT_END_DATE_TIME <= SYSDATE ");
		//dataMap.put("SQL_PH_DISP_MEDICATION_SELECT85","SELECT distinct TO_CHAR(FILL_INT_START_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_START_DATE_TIME   FROM PH_FILL_PROCESS_PARAM   WHERE SYSDATE <= FILL_INT_END_DATE_TIME   AND PROC_TYPE='I' and disp_locn_code=? order by FILL_INT_START_DATE_TIME desc");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT85","SELECT distinct TO_CHAR(FILL_INT_START_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT, FILL_INT_START_DATE_TIME   FROM PH_FILL_PROCESS_PARAM   WHERE SYSDATE <= FILL_INT_END_DATE_TIME   AND PROC_TYPE='I' and disp_locn_code=? order by FILL_INT_START_DATE_TIME desc");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT87","SELECT CONTENT_IN_PRES_BASE_UOM,STOCK_UOM,STRENGTH_PER_VALUE_PRES_UOM ,ph_get_ext_prod_drug_code(drug_code,?)EXTERNAL_PRODUCT_ID  FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT88","SELECT PH_CALCULATEBALANCE(?,?) BALANCE FROM DUAL");
		//SQL_PH_DISP_MEDICATION_SELECT89_ORDER Added for ML-MMOH-CRF-0532 [IN061327]  C.LONG_DESC CHANGED 
		
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT89_ORDER","SELECT A.ORD_PRACT_ID, A.SOURCE_CODE,DECODE(A.PATIENT_CLASS,'IP',DECODE (a.ORIG_SOURCE_TYPE,'N', ip_get_desc.ip_nursing_unit (a.ORDERING_FACILITY_ID,a.orig_source_code, b.language_id, '1')),DECODE(D.LONG_DESC,NULL,C.LONG_DESC,D.LONG_DESC)) LOCATION,B.PRACTITIONER_NAME,(SELECT PRACTITIONER_NAME FROM AM_PRACTITIONER_lang_vw  WHERE language_id =? and PRACTITIONER_ID = nvl2(ORD_AUTH_DATE_TIME,a.ord_auth_by_pract_id,NULL)) AUTH_BY_NAME ,(SELECT practitioner_name  FROM am_practitioner_lang_vw  WHERE language_id = ?  AND practitioner_id = NVL2 (ORD_APPR_DATE_TIME, ORD_APPR_BY_USER_ID, NULL)) appr_by_name, (SELECT practitioner_name FROM am_practitioner_lang_vw WHERE language_id = ?  AND practitioner_id =  NVL2 (ORD_COSIGN_DATE_TIME, ORD_COSIGN_BY_PRACT_ID, NULL)) cosign_by_name  FROM OR_ORDER A,AM_PRACTITIONER_LANG_VW B,IP_NURSING_UNIT_LANG_VW C, OP_CLINIC_LANG_VW D WHERE A.ORD_PRACT_ID=B.PRACTITIONER_ID AND A.SOURCE_CODE=C.NURSING_UNIT_CODE(+) AND A.SOURCE_CODE=D.CLINIC_CODE(+) AND A.ORDER_ID=? AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT89","SELECT A.ORD_PRACT_ID, A.SOURCE_CODE,DECODE(A.PATIENT_CLASS,'IP',C.LONG_DESC,DECODE(D.LONG_DESC,NULL,C.LONG_DESC,D.LONG_DESC)) LOCATION,B.PRACTITIONER_NAME,(SELECT PRACTITIONER_NAME FROM AM_PRACTITIONER_lang_vw  WHERE language_id =? and PRACTITIONER_ID = nvl2(ORD_AUTH_DATE_TIME,a.ord_auth_by_pract_id,NULL)) AUTH_BY_NAME ,(SELECT practitioner_name  FROM am_practitioner_lang_vw  WHERE language_id = ?  AND practitioner_id = NVL2 (ORD_APPR_DATE_TIME, ORD_APPR_BY_USER_ID, NULL)) appr_by_name, (SELECT practitioner_name FROM am_practitioner_lang_vw WHERE language_id = ?  AND practitioner_id =  NVL2 (ORD_COSIGN_DATE_TIME, ORD_COSIGN_BY_PRACT_ID, NULL)) cosign_by_name  FROM OR_ORDER A,AM_PRACTITIONER_LANG_VW B,IP_NURSING_UNIT_LANG_VW C, OP_CLINIC_LANG_VW D WHERE A.ORD_PRACT_ID=B.PRACTITIONER_ID AND A.SOURCE_CODE=C.NURSING_UNIT_CODE(+) AND A.SOURCE_CODE=D.CLINIC_CODE(+) AND A.ORDER_ID=? AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ?");
        /*QUERY FOR SELECTING DEFAULT Reconstituent Fluid FOR THE DRUG*/  
	    dataMap.put("SQL_PH_DISP_MEDICATION_SELECT90","select A.RF_ID,A.DRUG_QTY, A.DRUG_QTY_UOM,A.RF_QTY, A.RF_QTY_UOM ,B.DRUG_DESC from ph_reconst_fluid_for_drug A,ph_drug_lang_vw B where A.DRUG_CODE=B.DRUG_CODE AND A.DRUG_CODE=? and A.DEFAULT_YN=? AND b.language_id = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT95","select ISSUE_TOKEN_ON_REGN_YN  from ph_disp_locn where DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT96","select to_char(REGN_DATE_TIME,'mm/dd/yyyy hh24:mi') REGN_DATE_TIME from PH_DISP_QUEUE where PATIENT_ID=? AND  trunc(ADDED_DATE)= trunc(Sysdate)");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT97","select ORDER_ID from OR_ORDER where ORD_DATE_TIME > to_date(?,'mm/dd/yyyy hh24:mi') AND trunc(ADDED_DATE)= trunc(Sysdate)");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT98","select b.DRUG_DESC drug_name,to_char(a.START_DATE_TIME,'dd/mm/yyyy hh24:mi') start_date,to_char(a.END_DATE_TIME,'dd/mm/yyyy hh24:mi') end_date,a.ORDER_CATALOG_CODE order_catalog_code,a.QTY_VALUE qty_value,a.QTY_UNIT qty_unit,a.FREQ_CODE freq_code,c.ORD_PRACT_ID ordered_practioner,c.SOURCE_CODE locn_code,c.PERFORMING_DEPTLOC_CODE performing_deptloc_code,c.ORDERING_FACILITY_ID ordering_facility_id, d.LONG_DESC ordering_location, e.SHORT_DESC performing_location, f.FACILITY_NAME facility_name  from or_order_line a,ph_drug_vw_lang_vw b,or_order c, op_clinic_lang_vw d, ph_disp_locn_lang_vw e, sm_facility_param_lang_vw f where a.ORDER_ID=c.ORDER_ID and a.ORDER_CATALOG_CODE=b.DRUG_CODE and d.clinic_code=c.source_code and c.PERFORMING_DEPTLOC_CODE = e.DISP_LOCN_CODE and f.facility_id=c.ordering_facility_id and c.ORDER_ID=? and b.lang1 = d.language_id and b.lang1 = e.language_id and b.lang1 = f.language_id AND LANG1 = ? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT99","select PAT_COUNS_REQD_YN from or_order_line_ph where ORDER_ID=? and ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT100","SELECT 	distinct A.FILL_PROC_ID FROM 	PH_FILL_PROCESS_PARAM A,PH_DISP_HDR_TMP B WHERE trunc(FILL_PROC_DATE_TIME) = to_date(?,'dd/mm/yyyy') and a.fill_proc_id = b.fill_proc_id AND PROC_TYPE=? and A.DISP_LOCN_CODE =? order by A.FILL_PROC_ID");

		//dataMap.put("SQL_PH_DISP_MEDICATION_SELECT101","SELECT A.NURSING_UNIT_CODE NURSING_UNIT_CODE,B.LONG_DESC NURSING_UNIT_NAME FROM PH_LAST_FILL_INT_DTL A, IP_NURSING_UNIT_LANG_VW B WHERE  A.NURSING_UNIT_CODE = B.NURSING_UNIT_CODE AND A.FACILITY_ID = B.FACILITY_ID AND A.LAST_FILL_PROC_ID = ? AND B.EFF_STATUS = 'E' AND B.FACILITY_ID =? AND B.LANGUAGE_ID = ? AND (select count(*) from PH_DISP_HDR_TMP where A.LAST_FILL_PROC_ID = FILL_PROC_ID and A.NURSING_UNIT_CODE = LOCN_CODE)>0");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT101A","SELECT distinct(b.nursing_unit_code) nursing_unit_code, b.long_desc nursing_unit_name FROM ph_disp_hdr_tmp a, ip_nursing_unit_lang_vw b WHERE a.locn_code = b.nursing_unit_code   AND a.facility_id = b.facility_id AND a.fill_proc_id = ?  AND b.eff_status = 'E'   AND b.facility_id = ?  AND b.language_id = ? ");

		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT102","select a.DRUG_DESC DRUG_DESC,b.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,b.ORDER_QTY ORDER_QTY,b.order_uom order_uom,(select sum(disp_qty) from ph_disp_dtl where order_id= ? and order_line_no=?) disp_qty  from ph_drug_lang_vw a,or_order_line b where a.drug_code=b.ORDER_CATALOG_CODE and b.order_id= ? and b.order_line_num=? and a.language_id = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT103","select a.PATIENT_NAME PATIENT_NAME,GET_AGE(DATE_OF_BIRTH) AGE,   a.SEX SEX,b.ORD_PRACT_ID ORD_PRACT_ID,b.Source_code Source_code from mp_patient a,or_order b where a.patient_id=b.patient_id and a.patient_id=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT104","select FACILITY_ID,FACILITY_NAME from SM_FACILITY_PARAM_LANG_VW SM_FACILITY_PARAM WHERE STATUS='E' AND FACILITY_ID<>? AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT105","SELECT ORDER_LINE_NUM FROM OR_ORDER_LINE WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT106","SELECT ORDER_LINE_STATUS FROM OR_ORDER_LINE WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT107","SELECT TRADE_ID FROM ST_ITEM_BATCH WHERE STORE_CODE=? AND ITEM_CODE=? AND BATCH_ID=? AND BIN_LOCATION_CODE=? AND  EXPIRY_DATE_OR_RECEIPT_DATE=TO_DATE(?,'DD/MM/YYYY')");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT108","SELECT (TO_CHAR(SYSDATE+DECODE(IP_FILL_PRD_UNIT,'H', IP_FILL_PRD_AHEAD/24,nvl(ip_fill_prd_ahead,0)),'DD/MM/YYYY')||' '||TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI')) NEXT_DATE FROM PH_DISP_LOCN WHERE DISP_LOCN_CODE=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT109","SELECT A.FRACT_DOSE_ROUND_UP_YN FROM PH_DRUG A, OR_ORDER_LINE B WHERE B.ORDER_ID=? AND B.ORDER_LINE_NUM=? AND A.DRUG_CODE=B.ORDER_CATALOG_CODE");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT110","SELECT  REFERRAL_CODE code , LONG_DESC short_desc FROM AM_REFERRAL_LANG_VW AM_REFERRAL WHERE  EFF_STATUS='E' AND ORG_TYPE='G' AND LANGUAGE_ID = ?   ORDER BY 2");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT110A","SELECT  REFERRAL_CODE code , LONG_DESC description FROM AM_REFERRAL WHERE   HEALTHCARE_SETTING_TYPE LIKE Upper(?)   AND REFERRAL_CODE LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND EFF_STATUS='E' AND ORG_TYPE='G' ORDER BY 2");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT110B","SELECT HCARE_SETTING_TYPE_CODE, SHORT_DESC FROM AM_HCARE_SETTING_TYPE_LANG_VW AM_HCARE_SETTING_TYPE WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT111","SELECT PRESCRIBED_MODE,TO_CHAR(SYSDATE+DURATION,'DD/MM/YYYY HH24:MI') NEXT_FILL_DATE FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT112","SELECT TO_CHAR(FILL_INT_END_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_END_DATE_TIME FROM PH_FILL_PROCESS_PARAM WHERE FILL_PROC_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT113","select PT_COUN_REQD_YN from ph_drug where DRUG_CODE=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT114"," SELECT OP_DISP_PERIOD FROM PH_DISP_LOCN   WHERE FACILITY_ID=? AND  DISP_LOCN_CODE=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT115"," SELECT TO_DATE(END_DATE_TIME,'DD/MM/YYYY HH24:MI') - TO_DATE(START_DATE_TIME,'DD/MM/YYYY HH24:MI')DURATION FROM OR_ORDER_LINE WHERE ORDER_ID = ? AND ORDER_LINE_NUM = ? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT116"," SELECT NVL(MAX(WORKSHEET_ID) + 1,1) WRKSHTID FROM PH_WORKSHEET_HDR where DISP_LOCN =? and facility_id =? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT117"," SELECT NVL(MAX(TPN_WORKSHEET_ID) + 1,1) WRKSHTID FROM PH_TPN_WORKSHEET_HDR where DISP_LOCN_CODE =? and facility_id =? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT118"," SELECT DISTINCT B.DURN_VALUE DURN_VALUE, D.INFUSE_OVER INFUSE_OVER, C.IV_PREP_YN IV_PREP_YN,E.REPEAT_VALUE REPEAT_VALUE FROM PH_WORKSHEET_DTL A, OR_ORDER_LINE B, OR_ORDER C, OR_ORDER_LINE_PH D,AM_FREQUENCY E WHERE A.ORDER_ID = B.ORDER_ID AND A.ORDER_LINE_NUM = B.ORDER_LINE_NUM AND B.ORDER_ID = C.ORDER_ID AND C.ORDER_ID = D.ORDER_ID AND B.ORDER_LINE_NUM = D.ORDER_LINE_NUM AND B.FREQ_CODE = E.FREQ_CODE AND A.WORKSHEET_ID = ? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT119"," SELECT B.DURN_VALUE DURN_VALUE FROM PH_TPN_WORKSHEET_DTL A, OR_ORDER_LINE B WHERE A.ORDER_ID = B.ORDER_ID AND A.ORDER_LINE_NUM = B.ORDER_LINE_NUM AND A.TPN_WORKSHEET_ID = ? AND ROWNUM < 2");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT120"," SELECT ORDER_LINE_STATUS FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT121","  SELECT STRENGTH_VALUE, STRENGTH_PER_VALUE_PRES_UOM FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT122"," SELECT QTY_VALUE,FREQ_CODE FROM OR_ORDER_LINE WHERE ORDER_ID=? AND  ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT123"," SELECT ORDER_QTY FROM OR_ORDER_LINE WHERE ORDER_ID=?  AND ORDER_LINE_NUM=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT124"," SELECT SPLIT_DOSE_YN,DOSAGE_TYPE,TOT_STRENGTH FROM OR_ORDER_LINE_PH WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT125"," select DISP_AUTH_REQD_YN from ph_drug where drug_code=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT126"," select FILL_PROC_ID from or_order_line_ph where order_id=? and order_line_num=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT127"," SELECT IV_DRUG_FLUID_CONTINUOUS_LG||'(Direct)' iv_drug_fluid_continuous_dir,IV_DRUG_FLUID_CONTINUOUS_LG||'(Admx)' iv_drug_fluid_continuous_adm,IV_DRUG_FLUID_INTERMITTENT_LG||'(Direct)' IV_DRUG_FLUID_INTERMITTENT_dir,IV_DRUG_FLUID_INTERMITTENT_LG||'(Admx)' IV_DRUG_FLUID_INTERMITTENT_adm,IV_WITHOUT_ADDITIVES_LG,IV_DRUG_FLUID_CONTINUOUS_LG,IV_DRUG_FLUID_INTERMITTENT_LG from ph_param_lang_vw ph_param WHERE language_id = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT128"," SELECT TPN_WORKSHEET_ID FROM PH_TPN_WORKSHEET_DTL   WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT129"," SELECT SPIL_QTY_AVAIL FROM PH_WORKSHEET_DTL WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND FACILITY_ID=? AND WORKSHEET_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT130"," SELECT SUM(USED_QTY) TOT_DISP_QTY FROM PH_WORKSHEET_DTL  WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND FACILITY_ID=?");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT131"," select count(*) TOTAL, sum(ORDER_QTY) tot_qty from or_order_line a where order_id in (SELECT b.order_id FROM or_order b where B.TRN_GROUP_REF = (select TRN_GROUP_REF from or_order WHERE order_id = ? and patient_id=?)) and order_catalog_code = ? AND PARENT_ORDER_ID is null AND (select freq_nature from am_frequency where freq_code = a.freq_code)  not in ('O', 'P')"); 
        //dataMap.put("SQL_PH_DISP_MEDICATION_SELECT131","  select count(*) TOTAL  from or_order_line_ph where taper_order_id = ? and taper_order_line_num = ?"); 
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT132"," select TAPER_DOSE_YN,TAPER_UP from or_order_catalog where ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT133"," select short_name from ph_tpn_regimen where tpn_regimen_code = 'NON_STANDARD'");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT134","SELECT A.DISP_QTY,A.DISP_DRUG_CODE,A.PRES_DRUG_CODE,B.DRUG_DESC,A.DISP_UOM_CODE FORM_CODE,B.STRENGTH_VALUE,B.STRENGTH_UOM ,a.DISP_UOM_CODE,ph_get_ext_prod_drug_code(b.drug_code,?)EXTERNAL_PRODUCT_ID FROM PH_DISP_DTL_TMP A,PH_DRUG_LANG_VW B WHERE  A.ORDER_ID=? AND A.ORDER_LINE_NO=? AND A.DISP_DRUG_CODE=B.DRUG_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT135","SELECT COUNT(*) cnt FROM PH_DISP_DRUG_BATCH_TMP WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND ORDER_ID=?  AND ORDER_LINE_NUM=?  AND ITEM_CODE=? AND BATCH_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT136","select dtl_serial_num S_NO from ph_disp_dtl_tmp  where ?='A' and DISP_TMP_NO=? and facility_id=? and DISP_QTY>0 union all  select SRL_NO S_NO from ph_disp_dtl  where ?='D' and DISP_NO=? and facility_id=? and DISP_QTY>0 union all  select SRL_NO S_NO from ph_disp_cons_dtl  where DISP_NO=? and facility_id=? and DISP_QTY>0");// Added union all with ph_disp_cons_dtl for [IN:047652]//changed DOC_SRL_NO to dtl_serial_num for ML-MMOH-SCF-0646
		//DTL_SERIAL_NUM to DOC_SRL_NO for BSP-SCF-0002.2[EMR-5833]
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT137","select Ph_Calculatebalance (?,?) bms_qty from dual");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT138","SELECT order_line_field_value FROM or_order_line_field_values WHERE order_id=? AND  order_line_seq_num >=200");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT139","select order_id order_id from ph_disp_dtl_tmp  where ?='A' and DISP_TMP_NO=? and facility_id=? union all  select order_id order_id from ph_disp_dtl  where ?='D' and DISP_NO=? and facility_id=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT140","SELECT DISTINCT CEIL (a.durn_value / b.infuse_over) RepeatValue FROM or_order_line a, or_order_line_ph b WHERE a.order_id = b.order_id AND b.order_id = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT141","SELECT Bms_qty FROM or_order_line_ph WHERE order_id=? AND order_line_num=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT142","SELECT spil_qty_avail,qty_used_from_stock,used_qty FROM PH_WORKSHEET_DTL WHERE worksheet_id=? AND disp_locn=?  AND ORDER_LINE_NUM=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT143","SELECT finalized_yn FROM PH_WORKSHEET_hdr WHERE worksheet_id=? and facility_id =? and disp_locn =?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT144","SELECT doc_type,doc_no from ph_tpn_worksheet_hdr WHERE order_id=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT145","SELECT pat_couns_ord_pract_id FROM or_order_line_ph WHERE ORDER_id=? AND order_line_num=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT146","select func_role_id from sm_appl_user where APPL_USER_ID=?");	
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT147","SELECT DISTINCT a.order_id,TO_CHAR (a.ord_date_time, 'dd/mm/yyyy hh24:mi') ord_date_time,a.ord_date_time ord_dt_time, c.token_serial_no token_series_num,d.description token_series_desc,f.short_desc order_status_desc,DECODE (?,e.disp_locn_code, '!' || e.short_desc,e.short_desc) s_disp_locn, g.drug_desc drug_desc,TO_CHAR (b.start_date_time, 'dd/mm/yyyy hh24:mi') start_date,b.order_line_status line_status,TO_CHAR (c.queue_date, 'dd/mm/yyyy') token_date, a.performing_deptloc_code disp_locn_code,h.facility_name ord_facility_name, (case when (a.performing_deptloc_code = nvl(d.disp_locn_code,a.performing_deptloc_code) )then ( select short_desc from ph_disp_locn_lang_vw where disp_locn_code= a.performing_deptloc_code and language_id =?) else (select short_desc from ph_disp_locn_lang_vw where disp_locn_code= d.disp_locn_code and language_id =?) end )  disp_locn FROM or_order a, (select * from (SELECT row_number() over (partition by y.order_id order by y.added_date desc ) srl_no,y.facility_id, y.disp_locn_code, y.patient_id, y.order_id, y.token_series_code, y.token_serial_no, y.queue_date, y.queue_shift FROM ph_ord_for_disp_queue y, ph_disp_queue x WHERE y.facility_id = x.facility_id AND y.disp_locn_code = x.disp_locn_code AND y.queue_date = x.queue_date AND y.queue_shift = x.queue_shift AND y.token_series_code = x.token_series_code AND y.token_serial_no = x.token_serial_no AND x.token_status NOT IN ('DP', 'DF') order by  3,4 ) where srl_no = 1 ) c, ph_token_series_lang_vw d,ph_disp_locn_lang_vw e,or_order_status_code_lang_vw f, or_order_line b, (SELECT language_id, drug_desc, drug_code FROM ph_drug_lang_vw UNION SELECT language_id, long_name drug_desc, tpn_regimen_code drug_code FROM ph_tpn_regimen_lang_vw) g,sm_facility_param_lang_vw h, (select * from ph_disp_queue where token_status not in('DP', 'DF')) dispq WHERE a.patient_id = ? AND a.performing_deptloc_code = NVL (?, a.performing_deptloc_code) AND f.order_status_code = b.order_line_status AND (TO_NUMBER (f.order_status_type) < 58 or TO_NUMBER (f.order_status_type) ='94') AND a.order_id = c.order_id(+) AND a.patient_id = c.patient_id(+) AND c.facility_id = d.facility_id(+) AND c.disp_locn_code = d.disp_locn_code(+) AND c.token_series_code = d.token_series_code(+) AND e.facility_id = a.performing_facility_id AND e.disp_locn_code = a.performing_deptloc_code AND a.order_id = b.order_id AND b.order_catalog_code = g.drug_code AND ph_check_ord_date_dispensing (b.start_date_time, b.end_date_time, ?,?,?,?,?) = 1 AND DISPQ.facility_id(+)   = c.facility_id and DISPQ.disp_locn_code(+) = c.disp_locn_code  and DISPQ.QUEUE_DATE(+) = c.queue_date and DISPQ.QUEUE_SHIFT(+) = c.queue_shift and DISPQ.TOKEN_SERIES_CODE(+) = c.token_series_code and DISPQ.TOKEN_SERIAL_NO(+) = c.token_serial_no /* and DISPQ.TOKEN_STATUS not in('DP', 'DF') */ AND b.order_line_status not in ('DP','DC','CN') AND g.language_id = ? AND e.language_id = ? AND f.language_id(+) = ? AND a.ordering_facility_id = h.facility_id AND a.ordering_facility_id = NVL (?, a.ordering_facility_id) AND h.language_id = ? ORDER BY s_disp_locn, c.token_serial_no, a.order_id"); // "b.order_line_status NOT IN ('OS', 'DP', 'DC', 'CN', 'DC')" changed to "b.order_line_status NOT IN ('DP', 'DC', 'CN')" for SKR-SCF-1108[IN:057252]//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT148","SELECT VERIFY_REMARKS,BUILD_MAR_YN FROM OR_ORDER_LINE_PH WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT149","SELECT DISP_TMP_NO FROM PH_DISP_HDR_TMP  WHERE ORDER_ID=? AND DISP_LOCN_CODE = ? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT150","SELECT MAX(DTL_SERIAL_NUM)DTL_SERIAL_NUM, order_id FROM ph_disp_dtl_tmp WHERE order_id = ? AND disp_tmp_no=? GROUP BY ORDER_ID");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT151","SELECT a.order_id, a.order_line_no, a.pres_drug_code, a.disp_drug_code, a.disp_qty, a.disp_uom_code, b.item_code, b.batch_id, a.disp_drug_code, a.pres_drug_code, c.trade_id ,b.store_code,b.bin_location_code, to_char(b.expiry_date,'dd/mm/yyyy') expiry_date,a.doc_srl_no, b.disp_qty batch_qty  FROM ph_disp_dtl_tmp a, ph_disp_drug_batch_tmp b, st_item_batch c WHERE  a.order_id = ? AND a.order_id = b.order_id AND a.order_line_no = b.order_line_num AND a.doc_srl_no = b.doc_srl_no AND a.disp_locn_code = b.disp_locn_code AND a.facility_id = b.facility_id AND b.batch_id = c.batch_id AND b.store_code = c.store_code AND b.item_code = c.item_code AND b.bin_location_code = c.bin_location_code  AND b.expiry_date = c.expiry_date_or_receipt_date order by order_line_no");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT152","SELECT ON_HOLD_REASON_CODE  FROM ph_PATIENT_drug_profile WHERE orig_order_id=?  AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT153","SELECT Count(*)CNT FROM or_order_line a ,ph_disp_dtl b WHERE a.order_id =b.order_id AND a.order_line_num=b.order_line_no AND order_line_status in('DP','DD') AND b.disp_no=?");//,'DD' ADDED FOR MMS-KH-CRF-0014
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT154","SELECT DRUG_DB_PRODUCT_ID,a.ALLERGY_OVERRIDE_REASON,a.DOSAGE_LIMIT_OVERRIDE_REASON,a.DUPLICATE_DRUG_OVERRIDE_REASON,b.INTERACTION_OVERRIDE_REASON,CONTRAIND_OVERRIDE_REASON,b.LAB_INTERACT_OVERRIDE_REASON,b.FOOD_INTERACT_OVERRIDE_REASON,b.DISEASE_INTER_OVERRIDE_REASON FROM ph_patient_drug_profile a,or_order_line_ph b  WHERE  a.orig_order_id=b.order_id and orig_order_line_no=ORDER_LINE_NUM and  orig_order_id=? AND orig_order_line_no=?");//moddified for MMS-KH-CRF-0029 DISEASE_INTER_OVERRIDE_REASON for MMS-DM-CRF-0229
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT155","SELECT DISP_CASH_COLL_STAGE, DISP_BILL_STAGE,  DISP_CASH_COLL_STAGE_OP, DISP_BILL_STAGE_OP, CHARGE_PAT_FOR_SPILL_QTY_YN  FROM  PH_DISP_LOCN  WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? ");    
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT156","SELECT COUNT(*) POCNT FROM OR_ORDER A WHERE PATIENT_ID = ? AND  PERFORMING_DEPTLOC_CODE = ? AND ORDER_STATUS IN (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_TYPE IN ('00','03','05')) AND EXISTS (SELECT ORDER_ID FROM OR_ORDER_LINE WHERE ORDER_ID =A.ORDER_ID AND ORDER_STATUS IN (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_TYPE IN ('00','03','05')) AND END_DATE_TIME >= SYSDATE)");	
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT157","SELECT A.ORDER_ID,TO_CHAR (A.START_DATE_TIME, 'dd/mm/yyyy hh24:mi')START_DATE_TIME,TO_CHAR (A.END_DATE_TIME, 'dd/mm/yyyy hh24:mi') END_DATE_TIME  FROM OR_ORDER_LINE A,OR_ORDER B  WHERE B.PATIENT_ID = ?   AND B.ORDER_STATUS = 'OS'   AND A.ORDER_ID=B.ORDER_ID AND A.NUM_OF_REFILLS>0 AND       REFILL_SINGLE_CONT_ORDER_YN='Y'  AND B.PARENT_ORDER_ID =? AND A.END_DATE_TIME >SYSDATE");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT158","SELECT a.REMARK_CODE,a.REMARK_DESC,b.DEFAULT_REMARK_YN FROM PH_PRES_REMARK_lang_vw  a ,PH_PRES_REMARK_FOR_DRUG b WHERE a.REMARK_CODE =b.REMARK_CODE AND b.drug_code=? AND b.EFF_STATUS='E' AND a.language_id=? ");		
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT159","SELECT REMARK_CODE from ph_pres_remark_for_drug  WHERE drug_code =? AND DEFAULT_REMARK_YN ='Y'");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT160","SELECT ORDER_LINE_FIELD_VALUE FROM OR_ORDER_LINE_FIELD_VALUES a,OR_ORDER_FIELD_REF_VALUES_LANG b WHERE a.ORDER_ID=? AND a.ORDER_LINE_NUM = ? AND ORDER_LINE_SEQ_NUM < 100 AND a.ORDER_LINE_FIELD_VALUE = b.ALPHANUM_VALUE AND a.ORDER_LINE_FIELD_MNEMONIC = 'PRES_REMARKS' and b.LANGUAGE_ID=?");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT161","SELECT DOC_NO,DOC_TYPE,doc_srl_no FROM  PH_DISP_HDR_TMP a,PH_DISP_dtl_TMP b WHERE a.facility_id = ?  and a.disp_locn_code = ?  and a.ORDER_ID= b.order_id AND a.DISP_TMP_NO= b.DISP_TMP_NO AND a.order_id=? AND b.ORDER_LINE_NO=? AND b.disp_drug_code = ? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT162","SELECT BL_INCL_EXCL_OVERRIDE_VALUE,BL_INCL_EXCL_OVERRIDE_REASON FROM or_order_line_ph where ORDER_ID=? and ORDER_LINE_NUM=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT163","select LABEL_CAU_INSTRN1_ENG,LABEL_SPL_INSTRN1_ENG,LABEL_PAT_INSTRN1_ENG,PRES_REMARK_CODE FROM ph_disp_dtl_tmp WHERE order_id=? AND ORDER_LINE_NO =? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT164","SELECT LONG_NAME FROM am_trade_name_lang_vw WHERE trade_id=? AND language_id=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT165","SELECT DECODE(?,'0',ITEM_FOR_ONCO_ADMX_PREP_CHRG,'2',ITEM_FOR_IV_ADMX_PREP_CHRG,'4',ITEM_FOR_IV_ADMX_PREP_CHRG,'6',ITEM_FOR_COMP_ADMX_PREP_CHRG,'8',ITEM_FOR_TPN_ADMX_PREP_CHRG) ITEM_FOR_ADMX_PREP_CHRG  FROM PH_PARAM ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT166","SELECT  ADMX_PREP_CHARGE_ITEM_CODE,ADMX_PREP_CHARGE_UNITS FROM  ph_worksheet_hdr WHERE FACILITY_ID =? AND DISP_LOCN =? AND WORKSHEET_ID =? ");
        dataMap.put("SQL_PH_DISP_MEDICATION_SELECT167","SELECT BL_INCL_EXCL_OVERRIDE_VALUE,  BL_INCL_EXCL_OVERRIDE_REASON from or_order_line_ph WHERE order_id=? AND order_line_num =?");
		//DISP_VERI_REM_DRUG_INST added for ml-mmoh-crf-1755 ,DISP_VERI_REM_DRUG_INST
         dataMap.put("SQL_PH_DISP_MEDICATION_SELECT168","SELECT ADMX_PREP_CHARGES_APPL_YN,EDIT_DISP_LABEL_AFTER_DEL,INCLUDE_ZERO_ALLOC_QTY_ITEMS ,ALLOW_AMEND_ALTERNATE_DRUG_DT,ALLOW_SHORT_EXPIRY_DRUGS_YN,DISP_UNALLOC_DRUGS_AT_DEL_STG,DECODE(ALLOW_DISP_RECORD_LOCK_YN,NULL,'N',ALLOW_DISP_RECORD_LOCK_YN) ALLOW_DISP_RECORD_LOCK_YN,INCLUDE_ZERO_ALOC_QTY_ITEMS_IP,DISP_AUTO_REFRESH,DISP_VERI_REM_DRUG_INST FROM ph_facility_param WHERE facility_id=?"); // Added ALLOW_AMEND_ALTERNATE_DRUG_DT for JD-CRF-0198 [IN058599]//INCLUDE_ZERO_ALOC_QTY_ITEMS_IP added for ML-BRU-CRF-0473//DISP_AUTO_REFRESH Added for TH-KW-CRF-0011
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT169","SELECT WS_SRL_NO, DISP_DRUG_CODE, SPIL_QTY_AVAIL, BATCH_ID1, EXPIRY_DATE1, BIN_LOCATION_CODE1, TRADE_ID1 FROM ph_worksheet_dtl WHERE FACILITY_ID = ? AND DISP_LOCN = ? AND WORKSHEET_ID =? AND spil_qty_avail > 0 ORDER BY ws_srl_no");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT170","SELECT OVERAGE_VOLUME FROM PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE = ? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT171","SELECT  ADMX_PREP_CHARGE_ITEM_CODE,ADMX_PREP_CHARGE_UNITS FROM  ph_tpn_worksheet_hdr WHERE FACILITY_ID =? AND DISP_LOCN_CODE =? AND TPN_WORKSHEET_ID =? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT172","SELECT DISP_ITEM_CODE,BATCH_ID1,EXPIRY_DATE1,BATCH1_QTY,TRADE_ID1,BIN_LOCATION_CODE1,B.DOC_TYPE doc_type_code, B.DOC_NO doc_no, C.DOC_SRL_NO doc_srl_no FROM ph_tpn_worksheet_dtl a, ph_tpn_worksheet_hdr b, st_sal_dtl_exp c  WHERE A.DISP_LOCN  = ? AND B.FACILITY_ID=? AND B.TPN_WORKSHEET_ID = ? AND A.FACILITY_ID = B.FACILITY_ID  AND DISP_LOCN = B.DISP_LOCN_CODE AND A.TPN_WORKSHEET_ID = B.TPN_WORKSHEET_ID AND C.FACILITY_ID = B.FACILITY_ID AND C.DOC_TYPE_CODE = B.DOC_TYPE AND C.DOC_NO = B.DOC_NO AND BATCH_ID1=c.BATCH_ID AND EXPIRY_DATE1=c.EXPIRY_DATE_OR_RECEIPT_DATE AND DISP_ITEM_CODE=c.ITEM_CODE AND TRADE_ID1=c.TRADE_ID AND BIN_LOCATION_CODE1=BIN_LOCATION_CODE AND NVL(A.BATCH1_QTY,0) > 0  ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT173","SELECT A.ORDER_ID ORDER_ID,A.ORDER_LINE_NUM ORDER_LINE_NUM, D.DRUG_DESC DRUG_DESC,c.short_DESC ORDER_LINE_STATUS FROM OR_ORDER_LINE A ,PH_ORD_FOR_DISP_QUEUE  B,OR_ORDER_STATUS_CODE_LANG_VW C,PH_DRUG_LANG_VW D WHERE A.ORDER_ID = B.ORDER_ID AND B.FACILITY_ID=? AND B.DISP_LOCN_CODE=?  AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY')  AND QUEUE_SHIFT='*ALL' AND  TOKEN_SERIES_CODE=? AND  TOKEN_SERIAL_NO=? AND A.ORDER_LINE_STATUS =C.ORDER_STATUS_CODE AND C.LANGUAGE_ID =? AND A.ORDER_CATALOG_CODE=D.DRUG_CODE AND D.LANGUAGE_ID =? order by a.order_id,a.order_line_num ");
		//dataMap.put("SQL_PH_DISP_MEDICATION_SELECT174","select (APPT_DATE-trunc(sysdate)) next_appt_days from oa_appt where FACILITY_ID =? and trunc(APPT_DATE)>=trunc(sysdate) and  PATIENT_ID=? and  APPT_STATUS='1' AND ROWNUM<2 order by APPT_DATE ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT174","select (APPT_DATE-trunc(sysdate)) next_appt_days from oa_appt where  TO_DATE(TO_CHAR(APPT_DATE,'DD/MM/YYYY')||' '||to_char(APPT_SLAB_TO_TIME,'HH24:MI:SS'),'DD/MM/YYYY HH24:MI:SS')>= SYSDATE and  PATIENT_ID=? and  APPT_STATUS='1' AND ROWNUM<2 order by APPT_DATE "); 
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT175","select count(*) cnt from ph_disp_dtl where order_id=? and ORDER_LINE_NO =? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_SELECT176","SELECT FACILITY_ID, PRINT_DISP_SHEET_OP_YN, ALLOC_DISP_SHEET_DEFAULT_YN, ALLOC_DISP_LABEL_DEFAULT_YN, ALLOC_DRUG_LABEL_DEFAULT_YN, DEL_DISP_SHEET_DEFAULT_YN, DEL_DISP_LABEL_DEFAULT_YN, DEL_DRUG_LABEL_DEFAULT_YN FROM PH_DISP_LOCN WHERE FACILITY_ID =? AND DISP_LOCN_CODE=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE_VERIFY_REMARKS","UPDATE or_order_line_ph SET  verify_remarks=? , BL_INCL_EXCL_OVERRIDE_VALUE =? , BL_INCL_EXCL_OVERRIDE_REASON =?  WHERE order_id = ? AND order_line_num =?");
		dataMap.put("SQL_PH_DISP_MEDICATION_BL_SELECT1","SELECT DECODE(PATIENT_CLASS, 'IP','I','DC','D','OP','O','EM','E','XT','R') ENC_PATIENT_CLASS FROM PR_ENCOUNTER WHERE FACILITY_ID = ? AND ENCOUNTER_ID = ? AND PATIENT_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_BL_SELECT2","SELECT NVL(BL_INTERFACE_YN,'N') BL_INTERFACE_YN FROM ST_ACC_ENTITY_PARAM WHERE ACC_ENTITY_ID IN (SELECT ACC_ENTITY_ID FROM SM_ACC_ENTITY_PARAM_FACL WHERE FACILITY_ID = ?)");
		//select Ph_Calculatebalance (?,?) bms_qty from dual
		// QUERIES FOR MANUFACTURE DETAILS	
		dataMap.put("SQL_PH_TPN_WORKSHEET_DTL_SELECT4"," select distinct(TPN_WORKSHEET_ID) from PH_TPN_WORKSHEET_DTL where order_id=?");
		dataMap.put("SQL_PH_TPN_WORKSHEET_HDR_SELECT4","select FACILITY_ID, DISP_LOCN_CODE, TPN_WORKSHEET_ID,MFG_UNIT,BATCH_ID, to_char(EXPIRY_DATE,'dd/mm/yyyy hh24:mi')EXPIRY_DATE1, QTY_VOLUME, QTY_UOM,ADMIN_INSTRUCTION,INFUSION_LINE from  PH_TPN_WORKSHEET_HDR WHERE TPN_WORKSHEET_ID=? AND DISP_LOCN_CODE=?");
        dataMap.put("SQL_PH_TPN_WORKSHEET_HDR_SELECT5","SELECT OVERAGE_VOLUME,OVERAGE_VOLUME_UOM FROM PH_TPN_WORKSHEET_HDR WHERE order_id = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_MFCTR_SELECT1","SELECT ORDER_CATALOG_CODE,ORDER_LINE_NUM,QTY_VALUE,QTY_UNIT FROM OR_ORDER_LINE WHERE ORDER_ID=? order by ORDER_LINE_NUM");
		dataMap.put("SQL_PH_DISP_MEDICATION_MFCTR_SELECT2","SELECT GENERIC_NAME FROM PH_GENERIC_NAME_LANG_VW A, PH_DRUG B WHERE A.GENERIC_ID = B.GENERIC_ID AND B.DRUG_CODE = ? AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_MFCTR_SELECT3","SELECT DRUG_DESC,STABILITY_HRS,PRES_BASE_UOM FROM PH_DRUG_LANG_VW PH_DRUG WHERE DRUG_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_MF_EXPDATE_SELECT4","SELECT TO_CHAR(SYSDATE+(?/24), 'DD/MM/YYYY HH24:MI') EXPIRE_DATE FROM DUAL");
		dataMap.put("SQL_PH_DISP_MEDICATION_MFCTR_SELECT4","SELECT IV_PREP_YN FROM OR_ORDER WHERE ORDER_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_MFCTR_SELECT5","SELECT   	DISTINCT 	a.facility_id facility_id, a.disp_locn disp_locn,a.worksheet_id, a.mfg_unit mfg_unit,a.batch_id batch_id,TO_CHAR (a.expiry_date, 'dd/mm/yyyy hh24:mi') expiry_date,a.qty_volume qty_volume, a.qty_uom qty_uom,a.admin_instruction admin_instruction FROM ph_worksheet_hdr a, ph_worksheet_dtl b WHERE b.order_id = ? AND a.facility_id = b.facility_id AND a.disp_locn = b.disp_locn AND a.worksheet_id = b.worksheet_id AND a.worksheet_id =(SELECT MAX(worksheet_id) FROM ph_worksheet_dtl WHERE order_id =?) ");
		dataMap.put("SQL_PH_DISP_MEDICATION_MFCTR_SELECT6","SELECT TPN_ADMIN_ROUTE FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID = ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_MFCTR_UPDATE1","UPDATE PH_WORKSHEET_HDR SET MFG_UNIT=?, BATCH_ID=?, EXPIRY_DATE = TO_DATE(?,'DD/MM/YYYY HH24:MI'), QTY_VOLUME =?, QTY_UOM = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?,ADMIN_INSTRUCTION=? WHERE FACILITY_ID=? AND DISP_LOCN=? AND WORKSHEET_ID =?");
		dataMap.put("SQL_PH_TPN_WORKSHEET_HDR_UPDATE1","UPDATE PH_TPN_WORKSHEET_HDR SET MFG_UNIT=?, BATCH_ID=?, EXPIRY_DATE=TO_DATE(?,'DD/MM/YYYY HH24:MI'), QTY_VOLUME=?, QTY_UOM=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,ADMIN_INSTRUCTION =?,INFUSION_LINE = ? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND TPN_WORKSHEET_ID =?,APPROVAL_NO=? "); //approval_no added for AAKH-CRF-0117
		dataMap.put("SQL_PH_DISP_MEDICATION_ORDER_LINE_UPDATE","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS=?,HOLD_PRACT_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), HOLD_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),LAST_ACTION_TYPE=?,LAST_ACTION_REASON_DESC=?,CAN_LINE_REASON=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?,RESULT_LINE_STATUS=?, PREV_ORDER_LINE_STATUS=ORDER_LINE_STATUS  WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_OR_ORDER_LINE_PH_UPDATE","UPDATE OR_ORDER_LINE_PH SET PAT_COUNS_REQD_YN=?,MODIFIED_DATE=SYSDATE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");		
		dataMap.put("SQL_OR_ORDER_LINE_PH_UPDATE1","UPDATE OR_ORDER_LINE_PH SET PAT_COUNS_REQD_YN=?,pat_couns_ord_pract_id=?,MODIFIED_DATE=SYSDATE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
        dataMap.put("SQL_OR_ORDER_LINE_PH_UPDATE2","UPDATE OR_ORDER_LINE_PH SET complete_order_reason = ? , MODIFIED_DATE=SYSDATE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_OR_ORDER_LINE_PH_UPDATE2A","UPDATE OR_ORDER_LINE_PH SET complete_order_reason = ? , MODIFIED_DATE=SYSDATE ,LAST_DISPENSED_DATE=TO_DATE(?,'DD/MM/YYYY HH24:MI') WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_REFERRAL_ORDER_UPDATE","UPDATE OR_ORDER SET REF_DATE_TIME=SYSDATE,REF_FACILITY_ID=?,REF_SENT_PRACT_ID=?,REF_SENT_REMARKS=?, ORDER_STATUS='DF',MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ?, performing_facility_id='', performing_deptloc_code='' WHERE ORDER_ID=?"); //performing_facility_id, deptloc_code added for CRF-PH-HSA-CRF-0155/01 [IN:050775]
		dataMap.put("SQL_PH_DISP_MEDICATION_REFERRAL_ORDER_LINE_UPDATE1","UPDATE OR_ORDER_LINE SET REFERRAL_YN ='Y',ORDER_LINE_STATUS='DF' WHERE ORDER_ID = ? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_ORDER_LINE_SELECT","SELECT ORDER_LINE_STATUS,LAST_ACTION_REASON_DESC  FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_ORDER_LINE_SELECT1","select RESULT_LINE_STATUS from or_order_line where ORDER_ID=? and  ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_IP_ORDER_LINE_PH_UPDATE","UPDATE OR_ORDER_LINE_PH SET NEXT_FILL_DATE =TO_DATE(?,'DD/MM/YYYY HH24:MI'),LAST_DISPENSED_DATE=TO_DATE(?,'DD/MM/YYYY HH24:MI'),MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_ORDER_LINE_UPDATE_FOR_WS","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS=?,HOLD_PRACT_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), HOLD_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),LAST_ACTION_TYPE=?,LAST_ACTION_REASON_DESC=?,CAN_LINE_REASON=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=? WHERE ORDER_ID=? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_ORDER_UPDATE","UPDATE OR_ORDER SET ORDER_STATUS=?, MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=? WHERE ORDER_ID=? ");
        dataMap.put("SQL_PH_DISP_MEDICATION_ORDER_UPDATE1","UPDATE OR_ORDER SET ORDER_STATUS=?, MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=? WHERE ORDER_ID=? AND TO_CHAR(MODIFIED_DATE,'DDMMYYYYHH24MISS') = ?");   
		dataMap.put("SQL_PH_DISP_MEDICATION_PATIENT_DRUG_PROFILE_UPDATE","UPDATE PH_PATIENT_DRUG_PROFILE SET ON_HOLD_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ON_HOLD_BY_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), ON_HOLD_REASON_CODE=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?, ALT_DRUG_REMARKS=? WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_PATIENT_DRUG_PROFILE_UPDATE_FOR_WS","UPDATE PH_PATIENT_DRUG_PROFILE SET ON_HOLD_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ON_HOLD_BY_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), ON_HOLD_REASON_CODE=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=? WHERE PATIENT_ID=? AND ORIG_ORDER_ID=?  AND FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_PATIENT_DRUG_PROFILE_UPDATE_FOR_TPN_WS","update ph_patient_drug_profile set TOT_ISSUED_QTY=? where   PATIENT_ID=? AND ORIG_ORDER_ID=?  AND FACILITY_ID=?");
		//QUERY ADDED FOR UPDATING DRUG PROFILE DELIVERY AGAINST FILL LIST
		dataMap.put("SQL_PH_DISP_MEDICATION_PATIENT_DRUG_PROFILE_UPDATE_FOR_DEL_AF","UPDATE PH_PATIENT_DRUG_PROFILE SET TOT_ISSUED_QTY = (NVL(TOT_ISSUED_QTY,0) + (SELECT SUM(NVL(DISP_QTY,0))*(?) FROM ph_disp_dtl_tmp WHERE order_id=? AND ORDER_LINE_NO= ?)),DISPENSED_DRUGS= ?,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?, ALT_DRUG_REMARKS=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_DRUG_PROFILE","UPDATE PH_PATIENT_DRUG_PROFILE SET ALT_DRUG_REMARKS=?, MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_DISP_DTL_TMP_IP_UPDATE","UPDATE PH_DISP_DTL_TMP SET DOC_SRL_NO=? WHERE FACILITY_ID=? AND ORDER_ID=? AND DISP_DRUG_CODE= ?");
		dataMap.put("SQL_PH_DISP_BATCH_TMP_IP_UPDATE","UPDATE PH_DISP_DRUG_BATCH_TMP SET DOC_SRL_NO=? WHERE FACILITY_ID = ? AND ORDER_ID = ? AND ITEM_CODE = ? AND BATCH_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE1","UPDATE OR_ORDER_LINE_PH SET NEXT_COLLECTION_DATE=TO_DATE(?,'DD/MM/YYYY'),BMS_REASON_CODE=?, MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=? WHERE ORDER_ID=? AND ORDER_LINE_NUM IN(SELECT ORDER_LINE_NUM FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_STATUS='DP')");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE2","UPDATE PH_DISP_QUEUE SET VERIFY_DATE_TIME=SYSDATE,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL'");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE3","UPDATE PH_DISP_QUEUE SET FILL_DATE_TIME=SYSDATE,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL'");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE3A","UPDATE PH_DISP_QUEUE SET TOKEN_STATUS=?,FILL_DATE_TIME=SYSDATE,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL'");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE4","UPDATE PH_DISP_QUEUE SET ALLOCATE_DATE_TIME=SYSDATE,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL'");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE4A","UPDATE PH_DISP_QUEUE SET TOKEN_STATUS=?,ALLOCATE_DATE_TIME=SYSDATE,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL'");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE5","UPDATE PH_DISP_QUEUE SET DELIVER_DATE_TIME=SYSDATE,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?, TOKEN_STATUS ='DF' WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL' ");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE6","UPDATE PH_DISP_QUEUE SET VERIFY_DATE_TIME=SYSDATE,ALLOCATE_DATE_TIME=SYSDATE,FILL_DATE_TIME=SYSDATE,DELIVER_DATE_TIME=SYSDATE,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL'");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE7","UPDATE PH_DISP_QUEUE_SUMM SET TOT_VERIFIED=NVL(TOT_VERIFIED,0)+1,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE8","UPDATE PH_DISP_QUEUE_SUMM SET TOT_FILLED=NVL(TOT_FILLED,0)+1,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE9","UPDATE PH_DISP_QUEUE_SUMM SET TOT_ALLOCATED=NVL(TOT_ALLOCATED,0)+1,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE10","UPDATE PH_DISP_QUEUE_SUMM SET TOT_DELIVERED=NVL(TOT_DELIVERED,0)+1,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE11","UPDATE PH_DISP_QUEUE_SUMM SET TOT_VERIFIED=NVL(TOT_VERIFIED,0)+1,TOT_FILLED=NVL(TOT_FILLED,0)+1,TOT_ALLOCATED=NVL(TOT_ALLOCATED,0)+1,TOT_DELIVERED=NVL(TOT_DELIVERED,0)+1,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE12","UPDATE PH_PATIENT_DRUG_PROFILE SET TOT_ISSUED_QTY = (NVL(TOT_ISSUED_QTY,0) + ?),DISPENSED_DRUGS=?,MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		//dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE13","UPDATE OR_ORDER_LINE_PH SET DISPENSING_LOC_TYPE=?, DISPENSING_LOC=?, DISPENSING_STORE=?, DISPENSED_QTY=(NVL(DISPENSED_QTY,0)+?), BMS_QTY=(PRES_QTY_VALUE-(NVL(DISPENSED_QTY,0)+?)), BMS_STRENGTH=((TOT_STRENGTH)-((NVL(DISPENSED_QTY,0)+?)*STRENGTH_VALUE)),MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE13","UPDATE OR_ORDER_LINE_PH SET DISPENSING_LOC_TYPE=?, DISPENSING_LOC=?, DISPENSING_STORE=?,  DISPENSED_QTY=?, BMS_QTY=?,   BMS_STRENGTH= ( ? *STRENGTH_VALUE),MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,   MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE13A","UPDATE OR_ORDER_LINE_PH SET DISPENSING_LOC_TYPE=?, DISPENSING_LOC=?, DISPENSING_STORE=?,  DISPENSED_QTY=?, BMS_QTY=?,   BMS_STRENGTH= ( ? *STRENGTH_VALUE),LAST_DISPENSED_DATE	= SYSDATE , MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,   MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_UPDATE14","UPDATE PH_DISP_QUEUE SET TOKEN_STATUS=? WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND	TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND QUEUE_SHIFT='*ALL'");
		// Used in allocation independent stage
		dataMap.put("SQL_PH_DISP_MEDICATION_HRD_TMP_INSERT","INSERT INTO PH_DISP_HDR_TMP (DISP_TMP_NO, FACILITY_ID,DISP_LOCN_CODE,ORDER_ID,RECORD_DATE_TIME,FILL_PROC_ID,ORDERING_FACILITY_ID,ORD_DATE_TIME,PATIENT_ID,ENCOUNTER_ID,PATIENT_CLASS,LOCN_TYPE,LOCN_CODE,SPECIALITY_CODE,ATTEND_PRACTITIONER_ID,PRES_PHYSICIAN_ID,DISPENSED_DATE_TIME, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,FILLED_BY_NAME , DISPENSED_BY) VALUES(?,?,?,?,SYSDATE,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,?,?,?,sysdate,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_PH_DISP_MEDICATION_HRD_TMP_UPDATE","UPDATE PH_DISP_HDR_TMP SET DOC_TYPE=?, DOC_NO=? WHERE ORDER_ID = ? AND FACILITY_ID= ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_HRD_TMP_UPDATE_FILLEDBY","UPDATE PH_DISP_HDR_TMP SET FILLED_BY_NAME=?,DISPENSED_BY=? , DISPENSED_DATE_TIME=SYSDATE WHERE ORDER_ID = ? AND FACILITY_ID= ?"); // DISPENSED_BY and DISPENSED_DATE_TIME columns added for RUT-SCF-0274 IN039740
		dataMap.put("SQL_PH_DISP_MEDICATION_DTL_TMP_UPDATE_ALT_DRUG_REMARKS","UPDATE PH_DISP_DTL_TMP SET ALT_DRUG_REMARKS=?, MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NO=?"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_HRD_UPDATE","UPDATE PH_DISP_HDR SET DOC_TYPE=?, DOC_NO=? WHERE DISP_NO = ? AND FACILITY_ID= ?");
		dataMap.put("SQL_PH_DISP_MEDICATION_HRD_UPDATE1","UPDATE PH_DISP_HDR SET DOC_TYPE=?, DOC_NO=?,TOKEN_SERIES_CODE=?,TOKEN_SERIAL_NO=?,TOKEN_STATUS=? , disp_type='D' WHERE DISP_NO = ? AND FACILITY_ID= ?");
		dataMap.put("SQL_PH_DISP_MEDI_EDIT_INSTRUCTIONS","SELECT B.CAUTION_LABEL_TEXT_ID_1,B.CAUTION_LABEL_TEXT_ID_2, B.SPL_INSTR_LABEL_TEXT_ID,B.SPL_INSTR_LABEL_TEXT_ID1,B.HOW_TO_TAKE_TEXT,B.HOW_TO_TAKE_TEXT_LOCAL,B.DRUG_INDICATION FROM PH_DRUG_LANG_VW B, OR_ORDER_LINE C WHERE C.ORDER_CATALOG_CODE=? AND B.DRUG_CODE=? AND C.ORDER_ID=? AND C.ORDER_LINE_NUM=? AND B.LANGUAGE_ID = ?");//Added B.DRUG_INDICATION to display the AlternateDrugIndication in EditLabel
		dataMap.put("SQL_PH_DISP_MEDI_EDIT_INT_RESULTS","SELECT LABEL_TEXT_1, LABEL_TEXT_2, LABEL_TEXT_1_LOC_LANG, LABEL_TEXT_2_LOC_LANG FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE LABEL_TEXT_ID=? AND LANGUAGE_ID = ?");
		// Used in allocation independent stage
		dataMap.put("SQL_PH_DISP_MEDICATION_DISP_DTL_TMP_INSERT","INSERT INTO  PH_DISP_DTL_TMP (DISP_TMP_NO,DTL_SERIAL_NUM,RECORD_DATE_TIME,  FACILITY_ID,DISP_LOCN_CODE,ORDER_ID,ORDER_LINE_NO, PRES_DRUG_CODE, ORDERING_FACILITY_ID, DISP_DRUG_CODE,DISP_QTY,DISP_UOM_CODE,ADDED_BY_ID,ADDED_DATE ,ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE  ,MODIFIED_AT_WS_NO , MODIFIED_FACILITY_ID,DOC_SRL_NO,FILL_REMARKS_CODE,FILL_TASK_FINDING ,LABEL_CAU_INSTRN1_ENG,LABEL_CAU_INSTRN2_ENG,LABEL_SPL_INSTRN1_ENG,LABEL_SPL_INSTRN2_ENG,LABEL_PAT_INSTRN1_ENG,LABEL_CAU_INSTRN1_LOC,LABEL_CAU_INSTRN2_LOC,LABEL_SPL_INSTRN1_LOC,LABEL_SPL_INSTRN2_LOC,LABEL_PAT_INSTRN1_LOC,DELIVERY_REMARKS_CODE,DELIVERY_TASK_FINDING,ALLOCATE_REMARKS_CODE,ALLOCATE_TASK_FINDING,BL_INCL_EXCL_OVERRIDE_VALUE,BL_INCL_EXCL_OVERRIDE_REASON,PRES_REMARK_CODE,DRUG_INDICATION, ALT_DRUG_REMARKS,LABEL_BMS_REMARKS_ENG)VALUES  (?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");//Added DRUG_INDICATION for  ML-BRU-CRF-072[Inc:29938]//added for LABEL_BMS_REMARKS_ENG JD-CRF-0221
		dataMap.put("SQL_PH_DISP_MEDICATION_DISP_DTL_UPDATE" , "UPDATE PH_DISP_DTL SET DELIVERY_REMARKS_CODE=?,DELIVERY_TASK_FINDING = ? WHERE FACILITY_ID = ? AND DISP_NO = ? AND SRL_NO = ? ");
		// Used in allocation independent stage
		dataMap.put("SQL_PH_DISP_MEDICATION_DRUG_BATCH_TMP_INSERT","INSERT INTO PH_DISP_DRUG_BATCH_TMP( FACILITY_ID , DISP_LOCN_CODE,ORDER_ID,ORDER_LINE_NUM,RECORD_DATE_TIME,ITEM_CODE, BATCH_ID, EXPIRY_DATE, STORE_CODE, DISP_QTY, DRUG_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO , MODIFIED_FACILITY_ID,DISP_QTY_UOM,DOC_SRL_NO,BIN_LOCATION_CODE,TRADE_ID)VALUES(  ?,?,?,?,SYSDATE,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_DISP_MEDICATION_HRD_INSERT","INSERT INTO PH_DISP_HDR ( FACILITY_ID, DISP_NO, DISP_DATE_TIME, DISP_LOCN_CODE, ORDER_ID, ORD_DATE_TIME, PATIENT_ID, ENCOUNTER_ID, PATIENT_CLASS, LOCN_TYPE, LOCN_CODE, ROOM_TYPE, ROOM_NO, BED_NO, BED_CLASS, BED_TYPE, SPECIALITY_CODE, ATTEND_PRACTITIONER_ID, PRES_PHYSICIAN_ID, DISPENSED_BY, DISPENSED_DATE_TIME, AUTHORIZED_BY, DISP_AUTHORIZED_DATE_TIME, DELIVERED_YN, DELIVERED_BY, DELIVERED_DATE_TIME, COLLECTED_BY, RECEIVED_YN, RECEIVED_BY, RECEIVED_DATE_TIME, REF_DISP_NO_FOR_REISSUE, DISP_REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ,RECEIVED_AT, COUNTER_CHKD_BY)  VALUES ( ?,?,TRUNC(SYSDATE), ?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'), ?,?,?, ?,?,?, ?,?,?, ?,?,?, ?,?,SYSDATE, ?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?, TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?, ?,TO_DATE(?,'DD/MM/YYYY HH24:MI'), ?,?,?, SYSDATE,?,?, ?,SYSDATE,?, ?,?,? )");
		dataMap.put("SQL_PH_DISP_MEDICATION_HRD_INSERT1","INSERT INTO PH_DISP_HDR ( FACILITY_ID, DISP_NO, DISP_DATE_TIME, DISP_LOCN_CODE, ORDER_ID, ORD_DATE_TIME, PATIENT_ID, ENCOUNTER_ID, PATIENT_CLASS, LOCN_TYPE, LOCN_CODE, ROOM_TYPE, ROOM_NO, BED_NO, BED_CLASS, BED_TYPE, SPECIALITY_CODE, ATTEND_PRACTITIONER_ID, PRES_PHYSICIAN_ID, DISPENSED_BY, DISPENSED_DATE_TIME, AUTHORIZED_BY, DISP_AUTHORIZED_DATE_TIME, DELIVERED_YN, DELIVERED_BY, DELIVERED_DATE_TIME, COLLECTED_BY, RECEIVED_YN, RECEIVED_BY, RECEIVED_DATE_TIME, REF_DISP_NO_FOR_REISSUE, DISP_REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ,RECEIVED_AT, COUNTER_CHKD_BY,DOC_TYPE,DOC_NO,TOKEN_SERIES_CODE,TOKEN_SERIAL_NO,TOKEN_STATUS,DAILY_SEQ_NUM)  VALUES ( ?,?,TRUNC(SYSDATE), ?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'), ?,?,?, ?,?,?, ?,?,?, ?,?,?, ?,?,SYSDATE, ?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?, TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?, ?,TO_DATE(?,'DD/MM/YYYY HH24:MI'), ?,?,?, SYSDATE,?,?, ?,SYSDATE,?, ?,?,?,?,?,?,?,?,? )");
		dataMap.put("SQL_PH_DISP_MEDICATION_DISP_DTL_INSERT","INSERT INTO PH_DISP_DTL (FACILITY_ID, DISP_NO, SRL_NO, ORDER_ID, ORDER_LINE_NO, PRES_DRUG_CODE, ORDERING_FACILITY_ID, DISP_LOCN_CODE, STORE_CODE, DISP_DRUG_CODE, ITEM_CODE, STK_UOM_CODE, DISP_QTY, DISP_UOM_CODE, RETURNED_QTY, REISSUE_REASON_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, FILL_REMARKS_CODE,FILL_TASK_FINDING ,LABEL_CAU_INSTRN1_ENG,LABEL_CAU_INSTRN2_ENG,LABEL_SPL_INSTRN1_ENG,LABEL_SPL_INSTRN2_ENG,LABEL_PAT_INSTRN1_ENG,LABEL_CAU_INSTRN1_LOC,LABEL_CAU_INSTRN2_LOC,LABEL_SPL_INSTRN1_LOC,LABEL_SPL_INSTRN2_LOC,LABEL_PAT_INSTRN1_LOC,DELIVERY_REMARKS_CODE,DELIVERY_TASK_FINDING,ALLOCATE_REMARKS_CODE,ALLOCATE_TASK_FINDING,BL_INCL_EXCL_OVERRIDE_VALUE,BL_INCL_EXCL_OVERRIDE_REASON,PRES_REMARK_CODE)  VALUES ( ?,?, ?, ?, ? ,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?,?, SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
        dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_UPDATE","UPDATE OR_ORDER SET PERFORMING_DEPTLOC_CODE =?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=?");
	    dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_UPDATE1","UPDATE OR_ORDER SET PERFORMING_DEPTLOC_CODE =?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DTL_UPDATE","UPDATE PH_DISP_DTL SET RE_RTD_DISP_LOCN_CODE=? WHERE FACILITY_ID=? AND DISP_NO=?");
		dataMap.put("SQL_PH_DIR_DISP_MEDICATION_DTL_UPDATE","UPDATE PH_DISP_DTL SET RE_RTD_DISP_LOCN_CODE=? WHERE FACILITY_ID=? AND ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DRUG_BATCH_INSERT","INSERT INTO PH_DISP_DRUG_BATCH ( FACILITY_ID, DISP_NO, SRL_NO, SRL_NO_BATCH, DISP_LOCN_CODE, STORE_CODE, DRUG_CODE, ITEM_CODE, BATCH_ID, EXPIRY_DATE, DISP_QTY, RETURNED_QTY, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,BIN_LOCATION_CODE,TRADE_ID, DISP_QTY_UOM )  VALUES ( ?,?,?, ?,?,?, ?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?, ?, SYSDATE, ?, ?,?, SYSDATE,?,?,?,?, ?)");
		dataMap.put("SQL_PH_DISP_MEDICATION_DELETE1","DELETE FROM PH_DISP_DRUG_BATCH_TMP WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DELETE2","DELETE FROM PH_DISP_DTL_TMP WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DELETE3","DELETE FROM PH_DISP_HDR_TMP WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DELETE4","DELETE  FROM PH_WORKSHEET_HDR WHERE worksheet_id=? and facility_id =? and disp_locn =?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DELETE5","DELETE  FROM PH_WORKSHEET_DTL WHERE worksheet_id=? and facility_id =? and disp_locn =?");
		dataMap.put("SQL_PH_DISP_MEDICATION_ORDER_LINE_PH_UPDATE","UPDATE OR_ORDER_LINE_PH SET DISPENSING_LOC_TYPE = 'P', DISPENSING_LOC = ? , DISPENSING_STORE = ?,  DISPENSED_QTY=?,  BMS_QTY = ?, BMS_STRENGTH = ?,  LAST_DISPENSED_DATE = SYSDATE,  MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? ,  MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=? AND ORDER_LINE_NUM = ?");
		dataMap.put("SQL_PH_WORKSHEET_ITEM_SELECT","SELECT   a.order_line_num, a.drug_code, g.short_desc item_desc, NVL (qty_on_hand, 0) - NVL (committed_qty, 0) avail_qty, a.item_code, a.batch_id, a.disp_locn_code,TO_CHAR (a.expiry_date, 'DD/MM/YYYY') expiry_date, disp_qty, disp_qty_uom, order_id, order_line_num, b.bin_location_code, e.trade_id,(SELECT short_desc   FROM mm_bin_location_lang_vw mm_bin_location WHERE bin_location_code = b.bin_location_code AND b.store_code = store_code AND language_id = ?) bin_desc, f.drug_desc, g.manufacturer_id, (SELECT short_name FROM am_manufacturer_lang_vw am_manufacturer WHERE manufacturer_id = g.manufacturer_id AND language_id = ?) manufacturer_name,e.short_name trade_name, b.store_code FROM ph_disp_drug_batch_tmp a, st_item_batch b, (SELECT dflt_trade_id trade_id, dflt_trade_id short_name  FROM mm_parameter  UNION SELECT trade_id, short_name FROM am_trade_name_lang_vw WHERE language_id = ?) e, ph_drug_lang_vw f,  mm_item_lang_vw g WHERE g.item_code = a.item_code AND b.trade_id = e.trade_id  AND f.drug_code = a.drug_code  AND a.store_code = b.store_code AND a.item_code = b.item_code AND a.batch_id = b.batch_id   AND b.expiry_date_or_receipt_date = a.expiry_date AND order_id = ? AND f.language_id = ?  AND g.language_id = ? ORDER BY order_id, a.order_line_num ");


		dataMap.put("SQL_PH_WORKSHEET_HDR_INSERT","INSERT INTO PH_WORKSHEET_HDR(FACILITY_ID, DISP_LOCN, WORKSHEET_ID, MFG_UNIT, WS_PREP_BY, PREP_DATE_TIME, WS_TYPE, WS_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,BATCH_ID, EXPIRY_DATE, QTY_VOLUME, QTY_UOM,ORDER_ID,ADMIN_INSTRUCTION,FINALIZED_YN,ADMX_PREP_CHARGE_ITEM_CODE,ADMX_PREP_CHARGE_UNITS ) VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,TO_DATE(?,'DD/MM/YYYY hh24:mi'),?,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_WORKSHEET_BATCH_SELECT","SELECT   A.ITEM_CODE,  A.BATCH_ID,  TO_CHAR(A.EXPIRY_DATE,  'DD/MM/YYYY') EXPIRY_DATE  , DISP_QTY,  DISP_QTY_UOM,  ORDER_ID,  ORDER_LINE_NUM ,  B.BIN_LOCATION_CODE,   E.TRADE_ID ,   (SELECT short_Desc FROM mm_bin_location WHERE bin_location_code=b.bin_location_code   AND b.store_code=store_code) BIN_DESC FROM    PH_DISP_DRUG_BATCH_TMP A,   ST_ITEM_BATCH  B  , ST_ITEM_STORE C  ,  AM_TRADE_NAME E  WHERE    A.STORE_CODE=B.STORE_CODE  AND   A.ITEM_CODE=B.ITEM_CODE  AND   A.BATCH_ID=B.BATCH_ID  AND   B.EXPIRY_DATE_OR_RECEIPT_DATE=A.EXPIRY_DATE     AND   B.STORE_CODE=C.STORE_CODE AND   B.ITEM_CODE=C.ITEM_CODE     AND   B.TRADE_ID=E.TRADE_ID     AND  ORDER_ID=?  ORDER BY ORDER_ID,ORDER_LINE_NUM");
		dataMap.put("SQL_PH_WORKSHEET_DTL_INSERT","INSERT INTO PH_WORKSHEET_DTL(FACILITY_ID, DISP_LOCN, WORKSHEET_ID,WS_SRL_NO, ORDER_ID, ORDER_LINE_NUM, DISP_DRUG_CODE, PHYSICAL_FORM, DISP_DRUG_BASE_UNIT,SPIL_QTY_AVAIL, DISP_ITEM_CODE, STOCK_UNIT, QTY_USED_FROM_STOCK, USED_QTY, DISP_QTY_IN_STOCK_UNIT, BATCH_ID1, EXPIRY_DATE1, BIN_LOCATION_CODE1, TRADE_ID1,BATCH_ID2, EXPIRY_DATE2,BIN_LOCATION_CODE2, TRADE_ID2, BATCH_ID3, EXPIRY_DATE3,BIN_LOCATION_CODE3, TRADE_ID3, BAL_QTY, SAL_QTY, SAL_UNIT, 	ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_WS_DISP_MEDICATION_HRD_TMP_INSERT","INSERT INTO PH_DISP_HDR_TMP (DISP_TMP_NO, FACILITY_ID,DISP_LOCN_CODE,ORDER_ID,RECORD_DATE_TIME,FILL_PROC_ID,ORDERING_FACILITY_ID,ORD_DATE_TIME,PATIENT_ID,ENCOUNTER_ID,PATIENT_CLASS,LOCN_TYPE,LOCN_CODE,SPECIALITY_CODE,ATTEND_PRACTITIONER_ID,PRES_PHYSICIAN_ID,DISPENSED_DATE_TIME,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,WORKSHEET_ID) VALUES(?,?,?,?,SYSDATE,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?)");
		dataMap.put("SQL_PH_WORKSHEET_ID_COUNT","SELECT NVL(MAX(WORKSHEET_ID) + 1,1) WORKSHEET_ID FROM PH_WORKSHEET_HDR WHERE FACILITY_ID=? AND DISP_LOCN=?");
		dataMap.put("SQL_PH_WORKSHEET_SPILL_SELECT","SELECT ALLOW_USAGE_OF_SPIL_QTY_YN  FROM PH_DISP_LOCN_LANG_VW  WHERE  FACILITY_ID=? AND DISP_LOCN_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_WORKSHEET_STOCK_UOM","SELECT  CEIL(?/DECODE(CONTENT_IN_BASE_UOM,0,  1,  NVL(CONTENT_IN_BASE_UOM,  1)) ) STOCKQTY,  B.SALE_UOM_CODE STOCK_UOM FROM   PH_INV_ITEM_FOR_RECONST_FLUID A,ST_ITEM B WHERE A.ITEM_CODE=B.ITEM_CODE AND A.RF_ID=?");
		dataMap.put("SQL_PH_WORKSHEET_RF_NAME","SELECT RF_NAME FROM PH_RECONST_FLUID WHERE RF_ID=?");
		dataMap.put("SQL_PH_WORKSHEET_DRUG_NAME","SELECT DRUG_DESC  FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_WORKSHEET_SELECT1","SELECT IV_PREP_YN FROM OR_ORDER WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_WORKSHEET_SELECT2","SELECT A.MFG_UNIT ,a.BATCH_ID BATCH_ID, to_char(a.EXPIRY_DATE,'dd/mm/yyyy') EXPIRY_DATE FROM PH_WORKSHEET_HDR A,PH_WORKSHEET_DTL B WHERE A.WORKSHEET_ID =B.WORKSHEET_ID AND A.FACILITY_ID = B.FACILITY_ID AND A.DISP_LOCN   = B.DISP_LOCN AND B.ORDER_ID =? AND B.ORDER_LINE_NUM =? AND A.FACILITY_ID =?"); 
		dataMap.put("SQL_PH_WORKSHEET_TPN_HDR_INSERT","INSERT INTO PH_TPN_WORKSHEET_HDR(FACILITY_ID, DISP_LOCN_CODE, TPN_WORKSHEET_ID, MFG_UNIT, WS_PREP_BY, PREP_DATE_TIME, WS_TYPE, WS_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, BATCH_ID, EXPIRY_DATE, QTY_VOLUME, QTY_UOM,ORDER_ID,ADMIN_INSTRUCTION,FINALIZED_YN,INFUSION_LINE,OVERAGE_VOLUME,OVERAGE_VOLUME_UOM,OSMOLAR_VALUE,ADMX_PREP_CHARGE_ITEM_CODE,ADMX_PREP_CHARGE_UNITS,APPROVAL_NO) VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,TO_DATE(?,'DD/MM/YYYY hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?)");//approval_no added for AAKH-CRF-0117
		dataMap.put("SQL_PH_WORKSHEET_TPN_DTL_INSERT1","INSERT INTO PH_TPN_WORKSHEET_DTL(FACILITY_ID, DISP_LOCN, TPN_WORKSHEET_ID, CONST_GENERIC_CODE, WS_SRL_NO, ORDER_ID, ORDER_LINE_NUM, CONST_QTY, CONST_QTY_UNIT, DISP_ITEM_CODE, DISP_QTY, STOCK_UNIT, BATCH_ID1, EXPIRY_DATE1, BATCH1_QTY, BIN_LOCATION_CODE1, TRADE_ID1, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,DISP_QTY_UOM)Values(?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_WORKSHEET_TPN_DTL_INSERT","INSERT INTO PH_TPN_WORKSHEET_DTL(FACILITY_ID, DISP_LOCN, TPN_WORKSHEET_ID, CONST_GENERIC_CODE, WS_SRL_NO, ORDER_ID, ORDER_LINE_NUM, CONST_QTY, CONST_QTY_UNIT, DISP_ITEM_CODE, DISP_QTY, STOCK_UNIT, BATCH_ID1, EXPIRY_DATE1, BATCH1_QTY, BATCH_ID2, EXPIRY_DATE2, BATCH2_QTY, BATCH_ID3, EXPIRY_DATE3, BATCH3_QTY, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, BIN_LOCATION_CODE1, TRADE_ID1, BIN_LOCATION_CODE2, TRADE_ID2, BIN_LOCATION_CODE3, TRADE_ID3) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_TPN_WORKSHEET_ID_COUNT","SELECT   NVL(MAX(TPN_WORKSHEET_ID) + 1,  1) WORKSHEET_ID FROM   PH_TPN_WORKSHEET_HDR WHERE   FACILITY_ID=? AND  DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_HDR_COUNT","SELECT COUNT(*) COUNT FROM PH_DISP_HDR_TMP WHERE ORDER_ID= ?");
		//added by karabi...
		dataMap.put("SQL_PH_DISP_MEDICATION_DTL_COUNT","SELECT TPN_WORKSHEET_ID FROM PH_TPN_WORKSHEET_DTL WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DTL_DELETE1","DELETE FROM PH_TPN_WORKSHEET_DTL WHERE FACILITY_ID=? AND DISP_LOCN=? AND TPN_WORKSHEET_ID=? AND ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_HDR_DELETE1","DELETE FROM PH_TPN_WORKSHEET_HDR WHERE  TPN_WORKSHEET_ID=? AND FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_TPN_WORKSHEET_DTL_DELETE","DELETE FROM PH_TPN_WORKSHEET_DTL WHERE FACILITY_ID=? AND DISP_LOCN=? AND TPN_WORKSHEET_ID=? AND CONST_GENERIC_CODE=? WS_SRL_NO=?");
		dataMap.put("SQL_PH_PH_TPN_WORKSHEET_HDR_DELETE","DELETE FROM PH_TPN_WORKSHEET_HDR WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND TPN_WORKSHEET_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DFLT_LANG","SELECT DFLT_LANG_FOR_DISP_LABEL,DFLT_LANG_FOR_DISP_LABEL_IP FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_DFLT_LANG1","SELECT DECODE(A.NATIONALITY_CODE,B.CITIZEN_NATIONALITY_CODE,'L','E') LOCAL_YN FROM MP_PATIENT A, MP_PARAM B WHERE A.PATIENT_ID = ? AND EXISTS (SELECT count(*) from sm_language WHERE EFF_STATUS='E' having Count(*) > 1 group by EFF_STATUS)");
		dataMap.put("SQL_PH_WORKSHEET_UPDATE1","UPDATE PH_TPN_WORKSHEET_HDR SET DOC_TYPE=?, DOC_NO=? WHERE DISP_LOCN_CODE = ? AND FACILITY_ID= ? AND TPN_WORKSHEET_ID=?");
		dataMap.put("SQL_PH_TPN_WORKSHEET_HDR_SELECT","select doc_no,doc_type from PH_TPN_WORKSHEET_HDR where TPN_WORKSHEET_ID=? and FACILITY_ID=? and DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_TPN_WORKSHEET_DRUG_DTL_SELECT","select disp_item_code,disp_locn,WS_SRL_NO,batch_id1,to_char(EXPIRY_DATE1,'dd/mm/yyyy') EXPIRY_DATE,CEIL(disp_qty) DISP_QTY,stock_unit,bin_location_code1,TRADE_ID1,batch1_qty from PH_TPN_WORKSHEET_DTL where  ORDER_ID=? and ORDER_LINE_NUM=? ");

		dataMap.put("SQL_PH_DISP_MEDICATION_DISPENSING_RIGHTS_SELECT","SELECT DFLT_IP_FILL, DFLT_IP_DELIVER FROM PH_DISP_RIGHTS WHERE facility_id= ? AND appl_user_id= ? AND disp_locn_code = ? ");	

		//End Dispensing Medication

		dataMap.put("SQL_PH_FILL_PROCESS_SELECT1", "SELECT DISTINCT A.FILL_PROC_ID FROM PH_FILL_PROCESS_PARAM A,PH_DISP_HDR_TMP B WHERE PROC_TYPE=?  AND A.FILL_PROC_ID=B.FILL_PROC_ID AND TRUNC(FILL_PROC_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY')");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT2", "SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY') SYS_DATE from dual");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT3","SELECT DISP_TMP_NO,ORDER_ID,PATIENT_ID,ENCOUNTER_ID FROM PH_DISP_HDR_TMP WHERE FILL_PROC_ID=? AND FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT4","SELECT DTL_SERIAL_NUM,DISP_DRUG_CODE,DISP_QTY,DISP_UOM_CODE,DISP_LOCN_CODE FROM PH_DISP_DTL_TMP WHERE DISP_TMP_NO=? AND ORDER_ID=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT5","SELECT A.ITEM_CODE,A.STORE_CODE,A.BATCH_ID,TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,A.DISP_QTY,B.BIN_LOCATION_CODE,B.TRADE_ID FROM PH_DISP_DRUG_BATCH_TMP A, ST_ITEM_BATCH B WHERE A.ITEM_CODE=B.ITEM_CODE AND A.STORE_CODE=B.STORE_CODE AND A.BATCH_ID = B.BATCH_ID AND A.DRUG_CODE=? AND A.FACILITY_ID=? AND A.STORE_CODE=? AND A.ORDER_ID=? ");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT6","SELECT LAST_FILL_PROC_ID FROM PH_LAST_FILL_INT_DTL WHERE NURSING_UNIT_CODE = ? AND TRUNC(FILL_INT_START_DATE_TIME) = TRUNC(SYSDATE) ");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT7","SELECT ORDER_ID FROM OR_ORDER_LINE_PH WHERE FILL_PROC_ID =?");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT7A","SELECT a.ORDER_ID order_id FROM OR_ORDER_LINE_PH a, or_order b WHERE a.order_id = b.order_id AND b.source_code =? AND FILL_PROC_ID =?");
		dataMap.put("SQL_PH_FILL_PROCESS_SELECT8","SELECT MIN(DISP_TMP_NO) FRMDSP, MAX(DISP_TMP_NO) TODSP FROM PH_DISP_DTL_TMP ");


		//Start Direct Dispensing....
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT1", "SELECT DISP_LOCN_CATEGORY FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT2","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY') TODAY FROM DUAL");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT3","SELECT PATIENT_NAME,DECODE(SEX,'M','male','F','female') SEX ,GET_AGE(DATE_OF_BIRTH) AGE FROM MP_PATIENT WHERE PATIENT_ID=?");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT4","SELECT FACILITY_ID,FACILITY_NAME FROM SM_FACILITY_PARAM");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT5","SELECT FREQ_CODE FROM OR_FREQUENCY_SCOPE WHERE ORDER_CATEGORY='PH'");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT6","SELECT CLINIC_CODE,SHORT_DESC FROM OP_CLINIC WHERE FACILITY_ID=? AND EFF_STATUS='E'");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT7","SELECT NURSING_UNIT_CODE,SHORT_DESC FROM IP_NURSING_UNIT WHERE FACILITY_ID=? AND EFF_STATUS='E'");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT8","SELECT A.FORM_CODE,B.FORM_DESC, A.STRENGTH_VALUE,A.PRES_BASE_UOM, D.SHORT_DESC,E.ROUTE_DESC,A.DISP_MULTI_STRENGTH_YN FROM PH_DRUG A, PH_FORM B, PH_GENERIC_NAME C, AM_UOM D,PH_ROUTE E,PH_PARAM F WHERE A.FORM_CODE = B.FORM_CODE(+)  AND A.GENERIC_ID = C.GENERIC_ID(+) AND A.PRES_BASE_UOM = D.UOM_CODE (+) AND E.ROUTE_CODE = A.ROUTE_CODE AND DRUG_CODE=? AND A.DISP_MULTI_STRENGTH_YN=F.DISP_MULTI_STRENGTH_YN(+)");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT9","SELECT COUNT(ROWID) COUNT FROM SM_MODULE WHERE MODULE_ID='ST' AND INSTALL_YN='Y'");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT10","SELECT DURN_TYPE, DURN_DESC FROM AM_DURATION_TYPE");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT11","SELECT APPL_USER_NAME  FROM SM_APPL_USER_LANG_VW SM_APPL_USER WHERE APPL_user_id =? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT12","SELECT APP_PASSWORD.DECRYPT(A.DISP_PASSWORD) PASSWORD FROM PH_DISP_USERS A WHERE A.APPL_USER_ID=?");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT13","SELECT STORE_CODE FROM PH_DISP_LOCN WHERE DISP_LOCN_CODE=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_DIRECT_DISPENSING_SELECT14","select count(*) total from st_item_store where item_code=? and store_code =? and phy_inv_id IS NOT NULL");
		//end of Direct Dispensing....

		dataMap.put("SQL_PH_ATCL3_SQLDATA", "SELECT ATC_CLASS_LEV1_CODE,ATC_CLASS_LEV2_CODE,ATC_CLASS_LEV3_CODE,ATC_CLASS_LEV3_DESC FROM PH_ATC_CLASS_LEV3 WHERE ATC_CLASS_LEV1_CODE LIKE UPPER(?) AND ATC_CLASS_LEV2_CODE LIKE UPPER(?) AND ATC_CLASS_LEV3_CODE LIKE UPPER(?) AND ATC_CLASS_LEV3_DESC LIKE UPPER(?) ");
		dataMap.put("SQL_PH_ATCL3_MODIFY", "SELECT A.ATC_CLASS_LEV1_DESC, B.ATC_CLASS_LEV2_DESC, C.ATC_CLASS_LEV3_DESC, C.DISPLAY_SEQ_NO FROM PH_ATC_CLASS_LEV1 A, PH_ATC_CLASS_LEV2 B, PH_ATC_CLASS_LEV3 C WHERE A.ATC_CLASS_LEV1_CODE = C.ATC_CLASS_LEV1_CODE AND B.ATC_CLASS_LEV2_CODE = C.ATC_CLASS_LEV2_CODE AND C.ATC_CLASS_LEV1_CODE=? AND C.ATC_CLASS_LEV2_CODE=? AND C.ATC_CLASS_LEV3_CODE=? ");
        dataMap.put("SQL_PH_REPORTS_DISP_SELECT1",		"select DISP_LOCN_CODE,LONG_DESC from PH_disp_locn_lang_vw PH_disp_locn where DISP_LOCN_CATEGORY in ('B','O') and language_id = ?");
		dataMap.put("SQL_PH_REPORTS_DISP_SELECT2",		"select DISP_LOCN_CODE,LONG_DESC from PH_disp_locn_lang_vw PH_disp_locn where DISP_LOCN_CATEGORY in ('I','B') and language_id = ?");
		dataMap.put("SQL_PH_REPORTS_DISP_SELECT3", "select DISP_LOCN_CODE,SHORT_DESC from PH_disp_locn_lang_vw PH_disp_locn where DISP_LOCN_TYPE='P' and FACILITY_ID=? and language_id = ?");
        dataMap.put("SQL_PH_REPORTS_DISP_TIME_SELECT",	"select to_char(WORKING_HOURS_FROM,'hh24:mi') WORKING_HOURS_FROM,to_char(WORKING_HOURS_TO,'hh24:mi') WORKING_HOURS_TO from ph_disp_locn where FACILITY_ID=? and DISP_LOCN_CODE=?");
		//PH Reports - Master Code List Start
		dataMap.put("SQL_PH_REPORTS_MASTER_LIST",		"SELECT MASTER_CODE, MASTER_CODE_DESC FROM SM_MASTER_CODE_LANG_VW SM_MASTER_CODE WHERE MODULE_ID='PH' AND LANGUAGE_ID =?");
		dataMap.put("SQL_PH_REPORTS_FORM_LOOKUP",		"SELECT FORM_CODE CODE, FORM_DESC DESCRIPTION FROM PH_FORM_LANG_VW PH_FORM WHERE UPPER(FORM_CODE) LIKE UPPER(?) AND UPPER(FORM_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_DRUG_LOOKUP",		"SELECT DRUG_CODE CODE, DRUG_DESC DESCRIPTION FROM PH_DRUG_LANG_VW PH_DRUG WHERE UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_ROUTE_LOOKUP",		"SELECT ROUTE_CODE CODE, ROUTE_DESC DESCRIPTION FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE UPPER(ROUTE_CODE) LIKE UPPER(?) AND UPPER(ROUTE_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_DRCTG_LOOKUP",		"SELECT DRUG_CATG_CODE CODE, SHORT_DESC DESCRIPTION FROM PH_DRUG_CATG_LANG_VW PH_DRUG_CATG WHERE UPPER(DRUG_CATG_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_GENID_LOOKUP",		"SELECT GENERIC_ID CODE, GENERIC_NAME DESCRIPTION FROM PH_GENERIC_NAME_LANG_VW PH_GENERIC_NAME WHERE UPPER(GENERIC_ID) LIKE UPPER(?) AND UPPER(GENERIC_NAME) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_AGEDRP_LOOKUP",		"SELECT AGE_GROUP_CODE CODE, SHORT_DESC DESCRIPTION FROM AM_AGE_GROUP_LANG_VW AM_AGE_GROUP WHERE UPPER(AGE_GROUP_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_SCHED_LOOKUP",		"SELECT SCHEDULE_ID CODE, SCHEDULE_DESC DESCRIPTION FROM PH_DRUG_SCHEDULE_LANG_VW PH_DRUG_SCHEDULE WHERE UPPER(SCHEDULE_ID) LIKE UPPER(?) AND UPPER(SCHEDULE_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_SERVICE_LOOKUP",	"SELECT SERVICE_CODE CODE, SHORT_DESC DESCRIPTION FROM AM_SERVICE_LANG_VW AM_SERVICE WHERE UPPER(SERVICE_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_ORDER_LOOKUP",		"SELECT ORDER_TYPE_CODE CODE, SHORT_DESC DESCRIPTION FROM OR_ORDER_TYPE_LANG_VW OR_ORDER_TYPE WHERE ORDER_CATEGORY='PH' AND UPPER(ORDER_TYPE_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_REMARK_LOOKUP",		"SELECT REMARK_CODE CODE, REMARK_DESC DESCRIPTION FROM PH_PRES_REMARK_LANG_VW PH_PRES_REMARK WHERE UPPER(REMARK_CODE) LIKE UPPER(?) AND UPPER(REMARK_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_ATC1_LOOKUP",		"SELECT ATC_CLASS_LEV1_CODE CODE, ATC_CLASS_LEV1_DESC DESCRIPTION FROM PH_ATC_CLASS_LEV1_LANG_VW PH_ATC_CLASS_LEV1 WHERE UPPER(ATC_CLASS_LEV1_CODE) LIKE UPPER(?) AND UPPER(ATC_CLASS_LEV1_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_ATC2_LOOKUP",		"SELECT ATC_CLASS_LEV2_CODE CODE, ATC_CLASS_LEV2_DESC DESCRIPTION FROM PH_ATC_CLASS_LEV2_LANG_VW PH_ATC_CLASS_LEV2 WHERE UPPER(ATC_CLASS_LEV2_CODE) LIKE UPPER(?) AND UPPER(ATC_CLASS_LEV2_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_ATC3_LOOKUP",		"SELECT ATC_CLASS_LEV3_CODE CODE, ATC_CLASS_LEV3_DESC DESCRIPTION FROM PH_ATC_CLASS_LEV3_LANG_VW PH_ATC_CLASS_LEV3 WHERE UPPER(ATC_CLASS_LEV3_CODE) LIKE UPPER(?) AND UPPER(ATC_CLASS_LEV3_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_ATC4_LOOKUP",		"SELECT ATC_CLASS_LEV4_CODE CODE, ATC_CLASS_LEV4_DESC DESCRIPTION FROM PH_ATC_CLASS_LEV4_LANG_VW PH_ATC_CLASS_LEV4 WHERE UPPER(ATC_CLASS_LEV4_CODE) LIKE UPPER(?) AND UPPER(ATC_CLASS_LEV4_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_ATC5_LOOKUP",		"SELECT ATC_CLASS_LEV5_CODE CODE, ATC_CLASS_LEV5_DESC DESCRIPTION FROM PH_ATC_CLASS_LEV5_LANG_VW PH_ATC_CLASS_LEV5 WHERE UPPER(ATC_CLASS_LEV5_CODE) LIKE UPPER(?) AND UPPER(ATC_CLASS_LEV5_DESC) LIKE UPPER(?) AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_MFR_LOOKUP",		"SELECT MANUFACTURER_ID CODE, SHORT_NAME DESCRIPTION FROM AM_MANUFACTURER WHERE UPPER(MANUFACTURER_ID) LIKE UPPER(?) AND UPPER(SHORT_NAME) LIKE UPPER(?) ORDER BY 1");
		dataMap.put("SQL_PH_REPORTS_NURSUNIT_LOOKUP",	"SELECT DISTINCT NURSING_UNIT_CODE CODE, LONG_DESC DESCRIPTION FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT  , ph_disp_hdr_tmp B WHERE IP_NURSING_UNIT.nursing_unit_code = b.locn_code AND EFF_STATUS='E' AND UPPER(IP_NURSING_UNIT.FACILITY_ID) LIKE UPPER(?) AND FILL_PROC_ID = ? AND UPPER(NURSING_UNIT_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?)  AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_REPORTS_REF_PRESC_SELECT",	" SELECT a.ref_facility_id ref_facility_id, a.ref_date_time ref_date_time, a.ref_date_time ord_date, a.ref_sent_pract_id ref_sent_pract_id, a.ref_sent_remarks ref_sent_remarks, a.order_id order_id, b.disp_no disp_no, (select short_desc from ph_disp_locn_lang_vw where disp_locn_code = a.performing_deptloc_code AND language_id = ? and facility_id = b.facility_id) disp_locn_desc FROM or_order a, ph_disp_hdr b WHERE a.order_id = b.order_id(+)  AND a.patient_id = ? AND a.ref_facility_id IS NOT NULL ");
		dataMap.put("SQL_PH_REPORTS_BCP_NURSINGUNIT_LOOKUP","SELECT NURSING_UNIT_CODE Code,SHORT_DESC Description FROM IP_NURSING_UNIT_LANG_VW WHERE FACILITY_ID LIKE UPPER(?) AND UPPER(NURSING_UNIT_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?)  AND EFF_STATUS='E' and language_id= ");//added for HSA-CRF-0284 [IN:053276]
		dataMap.put("SQL_PH_REPORTS_BCP_LOCATION_LOOKUP","SELECT clinic_code Code, short_desc Description FROM op_clinic_lang_vw where facility_id LIKE UPPER(?) AND UPPER (clinic_code) LIKE UPPER (?) AND UPPER (short_desc) LIKE UPPER (?) AND eff_status = 'E' and language_id= ");//added for HSA-CRF-0284 [IN:053276]
		dataMap.put("SQL_PH_SELECT_PATIENT_ID_FOR_DOC_NO","SELECT distinct(PATIENT_ID) PATIENT_ID FROM PH_DISP_HDR WHERE  doc_no=?");
		dataMap.put("SQL_PH_SELECT_PATIENT_ID_FOR_DOC_NO_TMP","SELECT distinct(PATIENT_ID)  PATIENT_ID FROM PH_DISP_HDR_TMP WHERE  doc_no=?");
		//PH Reports - Master Code List End

		/*Workstation for Token Series*/		
		dataMap.put("SQL_WS_TS_SELECT_TOKEN_WS", "SELECT  TOKEN_SERIES_CODE FROM PH_WS_FOR_TOKEN_SERIES  WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND WS_NO=?");
		dataMap.put("SQL_WS_TS_SELECT_WORK_STN", "SELECT WS_NO FROM PH_WS_NO_FOR_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_WS_TS_SELECT_DISP_LOCN", "SELECT DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE EFF_STATUS='E' AND FACILITY_ID=? AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_WS_TS_SELECT_TOKEN_SERIES", "SELECT TOKEN_SERIES_CODE, DESCRIPTION FROM PH_TOKEN_SERIES_LANG_VW PH_TOKEN_SERIES WHERE EFF_STATUS='E' AND FACILITY_ID=? AND DISP_LOCN_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_WS_TS_SELECT", "SELECT A.DISP_LOCN_CODE, B.SHORT_DESC, A.TOKEN_SERIES_CODE, C.DESCRIPTION, A.WS_NO,  A.DEFAULT_TOKEN_YN  FROM PH_WS_FOR_TOKEN_SERIES A, PH_DISP_LOCN_LANG_VW B, PH_TOKEN_SERIES_LANG_VW C WHERE A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND B.DISP_LOCN_CODE=C.DISP_LOCN_CODE AND A.TOKEN_SERIES_CODE=C.TOKEN_SERIES_CODE AND A.DISP_LOCN_CODE LIKE UPPER(?) AND UPPER(B.SHORT_DESC) LIKE UPPER(?) AND A.TOKEN_SERIES_CODE LIKE UPPER(?) AND UPPER(C.DESCRIPTION) LIKE UPPER(?) AND UPPER(A.WS_NO) LIKE UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_WS_TS_INSERT", "INSERT INTO PH_WS_FOR_TOKEN_SERIES(FACILITY_ID, DISP_LOCN_CODE, TOKEN_SERIES_CODE, WS_NO, default_token_yn, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?, ?, ?, ?,?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_WS_TS_UPDATE", "UPDATE PH_WS_FOR_TOKEN_SERIES SET TOKEN_SERIES_CODE=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE WS_NO=? AND DISP_LOCN_CODE=? AND FACILITY_ID=?");
		dataMap.put("SQL_WS_TS_DELETE", "DELETE PH_WS_FOR_TOKEN_SERIES WHERE WS_NO=? AND DISP_LOCN_CODE=? AND FACILITY_ID=?");
		dataMap.put("JNDI_WS_TS", "java:comp/env/WsTokenSeries");
		/*Workstation for Token Series*/

		/* For IP fill */
		dataMap.put("SQL_PH_NURSINGUNIT_LOOKUP", "SELECT A.NURSING_UNIT_CODE code,SHORT_DESC description FROM IP_NURSING_UNIT_LANG_VW A WHERE  A.FACILITY_ID LIKE ?  AND upper(NURSING_UNIT_CODE) LIKE upper(?) AND SHORT_DESC LIKE ? AND EFF_STATUS='E' and a.language_id= ");
		dataMap.put("SQL_PH_TRANS_BUILDING_SELECT", "SELECT DISTINCT I.bldng_code BLDNG_CODE, c.SHORT_DESC FROM ip_nursing_unit_location i, IP_NURSING_UNIT_LANG_VW A, PH_ORDER_ROUTING B, AM_BLDNG_LANG_VW c WHERE A.NURSING_UNIT_CODE=B.ORDERING_SOURCE_CODE  AND A.FACILITY_ID LIKE ? AND A.EFF_STATUS='E' AND B.ORDERING_SOURCE_TYPE='N' AND I.NURSING_UNIT_CODE=A.NURSING_UNIT_CODE AND B.RTN_ORD_DISP_LOCN_CODE = ? AND A.LANGUAGE_ID = ? and i.BLDNG_CODE = c.BLDNG_CODE  and i.FACILITY_ID = c.OPERATING_FACILITY_ID and a.LANGUAGE_ID = c.LANGUAGE_ID order  by upper(c.short_desc) ");
		dataMap.put("SQL_PH_TRANS_FLOOR_SELECT", "SELECT FLOOR_CODE,SHORT_DESC FROM AM_BLDNG_FLOOR_lang_vw WHERE OPERATING_FACILITY_ID=? AND EFF_STATUS='E' AND BLDNG_CODE=? and language_id =? order by upper(short_desc)");
		dataMap.put("SQL_PH_FILLPERIOD_SELECT","SELECT   NVL(IP_FILL_PRD_AHEAD,0)		IP_FILL_PRD_AHEAD, NVL(IP_FILL_PRD_UNIT, 'H') IP_FILL_PRD_UNIT,		NVL(IP_FILL_EXCL_PRD_BEHIND,0)  IP_FILL_EXCL_PRD_BEHIND,TO_CHAR(SYSDATE,			'DD/MM/YYYY')||' '||TO_CHAR (IP_FILL_DFLT_START_TIME,'HH24:MI') SCHEDULE_START_TIME,TO_CHAR(SYSDATE,'DD') cdate, TO_CHAR(SYSDATE,'MM') cmonth,		TO_CHAR(SYSDATE,'YYYY') cyear, TO_CHAR(ip_fill_dflt_start_time, 'HH24') chours,	  TO_CHAR(ip_fill_dflt_start_time,'MI') cminutes, NVL(IP_FILL_ALLOCATE_BATHCES_YN,'N') IP_FILL_ALLOCATE_BATHCES_YN,TO_CHAR(TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY')||' '||TO_CHAR (IP_FILL_DFLT_START_TIME,'HH24:MI'),'dd/mm/yyyy hh24:mi')-(1/24)*NVL(ip_fill_Excl_prd_behind,  0),'dd/mm/yyyy hh24:mi') inc_start_date, TO_CHAR(TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY')||' '||TO_CHAR (IP_FILL_DFLT_START_TIME,'HH24:MI'),'dd/mm/yyyy hh24:mi'), 'dd/mm/yyyy hh24:mi') routine_start_date, TO_CHAR(TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY')||' '||TO_CHAR (IP_FILL_DFLT_START_TIME,'HH24:MI'),'dd/mm/yyyy hh24:mi')+DECODE(ip_fill_prd_unit,'D',  NVL(IP_FILL_PRD_AHEAD,0), 1/24*NVL(IP_FILL_PRD_AHEAD,0)),  'dd/mm/yyyy hh24:mi') routine_end_date , TO_CHAR(SYSDATE,'DD/MM/YYYY hh24:mi') inc_end_date		FROM  PH_DISP_LOCN WHERE  FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_FILLPERIOD_SELECT1", "  SELECT   TO_CHAR(TO_DATE(TO_CHAR(SYSDATE,   'DD/MM/YYYY')||' '||TO_CHAR (IP_FILL_DFLT_START_TIME,   'HH24:MI'),   'dd/mm/yyyy hh24:mi')-(1/24)*NVL(b.ip_fill_Excl_prd_behind,    0),   'dd/mm/yyyy hh24:mi') inc_start_date,   TO_CHAR(TO_DATE(TO_CHAR(SYSDATE,   'DD/MM/YYYY')||' '||TO_CHAR (IP_FILL_DFLT_START_TIME,   'HH24:MI'),   'dd/mm/yyyy hh24:mi')-(1/24)*NVL(b.ip_fill_Excl_prd_behind,   0)+   DECODE(b.ip_fill_prd_unit,   'D',   NVL(IP_FILL_PRD_AHEAD,   0),   1/24*NVL(IP_FILL_PRD_AHEAD,   0)),   'dd/mm/yyyy hh24:mi') inc_end_date  FROM PH_FILL_PROCESS_PARAM a,ph_disp_locn b WHERE a.FACILITY_ID=?    AND  a.DISP_LOCN_CODE=?    AND a.disp_locn_code=b.disp_locn_code   AND TO_CHAR(TRUNC(a.SCHEDULE_START),'dd/mm/yyyy')=TO_CHAR(TRUNC(TO_DATE(?,'dd/mm/yyyy hh24:mi')),'dd/mm/yyyy') AND a.proc_type='R' ");
		dataMap.put("SQL_PH_CURRTIME_SELECT","SELECT TO_CHAR(SYSDATE,'HH24') currenthrs, TO_CHAR(SYSDATE,'MI') currentmis FROM dual");
		dataMap.put("SQL_PH_ENDTIME_SELECT","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YY HH24:MI')+ DECODE(?,'D',?,1/24*?),'DD/MM/YY HH24:MI') ENDDATE FROM DUAL");
		dataMap.put("SQL_PH_FILLPARAM_INSERT","INSERT INTO PH_FILL_PROCESS_PARAM(FILL_PROC_ID, IV_DRUG_IND,COMPOUND_DRUG_IND,  IP_EXCL_INTERMITTENT_FILL,NURSING_UNIT_OR_LOCN,NURSING_UNIT_FROM,NURSING_UNIT_TO,        BUILDING_CODE,FLOOR_CODE,PROC_TYPE,SCHEDULE_START ,IP_FILL_PERIOD_AHEAD , 	 IP_FILL_PRD_UNIT,IP_FILL_EXCL_PRD_BEHIND ,ORDER_BY_FOR_LIST , FACILITY_ID  	 ,DISP_LOCN_CODE ,USER_ID,FILL_PROC_DATE_TIME,    FILL_INT_START_DATE_TIME 	  ,FILL_INT_END_DATE_TIME,CUT_OFF_LIMIT_FOR_NEW_ORD, FILL_PROC_STATUS , 	  ADDED_BY_ID ,ADDED_DATE,ADDED_AT_WS_NO ,ADDED_FACILITY_ID , 	  MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) 	  VALUES(?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy hh24:mi'),?,?,?,?, ?,?,?, sysdate,TO_DATE(?,'dd/mm/yyyy  hh24:mi'),TO_DATE(?,'dd/mm/yyyy  hh24:mi'),TO_DATE(?,'hh24:mi'),?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_FILLPARAM_SEQUENCE"," select PH_FILL_PROC_ID.NEXTVAL SEQNO from dual");
		/* End of IP Fill SQL */

		dataMap.put("SQL_PH_PHARM_SELECT", "SELECT A.PRACT_TYPE FROM AM_PRACTITIONER A,SM_APPL_USER B WHERE A.PRACTITIONER_ID=B.FUNC_ROLE_ID AND A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND APPL_USER_ID=?");		
		dataMap.put("SQL_PH_DISPLOCN_SELECT", "SELECT A.DISP_LOCN_CODE,C.SHORT_DESC DISP_DESC FROM PH_WS_NO_FOR_DISP_LOCN A,PH_DISP_RIGHTS B,PH_DISP_LOCN_LANG_VW C  WHERE A.FACILITY_ID=? AND A.FACILITY_ID=B.FACILITY_ID  AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE  AND WS_NO=? AND A.DISP_LOCN_CODE=C.DISP_LOCN_CODE  AND A.FACILITY_ID=C.FACILITY_ID AND APPL_USER_ID =? AND C.DISP_LOCN_CATEGORY<>'O' AND C.DISP_LOCN_TYPE='P' AND C.LANGUAGE_ID = ? ORDER BY 2");
		//End of IP Fill

		dataMap.put("SQL_PH_DISP_RIGHT", "SELECT FILL_YN FROM PH_DISP_RIGHTS WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND APPL_USER_ID=?");
		dataMap.put("SQL_PH_ALLOCATE_SETUP", "SELECT IP_FILL_ALLOCATE_BATHCES_YN FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT1", "SELECT 1 FROM SM_MODULE WHERE MODULE_ID='ST' AND INSTALL_YN='Y'");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT2", "SELECT RF_ID , RF_NAME FROM PH_RECONST_FLUID_LANG_VW PH_RECONST_FLUID WHERE upper(RF_NAME) LIKE UPPER(?) AND upper(RF_ID) LIKE UPPER(?) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT3", "SELECT UOM_CODE, SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE QTY_UOM_YN = 'Y' AND EFF_STATUS = 'E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT4", "SELECT A.ITEM_CODE code,  B.LONG_DESC description FROM   ST_ITEM A,  MM_ITEM B WHERE B.ITEM_CODE=A.ITEM_CODE AND  A.ITEM_CODE LIKE UPPER(?) AND   B.LONG_DESC LIKE UPPER(?) AND A.ITEM_CODE IN (SELECT ITEM_CODE FROM PH_DRUG WHERE PHYSICAL_FORM='L' AND APPL_TO_RECONST_FLUID_YN='Y')  ORDER BY 2");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT5", "SELECT ITEM_CODE, PRES_BASE_UOM FROM  PH_DRUG WHERE DRUG_CODE = UPPER(?) AND IV_FLUID_YN='Y' AND DISCONTINUED_YN = 'N' ");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT6", "SELECT RF_ID , RF_NAME, RF_BASE_UOM FROM PH_RECONST_FLUID_LANG_VW PH_RECONST_FLUID WHERE RF_ID = ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT7", "SELECT A.ITEM_CODE,A.CONTENT_IN_BASE_UOM,B.LONG_DESC FROM PH_INV_ITEM_FOR_RECONST_FLUID A,MM_ITEM_LANG_VW B WHERE A.rf_id = ? AND A.ITEM_CODE=B.ITEM_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT8", "SELECT UOM_CODE,EQVL_UOM_CODE,EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE = ? AND EQVL_UOM_CODE = ?  ");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_SELECT9", "SELECT COUNT(*) RFCOUNT FROM PH_RECONST_FLUID WHERE RF_ID=UPPER(?)  ");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_INSERT", "INSERT INTO PH_RECONST_FLUID (RF_ID, RF_NAME, RF_BASE_UOM, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?) ");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_UPDATE", "UPDATE PH_RECONST_FLUID SET RF_NAME=?,RF_BASE_UOM=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE RF_ID=?");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_DTL_INSERT", "INSERT INTO PH_INV_ITEM_FOR_RECONST_FLUID(RF_ID, ITEM_CODE, CONTENT_IN_BASE_UOM, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?) ");
		dataMap.put("SQL_PH_RECONSTITUENT_FLUID_DTL_DELETE", "DELETE FROM PH_INV_ITEM_FOR_RECONST_FLUID WHERE RF_ID=? ");
		dataMap.put("JNDI_PH_RECONS_FLUID", "java:comp/env/ReconstituentFluid");
		
		
		// IP Fill Process(IP_FILL_PROCESS)
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT1","SELECT ORDER_ID,SOURCE_CODE,ORDERING_FACILITY_ID,TO_DATE(ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') ORD_DATE_TIME ,MP_PATIENT.PATIENT_ID ,OR_ORDER.ENCOUNTER_ID,ORD_PRACT_ID  FROM OR_ORDER,MP_PATIENT,IP_ADT_TRN,PH_FILL_PROCESS_PARAM D WHERE OR_ORDER.PATIENT_ID=MP_PATIENT.PATIENT_ID AND OR_ORDER.ENCOUNTER_ID=IP_ADT_TRN.ENCOUNTER_ID AND  MP_PATIENT.DECEASED_YN='N' AND ORDER_CATEGORY = 'PH' AND PERFORMING_DEPTLOC_CODE = D.DISP_LOCN_CODE AND PATIENT_CLASS = 'IP' AND IP_ADT_TRN.SRL_NO=(SELECT MAX(SRL_NO) FROM IP_ADT_TRN WHERE PATIENT_ID=OR_ORDER.PATIENT_ID AND TRN_TYPE IN ('A','T') ) AND ORDER_TYPE_CODE IN (SELECT ORDER_TYPE_CODE FROM PH_ORDER_TYPE_FOR_DRUG_CLASS WHERE DRUG_CLASS <> 'N') AND ORDER_STATUS NOT IN (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_TYPE IN ('00','03','05','58','93','97','99','45','36','64') ) AND PRIORITY= 'R' AND ((D.NURSING_UNIT_OR_LOCN = 'N' AND IP_ADT_TRN.TO_NURSING_UNIT  BETWEEN NVL(D.NURSING_UNIT_FROM,'!')  AND NVL(D.NURSING_UNIT_TO,'~')) OR (D.NURSING_UNIT_OR_LOCN = 'L'  AND IP_ADT_TRN.TO_NURSING_UNIT   IN (SELECT  NURSING_UNIT_CODE    FROM  IP_NURSING_UNIT_LOCATION 	 WHERE FACILITY_ID = D.FACILITY_ID   	 AND BLDNG_CODE  =D.BUILDING_CODE 	 AND FLOOR_CODE = D.FLOOR_CODE))) 	 AND 	 ( ( D.IV_DRUG_IND='B' AND  (IV_PREP_YN IN ('N','I') OR IV_PREP_YN IS NULL)) 	  OR (D.IV_DRUG_IND='Y' AND  IV_PREP_YN IN ('I')) 	  OR(D.IV_DRUG_IND='N' AND  IV_PREP_YN IN ('N')) 	 )AND( 	  (D.PROC_TYPE='R' AND ORD_DATE_TIME<( D.FILL_INT_START_DATE_TIME-(1/24*D.IP_FILL_EXCL_PRD_BEHIND))) OR(D.PROC_TYPE='I') )	AND D.FILL_PROC_ID=? ORDER BY SOURCE_CODE");//'64' added for mms-kh-crf-0014
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT2","SELECT ORDER_CATALOG_CODE,TO_DATE(START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE_TIME,TO_DATE(END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE_TIME ,A.ORDER_ID,A.ORDER_LINE_NUM,ORDER_LINE_STATUS,ORDER_QTY,ORDER_UOM,DURN_VALUE,DURN_TYPE FROM OR_ORDER_LINE A, AM_FREQUENCY B,PH_DRUG C,OR_ORDER_LINE_PH D,PH_FILL_PROCESS_PARAM E WHERE A.ORDER_ID = ? AND D.ORDER_ID=A.ORDER_ID AND D.ORDER_LINE_NUM=A.ORDER_LINE_NUM AND C.DRUG_CODE=A.ORDER_CATALOG_CODE AND A.FREQ_CODE= B.FREQ_CODE AND FREQ_NATURE IN ('F','I') AND (( E.COMPOUND_DRUG_IND ='B')OR (E.COMPOUND_DRUG_IND ='Y' AND  COMPOUND_DRUG_YN  IN ('Y') )OR(E.COMPOUND_DRUG_IND ='N' AND  COMPOUND_DRUG_YN  IN ('N') )) AND ((TRUNC(NEXT_FILL_DATE)=TRUNC(E.FILL_INT_START_DATE_TIME))OR (NEXT_FILL_DATE IS NULL) OR (E.IP_FILL_PRD_UNIT='P') ) ");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT3","SELECT DRUG_AND_ITEM_CODE_SAME_IND,DRUG_ITEM_CODE_LINK_REQD_YN FROM PH_PARAM ");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT4","SELECT DECODE(EQVL_VALUE,0,1,EQVL_VALUE) EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE=? AND EQVL_UOM_CODE=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT5","SELECT ORDER_STATUS_TYPE FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_CODE = ?");
		// Used for Allocating the batches...
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT6","SELECT B.PATIENT_ID,B.ENCOUNTER_ID,A.ORDER_ID,A.ORDER_LINE_NO,DISP_DRUG_CODE,DISP_QTY,TO_CHAR(C.END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE_TIME,C.ORDER_UOM FROM PH_DISP_DTL_TMP A, PH_DISP_HDR_TMP B,OR_ORDER_LINE C WHERE A.DISP_TMP_NO = B.DISP_TMP_NO AND A.ORDER_ID= B.ORDER_ID AND B.ORDER_ID=C.ORDER_ID AND A.ORDER_LINE_NO = C.ORDER_LINE_NUM AND B.FILL_PROC_ID =?");
		//dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT7","SELECT TRADE_ID,BIN_LOCATION_CODE, BATCH_ID,TO_CHAR(EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE_OR_RECEIPT_DATE,A.STORE_CODE,NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0) QTY FROM ST_ITEM_BATCH A WHERE ITEM_CODE = ? AND STORE_CODE=? AND SUSPENDED_YN = 'N' AND (NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0))>0 AND TRUNC(EXPIRY_DATE_OR_RECEIPT_DATE) > TRUNC(SYSDATE) AND TRUNC(EXPIRY_DATE_OR_RECEIPT_DATE) > TO_DATE(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY') ORDER BY EXPIRY_DATE_OR_RECEIPT_DATE");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT7","SELECT TRADE_ID,BIN_LOCATION_CODE, BATCH_ID, TO_CHAR(EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE_OR_RECEIPT_DATE, A.STORE_CODE,NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0) QTY FROM   ST_ITEM_BATCH A, ST_ITEM B WHERE A.ITEM_CODE = ? AND STORE_CODE=? AND B.ITEM_CODE = A.ITEM_CODE AND SUSPENDED_YN = 'N' AND (NVL(QTY_ON_HAND,0)-NVL(COMMITTED_QTY,0))>0 AND (  (B.EXPIRY_YN = 'Y' AND B.USE_AFTER_EXPIRY_YN = 'N' AND TRUNC(EXPIRY_DATE_OR_RECEIPT_DATE) > TRUNC(SYSDATE) AND TRUNC(EXPIRY_DATE_OR_RECEIPT_DATE) > TO_DATE(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')  )  OR  B.EXPIRY_YN = 'N' ) ORDER BY EXPIRY_DATE_OR_RECEIPT_DATE ");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT8","SELECT A.STORE_CODE,A.DISP_LOCN_CODE,TO_CHAR(B.FILL_INT_END_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_END_DATE_TIME ,TO_CHAR(B.FILL_INT_START_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_START_DATE_TIME FROM PH_DISP_LOCN A,PH_FILL_PROCESS_PARAM B WHERE A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID=B.FACILITY_ID AND B.FILL_PROC_ID=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT9","SELECT INVENTORY_ITEM_CODE FROM PH_INVENTORY_ITEM_FOR_DRUG WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT10","SELECT COUNT(*) COUNT,DISP_TMP_NO FROM PH_DISP_HDR_TMP WHERE ORDER_ID = ? GROUP BY DISP_TMP_NO");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT11","SELECT PH_TMP_DISP_NO.NEXTVAL  TMP_DISP_NO FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT12","SELECT A.ASSIGN_ROOM_NUM,   A.ASSIGN_BED_NUM,A.SPECIALTY_CODE,A.ATTEND_PRACTITIONER_ID FROM PR_ENCOUNTER A WHERE ENCOUNTER_ID= ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT13","SELECT NVL(MAX(DTL_SERIAL_NUM),0)+1 DTL_SERIAL_NUM FROM PH_DISP_DTL_TMP WHERE DISP_TMP_NO = ?  AND DISP_DRUG_CODE != ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT14","SELECT   COUNT(ORDER_LINE_DOSE_QTY_VALUE) NOOFTIMES FROM   OR_ORDER_LINE_FIELD_VALUES WHERE   ORDER_ID		= ?  AND   ORDER_LINE_NUM	= ? AND   ORDER_LINE_FIELD_MNEMONIC = 'SCHED_ADMIN_TIME' AND     TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||ORDER_LINE_FIELD_VALUE,'DD/MM/YYYY HH24:MI')     BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND     TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||'23:59','DD/MM/YYYY HH24:MI')  UNION   SELECT COUNT(ORDER_LINE_DOSE_QTY_VALUE) NOOFTIMES FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID		= ? AND  ORDER_LINE_NUM	= ? AND   ORDER_LINE_FIELD_MNEMONIC = 'SCHED_ADMIN_TIME' AND  TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+1,'DD/MM/YYYY')||ORDER_LINE_FIELD_VALUE,'DD/MM/YYYY HH24:MI') BETWEEN TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+1,'DD/MM/YYYY')||'00:00','DD/MM/YYYY HH24:MI')   AND TO_DATE(?,'DD/MM/YYYY HH24:MI')");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT15","SELECT ORDER_LINE_DOSE_QTY_VALUE REQ_QTY ,ORDER_LINE_FIELD_VALUE FROM   OR_ORDER_LINE_FIELD_VALUES   WHERE   ORDER_ID  = ? AND   ORDER_LINE_NUM = ? AND   ORDER_LINE_FIELD_MNEMONIC = 'SCHED_ADMIN_TIME'   AND   TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||ORDER_LINE_FIELD_VALUE,'DD/MM/YYYY HH24:MI')   BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND   TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||(SELECT TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') FROM PH_DISP_LOCN where disp_locn_code=(SELECT PERFORMING_DEPTLOC_CODE FROM OR_ORDER WHERE ORDER_ID=?)),'DD/MM/YYYY HH24:MI') UNION  SELECT ORDER_LINE_DOSE_QTY_VALUE REQ_QTY, ORDER_LINE_FIELD_VALUE FROM   OR_ORDER_LINE_FIELD_VALUES   WHERE   ORDER_ID  = ? AND   ORDER_LINE_NUM = ? AND   ORDER_LINE_FIELD_MNEMONIC = 'SCHED_ADMIN_TIME'   AND    TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||ORDER_LINE_FIELD_VALUE,'DD/MM/YYYY HH24:MI')   BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND   TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||(SELECT TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') FROM PH_DISP_LOCN where disp_locn_code=(SELECT PERFORMING_DEPTLOC_CODE FROM OR_ORDER WHERE ORDER_ID=?)),'DD/MM/YYYY HH24:MI')");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT16","SELECT NVL(FRACT_DOSE_ROUND_UP_YN,'N') FRACTIONALROUNDUP,STOCK_UOM,(STRENGTH_VALUE/DECODE(STRENGTH_PER_VALUE_PRES_UOM,NULL,1,0,1,STRENGTH_PER_VALUE_PRES_UOM)) *NVL(CONTENT_IN_PRES_BASE_UOM,1) STRENGTHPERSTOCKUOM FROM OR_ORDER_LINE A, PH_DRUG B  WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND ORDER_CATALOG_CODE=B.DRUG_CODE");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT17","SELECT PRESCRIBED_MODE FROM PH_PATIENT_DRUG_PROFILE A WHERE ORIG_ORDER_ID=? AND  ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT18","SELECT DISTINCT ORDER_LINE_DOSE_QTY_UNIT SCHEDULEUOM ,ORDER_LINE_DOSE_QTY_VALUE SCHEDULEQTY FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID = ?   AND ORDER_LINE_NUM = ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT19","SELECT (TO_DATE(TRUNC(TO_DATE(?,'DD/MM/YYYY HH24:MI')),'DD/MM/YYYY')-(TO_DATE(TRUNC(TO_DATE(?,'DD/MM/YYYY HH24:MI')),'DD/MM/YYYY'))) VAL FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT20","SELECT TO_DATE(?,'DD/MM/YYYY HH24:MI')+1 NEXT_DAY FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT21","SELECT SUM(ORDER_LINE_DOSE_QTY_VALUE) ORDER_LINE_DOSE_QTY_VALUE  FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID		=? AND ORDER_LINE_NUM	= ?  AND ORDER_LINE_FIELD_MNEMONIC = 'SCHED_ADMIN_TIME'  AND TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||ORDER_LINE_FIELD_VALUE,'DD/MM/YYYY HH24:MI')   BETWEEN   TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI')"); 
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT22","SELECT COUNT(ORDER_LINE_DOSE_QTY_VALUE) COUNT_OF_SCHEDULES FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID		= ? AND ORDER_LINE_NUM	= ? AND ORDER_LINE_FIELD_MNEMONIC = 'SCHED_ADMIN_TIME' AND TO_DATE(TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')||ORDER_LINE_FIELD_VALUE,'DD/MM/YYYY HH24:MI') BETWEEN 		  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI')");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT22A","SELECT (A.ORDER_QTY/A.DURN_VALUE) PER_DAY,B.PERFORMING_DEPTLOC_CODE,A.DURN_VALUE,A.DURN_TYPE,A.ORDER_QTY FROM OR_ORDER_LINE A,OR_ORDER B WHERE A.ORDER_ID = B.ORDER_ID AND A.ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT23","SELECT ORDER_QTY,ORDER_UOM  FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?"); 
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT24","SELECT DECODE(STRENGTH_PER_PRES_UOM,NULL,1,0,1,STRENGTH_PER_PRES_UOM) STRENGTH_PER_PRES_UOM,DECODE(STRENGTH_PER_VALUE_PRES_UOM,NULL,1,0,1,STRENGTH_PER_VALUE_PRES_UOM) STRENGTH_PER_VALUE_PRES_UOM,DECODE(CONTENT_IN_PRES_BASE_UOM,NULL,1,0,1,CONTENT_IN_PRES_BASE_UOM) CONTENT_IN_PRES_BASE_UOM,PRES_BASE_UOM FROM PH_DRUG WHERE DRUG_CODE = ?"); 
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT25","SELECT OR_ORDER.ORDER_ID, SOURCE_CODE, ORDERING_FACILITY_ID,  TO_CHAR(OR_ORDER.ORD_DATE_TIME,  'DD/MM/YYYY HH24:MI') ORD_DATE_TIME,  MP_PATIENT.PATIENT_ID,  OR_ORDER.ENCOUNTER_ID,  OR_ORDER.ORD_PRACT_ID FROM   OR_ORDER,  MP_PATIENT,   IP_OPEN_ENCOUNTER,  PH_FILL_PROCESS_PARAM D,  OR_ORDER_LINE E WHERE    OR_ORDER.ORDER_ID = E.ORDER_ID AND   (  E.START_DATE_TIME  BETWEEN D.FILL_INT_START_DATE_TIME AND D.FILL_INT_END_DATE_TIME  OR  E.END_DATE_TIME  BETWEEN D.FILL_INT_START_DATE_TIME AND D.FILL_INT_END_DATE_TIME   OR D.FILL_INT_START_DATE_TIME BETWEEN E.START_DATE_TIME AND E.END_DATE_TIME OR D.FILL_INT_END_DATE_TIME BETWEEN E.START_DATE_TIME AND E.END_DATE_TIME ) AND   OR_ORDER.PATIENT_ID=MP_PATIENT.PATIENT_ID  AND  OR_ORDER.ENCOUNTER_ID=IP_OPEN_ENCOUNTER.ENCOUNTER_ID AND  OR_ORDER.ORDERING_FACILITY_ID=IP_OPEN_ENCOUNTER.FACILITY_ID AND  MP_PATIENT.DECEASED_YN='N' AND  OR_ORDER.ORDER_CATEGORY = 'PH' AND  PERFORMING_DEPTLOC_CODE = D.DISP_LOCN_CODE AND  OR_ORDER.PATIENT_CLASS = 'IP'  AND OR_ORDER.ORDER_TYPE_CODE IN (SELECT ORDER_TYPE_CODE FROM PH_ORDER_TYPE_FOR_DRUG_CLASS WHERE DRUG_CLASS <> 'N') AND  OR_ORDER.PRIORITY= 'R' AND  ((D.NURSING_UNIT_OR_LOCN = 'N' AND  OR_ORDER.SOURCE_CODE  BETWEEN NVL(D.NURSING_UNIT_FROM,'!') AND  NVL(D.NURSING_UNIT_TO,'~')) OR (D.NURSING_UNIT_OR_LOCN = 'L' AND  OR_ORDER.SOURCE_CODE  IN (SELECT  NURSING_UNIT_CODE    FROM  IP_NURSING_UNIT_LOCATION WHERE FACILITY_ID = D.FACILITY_ID AND  BLDNG_CODE  =D.BUILDING_CODE AND  FLOOR_CODE = D.FLOOR_CODE))) AND  ( ( D.IV_DRUG_IND='B' AND  (IV_PREP_YN IN ('N','I','1','4','5') OR IV_PREP_YN IS NULL)) OR (D.IV_DRUG_IND='Y' AND  IV_PREP_YN IN ('1','4','5')) OR(D.IV_DRUG_IND='N' AND  IV_PREP_YN IS NULL)) AND  ( (D.PROC_TYPE='R' AND  OR_ORDER.ORD_DATE_TIME<( D.FILL_INT_START_DATE_TIME-(1/24*D.IP_FILL_EXCL_PRD_BEHIND))) OR(D.PROC_TYPE='I') )  AND  FILL_PROC_ID=? AND TRUNC(OR_ORDER.ord_date_time) <= TRUNC(SYSDATE)"); 
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT26","SELECT ORDER_CATALOG_CODE,TO_CHAR(START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE_TIME,TO_CHAR(END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE_TIME,A.ORDER_ID,A.ORDER_LINE_NUM,ORDER_LINE_STATUS,ORDER_QTY,ORDER_UOM,DURN_VALUE,DURN_TYPE FROM OR_ORDER_LINE A, AM_FREQUENCY B,PH_DRUG C,OR_ORDER_LINE_PH D,PH_FILL_PROCESS_PARAM E WHERE A.ORDER_ID = ? AND E.FILL_PROC_ID = ? AND D.ORDER_ID=A.ORDER_ID AND D.ORDER_LINE_NUM=A.ORDER_LINE_NUM AND C.DRUG_CODE=A.ORDER_CATALOG_CODE AND A.FREQ_CODE= B.FREQ_CODE AND FREQ_NATURE IN ('F','I') AND ( ( E.COMPOUND_DRUG_IND ='B') OR (E.COMPOUND_DRUG_IND ='Y' AND  COMPOUND_DRUG_YN  IN ('Y') ) OR(E.COMPOUND_DRUG_IND ='N' AND  COMPOUND_DRUG_YN  IN ('N') ) ) AND (	(TRUNC(NEXT_FILL_DATE)=TRUNC(E.FILL_INT_START_DATE_TIME)) OR (NEXT_FILL_DATE IS NULL))"); 
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT27","SELECT A.IP_VERF_YN ,A.IP_FILL_ALLOCATE_BATHCES_YN,TO_CHAR(B.FILL_INT_START_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_START_DATE_TIME ,B.IP_FILL_PRD_UNIT,B.PROC_TYPE,TO_CHAR(B.FILL_INT_END_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_END_DATE_TIME,B.IP_EXCL_INTERMITTENT_FILL,B.FACILITY_ID,A.DISP_LOCN_CODE FROM PH_DISP_LOCN A,PH_FILL_PROCESS_PARAM B WHERE A.FACILITY_ID	  = B.FACILITY_ID AND A.DISP_LOCN_CODE  = B.DISP_LOCN_CODE AND B.FILL_PROC_ID	= ?"); 
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT28","SELECT FILL_PROC_ID FROM OR_ORDER_LINE_PH WHERE ORDER_ID = ? AND ORDER_LINE_NUM = ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT29","SELECT IP_FILL_PRD_UNIT  FROM PH_FILL_PROCESS_PARAM WHERE FILL_PROC_ID=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT30","SELECT CALC_DOSG_BY_FREQ_DURN_YN FROM PH_DRUG WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT31","SELECT COUNT(*) CORDERLINEFIELD FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT32","SELECT COUNT(*) CTMP FROM OR_ORDER_LINE WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT33","SELECT PH_RET_STOCK_AVAIL_STATUS(?,?,?,?,?,?,?) AVAIL_STOCK FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT34","SELECT (TO_DATE(?,'DD/MM/YYYY HH24:MI') - TO_DATE(?,'DD/MM/YYYY HH24:MI')) DATEVALUE FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT35","SELECT COUNT(*) COUNT,TO_CHAR(FILL_INT_END_DATE_TIME,'DD/MM/YYYY HH24:MI') EFF_START_DATE,TO_CHAR(FILL_INT_END_DATE_TIME+1,'DD/MM/YYYY HH24:MI') EFF_END_DATE FROM PH_FILL_PROCESS_PARAM WHERE PROC_TYPE='R'  GROUP BY FILL_INT_END_DATE_TIME,FILL_INT_START_DATE_TIME+1");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT35A","SELECT TO_CHAR(TO_DATE(TO_CHAR(SYSDATE,'DD/mm/yyyy') ||' '|| TO_CHAR(TO_DATE(?,'dd/mm/yyyy hh24:mi'),'hh24:mi'),'DD/MM/YYYY HH24:MI')+(?/24),'dd/mm/yyyy hh24:MI') EFF_END_DATE FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT36","SELECT TO_CHAR(B.FILL_INT_END_DATE_TIME, 'DD/MM/YYYY HH24:MI') STARTDATE, TO_CHAR(A.FILL_INT_END_DATE_TIME,'DD/MM/YYYY HH24:MI') FILL_INT_END_DATE_TIME,TO_CHAR(A.SCHEDULE_START,'DD/MM/YYYY HH24:MI') SCHEDULE_START FROM PH_FILL_PROCESS_PARAM A, PH_LAST_FILL_INT_DTL B  WHERE A.PROC_TYPE='I'  AND A.fill_proc_id = B.LAST_FILL_PROC_ID AND B.FILL_INT_END_DATE_TIME <  A.FILL_INT_END_DATE_TIME AND B.FACILITY_ID=? AND B.FILL_INT_END_DATE_TIME>=SYSDATE");		
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT36A","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY')||' 00:01' START_DATE ,	   (SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY')||' '|| TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND   DISP_LOCN_CODE=?) SCHEDULE_START, (SELECT TO_CHAR(SYSDATE+1,'DD/MM/YYYY')||' '|| TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND   DISP_LOCN_CODE=?) FILL_INT_END_DATE_TIME FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT36B","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI') TODAY FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT36C","SELECT  TO_DATE(?,'DD/MM/YYYY HH24:MI')-TO_DATE(?,'DD/MM/YYYY HH24:MI') VAL,TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI') TODAY FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT36D","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY')||' '||(SELECT TO_CHAR(IP_FILL_DFLT_START_TIME,'HH24:MI') FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? ) START_DATE FROM DUAL");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT37","SELECT MAX_DURN_FOR_IP_PRES FROM PH_PARAM");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_SELECT38","select count(*) cnt from st_item_store where STORE_CODE=? and ITEM_CODE=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_INSERT_HDR_TMP","INSERT INTO PH_DISP_HDR_TMP (DISP_TMP_NO, FACILITY_ID, DISP_LOCN_CODE,ORDER_ID, RECORD_DATE_TIME, FILL_PROC_ID,ORDERING_FACILITY_ID, ORD_DATE_TIME, PATIENT_ID, ENCOUNTER_ID, PATIENT_CLASS, LOCN_TYPE, LOCN_CODE, ROOM_TYPE, ROOM_NO, BED_NO, BED_CLASS, BED_TYPE, SPECIALITY_CODE, ATTEND_PRACTITIONER_ID, PRES_PHYSICIAN_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)VALUES(?,?,?,?,SYSDATE,?,?,SYSDATE,?,?,'IP','N',?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_INSERT_DTL_TMP","INSERT INTO PH_DISP_DTL_TMP(DISP_TMP_NO, DTL_SERIAL_NUM, RECORD_DATE_TIME, FACILITY_ID,DISP_LOCN_CODE, PRES_DRUG_CODE,ORDER_ID, ORDER_LINE_NO, ORDERING_FACILITY_ID, DISP_DRUG_CODE,DISP_QTY, DISP_UOM_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,DOC_SRL_NO)VALUES( NVL(?,?),?,SYSDATE,?,?,?,?,?,?,?,NVL(?,0),?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_DTL_TMP","UPDATE PH_DISP_DTL_TMP SET DISP_QTY = NVL(DISP_QTY,0) + NVL(?,0),MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_DATE=SYSDATE   WHERE ORDER_ID = ? AND  ORDER_LINE_NO	= ? AND  DISP_TMP_NO	= NVL(?,?)");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_INSERT_DRUG_BATCH_TMP","INSERT INTO PH_DISP_DRUG_BATCH_TMP(FACILITY_ID, DISP_LOCN_CODE, ORDER_ID, ORDER_LINE_NUM, RECORD_DATE_TIME, ITEM_CODE, BATCH_ID, EXPIRY_DATE, STORE_CODE, DISP_QTY,DISP_QTY_UOM,  DRUG_CODE,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,  ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,DOC_SRL_NO,BIN_LOCATION_CODE,TRADE_ID)VALUES(?,?, ?, ?,SYSDATE, ?,?, TO_DATE(?,'DD/MM/YYYY HH24:MI'),?, ? ,?,  ?,?,SYSDATE, ?,?,?,SYSDATE,?,?,?,?,?)");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_CAL_NO_OF_DAYS","SELECT FRACT_DOSE_ROUND_UP_YN,CEIL(CONTENT_IN_PRES_BASE_UOM /((STRENGTH_PER_VALUE_PRES_UOM/STRENGTH_PER_PRES_UOM) * (SELECT SUM(ORDER_LINE_DOSE_QTY_VALUE) FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID = ?   AND ORDER_LINE_NUM = ?))) NO_OF_DAYS FROM PH_DRUG WHERE DRUG_CODE = ?");		
		dataMap.put("SQL_PH_IP_FILL_PROCESS_CAL_NO_OF_DAYS_A","SELECT FRACT_DOSE_ROUND_UP_YN, CEIL(CONTENT_IN_PRES_BASE_UOM /(((decode(nvl(STRENGTH_PER_VALUE_PRES_UOM,1),0,1, STRENGTH_PER_VALUE_PRES_UOM))  / decode(nvl(STRENGTH_PER_PRES_UOM,1),0,1,STRENGTH_PER_PRES_UOM))  * (SELECT SUM(ORDER_LINE_DOSE_QTY_VALUE) FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID = ?   AND ORDER_LINE_NUM = ?))) NO_OF_DAYS FROM PH_DRUG WHERE DRUG_CODE = (SELECT ORDER_CATALOG_CODE FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?)");	
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_ORDER_LINE_PH","UPDATE OR_ORDER_LINE_PH SET FILL_PROC_ID = ?,	START_DATE_TIME_FOR_FILL= SYSDATE,FILL_QTY_VALUE_STK_UNIT = NVL(FILL_QTY_VALUE_STK_UNIT,0)+?,FILL_QTY_STK_UNIT 		= ?,TMP_DISP_NO= ?,NEXT_FILL_DATE= TO_DATE(?,'DD/MM/YYYY HH24:MI')+?,	MODIFIED_BY_ID			=?,	MODIFIED_FACILITY_ID	=?,	MODIFIED_AT_WS_NO		=?,	MODIFIED_DATE			=SYSDATE  WHERE 	ORDER_ID = ?   AND ORDER_LINE_NUM = ? ");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_ORDER_LINE","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS='IP',MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_DATE=SYSDATE WHERE ORDER_ID= ? AND ORDER_LINE_NUM=? AND ORDER_LINE_STATUS <> 'DP'");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_ORDER","UPDATE OR_ORDER SET ORDER_STATUS='IP',MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_DATE=SYSDATE WHERE ORDER_ID=? AND ORDER_STATUS<>'DP'");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_ORDER_LINE_A","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS='IP',MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_DATE=SYSDATE  WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_INSERT_LAST_FILL_INT_DTL","INSERT INTO PH_LAST_FILL_INT_DTL (FACILITY_ID,NURSING_UNIT_CODE,LAST_FILL_PROC_ID,FILL_INT_START_DATE_TIME,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_ORDER_A","UPDATE OR_ORDER SET ORDER_STATUS='IP' ,MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_DATE=SYSDATE WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_UPDATE_LAST_FILL_INT_DTL","UPDATE PH_LAST_FILL_INT_DTL SET FILL_INT_END_DATE_TIME = SYSDATE, CUT_OFF_LIMIT_FOR_NEW_ORD=TO_DATE(?,'DD/MM/YYYY HH24:MI'),MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?,MODIFIED_DATE=SYSDATE	WHERE LAST_FILL_PROC_ID = ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_EQVL_VALUE","SELECT EQVL_VALUE FROM AM_UOM_EQVL WHERE UOM_CODE = (SELECT DOSAGE_UOM_CODE FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID=? AND  ORIG_ORDER_LINE_NO = ?) AND EQVL_UOM_CODE = (SELECT ORDER_UOM FROM OR_ORDER_LINE WHERE ORDER_ID=? AND  ORDER_LINE_NUM = ?)");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_ALT_DRUGS_SELECT","SELECT   A.DRUG_CODE CODE,   A.DRUG_DESC || '  (AVAIL QTY  :' || PH_RET_STOCK_AVAIL_STATUS(F.INVENTORY_ITEM_CODE,?,?,'Y', ? ,'N',NULL ) || ')'  DESCRIPTION FROM PH_DRUG_lang_vw A, PH_DRUG_lang_vw B, AM_UOM C, PH_INVENTORY_ITEM_FOR_DRUG F WHERE    A.GENERIC_ID=B.GENERIC_ID AND   A.ROUTE_CODE=B.ROUTE_CODE AND   (( B.DISP_ALT_FORM_YN='N' AND B.FORM_CODE=A.FORM_CODE ) OR  B.DISP_ALT_FORM_YN='Y') AND A.STRENGTH_UOM=C.UOM_CODE AND    EXISTS (SELECT COUNT(*) FROM  AM_UOM_EQVL WHERE (UOM_CODE=A.STRENGTH_UOM AND   EQVL_UOM_CODE=B.STRENGTH_UOM) OR   (UOM_CODE=B.STRENGTH_UOM AND   EQVL_UOM_CODE=A.STRENGTH_UOM) ) AND   A.STRENGTH_VALUE<>0 AND   A.DRUG_CODE=F.DRUG_CODE(+) AND   A.GENERIC_ID=(SELECT GENERIC_ID FROM PH_DRUG WHERE DRUG_CODE = ?) AND   B.DRUG_CODE=? AND  A.DISP_MULTI_STRENGTH_YN='Y' AND a.language_id= b.language_id and a.language_id=? and PH_RET_STOCK_AVAIL_STATUS(F.INVENTORY_ITEM_CODE,?,?,'Y', ? ,'N',NULL )  >  ?");
		dataMap.put("SQL_PH_IP_FILL_PROCESS_DETAILS_SELECT","SELECT Ph_CalculateDispQty(e.order_id,e.order_line_num)  || ' ' ||e.ORDER_UOM  Tot_Disp_Qty, Ph_Display_Stock_UNIT(Or_Order.ORDERING_FACILITY_ID,	Or_Order.PERFORMING_DEPTLOC_CODE,	e.Order_id,	e.ordeR_line_num,	e.order_Catalog_code,	nvl((select to_char(next_fill_date,'DD/MM/YYYY HH24:MI') from or_order_line_ph where order_id = e.ordeR_id and order_line_num = e.order_line_num),?),	?,	?,	NUll,	e.start_Date_time,	e.end_Date_Time,	e.durn_type,	e.durn_value, 	e.order_line_Status, 	e.order_qty,	e.ORDER_UOM,	?) Disp_qty,  Mp_patient.patient_Name || ',' || Get_Age(Mp_patient.date_of_birth) || ','|| decode (Mp_patient.sex,'F','Female','M','Male','Unknown') || ','|| Mp_patient.patient_id || '  Bed No. : '|| ip_open_encounter.BED_NUM Patient_Details,   e.order_Catalog_code order_Catalog_code,CATALOG_DESC Drug_Name ,	e.ORDER_QTY,	e.ORDER_UOM, 	   e.ORDER_ID,	IP_OPEN_ENCOUNTER.NURSING_UNIT_CODE SOURCE_CODE, ORDERING_FACILITY_ID, TO_CHAR(OR_ORDER.ORD_DATE_TIME,  'DD/MM/YYYY HH24:MI') ORD_DATE_TIME, MP_PATIENT.PATIENT_ID,  OR_ORDER.ENCOUNTER_ID,  OR_ORDER.ORD_PRACT_ID,	e.order_line_status,	e.start_Date_Time,	TO_CHAR(e.end_date_Time,  'DD/MM/YYYY HH24:MI') end_date_Time,	e.DURN_VALUE,	e.DURN_TYPE,	IP_NURSING_UNIT.SHORT_DESC NURSING_UNIT_DESC, e.ordeR_line_num ORDER_LINE_NUM, OR_ORDER.PATIENT_CLASS PATIENT_CLASS, OR_ORDER.SOURCE_TYPE SOURCE_TYPE, IP_OPEN_ENCOUNTER.ROOM_NUM ROOM_NUM, IP_OPEN_ENCOUNTER.BED_NUM BED_NUM,IP_OPEN_ENCOUNTER.BED_CLASS_CODE BED_CLASS_CODE, IP_OPEN_ENCOUNTER.BED_TYPE_CODE BED_TYPE_CODE, IP_OPEN_ENCOUNTER.SPECIALTY_CODE SPECIALTY_CODE,IP_OPEN_ENCOUNTER.ATTEND_PRACTITIONER_ID ATTEND_PRACTITIONER_ID FROM	OR_ORDER,  	MP_PATIENT, IP_OPEN_ENCOUNTER, OR_ORDER_LINE E ,IP_NURSING_UNIT_lang_vw	IP_NURSING_UNIT ,ph_drug_lang_vw g WHERE    OR_ORDER.ORDER_ID = E.ORDER_ID	AND  OR_ORDER.ORDER_CATEGORY = 'PH'	AND  PERFORMING_DEPTLOC_CODE = ? 	AND  OR_ORDER.PATIENT_CLASS = 'IP' AND TRUNC(E.END_DATE_TIME) >=TRUNC(SYSDATE) AND IP_OPEN_ENCOUNTER.FACILITY_ID =  IP_NURSING_UNIT.FACILITY_ID AND IP_OPEN_ENCOUNTER.NURSING_UNIT_CODE = IP_NURSING_UNIT.NURSING_UNIT_CODE AND   (E.START_DATE_TIME  BETWEEN To_date(? ,'DD/MM/YYYY HH24:MI')  AND To_date(?,'DD/MM/YYYY HH24:MI') OR  E.END_DATE_TIME  BETWEEN To_date(? ,'DD/MM/YYYY HH24:MI')  AND To_date(?,'DD/MM/YYYY HH24:MI')   OR To_date(? ,'DD/MM/YYYY HH24:MI')  BETWEEN E.START_DATE_TIME AND E.END_DATE_TIME    OR To_date(?,'DD/MM/YYYY HH24:MI')  BETWEEN E.START_DATE_TIME AND E.END_DATE_TIME )   AND  OR_ORDER.ENCOUNTER_ID=IP_OPEN_ENCOUNTER.ENCOUNTER_ID 	AND  OR_ORDER.ORDERING_FACILITY_ID=IP_OPEN_ENCOUNTER.FACILITY_ID 	AND   OR_ORDER.PATIENT_ID=MP_PATIENT.PATIENT_ID  AND  MP_PATIENT.DECEASED_YN='N' 	AND OR_ORDER.ORDER_TYPE_CODE IN (SELECT ORDER_TYPE_CODE FROM PH_ORDER_TYPE_FOR_DRUG_CLASS WHERE DRUG_CLASS <> 'N') 	AND  OR_ORDER.PRIORITY= 'R'   	AND  ((?  = 'N' AND  IP_OPEN_ENCOUNTER.NURSING_UNIT_CODE  BETWEEN NVL(?,'!') AND  NVL(?,'~')) OR (?  = 'L' AND  IP_OPEN_ENCOUNTER.NURSING_UNIT_CODE  IN (SELECT  NURSING_UNIT_CODE    FROM  IP_NURSING_UNIT_LOCATION WHERE FACILITY_ID = OR_ORDER.ORDERING_FACILITY_ID AND  BLDNG_CODE  =? AND  FLOOR_CODE = ?))) AND  ( ( ? ='B' AND  (IV_PREP_YN IN ('N','I','1','4','5')   OR IV_PREP_YN IS NULL)) OR (? ='Y' AND  IV_PREP_YN IN ('1','4','5'))  OR(? ='N' AND  IV_PREP_YN IS NULL)) AND  ( (?='R' AND  OR_ORDER.ORD_DATE_TIME<( To_date(?,'DD/MM/YYYY HH24:MI')-(1/24*0)) 	and OR_ORDER.ORDER_STATUS IN ('OS','VF','DP') ) OR(? = 'I' and OR_ORDER.ORDER_STATUS IN ('OS','VF')) )   AND or_order.ord_date_time between sysdate-100 and sysdate And exists (select 'Y' from am_frequency where freq_code = e.freq_code 	and FREQ_NATURE IN ('F','I'))	AND EXISTS (Select 'Y' from or_order_line_ph where order_id = e.order_id and order_line_num = e.order_line_num 	AND (	(TRUNC(NEXT_FILL_DATE)>=TRUNC(To_Date(?,'DD/MM/YYYY HH24:MI'))) OR (NEXT_FILL_DATE IS NULL)))  and e.order_Catalog_code = g.drug_code and g.language_id =? and IP_NURSING_UNIT.language_id=? Order By  IP_OPEN_ENCOUNTER.NURSING_UNIT_CODE,decode(?,'B',NVL(IP_OPEN_ENCOUNTER.bed_NUM,or_order.patient_id),or_order.patient_id)");
		dataMap.put("JNDI_PH_IP_FILL", "java:comp/env/IPFill");		
		dataMap.put("JNDI_PH_IP_FILL_ALL", "java:comp/env/IPFillAll");		
		/*Start of Reconstituent Fluid for Drug */
		dataMap.put("SQL_PH_DRUGNAME_LOOKUP", "SELECT DRUG_CODE code,DRUG_DESC description FROM PH_DRUG A  WHERE upper(DRUG_CODE) LIKE upper(?) AND upper(DRUG_DESC) LIKE upper(?)   AND PHYSICAL_FORM='P' ORDER BY upper(drug_desc)");
		dataMap.put("SQL_PH_RFD_SELECT", "SELECT   RF_NAME,  RF_BASE_UOM,  A.RF_ID,(SELECT RF_QTY FROM PH_RECONST_FLUID_FOR_DRUG WHERE RF_ID=A.RF_ID AND DRUG_CODE=?) RF_QTY, (SELECT STABILITY_INFO FROM PH_RECONST_FLUID_FOR_DRUG WHERE RF_ID=A.RF_ID AND DRUG_CODE=?) STABILITY_INFO, (SELECT DEFAULT_YN FROM PH_RECONST_FLUID_FOR_DRUG WHERE RF_ID=A.RF_ID AND  DRUG_CODE=?) DEFAULT_YN FROM   PH_RECONST_FLUID_LANG_VW A WHERE A.LANGUAGE_ID = ? order by 1");
		dataMap.put("SQL_PH_RFD_INSERT", "INSERT INTO PH_RECONST_FLUID_FOR_DRUG ( DRUG_CODE, RF_ID, DRUG_QTY, DRUG_QTY_UOM, RF_QTY, RF_QTY_UOM, STABILITY_INFO, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, DEFAULT_YN )  VALUES ( ?,?, nvl( (SELECT content_in_base_uom FROM PH_INV_ITEM_FOR_RECONST_FLUID WHERE rf_id=? AND ITEM_CODE=?),0), (SELECT pres_base_uom FROM PH_DRUG WHERE drug_code=?), ?,(SELECT rf_base_uom FROM PH_RECONST_FLUID WHERE rf_id=:RF_ID), ?, ?,SYSDATE,?,?,?,SYSDATE,?,?,? )");
		dataMap.put("SQL_PH_RFD_UPDATE", "UPDATE PH_RECONST_FLUID_FOR_DRUG SET RF_QTY=?,STABILITY_INFO=?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,DEFAULT_YN=? WHERE DRUG_CODE=? AND RF_ID=?");
		dataMap.put("SQL_PH_RFD_DELETE", "DELETE FROM PH_RECONST_FLUID_FOR_DRUG  WHERE DRUG_CODE=? AND RF_ID=?");
		dataMap.put("SQL_PH_RFD_QUERY", "SELECT   A.RF_ID,  A.DRUG_CODE,  B.DRUG_DESC,  A.RF_QTY,  A.RF_QTY_UOM,  C.RF_NAME, A.DEFAULT_YN FROM    PH_RECONST_FLUID_FOR_DRUG A,   PH_DRUG B,   PH_RECONST_FLUID C WHERE A.DRUG_CODE=B.DRUG_CODE AND A.RF_ID=C.RF_ID AND  B.DRUG_CODE LIKE NVL(?,'%') AND B.DRUG_DESC LIKE NVL(?,'%') AND A.RF_ID LIKE NVL(?,'%') AND C.RF_NAME LIKE NVL(?,'%')  ");
		dataMap.put("JNDI_PH_RFD", "java:comp/env/RFD");
		/*End of Reconstituent Fluid for Drug */

		// Start of Medication Administration
		dataMap.put("SQL_PH_MED_ADMIN_SELECT1", "SELECT MED_ADMIN_REQD_YN, MAR_DISP_HELD_DISC_ORDERS_YN, ALLOW_MAR_SHARE_DRUG_YN,ALLOW_AUTO_DISP_ALT_DRUG_MAR,EARLY_OR_LATE_ADMIN_YN,WARD_ACK_MAR_REQUIRED_YN,VERF_REQD_BEF_MED_ADMIN_YN FROM  PH_FACILITY_PARAM WHERE FACILITY_ID=? "); // EARLY_OR_LATE_ADMIN_YN Added for GHL-CRF-0482 // WARD_ACK_MAR_REQUIRED_YN Added for MMS-KH-CRF-0014 [IN:067953]//VERF_REQD_BEF_MED_ADMIN_YNadded for mms-kh-scf-0056
		dataMap.put("SQL_PH_MED_ADMIN_SELECT1A", "SELECT ALLOW_MED_ADMIN_WO_ORD_YN FROM  PH_FACILITY_PARAM WHERE FACILITY_ID=? ");
		
		//This Query selects nursing unit description and code for a particular operating station
		/*
		Parameter 1:Facility_Id
		Parameter 2:User_Id
		Parameter 3:Facility_Id
		*/
		dataMap.put("SQL_PH_MED_ADMIN_SELECT2", "SELECT NURSING_UNIT_CODE,LONG_DESC SHORT_DESC FROM IP_NURSING_UNIT_LANG_VW A WHERE A.NURSING_UNIT_CODE IN ( SELECT LOCN_CODE FROM AM_LOCN_FOR_OPER_STN B,AM_USER_FOR_OPER_STN C WHERE B.OPER_STN_ID=C.OPER_STN_ID AND B.FACILITY_ID=C.FACILITY_ID AND C.FACILITY_ID=? AND C.APPL_USER_ID=? AND TRUNC(SYSDATE) BETWEEN NVL(C.EFF_DATE_FROM,SYSDATE) AND NVL(C.EFF_DATE_TO,SYSDATE) AND TRUNC(SYSDATE) BETWEEN NVL(B.EFF_DATE_FROM,TRUNC(SYSDATE)) AND NVL(B.EFF_DATE_TO,TRUNC(SYSDATE)) ) AND FACILITY_ID=? AND EFF_STATUS='E' AND A.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT2A", "SELECT CLINIC_CODE, SHORT_DESC FROM OP_CLINIC_LANG_VW A WHERE A.CLINIC_CODE IN ( SELECT LOCN_CODE FROM AM_LOCN_FOR_OPER_STN B,AM_USER_FOR_OPER_STN C WHERE B.OPER_STN_ID=C.OPER_STN_ID AND B.FACILITY_ID=C.FACILITY_ID AND C.FACILITY_ID=? AND C.APPL_USER_ID=? AND TRUNC(SYSDATE) BETWEEN NVL(C.EFF_DATE_FROM,SYSDATE) AND NVL(C.EFF_DATE_TO,SYSDATE) AND TRUNC(SYSDATE) BETWEEN NVL(B.EFF_DATE_FROM,TRUNC(SYSDATE)) AND NVL(B.EFF_DATE_TO,TRUNC(SYSDATE)) ) AND FACILITY_ID=? and A.LEVEL_OF_CARE_IND='E' AND A.EFF_STATUS='E' AND A.LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT2B", "SELECT NURSING_UNIT_CODE,LONG_DESC SHORT_DESC FROM IP_NURSING_UNIT_LANG_VW A WHERE A.NURSING_UNIT_CODE IN ( SELECT LOCN_CODE FROM AM_LOCN_FOR_OPER_STN B,AM_USER_FOR_OPER_STN C WHERE B.OPER_STN_ID=C.OPER_STN_ID AND B.FACILITY_ID=C.FACILITY_ID AND C.FACILITY_ID=? AND C.APPL_USER_ID=? AND TRUNC(SYSDATE) BETWEEN NVL(C.EFF_DATE_FROM,SYSDATE) AND NVL(C.EFF_DATE_TO,SYSDATE) AND TRUNC(SYSDATE) BETWEEN NVL(B.EFF_DATE_FROM,TRUNC(SYSDATE)) AND NVL(B.EFF_DATE_TO,TRUNC(SYSDATE)) ) AND FACILITY_ID=? AND EFF_STATUS='E' AND A.LANGUAGE_ID = ? order by LONG_DESC ");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT3", "SELECT to_char(SYSDATE,'dd/mm/yyyy') SYS_DATE,to_char(SYSDATE-1,'dd/mm/yyyy') BACK_DATE_TIME  from dual");
		//Increasing the end_date for 4 hours 
		//dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1", "SELECT DISTINCT  A.ENCOUNTER_ID,   A.ASSIGN_BED_NUM ASSIGN_BED_NUM,decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no,  C.PATIENT_NAME, A.PATIENT_ID,   GET_AGE(C.DATE_OF_BIRTH) AGE, C.NATIONALITY_CODE,DECODE(C.SEX,   'M',   'male',   'F',   'female',   'unknown') GENDER,   (SELECT SHORT_NAME FROM    MP_COUNTRY_LANG_VW MP_COUNTRY 	WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?) NATIONALITY  FROM   PR_ENCOUNTER  A,  MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I  WHERE  	   E.ORDER_ID=D.ORDER_ID   AND    E.ORDER_LINE_NUM=D.ORDER_LINE_NUM and	   I.ORIG_ORDER_ID=F.ORDER_ID AND    I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND    I.ORIG_ORDER_ID=E.ORDER_ID AND    F.ORDER_ID=E.ORDER_ID AND    E.FREQ_CODE=G.FREQ_CODE AND       A.FACILITY_ID=?  AND    C.PATIENT_ID=A.PATIENT_ID and	   d.patient_id=c.patient_id   AND    D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND    D.FACILITY_ID=A.FACILITY_ID    AND    A.ASSIGN_CARE_LOCN_CODE=? AND    d.sch_date_time>=i.start_date and    sysdate<=i.end_date+(4/24) AND    E.CAN_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1", "SELECT DISTINCT  A.ENCOUNTER_ID,   A.ASSIGN_BED_NUM ASSIGN_BED_NUM,decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no, nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME, A.PATIENT_ID,   GET_AGE(C.DATE_OF_BIRTH) AGE, C.NATIONALITY_CODE,DECODE(C.SEX,   'M',   'male',   'F',   'female',   'unknown') GENDER,   (SELECT SHORT_NAME FROM    MP_COUNTRY_LANG_VW MP_COUNTRY 	WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?) NATIONALITY  FROM   PR_ENCOUNTER  A,  MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I  WHERE  	   E.ORDER_ID=D.ORDER_ID   AND    E.ORDER_LINE_NUM=D.ORDER_LINE_NUM and	   I.ORIG_ORDER_ID=F.ORDER_ID AND    I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND    I.ORIG_ORDER_ID=E.ORDER_ID AND    F.ORDER_ID=E.ORDER_ID AND    E.FREQ_CODE=G.FREQ_CODE AND       A.FACILITY_ID=?  AND    C.PATIENT_ID=A.PATIENT_ID and	   d.patient_id=c.patient_id   AND    D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND    D.FACILITY_ID=A.FACILITY_ID    AND    A.ASSIGN_CARE_LOCN_CODE=? AND    d.sch_date_time>=i.start_date and    sysdate<=i.end_date+(4/24) AND    E.CAN_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		//query modified to include from and to bed nos...3/12/2004
		//dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1AAA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,  '' ASSIGN_BED_NUM,  null n_bed_no, C.PATIENT_NAME,  A.PATIENT_ID,  GET_AGE(C.DATE_OF_BIRTH) AGE,  C.NATIONALITY_CODE,DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown') GENDER,  (SELECT SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?) NATIONALITY    FROM         OP_CLINIC_LANG_VW B,  PR_ENCOUNTER  A,  MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I  WHERE I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND E.FREQ_CODE=G.FREQ_CODE AND F.ORDER_ID=E.ORDER_ID AND  E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND  E.ORDER_ID=D.ORDER_ID   AND  B.FACILITY_ID=A.FACILITY_ID AND  B.FACILITY_ID=?   AND  C.PATIENT_ID=A.PATIENT_ID   AND  D.FACILITY_ID=A.FACILITY_ID    AND  B.CLINIC_CODE = A.ASSIGN_CARE_LOCN_CODE AND  B.CLINIC_CODE=?  AND    d.sch_date_time>=e.ord_date_time AND sysdate<=e.end_date_time+(4/24) AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1AAA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,  '' ASSIGN_BED_NUM,  null n_bed_no, nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME,  A.PATIENT_ID,  GET_AGE(C.DATE_OF_BIRTH) AGE,  C.NATIONALITY_CODE,DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown') GENDER,  (SELECT SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?) NATIONALITY    FROM         OP_CLINIC_LANG_VW B,  PR_ENCOUNTER  A,  MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I  WHERE I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND E.FREQ_CODE=G.FREQ_CODE AND F.ORDER_ID=E.ORDER_ID AND  E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND  E.ORDER_ID=D.ORDER_ID   AND  B.FACILITY_ID=A.FACILITY_ID AND  B.FACILITY_ID=?   AND  C.PATIENT_ID=A.PATIENT_ID   AND  D.FACILITY_ID=A.FACILITY_ID    AND  B.CLINIC_CODE = A.ASSIGN_CARE_LOCN_CODE AND  B.CLINIC_CODE=?  AND    d.sch_date_time>=e.ord_date_time AND sysdate<=e.end_date_time+(4/24) AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		//query modified to include from and to bed nos...3/12/2004
		//dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1A", "SELECT DISTINCT  A.ENCOUNTER_ID, A.ASSIGN_BED_NUM ASSIGN_BED_NUM,decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no, C.PATIENT_NAME,  A.PATIENT_ID,  GET_AGE(C.DATE_OF_BIRTH) AGE,  C.NATIONALITY_CODE,DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown') GENDER,  (SELECT SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?) NATIONALITY FROM         PR_ENCOUNTER A,  MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E  ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE  E.ORDER_ID=D.ORDER_ID AND E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND F.ORDER_ID = E.ORDER_ID AND E.FREQ_CODE=G.FREQ_CODE AND  A.FACILITY_ID=? AND C.PATIENT_ID=A.PATIENT_ID AND D.PATIENT_ID=C.PATIENT_ID AND D.ENCOUNTER_ID=A.ENCOUNTER_ID AND D.FACILITY_ID=A.FACILITY_ID AND A.ASSIGN_CARE_LOCN_CODE=?  AND D.SCH_DATE_TIME>=I.START_DATE AND SYSDATE<=I.END_DATE+(4/24)  AND E.HOLD_DATE_TIME IS NULL  AND e. disc_date_time IS NULL AND (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1A", "SELECT DISTINCT  A.ENCOUNTER_ID, A.ASSIGN_BED_NUM ASSIGN_BED_NUM,decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no, nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME ,  A.PATIENT_ID,  GET_AGE(C.DATE_OF_BIRTH) AGE,  C.NATIONALITY_CODE,DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown') GENDER,  (SELECT SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?) NATIONALITY FROM         PR_ENCOUNTER A,  MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E  ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE  E.ORDER_ID=D.ORDER_ID AND E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND F.ORDER_ID = E.ORDER_ID AND E.FREQ_CODE=G.FREQ_CODE AND  A.FACILITY_ID=? AND C.PATIENT_ID=A.PATIENT_ID AND D.PATIENT_ID=C.PATIENT_ID AND D.ENCOUNTER_ID=A.ENCOUNTER_ID AND D.FACILITY_ID=A.FACILITY_ID AND A.ASSIGN_CARE_LOCN_CODE=?  AND D.SCH_DATE_TIME>=I.START_DATE AND SYSDATE<=I.END_DATE+(4/24)  AND E.HOLD_DATE_TIME IS NULL  AND e. disc_date_time IS NULL AND (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		//query modified to include from and to bed nos...3/12/2004
		//dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1AA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,  '' ASSIGN_BED_NUM, '' n_bed_no, C.PATIENT_NAME,  A.PATIENT_ID,  Get_Age(C.DATE_OF_BIRTH) AGE,  C.NATIONALITY_CODE,DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown') GENDER,  (SELECT SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ? ) NATIONALITY FROM    PR_ENCOUNTER A,OP_CLINIC_LANG_VW B,MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E  ,OR_ORDER F ,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I    WHERE   I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND	E.FREQ_CODE=G.FREQ_CODE AND  F.ORDER_ID = E.ORDER_ID AND   E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND  E.ORDER_ID=D.ORDER_ID   AND   C.PATIENT_ID=A.PATIENT_ID   AND  D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND  D.FACILITY_ID=A.FACILITY_ID    AND   B.CLINIC_CODE=a.ASSIGN_CARE_LOCN_CODE AND B.FACILITY_ID=? AND   B.CLINIC_CODE=?  AND   d.sch_date_time>=e.ord_date_time AND   sysdate<=e.end_date_time+(4/24) and e.hold_date_time IS NULL  and   e. disc_date_time IS NULL  AND (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT1AA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,  '' ASSIGN_BED_NUM, '' n_bed_no, nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME,  A.PATIENT_ID,  Get_Age(C.DATE_OF_BIRTH) AGE,  C.NATIONALITY_CODE,DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown') GENDER,  (SELECT SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ? ) NATIONALITY FROM    PR_ENCOUNTER A,OP_CLINIC_LANG_VW B,MP_PATIENT C ,  PH_MEDN_ADMIN D ,OR_ORDER_LINE E  ,OR_ORDER F ,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I    WHERE   I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND	E.FREQ_CODE=G.FREQ_CODE AND  F.ORDER_ID = E.ORDER_ID AND   E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND  E.ORDER_ID=D.ORDER_ID   AND   C.PATIENT_ID=A.PATIENT_ID   AND  D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND  D.FACILITY_ID=A.FACILITY_ID    AND   B.CLINIC_CODE=a.ASSIGN_CARE_LOCN_CODE AND B.FACILITY_ID=? AND   B.CLINIC_CODE=?  AND   d.sch_date_time>=e.ord_date_time AND   sysdate<=e.end_date_time+(4/24) and e.hold_date_time IS NULL  and   e. disc_date_time IS NULL  AND (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT8", "SELECT REC_ADMIN_WITHIN_HRS FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");		
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT_DOSES","SELECT CEIL(TOT_INFUSION_OVER/INFUSE_OVER) NO_OF_DOSES FROM OR_ORDER_LINE_PH WHERE ORDER_ID=? AND ORDER_LINE_NUM=? ");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT_FROM_DATE","SELECT  TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')-((SELECT REC_ADMIN_WITHIN_HRS FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?)/(24)),'DD/MM/YYYY HH24:MI') FROM_DATE FROM DUAL");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT_TO_DATE","SELECT  TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+((SELECT REC_ADMIN_WITHIN_HRS FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?)/(24)),'DD/MM/YYYY HH24:MI') TO_DATE FROM DUAL");
	    dataMap.put("SQL_PH_MED_ADMIN_FT_TPN_SELECT2","SELECT a.order_id, a.order_line_num, e.iv_prep_yn, a.admin_recorded_by username, a.admin_authorized_by authorized_by, a.admin_remarks, a.non_admin_remarks, a.admin_recorded_yn, (CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN (   f.admin_drug_code || ':' || (SELECT long_name FROM ph_tpn_regimen_lang_vw ph_tpn_regimen WHERE tpn_regimen_code = f.admin_drug_code AND language_id = ?) || ':' || f.admin_dosage_qty || ':' || f.admin_dosage_uom_code ) WHEN a.ord_drug_code = 'FINAL PRODUCT' and nvl(administered_yn,'N') = 'Y' then 'FINAL PRODUCT:'||((SELECT mfg_unit FROM ph_tpn_worksheet_hdr WHERE tpn_worksheet_id = (SELECT DISTINCT tpn_worksheet_id FROM ph_tpn_worksheet_dtl WHERE order_id = (SELECT DISTINCT order_id FROM ph_medn_admin WHERE order_id = a.order_id and order_line_num = a.order_line_num and nvl(administered_yn,'N' ) = 'Y'))) || ':' || f.admin_dosage_qty || ':' || f.admin_dosage_uom_code) END ) administereddrug,       a.dosage_seq_no, TO_CHAR (a.sch_date_time, 'DD/MM/YYYY HH24:MI') sch_date_time, a.admin_recorded_yn, a.administered_yn, a.verify_reqd_yn, a.verification_status, a.medn_admin_status, NVL (a.iv_admin_yn, 'N') iv_admin_yn, DECODE (d.disc_date_time, NULL, 'N', 'Y') discontinued, DECODE (d.hold_date_time, NULL, 'N', 'Y') held, a.patient_id, a.pract_id, a.order_id, d.qty_value, d.qty_unit, d.freq_code, a.order_line_num, NVL ((SELECT disp_drug_code FROM ph_disp_dtl WHERE ph_disp_dtl.order_id = a.order_id AND ph_disp_dtl.order_line_no = a.order_line_num AND ROWNUM < 2), (CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN b.long_name ELSE 'FINAL PRODUCT' END ) ) drug_code,(CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN b.tpn_regimen_code ELSE 'FINAL PRODUCT' END ) pres_drug_code,(CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN NVL ((SELECT long_name FROM ph_tpn_regimen_lang_vw  ph_tpn_regimen, ph_disp_dtl WHERE ph_disp_dtl.disp_drug_code = ph_tpn_regimen.tpn_regimen_code AND ph_disp_dtl.order_id = a.order_id AND ph_disp_dtl.order_line_no = a.order_line_num AND language_id = ? AND ROWNUM < 2), b.long_name ) ELSE (SELECT mfg_unit FROM ph_tpn_worksheet_hdr HDR WHERE EXISTS ( SELECT distinct tpn_worksheet_id FROM ph_tpn_worksheet_dtl b WHERE order_id = (SELECT DISTINCT order_id FROM ph_medn_admin WHERE order_id = a.order_id AND order_line_num = a.order_line_num) AND b.tpn_worksheet_id = HDR.tpn_worksheet_id)AND ROWNUM<2) END ) drug_desc,NVL (f.admin_dosage_qty, sch_dosage_qty) qty,  l.short_desc, a.iv_ingrediants, a.sch_infusion_rate, a.sch_infusion_vol_str_unit, a.sch_infusion_per_unit, a.sch_infusion_period, a.sch_infusion_period_unit, TO_CHAR (a.admin_date_time, 'DD/MM/YYYY HH24:MI') admin_date_time, TO_CHAR (a.modified_date, 'DD/MM/YYYY HH24:MI') modified_date, b.drug_class, b.item_code itemcode, TO_CHAR (d.end_date_time, 'DD/MM/YYYY HH24:MI') end_date_time, f.batch_id, TO_CHAR (f.expiry_date, 'DD/MM/YYYY') expiry_date, f.item_code, f.trade_id tradeid, g.short_name tradename, h.freq_nature, a.dosage_seq_no, TO_CHAR (a.against_schdose_date_time, 'DD/MM/YYYY HH24:MI' ) against_schdose_date_time, a.adr_reason_code, a.adr_remarks, TO_CHAR (a.adr_recorded_date_time, 'DD/MM/YYYY HH24:MI' ) adr_recorded_date_time, a.adr_recorded_by, i.prescribed_mode FROM ph_medn_admin a, ph_tpn_regimen_lang_vw b, or_order_line d, or_order e, ph_medn_admin_dtl f, am_trade_name_lang_vw g, am_frequency_lang_vw h, ph_patient_drug_profile i, am_uom_lang_vw l  WHERE h.freq_code = d.freq_code AND f.trade_id = g.trade_id(+) AND f.encounter_id(+) = a.encounter_id AND f.facility_id(+) = a.facility_id AND f.ord_drug_code(+) = a.ord_drug_code AND a.dosage_seq_no = f.dosage_seq_no(+) AND f.sch_date_time(+) = a.sch_date_time AND e.order_id = d.order_id AND i.orig_order_id = d.order_id AND i.orig_order_line_no = d.order_line_num AND e.order_id = i.orig_order_id AND a.ord_drug_code = b.tpn_regimen_code(+) AND a.order_id = d.order_id AND a.order_line_num = d.order_line_num AND a.facility_id =? AND a.encounter_id =? AND a.sch_date_time >= d.ord_date_time AND SYSDATE <= d.end_date_time AND d.can_date_time IS NULL AND e.iv_prep_yn IN (7, 8) AND h.language_id = ? AND b.language_id(+) = ? AND g.language_id(+) = ? and a.sch_dosage_uom_code = l.uom_code and l.language_id=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_TPN_SELECT3","SELECT a.order_id, a.order_line_num, e.iv_prep_yn,a.admin_recorded_by username, a.admin_authorized_by authorized_by,a.admin_remarks, a.non_admin_remarks,a.pract_id, a.admin_recorded_yn,f.admin_drug_code || ':'|| (SELECT long_name  FROM ph_tpn_regimen_lang_vw ph_tpn_regimen  WHERE tpn_regimen_code = f.admin_drug_code AND language_id = ?) || ':'|| f.admin_dosage_qty || ':'|| f.admin_dosage_uom_code administereddrug,a.admin_recorded_yn, a.dosage_seq_no,TO_CHAR (a.sch_date_time, 'DD/MM/YYYY HH24:MI') sch_date_time, a.iv_ingrediants,a.sch_infusion_rate, a.sch_infusion_vol_str_unit, a.sch_infusion_per_unit, a.sch_infusion_period,a.sch_infusion_period_unit,a.admin_recorded_yn, a.administered_yn, a.verify_reqd_yn,a.verification_status, a.medn_admin_status,NVL (a.iv_admin_yn, 'N') iv_admin_yn,DECODE (d.disc_date_time, NULL, 'N', 'Y') discontinued,DECODE (d.hold_date_time, NULL, 'N', 'Y') held, a.patient_id,d.freq_code,d.qty_value, d.qty_unit,  a.order_id,a.order_line_num,NVL ((SELECT disp_drug_code FROM ph_disp_dtl WHERE ph_disp_dtl.order_id = a.order_id AND ph_disp_dtl.order_line_no = a.order_line_num AND ROWNUM < 2), b.long_name ) drug_code,b.tpn_regimen_code pres_drug_code,NVL ((SELECT long_name FROM ph_tpn_regimen_lang_vw ph_tpn_regimen, ph_disp_dtl WHERE ph_disp_dtl.disp_drug_code =  ph_tpn_regimen.tpn_regimen_code AND ph_disp_dtl.order_id = a.order_id AND ph_disp_dtl.order_line_no = a.order_line_num AND ROWNUM < 2),b.long_name ) drug_desc, NVL (f.admin_dosage_qty, sch_dosage_qty) qty, l.short_desc, TO_CHAR (a.admin_date_time, 'DD/MM/YYYY HH24:MI') admin_date_time,TO_CHAR (a.modified_date, 'DD/MM/YYYY HH24:MI') modified_date, b.drug_class,e.iv_prep_yn, b.item_code itemcode,TO_CHAR (d.end_date_time, 'DD/MM/YYYY HH24:MI') end_date_time, f.batch_id, TO_CHAR (f.expiry_date, 'DD/MM/YYYY') expiry_date,f.item_code, f.trade_id tradeid, g.short_name tradename, h.freq_nature,a.dosage_seq_no,TO_CHAR (a.against_schdose_date_time,'DD/MM/YYYY HH24:MI') against_schdose_date_time,a.adr_reason_code, a.adr_remarks,TO_CHAR (a.adr_recorded_date_time,'DD/MM/YYYY HH24:MI') adr_recorded_date_time, a.adr_recorded_by  FROM ph_medn_admin a,ph_tpn_regimen_lang_vw b,or_order_line d,or_order e,ph_medn_admin_dtl f,am_trade_name_lang_vw g,am_frequency_lang_vw h,ph_patient_drug_profile i, am_uom_lang_vw l WHERE h.freq_code = d.freq_code   AND f.trade_id = g.trade_id(+)   AND f.encounter_id(+) = a.encounter_id   AND f.facility_id(+) = a.facility_id AND f.ord_drug_code(+) = a.ord_drug_code   AND a.dosage_seq_no = f.dosage_seq_no(+) AND f.sch_date_time(+) = a.sch_date_time   AND e.order_id = d.order_id  AND i.orig_order_id = d.order_id   AND i.orig_order_line_no = d.order_line_num AND e.order_id = i.orig_order_id   AND a.ord_drug_code = b.tpn_regimen_code AND a.order_id = d.order_id   AND a.order_line_num = d.order_line_num    AND a.facility_id = ?   AND a.encounter_id = ? AND TO_DATE (TO_CHAR (a.sch_date_time, 'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY HH24:MI') = TO_DATE (?, 'DD/MM/YYYY HH24:MI') AND a.order_id=? AND b.tpn_regimen_code = NVL (?, b.tpn_regimen_code) AND a.sch_date_time >= d.ord_date_time  AND SYSDATE <= d.end_date_time   AND d.can_date_time IS NULL  AND e.iv_prep_yn IN (7, 8) AND b.language_id = h.language_id AND b.language_id = ? AND g.language_id(+) = ? and a.sch_dosage_uom_code = l.uom_code and l.language_id=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT2","SELECT /*+ INDEX(d or_order_line_pk*/ a.order_id, a.order_line_num, e.iv_prep_yn, a.admin_recorded_by username, a.admin_authorized_by authorized_by, a.admin_remarks, a.non_admin_remarks, a.admin_recorded_yn, (CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN ( f.admin_drug_code || ':' || (SELECT drug_desc FROM ph_drug_lang_vw ph_drug WHERE drug_code = f.admin_drug_code AND language_id = ?) || ':' || f.admin_dosage_qty || ':' || f.admin_dosage_uom_code ) WHEN a.ord_drug_code = 'FINAL PRODUCT' AND NVL (administered_yn, 'N') = 'Y' THEN 'FINAL PRODUCT:' || ( (SELECT mfg_unit FROM ph_worksheet_hdr WHERE order_id = a.order_id AND ROWNUM<2 ) || ':' || f.admin_dosage_qty || ':' || f.admin_dosage_uom_code ) END ) administereddrug, a.dosage_seq_no, TO_CHAR (a.sch_date_time, 'DD/MM/YYYY HH24:MI') sch_date_time, a.admin_recorded_yn, a.administered_yn, a.verify_reqd_yn, a.verification_status, a.medn_admin_status, NVL (a.iv_admin_yn, 'N') iv_admin_yn, DECODE (d.disc_date_time, NULL, 'N', 'Y') discontinued, DECODE (d.hold_date_time, NULL, 'N', 'Y') held, a.patient_id, a.pract_id, a.order_id, d.qty_value, d.qty_unit, d.freq_code, a.order_line_num, NVL ((SELECT disp_drug_code FROM ph_disp_dtl WHERE ph_disp_dtl.order_id = a.order_id AND ph_disp_dtl.order_line_no = a.order_line_num AND ROWNUM < 2), (CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN b.drug_code ELSE 'FINAL PRODUCT' END ) ) drug_code, (CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN b.drug_code ELSE 'FINAL PRODUCT' END ) pres_drug_code, (CASE WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN NVL ((SELECT drug_desc FROM ph_drug_lang_vw ph_drug, ph_disp_dtl WHERE ph_disp_dtl.disp_drug_code = ph_drug.drug_code AND ph_disp_dtl.order_id = a.order_id AND ph_disp_dtl.order_line_no = a.order_line_num AND language_id = ? AND ROWNUM < 2 ), b.drug_desc ) ELSE (SELECT mfg_unit FROM ph_worksheet_hdr WHERE order_id = a.order_id AND ROWNUM<2 ) END ) drug_desc, NVL (f.admin_dosage_qty, sch_dosage_qty) qty, l.short_desc, b.disp_multi_strength_yn, a.iv_ingrediants, a.sch_infusion_rate, a.sch_infusion_vol_str_unit, a.sch_infusion_per_unit, a.sch_infusion_period, a.sch_infusion_period_unit, TO_CHAR (a.admin_date_time, 'DD/MM/YYYY HH24:MI') admin_date_time, TO_CHAR (a.modified_date, 'DD/MM/YYYY HH24:MI') modified_date, b.drug_class, b.item_code itemcode, TO_CHAR (d.end_date_time, 'DD/MM/YYYY HH24:MI') end_date_time, f.batch_id, TO_CHAR (f.expiry_date, 'DD/MM/YYYY') expiry_date, f.item_code, f.trade_id tradeid, g.short_name tradename, h.freq_nature, a.dosage_seq_no, TO_CHAR (a.against_schdose_date_time, 'DD/MM/YYYY HH24:MI' ) against_schdose_date_time, a.adr_reason_code, a.adr_remarks, TO_CHAR (a.adr_recorded_date_time, 'DD/MM/YYYY HH24:MI' ) adr_recorded_date_time, a.adr_recorded_by, i.prescribed_mode,B.MEDN_ADMN_DTL_REQD_YN, i.PRN_REMARKS, i.SLIDING_SCALE_REMARKS, j.action_seq_num,k.order_line_seq_num FROM ph_medn_admin a, ph_drug_lang_vw b, or_order_line d, or_order e, ph_medn_admin_dtl f, am_trade_name_lang_vw g, am_frequency_lang_vw h, ph_patient_drug_profile i, or_order_comment j, or_order_line_field_values k, am_uom_lang_vw l WHERE h.freq_code = d.freq_code AND f.trade_id = g.trade_id(+) AND f.encounter_id(+) = a.encounter_id AND f.facility_id(+) = a.facility_id AND f.ord_drug_code(+) = a.ord_drug_code AND a.dosage_seq_no = f.dosage_seq_no(+) AND f.sch_date_time(+) = a.sch_date_time AND f.order_id(+) = a.order_id AND e.order_id = d.order_id AND i.orig_order_id = d.order_id AND i.orig_order_line_no = d.order_line_num AND e.order_id = i.orig_order_id AND a.ord_drug_code = b.drug_code(+) AND a.order_id = d.order_id AND a.order_line_num = d.order_line_num AND a.order_id = j.order_id(+) AND a.order_id = k.order_id(+) and a.order_line_num = k.order_line_num(+) and k.order_line_seq_num(+) = 1 AND a.facility_id = ? AND a.encounter_id = ? AND a.sch_date_time >= d.ord_date_time AND d.can_date_time IS NULL AND d.order_id = NVL ('', d.order_id) AND d.order_line_num = NVL ('', d.order_line_num) AND a.order_id = NVL ('', a.order_id) AND a.order_line_num = NVL ('', a.order_line_num) AND a.encounter_id = NVL ('', a.encounter_id) AND a.facility_id = NVL ('', a.facility_id) AND h.language_id = ? AND g.language_id(+) = ? AND b.language_id(+) = ? and a.sch_dosage_uom_code = l.uom_code and l.language_id=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT3", "SELECT DISP_MULTI_STRENGTH_YN FROM PH_DRUG WHERE DRUG_CODE=?");

		/*
		This query selects trade name,expiry date and a flag that checks if expiry date is past for a particular item_code
		parameter1:item_code
		parameter 2:batch id
		*/
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT4", "SELECT CASE WHEN TRUNC(B.EXPIRY_DATE_OR_RECEIPT_DATE)<TRUNC(SYSDATE)  THEN 'Y' ELSE   'N' END EXPIRED,  A.SHORT_NAME TRADE_NAME,TO_CHAR(B.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE,A.TRADE_ID FROM AM_TRADE_NAME_LANG_VW A,ST_ITEM_BATCH B WHERE B.TRADE_ID=A.TRADE_ID(+) AND B.ITEM_CODE=? AND B.BATCH_ID=? AND A.LANGUAGE_ID(+) =?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT4A", "SELECT B.BATCH_ID,CASE WHEN TRUNC(B.EXPIRY_DATE_OR_RECEIPT_DATE)<TRUNC(SYSDATE)  THEN 'Y' ELSE   'N' END EXPIRED,  A.SHORT_NAME TRADE_NAME,TO_CHAR(B.EXPIRY_DATE_OR_RECEIPT_DATE,'DD/MM/YYYY') EXPIRY_DATE,A.TRADE_ID FROM AM_TRADE_NAME A,ST_ITEM_BATCH B WHERE B.TRADE_ID=A.TRADE_ID(+) ");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT5", "SELECT TO_CHAR(SYSDATE,'HH24:MI') TIME,TO_CHAR(SYSDATE+(24/(24*60*60))*226,'HH24:MI') FUTURE_TIME,TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI') DATE_TIME,REC_ADMIN_WITHIN_HRS FROM PH_FACILITY_PARAM  WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT6","SELECT   /*+ FIRST_ROWS */ A.ORDER_ID,  A.ORDER_LINE_NUM,  E.IV_PREP_YN,A.ADMIN_RECORDED_BY USERNAME,  A.ADMIN_AUTHORIZED_BY AUTHORIZED_BY,  A.ADMIN_REMARKS,  A.NON_ADMIN_REMARKS,  A.PRACT_ID,A.ADMIN_RECORDED_YN,  F.ADMIN_dRUG_CODE||':'||(SELECT DRUG_DESC FROM  PH_DRUG_LANG_VW PH_DRUG WHERE   DRUG_CODE = F.ADMIN_dRUG_CODE AND LANGUAGE_ID = ?)|| ':'||F.admin_dosage_qty||':'||F.admin_dosage_uom_code   ADMINISTEREDDRUG,       A.ADMIN_RECORDED_YN, 	A.DOSAGE_SEQ_NO,  TO_CHAR(A.SCH_DATE_TIME,   'DD/MM/YYYY HH24:MI')        SCH_DATE_TIME,	  A.IV_INGREDIANTS,A.SCH_INFUSION_RATE,A.SCH_INFUSION_VOL_STR_UNIT,       A.SCH_INFUSION_PER_UNIT,	A.SCH_INFUSION_PERIOD,A.SCH_INFUSION_PERIOD_UNIT,         A.ADMIN_RECORDED_YN,	A.ADMINISTERED_YN, A.VERIFY_REQD_YN,   A.VERIFICATION_STATUS,        A.MEDN_ADMIN_STATUS,   	NVL(A.IV_ADMIN_YN,   'N') IV_ADMIN_YN,  	 	   DECODE(D.DISC_DATE_TIME,   NULL,   'N',   'Y') DISCONTINUED,   	DECODE(D.HOLD_DATE_TIME,   NULL,   'N',   'Y') HELD , A.PATIENT_ID,   D.FREQ_CODE,D.QTY_VALUE,D.QTY_UNIT,	 	     A.ORDER_ID,A.ORDER_LINE_NUM,  NVL( (SELECT DISP_DRUG_CODE  FROM PH_DISP_DTL   WHERE PH_DISP_DTL.ORDER_ID=A.ORDER_ID AND  PH_DISP_DTL.ORDER_LINE_NO=A.ORDER_LINE_NUM AND  ROWNUM<2),   B.DRUG_CODE) DRUG_CODE,  	  B.DRUG_CODE PRES_DRUG_CODE,   NVL(      (SELECT DRUG_DESC FROM PH_DRUG_LANG_VW PH_DRUG,PH_DISP_DTL WHERE         PH_DISP_DTL.DISP_DRUG_CODE=PH_DRUG.DRUG_CODE    AND  PH_DISP_DTL.ORDER_ID=A.ORDER_ID AND  PH_DISP_DTL.ORDER_LINE_NO=A.ORDER_LINE_NUM   AND LANGUAGE_ID = ? AND  ROWNUM<2 ),B.DRUG_DESC)DRUG_DESC,   	 	    NVL(F.ADMIN_DOSAGE_QTY, SCH_DOSAGE_QTY) QTY, l.short_desc,  	          b.DISP_MULTI_STRENGTH_YN,TO_CHAR(A.ADMIN_DATE_TIME,'DD/MM/YYYY HH24:MI')     ADMIN_DATE_TIME,   TO_CHAR(A.MODIFIED_DATE,'DD/MM/YYYY HH24:MI') MODIFIED_DATE ,      B.DRUG_CLASS ,E.IV_PREP_YN ,B.ITEM_CODE ITEMCODE ,    TO_CHAR(D.END_DATE_TIME,'DD/MM/YYYY HH24:MI' ) END_DATE_TIME ,F.BATCH_ID ,  TO_CHAR(F.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,  F.ITEM_CODE,  F.trade_id TRADEID,G.short_name TRADENAME ,H.FREQ_NATURE,A.DOSAGE_SEQ_NO,TO_CHAR(A.AGAINST_SCHDOSE_DATE_TIME,'DD/MM/YYYY HH24:MI') AGAINST_SCHDOSE_DATE_TIME, A.ADR_REASON_CODE, A.ADR_REMARKS, TO_CHAR(A.ADR_RECORDED_DATE_TIME,'DD/MM/YYYY HH24:MI')ADR_RECORDED_DATE_TIME, A.ADR_RECORDED_BY, B.MEDN_ADMN_DTL_REQD_YN FROM PH_MEDN_ADMIN A,PH_DRUG_LANG_VW B,OR_ORDER_LINE D ,OR_ORDER E ,PH_MEDN_ADMIN_DTL F ,  AM_TRADE_NAME_LANG_VW G,AM_FREQUENCY_LANG_VW H, am_uom_lang_vw l WHERE H.FREQ_CODE=D.FREQ_CODE AND F.TRADE_ID = G.TRADE_ID(+) AND  F.encounter_id(+)=A.ENCOUNTER_ID AND  F.facility_id(+)=A.FACILITY_ID AND  F.ord_drug_code(+)=A.ORD_drug_code AND  A.dosage_seq_no=F.dosage_seq_no(+) AND  F.sch_date_time(+)=A.SCH_DATE_TIME AND  A.ORD_DRUG_CODE=B.DRUG_CODE     AND  E.ORDER_ID   = D.ORDER_ID AND  A.FACILITY_ID=? AND  D.ORDER_ID=A.ORDER_ID  AND  D.ORDER_LINE_NUM=A.ORDER_LINE_NUM  AND  A.ENCOUNTER_ID =? AND  a.sch_date_time>=d.ord_date_time AND TO_DATE(TO_CHAR(A.sch_date_time,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY HH24:MI')= TO_DATE(?,'DD/MM/YYYY HH24:MI') AND A.ORDER_ID=? AND B.DRUG_CODE=NVL(?,B.DRUG_CODE)  AND b.language_id = h.language_id AND b.language_id = ? AND g.language_id(+) =? and a.sch_dosage_uom_code = l.uom_code and l.language_id=?");

		
		//ORDER BY IV_ADMIN_YN

		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT7", "SELECT INVENTORY_ITEM_CODE FROM PH_INVENTORY_ITEM_FOR_DRUG WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT9","SELECT GENERIC_ID,ROUTE_CODE,FORM_CODE,STRENGTH_VALUE,STRENGTH_UOM,DRUG_CLASS FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT10","SELECT DISTINCT A.BATCH_ID,TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,A.ITEM_CODE,D.TRADE_ID,(SELECT SHORT_NAME FROM AM_TRADE_NAME WHERE TRADE_ID=D.TRADE_ID) TRADE_NAME FROM PH_DISP_DRUG_BATCH A,PH_DISP_DTL B, PH_DISP_HDR C,ST_ITEM_BATCH D WHERE  A.FACILITY_ID=B.FACILITY_ID AND A.DISP_NO=B.DISP_NO AND A.SRL_NO=B.SRL_NO AND B.FACILITY_ID=C.FACILITY_ID AND B.DISP_NO=C.DISP_NO AND A.ITEM_CODE=D.ITEM_CODE(+) AND A.BATCH_ID=D.BATCH_ID(+) AND A.DRUG_CODE=? AND C.FACILITY_ID=? AND C.ENCOUNTER_ID=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT11","SELECT ALLOW_MED_ADMIN_WO_ORD_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT12","SELECT PERFORMING_DEPTLOC_CODE FROM OR_ORDER WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT13","SELECT FREQ_NATURE FROM AM_FREQUENCY WHERE FREQ_CODE=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT14", "SELECT PRACT_TYPE FROM AM_PRACTITIONER  WHERE EFF_STATUS='E' AND PRACTITIONER_ID= ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT15", "SELECT TO_CHAR(AGAINST_SCHDOSE_DATE_TIME,'DD/MM/YYYY HH24:MI') AGAINST_SCHDOSE_DATE_TIME, ADR_REASON_CODE, ADR_REMARKS, TO_CHAR(ADR_RECORDED_DATE_TIME,'DD/MM/YYYY HH24:MI')ADR_RECORDED_DATE_TIME, ADR_RECORDED_BY FROM PH_MEDN_ADMIN  WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND ORD_DRUG_CODE=? AND ORDER_ID=?"); 
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT16", "SELECT COUNT(*) COUNT FROM DUAL WHERE TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI')");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT17", "SELECT round(NVL(A.ORDER_QTY,0)-(NVL(B.TOT_ADMINISTERED_QTY,0)+?),4) DIFF_QTY FROM OR_ORDER_LINE A,PH_PATIENT_DRUG_PROFILE B WHERE A.ORDER_ID=B.ORIG_ORDER_ID  AND A.ORDER_LINE_NUM=B.ORIG_ORDER_LINE_NO AND A.ORDER_ID=? AND A.ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT18", "SELECT FREQ_NATURE FROM AM_FREQUENCY WHERE FREQ_CODE=(SELECT FREQ_CODE FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?)");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT19", "SELECT NVL(MAX(SRL_NO),0)+1 NXT_SRL_NO FROM PH_MEDN_ADMIN_DTL WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND ORD_DRUG_CODE=? AND DOSAGE_SEQ_NO=? and order_id=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT20", "select distinct TO_CHAR(SCH_DATE_TIME,'DD/mm/yyyy')dates,TRUNC(SCH_DATE_TIME) SCH_DATE from ph_medn_admin where  encounter_id=TO_NUMBER(?)");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT20A", "select distinct TO_CHAR(SCH_DATE_TIME,'DD/mm/yyyy')dates,TRUNC(SCH_DATE_TIME) SCH_DATE  from ph_medn_admin A ,OR_ORDER_LINE B where  encounter_id=TO_NUMBER(?) AND A.ORDER_ID=B.ORDER_ID AND A.ORDER_LINE_NUM=B.ORDER_LINE_NUM AND ORDER_LINE_STATUS!='CN'");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT21", " select distinct TO_CHAR(SCH_DATE_TIME,'HH24:MI'), a.dosage_seq_no, F.FREQ_NATURE from ph_medn_admin A,OR_ORDER_LINE B, am_frequency f where  trunc(SCH_DATE_TIME)=to_date(?,'dd/mm/yyyy')  AND A.ORDER_ID=B.ORDER_ID AND A.ORDER_LINE_NUM=B.ORDER_LINE_NUM AND ORDER_LINE_STATUS!='CN' and b.FREQ_CODE = F.FREQ_CODE ");
		//dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT21A", "select distinct TO_CHAR(SCH_DATE_TIME,'HH24:MI'),ord_date_time from ph_medn_admin a,or_order b where trunc(SCH_DATE_TIME)=to_date(?,'dd/mm/yyyy') and a.sch_date_time >=b.ord_date_time and a.order_id=b.order_id and a.encounter_id=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT21A", "select distinct TO_CHAR(SCH_DATE_TIME,'HH24:MI'),ord_date_time, a.dosage_seq_no, b.ord_date_time, F.FREQ_NATURE from ph_medn_admin a,or_order b, or_order_line c, am_frequency f where trunc(SCH_DATE_TIME)=to_date(?,'dd/mm/yyyy')  and a.order_id=b.order_id and a.encounter_id=? and a.order_id= c.order_id and a.order_line_num = c.order_line_num and C.FREQ_CODE = F.FREQ_CODE");
		//dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT22", "SELECT DISTINCT a.ord_drug_code, a.sch_dosage_uom_code,(case when (c.iv_prep_yn = '7' or c.iv_prep_yn = '8') then (CASE WHEN a.ord_drug_code = 'FINAL PRODUCT' THEN (SELECT mfg_unit FROM ph_tpn_worksheet_hdr  WHERE tpn_worksheet_id =(SELECT DISTINCT tpn_worksheet_id FROM ph_tpn_worksheet_dtl WHERE order_id =(SELECT DISTINCT order_id FROM ph_medn_admin WHERE order_id = a.order_id AND order_line_num = a.order_line_num))) WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN (SELECT long_name FROM ph_tpn_regimen WHERE tpn_regimen_code = a.ord_drug_code) END)else(CASE WHEN a.ord_drug_code = 'FINAL PRODUCT' THEN (SELECT mfg_unit FROM ph_worksheet_hdr WHERE worksheet_id =(SELECT DISTINCT worksheet_id FROM ph_worksheet_dtl WHERE order_id =(SELECT DISTINCT order_id FROM ph_medn_admin WHERE order_id =a.order_id AND order_line_num = a.order_line_num)and rownum<2)) WHEN a.ord_drug_code <> 'FINAL PRODUCT' then b.drug_desc END ) end) drug_desc, a.order_id, a.order_line_num FROM ph_medn_admin a, ph_drug b, or_order c WHERE TRUNC (sch_date_time) = TO_DATE (?, 'dd/mm/yyyy') AND a.ord_drug_code = b.drug_code(+) AND a.encounter_id =? and a.order_id = c.order_id and   a.patient_id = c.patient_id ORDER BY a.order_id, a.order_line_num");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT22", "SELECT DISTINCT a.ord_drug_code, a.sch_dosage_uom_code,(CASE  WHEN (c.iv_prep_yn = '7' OR c.iv_prep_yn = '8')  THEN (CASE  WHEN a.ord_drug_code = 'FINAL PRODUCT' THEN (SELECT mfg_unit   FROM ph_tpn_worksheet_hdr   WHERE order_id = a.order_id and rownum<2)  WHEN a.ord_drug_code <> 'FINAL PRODUCT'   THEN (SELECT long_name FROM ph_tpn_regimen_lang_vw ph_tpn_regimen WHERE tpn_regimen_code = a.ord_drug_code and language_id = ?) END ) ELSE (CASE WHEN a.ord_drug_code = 'FINAL PRODUCT'  THEN (SELECT mfg_unit  FROM ph_worksheet_hdr   WHERE order_id = a.order_id and rownum<2) WHEN a.ord_drug_code <> 'FINAL PRODUCT' THEN b.drug_desc  END ) END ) drug_desc,  a.order_id, a.order_line_num,d.order_line_status,b.drug_class,e.pract_type FROM ph_medn_admin a, ph_drug_lang_vw b, or_order c,or_order_line d ,am_practitioner_lang_vw e WHERE TRUNC (sch_date_time) = TO_DATE (?, 'dd/mm/yyyy')  AND a.ord_drug_code = b.drug_code(+)AND a.encounter_id = ?  AND a.order_id = c.order_id	AND a.order_id = d.order_id	AND a.order_line_num = d.order_line_num	 AND a.patient_id = c.patient_id  and c.ord_pract_id =e.practitioner_id and b.language_id(+) = ?  and e.language_id = ? AND ORDER_LINE_STATUS!='CN' ORDER BY a.order_id, a.order_line_num");

		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT22A", "select distinct a.ord_drug_code,a.sch_dosage_uom_code,b.drug_desc,a.order_id,a.ORDER_LINE_NUM,b.DRUG_CLASS,a.ADMINISTERED_YN,a.ADMIN_RECORDED_YN,c.iv_prep_yn,a.ORDER_LINE_NUM from ph_medn_admin a,ph_drug b,or_order c where trunc(SCH_DATE_TIME)=to_date(?,'dd/mm/yyyy')and a.ord_drug_code=b.drug_code and c.order_id=a.order_id and a.encounter_id=? order by c.iv_prep_yn,a.order_id,a.ORDER_LINE_NUM");
        dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT23", "select TO_CHAR(SCH_DATE_TIME,'HH24:MI'),sch_dosage_qty,admin_recorded_yn,TO_CHAR(admin_recorded_date_time,'DD/mm/yyyy'),administered_yn,order_id,ADR_REMARKS,ADR_RECORDED_DATE_TIME,ADR_RECORDED_BY,ADR_REASON_CODE,ADDED_BY_ID,ORDER_LINE_NUM, DOSAGE_SEQ_NO from ph_medn_admin where ord_drug_code= ? and  trunc(SCH_DATE_TIME)=to_date(?,'dd/mm/yyyy') and order_id=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT24","SELECT DRUG_DESC, DRUG_CODE, SCH_DOSAGE_UOM_CODE,   ORDER_LINE_NUM, PATIENT_ID, TO_CHAR (SCH_DATE_TIME, 'DD/MM/YYYY') SCH_DATE,A.SCH_DOSAGE_QTY, TO_CHAR (SCH_DATE_TIME, 'HH24:MI') SCH_TIME ,FACILITY_ID,ENCOUNTER_ID,ORDER_ID,ADMINISTERED_YN,TO_CHAR (SCH_DATE_TIME, 'DD/MM/YYYY  HH24:MI') SCH_DATE1, ADMIN_RECORDED_YN, DRUG_CLASS FROM PH_MEDN_ADMIN A, PH_DRUG B, AM_FREQUENCY  WHERE  A.ORD_DRUG_CODE = B.DRUG_CODE  AND A.PATIENT_ID=? AND SCH_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI')  AND TO_DATE(?,'DD/MM/YYYY HH24:MI') ORDER BY SCH_DATE_TIME,ORDER_ID,ORDER_LINE_NUM");
        dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT25", "select count(*) from dual where ( to_date(to_char(sysdate,'dd/mm/yyyy hh24:mi'),'dd/mm/yyyy hh24:mi') >= to_date(?,'dd/mm/yyyy hh24:mi'))");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT26", "SELECT  TO_CHAR((end_date_time)+(1/(24*60)),'dd/mm/yyyy hh24:mi') end_date,to_char(sysdate,'dd/mm/yyyy hh24:mi') curr_date from or_order_line where order_id=? and order_line_num=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT27","select iv_prep_yn from or_order where order_id=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT28","select order_line_status from or_order_line where order_id=? and order_line_num=?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT29","SELECT COUNT(*) FROM  OR_USERS_TAB WHERE PRACTITIONER_ID = OR_USER_TAB_FOR_PRACT_CLASS(?,'IP','P','MEDICATION_ADMIN') AND PATIENT_CLASS  = OR_USER_TAB_FOR_PRACT_CLASS(?,'IP','C','MEDICATION_ADMIN') AND SYS_TAB_NAME ='newOrders' AND FUNCTION_ID= 'MEDICATION_ADMIN'");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT30", "SELECT AUTO_DISP_AT_ADMIN_YN FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?");
		//dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT31","SELECT A.SHORT_NAME NATIONALITY,C.PATIENT_NAME,DECODE(C.SEX,   'M',   'male',   'F',   'female',   'unknown') GENDER,GET_AGE(C.DATE_OF_BIRTH) AGE FROM    MP_COUNTRY_LANG_VW A,MP_PATIENT C WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND C.PATIENT_ID=?  AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT31","SELECT A.SHORT_NAME NATIONALITY,nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME,DECODE(C.SEX,   'M',   'male',   'F',   'female',   'unknown') GENDER,GET_AGE(C.DATE_OF_BIRTH) AGE,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB FROM    MP_COUNTRY_LANG_VW A,MP_PATIENT C WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND C.PATIENT_ID=?  AND A.LANGUAGE_ID = ?");
		//TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB added for ARYU-SCF-023
		dataMap.put("SQL_PH_MED_ADMIN_ORDER_QTY_SELECT32","SELECT ORDER_QTY FROM OR_ORDER_LINE WHERE ORDER_ID=?  AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_MED_ADMIN_LABEL_CAU_SELECT33","SELECT CAUTION_LABEL_TEXT_ID_1,SPL_INSTR_LABEL_TEXT_ID,HOW_TO_TAKE_TEXT FROM PH_DRUG WHERE DRUG_CODE=?");
       	dataMap.put("SQL_PH_MED_ADMIN_OR_ORDER_LINE_STATUS_UPDATE","UPDATE  OR_ORDER_LINE SET ORDER_LINE_STATUS=? ,MODIFIED_BY_ID=?, MODIFIED_DATE=sysdate, MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE ORDER_ID=?  AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_MEDN_ADMIN_FT_INSERT2","INSERT INTO PH_MEDN_ADMIN (FACILITY_ID,ENCOUNTER_ID,SCH_DATE_TIME,ORD_DRUG_CODE,DOSAGE_SEQ_NO,ORDER_ID,ORDER_LINE_NUM,PATIENT_ID,PRACT_ID,SCH_DOSAGE_QTY,SCH_DOSAGE_UOM_CODE,SCH_STRENGTH,SCH_STRENGTH_UOM,SCH_ROUTE_CODE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,VERIFY_REQD_YN,ADMINISTERED_YN) (SELECT FACILITY_ID,ENCOUNTER_ID,TO_DATE(TO_CHAR((SYSDATE+1/1440),'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY HH24:MI') SDATE,ORD_DRUG_CODE,(DOSAGE_SEQ_NO)+1,ORDER_ID,ORDER_LINE_NUM,PATIENT_ID,PRACT_ID,?,SCH_DOSAGE_UOM_CODE,SCH_STRENGTH,SCH_STRENGTH_UOM,SCH_ROUTE_CODE,?,SYSDATE,?,?,?,SYSDATE,?,?,VERIFY_REQD_YN,'N' FROM PH_MEDN_ADMIN WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND ORD_DRUG_CODE=? AND ORDER_ID=? AND ORDER_LINE_NUM=?)");
		//ADMIN_CODE ADDED FOR MMS-KH-CRF-0010
		dataMap.put("SQL_PH_MEDN_ADMIN_FT_UPDATE","UPDATE PH_MEDN_ADMIN SET ADMIN_NURSING_UNIT_CODE=?, ADMIN_BED_NO=?, ADMIN_BY = ? , ADMIN_REMARKS=?, NON_ADMIN_REMARKS=?,ADMIN_RECORDED_YN=?, ADMIN_RECORDED_DATE_TIME=SYSDATE,  ADMIN_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ADMINISTERED_YN=? ,MODIFIED_FACILITY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?, MODIFIED_AT_WS_NO=? ADMIN_CODE=?,NON_ADMIN_CODE = ?,ADMIN_RECORDED_BY  = ? ,ADMIN_AUTHORIZED_BY = ?,AGAINST_SCHDOSE_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ADR_REASON_CODE=?, ADR_REMARKS=?, ADR_RECORDED_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ADR_RECORDED_BY=? WHERE   FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND ORD_DRUG_CODE=? AND DOSAGE_SEQ_NO=? and order_id=?");
		dataMap.put("SQL_PH_MEDN_ADMIN_UPDATE2","UPDATE PH_MEDN_ADMIN SET AGAINST_SCHDOSE_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),ADR_REASON_CODE=?, ADR_REMARKS=?, ADR_RECORDED_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ADR_RECORDED_BY=?,MODIFIED_BY_ID=?, MODIFIED_DATE=sysdate, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND ORD_DRUG_CODE=? AND ORDER_ID=? ");
		dataMap.put("SQL_PH_MEDN_ADMIN_COULD_NOT_ADMIN","UPDATE ph_medn_admin SET admin_nursing_unit_code = ?, admin_bed_no = ?, admin_recorded_yn = ?, non_admin_code = ?, non_admin_remarks = ?, admin_recorded_by = ?, admin_recorded_date_time = SYSDATE, admin_date_time = SYSDATE, administered_yn = ?, admin_by = ?, ADMIN_AUTHORIZED_BY=?, modified_facility_id = ?, modified_date = SYSDATE, modified_by_id = ?, modified_at_ws_no = ? WHERE facility_id = ? AND encounter_id = ? AND sch_date_time = TO_DATE (?, 'DD/MM/YYYY HH24:MI') AND ord_drug_code = ? AND dosage_seq_no = ? AND order_id = ?");
		dataMap.put("SQL_PH_MEDN_ADMIN_FT_IV_UPDATE1","UPDATE PH_MEDN_ADMIN SET ADMIN_REMARKS=?,ADMIN_BY=?,ADMIN_AUTHORIZED_BY=?,MODIFIED_DATE=SYSDATE,  MODIFIED_BY_ID=?, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ORD_DRUG_CODE=? AND ORDER_ID=? AND ENCOUNTER_ID=?");
		//ADMIN_CODE ADDED FOR MMS-KH-CRF-0010
		dataMap.put("SQL_PH_MEDN_ADMIN_FT_IV_UPDATE","UPDATE PH_MEDN_ADMIN SET ADMIN_NURSING_UNIT_CODE=?, ADMIN_BED_NO=?, ADMIN_BY = ? , ADMIN_REMARKS=?, NON_ADMIN_REMARKS=?,ADMIN_RECORDED_YN=?, ADMIN_RECORDED_DATE_TIME=SYSDATE,  ADMIN_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ADMINISTERED_YN=? ,MODIFIED_FACILITY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?, MODIFIED_AT_WS_NO=? ,SCH_INFUSION_RATE=?, SCH_INFUSION_VOL_STR_UNIT=?, SCH_INFUSION_PER_UNIT=?, SCH_INFUSION_PERIOD=?, SCH_INFUSION_PERIOD_UNIT=? ADMIN_CODE=?,NON_ADMIN_CODE = ?,ADMIN_RECORDED_BY  = ? ,ADMIN_AUTHORIZED_BY = ?,AGAINST_SCHDOSE_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ADR_REASON_CODE=?, ADR_REMARKS=?, ADR_RECORDED_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ADR_RECORDED_BY=? WHERE   FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND ORD_DRUG_CODE=? AND DOSAGE_SEQ_NO=? and order_id =?");
		dataMap.put("SQL_PH_MEDN_ADMIN_FT_INSERT","INSERT INTO PH_MEDN_ADMIN (FACILITY_ID, ENCOUNTER_ID, SCH_DATE_TIME, ORD_DRUG_CODE, DOSAGE_SEQ_NO, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN, IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM, SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT, ADMIN_RECORDED_YN, ADMIN_RECORDED_DATE_TIME, ADMINISTERED_YN, ADMIN_DATE_TIME, ADMIN_NURSING_UNIT_CODE, ADMIN_BED_NO, ADMIN_REMARKS, NON_ADMIN_REMARKS, VERIFY_REQD_YN, VERIFICATION_STATUS, MEDN_ADMIN_STATUS, ADMIN_BY, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT) VALUES(?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_PH_MED_ADMIN_FT_IV_NXT_SCH_SELECT32","SELECT A.INFUSE_OVER INFUSE_OVER ,B.DURN_VALUE DURN_VALUE ,B.DURN_TYPE DURN_TYPE,TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE_TIME,INFUSE_OVER_UNIT FROM OR_ORDER_LINE_PH A, OR_ORDER_LINE B WHERE A.ORDER_ID=B.ORDER_ID AND A.ORDER_LINE_NUM = B.ORDER_LINE_NUM AND A.ORDER_ID =(?) AND A.ORDER_LINE_NUM ='1'");
		dataMap.put("SQL_PH_MED_ADMIN_FT_IV_NXT_SCH_SELECT33","SELECT TO_CHAR(TO_DATE((?),'DD/MM/YYYY HH24:MI')+((?)/24),'DD/MM/YYYY HH24:MI') NEXT_SCHD_TIME FROM DUAL");
		dataMap.put("SQL_PH_MED_ADMIN_FT_IV_NXT_SCH_SELECT33M","SELECT TO_CHAR(TO_DATE((?),'DD/MM/YYYY HH24:MI')+(((?)/60)/24),'DD/MM/YYYY HH24:MI') NEXT_SCHD_TIME FROM DUAL");


		//Query commented 
		//dataMap.put("SQL_PH_MEDN_ADMIN_FT_INSERT1","INSERT INTO PH_MEDN_ADMIN (FACILITY_ID, ENCOUNTER_ID, SCH_DATE_TIME, ORD_DRUG_CODE,DOSAGE_SEQ_NO, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN,IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM,SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT,ADMIN_RECORDED_YN, ADMIN_RECORDED_DATE_TIME, ADMINISTERED_YN, ADMIN_DATE_TIME,ADMIN_NURSING_UNIT_CODE, ADMIN_BED_NO, ADMIN_REMARKS, NON_ADMIN_REMARKS,VERIFY_REQD_YN, VERIFICATION_STATUS, MEDN_ADMIN_STATUS, ADMIN_BY, ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT)(SELECT FACILITY_ID, ENCOUNTER_ID, TO_DATE(?,'DD/MM/YYYY HH24:MI'), ORD_DRUG_CODE,DOSAGE_SEQ_NO+1, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN,IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM,SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT,ADMIN_RECORDED_YN, ADMIN_RECORDED_DATE_TIME, ADMINISTERED_YN, ADMIN_DATE_TIME,ADMIN_NURSING_UNIT_CODE, ADMIN_BED_NO, ADMIN_REMARKS, NON_ADMIN_REMARKS,VERIFY_REQD_YN, VERIFICATION_STATUS, MEDN_ADMIN_STATUS, ADMIN_BY, ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT FROM PH_MEDN_ADMIN WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYYHH24:MI') AND ORD_DRUG_CODE=? AND ORDER_ID=? AND ORDER_LINE_NUM=?)");
		dataMap.put("SQL_PH_MEDN_ADMIN_FT_INSERT1","INSERT INTO PH_MEDN_ADMIN (FACILITY_ID, ENCOUNTER_ID, SCH_DATE_TIME, ORD_DRUG_CODE,DOSAGE_SEQ_NO, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN,IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM,SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT,VERIFY_REQD_YN, VERIFICATION_STATUS, MEDN_ADMIN_STATUS,  ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT)(SELECT FACILITY_ID, ENCOUNTER_ID, TO_DATE(?,'DD/MM/YYYY HH24:MI'), ORD_DRUG_CODE, DOSAGE_SEQ_NO+1, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN,IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM, SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT, VERIFY_REQD_YN, VERIFICATION_STATUS, MEDN_ADMIN_STATUS, ADDED_BY_ID, SYSDATE ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, SYSDATE MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT FROM PH_MEDN_ADMIN WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYYHH24:MI') AND ORD_DRUG_CODE=? AND ORDER_ID=? AND ORDER_LINE_NUM=?)");
		dataMap.put("SQL_PH_MEDN_ADMIN_FT_INSERTSCH","INSERT INTO PH_MEDN_ADMIN (FACILITY_ID, ENCOUNTER_ID, SCH_DATE_TIME, ORD_DRUG_CODE,DOSAGE_SEQ_NO, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN,IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM,SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT,VERIFY_REQD_YN, VERIFICATION_STATUS, MEDN_ADMIN_STATUS,  ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT)(SELECT FACILITY_ID, ENCOUNTER_ID, TO_DATE(?,'DD/MM/YYYY HH24:MI'), ORD_DRUG_CODE, ?, ORDER_ID, ORDER_LINE_NUM, PATIENT_ID, PRACT_ID, IV_ADMIN_YN,IV_INGREDIANTS, SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE, SCH_STRENGTH, SCH_STRENGTH_UOM, SCH_ROUTE_CODE, SCH_INFUSION_RATE, SCH_INFUSION_VOL_STR_UNIT, SCH_INFUSION_PER_UNIT, VERIFY_REQD_YN, VERIFICATION_STATUS, MEDN_ADMIN_STATUS, ADDED_BY_ID, SYSDATE ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, SYSDATE MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, SCH_INFUSION_PERIOD, SCH_INFUSION_PERIOD_UNIT FROM PH_MEDN_ADMIN a WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND dosage_seq_no= (select max(dosage_seq_no) from ph_medn_admin where facility_id = a.facility_id AND encounter_id = a.encounter_id AND ord_drug_code = a.ord_drug_code AND order_id = a.order_id AND order_line_num = a.order_line_num ) AND ORD_DRUG_CODE=? AND ORDER_ID=? AND ORDER_LINE_NUM=?)");

		//query altered ...added DISP_BATCH_ID 1/12/2004 altered on 8.12.2004 added disp_expiry_date,disp_trade_id
		dataMap.put("SQL_PH_MEDN_ADMIN_DTL_FT_INSERT","INSERT INTO PH_MEDN_ADMIN_DTL ( FACILITY_ID, ENCOUNTER_ID,  SCH_DATE_TIME,  ORD_DRUG_CODE, DOSAGE_SEQ_NO, SRL_NO,  ADMIN_DRUG_CODE, ADMIN_DOSAGE_QTY,  ADMIN_DOSAGE_UOM_CODE,  ADMIN_STRENGTH, ADMIN_STRENGTH_UNIT, ADMIN_INFUSION_RATE, ADMIN_INFUSION_VOL_STR_UNIT, ADMIN_INFUSION_PER_UNIT, ADMIN_BY,  ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,  ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,  MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, ITEM_CODE,  BATCH_ID, EXPIRY_DATE, TRADE_ID,DISP_BATCH_ID,DISP_EXPIRY_DATE,DISP_TRADE_ID, ORDER_ID)   VALUES (  ?,?,TO_DATE(?,'dd/mm/yyyy hh24:mi'), ?,?,?,?,?,?,  ?,?,?,  ?,?,?,  ?,SYSDATE,?,  ?,?,SYSDATE,  ?, ?,?,  ?,decode(?,null,null,TO_DATE(?,'dd/mm/yyyy hh24:mi')),?,?,TO_DATE(?,'DD/MM/YYYY'),?,?)");
		dataMap.put("SQL_PH_MEDN_ADMIN_PAT_DRUG_PROFILE_FT_UPDATE","UPDATE PH_PATIENT_DRUG_PROFILE SET ADMINISTERED_DRUGS=?,TOT_ADMINISTERED_QTY=(NVL(TOT_ADMINISTERED_QTY,0)+?),MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_MEDN_ADMIN_PAT_DRUG_PROFILE_FT_UPDATE1","UPDATE PH_PATIENT_DRUG_PROFILE SET ADMINISTERED_DRUGS=?,TOT_ADMINISTERED_QTY=(NVL(TOT_ADMINISTERED_QTY,0)+?),/*INFUSION_RATE=?,INFUSE_OVER=?,*/ MODIFIED_DATE=SYSDATE,MODIFIED_BY_ID=?, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");///*INFUSION_RATE=?,INFUSE_OVER=?,*/ commented for SKR-SCF-1612
		dataMap.put("SQL_PH_MEDN_ADMIN_OR_ORDER_LINE_PH_UPDATE","UPDATE OR_ORDER_LINE_PH SET INFUSE_OVER=?, INFUSION_RATE=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=? ");
		dataMap.put("SQL_PH_MEDN_ADMIN_PAT_DRUG_PROFILE_FT_INSERT","INSERT INTO PH_PATIENT_DRUG_PROFILE(PATIENT_ID, SRL_NO, DRUG_CODE, GENERIC_ID, START_DATE, END_DATE, SPLIT_YN, TAPERED_YN, FREQ_CODE, DURATION, PRESCRIBED_QTY, IV_PREP_YN, AMENDED_YN, CANCEL_YN, BROUGHT_BY_PATIENT_YN, STOP_YN, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, DURN_TYPE, REFILL_YN, FACILITY_ID, ENCOUNTER_ID, BED_NO, DOSAGE, DOSAGE_UOM_CODE, INFUSE_OVER, INFUSE_OVER_UNIT, INFUSION_RATE, INFUSION_VOL_STR_UNIT, INFUSION_PER_UNIT, ORIG_FACILITY_ID, ROUTE_CODE, IV_INGREDIENTS, ADMINISTERED_DRUGS, TOT_ADMINISTERED_QTY) VALUES(?,SELECT MAX(SRL_NO)+1 FROM PH_PATIENT_DRUG_PROFILE ,?,?,TO_DATE(?,'dd/mm/yyyy hh24:mi'),TO_DATE(?,'dd/mm/yyyy hh24:mi'),'N','N',?,'1',?,?,'N','N','N','N','N',?,SYSDATE,?,?,?,SYSDATE,?,?,'D','N',?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
		dataMap.put("JNDI_PH_MEDICATION_ADMINISTRATION_FT", "java:comp/env/MedicationAdministrationFT");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT4", "SELECT DISTINCT a.BATCH_ID, to_char(a.EXPIRY_DATE,'dd/mm/yyyy') EXPIRY_DATE,d.trade_id,d.short_name  trade_name FROM PH_DISP_DRUG_BATCH a,st_item_batch c, PH_DISP_DTL b,am_trade_name_lang_vw d WHERE a.item_code=c.item_code AND a.store_code=c.store_code AND a.expiry_date=c.expiry_date_or_receipt_Date  AND a.batch_id=c.batch_id  AND a.facility_id=b.facility_id AND a.disp_no=b.disp_no AND a.srl_no=b.srl_no AND c.trade_id=d.trade_id(+) AND b.ORDER_ID=? AND b.ORDER_LINE_NO=? and d.language_id(+) =? and a.disp_qty<>NVL (a.returned_qty, 0) ");

		//query added ....
		dataMap.put("SQL_PH_MED_ADMIN_BATCH_SELECT4" , "SELECT A.FACILITY_ID,B.ENCOUNTER_ID,B.BATCH_ID,B.DISP_BATCH_ID, TO_CHAR(B.DISP_EXPIRY_DATE,'DD/MM/YYYY') DISP_EXPIRY_DATE,B.DISP_TRADE_ID  FROM PH_MEDN_ADMIN A, PH_MEDN_ADMIN_DTL B  WHERE   A.ORDER_ID = ? AND A.FACILITY_ID = B.FACILITY_ID  AND A.ENCOUNTER_ID = B.ENCOUNTER_ID  AND A.ORD_DRUG_CODE = B.ORD_DRUG_CODE   and a.SCH_DATE_TIME =b.SCH_DATE_TIME  and a.order_id=b.order_id   AND A.ORDER_LINE_NUM = ?  AND A.ORD_DRUG_CODE =? AND A.FACILITY_ID = ?  and a.DOSAGE_SEQ_NO =b.DOSAGE_SEQ_NO   AND A.ENCOUNTER_ID = ?  AND B.SCH_DATE_TIME = TO_DATE(?,'DD/MM/YYYY HH24:MI')  ");

		dataMap.put("SQL_PH_MED_ADMIN_REMARKS1", "SELECT ORDER_COMMENT FROM OR_ORDER_COMMENT WHERE ORDER_ID = ?AND ACTION_SEQ_NUM=(SELECT MAX(ACTION_SEQ_NUM) FROM OR_ORDER_COMMENT WHERE ORDER_ID=?) ");
		dataMap.put("SQL_PH_MED_ADMIN_REMARKS2", "SELECT FILL_TASK_FINDING, DELIVERY_TASK_FINDING, ALLOCATE_TASK_FINDING FROM PH_DISP_DTL WHERE ORDER_ID=? AND ORDER_LINE_NO = ?");
		dataMap.put("SQL_PH_MED_ADMIN_REMARKS2A", "SELECT FILL_TASK_FINDING, DELIVERY_TASK_FINDING, ALLOCATE_TASK_FINDING FROM PH_DISP_DTL_TMP WHERE ORDER_ID=? AND ORDER_LINE_NO = ?");
		dataMap.put("SQL_PH_MED_ADMIN_REMARKS2B", "SELECT FILL_TASK_FINDING, DELIVERY_TASK_FINDING, ALLOCATE_TASK_FINDING FROM or_order_line_ph WHERE ORDER_ID=? AND ORDER_LINE_NUM = ?");
		dataMap.put("SQL_PH_MED_ADMIN_REMARKS3", "SELECT ORDER_LINE_FIELD_VALUE,ORDER_LINE_LABEL_TEXT FROM OR_ORDER_LINE_FIELD_VALUES WHERE ORDER_ID=? AND ORDER_LINE_NUM = ? AND ORDER_LINE_SEQ_NUM < 100");
        dataMap.put("SQL_PH_MED_ADMIN_REMARKS5", "select  SLIDING_SCALE_REMARKS from ph_patient_drug_profile where ORIG_ORDER_ID=? and  ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_MED_ADMIN_REMARKS6", "SELECT VERIFY_REMARKS FROM OR_ORDER_LINE_PH WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
//query added for drug remarks to be displayed 
		
		dataMap.put("SQL_PH_MED_ADMIN_REMARKS4", "SELECT REMARK_DESC FROM PH_PRES_REMARK_LANG_VW PH_PRES_REMARK WHERE REMARK_CODE=? AND LANGUAGE_ID = ?");
	

		dataMap.put("SQL_PH_MED_ADMIN_REASON_CODES","SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE='M' AND EFF_STATUS='E'");
		dataMap.put("SQL_PH_MED_ADMIN_APPL_USERS","SELECT APPL_USER_ID code, APPL_USER_NAME description FROM SM_APPL_USER_lang_vw WHERE EFF_STATUS='E' AND LANGUAGE_ID LIKE ? and APPL_USER_ID LIKE UPPER(?) AND  UPPER(APPL_USER_NAME) LIKE UPPER(?)");
		dataMap.put("SQL_PH_MED_ADMIN_DOSAGE_SEQ_NO","SELECT MAX(DOSAGE_SEQ_NO)+1 DOSAGE_SEQ_NO FROM PH_MEDN_ADMIN WHERE FACILITY_ID = ? AND ENCOUNTER_ID = ? AND ORDER_ID = ? AND trunc(SCH_DATE_TIME)=trunc(TO_DATE(?,'DD/MM/YYYY HH24:MI')) AND ORD_DRUG_CODE=?");
		dataMap.put("SQL_PH_MED_ADMIN_MEDN_ADMIN_VALUES","SELECT SCH_STRENGTH, SCH_STRENGTH_UOM,SCH_ROUTE_CODE,SCH_INFUSION_PERIOD,SCH_INFUSION_PERIOD_UNIT,IV_INGREDIANTS FROM PH_MEDN_ADMIN WHERE FACILITY_ID = ? AND ENCOUNTER_ID = ? AND ORDER_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_MEDN_ADMIN_FREQ_NATURE","SELECT FREQ_NATURE FROM or_order_line A,AM_FREQUENCY B WHERE A.order_id=? AND A.order_line_num=? AND A.FREQ_CODE=B.FREQ_CODE");

		dataMap.put("SQL_PH_MED_ADMIN_MEDN_ADMIN_PRN","SELECT A.ORDER_CATALOG_CODE,C.DRUG_DESC,TO_CHAR(D.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') ORD_DATE_TIME,D.ADDED_BY_ID  FROM   OR_ORDER_LINE A,AM_FREQUENCY_LANG_VW B,PH_DRUG_LANG_VW C,OR_ORDER D WHERE  A.ORDER_CATALOG_CODE = C.Drug_CODE   AND A.FREQ_CODE = B.FREQ_CODE    AND A.ORDER_ID  = D.ORDER_ID    AND D.PATIENT_ID = ?    AND D.Encounter_id = ?    AND B.FREQ_NATURE='P' AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID =  ?");
		dataMap.put("SQL_PH_ADMIN_OR_ORDER_SELECT","SELECT PERFORMING_DEPTLOC_CODE FROM OR_ORDER where ORDER_ID=NVL(?,ORDER_ID)");
		dataMap.put("SQL_PH_DRUG_STRENGTH_SELECT","SELECT STRENGTH_VALUE,STRENGTH_PER_PRES_UOM, STRENGTH_PER_VALUE_PRES_UOM, CONTENT_IN_PRES_BASE_UOM,STOCK_UOM FROM PH_DRUG WHERE DRUG_CODE=NVL(?,DRUG_CODE)");

		/*
		This query selects bed no and patient id for open encounters
		parameter1:facility_id
		parameter2:administration date time
		parameter3:nursing unit code
		*/
		//dataMap.put("SQL_PH_MED_ADMIN_SELECT8", "SELECT  DISTINCT  A.ENCOUNTER_ID,   A.ASSIGN_BED_NUM ASSIGN_BED_NUM,decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no, C.PATIENT_NAME,  A.PATIENT_ID, C.NATIONALITY_CODE, GET_AGE(C.DATE_OF_BIRTH) AGE,  DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,  ( SELECT    SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?)     NATIONALITY     FROM      PR_ENCOUNTER  A,   MP_PATIENT C ,   PH_MEDN_ADMIN D,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID AND  E.ORDER_ID=D.ORDER_ID AND   E.ORDER_LINE_NUM=D.ORDER_LINE_NUM  AND   a.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND   D.FACILITY_ID=A.FACILITY_ID  AND   A.ASSIGN_CARE_LOCN_CODE=? AND    d.sch_date_time>=e.ord_date_time  and sysdate<=e.end_date_time AND E.CAN_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT8", "SELECT  DISTINCT  A.ENCOUNTER_ID,   A.ASSIGN_BED_NUM ASSIGN_BED_NUM,decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no, nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME,  A.PATIENT_ID, C.NATIONALITY_CODE, GET_AGE(C.DATE_OF_BIRTH) AGE,  DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,  ( SELECT    SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?)     NATIONALITY ,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB    FROM      PR_ENCOUNTER  A,   MP_PATIENT C ,   PH_MEDN_ADMIN D,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID AND  E.ORDER_ID=D.ORDER_ID AND   E.ORDER_LINE_NUM=D.ORDER_LINE_NUM  AND   a.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND   D.FACILITY_ID=A.FACILITY_ID  AND   A.ASSIGN_CARE_LOCN_CODE=? AND    d.sch_date_time>=e.ord_date_time  and sysdate<=e.end_date_time AND E.CAN_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		//,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB added for ARYU-SCF-023
		//query changed on 3/12/2004
		//dataMap.put("SQL_PH_MED_ADMIN_SELECT8A", "SELECT DISTINCT  A.ENCOUNTER_ID,  A.ASSIGN_BED_NUM ASSIGN_BED_NUM, decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no, C.PATIENT_NAME,  A.PATIENT_ID,C.NATIONALITY_CODE,  GET_AGE(C.DATE_OF_BIRTH) AGE,  DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,  ( SELECT    SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ? )     NATIONALITY  FROM       PR_ENCOUNTER A,   MP_PATIENT C ,   PH_MEDN_ADMIN D,OR_ORDER_LINE E,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE  I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID AND E.ORDER_ID=D.ORDER_ID AND  E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND  A.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND   D.FACILITY_ID=A.FACILITY_ID  AND   A.ASSIGN_CARE_LOCN_CODE=?   AND  d.sch_date_time>=e.ord_date_time AND D.SCH_DATE_TIME<=E.END_DATE_TIME AND    HOLD_DATE_TIME IS NULL AND   DISC_DATE_TIME IS NULL AND E.CAN_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT8A", "SELECT DISTINCT  A.ENCOUNTER_ID,  A.ASSIGN_BED_NUM ASSIGN_BED_NUM, decode(ph_number_yn(A.ASSIGN_BED_NUM),'Y',to_number(A.ASSIGN_BED_NUM),1000+ascii(A.ASSIGN_BED_NUM)) n_bed_no, nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME,  A.PATIENT_ID,C.NATIONALITY_CODE,  GET_AGE(C.DATE_OF_BIRTH) AGE,  DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,  ( SELECT    SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ? )     NATIONALITY ,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB  FROM       PR_ENCOUNTER A,   MP_PATIENT C ,   PH_MEDN_ADMIN D,OR_ORDER_LINE E,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE  I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID AND E.ORDER_ID=D.ORDER_ID AND  E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND  A.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND   D.FACILITY_ID=A.FACILITY_ID  AND   A.ASSIGN_CARE_LOCN_CODE=?   AND  d.sch_date_time>=e.ord_date_time AND D.SCH_DATE_TIME<=E.END_DATE_TIME AND    HOLD_DATE_TIME IS NULL AND   DISC_DATE_TIME IS NULL AND E.CAN_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND G.LANGUAGE_ID = ?");
		//,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB  added for ARYU-SCF-023


		//dataMap.put("SQL_PH_MED_ADMIN_SELECT8AAA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,   '' ASSIGN_BED_NUM, '' n_bed_no,  C.PATIENT_NAME,C.NATIONALITY_CODE,  A.PATIENT_ID,  GET_AGE(C.DATE_OF_BIRTH) AGE,  DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,  ( SELECT    SHORT_NAME FROM  MP_COUNTRY_LANG_VW MP_COUNTRY WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?)     NATIONALITY     FROM   OP_CLINIC_LANG_VW B,   PR_ENCOUNTER  A,   MP_PATIENT C ,   PH_MEDN_ADMIN D,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID AND  E.ORDER_ID=D.ORDER_ID AND   E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND     B.FACILITY_ID=A.FACILITY_ID AND   B.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND   D.FACILITY_ID=A.FACILITY_ID  AND   B.CLINIC_CODE=? AND B.CLINIC_CODE=A.ASSIGN_CARE_LOCN_CODE  AND    d.sch_date_time>=e.ord_date_time  and sysdate<=e.end_date_time AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");		
	   dataMap.put("SQL_PH_MED_ADMIN_SELECT8AAA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,   '' ASSIGN_BED_NUM, '' n_bed_no,  nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME,C.NATIONALITY_CODE,  A.PATIENT_ID,  GET_AGE(C.DATE_OF_BIRTH) AGE,  DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,  ( SELECT    SHORT_NAME FROM  MP_COUNTRY_LANG_VW MP_COUNTRY WHERE    COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?)     NATIONALITY ,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB    FROM   OP_CLINIC_LANG_VW B,   PR_ENCOUNTER  A,   MP_PATIENT C ,   PH_MEDN_ADMIN D,OR_ORDER_LINE E ,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I WHERE I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID AND  E.ORDER_ID=D.ORDER_ID AND   E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND     B.FACILITY_ID=A.FACILITY_ID AND   B.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID  AND   D.FACILITY_ID=A.FACILITY_ID  AND   B.CLINIC_CODE=? AND B.CLINIC_CODE=A.ASSIGN_CARE_LOCN_CODE  AND    d.sch_date_time>=e.ord_date_time  and sysdate<=e.end_date_time AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");	
	   //,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB added for ARYU-SCF-023
		//query changed on 3/12/2004
		//dataMap.put("SQL_PH_MED_ADMIN_SELECT8AA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,  '' ASSIGN_BED_NUM, '' n_bed_no, C.PATIENT_NAME,  A.PATIENT_ID, C.NATIONALITY_CODE, GET_AGE(C.DATE_OF_BIRTH) AGE,   DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,   ( SELECT    SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?)      NATIONALITY  FROM     OP_CLINIC_LANG_VW B,   PR_ENCOUNTER A,   MP_PATIENT C ,    PH_MEDN_ADMIN D,OR_ORDER_LINE E,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I  WHERE  I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID  AND E.ORDER_ID=D.ORDER_ID AND  E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND     B.FACILITY_ID=A.FACILITY_ID AND    B.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID   AND   D.FACILITY_ID=A.FACILITY_ID  AND   B.CLINIC_CODE=A.ASSIGN_CARE_LOCN_CODE AND B.CLINIC_CODE=?  AND  d.sch_date_time>=e.ord_date_time AND   sysdate<=e.end_date_time and HOLD_DATE_TIME IS NULL AND  DISC_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT8AA", "SELECT   /*+ FIRST_ROWS */  DISTINCT  A.ENCOUNTER_ID,  '' ASSIGN_BED_NUM, '' n_bed_no, nvl( decode(?,'en',C.PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME,  A.PATIENT_ID, C.NATIONALITY_CODE, GET_AGE(C.DATE_OF_BIRTH) AGE,   DECODE(C.SEX,  'M',  'male',  'F',  'female',  'unknown' ) GENDER,   ( SELECT    SHORT_NAME FROM   MP_COUNTRY_LANG_VW MP_COUNTRY WHERE   COUNTRY_CODE=C.NATIONALITY_CODE AND LANGUAGE_ID = ?)      NATIONALITY,TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB  FROM     OP_CLINIC_LANG_VW B,   PR_ENCOUNTER A,   MP_PATIENT C ,    PH_MEDN_ADMIN D,OR_ORDER_LINE E,OR_ORDER F,AM_FREQUENCY_LANG_VW G,PH_PATIENT_DRUG_PROFILE I  WHERE  I.ORIG_ORDER_ID=F.ORDER_ID AND I.ORIG_ORDER_LINE_NO=E.ORDER_LINE_NUM AND I.ORIG_ORDER_ID=E.ORDER_ID AND G.FREQ_CODE=E.FREQ_CODE AND F.ORDER_ID = E.ORDER_ID  AND E.ORDER_ID=D.ORDER_ID AND  E.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND     B.FACILITY_ID=A.FACILITY_ID AND    B.FACILITY_ID=? AND   C.PATIENT_ID=A.PATIENT_ID   AND   D.ENCOUNTER_ID=A.ENCOUNTER_ID   AND   D.FACILITY_ID=A.FACILITY_ID  AND   B.CLINIC_CODE=A.ASSIGN_CARE_LOCN_CODE AND B.CLINIC_CODE=?  AND  d.sch_date_time>=e.ord_date_time AND   sysdate<=e.end_date_time and HOLD_DATE_TIME IS NULL AND  DISC_DATE_TIME IS NULL AND    (( ? in ('IP','DC')  AND DECODE (ph_number_yn (a.assign_bed_num), 'Y', TO_NUMBER (a.assign_bed_num),  1000 + ASCII (a.assign_bed_num)  ) BETWEEN DECODE (ph_number_yn (?), 'Y', TO_NUMBER (?),  1000 + ASCII (?)  )  AND DECODE (ph_number_yn (?),  'Y', TO_NUMBER (?), 1000 + ASCII (?) ))OR(? in ('OP','EM'))) AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		//TO_CHAR(C.DATE_OF_BIRTH,'DD/MM/YYYY') DOB added for ARYU-SCF-023
		/* For a particular encounter,facility and admin date, this query returns the drugs to be administered at different times
		parameter1:facility_id
		parameter2:Encounter_id
		parameter3:administration date time
		parameter4:If past timings is to be included or not. Pass 'Y' or 'N'
		*/
		dataMap.put("SQL_PH_MED_ADMIN_SELECT5", "  SELECT  ph_medn_admin_timings (?,?,?,?) SCHEDULE   FROM dual ");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT6", "  SELECT  ph_medn_admin_timingsnew (?,?,?,?) SCHEDULE   FROM dual ");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT9", "SELECT PRACTITIONER_ID CODE, PRACTITIONER_NAME DESCRIPTION FROM AM_PRACT_FOR_FACILITY_VW  WHERE OPERATING_FACILITY_ID like ?  AND upper(PRACTITIONER_ID) like upper(?) and upper(PRACTITIONER_NAME) like upper(?) ORDER BY 1");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT10", "SELECT B.ROUTE_CODE,B.ROUTE_DESC FROM PH_ROUTE_FOR_FORM A,PH_ROUTE B  WHERE A.ROUTE_CODE=B.ROUTE_CODE AND B.EFF_STATUS='E' AND A.FORM_CODE=? ORDER BY 2");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT11", "SELECT FORM_CODE, PRES_BASE_UOM FROM PH_DRUG WHERE DRUG_CODE=?");

		/* This query verifies that a given  date time falls between sysdate-allowable medn hrs and sysdate */
		dataMap.put("SQL_PH_MED_ADMIN_SELECT12", "SELECT CASE WHEN TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN SYSDATE-(SELECT rec_admin_within_hrs FROM PH_FACILITY_PARAM WHERE facility_id=?)/24 AND SYSDATE THEN 'Y' ELSE 'N' END validdate FROM Dual");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT13", "SELECT (TO_DATE(?,'DD/MM/YYYY') - TO_DATE(?,'DD/MM/YYYY')) NUM FROM DUAL");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT14","SELECT TRADE_ID FROM PH_MEDN_ADMIN_DTL WHERE FACILITY_ID=? AND ENCOUNTER_ID=? AND SCH_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND ORD_DRUG_CODE=? AND DOSAGE_SEQ_NO=1 AND SRL_NO=1");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT15","SELECT DISTINCT(TO_CHAR(TRUNC(SCH_DATE_TIME),'DD/MM/YYYY')) SCH_DATE_TIME,TRUNC(SCH_DATE_TIME) SCH_DATE FROM PH_MEDN_ADMIN WHERE ENCOUNTER_ID=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT16","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY')+ROWNUM-1,'DD/MM/YYYY') DIFF_DATE FROM SM_FUNCTION WHERE ROWNUM<=(TO_DATE(?,'DD/MM/YYYY')-TO_DATE(?,'DD/MM/YYYY')+1)");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT17","SELECT NURSING_UNIT_CODE code,LONG_DESC description FROM IP_NURSING_UNIT_LANG_VW A WHERE A.NURSING_UNIT_CODE IN ( SELECT LOCN_CODE FROM AM_LOCN_FOR_OPER_STN B,AM_USER_FOR_OPER_STN C WHERE B.OPER_STN_ID=C.OPER_STN_ID AND B.FACILITY_ID=C.FACILITY_ID AND C.FACILITY_ID='#' AND C.APPL_USER_ID='#' AND TRUNC(SYSDATE) BETWEEN NVL(C.EFF_DATE_FROM,SYSDATE) AND NVL(C.EFF_DATE_TO,SYSDATE) AND TRUNC(SYSDATE) BETWEEN NVL(B.EFF_DATE_FROM,TRUNC(SYSDATE)) AND NVL(B.EFF_DATE_TO,TRUNC(SYSDATE)) ) AND EFF_STATUS='E' AND A.FACILITY_ID='#' AND A.PATIENT_CLASS ='#' AND A.LANGUAGE_ID ='#' and NURSING_UNIT_CODE LIKE UPPER(?) AND Upper(LONG_DESC) like upper(?) order by 2 ");
		dataMap.put("SQL_PH_MED_ADMIN_SELECT18","SELECT   CLINIC_CODE code, long_desc description FROM op_clinic_lang_vw a WHERE a.CLINIC_CODE IN ( SELECT locn_code FROM am_locn_for_oper_stn b, am_user_for_oper_stn c WHERE b.oper_stn_id = c.oper_stn_id AND b.facility_id = c.facility_id AND c.facility_id = '#' AND c.appl_user_id = '#' AND TRUNC (SYSDATE) BETWEEN NVL (c.eff_date_from, SYSDATE) AND NVL (c.eff_date_to, SYSDATE) AND TRUNC (SYSDATE) BETWEEN NVL (b.eff_date_from,TRUNC (SYSDATE)) AND NVL (b.eff_date_to,TRUNC (SYSDATE))) AND eff_status = 'E' AND a.facility_id = '#' AND a.LEVEL_OF_CARE_IND = '#' AND a.language_id = '#' AND CLINIC_CODE LIKE UPPER (?) AND UPPER (long_desc) LIKE UPPER (?) ORDER BY 2 ");		
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT12", "SELECT DISTINCT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY A, OR_FREQUENCY_SCOPE B WHERE A.EFF_STATUS='E' AND (A.FREQ_NATURE<>'C' AND A.FREQ_NATURE<>'I' AND A.FREQ_NATURE<>'F') AND A.FREQ_CODE = B.FREQ_CODE AND B.ORDER_CATEGORY='PH' AND B.FREQ_SCOPE_YN='Y' ORDER BY 2");
		dataMap.put("SQL_PH_ADR_SCH_DATE" ,"SELECT TO_CHAR(SCH_DATE_TIME,'DD/MM/YYYY HH24:MI') SCH_DATE_TIME FROM PH_MEDN_ADMIN WHERE FACILITY_ID = ? AND ENCOUNTER_ID = ?  AND ORD_DRUG_CODE = ? AND trunc(SCH_DATE_TIME) = trunc(SYSDATE) " );
		dataMap.put("SQL_PH_MEDICATION_ADR_REMARKS" , "SELECT CODE, ADR_DESC, REMARKS FROM PH_ADR_MAST WHERE CODE = ? ");
		dataMap.put("SQL_PH_MEDICATION_ADR_CODE" ,"SELECT CODE, ADR_DESC, REMARKS FROM PH_ADR_MAST ");
		dataMap.put("SQL_PH_MEDICATION_ADR_DFT_VALUES","SELECT to_char(AGAINST_SCHDOSE_DATE_TIME,'dd/mm/yyyy hh24:mi') AGAINST_SCHDOSE_DATE_TIME, ADR_REASON_CODE, ADR_REMARKS, ADR_RECORDED_DATE_TIME, ADR_RECORDED_BY FROM PH_MEDN_ADMIN WHERE FACILITY_ID =? AND ENCOUNTER_ID = ?  AND  ORD_DRUG_CODE = ?  AND  ORDER_ID = ?  AND ADR_REASON_CODE IS NOT NULL ");
		dataMap.put("SQL_PH_MEDICATION_COMPARE_DATES","SELECT  TO_DATE(?,'DD/MM/YYYY HH24:MI')-TO_DATE(TO_CHAR(SYSDATE,'Dd/mm/yyyy hh24:MI'),'DD/MM/YYYY HH24:MI') VAL FROM DUAL");
		dataMap.put("SQL_PH_MEDICATION_COMPARE_DATES_A","SELECT COUNT(*) DATEVALUE FROM DUAL WHERE TO_DATE(?,'DD/MM/YYYY HH24:MI') <= TO_DATE(?,'DD/MM/YYYY HH24:MI')");
		dataMap.put("SQL_PH_MEDICATION_COMPARE_DATES_B","SELECT COUNT(*) COUNT FROM DUAL WHERE TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI')");

		// end of Medication Administration

		//Start of Query for Pres Vs Disp drug
		dataMap.put("SQL_PH_PRESVSDISP_NURSUNIT_LOOKUP", "SELECT NURSING_UNIT_CODE CODE, LONG_DESC DESCRIPTION FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE  EFF_STATUS='E'  AND NURSING_UNIT_CODE LIKE ? AND LONG_DESC LIKE ? AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_PRESVSDISP_CLINIC_LOOKUP", "SELECT CLINIC_CODE CODE , LONG_DESC DESCRIPTION FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE  EFF_STATUS='E' AND CLINIC_TYPE IN ('C','E') AND CLINIC_CODE LIKE ? AND SHORT_DESC LIKE ?  AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_CLINIC_DISP_LOCN", "SELECT   DISTINCT A.DISP_LOCN_CODE, B.LONG_DESC FROM    PH_ALT_DISP_LOCN A,   PH_DISP_LOCN B WHERE A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND ORDERING_SOURCE_TYPE='C' AND ORDERING_SOURCE_CODE=?");
		dataMap.put("SQL_PH_OR_INSTALLED", "SELECT * FROM SM_MODULE WHERE MODULE_ID='OR' AND INSTALL_YN='Y'");
		dataMap.put("SQL_PH_NURSINGUNIT_DISP_LOCN", "SELECT  DISTINCT  A.DISP_LOCN_CODE, B.LONG_DESC FROM    PH_ALT_DISP_LOCN A,   PH_DISP_LOCN B WHERE A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND ORDERING_SOURCE_TYPE='N' AND ORDERING_SOURCE_CODE=?");
		dataMap.put("SQL_PH_PRESVSDISP_ORDER_SELECT", "SELECT   DISTINCT A.ORDER_ID,   TO_CHAR(A.ORD_DATE_TIME,'dd/mm/yyyy hh24:mi') ORD_DATE_TIME,   B.PRACTITIONER_NAME,   Ph_Order_Source(  A.SOURCE_CODE,   A.PATIENT_CLASS,   A.ORDERING_FACILITY_ID,A.SOURCE_TYPE,?) LOCATION,   A.PATIENT_ID,   C.PATIENT_NAME,   D.ORDER_STATUS_TYPE,   (SELECT SHORT_DESC FROM PH_DISP_LOCN WHERE DISP_LOCN_CODE=E.DISP_LOCN_CODE AND FACILITY_ID=E.FACILITY_ID)   DISP_LOCN FROM    OR_ORDER A,   AM_PRACTITIONER B,   MP_PATIENT C,   OR_ORDER_STATUS_CODE D ,   PH_DISP_HDR E WHERE    A.ORD_PRACT_ID=B.PRACTITIONER_ID AND   A.PATIENT_ID=C.PATIENT_ID AND   A.ORDER_ID=E.ORDER_ID   AND   A.ORDER_STATUS=D.ORDER_STATUS_CODE AND   ORDER_CATEGORY='PH' AND   order_status_type IN (25,30,35,56,58,10)");
		dataMap.put("SQL_PH_PRESVSDISP_ORDER_LINE_SELECT", "SELECT  A.ORDER_LINE_NUM, C.DRUG_DESC||' '||  '('||A.QTY_VALUE||' '||(SELECT SHORT_DESC FROM AM_UOM WHERE UOM_CODE=A.QTY_UNIT)||' '||D.FREQ_DESC ||')' DOSAGE,  A.ORDER_QTY, (SELECT SHORT_DESC FROM AM_UOM WHERE UOM_CODE=A.ORDER_UOM) QTYUNIT , (SELECT DRUG_DESC FROM PH_DRUG WHERE DRUG_CODE=B.DISP_DRUG_CODE) DISP_DRUG,  B.DISP_QTY, (SELECT SHORT_DESC FROM AM_UOM WHERE UOM_CODE=B.DISP_UOM_CODE) DISPUNIT, B.DISP_NO, TO_CHAR(TO_DATE(B.ADDED_DATE,'DD/MM/RRRR HH24:MI'),'DD/MM/RRRR')  RECORD_DATE_TIME  FROM    OR_ORDER_LINE A,   PH_DISP_DTL B,   PH_DRUG C,   AM_FREQUENCY D   WHERE   A.ORDER_ID=B.ORDER_ID(+) AND A.ORDER_LINE_NUM=B.ORDER_LINE_NO(+)   AND A.ORDER_CATALOG_CODE=C.DRUG_CODE   AND A.FREQ_CODE=D.FREQ_CODE(+)   AND A.ORDER_ID=?");
		// End of Query for Pres Vs Disp Drug

		//Start of Drug Dispensing
		dataMap.put("SQL_PH_DRUG_DIAGNOSIS1", "SELECT A.FACILITY_ID,B.FACILITY_NAME FROM SM_FACILITY_FOR_USER A,SM_FACILITY_PARAM_LANG_VW B  WHERE A.FACILITY_ID = B.FACILITY_ID   AND A.APPL_USER_ID = UPPER(?) AND B.LANGUAGE_ID = ? ORDER BY 2");
		//End of Drug Dispensing

		//start of Medication administration list
		dataMap.put("SQL_PH_MEDN_ADMN_REQ", "SELECT MED_ADMIN_REQD_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID = UPPER(?) ");
		dataMap.put("SQL_PH_DISP_LOCN_COMN_SELECT1", "SELECT DISP_LOCN_CODE,SHORT_DESC FROM PH_DISP_LOCN_LANG_VW  A, SM_FACILITY_FOR_USER B WHERE A.FACILITY_ID = B.FACILITY_ID AND DISP_LOCN_TYPE = 'P' AND EFF_STATUS='E' AND B.APPL_USER_ID = ? AND A.FACILITY_ID LIKE UPPER(DECODE(?,NULL,'%',?)) AND A.LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_LOCN_COMN_SELECT2", "SELECT DISP_LOCN_CODE,SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID = ? AND DISP_LOCN_TYPE = 'P' AND EFF_STATUS='E'  AND ISSUE_TOKEN_ON_REGN_YN='Y' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_DISP_LOCN_COMN_SELECT3", "SELECT DISP_LOCN_CODE,SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID = ? AND DISP_LOCN_TYPE = 'P' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");

		dataMap.put("SQL_PH_DISP_LOCN_COMN_SELECT4", "SELECT DISP_LOCN_CODE,SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE FACILITY_ID = ? AND DISP_LOCN_TYPE = 'P' AND EFF_STATUS='E' AND LANGUAGE_ID = ?  ORDER BY 2");//and disp_regn_reqd_yn = 'Y' commented for IN045597

		dataMap.put("SQL_PH_TOKEN_SERIES_GEN_SELECT1", "SELECT TOKEN_SERIES_CODE, DESCRIPTION FROM PH_TOKEN_SERIES_LANG_VW PH_TOKEN_SERIES WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_TOKEN_SERIES_GEN_SELECT2", "SELECT TOKEN_SERIAL_NO  FROM PH_DISP_QUEUE	WHERE FACILITY_ID=? AND DISP_LOCN_CODE=? AND TRUNC(QUEUE_DATE)=TRUNC(SYSDATE) AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND PATIENT_ID=? ");

		dataMap.put("SQL_PH_BAL_MEDN_PRINT_REQ", "SELECT PRINT_BAL_MED_SHEET_OP_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID = UPPER(?) ");
		dataMap.put("SQL_PH_MEDN_ADMN_DATE_SELECT5","select to_char(sysdate,'dd/mm/yyyy')today  from dual");
		dataMap.put("SQL_PH_PAT_SPEC_DRUG_DATE_RANGE_SELECT","select to_char(sysdate,'dd/mm/yyyy')today,to_char(sysdate-30,'dd/mm/yyyy')todayminusthirty  from dual");//added for performance tunning
		dataMap.put("SQL_PH_MEDN_ADMN_DATE_SELECT1","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI') IN_DATE,TO_CHAR(SYSDATE,'DD/MM/YYYY')|| ' '|| '23:59' EN_DATE,TO_CHAR(TO_DATE((TO_CHAR(SYSDATE,'DD/MM/YYYY')||' '|| '23:59'),'DD/MM/YYYY HH24:MI')+1,'DD/MM/YYYY HH24:MI') AD_DATE FROM DUAL");
		dataMap.put("SQL_PH_MEDN_ORD_STAT_PRACT_SELECT","SELECT INSTALL_YN FROM SM_MODULE WHERE MODULE_ID = 'OR' ");
		dataMap.put("SQL_PH_MEDN_STAT_PRACT_SELECT1","SELECT DISTINCT A.PRACTITIONER_ID CODE,B.PRACTITIONER_NAME DESCRIPTION FROM AM_PRACT_FOR_FACILITY A,AM_PRACTITIONER B,SM_FACILITY_FOR_USER C WHERE A.PRACTITIONER_ID=B.PRACTITIONER_ID AND C.FACILITY_ID=A.FACILITY_ID AND B.PRACT_TYPE != 'PH' AND UPPER(APPL_USER_ID)LIKE UPPER(?) AND UPPER(A.FACILITY_ID) LIKE UPPER(DECODE(?,NULL,'%',?)) AND  UPPER(B.PRACT_TYPE) LIKE UPPER(?) AND UPPER(A.PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(B.PRACTITIONER_NAME) LIKE UPPER(?)  ORDER BY 2");
		dataMap.put("SQL_PH_MEDN_STAT_PRESC_PATT_PRACT_SELECT1","SELECT DISTINCT A.PRACTITIONER_ID CODE,B.PRACTITIONER_NAME DESCRIPTION FROM AM_PRACT_FOR_FACILITY A,AM_PRACTITIONER_LANG_VW B,SM_FACILITY_FOR_USER C WHERE A.PRACTITIONER_ID=B.PRACTITIONER_ID AND C.FACILITY_ID=A.FACILITY_ID AND UPPER(APPL_USER_ID)LIKE UPPER(?) AND UPPER(A.FACILITY_ID) LIKE UPPER(DECODE(?,NULL,'%',?)) AND  UPPER(B.PRACT_TYPE) LIKE UPPER(?) AND UPPER(A.PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(B.PRACTITIONER_NAME) LIKE UPPER(?) AND B.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_MEDN_STAT_PRACT_MODIFIED_SELECT","SELECT DISTINCT A.PRACTITIONER_ID CODE,B.PRACTITIONER_NAME DESCRIPTION FROM AM_PRACT_FOR_FACILITY A,AM_PRACTITIONER_LANG_VW B,SM_FACILITY_FOR_USER C WHERE A.PRACTITIONER_ID=B.PRACTITIONER_ID  AND C.FACILITY_ID=A.FACILITY_ID  AND UPPER(APPL_USER_ID)LIKE UPPER(?) AND UPPER(A.FACILITY_ID) LIKE UPPER(DECODE(?,NULL,'%',?)) AND  UPPER(B.PRACT_TYPE) LIKE UPPER(?) AND UPPER(A.PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(B.PRACTITIONER_NAME) LIKE UPPER(?)  AND B.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_MEDN_STAT_PRACT_SELECT2","SELECT DISTINCT A.PRACTITIONER_ID CODE,B.PRACTITIONER_NAME DESCRIPTION FROM AM_PRACT_FOR_FACILITY A,AM_PRACTITIONER B,SM_FACILITY_FOR_USER C WHERE A.PRACTITIONER_ID=B.PRACTITIONER_ID AND C.FACILITY_ID=A.FACILITY_ID AND B.PRACT_TYPE != 'PH' AND UPPER(APPL_USER_ID)LIKE UPPER(?) AND UPPER(A.FACILITY_ID) LIKE UPPER(DECODE(?,NULL,'%',?))  AND UPPER(A.PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(B.PRACTITIONER_NAME) LIKE UPPER(?)  ORDER BY 2");
		dataMap.put("SQL_PH_DRG_STAT_DISPR_SELECT1","SELECT appl_user_id code, appl_user_name description FROM sm_appl_user_lang_vw a, am_practitioner b WHERE a.func_role_id = b.practitioner_id AND b.pract_type = 'PH' AND UPPER (appl_user_id) LIKE UPPER (?) AND UPPER (appl_user_name) LIKE UPPER (?) AND a.language_id =");
		//dataMap.put("SQL_PH_DRG_STAT_DISPR_SELECT1","SELECT DISTINCT PRACTITIONER_ID  CODE,  PRACTITIONER_NAME DESCRIPTION FROM AM_PRACTITIONER_LANG_VW        AM_PRACTITIONER WHERE PRACT_TYPE = 'PH' AND UPPER(PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(PRACTITIONER_NAME) LIKE UPPER(?) AND LANGUAGE_ID = ");
        dataMap.put("SQL_PH_MEDN_ORD_STAT_SRC_NU_SELECT1","SELECT NURSING_UNIT_CODE CODE, LONG_DESC DESCRIPTION FROM IP_NURSING_UNIT_LANG_VW A, SM_FACILITY_FOR_USER B WHERE A.FACILITY_ID = B.FACILITY_ID  AND UPPER(A.FACILITY_ID) LIKE UPPER(DECODE(?,NULL,'%',?))AND EFF_STATUS='E' AND LOCN_TYPE ='N' AND UPPER(NURSING_UNIT_CODE) LIKE UPPER(?) AND UPPER(LONG_DESC) LIKE UPPER(?) AND A.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_MEDN_ORD_STAT_SRC_CL_SELECT1","SELECT CLINIC_CODE CODE , LONG_DESC DESCRIPTION  FROM OP_CLINIC_LANG_VW A, SM_FACILITY_FOR_USER B WHERE A.FACILITY_ID = B.FACILITY_ID AND UPPER(A.FACILITY_ID) LIKE UPPER(DECODE(?,NULL,'%',?)) AND EFF_STATUS='E' AND CLINIC_TYPE IN ('C','E') AND UPPER(CLINIC_CODE) LIKE UPPER(?)  AND UPPER(LONG_DESC) LIKE UPPER(?)  AND A.LANGUAGE_ID = ");
		dataMap.put("SQL_PH_PATIENT_CLASS_SELECT1", "SELECT PATIENT_CLASS FROM AM_PATIENT_CLASS_LANG_VW AM_PATIENT_CLASS where LANGUAGE_ID = ? ORDER BY 1");
		dataMap.put("SQL_PH_ORDER_TYPE_CODE_SELECT1", "SELECT ORDER_TYPE_CODE FROM OR_ORDER_TYPE_LANG_VW OR_ORDER_TYPE WHERE ORDER_CATEGORY ='PH' AND EFF_STATUS = 'E' AND LANGUAGE_ID = ? ORDER BY 1");
		dataMap.put("SQL_PH_ORDER_TYPE_CODE_SELECT2", "SELECT PRACTITIONER_ID, PRACTITIONER_NAME, SHORT_NAME FROM AM_PRACTITIONER_LANG_VW AM_PRACTITIONER WHERE PRACT_TYPE='PH' AND LANGUAGE_ID = ?");
		// end of medication
		//Start of Query for Dispensed drugs by patient
		//Query for drug select
		dataMap.put("SQL_QUERY_DISP_DRUG_BY_PATIENT", "SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG_LANG_VW PH_DRUG WHERE DISCONTINUED_YN='N' AND DRUG_CODE LIKE UPPER(?) AND DRUG_DESC LIKE UPPER(?) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_DISP_DRUG_BY_PATIENT_SELECT1", "SELECT   A.DISP_NO,  A.DISP_QTY,  A.ORDER_ID,A.DISP_DRUG_CODE, TO_CHAR(TO_DATE(c.added_date,'dd/mm/RRRR hh24:mi'),'dd/mm/yyyy hh:mi') added_date  ,  B.DRUG_DESC,  TO_CHAR(TO_DATE(c.ORD_DATE_TIME, 'dd/mm/RRRR hh24:mi'), 'dd/mm/yyyy hh:mi') ord_date_time,  D.practitioner_name,  Ph_Order_Source(c.source_code,  c.patient_class,  c.ordering_facility_id,  c.source_type,b.language_id) SOURCE,  c.patient_id,  e.patient_name,  get_age(e.date_of_birth) age ,  DECODE(e.sex,  'M',  'male',  'F',  'female',  'unknown')   gender,A.ORDER_LINE_NO FROM   PH_DISP_DTL A,   PH_DRUG_LANG_VW B,   OR_ORDER c,   AM_PRACTITIONER_LANG_VW D,   MP_PATIENT e WHERE   A.disp_drug_code=b.drug_code AND   A.order_id=c.order_id AND   c.ord_pract_id=D.practitioner_id(+)   AND   c.patient_id=e.patient_id    AND   order_category='PH'    AND   c.patient_id=? AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_DISP_DRUG_BY_PATIENT_SELECT2", "SELECT PATIENT_NAME,GET_AGE(DATE_OF_BIRTH) AGE, DECODE(SEX,'M','male','F','female','unknown') GENDER, to_char(DATE_OF_BIRTH,'dd/mm/yyyy') DATE_OF_BIRTH FROM MP_PATIENT WHERE PATIENT_ID=? 	");
		dataMap.put("SQL_DISP_DRUG_BY_PATIENT_SELECT3", "SELECT   B.DRUG_DESC,B.STRENGTH_VALUE||' '||B.STRENGTH_UOM STRENGTH,  decode (d.SLIDING_SCALE_YN ,'Y','Sliding Scale',a.qty_value || ' ' || a.qty_unit) dosage, (SELECT ROUTE_DESC FROM PH_ROUTE WHERE ROUTE_CODE=A.ROUTE_CODE) ROUTE, (SELECT FREQ_DESC FROM AM_FREQUENCY WHERE FREQ_CODE=A.FREQ_CODE) FREQUENCY, A.DURN_VALUE||' '||(SELECT DURN_DESC  FROM AM_DURATION_TYPE WHERE DURN_TYPE=A.DURN_TYPE) DURATION,A.ORDER_QTY||' '||A.ORDER_UOM ORDERQTY FROM OR_ORDER_LINE A,PH_DRUG B,PH_ROUTE C ,or_order_line_ph d WHERE A.ORDER_CATALOG_CODE=B.DRUG_CODE and a.order_id =d.order_id  and a.order_line_num =d.ORDER_LINE_NUM AND A.ROUTE_CODE=C.ROUTE_CODE(+) AND A.ORDER_ID=? AND A.ORDER_LINE_NUM=?");
		dataMap.put("SQL_DISP_DRUG_BY_PATIENT_SELECT4", "SELECT DISTINCT (a.batch_id), c.drug_desc, a.disp_no,TO_CHAR (b.added_date, 'DD/MM/YYYY') disp_date,d.short_name tradename,a.batch_id, TO_CHAR (a.expiry_date, 'DD/MM/YYYY') expiry_date,a.disp_qty, b.disp_uom_code disp_qty_uom     FROM ph_disp_drug_batch a, ph_disp_dtl b, ph_drug c,am_trade_name d WHERE a.facility_id = b.facility_id AND a.disp_no = b.disp_no AND a.drug_code = b.disp_drug_code AND a.drug_code = c.drug_code AND a.disp_no = ? and a.trade_id= d.trade_id AND b.disp_drug_code = ?");
		dataMap.put("SQL_DISP_DRUG_BY_PATIENT_SELECT5", "SELECT ROUTE_CODE, ROUTE_DESC,ROUTE_COLOR FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE EFF_STATUS = 'E' AND LANGUAGE_ID = ? ORDER BY ROUTE_DESC");
		dataMap.put("SQL_DISP_DRUG_BY_PATIENT_SELECT6", "SELECT B.ROUTE_CODE,B.ROUTE_DESC,B.ROUTE_COLOR FROM PH_ROUTE_FOR_FORM A, PH_ROUTE_LANG_VW B WHERE  A.FORM_CODE=(SELECT FORM_CODE FROM PH_DRUG WHERE DRUG_CODE = ?) AND A.ROUTE_CODE=B.ROUTE_CODE AND B.LANGUAGE_ID = ? ORDER BY B.ROUTE_DESC");
		//End of Query for Dispensed drugs by patient

		//Start of Query for Dispensed drugs	
		dataMap.put("SQL_PH_DISP_DRUG_SELECT1", "SELECT F.ROUTE_DESC,G.ROUTE_CODE, C.PATIENT_ID,  A.DISP_NO,  A.DISP_QTY,  A.ORDER_ID,  TO_CHAR(A.ADDED_DATE,  'dd/mm/RRRR hh24:mi') ADDED_DATE  ,  B.DRUG_DESC,  TO_CHAR(C.ORD_DATE_TIME,  'dd/mm/RRRR hh24:mi') ORD_DATE_TIME,  D.PRACTITIONER_NAME,  PH_ORDER_SOURCE(C.SOURCE_CODE,  C.PATIENT_CLASS,  C.ORDERING_FACILITY_ID,  C.SOURCE_TYPE,B.LANGUAGE_ID) SOURCE,  C.PATIENT_ID,  E.PATIENT_NAME||' ,  '||GET_AGE(E.DATE_OF_BIRTH)||',  '||DECODE(E.SEX,  'M',  'male',  'F',  'female',  'unknown')   PATIENTDETAILS,  A.ORDER_LINE_NO ,  B.DRUG_DESC ,  B.PRES_BASE_UOM, B.STOCK_UOM,A.RETURNED_QTY FROM   PH_DISP_DTL A,  PH_DRUG_LANG_VW B,  OR_ORDER C,  AM_PRACTITIONER_LANG_VW D,  MP_PATIENT E,  PH_ROUTE_LANG_VW F, OR_ORDER_LINE G WHERE   C.ORDER_ID = G.ORDER_ID AND A.DISP_DRUG_CODE=B.DRUG_CODE AND  A.ORDER_ID=C.ORDER_ID  and g.ORDER_CATALOG_CODE = a.PRES_DRUG_CODE	and a.ORDER_LINE_NO =g.ORDER_LINE_NUM AND  C.ORD_PRACT_ID=D.PRACTITIONER_ID(+)   AND  C.PATIENT_ID=E.PATIENT_ID    AND  C.ORDER_CATEGORY='PH'    AND  A.DISP_DRUG_CODE=?	AND  A.ADDED_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND  TO_DATE(?,'DD/MM/YYYY')+0.99999 AND G.ROUTE_CODE = F.ROUTE_CODE AND G.ROUTE_CODE LIKE NVL(?,'%') AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ? ORDER BY G.ROUTE_CODE, C.ADDED_DATE DESC");
		dataMap.put("SQL_PH_DISP_DRUG_SELECT2", "SELECT   NVL(SUM(DISP_QTY),  0) DISPENSEDQTY,  NVL(SUM(RETURNED_QTY),  0)  RETURNEDQTY FROM   PH_DISP_DTL A,  PH_DISP_HDR B WHERE    A.DISP_NO=B.DISP_NO AND A.FACILITY_ID=B.FACILITY_ID AND A.DISP_NO=? AND A.FACILITY_ID=? ");
		dataMap.put("SQL_PH_DISP_DRUG_SELECT3", "SELECT COUNT (ORDER_ID) TOTALORDERS, SUM (ORDER_QTY) TOTALORDERED  FROM (SELECT DISTINCT A.ORDER_ID, D.ORDER_QTY FROM PH_DISP_DTL A, PH_DRUG B, OR_ORDER C, OR_ORDER_LINE D  WHERE A.DISP_DRUG_CODE = B.DRUG_CODE AND A.ORDER_ID = C.ORDER_ID  AND C.ORDER_CATEGORY = 'PH' AND C.ORDER_ID = D.ORDER_ID AND A.DISP_DRUG_CODE = ?  AND A.ADDED_DATE BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')+ 0.99999 AND D.ROUTE_CODE LIKE NVL(?,'%'))");
		//End of Query for Dispensed drugs

		//Start of Query for Dispensed Trial Drugs
		dataMap.put("SQL_QUERY_DISP_TRIAL_DRUG_SELECT1", "SELECT DRUG_CODE code,DRUG_DESC description FROM PH_DRUG_LANG_VW A  WHERE DRUG_CODE LIKE ? AND DRUG_DESC LIKE ?   AND TRIAL_DRUG_YN='Y' AND A.LANGUAGE_ID = ? ORDER BY 1");
		dataMap.put("SQL_QUERY_DISP_TRIAL_DRUG_SELECT2", "SELECT   A.DISP_NO,  A.DISP_QTY,   A.ORDER_ID, TO_CHAR(TO_DATE(c.added_date,   'dd/mm/RRRR hh24:mi'),   'dd/mm/yyyy hh:mi') added_date  ,   B.DRUG_DESC,   TO_CHAR(TO_DATE(c.ORD_DATE_TIME,   'dd/mm/RRRR hh24:mi'),   'dd/mm/yyyy hh:mi') ord_date_time,     D.practitioner_name,   Ph_Order_Source(c.source_code,   c.patient_class,   c.ordering_facility_id,   c.source_type,b.language_id) SOURCE,   c.patient_id,	      e.patient_name||' ,   '||get_age(e.date_of_birth)||',   '||DECODE(e.sex,   'M',   'male',   'F',   'female',   'unknown')   PatientDetails,   A.ORDER_LINE_NO ,   b.drug_desc ,   b.pres_base_uom FROM    PH_DISP_DTL A, 	PH_DRUG_LANG_VW B, 	OR_ORDER c,  AM_PRACTITIONER_LANG_VW D, 		MP_PATIENT e, ph_disp_hdr f WHERE   A.disp_drug_code=b.drug_code AND A.order_id=c.order_id 		AND c.ord_pract_id=D.practitioner_id  AND c.patient_id=e.patient_id	and c.ordering_facility_id=f.facility_id and c.order_id=f.order_id   and f.facility_id=a.facility_id	and f.disp_no=a.disp_no	AND c.order_category='PH'  	AND b.trial_drug_yn='Y' AND B.LANGUAGE_ID =  D.LANGUAGE_ID AND B.LANGUAGE_ID =?");
		dataMap.put("SQL_DISP_TRIAL_DRUG_BY_PATIENT_SELECT3", "SELECT   B.DRUG_DESC,B.STRENGTH_VALUE||' '||B.STRENGTH_UOM STRENGTH,  A.QTY_VALUE||' '||A.QTY_UNIT  DOSAGE, (SELECT ROUTE_DESC FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE ROUTE_CODE=A.ROUTE_CODE AND LANGUAGE_ID = ?) ROUTE, (SELECT FREQ_DESC FROM AM_FREQUENCY_LANG_VW AM_FREQUENCY WHERE FREQ_CODE=A.FREQ_CODE AND LANGUAGE_ID = ?) FREQUENCY, A.DURN_VALUE||' '||(SELECT DURN_DESC  FROM AM_DURATION_TYPE_LANG_VW AM_DURATION_TYPE WHERE DURN_TYPE=A.DURN_TYPE AND LANGUAGE_ID = ?) DURATION,A.ORDER_QTY||' '||A.ORDER_UOM ORDERQTY FROM OR_ORDER_LINE A,PH_DRUG_LANG_VW B,PH_ROUTE_LANG_VW C WHERE A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.ROUTE_CODE=C.ROUTE_CODE(+) AND A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_DISP_TRIAL_DRUG_BY_PATIENT_SELECT4", "SELECT   C.DRUG_DESC,A.DISP_NO,TO_CHAR(B.ADDED_DATE,'DD/MM/YYYY') DISP_DATE,   (SELECT A.SHORT_NAME FROM AM_TRADE_NAME_LANG_VW A,PH_TRADE_NAME_FOR_DRUG C    WHERE A.TRADE_ID=C.TRADE_CODE AND C.DRUG_CODE=A.DRUG_CODE AND A.LANGUAGE_ID = ? ) TRADENAME,   A.BATCH_ID, TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE, A.DISP_QTY,    B.DISP_UOM_CODE DISP_QTY_UOM FROM      PH_DISP_DRUG_BATCH A,PH_DISP_DTL B,PH_DRUG_LANG_VW C WHERE A.DISP_NO=B.DISP_NO  AND A.DRUG_CODE=C.DRUG_CODE AND A.DISP_NO=? AND C.LANGUAGE_ID = ?");
		dataMap.put("SQL_QUERY_DISP_TRIAL_DRUG_SELECT3", "SELECT   NVL(SUM(DISP_QTY),  0) DISPENSEDQTY,  NVL(SUM(RETURNED_QTY),  0)  RETURNEDQTY,  COUNT(DISTINCT A.ORDER_ID) TOTALORDERS,  COUNT(DISTINCT B.PATIENT_ID) TOTALPATIENTS,  MAX(PH_GETORDERQTY(?,'TRIAL')) ORDEREDQTY FROM   PH_DISP_DTL A,  PH_DISP_HDR B WHERE    A.DISP_NO=B.DISP_NO AND A.FACILITY_ID=B.FACILITY_ID ");
		dataMap.put("SQL_QUERY_DISP_TRIAL_DRUG_SUMMARY", "SELECT   B.DRUG_CODE, B.DRUG_DESC,COUNT(DISTINCT E.PATIENT_ID) PATIENTS,SUM(DISP_QTY) DISP_QTY,   SUM(RETURNED_QTY) RETURNED_QTY,PRES_BASE_UOM FROM    PH_DISP_DTL A,   PH_DRUG B   ,PH_DISP_HDR E  WHERE    A.DISP_DRUG_CODE=B.DRUG_CODE    AND  E.ORDER_ID=A.ORDER_ID AND B.TRIAL_DRUG_YN='Y'");
		//End of Query for Dispensed Trial Drugs

		//Start of Query for Dispensed Special Drugs
		dataMap.put("SQL_QUERY_DISP_SPECIAL_DRUG_SELECT1", "SELECT   DISTINCT    DRUG_CODE code,   DRUG_DESC description FROM    PH_DRUG_LANG_VW A,OR_ORDER_CATALOG B ,OR_ORDER_CATALOG_BY_PTCL C WHERE    DRUG_CODE LIKE ? AND   DRUG_DESC LIKE ?  AND   B.ORDER_CATEGORY='PH' AND B.ORDER_CATALOG_CODE=A.DRUG_CODE   AND B.ORDER_CATALOG_CODE=C.ORDER_CATALOG_CODE AND C.ORD_SPL_APPR_REQD_YN='Y' AND A.LANGUAGE_ID = ? ORDER BY 1");
		dataMap.put("SQL_QUERY_DISP_SPECIAL_DRUG_SELECT2", "SELECT A.DISP_NO, A.DISP_QTY, A.ORDER_ID, TO_CHAR (TO_DATE (C.ADDED_DATE, 'DD/MM/RRRR HH24:MI'), 'DD/MM/YYYY HH:MI') ADDED_DATE, B.DRUG_DESC, TO_CHAR (TO_DATE (C.ORD_DATE_TIME, 'DD/MM/RRRR HH24:MI'), 'DD/MM/YYYY HH:MI' ) ORD_DATE_TIME, D.PRACTITIONER_NAME, PH_ORDER_SOURCE (C.SOURCE_CODE, C.PATIENT_CLASS, C.ORDERING_FACILITY_ID, C.SOURCE_TYPE,B.LANGUAGE_ID) SOURCE, C.PATIENT_ID, E.PATIENT_NAME || ' ,   ' || GET_AGE (E.DATE_OF_BIRTH) || ',   ' || DECODE (E.SEX, 'M', 'male', 'F', 'female', 'unknown')  PATIENTDETAILS, A.ORDER_LINE_NO, B.DRUG_DESC, B.PRES_BASE_UOM FROM PH_DISP_DTL A, PH_DRUG_LANG_VW B, OR_ORDER C, AM_PRACTITIONER_LANG_VW D, MP_PATIENT E WHERE A.DISP_DRUG_CODE = B.DRUG_CODE AND A.ORDER_ID = C.ORDER_ID AND C.ORD_PRACT_ID = D.PRACTITIONER_ID(+) AND C.PATIENT_ID = E.PATIENT_ID AND C.ORDER_CATEGORY = 'PH' AND EXISTS ( SELECT B1.ORDER_CATALOG_CODE  FROM OR_ORDER_CATALOG A1, OR_ORDER_CATALOG_BY_PTCL B1 WHERE A1.ORDER_CATALOG_CODE = B1.ORDER_CATALOG_CODE   AND B1.ORD_SPL_APPR_REQD_YN = 'Y'   AND A1.ORDER_CATEGORY = 'PH' AND B1.ORDER_CATALOG_CODE = A.DISP_DRUG_CODE) AND B.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_DISP_SPECIAL_DRUG_BY_PATIENT_SELECT3", "SELECT   B.DRUG_DESC,B.STRENGTH_VALUE||' '||B.STRENGTH_UOM STRENGTH,  A.QTY_VALUE||' '||A.QTY_UNIT  DOSAGE, (SELECT ROUTE_DESC FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE ROUTE_CODE=A.ROUTE_CODE AND LANGUAGE_ID = ?) ROUTE, (SELECT FREQ_DESC FROM AM_FREQUENCY_LANG_VW AM_FREQUENCY WHERE FREQ_CODE=A.FREQ_CODE AND LANGUAGE_ID = ?) FREQUENCY, A.DURN_VALUE||' '||(SELECT DURN_DESC  FROM AM_DURATION_TYPE_LANG_VW AM_DURATION_TYPE WHERE DURN_TYPE=A.DURN_TYPE AND LANGUAGE_ID = ?) DURATION,A.ORDER_QTY||' '||A.ORDER_UOM ORDERQTY FROM OR_ORDER_LINE A,PH_DRUG_LANG_VW B,PH_ROUTE_LANG_VW C WHERE A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.ROUTE_CODE=C.ROUTE_CODE(+) AND A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_DISP_SPECIAL_DRUG_BY_PATIENT_SELECT4", "SELECT   C.DRUG_DESC,A.DISP_NO,TO_CHAR(B.ADDED_DATE,'DD/MM/YYYY') DISP_DATE,   (SELECT A.SHORT_NAME FROM AM_TRADE_NAME_LANG_VW A,PH_TRADE_NAME_FOR_DRUG C    WHERE A.TRADE_ID=C.TRADE_CODE AND C.DRUG_CODE=A.DRUG_CODE AND A.LANGUAGE_ID = ?) TRADENAME,   A.BATCH_ID, TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE, A.DISP_QTY,    B.DISP_UOM_CODE DISP_QTY_UOM FROM      PH_DISP_DRUG_BATCH A,PH_DISP_DTL B,PH_DRUG_LANG_VW C WHERE A.DISP_NO=B.DISP_NO  AND A.DRUG_CODE=C.DRUG_CODE AND A.DISP_NO=? AND C.LANGUAGE_ID = ?");
		dataMap.put("SQL_QUERY_DISP_SPECIAL_DRUG_SELECT3", "SELECT   NVL(SUM(DISP_QTY),  0) DISPENSEDQTY,  NVL(SUM(RETURNED_QTY),  0)  RETURNEDQTY,  COUNT(DISTINCT A.ORDER_ID) TOTALORDERS,  COUNT(DISTINCT B.PATIENT_ID) TOTALPATIENTS,  MAX(PH_GETORDERQTY(?,'SPECIAL')) ORDEREDQTY FROM   PH_DISP_DTL A,  PH_DISP_HDR B WHERE    A.DISP_NO=B.DISP_NO  ");
		dataMap.put("SQL_QUERY_DISP_SPECIAL_DRUG_SUMMARY", "SELECT   B.DRUG_CODE, B.DRUG_DESC,COUNT(DISTINCT E.PATIENT_ID) PATIENTS,SUM(DISP_QTY) DISP_QTY,   SUM(RETURNED_QTY) RETURNED_QTY,B.PRES_BASE_UOM FROM    PH_DISP_DTL A,   PH_DRUG B,   OR_ORDER_CATALOG C,   OR_ORDER_CATALOG_BY_PTCL D,PH_DISP_HDR E  WHERE    A.DISP_DRUG_CODE=B.DRUG_CODE    AND C.ORDER_CATALOG_CODE=D.ORDER_CATALOG_CODE AND   C.ORDER_CATEGORY='PH' AND D.ORD_SPL_APPR_REQD_YN='Y'   AND B.DRUG_CODE=C.ORDER_CATALOG_CODE AND   E.ORDER_ID=A.ORDER_ID");
		//End of Query for Dispensed Special Drugs

		// Start of Query for Medn Administration
		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT1", "SELECT NURSING_UNIT_CODE,FACILITY_ID,SHORT_DESC FROM IP_NURSING_UNIT A ORDER BY  SHORT_DESC");
		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT2", "SELECT  DISTINCT A.ENCOUNTER_ID, ASSIGN_BED_NUM, C.PATIENT_NAME, A.PATIENT_ID, GET_AGE (C.DATE_OF_BIRTH) AGE, DECODE (C.SEX, 'M', 'male', 'F', 'female', 'unknown') GENDER, (SELECT SHORT_NAME FROM MP_COUNTRY_LANG_VW MP_COUNTRY WHERE COUNTRY_CODE = C.NATIONALITY_CODE AND LANGUAGE_ID = ? ) NATIONALITY FROM  PR_ENCOUNTER A, MP_PATIENT C, PH_MEDN_ADMIN D, OR_ORDER_LINE E WHERE E.ORDER_LINE_NUM = D.ORDER_LINE_NUM AND E.ORDER_ID = D.ORDER_ID  AND C.PATIENT_ID = A.PATIENT_ID AND D.ENCOUNTER_ID = A.ENCOUNTER_ID AND D.FACILITY_ID = A.FACILITY_ID AND /* PATIENT ID */ C.PATIENT_ID  BETWEEN NVL (?, '!') AND NVL (?, '~') AND a.encounter_id = nvl(?,a.encounter_id) AND D.FACILITY_ID = ? AND D.SCH_DATE_TIME >= E.ORD_DATE_TIME");

		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT3", "SELECT  F.SHORT_DESC, b.ADMIN_DRUG_CODE,   TO_CHAR(A.ADMIN_DATE_TIME ,   'DD/MM/YYYY HH24:MI') ADMIN_TIME,   A.ADMIN_BY,D.PRACTITIONER_NAME,   e.drug_desc,   b.ADMIN_DOSAGE_QTY,   B.admin_dosage_uom_code,    A.ADMIN_REMARKS,  'Batch Id: '||NVL(B.BATCH_ID,'-- ')||' Expiry Date: '||    NVL(TO_CHAR(B.EXPIRY_DATE,'dd/mm/yyyy'),'-- ')||' Trade Name: '||NVL((SELECT SHORT_NAME FROM  AM_TRADE_NAME_lang_vw WHERE    language_id=? and TRADE_ID=B.TRADE_ID ),'-- ')  BATCH_DETAILS, G.REASON_DESC, A.ADR_REMARKS, A.ADR_RECORDED_DATE_TIME, A.ADR_RECORDED_BY FROM ph_medn_admin_dtl b, or_order c,am_practitioner_lang_vw d, ph_medn_admin a, ph_drug_lang_vw e, ip_nursing_unit_lang_vw f, ph_medn_trn_reason_lang_vw g WHERE    F.FACILITY_ID=A.FACILITY_ID AND F.NURSING_UNIT_CODE=A.ADMIN_NURSING_UNIT_CODE AND F.FACILITY_ID=B.FACILITY_ID AND A.FACILITY_ID= b.FACILITY_ID AND   A.ENCOUNTER_ID= b.ENCOUNTER_ID AND  a.order_id = b.order_id AND      A.order_id=c.order_id AND  c.ord_pract_id=D.practitioner_id  AND A.SCH_DATE_TIME=b.SCH_DATE_TIME AND  A.ORD_DRUG_CODE=  b.ORD_DRUG_CODE  AND    E.DRUG_CODE(+)=B.ADMIN_DRUG_CODE AND   A.FACILITY_ID=? AND   A.ENCOUNTER_ID=? AND   TO_CHAR(A.SCH_DATE_TIME,'dd/mm/yyyy')=TO_CHAR(TO_DATE(?,'dd/mm/yyyy'),'dd/mm/yyyy') AND TO_CHAR(A.SCH_DATE_TIME,'HH24:MI')=TO_CHAR(TO_DATE(?,'HH24:MI'),'HH24:MI') AND   A.ORD_DRUG_CODE=? AND G.REASON_CODE(+) = A.ADR_REASON_CODE AND A.ORDER_ID=? AND g.appl_trn_type(+)='M' AND d.language_id = ? AND e.language_id(+) = ? AND f.language_id = d.language_id AND g.language_id (+)= ? ");
		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT3A", "SELECT  F.SHORT_DESC, b.ADMIN_DRUG_CODE,   TO_CHAR(A.ADMIN_DATE_TIME ,   'DD/MM/YYYY HH24:MI') ADMIN_TIME,   A.ADMIN_BY,D.PRACTITIONER_NAME,   e.drug_desc,   b.ADMIN_DOSAGE_QTY,   B.admin_dosage_uom_code,    A.ADMIN_REMARKS,  'Batch Id: '||NVL(B.BATCH_ID,'--')||' Expiry Date: '||    NVL(TO_CHAR(B.EXPIRY_DATE,'dd/mm/yyyy'),'-- ')||' Trade Name: '||NVL((SELECT SHORT_NAME FROM  AM_TRADE_NAME_lang_vw WHERE    language_id=? and  TRADE_ID=B.TRADE_ID ),'-- ')  BATCH_DETAILS, G.REASON_DESC, A.ADR_REMARKS, A.ADR_RECORDED_DATE_TIME, A.ADR_RECORDED_BY FROM ph_medn_admin_dtl b, or_order c,am_practitioner_lang_vw d, ph_medn_admin a, ph_drug_lang_vw e, op_clinic_lang_vw f, ph_medn_trn_reason_lang_vw g WHERE    F.FACILITY_ID=A.FACILITY_ID AND F.clinic_code=A.ADMIN_NURSING_UNIT_CODE AND F.FACILITY_ID=B.FACILITY_ID AND A.FACILITY_ID= b.FACILITY_ID AND   A.ENCOUNTER_ID= b.ENCOUNTER_ID AND  a.order_id = b.order_id AND      A.order_id=c.order_id AND  c.ord_pract_id=D.practitioner_id  AND A.SCH_DATE_TIME=b.SCH_DATE_TIME AND  A.ORD_DRUG_CODE=  b.ORD_DRUG_CODE  AND    E.DRUG_CODE(+)=B.ADMIN_DRUG_CODE AND   A.FACILITY_ID=? AND   A.ENCOUNTER_ID=? AND   TO_CHAR(A.SCH_DATE_TIME,'dd/mm/yyyy')=TO_CHAR(TO_DATE(?,'dd/mm/yyyy'),'dd/mm/yyyy') AND TO_CHAR(A.SCH_DATE_TIME,'HH24:MI')=TO_CHAR(TO_DATE(?,'HH24:MI'),'HH24:MI') AND   A.ORD_DRUG_CODE=? AND G.REASON_CODE(+) = A.ADR_REASON_CODE AND A.ORDER_ID=? AND g.appl_trn_type(+)='M' AND d.language_id = ? AND e.language_id (+)= ? AND f.language_id = d.language_id AND g.language_id (+)= ?");
		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT4", "SELECT   F.SHORT_DESC,A.ADMIN_BY,A.non_ADMIN_REMARKS,  D.PRACTITIONER_NAME FROM   OR_ORDER c,  am_practitioner_lang_vw d,  PH_MEDN_ADMIN A,IP_NURSING_UNIT_lang_vw F WHERE   F.FACILITY_ID=A.FACILITY_ID AND F.NURSING_UNIT_CODE=A.ADMIN_NURSING_UNIT_CODE AND C.ORDERING_FACILITY_ID=F.FACILITY_ID AND A.order_id=c.order_id AND  c.ord_pract_id=D.practitioner_id     AND   A.FACILITY_ID=?  AND   A.ENCOUNTER_ID=?  AND   TO_CHAR(A.SCH_DATE_TIME,'dd/mm/yyyy')=TO_CHAR(TO_DATE(?,'dd/mm/yyyy'),'dd/mm/yyyy')  AND TO_CHAR(A.SCH_DATE_TIME,'HH24:MI')=TO_CHAR(TO_DATE(?,'HH24:MI'),'HH24:MI') AND   A.ORD_DRUG_CODE=? AND A.ORDER_ID=?  and d.language_id =f.language_id and f.language_id =?  ");		
		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT4A", "SELECT   F.SHORT_DESC,A.ADMIN_BY,A.non_ADMIN_REMARKS,  D.PRACTITIONER_NAME FROM   OR_ORDER c,  am_practitioner_lang_vw d,  PH_MEDN_ADMIN A,op_clinic_lang_vw F WHERE   F.FACILITY_ID=A.FACILITY_ID AND F.clinic_CODE=A.ADMIN_NURSING_UNIT_CODE AND C.ORDERING_FACILITY_ID=F.FACILITY_ID AND A.order_id=c.order_id AND  c.ord_pract_id=D.practitioner_id     AND   A.FACILITY_ID=?  AND   A.ENCOUNTER_ID=?  AND   TO_CHAR(A.SCH_DATE_TIME,'dd/mm/yyyy')=TO_CHAR(TO_DATE(?,'dd/mm/yyyy'),'dd/mm/yyyy') AND TO_CHAR(A.SCH_DATE_TIME,'HH24:MI')=TO_CHAR(TO_DATE(?,'HH24:MI'),'HH24:MI')  AND   A.ORD_DRUG_CODE=? AND A.ORDER_ID=?  and d.language_id =f.language_id and f.language_id =?  ");

		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT5", "SELECT to_char(SYSDATE,'dd/mm/yyyy hh24:mi') SYS_DATE_TIME, to_char(SYSDATE,'dd/mm/yyyy') SYS_DATE from dual");
		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT6", "SELECT e.drug_desc, b.admin_dosage_qty,  TO_CHAR (a.admin_date_time, 'DD/MM/YYYY HH24:MI') admin_time, 'Batch Id:' || NVL (b.batch_id, '--') || ' Expiry Date:' || NVL (TO_CHAR (b.expiry_date, 'dd/mm/yyyy'), '--') || ' Trade Name:' || NVL ((SELECT short_name  FROM am_trade_name  WHERE trade_id = b.trade_id), '--') batch_details, a.admin_remarks, b.admin_dosage_uom_code, ' ' practitioner_name, a.admin_by, b.admin_drug_code FROM ph_medn_admin_dtl b, ph_medn_admin a, ph_drug e  WHERE a.facility_id = b.facility_id   AND a.encounter_id = b.encounter_id   AND a.sch_date_time = b.sch_date_time   AND a.ord_drug_code = b.ord_drug_code   AND e.drug_code = b.admin_drug_code   AND a.facility_id = ?   AND a.encounter_id = ?   AND TO_CHAR (a.sch_date_time, 'dd/mm/yyyy') = TO_CHAR (TO_DATE (?, 'dd/mm/yyyy'), 'dd/mm/yyyy')   AND a.ord_drug_code = ?");
		dataMap.put("SQL_QUERY_MED_ADMIN_SELECT7", "SELECT ENCOUNTER_ID FROM IP_OPEN_ENCOUNTER WHERE PATIENT_ID=? AND FACILITY_ID=?");
		// End of Query for Medn Administration

		//Start of Return Medication Transaction
		dataMap.put("SQL_PH_RET_MEDN_SELECT1","SELECT APPL_USER_NAME,UPPER(APP_PASSWORD.DECRYPT(DISP_PASSWORD)) password  FROM ph_disp_users A,sm_appl_user b WHERE A.appl_user_id=b.appl_user_id and a.APPL_user_id =?");
		//Dispense locations for the user
		dataMap.put("SQL_PH_RET_MEDN_SELECT2","SELECT A.short_desc,A.disp_locn_code FROM PH_DISP_LOCN_LANG_VW A,PH_DISP_RIGHTS b,PH_WS_NO_FOR_DISP_LOCN c WHERE (A.Disp_locn_category=? OR A.disp_locn_category='B') AND A.facility_id=? AND A.Disp_locn_code=b.Disp_locn_code AND A.facility_id=b.facility_id AND A.Disp_locn_code=c.Disp_locn_code  AND A.facility_id=c.facility_id AND b.appl_user_id=? AND c.ws_no=? AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_RET_MEDN_SELECT3", "SELECT 1 FROM AM_PRACTITIONER A,SM_APPL_USER B WHERE A.PRACTITIONER_ID=B.FUNC_ROLE_ID AND A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND A.PRACT_TYPE='PH' AND APPL_USER_ID=?");
		dataMap.put("SQL_PH_RET_MEDN_SELECT4", "SELECT    TO_CHAR(SYSDATE-NVL(MAX_DRUG_RETENTION_BEF_RTN,0),'dd/mm/yyyy hh24:mi') cutoff,to_char(SYSDATE,'dd/mm/yyyy') CURR_DATE FROM    PH_FACILITY_PARAM  WHERE   facility_id=?");
		dataMap.put("SQL_PH_RET_MEDN_SELECT5", "SELECT DISTINCT disp_drug_code, d.drug_desc FROM (SELECT drug_desc drug_desc, drug_code drug_code  FROM ph_drug_lang_vw WHERE language_id = ? UNION SELECT NVL (short_name, long_name) drug_desc,tpn_regimen_code drug_code FROM ph_tpn_regimen_lang_vw   WHERE standard_regimen_yn = 'Y' and language_id = ?) d,ph_disp_dtl a, ph_disp_hdr b,   mp_patient c WHERE a.facility_id = b.facility_id AND a.disp_no = b.disp_no  AND c.patient_id = b.patient_id AND b.patient_id = ? AND a.added_date >=  DECODE (?, 'O', TO_DATE (?, 'dd/mm/yyyy hh24:mi'), a.added_date)   AND a.disp_drug_code = d.drug_code AND a.facility_id = ? AND b.order_id = NVL (?, b.order_id) AND a.disp_no = NVL (?, a.disp_no) AND a.disp_drug_code = NVL (?, a.disp_drug_code)AND a.disp_locn_code = NVL (?, a.disp_locn_code) AND a.disp_qty <> NVL (a.returned_qty, 0)  AND EXISTS (  SELECT * FROM ph_disp_drug_batch WHERE SYSDATE < expiry_date AND disp_no = a.disp_no AND facility_id = a.facility_id AND srl_no = a.srl_no) ");

		dataMap.put("SQL_PH_RET_MEDN_SELECT6", "SELECT reason_code,reason_desc FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE appl_trn_type='T' AND LANGUAGE_ID = ? and EFF_STATUS='E'");//Added for GHL-CRF-0412 eff_status='E'
		dataMap.put("SQL_PH_RET_MEDN_SELECT7", "SELECT   D.DRUG_DESC, DECODE(GREATEST(SYSDATE,expiry_date),SYSDATE,'N','Y') valid, C.DOC_TYPE, C.DOC_NO, A.STORE_CODE,  A.ITEM_CODE,  A.BIN_LOCATION_CODE, A.BATCH_ID,   TO_CHAR(A.EXPIRY_DATE,   'DD/MM/YYYY') EXPIRY_DATE,   A.DISP_NO,a.srl_no,f.doc_srl_no,a.srl_no_batch,   TO_CHAR(B.ADDED_DATE,   'dd/mm/yyyy') added_date,   A.DISP_QTY ISSUEDQTY, B.DISP_UOM_CODE QTYUOM,A.DISP_QTY-NVL(A.RETURNED_QTY,   0)  RETURNABLE,   nvl(A.RETURNED_QTY,0) RETURNEDQTY,C.ENCOUNTER_ID FROM    (SELECT drug_desc drug_desc, drug_code drug_code, nvl(content_in_pres_base_uom,1) content_in_pres_base_uom FROM ph_drug_lang_vw where  language_id=? UNION SELECT NVL(short_name, long_name) drug_desc, tpn_regimen_code drug_code, NVL(content_in_base_unit,1) content_in_pres_base_uom FROM ph_tpn_regimen_lang_vw WHERE standard_regimen_yn = 'Y' and language_id=?) d,   PH_DISP_DRUG_BATCH a,   PH_DISP_DTL b,   ph_disp_hdr c,   mp_patient e, st_sal_dtl_exp f WHERE    a.facility_id=b.facility_id AND   a.disp_no=b.disp_no AND   a.srl_no=b.srl_no AND   c.patient_id=e.patient_id  AND   c.facility_id=b.facility_id AND   c.disp_no=b.disp_no   AND    b.DISP_DRUG_CODE=D.DRUG_CODE      AND   E.patient_id=?  and a.FACILITY_ID = f.FACILITY_ID and c.doc_type =f.doc_type_code and  c.doc_NO    = f.doc_no  and a.STORE_CODE  =  f.STORE_CODE and a.ITEM_CODE   = f.ITEM_CODE and a.BATCH_ID    = f.BATCH_ID and a.EXPIRY_DATE = f.EXPIRY_DATE_OR_RECEIPT_DATE and a.BIN_LOCATION_CODE = f.BIN_LOCATION_CODE and a.TRADE_ID =f.TRADE_ID  AND  a.added_date>=to_date(?,'dd/mm/yyyy hh24:mi') AND   a.facility_id=?   AND   C.order_id=NVL(?,C.order_id)     AND   a.disp_no=NVL(?,a.disp_no)    AND   a.disp_locn_code=nvl(?,a.disp_locn_code)  AND a.DISP_QTY<>NVL(a.RETURNED_QTY,0) and sysdate<expiry_date ");
		dataMap.put("SQL_PH_RET_MEDN_SELECT7A", "SELECT rtn.RTN_MEDN_NO, TO_CHAR (rtn.RETURNED_DATE, 'DD/MM/YYYY') RETURNED_DATE, d.drug_desc, DECODE (GREATEST (SYSDATE, a.expiry_date), SYSDATE, 'N', 'Y') valid, a.batch_id, TO_CHAR (a.expiry_date, 'DD/MM/YYYY') expiry_date, a.disp_no, a.srl_no, a.srl_no_batch, TO_CHAR (b.added_date, 'dd/mm/yyyy') added_date, a.disp_qty issuedqty, b.disp_uom_code qtyuom, a.disp_qty - NVL (a.returned_qty, 0) returnable, NVL (a.returned_qty, 0) returnedqty FROM (SELECT drug_desc drug_desc, drug_code drug_code FROM ph_drug_lang_vw WHERE language_id = ? UNION SELECT NVL (short_name, long_name) drug_desc, tpn_regimen_code drug_code FROM ph_tpn_regimen_lang_vw WHERE standard_regimen_yn = 'Y' AND language_id = ?) d, ph_disp_drug_batch a, ph_disp_dtl b, ph_disp_hdr c, mp_patient e, PH_RETN_MEDN rtn WHERE a.facility_id = b.facility_id AND a.disp_no = b.disp_no AND a.srl_no = b.srl_no AND rtn.facility_id = b.facility_id AND rtn.disp_no = b.disp_no AND rtn.srl_no = b.srl_no AND rtn.SRL_NO_BATCH = a.SRL_NO_BATCH AND c.patient_id = e.patient_id AND c.facility_id = b.facility_id AND c.disp_no = b.disp_no AND b.disp_drug_code = d.drug_code AND e.patient_id = ? AND a.facility_id = ? AND c.order_id = NVL (?, c.order_id) AND a.disp_no = NVL (?, a.disp_no) AND a.disp_locn_code = NVL (?, a.disp_locn_code) /*AND SYSDATE < a.expiry_date*/ AND a.returned_qty != '0' order by RTN_MEDN_NO desc");//Commented For SKR-SCF-1342
		dataMap.put("SQL_PH_RET_MEDN_SELECT8", "SELECT nvl( decode(?,'en',PATIENT_NAME, PATIENT_NAME_LOC_LANG),PATIENT_NAME) PATIENT_NAME, DECODE(sex,'M','male','F','female','unknown') sex, get_age(date_of_birth) age FROM mp_patient where patient_id=?");
		dataMap.put("SQL_PH_RET_MEDN_SELECT9", "SELECT 1 FROM    PH_DISP_RIGHTS b WHERE    b.appl_user_id=?  AND ( b.accept_medn_rtn_yn='Y' OR b.ip_accept_medn_rtn_yn='Y') ");
		dataMap.put("SQL_PH_RET_MEDN_SELECT10","SELECT ORDER_ID,ORDER_LINE_NO FROM PH_DISP_DTL WHERE DISP_NO=? AND SRL_NO=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_RET_MEDN_SELECT11","SELECT REISSUE_REASON_CODE FROM PH_DISP_DTL WHERE FACILITY_ID=? AND DISP_NO=?");
        dataMap.put("SQL_PH_RET_MEDN_SELECT12","SELECT b.BL_INCL_EXCL_OVERRIDE_VALUE,b.BL_INCL_EXCL_OVERRIDE_REASON FROM PH_DISP_DTL a,or_order_line_ph b WHERE DISP_NO=? AND SRL_NO=? AND FACILITY_ID=? and a.order_id=b.order_id  and a.ORDER_LINE_no =b.ORDER_LINE_NUM");
		dataMap.put("SQL_PH_RET_MEDN_UPDATE1", "UPDATE PH_DISP_DRUG_BATCH SET RETURNED_QTY=NVL(RETURNED_QTY,0)+NVL(?,0), MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE DISP_NO=? AND SRL_NO=? AND SRL_NO_BATCH=? AND FACILITY_ID=? ");
		dataMap.put("SQL_PH_RET_MEDN_UPDATE2", "UPDATE PH_DISP_DTL SET RETURNED_QTY=NVL(RETURNED_QTY,0)+NVL(?,0),RETURN_REASON_CODE=?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ?  WHERE DISP_NO=? AND SRL_NO=? AND FACILITY_ID=?  ");
		dataMap.put("SQL_PH_RET_MEDN_UPDATE3", "UPDATE PH_PATIENT_DRUG_PROFILE SET RETURNED_QTY=NVL(RETURNED_QTY,0)+?,RETURN_DATE_TIME=SYSDATE,RETURN_REASON_CODE=?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_RET_MEDN_INSERT1", " INSERT INTO PH_RETURN_MEDN_LOG( FACILITY_ID , DISP_NO,  SRL_NO  , MEDN_RETURN_DATE,ITEM_CODE ,RETURNED_QTY ,RETURN_REASON_CODE ,  TOKEN_SERIES_CODE, TOKEN_SERIAL_NO, TOKEN_STATUS,  ADDED_BY_ID , ADDED_DATE , ADDED_AT_WS_NO , ADDED_FACILITY_ID , MODIFIED_BY_ID ,  MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID )VALUES(?,?,?,SYSDATE,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("JNDI_PH_ReturnMedication", "java:comp/env/ReturnMedication");
		//End of Return MedicationTransaction

		//Problem Stage - Begin - Dheeraj - 15 Jul 2003
		dataMap.put("SQL_PH_PROBLEM_STAGE_INSERT", " INSERT INTO ph_problem_stage (stage_code, problem_ind,short_desc,long_desc, eff_status, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES ((?),(?),(?),(?),(?),(?),sysdate,(?),(?),(?),sysdate,(?),(?)) ");
		dataMap.put("SQL_PH_PROBLEM_STAGE_DUPLICATE_CHK_MULIPLE", " SELECT stage_code FROM ph_problem_stage WHERE problem_ind  = (?) AND stage_code IN (?) ");
		dataMap.put("SQL_PH_PROBLEM_STAGE_SELECT", " SELECT stage_code,DECODE(problem_ind,'O','Oncology') problem_ind,long_desc,short_desc,eff_status     FROM PH_PROBLEM_STAGE_LANG_VW PH_PROBLEM_STAGE WHERE UPPER(problem_ind) LIKE UPPER(?) AND  UPPER(stage_code) LIKE UPPER(?)  AND UPPER(long_desc) LIKE UPPER(?) AND UPPER(short_desc) LIKE UPPER(?) AND eff_status LIKE (?) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_PROBLEM_STAGE_LOAD", " SELECT DECODE(problem_ind,'O','Oncology')problem_ind,stage_code,long_desc,short_desc,eff_status     FROM PH_PROBLEM_STAGE WHERE UPPER(stage_code) LIKE UPPER(?) ");
		dataMap.put("SQL_PH_PROBLEM_STAGE_UPDATE", " update PH_PROBLEM_STAGE set long_desc=(?),short_desc=(?),eff_status =(?), modified_by_id = (?), modified_at_ws_no = (?), modified_date = sysdate, modified_facility_id= (?) WHERE stage_code=(?) and problem_ind = (?)  ");
		dataMap.put("PROBLEM_STAGE_JNDI", "java:comp/env/PHProblemStage");
		//Problem Stage - End - Dheeraj - 16 Jul 2003

		//Order Intention - Begin - Dheeraj - 16 Jul 2003
		dataMap.put("SQL_PH_ORDER_INTENTION_INSERT", " INSERT INTO ph_order_intention (intention_code, problem_ind, short_desc,long_desc, eff_status, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES ((?),(?),(?),(?),(?),(?),sysdate,(?),(?),(?),sysdate,(?),(?)) ");
		dataMap.put("SQL_PH_ORDER_INTENTION_DUPLICATE_CHK_MULIPLE", " SELECT intention_code FROM ph_order_intention WHERE problem_ind  = (?) AND intention_code IN (?) ");
		dataMap.put("SQL_PH_ORDER_INTENTION_SELECT", " SELECT intention_code,DECODE(problem_ind,'O','Oncology') problem_ind,long_desc,short_desc,eff_status     FROM ph_order_intention_lang_vw ph_order_intention WHERE  UPPER(problem_ind) LIKE UPPER(?) AND  UPPER(intention_code) LIKE UPPER(?)  AND UPPER(long_desc) LIKE UPPER(?) AND UPPER(short_desc) LIKE UPPER(?) AND eff_status LIKE (?) AND language_id = ? ");
		dataMap.put("SQL_PH_ORDER_INTENTION_LOAD", " SELECT  DECODE(problem_ind,'O','Oncology')problem_ind_disp, problem_ind,intention_code,long_desc,short_desc,eff_status     FROM ph_order_intention WHERE UPPER(intention_code) LIKE UPPER(?) ");
		dataMap.put("SQL_PH_ORDER_INTENTION_UPDATE", " update ph_order_intention set long_desc=(?),short_desc=(?),eff_status =(?), modified_by_id = (?), modified_at_ws_no = (?), modified_date = sysdate, modified_facility_id= (?) WHERE intention_code=(?) and problem_ind = (?)  ");
		dataMap.put("ORDER_INTENTION_JNDI", "java:comp/env/PHOrderIntention");
		//Order Intention - End - Dheeraj - 17 Jul 2003

		//Regimen Service - Begin - Dheeraj - 17 Jul 2003
		dataMap.put("SQL_PH_REGIMEN_SERVICE_INSERT", " INSERT INTO ph_regimen_service (service_code, problem_ind, regimen_yn,tpn_yn, eff_status, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES ((?),(?),(?),(?),(?),(?),sysdate,(?),(?),(?),sysdate,(?),(?)) ");
		dataMap.put("SQL_PH_REGIMEN_SERVICE_SERVICE_CODE_LOOKUP", "  SELECT service_code code,short_desc description FROM am_service WHERE upper(service_code) like upper(?) and upper(short_desc) like upper(?)");
		dataMap.put("SQL_PH_REGIMEN_SERVICE_SERVICE_CODE_LOOKUP_VALIDATE", "  SELECT service_code FROM am_service WHERE service_code like (?)");
		dataMap.put("SQL_PH_REGIMEN_SERVICE_DUPLICATE_CHK_MULIPLE", " SELECT service_code FROM ph_regimen_service WHERE problem_ind  = (?) AND service_code IN (?) ");
		dataMap.put("SQL_PH_REGIMEN_SERVICE_SELECT", " SELECT a.service_code, b.short_desc, DECODE(a.problem_ind,'O','Oncology') problem_ind ,a.regimen_yn, tpn_yn, a.eff_status FROM ph_regimen_service a, am_service_lang_vw b WHERE   UPPER(a.problem_ind) LIKE UPPER(?) AND  UPPER(a.service_code) LIKE UPPER(?) AND  a.regimen_yn LIKE (?) AND  a.tpn_yn LIKE (?) AND a.eff_status LIKE (?) AND Upper(b.short_desc) LIKE Upper(?) AND a.service_code = b.service_code AND b.language_id = ?");
		dataMap.put("SQL_PH_REGIMEN_SERVICE_LOAD", " SELECT  DECODE(problem_ind,'O','Oncology')problem_ind_disp, problem_ind, service_code,regimen_yn,tpn_yn,eff_status     FROM ph_regimen_service WHERE UPPER(service_code) LIKE UPPER(?) ");
		dataMap.put("SQL_PH_REGIMEN_SERVICE_UPDATE", " update ph_regimen_service set regimen_yn=(?),tpn_yn=(?),eff_status =(?), modified_by_id = (?), modified_at_ws_no = (?), modified_date = sysdate, modified_facility_id= (?) WHERE service_code = (?) and problem_ind = (?)  ");
		dataMap.put("REGIMEN_SERVICE_JNDI", "java:comp/env/PHRegimenService");
		//Regimen Service - End - Dheeraj -17 Jul 2003

		//Stress Factor - Begin - Dheeraj - 05 Aug 2003
		dataMap.put("SQL_PH_STRESS_FACTOR_CHK_DEFAULT_YN", " select count(*) count from ph_tpn_weightage_for_stress where default_yn = 'Y'");
		dataMap.put("SQL_PH_STRESS_FACTOR_MAX_COUNT", " select max(srl_no) from ph_tpn_weightage_for_stress");
		dataMap.put("SQL_PH_STRESS_FACTOR_INSERT", " INSERT INTO ph_tpn_weightage_for_stress (srl_no, stress_related_option, weightage,default_yn, system_defined_yn, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES ((?),(?),(?),(?),(?),(?),sysdate,(?),(?),(?),sysdate,(?),(?)) ");
		dataMap.put("SQL_PH_STRESS_FACTOR_SELECT", " SELECT srl_no, stress_related_option, weightage, default_yn,system_defined_yn  FROM PH_TPN_WTAGE_FOR_STS_LANG_VW ph_tpn_weightage_for_stress WHERE   language_id = ? AND UPPER(stress_related_option) LIKE UPPER(?) AND  UPPER(weightage) LIKE UPPER(?) AND  default_yn LIKE (?) ");
		dataMap.put("SQL_PH_STRESS_FACTOR_LOAD", " SELECT  stress_related_option, weightage, default_yn,system_defined_yn     FROM PH_TPN_WTAGE_FOR_STS_LANG_VW ph_tpn_weightage_for_stress WHERE srl_no LIKE (?) AND language_id = ?");
		dataMap.put("SQL_PH_STRESS_FACTOR_UPDATE", " update ph_tpn_weightage_for_stress set stress_related_option=(?),weightage =(?),default_yn=(?), modified_by_id = (?), modified_at_ws_no = (?), modified_date = sysdate, modified_facility_id= (?) WHERE srl_no = (?)");
		dataMap.put("SQL_PH_STRESS_FACTOR_DELETE", " DELETE  FROM ph_tpn_weightage_for_stress  WHERE srl_no = (?)");
		dataMap.put("STRESS_FACTOR_JNDI", "java:comp/env/PHStressFactor");
		//Stress Factor - End - Dheeraj -

		//Cyto-Toxic Medication Orders -- Begin
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_SERVICE_SELECT", "SELECT regimen_yn,tpn_yn,DECODE(problem_ind,'O','Oncology','T','TB','P','Psycho')  indicator_desc,problem_ind FROM ph_regimen_service WHERE service_code = ?  AND eff_Status ='E' ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_STAGE_SELECT", "SELECT stage_code,short_desc FROM ph_problem_Stage_lang_vw ph_problem_Stage WHERE problem_ind =  ? AND eff_status ='E' AND language_id = ?");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_INTENTION_SELECT", "SELECT intention_code,short_desc FROM ph_order_intention_lang_vw ph_order_intention WHERE problem_ind =  ? AND eff_status ='E' AND language_id = ?");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_ORDERIDS_SELECT", "SELECT ORDER_ID FROM OR_ORDER WHERE ORDER_SET_ID=?");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_ORDERIDS_SELECT1", "SELECT ORDER_ID FROM OR_ORDER WHERE ORDER_SET_ID=(SELECT ORDER_SET_ID FROM OR_ORDER WHERE ORDER_ID=?)");
        dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_INTENTION_SELECT1", "SELECT IV_INGREDIENT_YN, IV_FLUID_YN from PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_SELECT","SELECT distinct a.order_catalog_code order_catalog_code,b.catalog_synonym short_desc,a.order_category order_category FROM or_order_set_trans_vw a ,or_catalog_synonym_lang_vw b,or_order_catalog_by_ptcl c, or_order_catalog d WHERE a.order_catalog_code = b.order_catalog_code AND a.Order_catalog_code=d.order_catalog_code and a.order_catalog_code = c.order_catalog_code AND a.order_category = nvl(?,a.order_category) and d.iv_prep_yn ='C' AND nvl(a.facility_id,?) = ? AND nvl(a.source_type,?) = ? AND nvl(a.source_code,?) = ? AND nvl(a.service_code,?) = ? AND nvl(a.practitioner_id,?) = ? AND nvl(a.diagnosis_code,'XXX') = nvl(?,'XXX') AND catalog_synonym_type = OR_GET_SYNONYM_TYPE(?,a.order_catalog_code) AND c.patient_class = OR_PATIENT_ORDER_APPLICABLE( ?,a.order_catalog_code,?) AND b.language_id = ?  ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_SELECT1","SELECT  a.order_catalog_code CODE,b.catalog_synonym DESCRIPTION,a.order_category order_category FROM or_order_set_trans_vw a ,or_catalog_synonym_lang_vw b,or_order_catalog_by_ptcl c, or_order_catalog d WHERE a.order_catalog_code = b.order_catalog_code AND a.Order_catalog_code=d.order_catalog_code and a.order_catalog_code = c.order_catalog_code AND a.order_category ='PH'  and d.iv_prep_yn ='C' AND nvl(a.diagnosis_code,'XXX') = nvl(NULL,'XXX') ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_DRUG_SELECT","SELECT a.order_catalog_code order_catalog_code,a.order_type_code order_type_code, a.reqd_or_opt_ind reqd_or_opt_ind,freq_code, a.qty_unit qty_unit,a.durn_value durn_value,a.durn_type durn_type, rel_start_date_time start_time,b.short_desc short_desc, a.ocurrance_num,order_set_seq_num dosage_type_seq_no  FROM or_order_set_component a ,or_order_catalog_lang_vw b WHERE a.order_catalog_code = b.order_catalog_code  AND a.order_set_code = ? and b.order_category = 'PH' AND b.language_id = ? and a.ROUTE_CODE is not null ORDER BY order_set_seq_num,a.ocurrance_num"); //order_set_seq_num dosage_type_seq_no added for ML-MMOH-CRF-1227.1
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_ITEM_LINK_SELECT","SELECT   a.order_catalog_code order_catalog_code, b.item_code  FROM or_order_set_component a, PH_DRUG b WHERE a.order_catalog_code = b.drug_code AND a.order_set_code = ?");
		//dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_DOSE", "call PH_CALC_DEF_DOSAGE (?,?,?,?,?,?,?,?,?) ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_DRUG_ROUTE_SELECT","select a.route_code, b.route_desc from or_order_set_component a, ph_route_lang_vw b where a.order_set_code=? and order_catalog_code=? and a.route_code=b.route_code and a.ocurrance_num = ? and b.language_id=?");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_DRUG_SELECT1","select DRUG_CODE, ITEM_CODE, DRUG_DESC, FORM_CODE, ROUTE_CODE, PRES_BASE_UOM from ph_drug_lang_vw ph_drug where drug_code=( select DFLT_FLUID_CODE from ph_drug where drug_code=?) AND language_id = ? ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_DRUG_SELECT2","SELECT REPEAT_DURN_TYPE FROM AM_FREQUENCY WHERE FREQ_CODE=? ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_DRUG_SELECT3","SELECT SHORT_DESC,ORDER_TYPE_CODE FROM OR_ORDER_CATALOG_LANG_VW OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE =? AND LANGUAGE_ID = ? ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_DRUG_SELECT","SELECT a.order_catalog_code order_catalog_code,a.order_type_code order_type_code, a.freq_code, a.qty_unit qty_unit,a.durn_value durn_value, a.durn_type durn_type, b.short_desc short_desc, a.ocurrance_num  FROM or_order_line a ,or_order_catalog_lang_vw b, or_order_set_component c WHERE a.order_catalog_code = b.order_catalog_code  AND a.ORDER_SET_ID = ? and b.order_category = 'PH' AND b.language_id = ? and c.ORDER_SET_CODE = (select order_catalog_code from or_order_line where order_id = ?) and a.OCURRANCE_NUM = c.OCURRANCE_NUM and a.ORDER_CATALOG_CODE = c.ORDER_CATALOG_CODE and a.ROUTE_CODE is not null ORDER BY a.order_id, a.order_line_num");
		
// RUT-CRF-0062 [IN029600]  --- NEWLY REMOVED FORM_CODE to get Build MAR Rule in Ph Order / Oncology Tab -- Begin
		//dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT1","SELECT B.ORDER_ID ORDER_ID ,B.ORDER_LINE_NUM  ORDER_LINE_NUM, B.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,B.CATALOG_DESC  CATALOG_DESC, TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY HH24:MI')START_DATE_TIME,TO_CHAR(B.END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE_TIME , B.QTY_VALUE  QTY_VALUE, B.QTY_UNIT QTY_UNIT,B.FREQ_CODE FREQ_CODE, B.DURN_VALUE DURN_VALUE, B.DURN_TYPE DURN_TYPE, B.ORDER_SET_ID ORDER_SET_ID,A.IV_PREP_YN  IV_PREP_YN, B.OCURRANCE_NUM FROM OR_ORDER_LINE B, OR_ORDER A WHERE A.ORDER_ID=B.ORDER_ID AND A.ORDER_SET_ID=B.ORDER_SET_ID AND B.ORDER_SET_ID=? ORDER BY ORDER_ID,ORDER_LINE_NUM ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT1","SELECT B.ORDER_ID ORDER_ID ,B.ORDER_LINE_NUM  ORDER_LINE_NUM, B.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,B.CATALOG_DESC  CATALOG_DESC, TO_CHAR(B.START_DATE_TIME,'DD/MM/YYYY HH24:MI')START_DATE_TIME,TO_CHAR(B.END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE_TIME , B.QTY_VALUE  QTY_VALUE, B.QTY_UNIT QTY_UNIT,B.FREQ_CODE FREQ_CODE, B.DURN_VALUE DURN_VALUE, B.DURN_TYPE DURN_TYPE, B.ORDER_SET_ID ORDER_SET_ID,A.IV_PREP_YN  IV_PREP_YN, B.OCURRANCE_NUM,B.FORM_CODE,A.DISCHARGE_IND FROM OR_ORDER_LINE B, OR_ORDER A WHERE A.ORDER_ID=B.ORDER_ID AND A.ORDER_SET_ID=B.ORDER_SET_ID AND B.ORDER_SET_ID=? ORDER BY ORDER_ID,ORDER_LINE_NUM ");
// RUT-CRF-0062 [IN029600]  ---  End
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_ORDER_HEADER_SELECT","select distinct DECODE(O.PRIORITY,  'R',  'routine',  'U',  'urgent') PRIORITY, TO_CHAR(O.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') ORD_DATE_TIME, PR.PRACTITIONER_NAME, PDP.HEIGHT, PDP.HEIGHT_UOM, PDP.WEIGHT, PDP.WEIGHT_UOM, PDP.BSA, PDP.DIAG_TEXT, O.DISCHARGE_IND TAKE_HOME  from or_order O, AM_PRACTITIONER_LANG_VW PR, PH_PATIENT_DRUG_PROFILE PDP where o.ORDER_SET_ID=? and o.order_id = pdp.ORIG_ORDER_ID  AND   O.ORD_PRACT_ID=PR.PRACTITIONER_ID ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT2","SELECT  INFUSE_OVER ,INFUSION_RATE , INFUSION_PER_UNIT ,CHNGD_FLUID_REMARKS,INTENTION_CODE, STAGE_CODE ,INFUSION_VOL_STR_UNIT , ALLERGY_OVERRIDE_REASON, DOSAGE_LIMIT_OVERRIDE_REASON, DUPLICATE_DRUG_OVERRIDE_REASON,INTERACTION_OVERRIDE_REASON FROM OR_ORDER_LINE_PH  WHERE ORDER_ID=? AND ORDER_LINE_NUM=? ");
        dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT3"," SELECT ORDER_CATALOG_CODE FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM='1'");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT4","SELECT QTY_VALUE FROM OR_ORDER_CATALOG_BY_PTCL WHERE ORDER_CATALOG_CODE=?");        
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT5","SELECT IV_FLUID_YN,IV_INGREDIENT_YN  FROM PH_DRUG WHERE DRUG_CODE=?");
        dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT6","SELECT ORDER_SET_ID FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM='1' ");
		dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_SELECT7","SELECT A.ORDER_LINE_FIELD_MNEMONIC, A.ORDER_LINE_FIELD_VALUE,B.REMARK_DESC FROM OR_ORDER_LINE_FIELD_VALUES A,PH_PRES_REMARK_LANG_VW B WHERE A.ORDER_LINE_FIELD_VALUE = B.REMARK_CODE(+) AND A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND A.ORDER_LINE_SEQ_NUM >=1 AND A.ORDER_LINE_SEQ_NUM <=100 AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ONCOLOGY_ORD_CMT_DELETE","DELETE FROM OR_ORDER_COMMENT WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_ONCOLOGY_UNIT","SELECT PH_DRUG_UNIT_CAL(?,?,?,?) from dual");
		dataMap.put("JNDI_PH_ONCOLOGY_REGIMEN", "java:comp/env/OncologyRegimen");

		// End of Cyto-Toxic Medication Orders

		//Start of  External Product link
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT1", "SELECT   compound_drug_yn,   c.route_code,   b.form_code,   c.route_Desc, b.form_desc,   a.drug_Desc,  a. drug_code,   ph_get_ext_prod_drug_code(a.drug_code,?) EXTERNAL_PRODUCT_ID,    DECODE(ph_get_ext_prod_drug_code(a.drug_code,?),   NULL,   'N',   'Y') fromdb,   c.ext_route_code, c.ext_route_desc,e.drug_Desc ext_drug_desc FROM    PH_DRUG a,   ph_form b,   ph_route c,   ph_generic_name d, ph_external_product_temp e   WHERE    a.form_code=b.form_code    AND   a.route_code=c.route_code AND c.ext_route_code  IS NOT NULL AND   a.generic_id=d.generic_id     AND   UPPER(generic_name)=UPPER(?)  AND e.drug_code(+)= ph_get_ext_prod_drug_code(a.drug_code,?) ORDER BY  compound_drug_yn,c.route_code,b.form_code,a.drug_desc");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT2", "Select 1 from ph_param where drug_db_interface_yn='Y' and module_id='PH'");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT3", "SELECT A.GENERIC_ID code,A.GENERIC_NAME description FROM PH_GENERIC_NAME A WHERE upper(A.GENERIC_ID) like upper(?) AND upper(A.GENERIC_NAME) like upper(?) AND A.EFF_STATUS='E' ORDER BY 2");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT4", "SELECT drug_code code,drug_desc description FROM ph_External_product_temp WHERE upper(generic_id) like upper(?) AND upper(route_code) like upper(?) AND  upper(drug_code) LIKE upper(?) AND upper(drug_desc) LIKE upper(?) ORDER BY 1	");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT5", "SELECT 1  FROM  ph_external_product_temp WHERE upper(generic_id) =upper(?)");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT6", "INSERT INTO ph_external_product_temp (generic_id,route_code,drug_code,drug_desc) VALUES (?,?,?,?)");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT7", "SELECT 1 FROM PH_EXTERNAL_PRODUCT_TEMP WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT8", "SELECT GENERIC_ID FROM PH_EXTERNAL_PRODUCT_TEMP WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT9", "Select drug_desc from  ph_drug  WHERE external_product_id=? ");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT10","SELECT   c.drug_Desc, ph_get_ext_prod_drug_code(c.drug_code,?)EXTERNAL_PRODUCT_ID FROM    PH_PATIENT_DRUG_PROFILE A ,   PH_DRUG C WHERE    A.PATIENT_ID =? AND   A.DRUG_CODE = C.DRUG_CODE AND (TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  A.START_DATE AND  A.END_DATE OR TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  A.START_DATE AND  A.END_DATE OR  A.START_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI') OR  A.END_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI'))  AND   A.DISCONT_DATE_TIME IS NULL AND   A.ON_HOLD_DATE_TIME IS NULL AND   A.CANCEL_YN='N' AND   A.STOP_YN='N'  and  ph_get_ext_prod_drug_code(c.drug_code,?) is not null union SELECT b.drug_desc, ph_get_ext_prod_drug_code(b.drug_code,?) external_product_id  FROM OR_ORDER_LINE A, PH_DRUG B, OR_ORDER_LINE_PH G, OR_ORDER H,PH_DISP_DTL_TMP I   WHERE A.ORDER_ID = H.ORDER_ID AND A.ORDER_ID= G.ORDER_ID AND   A.ORDER_LINE_NUM=G.ORDER_LINE_NUM  AND    A.ORDER_CATALOG_CODE=B.DRUG_CODE   AND   A.ORDER_LINE_NUM=I.ORDER_LINE_NO(+) AND   A.ORDER_ID=I.ORDER_ID(+) AND   Ph_Check_Ord_Date_Dispensing(A.START_DATE_TIME,A.END_DATE_TIME,?,?,?,?,?)=1   AND  A.ORDER_TYPE_CODE IN (SELECT ORDER_TYPE_CODE FROM PH_ORDER_TYPE_FOR_DRUG_CLASS  WHERE   DRUG_CLASS = 'G'  OR DRUG_CLASS = 'N'  OR DRUG_CLASS = 'C'  )   AND A.ORDER_LINE_STATUS IN (SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE  WHERE  ORDER_STATUS_TYPE IN ('10','30','56','36')) AND A.ORDER_ID=NVL(?,A.ORDER_ID) and ph_get_ext_prod_drug_code(b.drug_code,?) is not null");//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT11","SELECT   distinct c.drug_Desc,ph_get_ext_prod_drug_code(c.drug_code,?)EXTERNAL_PRODUCT_ID FROM PH_PATIENT_DRUG_PROFILE A , PH_DRUG C WHERE  A.PATIENT_ID =? AND A.DRUG_CODE = C.DRUG_CODE AND (TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  A.START_DATE AND  A.END_DATE OR TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  A.START_DATE AND  A.END_DATE OR  A.START_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI') OR  A.END_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI'))   AND   A.DISCONT_DATE_TIME IS NULL AND   A.ON_HOLD_DATE_TIME IS NULL AND   A.CANCEL_YN='N' AND   A.STOP_YN='N'  and ph_get_ext_prod_drug_code(c.drug_code,?) is not null");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT12", "SELECT DRUG_CODE,DRUG_DESC,ROUTE_CODE FROM PH_EXTERNAL_PRODUCT_TEMP WHERE DRUG_DESC LIKE UPPER(?) ORDER BY DRUG_DESC");
		dataMap.put("SQL_PH_EXT_PROD_LINK_QUERY", "SELECT a.drug_code,a.drug_Desc,generic_name,c.drug_desc exdesc FROM ph_drug a,ph_generic_name b,ph_external_product_temp c WHERE a.generic_id=b.generic_id  AND  a.external_product_id=c.drug_code AND a.drug_code like nvl(?,'%') AND a.drug_desc like nvl(?,'%') AND b.generic_name like nvl(?,'%')");
		dataMap.put("SQL_PH_EXT_PROD_LINK_UPDATE1", "UPDATE ph_drug SET external_product_id=?, modified_date=SYSDATE,modified_by_id=?, modified_at_ws_no=?,modified_facility_id=? WHERE drug_code=? ");
		//current rx query for drug-drug interactions and //order line query for verification stage
		dataMap.put("JNDI_PH_EXT_PROD_LINK", "java:comp/env/ExternalProductLink");
		//End of External Product link
// TPN Stock Item  Added by Janet on 10/8/2005
		dataMap.put("SQL_PH_DRUG_SELECT99", "SELECT A.ITEM_CODE CODE, B.SHORT_DESC DESCRIPTION FROM ST_ITEM A, MM_ITEM_LANG_VW B WHERE  A.DRUG_ITEM_YN='Y' AND A.ITEM_CODE=B.ITEM_CODE AND B.EFF_STATUS='E' AND A.ITEM_CODE LIKE UPPER(?) AND upper(B.SHORT_DESC) LIKE upper(?) AND b.language_id = ");
		dataMap.put("SQL_PH_ITEM_UPDATE_QUERY", "UPDATE	st_item	SET	modified_by_id = ? , modified_date = SYSDATE , modified_at_ws_no = ?, modified_facility_id =? ,tpn_item_yn=?  WHERE	item_code = ?");
		dataMap.put("SQL_PH_ITEM_LOAD_QUERY", "SELECT	item_code,tpn_item_yn FROM	st_item	WHERE item_code= ?");
		dataMap.put("SQL_PH_ITEM_UOM_VALUE", "SELECT	A.ITEM_CODE,B.SHORT_DESC,B.GEN_UOM_CODE,A.TPN_ITEM_YN FROM	ST_ITEM	A,MM_ITEM_LANG_VW B WHERE  A.ITEM_CODE  = B.ITEM_CODE AND A.ITEM_CODE=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ITEM_UOM_VALUE1","SELECT A.ITEM_CODE,B.SHORT_DESC,B.GEN_UOM_CODE,A.TPN_ITEM_YN FROM ST_ITEM A,MM_ITEM_LANG_VW B WHERE  A.ITEM_CODE  = B.ITEM_CODE AND upper(A.ITEM_CODE)like upper(?) and upper(B.SHORT_DESC)like upper(?) and upper(A.TPN_ITEM_YN)like upper(?) AND b.language_id = ?");
// TPN Stock Item  Ends here  by Janet on 10/8/2005
		//Start of TPN Cons Group
		dataMap.put("SQL_PH_TPN_CONS_GROUP_QUERY","SELECT CONST_GROUP_CODE,CONST_GROUP_NAME,DISP_SRL_NO FROM PH_TPN_CONST_GRP_LANG_VW PH_TPN_CONSTITUENT_GROUP WHERE EFF_STATUS='E' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_GROUP_SELECT1","SELECT CONST_GROUP_NAME,DISP_SRL_NO FROM PH_TPN_CONST_GRP_LANG_VW PH_TPN_CONSTITUENT_GROUP WHERE EFF_STATUS='E' AND CONST_GROUP_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_GROUP_UPDATE","UPDATE PH_TPN_CONSTITUENT_GROUP SET  CONST_GROUP_NAME=?,  MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE CONST_GROUP_CODE=?");
		dataMap.put("JNDI_PH_TPNCONSGROUP", "java:comp/env/TPNConsGroup");
		//End of TPN Cons Group
		//Start of TPN Cons Generic
		dataMap.put("SQL_PH_TPN_CONS_GENERIC_QUERY","SELECT a.CONST_GENERIC_CODE, a.CONST_GENERIC_NAME, a.DISP_SRL_NO, a.CONST_GROUP_CODE, b.CONST_GROUP_NAME, a.UOM_SETUP_LEVEL_IND FROM ph_tpn_const_gen_name_lang_vw a, ph_tpn_const_grp_lang_vw b WHERE a.EFF_STATUS='E' AND b.CONST_GROUP_CODE = a.CONST_GROUP_CODE AND a.language_id = b.language_id AND a.language_id = ? ORDER BY DISP_SRL_NO");
		dataMap.put("SQL_PH_TPN_CONS_GENERIC_SELECT1"," SELECT a.CONST_GENERIC_CODE, a.CONST_GENERIC_NAME, a.DISP_SRL_NO, a.CONST_GROUP_CODE, b.CONST_GROUP_NAME, a.UOM_SETUP_LEVEL_IND,a.ITEM_FLUID_APPL_YN FROM PH_TPN_CONST_GEN_NAME_LANG_VW a, PH_TPN_CONST_GRP_LANG_VW b WHERE a.EFF_STATUS='E' AND b.CONST_GROUP_CODE = a.CONST_GROUP_CODE AND a.CONST_GENERIC_CODE=? AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ?");
		//dataMap.put("SQL_PH_TPN_CONS_GENERIC_SELECT1"," SELECT a.CONST_GENERIC_CODE, a.CONST_GENERIC_NAME, a.DISP_SRL_NO, a.CONST_GROUP_CODE, b.CONST_GROUP_NAME, a.UOM_SETUP_LEVEL_IND FROM PH_TPN_CONST_GEN_NAME_LANG_VW a, PH_TPN_CONST_GRP_LANG_VW b WHERE a.EFF_STATUS='E' AND b.CONST_GROUP_CODE = a.CONST_GROUP_CODE AND a.CONST_GENERIC_CODE=? AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_GENERIC_UPDATE","UPDATE PH_TPN_CONST_GENERIC_NAME SET  CONST_GENERIC_NAME=?,  MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,ITEM_FLUID_APPL_YN=? WHERE CONST_GENERIC_CODE=?");

       //dataMap.put("SQL_PH_TPN_CONS_GENERIC_UPDATE","UPDATE PH_TPN_CONST_GENERIC_NAME SET  CONST_GENERIC_NAME=?,  MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE CONST_GENERIC_CODE=?");

		dataMap.put("JNDI_PH_TPNCONSGENERIC", "java:comp/env/TPNConsGeneric");
		//End of TPN Cons GENERIC
		//Start of TPN ENERGY CONS
		dataMap.put("SQL_PH_TPN_CONS_ENERGY_QUERY","SELECT   CONSTITUENT_CODE, CONSTITUENT_NAME, QTY_VALUE,   QTY_UNIT, ENERGY_REL_VALUE, ENERGY_UNIT FROM  PH_TPN_ENGY_FOR_CONST_LANG_VW PH_TPN_ENERGY_FOR_CONST WHERE LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_ENERGY_SELECT1"," SELECT   CONSTITUENT_CODE, CONSTITUENT_NAME, QTY_VALUE,   QTY_UNIT, ENERGY_REL_VALUE, ENERGY_UNIT FROM  PH_TPN_ENGY_FOR_CONST_LANG_VW PH_TPN_ENERGY_FOR_CONST WHERE CONSTITUENT_CODE=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_ENERGY_UPDATE","UPDATE PH_TPN_ENERGY_FOR_CONST SET  CONSTITUENT_NAME=?, ENERGY_REL_VALUE =?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE CONSTITUENT_CODE=?");
		dataMap.put("JNDI_PH_TPNCONSENERGY", "java:comp/env/TPNConsEnergy");
		//End of TPN Cons GENERIC
		//Start of TPN Constituent Limit
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_SELECT1","SELECT AGE_GROUP_CODE,SHORT_DESC, DECODE(GENDER,'M','male','F','female','Both') GENDER,MIN_AGE, MAX_AGE, AGE_UNIT FROM AM_AGE_GROUP_LANG_VW AM_AGE_GROUP WHERE EFF_STATUS='E' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_SELECT2","SELECT  DISTINCT C.CONST_GENERIC_CODE,B.CONST_GROUP_NAME,  B.DISP_SRL_NO,  C.CONST_GENERIC_NAME,  (SELECT SHORT_DESC FROM AM_UOM WHERE UOM_CODE = A.ORDERING_UNIT and EFF_STATUS='E')CONST_QTY_UNIT,  (SELECT CONST_MIN_VAL FROM   PH_TPN_CONSTITUENT_LIMIT WHERE   C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE = ?) CONST_MIN_VAL,   (SELECT CONST_MAX_VAL FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE = ?) CONST_MAX_VAL,  (SELECT CONST_STD_VAL FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE = ?) CONST_STD_VAL,(SELECT CONST_CEIL_VAL FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE = ?) CONST_CEIL_VAL,(SELECT CONST_USAGE_IND FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE = ?) CONST_USAGE_IND,(SELECT CONST_REMARKS FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE = ?) CONST_REMARKS ,(SELECT ORD_UNIT_IND FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE = ?) PREP_UNIT , ORD_UNIT_IND, ORDERING_UNIT,C.DISP_SRL_NO SRL_NO  FROM       PH_TPN_PARAM_FOR_CONST A,PH_TPN_CONSTITUENT_GROUP B,PH_TPN_CONST_GENERIC_NAME C   WHERE  C.CONST_GROUP_CODE=B.CONST_GROUP_CODE AND    A.CONST_GROUP_CODE=B.CONST_GROUP_CODE AND    GROUP_OR_INDIVIDUAL_IND=C.UOM_SETUP_LEVEL_IND  AND   c.disp_srl_no=DECODE(c.const_group_code,'OT',A.srl_no,A.srl_no) AND ORDERING_UNIT <> 'X'ORDER BY  C.DISP_SRL_NO,B.DISP_SRL_NO,C.CONST_GENERIC_CODE"); 	

       //dataMap.put("SQL_PH_TPN_CONS_LIMIT_SELECT2","SELECT  DISTINCT C.CONST_GENERIC_CODE,B.CONST_GROUP_NAME,  B.DISP_SRL_NO,  C.CONST_GENERIC_NAME,  (SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE = A.REGIMEN_SETUP_UNIT and EFF_STATUS='E' AND LANGUAGE_ID = ? )CONST_QTY_UNIT,  (SELECT CONST_MIN_VAL FROM   PH_TPN_CONSTITUENT_LIMIT WHERE   C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? ) CONST_MIN_VAL,   (SELECT CONST_MAX_VAL FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? ) CONST_MAX_VAL,    (SELECT CONST_STD_VAL FROM PH_TPN_CONSTITUENT_LIMIT   WHERE C.CONST_GENERIC_CODE=CONST_GENERIC_CODE AND   AGE_GROUP_CODE=? ) CONST_STD_VAL,ORD_UNIT_IND, REGIMEN_SETUP_UNIT  FROM       PH_TPN_PARAM_FOR_CONST A,PH_TPN_CONST_GRP_LANG_VW B,PH_TPN_CONST_GEN_NAME_LANG_VW C "); 




		dataMap.put("SQL_PH_TPN_CONS_LIMIT_INSERT","INSERT INTO PH_TPN_CONSTITUENT_LIMIT ( AGE_GROUP_CODE, CONST_GENERIC_CODE, CONST_QTY_UNIT, CONST_MIN_VAL, CONST_MAX_VAL, CONST_STD_VAL, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,TPN_REGIMEN_CODE,CONST_CEIL_VAL,CONST_USAGE_IND,CONST_REMARKS,ORD_UNIT_IND)  VALUES (?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?)"); 

		//dataMap.put("SQL_PH_TPN_CONS_LIMIT_INSERT","INSERT INTO PH_TPN_CONSTITUENT_LIMIT ( AGE_GROUP_CODE, CONST_GENERIC_CODE, CONST_QTY_UNIT, CONST_MIN_VAL, CONST_MAX_VAL, CONST_STD_VAL, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)  VALUES (?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");






		dataMap.put("SQL_PH_TPN_CONS_LIMIT_UPDATE","UPDATE PH_TPN_CONSTITUENT_LIMIT SET CONST_MIN_VAL=?, CONST_MAX_VAL=?,CONST_STD_VAL=?, MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?,INFUSION_LINE=? WHERE AGE_GROUP_CODE=? AND CONST_GENERIC_CODE=?");
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_DELETE","DELETE FROM PH_TPN_CONSTITUENT_LIMIT  WHERE AGE_GROUP_CODE=? AND TPN_REGIMEN_CODE=? "); 

		//dataMap.put("SQL_PH_TPN_CONS_LIMIT_DELETE","DELETE FROM PH_TPN_CONSTITUENT_LIMIT  WHERE AGE_GROUP_CODE=? "); 




		dataMap.put("SQL_PH_TPN_CONS_LIMIT_QUERY","SELECT A.AGE_GROUP_CODE, B.CONST_GROUP_CODE, C.SHORT_DESC,       B.CONST_GENERIC_NAME, A.CONST_QTY_UNIT, A.CONST_MIN_VAL, A.CONST_MAX_VAL, A.CONST_STD_VAL   FROM PH_TPN_CONSTITUENT_LIMIT A,       AM_AGE_GROUP_LANG_VW C, PH_TPN_CONST_GEN_NAME_LANG_VW B WHERE A.CONST_GENERIC_CODE = B.CONST_GENERIC_CODE AND C.AGE_GROUP_CODE = A.AGE_GROUP_CODE AND B.CONST_GROUP_CODE = NVL (?, B.CONST_GROUP_CODE) AND A.AGE_GROUP_CODE = NVL (?, A.AGE_GROUP_CODE) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");        
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_SELECT3","SELECT MIN_AGE, MAX_AGE, AGE_UNIT, GENDER FROM PH_TPN_CONSTITUENT_LIMIT ");
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_SELECT4","SELECT AGE_GROUP_CODE FROM PH_TPN_CONSTITUENT_LIMIT WHERE  MIN_AGE=? AND  MAX_AGE=? AND AGE_UNIT=? AND GENDER=?");
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_ORDERUOMDEFINED"," SELECT  ORDERING_UNIT   FROM    PH_TPN_PARAM_FOR_CONST A");
		dataMap.put("JNDI_PH_TPNCONSLIMITS", "java:comp/env/TPNConsLimits");
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_SELECT1","SELECT DECODE(COUNT(*),0,'N','Y') FROM PH_TPN_CONSTITUENT_LIMIT WHERE AGE_GROUP_CODE = ? AND TPN_REGIMEN_CODE = ? "); 

       //dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_SELECT1","SELECT DECODE(COUNT(*),0,'N','Y') FROM PH_TPN_CONSTITUENT_LIMIT WHERE AGE_GROUP_CODE = ? ");

		dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_SELECT2","SELECT GENDER SEL_GENDER, MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) MIN_AGE_IN_DAYS,MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) MAX_AGE_IN_DAYS FROM AM_AGE_GROUP WHERE AGE_GROUP_CODE = ?");
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_SELECT2A","SELECT GENDER SEL_GENDER, MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) MIN_AGE_IN_DAYS,MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) MAX_AGE_IN_DAYS FROM AM_AGE_GROUP a WHERE AGE_GROUP_CODE = ? AND NOT EXISTS (SELECT TPN_REGIMEN_CODE FROM PH_TPN_CONSTITUENT_LIMIT WHERE TPN_REGIMEN_CODE = ? AND AGE_GROUP_CODE = A.AGE_GROUP_CODE)");
	   	dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_SELECT3","SELECT 'Y' FROM DUAL WHERE EXISTS ( SELECT 1 FROM AM_AGE_GROUP WHERE AGE_GROUP_CODE IN (SELECT DISTINCT AGE_GROUP_CODE FROM PH_TPN_CONSTITUENT_LIMIT WHERE TPN_REGIMEN_CODE=?) AND ( (? IS NULL AND ( ? BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR ?  BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR min_age * DECODE (age_unit,'D', 1,'M', 30,'Y', 360) BETWEEN ? AND ? OR max_age * DECODE (age_unit_max,'D',1,'M',30,'Y',360) BETWEEN ? AND ? )) OR (? IS NOT NULL AND ( GENDER IS NULL OR GENDER = ? ) AND ( ? BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR ?  BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR min_age * DECODE (age_unit,'D', 1,'M', 30,'Y', 360) BETWEEN ? AND ? OR max_age * DECODE (age_unit_max,'D',1,'M',30,'Y',360) BETWEEN ? AND ? ))))"); 
	   //dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_SELECT3","SELECT 'Y' FROM DUAL WHERE EXISTS ( SELECT 1 FROM AM_AGE_GROUP WHERE AGE_GROUP_CODE IN (SELECT DISTINCT AGE_GROUP_CODE FROM PH_TPN_CONSTITUENT_LIMIT) AND ( (? IS NULL AND ( ? BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR ?  BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR min_age * DECODE (age_unit,'D', 1,'M', 30,'Y', 360) BETWEEN ? AND ? OR max_age * DECODE (age_unit_max,'D',1,'M',30,'Y',360) BETWEEN ? AND ? )) OR (? IS NOT NULL AND ( GENDER IS NULL OR GENDER = ? ) AND ( ? BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR ?  BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR min_age * DECODE (age_unit,'D', 1,'M', 30,'Y', 360) BETWEEN ? AND ? OR max_age * DECODE (age_unit_max,'D',1,'M',30,'Y',360) BETWEEN ? AND ? ))))");

		dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_INSERT","INSERT INTO PH_TPN_CONST_LIMIT_HDR ( AGE_GROUP_CODE, GENDER, MIN_AGE, MAX_AGE, AGE_UNIT, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)  VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TPN_CONS_LIMIT_HDR_DELETE","DELETE FROM PH_TPN_CONST_LIMIT_HDR WHERE AGE_GROUP_CODE=?");

		//End of TPN Constituent Limit
		//TPN Parameters queries start from here
		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT1","SELECT UOM_CODE, SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE EFF_STATUS='E' AND QTY_UOM_YN='Y' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");  //Both 1 & 2 are same...but both r being used...
		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT2","SELECT UOM_CODE, SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE IN('GM','ML','MCG','NCG','MG','IU','MIU','UNIT','MEQT','MMOL') AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		//newly added
		dataMap.put("SQL_PH_TPN_PARAMETERS_ENERGY_SELECT1","SELECT UOM_CODE,SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE QTY_UOM_YN = 'Y' AND EFF_STATUS='E'AND UOM_CODE IN (SELECT DISTINCT UPPER(ENERGY_UNIT) FROM PH_TPN_ENERGY_FOR_CONST) AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_TPN_PARAMETERS_ENERGY_SELECT2","SELECT UOM_CODE,SHORT_DESC FROM AM_UOM WHERE QTY_UOM_YN = 'Y' AND EFF_STATUS='E'AND UOM_CODE IN (SELECT DISTINCT UPPER(ENERGY_UNIT) FROM PH_TPN_ENERGY_FOR_CONST) ORDER BY SHORT_DESC");
		
		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT3","SELECT distinct b.DISP_SRL_NO,a.CONST_GROUP_CODE,a.CONST_GROUP_NAME FROM PH_TPN_CONST_GRP_LANG_VW a,PH_TPN_CONST_GENERIC_NAME b WHERE a.EFF_STATUS='E' AND a.CONST_GROUP_CODE=b.CONST_GROUP_CODE  and b.UOM_SETUP_LEVEL_IND='G' AND a.LANGUAGE_ID = ? ORDER BY DISP_SRL_NO"); 

		//dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT3","SELECT distinct b.DISP_SRL_NO,a.CONST_GROUP_CODE,a.CONST_GROUP_NAME FROM PH_TPN_CONST_GRP_LANG_VW a,PH_TPN_CONST_GENERIC_NAME b WHERE a.EFF_STATUS='E' AND a.CONST_GROUP_CODE=b.CONST_GROUP_CODE  and b.UOM_SETUP_LEVEL_IND='G' AND a.LANGUAGE_ID = ? ORDER BY DISP_SRL_NO");




		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT4","SELECT CONST_GENERIC_CODE, CONST_GROUP_CODE,CONST_GENERIC_NAME,DISP_SRL_NO,DFLT_ORD_UNIT_IND,CONST_GROUP_CODE FROM PH_TPN_CONST_GEN_NAME_LANG_VW PH_TPN_CONST_GENERIC_NAME WHERE EFF_STATUS='E' AND CONST_GROUP_CODE=? AND UOM_SETUP_LEVEL_IND='I' AND LANGUAGE_ID = ? ORDER BY DISP_SRL_NO,CONST_GENERIC_CODE");
		//dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT5","SELECT ENERGY_UNIT, REGIMEN_PRESC_BASE_UNIT FROM PH_TPN_PARAM WHERE MODULE_ID='PH'"); 

		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT5","SELECT ENERGY_UNIT, REGIMEN_PRESC_BASE_UNIT FROM PH_TPN_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT6","SELECT SRL_NO,CONST_GROUP_CODE, REGIMEN_SETUP_UNIT, ORDERING_UNIT, PREP_UNIT,ORD_UNIT_IND FROM PH_TPN_PARAM_FOR_CONST ");
		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT7","SELECT COUNT(*) COUNT FROM PH_TPN_PARAM WHERE MODULE_ID='PH' ");
		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT8","SELECT COUNT(*) COUNT FROM PH_TPN_PARAM_FOR_CONST WHERE SRL_NO=? ");
		//New sql
		dataMap.put("SQL_PH_TPN_PARAMETERS_SELECT9","SELECT CONST_GROUP_CODE,DFLT_ORD_UNIT_IND FROM PH_TPN_CONST_GENERIC_NAME where UOM_SETUP_LEVEL_IND='G'");
		dataMap.put("SQL_PH_TPN_PARAM_INSERT","INSERT INTO PH_TPN_PARAM(MODULE_ID, ENERGY_UNIT, REGIMEN_PRESC_BASE_UNIT, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,PEAD_MAX_WEIGHT_VALUE,ADULT_MIN_WEIGHT_VALUE,EXPIRY_FOR_TPN_ADM,ITEM_FLUID_APPL_YN, ORD_REGIMEN_IND) VALUES('PH',?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?)");//com on 8/21/2007

        //dataMap.put("SQL_PH_TPN_PARAM_INSERT","INSERT INTO PH_TPN_PARAM(MODULE_ID, ENERGY_UNIT, REGIMEN_PRESC_BASE_UNIT, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES('PH',?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");


		dataMap.put("SQL_PH_TPN_PARAM_FOR_CONST_INSERT","INSERT INTO PH_TPN_PARAM_FOR_CONST(SRL_NO, GROUP_OR_INDIVIDUAL_IND, CONST_GROUP_CODE, REGIMEN_SETUP_UNIT, ORD_UNIT_IND,ORDERING_UNIT, PREP_UNIT, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TPN_PARAM_UPDATE","UPDATE PH_TPN_PARAM SET ENERGY_UNIT=?, REGIMEN_PRESC_BASE_UNIT=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, PEAD_MAX_WEIGHT_VALUE=?, ADULT_MIN_WEIGHT_VALUE=?, EXPIRY_FOR_TPN_ADM=?, ITEM_FLUID_APPL_YN=?, ORD_REGIMEN_IND=? WHERE MODULE_ID='PH'"); 

		//dataMap.put("SQL_PH_TPN_PARAM_UPDATE","UPDATE PH_TPN_PARAM SET ENERGY_UNIT=?, REGIMEN_PRESC_BASE_UNIT=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE MODULE_ID='PH'");

		dataMap.put("SQL_PH_TPN_PARAM_FOR_CONST_UPDATE","UPDATE PH_TPN_PARAM_FOR_CONST SET GROUP_OR_INDIVIDUAL_IND=?, CONST_GROUP_CODE=?, REGIMEN_SETUP_UNIT=?, ORD_UNIT_IND=?,ORDERING_UNIT=?,  PREP_UNIT=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE SRL_NO=?");
		//added line
		dataMap.put("SQL_PH_TPN_PARAM_FOR_CONST_DELETE","DELETE FROM PH_TPN_PARAM_FOR_CONST");
		dataMap.put("JNDI_PH_TPN_PARAM", "java:comp/env/TPNUOMConst");
		//TPN Parameters queries ends here
		//TPN Constituents(For Preparing Non-standard Regimen) Starts here
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT1","SELECT CONST_GENERIC_CODE, CONST_GENERIC_NAME,CONST_GROUP_CODE FROM PH_TPN_CONST_GEN_NAME_LANG_VW PH_TPN_CONST_GENERIC_NAME WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY CONST_GENERIC_NAME");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT1A","SELECT CONST_GROUP_CODE FROM PH_TPN_CONST_GENERIC_NAME WHERE CONST_GENERIC_CODE=?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT2","SELECT MOLECULE_CODE, DESCRIPTION FROM PH_TPN_ELECT_MOL_FORMULA ORDER BY DESCRIPTION");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT3","SELECT A.ITEM_CODE CODE,B.SHORT_DESC DESCRIPTION FROM ST_ITEM A,MM_ITEM B WHERE A.ITEM_CODE=B.ITEM_CODE AND A.TPN_ITEM_YN ='Y' AND A.ITEM_CODE LIKE upper(?) AND upper(B.SHORT_DESC) LIKE upper(?) ORDER BY 1");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT4","SELECT SALE_UOM_CODE FROM ST_ITEM WHERE ITEM_CODE = ?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT5","SELECT NVL(MAX(CONST_SRL_NO)+1,1) COUNT FROM PH_INV_ITEM_FOR_NS_REGIMEN WHERE CONST_GENERIC_CODE = ?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT6","SELECT NVL(MAX(CONST_SRL_NO)+1,1) COUNT FROM PH_TPN_CONST_FOR_NS_REGIMEN");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT7","SELECT CONST_GENERIC_CODE, ITEM_CODE, CONCENTRATION_PERCENT, CONST_SHORT_NAME, CONST_LONG_NAME, PHYSICAL_FORM,EFF_STATUS FROM  PH_TPN_CNST_FR_NS_RGMN_LANG_VW PH_TPN_CONST_FOR_NS_REGIMEN WHERE   UPPER(CONST_GENERIC_CODE) LIKE UPPER(?) AND UPPER(CONST_SHORT_NAME) LIKE UPPER(?) AND UPPER(CONST_LONG_NAME) LIKE UPPER(?) AND UPPER(PHYSICAL_FORM) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?) AND UPPER(ITEM_CODE) LIKE UPPER(?) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT8","SELECT A.CONST_GENERIC_CODE,B.CONST_GENERIC_NAME, A.CONST_SHORT_NAME, A.CONST_LONG_NAME, A.PHYSICAL_FORM, A.CONCENTRATION_PERCENT, A.MANUFACTURER_VAR_PERCENTAGE, A.EFF_STATUS FROM PH_TPN_CNST_FR_NS_RGMN_LANG_VW A,PH_TPN_CONST_GEN_NAME_LANG_VW B WHERE 	A.CONST_GENERIC_CODE = B.CONST_GENERIC_CODE AND  	A.CONST_GENERIC_CODE=? AND NVL(A.CONCENTRATION_PERCENT,100)=NVL(?,100) AND A.LANGUAGE_ID = B.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT9","SELECT CONTENT_IN_PRES_BASE_UOM,A.CONST_GENERIC_CODE, A.ITEM_CODE,B.SHORT_DESC ITEM_DESC, D.MOLECULE_CODE,D.OSMOLAR_VALUE,C.DESCRIPTION MOLECULE_DESC, D.STOCK_UOM STOCK_UOM FROM PH_TPN_CNST_FR_NS_RGMN_LANG_VW A,MM_ITEM_LANG_VW B,PH_TPN_ELECT_MOL_FORMULA C, PH_INV_ITEM_FOR_NS_REGIMEN D WHERE A.ITEM_CODE = B.ITEM_CODE AND A.CONST_GENERIC_CODE = D.CONST_GENERIC_CODE AND A.ITEM_CODE=D.ITEM_CODE AND D.MOLECULE_CODE = C.MOLECULE_CODE(+) AND A.CONST_GENERIC_CODE=? AND NVL(CONCENTRATION_PERCENT,100) = NVL(?,100) AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ?"); 
	     //dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT9","SELECT A.CONST_GENERIC_CODE, A.ITEM_CODE,B.SHORT_DESC ITEM_DESC, D.MOLECULE_CODE,C.DESCRIPTION MOLECULE_DESC, D.STOCK_UOM STOCK_UOM FROM PH_TPN_CNST_FR_NS_RGMN_LANG_VW A,MM_ITEM_LANG_VW B,PH_TPN_ELECT_MOL_FORMULA C, PH_INV_ITEM_FOR_NS_REGIMEN D WHERE A.ITEM_CODE = B.ITEM_CODE AND A.CONST_GENERIC_CODE = D.CONST_GENERIC_CODE AND A.ITEM_CODE=D.ITEM_CODE AND D.MOLECULE_CODE = C.MOLECULE_CODE(+) AND A.CONST_GENERIC_CODE=? AND NVL(CONCENTRATION_PERCENT,100) = NVL(?,100) AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ?");

		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT10","SELECT EQVL_VALUE FROM AM_UOM_EQVL WHERE (UOM_CODE=? AND EQVL_UOM_CODE=?) OR (UOM_CODE=? AND EQVL_UOM_CODE=?)");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT11","SELECT NVL((SELECT ORDERING_UNIT FROM PH_TPN_PARAM_FOR_CONST A,PH_TPN_CONST_GENERIC_NAME B WHERE A.CONST_GROUP_CODE=B.CONST_GROUP_CODE AND B.CONST_GENERIC_CODE=? AND GROUP_OR_INDIVIDUAL_IND='I' AND ROWNUM<2), (SELECT ORDERING_UNIT  FROM PH_TPN_PARAM_FOR_CONST A,PH_TPN_CONST_GENERIC_NAME B WHERE A.CONST_GROUP_CODE=B.CONST_GROUP_CODE AND B.CONST_GENERIC_CODE=? AND GROUP_OR_INDIVIDUAL_IND='G' AND ROWNUM<2) ) SALE_UOM_CODE FROM DUAL");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_SELECT12","SELECT COUNT(*) COUNT FROM PH_TPN_CONST_FOR_NS_REGIMEN WHERE CONST_GENERIC_CODE=? AND ITEM_CODE=?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_INSERT1","INSERT INTO PH_INV_ITEM_FOR_NS_REGIMEN(CONST_SRL_NO,CONST_GENERIC_CODE, ITEM_CODE, STOCK_UOM, MOLECULE_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,CONTENT_IN_PRES_BASE_UOM,OSMOLAR_VALUE) VALUES(?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		//dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_INSERT1","INSERT INTO PH_INV_ITEM_FOR_NS_REGIMEN(CONST_SRL_NO,CONST_GENERIC_CODE, ITEM_CODE, STOCK_UOM, MOLECULE_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,CONTENT_IN_PRES_BASE_UOM) VALUES(?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");


		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_INSERT2","INSERT INTO PH_TPN_CONST_FOR_NS_REGIMEN(CONST_GENERIC_CODE,ITEM_CODE, CONST_SHORT_NAME, CONST_LONG_NAME, PHYSICAL_FORM, CONCENTRATION_PERCENT, MANUFACTURER_VAR_PERCENTAGE, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_DELETE","DELETE FROM PH_INV_ITEM_FOR_NS_REGIMEN WHERE CONST_GENERIC_CODE=? AND ITEM_CODE=?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_DELETE1","DELETE FROM PH_TPN_CONST_FOR_NS_REGIMEN WHERE CONST_GENERIC_CODE=? AND ITEM_CODE=?");
		dataMap.put("SQL_PH_TPN_CONS_NS_REGIMEN_UPDATE","UPDATE PH_TPN_CONST_FOR_NS_REGIMEN SET CONST_SHORT_NAME=?, CONST_LONG_NAME=?, PHYSICAL_FORM=?, CONCENTRATION_PERCENT=?, MANUFACTURER_VAR_PERCENTAGE=?, EFF_STATUS=?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE CONST_GENERIC_CODE=? AND ITEM_CODE =? ");
		 dataMap.put("JNDI_PH_TPN_CONS_NS_REGIMEN","java:comp/env/TPNConsNSRegimen");
		// End here

		//TPN Standard Regimen Queries start here

		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT1","SELECT FREQ_CODE, FREQ_DESC,SCHEDULED_YN,FREQ_NATURE  FROM am_frequency_lang_vw am_frequency WHERE freq_nature IN ('F','I','O')  AND eff_status='E' AND language_id =? ORDER BY UPPER(freq_desc)");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT2","SELECT    a.TPN_REGIMEN_CODE,   a.LONG_NAME,   a.TOTAL_VOLUME,   a.PRES_BASE_UNIT, (SELECT CONST_WEIGHT  FROM    PH_CONST_FOR_TPN_REGIMEN WHERE     const_generic_code='CHO' AND   TPN_REGIMEN_CODE=a.tpn_regimen_code)    cho, (SELECT CONST_WEIGHT   FROM PH_CONST_FOR_TPN_REGIMEN        WHERE const_generic_code='PROTEIN' AND   TPN_REGIMEN_CODE=a.tpn_regimen_code)    protein,      (SELECT CONST_WEIGHT   FROM PH_CONST_FOR_TPN_REGIMEN    WHERE const_generic_code='LIPID' AND   TPN_REGIMEN_CODE=a.tpn_regimen_code)    lipid     FROM    PH_TPN_REGIMEN_LANG_VW a WHERE    standARD_regimen_yn='Y' AND   system_created_yn='N' AND   UPPER(A.LONG_NAME) LIKE UPPER(?) AND   A.TPN_REGIMEN_CODE IN (   SELECT TPN_REGIMEN_CODE FROM PH_CONST_FOR_TPN_REGIMEN   WHERE CONST_GENERIC_CODE='CHO' AND   CONST_WEIGHT    BETWEEN NVL(?,0) AND   NVL(?,100000) ) AND   A.TPN_REGIMEN_CODE IN (   SELECT TPN_REGIMEN_CODE FROM PH_CONST_FOR_TPN_REGIMEN   WHERE CONST_GENERIC_CODE='PROTEIN' AND  CONST_WEIGHT    BETWEEN NVL(?,0) AND   NVL(?,100000) ) AND   A.TPN_REGIMEN_CODE IN (   SELECT TPN_REGIMEN_CODE FROM PH_CONST_FOR_TPN_REGIMEN   WHERE CONST_GENERIC_CODE='LIPID'  AND CONST_WEIGHT   BETWEEN NVL(?,0) AND   NVL(?,100000) AND EMULSION_TYPE LIKE  DECODE(?,'A','%',?)) AND a.language_id = ?");	
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT3","SELECT   c.const_generic_code, c.const_generic_name, c.dflt_during_order_yn,(SELECT ord_unit_ind FROM ph_tpn_param_for_const WHERE group_or_individual_ind = c.uom_setup_level_ind AND const_group_code = c.const_group_code AND ROWNUM < 2 )w_or_a,(SELECT uom_code || '!' || short_desc FROM am_uom_lang_vw am_uom WHERE language_id = ? AND uom_code = (SELECT a.ORDERING_UNIT FROM ph_tpn_param_for_const a WHERE a.group_or_individual_ind = c.uom_setup_level_ind and a.srl_no=c.disp_srl_no AND a.const_group_code = ? AND ROWNUM < 2) )const_qty_unit,(SELECT const_min_val FROM ph_tpn_constituent_limit WHERE age_group_code = ? AND const_generic_code = c.const_generic_code) const_min_val,(SELECT const_max_val FROM ph_tpn_constituent_limit WHERE age_group_code = ? AND const_generic_code = c.const_generic_code) const_max_val,(SELECT const_std_val FROM ph_tpn_constituent_limit WHERE age_group_code = ? AND const_generic_code = c.const_generic_code) const_std_val FROM ph_tpn_const_gen_name_lang_vw c WHERE c.const_group_code = ? AND c.language_id = ? ORDER BY c.disp_srl_no, c.const_generic_name");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT4","SELECT    B.CONST_GROUP_NAME,B.CONST_GROUP_CODE   FROM     PH_TPN_CONST_GRP_LANG_VW B WHERE   B.CONST_GROUP_CODE <> 'FL' AND B.LANGUAGE_ID = ? ");
		//age group query
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT5","SELECT AGE_GROUP_CODE FROM AM_AGE_GROUP WHERE ( SELECT   CASE  WHEN INSTR(GET_AGE(DATE_OF_BIRTH),'Y')>0    THEN    Ph_Pkg_Common.Ph_Getsubstrbtwndelim(GET_AGE(DATE_OF_BIRTH),'Y',1)   WHEN INSTR(GET_AGE(DATE_OF_BIRTH),'M')>0 THEN    Ph_Pkg_Common.Ph_Getsubstrbtwndelim   (GET_AGE(DATE_OF_BIRTH),'M',1) WHEN INSTR(GET_AGE(DATE_OF_BIRTH),'D')>0 THEN    Ph_Pkg_Common.Ph_Getsubstrbtwndelim   (GET_AGE(DATE_OF_BIRTH),'D',1) END  AGE FROM MP_PATIENT WHERE PATIENT_ID =? )    BETWEEN MIN_AGE AND MAX_AGE  AND (GENDER<>DECODE((SELECT sex  FROM mp_patient WHERE     patient_id=?),'M','F','F','M','U','*') OR gender IS NULL)   AND age_group_code IN  (SELECT age_group_code FROM PH_TPN_CONSTITUENT_LIMIT) AND ROWNUM<2 ");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT6","SELECT CONST_GENERIC_CODE, CONST_GENERIC_NAME FROM PH_TPN_CONST_GENERIC_NAME WHERE const_group_code=? ");
		//retrieves the regimen details
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT7","SELECT DFLT_TPN_ROUTE, TOTAL_VOLUME, PRES_BASE_UNIT, INFUSE_OVER_VALUE, INFUSE_OVERDURN_TYPE FROM  PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT8","SELECT  ORD_AUTH_REQD_YN, ORD_COSIGN_REQD_YN,  ORD_SPL_APPR_REQD_YN,   FREQ_CODE,  DURN_VALUE,  CHK_FOR_MAX_DURN_ACTION,   PROMPT_MSG,   MAX_DURN_VALUE,   CONSENT_REQD_YN ,TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+NVL(durn_value,0),'DD/MM/YYYY HH24:MI') ENDDATE FROM    OR_ORDER_CATALOG_BY_PTCL A,OR_ORDER_CATALOG B WHERE   A.ORDER_CATALOG_CODE=B.ORDER_CATALOG_CODE AND A.ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT9","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+?,'DD/MM/YYYY HH24:MI') ENDDATE FROM DUAL");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT10","SELECT REPEAT_VALUE, REPEAT_DURN_TYPE, INTERVAL_VALUE, INTERVAL_DURN_TYPE FROM AM_FREQUENCY WHERE FREQ_CODE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT11","SELECT ORDER_TYPE_CODE FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT12","SELECT A.TRADE_ID FROM ST_ITEM_BATCH A,PH_TPN_REGIMEN B WHERE A.ITEM_CODE=B.ITEM_CODE AND  B.TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT13","SELECT ORDER_STATUS_CODE FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_TYPE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT14","SELECT VERF_REQD_BEF_MED_ADMIN_YN,MED_ADMIN_REQD_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT15","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+?,'DD/MM/YYYY')||' '||? SCHDATE FROM DUAL");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT16","SELECT OR_GET_FORMAT_ID(?,?,?) FORMAT_ID FROM DUAL");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT17","SELECT const_group_name,CONST_GENERIC_NAME, CONST_CONCENTRATION_PERC, CONST_VOLUME,  CONST_VOLUME_UNIT, CONST_WEIGHT, CONST_WEIGHT_UNIT  FROM PH_CONST_FOR_TPN_REGIMEN A,PH_TPN_CONST_GEN_NAME_LANG_VW B,PH_TPN_CONST_GRP_LANG_VW c   WHERE TPN_REGIMEN_CODE=? AND A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE  AND  b.const_group_code=c.const_group_code  AND b.language_id = c.language_id AND b.language_id = ? ORDER BY c.disp_srl_no,b.disp_srl_no");
		// ORDERING_UNIT to REGIMEN_SETUP_UNIT
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT21","SELECT REGIMEN_SETUP_UNIT FROM PH_TPN_PARAM_FOR_CONST WHERE CONST_GROUP_CODE='MN'");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT29","select a.APPL_FREQ_FOR_TPN code,b.FREQ_DESC  FREQUENCY, b.FREQ_NATURE FREQ_NATURE from ph_param a, AM_FREQUENCY_LANG_VW b where a.APPL_FREQ_FOR_TPN=b.FREQ_CODE and  MODULE_ID='PH' AND b.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT30","SELECT NPC_VALUE NPC,TOTAL_VOLUME FROM PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT22","SELECT MAX(ORDER_LINE_SEQ_NUM) SEQ FROM OR_ORDER_LINE_FIELD_VALUES WHERE order_id=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_PH_DRUG_PROFILE_UPDATE", "UPDATE PH_PATIENT_DRUG_PROFILE SET TPN_ADMIN_ROUTE=?,MODIFIED_AT_WS_NO=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_FACILITY_ID=? WHERE ORIG_ORDER_ID=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT23","SELECT ORDER_LINE_FIELD_VALUE, ORDER_LINE_DOSE_QTY_VALUE ||' '||ORDER_LINE_DOSE_QTY_UNIT  dose FROM OR_ORDER_LINE_FIELD_VALUES WHERE order_id=? AND ORDER_LINE_FIELD_MNEMONIC ='SCHED_ADMIN_TIME'");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT24","SELECT DISTINCT CONST_GROUP_CODE FROM PH_TPN_CONST_GENERIC_NAME WHERE CONST_GENERIC_CODE  IN(SELECT CONST_GENERIC_CODE FROM PH_TPN_CONSTITUENT_LIMIT WHERE AGE_GROUP_CODE =(SELECT AGE_GROUP_CODE FROM AM_AGE_GROUP WHERE ( SELECT   CASE  WHEN INSTR(GET_AGE(DATE_OF_BIRTH),'Y')>0    THEN Ph_Pkg_Common.Ph_Getsubstrbtwndelim(GET_AGE(DATE_OF_BIRTH),'Y',1) WHEN INSTR(GET_AGE(DATE_OF_BIRTH),'M')>0 THEN    Ph_Pkg_Common.Ph_Getsubstrbtwndelim(GET_AGE(DATE_OF_BIRTH),'M',1) WHEN INSTR            (GET_AGE (DATE_OF_BIRTH),'D') > 0  THEN ph_pkg_common.ph_getsubstrbtwndelim              (GET_AGE (DATE_OF_BIRTH),'D',1) END  AGE FROM MP_PATIENT WHERE PATIENT_ID =? )BETWEEN MIN_AGE AND MAX_AGE  AND (GENDER<>DECODE((SELECT sex  FROM mp_patient WHERE     patient_id=?),'M','F','F','M','U','*') OR gender IS NULL)   AND age_group_code IN(SELECT age_group_code FROM PH_TPN_CONSTITUENT_LIMIT) AND ROWNUM<2))");
        dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT25","select ENERGY_UNIT from PH_TPN_PARAM where MODULE_ID='PH'");
        dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT26","SELECT QTY_VALUE FROM OR_ORDER_LINE WHERE ORDER_ID=? AND  ADDED_FACILITY_ID=?");
		/* These Queries are for amending standard regimen order */
        //oph.total_daily_fluid, oph.enteral_feeding added for amend ML-MMOH-CRF-1012
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT20","SELECT distinct f.repeat_value, b.qty_value, b.route_code, c.total_volume,c.pres_base_unit, b.order_catalog_code, f.freq_nature, b.catalog_desc,c.long_name,e.order_id, b.order_line_num,TO_CHAR (b.start_date_time, 'dd/mm/yyyy hh24:mi') start_date_time,b.freq_code, b.durn_value, b.durn_type, TO_CHAR (b.end_date_time, 'dd/mm/yyyy hh24:mi') end_date_time,oph.infuse_over,oph.infuse_over_unit,(SELECT COUNT (*) FROM or_order_line_field_values WHERE order_id = e.order_id AND order_line_field_mnemonic = 'SCHED_ADMIN_TIME') isscheduled,pdf.TPN_ADMIN_ROUTE, oph.BUILD_MAR_YN,oph.total_daily_fluid, oph.enteral_feeding FROM or_order e,or_order_line b,or_order_line_ph oph,ph_tpn_regimen_lang_vw c,am_frequency f,ph_patient_drug_profile pdf WHERE e.order_id = b.order_id   AND e.order_id = oph.order_id   AND b.order_catalog_code = c.tpn_regimen_code AND b.freq_code = f.freq_code   AND e.patient_id=pdf.patient_id   and b.order_line_num = oph.order_line_num and e.order_id = pdf.orig_order_id AND e.order_id =? AND c.language_id = ?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_UPDATEORDERLINE1","UPDATE OR_ORDER_LINE SET ROUTE_CODE=?, QTY_VALUE=?,QTY_UNIT=?,ORDER_QTY=?,  ORDER_UOM=?, DURN_VALUE=?, START_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),END_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),MODIFIED_BY_ID=?,  MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?,  MODIFIED_FACILITY_ID=?, CATALOG_DESC=?,CATALOG_SYNONYM_DC=?,CATALOG_SYNONYM_AD=?,CATALOG_SYNONYM=? WHERE order_id=?");
//query copied from SQL_PH_TPN_STD_REGIMEN_UPDATEORDERLINE1  to sort out tpn std regmen amend mode exception
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_UPDATEORDERLINE1A","UPDATE OR_ORDER_LINE SET ROUTE_CODE=?, QTY_VALUE=?,QTY_UNIT=?,ORDER_QTY=?,  ORDER_UOM=?, DURN_VALUE=?, START_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),END_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),MODIFIED_BY_ID=?,  MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?,  MODIFIED_FACILITY_ID=?,FREQ_CODE=? WHERE order_id=?");//freq_code added for ICN67574
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_UPDATEORDERLINEPH","UPDATE OR_ORDER_LINE_PH SET INFUSE_OVER=?, INFUSE_OVER_UNIT=?,TOT_INFUSION_OVER=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE ORDER_ID=? ");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_UPDATEORDERLINEPH1","UPDATE OR_ORDER_LINE_PH SET INFUSE_OVER=?, INFUSE_OVER_UNIT=?,TOT_INFUSION_OVER=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, ADMIN_RATE_DETAIL=? WHERE ORDER_ID=? ");
		/* End of Queries for amending standard regimen order */
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT18","SELECT c.const_generic_code, c.const_generic_name,  (SELECT  ORDERING_UNIT FROM    PH_TPN_PARAM_FOR_CONST WHERE    GROUP_OR_INDIVIDUAL_IND=c.uom_setup_level_ind AND   CONST_GROUP_CODE=?  )   const_qty_unit      FROM      PH_TPN_CONST_GEN_NAME_LANG_VW C WHERE     c.CONST_GROUP_CODE=? AND C.LANGUAGE_ID = ? ORDER BY   c.disp_srl_no,c.const_generic_name");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_SELECT19","SELECT   CEIL(?/DECODE(CONTENT_IN_PRES_BASE_UOM, 0,1,NVL(CONTENT_IN_PRES_BASE_UOM,1)) ) stock_qty,  SALE_UOM_CODE   stock_uom FROM    PH_INVENTORY_ITEM_FOR_DRUG A,ST_ITEM B WHERE  A.INVENTORY_ITEM_CODE=B.ITEM_CODE AND A.DRUG_CODE=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_INSERT1","INSERT INTO OR_ORDER (ORDER_ID, ORDER_TYPE_CODE, ORDER_CATEGORY,CONTR_SYS_ID, PATIENT_ID, PATIENT_CLASS, ORDERING_FACILITY_ID,ENCOUNTER_ID, EPISODE_ID, SOURCE_TYPE,SOURCE_CODE, DISCHARGE_IND, ORD_DATE_TIME, ORD_PRACT_ID, PRIORITY, ORD_AUTH_REQD_YN,  ORD_AUTH_BY_PRACT_ID,ORD_AUTH_DATE_TIME,ORD_APPR_REQD_YN, ORD_APPR_BY_USER_ID, ORD_APPR_DATE_TIME, ORD_COSIGN_REQD_YN, ORD_COSIGN_BY_PRACT_ID, ORD_COSIGN_DATE_TIME,BILL_YN, CONT_ORDER_IND, PERFORMING_FACILITY_ID, PERFORMING_SYS_ID, PERFORMING_DEPTLOC_TYPE, PERFORMING_DEPTLOC_CODE, PERFORMING_PRACT_ID,  RESULT_AUTH_REQD_YN, CHILD_ORDER_YN,  ORDER_SET_YN,  IV_PREP_YN,  ORDER_STATUS,ADDED_BY_ID,  ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,  MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, ORD_CONSENT_REQD_YN, ORD_CONSENT_BY_ID,  ORD_CONSENT_BY_DATE_TIME) VALUES (?/*order_id*/, ?/*ORDER_TYPE_CODE*/, 'PH', 'PH', ?/*PATIENT_ID*/,?/*PATIENT_CLASS*/, ?/*ORDERING_FACILITY_ID*/, ?/*ENCOUNTER_ID*/, ?/*EPISODE_ID*/, ? /*SOURCE_TYPE*/, ?/*SOURCE_CODE*/, 'N', TO_DATE(?, 'dd/mm/yyyy hh24:mi')/*ORD_DATE_TIME*/, ?/*ORD_PRACT_ID*/, ?/*PRIORITY*/,?/*ORD_AUTH_REQD_YN*/, ?/*ORD_AUTH_BY_PRACT_ID*/,  TO_DATE(?, 'dd/mm/yyyy hh24:mi')/*ORD_AUTH_DATE_TIME*/,?/*ORD_APPR_REQD_YN*/, ?/*ORD_APPR_BY_USER_ID*/,  TO_DATE(?, 'dd/mm/yyyy hh24:mi')/*ORD_APPR_DATE_TIME*/,?/*ORD_COSIGN_REQD_YN*/, ?/*ORD_COSIGN_BY_PRACT_ID*/, TO_DATE(?, 'dd/mm/yyyy hh24:mi')/*ORD_COSIGN_DATE_TIME*/,'N', 'CO', ?/*PERFORMING_FACILITY_ID*/, 'PH', ?/*PERFORMING_DEPTLOC_TYPE*/,	?/*PERFORMING_DEPTLOC_CODE*/,?/*PERFORMING_PRACT_ID*/, 'N', 'N', 'N', ?, ?/*ORDER_STATUS*/, ?/*ADDED_BY_ID*/, SYSDATE, ?/*ADDED_AT_WS_NO*/, ?/*ADDED_FACILITY_ID*/,  ?/*MODIFIED_BY_ID*/, SYSDATE, ?/*MODIFIED_AT_WS_NO*/,   ?/*MODIFIED_FACILITY_ID*/, ?/*ORD_CONSENT_REQD_YN*/, ?/*ORD_CONSENT_BY_ID*/,    TO_DATE(?, 'dd/mm/yyyy hh24:mi')/*ORD_CONSENT_BY_DATE_TIME*/ )");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_INSERT2","INSERT INTO OR_ORDER_LINE (ORDER_ID,ORDER_LINE_NUM, ORDER_CATALOG_CODE,CATALOG_DESC, CATALOG_SYNONYM,ORDER_TYPE_CODE, ORDER_CATEGORY,ORD_DATE_TIME,PRIORITY,ORD_AUTH_REQD_YN, ORD_APPR_REQD_YN,ORD_COSIGN_REQD_YN,START_DATE_TIME, ROUTE_CODE,QTY_VALUE,QTY_UNIT,FREQ_CODE,DURN_VALUE,DURN_TYPE, LINE_FIELDS_DISPLAY_TEXT, END_DATE_TIME,ORDER_QTY, ORDER_UOM,APPT_REQD_YN, RESULT_APPLICABLE_YN,BILL_YN, BILLED_YN,CONT_ORDER_IND,REFILL_SINGLE_CONT_ORDER_YN, CHILD_ORDER_YN, ORD_PRACT_ID,ORDER_LINE_STATUS, ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,ORD_CONSENT_REQD_YN,CATALOG_SYNONYM_DC, CATALOG_SYNONYM_AD,RESULT_AUTH_REQD_YN) VALUES (?/*ORDER_ID */,? /*ORDER_LINE_NUM */,? /*ORDER_CATALOG_CODE */,? /*CATALOG_DESC */,? /*CATALOG_SYNONYM */,?/* ORDER_TYPE_CODE */,'PH',TO_DATE(?,'dd/mm/yyyy hh24:mi')/*ORD_DATE_TIME */, ?/* PRIORITY*/,?/*ORD_AUTH_REQD_YN */,?/*ORD_APPR_REQD_YN */,?/*ORD_COSIGN_REQD_YN */, TO_DATE(?,'dd/mm/yyyy hh24:mi')/* START_DATE_TIME*/,?/*ROUTE_CODE */,?/*QTY_VALUE */,?/*QTY_UNIT */,?/*FREQ_CODE */,?/*DURN_VALUE */,?/* DURN_TYPE*/,?/* LINE_FIELDS_DISPLAY_TEXT*/, TO_DATE(?,'dd/mm/yyyy hh24:mi')/*END_DATE_TIME */,?/*ORDER_QTY */,?/*ORDER_UOM */,'N','N','N','N','CO','N','N',?/* ORD_PRACT_ID */,?/* ORDER_LINE_STATUS */,?/* ADDED_BY_ID*/,SYSDATE,?/* ADDED_AT_WS_NO */,?/*ADDED_FACILITY_ID*/,?/* MODIFIED_BY_ID*/,SYSDATE,? /*MODIFIED_AT_WS_NO */,? /*MODIFIED_FACILITY_ID */,?/*ORD_CONSENT_REQD_YN */,?/*CATALOG_SYNONYM_DC */,?/* CATALOG_SYNONYM_AD */,'N')");
        // TOTAL_DAILY_FLUID, ENTERAL_FEEDING ? ? added for ML-MMOH-CRF-1012 
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_INSERT3","INSERT INTO OR_ORDER_LINE_PH (ORDER_ID,ORDER_LINE_NUM,TRADE_CODE,FORMULARY_ITEM_YN,DOSAGE_TYPE,TOT_STRENGTH,TOT_STRENGTH_UOM,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,BROUGHT_BY_PATIENT_YN,CUR_DRUG_YN,REFILL_DRUG_YN,DISPENSING_LOC_TYPE,DISPENSING_LOC,BMS_QTY,BMS_STRENGTH,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,SPLIT_DOSE_YN,STRENGTH_VALUE,STRENGTH_UOM,PRES_QTY_VALUE,PRES_QTY_UOM, BUILD_MAR_YN, TOTAL_DAILY_FLUID, ENTERAL_FEEDING) VALUES (? /*ORDER_ID */,? /* ORDER_LINE_NUM */,? /*TRADE_CODE */,'N',? /*DOSAGE_TYPE */,?/* TOT_STRENGTH*/,?/*TOT_STRENGTH_UOM */,?/*INFUSE_OVER */,?/* INFUSE_OVER_UNIT*/,?/*INFUSION_RATE */,?/* INFUSION_VOL_STR_UNIT*/,?/* INFUSION_PER_UNIT*/,'N','N','N',?/*DISPENSING_LOC_TYPE */,?/* DISPENSING_LOC*/,?/*BMS_QTY */,?/* BMS_STRENGTH */,?/*ADDED_BY_ID */,SYSDATE,?/* ADDED_AT_WS_NO*/,?/* ADDED_FACILITY_ID */,?/* MODIFIED_BY_ID */,SYSDATE,?/*MODIFIED_AT_WS_NO */,?/* MODIFIED_FACILITY_ID */,'N',?/* STRENGTH_VALUE */,?/*STRENGTH_UOM */,?/*PRES_QTY_VALUE */,?/*PRES_QTY_UOM */,?,?,?)");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_INSERT3A","INSERT INTO OR_ORDER_LINE_PH (ORDER_ID,ORDER_LINE_NUM,TRADE_CODE,FORMULARY_ITEM_YN,DOSAGE_TYPE,TOT_STRENGTH,TOT_STRENGTH_UOM,INFUSE_OVER,INFUSE_OVER_UNIT,INFUSION_RATE,INFUSION_VOL_STR_UNIT,INFUSION_PER_UNIT,BROUGHT_BY_PATIENT_YN,CUR_DRUG_YN,REFILL_DRUG_YN,DISPENSING_LOC_TYPE,DISPENSING_LOC,BMS_QTY,BMS_STRENGTH,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,SPLIT_DOSE_YN,STRENGTH_VALUE,STRENGTH_UOM,PRES_QTY_VALUE,PRES_QTY_UOM,ADMIN_RATE_DETAIL, BUILD_MAR_YN) VALUES (? /*ORDER_ID */,? /* ORDER_LINE_NUM */,? /*TRADE_CODE */,'N',? /*DOSAGE_TYPE */,?/* TOT_STRENGTH*/,?/*TOT_STRENGTH_UOM */,?/*INFUSE_OVER */,?/* INFUSE_OVER_UNIT*/,?/*INFUSION_RATE */,?/* INFUSION_VOL_STR_UNIT*/,?/* INFUSION_PER_UNIT*/,'N','N','N',?/*DISPENSING_LOC_TYPE */,?/* DISPENSING_LOC*/,?/*BMS_QTY */,?/* BMS_STRENGTH */,?/*ADDED_BY_ID */,SYSDATE,?/* ADDED_AT_WS_NO*/,?/* ADDED_FACILITY_ID */,?/* MODIFIED_BY_ID */,SYSDATE,?/*MODIFIED_AT_WS_NO */,?/* MODIFIED_FACILITY_ID */,'N',?/* STRENGTH_VALUE */,?/*STRENGTH_UOM */,?/*PRES_QTY_VALUE */,?/*PRES_QTY_UOM */,?,?)");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_INSERT4","INSERT INTO OR_ORDER_COMMENT (ORDER_ID,ACTION_SEQ_NUM,ORDER_COMMENT,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,empty_clob(),?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_INSERT5","INSERT INTO OR_ORDER_LINE_FIELD_VALUES (ORDER_ID,ORDER_LINE_NUM,ORDER_LINE_FIELD_LEVEL,ORDER_LINE_SEQ_NUM,ORDER_LINE_FIELD_MNEMONIC,ORDER_LINE_FIELD_TYPE,ORDER_LINE_LABEL_TEXT,ORDER_LINE_FIELD_VALUE,ORDER_LINE_DOSE_QTY_VALUE,ORDER_LINE_DOSE_QTY_UNIT,ACCEPT_OPTION,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_DELETE", "DELETE FROM PH_MEDN_ADMIN WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_INSERT6", "INSERT INTO PH_MEDN_ADMIN (FACILITY_ID,ENCOUNTER_ID,SCH_DATE_TIME,ORD_DRUG_CODE, DOSAGE_SEQ_NO,ORDER_ID,ORDER_LINE_NUM,PATIENT_ID,PRACT_ID,SCH_DOSAGE_QTY, SCH_DOSAGE_UOM_CODE,SCH_ROUTE_CODE,ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,VERIFY_REQD_YN,ADMINISTERED_YN)  VALUES (?/*FACILITY_ID*/,?/*ENCOUNTER_ID*/, TO_DATE(?,'dd/mm/yyyy hh24:mi')/*SCH_DATE_TIME*/, ?/*REGIMEN_CODE*/,?/*DOSAGE_SEQ_NO*/,? /*ORDER_ID*/,?/*ORDER_LINE_NUM*/,?/*PATIENT_ID*/,?/*PRACT_ID*/,?/*SCH_DOSAGE_QTY*/,?/*SCH_DOSAGE_UOM_CODE*/, ?/*SCH_ROUTE_CODE*/,?/*USER*/,SYSDATE, ?/*WSNO**/,?/*FACILITY*/,?/*USER*/,SYSDATE,?/*WSNO*/,?/*FACILITY*/,?/*VERIFY_REQD_YN*/,'N')");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_UPDATE1", "SELECT ORDER_COMMENT FROM OR_ORDER_COMMENT WHERE ORDER_ID =? AND ACTION_SEQ_NUM = ? FOR UPDATE ");
		//dataMap.put("SQL_PH_TPN_STD_REGIMEN_UPDATE1", "SELECT ORDER_COMMENT FROM OR_ORDER_COMMENT WHERE ORDER_ID =? AND ACTION_SEQ_NUM = ? FOR UPDATE ");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_ORDERLINEREMARKSDELETE", "DELETE FROM OR_ORDER_LINE_FIELD_VALUES WHERE  ORDER_ID=? AND ORDER_LINE_FIELD_MNEMONIC !='SCHED_ADMIN_TIME'");
		dataMap.put("SQL_PH_TPN_STD_REGIMEN_ORDERREMARKSDELETE", "DELETE FROM OR_ORDER_COMMENT WHERE ORDER_ID=?");
		dataMap.put("JNDI_PH_TPNSTANDARDREGIMEN", "java:comp/env/TPNStandardRegimen");
		//TPN Standard Regimen Queries end here
		//TPN Non Standard Regimen Queries
		/* Non Standard Regimen uses most queries of Standard Regimen .The extra queries are listed here */
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_SELECT1","SELECT   TPN_REGIMEN_CODE,   DFLT_TPN_ROUTE,   TOTAL_VOLUME,   SHORT_NAME,   b.QTY_UOM PRES_BASE_UNIT,   ITEM_CODE,   INFUSE_OVERDURN_TYPE,   INFUSE_OVER_VALUE,   B.ORDER_TYPE_CODE,   CONSENT_REQD_YN,   ORD_AUTH_REQD_YN,   ORD_COSIGN_REQD_YN,   ORD_SPL_APPR_REQD_YN,   FREQ_CODE,   DURN_VALUE,   DURN_TYPE,   CHK_FOR_MAX_DURN_ACTION,   PROMPT_MSG,   MAX_DURN_VALUE,   TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+NVL(durn_value,0),'DD/MM/YYYY HH24:MI') ENDDATE FROM     PH_TPN_REGIMEN_LANG_VW A,  OR_ORDER_CATALOG B,   OR_ORDER_CATALOG_BY_PTCL C WHERE    STANDARD_REGIMEN_YN='N' AND   A.TPN_REGIMEN_CODE=B.ORDER_CATALOG_CODE AND   B.ORDER_CATALOG_CODE=C.ORDER_CATALOG_CODE AND   ROWNUM<2 AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_SELECT2","SELECT A.CONST_GENERIC_CODE, B.CONST_GROUP_CODE,CONST_QTY, CONST_QTY_UNIT  FROM OR_ORDER_LINE_PH_TPN A,PH_TPN_CONST_GENERIC_NAME  B WHERE  order_id=? AND A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_SELECT2A","SELECT  CONST_GENERIC_CODE, CONST_QTY, CONST_QTY_UNIT, PRES_ITEM_CODE, TPN_LIMIT_OVERRIDE_REASON FROM OR_ORDER_LINE_PH_TPN WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_SELECT3","select TOTAL_VOLUME from ph_tpn_regimen where TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_INSERT1","INSERT INTO OR_ORDER_LINE_PH_TPN ( ORDER_ID, ORDER_LINE_NUM, CONST_GENERIC_CODE, CONST_QTY,  CONST_QTY_UNIT, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,   MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID )     VALUES ( ? ,?,?, ?,?, ?, SYSDATE, ?,?, ?, SYSDATE,?, ?) ");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_DELETE1","DELETE FROM OR_ORDER_LINE_PH_TPN WHERE ORDER_ID=? ");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_SELECT4","SELECT HIGH_CARBO_CONCENTRATION FROM PH_FACILITY_PARAM WHERE FACILITY_ID = ? ");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_SELECT5","SELECT CATALOG_DESC FROM OR_ORDER_LINE WHERE ORDER_ID = ? AND ORDER_LINE_NUM = '1'");
		dataMap.put("SQL_PH_TPN_NON_STD_REGIMEN_SELECT6","SELECT round((?*(DECODE(a.CONCENTRATION_PERCENT,NULL,100,0,100,a.CONCENTRATION_PERCENT)/100)),2)  || ' ' || b.SALE_UOM_CODE  Volume FROM	PH_TPN_CONST_FOR_NS_REGIMEN a 	,ST_ITEM b WHERE a.CONST_GENERIC_CODE = ?  AND  a.ITEM_CODE=?   AND A.ITEM_CODE=B.ITEM_CODE ");

		//End of TPN Non Standard Regimen Queries
		//TPN  Regimen Master starts here
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT1","SELECT SRL_NO, STRESS_RELATED_OPTION,WEIGHTAGE,  DEFAULT_YN FROM  PH_TPN_WTAGE_FOR_STS_LANG_VW PH_TPN_WEIGHTAGE_FOR_STRESS WHERE LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT2","SELECT CONST_GENERIC_CODE, short_desc CONST_QTY_UNIT,CONST_MIN_VAL,  CONST_MAX_VAL, CONST_STD_VAL FROM PH_TPN_CONSTITUENT_LIMIT , AM_UOM_LANG_VW AM_UOM WHERE CONST_GENERIC_CODE='FLUID' AND UOM_CODE = CONST_QTY_UNIT AND age_group_code IN ( SELECT AGE_GROUP_CODE FROM AM_AGE_GROUP WHERE (   SELECT  CASE  WHEN INSTR(GET_AGE(DATE_OF_BIRTH),'Y')>0  THEN   Ph_Pkg_Common.Ph_Getsubstrbtwndelim(GET_AGE(DATE_OF_BIRTH),'Y',1)   WHEN INSTR(GET_AGE(DATE_OF_BIRTH),'M')>0 THEN    Ph_Pkg_Common.Ph_Getsubstrbtwndelim(GET_AGE(DATE_OF_BIRTH),'M',1)  END  AGE FROM MP_PATIENT WHERE PATIENT_ID =? ) BETWEEN MIN_AGE AND MAX_AGE 	 AND ( GENDER<>DECODE((SELECT sex FROM mp_patient WHERE  patient_id=?),'M','F','F','M','U','*')  OR gender IS NULL) AND  age_unit=( SELECT DECODE(GREATEST(INSTR(GET_AGE(DATE_OF_BIRTH),'Y'),0),0,'D','Y') FROM MP_PATIENT WHERE patient_id=?)) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT3","SELECT CONST_GENERIC_CODE, short_desc CONST_QTY_UNIT,CONST_MIN_VAL,  CONST_MAX_VAL, CONST_STD_VAL FROM PH_TPN_CONSTITUENT_LIMIT , AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE =CONST_QTY_UNIT AND CONST_GENERIC_CODE IN ('PROTEIN','LIPID') AND age_group_code = (SELECT AGE_GROUP_CODE FROM AM_AGE_GROUP WHERE AGE_GROUP_CODE IN (SELECT DISTINCT AGE_GROUP_CODE FROM PH_TPN_CONSTITUENT_LIMIT) AND (  (GENDER IS NULL) OR (GENDER IS NOT NULL AND GENDER = ? )) AND ( ? between min_age * decode(age_unit,'D',1,'M',30,'Y',365) and max_age * decode(age_unit_max,'D',1,'M',30,'Y',365))) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT14","SELECT SEX PAT_GENDER, ROUND(SYSDATE - DATE_OF_BIRTH) PAT_AGE_IN_DAYS FROM MP_PATIENT WHERE PATIENT_ID = ?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT4","SELECT ORDER_CATALOG_CODE FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=? AND EFF_STATUS='E'");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT5","SELECT B.SHORT_DESC, B.UOM_CODE FROM PH_TPN_PARAM A, AM_UOM_LANG_VW B WHERE A.REGIMEN_PRESC_BASE_UNIT=B.UOM_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT6","SELECT ORDERING_UNIT  FROM PH_TPN_PARAM_FOR_CONST WHERE CONST_GROUP_CODE='FL'");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT7","SELECT EQVL_VALUE FROM AM_UOM_EQVL WHERE (UOM_CODE = (SELECT uom_code FROM am_uom WHERE short_desc = ?)AND EQVL_UOM_CODE = 'GM') OR (UOM_CODE = 'GM' AND EQVL_UOM_CODE = (SELECT uom_code FROM am_uom WHERE short_desc = ?))");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT8","SELECT CONSTITUENT_CODE,ENERGY_REL_VALUE FROM PH_TPN_ENERGY_FOR_CONST");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT9","SELECT ENERGY_UNIT FROM PH_TPN_PARAM WHERE MODULE_ID='PH'");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT10","SELECT TOT_CAL FROM PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT11","SELECT DISTINCT EMULSION_TYPE FROM PH_CONST_FOR_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT12","SELECT NPC_VALUE FROM PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_REGIMEN_SELECT13","SELECT COUNT(ROWID) TOT_COUNT FROM PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE = ?");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT1",	"SELECT C.CONST_GENERIC_CODE, C.CONST_GENERIC_NAME, UOM_SETUP_LEVEL_IND,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE = b.REGIMEN_SETUP_UNIT AND EFF_STATUS='E' AND LANGUAGE_ID = ? )unit_desc, regimen_setup_unit FROM PH_TPN_CONST_GEN_NAME_LANG_VW C, PH_TPN_PARAM_FOR_CONST B WHERE C.CONST_GROUP_CODE=?  AND c.const_Group_code=b.const_group_code AND c.UOM_SETUP_LEVEL_IND=b.GROUP_OR_INDIVIDUAL_IND AND C.LANGUAGE_ID = ? ORDER BY C.CONST_GENERIC_NAME"); 

		//dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT1",	"SELECT C.CONST_GENERIC_CODE, C.CONST_GENERIC_NAME, UOM_SETUP_LEVEL_IND,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE = b.REGIMEN_SETUP_UNIT AND EFF_STATUS='E' AND LANGUAGE_ID = ? )unit_desc, regimen_setup_unit FROM PH_TPN_CONST_GEN_NAME_LANG_VW C, PH_TPN_PARAM_FOR_CONST B WHERE C.CONST_GROUP_CODE=?  AND c.const_Group_code=b.const_group_code AND c.UOM_SETUP_LEVEL_IND=b.GROUP_OR_INDIVIDUAL_IND AND C.LANGUAGE_ID = ? ORDER BY C.CONST_GENERIC_NAME");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT2","SELECT A.CONST_GROUP_CODE,A.CONST_GROUP_NAME, A.DISP_SRL_NO  FROM PH_TPN_CONST_GRP_LANG_VW A    WHERE EFF_STATUS='E' AND a.const_group_code IN (SELECT CONST_GROUP_CODE FROM PH_TPN_PARAM_FOR_CONST WHERE GROUP_OR_INDIVIDUAL_IND = 'G')   AND A.LANGUAGE_ID = ? ORDER BY DISP_SRL_NO"); 

	    //dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT2","SELECT A.CONST_GROUP_CODE,A.CONST_GROUP_NAME, A.DISP_SRL_NO  FROM PH_TPN_CONST_GRP_LANG_VW A    WHERE EFF_STATUS='E' AND a.const_group_code IN (SELECT CONST_GROUP_CODE FROM PH_TPN_PARAM_FOR_CONST WHERE GROUP_OR_INDIVIDUAL_IND = 'G')   AND A.LANGUAGE_ID = ? ORDER BY DISP_SRL_NO"); 


		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT3",	"SELECT COUNT(ROWID) COUNT FROM PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT4",	"SELECT TPN_REGIMEN_CODE, LONG_NAME, decode(DFLT_TPN_ROUTE,'C','Central', 'P', 'Peripheral')DFLT_TPN_ROUTE  FROM PH_TPN_REGIMEN_LANG_VW PH_TPN_REGIMEN WHERE   UPPER(tpn_regimen_code) LIKE UPPER(?) AND UPPER(LONG_NAME) LIKE UPPER(?) AND language_id = ?");
//		SHORT_NAME,UPPER(SHORT_NAME) LIKE UPPER(?)  AND  have been removed from the above query as the short name is removed in the tpn_standard_regiment master
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT5",	"SELECT SHORT_NAME, LONG_NAME, ITEM_CODE, DFLT_TPN_ROUTE, TOTAL_VOLUME, PRES_BASE_UNIT, SCHEDULE_ID, PRES_CATG_CODE, INFUSE_OVER_VALUE, INFUSE_OVERDURN_TYPE,   DISP_AUTH_REQD_YN, DISP_VIA_PRES_ONLY_YN, DISP_AGAINST_DAMAGE_YN, CAUTION_LABEL_TEXT_ID_1, CAUTION_LABEL_TEXT_ID_2, SPL_INSTR_LABEL_TEXT_ID, HOW_TO_TAKE_TEXT, EXTERNAL_PRODUCT_ID, SINGLE_EMULSION_YN, PPN_YN FROM PH_TPN_REGIMEN_LANG_VW PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE = ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT6",	"SELECT CONST_GENERIC_CODE,CONST_CONCENTRATION_PERC,CONST_VOLUME,CONST_VOLUME_UNIT,CONST_WEIGHT,CONST_WEIGHT_UNIT FROM PH_CONST_FOR_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT7",	"SELECT STANDARD_REGIMEN_YN FROM PH_TPN_REGIMEN WHERE TPN_REGIMEN_CODE=?");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT8","SELECT A.UOM_CODE CODE,A.SHORT_DESC DESCRIPTION FROM AM_UOM A,AM_UOM_EQVL B WHERE A.STOCK_UOM_YN='Y' AND ((A.UOM_CODE=B.UOM_CODE AND B.EQVL_UOM_CODE=?) OR (A.UOM_CODE=B.EQVL_UOM_CODE AND B.UOM_CODE=?) )  ");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT9","SELECT SALE_UOM_CODE FROM ST_ITEM WHERE ITEM_CODE=?");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT10", "SELECT EQVL_VALUE FROM AM_UOM_EQVL a, st_item b WHERE a.eqvl_uom_code=b.sale_uom_code AND a.UOM_CODE = ? AND b.item_code = ?     ");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT11","SELECT C.CONST_GENERIC_CODE, C.CONST_GENERIC_NAME, UOM_SETUP_LEVEL_IND,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE = b.REGIMEN_SETUP_UNIT AND EFF_STATUS='E' AND LANGUAGE_ID = ?)unit_desc, regimen_setup_unit FROM PH_TPN_CONST_GEN_NAME_LANG_VW C, PH_TPN_PARAM_FOR_CONST B WHERE C.CONST_GROUP_CODE=?  AND c.const_Group_code=b.const_group_code AND c.UOM_SETUP_LEVEL_IND=b.GROUP_OR_INDIVIDUAL_IND AND disp_srl_no = srl_no AND C.LANGUAGE_ID = ? ORDER BY C.CONST_GENERIC_NAME");

		//dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT11","SELECT C.CONST_GENERIC_CODE, C.CONST_GENERIC_NAME, UOM_SETUP_LEVEL_IND,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE = b.REGIMEN_SETUP_UNIT AND EFF_STATUS='E' AND LANGUAGE_ID = ?)unit_desc, regimen_setup_unit FROM PH_TPN_CONST_GEN_NAME_LANG_VW C, PH_TPN_PARAM_FOR_CONST B WHERE C.CONST_GROUP_CODE=?  AND c.const_Group_code=b.const_group_code AND c.UOM_SETUP_LEVEL_IND=b.GROUP_OR_INDIVIDUAL_IND AND disp_srl_no = srl_no AND C.LANGUAGE_ID = ? ORDER BY C.CONST_GENERIC_NAME");



		//dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT11","SELECT C.CONST_GENERIC_CODE, C.CONST_GENERIC_NAME, UOM_SETUP_LEVEL_IND,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE = b.REGIMEN_SETUP_UNIT AND EFF_STATUS='E' AND LANGUAGE_ID = ?)unit_desc, regimen_setup_unit FROM PH_TPN_CONST_GEN_NAME_LANG_VW C, PH_TPN_PARAM_FOR_CONST B WHERE C.CONST_GROUP_CODE=?  AND c.const_Group_code=b.const_group_code AND c.UOM_SETUP_LEVEL_IND=b.GROUP_OR_INDIVIDUAL_IND AND disp_srl_no = srl_no AND C.LANGUAGE_ID = ? ORDER BY C.CONST_GENERIC_NAME");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT12", "SELECT SALE_UOM_CODE FROM ST_ITEM WHERE ITEM_CODE = ?     ");
		//dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT13", "SELECT LONG_NAME,TPN_REGIMEN_CODE FROM PH_TPN_REGIMEN WHERE STANDARD_REGIMEN_YN = 'N' ORDER BY 1  "); 
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT13", "SELECT A.ORDER_TYPE_CODE code,B.SHORT_DESC short_desc FROM PH_ORDER_TYPE_FOR_DRUG_CLASS A,OR_ORDER_TYPE_LANG_VW B WHERE A.ORDER_TYPE_CODE=B.ORDER_TYPE_CODE AND B.EFF_STATUS='E' AND A.DRUG_CLASS='G' AND B.LANGUAGE_ID =  ");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT14", "SELECT A.DRUG_CATG_CODE,A.PATIENT_CLASS,A.MAX_DURN_VALUE,A.MAX_DURN_TYPE ,A.ACTION chk_for_max_durn_action,A.ORD_AUTH_LEVEL,A.PROMPT_MSG FROM PH_DRG_CTG_RLE_BY_PTCL_LANG_VW A WHERE A.LANGUAGE_ID=");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_SELECT15", "SELECT A.ORDER_AUTH_LEVEL ord_auth_level,A.ORDER_COSIGN_LEVEL ord_cosign_level,A.SPL_APPR_LEVEL ord_spl_appr_level,A.DISP_AUTH_REQD_YN result_auth_reqd_yn,A.REPEAT_SINGLE_CONT_ORDER_YN FROM PH_DRUG_SCHEDULE A WHERE SCHEDULE_ID= ");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_INSERT1",	"INSERT INTO PH_TPN_REGIMEN(TPN_REGIMEN_CODE, STANDARD_REGIMEN_YN, SYSTEM_CREATED_YN, SHORT_NAME, LONG_NAME, ITEM_CODE, DFLT_TPN_ROUTE, TOTAL_VOLUME, PRES_BASE_UNIT, CONTENT_IN_BASE_UNIT, TOT_CAL, DRUG_CLASS, SCHEDULE_ID, PRES_CATG_CODE, INFUSE_OVER_VALUE, INFUSE_OVERDURN_TYPE, DISP_AUTH_REQD_YN, DISP_VIA_PRES_ONLY_YN, DISP_AGAINST_DAMAGE_YN, ORDER_TYPE_CODE, CAUTION_LABEL_TEXT_ID_1, CAUTION_LABEL_TEXT_ID_2, SPL_INSTR_LABEL_TEXT_ID, HOW_TO_TAKE_TEXT, EXTERNAL_PRODUCT_ID, DISCONTINUED_YN, DISCONTINUED_REASON, DISCONTINUED_DATE, DISCONTINUED_BY_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SINGLE_EMULSION_YN,PPN_YN,NPC_VALUE,PEAD_TPN_REGIMEN_YN,OVERAGE_VOLUME) VALUES( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?,?,?,?,?,?)");

		//dataMap.put("SQL_PH_TPN_REGIMEN_MAST_INSERT1",	"INSERT INTO PH_TPN_REGIMEN(TPN_REGIMEN_CODE, STANDARD_REGIMEN_YN, SYSTEM_CREATED_YN, SHORT_NAME, LONG_NAME, ITEM_CODE, DFLT_TPN_ROUTE, TOTAL_VOLUME, PRES_BASE_UNIT, CONTENT_IN_BASE_UNIT, TOT_CAL, DRUG_CLASS, SCHEDULE_ID, PRES_CATG_CODE, INFUSE_OVER_VALUE, INFUSE_OVERDURN_TYPE, DISP_AUTH_REQD_YN, DISP_VIA_PRES_ONLY_YN, DISP_AGAINST_DAMAGE_YN, ORDER_TYPE_CODE, CAUTION_LABEL_TEXT_ID_1, CAUTION_LABEL_TEXT_ID_2, SPL_INSTR_LABEL_TEXT_ID, HOW_TO_TAKE_TEXT, EXTERNAL_PRODUCT_ID, DISCONTINUED_YN, DISCONTINUED_REASON, DISCONTINUED_DATE, DISCONTINUED_BY_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,SINGLE_EMULSION_YN,PPN_YN,NPC_VALUE) VALUES( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?,?,?,?)");





		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_INSERT2",	"INSERT INTO PH_CONST_FOR_TPN_REGIMEN(TPN_REGIMEN_CODE, CONST_GENERIC_CODE, CONST_CONCENTRATION_PERC, CONST_VOLUME, CONST_VOLUME_UNIT, CONST_WEIGHT, CONST_WEIGHT_UNIT, EMULSION_TYPE,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?,SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_INSERT3",	"INSERT INTO PH_INVENTORY_ITEM_FOR_DRUG(DRUG_CODE,INVENTORY_ITEM_CODE, STOCK_UOM, CONTENT_IN_PRES_BASE_UOM, CONTENT_IN_STRENGTH_UOM, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_UPDATE1",	"UPDATE PH_TPN_REGIMEN SET STANDARD_REGIMEN_YN=?, SYSTEM_CREATED_YN=?, SHORT_NAME=?, LONG_NAME=?, ITEM_CODE=?, DFLT_TPN_ROUTE=?, TOTAL_VOLUME=?, PRES_BASE_UNIT=?, CONTENT_IN_BASE_UNIT=?, TOT_CAL=?, DRUG_CLASS=?, SCHEDULE_ID=?, PRES_CATG_CODE=?, INFUSE_OVER_VALUE=?, INFUSE_OVERDURN_TYPE=?, DISP_AUTH_REQD_YN=?, DISP_VIA_PRES_ONLY_YN=?, DISP_AGAINST_DAMAGE_YN=?, ORDER_TYPE_CODE=?, CAUTION_LABEL_TEXT_ID_1=?, CAUTION_LABEL_TEXT_ID_2=?, SPL_INSTR_LABEL_TEXT_ID=?, HOW_TO_TAKE_TEXT=?, EXTERNAL_PRODUCT_ID=?, DISCONTINUED_YN=?, DISCONTINUED_REASON=?, DISCONTINUED_DATE=?, DISCONTINUED_BY_ID=?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,SINGLE_EMULSION_YN=?, PPN_YN=?, NPC_VALUE=?, PEAD_TPN_REGIMEN_YN=?, OVERAGE_VOLUME=? WHERE TPN_REGIMEN_CODE=?");

       //dataMap.put("SQL_PH_TPN_REGIMEN_MAST_UPDATE1",	"UPDATE PH_TPN_REGIMEN SET STANDARD_REGIMEN_YN=?, SYSTEM_CREATED_YN=?, SHORT_NAME=?, LONG_NAME=?, ITEM_CODE=?, DFLT_TPN_ROUTE=?, TOTAL_VOLUME=?, PRES_BASE_UNIT=?, CONTENT_IN_BASE_UNIT=?, TOT_CAL=?, DRUG_CLASS=?, SCHEDULE_ID=?, PRES_CATG_CODE=?, INFUSE_OVER_VALUE=?, INFUSE_OVERDURN_TYPE=?, DISP_AUTH_REQD_YN=?, DISP_VIA_PRES_ONLY_YN=?, DISP_AGAINST_DAMAGE_YN=?, ORDER_TYPE_CODE=?, CAUTION_LABEL_TEXT_ID_1=?, CAUTION_LABEL_TEXT_ID_2=?, SPL_INSTR_LABEL_TEXT_ID=?, HOW_TO_TAKE_TEXT=?, EXTERNAL_PRODUCT_ID=?, DISCONTINUED_YN=?, DISCONTINUED_REASON=?, DISCONTINUED_DATE=?, DISCONTINUED_BY_ID=?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?,SINGLE_EMULSION_YN=?, PPN_YN=?, NPC_VALUE=? WHERE TPN_REGIMEN_CODE=?");



		dataMap.put("SQL_PH_TPN_REGIMEN_MAST_DELETE1",	"DELETE PH_CONST_FOR_TPN_REGIMEN WHERE TPN_REGIMEN_CODE = ?");
		dataMap.put("JNDI_PH_TPN_REGIMEN_MAST","java:comp/env/TPNRegimenMast");
		//TPN  Regimen Master ends here
		//TPN worksheet starts here
		//dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT1", "SELECT A.CONST_GENERIC_CODE, B.CONST_GENERIC_NAME, A.CONST_QTY, A.CONST_QTY_UNIT, B.CONST_GROUP_CODE, C.CONST_GROUP_NAME,B.DFLT_ORD_UNIT_IND FROM OR_ORDER_LINE_PH_TPN A, PH_TPN_CONST_GENERIC_NAME B, PH_TPN_CONSTITUENT_GROUP C WHERE A.ORDER_ID=? AND A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND B.CONST_GROUP_CODE=C.CONST_GROUP_CODE AND B.CONST_GENERIC_CODE=NVL('',B.CONST_GENERIC_CODE)ORDER BY C.DISP_SRL_NO");
		
		
		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT1", "SELECT 'N' NOT_TO_BE_ORDERED,A.CONST_GENERIC_CODE,B.CONST_GENERIC_NAME, A.CONST_QTY, A.CONST_QTY_UNIT, B.CONST_GROUP_CODE,C.CONST_GROUP_NAME,B.DFLT_ORD_UNIT_IND,C.DISP_SRL_NO,B.DISP_SRL_NO ,(SELECT CONST_REMARKS FROM	PH_TPN_CONSTITUENT_LIMIT WHERE	TPN_REGIMEN_CODE = ? AND    CONST_GENERIC_CODE = A.CONST_GENERIC_CODE AND	AGE_GROUP_CODE = (SELECT	AGE_GROUP_CODE FROM	AM_AGE_GROUP WHERE nvl(gender,(select sex from mp_patient where patient_id = ?))=(select sex from mp_patient where patient_id = ?)  and trunc(sysdate)-(select trunc(date_of_birth) from mp_patient where patient_id = ?) between  decode(age_unit,'Y',365,'M',30,1)*min_age and decode(age_unit,'Y',365,'M',30,1)*max_age and eff_status='E' AND age_group_code IN  (SELECT age_group_code FROM PH_TPN_CONSTITUENT_LIMIT WHERE TPN_REGIMEN_CODE = ?)))  CONST_REMARKS ,PRES_ITEM_CODE ,TPN_LIMIT_OVERRIDE_REASON    FROM	OR_ORDER_LINE_PH_TPN A, PH_TPN_CONST_GENERIC_NAME B, PH_TPN_CONSTITUENT_GROUP C WHERE	A.ORDER_ID=? AND A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND B.CONST_GROUP_CODE=C.CONST_GROUP_CODE AND B.CONST_GENERIC_CODE=NVL('',B.CONST_GENERIC_CODE) UNION SELECT 'Y' NOT_TO_BE_ORDERED,A.CONST_GENERIC_CODE, B.CONST_GENERIC_NAME, round((select Decode(ORD_UNIT_IND,'A',(SELECT CONST_STD_VAL FROM	PH_TPN_CONSTITUENT_LIMIT WHERE	TPN_REGIMEN_CODE = ? AND    CONST_GENERIC_CODE = A.CONST_GENERIC_CODE AND	AGE_GROUP_CODE = (SELECT	AGE_GROUP_CODE FROM	AM_AGE_GROUP WHERE nvl(gender,(select sex from mp_patient where patient_id = ?))=(select sex from mp_patient where patient_id = ?)  and trunc(sysdate)-(select trunc(date_of_birth) from mp_patient where patient_id = ?) between  decode(age_unit,'Y',365,'M',30,1)*min_age and decode(age_unit,'Y',365,'M',30,1)*max_age and eff_status='E' AND age_group_code IN  (SELECT age_group_code FROM PH_TPN_CONSTITUENT_LIMIT WHERE TPN_REGIMEN_CODE = ?))),'W',(SELECT CONST_STD_VAL FROM	PH_TPN_CONSTITUENT_LIMIT WHERE	TPN_REGIMEN_CODE = ? AND    CONST_GENERIC_CODE = A.CONST_GENERIC_CODE AND	AGE_GROUP_CODE = (SELECT	AGE_GROUP_CODE FROM	AM_AGE_GROUP WHERE nvl(gender,(select sex from mp_patient where patient_id = ?))=(select sex from mp_patient where patient_id = ?)  and trunc(sysdate)-(select trunc(date_of_birth) from mp_patient where patient_id = ?) between  decode(age_unit,'Y',365,'M',30,1)*min_age and decode(age_unit,'Y',365,'M',30,1)*max_age and eff_status='E' AND age_group_code IN  (SELECT age_group_code FROM PH_TPN_CONSTITUENT_LIMIT WHERE TPN_REGIMEN_CODE = ?)))*WEIGHT)    from  ph_patient_drug_profile W,PH_TPN_PARAM_FOR_CONST X where W.patient_id = ? and W.ORIG_ORDER_ID = ? and X.SRL_NO = b.disp_SRL_NO AND x.CONST_GROUP_CODE  = b.CONST_GROUP_CODE),4) CONST_QTY, A.CONST_QTY_UNIT, B.CONST_GROUP_CODE, C.CONST_GROUP_NAME,B.DFLT_ORD_UNIT_IND,C.DISP_SRL_NO,B.DISP_SRL_NO ,A.CONST_REMARKS CONST_REMARKS,NULL PRES_ITEM_CODE ,NULL TPN_LIMIT_OVERRIDE_REASON      FROM	PH_TPN_CONSTITUENT_LIMIT A,PH_TPN_CONST_GENERIC_NAME B, PH_TPN_CONSTITUENT_GROUP C WHERE	A.TPN_REGIMEN_CODE=? AND AGE_GROUP_CODE = (SELECT	AGE_GROUP_CODE FROM	AM_AGE_GROUP WHERE nvl(gender,(select sex from mp_patient where patient_id = ?))=(select sex from mp_patient where patient_id = ?)  and trunc(sysdate)-(select trunc(date_of_birth) from mp_patient where patient_id = ?) between  decode(age_unit,'Y',365,'M',30,1)*min_age and decode(age_unit,'Y',365,'M',30,1)*max_age and eff_status='E' AND age_group_code IN  (SELECT age_group_code FROM PH_TPN_CONSTITUENT_LIMIT WHERE TPN_REGIMEN_CODE = ?) ) AND A.CONST_GENERIC_CODE !='FLUID' AND CONST_USAGE_IND = 'N' AND A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND B.CONST_GROUP_CODE=C.CONST_GROUP_CODE AND NOT EXISTS (SELECT CONST_GENERIC_CODE FROM OR_ORDER_LINE_PH_TPN WHERE ORDER_ID = ? and CONST_GENERIC_CODE = A.CONST_GENERIC_CODE) ORDER BY 10,9,2 ");		

		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT2", "SELECT A.ITEM_CODE ITEM_CODE, D.SHORT_DESC ITEM_DESC FROM PH_INV_ITEM_FOR_NS_REGIMEN A, (SELECT ORDER_ID,CONST_GENERIC_CODE  FROM OR_ORDER_LINE_PH_TPN 	 UNION  SELECT ? ORDER_ID,CONST_GENERIC_CODE  FROM PH_TPN_CONST_GENERIC_NAME ) B,MM_ITEM D WHERE A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND A.ITEM_CODE = D.ITEM_CODE AND B.CONST_GENERIC_CODE=? AND EXISTS (SELECT C.ITEM_CODE FROM ST_ITEM_BATCH C WHERE C.QTY_ON_HAND>=C.COMMITTED_QTY AND C.ITEM_CODE=A.ITEM_CODE AND STORE_CODE=?) AND B.ORDER_ID=?");

		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT3", "SELECT A.STOCK_UOM, DECODE(CONCENTRATION_PERCENT,NULL,CEIL(CONST_QTY/DECODE(CONTENT_IN_PRES_BASE_UOM, 0, 1, NVL(CONTENT_IN_PRES_BASE_UOM, 1))), CEIL((CONCENTRATION_PERCENT/100)*CONST_QTY/DECODE(CONTENT_IN_PRES_BASE_UOM, 0, 1, NVL(CONTENT_IN_PRES_BASE_UOM, 1)))  )  ISSUEQTY,   (NVL(QTY_ON_HAND,   0) - NVL(COMMITTED_QTY,   0)) AVAILABLEQTY,CONCENTRATION_PERCENT,MANUFACTURER_VAR_PERCENTAGE FROM    PH_INV_ITEM_FOR_NS_REGIMEN A,   OR_ORDER_LINE_PH_TPN B,   ST_ITEM_BATCH C,   PH_TPN_CNST_FR_NS_RGMN_LANG_VW D WHERE   A.CONST_GENERIC_CODE=D.CONST_GENERIC_CODE AND    A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND   A.ITEM_CODE=C.ITEM_CODE    AND   B.CONST_GENERIC_CODE=? AND   B.ORDER_ID=? AND   C.STORE_CODE=? AND   C.BATCH_ID=? AND LANGUAGE_ID =? ");
		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT4", "SELECT B.ORDER_ID,BATCH_ID,D.PHY_WEIGHT_UNIT STOCK_UOM,(NVL(C.QTY_ON_HAND, 0) - NVL(C.COMMITTED_QTY, 0)) AVAILABLEQTY, CEIL(PHY_WEIGHT_VALUE*CONST_QTY/NVL((DECODE(UPPER(A.CONST_GENERIC_CODE),UPPER(SUBSTR(D.AN_ION,1,LENGTH(D.AN_ION)-1)), D.MMOL_VALUE_AN_ION,UPPER(SUBSTR(D.CAT_ION,1,LENGTH(D.CAT_ION)-1)),D.MMOL_VALUE_CAT_ION)),0))ISSUEQTY, CEIL(PHY_WEIGHT_VALUE*CONST_QTY/NVL((DECODE(UPPER(A.CONST_GENERIC_CODE),UPPER(SUBSTR(D.AN_ION,1,LENGTH(D.AN_ION)-1)), D.MMOL_VALUE_CAT_ION,UPPER(SUBSTR(D.CAT_ION,1,LENGTH(D.CAT_ION)-1)),D.MMOL_VALUE_AN_ION)),0))ISSUEQTY_OTH, E.CONCENTRATION_PERCENT,E.MANUFACTURER_VAR_PERCENTAGE,DECODE(UPPER(A.CONST_GENERIC_CODE),UPPER(SUBSTR(AN_ION,1, LENGTH(AN_ION)-1)),UPPER(SUBSTR(CAT_ION,1,LENGTH(CAT_ION)-1)),UPPER(SUBSTR(CAT_ION,1,LENGTH(CAT_ION)-1)), UPPER(SUBSTR(AN_ION,1,LENGTH(AN_ION)-1)))otherion,(SELECT concentration_percent||'!' || MANUFACTURER_VAR_PERCENTAGE  FROM PH_TPN_CONST_FOR_NS_REGIMEN WHERE const_generic_code =DECODE(UPPER(A.CONST_GENERIC_CODE),UPPER(SUBSTR(AN_ION,1,LENGTH(AN_ION)-1)),UPPER(SUBSTR(AN_ION,1,LENGTH(CAT_ION)-1)),UPPER(SUBSTR(CAT_ION,1,LENGTH(CAT_ION)-1)),UPPER(SUBSTR(AN_ION,1,LENGTH(AN_ION)-1))))concentration_oth ,(DECODE(UPPER(A.CONST_GENERIC_CODE), UPPER(SUBSTR(D.AN_ION,1,LENGTH(D.AN_ION)-1)), D.MMOL_VALUE_AN_ION, UPPER(SUBSTR(D.CAT_ION,1,LENGTH(D.CAT_ION)-1)), D.MMOL_VALUE_CAT_ION))  MMOLVAL,(DECODE(UPPER(A.CONST_GENERIC_CODE),UPPER(SUBSTR(D.AN_ION,1,LENGTH(D.AN_ION)-1)),D.MMOL_VALUE_CAT_ION,UPPER(SUBSTR(D.CAT_ION,1,LENGTH(D.CAT_ION)-1)),D.MMOL_VALUE_AN_ION))  MMOLVAL_OTH FROM PH_INV_ITEM_FOR_NS_REGIMEN A, OR_ORDER_LINE_PH_TPN B,ST_ITEM_BATCH C,PH_TPN_ELECT_MOL_FORMULA D,PH_TPN_CNST_FR_NS_RGMN_LANG_VW E WHERE A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND E.CONST_GENERIC_CODE = A.CONST_GENERIC_CODE AND A.ITEM_CODE=C.ITEM_CODE AND A.MOLECULE_CODE=D.MOLECULE_CODE AND E.EFF_STATUS = 'E' AND B.CONST_GENERIC_CODE=? AND B.ORDER_ID=? AND C.STORE_CODE=? AND C.BATCH_ID=? AND LANGUAGE_ID=?");
		//dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT5", " SELECT b.SALE_UOM_CODE,a.CONCENTRATION_PERCENT,a.MANUFACTURER_VAR_PERCENTAGE FROM PH_TPN_CONST_FOR_NS_REGIMEN a ,ST_ITEM b WHERE a.CONST_GENERIC_CODE =? AND  a.ITEM_CODE=?  AND A.ITEM_CODE=B.ITEM_CODE");

        dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT5", "SELECT b.SALE_UOM_CODE,DECODE(a.CONCENTRATION_PERCENT,NULL,100,0,100,a.CONCENTRATION_PERCENT) CONCENTRATION_PERCENT, a.MANUFACTURER_VAR_PERCENTAGE FROM PH_TPN_CONST_FOR_NS_REGIMEN a ,ST_ITEM b WHERE a.CONST_GENERIC_CODE = ? AND  a.ITEM_CODE=?  AND A.ITEM_CODE=B.ITEM_CODE ");

		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT6", "SELECT MOLECULE_CODE,STOCK_UOM FROM PH_INV_ITEM_FOR_NS_REGIMEN WHERE ITEM_CODE=? AND CONST_GENERIC_CODE=? AND CONST_SRL_NO=(SELECT MAX(CONST_SRL_NO) FROM PH_INV_ITEM_FOR_NS_REGIMEN WHERE ITEM_CODE=? AND CONST_GENERIC_CODE=?)");
		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT7", "SELECT MEQ_VALUE_AN_ION,MEQ_VALUE_CAT_ION,MMOL_VALUE_AN_ION,MMOL_VALUE_CAT_ION,PHY_WEIGHT_VALUE,PHY_WEIGHT_UNIT,AN_ION,CAT_ION FROM PH_TPN_ELECT_MOL_FORMULA WHERE MOLECULE_CODE=?");
		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT8", "SELECT A.CONST_GENERIC_CODE, B.CONST_GENERIC_NAME, A.CONST_QTY, A.CONST_QTY_UNIT, B.CONST_GROUP_CODE, C.CONST_GROUP_NAME,B.DFLT_ORD_UNIT_IND FROM OR_ORDER_LINE_PH_TPN A, PH_TPN_CONST_GENERIC_NAME B, PH_TPN_CONSTITUENT_GROUP C WHERE A.ORDER_ID=? AND B.CONST_GROUP_CODE=upper(?) AND A.CONST_GENERIC_CODE=UPPER(?) AND A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND B.CONST_GROUP_CODE=C.CONST_GROUP_CODE ORDER BY C.DISP_SRL_NO");
		dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT9", "SELECT CONST_GENERIC_CODE,CONST_QTY_UNIT,DISP_ITEM_CODE,CONST_QTY,BATCH_ID1,TO_CHAR(EXPIRY_DATE1,'DD/MM/YYYY') EXPIRY_DATE1,DISP_QTY,TRADE_ID1,BIN_LOCATION_CODE1,STOCK_UNIT,DISP_QTY_UOM FROM ph_tpn_worksheet_dtl WHERE ORDER_ID=?");
        dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT10", "SELECT DISTINCT A.ITEM_CODE ITEM_CODE, D.SHORT_DESC ITEM_DESC FROM PH_INV_ITEM_FOR_NS_REGIMEN A, PH_TPN_CONST_FOR_NS_REGIMEN B, MM_ITEM D WHERE A.ITEM_CODE = D.ITEM_CODE AND A.ITEM_CODE = B.ITEM_CODE AND B.CONST_GENERIC_CODE = 'FLUID'");

        dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT11", "SELECT INFUSE_OVER FROM OR_ORDER_LINE_PH WHERE ORDER_ID = ?");

        dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT12", "SELECT OSMOLAR_VALUE FROM PH_INV_ITEM_FOR_NS_REGIMEN WHERE CONST_GENERIC_CODE = ? AND ITEM_CODE = ?");
        dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT13", "SELECT CONST_PREC_MESSAGE MESSAGE_DESCR  FROM PH_TPN_CONS_PREC_MOL WHERE CONSTR_GENERIC_FRM_CODE = 'PO4' AND CONSTR_GENERIC_TO_CODE = 'Ca' AND MOLECULE_FRM_CODE = ?  AND MOLECULE_TO_CODE  = ? AND CONST_FRM_MMOL_VALUE_PERL >= ? AND  CONST_TO_MMOL_VALUE_PERL <=? AND CONST_PREC_IND != 'I' AND ROWNUM < = 1 ");
        dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT_EXP_DATE", "SELECT TO_CHAR(SYSDATE+NVL((SELECT EXPIRY_FOR_TPN_ADM FROM PH_TPN_PARAM),0),'DD/MM/YYYY HH24:MI') TPN_EXP_DATE FROM DUAL");

		dataMap.put("SQL_PH_TPN_DISPENSED_DETAILS", "SELECT A.CONST_GENERIC_CODE, B.CONST_GENERIC_NAME, CEIL(A.DISP_QTY)DISP_QTY, A.STOCK_UNIT, B.CONST_GROUP_CODE, C.CONST_GROUP_NAME,B.DFLT_ORD_UNIT_IND FROM PH_TPN_WORKSHEET_DTL A, PH_TPN_CONST_GEN_NAME_LANG_VW B,PH_TPN_CONST_GRP_LANG_VW C,OR_ORDER_LINE D WHERE A.ORDER_ID=? AND A.ORDER_LINE_NUM='1' AND A.ORDER_ID=D.ORDER_ID AND A.ORDER_LINE_NUM=D.ORDER_LINE_NUM AND A.CONST_GENERIC_CODE=B.CONST_GENERIC_CODE AND A.TPN_WORKSHEET_ID=NVL('',A.TPN_WORKSHEET_ID) AND A.WS_SRL_NO=NVL('',A.WS_SRL_NO) AND B.CONST_GROUP_CODE=C.CONST_GROUP_CODE AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ? ORDER BY C.DISP_SRL_NO ");	

        dataMap.put("SQL_PH_TPN_ORD_DISPENSED_DETAILS", "SELECT 'Y' ORDERED,A.CONST_GENERIC_CODE,D.CONST_GENERIC_NAME,E.CONST_GROUP_NAME,A.CONST_QTY ORDERED_QTY,A.CONST_QTY_UNIT ORDERED_UNIT,       C.LONG_DESC DISP_ITEM_DESC,B.DISP_QTY,STOCK_UNIT,DISP_QTY_UOM, E.DISP_SRL_NO SRL_NO,D.DISP_SRL_NO SRL_NO1,E.CONST_GROUP_CODE FROM OR_ORDER_LINE_PH_TPN A, PH_TPN_WORKSHEET_DTL B,MM_ITEM C,PH_TPN_CONST_GENERIC_NAME D,PH_TPN_CONSTITUENT_GROUP E    WHERE A.ORDER_ID = ? AND A.ORDER_ID =B.ORDER_ID (+)   AND A.CONST_GENERIC_CODE = B.CONST_GENERIC_CODE (+) AND C.ITEM_CODE (+) = B.DISP_ITEM_CODE   AND D.CONST_GENERIC_CODE  = A.CONST_GENERIC_CODE  AND E.CONST_GROUP_CODE = D.CONST_GROUP_CODE  UNION SELECT 'N' ORDERED,B.CONST_GENERIC_CODE,D.CONST_GENERIC_NAME,E.CONST_GROUP_NAME,B.CONST_QTY ORDERED_QTY,B.CONST_QTY_UNIT ORDERED_UNIT,        C.LONG_DESC DISP_ITEM_CODE,B.DISP_QTY,STOCK_UNIT ,DISP_QTY_UOM, E.DISP_SRL_NO,D.DISP_SRL_NO,E.CONST_GROUP_CODE FROM PH_TPN_WORKSHEET_DTL B ,MM_ITEM C,PH_TPN_CONST_GENERIC_NAME D ,PH_TPN_CONSTITUENT_GROUP E  WHERE B.ORDER_ID = ? AND C.ITEM_CODE = B.DISP_ITEM_CODE AND D.CONST_GENERIC_CODE  = B.CONST_GENERIC_CODE  AND E.CONST_GROUP_CODE = D.CONST_GROUP_CODE  AND NOT EXISTS (SELECT 'Y' FROM OR_ORDER_LINE_PH_TPN  WHERE ORDER_ID = B.ORDER_ID AND  CONST_GENERIC_CODE = B.CONST_GENERIC_CODE) ORDER BY SRL_NO,SRL_NO1,2 ");	



		//Release Batches
		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT1", "SELECT A.PERFORMING_DEPTLOC_CODE,A.ORDER_ID,D.ORDER_LINE_NO,C.DISP_TMP_NO,C.DOC_NO,C.DOC_TYPE,A.PATIENT_ID,B.PATIENT_NAME,H.DRUG_DESC SHORT_DESC,D.DISP_QTY,D.DISP_UOM_CODE,TO_CHAR(C.RECORD_DATE_TIME,'DD/MM/YYYY') RECORD_DATE_TIME,D.ADDED_BY_ID, D.DISP_DRUG_CODE, D.DOC_SRL_NO ,A.ENCOUNTER_ID  ENCOUNTER_ID FROM OR_ORDER A,MP_PATIENT B,PH_DISP_HDR_TMP C,PH_DISP_DTL_TMP D,OR_ORDER_LINE G, PH_DRUG_LANG_VW H WHERE A.PATIENT_ID   = B.PATIENT_ID AND A.PATIENT_ID   = C.PATIENT_ID AND B.PATIENT_ID   = C.PATIENT_ID AND C.ORDER_ID     = D.ORDER_ID AND C.ORDER_ID     = A.ORDER_ID  AND G.ORDER_ID= D.ORDER_ID AND G.ORDER_LINE_NUM=D.ORDER_LINE_NO AND C.ORDER_ID     = G.ORDER_ID AND A.ORDER_ID     = G.ORDER_ID  AND C.FACILITY_ID  = D.FACILITY_ID AND C.DISP_LOCN_CODE  = D.DISP_LOCN_CODE AND C.DISP_TMP_NO = D.DISP_TMP_NO AND D.DISP_DRUG_CODE = H.DRUG_CODE AND A.PERFORMING_DEPTLOC_CODE=? AND A.PATIENT_ID=NVL(?,A.PATIENT_ID) AND D.DISP_DRUG_CODE = NVL(?,D.DISP_DRUG_CODE) AND H.LANGUAGE_ID = ?");

		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT2", "SELECT COUNT(*) TOTAL FROM PH_DISP_DTL_TMP WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT3", "SELECT ITEM_CODE, BATCH_ID, to_char(EXPIRY_DATE,'dd/mm/yyyy') expiry_date, STORE_CODE, DISP_QTY, DISP_QTY_UOM FROM PH_DISP_DRUG_BATCH_TMP WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT4", "SELECT FACILITY_ID,DISP_LOCN_CODE,ORDER_ID,ORDER_LINE_NUM,BIN_LOCATION_CODE,ITEM_CODE,BATCH_ID,TO_CHAR(EXPIRY_DATE,'DD/MM/YYYY HH24:MI') EXPIRY_DATE,STORE_CODE,DISP_QTY,DISP_QTY_UOM,DRUG_CODE,DOC_SRL_NO,TRADE_ID FROM PH_DISP_DRUG_BATCH_TMP WHERE ORDER_ID = ? AND ORDER_LINE_NUM = ?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT5", "SELECT DISP_TMP_NO, DTL_SERIAL_NUM, TO_CHAR(RECORD_DATE_TIME,'DD/MM/YYYY HH24:MI') RECORD_DATE_TIME FROM PH_DISP_DTL_TMP WHERE ORDER_ID = ? AND ORDER_LINE_NO = ?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT6", "SELECT COUNT(*) TOTAL_BATCH FROM PH_DISP_DRUG_BATCH_TMP WHERE ORDER_ID = ? AND ORDER_LINE_NUM=? AND DOC_SRL_NO = ?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT7", "SELECT COUNT(*) TOTAL FROM PH_DISP_DTL_TMP WHERE ORDER_ID=? AND ORDER_LINE_NO = ?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_SELECT8", "SELECT ORDER_LINE_STATUS FROM OR_ORDER_LINE WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_INSERT1", "INSERT INTO PH_RELEASE_BATCH_LOG (LOG_ID,FACILITY_ID,DISP_LOCN_CODE,ALCN_FILL_NO,ALCN_FILL_SRL_NO,ALCN_FILL_DATE,ORDER_ID,ORDER_LINE_NUM,DRUG_CODE,ITEM_CODE,BATCH_ID,EXPIRY_DATE,STORE_CODE,ALCN_FILL_QTY,ALCN_FILL_QTY_UOM,RELEASE_REASON_TYPE,RELEASE_REASON_CODE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,TRADE_ID) VALUES(PH_RELEASE_LOG_SEQ.NEXTVAL,?,?,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_RELEASE_BATCHES_DELETE1", "DELETE FROM PH_DISP_DRUG_BATCH_TMP WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND DOC_SRL_NO = ?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_DELETE2", "DELETE FROM PH_DISP_DTL_TMP WHERE ORDER_ID=? AND ORDER_LINE_NO=? AND DOC_SRL_NO = ?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_DELETE3", "DELETE FROM PH_DISP_HDR_TMP WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_UPDATE1", "UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS='UC',MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_RELEASE_BATCHES_UPDATE2", "UPDATE OR_ORDER SET ORDER_STATUS=?,CAN_REASON='',MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=?");
		// JNDI Release Batches
		dataMap.put("JNDI_PH_RELEASE_BATCHES", "java:comp/env/ReleaseBatches");
		//OverRide BMS
		dataMap.put("SQL_PH_OVERRIDE_BMS_SELECT1", "SELECT   a.order_id, b.order_catalog_code, d.in_formulary_yn,b.order_line_num, a.patient_id, c.patient_name,b.catalog_desc, b.order_qty, b.order_uom,(SELECT SUM (disp_qty) FROM ph_disp_dtl  WHERE order_id = a.order_id AND order_line_no = b.order_line_num  AND pres_drug_code = disp_drug_code and REISSUE_REASON_CODE is null) disp_qty,(SELECT MAX (disp_uom_code) FROM ph_disp_dtl  WHERE order_id = b.order_id  AND order_line_no = b.order_line_num  AND pres_drug_code = disp_drug_code) disp_qty_uom,(SELECT SUM (disp_qty) FROM ph_disp_dtl  WHERE order_id = b.order_id  AND order_line_no = b.order_line_num  AND pres_drug_code != disp_drug_code and REISSUE_REASON_CODE is null) alternate, (SELECT bms_qty FROM or_order_line_ph  WHERE order_id = b.order_id  AND order_line_num = b.order_line_num) bal_qty, (SELECT TO_CHAR (sm_convert_date(added_date,?), 'dd/mm/yyyy')  || ' ' || dispensed_by  FROM ph_disp_hdr  WHERE order_id = a.order_id  AND ROWID = (SELECT MAX (ROWID)  FROM ph_disp_hdr  WHERE order_id = a.order_id)) delivered_by , d.stock_uom bal_uom FROM or_order a, or_order_line b, mp_patient c, ph_drug d  WHERE a.order_id = b.order_id  AND b.order_catalog_code = d.drug_code  AND a.patient_id = c.patient_id  AND b.order_line_status NOT IN ('DF', 'IP', 'AL', 'CN', 'DC')  AND b.order_line_status = 'DP'  AND a.order_category = 'PH'  AND TO_DATE (b.modified_date, 'DD/MM/RRRR')  BETWEEN TO_DATE (?, 'DD/MM/RRRR')  AND TO_DATE (?, 'DD/MM/RRRR')  AND a.ordering_facility_id = ?  AND a.performing_deptloc_code = ? ORDER BY b.modified_date DESC");
		dataMap.put("SQL_PH_OVERRIDE_BMS_SELECT2","SELECT COUNT(*) TOTAL FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_STATUS!='DF'");
		dataMap.put("SQL_PH_OVERRIDE_BMS_SELECT3","SELECT A.DISP_DRUG_CODE,B.DRUG_DESC,B.STRENGTH_VALUE,B.STRENGTH_UOM,A.DISP_QTY,A.DISP_UOM_CODE FROM PH_DISP_DTL A, PH_DRUG_LANG_VW B WHERE A.DISP_DRUG_CODE=B.DRUG_CODE AND A.ORDER_ID=? AND A.ORDER_LINE_NO=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_OVERRIDE_BMS_SELECT4","SELECT STRENGTH_VALUE,STRENGTH_UOM FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_OVERRIDE_BMS_UPDATE1","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS='DF',MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_OVERRIDE_BMS_UPDATE2","UPDATE OR_ORDER SET ORDER_STATUS='DF',MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=?");
		// JNDI OverRide BMS
		dataMap.put("JNDI_PH_OVERRIDE_BMS", "java:comp/env/OverRideBMS");
		//Reissue Medication Starts 
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT1", "SELECT A.SHORT_DESC, A.DISP_LOCN_CODE FROM PH_DISP_LOCN_LANG_VW A, PH_DISP_RIGHTS B WHERE A.FACILITY_ID = ? AND B.FACILITY_ID=A.FACILITY_ID AND B.APPL_USER_ID = ? AND A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT2", "SELECT A.DISP_NO,to_char(A.DISP_DATE_TIME,'dd/mm/yyyy hh24:mi') DISP_DATE_TIME,A.ADDED_BY_ID,B.DISP_DRUG_CODE,C.DRUG_DESC, B.DISP_UOM_CODE, (B.DISP_QTY||' ' ||D.SHORT_DESC)DISP_QTY,A.PATIENT_ID,A.LOCN_CODE FROM PH_DISP_HDR A,PH_DISP_DTL B , PH_DRUG_LANG_VW C , AM_UOM_LANG_VW D WHERE A.FACILITY_ID = B.FACILITY_ID AND A.DISP_NO = B.DISP_NO AND B.DISP_DRUG_CODE=C.DRUG_CODE AND B.DISP_UOM_CODE = D.UOM_CODE AND A.FACILITY_ID=? AND A.DISP_LOCN_CODE = DECODE(?,'',A.DISP_LOCN_CODE,?) AND A.DISP_DATE_TIME = DECODE(?,'',A.DISP_DATE_TIME,?)AND B.DISP_DRUG_CODE = DECODE(?,'',B.DISP_DRUG_CODE,?)AND A.ORDER_ID = DECODE(?,'',A.ORDER_ID,?)AND A.ORD_DATE_TIME = DECODE(?,'',A.ORD_DATE_TIME,?)AND A.PATIENT_CLASS = DECODE(?,'',A.PATIENT_CLASS,?)AND A.LOCN_CODE = DECODE(?,'',A.LOCN_CODE,?)AND A.PATIENT_ID = DECODE(?,'',A.PATIENT_ID,?) AND C.LANGUAGE_ID = D.LANGUAGE_ID AND C.LANGUAGE_ID = ? ORDER BY A.DISP_DATE_TIME desc");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT3", "SELECT DISTINCT(order_id),LOCN_CODE  FROM PH_DISP_HDR  WHERE FACILITY_ID=? ORDER BY ORDER_ID");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT4", "SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE='R' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ");
        dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT5", "SELECT   x.order_id, x.order_line_no, x.disp_drug_code, x.disp_against_damage_yn, x.drug_desc, x.content_in_pres_base_uom, (x.disp_qty- CEIL((y.tot_administered_qty/x.content_in_pres_base_uom))) MAX_REISSUABLE_QTY, x.item_code, x.disp_uom_code, x.patient_class, x.unit_cost,         x.added_by_id, x.disp_locn_code, x.short_desc, x.ip_fill_prd_ahead, x.ip_fill_prd_unit, x.patient_name, x.sex, x.age, x.encounter_id, x.discharge_ind, x.ORDERING_FACILITY_ID, x.facility_id DISP_FACILITY_ID, x.facility_name,x.reissue_type_ind,x.reissue_count_by_ind,x.reissue_count,x.LABEL_CAU_INSTRN1_ENG, x.LABEL_CAU_INSTRN2_ENG, x.LABEL_SPL_INSTRN1_ENG, x.LABEL_SPL_INSTRN2_ENG, x.LABEL_PAT_INSTRN1_ENG, x.LABEL_CAU_INSTRN1_LOC, x.LABEL_CAU_INSTRN2_LOC, x.LABEL_SPL_INSTRN1_LOC, x.LABEL_SPL_INSTRN2_LOC, x.LABEL_PAT_INSTRN1_LOC FROM (SELECT a.order_id, a.order_line_no, a.disp_drug_code, a.ORDERING_FACILITY_ID, a.facility_id, b.disp_against_damage_yn, b.drug_desc, b.content_in_pres_base_uom, SUM(DECODE(a.reissue_reason_code, NULL, a.disp_qty, 0)) disp_qty, a.item_code, a.disp_uom_code, e.patient_class, d.unit_cost,  a.added_by_id, a.disp_locn_code, f.short_desc, f.ip_fill_prd_ahead, f.ip_fill_prd_unit, NVL (DECODE (?, 'en', g.patient_name, g.patient_name_loc_lang), g.patient_name) patient_name,  DECODE (g.sex, 'M', 'male', 'F', 'female', 'U', 'unknown') sex, get_age (g.date_of_birth) age, e.encounter_id encounter_id, decode(e.discharge_ind,'D','Y','N') discharge_ind, (select facility_name from sm_facility_param_lang_vw where facility_id = a.facility_id and language_id = 'en') facility_name,b.reissue_type_ind,b.reissue_count_by_ind,b.reissue_count,a.LABEL_CAU_INSTRN1_ENG, a.LABEL_CAU_INSTRN2_ENG, a.LABEL_SPL_INSTRN1_ENG, a.LABEL_SPL_INSTRN2_ENG, a.LABEL_PAT_INSTRN1_ENG, a.LABEL_CAU_INSTRN1_LOC, a.LABEL_CAU_INSTRN2_LOC, a.LABEL_SPL_INSTRN1_LOC, a.LABEL_SPL_INSTRN2_LOC, a.LABEL_PAT_INSTRN1_LOC  FROM ph_disp_dtl a,  ph_drug_lang_vw b, am_uom_lang_vw c, mm_item_lang_vw d, or_order e,ph_disp_locn_lang_vw f, mp_patient g,or_order_line h WHERE g.patient_id = e.patient_id and a.order_id =h.order_id and a.order_line_no =h.ORDER_LINE_NUM AND /* e.ordering_facility_id = ?  AND */ a.facility_id = f.facility_id AND a.disp_locn_code = f.disp_locn_code AND a.disp_drug_code = b.drug_code  AND a.disp_uom_code = c.uom_code  AND a.order_id = e.order_id  AND b.drug_code = d.item_code  AND b.disp_against_damage_yn = 'Y'  /* AND a.facility_id = ?  */ AND e.patient_id = ?  AND (a.added_date) BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + .99999  AND a.disp_drug_code = NVL (?, a.disp_drug_code) AND b.language_id = c.language_id   AND b.language_id = d.language_id  AND b.language_id = f.language_id   AND b.language_id = ? AND /* e.patient_class = ? AND  a.disp_locn_code = ? and */ h.order_line_status not in('DC','CN') AND trunc(h.end_date_time) >= trunc(sysdate) GROUP BY A.ORDER_ID,	 A.ORDER_LINE_NO, A.DISP_DRUG_CODE,a.FACILITY_ID, a.ORDERING_FACILITY_ID, B.DISP_AGAINST_DAMAGE_YN,  B.DRUG_DESC,b.content_in_pres_base_uom,b.reissue_type_ind,b.reissue_count_by_ind,b.reissue_count,  C.SHORT_DESC, A.ITEM_CODE,A.DISP_UOM_CODE, E.PATIENT_CLASS, D.UNIT_COST,A.ADDED_BY_ID,  A.DISP_LOCN_CODE,   F.SHORT_DESC,  F.IP_FILL_PRD_AHEAD,   F.IP_FILL_PRD_UNIT,  G.PATIENT_NAME,g.patient_name_loc_lang,  G.SEX,  G.DATE_OF_BIRTH, E.ENCOUNTER_ID, E.discharge_ind,a.LABEL_CAU_INSTRN1_ENG, a.LABEL_CAU_INSTRN2_ENG, a.LABEL_SPL_INSTRN1_ENG, a.LABEL_SPL_INSTRN2_ENG, a.LABEL_PAT_INSTRN1_ENG, a.LABEL_CAU_INSTRN1_LOC, a.LABEL_CAU_INSTRN2_LOC, a.LABEL_SPL_INSTRN1_LOC, a.LABEL_SPL_INSTRN2_LOC, a.LABEL_PAT_INSTRN1_LOC) X,(SELECT orig_order_id, orig_order_line_no, NVL(tot_administered_qty,0) tot_administered_qty FROM ph_patient_drug_profile WHERE patient_id = ?) y WHERE Y.orig_order_id = x.order_id AND Y.orig_order_line_no = x.order_line_no");

		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT6", "SELECT  to_char(A.EXPIRY_DATE,'dd/mm/yyyy hh24:mi') EXPIRY_DATE , A.BATCH_ID, D.SHORT_NAME TRADE_NAME, E.SHORT_NAME MANU_NAME, C.BIN_LOCATION_CODE,(C.QTY_ON_HAND-C.COMMITTED_QTY)AVL_QTY FROM PH_DISP_DRUG_BATCH A ,PH_DISP_DTL B, ST_ITEM_BATCH C, AM_TRADE_NAME_LANG_VW D,AM_MANUFACTURER_LANG_VW E WHERE A.DISP_NO=B.DISP_NO AND A.SRL_NO=B.SRL_NO AND B.ITEM_CODE=C.ITEM_CODE AND D.TRADE_ID = C.TRADE_ID AND A.BATCH_ID = C.BATCH_ID AND E.MANUFACTURER_ID = D.MANUFACTURER_ID AND B.FACILITY_ID=? AND B.DISP_NO = ? AND B.SRL_NO = ? AND A.DRUG_CODE = ? AND D.LANGUAGE_ID = E.LANGUAGE_ID AND D.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT7", "SELECT NURSING_UNIT_CODE CODE, SHORT_DESC DESCRIPTION FROM IP_NURSING_UNIT  WHERE FACILITY_ID LIKE ? AND NURSING_UNIT_CODE LIKE ? AND SHORT_DESC LIKE ?");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT8", "SELECT CLINIC_CODE CODE, SHORT_DESC  DESCRIPTION FROM OP_CLINIC  WHERE FACILITY_ID LIKE ? AND CLINIC_CODE LIKE ? AND SHORT_DESC LIKE ?");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT9", "SELECT FACILITY_ID, DISP_NO, TO_CHAR(DISP_DATE_TIME,'dd/mm/yyyy hh24:mi')DISP_DATE_TIME, DISP_LOCN_CODE, ORDER_ID, TO_CHAR(ORD_DATE_TIME,'dd/mm/yyyy hh24:mi')ORD_DATE_TIME, PATIENT_ID, ENCOUNTER_ID, PATIENT_CLASS, LOCN_TYPE, LOCN_CODE, ROOM_TYPE, ROOM_NO, BED_NO, BED_CLASS, BED_TYPE, SPECIALITY_CODE, ATTEND_PRACTITIONER_ID, PRES_PHYSICIAN_ID, DISPENSED_BY, TO_CHAR(DISPENSED_DATE_TIME,'dd/mm/yyyy hh24:mi')DISPENSED_DATE_TIME, AUTHORIZED_BY, TO_CHAR(DISP_AUTHORIZED_DATE_TIME,'dd/mm/yyyy hh24:mi')DISP_AUTHORIZED_DATE_TIME, DELIVERED_YN, DELIVERED_BY, TO_CHAR(DELIVERED_DATE_TIME,'dd/mm/yyyy hh24:mi')DELIVERED_DATE_TIME, COLLECTED_BY, RECEIVED_YN, RECEIVED_BY, TO_CHAR(RECEIVED_DATE_TIME,'dd/mm/yyyy hh24:mi')RECEIVED_DATE_TIME, REF_DISP_NO_FOR_REISSUE, DISP_REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID  FROM ph_disp_hdr WHERE FACILITY_ID=? AND DISP_NO=?");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_UPDATE_HDR", "UPDATE PH_DISP_HDR SET REF_DISP_NO_FOR_REISSUE=? , DISP_REMARKS=? WHERE DISP_NO=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT10", "SELECT UNIT_COST FROM MM_ITEM WHERE ITEM_CODE=? AND EFF_STATUS = 'E' ");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT11", "SELECT SUM(B.DISP_QTY) DISP_QTY,A.DISP_NO,TO_CHAR(A.DISPENSED_DATE_TIME,'DD/MM/YYYY HH24:MI') DISP_DATE,B.DISP_DRUG_CODE,C.DRUG_DESC,D.REASON_DESC FROM PH_DISP_HDR A,PH_DISP_DTL B,PH_DRUG_LANG_VW C,PH_MEDN_TRN_REASON D WHERE B.ORDER_ID=? AND B.ORDER_LINE_NO=? AND D.APPL_TRN_TYPE='R' AND D.REASON_CODE=B.REISSUE_REASON_CODE  AND B.REISSUE_REASON_CODE IS NOT NULL AND B.DISP_DRUG_CODE=C.DRUG_CODE AND B.DISP_NO=A.DISP_NO AND A.FACILITY_ID=B.FACILITY_ID AND C.LANGUAGE_ID = ? GROUP BY B.DISP_QTY,A.DISP_NO,A.DISPENSED_DATE_TIME,B.DISP_DRUG_CODE,C.DRUG_DESC,D.REASON_DESC ORDER BY DISP_NO");
		//dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT12", "SELECT A.DRUG_CODE code,A.DRUG_DESC description FROM PH_DRUG A WHERE upper(A.DRUG_CODE) like upper(?) AND upper(A.DRUG_DESC) like upper(?) AND A.DISP_AGAINST_DAMAGE_YN='Y' ORDER BY 2");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT12", "SELECT A.DRUG_CODE code,A.DRUG_DESC description FROM PH_DRUG A WHERE upper(A.DRUG_CODE) like upper(?) AND upper(A.DRUG_DESC) like upper(?) AND A.DISP_AGAINST_DAMAGE_YN='Y' AND A.DRUG_YN='Y' ORDER BY 2");//modified ML-MMOH-SCF-0389 by Chithra
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT13"," SELECT DISP_NO FROM PH_DISP_HDR WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_REISSUE_MEDICATION_SELECT14"," SELECT TO_CHAR(TRUNC(SYSDATE)-7,'DD/MM/YYYY') FRM_DATE FROM DUAL");
	
		dataMap.put("SQL_PH_REISSUE_MEDICATION_UPDATE1", "UPDATE PH_PATIENT_DRUG_PROFILE SET REISSUED_QTY=(NVL(REISSUED_QTY,0)+?), REISSUE_DATE_TIME=SYSDATE, REISSUE_REASON_CODE=? WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		//Reissue Medication Ends
		//Common Query to check patient id length for all functions
		dataMap.put("SQL_PH_COMMON_SELECT1","SELECT PATIENT_ID_LENGTH FROM MP_PARAM WHERE MODULE_ID='MP'");
		dataMap.put("SQL_PH_COMMON_SELECT2","SELECT A.CITIZEN_NATIONALITY_CODE,B.LONG_DESC FROM MP_PARAM A,MP_COUNTRY_LANG_VW B WHERE A.CITIZEN_NATIONALITY_CODE=B.COUNTRY_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_COMMON_SELECT3","SELECT COUNTRY_CODE, LONG_NAME SHORT_NAME FROM MP_COUNTRY_LANG_VW MP_COUNTRY WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY SHORT_NAME");
		dataMap.put("SQL_PH_COMMON_SELECT4","SELECT  REASON_DESC FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE=? AND REASON_CODE=? AND EFF_STATUS='E' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_COMMON_SELECT5","SELECT to_char(SYSDATE+(1/1440),'dd/mm/yyyy hh24:mi') SYS_DATE FROM DUAL");
		dataMap.put("SQL_PH_COMMON_SELECT6","SELECT COUNT(*) COUNT,TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI') SYS_DATE FROM DUAL WHERE (SYSDATE > TO_DATE(?,'DD/MM/YYYY HH24:MI'))");
		// Sliding Scale Queried starts
		dataMap.put("SQL_PH_SLIDING_SCALE_SELECT1","SELECT REMARK_CODE, REMARK_DESC FROM PH_PRES_REMARK_LANG_VW PH_PRES_REMARK WHERE FORM_CODE = ? AND ROUTE_CODE = ? AND APPL_SLIDING_SCALE_YN = 'Y' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_SLIDING_SCALE_SELECT2","SELECT A.APPL_SLIDING_SCALE_YN,A.SPLIT_DOSE_YN, A.TAPER_DOSE_YN FROM OR_ORDER_CATALOG A WHERE A.ORDER_CATALOG_CODE = ?");
		dataMap.put("SQL_PH_SLIDING_SCALE_SELECT3","SELECT A.FREQ_NATURE,A.FREQ_CODE, A.FREQ_DESC,A.REPEAT_DURN_TYPE, C.DURN_DESC  FROM AM_FREQUENCY_LANG_VW A,OR_FREQUENCY_SCOPE B,AM_DURATION_TYPE_LANG_VW C WHERE A.EFF_STATUS='E' AND B.FREQ_CODE=A.FREQ_CODE AND B.ORDER_CATEGORY='PH' AND (A.SCHEDULED_YN='Y' OR A.FREQ_NATURE='P' OR A.FREQ_NATURE='O') AND B.FREQ_SCOPE_YN='Y' AND C.DURN_TYPE(+) = A.REPEAT_DURN_TYPE AND A.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? ORDER BY FREQ_DESC");
		dataMap.put("SQL_PH_SLIDING_SCALE_SELECT4","SELECT A.QTY_UOM ,B.SHORT_DESC FROM OR_ORDER_CATALOG_BY_PTCL A,AM_UOM_LANG_VW B WHERE A.QTY_UOM = B.UOM_CODE AND A.ORDER_CATALOG_CODE = ? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_SLIDING_SCALE_SELECT5","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+1,'DD/MM/YYYY HH24:MI')  SCH_DATE_TIME FROM DUAL");
		// dispensed drugs report
		dataMap.put("SQL_DISP_DRUGS_REPORT_SELECT1", "SELECT  DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE DISP_LOCN_CATEGORY IN('I','B','O') AND DISP_LOCN_TYPE='P' AND EFF_STATUS='E' AND FACILITY_ID=? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_DISP_DRUGS_REPORT_SELECT2", "SELECT FILL_PROC_ID FROM PH_FILL_PROCESS_PARAM WHERE trunc(FILL_PROC_DATE_TIME) = to_date(?,'dd/mm/yyyy') ORDER BY FILL_PROC_ID asc");// modified by chithra for FillprocessId display  in Patient List - Fill List report
		//Dangerous drugs report
		dataMap.put("SQL_DANG_DRUGS_REPORT_SELECT1", "SELECT  DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE DISP_LOCN_CATEGORY IN('I','B','O') AND DISP_LOCN_TYPE='P' AND EFF_STATUS='E' AND FACILITY_ID=? AND LANGUAGE_ID =? ");
		//Disp Medication Delivery Filllist
		dataMap.put("SQL_DISP_MEDN_DEL_FILLLIST_PATIENT_SELECT" , "SELECT A.PATIENT_ID,E.LONG_DESC NURSING_UNIT,PATIENT_NAME,COUNT(DISTINCT A.ORDER_ID) ORDERS,GET_AGE(DATE_OF_BIRTH) AGE,DECODE (sex,'M', 'male','F', 'female','U', 'unknown') sex ,COUNTRY_CODE,SHORT_NAME NATIONALITY_DESC,C.NATIONAL_ID_NO,A.ENCOUNTER_ID,I.ADT_STATUS,k.BED_NUM BED_NO FROM OR_ORDER_LINE B,OR_ORDER A,MP_PATIENT C,MP_COUNTRY_LANG_VW D,IP_NURSING_UNIT_LANG_VW E,OR_ORDER_STATUS_CODE_LANG_VW F,PH_DISP_HDR_TMP G,PH_FILL_PROCESS_PARAM H ,PR_ENCOUNTER  I,  ph_drug j,ip_open_encounter k WHERE E.NURSING_UNIT_CODE=A.SOURCE_CODE AND E.FACILITY_ID=A.ORDERING_FACILITY_ID  AND I.facility_id = a.ordering_facility_id AND I.ENCOUNTER_ID =A.ENCOUNTER_ID and k.facility_id = a.ordering_facility_id  AND k.encounter_id = a.encounter_id AND C.PATIENT_ID=A.PATIENT_ID AND B.ORDER_ID=A.ORDER_ID AND C.NATIONALITY_CODE=D.COUNTRY_CODE(+) AND F.ORDER_STATUS_CODE=B.ORDER_LINE_STATUS   AND  B.ORDER_ID=G.ORDER_ID   AND H.FILL_PROC_ID=G.FILL_PROC_ID AND E.NURSING_UNIT_CODE = ? AND  F.ORDER_STATUS_TYPE ='35'  AND G.PATIENT_CLASS='IP' AND  A.PATIENT_CLASS='IP' AND b.order_catalog_code = j.drug_code  AND   PH_CHECK_ORD_DATE_DISPENSING(B.START_DATE_TIME,B.END_DATE_TIME,?,?,?,?,?)=1 AND   A.ORDER_CATEGORY='PH' AND G.FILL_PROC_ID=?   AND  H.PROC_TYPE=?  AND ph_disp_locn_appl_yn (a.orig_performing_deptloc_code,?, A.source_type, A.source_code, a.added_facility_id, A.performing_facility_id, A.PERFORMING_DEPTLOC_CODE, J.drug_class, J.drug_code, b.ORDER_TYPE_CODE, a.patient_class, a.priority, a.discharge_ind, decode(J.drug_yn,'Y','D','N','M'),a.iv_prep_yn,a.ORIG_PERFORMING_DEPTLOC_CODE, a.order_id, a.HOME_LEAVE_MEDN_YN, a.PATIENT_ID, a.ENCOUNTER_ID) = 'Y'  AND (B.END_DATE_TIME) >= TRUNC(SYSDATE)  AND E.LANGUAGE_ID = F.LANGUAGE_ID AND E.LANGUAGE_ID = ? AND D.LANGUAGE_ID(+) = ? GROUP BY   A.PATIENT_ID, PATIENT_NAME, DATE_OF_BIRTH, SEX,COUNTRY_CODE, SHORT_NAME,  C.NATIONAL_ID_NO,A.ENCOUNTER_ID,E.LONG_DESC,I.ADT_STATUS,k.BED_NUM ");//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_DISP_MEDN_DEL_FILLLIST_PAT_ORDER_SELECT" , "SELECT A.PRIORITY,A.IV_PREP_YN,E.LONG_DESC LOCATION,A.ORDER_ID,TO_CHAR(A.ORD_DATE_TIME,   'DD/MM/YYYY HH24:MI') ORD_DATE_TIME  ,F.PRACTITIONER_NAME,DECODE(A.ORDERING_FACILITY_ID,  A.PERFORMING_FACILITY_ID,'',G.FACILITY_NAME) FACILITY_NAME,F.PRACTITIONER_ID,F.PRACTITIONER_NAME,G1.ENCOUNTER_ID FROM    OR_ORDER_LINE B,  OR_ORDER A,IP_NURSING_UNIT_LANG_VW E  ,SM_FACILITY_PARAM_LANG_VW G,AM_PRACTITIONER_LANG_VW F,PH_DISP_HDR_TMP G1,PH_FILL_PROCESS_PARAM H WHERE  E.FACILITY_ID=A.ORDERING_FACILITY_ID AND B.ORDER_ID=A.ORDER_ID AND G.FACILITY_ID=A.ORDERING_FACILITY_ID AND A.ORD_PRACT_ID=F.PRACTITIONER_ID(+) AND  E.NURSING_UNIT_CODE=A.SOURCE_CODE AND B.ORDER_ID=G1.ORDER_ID   AND H.FILL_PROC_ID=G1.FILL_PROC_ID AND E.NURSING_UNIT_CODE = ? AND   A.PATIENT_ID = ? AND   PH_CHECK_ORD_DATE_DISPENSING(B.START_DATE_TIME,B.END_DATE_TIME,?,?,?,?,?)=1    AND B.ORDER_LINE_STATUS ='IP' AND A.PATIENT_CLASS='IP' AND A.ORDER_CATEGORY='PH'   AND A.PERFORMING_DEPTLOC_CODE = ? AND G1.FILL_PROC_ID = ? AND H.PROC_TYPE = ? 	 AND IV_PREP_YN IS NULL AND E.LANGUAGE_ID = G.LANGUAGE_ID AND E.LANGUAGE_ID = ? AND F.LANGUAGE_ID(+) = ? ");//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_DISP_MEDN_GET_PAT_ORDER_ENDDATETIME", "SELECT TO_CHAR(END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE_TIME FROM OR_ORDER_LINE WHERE ORDER_ID = ? AND ORDER_LINE_NUM = ?");
		dataMap.put("SQL_DISP_MEDN_DEL_FILLLIST_PAT_ORD_LINE_SELECT" , "SELECT H.PATIENT_ID,(SELECT WORKSHEET_ID FROM PH_DISP_HDR_TMP   WHERE ORDER_ID=A.ORDER_ID ) WORKSHEET_ID,B.STRENGTH_VALUE,(SELECT SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE=B.STRENGTH_UOM AND LANGUAGE_ID = ?) STRENGTH_UOM,  PH_GETMINDOSEDETAILS(B.DRUG_CODE, ?) MINDOSEDETAILS ,PH_ISDUPLICATEDRUG(B.DRUG_CODE, ? ) ISDUPLICATE, (SELECT DISP_QTY FROM PH_DISP_DTL_TMP WHERE ORDER_ID=A.ORDER_ID AND ORDER_LINE_NO=A.ORDER_LINE_NUM AND ROWNUM<2) ALLOC_QTY, B.DRUG_CODE,B.IN_FORMULARY_YN, H.IV_PREP_YN,  F.GENERIC_NAME,  B.DRUG_CLASS, B.DRUG_DESC,ph_get_ext_prod_drug_code(b.drug_code,?)EXTERNAL_PRODUCT_ID ,  A.ORDER_LINE_NUM ,A.ORDER_QTY, A.QTY_VALUE,   A.QTY_UNIT,   C.SHORT_DESC QTY_UNIT_DESC, I.FORM_DESC,  D.FREQ_DESC,   A.DURN_VALUE,   E.DURN_DESC,   TO_CHAR(A.START_DATE_TIME,   'DD/MM/RRRR') START_DATE_TIME,   TO_CHAR(A.END_DATE_TIME,   'DD/MM/RRRR') END_DATE_TIME,   A.ORDER_QTY PRES_QTY_VALUE, A.ORDER_UOM PRES_QTY_UOM,   G.ALLERGY_OVERRIDE_REASON,   G.DUPLICATE_DRUG_OVERRIDE_REASON,   G.DOSAGE_LIMIT_OVERRIDE_REASON,   G.ORDER_LINE_NUM,   A.ORDER_LINE_STATUS,   B.GENERIC_ID, NVL(PH_CALCULATEBALANCE(A.ORDER_ID,A.ORDER_LINE_NUM),(SELECT DISP_QTY FROM PH_DISP_DTL_TMP WHERE ORDER_ID=A.ORDER_ID AND ORDER_LINE_NO=A.ORDER_LINE_NUM AND ROWNUM<2))  BMS_QTY,A.ORDER_CATALOG_CODE,PH_DRUGDOSEINLIMIT(B.DRUG_CODE,?,A.QTY_VALUE,A.DURN_VALUE,A.ORDER_QTY) DRUG_DOSAGE_LIMIT, H.SOURCE_CODE,H.SOURCE_TYPE,H.ORDERING_FACILITY_ID,TO_CHAR(H.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') ORD_DATE_TIME, H.ORD_PRACT_ID  PERFORMING_PRACT_ID  #  FROM    OR_ORDER_LINE A,OR_ORDER H,PH_DRUG_LANG_VW B,OR_ORDER_LINE_PH G,AM_UOM_LANG_VW C,AM_FREQUENCY_LANG_VW D,AM_DURATION_TYPE_LANG_VW E,PH_GENERIC_NAME_LANG_VW F,OR_ORDER_STATUS_CODE_LANG_VW G1,PH_DISP_HDR_TMP G2,PH_DISP_DTL_TMP  G1,PH_FILL_PROCESS_PARAM H,PH_FORM_LANG_VW I  WHERE  H.ORDER_ID=A.ORDER_ID AND   A.ORDER_ID= G.ORDER_ID AND A.ORDER_LINE_NUM=G.ORDER_LINE_NUM  AND   A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.FORM_CODE=I.FORM_CODE AND B.FORM_CODE=I.FORM_CODE AND   G.PRES_QTY_UOM=C.UOM_CODE(+) AND   A.FREQ_CODE=D.FREQ_CODE(+) AND   A.DURN_TYPE=E.DURN_TYPE(+)  AND  F.GENERIC_ID=B.GENERIC_ID  AND   G1.ORDER_STATUS_CODE=A.ORDER_LINE_STATUS   AND A.ORDER_ID=G2.ORDER_ID    AND   A.ORDER_ID=G1.ORDER_ID   AND  A.ORDER_LINE_NUM=G1.ORDER_LINE_NO   AND   G1.ORDER_ID=G2.ORDER_ID   AND  H.FILL_PROC_ID=G2.FILL_PROC_ID  AND  PH_CHECK_ORD_DATE_DISPENSING(A.START_DATE_TIME,A.END_DATE_TIME, ?,?,?,?,?)=1   AND G2.FILL_PROC_ID=NVL( ? ,G2.FILL_PROC_ID)    AND  H.PROC_TYPE=NVL(?,PROC_TYPE)   AND  G1.ORDER_STATUS_TYPE = '35'    AND A.ORDER_ID = ?  AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = G1.LANGUAGE_ID AND B.LANGUAGE_ID = I.LANGUAGE_ID AND B.LANGUAGE_ID = G1.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND C.LANGUAGE_ID(+) = ? AND D.LANGUAGE_ID(+) = ? AND E.LANGUAGE_ID(+) = ?" );//Modify PH_CHECK_ORD_DATE_DISPENSING for COMMON-ICN-0120 [40745]
		dataMap.put("SQL_DISP_MEDN_SEL_BATCH_RECORDS", "SELECT ITEM_CODE, BATCH_ID, TO_CHAR(EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE, STORE_CODE, DISP_QTY, DISP_QTY_UOM, BIN_LOCATION_CODE,TRADE_ID FROM PH_DISP_DRUG_BATCH_TMP WHERE ORDER_ID=? AND ORDER_LINE_NUM=?" );



		dataMap.put("SQL_DISP_MEDN_SEL_DRUG_DTLS","SELECT ORDER_ID, ORDER_LINE_NO, PRES_DRUG_CODE, DISP_DRUG_CODE,DISP_QTY, DISP_UOM_CODE FROM   PH_DISP_DTL_TMP WHERE ORDER_ID=? AND ORDER_LINE_NO=?");

		dataMap.put("SQL_DISP_MEDN_SEL_ENC_ID","SELECT ENCOUNTER_ID FROM OR_ORDER WHERE ORDER_ID = ? AND PATIENT_ID = ?");
		dataMap.put("SQL_DISP_MEDN_SEL_DISP_QTY","SELECT SUM(DISP_QTY) TOT_DISPENSED FROM PH_DISP_DTL WHERE ORDER_ID=? AND ORDER_LINE_NO='1'");
		// TDM attributes
		dataMap.put("SQL_PH_TDM_SELECT1", "SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG_LANG_VW PH_DRUG WHERE DISCONTINUED_YN='N' AND APPL_TO_TDM_YN='Y' AND DRUG_CODE LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND NPB_DRUG_YN <>'Y' AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_TDM_SELECT2", "SELECT ORDER_CATALOG_CODE,SHORT_DESC FROM  OR_ORDER_CATALOG_LANG_VW OR_ORDER_CATALOG WHERE ORDER_CATEGORY='LB' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_TDM_SELECT3", "SELECT COUNT(*) COUNT FROM PH_TDM_ATTR WHERE DRUG_CODE =? AND AGE_GROUP_CODE=? ");
		dataMap.put("SQL_PH_TDM_SELECT4", "SELECT COUNT(*) COUNT FROM PH_TDM_ATTR_DTL WHERE DRUG_CODE =? AND AGE_GROUP_CODE=? AND SAMPLING_TYPE=? AND ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_PH_TDM_SELECT5", "SELECT DISTINCT A.DRUG_CODE,B.DRUG_DESC,A.AGE_GROUP_CODE,C.SHORT_DESC,c.MIN_AGE, c.MAX_AGE, c.AGE_UNIT,c.GENDER,C.AGE_UNIT_MAX FROM PH_TDM_ATTR A, PH_DRUG_LANG_VW B,AM_AGE_GROUP_LANG_VW C WHERE A.DRUG_CODE=B.DRUG_CODE AND A.AGE_GROUP_CODE=C.AGE_GROUP_CODE AND UPPER(A.DRUG_CODE) LIKE UPPER(?) AND UPPER(B.DRUG_DESC) LIKE UPPER(?) AND UPPER(A.AGE_GROUP_CODE) LIKE UPPER(?) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TDM_SELECT6", "SELECT A.DRUG_CODE, A.AGE_GROUP_CODE, c.MIN_AGE,c.MAX_AGE, c.AGE_UNIT, c.GENDER,c.age_unit_max ,A.STEADY_STATE_DURN, A.STEADY_STATE_DURN_TYPE, B.DRUG_DESC FROM PH_TDM_ATTR A, PH_DRUG_LANG_VW B,AM_AGE_GROUP C WHERE a.AGE_GROUP_CODE =c.AGE_GROUP_CODE and A.DRUG_CODE=? AND A.AGE_GROUP_CODE=? AND A.DRUG_CODE=B.DRUG_CODE AND B.LANGUAGE_ID = ?");		
		dataMap.put("SQL_PH_TDM_SELECT7", "SELECT A.SAMPLING_TYPE, A.ORDER_CATALOG_CODE, B.SHORT_DESC FROM PH_TDM_ATTR_DTL A,OR_ORDER_CATALOG_LANG_VW B WHERE A.ORDER_CATALOG_CODE=B.ORDER_CATALOG_CODE AND A.DRUG_CODE=? AND A.AGE_GROUP_CODE=? AND B.LANGUAGE_ID = ? ORDER BY B.SHORT_DESC"); 
		dataMap.put("SQL_PH_TDM_SELECT8", "SELECT  SAMPLING_TYPE,SAMPLING_TIME, SAMPLING_TIME_DURN_TYPE FROM PH_TDM_ATTR WHERE DRUG_CODE=? AND AGE_GROUP_CODE=? ");
        dataMap.put("SQL_PH_TDM_ATTR_CHECK_AGE_RANGE_OVERLAP", "SELECT 'Y'  EXISTS_YN FROM DUAL WHERE EXISTS ( SELECT 1 FROM AM_AGE_GROUP WHERE AGE_GROUP_CODE IN (SELECT DISTINCT AGE_GROUP_CODE FROM PH_TDM_ATTR WHERE DRUG_CODE = ? AND AGE_GROUP_CODE != ?) AND ( ( (? IS NULL) OR ( ? IS NOT NULL AND ( GENDER IS NULL OR GENDER = ? ))) AND ( ? BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR ?  BETWEEN MIN_AGE * DECODE(AGE_UNIT,'D',1,'M',30,'Y',360) AND MAX_AGE * DECODE(AGE_UNIT_MAX,'D',1,'M',30,'Y',360) OR min_age * DECODE (age_unit,'D', 1,'M', 30,'Y', 360) BETWEEN ? AND ? OR max_age * DECODE (age_unit_max,'D',1,'M',30,'Y',360) BETWEEN ? AND ? )))"); 


		dataMap.put("SQL_PH_TDM_DELETE1", "DELETE PH_TDM_ATTR_DTL WHERE DRUG_CODE=? AND AGE_GROUP_CODE=?"); 
		dataMap.put("SQL_PH_TDM_DELETE2", "DELETE PH_TDM_ATTR WHERE DRUG_CODE=? AND AGE_GROUP_CODE=?"); 
		dataMap.put("SQL_PH_TDM_INSERT1","INSERT INTO PH_TDM_ATTR (DRUG_CODE, AGE_GROUP_CODE, STEADY_STATE_DURN, STEADY_STATE_DURN_TYPE, SAMPLING_TYPE, SAMPLING_TIME, SAMPLING_TIME_DURN_TYPE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_TDM_INSERT2", "INSERT INTO PH_TDM_ATTR_DTL (DRUG_CODE, AGE_GROUP_CODE, SAMPLING_TYPE, ORDER_CATALOG_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("JNDI_PH_TDM_ATTRIBUTES", "java:comp/env/TDMAttributes");
		// TDM Transaction

		dataMap.put("SQL_PH_TDM_SELECT_REASON","SELECT REASON_CODE,REASON_DESC FROM PH_MEDN_TRN_REASON_LANG_VW PH_MEDN_TRN_REASON WHERE APPL_TRN_TYPE = 'TD' AND EFF_STATUS ='E' AND LANGUAGE_ID = ? ORDER BY REASON_DESC");
		dataMap.put("SQL_PH_TDM_SELECT_DRUG_PROFILE","SELECT B.DRUG_CODE,B.ORIG_ORDER_ID,B.ORIG_ORDER_LINE_NO,A.DRUG_DESC,B.PRES_PRACTITIONER_ID,D.FORM_DESC,C.FREQ_DESC,TO_CHAR(B.START_DATE,'DD/MM/YYYY HH24:MI') START_DATE,TO_CHAR(B.END_DATE,'DD/MM/YYYY HH24:MI') END_DATE,NVL(DECODE( B.PATIENT_CLASS,  'IP',  F.LONG_DESC,  'EA',  F.LONG_DESC,  E.LONG_DESC ),'') LOCATION FROM PH_DRUG_LANG_VW A, PH_PATIENT_DRUG_PROFILE B, AM_FREQUENCY_LANG_VW C, PH_FORM_LANG_VW D, OP_CLINIC_LANG_VW E,IP_NURSING_UNIT_LANG_VW F WHERE B.PATIENT_ID = ? AND A.DRUG_CODE=B.DRUG_CODE AND B.FORM_CODE=D.FORM_CODE AND A.APPL_TO_TDM_YN='Y' AND B.FREQ_CODE=C.FREQ_CODE AND B.LOCN_CODE=E.CLINIC_CODE(+) AND B.LOCN_CODE=F.NURSING_UNIT_CODE(+) AND B.FACILITY_ID=E.FACILITY_ID (+) AND B.FACILITY_ID = F.FACILITY_ID (+) AND  B.END_DATE > SYSDATE AND B.CANCEL_DATE_TIME IS NULL AND B.DISCONT_DATE_TIME IS  NULL AND B.ON_HOLD_DATE_TIME IS  NULL AND A.LANGUAGE_ID = C.LANGUAGE_ID AND A.LANGUAGE_ID = D.LANGUAGE_ID AND A.LANGUAGE_ID = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ? ORDER BY B.ORIG_ORDER_ID,B.ORIG_ORDER_LINE_NO");
        dataMap.put("SQL_PH_TDM_SELECT_POISINOUS_DRUG","SELECT A.DRUG_CODE DRUG_CODE, A.DRUG_DESC DRUG_DESC, B.ROUTE_DESC ROUTE_DESC,C.FORM_DESC FORM_DESC,B.ROUTE_COLOR FROM PH_DRUG_LANG_VW A,PH_ROUTE_LANG_VW B ,PH_FORM_LANG_VW C WHERE  A.APPL_TO_TDM_YN='Y' AND A.DISCONTINUED_YN='N' AND A.DRUG_TYPE='S'  AND A.ROUTE_CODE=B.ROUTE_CODE  AND A.FORM_CODE=C.FORM_CODE  AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = C.LANGUAGE_ID AND A.LANGUAGE_ID = ?");
	    dataMap.put("SQL_PH_TDM_SELECT_SELECT1","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY') syadte FROM DUAL ");
        dataMap.put("SQL_PH_TDM_SELECT_GENERIC","SELECT GENERIC_ID, GENERIC_NAME FROM PH_GENERIC_NAME_LANG_VW PH_GENERIC_NAME WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? order by GENERIC_NAME");
        dataMap.put("SQL_PH_TDM_SELECT_FORM","select FORM_CODE, FORM_DESC from  PH_FORM_LANG_VW PH_FORM WHERE EFF_STATUS='E' AND language_id = ? order by FORM_DESC");
   		
		dataMap.put("SQL_PH_TDM_SELECT_ORDER_DTLS","SELECT TO_CHAR(SCH_DATE_TIME,'DD/MM/YYYY') SCH_DATE,TO_CHAR(SCH_DATE_TIME,'HH24:MI') SCH_TIME,TO_CHAR(SCH_DATE_TIME,'DD/MM/YYYY hh24:mi') SCH_DATE_TIME, SCH_DOSAGE_QTY || '  ' || SCH_DOSAGE_UOM_CODE  DOSAGE,(SELECT DISTINCT B.ORDER_ID   FROM OR_ORDER_LINE_TDM_DTL B, OR_ORDER C, OR_ORDER_STATUS_CODE D   WHERE C.ORDER_CATEGORY = 'PH'   AND C.ORDER_TYPE_CODE = 'TDM'   AND C.PARENT_ORDER_ID = A.ORDER_ID  AND C.ORDER_ID = B.ORDER_ID  AND B.ORDER_LINE_NUM = A.ORDER_LINE_NUM   AND B.SCH_DOSE_DATE_TIME = A.SCH_DATE_TIME   AND D.ORDER_STATUS_CODE = C.ORDER_STATUS       AND D.ORDER_STATUS_TYPE <= 10)  OPEN_TDM_ORDER_ID    FROM    PH_MEDN_ADMIN A   WHERE  PATIENT_ID=?  AND  A.ORDER_ID=?  AND  ORDER_LINE_NUM=?  AND   SCH_DATE_TIME > (SELECT MIN(SCH_DATE_TIME) + DECODE(?,'D',(?),'H',(?/24),'M',(?/(24*60)))    FROM  PH_MEDN_ADMIN   WHERE  PATIENT_ID=?   AND  ORDER_ID=?  AND  ORDER_LINE_NUM=? )  ORDER BY SCH_DATE_TIME ");

		dataMap.put("SQL_PH_TDM_SELECT_ORDER_DTLS1","SELECT TO_CHAR (a.sch_dose_date_time,'dd/mm/yyyy hh24:mi') sch_date_time, TO_CHAR (a.sch_dose_date_time, 'DD/MM/YYYY') sch_dose_date,TO_CHAR (a.sch_dose_date_time, 'hh24:mi') sch_dose_time, a.order_catalog_code,a.sampling_type, a.sampling_durn, a.sampling_durn_type,b.short_desc  order_catalog_desc,a.sampling_time_ind sampling_indicator FROM or_order_line_tdm_dtl a, or_order_catalog_lang_vw b WHERE a.order_catalog_code = b.order_catalog_code AND a.ORDER_ID in ( SELECT ORDER_ID FROM OR_ORDER WHERE PARENT_ORDER_ID=? AND ORDER_TYPE_CODE='TDM') AND b.language_id = ?");

		dataMap.put("SQL_PH_TDM_SELECT_ORDER_DATE_TIME","SELECT ORDER_ID FROM OR_ORDER WHERE PARENT_ORDER_ID= ? ORDER BY ORD_DATE_TIME" );

		dataMap.put("SQL_PH_TDM_SELECT_ORDER_DTLS2B","select SCH_DOSAGE_QTY,SCH_DOSAGE_UOM_CODE from PH_MEDN_ADMIN where order_id=? and order_line_num=? and sch_date_time=to_date(?,'dd/mm/yyyy hh24:mi')");
		dataMap.put("SQL_PH_TDM_SELECT_ORDER_DTLS2","SELECT REASON_FOR_REQ_CODE,REMARKS,SMOKER_YN,ALCOHLIC_YN,PREGNANT_YN FROM OR_ORDER_LINE_TDM WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");


		//dataMap.put("SQL_PH_TDM_PRES_SELECT1","SELECT a.AGE_GROUP_CODE, NVL(a.SAMPLING_TYPE,'') SAMPLING_TYPE, NVL(a.SAMPLING_TIME,'') SAMPLING_TIME,  NVL(a.SAMPLING_TIME_DURN_TYPE,'') SAMPLING_TIME_DURN_TYPE,STEADY_STATE_DURN, STEADY_STATE_DURN_TYPE  FROM  PH_TDM_ATTR  A,AM_AGE_GROUP B, MP_PATIENT C  WHERE  a.DRUG_CODE=? AND c.patient_id =? AND trunc(sysdate - c.date_of_birth)   BETWEEN  decode(b.age_unit,'D',b.MIN_AGE,'M',b.MIN_AGE*30,'Y',MIN_AGE*360) AND  decode(b.age_unit_max,'D',b.MAX_AGE,'M',b.MAX_AGE*30,'Y',MAX_AGE*360) AND ( b.GENDER is null OR b.GENDER = c.sex ) AND b.age_group_code = a.age_group_code ");//Commented for ML-MMOH-SCF-0866
		dataMap.put("SQL_PH_TDM_PRES_SELECT1","SELECT a.AGE_GROUP_CODE, NVL(a.SAMPLING_TYPE,'') SAMPLING_TYPE, NVL(a.SAMPLING_TIME,'') SAMPLING_TIME,  NVL(a.SAMPLING_TIME_DURN_TYPE,'') SAMPLING_TIME_DURN_TYPE,STEADY_STATE_DURN, STEADY_STATE_DURN_TYPE  FROM  PH_TDM_ATTR  A,AM_AGE_GROUP B, MP_PATIENT C  WHERE  a.DRUG_CODE=? AND c.patient_id =? AND  ROUND (  (  TO_DATE (TO_CHAR (SYSDATE, 'dd/mm/yyyy hh24:mi'), 'dd/mm/yyyy hh24:mi' ) - TO_DATE (TO_CHAR (date_of_birth, 'dd/mm/yyyy hh24:mi'),'dd/mm/yyyy hh24:mi') ) * 24* 60)   BETWEEN  decode(b.age_unit,'N', min_age,'H', min_age * 60,'D', min_age * 24 * 60,'M', min_age * 30 * 24 * 60,'Y', min_age * 365 * 24 * 60) AND  decode(b.age_unit_max,'N', max_age, 'H', max_age * 60,'D', max_age * 24 * 60, 'M', max_age * 30 * 24 * 60, 'Y', max_age * 365 * 24 * 60) AND ( b.GENDER is null OR b.GENDER = c.sex ) AND b.age_group_code = a.age_group_code ");//Added for ML-MMOH-SCF-0866

		dataMap.put("SQL_PH_TDM_SAMPLE_TYPE_SELECT1","select distinct sampling_type, decode(sampling_type,'E','Extended','P','Peak','T','Trough','R','Random')  sampling_type_desc,decode(sampling_type,'T',1,'P',2,'R',3,'E',4)  sampling_type_seq  from ph_tdm_attr_dtl  where drug_code = ? order by sampling_type_seq");

		dataMap.put("SQL_PH_TDM_PRES_SELECT2","SELECT A.SAMPLING_TYPE,A.ORDER_CATALOG_CODE,B.SHORT_DESC FROM PH_TDM_ATTR_DTL A, OR_ORDER_CATALOG_LANG_VW B WHERE A.DRUG_CODE=? AND A.AGE_GROUP_CODE=? AND A.SAMPLING_TYPE = ? AND A.ORDER_CATALOG_CODE=B.ORDER_CATALOG_CODE AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TDM_PRES_SELECT3","SELECT VERIFY_TDM_ORDER_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID=? ");
		dataMap.put("SQL_PH_TDM_PRES_SELECT4","SELECT REGN_REQD_YN FROM OR_ORDER_TYPE WHERE ORDER_TYPE_CODE='TDM'");
		dataMap.put("SQL_PH_TDM_PRES_SELECT5","SELECT EPISODE_ID, OP_EPISODE_VISIT_NUM FROM PR_ENCOUNTER WHERE ENCOUNTER_ID=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_TDM_PRES_SELECT6","SELECT A.ORDER_CATALOG_CODE,B.DRUG_DESC FROM OR_ORDER_LINE A, PH_DRUG_LANG_VW B WHERE A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.ORDER_ID=? AND A.ORDER_LINE_NUM=?  AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TDM_PRES_INSERT1","INSERT INTO OR_ORDER_LINE_TDM (ORDER_ID, ORDER_LINE_NUM, REASON_FOR_REQ_CODE, SMOKER_YN, ALCOHLIC_YN, PREGNANT_YN,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID,MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,REMARKS) VALUES( ?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)"); 
		dataMap.put("SQL_PH_TDM_PRES_INSERT2","INSERT INTO OR_ORDER_LINE_TDM_DTL(ORDER_ID, ORDER_LINE_NUM, SCH_DOSE_DATE_TIME,ORDER_CATALOG_CODE, SAMPLING_TYPE, SAMPLING_DURN,SAMPLING_DURN_TYPE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, sampling_time_ind) VALUES(?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_TDM_PRESCRIPTION_SELECT_EXISTENCE","SELECT B.ORDER_ID, B.ORDER_LINE_NUM FROM OR_ORDER A, OR_ORDER_LINE B WHERE A.PATIENT_ID = ? AND A.ORDER_TYPE_CODE='TDM' AND A. ORDER_CATEGORY = 'PH' AND A.PATIENT_CLASS = 'IP' AND A.PARENT_ORDER_ID=? AND B.ORDER_ID=A.ORDER_ID AND B.ORDER_CATALOG_CODE = ?");
		dataMap.put("SQL_PH_TDM_ENDDATE_PEAK_RANDOM","SELECT TO_CHAR((CASE WHEN ? = 'D' THEN TO_DATE(?, 'DD/MM/RRRR HH24:MI') + (TO_NUMBER(?)) WHEN ?= 'H' THEN TO_DATE(?, 'DD/MM/RRRR HH24:MI') + (TO_NUMBER(?)/24) WHEN ? = 'M' THEN  TO_DATE(?, 'DD/MM/RRRR HH24:MI') + (TO_NUMBER(?)/(24*60)) END),'dd/mm/yyyy hh24:mi') START_DATE_TIME FROM DUAL");

		// ADR Transaction
		dataMap.put("SQL_PH_ADR_SELECT1", "SELECT A.ORIG_ORDER_ID,A.ORIG_ORDER_LINE_NO,A.IV_PREP_YN,A.DRUG_CODE ,C.DRUG_DESC,A.DISPENSED_DRUGS,F.ROUTE_DESC,A.DOSAGE||' '||G.SHORT_DESC||' , '||CHR(13)||DECODE(a.split_yn,'Y',NULL,H.FREQ_DESC||' , ')||CHR(13)||DURATION||' '||    I.DURN_DESC DOSAGE_DETAILS,TO_CHAR(A.START_DATE,'DD/MM/YYYY hh24:mi') START_DATE,TO_CHAR(A.END_DATE,'DD/MM/YYYY hh24:mi') END_DATE, A.PATIENT_CLASS,   D.PATIENT_NAME,E.PRACTITIONER_NAME,J.FACILITY_NAME,DECODE(P.ASSIGN_CARE_LOCN_TYPE, 'N',   L.LONG_DESC,'C',K.LONG_DESC) LOCATION,C.PRES_BASE_UOM,O.LAST_ACTION_REASON_DESC, A.HEIGHT,A.HEIGHT_UOM,A.WEIGHT,A.WEIGHT_UOM,A.PRESCRIBED_QTY,A.TOT_ISSUED_QTY,A.RETURNED_QTY,A.TOT_ADMINISTERED_QTY,A.DOSAGE_UOM_CODE,O.ORDER_UOM,R.ELAPSED_PRD_OF_ORD_FOR_ADR FROM PH_PATIENT_DRUG_PROFILE A, PH_GENERIC_NAME_LANG_VW B, PH_DRUG_LANG_VW C,MP_PATIENT D, AM_PRACTITIONER_LANG_VW E,PH_ROUTE_LANG_VW F,AM_UOM_LANG_VW G,AM_FREQUENCY_LANG_VW H,    AM_DURATION_TYPE_LANG_VW I, SM_FACILITY_PARAM_LANG_VW J,OP_CLINIC_LANG_VW K,IP_NURSING_UNIT_LANG_VW L ,OR_ORDER_LINE O, PR_ENCOUNTER P,OR_ORDER Q, PH_PARAM_LANG_VW R  WHERE  Q.ORDER_ID = O.ORDER_ID AND A.PATIENT_ID=? AND A.GENERIC_ID = B.GENERIC_ID  AND D.PATIENT_ID = A.PATIENT_ID AND A.DRUG_CODE = C.DRUG_CODE  AND E.PRACTITIONER_ID=A.PRES_PRACTITIONER_ID AND F.ROUTE_CODE = C.ROUTE_CODE  AND G.UOM_CODE = A.DOSAGE_UOM_CODE AND H.FREQ_CODE = A.FREQ_CODE  AND I.DURN_TYPE = A.DURN_TYPE AND J.FACILITY_ID = A.ORIG_FACILITY_ID AND K.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND K.CLINIC_CODE(+) = A.LOCN_CODE  AND L.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND L.NURSING_UNIT_CODE(+)= A.LOCN_CODE  AND A.ORIG_ORDER_ID=O.ORDER_ID AND A.ORIG_ORDER_LINE_NO=O.ORDER_LINE_NUM AND P.ENCOUNTER_ID=A.ENCOUNTER_ID AND P.FACILITY_ID=A.ORIG_FACILITY_ID AND A.END_DATE >= (SYSDATE - nvl(R.ELAPSED_PRD_OF_ORD_FOR_ADR,0))  AND CAN_DATE_TIME IS NULL AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = H.LANGUAGE_ID AND B.LANGUAGE_ID = I.LANGUAGE_ID AND B.LANGUAGE_ID = J.LANGUAGE_ID AND B.LANGUAGE_ID = R.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND K.LANGUAGE_ID(+) = ? AND L.LANGUAGE_ID(+) = ? ");


		dataMap.put("SQL_PH_ADR_SELECT1A", "SELECT A.ORIG_ORDER_ID,A.ORIG_ORDER_LINE_NO,A.IV_PREP_YN,A.DRUG_CODE ,C.DRUG_DESC,A.DISPENSED_DRUGS,F.ROUTE_DESC,A.DOSAGE||' '||G.SHORT_DESC||' , '||CHR(13)||DECODE(a.split_yn,'Y',NULL,H.FREQ_DESC||' , ')||CHR(13)||DURATION||' '||    I.DURN_DESC DOSAGE_DETAILS,TO_CHAR(A.START_DATE,'DD/MM/YYYY hh24:mi') START_DATE,TO_CHAR(A.END_DATE,'DD/MM/YYYY hh24:mi') END_DATE, A.PATIENT_CLASS,   D.PATIENT_NAME,E.PRACTITIONER_NAME,J.FACILITY_NAME,DECODE(P.ASSIGN_CARE_LOCN_TYPE, 'N',   L.LONG_DESC,'C',K.LONG_DESC) LOCATION,C.PRES_BASE_UOM,O.LAST_ACTION_REASON_DESC, A.HEIGHT,A.HEIGHT_UOM,A.WEIGHT,A.WEIGHT_UOM,A.PRESCRIBED_QTY,A.TOT_ISSUED_QTY,A.RETURNED_QTY,A.TOT_ADMINISTERED_QTY,A.DOSAGE_UOM_CODE,O.ORDER_UOM,R.ELAPSED_PRD_OF_ORD_FOR_ADR,A.GENERIC_ID FROM PH_PATIENT_DRUG_PROFILE A, PH_GENERIC_NAME_LANG_VW B, PH_DRUG_LANG_VW C,MP_PATIENT D, AM_PRACTITIONER_LANG_VW E,PH_ROUTE_LANG_VW F,AM_UOM_LANG_VW G,AM_FREQUENCY_LANG_VW H,    AM_DURATION_TYPE_LANG_VW I, SM_FACILITY_PARAM_LANG_VW J,OP_CLINIC_LANG_VW K,IP_NURSING_UNIT_LANG_VW L ,OR_ORDER_LINE O, PR_ENCOUNTER P,OR_ORDER Q, PH_PARAM_LANG_VW R  WHERE  Q.ORDER_ID = O.ORDER_ID AND A.PATIENT_ID=? AND A.GENERIC_ID = B.GENERIC_ID  AND D.PATIENT_ID = A.PATIENT_ID AND A.DRUG_CODE = C.DRUG_CODE  AND E.PRACTITIONER_ID=A.PRES_PRACTITIONER_ID AND F.ROUTE_CODE = C.ROUTE_CODE  AND G.UOM_CODE = A.DOSAGE_UOM_CODE AND H.FREQ_CODE = A.FREQ_CODE  AND I.DURN_TYPE = A.DURN_TYPE AND J.FACILITY_ID = A.ORIG_FACILITY_ID AND K.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND K.CLINIC_CODE(+) = A.LOCN_CODE  AND L.FACILITY_ID(+) = A.ORIG_FACILITY_ID AND L.NURSING_UNIT_CODE(+)= A.LOCN_CODE  AND A.ORIG_ORDER_ID=O.ORDER_ID AND A.ORIG_ORDER_LINE_NO=O.ORDER_LINE_NUM AND P.ENCOUNTER_ID=A.ENCOUNTER_ID AND P.FACILITY_ID=A.ORIG_FACILITY_ID AND A.END_DATE >= (SYSDATE - R.ELAPSED_PRD_OF_ORD_FOR_ADR) AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = E.LANGUAGE_ID AND B.LANGUAGE_ID = F.LANGUAGE_ID AND B.LANGUAGE_ID = G.LANGUAGE_ID AND B.LANGUAGE_ID = H.LANGUAGE_ID AND B.LANGUAGE_ID = I.LANGUAGE_ID AND B.LANGUAGE_ID = J.LANGUAGE_ID AND B.LANGUAGE_ID = R.LANGUAGE_ID AND B.LANGUAGE_ID = ? AND K.LANGUAGE_ID(+) = ? AND L.LANGUAGE_ID(+) = ?  ");
		//dataMap.put("SQL_PH_ADR_SELECT2", "SELECT A.ORDER_CATALOG_CODE,B.DRUG_DESC,B.GENERIC_ID,B.GENERIC_NAME,B.STRENGTH_VALUE,B.STRENGTH_UOM,B.ROUTE_DESC,B.FORM_DESC,A.QTY_VALUE,A.QTY_UNIT,A.FREQ_CODE,D.FREQ_DESC,A.DURN_VALUE,C.DURN_DESC,TO_CHAR(A.START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE,TO_CHAR(A.END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE FROM OR_ORDER_LINE A, PH_DRUG_VW_LANG_VW B,AM_DURATION_TYPE_LANG_VW C,AM_FREQUENCY_LANG_VW D WHERE A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.DURN_TYPE=C.DURN_TYPE AND A.FREQ_CODE=D.FREQ_CODE AND B.LANG1 = C.LANGUAGE_ID AND B.LANG1 = D.LANGUAGE_ID AND B.LANG1 = ? AND DECODE(B.LANG2,NULL,?,B.LANG2)= ? AND  DECODE(B.LANG3,NULL,?,B.LANG3)= ?");
		dataMap.put("SQL_PH_ADR_SELECT2", "SELECT  A.ORDER_CATALOG_CODE,B.DRUG_DESC,B.GENERIC_ID,B.GENERIC_NAME,B.STRENGTH_VALUE,PH_GET_UOM_DISPLAY(?, B.STRENGTH_UOM, ?) STRENGTH_UOM,B.ROUTE_DESC,B.FORM_DESC,A.QTY_VALUE,PH_GET_UOM_DISPLAY(?, A.QTY_UNIT, ?) QTY_UNIT,A.FREQ_CODE,D.FREQ_DESC,A.DURN_VALUE,C.DURN_DESC,TO_CHAR(A.START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE,TO_CHAR(A.END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE,j.ROUTE_COLOR FROM OR_ORDER_LINE A, PH_DRUG_VW_LANG_VW B,AM_DURATION_TYPE_LANG_VW C,AM_FREQUENCY_LANG_VW D,PH_ROUTE_LANG_VW J WHERE A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.DURN_TYPE=C.DURN_TYPE AND A.FREQ_CODE=D.FREQ_CODE  and B.ROUTE_CODE=J.ROUTE_CODE AND B.LANG1 = j.LANGUAGE_ID AND B.LANG1 = D.LANGUAGE_ID AND B.LANG1 = j.LANGUAGE_ID  AND B.LANG1 = ? AND DECODE(B.LANG2,NULL,?,B.LANG2)= ? AND  DECODE(B.LANG3,NULL,?,B.LANG3)= ?");
		dataMap.put("SQL_PH_ADR_SELECT2_EXTDRUG", "SELECT NVL (a.drug_code, a.ext_drug_code) order_catalog_code, nvl(b.drug_desc, a.drug_desc)drug_desc,  nvl(a.ext_generic_id, b.generic_id) generic_id, g.generic_name, b.strength_value, ph_get_uom_display (?, b.strength_uom, ?) strength_uom, b.route_desc, b.form_desc, TO_CHAR (a.start_date, 'DD/MM/YYYY HH24:MI') start_date, TO_CHAR (a.end_date, 'DD/MM/YYYY HH24:MI') end_date,j.ROUTE_COLOR FROM ph_patient_ext_drug_profile a, ph_drug_vw_lang_vw b, ph_generic_name_lang_vw g,PH_ROUTE_LANG_VW J WHERE a.patient_id = ? AND a.srl_no = ? AND a.drug_code = b.drug_code(+)  AND g.generic_id = nvl(a.ext_generic_id, b.generic_id)  and B.ROUTE_CODE=J.ROUTE_CODE(+) and g.LANGUAGE_ID = ? AND b.lang1(+) = ? AND DECODE (b.lang2, NULL, ?, b.lang2) = ? AND DECODE (b.lang3, NULL, ?, b.lang3) = ? and b.lang1=j.LANGUAGE_ID(+)");
		dataMap.put("SQL_PH_ADR_SELECT3", "SELECT B.SHORT_NAME, A.TRADE_CODE FROM PH_TRADE_NAME_FOR_DRUG A, AM_TRADE_NAME_LANG_VW B  WHERE A.TRADE_CODE=B.TRADE_ID AND A.DRUG_CODE=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ADR_SELECT4", "SELECT DIAG_TEXT FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_ADR_SELECT5", "SELECT WEIGHT, WEIGHT_UOM FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=?");
		dataMap.put("SQL_PH_ADR_SELECT6", "SELECT TO_CHAR(ADMIN_DATE_TIME,'DD/MM/YYYY HH24:MI') ADMIN_DATE_TIME FROM PH_MEDN_ADMIN WHERE ADMIN_RECORDED_YN='Y' AND ORDER_ID= ? AND ORDER_LINE_NUM= ? ORDER BY ADMIN_DATE_TIME");
		dataMap.put("SQL_PH_ADR_SELECT7", "SELECT QTY_VALUE,QTY_UNIT FROM OR_ORDER_LINE WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_ADR_SELECT8","SELECT A.ADMIN_BY,B.BATCH_ID, TO_CHAR(B.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE, B.TRADE_ID FROM PH_MEDN_ADMIN A, PH_MEDN_ADMIN_DTL B  WHERE A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND A.PATIENT_ID=? AND TRUNC(A.ADMIN_DATE_TIME,'MI')=TO_DATE(?,'DD/MM/YYYY HH24:MI') AND A.FACILITY_ID=B.FACILITY_ID AND A.ENCOUNTER_ID=B.ENCOUNTER_ID AND A.SCH_DATE_TIME=B.SCH_DATE_TIME AND A.ORD_DRUG_CODE=B.ORD_DRUG_CODE AND  A.DOSAGE_SEQ_NO=B.DOSAGE_SEQ_NO");
		dataMap.put("SQL_PH_ADR_SELECT9","SELECT CASE WHEN FLOOR(NO_OF_DAYS)>1 THEN FLOOR(NO_OF_DAYS) ||'|DAYS ' WHEN FLOOR(NO_OF_DAYS)>0 THEN FLOOR(NO_OF_DAYS) ||'|DAY ' WHEN FLOOR((NO_OF_DAYS-FLOOR(NO_OF_DAYS))*24)>1 THEN FLOOR((NO_OF_DAYS-FLOOR(NO_OF_DAYS))*24) ||'|HOURS '  WHEN FLOOR((NO_OF_DAYS-FLOOR(NO_OF_DAYS))*24)>0 THEN FLOOR((NO_OF_DAYS-FLOOR(NO_OF_DAYS))*24) ||'|HOUR'  WHEN FLOOR((NO_OF_DAYS*24-FLOOR(NO_OF_DAYS*24))*60)>1 THEN FLOOR( (NO_OF_DAYS*24-FLOOR(NO_OF_DAYS*24))*60)||'|MINUTES' ELSE FLOOR( (NO_OF_DAYS*24-FLOOR(NO_OF_DAYS*24))*60)||'|MINUTE' END DAY_COMP FROM(SELECT to_date(?,'dd/mm/yyyy hh24:mi') - to_date(?,'dd/mm/yyyy hh24:mi') NO_OF_DAYS FROM DUAL)");
		dataMap.put("SQL_PH_ADR_SELECT10","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+(?/(24*60)),'DD/MM/YYYY HH24:MI') ONSET_DATE FROM DUAL");
		dataMap.put("SQL_PH_ADR_SELECT11","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+(?/24),'DD/MM/YYYY HH24:MI') ONSET_DATE FROM DUAL");
		dataMap.put("SQL_PH_ADR_SELECT12","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')+(?),'DD/MM/YYYY HH24:MI') ONSET_DATE FROM DUAL");
		dataMap.put("SQL_PH_ADR_SELECT14","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')-(?/(24*60)),'DD/MM/YYYY HH24:MI') ADMIN_DATE FROM DUAL");
		dataMap.put("SQL_PH_ADR_SELECT15","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')-(?/24),'DD/MM/YYYY HH24:MI') ADMIN_DATE FROM DUAL");
		dataMap.put("SQL_PH_ADR_SELECT16","SELECT TO_CHAR(TO_DATE(?,'DD/MM/YYYY HH24:MI')-(?),'DD/MM/YYYY HH24:MI') ADMIN_DATE FROM DUAL");
		dataMap.put("SQL_PH_ADR_SELECT13","SELECT ADR_CODE, ADR_DESC FROM PH_ADR_TYPE_LANG_VW PH_ADR_TYPE WHERE EFF_STATUS='E' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_ADRDRUG_REACT", "SELECT LAST_ADR_NO+1 NEXTNO FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");
//		dataMap.put("SQL_PH_ADRDRUG_HDR_INSERT","INSERT INTO PR_ADV_DRUG_REACTION (ADR_NO,PATIENT_ID,DRUG_CODE,GENERIC_ID,TRADE_CODE,ADR_TYPE,ONSET_DATE_TIME,DURN_TO_ONSET_REACTION,DURN_TO_ONSET_REACTION_TYPE,EXTENT_OF_REACTION,DRUG_REACTION_RELATIONSHIP,REACTION_ON_STOP_OF_MEDN,REACTION_ON_REPETITION,ADDITIONAL_MEDN,OUTCOME,ADR_TREATMENT,RELEVANT_INVESTIGATION,RELEVANT_HISTORY,PREPARED_BY,VERIFIED_BY,PREPARED_DATE_TIME,SIGNED_BY,SIGNED_DATE_TIME,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ORDER_ID,ORDER_LINE_NUM,WEIGHT,DIAG_TXT,DOSAGE,ADMIN_BY,BATCH_ID,EXPIRY_DATE,MANUFACTURER,SUPPLIER,ADR_DESCRIPTION,ETHNIC_GROUP) VALUES (?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?)");
		dataMap.put("SQL_PH_ADRDRUG_HDR_INSERT","INSERT INTO PR_ADV_DRUG_REACTION (ADR_NO,PATIENT_ID,DRUG_CODE,GENERIC_ID,TRADE_CODE,ADR_TYPE,ONSET_DATE_TIME,DURN_TO_ONSET_REACTION,DURN_TO_ONSET_REACTION_TYPE,EXTENT_OF_REACTION,DRUG_REACTION_RELATIONSHIP,REACTION_ON_STOP_OF_MEDN,REACTION_ON_REPETITION,ADDITIONAL_MEDN,OUTCOME,ADR_TREATMENT,RELEVANT_INVESTIGATION,RELEVANT_HISTORY,PREPARED_BY,VERIFIED_BY,PREPARED_DATE_TIME,SIGNED_BY,SIGNED_DATE_TIME,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ORDER_ID,ORDER_LINE_NUM,WEIGHT,DIAG_TXT,DOSAGE,ADMIN_BY,BATCH_ID,EXPIRY_DATE,MANUFACTURER,SUPPLIER,ADR_DESCRIPTION,ETHNIC_GROUP,QA_DRUG_REACTION_RELATIONSHIP, ALLERGY_YN, ALLERGY_TYPE_CODE) VALUES (?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,TO_DATE(?,'DD/MM/YYYY HH24:MI'),?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,decode(?,null,'N','Y'),?)");
		dataMap.put("SQL_PH_ADRDRUG_DTL_INSERT","INSERT INTO PR_ADV_DRUG_REACTION_DTL (ADR_NO,OTH_DRUG_CODE,OTH_GENERIC_ID,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ORDER_ID,ORDER_LINE_NUM) VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_PH_ADR_FACILITY_PARAM_UPDATE","UPDATE PH_FACILITY_PARAM SET LAST_ADR_NO=? WHERE FACILITY_ID=?");
		dataMap.put("SQL_PH_ADRDRUG_SELECT_ADRNO","SELECT ADR_NO FROM PR_ADV_DRUG_REACTION WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_ADRDRUG_HDR_DELETE","DELETE FROM PR_ADV_DRUG_REACTION WHERE ADR_NO=?");
		dataMap.put("SQL_PH_ADRDRUG_DTL_DELETE","DELETE FROM PR_ADV_DRUG_REACTION_DTL WHERE ADR_NO=?");
		dataMap.put("SQL_PH_ADRDRUG_QUERY_SELECT","SELECT A.ORDER_ID ORDER_ID, A.ORDER_LINE_NUM ORDER_LINE_NUM, A.PATIENT_ID PATIENT_ID, A.ADR_NO ADR_NO,TO_CHAR(A.PREPARED_DATE_TIME,'DD/MM/YYYY HH24:MI') PREPARED_DATE_TIME,A.VERIFIED_BY VERIFIED_BY,A.SIGNED_BY SIGNED_BY,A.DRUG_CODE DRUG_CODE,A.ADR_TYPE ADR_TYPE, A.WEIGHT WEIGHT,B.DRUG_DESC DRUG_DESC, C.ADR_DESC ADR_DESC,A.ETHNIC_GROUP ETHNIC_GROUP FROM PR_ADV_DRUG_REACTION A, PH_DRUG_LANG_VW B, PH_ADR_TYPE_LANG_VW C WHERE A.DRUG_CODE = B.DRUG_CODE AND A.ADR_TYPE = C.ADR_CODE AND PATIENT_ID = NVL(?,PATIENT_ID) AND ADR_NO = NVL(?,ADR_NO) AND VERIFIED_BY = NVL(?,VERIFIED_BY) AND A.DRUG_CODE = NVL(?,A.DRUG_CODE) AND TRUNC(PREPARED_DATE_TIME) BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') AND B.LANGUAGE_ID = C.LANGUAGE_ID AND B.LANGUAGE_ID = ?");
		//dataMap.put("SQL_PH_ADRDRUG_DETAIL_SELECT","SELECT DISTINCT A.ORDER_CATALOG_CODE,B.DRUG_DESC,B.GENERIC_ID,B.GENERIC_NAME,B.STRENGTH_VALUE,B.STRENGTH_UOM,B.ROUTE_DESC,B.FORM_DESC,A.QTY_VALUE,A.QTY_UNIT,A.FREQ_CODE,D.FREQ_DESC,A.DURN_VALUE,C.DURN_DESC,TO_CHAR(A.START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE,TO_CHAR(A.END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE, F.TRADE_CODE FROM OR_ORDER_LINE A, PH_DRUG_VW_LANG_VW B,AM_DURATION_TYPE_LANG_VW C,AM_FREQUENCY_LANG_VW D,PR_ADV_DRUG_REACTION F WHERE A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.DURN_TYPE=C.DURN_TYPE AND A.FREQ_CODE=D.FREQ_CODE AND F.ORDER_ID = A.ORDER_ID AND B.LANG1 = C.LANGUAGE_ID AND B.LANG1 = D.LANGUAGE_ID AND B.LANG1 = ? AND DECODE(B.LANG2,NULL,?,B.LANG2) = ? AND DECODE(B.LANG3,NULL,?,B.LANG3) = ?");
		dataMap.put("SQL_PH_ADRDRUG_DETAIL_SELECT","SELECT DISTINCT A.ORDER_CATALOG_CODE,B.DRUG_DESC,B.GENERIC_ID,B.GENERIC_NAME,B.STRENGTH_VALUE,PH_GET_UOM_DISPLAY(?, B.STRENGTH_UOM, ?) STRENGTH_UOM,B.ROUTE_DESC,B.FORM_DESC,A.QTY_VALUE,PH_GET_UOM_DISPLAY(?, A.QTY_UNIT, ?) QTY_UNIT ,A.FREQ_CODE,D.FREQ_DESC,A.DURN_VALUE,C.DURN_DESC,TO_CHAR(A.START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATE,TO_CHAR(A.END_DATE_TIME,'DD/MM/YYYY HH24:MI') END_DATE, F.TRADE_CODE,j.ROUTE_COLOR FROM OR_ORDER_LINE A, PH_DRUG_VW_LANG_VW B,AM_DURATION_TYPE_LANG_VW C,AM_FREQUENCY_LANG_VW D,PR_ADV_DRUG_REACTION F, PH_ROUTE_LANG_VW J WHERE A.ORDER_ID=? AND A.ORDER_LINE_NUM=? AND A.ORDER_CATALOG_CODE=B.DRUG_CODE AND A.DURN_TYPE=C.DURN_TYPE AND A.FREQ_CODE=D.FREQ_CODE AND F.ORDER_ID = A.ORDER_ID  and B.ROUTE_CODE=J.ROUTE_CODE AND B.LANG1 = C.LANGUAGE_ID AND B.LANG1 = D.LANGUAGE_ID  AND B.LANG1 = j.LANGUAGE_ID AND B.LANG1 = ? AND DECODE(B.LANG2,NULL,?,B.LANG2) = ? AND DECODE(B.LANG3,NULL,?,B.LANG3) = ?");
		dataMap.put("SQL_PH_EXT_ADRDRUG_DETAIL_SELECT","SELECT NVL (a.drug_code, a.ext_drug_code) order_catalog_code, nvl(b.drug_desc, a.drug_desc)drug_desc,  nvl(a.ext_generic_id, b.generic_id) generic_id, g.generic_name, b.strength_value, ph_get_uom_display (?, b.strength_uom, ?) strength_uom, b.route_desc, b.form_desc, TO_CHAR (a.start_date, 'DD/MM/YYYY HH24:MI') start_date, TO_CHAR (a.end_date, 'DD/MM/YYYY HH24:MI') end_date, adr.trade_code,j.ROUTE_COLOR FROM ph_patient_ext_drug_profile a, ph_drug_vw_lang_vw b, ph_generic_name_lang_vw g, pr_adv_drug_reaction adr,PH_ROUTE_LANG_VW J WHERE a.patient_id = ? AND a.srl_no = ? AND adr.order_id = ? AND ADR.ADR_NO = ? AND a.drug_code = b.drug_code(+) AND g.generic_id = nvl(a.ext_generic_id, b.generic_id) and g.LANGUAGE_ID = ? AND b.lang1(+) = ? AND b.lang1 = J.LANGUAGE_ID(+)  and B.ROUTE_CODE=J.ROUTE_CODE(+) AND DECODE (b.lang2, NULL, ?, b.lang2) = ? AND DECODE (b.lang3, NULL, ?, b.lang3) = ?");
		dataMap.put("SQL_PH_ADRDRUG_CODES_SELECT","SELECT OTH_DRUG_CODE,ORDER_ID,ORDER_LINE_NUM FROM PR_ADV_DRUG_REACTION_DTL WHERE ADR_NO=?");
		dataMap.put("SQL_PH_ADRDRUG_HDR_SELECT","SELECT DOSAGE,BATCH_ID,MANUFACTURER,ADMIN_BY,TO_CHAR(EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,SUPPLIER,TO_CHAR(ONSET_DATE_TIME,'DD/MM/YYYY HH24:MI') ONSET_DATE_TIME,DURN_TO_ONSET_REACTION,DURN_TO_ONSET_REACTION_TYPE,ADR_TYPE,EXTENT_OF_REACTION,DRUG_REACTION_RELATIONSHIP,REACTION_ON_STOP_OF_MEDN,REACTION_ON_REPETITION,ADDITIONAL_MEDN,OUTCOME,ADR_TREATMENT,RELEVANT_INVESTIGATION,RELEVANT_HISTORY,PREPARED_BY,TO_CHAR(PREPARED_DATE_TIME,'DD/MM/YYYY HH24:MI') PREPARED_DATE_TIME,ADR_DESCRIPTION,ETHNIC_GROUP,QA_DRUG_REACTION_RELATIONSHIP,ALLERGY_YN, A.ALLERGY_TYPE_CODE,C.LONG_DESC ALLERGY_TYPE_DESC, B.CERTAINITY_USER_DESC QA_DRUG_REACTION_RELNSHIP_DESC FROM PR_ADV_DRUG_REACTION A, PH_ADR_CERTAINITY_LANG_VW B, MR_ALLERGY_TYPE_LANG_VW C WHERE ADR_NO=? AND A.QA_DRUG_REACTION_RELATIONSHIP = B.CERTAINITY_CODE(+) AND B.LANGUAGE_ID(+) = ? AND A.ALLERGY_TYPE_CODE = C.ALLERGY_TYPE_CODE(+) AND C.LANGUAGE_ID(+) = ?");
		dataMap.put("SQL_PH_ADRDRUG_HDR_SELECT1","SELECT DIAG_TXT FROM PR_ADV_DRUG_REACTION WHERE ADR_NO=?");
        //DIRECT DISPENSING
		dataMap.put("SQL_PH_DIR_DISP_SELECT1","select  CLINIC_CODE CODE, SHORT_DESC DESCRIPTION  FROM op_clinic  WHERE EFF_STATUS='E' AND UPPER(CLINIC_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) ORDER BY 2");	
		dataMap.put("SQL_PH_DIR_DISP_SELECT2","SELECT VISIT_DATE_TIME, ENCOUNTER_ID, PATIENT_CLASS, PRACTITIONER_ID, LOCN_CODE, LOCN_NAME,PRACT_NAME  FROM (SELECT  TO_CHAR(a.VISIT_ADM_DATE_TIME,'DD/MM/YYYY HH24:MI') VISIT_DATE_TIME,a.ENCOUNTER_ID ENCOUNTER_ID,A.PATIENT_CLASS PATIENT_CLASS,a.ATTEND_PRACTITIONER_ID PRACTITIONER_ID,a.ASSIGN_CARE_LOCN_CODE LOCN_CODE,b.LONG_DESC LOCN_NAME,C.PRACTITIONER_NAME PRACT_NAME,d.how_many_enctrs FROM  PR_ENCOUNTER a ,op_clinic_lang_vw b ,AM_PRACTITIONER_LANG_VW C ,ph_facility_param d WHERE  a.PATIENT_ID=? AND  A.ENCOUNTER_ID = NVL(?,A.ENCOUNTER_ID) and a.VISIT_STATUS <>99 and  A.ASSIGN_CARE_LOCN_TYPE ='C' and  a.facility_id=b.facility_id and  a.facility_id=d.facility_id and  a.ASSIGN_CARE_LOCN_CODE=b.CLINIC_CODE AND  C.PRACTITIONER_ID=a.ATTEND_PRACTITIONER_ID AND  ( (A.PATIENT_CLASS = decode( d.appl_pt_class, 'O', 'OP', 'E','EM','X','XT')) OR  (A.PATIENT_CLASS = decode( d.appl_pt_class,'B', 'OP')OR A.PATIENT_CLASS = decode( d.appl_pt_class,'B', 'EM')OR A.PATIENT_CLASS = decode( d.appl_pt_class,'B' ,'XT'))) and  b.facility_id=? and  b.EFF_STATUS='E' and  c.EFF_STATUS='E' AND    ( nvl(A.discharge_date_time,sysdate) = DECODE(d.appl_enctrs, 'O',sysdate) or NVL(a.discharge_date_time,SYSDATE) = decode(d.appl_enctrs, 'B', NVL(a.discharge_date_time,SYSDATE)) or  nvl(a.discharge_date_time,sysdate) != decode(d.appl_enctrs, 'C',sysdate) )AND b.language_id =c.language_id AND b.language_id = ? and 'Y' = OR_GET_ACCESS_RULE(a.facility_id,a.encounter_id,'PH',a.patient_class,to_char(a.VISIT_ADM_DATE_TIME,'DD/MM/YYYY HH24:MI'), to_char(a.DISCHARGE_DATE_TIME,'DD/MM/YYYY HH24:MI'), (SELECT to_char(DIS_ADV_DATE_TIME,'DD/MM/YYYY HH24:MI') FROM IP_DISCHARGE_ADVICE WHERE FACILITY_ID=a.facility_id and ENCOUNTER_ID=a.encounter_id AND DIS_ADV_STATUS in('0','1') and rownum <=1)) order by a.VISIT_ADM_DATE_TIME desc) WHERE rownum <=  HOW_MANY_ENCTRS");
		dataMap.put("SQL_PH_DIR_DISP_EDIT_INSTRUCTIONS","SELECT B.CAUTION_LABEL_TEXT_ID_1,B.CAUTION_LABEL_TEXT_ID_2, B.SPL_INSTR_LABEL_TEXT_ID,B.SPL_INSTR_LABEL_TEXT_ID1,B.HOW_TO_TAKE_TEXT FROM PH_DRUG_LANG_VW B  WHERE   B.DRUG_CODE=? AND B.LANGUAGE_ID  = ?");
		dataMap.put("SQL_PH_FACILITY_PARAM_DIR_DISP_SELECT","select DIR_DISP_ALLOWED,ENCTRS_DTLS_REQD_DUR_DIR_DISP from PH_FACILITY_PARAM WHERE FACILITY_id = ?");
		//added by karabi on 16/05/05
		dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_LINE_SELECT1","select IV_PREP_YN from or_order where order_id=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_LINE_SELECT2","select distinct a.encounter_id encounter_id,b.durn_value durn_value,to_char(b.start_date_time,'dd/mm/yyyy hh24:mi')start_date_time, b.order_catalog_code ORD_DRUG_CODE ,a.ORD_PRACT_ID PRACT_ID, b.route_code SCH_ROOUTE_CODE from or_order a, or_order_line b where a.order_id = b.order_id and a.order_id = ? and b.order_line_num = 2");
		dataMap.put("SQL_PH_DISP_MEDICATION_PH_PATIENT_DRUG_PROFILE_SELECT1","select b.FACILITY_ID,a.infusion_rate SCH_INFUSION_RATE,a.infusion_vol_str_unit SCH_INFUSION_VOL_STR_UNIT,a.infusion_per_unit SCH_INFUSION_PER_UNIT, a.infuse_over_unit SCH_INFUSION_PERIOD_UNIT, b.duration durations, b.IV_INGREDIENTS IV_INGREDIENTS, a.infuse_over SCH_INFUSION_PERIOD, b.dosage SCH_DOSAGE_QTY, b.dosage_uom_code, b.strength, b.strength_uom_code from or_order_line_ph a, ph_patient_drug_profile b where a.order_id = b.orig_order_id and a.order_line_num = b.orig_order_line_no and a.order_id = ? ");
		dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_LINE_FIELD_VALUES_SELECT1","select count(1) cnt from or_order_line_field_values where 	order_id = ? and order_line_field_mnemonic = 'SCHED_ADMIN_TIME'");	
		//dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_LINE_FIELD_VALUES_SELECT2","SELECT to_char(a.start_date_time + ? ,'dd/mm/yyyy') ||' '|| b.order_line_field_value sch_date_time  FROM or_order_line a, or_order_line_field_values b WHERE a.order_id = b.order_id AND a.order_id = ? AND b.order_line_field_mnemonic = 'SCHED_ADMIN_TIME' AND a.order_line_num = 2 ORDER BY b.order_line_seq_num"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_LINE_FIELD_VALUES_SELECT2","SELECT to_char(a.start_date_time + ? ,'dd/mm/yyyy') ||' '|| b.order_line_field_value sch_date_time  FROM or_order_line a, or_order_line_field_values b WHERE a.order_id = b.order_id AND a.order_id = ? AND b.order_line_field_mnemonic = 'SCHED_ADMIN_TIME' AND TO_DATE ((   TO_CHAR (a.start_date_time + ?, 'dd/mm/yyyy') ||' '|| b.order_line_field_value),'dd/mm/yyyy hh24:mi') > a.start_date_time AND TO_DATE ((   TO_CHAR (a.start_date_time + ?, 'dd/mm/yyyy') ||' '|| b.order_line_field_value),'dd/mm/yyyy hh24:mi' ) < a.end_date_time 	AND a.order_line_num = 2 ORDER BY b.order_line_seq_num"); 
		dataMap.put("SQL_PH_DISP_MEDICATION_PH_MEDN_ADMIN_DELETE","delete from ph_medn_admin where order_id=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_OR_ORDER_LINE_TPN_SELECT2","select distinct a.encounter_id encounter_id,b.durn_value durn_value,to_char(b.start_date_time,'dd/mm/yyyy hh24:mi')start_date_time, b.order_catalog_code ORD_DRUG_CODE ,b.qty_value,b.qty_unit,a.ORD_PRACT_ID PRACT_ID, b.route_code SCH_ROOUTE_CODE from or_order a, or_order_line b where a.order_id = b.order_id and a.order_id = ? and b.order_line_num = 1");
		dataMap.put("SQL_PH_DISP_MEDICATION_PH_PATIENT_DRUG_PROFILE_TPN_SELECT1","select b.FACILITY_ID,a.infusion_rate SCH_INFUSION_RATE,a.infusion_vol_str_unit SCH_INFUSION_VOL_STR_UNIT,a.infusion_per_unit SCH_INFUSION_PER_UNIT, a.infuse_over_unit SCH_INFUSION_PERIOD_UNIT, b.duration durations, b.IV_INGREDIENTS IV_INGREDIENTS, a.infuse_over SCH_INFUSION_PERIOD, b.dosage SCH_DOSAGE_QTY, b.dosage_uom_code, b.strength, b.strength_uom_code from or_order_line_ph a, ph_patient_drug_profile b where a.order_id = b.orig_order_id and a.order_line_num = b.orig_order_line_no and a.order_id = ? and a.order_line_num =1");
		dataMap.put("SQL_PH_DISP_MEDICATION_AM_FREQ_SELECT","SELECT DECODE (INSTR (a.qty_value, '.'),0, TO_CHAR (a.qty_value),RTRIM (TO_CHAR (a.qty_value, '9999999990.00000000'),'0'))  qty_value,QTY_UNIT,TO_CHAR(A.START_DATE_TIME,'DD/MM/YYYY HH24:MI')START_DATE_TIME, A.FREQ_CODE, A.DURN_VALUE,  DURN_DESC DURN_TYPE, TO_CHAR(A.END_DATE_TIME,'DD/MM/YYYY HH24:MI')  END_DATE_TIME,B.FREQ_DESC ,d.drug_yn drug_yn,e.SLIDING_SCALE_YN FROM OR_ORDER_LINE  A,AM_FREQUENCY_LANG_VW B , am_duration_type_lang_vw c,ph_drug d,or_order_line_ph e WHERE  A.FREQ_CODE=B.FREQ_CODE and a.DURN_TYPE =c.DURN_TYPE and b.language_id =c.LANGUAGE_ID  and a.order_catalog_code =d.Drug_code and a.order_id =e.order_id  AND a.ORDER_LINE_NUM  = e.ORDER_LINE_NUM AND  a.ORDER_ID=? AND a.ORDER_LINE_NUM=? AND B.LANGUAGE_ID = ?");

        dataMap.put("SQL_PH_AM_PRACTITIONER_SELECT","SELECT  PRACTITIONER_ID CODE, PRACTITIONER_NAME DESCRIPTION  FROM AM_PRACTITIONER WHERE PRACTITIONER_ID IN (SELECT PRACTITIONER_ID FROM AM_PRACT_FOR_FACILITY WHERE UPPER(FACILITY_ID) LIKE UPPER(?)) AND UPPER(PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(PRACTITIONER_NAME) LIKE UPPER(?) AND EFF_STATUS='E'");

		dataMap.put("SQL_PH_MP_PATIENT_SELECT","SELECT A.PATIENT_NAME PATIENT_NAME,GET_AGE(DATE_OF_BIRTH) AGE, A.SEX SEX, A.ETHNIC_GRP_CODE  FROM MP_PATIENT A WHERE A.PATIENT_ID=?");
		dataMap.put("SQL_PH_AM_PRACT_TYPE_SELECT","SELECT  A.PRACT_TYPE, DESC_USERDEF PRACT_DESC FROM AM_PRACTITIONER A ,AM_PRACT_TYPE_LANG_VW B WHERE A.PRACT_TYPE=B.PRACT_TYPE AND PRACTITIONER_ID=? AND B.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_AM_ETHNIC_GROUP_SELECT","SELECT ETHNIC_GROUP_CODE, SHORT_DESC FROM MP_ETHNIC_GROUP_LANG_VW MP_ETHNIC_GROUP WHERE EFF_STATUS='E' AND LANGUAGE_ID =? ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_REQ_ENQ_SELECT","SELECT REQ_CAT_CODE, SHORT_DESC,SYSTEM_DEFINED_YN FROM PH_DRUG_REQ_ENQ_LANG_VW PH_DRUG_REQ_ENQ WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY SEQ_NO");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_DATE_DIFF_SELECT","SELECT DECODE(DAYS,0,'',DAYS) DD,DECODE(HOURS,0,'',HOURS) HH ,DECODE(MINUTES,0,'',MINUTES) MM, (CASE WHEN DAYS = 0 AND HOURS = 0 AND MINUTES = 0 THEN '' WHEN DAYS = 0 AND HOURS = 0 THEN MINUTES || 'MINUTES' WHEN DAYS = 0 AND MINUTES = 0 THEN HOURS || 'HOURS' WHEN HOURS = 0 AND MINUTES = 0 THEN DAYS || 'DAYS' WHEN MINUTES = 0 THEN DAYS || 'DAYS' || HOURS || 'HOURS' WHEN DAYS = 0 THEN HOURS || 'HOURS' || MINUTES || 'MINUTES' WHEN HOURS = 0 THEN DAYS || 'DAYS' || MINUTES || 'MINUTES' ELSE DAYS || 'DAYS' || HOURS || 'HOURS' || MINUTES || 'MINUTES' END) FULL FROM (SELECT FLOOR (NO_OF_DAYS) DAYS,FLOOR ((NO_OF_DAYS - FLOOR (NO_OF_DAYS)) * 24) HOURS, FLOOR ((NO_OF_DAYS * 24 - FLOOR (NO_OF_DAYS * 24)) * 60) MINUTES FROM (SELECT   TO_DATE (?,'DD/MM/YYYY HH24:MI')- TO_DATE (?, 'DD/MM/YYYY HH24:MI')NO_OF_DAYS FROM DUAL)) ");
		dataMap.put("SQL_PH_DRUG_INFO_REQUEST","SELECT REQ_CAT_CODE CODE, SHORT_DESC DESCRIPTION, SEQ_NO SEQUENCE, EFF_STATUS, SYSTEM_DEFINED_YN  FROM PH_DRUG_REQ_ENQ_LANG_VW PH_DRUG_REQ_ENQ WHERE UPPER(REQ_CAT_CODE ) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?)AND UPPER(SYSTEM_DEFINED_YN) LIKE UPPER(?) AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_HDR_SEQ_NO_SELECT","SELECT PH_DRUG_REQ_ENQ_NO.NEXTVAL||'/'||TO_CHAR(SYSDATE,'YYYY')SEQ_NO FROM DUAL");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_HDR_DTL_SELECT","SELECT A.INFO_CAT_CODE, A.SHORT_DESC, B.INFO_CODE, B.INFO_DESC FROM PH_DRUG_INFO_ENQ_HDR_LANG_VW A,PH_DRUG_INFO_ENQ_DTL_LANG_VW B WHERE A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND  A.INFO_CAT_CODE=B.INFO_CAT_CODE AND A.LANGUAGE_ID = B.LANGUAGE_ID AND A.LANGUAGE_ID = ? ORDER BY A.SEQ_NO,B.INFO_SEQ_NO"); 
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_REQ_DTL_INSERT","INSERT INTO PH_DRUG_ENQ_INFO_REQ_DTL  (ENQUIRY_NO, REQUEST_CAT_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)VALUES(?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		// End..
		//Drug Information Request
	    dataMap.put("SQL_PH_DRUG_INFO_ENQ_DUPLICATE_SELECT","SELECT COUNT(ROWID) COUNT FROM PH_DRUG_INFO_ENQ_HDR WHERE UPPER(INFO_CAT_CODE) LIKE UPPER(?)");
        dataMap.put("SQL_PH_DRUG_INFO_ENQ_DTL_DUPLICATE_SELECT","SELECT INFO_CODE FROM PH_DRUG_INFO_ENQ_DTL WHERE INFO_CAT_CODE like (?) and INFO_CODE in(?)");
        dataMap.put("SQL_PH_DRUG_INFO_ENQ_HDR_UPDATE","UPDATE PH_DRUG_INFO_ENQ_HDR SET SHORT_DESC=?, SEQ_NO=?, EFF_STATUS=?,MODIFIED_BY_ID =?, MODIFIED_DATE =SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE INFO_CAT_CODE=?");
        dataMap.put("SQL_PH_DRUG_INFO_ENQ_DTL_UPDATE1","UPDATE  PH_DRUG_INFO_ENQ_DTL  SET INFO_DESC=?, INFO_SEQ_NO=?, EFF_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO= ?, MODIFIED_FACILITY_ID= ? WHERE INFO_CAT_CODE=? AND INFO_CODE= ?");
		dataMap.put("SQL_PH_MP_PATIENT_SELECT","SELECT A.PATIENT_NAME PATIENT_NAME,GET_AGE(DATE_OF_BIRTH) AGE, A.SEX SEX, A.ETHNIC_GRP_CODE  FROM MP_PATIENT A WHERE A.PATIENT_ID=?");
		//****dataMap.put("SQL_PH_AM_PRACT_TYPE_SELECT","SELECT  A.PRACT_TYPE, DESC_USERDEF PRACT_DESC FROM AM_PRACTITIONER A ,AM_PRACT_TYPE B WHERE A.PRACT_TYPE=B.PRACT_TYPE AND PRACTITIONER_ID=?");
		dataMap.put("SQL_PH_AM_PRACT_TYPE_SELECT1","SELECT  PRACT_TYPE, DESC_USERDEF PRACT_DESC FROM AM_PRACT_TYPE_LANG_VW AM_PRACT_TYPE WHERE LANGUAGE_ID = ?");
		//dataMap.put("SQL_PH_AM_ETHNIC_GROUP_SELECT","SELECT ETHNIC_GROUP_CODE, SHORT_DESC FROM MP_ETHNIC_GROUP WHERE EFF_STATUS='E' ORDER BY 2");
		//*****dataMap.put("SQL_PH_DRUG_REQ_ENQ_SELECT","select REQ_CAT_CODE, SHORT_DESC,SYSTEM_DEFINED_YN from ph_drug_req_enq where EFF_STATUS='E' order by SEQ_NO");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_DATE_DIFF_SELECT","SELECT DECODE (days, 0, '', days) dd, DECODE (hours, 0, '', hours) hh,DECODE (minutes, 0, '', minutes) mm,(CASE WHEN days = 0 AND hours = 0 AND minutes = 0 THEN '' WHEN days = 0 AND hours = 0 THEN minutes || ' Mins' WHEN days = 0 AND minutes = 0 THEN hours || ' Hrs' WHEN hours = 0 AND minutes = 0 THEN days || ' Days' WHEN minutes = 0 THEN days || ' Days' ||' '|| hours || ' Hrs' WHEN days = 0 THEN hours || ' Hrs' ||' '|| minutes || ' Mins' WHEN hours = 0 THEN days || ' Days' ||' '|| minutes || ' Mins' ELSE days || ' Days' ||' '|| hours || ' Hrs' ||' '|| minutes || ' Mins'  END ) FULL FROM (SELECT FLOOR (no_of_days) days,FLOOR ((no_of_days - FLOOR (no_of_days)) * 24) hours,FLOOR ((no_of_days * 24 - FLOOR (no_of_days * 24)) * 60) minutes FROM (SELECT   TO_DATE (?,'DD/MM/YYYY HH24:MI' )- TO_DATE (?, 'DD/MM/YYYY HH24:MI')no_of_days FROM DUAL))");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_HDR_INSERT","INSERT INTO PH_DRUG_ENQ_INFO_HDR(ENQUIRY_NO, SOURCE_OF_REQUEST,SOURCE_OF_REQUEST_DESC, ENQUIRER_ID, ENQUIRER_NAME, ENQUIRER_TYPE_CODE, ENQUIRER_TYPE_DESC, ENQUIRER_OTH, REQUEST_PRIORITY, REQUEST_OTH, ENQUIRY_DATE_TIME, REQUEST_MODE, REQUEST_MODE_DESC, CONTACT_ADDR1, CONTACT_ADDR2, CONTACT_ADDR3, CONTACT_ADDR4, CONTACT_TEL, CONTACT_FAX, CONTACT_EMAIL, REPLY_ADDR1, REPLY_ADDR2, REPLY_ADDR3, REPLY_ADDR4, REPLY_TEL, REPLY_FAX, REPLY_EMAIL, REQUEST_DTLS, ENQUIRY_RECD_BY, PATIENT_ID, PATIENT_NAME, PATIENT_AGE, PATIENT_AGE_UNIT, PATIENT_GENDER, PATIENT_ETHNIC_GRP, ALLERGY_DRUG, ALLERGY_FOOD, ALLERGY_OTH, RESPONSE_DTLS, REMARKS, RESPONSE_DATE_TIME, REPLIED_BY, VERIFIED_BY, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,VERIFIED_DATE_TIME,RESPONDE_DAYS, RESPONSE_HOURS, RESPONSE_MINUTES,Confidential_YN,verify_remarks) VALUES (?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?)");
		//dataMap.put("SQL_PH_DRUG_ENQ_INFO_HDR_INSERT","INSERT INTO PH_DRUG_ENQ_INFO_HDR(ENQUIRY_NO, SOURCE_OF_REQUEST,SOURCE_OF_REQUEST_DESC, ENQUIRER_ID, ENQUIRER_NAME, ENQUIRER_TYPE_CODE, ENQUIRER_TYPE_DESC, ENQUIRER_OTH, REQUEST_PRIORITY, REQUEST_OTH, ENQUIRY_DATE_TIME, REQUEST_MODE, REQUEST_MODE_DESC, CONTACT_ADDR1, CONTACT_ADDR2, CONTACT_ADDR3, CONTACT_ADDR4, CONTACT_TEL, CONTACT_FAX, CONTACT_EMAIL, REPLY_ADDR1, REPLY_ADDR2, REPLY_ADDR3, REPLY_ADDR4, REPLY_TEL, REPLY_FAX, REPLY_EMAIL, REQUEST_DTLS, ENQUIRY_RECD_BY, PATIENT_ID, PATIENT_NAME, PATIENT_AGE, PATIENT_AGE_UNIT, PATIENT_GENDER, PATIENT_ETHNIC_GRP, ALLERGY_DRUG, ALLERGY_FOOD, ALLERGY_OTH, RESPONSE_DTLS, REMARKS, RESPONSE_DATE_TIME, REPLIED_BY, VERIFIED_BY, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,VERIFIED_DATE_TIME,RESPONDE_DAYS, RESPONSE_HOURS, RESPONSE_MINUTES) VALUES (?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_SOURCE_DTL_INSERT","INSERT INTO PH_DRUG_ENQ_INFO_SOURCE_DTL (ENQUIRY_NO, INFO_CATE_CODE, INFO_CODE, ADDED_BY_ID,ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_HDR_SEQ_NO_SELECT","SELECT PH_DRUG_REQ_ENQ_NO.NEXTVAL||'/'||TO_CHAR(SYSDATE,'YYYY')SEQ_NO FROM DUAL");
		//***dataMap.put("SQL_PH_DRUG_INFO_ENQ_HDR_DTL_SELECT","SELECT A.INFO_CAT_CODE, A.SHORT_DESC, B.INFO_CODE, B.INFO_DESC FROM PH_DRUG_INFO_ENQ_HDR A,PH_DRUG_INFO_ENQ_DTL B WHERE A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND  A.INFO_CAT_CODE=B.INFO_CAT_CODE ORDER BY A.SEQ_NO,B.INFO_SEQ_NO"); 
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_REQ_DTL_INSERT","INSERT INTO PH_DRUG_ENQ_INFO_REQ_DTL  (ENQUIRY_NO, REQUEST_CAT_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)VALUES(?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_REQ_HDR_SELECT","SELECT to_char(response_date_time,'dd/mm/yyyy hh24:mi')response_date_time1, verified_by, enquiry_no, to_char(enquiry_date_time,'dd/mm/yyyy hh24:mi')enquiry_date_time1,source_of_request, source_of_request_desc, request_priority, DECODE (request_priority,'U', 'urgent', 'I', 'Immediatewithin1to2hours','W', 'Inaweekstime','H', 'Within24Hours') req_priority_desc, enquirer_type_code, enquirer_type_desc FROM ph_drug_enq_info_hdr hdr WHERE enquiry_date_time BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + 0.99999 AND NVL (response_date_time, TO_DATE ('01/01/1472', 'DD/MM/YYYY')) BETWEEN NVL (TO_DATE (?, 'dd/mm/yyyy'),TO_DATE ('01/01/1472', 'dd/mm/yyyy')) AND   NVL (TO_DATE (?, 'dd/mm/yyyy'), TO_DATE ('31/12/5000', 'dd/mm/yyyy')) + 0.99999 AND NVL(source_of_request,'%') LIKE NVL (?, '%')  AND NVL(request_priority,'%') LIKE NVL (?, '%') AND NVL(enquirer_type_code,'%') LIKE NVL (?, '%') AND NVL(request_mode,'%') LIKE NVL (?, '%') AND enquiry_no BETWEEN NVL (?, '!') AND NVL (?, '~') "); 
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_REQ_HDR_SELECT1","SELECT to_char(hdr.response_date_time,'dd/mm/yyyy hh24:mi')response_date_time1, hdr.verified_by, hdr.enquiry_no,to_char(hdr.enquiry_date_time,'dd/mm/yyyy hh24:mi')enquiry_date_time1, hdr.source_of_request, hdr.source_of_request_desc, hdr.request_priority, DECODE (hdr.request_priority,'U', 'urgent','I', 'Immediatewithin1to2hours','W', 'Inaweekstime', 'H', 'Within24Hours') req_priority_desc, hdr.enquirer_type_code, hdr.enquirer_type_desc FROM ph_drug_enq_info_hdr hdr, ph_drug_enq_info_req_dtl dtl WHERE hdr.enquiry_date_time BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND   TO_DATE (?, 'DD/MM/YYYY')+ 0.99999 AND hdr.enquiry_no = dtl.enquiry_no AND NVL (hdr.response_date_time, TO_DATE ('01/01/1472', 'DD/MM/YYYY')) BETWEEN NVL (TO_DATE (?, 'dd/mm/yyyy'), TO_DATE ('01/01/1472', 'dd/mm/yyyy')) AND   NVL (TO_DATE (?, 'dd/mm/yyyy'),TO_DATE ('31/12/5000', 'dd/mm/yyyy')) + 0.99999 AND NVL(hdr.source_of_request,'%') LIKE NVL (?, '%') AND NVL(hdr.request_priority,'%') LIKE NVL (?, '%') AND NVL(hdr.enquirer_type_code,'%') LIKE NVL (?, '%') AND NVL(hdr.request_mode,'%') LIKE NVL (?, '%') AND hdr.enquiry_no BETWEEN NVL (?, '!') AND NVL (?, '~') AND dtl.request_cat_code = ?");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_REQ_HDR_SELECT2","SELECT hdr.enquiry_no, source_of_request, enquirer_id, enquirer_name,enquirer_type_code, enquirer_type_desc, enquirer_oth, request_priority, request_oth, to_char(hdr.enquiry_date_time,'dd/mm/yyyy hh24:mi')enquiry_date_time1, request_mode, contact_addr1, contact_addr2, contact_addr3, contact_addr4, contact_tel, contact_fax, contact_email, reply_addr1, reply_addr2, reply_addr3, reply_addr4, reply_tel, reply_fax, reply_email,request_dtls, enquiry_recd_by, patient_id, patient_name, patient_age, patient_age_unit, patient_gender, patient_ethnic_grp, allergy_drug, allergy_food, allergy_oth, response_dtls, remarks,to_char(hdr.response_date_time,'dd/mm/yyyy hh24:mi ')response_date_time1,replied_by, verified_by, to_char(hdr.verified_date_time,'dd/mm/yyyy hh24:mi')verified_date_time1, responde_days, response_hours, response_minutes,Confidential_YN,hdr.modified_facility_id ,REQUEST_MODE_DESC,SOURCE_OF_REQUEST_DESC FROM ph_drug_enq_info_hdr hdr WHERE  hdr.enquiry_no =?");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_REQ_DTL_SELECT1","select REQUEST_CAT_CODE from PH_DRUG_ENQ_INFO_REQ_DTL where ENQUIRY_NO=?");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_SOURCE_DTL_SELECT1","select INFO_CATE_CODE, INFO_CODE from PH_DRUG_ENQ_INFO_SOURCE_DTL where ENQUIRY_NO=?");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_HDR_UPDATE","UPDATE PH_DRUG_ENQ_INFO_HDR set SOURCE_OF_REQUEST=?,SOURCE_OF_REQUEST_DESC=?, ENQUIRER_ID=?, ENQUIRER_NAME=?,ENQUIRER_TYPE_CODE=?, ENQUIRER_TYPE_DESC=?, ENQUIRER_OTH=?, REQUEST_PRIORITY=?,REQUEST_OTH=?, ENQUIRY_DATE_TIME=to_date(?,'dd/mm/yyyy hh24:mi'), REQUEST_MODE=?, REQUEST_MODE_DESC=?,CONTACT_ADDR1=?, CONTACT_ADDR2=?, CONTACT_ADDR3=?, CONTACT_ADDR4=?, CONTACT_TEL=?, CONTACT_FAX=?, CONTACT_EMAIL=?, REPLY_ADDR1=?, REPLY_ADDR2=?, REPLY_ADDR3=?, REPLY_ADDR4=?, REPLY_TEL=?, REPLY_FAX=?, REPLY_EMAIL=?, REQUEST_DTLS=?, ENQUIRY_RECD_BY=?, PATIENT_ID=?, PATIENT_NAME=?, PATIENT_AGE=?, PATIENT_AGE_UNIT=?, PATIENT_GENDER=?, PATIENT_ETHNIC_GRP=?, ALLERGY_DRUG=?, ALLERGY_FOOD=?, ALLERGY_OTH=?, RESPONSE_DTLS=?, REMARKS=?, RESPONSE_DATE_TIME=to_date(?,'dd/mm/yyyy hh24:mi'), REPLIED_BY=?, VERIFIED_BY=?, VERIFIED_DATE_TIME=to_date(?,'dd/mm/yyyy hh24:mi'),MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, RESPONDE_DAYS=?, RESPONSE_HOURS=?, RESPONSE_MINUTES=? ,Confidential_YN =?,verify_remarks=? where Enquiry_no=?");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_REQ_DTL_DELETE","delete from PH_DRUG_ENQ_INFO_REQ_DTL where enquiry_no=?");
		dataMap.put("SQL_PH_DRUG_ENQ_INFO_SOURCE_DTL_DELETE","DELETE FROM PH_DRUG_ENQ_INFO_SOURCE_DTL WHERE ENQUIRY_NO=?");
		dataMap.put("JNDI_PH_DRUG_INFO_ENQUIRY","java:comp/env/DrugInfoEnquiry");
//Drug Information Request
		dataMap.put("SQL_PH_DRUG_INFO_REQ_INSERT","INSERT INTO PH_DRUG_REQ_ENQ (REQ_CAT_CODE, SHORT_DESC, SEQ_NO,EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ,SYSTEM_DEFINED_YN)  VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_DRUG_INFO_REQ_SELECT1","SELECT COUNT(ROWID) COUNT FROM PH_DRUG_REQ_ENQ WHERE SEQ_NO=?");
		dataMap.put("SQL_PH_DRUG_INFO_REQ_SELECT2","SELECT REQ_CAT_CODE, SHORT_DESC, SEQ_NO, EFF_STATUS  FROM PH_DRUG_REQ_ENQ WHERE UPPER(REQ_CAT_CODE ) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?)");
		dataMap.put("SQL_PH_DRUG_INFO_REQ_SELECT3","SELECT REQ_CAT_CODE  FROM PH_DRUG_REQ_ENQ WHERE SEQ_NO=? ");
        dataMap.put("SQL_PH_DRUG_INFO_REQ_UPDATE","UPDATE   PH_DRUG_REQ_ENQ  SET SHORT_DESC=?, SEQ_NO=?, EFF_STATUS=?,MODIFIED_BY_ID =?, MODIFIED_DATE =SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? ,SYSTEM_DEFINED_YN=? WHERE REQ_CAT_CODE=?");
		dataMap.put("SQL_PH_DRUG_INFO_REQ_SELECT","SELECT REQ_CAT_CODE CODE, SHORT_DESC DESCRIPTION, SEQ_NO ,SYSTEM_DEFINED_YN, EFF_STATUS  FROM PH_DRUG_REQ_ENQ WHERE UPPER(REQ_CAT_CODE ) LIKE UPPER(?)");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_HDR_COUNT_SELECT","SELECT COUNT(ROWID) COUNT FROM PH_DRUG_INFO_ENQ_HDR WHERE SEQ_NO=?");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_HDR_INSERT","INSERT INTO PH_DRUG_INFO_ENQ_HDR (INFO_CAT_CODE,SHORT_DESC, SEQ_NO, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)  VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_DTL_COUNT_SELECT","SELECT COUNT(ROWID) COUNT FROM PH_DRUG_INFO_ENQ_HDR WHERE INFO_SEQ_NO=?");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_DTL_INSERT","INSERT INTO PH_DRUG_INFO_ENQ_DTL (INFO_CAT_CODE, INFO_CODE, INFO_DESC, INFO_SEQ_NO, EFF_STATUS, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, ADDED_BY_ID) VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_DTL_SELECT","SELECT INFO_CODE CODE , INFO_DESC DESCRIPTION, INFO_SEQ_NO ,EFF_STATUS  FROM PH_DRUG_INFO_ENQ_DTL WHERE UPPER(INFO_CODE ) LIKE UPPER(?)");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_DTL_UPDATE","UPDATE  PH_DRUG_INFO_ENQ_DTL  SET INFO_DESC=?, INFO_SEQ_NO=?, EFF_STATUS=?,ADDED_DATE = SYSDATE, ADDED_AT_WS_NO=?, ADDED_FACILITY_ID= ?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO= ?, MODIFIED_FACILITY_ID= ? ,ADDED_BY_ID= ? WHERE INFO_CAT_CODE=? AND INFO_CODE= ?");
		dataMap.put("SQL_PH_DRUG_INFO_ENQ_QUERY_SELECT","SELECT A.INFO_CODE CODE, A.INFO_DESC DESCP , A.INFO_SEQ_NO SEQNO,A.EFF_STATUS EFF FROM PH_DRUG_INFO_ENQ_DTL_LANG_VW A ,PH_DRUG_INFO_ENQ_HDR B WHERE A.INFO_CAT_CODE = B.INFO_CAT_CODE AND UPPER(B.INFO_CAT_CODE ) LIKE UPPER(?) AND A.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_SYRINGE_FOR_ADMIX_SELECT","SELECT DISP_NO FROM PH_DISP_HDR A , OR_ORDER B WHERE A.ORDER_ID = B.ORDER_ID and A.PATIENT_ID=? AND B.IV_PREP_YN IN('2','4','6','8','0') AND TRUNC(A.DISP_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND A.PATIENT_CLASS=? ORDER BY A.DISP_NO");
		//Added bt karabi for Incident Report Form
		dataMap.put("SQL_PH_OP_CLINIC_SELECT","SELECT CLINIC_CODE LOCN_CODE, LONG_DESC SHORT_DESC FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE EFF_STATUS='E' AND CLINIC_TYPE='C' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_IP_NURSING_UNIT_SELECT","SELECT NURSING_UNIT_CODE LOCN_CODE,LONG_DESC SHORT_DESC FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT  WHERE EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY 2");
		dataMap.put("SQL_PH_CYTO_INCI_REPO_SELECT","SELECT (INCIDENT_SEQ_NO.NEXTVAL||'/'||to_char(sysdate,'yyyy'))Seq_No FROM DUAL");
		dataMap.put("SQL_PH_CYTO_INCI_REPO_INSERT","INSERT INTO PH_CYTO_INCI_REPO(INCIDENT_SEQ_NO, DRUG_CODE, DATE_OF_INCIDENT, LOCN_TYPE, LOCN_CODE, INCIDENT_REMARKS, CAUSE_OF_SPILAGE, OTHER_REMARKS, WITNESS_ID, DOSAGE_FORM, VOLUME, WEIGHT, WEIGHT_UOM, DATE_RET_PHARMACY, DATE_REPLACED, REPORTED_BY_ID,  REPORTED_REMARKS, CHECKED_BY_ID, DATE_OF_CHECK_REPO, EFF_STATUS, ADDED_BY_ID,  ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,  MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)VALUES(?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_CYTO_INCI_REPO_SELECT1","SELECT incident_seq_no, a.drug_code, b.drug_desc,(SELECT appl_user_name FROM sm_appl_user_lang_vw sm_appl_user WHERE appl_user_id = a.witness_id and language_id = ? ) witnessname, (SELECT appl_user_name FROM sm_appl_user_lang_vw sm_appl_user WHERE appl_user_id = a.reported_by_id AND language_id = ?) reporterName,(SELECT appl_user_name FROM sm_appl_user_lang_vw sm_appl_user WHERE appl_user_id = a.checked_by_id AND language_id = ?) CheckedBy, to_char(a.date_of_incident,'dd/mm/yyyy hh24:mi')DateOfIncident, a.locn_type, a.locn_code, incident_remarks, cause_of_spilage,other_remarks, witness_id, dosage_form, volume, weight, weight_uom, to_char(date_ret_pharmacy,'dd/mm/yyyy hh24:mi')dateRetPharmacy, to_char(date_replaced,'dd/mm/yyyy hh24:mi')dateReplaced, reported_by_id, reported_remarks,checked_by_id, to_char(date_of_check_repo,'dd/mm/yyyy hh24:mi')dateOfCheckRepo FROM ph_cyto_inci_repo a, ph_drug_lang_vw b, sm_appl_user_lang_vw e WHERE incident_seq_no = ? AND a.drug_code = b.drug_code  AND a.reported_by_id = e.appl_user_id AND b.language_id = e.language_id AND b.language_id = ?");
		dataMap.put("SQL_PH_CYTO_INCI_REPO_UPDATE","UPDATE PH_CYTO_INCI_REPO SET DRUG_CODE=?, DATE_OF_INCIDENT=to_date(?,'dd/mm/yyyy hh24:mi'), LOCN_TYPE=?,LOCN_CODE=?, INCIDENT_REMARKS=?, CAUSE_OF_SPILAGE=?, OTHER_REMARKS=?, WITNESS_ID=?, DOSAGE_FORM=?, VOLUME=?, WEIGHT=?, WEIGHT_UOM=?, DATE_RET_PHARMACY=to_date(?,'dd/mm/yyyy hh24:mi'), DATE_REPLACED=to_date(?,'dd/mm/yyyy hh24:mi'), REPORTED_BY_ID=?, REPORTED_REMARKS=?, CHECKED_BY_ID=?, DATE_OF_CHECK_REPO=to_date(?,'dd/mm/yyyy hh24:mi'),MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE INCIDENT_SEQ_NO=?");
        dataMap.put("SQL_PH_ONCOLOGY_INCIDENT_RESULT","SELECT /*+ NO_EXPAND */ CYTO.INCIDENT_SEQ_NO INCIDENT_SEQ_NO, CYTO.DRUG_CODE DRUG_CODE, DRUG.DRUG_DESC DRUG_DESC, TO_CHAR(CYTO.DATE_OF_INCIDENT,'DD/MM/YYYY') REPORTINGDATE, APPLUSER.APPL_USER_NAME REPORTED_BY_ID,LOCN.SHORT_DESC LOCATION,DECODE (CYTO.DOSAGE_FORM, 'P', 'PlasticBag', 'S', 'Syringe', 'D', 'DryPowder', 'L', 'LiquidinVial/Ampoule') DOSAGEFORM FROM PH_CYTO_INCI_REPO CYTO, PH_DRUG_LANG_VW DRUG, (SELECT NURS.LONG_DESC SHORT_DESC, FACILITY_ID, NURSING_UNIT_CODE LOCN_CODE, 'N' CL_TYPE FROM IP_NURSING_UNIT_LANG_VW NURS WHERE NURS.LANGUAGE_ID = ? UNION ALL SELECT CLINIC.LONG_DESC SHORT_DESC, FACILITY_ID, CLINIC_CODE LOCN_CODE, 'C' CL_TYPE FROM OP_CLINIC_LANG_VW CLINIC WHERE CLINIC.LANGUAGE_ID = ? UNION ALL SELECT DISP_LOCN.SHORT_DESC, FACILITY_ID, DISP_LOCN_CODE LOCN_CODE, 'P' CL_TYPE FROM PH_DISP_LOCN_LANG_VW DISP_LOCN WHERE DISP_LOCN.LANGUAGE_ID = ? ) LOCN,SM_APPL_USER APPLUSER WHERE CYTO.DATE_OF_INCIDENT BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + 0.99999 AND CYTO.DRUG_CODE = DRUG.DRUG_CODE AND CYTO.LOCN_TYPE = LOCN.CL_TYPE    AND CYTO.REPORTED_BY_ID = APPLUSER.APPL_USER_ID AND CYTO.LOCN_CODE = LOCN.LOCN_CODE AND CYTO.ADDED_FACILITY_ID = LOCN.FACILITY_ID  AND CYTO.DRUG_CODE BETWEEN NVL (?, '!') AND NVL (?,'~') AND CYTO.INCIDENT_SEQ_NO BETWEEN NVL (?, '!') AND NVL (?,'~') AND CYTO.REPORTED_BY_ID BETWEEN NVL (?, '!') AND NVL (?,'~') AND CYTO.LOCN_TYPE BETWEEN NVL (?, '!') AND NVL (?,'~') AND LOCN.LOCN_CODE BETWEEN NVL (?, '!') AND NVL (?, '~') AND DRUG.LANGUAGE_ID = ? ORDER BY CYTO.INCIDENT_SEQ_NO DESC");
		dataMap.put("SQL_PH_DRUG_PRACTITIONER_JOB_TITLE","SELECT DISTINCT  PRACT_TYPE ,DESC_SYSDEF FROM AM_PRACT_TYPE_LANG_VW AM_PRACT_TYPE WHERE EFF_STATUS='E' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_BAL_HAND_SELECT","SELECT DISP_LOCN_CODE,SHORT_DESC FROM PH_DISP_LOCN WHERE EFF_STATUS='E' AND FACILITY_ID=?  AND DISP_LOCN_TYPE IN ('P', 'C')");
		dataMap.put("SQL_QUERY_SELECT_WRKSHT_1","SELECT A.WORKSHEET_ID WORKSHEET_ID,TO_CHAR(A.PREP_DATE_TIME,'DD/MM/YYYY HH24:MI') PREP_DATE_TIME, WS_PREP_BY ,B.ORDER_STATUS FROM PH_WORKSHEET_HDR A, OR_ORDER B WHERE A.FACILITY_ID = ? AND A.DISP_LOCN = ? AND A.PREP_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY')+1 AND B.ORDER_ID = A.ORDER_ID AND B.PATIENT_CLASS = ? ");
		dataMap.put("SQL_QUERY_SELECT_WRKSHT_2","SELECT A.TPN_WORKSHEET_ID WORKSHEET_ID,TO_CHAR(A.PREP_DATE_TIME,'DD/MM/YYYY HH24:MI') PREP_DATE_TIME, WS_PREP_BY ,B.ORDER_STATUS FROM PH_TPN_WORKSHEET_HDR A, OR_ORDER B WHERE A.FACILITY_ID = ? AND A.DISP_LOCN_CODE = ? AND A.PREP_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY')+1 AND B.ORDER_ID = A.ORDER_ID AND B.PATIENT_CLASS = ? ");
		dataMap.put("SQL_QUERY_SELECT_WORKLOAD"," SELECT NVL(COUNT(*),0) FROM PH_DLY_DISP_WORKLOAD WHERE DISPENSER_ID = ? ");
		dataMap.put("SQL_PH_REPORT_DISP_LOCATION", "SELECT DISP_LOCN_CODE, SHORT_DESC FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE EFF_STATUS='E' and facility_id =? AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_REPORT_TRADE_NAME_FOR_DRUG","SELECT B.TRADE_ID TRADE_CODE, A.SHORT_NAME SHORT_NAME FROM AM_TRADE_NAME_LANG_VW A,mm_trade_name_for_item B WHERE A.TRADE_ID=B.TRADE_ID AND A.EFF_STATUS='E' AND b.item_code=? AND A.LANGUAGE_ID =? ORDER BY A.SHORT_NAME");
		dataMap.put("SQL_PH_TAPER_DRUG_DTLS_1","SELECT DRUG_DESC FROM PH_DRUG_LANG_VW PH_DRUG WHERE DRUG_CODE = ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_TAPER_DRUG_DTLS_2","SELECT A.DOSAGE, PH_GET_UOM_DISPLAY(?,A.DOSAGE_UOM_CODE,? ) DOSAGE_UOM, B.FREQ_DESC, TO_CHAR(A.START_DATE,'DD/MM/YYYY HH24:MI') START_DATE, TO_CHAR(A.END_DATE,'DD/MM/YYYY HH24:MI') END_DATE FROM PH_PATIENT_DRUG_PROFILE A, AM_FREQUENCY_LANG_VW B WHERE A.PATIENT_ID = ? AND A.DRUG_CODE = ? AND A.ORIG_ORDER_ID in (SELECT b.order_id FROM or_order b where B.TRN_GROUP_REF = (select TRN_GROUP_REF from or_order WHERE order_id = ?) ) AND A.FREQ_CODE=B.FREQ_CODE AND B.LANGUAGE_ID = ? ORDER BY A.ORIG_ORDER_ID, A.ORIG_ORDER_LINE_NO");

        //Task List
		dataMap.put("SQL_PH_TASK_LIST_SELECT1","SELECT   f.disp_fill_stage disp_fill_stage,a.ord_pract_id ord_pract_id,a.priority priority, a.iv_prep_yn iv_prep_yn,(CASE WHEN a.iv_prep_yn IS NULL THEN 'Normal Rx' WHEN a.iv_prep_yn IN (1, 2) THEN (SELECT iv_drug_fluid_continuous_lg FROM ph_param) WHEN a.iv_prep_yn IN (3, 4) THEN (SELECT iv_drug_fluid_intermittent_lg FROM ph_param) WHEN a.iv_prep_yn = 5 THEN (SELECT iv_without_additives_lg FROM ph_param) WHEN a.iv_prep_yn = 6 THEN 'Compounding Rx' WHEN a.iv_prep_yn = 7 THEN 'TPN Standard' WHEN a.iv_prep_yn = 8 THEN 'TPN Non Standard' WHEN a.iv_prep_yn IN (9, 0) THEN 'Oncology Regimen' END) order_type,DECODE (TRUNC (k.queue_date),TRUNC (SYSDATE), 'Y','N') display_yn,a.encounter_id encounter_id, a.patient_class patient_class,COUNT (DISTINCT b.order_id) OVER (PARTITION BY b.order_line_status) tot_orders,b.order_id order_id, b.order_line_num order_line_num,TO_CHAR (a.ord_date_time,'DD/MM/YYYY HH24:MI') ord_date_time,(a.patient_id || ' / ' || e.short_name) patient_name,e.nationality_code nationality_code,j.short_name nationality_desc,DECODE (e.sex,'M', 'male','F', 'female','U', 'unknown') sex,i.short_desc locn_desc, g.practitioner_name,(c.drug_desc || ' / ' || b.qty_value || ' ' || (select short_desc FROM am_uom WHERE uom_code= b.qty_unit) || '/ ' || d.freq_desc || ' FOR ' || b.durn_value || ' DAY(S)') dosage_dtl,(order_qty || ' ' || order_uom) prescribed_qty,'' allocated_qty, '' balance_qty,TO_CHAR (k.queue_date, 'dd/mm/yyyy') queue_date,k.token_series_code token_series_code,k.token_serial_no token_series_num, b.order_line_status,(CASE WHEN b.order_line_status IN ('OS', 'RG', 'VF', 'AL', 'IP') THEN ph_get_next_link (a.performing_deptloc_code,a.ordering_facility_id,b.order_line_status,a.patient_class) WHEN b.order_line_status IN ('DF', 'CN', 'DC', 'DP','DD','DE') THEN '0' WHEN b.order_line_status = 'HD' THEN b.result_line_status END) next_link,l.description token_series_desc FROM or_order a,or_order_line b,ph_drug c,am_frequency d,mp_patient_mast e,ph_disp_locn f,am_practitioner g,(SELECT nursing_unit_code locn_code, short_desc, facility_id,'N' locn_type FROM ip_nursing_unit UNION ALL SELECT clinic_code locn_code, short_desc, facility_id,'C' locn_type FROM op_clinic) i,mp_country j,ph_ord_for_disp_queue k,ph_token_series l WHERE a.order_id = b.order_id AND b.order_catalog_code = c.drug_code(+) AND d.freq_code = b.freq_code AND a.patient_id = e.patient_id AND f.disp_locn_code = a.performing_deptloc_code AND a.ord_pract_id = g.practitioner_id AND a.ord_date_time BETWEEN TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY') + 0.99999  AND a.performing_deptloc_code = ? AND a.source_code = NVL (?, a.source_code) AND a.source_type = NVL (?, a.source_type) AND b.order_line_status LIKE NVL (?, '%') AND a.priority LIKE NVL (?, '%') AND a.patient_id LIKE NVL (?, '%') AND a.encounter_id LIKE NVL (?, '%') AND i.facility_id = a.ordering_facility_id AND i.locn_code = a.source_code AND i.locn_type = a.source_type AND e.nationality_code = j.country_code AND a.order_id = k.order_id(+) AND a.patient_id = k.patient_id(+) AND ph_check_ord_date_dispensing (b.start_date_time,b.end_date_time,?) = 1 AND k.facility_id = l.facility_id(+) AND k.disp_locn_code = l.disp_locn_code(+) AND k.token_series_code = l.token_series_code(+) ORDER BY b.order_line_status, a.patient_id, a.order_id");//,'DD','DE' ADDED FOR MMS-KH-CRF-0014
		dataMap.put("SQL_PH_TASK_LIST_SELECT2", "SELECT ISSUE_TOKEN_ON_REGN_YN,DISP_REGN_REQD_YN, STORE_CODE FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_TASK_LIST_SELECT3", " SELECT  A.DISP_DRUG_CODE DISP_DRUG_CODE,A.DISP_QTY DISP_QTY,A.DISP_UOM_CODE DISP_QTY_UOM,B.DRUG_DESC DRUG_DESC FROM PH_DISP_DTL_TMP A,PH_DRUG B WHERE  A.DISP_DRUG_CODE=B.DRUG_CODE AND A.ORDER_ID = ? AND ORDER_LINE_NO= ? AND A.FACILITY_ID = ?");
		dataMap.put("SQL_PH_TASK_LIST_SELECT4", "SELECT  a.disp_drug_code disp_drug_code, SUM(a.disp_qty) disp_qty, a.disp_uom_code Disp_qty_uom, b.drug_desc drug_desc  FROM ph_disp_dtl a, ph_drug b  WHERE  a.disp_drug_code = b.drug_code AND a.order_id =? AND order_line_no = ? AND a.facility_id = ? GROUP BY a.disp_drug_code, a.disp_uom_code, b.drug_desc");
		dataMap.put("SQL_PH_TASK_LIST_SELECT5", "SELECT to_char(SYSDATE-7,'dd/mm/yyyy') FROM_DATE,to_char(SYSDATE+7,'dd/mm/yyyy')TO_DATE from dual");
		dataMap.put("SQL_PH_CHART_SUMM_CURR_MEDNS_SELECT1","select 1 from  sm_module where module_id='PH' and INSTALL_YN='Y'");
		dataMap.put("SQL_PH_CHART_SUMM_CURR_MEDNS_SELECT2","SELECT b.order_id,e.form_code||' '||e.DRUG_DESC||' '||a.dosage ||' '||a.dosage_uom_code||' '||a.FREQ_CODE||' * '||a.DURATION  ||' '||c.DURN_DESC drug_name,to_char(a.start_date,'dd/mm/yy')||'-'||to_char(a.end_date,'dd/mm/yy') drug_duration, b.iv_prep_yn FROM ph_patient_drug_profile a,or_order b,am_duration_type c,am_frequency d, ph_drug e ,ph_generic_name f WHERE a.patient_id = ? AND A.ORIG_ORDER_ID = NVL(?,A.ORIG_ORDER_ID) AND B.ORDER_ID = A.ORIG_ORDER_ID AND TRUNC(NVL(a.end_date,SYSDATE)) >= TRUNC(SYSDATE) AND a.discont_date_time IS NULL AND a.on_hold_date_time IS NULL AND d.freq_code(+)=a.FREQ_CODE AND e.DRUG_CODE=a.DRUG_CODE  and f.GENERIC_ID=a.GENERIC_ID AND c.durn_type(+)=d.INTERVAL_DURN_TYPE and cancel_yn='N' and cancel_date_time is null ORDER BY ord_date_time,orig_order_id,orig_order_line_no");
		dataMap.put("SQL_PH_CHART_SUMM_CURR_MEDNS_SELECT2A","SELECT b.order_id,e.form_code||' '||e.DRUG_DESC||' '||a.dosage ||' '||a.dosage_uom_code||' '||a.FREQ_CODE||' * '||a.DURATION  ||' '||c.DURN_DESC drug_name,to_char(a.start_date,'dd/mm/yy')||'-'||to_char(a.end_date,'dd/mm/yy') drug_duration, b.iv_prep_yn FROM ph_patient_drug_profile a,or_order b,am_duration_type c,am_frequency d, ph_drug e ,ph_generic_name f WHERE a.patient_id = ? AND A.ORIG_ORDER_ID = NVL(?,A.ORIG_ORDER_ID) AND B.ORDER_ID = A.ORIG_ORDER_ID  AND a.discont_date_time IS NULL AND a.on_hold_date_time IS NULL AND d.freq_code(+)=a.FREQ_CODE AND e.DRUG_CODE=a.DRUG_CODE  and f.GENERIC_ID=a.GENERIC_ID AND c.durn_type(+)=d.INTERVAL_DURN_TYPE and cancel_yn='N' and cancel_date_time is null ORDER BY ord_date_time,orig_order_id,orig_order_line_no");
		dataMap.put("SQL_PH_CHART_SUMM_CURR_MEDNS_SELECT3","select IV_DRUG_FLUID_CONTINUOUS_LG, IV_DRUG_FLUID_INTERMITTENT_LG, IV_WITHOUT_ADDITIVES_LG from PH_PARAM");

		//Audit / log
		dataMap.put("PH_SETUP_LOG_SELECT1","select decode(build_setup_log_yn, 'Y', decode((select count(*) from ph_setup_log_hdr where table_id=? and pkey_value=?),0,'N','Y'), 'N')view_log_yn from ph_param");
		dataMap.put("PH_SETUP_LOG_SELECT2", "SELECT	a.column_id, a.column_value_old, a.column_value_new, b.option_type, b.legend_key main_legend_key, b.legend_desc main_legend_desc, c.legend_option_key legend_option_key_new, c.legend_option_desc legend_option_desc_new, d.legend_option_key legend_option_key_old, d.legend_option_desc legend_option_desc_old FROM ph_setup_log_dtl a, PH_LEGEND b, PH_LEGEND_OPTION c, PH_LEGEND_OPTION d WHERE a.log_id = ? AND b.table_id = ? AND b.column_id = a.column_id AND c.table_id(+) = a.table_id AND c.column_id(+) = a.column_id AND c.legend_option_code(+) = a.column_value_new and d.table_id(+) = a.table_id AND d.column_id(+) = a.column_id AND d.legend_option_code(+) = a.column_value_old");
		dataMap.put("PH_SETUP_LOG_SELECT3","select a.log_id,a.modified_facility_id,a.modified_by_id,a.modified_at_ws_no, to_char(a.modified_date,'dd/mm/yyyy hh24:mi') modified_date,  b.facility_name,c.appl_user_name  from ph_setup_log_hdr a, sm_facility_param b, sm_appl_user c where table_id = ?  and pkey_value = ?  and b.facility_id = a.modified_facility_id  and c.appl_user_id = a.modified_by_id order by log_id desc ");
        dataMap.put("SQL_PH_DRUG_BY_DRUG_TYPE_SELECT", "select drug_type, drug_type_desc, 'I' db_action, 'D' eff_status from ph_drug_type where  eff_status='E' AND drug_type not in(select drug_type from ph_drug_drug_type where drug_code =?) union ALL select a.drug_type, b.drug_type_desc, 'U' db_action, a.eff_status from ph_drug_drug_type a, ph_drug_type b where a.drug_type=b.drug_type and a.drug_code=?  order by 2");
		dataMap.put("SQL_PH_DRUG_BY_DRUG_TYPE_SELECT1", "select distinct b.drug_type code, a.drug_type_desc description from ph_drug_type_lang_vw a, ph_drug_drug_type b WHERE  b.drug_code LIKE upper(?) and a.drug_type like Upper(?) and  Upper(a.drug_type_desc) like Upper(?) AND a.drug_type = b.drug_type AND a.language_id = ");
		dataMap.put("SQL_PH_DRUG_BY_DRUG_TYPE_SELECT2","SELECT a.drug_type, b.drug_type_desc, a.drug_code, c.drug_desc FROM ph_drug_drug_type a, ph_drug_type_lang_vw b, ph_drug c WHERE a.drug_type = b. drug_type AND a.drug_code = c.drug_code AND a.eff_status='E' AND a.drug_type LIKE upper(?) AND a.drug_code LIKE upper(?) AND b.language_id = ?");
        dataMap.put("SQL_PH_DRUG_BY_DRUG_TYPE_INSERT", "INSERT INTO ph_drug_drug_type (DRUG_CODE, DRUG_TYPE, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,sysdate,?,?,?,sysdate,?,?)");
		dataMap.put("SQL_PH_DRUG_BY_DRUG_TYPE_UPDATE", "UPDATE ph_drug_drug_type SET  EFF_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=sysdate, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID =? WHERE  DRUG_CODE=? AND DRUG_TYPE=?");

		//Drug Type
		dataMap.put("SQL_PH_DRUGTYPE_SELECT1", "SELECT DRUG_TYPE, DRUG_TYPE_DESC,EFF_STATUS FROM PH_DRUG_TYPE_LANG_VW PH_DRUG_TYPE WHERE DRUG_TYPE like NVL(?,DRUG_TYPE) AND DRUG_TYPE_DESC LIKE NVL(UPPER(?),DRUG_TYPE_DESC) AND EFF_STATUS = NVL(?,EFF_STATUS) AND LANGUAGE_ID = ?");
        dataMap.put("SQL_PH_DRUGTYPE_SELECT2", "SELECT DRUG_TYPE,DRUG_TYPE_DESC,EFF_STATUS FROM PH_DRUG_TYPE_LANG_VW PH_DRUG_TYPE  WHERE DRUG_TYPE = ? AND LANGUAGE_ID = ?");
        dataMap.put("SQL_PH_DRUGTYPE_UPDATE", "UPDATE PH_DRUG_TYPE SET  DRUG_TYPE_DESC=?, EFF_STATUS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE DRUG_TYPE=?");
		//Ph Vaccine Family
		dataMap.put("SQL_PH_VACC_FAMILY_INSERT","INSERT INTO PH_VACC_FAMILY (VACC_FAMILY_ID, VACC_FAMILY_NAME, OPTIONAL_YN, VACC_CYCLE_TYPE, NO_OF_DOSES, RESTART_SERIES_YN, SKIP_DOSE_YN, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,EXTRA_DOSES_YN,DEFAULT_SITE,FREQ_DURN,FREQ_DURN_TYPE,MIN_AGE,MIN_AGE_UNIT) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?,?,?,?,?,?,?)");
		dataMap.put("SQL_PH_VACC_FAMILY_SELECT","SELECT count(*) getCount FROM PH_VACC_FAMILY WHERE vacc_family_id=?");
		dataMap.put("SQL_PH_VACC_FAMILY_SELECT1","SELECT VACC_FAMILY_ID, VACC_FAMILY_NAME, OPTIONAL_YN, VACC_CYCLE_TYPE, NO_OF_DOSES, RESTART_SERIES_YN, SKIP_DOSE_YN, EFF_STATUS, EXTRA_DOSES_YN, DEFAULT_SITE, FREQ_DURN,FREQ_DURN_TYPE, MIN_AGE, MIN_AGE_UNIT FROM PH_VACC_FAMILY WHERE VACC_FAMILY_ID LIKE upper(?) AND UPPER(VACC_FAMILY_NAME) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?)");
		dataMap.put("SQL_PH_VACC_FAMILY_SELECT2","SELECT VACC_FAMILY_ID,VACC_FAMILY_NAME,OPTIONAL_YN, DECODE(VACC_CYCLE_TYPE,'S','Schedule','F','Frequency')VACC_CYCLE_TYPE, NO_OF_DOSES,RESTART_SERIES_YN,SKIP_DOSE_YN,EFF_STATUS, EXTRA_DOSES_YN, DEFAULT_SITE, FREQ_DURN,FREQ_DURN_TYPE, MIN_AGE, MIN_AGE_UNIT FROM PH_VACC_FAMILY WHERE VACC_FAMILY_ID = UPPER(?)");
		dataMap.put("SQL_PH_VACC_FAMILY_UPDATE","UPDATE ph_vacc_family SET VACC_FAMILY_NAME=?, OPTIONAL_YN=?, VACC_CYCLE_TYPE=?, NO_OF_DOSES=?, RESTART_SERIES_YN=?, SKIP_DOSE_YN=?, eff_status=?, MODIFIED_BY_ID=?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO =?, MODIFIED_FACILITY_ID =?, EXTRA_DOSES_YN=?, DEFAULT_SITE=?, FREQ_DURN=?, FREQ_DURN_TYPE=?, MIN_AGE=?, MIN_AGE_UNIT=? WHERE VACC_FAMILY_ID=?");
		dataMap.put("SQL_PH_DEFAULT_SITE_SELECT1","SELECT ANATOMICAL_SITE_CODE CODE, SHORT_DESC DESCRIPTION FROM AM_ANATOMICAL_SITE_LANG_VW AM_ANATOMICAL_SITE WHERE  LANGUAGE_ID like ? AND  UPPER(ANATOMICAL_SITE_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?)");
		dataMap.put("SQL_PH_DEFAULT_SITE_SELECT2","SELECT ANATOMICAL_SITE_CODE CODE, SHORT_DESC DESCRIPTION FROM AM_ANATOMICAL_SITE_LANG_VW WHERE  ANATOMICAL_SITE_CODE=? AND LANGUAGE_ID=?");
		//Ph Vaccine Schedule
		dataMap.put("SQL_PH_VACC_SCHEDULE_SELECT","SELECT vacc_family_id,dose_no,min_int_durn,min_int_durn_type, rec_int_durn,rec_int_durn_type,od_int_durn,od_int_durn_type, minimum_age,minimum_age_unit, skip_age,skip_age_unit FROM ph_vacc_schedule WHERE vacc_family_id =?");
		dataMap.put("SQL_PH_VACC_SCHEDULE_SELECT1","SELECT a.VACC_FAMILY_ID, b.VACC_FAMILY_NAME, a.DOSE_NO, a.MINIMUM_AGE,a.MINIMUM_AGE_UNIT,a.MIN_INT_DURN, a.MIN_INT_DURN_TYPE, a.REC_INT_DURN, a.REC_INT_DURN_TYPE, a.OD_INT_DURN, a.OD_INT_DURN_TYPE,  a.SKIP_AGE,  a.SKIP_AGE_UNIT FROM ph_vacc_schedule a, ph_vacc_family b WHERE a.VACC_FAMILY_ID = b.vacc_family_id AND a.vacc_family_id LIKE UPPER(?) AND upper(VACC_FAMILY_NAME) LIKE UPPER(?)");
		dataMap.put("SQL_PH_VACC_SCHEDULE_SELECT2","SELECT vacc_family_id,vacc_family_name from ph_vacc_family  WHERE VACC_CYCLE_TYPE NOT IN(SELECT VACC_CYCLE_TYPE FROM ph_vacc_family WHERE   VACC_CYCLE_TYPE ='F') order by vacc_family_name");
        dataMap.put("SQL_PH_VACC_SCHEDULE_SELECT3", "SELECT VACC_CYCLE_TYPE,NO_OF_DOSES,SKIP_DOSE_YN from ph_vacc_family WHERE  VACC_FAMILY_ID=?");
		dataMap.put("SQL_PH_VACC_SCHEDULE_UPDATE","UPDATE PH_VACC_SCHEDULE SET MIN_INT_DURN =?, MIN_INT_DURN_TYPE=?, REC_INT_DURN=?, REC_INT_DURN_TYPE=?, OD_INT_DURN=?, OD_INT_DURN_TYPE=?, MINIMUM_AGE=?, SKIP_AGE=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?, MINIMUM_AGE_UNIT=?, SKIP_AGE_UNIT=? WHERE VACC_FAMILY_ID=? AND DOSE_NO=?");
        dataMap.put("SQL_PH_PRACT_SELECT","SELECT A.PRACT_TYPE FROM AM_PRACTITIONER A,SM_APPL_USER B WHERE A.PRACTITIONER_ID=B.FUNC_ROLE_ID AND A.EFF_STATUS='E' AND B.EFF_STATUS='E' AND APPL_USER_ID=?");
		dataMap.put("SQL_PH_MEDN_TRN_REASON_SELECT", "SELECT reason_code,reason_desc FROM ph_medn_trn_reason_lang_vw ph_medn_trn_reason WHERE appl_trn_type='CO' AND eff_status='E' AND language_id = ? order by reason_desc");
		dataMap.put("SQL_PH_MEDN_TRN_REASON_SELECT1", "SELECT reason_code,reason_desc FROM ph_medn_trn_reason_lang_vw ph_medn_trn_reason WHERE appl_trn_type='OB' AND eff_status='E' AND language_id = ? order by reason_desc");
		dataMap.put("SQL_OR_ORDER_LINE_PH_UPDATE3", "UPDATE OR_ORDER_LINE_PH SET MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? ,COMPLETE_ORDER_REASON= ? WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_EXT_DRUG_DB_ACTION", "SELECT NULL DRUG_CODE,PRODUCT_ID, PRODUCT_DESC, NULL EXT_PROD_DRUG_CODE, 'D' EFF_STATUS , 'I' DB_ACTION FROM PH_EXTERNAL_PRODUCT_LANG_VW PH_EXTERNAL_PRODUCT WHERE PRODUCT_ID NOT IN (SELECT PRODUCT_ID FROM PH_DRUG_EXT_PROD_DRUG WHERE DRUG_CODE = ? ) AND LANGUAGE_ID = ? UNION ALL SELECT A.DRUG_CODE, A.PRODUCT_ID, B.PRODUCT_DESC, A.EXT_PROD_DRUG_CODE, A.EFF_STATUS, 'U' DB_ACTION FROM PH_DRUG_EXT_PROD_DRUG A, PH_EXTERNAL_PRODUCT_LANG_VW B WHERE A.DRUG_CODE = ? AND A.PRODUCT_ID = B.PRODUCT_ID AND B.LANGUAGE_ID = ? ORDER BY PRODUCT_DESC");
		dataMap.put("SQL_PH_EXT_DRUG_UPDATE", "UPDATE PH_DRUG_EXT_PROD_DRUG SET EXT_PROD_DRUG_CODE = ?,EFF_STATUS=?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE DRUG_CODE = ? AND PRODUCT_ID=?");
		dataMap.put("SQL_PH_EXT_DRUG_INSERT", "INSERT INTO PH_DRUG_EXT_PROD_DRUG(DRUG_CODE,PRODUCT_ID,EXT_PROD_DRUG_CODE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,EFF_STATUS) VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_DRUG_DB_INTERFACE_YN", "SELECT DRUG_DB_INTERFACE_YN FROM PH_PARAM");
		dataMap.put("SQL_PH_IVPRESCRIPTION_SELECT5E", "SELECT ALLERGY_OVERRIDE_REASON,DOSAGE_LIMIT_OVERRIDE_REASON,DUPLICATE_DRUG_OVERRIDE_REASON,INTERACTION_OVERRIDE_REASON,CONTRAIND_OVERRIDE_REASON FROM PH_PATIENT_DRUG_PROFILE WHERE ORIG_ORDER_ID = ? AND ORIG_ORDER_LINE_NO = ?");
		dataMap.put("SQL_PH_OVERRIDE_BMS_UPDATE3", "UPDATE OR_ORDER SET ORDER_STATUS=?,MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ? , MODIFIED_FACILITY_ID = ? WHERE ORDER_ID=?");
		dataMap.put("SQL_PH_EXT_PROD_LINK_PATIENT_AGE_SELECT", "SELECT (TRUNC(SYSDATE) - TRUNC(DATE_OF_BIRTH)) AGE_IN_DAYS FROM MP_PATIENT WHERE PATIENT_ID=? ");
		dataMap.put("SQL_PH_EXT_PROD_LINK_DOSE_UOM_SELECT","SELECT DRUG_DATABASE_UOM_CODE FROM AM_UOM WHERE UOM_CODE = ? ");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT13","SELECT DISTINCT B.EQUIVALENT_TERM_CODE FROM PR_DIAGNOSIS A, MR_EQUIVALENT_TERM_CODE B WHERE A.PATIENT_ID = ?  AND A.CURR_STATUS = 'A' AND B.TERM_SET_ID = A.TERM_SET_ID AND B.TERM_CODE = A.TERM_CODE AND B.EQUIVALENT_TERM_SET_ID = 'ICD9' ");
		dataMap.put("SQL_PH_EXT_PROD_LINK_SELECT14","SELECT DRUG_DB_INTERFACE_YN, DRUG_DB_DOSECHECK_YN, DRUG_DB_DUPTHERAPY_YN, DRUG_DB_INTERACT_CHECK_YN, DRUG_DB_CONTRAIND_CHECK_YN, DRUG_DB_ALLERGY_CHECK_YN FROM PH_PARAM WHERE MODULE_ID=? AND drug_db_interface_name IS NOT NULL");
		dataMap.put("SQL_PH_DRUG_DB_INTERFACE_CHECKS_SELECT","SELECT DRUG_DB_INTERFACE_YN, DRUG_DB_DOSECHECK_YN, DRUG_DB_DUPTHERAPY_YN, DRUG_DB_INTERACT_CHECK_YN, DRUG_DB_CONTRAIND_CHECK_YN, DRUG_DB_ALLERGY_CHECK_YN FROM PH_PARAM WHERE MODULE_ID=? AND drug_db_interface_name IS NOT NULL");
		dataMap.put("SQL_PH_DISP_HDR_SELECT","select patient_id from ph_disp_hdr where DISP_NO = ?");
		dataMap.put("SQL_PH_TERM_SET_SELECT1","SELECT TERM_SET_ID, TERM_SET_DESC FROM MR_TERM_SET MR_TERM_SET WHERE EFF_STATUS = 'E'  ORDER BY TERM_SET_DESC");
		dataMap.put("SQL_PH_TERM_CODE_SELECT_LOOKUP","SELECT TERM_CODE CODE, SHORT_DESC DESCRIPTION FROM MR_TERM_CODE WHERE UPPER(TERM_SET_ID) LIKE UPPER(?) AND EFF_STATUS = 'E' AND TERM_CODE NOT IN ( SELECT TERM_CODE FROM PH_DRUG_ELIGIBLE_TERM_CODE WHERE UPPER(DRUG_CODE)  LIKE UPPER(?) AND UPPER(TERM_SET_ID) LIKE (?))AND UPPER(TERM_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_ELIGIBLE_TERM_CODE_INSERT","INSERT INTO PH_DRUG_ELIGIBLE_TERM_CODE(DRUG_CODE,TERM_SET_ID,TERM_CODE,DIAG_SCR_NOTE_TYPE,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES(?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DRUG_ELIGIBLE_TERM_CODE_UPDATE","UPDATE PH_DRUG_ELIGIBLE_TERM_CODE SET EFF_STATUS = ? WHERE DRUG_CODE = ? AND TERM_SET_ID = ? AND TERM_CODE = ?");
		dataMap.put("SQL_PH_DRUG_ELIGIBLE_TERM_CODE_SELECT","SELECT   A.DRUG_CODE, A.TERM_SET_ID, A.TERM_CODE, B.TERM_SET_DESC,C.LONG_DESC TERM_CODE_DESC, A.EFF_STATUS FROM PH_DRUG_ELIGIBLE_TERM_CODE A, MR_TERM_SET B, MR_TERM_CODE C WHERE A.DRUG_CODE = ? AND A.TERM_SET_ID = B.TERM_SET_ID AND A.TERM_SET_ID = C.TERM_SET_ID AND A.TERM_CODE = C.TERM_CODE ORDER BY B.TERM_SET_DESC, C.SHORT_DESC");
		dataMap.put("SQL_PH_PRES_WEIGTH_CHECK_FLAG_SELECT","select c.WT_MAND_YN, c.HT_MAND_YN from ph_drug_age_group c, am_age_group b where c.drug_code= ? and b.AGE_GROUP_CODE = c.AGE_GROUP_CODE and c.EFF_STATUS='E' and  ?  BETWEEN decode( age_unit,'N',min_age,'H',min_age * 60,'D',MIN_AGE * 24 * 60,'M',MIN_AGE*30 * 24 * 60,'Y',MIN_AGE*365 * 24 * 60) AND decode( age_unit_max,'N',MAX_AGE,'H',MAX_AGE * 60,'D',MAX_AGE * 24 * 60,'M',MAX_AGE*30 * 24 * 60,'Y',MAX_AGE*365 * 24 * 60) and upper(?) = upper(case when (select count(*) from ph_drug_age_group c, am_age_group b where b.AGE_GROUP_CODE = c.AGE_GROUP_CODE  and c.EFF_STATUS='E' and b.GENDER =? and c.drug_code= ? and  ? BETWEEN decode( age_unit,'D',MIN_AGE,'M',MIN_AGE*30,'Y',MIN_AGE*365)  AND decode( age_unit_max,'D',MAX_AGE,'M',MAX_AGE*30,'Y',MAX_AGE*365))=0 then nvl(b.GENDER,?) else b.GENDER end)"); //age_unit_max,'N',min_age,'H',min_age * 60 is replaced by age_unit_max,'N',MAX_AGE,'H',MAX_AGE * 60 for ML-BRU-SCF-0903[IN041270]
		dataMap.put("SQL_PH_MED_ADMIN_FT_SELECT_DRUGS_COUNT","SELECT Count(*) NO_OF_DRUGS FROM ph_medn_admin WHERE order_id =? AND sch_date_time = To_Date(?,'dd/mm/yyyy hh24:mi')");
		dataMap.put("SQL_PH_PRESCRIPTION_BL_ACTION_SELECT_LOOKUP","select  action_reason_code code,action_reason_desc description from bl_action_reason_lang_vw a where nvl(status,'!') != 'S'  and exists (select b.action_type from bl_action_type b, bl_action_reason_by_type c where b.action_type = c.action_type and b.action_type = 'OV' and c.action_reason_code = a.action_reason_code and c.active_yn = 'Y') and upper(a.language_id) like Upper(?) AND Upper(a.action_reason_code) LIKE Upper(?) AND Upper(a.action_reason_desc) LIKE Upper(?)");
		dataMap.put("SQL_PH_AMEND_PRESCRIPTION_BL_ACTION_DESC_SELECT","select action_reason_desc from bl_action_reason_lang a where nvl(status,'!') != 'S'  and exists (select b.action_type from bl_action_type b, bl_action_reason_by_type c where b.action_type = c.action_type  and b.action_type = 'OV' and c.action_reason_code = a.action_reason_code and c.active_yn = 'Y') and upper(a.language_id) like Upper(?) AND a.action_reason_code =?");
		dataMap.put("SQL_PH_MEDICAL_ITEM_NONDRUG_SELECT","SELECT drg.drug_code, drg.item_code, drg.drug_desc, drg.in_formulary_yn,      disp_alt_form_yn, generic_name, drg.generic_id, drg.discontinued_yn FROM ph_drug_lang_vw drg,       mm_item_lang_vw itm,ph_generic_name_lang_vw genname WHERE drg.item_code = itm.item_code(+) AND drg.generic_id = genname.generic_id(+) AND drg.language_id = itm.language_id(+) AND drg.drug_yn = 'N' AND drg.drug_code LIKE NVL (?, drg.drug_code) AND drg.drug_desc LIKE NVL (?, drg.drug_desc)   AND drg.discontinued_yn = DECODE (?, 'B', drg.discontinued_yn, ?) AND drg.language_id = ? AND genname.language_id(+) = ?");
		dataMap.put("SQL_PH_MEDICAL_ITEM_TRADE_COUNT","SELECT COUNT(1) CNT FROM PH_TRADE_NAME_FOR_DRUG WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_MEDICAL_ITEM_TRADE_COUNT1","SELECT COUNT(1) CNT FROM PH_TRADE_NAME_FOR_DRUG WHERE DRUG_CODE = ? AND TRADE_CODE = ?");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_INSERT","INSERT INTO ph_drug(DRUG_CODE,DRUG_DESC,DRUG_CLASS,IN_FORMULARY_YN,LINK_TO_EXISTING_ITEM,ITEM_CODE,GENERIC_ID,STRENGTH_VALUE,PRES_BASE_UOM,STOCK_UOM,CONTENT_IN_PRES_BASE_UOM,		DISP_MULTI_STRENGTH_YN,DISP_ALT_FORM_YN,DISCONTINUED_YN,DRUG_YN,ADDED_BY_ID, ADDED_DATE,ADDED_AT_WS_NO, ADDED_FACILITY_ID,MODIFIED_BY_ID, MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)	VALUES(?,?,'G',?,?,?,?,?,?,?,?,?,?,?,'N',?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_TRADE_NAME_INSERT"," INSERT INTO PH_TRADE_NAME_FOR_DRUG(DRUG_CODE,TRADE_CODE,EFF_STATUS,DISPLAY_SEQ_NO ,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_UPDATE","UPDATE ph_drug SET DRUG_DESC = ?,DRUG_CLASS = 'G',IN_FORMULARY_YN = ?,LINK_TO_EXISTING_ITEM=?,ITEM_CODE=?,GENERIC_ID=?,STRENGTH_VALUE=?,PRES_BASE_UOM=?,STOCK_UOM=?,CONTENT_IN_PRES_BASE_UOM=?,DISP_MULTI_STRENGTH_YN=?,DISP_ALT_FORM_YN=?,DISCONTINUED_YN=?,DRUG_YN='N',MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_TRADE_NAME_INSERT","INSERT INTO PH_TRADE_NAME_FOR_DRUG(DRUG_CODE,TRADE_CODE,EFF_STATUS,DISPLAY_SEQ_NO ,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)VALUES(?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_TRADE_NAME_UPDATE","UPDATE PH_TRADE_NAME_FOR_DRUG SET EFF_STATUS = ?,MODIFIED_BY_ID = ?,MODIFIED_DATE = SYSDATE,MODIFIED_AT_WS_NO = ?,MODIFIED_FACILITY_ID = ? WHERE DRUG_CODE = ? AND TRADE_CODE = ?");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_UOM_SELECT","SELECT UOM_CODE, SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE QTY_UOM_YN = 'Y' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_UOM_SELECT1","SELECT UOM_CODE, SHORT_DESC FROM AM_UOM_LANG_VW AM_UOM WHERE UOM_CODE != ? AND QTY_UOM_YN = 'Y' AND EFF_STATUS='E' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_SELECT1","SELECT COUNT(1) CNT FROM PH_DRUG WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_SELECT2","SELECT trade.trade_id,trade.short_name trade_name,manufact.short_name manufact_name,drgtrade.eff_status FROM ph_trade_name_for_drug drgtrade, am_trade_name_lang_vw trade,am_manufacturer_lang_vw manufact WHERE  drgtrade.trade_code = trade.trade_id AND drgtrade.drug_code = ? AND trade.language_id =? AND trade.manufacturer_id = manufact.manufacturer_id(+) AND manufact.language_id(+) = ?");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_SELECT3","SELECT drg.drug_code,drg.item_code, drg.drug_desc, drg.in_formulary_yn, disp_alt_form_yn,generic_name,drg.generic_id, drg.discontinued_yn,drg.disp_multi_strength_yn,drg.pres_base_uom,drg.stock_uom,drg.content_in_pres_base_uom FROM ph_drug_lang_vw drg,mm_item_lang_vw itm,ph_generic_name_lang_vw genname  WHERE drg.item_code = itm.item_code(+) AND drg.generic_id = genname.generic_id(+) AND drg.language_id = itm.language_id(+) AND drg.drug_code = ? AND drg.language_id = ? AND genname.language_id(+) = ?");
		dataMap.put("SQL_PH_DRUG_MEDICAL_ITEM_SELECT4","select a.item_code code, b.long_desc description from st_item a, mm_item_lang_vw b where a.medical_item_yn = 'Y' and a.drug_item_yn = 'N' and b.cssd_component_yn = 'N' and b.item_code = a.item_code and upper(a.item_code) like upper(?) and upper(b.long_desc) like upper(?)");
		dataMap.put("JNDI_PH_MEDICAL_ITEM", "java:comp/env/MedicalItem");

		dataMap.put("SQL_PH_ADR_CERTAINITY_UPDATE","UPDATE PH_ADR_CERTAINITY SET CERTAINITY_USER_DESC=?,REL_SCORE_FROM=?,REL_SCORE_TO=?,MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE CERTAINITY_CODE=? AND CERTAINITY_SYS_DESC=?");
		dataMap.put("SQL_PH_ADR_CERTAINITY_SELECT","SELECT  DECODE(NVL(COUNT(*),0),0,'N','Y')  OVERLAPS_YN   FROM   PH_ADR_CERTAINITY  WHERE CERTAINITY_CODE != 'E'    AND CERTAINITY_CODE !=?  AND       ( (? BETWEEN REL_SCORE_FROM AND REL_SCORE_TO ) or       (? BETWEEN REL_SCORE_FROM AND REL_SCORE_TO )  OR   ( REL_SCORE_FROM BETWEEN ? AND ?  ) or    (REL_SCORE_TO BETWEEN ? AND ?))");
		dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_QUERY_RESULT","SELECT (SELECT long_desc from ph_disp_locn_lang_vw B WHERE a.disp_locn_code = b.disp_locn_code AND a.facility_id = b.facility_id AND b.language_id = ?) long_desc, DECODE (a.day_type,0, 'ALLDAYS', 1, 'MONDAY',2, 'TUESDAY',3, 'WEDNESDAY',4, 'THURSDAY',5, 'FRIDAY',6, 'SATURDAY',7, 'SUNDAY',8, 'WORKINGDAYS',9, 'HOLIDAYS') day_type ,TO_CHAR (a.from_time, 'hh24:mi') from_time, TO_CHAR (a.to_time, 'hh24:mi') to_time  FROM ph_disp_locn_time_table a WHERE a.disp_locn_code LIKE NVL(?,'%') AND a.day_type LIKE NVL(?,'%')");
		dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_UPDATE","UPDATE ph_pres_remark_for_drug SET eff_status= ?,modified_by_id= ?,modified_date= SYSDATE,modified_at_ws_no= ?,modified_facility_id= ? WHERE drug_code = ? AND remark_code =  ?");
		dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_UPDATE1","UPDATE ph_pres_remark_for_drug SET eff_status= ?,default_remark_yn=?,modified_by_id= ?,modified_date= SYSDATE,modified_at_ws_no= ?,modified_facility_id= ? WHERE drug_code = ? AND remark_code =  ?");
		dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_SELECT","SELECT B.ROUTE_CODE,A.FORM_CODE, A.FORM_DESC FROM PH_FORM_LANG_VW A,PH_DRUG B WHERE DRUG_CODE =? AND A.FORM_CODE =B.FORM_CODE AND A.LANGUAGE_ID =?");
		dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_SELECT1","SELECT REMARK_CODE,EFF_STATUS,DEFAULT_REMARK_YN FROM  PH_PRES_REMARK_FOR_DRUG WHERE DRUG_CODE = ?");
		dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_SELECT2","SELECT ROUTE_CODE FROM PH_PRES_REMARK WHERE REMARK_CODE IN (SELECT REMARK_CODE FROM PH_PRES_REMARK_FOR_DRUG WHERE DRUG_CODE=? AND DEFAULT_REMARK_YN='Y')");
		dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_INSERT","INSERT INTO PH_PRES_REMARK_FOR_DRUG(DRUG_CODE,REMARK_CODE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,EFF_STATUS,DEFAULT_REMARK_YN)VALUES (?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?)");
		dataMap.put("SQL_PRES_REMARK_FOR_DRUG_LOOKUP","select a.drug_code code, a.drug_desc description from ph_drug_lang_vw a where  upper(a.drug_code) like upper(?) and upper(a.drug_desc) like upper(?) AND DRUG_YN = 'Y' AND DISCONTINUED_YN = 'N'");
		dataMap.put("SQL_PRES_REMARK_FOR_DRUG_LOOKUP1","SELECT a.REMARK_CODE code, a.REMARK_DESC ||' ( ' ||(SELECT form_desc FROM ph_form_lang_vw WHERE form_code = a.form_code AND language_id = #) ||' - '||(SELECT route_desc FROM ph_route_lang_vw WHERE route_code = a.route_code AND language_id = #)||' )' description FROM ph_pres_remark_lang_vw a WHERE  A.LANGUAGE_ID = # AND  UPPER(a.REMARK_CODE) LIKE UPPER(?) AND UPPER(a.REMARK_DESC) LIKE UPPER(?)");        
	    dataMap.put("SQL_PH_PRES_REMARK_FOR_DRUG_QUERY_RESULT","SELECT  pres.remark_code, pres.remark_desc, drug.drug_code,  drug.drug_desc, presdrug.eff_status   FROM ph_drug_lang_vw drug,   ph_pres_remark_lang_vw pres, ph_pres_remark_for_drug presdrug WHERE UPPER (pres.remark_code) LIKE UPPER (?)  AND UPPER (pres.remark_desc) LIKE UPPER (?) AND UPPER (drug.drug_code) LIKE UPPER (?) AND UPPER (drug.drug_desc) LIKE UPPER (?) AND drug.drug_code = presdrug.drug_code AND pres.remark_code = presdrug.remark_code  AND pres.language_id = drug.language_id AND pres.language_id =?");
		dataMap.put("SQL_PR_ADV_DRUG_REACTION_QA_INSERT","insert into PR_ADV_DRUG_REACTION_QA(ADR_NO,QUESTION_CODE,RESPONSE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES(?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PR_ADV_DRUG_REACTION_QA_DELETE","DELETE FROM PR_ADV_DRUG_REACTION_QA WHERE ADR_NO=? ");
		dataMap.put("SQL_PR_ADV_DRUG_REACTION_QA_SELECT","SELECT QUESTION_CODE, QUESTION_DESC, YES_SCORE, NO_SCORE, NOT_KNOWN_SCORE, TO_CHAR(NULL) RESPONSE, SEQ_NO FROM PH_ADR_QUESTION_LANG_VW WHERE LANGUAGE_ID =? ORDER BY SEQ_NO");
		dataMap.put("SQL_PR_ADV_DRUG_REACTION_QA_SELECT1","SELECT QUESTION_CODE, QUESTION_DESC, YES_SCORE, NO_SCORE, NOT_KNOWN_SCORE, TO_CHAR(NULL) RESPONSE, SEQ_NO FROM PH_ADR_QUESTION_LANG_VW WHERE LANGUAGE_ID = ? AND QUESTION_CODE NOT IN (SELECT QUESTION_CODE FROM PR_ADV_DRUG_REACTION_QA WHERE ADR_NO = ?) UNION ALL SELECT A.QUESTION_CODE, B.QUESTION_DESC, B.YES_SCORE, B.NO_SCORE, B.NOT_KNOWN_SCORE, A.RESPONSE, B.SEQ_NO FROM PH_ADR_QUESTION_LANG_VW B, PR_ADV_DRUG_REACTION_QA A WHERE a.ADR_NO = ? AND A.QUESTION_CODE = B.QUESTION_CODE AND B.LANGUAGE_ID = ? ORDER BY SEQ_NO");
		dataMap.put("SQL_PR_ADV_DRUG_REACTION_QA_SELECT2","select certainity_code,CERTAINITY_USER_DESC from PH_ADR_CERTAINITY_LANG_VW  where ? between REL_SCORE_FROM and REL_SCORE_TO AND language_id = ?");
		dataMap.put("SQL_PR_ADV_DRUG_REACTION_QA_SELECT3","Select CERTAINITY_CODE,CERTAINITY_USER_DESC from PH_ADR_CERTAINITY_LANG_VW where language_id=? order by certainity_code");
		dataMap.put("SQL_CERTAINITY_QUERY_RESULT","SELECT CERTAINITY_CODE, CERTAINITY_SYS_DESC, CERTAINITY_USER_DESC, REL_SCORE_FROM, REL_SCORE_TO FROM PH_ADR_CERTAINITY_LANG_VW WHERE LANGUAGE_ID like ? ORDER BY CERTAINITY_CODE");
		dataMap.put("SQL_PH_ADR_QUESTION_QUERY_RESULT","Select  QUESTION_CODE,QUESTION_DESC,SEQ_NO,YES_SCORE,NO_SCORE,NOT_KNOWN_SCORE,EFF_STATUS FROM PH_ADR_QUESTION_LANG_VW WHERE UPPER(QUESTION_CODE) LIKE UPPER(?) AND UPPER(QUESTION_DESC) LIKE UPPER(?) AND UPPER(EFF_STATUS) LIKE UPPER(?) and LANGUAGE_ID like ?");
		dataMap.put("SQL_PH_ADR_CERTAINITY_SELECT_OVERLAP","SELECT DECODE(NVL(COUNT(*),0),0,'N','Y') OVERLAPS_YN   FROM   PH_ADR_CERTAINITY  WHERE CERTAINITY_CODE != 'E'    AND CERTAINITY_CODE !=?  AND       ( (? BETWEEN REL_SCORE_FROM AND REL_SCORE_TO ) or       (? BETWEEN REL_SCORE_FROM AND REL_SCORE_TO )  OR   ( REL_SCORE_FROM BETWEEN ? AND ?  ) or    (REL_SCORE_TO BETWEEN ? AND ?))");
		dataMap.put("SQL_PH_ADR_QUESTION_INSERT","INSERT INTO PH_ADR_QUESTION(QUESTION_CODE, QUESTION_DESC, YES_SCORE,NO_SCORE,NOT_KNOWN_SCORE,SEQ_NO, ADDED_BY_ID, ADDED_DATE , ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,EFF_STATUS)VALUES(?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)");
		dataMap.put("SQL_PH_ADR_QUESTION_SELECT","SELECT COUNT(ROWID) FROM PH_ADR_QUESTION WHERE QUESTION_CODE=?");
		dataMap.put("SQL_PH_ADR_QUESTION_UPDATE","UPDATE PH_ADR_QUESTION SET QUESTION_DESC=?,YES_SCORE=?,NO_SCORE=?,NOT_KNOWN_SCORE=?,SEQ_NO=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=?,EFF_STATUS=? WHERE QUESTION_CODE=?");
		dataMap.put("SQL_PH_ALLERGY_SEARCH_CODE","SELECT ALLERGY_TYPE_CODE code,LONG_DESC description FROM MR_ALLERGY_TYPE_LANG_VW WHERE ALLERGY_CLASS='D' AND EFF_STATUS='E' AND UPPER(ALLERGY_TYPE_CODE) LIKE UPPER(?) AND UPPER(LONG_DESC) LIKE UPPER(?) AND LANGUAGE_ID=");
		dataMap.put("SQL_PH_ADR_QUESTION_SELECT_OVERLAP","SELECT MIN(REL_SCORE_FROM) MIN_REL_SCORE,MAX(REL_SCORE_TO) MAX_REL_STORE FROM PH_ADR_CERTAINITY WHERE CERTAINITY_CODE!='E'");
//EDL classification
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_SELECT_ROWID","SELECT COUNT(ROWID) FROM  PH_EDL_CLASSIFICATIONS  WHERE EDL_CODE = UPPER(?) ");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_INSERT","INSERT INTO PH_EDL_CLASSIFICATIONS (EDL_CODE, DESCRIPTION, PARENT_CODE,EFF_STATUS,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)VALUES ( ?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_UPDATE","UPDATE PH_EDL_CLASSIFICATIONS SET DESCRIPTION=?, EFF_STATUS=? WHERE EDL_CODE=?");		
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_SELECT_PARENT","SELECT EDL_CODE, DESCRIPTION, EFF_STATUS, LEVEL, SYS_CONNECT_BY_PATH(EDL_CODE,'/') PATH,PARENT_CODE FROM  (SELECT * FROM PH_EDL_CLASSIFICATIONS_LANG_VW WHERE LANGUAGE_ID=?)  START WITH PARENT_CODE IS NULL CONNECT BY PRIOR EDL_CODE = PARENT_CODE");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_SELECT_LEAF_NODE","SELECT EDL_CODE FROM PH_EDL_CLASSIFICATIONS_LANG_VW  WHERE EDL_CODE NOT IN (SELECT DISTINCT PARENT_CODE FROM  PH_EDL_CLASSIFICATIONS_LANG_VW WHERE PARENT_CODE IS NOT NULL AND  LANGUAGE_ID=?) AND  LANGUAGE_ID=?");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_SELECT_PATH","SELECT PATH FROM (SELECT EDL_CODE,LEVEL L_LEVEL,SYS_CONNECT_BY_PATH(DESCRIPTION,'/') PATH ,PARENT_CODE  FROM  (SELECT * FROM PH_EDL_CLASSIFICATIONS_LANG_VW WHERE LANGUAGE_ID=?)  START WITH PARENT_CODE IS NULL CONNECT BY PRIOR EDL_CODE = PARENT_CODE)");
		dataMap.put("SQL_PH_DRUG_SELECT_EDL_CODES","SELECT EDL_CODES,EDL_REMARKS FROM PH_DRUG_LANG_VW WHERE DRUG_CODE = ? AND LANGUAGE_ID=?");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_SELECT_PATH1","SELECT PATH FROM(SELECT EDL_CODE,LEVEL L_LEVEL,SYS_CONNECT_BY_PATH(DESCRIPTION,'~') PATH  FROM  (SELECT * FROM PH_EDL_CLASSIFICATIONS_LANG_VW WHERE LANGUAGE_ID=?)  START WITH PARENT_CODE IS NULL CONNECT BY PRIOR EDL_CODE = PARENT_CODE)  WHERE  EDL_CODE IN");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_PARENT_SELECT","SELECT DESCRIPTION,LEVEL ,EDL_CODE,DECODE(PARENT_CODE,NULL,' ',PARENT_CODE) PARENT_CODE , EFF_STATUS FROM  (SELECT * FROM PH_EDL_CLASSIFICATIONS_LANG_VW WHERE LANGUAGE_ID=?)  CONNECT BY EDL_CODE = PRIOR PARENT_CODE START WITH EDL_CODE = ? ORDER BY LEVEL DESC");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_CHILD_SELECT","SELECT DESCRIPTION,LEVEL ,EDL_CODE,DECODE(PARENT_CODE,NULL,' ',PARENT_CODE) PARENT_CODE, EFF_STATUS FROM  (SELECT * FROM PH_EDL_CLASSIFICATIONS_LANG_VW WHERE LANGUAGE_ID=?)   START WITH PARENT_CODE = ? CONNECT BY PRIOR EDL_CODE = PARENT_CODE");
		dataMap.put("SQL_PH_EDL_TREE","SELECT EDL_CODE ,DESCRIPTION,DECODE(PARENT_CODE,NULL,' ',PARENT_CODE) PARENT_CODE, EFF_STATUS FROM (SELECT * FROM PH_EDL_CLASSIFICATIONS_LANG_VW WHERE LANGUAGE_ID=?)  START WITH PARENT_CODE IS NULL CONNECT BY PRIOR EDL_CODE = PARENT_CODE");
		dataMap.put("SQL_PH_EDL_CLASSIFICATIONS_LEAF_SELECT","SELECT EDL_CODE FROM PH_EDL_CLASSIFICATIONS WHERE EDL_CODE NOT IN (SELECT DISTINCT PARENT_CODE FROM   PH_EDL_CLASSIFICATIONS_LANG_VW WHERE PARENT_CODE IS NOT NULL AND LANGUAGE_ID=?)");

//dispense time table
  		dataMap.put("SQL_PH_DISP_LOCN_TIME_SELECT","SELECT (SELECT LONG_DESC FROM PH_DISP_LOCN_LANG_VW B WHERE A.DISP_LOCN_CODE = B.DISP_LOCN_CODE AND A.FACILITY_ID = B.FACILITY_ID AND B.LANGUAGE_ID = ?) LONG_DESC, DECODE (A.DAY_TYPE,0, 'ALLDAYS', 1, 'MONDAY',2, 'TUESDAY',3, 'WEDNESDAY',4, 'THURSDAY',5, 'FRIDAY',6, 'SATURDAY',7, 'SUNDAY',8, 'WORKINGDAYS',9, 'HOLIDAYS') DAY_TYPE ,TO_CHAR (A.FROM_TIME, 'HH24:MI') FROM_TIME, TO_CHAR (A.TO_TIME, 'HH24:MI') TO_TIME  FROM PH_DISP_LOCN_TIME_TABLE A WHERE A.DISP_LOCN_CODE LIKE NVL(?,'%') AND A.DAY_TYPE LIKE NVL(?,'%')");
		dataMap.put("SQL_PH_DISP_LOCN_TIME_SELECT1","select DISP_LOCN_CODE, LONG_DESC from ph_disp_locn_lang_vw where facility_id = ? and eff_status = 'E' and language_id = ? order by long_desc");
		dataMap.put("SQL_PH_DISP_LOCN_TIME_SELECT2","Select -3 DISP_SEQ, '0' DAY_TYPE_CODE,'ALLDAYS' DAY_TYPE_LEGEND,null FROM_TIME_HH, null FROM_TIME_MM, null TO_TIME_HH,null TO_TIME_MM,'I' DB_ACTION FROM DUAL WHERE 0 NOT IN (SELECT DAY_TYPE FROM PH_DISP_LOCN_TIME_TABLE WHERE FACILITY_ID=? AND DISP_LOCN_CODE = ? AND DAY_TYPE = 0) UNION ALL Select -2 DISP_SEQ, '9' DAY_TYPE_CODE,'HOLIDAYS' DAY_TYPE_LEGEND,null FROM_TIME_HH, null FROM_TIME_MM, null TO_TIME_HH,null TO_TIME_MM,'I' DB_ACTION  FROM DUAL WHERE 9 NOT IN (SELECT DAY_TYPE FROM PH_DISP_LOCN_TIME_TABLE WHERE FACILITY_ID=? AND DISP_LOCN_CODE = ? AND DAY_TYPE = 9) UNION ALL Select -1 DISP_SEQ, '8' DAY_TYPE_CODE,'WORKINGDAYS' DAY_TYPE_LEGEND,null FROM_TIME_HH, null FROM_TIME_MM, null TO_TIME_HH,null TO_TIME_MM,'I' DB_ACTION FROM DUAL WHERE 8 NOT IN (SELECT DAY_TYPE FROM PH_DISP_LOCN_TIME_TABLE WHERE FACILITY_ID=? AND DISP_LOCN_CODE = ? AND DAY_TYPE = 8) UNION ALL SELECT TO_NUMBER(DAY_NO) DISP_SEQ, DAY_NO DAY_TYPE_CODE,DAY_OF_WEEK DAY_TYPE_LEGEND,null FROM_TIME_HH, null FROM_TIME_MM, null TO_TIME_HH,null TO_TIME_MM,'I' DB_ACTION FROM SM_DAY_OF_WEEK WHERE DAY_NO NOT IN (SELECT DAY_TYPE FROM PH_DISP_LOCN_TIME_TABLE WHERE FACILITY_ID=? AND DISP_LOCN_CODE = ?) UNION ALL SELECT A.DAY_TYPE DISP_SEQ, TO_CHAR(A.DAY_TYPE) DAY_TYPE_CODE, B.DAY_OF_WEEK,    TO_CHAR(A.FROM_TIME,'HH24') FROM_TIME_HH, TO_CHAR(A.FROM_TIME,'MI') FROM_TIME_MM, TO_CHAR(A.TO_TIME,'HH24') TO_TIME_HH, TO_CHAR(A.TO_TIME,'MI') TO_TIME_MM,'U' DB_ACTION FROM PH_DISP_LOCN_TIME_TABLE A, SM_DAY_OF_WEEK B WHERE a.FACILITY_ID=? AND a.DISP_LOCN_CODE = ? AND A.DAY_TYPE = B.DAY_NO UNION ALL SELECT A.DAY_TYPE DISP_SEQ, TO_CHAR(A.DAY_TYPE) DAY_TYPE_CODE, DECODE(A.DAY_TYPE,'0','ALLDAYS','9','HOLIDAYS','8','WORKINGDAYS') DAY_OF_WEEK, TO_CHAR(A.FROM_TIME,'HH24') FROM_TIME_HH, TO_CHAR(A.FROM_TIME,'MI') FROM_TIME_MM, TO_CHAR(A.TO_TIME,'HH24') TO_TIME_HH, TO_CHAR(A.TO_TIME,'MI') TO_TIME_MM, 'U' DB_ACTION FROM PH_DISP_LOCN_TIME_TABLE A WHERE a.FACILITY_ID=? AND a.DISP_LOCN_CODE = ? and  A.DAY_TYPE in (0,8,9) ORDER BY DAY_TYPE_CODE");
		dataMap.put("SQL_PH_DISP_LOCN_TIME_INSERT","INSERT INTO PH_DISP_LOCN_TIME_TABLE(FACILITY_ID, DISP_LOCN_CODE, DAY_TYPE, SRL_NO, FROM_TIME, TO_TIME,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID)VALUES(?,?,?,1,TO_DATE(TO_CHAR(SYSDATE,'DDMMYYYY')||?||?,'DDMMYYYYHH24MI'), TO_DATE(TO_CHAR(SYSDATE,'DDMMYYYY')||?||?,'DDMMYYYYHH24MI'),?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_DISP_LOCN_TIME_UPDATE","UPDATE PH_DISP_LOCN_TIME_TABLE SET FROM_TIME = TO_DATE(TO_CHAR(SYSDATE,'DDMMYYYY')||?||?,'DDMMYYYYHH24MI'),TO_TIME   =TO_DATE(TO_CHAR(SYSDATE,'DDMMYYYY')||?||?,'DDMMYYYYHH24MI'),MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE FACILITY_ID = ? AND DISP_LOCN_CODE = ?AND DAY_TYPE = ?");
		dataMap.put("SQL_PH_TOKEN_LIST_SELECT","Select distinct  b.long_desc disp_locn_desc, c.description token_series_desc, a. token_serial_no, a.patient_id, a.DISP_LOCN_CODE, a.TOKEN_SERIES_CODE,  a.FACILITY_ID from or_order x, ph_ord_for_disp_queue a, ph_disp_locn_lang_vw b, ph_token_series_lang_vw c Where x.trn_group_ref  = ? And a.facility_id = b.facility_id And a.disp_locn_code = b.disp_locn_code AND a.queue_date = trunc(sysdate) and a.queue_shift = '*ALL' and a.order_id = x.order_id and a.facility_id = c.facility_id and a.disp_locn_code = c.disp_locn_code And a.token_series_code = c.token_series_code and b.language_id = ? and c.language_id = ? order by 2,4,5");

//Holiday		  
		dataMap.put("SQL_PH_HOLIDAY_LOAD_SELECT","SELECT TO_CHAR(HOLIDAY_DATE,'DD/MM/YYYY') HOLIDAY_DATE,REASON FROM PH_HOLIDAY_LANG_VW WHERE LANGUAGE_ID=?");
		dataMap.put("SQL_PH_HOLIDAY_INSERT","INSERT INTO PH_HOLIDAY(HOLIDAY_DATE,REASON,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)VALUES(to_date(?,'dd/mm/yyyy'),?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_HOLIDAY_UPDATE","UPDATE PH_HOLIDAY SET REASON =?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE HOLIDAY_DATE=TO_DATE(?,'DD/MM/YYYY')");
		dataMap.put("SQL_PH_HOLIDAY_DELETE","DELETE FROM PH_HOLIDAY WHERE HOLIDAY_DATE=TO_DATE(?,'DD/MM/YYYY')");
		dataMap.put("SQL_PH_HOLIDAY_SELECT","SELECT HOLIDAY_DATE,REASON FROM PH_HOLIDAY WHERE HOLIDAY_DATE=to_date(?,'dd/mm/yyyy')");
		dataMap.put("SQL_PH_HOLIDAY_COUNT_SELECT","SELECT COUNT(ROWID) COUNT FROM PH_HOLIDAY WHERE HOLIDAY_DATE=TO_DATE(?,'DD/MM/YYYY')");
//RE-ROUTE PRESCRUIPTION

		dataMap.put("SQL_PH_RE_ROUTE_ORDER_SELECT","SELECT A.ORDER_ID, TO_CHAR(A.ORD_DATE_TIME, 'DD/MM/YYYY HH24:MI') ORDER_DATE, B.SHORT_DESC ORDER_STATUS_DESC, C.SHORT_DESC CURR_DISP_LOCN_DESC, A.TRN_GROUP_REF,A.ORDER_STATUS,(SELECT DECODE(NVL(COUNT(*),0),0,'N','Y') FROM OR_ORDER_LINE_PH D WHERE D.ORDER_ID = A.ORDER_ID AND D.NEXT_COLLECTION_DATE IS NOT NULL)  BMS_ORDER_YN FROM OR_ORDER A, OR_ORDER_STATUS_CODE_LANG_VW B, PH_DISP_LOCN_LANG_VW C WHERE A.PATIENT_ID = ?   AND A.ORDER_CATEGORY = 'PH'AND A.ORD_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI') AND A.PERFORMING_DEPTLOC_CODE = ?  AND A.ORDER_ID = NVL(?,A.ORDER_ID) AND A.ORDER_STATUS IN ('OS','DP','RG','VF','DD') AND A.ORDER_STATUS = B.ORDER_STATUS_CODE AND B.LANGUAGE_ID = ? AND C.FACILITY_ID = A.PERFORMING_FACILITY_ID AND C.DISP_LOCN_CODE = A.PERFORMING_DEPTLOC_CODE  AND C.LANGUAGE_ID = ? ORDER BY A.ORDER_ID");//'DD' ADDED FOR MMS-KH-CRF-0014
		dataMap.put("SQL_PH_RE_ROUTE_DISP_LOCN_SELECT","SELECT A.DISP_LOCN_CODE, A.SHORT_DESC  FROM PH_DISP_LOCN_LANG_VW A WHERE A.FACILITY_ID =? AND A.EFF_STATUS = 'E' AND A.LANGUAGE_ID =? AND EXISTS (SELECT B.DISP_LOCN_CODE FROM PH_DISP_RIGHTS B WHERE B.FACILITY_ID =? AND B.APPL_USER_ID =? AND B.DISP_LOCN_CODE = A.DISP_LOCN_CODE  AND B.REROUTE_ORDER_YN ='Y') ORDER BY A.SHORT_DESC");
		dataMap.put("SQL_PH_RE_ROUTE_SM_FACILITY_SELECT","SELECT FACILITY_ID, FACILITY_NAME FROM SM_FACILITY_PARAM_LANG_VW  WHERE FACILITY_ID = ? AND STATUS = 'E' AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_RE_ROUTE_MEDN_TRN_REASON_SELECT","SELECT REASON_CODE, REASON_DESC FROM PH_MEDN_TRN_REASON_LANG_VW  WHERE APPL_TRN_TYPE = 'RR'  AND EFF_STATUS = 'E' and LANGUAGE_ID = ? ORDER BY REASON_DESC ");
		dataMap.put("SQL_PH_RE_ROUTE_DISP_LOCN_SELECT_LOOKUP","SELECT A.DISP_LOCN_CODE CODE, A.SHORT_DESC DESCRIPTION FROM PH_DISP_LOCN_LANG_VW A WHERE  UPPER(A.DISP_LOCN_CODE) LIKE UPPER(?) AND UPPER(A.SHORT_DESC) LIKE UPPER(?) AND A.EFF_STATUS = 'E'");
		dataMap.put("SQL_PH_DISP_DIRDISP_SELECT","Select DIR_DISP_ALLOWED from ph_facility_param where facility_id = ? ");
		dataMap.put("SQL_PH_AGE_GROUP_FOR_DRUG_INSERT","insert into PH_DRUG_AGE_GROUP (DRUG_CODE, AGE_GROUP_CODE,  ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,WT_MAND_YN,DRUG_APPL_YN,EFF_STATUS,HT_MAND_YN)values(?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?) ");
		dataMap.put("SQL_PH_AGE_GROUP_FOR_DRUG_UPDATE","UPDATE PH_DRUG_AGE_GROUP SET  EFF_STATUS=?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? , WT_MAND_YN=?,DRUG_APPL_YN=? , HT_MAND_YN=? WHERE DRUG_CODE = ? AND  AGE_GROUP_CODE = ?");
		dataMap.put("SQL_PH_AGE_GROUP_FOR_DRUG_SELECT","SELECT a.AGE_GROUP_CODE AGE_GROUP_CODE, a.SHORT_DESC SHORT_DESC, a.MIN_AGE MIN_AGE, a.MAX_AGE MAX_AGE, a.AGE_UNIT AGE_UNIT,  b.EFF_STATUS EFF_STATUS, Nvl(a.GENDER,'A') GENDER,b.WT_MAND_YN WT_MAND_YN,b.DRUG_APPL_YN DRUG_APPL_YN ,b.HT_MAND_YN HT_MAND_YN FROM   AM_AGE_GROUP_LANG_VW a ,PH_DRUG_AGE_GROUP b WHERE a.AGE_GROUP_CODE=b.AGE_GROUP_CODE AND  b.DRUG_CODE =? AND a.LANGUAGE_ID=?");
		dataMap.put("SQL_PH_AGE_GROUP_SELECT","SELECT AGE_GROUP_CODE, SHORT_DESC, MIN_AGE,MAX_AGE, AGE_UNIT, GENDER FROM AM_AGE_GROUP_lang_vw WHERE  EFF_STATUS ='E' and language_id=?");
		dataMap.put("SQL_PH_DISP_STAT_AGE_GROUP_SELECT1","SELECT DISP_LOCN_CODE CODE, SHORT_DESC DESCRIPTION FROM PH_DISP_LOCN_LANG_VW WHERE FACILITY_ID like ? and DISP_LOCN_TYPE ='P'AND UPPER(DISP_LOCN_CODE) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?)  AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DISP_STAT_AGE_GROUP_SELECT2","SELECT RANGE_ID CODE, SHORT_DESC DESCRIPTION FROM AM_SUMM_RANGE_LANG_VW WHERE  RANGE_TYPE = 'A' AND EFF_STATUS = 'E' AND UPPER(RANGE_ID) LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?)  AND LANGUAGE_ID = ");
		dataMap.put("SQL_PH_DISP_STAT_AGE_GROUP_SELECT3","SELECT STAT_GRP_ID CODE, STAT_GRP_DESC DESCRIPTION FROM AM_STAT_GROUP WHERE  STAT_GRP_CAT = 'N' AND UPPER(STAT_GRP_ID) LIKE UPPER(?) AND UPPER(STAT_GRP_DESC) LIKE UPPER(?) ");
//sliding scale master
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_SELECT","Select TEMPLATE_ID, TEMPLATE_DESC, RANGE_UOM_CODE,ADMIN_UNITS_UOM_CODE, EFF_STATUS from PH_SLIDING_SCALE_TMPL where UPPER(TEMPLATE_ID) like UPPER(?) and UPPER(TEMPLATE_DESC) like UPPER(?) and UPPER(RANGE_UOM_CODE) like UPPER(?) and UPPER(ADMIN_UNITS_UOM_CODE) like UPPER(?) and UPPER(EFF_STATUS) like UPPER(?)");
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_DTL_SELECT","SELECT SRL_NO,DISP_SEQ_NO,RANGE_FROM,RANGE_TO,ADMIN_UNITS,INFORM_TO_PRACT,REMARKS,EFF_STATUS  FROM PH_SLIDING_SCALE_TMPL_DTL  WHERE  TEMPLATE_ID   like upper(?) ");
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_DTL_INSERT","INSERT INTO PH_SLIDING_SCALE_TMPL_DTL (TEMPLATE_ID, SRL_NO, DISP_SEQ_NO, RANGE_FROM, RANGE_TO,ADMIN_UNITS,INFORM_TO_PRACT,REMARKS, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_INSERT","INSERT INTO PH_SLIDING_SCALE_TMPL (TEMPLATE_ID, TEMPLATE_DESC, RANGE_UOM_CODE,ADMIN_UNITS_UOM_CODE, EFF_STATUS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) ");
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_UPDATE","UPDATE PH_SLIDING_SCALE_TMPL SET TEMPLATE_DESC = ?,  EFF_STATUS = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE TEMPLATE_ID = ? "); 
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_DTL_DELETE","DELETE  FROM  PH_SLIDING_SCALE_TMPL_DTL WHERE TEMPLATE_ID=?");
		dataMap.put("SQL_PH_SLIDING_SCALE_TMPL_SELECT2","SELECT TEMPLATE_ID FROM PH_SLIDING_SCALE_TMPL WHERE EFF_STATUS='D'");

		// Edit Label
		dataMap.put("SQL_PH_EDIT_LABEL_TEXT_ID_SELECT","SELECT LABEL_TEXT_ID,LABEL_TEXT_1, LANGUAGE_ID FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE LABEL_TEXT_1= ? AND LANGUAGE_ID = 'en'");

		dataMap.put("SQL_PH_EDIT_LABEL_TEXT_SELECT","SELECT LABEL_TEXT_ID,LABEL_TEXT_1, LANGUAGE_ID FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE  LABEL_TEXT_ID= ? AND LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_IVPRESCRIPTION_MFR_INSERT","INSERT INTO OR_ORDER_LINE_PH_MFR (ORDER_ID, ORDER_LINE_NUM, SL_NO, TOT_STRENGTH, TOT_STRENGTH_UOM, INFUSE_OVER, INFUSE_OVER_UNIT, INFUSION_RATE, INFUSION_VOL_STR_UNIT, INFUSION_PER_UNIT,GAP_DURATION_IN_HRS, ADMIN_RATE_DETAIL,SCH_START_DATE_TIME,SCH_END_DATE_TIME, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),?,sysdate,?,?,?,sysdate,?,?)");

		dataMap.put("SQL_PH_RETMEDICATION_ENCOUNTER_SELECT","SELECT ENCOUNTER_ID FROM pr_encounter WHERE patient_id= ? AND ((?='I' AND  PATIENT_CLASS IN ('IP', 'DC'))OR (?='O' AND PATIENT_CLASS IN ('OP', 'EM'))) AND FACILITY_ID = ? Union SELECT distinct( encounter_id) FROM OR_order WHERE patient_id = ? AND (? = 'O' and patient_class = 'OP') and discharge_IND='D' and ORDERING_FACILITY_ID =? order by encounter_id desc");

		dataMap.put("SQL_PH_RETMEDICATION_CURRENT_ENCOUNTER_SELECT","SELECT distinct(a.ENCOUNTER_ID) FROM ph_disp_hdr a WHERE a.facility_id = ? AND a.patient_id= ? and exists (select 'X' from ip_open_encounter where facility_id = a.facility_id and encounter_id = a.encounter_id)");
		dataMap.put("SQL_PH_DISPMEDN_FILLED_DISPQTY_SELECT","select DISP_QTY from ph_disp_dtl_tmp where order_id =? and DISP_TMP_NO=?");
		dataMap.put("SQL_PH_DISPMEDN_DELEVERED_DISPQTY_SELECT","select DISP_QTY from ph_disp_dtl where order_id =? and DISP_NO=?");
		dataMap.put("SQL_PH_DISPMEDN_BMS_REASONS_SELECT","select reason_code,reason_desc,remarks from PH_MEDN_TRN_REASON_LANG_VW where appl_trn_type = 'BR' and eff_Status = 'E' and language_id = ? order by 2");

		//  RUT-CRF-0062 [IN029600] For Build MAR Rules    -- begin
		dataMap.put("SQL_PH_BUILD_MAR_RULE_PAT_CLASS","SELECT DECODE(IP_MAR_RULE_YN,'Y','IP','N')||'~'||DECODE(OP_MAR_RULE_YN,'Y','OP','N')||'~'||DECODE(DC_MAR_RULE_YN,'Y','DC','N')||'~'||DECODE(EM_MAR_RULE_YN,'Y','EM','N')||'~'||DECODE(DM_MAR_RULE_YN,'Y','DM','N') AS BUILD_MAR_INIT_VALUES FROM PH_FACILITY_PARAM WHERE FACILITY_ID = ?");		
		dataMap.put("SQL_PH_BUILD_MAR_RULE_LOCATION1","SELECT NURSING_UNIT_CODE AS LOCATION_CODE, SHORT_DESC FROM IP_NURSING_UNIT_LANG_VW WHERE FACILITY_ID =? AND LANGUAGE_ID=? ORDER BY SHORT_DESC");		
		dataMap.put("SQL_PH_BUILD_MAR_RULE_LOCATION2","SELECT CLINIC_CODE AS LOCATION_CODE, SHORT_DESC FROM OP_CLINIC_LANG_VW WHERE FACILITY_ID =? AND LANGUAGE_ID=? ORDER BY SHORT_DESC ");		
		dataMap.put("SQL_PH_BUILD_MAR_RULE_FORM","SELECT DECODE(FORM_CODE,NULL,'',FORM_CODE) AS FORM_CODE, DECODE(FORM_DESC,NULL,'',FORM_DESC) AS FORM_DESC FROM PH_FORM_LANG_VW WHERE LANGUAGE_ID=? AND LANGUAGE_ID=? AND EFF_STATUS='E' ORDER BY FORM_DESC");		
		dataMap.put("SQL_PH_BUILD_MAR_RULE_INSERT","INSERT INTO PH_BUILD_MAR_RULE (FACILITY_ID,PATIENT_CLASS,SOURCE_CODE,FORM_CODE,PRIORITY,BUILD_MAR_INDICATOR,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");		
		dataMap.put("SQL_PH_BUILD_MAR_RULE_INSERT_CHECK","SELECT COUNT(ROWID) FROM PH_BUILD_MAR_RULE WHERE FACILITY_ID = UPPER(?) AND PATIENT_CLASS = UPPER(?) AND SOURCE_CODE = UPPER(?)  AND FORM_CODE = UPPER(?) AND PRIORITY = UPPER(?)");	
		dataMap.put("SQL_PH_BUILD_MAR_RULE_MOD_DATA","SELECT PATIENT_CLASS,SOURCE_CODE,FORM_CODE,PRIORITY FROM PH_BUILD_MAR_RULE WHERE FACILITY_ID = UPPER(?) AND PATIENT_CLASS = UPPER(?) AND SOURCE_CODE = UPPER(?)  AND FORM_CODE = UPPER(?) AND PRIORITY = UPPER(?)");
		dataMap.put("SQL_PH_BUILD_MAR_RULE_QUERY_RESULT","SELECT  A.PATIENT_CLASS, NVL( B.SHORT_DESC, 'ALL') LOC_DESC, NVL(C.FORM_DESC,'ALL') FORM_DESC, A.PRIORITY, A.BUILD_MAR_INDICATOR, A.FORM_CODE, A.SOURCE_CODE  FROM PH_BUILD_MAR_RULE A,(SELECT FACILITY_ID,CLINIC_CODE SOURCE_CODE,SHORT_DESC SHORT_DESC,LANGUAGE_ID FROM OP_CLINIC_LANG_VW UNION SELECT FACILITY_ID,NURSING_UNIT_CODE SOURCE_CODE,SHORT_DESC SHORT_DESC,LANGUAGE_ID  FROM IP_NURSING_UNIT_LANG_VW) B, PH_FORM_LANG_VW C WHERE A.FACILITY_ID =? AND C.FORM_CODE(+) = A.FORM_CODE AND C.LANGUAGE_ID (+) = ? AND B.LANGUAGE_ID (+) = ? AND A.FACILITY_ID = B.FACILITY_ID(+) AND A.SOURCE_CODE = B.SOURCE_CODE (+) AND NVL(B.SHORT_DESC,'*A') LIKE (?) AND (NVL(C.FORM_CODE,'*A') LIKE UPPER (?) OR UPPER (C.FORM_DESC) LIKE UPPER (?)) AND A.BUILD_MAR_INDICATOR = DECODE (?, '*A', A.BUILD_MAR_INDICATOR, ?) AND (A.PATIENT_CLASS) = DECODE (UPPER (?),'', A.PATIENT_CLASS,UPPER (?)) AND A.PRIORITY=DECODE(UPPER(?),'A',A.PRIORITY,UPPER(?)) ");
		dataMap.put("SQL_PH_BUILD_MAR_RULE_UPDATE","UPDATE PH_BUILD_MAR_RULE SET BUILD_MAR_INDICATOR=?, MODIFIED_BY_ID= ?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE FACILITY_ID=? AND  PATIENT_CLASS=? AND SOURCE_CODE=? AND FORM_CODE=? AND PRIORITY=?");		
		//  RUT-CRF-0062 [IN029600]   For Build MAR Rules -- end
		dataMap.put("SQL_BUILD_MAR_RULE","SELECT PH_GET_BUILD_MAR_RULE(?,?,?,?,?) BUILD_MAR_RULE FROM DUAL");
		dataMap.put("SQL_PH_ATC_LEVEL_ALLERGY_CHECK","SELECT PH_ATC_ALLERGY_CHECK(?,?,?) ATC_CHECK_EXISTS FROM DUAL");
		dataMap.put("SQL_PH_SELECT_ATC_ALLERGY_GENERIC_NAME","SELECT GENERIC_NAME FROM PH_GENERIC_NAME_LANG_VW where GENERIC_ID=? AND LANGUAGE_ID=?");
		dataMap.put("SQL_PH_DISP_MEDICATION_TAB_BASED_GROUP_SORT","SELECT TAB_BASED_GROUP_SORT_DISP FROM PH_FACILITY_PARAM where FACILITY_ID=? ");

		dataMap.put("SQL_PH_SELECT_NPB_REQUEST_FORM_LIST","select consent_form_id, consent_form_label from OR_CONSENT_FORM_LANG_VW where consent_type='N' and eff_status='E' and language_id=? order by consent_form_label");
		dataMap.put("SQL_PH_NPB_REQUEST_FORM_CONTENT","select CONSENT_FORM_CONTENT, CONSENT_FORMAT from or_consent_form  where Consent_form_id = (?)");
		dataMap.put("SQL_PH_NPB_REQ_FORM_PATIENT_TEMPLATE_SELECT", "SELECT patient_id,  SM_CONVERT_DATE_2T( (to_date(added_date,'DD/MM/YYYY HH24:MI')), ?) regn_date, decode(?,'en',PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,PATIENT_NAME)) patient_name, DECODE (sex,'F', 'Female','M', 'Male','Other') gender, sex,TO_CHAR ((sm_convert_date (date_of_birth, ?)),'DD/MM/YYYY') date_of_birth,mar_status_desc mar_status_code, nationality_desc nationality_code,regn_facility_name facility_name, res_area_desc res_area_code,res_town_desc res_town_code, relgn_desc relgn_code, name_prefix, region_desc region_code, blood_grp, rh_factor,TO_CHAR((SM_CONVERT_DATE(SYSDATE, ?)),'DD/MM/YYYY HH24:MI') sys_date_time, resi_addr_line1 || '  ' || resi_addr_line2 || '  ' || resi_addr_line3 || '  ' || resi_addr_line4 || '  ' || res_area_desc || '  ' || res_town_desc || '  ' || res_area_desc || '  ' || resi_postal_code || '  ' || resi_country_name residentail_address,get_age (date_of_birth) age, national_id_no national_id_no FROM mp_chg_pat_dtls_vw WHERE patient_id = ?");//modified for  ML-MMOH-SCF-1860
	    dataMap.put("SQL_PH_NPB_REQ_FORM_ENCOUNTER_TEMPLATE_SELECT", "SELECT encounter_id,AM_GET_DESC.AM_CARE_LOCN_TYPE(assign_care_locn_type,?,'2') || '/' || case when assign_care_locn_type in ('N') then ip_get_desc.ip_nursing_unit(?,ASSIGN_CARE_LOCN_CODE,?,'2') else op_get_desc.op_clinic(?,ASSIGN_CARE_LOCN_CODE,?,'2') end current_location,   AM_GET_DESC.AM_PRACTITIONER(ATTEND_PRACTITIONER_ID,?,'2') attending_practitioner, AM_GET_DESC.AM_SPECIALITY(SPECIALTY_CODE,'en','2') speciality,  sm_convert_date_2t ( (to_date(visit_adm_date_time,'DD/MM/YYYY HH24:MI')), ?) admission_date,AM_GET_DESC.AM_PATIENT_CLASS(patient_class,?,'2') patient_class,assign_room_num room_num, assign_bed_num bed_num,AM_GET_DESC.AM_SERVICE(service_code,?,'2') service_code FROM pr_encounter WHERE facility_id = ? AND encounter_id =?");//modified for  ML-MMOH-SCF-1860 
        dataMap.put("SQL_PH_NPB_REQ_FORM_AGE_GROUP_SELECT", "SELECT COUNT(age_group_code) FROM am_age_group WHERE age_group_code=? AND NVL(gender, ?)= ? AND TRUNC(sysdate)-TRUNC(to_date(?,'dd/mm/yyyy')) BETWEEN DECODE(age_unit,'Y',365,'M',30,1)*min_age and decode(age_unit,'Y',365,'M',30,1)*max_age and  eff_status='E' ");
		dataMap.put("SQL_PH_SELECT_NPB_REQUEST_NO", "SELECT PH_NPB_DRUG_REQUEST_SEQ.NEXTVAL PH_NPB_REQ_NO FROM DUAL");
		dataMap.put("SQL_PH_SELECT_NPB_REQUEST_CANCEL_REASON","select reason_code,reason_desc from PH_MEDN_TRN_REASON_LANG_VW where appl_trn_type = 'CN' and eff_Status = 'E' and language_id = ? order by 2");
		dataMap.put("SQL_PH_SELECT_DRUG_QTY_DTL", "SELECT FORM_CODE, PRES_BASE_UOM FROM PH_DRUG WHERE DRUG_CODE=?");
		dataMap.put("SQL_PH_SELECT_NPB_DRUG_LOOKUP", "SELECT  drug_code code, drug_desc description FROM ph_drug_vw_lang_vw WHERE NPB_DRUG_YN ='Y' and  LANG1 =? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ?  AND UPPER (drug_code) LIKE UPPER (?) AND UPPER (drug_desc) LIKE UPPER (?) ORDER BY 2");
		dataMap.put("SQL_PH_SELECT_NPB_ORDERINFDTL", "select CASE WHEN ? IN ('IP', 'DC') THEN ip_get_desc.ip_nursing_unit (?, ?, ?, '1' ) ELSE op_get_desc.op_clinic (?, ?, ?, '1' ) END location_description,  am_get_desc.am_practitioner (?, ?, '1' ) ordering_practitioner, or_get_desc.or_order_type (?, ?, '2') order_type, or_get_desc.or_order_category (?, ?, '2') order_category from dual ");
		dataMap.put("SQL_PH_SELECT_NPB_DRUG_LOOKUP", "SELECT  drug_code code, drug_desc description FROM ph_drug_vw_lang_vw WHERE NPB_DRUG_YN ='Y' and  LANG1 =? AND DECODE(LANG2,NULL,?,LANG2)= ? AND  DECODE(LANG3,NULL,?,LANG3)= ? AND UPPER (drug_code) LIKE UPPER (?) AND UPPER (drug_desc) LIKE UPPER (?)  ORDER BY 2 ");
		dataMap.put("JNDI_PH_NPBREQUEST", "java:comp/env/NPBRequest");
		//	RUT-CRF-0066 - Drug Interaction - START
		//LAB_ORD_CHK_UPTO_NO_OF_DAYS added for MMS-KH-CRF-0034
		dataMap.put("SQL_PH_INSERT_DRUG_INT_DTL", "INSERT INTO PH_DRUG_INTERACTION(INTR_TYPE1,INTR_TYPE2,INTR_CODE1,INTR_CODE2,INTR_SEVERITY_LEVEL,INTR_SIGNIF_LEVEL,INTR_PROB_LEVEL,INTR_RESTRT_YN,INTR_REMARKS,EFF_STATUS,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID, form_code1, form_code2,LAB_ORD_CHK_UPTO_NO_OF_DAYS,TERM_SET_ID) VALUES(?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?, ?,?,?,?)");//,TERM_SET_ID Added for MMS-DM-CRF-0229
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_DRUG", "SELECT intr_code1, d1.drug_desc intr_name1, form_code1,(select form_desc from ph_form_lang_vw where form_code=b.form_code1 and language_id=d1.language_id) form_desc1, intr_code2, d2.drug_desc intr_name2, form_code2, (select form_desc from ph_form_lang_vw where form_code=b.form_code2 and language_id=d2.language_id) form_desc2, b.intr_severity_level, b.intr_signif_level, b.intr_prob_level,INTR_RESTRT_YN,INTR_REMARKS, b.eff_status FROM ph_drug_interaction b, ph_drug_lang_vw d1, ph_drug_lang_vw d2  WHERE b.intr_code1 LIKE (?) AND b.intr_code2 LIKE (?) and upper(d1.drug_desc) LIKE upper(?) AND upper(d2.drug_desc) LIKE upper(?) and b.intr_code1 = d1.drug_code  and b.intr_code2 = d2.drug_code AND b.intr_severity_level like(?) AND b.intr_signif_level like(?) AND b.intr_prob_level like(?) AND b.eff_status LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') and d1.language_id=? and d2.language_id=? ");
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_GNERIC", "SELECT intr_code1, d1.generic_name intr_name1, form_code1,(select form_desc from ph_form_lang_vw where form_code=b.form_code1 and language_id=d1.language_id) form_desc1, intr_code2, d2.generic_name intr_name2, form_code2, (select form_desc from ph_form_lang_vw where form_code=b.form_code2 and language_id=d2.language_id) form_desc2, b.intr_severity_level, b.intr_signif_level, b.intr_prob_level,INTR_RESTRT_YN,INTR_REMARKS, b.eff_status FROM ph_drug_interaction b, ph_generic_name_lang_vw d1, ph_generic_name_lang_vw d2  WHERE b.intr_code1 LIKE (?) AND b.intr_code2 LIKE (?) and upper(d1.generic_name) LIKE upper(?) AND upper(d2.generic_name) LIKE upper(?) and b.intr_code1 = d1.generic_id  and b.intr_code2 = d2.generic_id AND b.intr_severity_level like(?) AND b.intr_signif_level like(?) AND b.intr_prob_level like(?) AND b.eff_status LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') and d1.language_id=? and d2.language_id=?");
		dataMap.put("SQL_PH_DRUG_INT_SELECT_QUERY", "SELECT COUNT(ROWID) from ph_drug_interaction where intr_type1=? and intr_type2=? and intr_code1=? and intr_code2=? and form_code1=? and form_code2=?");
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_DRUG", "SELECT INTR_TYPE1, INTR_TYPE2, intr_code1, d1.drug_desc intr_name1, form_code1, decode(form_code1, '*A', 'All',(select form_desc from ph_form_lang_vw where form_code=b.form_code1 and language_id=d1.language_id)) form_desc1, intr_code2, d2.drug_desc intr_name2, form_code2,decode(form_code2, '*A', 'All',(select form_desc from ph_form_lang_vw where form_code=b.form_code2 and language_id=d2.language_id)) form_desc2, b.intr_severity_level, b.intr_signif_level, b.intr_prob_level,INTR_RESTRT_YN,INTR_REMARKS, b.eff_status FROM ph_drug_interaction b, ph_drug_lang_vw d1, ph_drug_lang_vw d2 WHERE b.INTR_TYPE1 = ? AND b.INTR_TYPE2 = ? and b.intr_code1 =? AND b.intr_code2 =? and b.form_code1 =? AND b.form_code2 =? AND b.intr_code1 = d1.drug_code and b.intr_code2 = d2.drug_code and d1.language_id=? and d2.language_id=? ");
	//LAB_ORD_CHK_UPTO_NO_OF_DAYS added for MMS-KH-CRF-0034
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_GENERIC", "SELECT INTR_TYPE1, INTR_TYPE2,intr_code1, d1.generic_name intr_name1, form_code1, decode(form_code1, '*A', 'All',(select form_desc from ph_form_lang_vw where form_code=b.form_code1 and language_id=d1.language_id)) form_desc1, intr_code2, d2.generic_name intr_name2, form_code2, decode(form_code2, '*A', 'All',(select form_desc from ph_form_lang_vw where form_code=b.form_code2 and language_id=d2.language_id)) form_desc2, b.intr_severity_level, b.intr_signif_level, b.intr_prob_level,INTR_RESTRT_YN,INTR_REMARKS, b.eff_status,LAB_ORD_CHK_UPTO_NO_OF_DAYS FROM ph_drug_interaction b, ph_generic_name_lang_vw d1, ph_generic_name_lang_vw d2 WHERE b.INTR_TYPE1 = ? AND b.INTR_TYPE2 = ? AND b.intr_code1 = ? AND b.intr_code2= ? AND b.form_code1 = ? AND b.form_code2= ? AND  b.intr_code1 = d1.generic_id AND b.intr_code2 = d2.generic_id AND d1.language_id = ? AND d2.language_id = ?");
	//LAB_ORD_CHK_UPTO_NO_OF_DAYS added for MMS-KH-CRF-0034
		dataMap.put("SQL_PH_DRUG_INT_UPDATE_QUERY", "update PH_DRUG_INTERACTION set  intr_severity_level= ? , intr_signif_level=?,  intr_prob_level=?,INTR_RESTRT_YN=?,INTR_REMARKS=?,  eff_status=? , modified_date=SYSDATE , modified_facility_id=?, modified_at_ws_no=? ,LAB_ORD_CHK_UPTO_NO_OF_DAYS=? where intr_type1=? and intr_code1 =? and intr_type2=? and intr_code2 =?  and form_code1=? and form_code2 =?");
		dataMap.put("SQL_PH_DRUG_INT_DUPLICATE_CHECK", "select count(*) DUP_COUNT from ph_drug_interaction where intr_type1=? and intr_type2=? and ((intr_code1=? and intr_code2=? AND FORM_CODE1=? AND FORM_CODE2=?) or(intr_code1=? and intr_code2=? AND FORM_CODE1=? AND FORM_CODE2=?))  ");
		dataMap.put("SQL_PH_DRUG_INT_GENERIC_DOSAGE_FORM", "SELECT DISTINCT (dg.form_code) FORM_CODE, fm.form_desc FROM ph_drug dg, ph_form_lang_vw fm, PH_GENERIC_NAME_FOR_DRUG dgen WHERE dg.form_code = fm.form_code AND DG.DRUG_CODE = DGEN.DRUG_CODE(+) AND ( DGEN.GENERIC_ID = ? OR dg.generic_id = ?) AND fm.language_id = ?");
		dataMap.put("SQL_PH_DRUG_INT_DRUG_DOSAGE_FORM", "SELECT DISTINCT (dg.form_code) FORM_CODE, fm.form_desc FROM ph_drug dg, ph_form_lang_vw fm WHERE dg.form_code = fm.form_code AND DG.DRUG_CODE = ? AND fm.language_id = ?");
		//	RUT-CRF-0066 - Drug Interaction - END		
		//IN070606 Start.
		dataMap.put("SQL_DS_INGREDIENT_DETAILS", "SELECT INGREDIENT_CODE  CODE,SHORT_DESC DESCRIPTION FROM DS_INGREDIENT WHERE EFF_STATUS ='E' AND UPPER (INGREDIENT_CODE) LIKE UPPER (?) AND UPPER (SHORT_DESC) LIKE UPPER (?)");		
		dataMap.put("SQL_OR_LABORDERCATALOG_DETAILS", "SELECT ORDER_CATALOG_CODE CODE,SHORT_DESC DESCRIPTION  FROM OR_ORDER_CATALOG WHERE ORDER_CATEGORY='LB' AND ORDER_CATALOG_NATURE !='S' AND EFF_STATUS='E' AND UPPER (ORDER_CATALOG_CODE) LIKE UPPER (?) AND UPPER (SHORT_DESC) LIKE UPPER (?)");
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_DRUGTOFOOD", "SELECT INTR_CODE1, D1.DRUG_DESC INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM DS_INGREDIENT WHERE INGREDIENT_CODE = B.INTR_CODE2) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS FROM PH_DRUG_INTERACTION B, PH_DRUG_LANG_VW D1 WHERE B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.INTR_TYPE1 = 'D' AND B.INTR_TYPE2 = 'F' AND B.INTR_CODE1 = D1.DRUG_CODE AND B.INTR_SEVERITY_LEVEL LIKE (?) AND B.INTR_SIGNIF_LEVEL LIKE (?) AND B.INTR_PROB_LEVEL LIKE (?) AND B.EFF_STATUS LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') AND D1.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_GNERICTOFOOD", "SELECT INTR_CODE1, D1.GENERIC_NAME INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM DS_INGREDIENT WHERE INGREDIENT_CODE = B.INTR_CODE2) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS FROM PH_DRUG_INTERACTION B, PH_GENERIC_NAME_LANG_VW D1 WHERE B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.INTR_TYPE1 = 'G' AND B.INTR_TYPE2 = 'F' AND B.INTR_CODE1 = D1.GENERIC_ID AND B.INTR_SEVERITY_LEVEL LIKE (?) AND B.INTR_SIGNIF_LEVEL LIKE (?) AND B.INTR_PROB_LEVEL LIKE (?) AND B.EFF_STATUS LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') AND D1.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_DRUGTOLAB", "SELECT INTR_CODE1, D1.DRUG_DESC INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM OR_ORDER_CATALOG_LANG_VW WHERE ORDER_CATALOG_CODE = B.INTR_CODE2 AND LANGUAGE_ID= D1.LANGUAGE_ID) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS FROM PH_DRUG_INTERACTION B, PH_DRUG_LANG_VW D1 WHERE B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.INTR_TYPE1 = 'D' AND B.INTR_TYPE2 = 'L' AND B.INTR_CODE1 = D1.DRUG_CODE AND B.INTR_SEVERITY_LEVEL LIKE (?) AND B.INTR_SIGNIF_LEVEL LIKE (?) AND B.INTR_PROB_LEVEL LIKE (?) AND B.EFF_STATUS LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') AND D1.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_GNERICTOLAB", "SELECT INTR_CODE1, D1.GENERIC_NAME INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM OR_ORDER_CATALOG_LANG_VW WHERE ORDER_CATALOG_CODE = B.INTR_CODE2 AND LANGUAGE_ID= D1.LANGUAGE_ID) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS FROM PH_DRUG_INTERACTION B, PH_GENERIC_NAME_LANG_VW D1 WHERE B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.INTR_TYPE1 = 'G' AND B.INTR_TYPE2 = 'L' AND B.INTR_CODE1 = D1.GENERIC_ID AND B.INTR_SEVERITY_LEVEL LIKE (?) AND B.INTR_SIGNIF_LEVEL LIKE (?) AND B.INTR_PROB_LEVEL LIKE (?) AND B.EFF_STATUS LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') AND D1.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_DRUGTOFOOD", "SELECT INTR_TYPE1,INTR_TYPE2,INTR_CODE1, D1.DRUG_DESC INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM DS_INGREDIENT WHERE INGREDIENT_CODE = B.INTR_CODE2) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS,LAB_ORD_CHK_UPTO_NO_OF_DAYS FROM PH_DRUG_INTERACTION B, PH_DRUG_LANG_VW D1 WHERE B.INTR_TYPE1 = ? AND B.INTR_TYPE2 = ? AND B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.FORM_CODE1=? AND B.FORM_CODE2=? AND B.INTR_CODE1 = D1.DRUG_CODE  AND D1.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_GENERICTOFOOD", "SELECT INTR_TYPE1,INTR_TYPE2,INTR_CODE1, D1.GENERIC_NAME INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM DS_INGREDIENT WHERE INGREDIENT_CODE = B.INTR_CODE2) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS,LAB_ORD_CHK_UPTO_NO_OF_DAYS FROM PH_DRUG_INTERACTION B, PH_GENERIC_NAME_LANG_VW D1 WHERE B.INTR_TYPE1 = ? AND B.INTR_TYPE2 = ? AND B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.FORM_CODE1=? AND B.FORM_CODE2=? AND B.INTR_CODE1 = D1.GENERIC_ID  AND D1.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_DRUGTOLAB",  "SELECT INTR_TYPE1,INTR_TYPE2,INTR_CODE1, D1.DRUG_DESC INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM OR_ORDER_CATALOG_LANG_VW WHERE ORDER_CATALOG_CODE = B.INTR_CODE2 AND LANGUAGE_ID= D1.LANGUAGE_ID) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS,LAB_ORD_CHK_UPTO_NO_OF_DAYS FROM PH_DRUG_INTERACTION B, PH_DRUG_LANG_VW D1 WHERE B.INTR_TYPE1 = ? AND B.INTR_TYPE2 = ? AND B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.FORM_CODE1=? AND B.FORM_CODE2=? AND B.INTR_CODE1 = D1.DRUG_CODE  AND D1.LANGUAGE_ID = ?");
		//LAB_ORD_CHK_UPTO_NO_OF_DAYS added for MMS-KH-CRF-0034
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_GENERICTOLAB",  "SELECT INTR_TYPE1,INTR_TYPE2,INTR_CODE1, D1.GENERIC_NAME INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM OR_ORDER_CATALOG_LANG_VW WHERE ORDER_CATALOG_CODE = B.INTR_CODE2 AND LANGUAGE_ID= D1.LANGUAGE_ID) INTR_NAME2,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS,LAB_ORD_CHK_UPTO_NO_OF_DAYS FROM PH_DRUG_INTERACTION B, PH_GENERIC_NAME_LANG_VW D1 WHERE B.INTR_TYPE1 = ? AND B.INTR_TYPE2 = ? AND B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.FORM_CODE1=? AND B.FORM_CODE2=? AND B.INTR_CODE1 = D1.GENERIC_ID  AND D1.LANGUAGE_ID = ?");
		//LAB_ORD_CHK_UPTO_NO_OF_DAYS added for MMS-KH-CRF-0034
		//IN070606 End.
		//	JD-CRF-0148 - DispLabel/sheet reprint -start
		dataMap.put("SQL_PH_UPDATE_TMP_OFFLINE_PRINT_SEQ_NO", "update ph_disp_dtl_tmp set OFFLINE_PRINT_SEQ_NO= ? where DISP_TMP_NO=? AND DTL_SERIAL_NUM=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_UPDATE_OFFLINE_PRINT_SEQ_NO", "update ph_disp_dtl set OFFLINE_PRINT_SEQ_NO= ? where DISP_NO=? AND SRL_NO=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_SELECT_TMP_OFFLINE_PRINT_SEQ_NO", "SELECT OFFLINE_PRINT_SEQ_TMP.NEXTVAL PRINT_SEQ_NO FROM DUAL");
		dataMap.put("SQL_PH_SELECT_OFFLINE_PRINT_SEQ_NO", "SELECT OFFLINE_PRINT_SEQ.NEXTVAL PRINT_SEQ_NO FROM DUAL");
		//	JD-CRF-0148 - DispLabel/sheet reprint -END
		dataMap.put("SQL_PH_SELECT_GET_ORDERING_FACILITY_ID", "SELECT ORDERING_FACILITY_ID  FROM OR_ORDER WHERE ORDER_ID = (SELECT order_id FROM ph_ord_for_disp_queue x, ph_disp_queue y  WHERE  x.facility_id = ? AND x.queue_date = TO_DATE (?,'DD/MM/YYYY') AND  x.token_series_code = ? AND  x.token_serial_no = NVL (?, x.token_serial_no)  AND x.queue_shift = '*ALL' AND x.facility_id = y.facility_id AND x.disp_locn_code = y.disp_locn_code  AND x.queue_date = y.queue_date   AND x.queue_shift = y.queue_shift AND x.token_series_code = y.token_series_code AND x.token_serial_no =y.token_serial_no AND y.token_status NOT IN ('XX') AND ROWNUM =1)"); //  code added for ML-BRU-SCF-0340[IN:034556] 
		dataMap.put("SQL_PH_REG_PRES_ALL_SOURCE_SELECT", "select code, description,facility_id,eff_status,language_id from (SELECT clinic_code code, long_desc description,facility_id,eff_status,language_id,clinic_type  FROM op_clinic_lang_vw op_clinic   UNION  SELECT nursing_unit_code code, long_desc description,facility_id,eff_status,language_id,'C' clinic_type  FROM ip_nursing_unit_lang_vw ip_nursing_unit)WHERE  UPPER (facility_id) LIKE UPPER (?)   AND UPPER (code) LIKE UPPER (?)   AND UPPER (description) LIKE UPPER (?) AND eff_status = 'E' AND clinic_type ='C'  AND language_id = "); 
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT104", "SELECT  gn.generic_name, gn.generic_id, A.DISCONT_DATE_TIME, A.PATIENT_ID,  A.ALLERGY_OVERRIDE_REASON,  A.DOSAGE_LIMIT_OVERRIDE_REASON,  A.DUPLICATE_DRUG_OVERRIDE_REASON,  A.ORIG_ORDER_ID,  A.ORIG_ORDER_LINE_NO, A.DOSAGE, A.DOSAGE_UOM_CODE,  PH_GET_UOM_DISPLAY(?,A.DOSAGE_UOM_CODE,? ) DOSAGE_UOM_DESC , A.SPLIT_DOSE_PREVIEW,  A.FREQ_CODE,  G.FREQ_DESC,  A.PRES_PRACTITIONER_ID,  B.PRACTITIONER_NAME,  H.DISCHARGE_IND,A.DRUG_CODE,  C.DRUG_DESC,  C.IN_FORMULARY_YN, A.STRENGTH,  C.STRENGTH_UOM,  C.FORM_CODE,  TO_CHAR(A.START_DATE,  'DD/MM/YYYY hh24:mi') START_DATE,  TO_CHAR(A.END_DATE,  'DD/MM/YYYY hh24:mi') END_DATE,   A.PRESCRIBED_QTY,  A.DIAG_TEXT,  D.FACILITY_NAME,  A.PATIENT_CLASS,  DECODE( DECODE(?,'1', 'IP',A.PATIENT_CLASS) ,  'IP',  F.LONG_DESC,  'EA',  F.LONG_DESC,  E.LONG_DESC ) LOCATION,I.SHORT_DESC PERF_LOCN,H.IV_PREP_YN,K.ORDER_STATUS_TYPE ORDER_STATUS_TYPE,A.SLIDING_SCALE_YN  FROM   PH_PATIENT_DRUG_PROFILE A ,  AM_PRACTITIONER_LANG_VW B  ,  SM_FACILITY_PARAM_LANG_VW D,  OP_CLINIC_LANG_VW E,  IP_NURSING_UNIT_LANG_VW F,  PH_DRUG_LANG_VW C,   AM_FREQUENCY_LANG_VW G, OR_ORDER H,  PH_DISP_LOCN_LANG_VW I, OR_ORDER_LINE J, OR_ORDER_STATUS_CODE_LANG_VW K, ph_generic_name_lang_vw gn WHERE   A.PATIENT_ID =? AND   A.PRES_PRACTITIONER_ID = B.PRACTITIONER_ID(+) AND   A.FACILITY_ID = D.FACILITY_ID  AND   A.FACILITY_ID = E.FACILITY_ID (+) AND  A.LOCN_CODE = E.CLINIC_CODE(+) AND   A.FACILITY_ID = F.FACILITY_ID (+) AND   A.LOCN_CODE = F.NURSING_UNIT_CODE(+) AND   A.DRUG_CODE = C.DRUG_CODE  AND   A.FREQ_CODE=G.FREQ_CODE AND  A.ORIG_ORDER_ID= H.ORDER_ID AND I.DISP_LOCN_CODE = H.PERFORMING_DEPTLOC_CODE AND A.PATIENT_ID=H.PATIENT_ID AND  (TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  START_DATE AND  END_DATE OR TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN  START_DATE AND  END_DATE OR  START_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI') OR  END_DATE BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI'))   AND A.DISCONT_DATE_TIME IS NULL AND   A.ON_HOLD_DATE_TIME IS NULL AND   A.CANCEL_YN='N' AND   A.STOP_YN='N' AND A.ORIG_ORDER_ID = J.ORDER_ID AND A.ORIG_ORDER_LINE_NO = J.ORDER_LINE_NUM AND J.ORDER_LINE_STATUS = K.ORDER_STATUS_CODE AND h.performing_facility_id = i.facility_id AND b.language_id(+) = ? AND c.language_id(+)= ? AND d.language_id (+) = c.language_id AND e.language_id(+) = ? AND f.language_id(+) = ? AND g.language_id(+) = c.language_id  AND k.language_id(+) = c.language_id  AND i.language_id(+) = c.language_id  and c.generic_id=gn.generic_id and c.language_id= gn.language_id"); //Modified for BRU-HIMS-CRF-403//added for Bru-HIMS-CRF-265 [IN:032315]
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT105", "SELECT  gn.generic_name, gn.generic_id, A.DISCONT_DATE_TIME, A.PATIENT_ID,  A.ALLERGY_OVERRIDE_REASON,  A.DOSAGE_LIMIT_OVERRIDE_REASON,  A.DUPLICATE_DRUG_OVERRIDE_REASON,  A.ORIG_ORDER_ID,  A.ORIG_ORDER_LINE_NO,  C.IN_FORMULARY_YN, A.DOSAGE, A.DOSAGE_UOM_CODE, PH_GET_UOM_DISPLAY(?,A.DOSAGE_UOM_CODE, ?) DOSAGE_UOM_DESC, A.SPLIT_DOSE_PREVIEW,  A.FREQ_CODE,  G.FREQ_DESC,  A.PRES_PRACTITIONER_ID,  B.PRACTITIONER_NAME,  H.DISCHARGE_IND,A.DRUG_CODE,  C.DRUG_DESC,  A.STRENGTH,  C.STRENGTH_UOM,  C.FORM_CODE,  TO_CHAR(A.START_DATE,  'DD/MM/YYYY hh24:mi') START_DATE,  TO_CHAR(A.END_DATE,  'DD/MM/YYYY hh24:mi') END_DATE,    A.PRESCRIBED_QTY,  A.DIAG_TEXT,  D.FACILITY_NAME,  A.PATIENT_CLASS,  DECODE(  DECODE(?,'1', 'IP',A.PATIENT_CLASS),  'IP',  F.LONG_DESC,  'EA',  F.LONG_DESC,  E.LONG_DESC ) LOCATION,H.IV_PREP_YN,A.SLIDING_SCALE_YN FROM   PH_PATIENT_DRUG_PROFILE A ,  AM_PRACTITIONER_LANG_VW B  ,  SM_FACILITY_PARAM_LANG_VW D,  OP_CLINIC_LANG_VW E,  IP_NURSING_UNIT_LANG_VW F,  PH_DRUG_LANG_VW C,   AM_FREQUENCY_LANG_VW G, OR_ORDER H, ph_generic_name_lang_vw gn  WHERE   A.PATIENT_ID =? AND   A.PRES_PRACTITIONER_ID = B.PRACTITIONER_ID(+) AND   A.FACILITY_ID = D.FACILITY_ID  AND   A.FACILITY_ID = E.FACILITY_ID (+) AND  A.LOCN_CODE = E.CLINIC_CODE(+) AND   A.FACILITY_ID = F.FACILITY_ID (+) AND   A.LOCN_CODE = F.NURSING_UNIT_CODE(+) AND   A.DRUG_CODE = C.DRUG_CODE   AND   A.FREQ_CODE=G.FREQ_CODE  AND   A.ORIG_ORDER_ID= H.ORDER_ID AND  A.PATIENT_ID=H.PATIENT_ID AND to_date(A.END_DATE,'dd/mm/yyyy hh24:mi') >= to_date(SYSDATE,'dd/mm/yyyy hh24:mi') AND  TO_DATE(SYSDATE,'DD/MM/RRRR HH24:MI') BETWEEN  TO_DATE(A.START_DATE,'DD/MM/RRRR HH24:MI') AND  TO_DATE(A.END_DATE,'DD/MM/RRRR HH24:MI')   AND A.DISCONT_DATE_TIME IS NULL AND   A.ON_HOLD_DATE_TIME IS NULL AND   A.CANCEL_YN='N' AND   A.STOP_YN='N' AND H.ORDER_TYPE_CODE !='MS' AND C.LANGUAGE_ID = D.LANGUAGE_ID  AND C.LANGUAGE_ID = G.LANGUAGE_ID AND C.LANGUAGE_ID = ? AND B.LANGUAGE_ID(+) = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ? and c.generic_id=gn.generic_id and c.language_id= gn.language_id "); //added for Bru-HIMS-CRF-265 [IN:032315]
        //Added for Bru-HIMS-CRF-142 [IN:030195] - start
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT26","SELECT MARK_PATIENT_ARRIVE_YN, GENERATE_ACTUAL_TOKEN_YN, PRINT_TOKEN_ON_LABEL_YN FROM PH_DISP_LOCN WHERE FACILITY_ID=? AND DISP_LOCN_CODE=?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_INSERT_DISP_QUEUE1","INSERT INTO PH_DISP_QUEUE(FACILITY_ID, DISP_LOCN_CODE, QUEUE_DATE,QUEUE_SHIFT, TOKEN_SERIES_CODE, TOKEN_SERIAL_NO, NO_OF_PRES, PATIENT_ID,COLLECTOR_SAME_AS_PATIENT,COLLECTOR_NAME, COLLECTOR_NATIONALITY, ENCOUNTER_ID, REGN_DATE_TIME,  ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,  MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,COLLECTOR_GENDER,TOKEN_STATUS,PATIENT_ARRIVED_YN) VALUES(?,?,TRUNC(SYSDATE),'*ALL',?,?,?,?,?,?,?,?,SYSDATE,?,SYSDATE,?,?,?,SYSDATE,?,?,?,'RG',?)");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_INSERT_DISP_QUEUE2","INSERT INTO PH_DISP_QUEUE(FACILITY_ID, DISP_LOCN_CODE, QUEUE_DATE,QUEUE_SHIFT, TOKEN_SERIES_CODE, TOKEN_SERIAL_NO, NO_OF_PRES, PATIENT_ID,COLLECTOR_SAME_AS_PATIENT,COLLECTOR_NAME, COLLECTOR_NATIONALITY, ENCOUNTER_ID, REGN_DATE_TIME,  ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID,  MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,COLLECTOR_GENDER,TOKEN_STATUS,PATIENT_ARRIVED_YN,PATIENT_ARRIVED_TIME) VALUES(?,?,TRUNC(SYSDATE),'*ALL',?,?,?,?,?,?,?,?,SYSDATE,?,SYSDATE,?,?,?,SYSDATE,?,?,?,'RG',?,SYSDATE)");
		dataMap.put("SQL_PH_STORAGE_LOCN_DUPLICATE","SELECT COUNT(ROWID) FROM PH_STORAGE_BIN_LOCN WHERE  DISP_LOCN_CODE = UPPER(?) AND STORAGE_BIN_CODE = UPPER(?)");
		dataMap.put("SQL_PH_STORAGE_LOCN_INSERT","INSERT INTO PH_STORAGE_BIN_LOCN(FACILITY_ID,DISP_LOCN_CODE,STORAGE_BIN_CODE,STORAGE_NAME,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID)values(?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_STORAGE_LOCN_UPDATE","UPDATE PH_STORAGE_BIN_LOCN SET STORAGE_NAME = ?,EFF_STATUS = ?,MODIFIED_BY_ID = ?,MODIFIED_DATE = SYSDATE ,MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE FACILITY_ID = ? AND DISP_LOCN_CODE = ? AND STORAGE_BIN_CODE = ? ");
		dataMap.put("SQL_PH_STORAGE_LOCN_DISP_LOCN", "SELECT A.DISP_LOCN_CODE,A.SHORT_DESC FROM PH_DISP_LOCN A WHERE  A.EFF_STATUS='E' AND A.FACILITY_ID = UPPER(?) AND DISP_LOCN_TYPE='P'  and STORAGE_LOCN_APPL_YN = 'Y' ORDER BY 2");
		dataMap.put("SQL_PH_STORAGE_LOCN_EXECUTE", "SELECT A.DISP_LOCN_CODE,B.SHORT_DESC,A.STORAGE_BIN_CODE,A.STORAGE_NAME,A.EFF_STATUS FROM PH_STORAGE_BIN_LOCN A, PH_DISP_LOCN B WHERE  A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID=B.FACILITY_ID AND A.DISP_LOCN_CODE LIKE UPPER(?) AND UPPER(B.SHORT_DESC) LIKE UPPER(?) AND A.STORAGE_BIN_CODE LIKE UPPER(?) AND UPPER(A.STORAGE_NAME) LIKE UPPER(?) AND UPPER(A.EFF_STATUS) LIKE DECODE(A.EFF_STATUS,'B',A.EFF_STATUS,?) AND A.FACILITY_ID = ?");
		dataMap.put("SQL_PH_STORAGE_LOCN_RESULT","SELECT  A.DISP_LOCN_CODE,B.SHORT_DESC,A.STORAGE_BIN_CODE,A.STORAGE_NAME,A.EFF_STATUS FROM PH_STORAGE_BIN_LOCN A , PH_DISP_LOCN B WHERE A.DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.FACILITY_ID=B.FACILITY_ID AND A.FACILITY_ID = ? AND A.DISP_LOCN_CODE = ? AND A.STORAGE_BIN_CODE = ?");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT27","SELECT DISTINCT DECODE((TRUNC(SYSDATE)-TRUNC(ORD_DATE_TIME)),0,'P','U') PAT_MODE FROM OR_ORDER A WHERE PATIENT_ID = ?  AND order_category = 'PH' AND order_id IN (SELECT order_id FROM or_order_line WHERE order_id = a.order_id AND order_line_status IN ('RG', 'VF', 'AL','IP', 'HC', 'HD', 'UC') AND order_category = 'PH') AND order_id in (select order_id from ph_ord_for_disp_queue where patient_id = a.patient_id  AND (DISP_LOCN_CODE ||QUEUE_DATE ||QUEUE_SHIFT ||TOKEN_SERIES_CODE ||TOKEN_SERIAL_NO) in (select (DISP_LOCN_CODE ||QUEUE_DATE ||QUEUE_SHIFT ||TOKEN_SERIES_CODE  ||TOKEN_SERIAL_NO) FROM ph_disp_queue WHERE patient_id = a.patient_id AND queue_date BETWEEN NVL(to_date(?,'DD/MM/YYYY'),(trunc(SYSDATE - 360))) AND nvl(to_Date(?,'DD/MM/YYYY'),trunc(SYSDATE))  AND ( ( queue_date = TRUNC (SYSDATE) AND patient_arrived_yn = 'N' ) OR (    queue_date != TRUNC (SYSDATE) AND assigned_queue_date IS NULL ) ))) ");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT28","SELECT A.PATIENT_NAME,GET_AGE(A.DATE_OF_BIRTH) AGE, DECODE(A.SEX,'M','MALE','F','FEMALE','UNKNOWN') GENDER,B.LONG_DESC NATIONALITY,A.NATIONALITY_CODE FROM MP_PATIENT A,MP_COUNTRY B WHERE A.PATIENT_ID=? AND  A.NATIONALITY_CODE=B.COUNTRY_CODE(+)");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT29","SELECT H.TOKEN_SERIAL_NO ,TO_CHAR(H.QUEUE_DATE,'DD/MM/YYYY') QUEUE_DATE,A.ORDER_ID,A.ORDER_LINE_NUM, A.ORDER_CATALOG_CODE,NVL(B.DRUG_DESC,A.CATALOG_DESC) DRUG_DESC,E.SHORT_DESC DISP_LOCN_NAME,F.STORAGE_NAME STORAGE_LOCN_DESC ,C.SHORT_DESC ORDER_STATUS ,(CASE WHEN H.TOKEN_SERIAL_NO >900000  THEN 'Queue Date :-' || To_Char(H.Queue_date,'DD/MM/YYYY') || ' Token Series -:' || (Select DESCRIPTION from ph_token_series where facility_id = h.facility_id and disp_locn_code = h.disp_locn_code and token_series_Code = h.token_series_Code) || 'Patient not arrived'   ELSE  'Queue Date :-' || To_Char(H.Queue_date,'DD/MM/YYYY') || ' Token Series :-' || (Select DESCRIPTION from ph_token_series where facility_id = h.facility_id and disp_locn_code = h.disp_locn_code and token_series_Code = h.token_series_Code) || ' Token No-' || H.token_serial_no  END ) TOKEN_STATUS,H.TOKEN_SERIES_CODE,H.DISP_LOCN_CODE FROM OR_ORDER_LINE A,PH_DRUG B,OR_ORDER_STATUS_CODE C, OR_ORDER D ,PH_DISP_LOCN E,PH_STORAGE_BIN_LOCN F ,PH_DISP_QUEUE G ,PH_ORD_FOR_DISP_QUEUE H WHERE D.PATIENT_ID = ? AND A.ORDER_ID = D.ORDER_ID AND A.ORDER_LINE_STATUS = C.ORDER_STATUS_CODE AND A.ORDER_CATALOG_CODE = B.DRUG_CODE(+)  AND D.ORD_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY') + 0.9999 AND D.ORDER_CATEGORY = 'PH' AND A.ORDER_LINE_STATUS IN ('RG','VF','AL','IP','HC','HD','UC') AND E.FACILITY_ID = D.PERFORMING_FACILITY_ID  AND e.facility_id(+) = h.facility_id AND E.DISP_LOCN_CODE = D.PERFORMING_DEPTLOC_CODE AND F.FACILITY_ID(+) = G.FACILITY_ID AND F.DISP_LOCN_CODE(+) = G.DISP_LOCN_CODE AND F.STORAGE_BIN_CODE(+)   = G.STORAGE_BIN_CODE AND H.ORDER_ID = D.ORDER_ID AND G.PATIENT_ID = D.PATIENT_ID AND G.TOKEN_SERIAL_NO = NVL(?,G.TOKEN_SERIAL_NO) AND G.FACILITY_ID = H.FACILITY_ID AND G.DISP_LOCN_CODE = H.DISP_LOCN_CODE AND G.QUEUE_DATE = H.QUEUE_DATE AND G.QUEUE_SHIFT = H.QUEUE_SHIFT AND G.TOKEN_SERIES_CODE =  H.TOKEN_SERIES_CODE AND G.TOKEN_SERIAL_NO =  H.TOKEN_SERIAL_NO AND ((g.queue_date = TRUNC (SYSDATE) AND g.patient_arrived_yn = 'N' ) OR (g.queue_date != TRUNC (SYSDATE) and g.assigned_queue_Date is null) ) AND a.order_id =h.order_id AND a.order_line_num=h.order_line_num ORDER BY A.ORDER_ID,A.ORDER_LINE_NUM");//modified for ml-mmoh-scf-2339
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_UPD_ORD_FOR_DISP_QUEUE","UPDATE PH_ORD_FOR_DISP_QUEUE SET PATIENT_ARRIVE_MODE=? ,PATIENT_ARRIVE_DATE_TIME=SYSDATE WHERE FACILITY_ID=? AND  DISP_LOCN_CODE =? AND  QUEUE_DATE=TO_DATE(?,'DD/MM/YYYY') AND QUEUE_SHIFT='*ALL' AND TOKEN_SERIES_CODE=? AND TOKEN_SERIAL_NO=? AND ORDER_ID=? ");
		dataMap.put("SQL_PH_REG_PRESCRIPTIONS_SELECT30","SELECT DISTINCT TOKEN_SERIAL_NO FROM PH_ORD_FOR_DISP_QUEUE WHERE PATIENT_ID = ? AND PATIENT_ARRIVE_MODE IN ('P','U') AND TRUNC(PATIENT_ARRIVE_DATE_TIME) = TRUNC(SYSDATE) AND ROWNUM <=1");
		//Added forBru-HIMS-CRF-142 [IN:030195] -end
		// adding start for  Bru-HIMS-CRF-093 [IN:029960]
		dataMap.put("SQL_PH_PRESCRIPTION_HOMELEAVE", "SELECT COUNT(ROWID) FROM IP_LEAVE_DETAIL WHERE ENCOUNTER_ID=? AND FACILITY_ID=? AND LEAVE_STATUS in('0','1') ");
		dataMap.put("SQL_PH_PRESCRIPTION_HOMELEAVEDATES", "SELECT TO_CHAR(LEAVE_FR_DATE,'dd/mm/yyyy hh24:mi') LEAVE_FR_DATE ,TO_CHAR(LEAVE_TO_DATE,'dd/mm/yyyy hh24:mi') LEAVE_TO_DATE FROM IP_leave_detail WHERE ENCOUNTER_ID=? AND FACILITY_ID=? AND LEAVE_STATUS in('0','1') ");
		dataMap.put("SQL_PH_PRESCRIPTION_COMPARE_LEAVE_DATES", "SELECT COUNT (*) COUNT FROM DUAL WHERE TO_DATE (?, 'DD/MM/YYYY hh24:mi') BETWEEN TO_DATE (?,'DD/MM/YYYY HH24:MI') AND TO_DATE (?,'DD/MM/YYYY HH24:MI') OR TO_DATE (?, 'DD/MM/YYYY hh24:mi') BETWEEN TO_DATE (?, 'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR TO_DATE (?, 'DD/MM/YYYY hh24:mi') BETWEEN TO_DATE (?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR TO_DATE (?, 'DD/MM/YYYY hh24:mi') BETWEEN TO_DATE (?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI')  ");
		dataMap.put("SQL_PH_PRES_HOME_LEAVE_SELECT1", "SELECT COUNT(*) COUNT FROM DUAL WHERE TO_DATE(?,'DD/MM/YYYY HH24:MI') BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI')");
		// adding end for  Bru-HIMS-CRF-093 [IN:029960]

		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_INSERT","INSERT INTO CA_PATIENT_PREGN_DTLS (PATIENT_ID, FACILITY_ID,ENCOUNTER_ID,SRL_NO,PREG_RECDED_DATE,PREGENANT_YN,LMP_DATE,EXPD_DELV_DATE,ACTU_DELV_DATE,DELV_FACILITY_ID,DELV_ENCOUNTER_ID,PRACT_ID,PREGN_STATUS_IND,PREGN_STATUS_DATE,REMARKS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES(?,?,?,?,SYSDATE,?,to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,SYSDATE,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_UPDATE","UPDATE CA_PATIENT_PREGN_DTLS SET PREGENANT_YN=?,LMP_DATE=to_date(?,'dd/mm/yyyy hh24:mi'),EXPD_DELV_DATE=to_date(?,'dd/mm/yyyy hh24:mi'),ACTU_DELV_DATE=to_date(?,'dd/mm/yyyy hh24:mi'),PRACT_ID=?,PREGN_STATUS_IND=?,PREGN_STATUS_DATE=SYSDATE,REMARKS=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=? WHERE PATIENT_ID=? AND FACILITY_ID=? AND SRL_NO=? ");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_SELECT2", "SELECT NVL(MAX(SRL_NO) + 1,1) NEXT_SRL_NO FROM CA_PATIENT_PREGN_DTLS WHERE PATIENT_ID= ? ");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_LOCN_DTL","SELECT ASSIGN_CARE_LOCN_CODE,case when assign_care_locn_type in ('N') then ip_get_desc.ip_nursing_unit(?,ASSIGN_CARE_LOCN_CODE,?,'1') else op_get_desc.op_clinic(?,ASSIGN_CARE_LOCN_CODE,?,'2') end current_location, AM_GET_DESC.AM_PRACTITIONER(ATTEND_PRACTITIONER_ID,?,'1') attending_practitioner,  SM_CONVERT_DATE_2T(visit_adm_date_time, ?) admission_date FROM pr_encounter WHERE facility_id = ? AND encounter_id =?");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_ENCOUNTER_LIST","SELECT encounter_id FROM pr_encounter WHERE patient_id = ? AND facility_id =? ORDER BY encounter_id DESC ");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_EDD","SELECT to_char(to_date(?,'dd/mm/yyyy')+280,'dd/mm/yyyy') exp_preg_date from dual");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_PREG_STAGE","SELECT (TRUNC(SYSDATE)-TO_DATE(?,'DD/MM/YYYY'))/7 preg_week FROM DUAL");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_PATIENT_DTL","SELECT DECODE(?,'en',a.PATIENT_NAME,nvl(a.PATIENT_NAME_LOC_LANG,a.PATIENT_NAME)) PATIENT_NAME,GET_AGE(a.DATE_OF_BIRTH) AGE, DECODE(a.SEX,'M','male','F','female','unknown') GENDER, to_char(a.DATE_OF_BIRTH,'dd/mm/yyyy') DATE_OF_BIRTH FROM MP_PATIENT a WHERE a.PATIENT_ID=? AND SUBSTR (get_age (a.date_of_birth),1,2) BETWEEN '12' AND '64' AND a.sex='F' ");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_SELECT","SELECT A.SRL_NO,A.PREGENANT_YN,to_char(A.LMP_DATE,'dd/mm/yyyy') LMP_DATE,to_char(A.EXPD_DELV_DATE,'dd/mm/yyyy') EXPD_DELV_DATE,to_char(A.ACTU_DELV_DATE,'dd/mm/yyyy') ACTU_DELV_DATE,A.PREGN_STATUS_IND,A.PRACT_ID,A.REMARKS FROM CA_PATIENT_PREGN_DTLS A WHERE PATIENT_ID=?  ORDER BY A.SRL_NO desc");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT_PREG_YN","SELECT A.PREGENANT_YN FROM CA_PATIENT_PREGN_DTLS A WHERE PATIENT_ID=? AND FACILITY_ID=? AND A.PREGN_STATUS_IND='A' AND A.PREGN_STATUS_IND='A' and nvl(ACTU_DELV_DATE , EXPD_DELV_DATE) >= sysdate");
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT_TRIMSTER","SELECT CASE  WHEN ? BETWEEN FIRST_TRIMSTER_START AND FIRST_TRIMSTER_END THEN 'First Trimester'  WHEN  ? BETWEEN second_trimster_start AND second_trimster_end THEN 'Second Trimester' WHEN  ? BETWEEN third_trimster_start AND third_trimster_end THEN 'Thrid Trimester' else ' ' END trimster FROM ph_param");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_STATUS_COUNT", "SELECT COUNT(*) COUNT FROM CA_PATIENT_PREGN_DTLS WHERE PATIENT_ID =? AND PREGN_STATUS_IND= 'A'");
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_DTLS_PRACT_SELECT", "SELECT PRACTITIONER_NAME FROM AM_PRACTITIONER_LANG_VW WHERE PRACTITIONER_ID =? and language_id=?");


		//Added By Gangadharan Friday, February 22, 2013 FOR home page
		dataMap.put("SQL_ST_SAL_STORE_SELECT", "SELECT st.store_code, mm.short_desc	FROM mm_store_lang_vw mm, ST_USER_ACCESS_FOR_STORE st, st_store ststr WHERE	mm.store_code=st.store_code	AND mm.store_code = ststr.store_code AND mm.eff_status='E' /*AND st.sal_allowed_yn='Y' AND ststr.sal_allowed_yn='Y'*/  AND mm.facility_id = ? AND st.user_id=? AND mm.language_id = ? ORDER	BY 2");
		dataMap.put("SQL_PH_ST_DESKTOP_FOR_USER_INSERT","INSERT INTO PH_ST_DESKTOP_FOR_USER (USER_ID,DESKTOP_ID,LEGEND_FOR_DESK_TOP,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_PH_ST_DESKTOP_FOR_USER_UPDATE","UPDATE PH_ST_DESKTOP_FOR_USER SET DESKTOP_ID = ? ,LEGEND_FOR_DESK_TOP = ?,EFF_STATUS = ?, MODIFIED_BY_ID= ?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE USER_ID = ?");
		dataMap.put("SQL_PH_ST_DESKTOP_ID_EXIST",	"SELECT COUNT(*) COUNT FROM PH_ST_DESKTOP_FOR_USER WHERE USER_ID = ? " );
		dataMap.put("SQL_PH_ST_DESKTOP_FOR_USER_MODIFY",	"SELECT USER_ID,DESKTOP_ID,LEGEND_FOR_DESK_TOP DESKTOP_DESC,EFF_STATUS FROM PH_ST_DESKTOP_FOR_USER WHERE USER_ID = ? " );
		dataMap.put("SQL_PH_ST_DEFINE_MENU_QUERYCRIT",		"SELECT USER_ID,DESKTOP_ID,DESKTOP_DESC,EFF_STATUS FROM PH_ST_DESKTOP_FOR_USER WHERE UPPER(USER_ID) LIKE UPPER(?) AND UPPER(DESKTOP_ID) LIKE UPPER(?) AND UPPER(DESKTOP_DESC) LIKE UPPER(?) AND EFF_STATUS LIKE UPPER(?)");
		dataMap.put("SQL_ST_USER_LOOKUP_USERACCESS","SELECT appl_user_id code,	appl_user_name  description  FROM  sm_appl_user_lang_vw sm_appl_user  where eff_status='E'  AND appl_user_id like UPPER(?)  AND  UPPER(appl_user_name)	like  UPPER(?) AND language_id = ");
		dataMap.put("SQL_PH_ST_DESKTOP_ID_LIST","select DESKTOP_SUMMARY_ID,  DESKTOP_SUMMARY_NAME from SM_DESKTOP_SUM_HDR where DFLT_MODULE_ID IN ('PH','ST') and EFF_STATUS='E' ");
		dataMap.put("SQL_PH_GEN_MARDARCODEID","SELECT PH_MAR_BARCODE_GENERATION (?) MAR_BARCODE_ID FROM DUAL "); //added for  MMS-QH-CRF-0080 [IN:038064]
		dataMap.put("SQL_PH_SELECT_LANGUAGES","select language_id, short_name from sm_language where EFF_STATUS='E'order by 2"); //added for  MMS-QH-CRF-0069 [IN:037977]
		dataMap.put("SQL_PH_BILLING_GROUP_SELECT","SELECT BLNG_GRP_ID,SHORT_DESC,SETTLEMENT_IND FROM BL_BLNG_GRP_LANG_VW WHERE LANGUAGE_ID=? ");
		dataMap.put("SQL_PH_CUSTOMER_GROUP_SELECT","SELECT  CUST_GROUP_CODE,SHORT_DESC FROM AR_CUST_GROUP_LANG_VW WHERE LANGUAGE_ID=? ORDER BY 2");//added order by 2 for MMS-QH-CRF-0110[IN045590]
		dataMap.put("SQL_PH_CUSTOMER_SELECT","SELECT CUST_CODE,SHORT_NAME FROM AR_CUSTOMER_LANG_VW WHERE CUST_GROUP_CODE=? AND LANGUAGE_ID=? ORDER BY SHORT_NAME");//added Order by 2 for  MMS-QH-CRF-0110[IN045590] start
		dataMap.put("SQL_PH_CUSTOMER_GROUP_SELECT1", "SELECT  CUST_GROUP_CODE CODE,SHORT_DESC DESCRIPTION FROM AR_CUST_GROUP_LANG_VW WHERE upper(SHORT_DESC) like upper(?) and upper(CUST_GROUP_CODE) like upper(?) and  LANGUAGE_ID='~LANGUAGE_ID`' ORDER BY 2"); // 39764
        //dataMap.put("SQL_PH_CUSTOMER_SELECT1","SELECT CODE,DESCRIPTION FROM(SELECT CUST_CODE CODE,SHORT_NAME DESCRIPTION FROM AR_CUSTOMER_LANG_VW WHERE upper(SHORT_NAME) like upper(?) and upper(CUST_CODE) like upper(?) AND CUST_GROUP_CODE='~CUST_GROUP_CODE`' AND LANGUAGE_ID='~LANGUAGE_ID`' union (SELECT '**','All Payer' From Dual where 1< (SELECT COUNT(*) FROM AR_CUSTOMER_LANG_VW WHERE upper(SHORT_NAME) like upper('%~SHORT_NAME1`%') and upper(CUST_CODE) like upper('%~CUST_CODE1`%') AND CUST_GROUP_CODE='~CUST_GROUP_CODE1`' AND LANGUAGE_ID='~LANGUAGE_ID1`')))"); //  43567 
        dataMap.put("SQL_PH_CUSTOMER_SELECT1","SELECT CODE,DESCRIPTION FROM(SELECT CUST_CODE CODE,SHORT_NAME DESCRIPTION FROM AR_CUSTOMER_LANG_VW WHERE CUST_GROUP_CODE='~CUST_GROUP_CODE`' AND LANGUAGE_ID='~LANGUAGE_ID`' union SELECT '**','All Payer' From Dual) where upper(description) like upper(?) and upper(code) like upper(?) ORDER BY 2");//  43567 
		dataMap.put("SQL_PH_POLICY_TYPE_SELECT","SELECT  A.POLICY_TYPE_CODE ,B.SHORT_DESC FROM BL_INS_POLICY_TYPE_HDR A, BL_INS_POLICY_TYPES B WHERE A.CUST_GROUP_CODE=? AND A.CUST_CODE=? AND A.OPERATING_FACILITY_ID=? AND A.POLICY_TYPE_CODE=B.POLICY_TYPE_CODE");
		dataMap.put("JNDI_PH_BL_ORDER_ROUTING", "java:comp/env/BLGroupOrderRouting");
		dataMap.put("SQL_PH_BL_GROUP_ORDER_ROUTING_INSERT", "INSERT INTO PH_BLGROUP_ORDER_ROUTING (ORDERING_FACILITY_ID, ORDERING_SOURCE_TYPE, ORDERING_SOURCE_CODE,BLNG_GRP_ID,CUST_GROUP_CODE,CUST_CODE,POLICY_TYPE_CODE, PERFORMING_FACILITY_ID, RTN_ORD_DISP_LOCN_CODE, STAT_ORD_DISP_LOCN_CODE, DISCH_ORD_DISP_LOCN_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?,?,?,?,?, ?, ?, ?, ?,?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?) ");
		dataMap.put("SQL_PH_BL_GROUP_ORDER_ROUTING_DTL_INSERT", "INSERT INTO PH_BLGROUP_ORDER_ROUTING_DTL(ORDERING_FACILITY_ID, ORDERING_SOURCE_TYPE, ORDERING_SOURCE_CODE, ROUTING_LEVEL, ROUTING_CODE, PERFORMING_FACILITY_ID, RTN_ORD_DISP_LOCN_CODE, STAT_ORD_DISP_LOCN_CODE, DISCH_ORD_DISP_LOCN_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,BLNG_GRP_ID,CUST_GROUP_CODE,CUST_CODE,POLICY_TYPE_CODE) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?,?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?,?,?,?,?) "); 
		dataMap.put("SQL_PH_BL_GROUP_ORDER_ROUTING_SELECT1","SELECT A.PERFORMING_FACILITY_ID, A.RTN_ORD_DISP_LOCN_CODE, A.STAT_ORD_DISP_LOCN_CODE,A.DISCH_ORD_DISP_LOCN_CODE,a.BLNG_GRP_ID BL_GROUP_CODE,a.CUST_GROUP_CODE BL_CUSTOMER_GROUP_CODE,a.CUST_CODE BL_CUSTOMER_CODE,a.POLICY_TYPE_CODE BL_POLICY_TYPE FROM PH_BLGROUP_ORDER_ROUTING A,PH_DISP_LOCN D,PH_DISP_LOCN B,PH_DISP_LOCN C WHERE A.ORDERING_FACILITY_ID = UPPER(?) AND A.ORDERING_SOURCE_TYPE = UPPER(?) AND A.ORDERING_SOURCE_CODE = UPPER(?)  AND  A.BLNG_GRP_ID=UPPER (?) AND NVL (CUST_GROUP_CODE, '*A') = NVL(UPPER(?),NVL(CUST_GROUP_CODE,'*A')) AND NVL (CUST_CODE, '*A') = NVL(UPPER(?),NVL(CUST_CODE,'*A')) AND NVL (POLICY_TYPE_CODE, '*A') =NVL(UPPER(?),NVL(POLICY_TYPE_CODE,'*A')) AND A.RTN_ORD_DISP_LOCN_CODE=D.DISP_LOCN_CODE AND A.PERFORMING_FACILITY_ID=D.FACILITY_ID AND A.STAT_ORD_DISP_LOCN_CODE=B.DISP_LOCN_CODE AND A.PERFORMING_FACILITY_ID=B.FACILITY_ID AND A.DISCH_ORD_DISP_LOCN_CODE=C.DISP_LOCN_CODE(+)  AND A.ORDERING_FACILITY_ID=C.FACILITY_ID(+)");// cust_group_code,cust_code,policy_code,billingrp added in where condition for MMS internal issue,//X replaced *A for MMS interanal issue start 
		dataMap.put("SQL_PH_BL_GROUP_ORDER_ROUTING_SELECT2", "SELECT PERFORMING_FACILITY_ID, RTN_ORD_DISP_LOCN_CODE, STAT_ORD_DISP_LOCN_CODE, DISCH_ORD_DISP_LOCN_CODE,BLNG_GRP_ID BL_GROUP_CODE,CUST_GROUP_CODE BL_CUSTOMER_GROUP_CODE,CUST_CODE BL_CUSTOMER_CODE,POLICY_TYPE_CODE BL_POLICY_TYPE FROM PH_BLGROUP_ORDER_ROUTING_DTL WHERE ORDERING_FACILITY_ID = UPPER(?) AND ORDERING_SOURCE_TYPE = UPPER(?) AND ORDERING_SOURCE_CODE = UPPER(?) AND ROUTING_LEVEL = UPPER(?) AND ROUTING_CODE = UPPER(?) AND BLNG_GRP_ID=UPPER(?) AND NVL (CUST_GROUP_CODE, '*A') = NVL(UPPER(?),NVL(CUST_GROUP_CODE,'*A')) AND NVL (CUST_CODE, '*A') = NVL(UPPER(?),NVL(CUST_CODE,'*A')) AND NVL (POLICY_TYPE_CODE, '*A') =NVL(UPPER(?),NVL(POLICY_TYPE_CODE,'*A'))");
		dataMap.put("SQL_PH_BL_GROUP_ORDER_ROUTING_DTL_UPDATE", "UPDATE PH_BLGROUP_ORDER_ROUTING_DTL SET PERFORMING_FACILITY_ID =? , RTN_ORD_DISP_LOCN_CODE= ? ,STAT_ORD_DISP_LOCN_CODE=?, DISCH_ORD_DISP_LOCN_CODE = ?,CUST_GROUP_CODE=?,CUST_CODE=?,POLICY_TYPE_CODE=?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ? WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? AND  ROUTING_LEVEL = ? AND ROUTING_CODE = ? AND BLNG_GRP_ID=? AND NVL (CUST_GROUP_CODE, '*A') = NVL(UPPER(?),NVL(CUST_GROUP_CODE,'*A')) AND NVL (CUST_CODE, '*A') = NVL(UPPER(?),NVL(CUST_CODE,'*A')) AND NVL (POLICY_TYPE_CODE, '*A') =NVL(UPPER(?),NVL(POLICY_TYPE_CODE,'*A'))");
		dataMap.put("SQL_PH_BILLING_GROUP_TYPE_SELECT","SELECT SETTLEMENT_IND FROM BL_BLNG_GRP_LANG_VW WHERE  BLNG_GRP_ID=? AND LANGUAGE_ID=? ");
		dataMap.put("SQL_PH_BL_ORDER_ROUTING_SELECT12", "SELECT COUNT(ROWID) count FROM PH_BLGROUP_ORDER_ROUTING_DTL WHERE ORDERING_FACILITY_ID = UPPER(?) AND ORDERING_SOURCE_TYPE = UPPER(?) AND ORDERING_SOURCE_CODE = UPPER(?) AND ROUTING_LEVEL = UPPER(?) AND ROUTING_CODE = UPPER(?) AND BLNG_GRP_ID=UPPER(?) AND NVL (CUST_GROUP_CODE, '*A') = NVL(UPPER(?),NVL(CUST_GROUP_CODE,'*A')) AND NVL (CUST_CODE, '*A') = NVL(UPPER(?),NVL(CUST_CODE,'*A')) AND NVL (POLICY_TYPE_CODE, '*A') =NVL(UPPER(?),NVL(POLICY_TYPE_CODE,'*A'))");
		dataMap.put("SQL_PH_BL_ORDER_ROUTING_SELECT11", "SELECT COUNT(ROWID) count FROM PH_BLGROUP_ORDER_ROUTING WHERE ORDERING_FACILITY_ID = UPPER(?) AND ORDERING_SOURCE_TYPE = UPPER(?) AND ORDERING_SOURCE_CODE = UPPER(?) AND BLNG_GRP_ID=UPPER(?) AND NVL (CUST_GROUP_CODE, '*A') = NVL(UPPER(?),NVL(CUST_GROUP_CODE,'*A')) AND NVL (CUST_CODE, '*A') = NVL(UPPER(?),NVL(CUST_CODE,'*A')) AND NVL (POLICY_TYPE_CODE, '*A') =NVL(UPPER(?),NVL(POLICY_TYPE_CODE,'*A'))");
		dataMap.put("SQL_PH_BL_ORDER_ROUTING_DELETE", "DELETE PH_BLGROUP_ORDER_ROUTING WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? AND blng_grp_id =? AND NVL (CUST_GROUP_CODE, '*A') = NVL(UPPER(?),NVL(CUST_GROUP_CODE,'*A')) AND NVL (CUST_CODE, '*A') = NVL(UPPER(?),NVL(CUST_CODE,'*A')) AND NVL (POLICY_TYPE_CODE, '*A') =NVL(UPPER(?),NVL(POLICY_TYPE_CODE,'*A'))");
		dataMap.put("SQL_PH_BL_ORDER_ROUTING_DTL_DELETE", "DELETE PH_BLGROUP_ORDER_ROUTING_DTL WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? AND  ROUTING_LEVEL = ? AND ROUTING_CODE = ? AND blng_grp_id =? AND NVL (CUST_GROUP_CODE, '*A') = NVL(UPPER(?),NVL(CUST_GROUP_CODE,'*A')) AND NVL (CUST_CODE, '*A') = NVL(UPPER(?),NVL(CUST_CODE,'*A')) AND NVL (POLICY_TYPE_CODE, '*A') =NVL(UPPER(?),NVL(POLICY_TYPE_CODE,'*A')) ");//X replaced *A for MMS interanal issue start 
        dataMap.put("SQL_PH_BLGROUP_ALT_DISP_LOCN_INSERT", "INSERT INTO PH_BLGROUP_ALT_DISP_LOCN(ORDERING_FACILITY_ID, ORDERING_SOURCE_TYPE, ORDERING_SOURCE_CODE, PERFORMING_FACILITY_ID, DISP_LOCN_CODE,ALT_DISP_LOCN_CODE, DAY_TYPE,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE,  MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID,TIME_FROM,TIME_TO,EFF_STATUS, ORD_LEVEL_IND, ROUTING_LEVEL, ROUTING_CODE)VALUES (?, ?, ?, ?, ?, ?, ?, ?,SYSDATE, ?, ?, ?, SYSDATE, ?, ?,TO_DATE(?,'hh24:mi'),TO_DATE(?,'hh24:mi'),?,?,?,?)" );
        dataMap.put("SQL_PH_BLGROUP_ALT_DISP_LOCN_UPDATE", "DELETE FROM PH_BLGROUP_ALT_DISP_LOCN WHERE ORDERING_FACILITY_ID=? AND ORDERING_SOURCE_TYPE=? AND ORDERING_SOURCE_CODE=? AND PERFORMING_FACILITY_ID=? AND DISP_LOCN_CODE=? AND DAY_TYPE=? AND ORD_LEVEL_IND=? AND ROUTING_LEVEL=? AND ROUTING_CODE=?");
	    dataMap.put("SQL_PH_BL_ORDER_ROUTING_SELECT13",  "SELECT   a.order_type_code, b.short_desc, a.drug_class FROM ph_order_type_for_drug_class a, or_order_type_lang_vw b WHERE a.order_type_code = b.order_type_code AND b.eff_status = 'E' AND b.language_id = ? UNION ALL SELECT   order_type_code, short_desc, NULL drug_class FROM or_order_type_lang_vw WHERE order_category = 'PH' AND eff_status = 'E' AND language_id = ? AND order_type_code NOT IN (SELECT a.order_type_code FROM ph_order_type_for_drug_class a, or_order_type_lang_vw b WHERE a.order_type_code = b.order_type_code AND b.eff_status = 'E' AND b.language_id = ?) ORDER BY 2 " );
        dataMap.put("SQL_PH_BL_ORDER_ROUTING_SELECT14",  "SELECT ALT_DISP_LOCN_CODE,EFF_STATUS,to_char(TIME_FROM,'hh24:mi') TIME_FROM,to_char(TIME_TO,'hh24:mi')TIME_TO  FROM PH_BLGROUP_ALT_DISP_LOCN  WHERE ORDERING_FACILITY_ID=? AND  ORDERING_SOURCE_TYPE=?  AND ORDERING_SOURCE_CODE=? AND PERFORMING_FACILITY_ID=? AND DAY_TYPE=? AND DISP_LOCN_CODE=?   AND ROUTING_LEVEL =? AND ROUTING_CODE =? AND ORD_LEVEL_IND=?" );//AND ORD_LEVEL_IND=? added for MMS_BETA_0043[046240]; 
		dataMap.put("SQL_PH_BL_ORDER_ROUTING_ALT_DELETE", "DELETE PH_BLGROUP_ALT_DISP_LOCN WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ? AND  ROUTING_LEVEL = ? AND ROUTING_CODE = ? ");
		dataMap.put("SQL_PH_BL_ORDER_ROUTING_ALT_DELETE_FOR_SOURCE", "DELETE PH_BLGROUP_ALT_DISP_LOCN WHERE ORDERING_FACILITY_ID =? AND  ORDERING_SOURCE_TYPE = ? AND ORDERING_SOURCE_CODE = ?");
	    dataMap.put("SQL_PH_BL_ORDER_ROUTING_SELECT15",  "SELECT ALT_DISP_LOCN_CODE,EFF_STATUS,to_char(TIME_FROM,'hh24:mi') TIME_FROM,to_char(TIME_TO,'hh24:mi')TIME_TO  FROM PH_BLGROUP_ALT_DISP_LOCN  WHERE ORDERING_FACILITY_ID=? AND  ORDERING_SOURCE_TYPE=?  AND ORDERING_SOURCE_CODE=? AND PERFORMING_FACILITY_ID=? AND DAY_TYPE=? AND DISP_LOCN_CODE=?  AND ROUTING_LEVEL =? AND ORD_LEVEL_IND=?" );//added for CRF MMS-QH-CRF-0048 [IN:037704]-end // AND ORD_LEVEL_IND=? added for MMS_BETA_0043[046240]; 
		dataMap.put("SQL_PH_PRESCRIPTION_PREG_DRUG_DETAILS_SELECT","select preg_category_group_code, preg_effect_ft, preg_effect_st,preg_effect_tt, preg_warn_req_ft_yn, preg_warn_req_st_yn,preg_warn_req_tt_yn, preg_category_code1, preg_category_code2, preg_category_code3 FROM ph_drug_vw_lang_vw WHERE drug_code = ? and LANG1=? ");//added for CRF RUT-CRF-0063[29601]
		dataMap.put("SQL_PH_CA_PRACT_SELECT","select  b.FUNC_ROLE_ID,A.PRACTITIONER_NAME from AM_PRACTITIONER_LANG_VW a,SM_APPL_USER b where APPL_USER_ID=? and A.PRACTITIONER_ID=b.FUNC_ROLE_ID and A.LANGUAGE_ID=? ");//added for CRF RUT-CRF-0063[29601]
		dataMap.put("SQL_PH_CA_PATIENT_PREGN_NO_DAYE","select to_char(to_date(?,'dd/mm/yyyy')-to_date(?,'dd/mm/yyyy')) preg_days from dual");
		dataMap.put("SQL_PH_SELECT_SHC_MAR_PARAM_VALUES","SELECT mar_sch_level_yn, mar_start_ind, TO_char (NVL (DECODE (mar_start_ind, 'S', TRUNC (SYSDATE, 'DAY') + case when (to_char(sysdate,'D') > NVL (mar_week_day_start, 0)) then mar_week_day_start else (mar_week_day_start - 7)  end, 'C', trunc (SYSDATE), 'U', trunc (SYSDATE) - NVL (mar_past_day, 0) ), SYSDATE), 'dd/mm/yyyy' ) start_date, TO_char ( NVL (DECODE (mar_start_ind, 'S',(TRUNC (SYSDATE, 'DAY') + case when (to_char(sysdate,'D') > NVL (mar_week_day_start, 0)) then mar_week_day_start else (mar_week_day_start - 7)  end)+6, 'C', trunc (SYSDATE)+6, 'U', trunc (SYSDATE) + NVL (mar_future_day, 0) ), SYSDATE), 'dd/mm/yyyy' ) end_date, mar_week_day_start, mar_past_day, mar_future_day, mar_disc_dose_yn, mar_default_order_by, mar_iv_compl_dt_ind , TO_char (trunc(trunc(sysdate,'MM'),'MM'),'dd/mm/yyyy') MONTH_START, TO_char (last_day(trunc(sysdate,'MM')),'dd/mm/yyyy') MONTH_END FROM ph_facility_param WHERE mar_sch_level_yn = 'Y' AND facility_id = ?");
		dataMap.put("SQL_PH_SELECT_SHC_MAR_DATE_DAY_DTLS","select TO_CHAR (to_date(?,'DD/MM/YYYY')  + level -1, 'DD/MM/YYYY') dt,to_char(to_date(?,'DD/MM/YYYY')  + level -1,'Day') day_week,to_char(to_date(?,'DD/MM/YYYY')  + level -1,'DD') day_month from dual connect by level <= to_date(?,'DD/mm/yyyy') +1 - to_date(?,'dd/mm/yyyy')");
		dataMap.put("SQL_PH_SELECT_NAVI_PREV_DATE_RAGE_MONTH","SELECT TO_CHAR (TRUNC (TRUNC (to_date(?,'dd/mm/yyyy')-1, 'MM'), 'MM'), 'dd/mm/yyyy') fromDate, TO_CHAR (LAST_DAY (TRUNC (to_date(?,'dd/mm/yyyy')-1, 'MM')), 'dd/mm/yyyy') toDate FROM dual");
		dataMap.put("SQL_PH_SELECT_NAVI_PREV_DATE_RAGE_WEEK","SELECT TO_CHAR(to_date(?,'dd/mm/yyyy')-(to_date(?,'dd/mm/yyyy')-to_date(?,'dd/mm/yyyy')+1),'dd/mm/yyyy') fromDate, TO_CHAR(to_date(?,'dd/mm/yyyy')-1,'dd/mm/yyyy') toDate  FROM dual");
		dataMap.put("SQL_PH_SELECT_NAVI_NEXT_DATE_RAGE_MONTH","SELECT TO_CHAR (TRUNC (TRUNC (to_date(?,'dd/mm/yyyy')+1, 'MM'), 'MM'), 'dd/mm/yyyy') fromDate, TO_CHAR (LAST_DAY (TRUNC (to_date(?,'dd/mm/yyyy')+1, 'MM')), 'dd/mm/yyyy') toDate FROM dual");
		dataMap.put("SQL_PH_SELECT_NAVI_NEXT_DATE_RAGE_WEEK","SELECT TO_CHAR (TO_DATE (?, 'dd/mm/yyyy') + 1, 'dd/mm/yyyy') fromdate, TO_CHAR( TO_DATE (?, 'dd/mm/yyyy') + (TO_DATE (?, 'dd/mm/yyyy') - TO_DATE (?, 'dd/mm/yyyy') + 1), 'dd/mm/yyyy' ) todate FROM DUAL");
		dataMap.put("SQL_PH_SELECT_DOC_NO_DELIVERY","SELECT DISTINCT DOC_NO FROM PH_DISP_HDR A WHERE A.PATIENT_ID =? AND TRUNC(A.DISP_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND a.PATIENT_CLASS=? ORDER BY DOC_NO");////code added for GHL-CRF-0323[IN:040527]
		dataMap.put("SQL_PH_SELECT_DOC_NO_FILL","SELECT DISTINCT DOC_NO FROM PH_DISP_HDR_TMP A WHERE A.PATIENT_ID =? AND TRUNC(A.DISPENSED_DATE_TIME)=TO_DATE(?,'DD/MM/YYYY') AND a.PATIENT_CLASS=? ORDER BY DOC_NO");//code added for GHL-CRF-0323[IN:040527]
		//dataMap.put("SQL_PH_ORDER_LINE_UPDATE_HOLD","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS=?,HOLD_PRACT_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), HOLD_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),LAST_ACTION_TYPE=?,LAST_ACTION_REASON_DESC=?,CAN_LINE_REASON=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?, PREV_ORDER_LINE_STATUS=ORDER_LINE_STATUS  WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");// modified for inc SKR-SCF-0840
		dataMap.put("SQL_PH_ORDER_LINE_UPDATE_HOLD","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS=?,HOLD_PRACT_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), HOLD_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),LAST_ACTION_TYPE=?,LAST_ACTION_REASON_DESC=?,CAN_LINE_REASON=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?  WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_PATIENT_DRUG_PROFILE_UPDATE_HOLD","UPDATE PH_PATIENT_DRUG_PROFILE SET ON_HOLD_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), ON_HOLD_BY_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), ON_HOLD_REASON_CODE=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?, ALT_DRUG_REMARKS=? WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_ORDER_LINE_UPDATE_DISCONT","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS=?, DISC_PRACT_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?), DISC_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'),LAST_ACTION_TYPE=?,LAST_ACTION_REASON_DESC=?,CAN_LINE_REASON=?,MODIFIED_DATE=SYSDATE, MODIFIED_BY_ID=?,MODIFIED_FACILITY_ID=?,MODIFIED_AT_WS_NO=?, PREV_ORDER_LINE_STATUS=ORDER_LINE_STATUS  WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
		dataMap.put("SQL_PH_PATIENT_DRUG_PROFILE_UPDATE_DISCONT","UPDATE PH_PATIENT_DRUG_PROFILE SET DISCONT_DATE_TIME=TO_DATE(?,'DD/MM/YYYY HH24:MI'), DISCONT_BY_ID=(select func_role_id from sm_appl_user where APPL_USER_ID=?),  DISCONT_REASON_CODE=?, MODIFIED_BY_ID=?, MODIFIED_DATE=SYSDATE, MODIFIED_AT_WS_NO=?, MODIFIED_FACILITY_ID=?  WHERE PATIENT_ID=? AND ORIG_ORDER_ID=? AND ORIG_ORDER_LINE_NO=? AND FACILITY_ID=?");
		dataMap.put("SQL_PH_FACILITY_PARAM_GET_ALLERGY_CONF","Select ALLERGY_CONF_REQD_YN from MR_PARAMETER");
		dataMap.put("SQL_PH_PRESCIPTION_GET_ALLERGY_CONF","Select ALLERGY_CONF_REQD_YN from PH_FACILITY_PARAM where facility_id=?");
		dataMap.put("SQL_PH_PRESCIPTION_GET_PATIENT_ALLERGY_CONF","select count(*) ALLERGY_COUNT from MR_ALLERGY_CONFIRMATION where PATIENT_ID = ? and ONSET_ENCOUNTER_ID = ?");
		dataMap.put("SQL_PH_PRES_UOM_DECIMAL_INSERT_CHECK","SELECT COUNT(ROWID) FROM PH_PRES_UOM_DECIMAL WHERE UOM_CODE = UPPER(?) AND DECIMAL_VALUE = ?");// added for RUT-CRF-0094 
		dataMap.put("SQL_PH_PRES_UOM_DECIMAL_INSERT","INSERT INTO PH_PRES_UOM_DECIMAL (UOM_CODE,DECIMAL_VALUE,FRACT_VALUE,FRACT_DESC,FRACT_DESC_LOCAL,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");// added for RUT-CRF-0094
		dataMap.put("SQL_PH_PRES_UOM_DECIMAL_UPDATE","UPDATE PH_PRES_UOM_DECIMAL SET FRACT_VALUE = ?,FRACT_DESC = ?,FRACT_DESC_LOCAL = ?, EFF_STATUS = ?, MODIFIED_BY_ID = ?, MODIFIED_DATE = SYSDATE, MODIFIED_AT_WS_NO = ?, MODIFIED_FACILITY_ID = ?  WHERE UPPER(UOM_CODE)=UPPER(?) AND DECIMAL_VALUE=?");// added for RUT-CRF-0094
		dataMap.put("SQL_PH_AM_UOM_LANG_VW_SELECT_LONGDESC","SELECT LONG_DESC FROM AM_UOM_LANG_VW WHERE UOM_CODE=UPPER(?) AND LANGUAGE_ID=?");// added for RUT-CRF-0094
		dataMap.put("SQL_PH_PRES_UOM_DECIMAL_SELECT_ALL","SELECT A.UOM_CODE UOM_CODE, A.SHORT_DESC UOM_DESC, B.DECIMAL_VALUE DECIMAL_VALUE, B.FRACT_VALUE FRACT_VALUE,B.FRACT_DESC FRACT_DESC, B.FRACT_DESC_LOCAL FRACT_DESC_LOCAL, B.EFF_STATUS EFF_STATUS FROM AM_UOM_LANG_VW A, PH_PRES_UOM_DECIMAL B where A.UOM_CODE = B.UOM_CODE  AND UPPER(A.UOM_CODE) LIKE NVL(UPPER(?),A.UOM_CODE) AND UPPER(A.SHORT_DESC) LIKE  NVL(UPPER(?),A.SHORT_DESC) AND B.DECIMAL_VALUE LIKE ? AND UPPER(B.FRACT_VALUE) LIKE  NVL(UPPER(?),B.FRACT_VALUE) AND UPPER(B.FRACT_DESC) LIKE  NVL(UPPER(?),B.FRACT_DESC) AND A.LANGUAGE_ID=?");// added for RUT-CRF-0094
		dataMap.put("SQL_PH_PRES_UOM_DECIMAL_SELECT","SELECT A.UOM_CODE UOM_CODE, A.SHORT_DESC UOM_DESC, B.DECIMAL_VALUE DECIMAL_VALUE, B.FRACT_VALUE FRACT_VALUE,B.FRACT_DESC FRACT_DESC, B.FRACT_DESC_LOCAL FRACT_DESC_LOCAL, B.EFF_STATUS EFF_STATUS FROM AM_UOM_LANG_VW A, PH_PRES_UOM_DECIMAL B where A.UOM_CODE = B.UOM_CODE  AND UPPER(A.UOM_CODE) LIKE NVL(UPPER(?),A.UOM_CODE) AND B.DECIMAL_VALUE LIKE ? AND A.LANGUAGE_ID = ?");// added for RUT-CRF-0094
		dataMap.put("SQL_PH_MEDN_ADMIN_COULD_NOT_ADMIN_AUDIT","SELECT NVL(MAX(ACTION_SEQ_NUM),0)+1  FROM OR_ORDER_ACTION  WHERE ORDER_ID = ? and order_line_num=?");// Added for AAKH-CRF-0024 [IN:038260]
		dataMap.put("SQL_PH_MEDN_ADMIN_COULD_NOT_ADMIN_AUDIT_INSERT","INSERT INTO OR_ORDER_ACTION (	ORDER_ID,ORDER_LINE_NUM,ACTION_SEQ_NUM,ACTION_USER_ID,ACTION_DATE_TIME,ACTION_FACILITY_ID,FIELD_MNEMONIC,FIELD_VALUE_OLD,FIELD_VALUE_NEW,FIELD_VALUE_TXT) VALUES (?,?,?,?,SYSDATE,?,?,?,?,?)");// Added for AAKH-CRF-0024 [IN:038260]
		dataMap.put("SQL_PH_ORDER_UPDATE_DISCONT","UPDATE or_order SET order_status = ? ,modified_by_id =?,modified_date  = sysdate,modified_at_ws_no=?,modified_facility_id=? WHERE order_id = ?");// Added for SKR-SCF-0902 [IN:044632]
		dataMap.put("SQL_OR_ORDER_STATUS_SELECT","select order_id,order_line_status from or_order_line a where order_id = ? and order_line_num not in (?) and order_line_Status in (select order_Status_code from or_ordeR_status_code where ordeR_status_type in ('99','97','96','95','90','85','80','75','70','65','60','55','54','52','25','20','15','10','05','03','00','23','35') and order_Status_code = a.order_line_status and rownum <=1)   order by order_line_status ASC");// Added for SKR-SCF-0902 [IN:044632]
		dataMap.put("SQL_PH_ORDER_UPDATE_HDR","UPDATE or_order SET order_status = (SELECT order_Status_code FROM or_order_status_code WHERE order_Status_type =(?)), modified_by_id=(?), modified_date=SYSDATE, modified_at_ws_no=(?), modified_facility_id=(?) WHERE order_id = (?)");// Added for SKR-SCF-0902 [IN:044632]
		dataMap.put("SQL_PH_UPDATE_PREV_ORDER_STATUS","update or_order_line set prev_order_line_status = order_line_status where order_id = ?");// Added for SKR-SCF-0840
		dataMap.put("SQL_PH_SELECT_DISCHARGE_BILL_GEN_IND","select DISCHARGE_BILL_GEN_IND from bl_episode_fin_dtls where patient_id = ? and operating_facility_id = ? and episode_id =?");// Added for JD-CRF-0178 [IN:039208]
		dataMap.put("SQL_SELECT_FINANCE_BILL_DTL"," SELECT A.CURR_ENC_FINANCIAL_DTL_YN ,B.BL_INTERFACE_YN FROM PH_DISP_RIGHTS A,ST_ACC_ENTITY_PARAM B WHERE FACILITY_ID=? AND APPL_USER_ID =? AND DISP_LOCN_CODE =?");//code added for JD-CRF-0156[IN041737]
		dataMap.put("SQL_PH_ITEM_CONSUMPTION_CUSTOMER_SELECT","SELECT SHORT_NAME,CUST_CODE FROM AR_CUSTOMER_LANG_VW WHERE LANGUAGE_ID=? order by SHORT_NAME");//Added for MMS-QH-CRF-0106
		dataMap.put("SQL_PH_ITEM_CONSUMPTION_REPORT_SELECT","SELECT count(a.item_code) item_count FROM ph_disp_drug_batch a, ph_disp_hdr b, bl_patient_charges_interface i, bl_patient_charges_folio j WHERE b.facility_id = ? AND b.disp_locn_code = NVL (?, b.disp_locn_code) AND b.disp_date_time BETWEEN TO_DATE (?, 'dd/mm/yyyy') AND (TO_DATE (?, 'dd/mm/yyyy') + 1) AND a.disp_no = b.disp_no AND a.facility_id = b.facility_id AND a.disp_locn_code = b.disp_locn_code AND (b.doc_type || '-' || b.doc_no) = i.sec_key_main AND i.operating_facility_id = j.operating_facility_id AND i.trx_doc_ref = j.trx_doc_ref AND i.trx_doc_ref_line_num = j.trx_doc_ref_line_num AND nvl(j.cust_code ,'!') = NVL (?, nvl(j.cust_code,'!')) AND b.patient_class = NVL (?, b.patient_class) AND NVL (j.cust_group_code, '!') BETWEEN NVL (?, '!') AND NVL (?, '~')");//Added for MMS-QH-CRF-0106
		dataMap.put("SQL_SELECT_ENCOUNTER_DTL"," SELECT encounter_id, EPISODE_ID,PATIENT_CLASS FROM PR_ENCOUNTER WHERE patient_id = ?  AND facility_id = ?  ORDER BY VISIT_ADM_DATE_TIME DESC");//code added for JD-CRF-0156[IN041737]  
		dataMap.put("SQL_SELECT_ENCOUNTER_EPISODE_DTL"," SELECT EPISODE_ID,PATIENT_CLASS FROM PR_ENCOUNTER WHERE patient_id = ? AND ENCOUNTER_ID=?   AND facility_id = ? ");//code added for JD-CRF-0156[IN041737]  
		dataMap.put("SQL_PH_POLICY_SELECT","SELECT  DISTINCT A.POLICY_TYPE_CODE ,B.SHORT_DESC FROM BL_INS_POLICY_TYPE_HDR A, BL_INS_POLICY_TYPES B WHERE  A.POLICY_TYPE_CODE=B.POLICY_TYPE_CODE ORDER BY B.SHORT_DESC ");//added for MMS-QH-CRF-0110[IN039378]  
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_TYPE","SELECT FLANG.FORM_CODE, FLANG.FORM_DESC,NVL((SELECT HMED.EFF_STATUS FROM PH_HOME_MED_TYPE HMED WHERE HMED.MED_TYPE_IND=? AND FLANG.FORM_CODE=HMED.FORM_CODE),'D')  EFF_STATUS FROM PH_FORM_LANG_VW FLANG WHERE  FLANG.EFF_STATUS='E' AND FLANG.LANGUAGE_ID=?  ORDER BY FLANG.FORM_DESC");//Added for RUT-CRF-0061// Modified for RUT-SCF-0358[IN46714]
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_REPORT_PRINT_OPTION","SELECT REPORT_ID,PRINT_STATUS FROM PH_DISP_LOCN_PRN_OPTION WHERE FACILITY_ID=? AND PATIENT_CLASS=? AND DISP_STAGE=? AND DISP_LOCN_CODE=? and REPORT_ID in( 'HOME_MED_SHEET_TAPER' ,'HOME_MED_SHEET_PORTRAIT','HOME_MED_SHEET_LANDSCAPE')");//Added for RUT-CRF-0061 [IN:029599]
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_REPORT_TYPE_TMP","SELECT distinct( e.med_type_ind) med_type_ind FROM ph_disp_dtl_tmp b, ph_drug_vw d, ph_home_med_type e WHERE B.DISP_DRUG_CODE = D.DRUG_CODE  AND e.form_code = d.form_code AND e.eff_status = 'E' AND b.print_seq_no = ? AND b.facility_id = ?");//Added for RUT-CRF-0061 [IN:029599]//Modified query for [IN45913]
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_REPORT_TYPE","SELECT distinct( e.med_type_ind) med_type_ind FROM ph_disp_dtl b, ph_drug_vw d, ph_home_med_type e WHERE B.DISP_DRUG_CODE = D.DRUG_CODE  AND e.form_code = d.form_code AND e.eff_status = 'E' AND b.print_seq_no = ? AND b.facility_id = ?");//Added for RUT-CRF-0061 [IN:029599]//Modified for [IN45913]
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_REPORT_TAPER_TMP","SELECT COUNT (*) taper_count FROM OR_ORDER_LINE_PH A, PH_DISP_DTL_TMP D WHERE A.ORDER_ID IN (SELECT B.ORDER_ID FROM OR_ORDER B WHERE B.TRN_GROUP_REF = (SELECT TRN_GROUP_REF FROM OR_ORDER WHERE ORDER_ID = D.ORDER_ID AND D.PRINT_SEQ_NO = ? AND D.FACILITY_ID = ? )) AND A.ORDER_ID=D.ORDER_ID AND A.ORDER_LINE_NUM=D.ORDER_LINE_NO and a.tapered_yn ='Y'");//Added for RUT-CRF-0061 [IN:046607] 
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_REPORT_TAPER","SELECT COUNT (*) taper_count FROM OR_ORDER_LINE_PH A, PH_DISP_DTL D WHERE A.ORDER_ID IN ( SELECT B.ORDER_ID FROM OR_ORDER B WHERE B.TRN_GROUP_REF = (SELECT TRN_GROUP_REF FROM OR_ORDER WHERE ORDER_ID = D.ORDER_ID AND D.PRINT_SEQ_NO = ? AND D.FACILITY_ID = ?)) AND A.ORDER_ID = D.ORDER_ID AND A.ORDER_LINE_NUM = D.ORDER_LINE_NO and a.tapered_yn ='Y'");//Added for RUT-CRF-0061 [IN:046607]
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_TYPE_SELECT","SELECT COUNT(ROWID) FROM PH_HOME_MED_TYPE WHERE MED_TYPE_IND=? AND FORM_CODE = UPPER(?)");//Added for RUT-CRF-0061
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_TYPE_INSERT","INSERT INTO PH_HOME_MED_TYPE(MED_TYPE_IND,FORM_CODE,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID ,MODIFIED_BY_ID ,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) values(?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");//Added for RUT-CRF-0061
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_TYPE_UPDATE","UPDATE PH_HOME_MED_TYPE SET EFF_STATUS='E', MODIFIED_BY_ID =? , MODIFIED_DATE=SYSDATE , MODIFIED_AT_WS_NO=? , MODIFIED_FACILITY_ID=? WHERE MED_TYPE_IND=? AND FORM_CODE=?");
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_TYPE_DELETE","DELETE PH_HOME_MED_TYPE WHERE MED_TYPE_IND=? AND FORM_CODE=?");
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_TYPE_ASSOCIATION","SELECT DISTINCT HM.FORM_CODE FORM_CODE, VW.FORM_DESC FORM_DESC,HM.EFF_STATUS EFF_STATUS FROM PH_FORM_LANG_VW VW,PH_HOME_MED_TYPE HM WHERE VW.FORM_CODE=HM.FORM_CODE AND HM.MED_TYPE_IND=UPPER(?) AND hm.eff_status='E' AND VW.LANGUAGE_ID=? order by FORM_DESC");
		dataMap.put("SQL_PH_HOME_MEDN_SHEET_TYPE_QUERY","SELECT MedType.FORM_CODE,FormLangVw.FORM_DESC,MedType.MED_TYPE_IND,MedType.EFF_STATUS FROM PH_HOME_MED_TYPE MedType,PH_FORM_LANG_VW FormLangVw WHERE MedType.FORM_CODE=FormLangVw.FORM_CODE AND MedType.MED_TYPE_IND=? AND FormLangVw.LANGUAGE_ID=?");//Modified for RUT-SCF-0358[IN46714]
        dataMap.put("SQL_PATIENT_PROFILE_MEDICAL_ITEM_SELECT","SELECT TO_CHAR(b.added_date,'DD/MM/YYYY HH24:MI') ord_date, TO_CHAR(b.added_date,'DD/MM/YYYY HH24:MI') disp_date, b.item_code, (SELECT short_desc FROM mm_item_lang_vw WHERE language_id = 'en' AND item_code = b.item_code) item_name, b.item_qty order_qty, b.item_qty disp_qty, (SELECT gen_uom_code FROM mm_item WHERE item_code = b.item_code) order_uom, 'Dispensed - Complete' status_desc, (SELECT appl_user_name FROM sm_appl_user_lang_vw WHERE language_id = 'en' AND appl_user_id = b.added_by_id) ordered_practitioner, (SELECT facility_name FROM sm_facility_param_lang_vw WHERE language_id = 'en' AND facility_id = a.facility_id) || '- Dispense Location /' || (SELECT short_desc FROM ph_disp_locn_lang_vw WHERE language_id = 'en' AND facility_id = a.facility_id AND disp_locn_code = a.store_code) ordering_details, decode(SAL_TRN_TYPE, 'I', 'IP', 'D','IP', 'O', 'OP','E', 'OP', 'X', 'XT') patient_class, '' order_id, order_line_num, (SELECT short_desc FROM ph_disp_locn_lang_vw WHERE language_id = 'en' AND facility_id = a.facility_id AND disp_locn_code = a.store_code) disp_locn FROM st_sal_hdr a, st_sal_dtl b WHERE a.facility_id = b.facility_id AND a.doc_type_code = b.doc_type_code AND a.doc_no = b.doc_no AND b.item_code IN (SELECT item_code FROM ph_drug WHERE drug_yn = 'N') AND a.module_id = 'PH' AND NOT EXISTS ( (SELECT 'Y' FROM ph_disp_hdr WHERE patient_id = a.patient_id AND doc_type = a.doc_type_code AND doc_no = a.doc_no AND facility_id = a.facility_id AND order_id IN (SELECT order_id FROM ph_disp_cons_dtl)) UNION (SELECT 'Y' FROM ph_disp_hdr_tmp WHERE patient_id = a.patient_id AND doc_type = a.doc_type_code AND doc_no = a.doc_no AND facility_id = a.facility_id AND order_id IN (SELECT order_id FROM ph_disp_cons_dtl))) AND patient_id = ? UNION SELECT TO_CHAR(b.ord_date_time,'DD/MM/YYYY HH24:MI') ord_date, TO_CHAR(b.ord_date_time,'DD/MM/YYYY HH24:MI') disp_date, a.order_catalog_code, (SELECT drug_desc FROM ph_drug WHERE drug_code = a.order_catalog_code) item_name, a.order_qty, pdp.tot_issued_qty disp_qty, a.order_uom, (SELECT short_desc FROM or_order_status_code_lang_vw WHERE language_id = 'en' AND order_status_code = a.order_line_status) status_desc, (SELECT practitioner_name FROM am_practitioner_lang_vw WHERE language_id = 'en' AND practitioner_id = b.ord_pract_id) ordered_practitioner, (SELECT facility_name FROM sm_facility_param_lang_vw WHERE language_id = 'en' AND facility_id = b.ordering_facility_id) || DECODE (b.source_type, 'N', (SELECT '- Nursing Unit/' || short_desc FROM ip_nursing_unit_lang_vw WHERE language_id = 'en' AND facility_id = b.ordering_facility_id AND nursing_unit_code = b.source_code), 'C', (SELECT '- Clinic/' || short_desc FROM op_clinic_lang_vw WHERE language_id = 'en' AND facility_id = b.ordering_facility_id AND clinic_code = b.source_code), 'D', (SELECT '- Day Care/' || short_desc FROM ip_nursing_unit_lang_vw WHERE language_id = 'en' AND facility_id = b.ordering_facility_id AND nursing_unit_code = b.source_code), 'E', (SELECT '- Emergency/' || short_desc FROM op_clinic_lang_vw WHERE language_id = 'en' AND facility_id = b.ordering_facility_id AND clinic_code = b.source_code) ) || '/' || b.order_id ordering_details, b.patient_class, a.order_id, a.order_line_num, '' disp_locn FROM or_order_line a, or_order b, ph_patient_drug_profile pdp WHERE a.order_id = b.order_id AND a.order_id = pdp.orig_order_id AND a.order_line_num = pdp.orig_order_line_no AND b.ordering_facility_id = pdp.orig_facility_id AND order_catalog_code IN (SELECT drug_code FROM ph_drug WHERE drug_yn = 'N') AND a.order_category = 'PH' AND b.patient_id =? ORDER BY 1 DESC");//Added for Medical TAB
		dataMap.put("SQL_PH_DISP_SHEET_PRINT_FOR_REFILL_TMP","select count(ol.order_id) refill_count from or_order_line ol, ph_disp_dtl_tmp disp where DISP.PRINT_SEQ_NO =? and DISP.ORDER_ID =OL.PARENT_ORDER_ID  and DISP.ORDER_LINE_NO =OL.PARENT_ORDER_LINE_NUM and OL.CHILD_ORDER_YN='Y' and disp.FACILITY_ID=?");
		dataMap.put("SQL_PH_DISP_SHEET_PRINT_FOR_REFILL","select count(ol.order_id) refill_count from or_order_line ol, ph_disp_dtl disp where DISP.PRINT_SEQ_NO =? and DISP.ORDER_ID =OL.PARENT_ORDER_ID  and DISP.ORDER_LINE_NO =OL.PARENT_ORDER_LINE_NUM and OL.CHILD_ORDER_YN='Y' and disp.FACILITY_ID=?");
		dataMap.put("SQL_PH_REPRINT_MEDICATION_SUMMARY_QUERY","SELECT DISTINCT C.PATIENT_ID,C.PATIENT_NAME,G.TOKEN_SERIAL_NO,A.TRN_GROUP_REF PRACTIONER_ID,TO_CHAR(G.DISP_DATE_TIME,'DD/MM/YYYY') DISPDATE,V.PRACTITIONER_NAME,B.ORDER_ID FROM OR_ORDER A,OR_ORDER_LINE_PH B,MP_PATIENT C,PH_DISP_HDR G,AM_PRACTITIONER_LANG_VW V,PH_HOME_MED_TYPE H,PH_FORM_LANG_VW VW WHERE A.ORDER_ID=G.ORDER_ID AND B.ORDER_ID=A.ORDER_ID AND A.PATIENT_ID=C.PATIENT_ID AND A.ORD_PRACT_ID= V.PRACTITIONER_ID AND B.DISPENSING_LOC=G.DISP_LOCN_CODE AND VW.FORM_CODE=B.FORM_CODE AND G.ATTEND_PRACTITIONER_ID=V.PRACTITIONER_ID AND H.FORM_CODE=VW.FORM_CODE AND G.DISP_DATE_TIME BETWEEN  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI') AND G.DISP_LOCN_CODE=? AND V.LANGUAGE_ID=? AND VW.LANGUAGE_ID=?");//Added for RUT-0061[IN46714]//Added column 'b.order_id' for RUT-SCF-0383[IN46980]
		dataMap.put("SQL_PH_MEDICALITEM_SEARCH_SELECT","SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG_LANG_VW PH_DRUG WHERE UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DRUG_YN='N' AND LANGUAGE_ID =");
		dataMap.put("SQL_PH_DEFFREQFORIV_SELECT","SELECT A.FREQ_CODE,A.FREQ_DESC FROM AM_FREQUENCY_LANG_VW A,OR_FREQUENCY_SCOPE B,PH_FACILITY_PARAM C WHERE A.EFF_STATUS='E' AND A.FREQ_NATURE='C' AND A.FREQ_CODE=B.FREQ_CODE AND  B.ORDER_CATEGORY='PH' AND A.LANGUAGE_ID = ? AND A.FREQ_CODE=C.IV_DEFAULT_FREQUENCY AND C.FACILITY_ID = ?");//Added for Bru-HIMS-CRF-384[IN041642]
		dataMap.put("SQL_PH_CONSUMPTION_BY_DOCTOR_SELECT"," SELECT COUNT (d.ord_pract_id) item_count FROM ph_disp_hdr a,ph_disp_dtl b,ph_disp_drug_batch c,or_order d,(SELECT cust_code, patient_id,episode_id encounter_id, operating_facility_id facility_id,blng_grp_id,cust_group_code,NVL(policy_type_code,(SELECT DISTINCT aa.policy_type_code FROM bl_patient_fin_dtls aa WHERE aa.patient_id =fin.patient_id AND ROWNUM = 1)) policy_type_code FROM bl_episode_fin_dtls fin WHERE episode_type IN ('D', 'I') UNION SELECT cust_code, patient_id,TO_NUMBER (episode_id || '000' || visit_id) encounter_id,operating_facility_id facility_id,blng_grp_id,cust_group_code,NVL(policy_type_code,(SELECT DISTINCT aa.policy_type_code FROM bl_patient_fin_dtls aa WHERE aa.patient_id =m.patient_id AND ROWNUM = 1)) policy_type_code FROM bl_visit_fin_dtls m WHERE episode_type IN ('E', 'O') UNION SELECT cust_code, patient_id, NULL encounter_id,NULL facility_id, blng_grp_id,cust_group_code,policy_type_code FROM bl_patient_fin_dtls bl WHERE NOT EXISTS (SELECT patient_id FROM bl_visit_fin_dtls WHERE episode_type IN ('E', 'O') AND patient_id = bl.patient_id UNION SELECT patient_id FROM bl_episode_fin_dtls WHERE episode_type IN ('D', 'I') AND patient_id = bl.patient_id)) e,bl_blng_grp g,pr_encounter h,(SELECT   facility_id, doc_type_code, doc_no,doc_srl_no,SUM (sal_item_qty) sal_item_qty, SUM (ret_item_qty) ret_item_qty,(SUM (sal_item_qty) - SUM (ret_item_qty)) total_batch_qty,batch_id, item_code,TRUNC(expiry_date_or_receipt_date) expiry_date FROM st_sal_dtl_exp GROUP BY facility_id,doc_type_code,doc_no,doc_srl_no,batch_id,item_code,TRUNC (expiry_date_or_receipt_date)) sal WHERE a.facility_id = b.facility_id AND a.disp_no = b.disp_no AND a.order_id = b.order_id AND c.facility_id = b.facility_id AND c.srl_no = b.srl_no AND a.order_id = d.order_id AND a.dispensed_date_time BETWEEN TO_DATE (?,'DD/MM/YYYY') AND   TO_DATE(?,'DD/MM/YYYY')+ 0.99999 AND ((? IS NULL AND 1 = 1) OR (? IS NOT NULL AND ? <> 'XT' AND h.patient_class = ? AND a.order_id NOT LIKE 'PHXT%')OR ( ? = 'XT' AND a.order_id LIKE 'PHXT%'))AND d.ord_pract_id = NVL (?, d.ord_pract_id)AND h.specialty_code =NVL (?, h.specialty_code)AND NVL (cust_group_code, '#')BETWEEN NVL (TRIM (?),NVL (cust_group_code, '#'))AND NVL (TRIM (?), NVL (cust_group_code, '#'))AND NVL (e.cust_code, '!') =NVL (?, NVL (e.cust_code, '!'))AND NVL (e.policy_type_code, '!') =NVL (?,NVL (e.policy_type_code, '!'))AND NVL (e.encounter_id, h.encounter_id) = h.encounter_id AND e.patient_id = a.patient_id AND e.blng_grp_id = g.blng_grp_id AND a.facility_id = h.facility_id AND decode(a.encounter_id,11111,h.encounter_id,a.encounter_id)=h.encounter_id AND sal.facility_id = a.facility_id AND sal.doc_type_code = a.doc_type AND sal.doc_no = a.doc_no AND sal.batch_id = c.batch_id AND sal.expiry_date = c.expiry_date AND sal.item_code = c.item_code AND sal.doc_srl_no = b.doc_srl_no ");//added for IN50969
		dataMap.put("SQL_PH_PATIENT_APPOINTMENT_DETAILS_SELECT","Select patient_id,MP_GET_DESC.MP_PAT_CATEGORY(patient_cat_code,'en','1') patientCatDesc,AM_GET_DESC.AM_CARE_LOCN_TYPE((select clinic_type from op_clinic where facility_id=oa_appt_patient_vw.facility_id and CLINIC_CODE=oa_appt_patient_vw.clinic_code),?,'1')CARE_LOCN_TYPE_DESC , RESOURCE_CLASS ,CLINIC_CODE,CARE_LOCN_TYPE_IND,appt_ref_no, to_char(appt_date,'dd/mm/rrrr') appt_date1,appt_date,referral_id, nvl(to_char(appt_slab_from_time,'hh24:mi'),' ') appt_slab_from_time, appt_slab_from_time appt_slab_from_time1, nvl(to_char(appt_slab_to_time,'hh24:mi'),' ')appt_slab_to_time,nvl(to_char(appt_duration,'hh24:mi'),' ')appt_duration,OP_GET_DESC.OP_VISIT_TYPE(FACILITY_ID, APPT_TYPE_CODE,?,'2') visit_type_short_desc , OP_GET_DESC.OP_CLINIC(FACILITY_ID,CLINIC_CODE,?,'1') CLINIC_SHORT_DESC ,decode(resource_class, 'P', AM_GET_DESC.AM_PRACTITIONER(PRACTITIONER_ID,?,'1'), 'R', AM_GET_DESC.AM_FACILITY_ROOM(FACILITY_ID, PRACTITIONER_ID,?,'2'),'E', AM_GET_DESC.AM_RESOURCE(FACILITY_ID, PRACTITIONER_ID,?,'2')) practitioner_full_name ,sm_get_desc.sm_appl_user(modified_by_id,?,'1') modified_by,sm_get_desc.sm_appl_user(added_by_id,?,'1') added_by,to_char(added_date,'dd/mm/yyyy hh24:mi') added_date, FACILITY_ID,  to_char(modified_date,'dd/mm/yyyy hh24:mi') modified_date ,AM_GET_DESC.AM_SPECIALITY(speciality_code,?,'2')  SPECIALITY_DESC , SM_GET_DESC.SM_FACILITY_PARAM(FACILITY_ID,?,1)FACILITY_NAME ,appt_status,ORDER_CATALOG_CODE,decode(?,'en',patient_name, nvl(patient_name_loc_lang, patient_name)) patient_name,GENDER ,oth_contact_no,get_age(DATE_OF_BIRTH) age,(select DECEASED_YN from mp_patient where patient_id=oa_appt_patient_vw.patient_id) DECEASED_YN,(select COLOR_INDICATOR from op_visit_type where facility_id=oa_appt_patient_vw.facility_id and VISIT_TYPE_CODE=oa_appt_patient_vw.APPT_TYPE_CODE) COLOR_INDICATOR,(select contact_reason from am_contact_reason_lang_vw where contact_reason_code=oa_appt_patient_vw.TRANS_EXCEED_REASON_CODE and nvl(trans_exceed_reason_yn,'N') = 'Y' and  language_id=?)translator_override_reason,(select rule_appl_yn from oa_param)rule_appl_yn   from oa_appt_patient_vw where  patient_id= ? and appt_date between to_date(nvl(?,'01/01/1400'),'dd/mm/yyyy') and  to_date(nvl(?,'31/12/5000'),'dd/mm/yyyy') and  TO_DATE(TO_CHAR(APPT_DATE,'DD/MM/YYYY')||' '||to_char(APPT_SLAB_TO_TIME,'HH24:MI:SS'),'DD/MM/YYYY HH24:MI:SS')>= SYSDATE  ORDER BY  appt_ref_no asc  ");
		dataMap.put("SQL_PH_SHOW_INSTRUCTION_SELECT","select appt_ref_no  from oa_appt_proc_instructions where facility_id= (select facility_id from oa_appt where appt_ref_no =? and patient_id = ? ) and appt_ref_no = ? union select appt_ref_no  from oa_appt_pat_instructions where facility_id= ( select facility_id from oa_appt where appt_ref_no =? and patient_id = ? ) and appt_ref_no = ? ");
		dataMap.put("SQL_PH_ORDER_CATALOG_SELECT","select short_desc from OR_ORDER_CATALOG_lang_vw where ORDER_CATALOG_CODE = ?  and language_id= ? and 'Y' IN(select Operational_yn from sm_modules_facility where facility_id = (select facility_id from oa_appt where appt_ref_no =? and patient_id = ? ) and module_id = 'OR') ");	
		dataMap.put("SQL_PH_PATIENT_INSTRUCTION_SELECT","SELECT instruction_desc FROM oa_appt_pat_instructions WHERE facility_id = (select facility_id from oa_appt where appt_ref_no =? and patient_id = ? ) AND appt_ref_no = ? ORDER BY display_order  ");		
		dataMap.put("SQL_PH_PROCEDURE_INSTRUCTION_SELECT","SELECT INSTRUCTION_DESC FROM oa_appt_proc_instructions WHERE facility_id = ( select facility_id from oa_appt where appt_ref_no =? and patient_id = ? ) AND appt_ref_no = ? ");	
		
		dataMap.put("SQL_PH_RETURNMEDICATION_SELECT","SELECT X.DISP_LOCN_CODE,B.SHORT_DESC DISP_DESC, G.RTN_QTY RETURNED_QTY ,E.SHORT_DESC RET_QTY_UOM, TO_CHAR(G.ADDED_DATE,'DD/MM/YYYY HH24:MI') RETURNED_DATE_TIME, D.DRUG_DESC RETURNED_DRUG_DESC, APLUSR.APPL_USER_NAME RETURNED_BY,A.ALT_DRUG_REMARKS, 'R' STATUS  FROM PH_DISP_HDR X, PH_DISP_DTL A, PH_DISP_LOCN_LANG_VW B,(SELECT DRUG_CODE DRUG_CODE,DRUG_DESC DRUG_DESC FROM PH_DRUG_LANG_VW  WHERE LANGUAGE_ID=? UNION SELECT TPN_REGIMEN_CODE  DRUG_CODE, LONG_NAME DRUG_DESC FROM  PH_TPN_REGIMEN_LANG_VW WHERE LANGUAGE_ID=?) D, AM_UOM_LANG_VW E, SM_APPL_USER_LANG_VW APLUSR , PH_RETN_MEDN G WHERE X.ORDER_ID=? AND X.FACILITY_ID = A.FACILITY_ID AND X.DISP_NO = A.DISP_NO AND A.ORDER_LINE_NO= NVL(?,A.ORDER_LINE_NO) AND D.DRUG_CODE = A.DISP_DRUG_CODE AND E.UOM_CODE = g.RTN_QTY_UOM AND B.FACILITY_ID = X.FACILITY_ID AND B.DISP_LOCN_CODE = X.DISP_LOCN_CODE AND APLUSR.APPL_USER_ID = X.DISPENSED_BY AND B.LANGUAGE_ID = ? AND E.LANGUAGE_ID = ? AND APLUSR.LANGUAGE_ID = B.LANGUAGE_ID AND A.RETURN_REASON_CODE IS NOT NULL AND G.DISP_NO = X.DISP_NO AND G.DRUG_CODE = A.DISP_DRUG_CODE");//Added for ML-BRU-SCF-1394[IN0501010] &&  A.DISP_QTY is replaced by G.RTN_QTY , TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY HH24:MI') is replaced by TO_CHAR(G.ADDED_DATE,'DD/MM/YYYY HH24:MI') and code AND 'G.DISP_NO = X.DISP_NO AND G.DRUG_CODE = A.DISP_DRUG_CODE'added  for ML-BRU-SCF-1394[IN0501010] //A.DISP_UOM_CODE CHANGE TO G.RTN_QTY_UOM Changed for ML-BRU-SCF-1880
		dataMap.put("SQL_PH_REISSUEMEDICATION_SELECT","SELECT X.DISP_LOCN_CODE,B.SHORT_DESC DISP_DESC, A.DISP_QTY REISSUED_QTY ,E.SHORT_DESC REISSUE_QTY_UOM, TO_CHAR(A.ADDED_DATE,'DD/MM/YYYY HH24:MI') REISSUE_DATE_TIME, D.DRUG_DESC REISSUED_DRUG_DESC, APLUSR.APPL_USER_NAME REISSUED_BY,A.ALT_DRUG_REMARKS, 'R' STATUS  FROM PH_DISP_HDR X, PH_DISP_DTL A, PH_DISP_LOCN_LANG_VW B,(SELECT DRUG_CODE DRUG_CODE,DRUG_DESC DRUG_DESC FROM PH_DRUG_LANG_VW  WHERE LANGUAGE_ID=? UNION SELECT TPN_REGIMEN_CODE  DRUG_CODE, LONG_NAME DRUG_DESC FROM  PH_TPN_REGIMEN_LANG_VW WHERE LANGUAGE_ID=?) D, AM_UOM_LANG_VW E, SM_APPL_USER_LANG_VW APLUSR WHERE X.ORDER_ID=? AND X.FACILITY_ID = A.FACILITY_ID AND X.DISP_NO = A.DISP_NO AND A.ORDER_LINE_NO= NVL(?,A.ORDER_LINE_NO) AND D.DRUG_CODE = A.DISP_DRUG_CODE AND E.UOM_CODE = A.DISP_UOM_CODE AND B.FACILITY_ID = X.FACILITY_ID AND B.DISP_LOCN_CODE = X.DISP_LOCN_CODE AND APLUSR.APPL_USER_ID = X.DISPENSED_BY AND B.LANGUAGE_ID = ? AND E.LANGUAGE_ID = ? AND APLUSR.LANGUAGE_ID = B.LANGUAGE_ID AND A.REISSUE_REASON_CODE IS NOT NULL ");//Added for ML-BRU-SCF-1394[IN0501010]	
		dataMap.put("SQL_PH_SPECIALITY_SELECT","SELECT SPECIALITY_CODE CODE, SHORT_DESC DESCRIPTION FROM AM_SPECIALITY_LANG_VW WHERE EFF_STATUS = 'E' AND LANGUAGE_ID= ?");//Added for MMS-QH-CRF-0108
		dataMap.put("SQL_PH_DISP_STAT_AGE_CUSTOMER_GROUP_SELECT","SELECT CUST_GROUP_CODE CODE,SHORT_DESC DESCRIPTION FROM AR_CUST_GROUP_LANG_VW WHERE upper(CUST_GROUP_CODE) like upper(?) and upper(SHORT_DESC) like upper(?) AND LANGUAGE_ID=");
		dataMap.put("SQL_PH_DISP_STAT_AGE_CUSTOMER_SELECT","SELECT CUST_CODE CODE,SHORT_NAME DESCRIPTION FROM AR_CUSTOMER_LANG_VW WHERE upper(CUST_CODE) like upper(?) and upper(SHORT_NAME) like upper(?) AND LANGUAGE_ID=");//Added for MMS-QH-CRF-0108
		dataMap.put("SQL_PH_DTL_DISP_QTY_SELECT","SELECT sum(DISP_QTY) DISP_QTY FROM PH_DISP_DTL WHERE ORDER_ID= ? ");//Added for HSA-CRF-0155 [IN048487]
		dataMap.put("SQL_REF_FACILITY_SELECT","SELECT REFERRAL_CODE,SHORT_DESC FROM AM_REFERRAL_LANG_VW WHERE EFF_STATUS = 'E' AND LANGUAGE_ID = ? ORDER BY SHORT_DESC ");//Added for HSA-CRF-0155 [IN048487]
		dataMap.put("SQL_RESULT_MULTI_FACILITY_SELECT","SELECT DISTINCT a.order_id, TO_CHAR (a.ord_date_time, 'DD/MM/YYYY HH24:MI') order_date,b.short_desc order_status_desc,(select c.short_desc from ph_disp_locn_lang_vw c where decode( a.performing_facility_id, null, null, a.performing_deptloc_code)  = C.DISP_LOCN_CODE (+) /*AND A.PATIENT_CLASS=D.PATIENT_CLASS */ AND C.LANGUAGE_ID(+) = ?)curr_disp_locn_desc,a.trn_group_ref,a.order_status,(SELECT DECODE (NVL (COUNT (*), 0),0, 'N','Y') FROM or_order_line_ph d WHERE d.order_id = a.order_id AND d.next_collection_date IS NOT NULL) bms_order_yn,d.facility_id, a.performing_facility_id, decode( a.performing_facility_id, null, null, a.performing_deptloc_code) performing_deptloc_code ,a.discharge_ind, a.patient_class, (SELECT short_desc FROM am_referral_lang_vw WHERE referral_code = a.REF_FACILITY_ID AND language_id = ?) REF_FACILITY FROM or_order a,or_order_status_code_lang_vw b,ph_patient_drug_profile d WHERE a.patient_id = ?  AND a.patient_id = d.patient_id AND a.order_id = d.orig_order_id AND TRUNC (NVL (d.end_date, SYSDATE)) >= TRUNC (SYSDATE) AND a.order_category = 'PH' AND a.order_id = NVL (?, a.order_id) AND a.order_status IN ('OS', 'DP', 'RG', 'VF', 'UC', 'DF', 'DC', 'CN') AND a.order_status = b.order_status_code AND b.language_id =? /*AND A.PATIENT_CLASS=D.PATIENT_CLASS */ AND ph_reroute_order_allow_yn(a.order_id) ='Y' ORDER BY A.ORDER_ID ");//Added for HSA-CRF-0155 [IN048487] and AND A.PATIENT_CLASS=D.PATIENT_CLASS commented for ML-BRU-SCF-1980 and SCF-1980.1
		dataMap.put("SQL_PH_MEDICATION_PLAN_INSERT_CHECK","SELECT COUNT(ROWID) FROM PH_MEDICATION_PLAN WHERE MED_PLAN_ID = ? AND LANGUAGE_ID = ? AND ORDER_ID =? AND ORDER_LINE_NUM=? AND DISP_DRUG_CODE=?");//Added for Bru-HIMS-CRF-072.1[IN 049144] 
		dataMap.put("SQL_PH_MEDICATION_PLAN_INSERT","INSERT INTO PH_MEDICATION_PLAN (MED_PLAN_ID,LANGUAGE_ID,FACILITY_ID,DISP_LOCN_CODE,PATIENT_ID,ENCOUNTER_ID,STAGE_IND,ORDER_ID,ORDER_LINE_NUM,PRES_DRUG_CODE,DISP_NO,DISP_SRL_NO,DISP_DRUG_CODE,ISSUE_QTY_DTL,HOW_TO_TAKE,IMPORTANT_NOTE,DOSE_MORNING,DOSE_AFTERNOON,DOSE_EVENING,DOSE_NIGHT,CURR_DISPENSE_YN,MERGED_YN,MERGED_MED_PLAN_ID,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MED_PLAN_ID_SEQ","SELECT PH_MED_PLAN_ID.NEXTVAL FROM DUAL");//Added for Bru-HIMS-CRF-072.1[IN 049144]  
		dataMap.put("SQL_SELECT_ACTIVEORDER_COUNT","SELECT  count(a.drug_code)  count  FROM   PH_PATIENT_DRUG_PROFILE A ,  AM_PRACTITIONER_LANG_VW B  ,  SM_FACILITY_PARAM_LANG_VW D,  OP_CLINIC_LANG_VW E,  IP_NURSING_UNIT_LANG_VW F,  (SELECT drug_desc drug_desc, drug_code drug_code, in_formulary_yn in_formulary_yn, strength_uom strength_uom, form_code form_code   FROM ph_drug_lang_vw   WHERE language_id = ?   UNION  SELECT NVL (short_name, long_name) drug_desc,   tpn_regimen_code drug_code, 'Y' in_formulary_yn,    NULL strength_uom, NULL form_code   FROM ph_tpn_regimen_lang_vw    WHERE  language_id = ?) c,   AM_FREQUENCY_LANG_VW G, OR_ORDER H,  PH_DISP_LOCN_LANG_VW I,SM_FACILITY_PARAM_LANG_VW J, or_order_line_ph k WHERE   A.PATIENT_ID =? AND   A.PRES_PRACTITIONER_ID = B.PRACTITIONER_ID(+) AND   A.FACILITY_ID = D.FACILITY_ID  AND   A.FACILITY_ID = E.FACILITY_ID (+) AND  A.LOCN_CODE = E.CLINIC_CODE(+) AND   A.FACILITY_ID = F.FACILITY_ID (+) AND   A.LOCN_CODE = F.NURSING_UNIT_CODE(+) AND   A.DRUG_CODE = C.DRUG_CODE  AND   A.FREQ_CODE=G.FREQ_CODE AND    A.ORIG_ORDER_ID= H.ORDER_ID and a.orig_order_id =k.order_id and a.ORIG_ORDER_LINE_NO =k.ORDER_LINE_NUM AND I.DISP_LOCN_CODE = H.PERFORMING_DEPTLOC_CODE AND H.PERFORMING_FACILITY_ID =I.FACILITY_ID AND H.PERFORMING_FACILITY_ID =J.FACILITY_ID AND A.PATIENT_ID=H.PATIENT_ID AND to_date(A.END_DATE,'dd/mm/yyyy hh24:mi') >= to_date(SYSDATE,'dd/mm/yyyy hh24:mi') AND  TO_DATE(SYSDATE,'DD/MM/RRRR HH24:MI') BETWEEN  TO_DATE(A.START_DATE,'DD/MM/RRRR HH24:MI') AND  TO_DATE(A.END_DATE,'DD/MM/RRRR HH24:MI')   AND A.DISCONT_DATE_TIME IS NULL AND   A.ON_HOLD_DATE_TIME IS NULL AND   A.CANCEL_YN='N' AND   A.STOP_YN='N' AND H.ORDER_TYPE_CODE !='MS'  AND D.LANGUAGE_ID = G.LANGUAGE_ID AND D.LANGUAGE_ID = I.LANGUAGE_ID AND D.LANGUAGE_ID = ? AND E.LANGUAGE_ID(+) = ? AND F.LANGUAGE_ID(+) = ? AND B.LANGUAGE_ID(+) = ? AND J.LANGUAGE_ID(+) = ?  AND H.IV_PREP_YN IS NULL  ORDER BY A.END_DATE DESC,A.ORIG_ORDER_ID,A.ORIG_ORDER_LINE_NO ");//Added for Bru-HIMS-CRF-072.1[IN 049144]  
		dataMap.put("SQL_SELECT_PH_MED_PLAN_COUNT","SELECT COUNT(MED_PLAN_ID) COUNT ,MAX(MED_PLAN_ID) MAXID from PH_MEDICATION_PLAN where STAGE_IND ='D' and EFF_STATUS='E' and FACILITY_ID=? and PATIENT_ID=? and LANGUAGE_ID=? and trunc(MODIFIED_DATE) = trunc(SYSDATE) ");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_SELECT_PH_MED_PLAN_COUNT_REPORT","SELECT COUNT(MED_PLAN_ID) COUNT,MAX(MED_PLAN_ID) MAXID FROM PH_MEDICATION_PLAN WHERE STAGE_IND ='D' AND EFF_STATUS='E' AND FACILITY_ID=? AND PATIENT_ID=? AND MODIFIED_DATE BETWEEN TO_DATE(?,'DD/MM/RRRR') AND TO_DATE(?,'DD/MM/RRRR') + 0.99999 AND DISP_LOCN_CODE=? AND MED_PLAN_ID!=? AND LANGUAGE_ID=?");
		dataMap.put("SQL_SELECT_PH_MED_PLAN_MERGE","SELECT MED_PLAN_ID,LANGUAGE_ID,FACILITY_ID,DISP_LOCN_CODE,PATIENT_ID,ENCOUNTER_ID,STAGE_IND,ORDER_ID,ORDER_LINE_NUM,PRES_DRUG_CODE,DISP_NO,DISP_SRL_NO,DISP_DRUG_CODE,ISSUE_QTY_DTL,HOW_TO_TAKE,IMPORTANT_NOTE,DOSE_MORNING,DOSE_AFTERNOON,DOSE_EVENING,DOSE_NIGHT,CURR_DISPENSE_YN,MERGED_YN,MERGED_MED_PLAN_ID from PH_MEDICATION_PLAN where STAGE_IND ='D' and EFF_STATUS='E' and FACILITY_ID=? and PATIENT_ID=? and trunc(MODIFIED_DATE) = trunc(SYSDATE) and MED_PLAN_ID=? AND LANGUAGE_ID=?");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_SELECT_PH_MED_PLAN_MERGE_REPORT","SELECT MED_PLAN_ID,LANGUAGE_ID,FACILITY_ID,DISP_LOCN_CODE,PATIENT_ID,ENCOUNTER_ID,STAGE_IND,ORDER_ID,ORDER_LINE_NUM,PRES_DRUG_CODE,DISP_NO,DISP_SRL_NO,DISP_DRUG_CODE,ISSUE_QTY_DTL,HOW_TO_TAKE,IMPORTANT_NOTE,DOSE_MORNING,DOSE_AFTERNOON,DOSE_EVENING,DOSE_NIGHT,CURR_DISPENSE_YN,MERGED_YN,MERGED_MED_PLAN_ID from PH_MEDICATION_PLAN WHERE STAGE_IND ='D' AND EFF_STATUS='E' AND FACILITY_ID=? AND PATIENT_ID=? AND MODIFIED_DATE BETWEEN TO_DATE(?,'DD/MM/RRRR') AND TO_DATE(?,'DD/MM/RRRR') + 0.99999 AND DISP_LOCN_CODE=? AND MED_PLAN_ID!=? AND LANGUAGE_ID=?");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MEDICATION_PLAN_UPDATE","UPDATE PH_MEDICATION_PLAN SET STAGE_IND=NVL(?,STAGE_IND),ISSUE_QTY_DTL=?,HOW_TO_TAKE=?,IMPORTANT_NOTE=?,DOSE_MORNING=?,DOSE_AFTERNOON=?,DOSE_EVENING=?,DOSE_NIGHT=?,EFF_STATUS=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE PATIENT_ID=? AND MED_PLAN_ID=? AND ORDER_ID=? AND ORDER_LINE_NUM=? AND LANGUAGE_ID=? AND DISP_DRUG_CODE=? ");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_SELECT_DISP_NO","SELECT DISP_TMP_NO DISP_NO,DTL_SERIAL_NUM DISP_SRL_NO FROM PH_DISP_DTL_TMP WHERE ORDER_ID=? AND ORDER_LINE_NO=? UNION SELECT TO_NUMBER(DISP_NO) DISP_NO,SRL_NO DISP_SRL_NO FROM PH_DISP_DTL WHERE ORDER_ID=? AND ORDER_LINE_NO=?");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MEDICATION_PLAN_UPDATE1","UPDATE PH_MEDICATION_PLAN SET EFF_STATUS=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE PATIENT_ID=? AND MED_PLAN_ID=? AND ORDER_ID=? AND ORDER_LINE_NUM=? AND LANGUAGE_ID=? AND DISP_DRUG_CODE=?");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_DISP_LABEL_INSERT","insert into ph_disp_label (FACILITY_ID ,DISP_NO ,SRL_NO ,LANGUAGE_ID ,PRES_DRUG_CODE ,DISP_DRUG_CODE ,DISP_QTY ,DISP_UOM_CODE ,DOSAGE_DTL ,NO_OF_COPIES ,INSTRUCTION ,ADDED_BY_ID ,ADDED_DATE ,ADDED_AT_WS_NO ,ADDED_FACILITY_ID ,MODIFIED_BY_ID ,MODIFIED_DATE ,MODIFIED_AT_WS_NO ,MODIFIED_FACILITY_ID)values (?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?)");
		dataMap.put("SQL_PH_DISP_LABEL_UPDATE","UPDATE ph_disp_label SET DISP_DRUG_CODE=?, DISP_QTY=?, DOSAGE_DTL=? ,NO_OF_COPIES=? ,INSTRUCTION=?, MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_NO=? AND SRL_NO=? AND LANGUAGE_ID=? ");
		dataMap.put("SQL_PH_DISP_EDIT_LABEL_UPDATE","UPDATE ph_disp_label SET DISP_QTY=?, DISP_UOM_CODE=?, DOSAGE_DTL=? ,NO_OF_COPIES=? ,INSTRUCTION=?, MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE FACILITY_ID=? AND DISP_NO=? AND SRL_NO=? AND LANGUAGE_ID=? ");
		dataMap.put("SQL_PH_DISP_LABEL_SELECT_DISP_DTL_TMP","select DISP_TMP_NO DISP_NO, DTL_SERIAL_NUM SRL_NO from ph_disp_dtl_tmp WHERE facility_id = ? AND order_id = ? AND ORDER_LINE_NO =? AND DISP_DRUG_CODE =? ");
		dataMap.put("SQL_PH_DISP_LABEL_SELECT_DISP_DTL_TMP1","select DISP_TMP_NO DISP_NO, DTL_SERIAL_NUM SRL_NO from ph_disp_dtl_tmp WHERE facility_id = ? AND order_id = ? AND ORDER_LINE_NO =? ");
		dataMap.put("SQL_PH_DISP_LABEL_SELECT_COUNT","select count(*) LBLCOUNT from ph_disp_label WHERE FACILITY_ID=? AND DISP_NO=? AND SRL_NO=? AND LANGUAGE_ID=? ");
		dataMap.put("SQL_PH_DISP_LABEL_SELECT_DISP_DTL","select DISP_NO, SRL_NO from ph_disp_dtl WHERE facility_id = ? AND order_id = ? AND ORDER_LINE_NO =? AND DISP_DRUG_CODE =? order by disp_no desc"); //order by disp_no desc added for ML-BRU-SCF-1958
		dataMap.put("SQL_PH_DISP_LABEL_DTL_TMP_SELECT","SELECT lbl.PRES_DRUG_CODE, lbl.DISP_DRUG_CODE, lbl.disp_qty, lbl.DISP_UOM_CODE, lbl.dosage_dtl, lbl.no_of_copies, lbl.instruction, (select drug_yn from ph_drug where drug_code = DISP.DISP_DRUG_CODE) drug_yn FROM ph_disp_label lbl, ph_disp_dtl_tmp disp WHERE lbl.facility_id = DISP.FACILITY_ID AND lbl.disp_no = DISP.DISP_TMP_NO AND lbl.srl_no = disp.DTL_SERIAL_NUM AND DISP.ORDER_ID=? and DISP.ORDER_LINE_NO=? and disp.DISP_DRUG_CODE=? and lbl.language_id = ? and DISP.DISP_TMP_NO in (?) ");
		dataMap.put("SQL_PH_DISP_LABEL_DTL_TMP_PREV_INSERT","insert into ph_disp_label (FACILITY_ID ,DISP_NO ,SRL_NO ,LANGUAGE_ID ,PRES_DRUG_CODE ,DISP_DRUG_CODE ,DISP_QTY ,DISP_UOM_CODE ,DOSAGE_DTL ,NO_OF_COPIES ,INSTRUCTION ,ADDED_BY_ID ,ADDED_DATE ,ADDED_AT_WS_NO ,ADDED_FACILITY_ID ,MODIFIED_BY_ID ,MODIFIED_DATE ,MODIFIED_AT_WS_NO ,MODIFIED_FACILITY_ID) SELECT ?, ?, ?, language_id, pres_drug_code, DISP_DRUG_CODE, disp_qty, disp_uom_code, dosage_dtl, no_of_copies, instruction, ?, sysdate, ?, ?, ?, sysdate, ?, ? FROM ph_disp_label WHERE facility_id = ? AND disp_no = ? AND srl_no = ? and DISP_DRUG_CODE=? and language_id<>?");
		dataMap.put("SQL_PH_DISP_LABEL_DTL_SELECT","SELECT lbl.PRES_DRUG_CODE, lbl.DISP_DRUG_CODE, lbl.disp_qty, lbl.DISP_UOM_CODE, lbl.dosage_dtl, lbl.no_of_copies, lbl.instruction, (select drug_yn from ph_drug where drug_code = DISP.DISP_DRUG_CODE) drug_yn FROM ph_disp_label lbl, ph_disp_dtl disp WHERE lbl.facility_id = DISP.FACILITY_ID AND lbl.disp_no = DISP.DISP_NO AND lbl.srl_no = disp.SRL_NO AND DISP.ORDER_ID=? and DISP.ORDER_LINE_NO=? and disp.DISP_DRUG_CODE=? and lbl.language_id = ? and DISP.DISP_NO in (?)");
		dataMap.put("SQL_PH_DISP_LABEL_DELETE","delete from ph_disp_label WHERE FACILITY_ID=? AND DISP_NO=? AND SRL_NO=? ");
		dataMap.put("SQL_PH_EDIT_LABEL_DTL_TMP_SELECT","SELECT a.disp_no, a.srl_no, a.order_id, a.order_line_no, decode( b.DISP_QTY, null, a.disp_qty, b.disp_qty) disp_qty, b.DISP_UOM_CODE, b.PRES_DRUG_CODE, d.item_code drug_code, (select DRUG_DESC from ph_drug_lang_vw where drug_code=d.drug_code and language_id = ?)drug_desc, d.PRINT_LABEL_BASED_ON_QTY_YN, DOSAGE_DTL, NO_OF_COPIES, INSTRUCTION FROM ph_disp_dtl a, ph_disp_label b, PH_DRUG d WHERE a.disp_no = b.disp_no AND a.srl_no = B.SRL_NO AND a.disp_no = ? and a.facility_id=? AND a.disp_drug_code = d.item_code AND b.language_id = ?  ORDER BY srl_no");
		dataMap.put("SQL_PH_EDIT_LABEL_DTL_SELECT","select a.DISP_NO, a.SRL_NO, a.ORDER_ID, a.ORDER_LINE_NO,a.disp_qty,a.DISP_UOM_CODE, A.PRES_DRUG_CODE, d.item_code drug_code, (select DRUG_DESC from ph_drug_lang_vw where drug_code=d.drug_code and language_id = ?) drug_desc , d.PRINT_LABEL_BASED_ON_QTY_YN, ph_dosage_details(?,?,A.PRES_DRUG_CODE, a.disp_drug_code, a.ORDER_ID, a.ORDER_LINE_NO) dosage_dtl, LABEL_PAT_INSTRN1_ENG , LABEL_PAT_INSTRN1_LOC ,(SELECT  LABEL_TEXT_1  FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE  LABEL_TEXT_ID = A.LABEL_CAU_INSTRN1_ENG  AND LABEL_TEXT_TYPE ='C' AND LANGUAGE_ID =?) LABEL_CAU_INSTRN, (SELECT  LABEL_TEXT_1  FROM PH_LABEL_TEXT_LANG_VW PH_LABEL_TEXT WHERE  LABEL_TEXT_ID= A.LABEL_SPL_INSTRN1_ENG AND  LABEL_TEXT_TYPE ='S' AND LANGUAGE_ID = ?) LABEL_SPL_INSTRN from ph_disp_dtl a, ph_drug d where a.disp_no =? and a.facility_id =? and a.disp_drug_code = d.item_code order by srl_no");
		dataMap.put("SQL_PH_EDIT_LABEL_EDITABLE_SELECT","SELECT CRIT_FIELD_ID, CRIT_FIELD_VAL  FROM PH_DISP_MEDN_DFLT WHERE FACILITY_ID = DECODE (?, FACILITY_ID, FACILITY_ID, '*A')   AND CRIT_FIELD_ID = 'ALLOW_EDIT_DISP_LABEL'");
		dataMap.put("SQL_PH_MED_PLAN_DELETE","DELETE FROM PH_MEDICATION_PLAN WHERE FACILITY_ID=? AND DISP_NO=? AND DISP_SRL_NO=? ");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MED_PLAN_DELETE_ALL","DELETE FROM PH_MEDICATION_PLAN WHERE MED_PLAN_ID=?");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MED_PLAN_SELECT_ID","SELECT MED_PLAN_ID FROM PH_MEDICATION_PLAN WHERE FACILITY_ID=? AND DISP_NO=? AND DISP_SRL_NO=? ");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MED_PLAN_SELECT_CURR_DRUG","SELECT COUNT(MED_PLAN_ID) COUNT FROM PH_MEDICATION_PLAN WHERE MED_PLAN_ID=? AND DISP_NO=? AND DISP_SRL_NO!=? AND CURR_DISPENSE_YN='Y'");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MEDICATION_PLAN_UPDATE2","UPDATE PH_MEDICATION_PLAN SET STAGE_IND=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE MED_PLAN_ID=? AND DISP_NO=? AND DISP_SRL_NO=? AND DISP_DRUG_CODE=?");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_MEDICATION_PLAN_UPDATE3","UPDATE PH_MEDICATION_PLAN SET STAGE_IND=?,MODIFIED_BY_ID=?,MODIFIED_DATE=SYSDATE,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? WHERE MED_PLAN_ID=?");//Added for Bru-HIMS-CRF-072.1[IN 049144]
		dataMap.put("SQL_PH_DISC_CANCELLED_DRUG_DTL_SELECT","SELECT A.ORDER_ID, A.ORDER_LINE_NUM, D.DRUG_DESC, TO_CHAR(A.START_DATE_TIME, 'DD/MM/YYYY HH24:MI') START_DATE_TIME, TO_CHAR(A.END_DATE_TIME, 'DD/MM/YYYY HH24:MI') END_DATE_TIME, (SELECT PRACTITIONER_NAME FROM AM_PRACTITIONER_LANG_VW WHERE LANGUAGE_ID = ? AND PRACTITIONER_ID = A.ORD_PRACT_ID) ORD_PRACT_NAME, ORD_PRACT_ID, (SELECT PRACTITIONER_NAME FROM AM_PRACTITIONER_LANG_VW WHERE LANGUAGE_ID = ? AND PRACTITIONER_ID = DECODE (A.CAN_PRACT_ID, NULL, A.DISC_PRACT_ID, A.CAN_PRACT_ID)) DISC_CAN_PRACT_NAME, DECODE (A.CAN_PRACT_ID, NULL, A.DISC_PRACT_ID, A.CAN_PRACT_ID) DISC_CAN_PRACT_ID, A.CAN_LINE_REASON FROM OR_ORDER_LINE A, PH_DRUG_LANG_VW D WHERE A.ORDER_CATALOG_CODE = D.DRUG_CODE AND D.LANGUAGE_ID = ? ");//Added for HSA-CRF-0138 [IN:048414]
		dataMap.put("SQL_PH_RETMEDICATION_ALL_ENCOUNTER_SELECT","SELECT encounter_id FROM pr_encounter WHERE patient_id = ? AND facility_id = ? UNION SELECT DISTINCT (encounter_id) FROM or_order WHERE patient_id = ? AND ordering_facility_id = ? ORDER BY encounter_id DESC");//Added for MMS-DM-CRF-0012
		dataMap.put("SQL_PH_ST_STORE_LOOKUP_LANG",	"SELECT st.store_code code, mm.short_desc description FROM mm_store_lang_vw mm, st_store st,st_user_access_for_store uas WHERE mm.facility_id LIKE (?) AND mm.eff_status = 'E' AND UPPER (st.store_code) LIKE UPPER (?)   AND UPPER (mm.short_desc) LIKE UPPER (?)  AND mm.store_code = st.store_code  and st.store_code = uas.store_code  AND uas.var_allowed_yn = 'Y'  ");
		dataMap.put("SQL_PH_ST_ITEM_LOOKUP","SELECT ST.ITEM_CODE CODE, MM.SHORT_DESC DESCRIPTION FROM MM_ITEM_LANG_VW  MM, ST_ITEM ST WHERE ST.ITEM_CODE = MM.ITEM_CODE AND MM.EFF_STATUS = 'E' AND MM.LANGUAGE_ID LIKE  ? AND ST .ITEM_CODE LIKE UPPER(?) AND UPPER(MM.SHORT_DESC) LIKE UPPER(?) ORDER BY 2");
		dataMap.put("SQL_PH_DRUG_PRICE_DETAILS_SELECT","SELECT st.store_code, (SELECT short_desc FROM mm_store_lang_vw mm WHERE mm.store_code = st.store_code AND mm.language_id = ?) store_desc, st.item_code, mmitm.short_desc item_desc, st.batch_id, TO_CHAR (st.expiry_date_or_receipt_date, 'DD/MM/YYYY') expiry_date, st.qty_on_hand stock_on_hand, committed_qty allocated_quantity, (SELECT sale_price FROM st_batch_control bat WHERE bat.item_code = st.item_code AND bat.batch_id = st.batch_id AND bat.expiry_date_or_receipt_date = st.expiry_date_or_receipt_date) sale_price, d.short_desc base_uom_desc, (SELECT short_desc FROM am_uom_lang_vw amuom WHERE amuom.uom_code = c.def_issue_uom AND amuom.language_id = ?) issue_uom_desc, st_get_uom_conv_fac_sing_str (st.item_code, st.store_code) cov_factor FROM st_item_batch st, st_item_store c, am_uom_lang_vw d, st_item itm, mm_item_lang_vw mmitm WHERE st.store_code BETWEEN NVL (UPPER (?), '!') AND NVL (UPPER (?), '~') AND st.item_code BETWEEN NVL (UPPER (?), '!') AND NVL (UPPER (?), '~') AND c.item_code = st.item_code AND c.store_code = st.store_code AND d.uom_code = mmitm.gen_uom_code AND st.item_code = itm.item_code AND st.item_code = mmitm.item_code AND mmitm.LANGUAGE_ID=? AND d.language_id = ? AND ( (use_after_expiry_yn = 'Y') OR ( use_after_expiry_yn <> 'Y' AND expiry_date_or_receipt_date > TRUNC (SYSDATE) ) ) ORDER BY store_desc, item_desc, to_date(expiry_date, 'dd/mm/yyyy')");
		dataMap.put("SQL_PH_MEDN_RETUN_REASON_SELECT", "SELECT reason_code CODE , reason_desc DESCRIPTION FROM ph_medn_trn_reason_lang_vw ph_medn_trn_reason  WHERE upper(appl_trn_type) like upper(?) and upper(language_id) like upper(?) AND UPPER(reason_code) LIKE UPPER(?) AND UPPER(reason_desc) LIKE UPPER(?)  AND eff_status='E' ");
		dataMap.put("SQL_PH_PREV_HT_WT_RECORDS", "SELECT DISTINCT b.field_or_template_mnemonic mnemonic, d.discr_msr_result_num, d.discr_msr_result_num_uom, d.encounter_id, d.patient_id, d.patient_class, TO_CHAR (d.test_observ_dt_tm,'dd/mm/yyyy hh24:mi') test_observ_dt_tm FROM or_order_format_hdr a, or_order_format_dtl b, or_order_field c, ca_encntr_discr_msr d WHERE a.order_category = 'PH' AND a.order_category = c.order_category AND b.field_or_template_mnemonic IN ('HEIGHT', 'WEIGHT') AND a.format_id = b.format_id AND b.field_or_template_mnemonic = c.field_mnemonic AND d.facility_id = ? AND d.discr_msr_id = c.discr_msr_id AND d.patient_id = ? AND d.patient_class = ? AND d.discr_msr_result_num_uom IS NOT NULL AND NVL (d.error_yn, 'N') != 'Y' AND (d.test_observ_dt_tm) BETWEEN SYSDATE - 730 AND SYSDATE + .99999 ORDER BY TO_date (test_observ_dt_tm,'dd/mm/yyyy hh24:mi')DESC, mnemonic ");
		dataMap.put("SQL_PH_GENERIC_NAME_LOOKUP_TDM", "select A.GENERIC_ID code,A.GENERIC_NAME description FROM PH_GENERIC_NAME_LANG_VW A WHERE A.EFF_STATUS like 'E'  AND A.LANGUAGE_ID like ? AND upper(A.GENERIC_ID) like upper(?) AND upper(A.GENERIC_NAME) like upper(?)");//Added for HSA-CRF-0239 [IN:051707] by B.Badmavathi on 30/01/2016 
		dataMap.put("SQL_PH_GENERIC_NAME_FOR_ID", "SELECT GENERIC_NAME  FROM PH_GENERIC_NAME_lang_vw  WHERE  generic_id=?  AND LANGUAGE_ID = ?");//Added for HSA-CRF-0239 [IN:051707] by B.Badmavathi on 30/01/2016 
		dataMap.put("SQL_GENERIC_ID_FAC_PARAM", "select DEF_GENERIC_ID from ph_facility_param where facility_id =?");//Added for HSA-CRF-0239 [IN:051707] by B.Badmavathi on 30/01/2016 
		//ward ack rights quiers GHL-CRF-0399.2 starts
		dataMap.put("WARD_ACK_RIGHTS_INSERT", "INSERT INTO ph_ward_ack_rights(nursing_unit_code, user_id, genral_drug_yn, narcotic_drug_yn,controlled_drug_yn,added_by_id, modified_by_id,added_facility_id,modified_facility_id,added_date,modified_date,added_at_ws_no,modified_at_ws_no)VALUES (?, ?, ?, ?,?, ?, ?, ?,?, sysdate,sysdate,?,?)");
		dataMap.put("WARD_ACK_COUNT_SELECT", "select count(ROWID) from ph_ward_ack_rights where nursing_unit_code=? and user_id =? and added_facility_id=?");
		//dataMap.put("WARD_ACK_RIGHTS_DELETE", "DELETE FROM ph_ward_ack_rights WHERE ADDED_FACILITY_ID=? AND USER_ID=? AND NURSING_UNIT_CODE=?");//ADDED FOR GHL-CRF-0466
		dataMap.put("WARD_ACK_RIGHTS_DELETE", "DELETE FROM ph_ward_ack_rights WHERE ADDED_FACILITY_ID=? AND USER_ID=? ");
		dataMap.put("WARD_ACK_RIGHTS_SELECT", "SELECT genral_drug_yn, narcotic_drug_yn,controlled_drug_yn FROM  ph_ward_ack_rights WHERE   ADDED_FACILITY_ID=? AND USER_ID=? AND NURSING_UNIT_CODE= ?");
		dataMap.put("WARD_ACK_RIGHTS_UPDATE", "update  ph_ward_ack_rights set genral_drug_yn =?,narcotic_drug_yn =?,controlled_drug_yn =?  WHERE ADDED_FACILITY_ID=? AND USER_ID=? AND NURSING_UNIT_CODE= ?");
		//ward ack rights quiers GHL-CRF-0399.2 ends
		//SELECT_AUTH_AMEND_PRES added for ml-mmoh-crf-0863
		dataMap.put("SELECT_AUTH_AMEND_PRES", "SELECT AUTH_AMEND_PRES_YN FROM ph_disp_rights a, ph_disp_locn_lang_vw b WHERE a.facility_id = b.facility_id AND a.disp_locn_code = b.disp_locn_code AND a.facility_id = UPPER (?) AND UPPER (a.disp_locn_code) = UPPER (?) AND UPPER (a.appl_user_id) = UPPER (?) AND b.language_id = ?");//added for ml-mmoh-crf-0863
	
//ADDED FOR GHL-CRF-0466 START
		dataMap.put("PH_WARD_ACK_RIGHTS_ALL", "select * from ph_ward_ack_rights where nursing_unit_code='*A' and user_id= ? AND ADDED_FACILITY_ID= ?");
		dataMap.put("PH_WARD_ACK_RIGHTS_NURSING_UNIT", "select NURSING_UNIT_CODE,SHORT_DESC from ip_nursing_unit where EFF_STATUS='E' and FACILITY_ID=? order by NURSING_UNIT_CODE");
		dataMap.put("PH_WARD_ACK_RIGHTS_SELECT_NUNIT", "SELECT nursing_unit_code, short_desc, NULL genral_drug_yn,NULL narcotic_drug_yn, NULL controlled_drug_yn FROM ip_nursing_unit_lang_vw WHERE eff_status = 'E' AND language_id = ? AND facility_id = ? AND nursing_unit_code NOT IN (SELECT nursing_unit_code FROM ph_ward_ack_rights WHERE ADDED_FACILITY_ID = ? AND user_id = ?)UNION SELECT nursing_unit_code,ip_get_desc.ip_nursing_unit (?,nursing_unit_code,?,'2') short_desc,genral_drug_yn, narcotic_drug_yn, controlled_drug_yn FROM ph_ward_ack_rights WHERE ADDED_FACILITY_ID = ? AND user_id = ? order by NURSING_UNIT_CODE");
		
		dataMap.put("SQL_PH_PRESCRIPTION_SELECT101_default","SELECT b.discr_msr_id discr_msr_id,a.num_uom,b.SHORT_DESC FROM am_discr_msr_ref_rng_num a,am_discr_msr b,(SELECT TRUNC (SYSDATE - date_of_birth) no_of_day, sex FROM mp_patient WHERE patient_id = ?) c WHERE b.discr_msr_id IN (SELECT discr_msr_id FROM or_order_field WHERE field_mnemonic IN ('HEIGHT', 'WEIGHT') AND order_category = 'PH' AND eff_status = 'E') AND b.discr_msr_id = a.discr_msr_id(+)");//added for ml-mmoh-0862
		
//ADDED FOR GHL-CRF-0466  END
		dataMap.put("SQL_PH_ONCO_MFR_VIEW_SELECT", "select TOT_STRENGTH, TOT_STRENGTH_UOM, INFUSE_OVER, INFUSE_OVER_UNIT, INFUSION_RATE, INFUSION_VOL_STR_UNIT, INFUSION_PER_UNIT, ADMIN_RATE_DETAIL, TO_CHAR (SCH_START_DATE_TIME, 'DD/MM/YYYY HH24:MI') START_DATE_TIME, TO_CHAR (SCH_END_DATE_TIME, 'DD/MM/YYYY HH24:MI') END_DATE_TIME, GAP_DURATION_IN_HRS from OR_ORDER_LINE_PH_MFR where  ORDER_ID=? order by sl_no");//ML-MMOH-CRF-1014
		dataMap.put("SQL_PH_TPN_CONS_GROUP_INSERT","INSERT INTO PH_TPN_CONSTITUENT_GROUP( CONST_GROUP_CODE,CONST_GROUP_NAME,DISP_SRL_NO,EFF_STATUS,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) values(?,?,?,?,?,sysdate,?,?,?,sysdate,?,?)");//added for ML-MMOH-CRF-1126
           dataMap.put("SQL_PH_TPN_WORKSHEET_SELECT14", "SELECT ITEM_CONCENTRATION_PERCENT,VOLUME FROM PH_INV_ITEM_FOR_NS_REGIMEN WHERE CONST_GENERIC_CODE = ? AND ITEM_CODE = ?");//Added for ML-MMOH-CRF-1201
     
           dataMap.put("SQL_PH_DRUG_DISP_MULTI_STRENGTH_YN", "SELECT DISP_MULTI_STRENGTH_YN FROM PH_PARAM WHERE MODULE_ID='PH'");//ADDED FOR GHL-CRF-0548
           dataMap.put("SQL_PH_DRUG_DISP_MULTI_STRENGTH", "select DISP_MULTI_STRENGTH_YN,DISP_ALT_FORM_YN from PH_DRUG_VW where drug_code= ?");//ADDED FOR GHL-CRF-0548
           dataMap.put("SQL_PH_DRUG_DISP_MULTI_STRENGTH1", "select DISP_MULTI_STRENGTH_YN,DISP_ALT_FORM_YN from PH_DRUG_lang_vw where drug_code= ? and language_id= ?");//ADDED FOR GHL-CRF-0548
                      dataMap.put("SQL_PH_WRD_ACK_APPLICABLE_YN", "SELECT WARD_ACK_REQUIRED_YN FROM PH_FACILITY_PARAM WHERE FACILITY_ID=?");//Added for MMS-KH-CRF-0014
           dataMap.put("SQL_PH_EXTERNAL_DISPENSING", "select EXT_DISP_YN from ph_disp_locn where facility_id= ? and disp_locn_code= ?");//Added for NMC-JD-CRF-0008[IN069511]
           dataMap.put("SQL_PH_EXTERNAL_DISPENSING_QTY", "select EXTERNAL_ITEM_QTY from XI_ITEM_POS_QTY_DTLS where DISP_LOCN_CODE = ? and EXTERNAL_ITEM_CODE = ?");//Added for NMC-JD-CRF-0008
           dataMap.put("SQL_PH_ONCOLOGY_REGIMEN_AMEND_RPEAT_VALUE_SELECT", "SELECT qty_value,dosage_type,a.order_line_num,(SELECT repeat_value FROM am_frequency WHERE freq_code = a.freq_code) repeat_value FROM or_order_line a, or_order_line_ph b WHERE a.order_id = b.order_id AND a.order_line_num = b.order_line_num AND a.order_id = ? and ROWNUM<=1 order by ORDER_LINE_NUM desc"); //Added for IN:070451,
     //added for jd-crf-0200    Medication Administration Rights     
           dataMap.put("PH_MED_CANCEL_RIGHTS_INSERT","INSERT INTO MEDICATION_ADMIN_RIGHTS(user_id,facility_id,admin_yn,self_admin_yn,hold_yn,cnd_not_admin_yn,discontinue_yn,cancel_admin_yn,added_by_id, modified_by_id,added_facility_id, modified_facility_id, added_date,modified_date, added_at_ws_no, modified_at_ws_no )VALUES ( ?, ?, ?,?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,?)");
           dataMap.put("PH_MED_CANCEL_RIGHTS_UPDATE","update MEDICATION_ADMIN_RIGHTS SET admin_yn =? ,self_admin_yn =? ,hold_yn =?,cnd_not_admin_yn =?,discontinue_yn =?,cancel_admin_yn =?,modified_by_id = ?, modified_date = SYSDATE,modified_at_ws_no = ?, modified_facility_id = ? where user_id=? and FACILITY_ID =?");
           dataMap.put("PH_MED_CANCEL_RIGHTS_DELETE","DELETE FROM MEDICATION_ADMIN_RIGHTS WHERE FACILITY_ID=? AND USER_ID=?");
           dataMap.put("PH_MED_CANCEL_RIGHTS_SELECT","SELECT a.user_id,a.admin_yn,a.self_admin_yn,a.hold_yn,a.cnd_not_admin_yn,a.discontinue_yn,a.cancel_admin_yn FROM  MEDICATION_ADMIN_RIGHTS a WHERE  a.user_id = ? and a.facility_id =?");
           dataMap.put("PH_MED_CANCEL_RIGHTS_QUERY1","SELECT a.user_id, c.appl_user_name,admin_yn,self_admin_yn,hold_yn,cnd_not_admin_yn,discontinue_yn,cancel_admin_yn FROM MEDICATION_ADMIN_RIGHTS a, sm_appl_user_lang_vw c WHERE a.user_id = c.appl_user_id AND UPPER (a.user_id) LIKE UPPER (?) AND UPPER (c.appl_user_name) LIKE UPPER (?) AND c.language_id= ? AND A.FACILITY_ID = ? AND UPPER (A.CANCEL_ADMIN_YN) LIKE UPPER (?)");
           dataMap.put("PH_MED_CANCEL_RIGHTS_QUERY2","SELECT a.user_id, c.appl_user_name,admin_yn,self_admin_yn,hold_yn,cnd_not_admin_yn,discontinue_yn,cancel_admin_yn FROM MEDICATION_ADMIN_RIGHTS a, sm_appl_user_lang_vw c WHERE a.user_id = c.appl_user_id AND UPPER (a.user_id) LIKE UPPER (?) AND UPPER (c.appl_user_name) LIKE UPPER (?) AND c.language_id= ? AND A.FACILITY_ID = ?");
           dataMap.put("PH_OVERRIDE_REMARKS","select REASON_CODE,REMARKS from PH_MEDN_TRN_REASON where APPL_TRN_TYPE=? AND EFF_STATUS='E'");//Added for IN:072715 
           dataMap.put("SQL_PH_IVPRESCRIPTION_REASON_CODE_SELECT", "SELECT ALLERGY_OVERRIDE_REASON_CODE, DOSE_LIMIT_OVER_REASON_CODE, DUP_DRUG_OVERRIDE_REASON_CODE FROM OR_ORDER_LINE_PH WHERE ORDER_ID = ? AND ORDER_LINE_NUM = ?");//Added for IN:072715 
            dataMap.put("SQL_PH_DFLT_DISP_LOCN_CODE_SELECT", "SELECT DFLT_DISP_LOCN FROM ph_facility_param WHERE FACILITY_ID = ?");//Added for TFS id:-16341
        
		dataMap.put("SQL_PH_CYTOINCIREORT_CLINIC_SELECT", "SELECT CLINIC_CODE CODE, LONG_DESC description FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE EFF_STATUS='E' AND CLINIC_CODE LIKE UPPER(?) AND Upper(SHORT_DESC) like upper(?) AND FACILITY_ID ='~FACILITY_ID`' and language_id='~LOCALE_ID`'  order by 2 ");
		dataMap.put("SQL_PH_CYTOINCIREORT_NURSING_SELECT", "SELECT NURSING_UNIT_CODE  CODE, SHORT_DESC description FROM IP_NURSING_UNIT_LANG_VW  WHERE EFF_STATUS='E' and NURSING_UNIT_CODE LIKE UPPER(?) AND Upper(SHORT_DESC) like upper(?)and FACILITY_ID ='~FACILITY_ID`' and language_id='~LOCALE_ID`'  order by 2 ");
		dataMap.put("SQL_PH_CYTOINCIREORT_DISP_SELECT", "SELECT DISP_LOCN_CODE CODE, SHORT_DESC description FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE EFF_STATUS='E' AND DISP_LOCN_CODE LIKE UPPER(?) AND Upper(SHORT_DESC) like upper(?) and facility_id ='~FACILITY_ID`' and language_id='~LOCALE_ID`'  order by 2 ");
		dataMap.put("SQL_PH_CYTOINCIREORT_WITNESSEDBY_SELECT", "SELECT APPL_USER_ID CODE, APPL_USER_NAME DESCRIPTION FROM SM_APPL_USER WHERE PIN_NO IS NOT NULL AND UPPER(APPL_USER_ID) LIKE UPPER(?) AND UPPER(APPL_USER_NAME) LIKE UPPER(?) AND LANGUAGE_ID ='~LOCALE_ID`' ");
		dataMap.put("SQL_PH_DISPMEDICATIONIP_NURSING_SELECT","SELECT NURSING_UNIT_CODE CODE, SHORT_DESC DESCRIPTION FROM IP_NURSING_UNIT_LANG_VW IP_NURSING_UNIT WHERE EFF_STATUS='E' AND FACILITY_ID LIKE UPPER(?) AND upper(NURSING_UNIT_CODE) LIKE upper(?) AND upper(SHORT_DESC) LIKE upper(?) AND LANGUAGE_ID ='~LOCALE_ID`' ");
		dataMap.put("SQL_PH_DISPMEDICATIONIP_CLINIC_SELECT","SELECT CLINIC_CODE CODE, LONG_DESC DESCRIPTION  FROM OP_CLINIC_LANG_VW OP_CLINIC WHERE  UPPER(FACILITY_ID) LIKE UPPER(?)  AND Upper(CLINIC_CODE) like Upper(?) AND Upper(LONG_DESC) LIKE Upper(?) AND EFF_STATUS='E'  AND CLINIC_TYPE ='C' AND  LANGUAGE_ID ='~LOCALE_ID`' ");									
		dataMap.put("SQL_PH_DISP_MEDICATION_NAT_SEARCH","SELECT COUNTRY_CODE CODE,LONG_NAME  DESCRIPTION FROM MP_COUNTRY_LANG_VW WHERE  UPPER(COUNTRY_CODE) LIKE UPPER(?)  AND UPPER(LONG_NAME) LIKE UPPER(?) and EFF_STATUS='E' AND  LANGUAGE_ID ='~LOCALE_ID`'  order by 2 ");
		dataMap.put("SQL_PH_DISP_LOCN_LANG_VW_SELECT","SELECT A.DISP_LOCN_CODE code,SHORT_DESC description FROM PH_disp_locn_lang_vw A WHERE  A.FACILITY_ID LIKE ? AND upper(DISP_LOCN_CODE) LIKE upper(?) AND upper(SHORT_DESC )LIKE upper(?) AND A.DISP_LOCN_TYPE='P' and a.language_id='~LOCALE_ID`' ");
		dataMap.put("SQL_PH_DRUG_SEARCH_DRUG","SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG_LANG_VW PH_DRUG WHERE  DISCONTINUED_YN='N' AND UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DRUG_YN='Y' AND LANGUAGE_ID = '~LOCALE_ID`' ");//added for mohe-scf-202
		dataMap.put("SQL_PH_DRUG_QUERY_SELECT1_LOOKUP", "SELECT DRUG_CODE CODE, DRUG_DESC DESCRIPTION FROM PH_DRUG_LANG_VW PH_DRUG WHERE  UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DISCONTINUED_YN='Y' AND LANGUAGE_ID ='~LANGUAGE_ID`'");//40016 
		dataMap.put("SQL_PH_DISP_LOCN_SELECT10_LOOKUP", "SELECT PRACTITIONER_ID CODE,PRACTITIONER_NAME  DESCRIPTION FROM AM_PRACTITIONER WHERE UPPER(PRACTITIONER_ID) LIKE UPPER(?)  AND UPPER(PRACTITIONER_NAME) LIKE UPPER(?) AND EFF_STATUS='E' ORDER BY 2 ");//40016
        dataMap.put("SQL_PH_QUOTA_LMT_SELECT","SELECT DRUG_CODE, SPECIALITY_CODE, SET_LIMIT_BY, QUOTA_LIMIT, ADDITIONAL_QUOTA_LIMIT FROM PH_DRUG_QUOTA_LIMIT WHERE  DRUG_CODE =?");
        dataMap.put("SQL_PH_DRUG_QUERY_SELECT1_LOOKUP", "SELECT DRUG_CODE CODE, DRUG_DESC DESCRIPTION FROM PH_DRUG_LANG_VW PH_DRUG WHERE  UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DISCONTINUED_YN='Y' AND LANGUAGE_ID ='~LANGUAGE_ID`'");//40016
        dataMap.put("SQL_SPECIALITY_DESC_SELECT","SELECT  short_desc SPECIALITY_DESC FROM am_speciality WHERE SPECIALITY_CODE=?");
        //dataMap.put("SQL_SPECIALITY_CODE_SELECT","SELECT speciality_code FROM am_speciality WHERE short_desc = ?");
        dataMap.put("SQL_SPECIALITY_CODE_INSERT","INSERT INTO PH_DRUG_QUOTA_LIMIT(DRUG_CODE, SPECIALITY_CODE, SET_LIMIT_BY, QUOTA_LIMIT, ADDITIONAL_QUOTA_LIMIT,ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) Values(?, ?, ?, ?, ?,?, sysdate, ?, ?, ?, sysdate, ?, ?)");
        dataMap.put("SQL_SPECIALITY_CODE_UPDATE","UPDATE ph_drug_quota_limit SET set_limit_by = ?,quota_limit = ?,additional_quota_limit = ?,modified_facility_id = ?,modified_at_ws_no = ?,modified_date = SYSDATE,modified_by_id = ?, added_facility_id = ?,added_at_ws_no = ?,added_date = SYSDATE,added_by_id = ?  WHERE speciality_code = ? AND drug_code = ?");
        dataMap.put("SQL_SPECIALITY_CODE_DELETE", "DELETE FROM ph_drug_quota_limit WHERE speciality_code = ? AND drug_code = ?");
        dataMap.put("SQL_SPECIALITY_CODE_UPDATE_AND_RESET","UPDATE ph_drug_quota_limit SET set_limit_by = ?,quota_limit = ?,additional_quota_limit = ?,modified_facility_id = ?,modified_at_ws_no = ?,modified_date = SYSDATE,modified_by_id = ?, added_facility_id = ?,added_at_ws_no = ?,added_date = SYSDATE,added_by_id = ?,quota_curr_value=0  WHERE speciality_code = ? AND drug_code = ?");//Added for ML-MMOH-CRF-1823 US005
		dataMap.put("SQL_CURR_QUOTA_LIMIT_UPDATE","UPDATE PH_DRUG_QUOTA_LIMIT SET QUOTA_CURR_VALUE =?,MODIFIED_AT_WS_NO = ?,MODIFIED_DATE = SYSDATE,MODIFIED_BY_ID = ?,MODIFIED_FACILITY_ID = ? WHERE DRUG_CODE =? AND SPECIALITY_CODE =?");//Added for ML-MMOH-CRF-1823
		dataMap.put("SQL_PH_ORDERRUTIN_MEDICAL_ITEM_LOOKUP","SELECT A.ITEM_CODE CODE, A.SHORT_DESC DESCRIPTION FROM MM_ITEM_LANG_VW A, ST_ITEM B WHERE A.ITEM_CODE = B.ITEM_CODE  AND B.MEDICAL_ITEM_YN = 'Y'  AND B.DRUG_ITEM_YN = 'N'  AND A.ITEM_CODE LIKE UPPER(?)  AND UPPER(A.SHORT_DESC) LIKE UPPER(?) AND A.LANGUAGE_ID ='~LANGUAGE_ID`' ");
		dataMap.put("SQL_PH_REPORTS_ROUTE_LOOKUP_NEW",		"SELECT ROUTE_CODE CODE, ROUTE_DESC DESCRIPTION FROM PH_ROUTE_LANG_VW PH_ROUTE WHERE UPPER(ROUTE_CODE) LIKE UPPER(?) AND UPPER(ROUTE_DESC) LIKE UPPER(?) AND LANGUAGE_ID ='~LANGUAGE_ID`' ");
		dataMap.put("SQL_PH_REPORTS_GENID_LOOKUP_NEW",		"SELECT GENERIC_ID CODE, GENERIC_NAME DESCRIPTION FROM PH_GENERIC_NAME_LANG_VW PH_GENERIC_NAME WHERE UPPER(GENERIC_ID) LIKE UPPER(?) AND UPPER(GENERIC_NAME) LIKE UPPER(?) AND LANGUAGE_ID ='~LANGUAGE_ID`'  ");
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_GNERICTOICD", "SELECT INTR_CODE1, D1.GENERIC_NAME INTR_NAME1, FORM_CODE1,DECODE (FORM_CODE1, '*A', 'ALL',(SELECT FORM_DESC FROM PH_FORM_LANG_VW WHERE FORM_CODE = B.FORM_CODE1 AND LANGUAGE_ID = D1.LANGUAGE_ID) ) FORM_DESC1,INTR_CODE2,(SELECT SHORT_DESC FROM MR_TERM_CODE WHERE TERM_CODE = B.INTR_CODE2 AND TERM_SET_ID = B.TERM_SET_ID) INTR_NAME2, '*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL,B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS,B.EFF_STATUS FROM PH_DRUG_INTERACTION B, PH_GENERIC_NAME_LANG_VW D1 WHERE B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.INTR_TYPE1 = 'G' AND B.INTR_TYPE2 = 'I' AND B.INTR_CODE1 = D1.GENERIC_ID AND B.INTR_SEVERITY_LEVEL LIKE (?) AND B.INTR_SIGNIF_LEVEL LIKE (?) AND B.INTR_PROB_LEVEL LIKE (?) AND B.EFF_STATUS LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') AND D1.LANGUAGE_ID = ?");//Added for MMS-DM-CRF-0229
		dataMap.put("SQL_PH_DRUG_INT_QUERY_DTL_DRUGTOICD", " SELECT INTR_CODE1, D1.DRUG_DESC INTR_NAME1, FORM_CODE1,DECODE (FORM_CODE1, '*A', 'ALL',(SELECT FORM_DESC FROM PH_FORM_LANG_VW WHERE FORM_CODE = B.FORM_CODE1 AND LANGUAGE_ID = D1.LANGUAGE_ID) ) FORM_DESC1,INTR_CODE2,(SELECT SHORT_DESC FROM MR_TERM_CODE WHERE TERM_CODE = B.INTR_CODE2 AND TERM_SET_ID = B.TERM_SET_ID) INTR_NAME2, '*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL,B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS,B.EFF_STATUS FROM PH_DRUG_INTERACTION B, PH_DRUG_LANG_VW D1 WHERE B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.INTR_TYPE1 = 'D' AND B.INTR_TYPE2 = 'I' AND B.INTR_CODE1 = D1.DRUG_CODE AND B.INTR_SEVERITY_LEVEL LIKE (?) AND B.INTR_SIGNIF_LEVEL LIKE (?) AND B.INTR_PROB_LEVEL LIKE (?) AND B.EFF_STATUS LIKE DECODE (?, 'E', 'E', 'D', 'D', '%') AND D1.LANGUAGE_ID = ?");//Added for MMS-DM-CRF-0229
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_DRUGTOICD",  "SELECT INTR_TYPE1,INTR_TYPE2,INTR_CODE1, D1.DRUG_DESC INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2, (SELECT SHORT_DESC FROM MR_TERM_CODE WHERE TERM_CODE = B.INTR_CODE2 AND TERM_SET_ID = B.TERM_SET_ID) INTR_NAME2,B.TERM_SET_ID TERM_CODE, (SELECT TERM_SET_DESC FROM MR_TERM_SET WHERE TERM_SET_ID = B.TERM_SET_ID) TERM_SET_DESC,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS,LAB_ORD_CHK_UPTO_NO_OF_DAYS FROM PH_DRUG_INTERACTION B, PH_DRUG_LANG_VW D1 WHERE B.INTR_TYPE1 = ? AND B.INTR_TYPE2 = ? AND B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.FORM_CODE1=? AND B.FORM_CODE2=? AND B.INTR_CODE1 = D1.DRUG_CODE  AND D1.LANGUAGE_ID = ?");
		dataMap.put("SQL_PH_DRUG_INT_MODIFY_GENERICTOICD",  "SELECT INTR_TYPE1,INTR_TYPE2,INTR_CODE1, D1.GENERIC_NAME INTR_NAME1, FORM_CODE1, decode(form_code1, '*A', 'All',(SELECT FORM_DESC FROM PH_FORM_LANG_VW  WHERE FORM_CODE = B.FORM_CODE1  AND LANGUAGE_ID = D1.LANGUAGE_ID)) FORM_DESC1,INTR_CODE2,  (SELECT SHORT_DESC FROM MR_TERM_CODE WHERE TERM_CODE = B.INTR_CODE2 AND TERM_SET_ID = B.TERM_SET_ID) INTR_NAME2,B.TERM_SET_ID TERM_CODE, (SELECT TERM_SET_DESC FROM MR_TERM_SET WHERE TERM_SET_ID = B.TERM_SET_ID) TERM_SET_DESC,'*A' FORM_CODE2, '' FORM_DESC2, B.INTR_SEVERITY_LEVEL, B.INTR_SIGNIF_LEVEL, B.INTR_PROB_LEVEL, INTR_RESTRT_YN, INTR_REMARKS, B.EFF_STATUS,LAB_ORD_CHK_UPTO_NO_OF_DAYS FROM PH_DRUG_INTERACTION B, PH_GENERIC_NAME_LANG_VW D1 WHERE B.INTR_TYPE1 = ? AND B.INTR_TYPE2 = ? AND B.INTR_CODE1 LIKE (?) AND B.INTR_CODE2 LIKE (?) AND B.FORM_CODE1=? AND B.FORM_CODE2=? AND B.INTR_CODE1 = D1.GENERIC_ID  AND D1.LANGUAGE_ID = ?");//Added for MMS-DM-CRF-0229
		dataMap.put("SQL_QUOTALIMIT_APPROVAL_LOCATION_LOOKUP","SELECT CODE,DESCRIPTION FROM (Select locn_code code, DECODE(PATIENT_CLASS,'DC',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'IP',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'EM',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'OP',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'R',AM_GET_DESC.AM_REFERRAL(locn_code,'~LANGUAGE_ID`','1') )  description from or_locn_vw where patient_class like '~PATIENT_CLASS`%' and nvl(facility_id, '~FACILITY_ID`')  like '~FACILITY_ID`%' )  WHERE CODE like UPPER(?) and UPPER(DESCRIPTION) like UPPER(?) order by DESCRIPTION");
		dataMap.put("SQL_QUOTALIMIT_APPROVAL_LOCATION_LOOKUP_DAYCARE","SELECT CODE,DESCRIPTION FROM (Select locn_code code, DECODE(PATIENT_CLASS,'DC',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'IP',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'EM',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'OP',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'R',AM_GET_DESC.AM_REFERRAL(locn_code,'~LANGUAGE_ID`','1') )  description from or_locn_vw where  patient_class like '~PATIENT_CLASS`%' and nvl(facility_id, '~FACILITY_ID`')  like '~FACILITY_ID`%' ) and CLINIC_TYPE='Y' WHERE CODE like UPPER(?) and UPPER(DESCRIPTION) like UPPER(?) order by DESCRIPTION");
		dataMap.put("SQL_QUOTALIMIT_APPROVAL_LOCATION_LOOKUP_EMERGENCY","SELECT CODE,DESCRIPTION FROM (Select locn_code code, DECODE(PATIENT_CLASS,'DC',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'IP',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'EM',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'OP',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'R',AM_GET_DESC.AM_REFERRAL(locn_code,'~LANGUAGE_ID`','1') )  description from or_locn_vw where  patient_class like '~PATIENT_CLASS`%' and nvl(facility_id, '~FACILITY_ID`')  like '~FACILITY_ID`%' ) and CLINIC_TYPE='C' AND LEVEL_OF_CARE_IND='E' WHERE CODE like UPPER(?) and UPPER(DESCRIPTION) like UPPER(?) order by DESCRIPTION");
		dataMap.put("SQL_QUOTALIMIT_APPROVAL_LOCATION_LOOKUP_CLINIC","SELECT CODE,DESCRIPTION FROM (Select locn_code code, DECODE(PATIENT_CLASS,'DC',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'IP',IP_GET_DESC.IP_NURSING_UNIT(facility_id,locn_code,'~LANGUAGE_ID`','2'),'EM',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'OP',OP_GET_DESC.OP_CLINIC(facility_id,locn_code,'~LANGUAGE_ID`','2'),'R',AM_GET_DESC.AM_REFERRAL(locn_code,'~LANGUAGE_ID`','1') )  description from or_locn_vw where  patient_class like '~PATIENT_CLASS`%' and nvl(facility_id, '~FACILITY_ID`')  like '~FACILITY_ID`%' ) and CLINIC_TYPE='C' AND LEVEL_OF_CARE_IND='A' WHERE CODE like UPPER(?) and UPPER(DESCRIPTION) like UPPER(?) order by DESCRIPTION");
		dataMap.put("SQL_QUOTALIMIT_APPROVAL_DRUG_SEARCH_LOOKUP", "SELECT DRUG_CODE code, DRUG_DESC description FROM PH_DRUG_LANG_VW PH_DRUG WHERE  DISCONTINUED_YN='N' AND UPPER(DRUG_CODE) LIKE UPPER(?) AND UPPER(DRUG_DESC) LIKE UPPER(?) AND DRUG_YN='Y' AND LANGUAGE_ID = '~LANGUAGE_ID`'");
		dataMap.put("SQL_PH_DISP_LOC_LOOKUP_SELECT", "SELECT DISP_LOCN_CODE CODE, SHORT_DESC description FROM PH_DISP_LOCN_LANG_VW PH_DISP_LOCN WHERE EFF_STATUS='E' AND DISP_LOCN_CODE LIKE UPPER(?) AND Upper(SHORT_DESC) like upper(?) and facility_id ='~FACILITY_ID`' and language_id='~LOCALE_ID`' order by 2"); // Added for MOHE-SCF-0276 by lakshmanan 
	
	} 

	//private static PhRepository instance;
	private static int i;
}