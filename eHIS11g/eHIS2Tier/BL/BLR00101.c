
/* Result Sets Interface */
#ifndef SQL_CRSR
#  define SQL_CRSR
  struct sql_cursor
  {
    unsigned int curocn;
    void *ptr1;
    void *ptr2;
    unsigned int magic;
  };
  typedef struct sql_cursor sql_cursor;
  typedef struct sql_cursor SQL_CURSOR;
#endif /* SQL_CRSR */

/* Thread Safety */
typedef void * sql_context;
typedef void * SQL_CONTEXT;

/* Object support */
struct sqltvn
{
  unsigned char *tvnvsn; 
  unsigned short tvnvsnl; 
  unsigned char *tvnnm;
  unsigned short tvnnml; 
  unsigned char *tvnsnm;
  unsigned short tvnsnml;
};
typedef struct sqltvn sqltvn;

struct sqladts
{
  unsigned int adtvsn; 
  unsigned short adtmode; 
  unsigned short adtnum;  
  sqltvn adttvn[1];       
};
typedef struct sqladts sqladts;

static struct sqladts sqladt = {
  1,1,0,
};

/* Binding to PL/SQL Records */
struct sqltdss
{
  unsigned int tdsvsn; 
  unsigned short tdsnum; 
  unsigned char *tdsval[1]; 
};
typedef struct sqltdss sqltdss;
static struct sqltdss sqltds =
{
  1,
  0,
};

/* File name & Package Name */
struct sqlcxp
{
  unsigned short fillen;
           char  filnam[42];
};
static const struct sqlcxp sqlfpn =
{
    41,
    "Y:\\trunk\\eHIS11g\\eHIS2Tier/BL/BLR00101.pc"
};


static unsigned int sqlctx = 1288460867;


static struct sqlexd {
   unsigned int   sqlvsn;
   unsigned int   arrsiz;
   unsigned int   iters;
   unsigned int   offset;
   unsigned short selerr;
   unsigned short sqlety;
   unsigned int   occurs;
      const short *cud;
   unsigned char  *sqlest;
      const char  *stmt;
   sqladts *sqladtp;
   sqltdss *sqltdsp;
            void  **sqphsv;
   unsigned int   *sqphsl;
            int   *sqphss;
            void  **sqpind;
            int   *sqpins;
   unsigned int   *sqparm;
   unsigned int   **sqparc;
   unsigned short  *sqpadto;
   unsigned short  *sqptdso;
   unsigned int   sqlcmax;
   unsigned int   sqlcmin;
   unsigned int   sqlcincr;
   unsigned int   sqlctimeout;
   unsigned int   sqlcnowait;
              int   sqfoff;
   unsigned int   sqcmod;
   unsigned int   sqfmod;
            void  *sqhstv[52];
   unsigned int   sqhstl[52];
            int   sqhsts[52];
            void  *sqindv[52];
            int   sqinds[52];
   unsigned int   sqharm[52];
   unsigned int   *sqharc[52];
   unsigned short  sqadto[52];
   unsigned short  sqtdso[52];
} sqlstm = {12,52};

/* SQLLIB Prototypes */
extern void sqlcxt (void **, unsigned int *,
                    struct sqlexd *, const struct sqlcxp *);
extern void sqlcx2t(void **, unsigned int *,
                    struct sqlexd *, const struct sqlcxp *);
extern void sqlbuft(void **, char *);
extern void sqlgs2t(void **, char *);
extern void sqlorat(void **, unsigned int *, void *);

/* Forms Interface */
static const int IAPSUCC = 0;
static const int IAPFAIL = 1403;
static const int IAPFTL  = 535;
extern void sqliem(unsigned char *, signed int *);

 static const char *sq0006 = 
"select PATIENT_ID ,DOC_TYPE_CODE ,DOC_NUM ,EPISODE_ID  from BL_BILL_PRINT_TE\
MP where (OPERATING_FACILITY_ID=:b0 and SESSION_ID=:b1)           ";

 static const char *sq0007 = 
"select doc_type_code ,doc_Number  from BL_RECEIPT_REFUND_HDR where (Bill_doc\
_type_code=:b0 and bill_doc_number=:b1)           ";

 static const char *sq0015 = 
"priority c ,BL_BILL_PRINT_TEMP D where ((((((((((((a.facility_id=b.operating\
_facility_id and a.open_episode_id=b.episode_id) and b.operating_facility_id=c\
.operating_facility_id) and b.episode_id=c.episode_id) and b.cur_acct_seq_no=c\
.acct_seq_no) and nvl(a.cust_code,'!!!')=nvl(c.cust_code,'!!!')) and nvl(a.pol\
icy_type_code,'!!!')=nvl(c.policy_type_code,'!!!')) and A.BLNG_GRP_ID=C.BLNG_G\
RP_ID) and d.episode_id=b.episode_id) and b.operating_facility_id=d.operating_\
facility_id) and NVL(a.cust_code,'!!!')=NVL(D.CUST_CODE,'!!!')) and D.SESSION_\
ID=:b0) and B.PATIENT_ID=D.PATIENT_ID) order by 1,2            ";

 static const char *sq0016 = 
"_doc_ref) and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.package_t\
rx_yn='N') and b.org_gross_charge_amt<>0))) and NVL(a.package_trx_yn,'N')='P')\
 and nvl(a.confirmed_yn,'N')<>'N') order by custcode,payeritemgrpcode,entitemg\
rpcode,payerservgrphdr,print_seq,summary_dtl_ind,payerservgrpline,servicedate,\
trxdocref,trxdocreflinenum            ";

 static const char *sq0019 = 
"credit_auth_ref=a.credit_auth_ref) and NVL(b.appt_book_ref_num,'#')=NVL(a.ap\
pt_book_ref_num,'#'))))           ";

 static const char *sq0021 = 
"_line_num=a.trx_doc_ref_line_num) and b.episode_id=:b4) and NVL(a.billed_fla\
g,'N')='N'))) and exists (select 1  from bl_package_folio b where (((((b.opera\
ting_facility_id=:b1 and b.operating_facility_id=a.operating_facility_id) and \
b.trx_doc_ref=a.trx_doc_ref) and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num\
) and b.package_seq_no=:b21) and b.package_trx_yn='Y'))) and NVL(a.package_trx\
_yn,'N') in ('P','Y')) and nvl(a.confirmed_yn,'N')<>'N') and ((:b22 is null  a\
nd a.cust_code is null ) or (:b22 is  not null  and a.cust_code=:b22))) order \
by PRINT_SEQ,PAYER_ITEM_GRP_CODE,summary_dtl_ind,a.TRX_DOC_REF,a.TRX_DOC_REF_L\
INE_NUM            ";

 static const char *sq0034 = 
"select ((((DOC_TYPE_CODE||'/')||DOC_NUMBER)||'/')||DOC_SRNO) ,DOC_DATE ,DOC_\
AMT ,A.SLMT_TYPE_CODE ,b.SHORT_DESC  from bl_receipt_refund_dtl_vw A ,BL_SLMT_\
TYPE B where (((((operating_facility_id=:b0 and a.SLMT_TYPE_CODE=b.SLMT_TYPE_C\
ODE) and patient_id=:b1) and RECPT_NATURE_CODE in ('BI','DC','IN')) and nvl(CA\
NCELLED_IND,'N')='N') and ((BILL_DOC_TYPE_CODE=:b2 and BILL_DOC_NUMBER=:b3) or\
 (DOC_TYPE_CODE,DOC_NUMBER,DOC_SRNO) in (select ORG_DOC_TYPE_CODE ,ORG_DOC_NUM\
 ,ORG_DOC_SRNO  from bl_patient_ledger where ((operating_facility_id=:b0 and A\
D_PR_ADJ_BILL_DOC_TYPE=:b2) and AD_PR_ADJ_BILL_DOC_NUM=:b3))))           ";

 static const char *sq0035 = 
"select ((((ORG_DOC_TYPE_CODE||'/')||ORG_DOC_NUM)||'/')||ORG_DOC_SRNO) ,A.DOC\
_DATE ,ABS(A.DOC_AMT) ,B.SLMT_TYPE_CODE  from BL_PATIENT_LEDGER_TRN A ,BL_RECE\
IPT_REFUND_DTL B where ((((((((A.operating_facility_id=:b0 and AD_PR_ADJ_BILL_\
DOC_TYPE=:b1) and AD_PR_ADJ_BILL_DOC_NUM=:b2) and a.patient_id=:b3) and TRX_ST\
ATUS is null ) and A.operating_facility_id=B.operating_facility_id) and A.ORG_\
DOC_TYPE_CODE=B.doc_type_code) and A.ORG_DOC_NUM=B.DOC_NUMBER) and A.ORG_DOC_S\
RNO=B.DOC_SRNO) order by A.DOC_DATE,A.ORG_DOC_TYPE_CODE,A.ORG_DOC_NUM         \
   ";

 static const char *sq0388 = 
"select sum(upd_net_charge_amt) ,cust_code ,cust_group_code ,policy_type_code\
 ,policy_number ,priority  from bl_patient_charges_folio where ((((patient_id=\
:b0 and episode_id=:b1) and cust_code is  not null ) and bill_doc_num is null \
) and trx_status is null ) group by cust_code,cust_group_code,policy_type_code\
,policy_number,priority           ";

 static const char *sq0389 = 
"select sum(upd_net_charge_amt) ,cust_code ,cust_group_code ,policy_type_code\
 ,policy_number ,priority  from bl_patient_charges_folio where (((((patient_id\
=:b0 and episode_id=:b1) and cust_code is  not null ) and bill_doc_num is null\
 ) and trx_status is null ) and ((((((cust_code||'/')||cust_group_code)||'/')|\
|policy_type_code)||'/')||policy_number)<>:b2) group by cust_code,cust_group_c\
ode,policy_type_code,policy_number,priority           ";

 static const char *sq0396 = 
"select ((((ORG_DOC_TYPE_CODE||'/')||ORG_DOC_NUM)||'/')||ORG_DOC_SRNO) ,SLMT_\
TYPE_CODE ,ABS(DOC_AMT) ,ORG_DOC_DATE  from BL_PATIENT_LEDGER where ((((((PATI\
ENT_ID=:b0 and EPISODE_ID=:b1) and ((:b2 in ('O','E') and visit_id=:b3) or :b2\
 in ('I','D','R'))) and tRX_TYPE_CODE='5') and RECPT_NATURE_CODE in ('AD','PR'\
)) and DOC_OUTST_AMT<>0) and TRX_STATUS is null ) union select ((((ORG_DOC_TYP\
E_CODE||'/')||ORG_DOC_NUM)||'/')||ORG_DOC_SRNO) ,SLMT_TYPE_CODE ,ABS(DOC_AMT) \
,ORG_DOC_DATE  from BL_PATIENT_LEDGER where (((((PATIENT_ID=:b0 and EPISODE_TY\
PE='R') and tRX_TYPE_CODE='5') and RECPT_NATURE_CODE in ('AD','PR')) and DOC_O\
UTST_AMT<>0) and TRX_STATUS is null ) order by ORG_DOC_DATE            ";

 static const char *sq0397 = 
"select sum(BL_GET_TAX_AMOUNT(a.operating_facility_id,a.TRX_DOC_REF,a.TRX_DOC\
_REF_LINE_NUM,a.TRX_DOC_REF_SEQ_NUM,a.RULE_CODE,a.ADDL_CHARGE_AMT,a.SERV_TAX_Y\
N,'P',null )) Tax_amt  from BL_PAT_CHRG_FOLIO_ADDL_CHARGE A where ((a.operatin\
g_facility_id,a.TRX_DOC_REF,a.TRX_DOC_REF_LINE_NUM,a.TRX_DOC_REF_SEQ_NUM) in (\
select c.operating_facility_id ,c.TRX_DOC_REF ,c.TRX_DOC_REF_LINE_NUM ,c.TRX_D\
OC_REF_SEQ_NUM  from BL_PATIENT_CHARGES_FOLIO C where ((((((((c.TRX_DOC_REF=a.\
TRX_DOC_REF and c.TRX_DOC_REF_LINE_NUM=a.TRX_DOC_REF_LINE_NUM) and c.TRX_DOC_R\
EF_SEQ_NUM=a.TRX_DOC_REF_SEQ_NUM) and NVL(c.billed_flag,'N')='N') and c.episod\
e_type=:b0) and c.patient_id=:b1) and c.episode_id=:b2) and c.cust_code=:b3) a\
nd nvl(c.priority,0)=nvl(:b4,0))) and exists (select 'Y'  from BL_package_FOLI\
O d where (((d.TRX_DOC_REF=a.TRX_DOC_REF and d.TRX_DOC_REF_LINE_NUM=a.TRX_DOC_\
REF_LINE_NUM) and d.TRX_DOC_REF_SEQ_NUM=a.TRX_DOC_REF_SEQ_NUM) and d.package_t\
rx_yn='Y')))           ";

typedef struct { unsigned short len; unsigned char arr[1]; } VARCHAR;
typedef struct { unsigned short len; unsigned char arr[1]; } varchar;

/* cud (compilation unit data) array */
static const short sqlcud0[] =
{12,4274,178,0,0,
5,0,0,1,47,0,4,1234,0,0,4,3,0,1,0,1,9,0,0,1,3,0,0,1,3,0,0,2,9,0,0,
36,0,0,0,0,0,27,1331,0,0,4,4,0,1,0,1,9,0,0,1,10,0,0,1,10,0,0,1,10,0,0,
67,0,0,3,407,0,4,1414,0,0,10,3,0,1,0,1,3,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
122,0,0,4,104,0,4,1494,0,0,5,4,0,1,0,1,3,0,0,1,3,0,0,1,9,0,0,1,9,0,0,2,9,0,0,
157,0,0,5,104,0,4,1504,0,0,5,4,0,1,0,1,3,0,0,1,3,0,0,1,9,0,0,1,9,0,0,2,9,0,0,
192,0,0,6,142,0,9,5023,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
215,0,0,6,0,0,13,5053,1,0,4,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
246,0,0,7,126,0,9,5098,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
269,0,0,7,0,0,13,5118,1,0,2,0,0,1,0,2,9,0,0,2,9,0,0,
292,0,0,8,85,0,5,5156,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
315,0,0,9,120,0,5,5163,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
338,0,0,10,93,0,5,5173,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
361,0,0,11,0,0,29,5183,1,0,0,0,0,1,0,
376,0,0,12,85,0,5,5190,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
399,0,0,13,120,0,5,5196,1,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
422,0,0,14,0,0,29,5203,1,0,0,0,0,1,0,
437,0,0,6,0,0,15,5218,1,0,0,0,0,1,0,
452,0,0,7,0,0,15,5229,1,0,0,0,0,1,0,
467,0,0,15,1631,0,9,5320,1,0,1,1,0,1,0,1,9,0,0,
486,0,0,15,0,0,13,5396,1,0,41,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,4,0,0,2,4,0,0,2,4,0,
0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,4,0,0,2,9,0,0,2,4,0,0,2,4,0,0,2,9,0,0,2,4,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,3,0,0,
665,0,0,15,0,0,15,5491,1,0,0,0,0,1,0,
680,0,0,16,348,1,9,5915,1,0,47,47,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,
883,0,0,16,0,0,15,5926,1,0,0,0,0,1,0,
898,0,0,16,0,0,13,6022,1,0,44,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,9,0,0,2,4,0,0,2,
4,0,0,2,3,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
1089,0,0,17,83,0,4,6146,1,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
1112,0,0,18,124,0,4,6176,1,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1143,0,0,19,2158,0,9,6273,1,0,14,14,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1214,0,0,19,0,0,15,6285,1,0,0,0,0,1,0,
1229,0,0,19,0,0,13,6308,1,0,6,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,4,0,0,2,4,0,0,
2,4,0,0,
1268,0,0,20,96,0,4,6328,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1295,0,0,21,2689,0,9,6471,1,0,25,25,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
4,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,
1410,0,0,21,0,0,15,6483,1,0,0,0,0,1,0,
1425,0,0,21,0,0,13,6536,1,0,18,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,3,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,
1512,0,0,22,264,0,4,6585,1,0,7,6,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,
1555,0,0,16,348,1,9,6605,1,0,47,47,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,
1758,0,0,16,0,0,15,6617,1,0,0,0,0,1,0,
1773,0,0,16,0,0,13,6711,1,0,44,0,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,9,0,0,2,4,0,0,2,
4,0,0,2,3,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
1964,0,0,23,83,0,4,6824,1,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
1987,0,0,24,124,0,4,6855,1,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2018,0,0,25,370,0,4,6876,1,0,11,10,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2077,0,0,26,109,0,4,6983,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
2104,0,0,27,151,0,4,6988,1,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2135,0,0,28,113,0,4,6994,1,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
2162,0,0,29,100,0,4,5811,3,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
2189,0,0,30,206,0,6,6044,3,0,8,8,0,1,0,2,3,0,0,1,9,0,0,1,4,0,0,1,9,0,0,1,9,0,0,
1,3,0,0,2,9,0,0,2,9,0,0,
2236,0,0,31,88,0,4,6064,3,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
2259,0,0,32,31,0,4,6070,3,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
2282,0,0,33,77,0,6,6084,3,0,2,2,0,1,0,2,9,0,0,1,9,0,0,
2305,0,0,34,617,0,9,6121,3,0,7,7,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,
2348,0,0,34,0,0,13,6147,3,0,5,0,0,1,0,2,9,0,0,2,9,0,0,2,4,0,0,2,9,0,0,2,9,0,0,
2383,0,0,34,0,0,15,6179,3,0,0,0,0,1,0,
2398,0,0,35,547,0,9,6219,3,0,4,4,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2429,0,0,35,0,0,13,6247,3,0,4,0,0,1,0,2,9,0,0,2,9,0,0,2,4,0,0,2,9,0,0,
2460,0,0,35,0,0,15,6279,3,0,0,0,0,1,0,
2475,0,0,36,355,0,6,6619,3,0,9,9,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,2,4,0,0,2,4,0,0,
2,4,0,0,2,9,0,0,3,9,0,0,2,9,0,0,
2526,0,0,37,382,0,6,6658,3,0,10,10,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,2,4,0,
0,2,4,0,0,2,4,0,0,2,9,0,0,3,9,0,0,2,9,0,0,
2581,0,0,38,341,0,6,6702,3,0,9,9,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,2,4,0,0,2,4,0,0,
2,4,0,0,2,9,0,0,3,9,0,0,2,9,0,0,
2632,0,0,39,367,0,6,6744,3,0,10,10,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,2,4,0,
0,2,4,0,0,2,4,0,0,2,9,0,0,3,9,0,0,2,9,0,0,
2687,0,0,40,499,0,6,6820,3,0,19,19,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,3,0,0,1,9,0,0,1,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,3,9,0,0,2,9,0,0,
2778,0,0,41,76,0,4,6924,3,0,3,2,0,1,0,1,9,0,0,1,9,0,0,2,3,0,0,
2805,0,0,42,519,0,4,6931,3,0,36,24,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,
2964,0,0,43,491,0,6,7026,3,0,16,16,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,2,4,0,0,2,9,0,0,2,9,
0,0,3,9,0,0,
3043,0,0,44,108,0,4,7146,3,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3070,0,0,45,559,0,6,7173,3,0,3,3,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
3097,0,0,46,140,0,4,7224,3,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
3128,0,0,47,127,0,4,7254,3,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
3159,0,0,48,85,0,4,7362,3,0,1,0,0,1,0,2,9,0,0,
3178,0,0,49,119,0,4,7373,3,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3205,0,0,50,365,0,6,7502,3,0,5,5,0,1,0,1,9,0,0,3,9,0,0,2,9,0,0,3,9,0,0,2,9,0,0,
3240,0,0,51,292,0,6,7542,3,0,5,5,0,1,0,1,9,0,0,2,9,0,0,2,9,0,0,3,9,0,0,2,9,0,0,
3275,0,0,52,184,0,6,7581,3,0,3,3,0,1,0,1,9,0,0,3,9,0,0,3,9,0,0,
3302,0,0,53,1517,0,6,7606,3,0,13,13,0,1,0,1,9,0,0,1,9,0,0,2,1,0,0,3,3,0,0,3,3,
0,0,1,9,0,0,1,9,0,0,2,9,0,0,2,9,0,0,3,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
3369,0,0,54,97,0,4,7696,3,0,2,1,0,1,0,2,3,0,0,1,9,0,0,
3392,0,0,55,484,0,4,7735,3,0,25,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,1,0,0,2,1,0,0,2,1,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,1,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,
9,0,0,
3507,0,0,56,1600,0,4,7843,3,0,52,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,
3730,0,0,57,865,0,4,8030,3,0,28,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
3857,0,0,58,921,0,4,8174,3,0,29,3,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
3988,0,0,59,691,0,4,51,4,0,21,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
4087,0,0,60,691,0,4,109,4,0,21,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,
4186,0,0,61,691,0,4,160,4,0,20,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,
4281,0,0,63,120,0,4,337,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4312,0,0,64,119,0,4,403,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4343,0,0,65,132,0,4,430,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4374,0,0,66,119,0,4,452,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4405,0,0,67,195,0,4,488,4,0,7,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,3,0,0,
1,9,0,0,1,9,0,0,
4448,0,0,68,105,0,4,513,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
4475,0,0,69,57,0,4,523,4,0,1,0,0,1,0,2,9,0,0,
4494,0,0,70,65,0,4,541,4,0,1,0,0,1,0,2,9,0,0,
4513,0,0,71,110,0,4,1920,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
4540,0,0,72,132,0,6,1976,4,0,4,4,0,1,0,1,4,0,0,1,9,0,0,2,4,0,0,2,4,0,0,
4571,0,0,73,92,0,4,1996,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
4594,0,0,74,383,0,4,2013,4,0,12,10,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4657,0,0,75,91,0,2,2124,4,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
4680,0,0,76,0,0,29,2129,4,0,0,0,0,1,0,
4695,0,0,77,53,0,2,2137,4,0,1,1,0,1,0,1,9,0,0,
4714,0,0,78,0,0,29,2141,4,0,0,0,0,1,0,
4729,0,0,79,268,0,4,2654,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
4752,0,0,80,91,0,4,2667,4,0,1,0,0,1,0,2,9,0,0,
4771,0,0,81,268,0,4,2679,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
4794,0,0,82,91,0,4,2691,4,0,1,0,0,1,0,2,9,0,0,
4813,0,0,83,268,0,4,2702,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
4836,0,0,84,91,0,4,2714,4,0,1,0,0,1,0,2,9,0,0,
4855,0,0,85,268,0,4,2725,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
4878,0,0,86,91,0,4,2737,4,0,1,0,0,1,0,2,9,0,0,
4897,0,0,87,268,0,4,2747,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
4920,0,0,88,91,0,4,2759,4,0,1,0,0,1,0,2,9,0,0,
4939,0,0,89,268,0,4,2770,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
4962,0,0,90,91,0,4,2782,4,0,1,0,0,1,0,2,9,0,0,
4981,0,0,91,255,0,4,2793,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5004,0,0,92,91,0,4,2805,4,0,1,0,0,1,0,2,9,0,0,
5023,0,0,93,255,0,4,2816,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5046,0,0,94,91,0,4,2828,4,0,1,0,0,1,0,2,9,0,0,
5065,0,0,95,268,0,4,2839,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5088,0,0,96,91,0,4,2851,4,0,1,0,0,1,0,2,9,0,0,
5107,0,0,97,268,0,4,2862,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5130,0,0,98,91,0,4,2874,4,0,1,0,0,1,0,2,9,0,0,
5149,0,0,99,268,0,4,2885,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5172,0,0,100,91,0,4,2897,4,0,1,0,0,1,0,2,9,0,0,
5191,0,0,101,268,0,4,2907,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5214,0,0,102,91,0,4,2919,4,0,1,0,0,1,0,2,9,0,0,
5233,0,0,103,268,0,4,2929,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5256,0,0,104,91,0,4,2941,4,0,1,0,0,1,0,2,9,0,0,
5275,0,0,105,268,0,4,2952,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5298,0,0,106,91,0,4,2964,4,0,1,0,0,1,0,2,9,0,0,
5317,0,0,107,268,0,4,2975,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5340,0,0,108,91,0,4,2987,4,0,1,0,0,1,0,2,9,0,0,
5359,0,0,109,268,0,4,2997,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5382,0,0,110,91,0,4,3009,4,0,1,0,0,1,0,2,9,0,0,
5401,0,0,111,268,0,4,3020,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5424,0,0,112,91,0,4,3032,4,0,1,0,0,1,0,2,9,0,0,
5443,0,0,113,268,0,4,3043,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5466,0,0,114,91,0,4,3055,4,0,1,0,0,1,0,2,9,0,0,
5485,0,0,115,268,0,4,3065,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5508,0,0,116,91,0,4,3077,4,0,1,0,0,1,0,2,9,0,0,
5527,0,0,117,268,0,4,3088,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5550,0,0,118,91,0,4,3100,4,0,1,0,0,1,0,2,9,0,0,
5569,0,0,119,268,0,4,3110,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5592,0,0,120,91,0,4,3122,4,0,1,0,0,1,0,2,9,0,0,
5611,0,0,121,268,0,4,3133,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5634,0,0,122,91,0,4,3145,4,0,1,0,0,1,0,2,9,0,0,
5653,0,0,123,268,0,4,3155,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5676,0,0,124,91,0,4,3167,4,0,1,0,0,1,0,2,9,0,0,
5695,0,0,125,268,0,4,3177,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5718,0,0,126,91,0,4,3189,4,0,1,0,0,1,0,2,9,0,0,
5737,0,0,127,268,0,4,3200,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5760,0,0,128,91,0,4,3212,4,0,1,0,0,1,0,2,9,0,0,
5779,0,0,129,268,0,4,3222,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5802,0,0,130,91,0,4,3234,4,0,1,0,0,1,0,2,9,0,0,
5821,0,0,131,268,0,4,3245,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5844,0,0,132,91,0,4,3257,4,0,1,0,0,1,0,2,9,0,0,
5863,0,0,133,268,0,4,3267,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5886,0,0,134,91,0,4,3279,4,0,1,0,0,1,0,2,9,0,0,
5905,0,0,135,255,0,4,3290,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5928,0,0,136,91,0,4,3302,4,0,1,0,0,1,0,2,9,0,0,
5947,0,0,137,350,0,4,3314,4,0,3,2,0,1,0,1,3,0,0,2,9,0,0,1,9,0,0,
5974,0,0,138,268,0,4,3327,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5997,0,0,139,91,0,4,3340,4,0,1,0,0,1,0,2,9,0,0,
6016,0,0,140,268,0,4,3351,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6039,0,0,141,91,0,4,3363,4,0,1,0,0,1,0,2,9,0,0,
6058,0,0,142,350,0,4,3375,4,0,3,2,0,1,0,1,3,0,0,2,9,0,0,1,9,0,0,
6085,0,0,143,268,0,4,3387,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6108,0,0,144,91,0,4,3400,4,0,1,0,0,1,0,2,9,0,0,
6127,0,0,145,350,0,4,3412,4,0,3,2,0,1,0,1,3,0,0,2,9,0,0,1,9,0,0,
6154,0,0,146,268,0,4,3424,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6177,0,0,147,91,0,4,3438,4,0,1,0,0,1,0,2,9,0,0,
6196,0,0,148,268,0,4,3448,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6219,0,0,149,91,0,4,3460,4,0,1,0,0,1,0,2,9,0,0,
6238,0,0,150,268,0,4,3470,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6261,0,0,151,91,0,4,3482,4,0,1,0,0,1,0,2,9,0,0,
6280,0,0,152,268,0,4,3492,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6303,0,0,153,91,0,4,3504,4,0,1,0,0,1,0,2,9,0,0,
6322,0,0,154,350,0,4,3516,4,0,3,2,0,1,0,1,3,0,0,2,9,0,0,1,9,0,0,
6349,0,0,155,198,0,4,3528,4,0,2,1,0,1,0,1,3,0,0,2,9,0,0,
6372,0,0,156,350,0,4,3540,4,0,3,2,0,1,0,1,3,0,0,2,9,0,0,1,9,0,0,
6399,0,0,157,198,0,4,3552,4,0,2,1,0,1,0,1,3,0,0,2,9,0,0,
6422,0,0,158,248,0,4,3565,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6445,0,0,159,91,0,4,3577,4,0,1,0,0,1,0,2,9,0,0,
6464,0,0,160,248,0,4,3589,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6487,0,0,161,91,0,4,3601,4,0,1,0,0,1,0,2,9,0,0,
6506,0,0,162,248,0,4,3612,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6529,0,0,163,91,0,4,3624,4,0,1,0,0,1,0,2,9,0,0,
6548,0,0,164,248,0,4,3636,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6571,0,0,165,91,0,4,3648,4,0,1,0,0,1,0,2,9,0,0,
6590,0,0,166,248,0,4,3660,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6613,0,0,167,91,0,4,3672,4,0,1,0,0,1,0,2,9,0,0,
6632,0,0,168,248,0,4,3684,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6655,0,0,169,91,0,4,3696,4,0,1,0,0,1,0,2,9,0,0,
6674,0,0,170,248,0,4,3708,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6697,0,0,171,91,0,4,3720,4,0,1,0,0,1,0,2,9,0,0,
6716,0,0,172,248,0,4,3732,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6739,0,0,173,91,0,4,3744,4,0,1,0,0,1,0,2,9,0,0,
6758,0,0,174,248,0,4,3759,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6781,0,0,175,91,0,4,3771,4,0,1,0,0,1,0,2,9,0,0,
6800,0,0,176,248,0,4,3784,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6823,0,0,177,91,0,4,3796,4,0,1,0,0,1,0,2,9,0,0,
6842,0,0,178,248,0,4,3808,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6865,0,0,179,91,0,4,3820,4,0,1,0,0,1,0,2,9,0,0,
6884,0,0,180,248,0,4,3834,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6907,0,0,181,91,0,4,3846,4,0,1,0,0,1,0,2,9,0,0,
6926,0,0,182,248,0,4,3858,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6949,0,0,183,91,0,4,3870,4,0,1,0,0,1,0,2,9,0,0,
6968,0,0,184,248,0,4,3883,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
6991,0,0,185,91,0,4,3895,4,0,1,0,0,1,0,2,9,0,0,
7010,0,0,186,248,0,4,3907,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7033,0,0,187,91,0,4,3919,4,0,1,0,0,1,0,2,9,0,0,
7052,0,0,188,248,0,4,3930,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7075,0,0,189,91,0,4,3942,4,0,1,0,0,1,0,2,9,0,0,
7094,0,0,190,248,0,4,3954,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7117,0,0,191,91,0,4,3966,4,0,1,0,0,1,0,2,9,0,0,
7136,0,0,192,248,0,4,3976,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7159,0,0,193,91,0,4,3988,4,0,1,0,0,1,0,2,9,0,0,
7178,0,0,194,248,0,4,3998,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7201,0,0,195,91,0,4,4010,4,0,1,0,0,1,0,2,9,0,0,
7220,0,0,196,248,0,4,4020,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7243,0,0,197,91,0,4,4032,4,0,1,0,0,1,0,2,9,0,0,
7262,0,0,198,248,0,4,4042,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7285,0,0,199,91,0,4,4054,4,0,1,0,0,1,0,2,9,0,0,
7304,0,0,200,248,0,4,4064,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7327,0,0,201,91,0,4,4076,4,0,1,0,0,1,0,2,9,0,0,
7346,0,0,202,248,0,4,4087,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7369,0,0,203,91,0,4,4099,4,0,1,0,0,1,0,2,9,0,0,
7388,0,0,204,248,0,4,4109,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7411,0,0,205,91,0,4,4121,4,0,1,0,0,1,0,2,9,0,0,
7430,0,0,206,248,0,4,4131,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7453,0,0,207,91,0,4,4143,4,0,1,0,0,1,0,2,9,0,0,
7472,0,0,208,248,0,4,4154,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7495,0,0,209,91,0,4,4166,4,0,1,0,0,1,0,2,9,0,0,
7514,0,0,210,248,0,4,4177,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7537,0,0,211,91,0,4,4189,4,0,1,0,0,1,0,2,9,0,0,
7556,0,0,212,248,0,4,4200,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7579,0,0,213,91,0,4,4212,4,0,1,0,0,1,0,2,9,0,0,
7598,0,0,214,248,0,4,4222,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7621,0,0,215,91,0,4,4234,4,0,1,0,0,1,0,2,9,0,0,
7640,0,0,216,248,0,4,4245,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7663,0,0,217,91,0,4,4257,4,0,1,0,0,1,0,2,9,0,0,
7682,0,0,218,248,0,4,4268,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7705,0,0,219,91,0,4,4280,4,0,1,0,0,1,0,2,9,0,0,
7724,0,0,220,248,0,4,4291,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7747,0,0,221,91,0,4,4303,4,0,1,0,0,1,0,2,9,0,0,
7766,0,0,222,248,0,4,4314,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7789,0,0,223,91,0,4,4326,4,0,1,0,0,1,0,2,9,0,0,
7808,0,0,224,248,0,4,4337,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7831,0,0,225,91,0,4,4349,4,0,1,0,0,1,0,2,9,0,0,
7850,0,0,226,248,0,4,4361,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7873,0,0,227,91,0,4,4373,4,0,1,0,0,1,0,2,9,0,0,
7892,0,0,228,248,0,4,4384,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7915,0,0,229,91,0,4,4396,4,0,1,0,0,1,0,2,9,0,0,
7934,0,0,230,248,0,4,4406,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7957,0,0,231,91,0,4,4418,4,0,1,0,0,1,0,2,9,0,0,
7976,0,0,232,248,0,4,4429,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
7999,0,0,233,91,0,4,4441,4,0,1,0,0,1,0,2,9,0,0,
8018,0,0,234,248,0,4,4452,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
8041,0,0,235,91,0,4,4464,4,0,1,0,0,1,0,2,9,0,0,
8060,0,0,236,248,0,4,4476,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
8083,0,0,237,91,0,4,4488,4,0,1,0,0,1,0,2,9,0,0,
8102,0,0,238,248,0,4,4499,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
8125,0,0,239,91,0,4,4511,4,0,1,0,0,1,0,2,9,0,0,
8144,0,0,240,248,0,4,4522,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
8167,0,0,241,91,0,4,4534,4,0,1,0,0,1,0,2,9,0,0,
8186,0,0,242,248,0,4,4544,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
17,1,0,243,91,0,4,4556,4,0,1,0,0,1,0,2,9,0,0,
36,1,0,244,248,0,4,4567,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
59,1,0,245,91,0,4,4579,4,0,1,0,0,1,0,2,9,0,0,
78,1,0,246,248,0,4,4589,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
101,1,0,247,91,0,4,4601,4,0,1,0,0,1,0,2,9,0,0,
120,1,0,248,248,0,4,4611,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
143,1,0,249,91,0,4,4623,4,0,1,0,0,1,0,2,9,0,0,
162,1,0,250,248,0,4,4633,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
185,1,0,251,91,0,4,4645,4,0,1,0,0,1,0,2,9,0,0,
204,1,0,252,248,0,4,4656,4,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
227,1,0,253,91,0,4,4668,4,0,1,0,0,1,0,2,9,0,0,
246,1,0,254,258,0,4,5123,4,0,8,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,1,9,0,0,1,9,0,0,
293,1,0,255,255,0,4,5145,4,0,7,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,1,9,0,0,
336,1,0,256,95,0,4,5176,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
363,1,0,257,109,0,4,5201,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
390,1,0,258,137,0,4,5209,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
421,1,0,259,189,0,4,5218,4,0,6,5,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,
460,1,0,260,186,0,4,5230,4,0,6,5,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,
499,1,0,261,151,0,4,5255,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
530,1,0,262,233,0,4,5263,4,0,7,6,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,
573,1,0,263,151,0,4,5276,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
604,1,0,264,233,0,4,5284,4,0,7,6,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,
647,1,0,265,122,0,4,5307,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
674,1,0,266,151,0,4,5331,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
705,1,0,267,122,0,4,5354,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
732,1,0,268,202,0,4,5362,4,0,6,5,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,
771,1,0,269,199,0,4,5374,4,0,6,5,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,
810,1,0,270,122,0,4,5398,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
837,1,0,271,151,0,4,5419,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
868,1,0,272,233,0,4,5428,4,0,7,6,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,
911,1,0,273,151,0,4,5441,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
942,1,0,274,233,0,4,5451,4,0,7,6,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,
985,1,0,275,151,0,4,5477,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1016,1,0,276,323,0,4,5502,4,0,6,4,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
1055,1,0,277,113,0,4,5518,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1082,1,0,278,113,0,4,5533,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1109,1,0,279,323,0,4,5564,4,0,6,4,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
1148,1,0,280,113,0,4,5581,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1175,1,0,281,113,0,4,5595,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1202,1,0,282,180,0,4,5673,4,0,8,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,1,9,0,0,1,9,0,0,
1249,1,0,283,95,0,4,5712,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1276,1,0,284,177,0,4,5891,4,0,7,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,1,9,0,0,
1319,1,0,285,95,0,4,5934,4,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
1346,1,0,286,373,0,4,6130,4,0,7,3,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,
1389,1,0,287,264,0,4,6161,4,0,6,3,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
1428,1,0,288,166,0,4,6213,4,0,7,3,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,1,9,0,0,
1471,1,0,289,106,0,4,6253,4,0,3,2,0,1,0,1,9,0,0,2,9,0,0,1,9,0,0,
1498,1,0,290,398,0,4,6274,4,0,12,10,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1561,1,0,291,334,0,4,6298,4,0,11,9,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1620,1,0,292,157,0,4,6321,4,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1651,1,0,293,95,0,4,195,5,0,2,1,0,1,0,1,3,0,0,2,9,0,0,
1674,1,0,294,159,0,6,202,5,0,4,4,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,1,9,0,0,
1705,1,0,295,96,0,4,226,5,0,2,1,0,1,0,1,3,0,0,2,9,0,0,
1728,1,0,296,159,0,6,233,5,0,4,4,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,1,9,0,0,
1759,1,0,297,103,0,4,269,5,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
1782,1,0,298,139,0,4,283,5,0,4,3,0,1,0,2,1,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1813,1,0,299,140,0,4,292,5,0,3,2,0,1,0,2,1,0,0,1,9,0,0,1,9,0,0,
1840,1,0,300,139,0,4,307,5,0,4,3,0,1,0,2,1,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1871,1,0,301,140,0,4,316,5,0,3,2,0,1,0,2,1,0,0,1,9,0,0,1,9,0,0,
1898,1,0,302,196,0,6,335,5,0,3,3,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
1925,1,0,303,210,0,6,360,5,0,3,3,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
1952,1,0,304,167,0,4,453,5,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1983,1,0,305,31,0,4,475,5,0,1,0,0,1,0,2,9,0,0,
2002,1,0,306,31,0,4,482,5,0,1,0,0,1,0,2,9,0,0,
2021,1,0,307,31,0,4,493,5,0,1,0,0,1,0,2,9,0,0,
2040,1,0,308,1278,0,4,504,5,0,23,22,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2147,1,0,309,2750,0,4,566,5,0,40,39,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
4,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,4,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2322,1,0,310,161,0,4,738,5,0,5,4,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2357,1,0,311,134,0,4,746,5,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,3,0,0,
2388,1,0,312,2750,0,4,757,5,0,40,39,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
4,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,4,0,
0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
2563,1,0,313,83,0,4,928,5,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
2586,1,0,314,94,0,4,939,5,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
2609,1,0,315,111,0,4,1043,5,0,4,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,
2640,1,0,316,1218,0,4,1058,5,0,44,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,
0,0,
2831,1,0,317,1218,0,4,1149,5,0,43,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,
3018,1,0,318,1320,0,4,1240,5,0,44,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,1,9,
0,0,
3209,1,0,319,1320,0,4,1330,5,0,43,1,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,
0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,
9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,
0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,1,9,0,0,
3396,1,0,320,338,0,4,1673,5,0,4,2,0,1,0,1,3,0,0,2,9,0,0,2,9,0,0,1,9,0,0,
3427,1,0,321,61,0,6,1965,5,0,2,2,0,1,0,1,97,0,0,2,9,0,0,
3450,1,0,322,126,0,4,2161,5,0,3,2,0,1,0,1,9,0,0,2,9,0,0,1,9,0,0,
3477,1,0,323,51,0,4,2193,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3500,1,0,324,51,0,4,2232,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3523,1,0,325,51,0,4,2268,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3546,1,0,326,51,0,4,2305,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3569,1,0,327,51,0,4,2343,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3592,1,0,328,51,0,4,2369,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3615,1,0,329,51,0,4,2406,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3638,1,0,330,51,0,4,2443,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3661,1,0,331,51,0,4,2481,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
3684,1,0,332,126,0,4,2563,5,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
3707,1,0,333,127,0,4,2570,5,0,1,0,0,1,0,2,9,0,0,
3726,1,0,334,126,0,4,2580,5,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
3749,1,0,335,127,0,4,2587,5,0,1,0,0,1,0,2,9,0,0,
3768,1,0,336,126,0,4,2597,5,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
3791,1,0,337,127,0,4,2604,5,0,1,0,0,1,0,2,9,0,0,
3810,1,0,338,121,0,4,2665,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3837,1,0,339,108,0,4,2688,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3864,1,0,340,105,0,4,2713,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3891,1,0,341,102,0,4,2740,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3918,1,0,342,102,0,4,2768,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3945,1,0,343,102,0,4,2797,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3972,1,0,344,102,0,4,2828,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
3999,1,0,345,44,0,4,2855,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
4022,1,0,346,126,0,4,2870,5,0,3,2,0,1,0,1,9,0,0,2,9,0,0,1,9,0,0,
4049,1,0,347,137,0,4,2904,5,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4080,1,0,348,137,0,4,2945,5,0,4,3,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4111,1,0,349,43,0,4,3003,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
4134,1,0,350,108,0,4,3038,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
4161,1,0,351,94,0,4,3065,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
4188,1,0,352,44,0,4,3074,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
4211,1,0,353,47,0,4,3401,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4238,1,0,354,47,0,4,3419,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4265,1,0,355,47,0,4,3437,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4292,1,0,356,47,0,4,3454,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4319,1,0,357,47,0,4,3471,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4346,1,0,358,47,0,4,3488,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4373,1,0,359,47,0,4,3505,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4400,1,0,360,46,0,4,3521,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,3,0,0,
4427,1,0,361,47,0,4,3538,5,0,2,1,0,1,0,1,9,0,0,2,3,0,0,
4450,1,0,362,46,0,4,3580,5,0,4,3,0,1,0,1,9,0,0,1,9,0,0,1,3,0,0,2,3,0,0,
4481,1,0,363,194,0,6,3652,5,0,3,3,0,1,0,1,9,0,0,1,9,0,0,2,9,0,0,
4508,1,0,364,192,0,6,3683,5,0,8,8,0,1,0,2,3,0,0,1,9,0,0,1,4,0,0,1,9,0,0,1,9,0,
0,1,3,0,0,2,9,0,0,2,9,0,0,
4555,1,0,365,88,0,4,3699,5,0,2,1,0,1,0,1,9,0,0,2,9,0,0,
4578,1,0,366,566,0,6,4237,5,0,2,2,0,1,0,1,9,0,0,2,3,0,0,
4601,1,0,367,338,0,4,4375,5,0,4,2,0,1,0,1,3,0,0,2,9,0,0,2,9,0,0,1,9,0,0,
4632,1,0,368,61,0,6,4652,5,0,2,2,0,1,0,1,97,0,0,2,9,0,0,
4655,1,0,369,195,0,4,4816,5,0,7,2,0,1,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,3,0,
0,1,9,0,0,1,9,0,0,
4698,1,0,370,1236,0,4,4851,5,0,21,20,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4797,1,0,371,1232,0,4,4905,5,0,21,20,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
4896,1,0,372,209,0,6,4974,5,0,11,11,0,1,0,1,9,0,0,3,3,0,0,3,9,0,0,3,3,0,0,3,9,
0,0,3,3,0,0,3,9,0,0,3,3,0,0,3,9,0,0,3,3,0,0,3,3,0,0,
4955,1,0,373,210,0,6,5009,5,0,11,11,0,1,0,1,9,0,0,3,3,0,0,3,9,0,0,3,3,0,0,3,9,
0,0,3,3,0,0,3,9,0,0,3,3,0,0,3,9,0,0,3,3,0,0,3,3,0,0,
5014,1,0,374,2047,0,4,5036,5,0,43,42,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,1,9,0,0,1,1,0,0,1,9,0,0,1,97,0,0,1,9,0,0,1,97,0,0,1,9,0,0,1,97,
0,0,1,9,0,0,1,97,0,0,1,1,0,0,1,9,0,0,1,97,0,0,1,97,0,0,1,9,0,0,1,97,0,0,1,97,0,
0,
5201,1,0,375,2052,0,4,5164,5,0,43,42,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
1,9,0,0,1,9,0,0,1,9,0,0,1,1,0,0,1,9,0,0,1,97,0,0,1,9,0,0,1,97,0,0,1,9,0,0,1,97,
0,0,1,9,0,0,1,97,0,0,1,1,0,0,1,9,0,0,1,97,0,0,1,97,0,0,1,9,0,0,1,97,0,0,1,97,0,
0,
5388,1,0,376,1866,0,4,5290,5,0,37,36,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
4,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,1,0,0,1,9,0,0,1,97,0,0,
1,9,0,0,1,97,0,0,1,9,0,0,1,97,0,0,1,9,0,0,1,97,0,0,1,1,0,0,1,9,0,0,1,97,0,0,1,
97,0,0,1,9,0,0,1,97,0,0,1,97,0,0,
5551,1,0,377,1237,0,4,5368,5,0,19,18,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
5642,1,0,378,1300,0,4,5431,5,0,21,20,0,1,0,2,3,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,
0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,
9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
5741,1,0,379,87,0,4,5576,5,0,3,1,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,
5768,1,0,380,43,0,4,5605,5,0,2,1,0,1,0,1,9,0,0,2,3,0,0,
5791,1,0,381,49,0,4,5608,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
5818,1,0,382,106,0,4,5634,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
5845,1,0,383,76,0,4,5644,5,0,2,1,0,1,0,2,9,0,0,1,9,0,0,
5868,1,0,384,39,0,4,5674,5,0,2,1,0,1,0,1,9,0,0,2,3,0,0,
5891,1,0,385,35,0,4,5677,5,0,2,1,0,1,0,1,3,0,0,2,3,0,0,
5914,1,0,386,43,0,4,5694,5,0,2,1,0,1,0,1,9,0,0,2,3,0,0,
5937,1,0,387,49,0,4,5697,5,0,3,2,0,1,0,1,9,0,0,1,3,0,0,2,9,0,0,
5964,1,0,388,344,0,9,5738,5,0,2,2,0,1,0,1,9,0,0,1,9,0,0,
5987,1,0,388,0,0,15,5754,5,0,0,0,0,1,0,
6002,1,0,388,0,0,13,5787,5,0,6,0,0,1,0,2,4,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,3,0,0,
6041,1,0,389,442,0,9,5850,5,0,3,3,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,
6068,1,0,389,0,0,15,5866,5,0,0,0,0,1,0,
6083,1,0,389,0,0,13,5896,5,0,6,0,0,1,0,2,4,0,0,2,9,0,0,2,9,0,0,2,9,0,0,2,9,0,0,
2,3,0,0,
6122,1,0,390,210,0,4,5934,5,0,4,3,0,1,0,2,4,0,0,1,9,0,0,1,9,0,0,1,9,0,0,
6153,1,0,391,308,0,4,5951,5,0,5,4,0,1,0,2,4,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,
6188,1,0,392,120,0,4,5982,5,0,3,1,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,
6215,1,0,393,125,0,4,5999,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
6242,1,0,394,120,0,4,6078,5,0,3,1,0,1,0,2,9,0,0,2,9,0,0,1,9,0,0,
6269,1,0,395,125,0,4,6096,5,0,3,2,0,1,0,2,9,0,0,1,9,0,0,1,9,0,0,
6296,1,0,396,693,0,9,6199,5,0,6,6,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,
0,1,9,0,0,
6335,1,0,396,0,0,13,6216,5,0,4,0,0,1,0,2,9,0,0,2,9,0,0,2,4,0,0,2,9,0,0,
6366,1,0,396,0,0,15,6244,5,0,0,0,0,1,0,
6381,1,0,397,957,0,9,6298,5,0,5,5,0,1,0,1,9,0,0,1,9,0,0,1,9,0,0,1,9,0,0,1,3,0,
0,
6416,1,0,397,0,0,13,6315,5,0,1,0,0,1,0,2,4,0,0,
6435,1,0,397,0,0,15,6339,5,0,0,0,0,1,0,
};


/************************************************************************/
/************************************************************************/
/* PROGRAM NAME          :	BLRVSBL1.PC									*/
/* AUTHOR                :	K.SARAVANAN									*/
/* DATE WRITTEN          :	14-AUG-2003									*/
/* DATE MODIFIED         :												*/
/* CALLED FROM           :												*/
/*                                                                      */
/* FUNCTION              :	TO PRINT CASH BILL CUM RECEIPT,				*/
/*				PRINT_VISIT_BILL, PRINT_VISIT_BILL_NO_DISC,				*/
/*				PRINT VISIT BILL - NO SETTLEMENT DTLS,					*/
/*																		*/
/* REPORTS				 : PRINT BILL-CUM RECEIPT,PRINT BILL			*/
/*						   PRINT PACKAGE BILL,PRINT DISCOUNT DOCUMENT	*/ 
/************************************************************************/
/* UPGRADED TO 4.1 */

#include <stdio.h>     
#include <string.h> 
#include <process.h>      
#include <bl.h>    

#define OERROR (sqlca.sqlcode < 0)

#define NODATAFOUND sqlca.sqlcode == 1403
#define RESOURCE_BUSY (sqlca.sqlcode == -54)


//#define INIT_MESG "Bill Printing in progress" COMMENETED FOR SCRUM CRF-654
//#define ONLINE_PRINTING 1 COMMENETED FOR SCRUM CRF-654
#define DEBUG  1
#define maxlines 11
#define LEGEND 1
#define LENGTH_WORDS 80 
#define ERR_MESG  4
#define ESC     0x1B

/* EXEC SQL BEGIN DECLARE SECTION; */ 

		
/* VARCHAR nd_fm_doc_type		[31],
		trx_type 			[2],
		uid_pwd      		[132],		
		nd_episode_id 		[9], 
		nd_visit_id 		[5],
		pk_disc_episode_id  [9],   //Rajesh 
		pk_disc_visitid     [5],   //Rajesh
		nd_fm_doc_num		[31],
		nd_to_doc_type		[31],  
		nd_to_doc_num		[31],
		nd_fm_doc_date		[12],
		nd_fm_doc_date1		[12],
		d_cashfacility_id	[3],
		nd_to_doc_date		[31],
		nd_facility_name	[500],
		nd_acc_name			[31],
		nd_facility			[31],
		p_cash_counter		[7],
		p_document_id		[31],
		p_shift				[2],
		nd_pgm_date			[13],
		nd_session_id		[16],
		nd_mpd_id			[40],
		nd_ws_no			[40],
		l_printer_ids		[1000],
		l_printer_names		[1000],
		l_printer_types		[1000],
	    l_queue_names		[1000],
	    l_no_of_copies		[1000],
	    l_errortext			[1000],
		l_logo_yniflaser	[1000],
		LOGO_DIR			[1000],
	    l_logo_name			[1000],
		l_errorlevel		[10],
		l_sysmessageid		[10],		
		currency			[16],
		sub_cur  			[10],
		nn_cc_code			[3],
		nd_curr_date		[20],
		nd_curr_date_t		[20],
		nd_curr_date1_t		[20],
		nd_curr_date1		[12],
		nn_shift_id			[2],
		nn_cc_id			[31],
		nn_cc_name			[16],
		nd_user				[41],
		nd_calling_pgm_id	[10],
		l_nd_calling_pgm_id	[10],
		nd_logo_pgm_id		[1000],
		bill_title			[40],
		nd_printed			[2],
		nd_pat_sex			[20],
		nd_bill_format_id	[2],
		d_folio_batch_id   [100],
		d1_folio_batch_id   [100],
		d_serv_code			[20],
		language_id			[3],
		nd_episode_id_1 		[9]; */ 
struct { unsigned short len; unsigned char arr[31]; } nd_fm_doc_type;

struct { unsigned short len; unsigned char arr[2]; } trx_type;

struct { unsigned short len; unsigned char arr[132]; } uid_pwd;

struct { unsigned short len; unsigned char arr[9]; } nd_episode_id;

struct { unsigned short len; unsigned char arr[5]; } nd_visit_id;

struct { unsigned short len; unsigned char arr[9]; } pk_disc_episode_id;

struct { unsigned short len; unsigned char arr[5]; } pk_disc_visitid;

struct { unsigned short len; unsigned char arr[31]; } nd_fm_doc_num;

struct { unsigned short len; unsigned char arr[31]; } nd_to_doc_type;

struct { unsigned short len; unsigned char arr[31]; } nd_to_doc_num;

struct { unsigned short len; unsigned char arr[12]; } nd_fm_doc_date;

struct { unsigned short len; unsigned char arr[12]; } nd_fm_doc_date1;

struct { unsigned short len; unsigned char arr[3]; } d_cashfacility_id;

struct { unsigned short len; unsigned char arr[31]; } nd_to_doc_date;

struct { unsigned short len; unsigned char arr[500]; } nd_facility_name;

struct { unsigned short len; unsigned char arr[31]; } nd_acc_name;

struct { unsigned short len; unsigned char arr[31]; } nd_facility;

struct { unsigned short len; unsigned char arr[7]; } p_cash_counter;

struct { unsigned short len; unsigned char arr[31]; } p_document_id;

struct { unsigned short len; unsigned char arr[2]; } p_shift;

struct { unsigned short len; unsigned char arr[13]; } nd_pgm_date;

struct { unsigned short len; unsigned char arr[16]; } nd_session_id;

struct { unsigned short len; unsigned char arr[40]; } nd_mpd_id;

struct { unsigned short len; unsigned char arr[40]; } nd_ws_no;

struct { unsigned short len; unsigned char arr[1000]; } l_printer_ids;

struct { unsigned short len; unsigned char arr[1000]; } l_printer_names;

struct { unsigned short len; unsigned char arr[1000]; } l_printer_types;

struct { unsigned short len; unsigned char arr[1000]; } l_queue_names;

struct { unsigned short len; unsigned char arr[1000]; } l_no_of_copies;

struct { unsigned short len; unsigned char arr[1000]; } l_errortext;

struct { unsigned short len; unsigned char arr[1000]; } l_logo_yniflaser;

struct { unsigned short len; unsigned char arr[1000]; } LOGO_DIR;

struct { unsigned short len; unsigned char arr[1000]; } l_logo_name;

struct { unsigned short len; unsigned char arr[10]; } l_errorlevel;

struct { unsigned short len; unsigned char arr[10]; } l_sysmessageid;

struct { unsigned short len; unsigned char arr[16]; } currency;

struct { unsigned short len; unsigned char arr[10]; } sub_cur;

struct { unsigned short len; unsigned char arr[3]; } nn_cc_code;

struct { unsigned short len; unsigned char arr[20]; } nd_curr_date;

struct { unsigned short len; unsigned char arr[20]; } nd_curr_date_t;

struct { unsigned short len; unsigned char arr[20]; } nd_curr_date1_t;

struct { unsigned short len; unsigned char arr[12]; } nd_curr_date1;

struct { unsigned short len; unsigned char arr[2]; } nn_shift_id;

struct { unsigned short len; unsigned char arr[31]; } nn_cc_id;

struct { unsigned short len; unsigned char arr[16]; } nn_cc_name;

struct { unsigned short len; unsigned char arr[41]; } nd_user;

struct { unsigned short len; unsigned char arr[10]; } nd_calling_pgm_id;

struct { unsigned short len; unsigned char arr[10]; } l_nd_calling_pgm_id;

struct { unsigned short len; unsigned char arr[1000]; } nd_logo_pgm_id;

struct { unsigned short len; unsigned char arr[40]; } bill_title;

struct { unsigned short len; unsigned char arr[2]; } nd_printed;

struct { unsigned short len; unsigned char arr[20]; } nd_pat_sex;

struct { unsigned short len; unsigned char arr[2]; } nd_bill_format_id;

struct { unsigned short len; unsigned char arr[100]; } d_folio_batch_id;

struct { unsigned short len; unsigned char arr[100]; } d1_folio_batch_id;

struct { unsigned short len; unsigned char arr[20]; } d_serv_code;

struct { unsigned short len; unsigned char arr[3]; } language_id;

struct { unsigned short len; unsigned char arr[9]; } nd_episode_id_1;
 //added for scrum crf-654

/* VARCHAR		
		d_trx_doc_ref			[61],
		d_trx_doc_ref_line_num	[9],
		d_trx_doc_ref_seq_num	[5],
		d_cust_code				[25],
		d_cust_group_code		[4], 
		d2_cust_code			[25],
		d2_cust_group_code		[4], 
		nd_cust_code			[25],
		d_blng_serv_code		[31],
		nd_blng_serv_code		[31],
		d_mapping_code_ind		[3],
		d_mapping_code			[12],
		d_serv_anal_grp	    	[31],
		nd_serv_anal_grp		[31],
		d_serv_item_code		[61],
		d_serv_item_desc		[61],
		d_payer_serv_grp_hdr	[7],
		d_payer_serv_grp_line	[7],
		d_prt_grp_hdr_code		[7],
		d_prt_grp_line_code		[7],
		d_bill_doc_type_code	[18],
		d_bill_doc_num			[9],
		nd_bill_doc_type_code	[18],		 //crf-659
		nd_bill_doc_num			[9],		 //crf-659
		nd_bill_doc_type_code1	[18],		 //crf-659
		nd_bill_doc_num1		[9],		 //crf-659
		nd_bill_doc_type_code2	[18],		 //crf-659
		nd_bill_doc_num2		[9],		 //crf-659
		d_patient_deposit_num	[40],
		d_patient_deposit_sett	[40],
		d_ent_item_grp_code		[13],
		d_payer_item_grp_code	[7],
		d_print_seq				[5],
		d_grp_ind				[4],
		d1_grp_ind              [4],
		nd_grp_ind				[4],
		d_summary_dtl_ind		[7],
		d_package_trx_yn		[2],
		nd_package_trx_yn		[2],
		nd_summary_dtl_ind		[7],
		d_episode_type			[2],
		d_episode_id			[9],
		nd_episode				[9],
		d_visit_id				[5],	
		d_patient_id			[61],
		d_date_of_birth			[31],
		d_gender				[2],
		d_gender_desc			[100],
		d_encounter_id			[13],
		d_cust_code1			[25],
		d1_doc_type				[25],
	    d1_doc_number			[50],
		d1_doc_date				[20],
		d1_doc_date1			[20],
		d1_doc_type_num			[100],
		nd_mpi_id				[40],
		d_int_bill_prv_doc_type_code[25],
		d_int_bill_prv_doc_number[50],
		d_payer_serv_grp_cust_code[10], //Added for merging walkthrough corrections
		d_payer_serv_grp_pat_class[5],
		d_payer_item_grp_cust_code[10],
		d_payer_item_grp_pat_class[5],
		d1_payer_serv_grp_cust_code[10],
		d1_payer_serv_grp_pat_class[5],
		d1_payer_item_grp_cust_code[10],
		d1_payer_item_grp_pat_class[5], //upto here Added for merging walkthrough corrections

		nd_cust_code1			[25],
		nd_cust_cd1				[25],
		nd_prt_grp_hdr_code		[7],
		nd_prt_grp_line_code	[7],
		nd_ref_prt_grp_hdr_code [7],
		nd_ref_prt_grp_line_code [7],
		nd_prt_hd_desc			 [46],
		d_prev_grp_desc			 [100],	
		nd_prt_line_desc		 [46],
		nd_blng_desc			 [81],
		d_Policy_type_code		 [21],
		l_Policy_type_desc		 [300],
		alt_id_type				 [5],
		alt_id_no			     [30],
		patient_name			 [100],
		disc_doc_appl_ind		 [2],
		l_alt_id_type_desc		 [300],
		nd_blng_desc1			 [61],
		nd_mapping_code_desc	 [46],
		nd1_mapping_code_desc	 [46],
		d_customer			     [46],
		d_oth_doc_type_code		 [100],
		d_oth_cust_code			 [20],
		d_oth_cust_desc			 [200],
		d_oth_cust_group_code	 [20],
		d_oth_policy_code		 [50],
		d_oth_policy_number			 [50],
		d_oth_group_code		 [200],
		d1_oth_group_code		 [200],
		nd_pkg_serv_code		[30], //rajesh
		d_pk_trx_doc_ref			[61],
		d_pk_trx_doc_ref_line_num	[9],
		d_pk_trx_doc_ref_seq_num	[5],
		nd_pkg_serv_dt			[30],
		nd_mapping_code_ind		[2],
		nd_serv_anal_group		[30],
		nd_serv_item_code		[30],
		nd_serv_item_desc		[101],
		nd_payer_serv_group_hdr	[101],
		nd_payer_serv_group_line [101],
		nd_prt_group_hdr_code	[7],
		nd_prt_grp_hdr_code_old [7],
		nd_prt_grp_lin_code_old [101],
		nd_prt_group_line_code [101],
		nd_ent_item_grp_code   [101],  
		nd_payer_item_grp_code	[101],
		nd_detail_report		[101],
		v_package_trx_yn		[2], 
		PkgPrintedYN			[2], 				
		pk_disc_pack_code       [10],  //Rajesh The below variables are defined for package discount 
		pk_disc_pat_id			[61],
		pk_disc_episode_type    [3],
		pk_disc_blng_grp_id     [5],
		pk_disc_usr_id          [40],
		pk_disc_wsno			[40],
			//upto here
		d_customer1			     [46],
		d_customer2			     [46],
		d_customer3			     [46],
		nd_cust_nm				 [46],
		cur_str					[8],
		sub_cur_str				[8],
		d_bank_name				[60],
		d_bank_code				[25],
		d1_last_col_trx_yn		[20],  //Rajesh
		d_last_col_trx_yn		[20],  //Rajesh
		//added by rajesh for package_approval & Package Refund

		d_pk_short_desc			[101],
		d_pk_credit_auth_ref	[21],
		d_pk_credit_auth_dt		[30],
	
		d_pkg_desc				[41],
		d_doc_ref				[21],
		d_pkg_ref_doc_date		[30],

		d1_pkg_desc				[41],
		d1_doc_ref				[21],
		d1_pkg_ref_doc_date		[30],

		d_payer_serv_group_line [30], //IN22491
		d_payer_serv_group_hdr  [30],
		d_service_dt			[30],
		d1_payer_serv_group_line [30], 
		d1_payer_serv_group_hdr  [30],
		d1_service_dt			[30], //IN22491

		leg_cust				 [70],
		v_patient_id			[61]; */ 
struct { unsigned short len; unsigned char arr[61]; } d_trx_doc_ref;

struct { unsigned short len; unsigned char arr[9]; } d_trx_doc_ref_line_num;

struct { unsigned short len; unsigned char arr[5]; } d_trx_doc_ref_seq_num;

struct { unsigned short len; unsigned char arr[25]; } d_cust_code;

struct { unsigned short len; unsigned char arr[4]; } d_cust_group_code;

struct { unsigned short len; unsigned char arr[25]; } d2_cust_code;

struct { unsigned short len; unsigned char arr[4]; } d2_cust_group_code;

struct { unsigned short len; unsigned char arr[25]; } nd_cust_code;

struct { unsigned short len; unsigned char arr[31]; } d_blng_serv_code;

struct { unsigned short len; unsigned char arr[31]; } nd_blng_serv_code;

struct { unsigned short len; unsigned char arr[3]; } d_mapping_code_ind;

struct { unsigned short len; unsigned char arr[12]; } d_mapping_code;

struct { unsigned short len; unsigned char arr[31]; } d_serv_anal_grp;

struct { unsigned short len; unsigned char arr[31]; } nd_serv_anal_grp;

struct { unsigned short len; unsigned char arr[61]; } d_serv_item_code;

struct { unsigned short len; unsigned char arr[61]; } d_serv_item_desc;

struct { unsigned short len; unsigned char arr[7]; } d_payer_serv_grp_hdr;

struct { unsigned short len; unsigned char arr[7]; } d_payer_serv_grp_line;

struct { unsigned short len; unsigned char arr[7]; } d_prt_grp_hdr_code;

struct { unsigned short len; unsigned char arr[7]; } d_prt_grp_line_code;

struct { unsigned short len; unsigned char arr[18]; } d_bill_doc_type_code;

struct { unsigned short len; unsigned char arr[9]; } d_bill_doc_num;

struct { unsigned short len; unsigned char arr[18]; } nd_bill_doc_type_code;

struct { unsigned short len; unsigned char arr[9]; } nd_bill_doc_num;

struct { unsigned short len; unsigned char arr[18]; } nd_bill_doc_type_code1;

struct { unsigned short len; unsigned char arr[9]; } nd_bill_doc_num1;

struct { unsigned short len; unsigned char arr[18]; } nd_bill_doc_type_code2;

struct { unsigned short len; unsigned char arr[9]; } nd_bill_doc_num2;

struct { unsigned short len; unsigned char arr[40]; } d_patient_deposit_num;

struct { unsigned short len; unsigned char arr[40]; } d_patient_deposit_sett;

struct { unsigned short len; unsigned char arr[13]; } d_ent_item_grp_code;

struct { unsigned short len; unsigned char arr[7]; } d_payer_item_grp_code;

struct { unsigned short len; unsigned char arr[5]; } d_print_seq;

struct { unsigned short len; unsigned char arr[4]; } d_grp_ind;

struct { unsigned short len; unsigned char arr[4]; } d1_grp_ind;

struct { unsigned short len; unsigned char arr[4]; } nd_grp_ind;

struct { unsigned short len; unsigned char arr[7]; } d_summary_dtl_ind;

struct { unsigned short len; unsigned char arr[2]; } d_package_trx_yn;

struct { unsigned short len; unsigned char arr[2]; } nd_package_trx_yn;

struct { unsigned short len; unsigned char arr[7]; } nd_summary_dtl_ind;

struct { unsigned short len; unsigned char arr[2]; } d_episode_type;

struct { unsigned short len; unsigned char arr[9]; } d_episode_id;

struct { unsigned short len; unsigned char arr[9]; } nd_episode;

struct { unsigned short len; unsigned char arr[5]; } d_visit_id;

struct { unsigned short len; unsigned char arr[61]; } d_patient_id;

struct { unsigned short len; unsigned char arr[31]; } d_date_of_birth;

struct { unsigned short len; unsigned char arr[2]; } d_gender;

struct { unsigned short len; unsigned char arr[100]; } d_gender_desc;

struct { unsigned short len; unsigned char arr[13]; } d_encounter_id;

struct { unsigned short len; unsigned char arr[25]; } d_cust_code1;

struct { unsigned short len; unsigned char arr[25]; } d1_doc_type;

struct { unsigned short len; unsigned char arr[50]; } d1_doc_number;

struct { unsigned short len; unsigned char arr[20]; } d1_doc_date;

struct { unsigned short len; unsigned char arr[20]; } d1_doc_date1;

struct { unsigned short len; unsigned char arr[100]; } d1_doc_type_num;

struct { unsigned short len; unsigned char arr[40]; } nd_mpi_id;

struct { unsigned short len; unsigned char arr[25]; } d_int_bill_prv_doc_type_code;

struct { unsigned short len; unsigned char arr[50]; } d_int_bill_prv_doc_number;

struct { unsigned short len; unsigned char arr[10]; } d_payer_serv_grp_cust_code;

struct { unsigned short len; unsigned char arr[5]; } d_payer_serv_grp_pat_class;

struct { unsigned short len; unsigned char arr[10]; } d_payer_item_grp_cust_code;

struct { unsigned short len; unsigned char arr[5]; } d_payer_item_grp_pat_class;

struct { unsigned short len; unsigned char arr[10]; } d1_payer_serv_grp_cust_code;

struct { unsigned short len; unsigned char arr[5]; } d1_payer_serv_grp_pat_class;

struct { unsigned short len; unsigned char arr[10]; } d1_payer_item_grp_cust_code;

struct { unsigned short len; unsigned char arr[5]; } d1_payer_item_grp_pat_class;

struct { unsigned short len; unsigned char arr[25]; } nd_cust_code1;

struct { unsigned short len; unsigned char arr[25]; } nd_cust_cd1;

struct { unsigned short len; unsigned char arr[7]; } nd_prt_grp_hdr_code;

struct { unsigned short len; unsigned char arr[7]; } nd_prt_grp_line_code;

struct { unsigned short len; unsigned char arr[7]; } nd_ref_prt_grp_hdr_code;

struct { unsigned short len; unsigned char arr[7]; } nd_ref_prt_grp_line_code;

struct { unsigned short len; unsigned char arr[46]; } nd_prt_hd_desc;

struct { unsigned short len; unsigned char arr[100]; } d_prev_grp_desc;

struct { unsigned short len; unsigned char arr[46]; } nd_prt_line_desc;

struct { unsigned short len; unsigned char arr[81]; } nd_blng_desc;

struct { unsigned short len; unsigned char arr[21]; } d_Policy_type_code;

struct { unsigned short len; unsigned char arr[300]; } l_Policy_type_desc;

struct { unsigned short len; unsigned char arr[5]; } alt_id_type;

struct { unsigned short len; unsigned char arr[30]; } alt_id_no;

struct { unsigned short len; unsigned char arr[100]; } patient_name;

struct { unsigned short len; unsigned char arr[2]; } disc_doc_appl_ind;

struct { unsigned short len; unsigned char arr[300]; } l_alt_id_type_desc;

struct { unsigned short len; unsigned char arr[61]; } nd_blng_desc1;

struct { unsigned short len; unsigned char arr[46]; } nd_mapping_code_desc;

struct { unsigned short len; unsigned char arr[46]; } nd1_mapping_code_desc;

struct { unsigned short len; unsigned char arr[46]; } d_customer;

struct { unsigned short len; unsigned char arr[100]; } d_oth_doc_type_code;

struct { unsigned short len; unsigned char arr[20]; } d_oth_cust_code;

struct { unsigned short len; unsigned char arr[200]; } d_oth_cust_desc;

struct { unsigned short len; unsigned char arr[20]; } d_oth_cust_group_code;

struct { unsigned short len; unsigned char arr[50]; } d_oth_policy_code;

struct { unsigned short len; unsigned char arr[50]; } d_oth_policy_number;

struct { unsigned short len; unsigned char arr[200]; } d_oth_group_code;

struct { unsigned short len; unsigned char arr[200]; } d1_oth_group_code;

struct { unsigned short len; unsigned char arr[30]; } nd_pkg_serv_code;

struct { unsigned short len; unsigned char arr[61]; } d_pk_trx_doc_ref;

struct { unsigned short len; unsigned char arr[9]; } d_pk_trx_doc_ref_line_num;

struct { unsigned short len; unsigned char arr[5]; } d_pk_trx_doc_ref_seq_num;

struct { unsigned short len; unsigned char arr[30]; } nd_pkg_serv_dt;

struct { unsigned short len; unsigned char arr[2]; } nd_mapping_code_ind;

struct { unsigned short len; unsigned char arr[30]; } nd_serv_anal_group;

struct { unsigned short len; unsigned char arr[30]; } nd_serv_item_code;

struct { unsigned short len; unsigned char arr[101]; } nd_serv_item_desc;

struct { unsigned short len; unsigned char arr[101]; } nd_payer_serv_group_hdr;

struct { unsigned short len; unsigned char arr[101]; } nd_payer_serv_group_line;

struct { unsigned short len; unsigned char arr[7]; } nd_prt_group_hdr_code;

struct { unsigned short len; unsigned char arr[7]; } nd_prt_grp_hdr_code_old;

struct { unsigned short len; unsigned char arr[101]; } nd_prt_grp_lin_code_old;

struct { unsigned short len; unsigned char arr[101]; } nd_prt_group_line_code;

struct { unsigned short len; unsigned char arr[101]; } nd_ent_item_grp_code;

struct { unsigned short len; unsigned char arr[101]; } nd_payer_item_grp_code;

struct { unsigned short len; unsigned char arr[101]; } nd_detail_report;

struct { unsigned short len; unsigned char arr[2]; } v_package_trx_yn;

struct { unsigned short len; unsigned char arr[2]; } PkgPrintedYN;

struct { unsigned short len; unsigned char arr[10]; } pk_disc_pack_code;

struct { unsigned short len; unsigned char arr[61]; } pk_disc_pat_id;

struct { unsigned short len; unsigned char arr[3]; } pk_disc_episode_type;

struct { unsigned short len; unsigned char arr[5]; } pk_disc_blng_grp_id;

struct { unsigned short len; unsigned char arr[40]; } pk_disc_usr_id;

struct { unsigned short len; unsigned char arr[40]; } pk_disc_wsno;

struct { unsigned short len; unsigned char arr[46]; } d_customer1;

struct { unsigned short len; unsigned char arr[46]; } d_customer2;

struct { unsigned short len; unsigned char arr[46]; } d_customer3;

struct { unsigned short len; unsigned char arr[46]; } nd_cust_nm;

struct { unsigned short len; unsigned char arr[8]; } cur_str;

struct { unsigned short len; unsigned char arr[8]; } sub_cur_str;

struct { unsigned short len; unsigned char arr[60]; } d_bank_name;

struct { unsigned short len; unsigned char arr[25]; } d_bank_code;

struct { unsigned short len; unsigned char arr[20]; } d1_last_col_trx_yn;

struct { unsigned short len; unsigned char arr[20]; } d_last_col_trx_yn;

struct { unsigned short len; unsigned char arr[101]; } d_pk_short_desc;

struct { unsigned short len; unsigned char arr[21]; } d_pk_credit_auth_ref;

struct { unsigned short len; unsigned char arr[30]; } d_pk_credit_auth_dt;

struct { unsigned short len; unsigned char arr[41]; } d_pkg_desc;

struct { unsigned short len; unsigned char arr[21]; } d_doc_ref;

struct { unsigned short len; unsigned char arr[30]; } d_pkg_ref_doc_date;

struct { unsigned short len; unsigned char arr[41]; } d1_pkg_desc;

struct { unsigned short len; unsigned char arr[21]; } d1_doc_ref;

struct { unsigned short len; unsigned char arr[30]; } d1_pkg_ref_doc_date;

struct { unsigned short len; unsigned char arr[30]; } d_payer_serv_group_line;

struct { unsigned short len; unsigned char arr[30]; } d_payer_serv_group_hdr;

struct { unsigned short len; unsigned char arr[30]; } d_service_dt;

struct { unsigned short len; unsigned char arr[30]; } d1_payer_serv_group_line;

struct { unsigned short len; unsigned char arr[30]; } d1_payer_serv_group_hdr;

struct { unsigned short len; unsigned char arr[30]; } d1_service_dt;

struct { unsigned short len; unsigned char arr[70]; } leg_cust;

struct { unsigned short len; unsigned char arr[61]; } v_patient_id;
 //ADDED FOR SCRUM CRF-654

		/* VARCHAR l_mpi_id[50]; */ 
struct { unsigned short len; unsigned char arr[50]; } l_mpi_id;

		/* VARCHAR l_blng_grp[5]; */ 
struct { unsigned short len; unsigned char arr[5]; } l_blng_grp;

		/* VARCHAR l_pakage_yn[2]; */ 
struct { unsigned short len; unsigned char arr[2]; } l_pakage_yn;


/* VARCHAR	  d_trade_name	[100],
		  d_batch_name  [100],
		  d_exp_dt		[20],
		  d_loc_code	[100]; */ 
struct { unsigned short len; unsigned char arr[100]; } d_trade_name;

struct { unsigned short len; unsigned char arr[100]; } d_batch_name;

struct { unsigned short len; unsigned char arr[20]; } d_exp_dt;

struct { unsigned short len; unsigned char arr[100]; } d_loc_code;



/* VARCHAR		p_pract_name_incexc_ind		[2],
			pract_name_in_dtlformat_ind [2],
			p_pract_name_incexc_ind_ent	[2],
			d_print_pract_name_ind		[2],
			d_pract_name_ind			[2],
			d1_print_pract_name_ind			[2],
			d1_pract_name_ind			[2]; */ 
struct { unsigned short len; unsigned char arr[2]; } p_pract_name_incexc_ind;

struct { unsigned short len; unsigned char arr[2]; } pract_name_in_dtlformat_ind;

struct { unsigned short len; unsigned char arr[2]; } p_pract_name_incexc_ind_ent;

struct { unsigned short len; unsigned char arr[2]; } d_print_pract_name_ind;

struct { unsigned short len; unsigned char arr[2]; } d_pract_name_ind;

struct { unsigned short len; unsigned char arr[2]; } d1_print_pract_name_ind;

struct { unsigned short len; unsigned char arr[2]; } d1_pract_name_ind;


/* VARCHAR	
		p_err_level				[10],
		p_sys_message_id		[10],
		p_error_text			[200],
		ar_cust					[46]; */ 
struct { unsigned short len; unsigned char arr[10]; } p_err_level;

struct { unsigned short len; unsigned char arr[10]; } p_sys_message_id;

struct { unsigned short len; unsigned char arr[200]; } p_error_text;

struct { unsigned short len; unsigned char arr[46]; } ar_cust;

	
/* VARCHAR	
		d1_trx_doc_ref			[61],
		d1_trx_doc_ref_line_num	[9],
		d1_trx_doc_ref_seq_num	[5],
		d_copy_cust_code		[10],
		d1_cust_code			[25],
		nd1_cust_code			[25],
		d1_blng_serv_code		[31],
		d1_mapping_code_ind		[3],
		d1_mapping_code			[12],
		nd1_blng_serv_code		[31],
		nd2_blng_serv_code		[31],
		d1_serv_anal_grp		[31],
		nd1_serv_anal_grp		[31],
		nd2_serv_anal_grp		[31],
		d1_serv_item_code		[61],
		d1_serv_item_desc		[61],
		d1_payer_serv_grp_hdr	[7],
		d1_payer_serv_grp_line	[7],
		d1_prt_grp_hdr_code		[7],
		d1_prt_grp_line_code	[7],
		d1_bill_doc_type_code	[18],
		d1_bill_doc_num			[9],
		d1_ent_item_grp_code	[13],
		d1_payer_item_grp_code	[7],
		d1_print_seq			[5],
		d1_summary_dtl_ind		[7],
		d1_package_trx_yn		[2],
		nd1_package_trx_yn		[2],
		nd1_summary_dtl_ind		[7],
		nd2_summary_dtl_ind		[7],
		d1_episode_type			[2],
		d1_episode_id			[9],
		d1_visit_id				[5],	
		d1_patient_id			[61],
		d1_encounter_id			[13],
		d1_cust_code1			[25],
		nd1_cust_code1			[25],
		dp_cust_code			[25],
		nd1_prt_grp_hdr_code	[7],
		nd1_prt_grp_line_code	[7],
		nd1_payer_serv_grp_hdr	[30],
		nd_payer_serv_grp_hdr	[30],
		nd1_payer_serv_grp_line	[30],
		nd_payer_serv_grp_line	[30],
		nd1_ent_item_grp_code   [30], //added for walkthrough corrections
		nd1_payer_item_grp_code [30],//upto here added for walkthrough corrections
        d_adm_rec_flag			[2],
		d_acct_seq_no			[4],
		nd1_trx_doc_ref			[61],
		d_patient_deposit_date	[50],
		nd1_trx_doc_ref_line_num[61],
		nd_trx_doc_ref			[61],
		l_only_print_discount   [2], //added by vani
		nd_trx_doc_ref_line_num[61]; */ 
struct { unsigned short len; unsigned char arr[61]; } d1_trx_doc_ref;

struct { unsigned short len; unsigned char arr[9]; } d1_trx_doc_ref_line_num;

struct { unsigned short len; unsigned char arr[5]; } d1_trx_doc_ref_seq_num;

struct { unsigned short len; unsigned char arr[10]; } d_copy_cust_code;

struct { unsigned short len; unsigned char arr[25]; } d1_cust_code;

struct { unsigned short len; unsigned char arr[25]; } nd1_cust_code;

struct { unsigned short len; unsigned char arr[31]; } d1_blng_serv_code;

struct { unsigned short len; unsigned char arr[3]; } d1_mapping_code_ind;

struct { unsigned short len; unsigned char arr[12]; } d1_mapping_code;

struct { unsigned short len; unsigned char arr[31]; } nd1_blng_serv_code;

struct { unsigned short len; unsigned char arr[31]; } nd2_blng_serv_code;

struct { unsigned short len; unsigned char arr[31]; } d1_serv_anal_grp;

struct { unsigned short len; unsigned char arr[31]; } nd1_serv_anal_grp;

struct { unsigned short len; unsigned char arr[31]; } nd2_serv_anal_grp;

struct { unsigned short len; unsigned char arr[61]; } d1_serv_item_code;

struct { unsigned short len; unsigned char arr[61]; } d1_serv_item_desc;

struct { unsigned short len; unsigned char arr[7]; } d1_payer_serv_grp_hdr;

struct { unsigned short len; unsigned char arr[7]; } d1_payer_serv_grp_line;

struct { unsigned short len; unsigned char arr[7]; } d1_prt_grp_hdr_code;

struct { unsigned short len; unsigned char arr[7]; } d1_prt_grp_line_code;

struct { unsigned short len; unsigned char arr[18]; } d1_bill_doc_type_code;

struct { unsigned short len; unsigned char arr[9]; } d1_bill_doc_num;

struct { unsigned short len; unsigned char arr[13]; } d1_ent_item_grp_code;

struct { unsigned short len; unsigned char arr[7]; } d1_payer_item_grp_code;

struct { unsigned short len; unsigned char arr[5]; } d1_print_seq;

struct { unsigned short len; unsigned char arr[7]; } d1_summary_dtl_ind;

struct { unsigned short len; unsigned char arr[2]; } d1_package_trx_yn;

struct { unsigned short len; unsigned char arr[2]; } nd1_package_trx_yn;

struct { unsigned short len; unsigned char arr[7]; } nd1_summary_dtl_ind;

struct { unsigned short len; unsigned char arr[7]; } nd2_summary_dtl_ind;

struct { unsigned short len; unsigned char arr[2]; } d1_episode_type;

struct { unsigned short len; unsigned char arr[9]; } d1_episode_id;

struct { unsigned short len; unsigned char arr[5]; } d1_visit_id;

struct { unsigned short len; unsigned char arr[61]; } d1_patient_id;

struct { unsigned short len; unsigned char arr[13]; } d1_encounter_id;

struct { unsigned short len; unsigned char arr[25]; } d1_cust_code1;

struct { unsigned short len; unsigned char arr[25]; } nd1_cust_code1;

struct { unsigned short len; unsigned char arr[25]; } dp_cust_code;

struct { unsigned short len; unsigned char arr[7]; } nd1_prt_grp_hdr_code;

struct { unsigned short len; unsigned char arr[7]; } nd1_prt_grp_line_code;

struct { unsigned short len; unsigned char arr[30]; } nd1_payer_serv_grp_hdr;

struct { unsigned short len; unsigned char arr[30]; } nd_payer_serv_grp_hdr;

struct { unsigned short len; unsigned char arr[30]; } nd1_payer_serv_grp_line;

struct { unsigned short len; unsigned char arr[30]; } nd_payer_serv_grp_line;

struct { unsigned short len; unsigned char arr[30]; } nd1_ent_item_grp_code;

struct { unsigned short len; unsigned char arr[30]; } nd1_payer_item_grp_code;

struct { unsigned short len; unsigned char arr[2]; } d_adm_rec_flag;

struct { unsigned short len; unsigned char arr[4]; } d_acct_seq_no;

struct { unsigned short len; unsigned char arr[61]; } nd1_trx_doc_ref;

struct { unsigned short len; unsigned char arr[50]; } d_patient_deposit_date;

struct { unsigned short len; unsigned char arr[61]; } nd1_trx_doc_ref_line_num;

struct { unsigned short len; unsigned char arr[61]; } nd_trx_doc_ref;

struct { unsigned short len; unsigned char arr[2]; } l_only_print_discount;

struct { unsigned short len; unsigned char arr[61]; } nd_trx_doc_ref_line_num;



/* VARCHAR p_gross_net_amt_ind				[4],              
		p_serv_disc_on_gross_ind		[4],        
		p_all_oth_adj_amt_row_ind		[4],     
		p_bill_disc_sep_row_yn			[4],     
		p_bill_adj_sep_row_yn			[4],     
		p_bill_exm_sep_row_yn			[4],     
		p_bill_wo_sep_row_yn			[4],     
		p_oth_payers_amt_print_row_ind  [4], 
		p_patient_amt_print_row_ind		[4],   
		p_bill_net_payable_ind			[4], 
		p_addl_charge_amt_ind			[4],
		p_excl_addl_charge_yn			[4],
		p_servdate_in_dtlformat_yn		[2],
		p_disc_amt_in_dtl_yn			[2],  
		c_gross_net_amt_ind				[4],   
		c_serv_disc_on_gross_ind		[4], 
		c_reim_amt_ind					[4],
		c_non_reim_amt_ind				[4],  
		c_all_oth_adj_amt_ind			[4],   
		c_bill_disc_sep_row_yn			[4],   
		c_bill_adj_sep_row_yn			[4],   
		c_bill_exm_sep_row_yn			[4],   
		c_bill_wo_sep_row_yn			[4],   
		c_oth_payers_amt_print_row_ind	[4],  
		c_bill_subsidized_amt_ind		[4],  
		c_bill_net_payable_ind			[4],  
		c_addl_charge_amt_ind			[4],
		c_excl_addl_charge_yn			[4],
		c_servdate_in_dtlformat_yn		[2],
		c_disc_amt_in_dtl_yn			[2],
		status							[4],
		c_print_serv_date_with_time_yn  [2],
		c_print_zero_other_adj_yn		[2],	
		c_print_zero_disc_column_yn		[2],	
		c_qty_in_dtlformat_yn			[2],
		c_rate_in_dtlformat_yn			[2],		
		p_print_serv_date_with_time_yn	[2],
		p_print_zero_other_adj_yn		[2],	
		p_print_zero_disc_column_yn		[2],
		p_qty_in_dtlformat_yn			[2],	
		p_rate_in_dtlformat_yn			[2],
		p_print_zero_adcharg_column_yn	[2],
		p_bill_addl_id_in_ftr_yn		[2],
		p_serv_desc_sep_line_yn			[2],
		c_serv_desc_sep_line_yn			[2],
		p_print_separator_line			[2],
		c_print_separator_line			[2],
		p_print_legend_yn				[2],
		c_print_legend_yn				[2],
		c_print_zero_adcharg_column_yn  [2],
		p_pract_name_in_dtlformat_ind	[2],
		c_pract_name_in_dtlformat_ind	[2],
		c_print_zero_subsid_column_yn	[2]; */ 
struct { unsigned short len; unsigned char arr[4]; } p_gross_net_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } p_serv_disc_on_gross_ind;

struct { unsigned short len; unsigned char arr[4]; } p_all_oth_adj_amt_row_ind;

struct { unsigned short len; unsigned char arr[4]; } p_bill_disc_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } p_bill_adj_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } p_bill_exm_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } p_bill_wo_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } p_oth_payers_amt_print_row_ind;

struct { unsigned short len; unsigned char arr[4]; } p_patient_amt_print_row_ind;

struct { unsigned short len; unsigned char arr[4]; } p_bill_net_payable_ind;

struct { unsigned short len; unsigned char arr[4]; } p_addl_charge_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } p_excl_addl_charge_yn;

struct { unsigned short len; unsigned char arr[2]; } p_servdate_in_dtlformat_yn;

struct { unsigned short len; unsigned char arr[2]; } p_disc_amt_in_dtl_yn;

struct { unsigned short len; unsigned char arr[4]; } c_gross_net_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } c_serv_disc_on_gross_ind;

struct { unsigned short len; unsigned char arr[4]; } c_reim_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } c_non_reim_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } c_all_oth_adj_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } c_bill_disc_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } c_bill_adj_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } c_bill_exm_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } c_bill_wo_sep_row_yn;

struct { unsigned short len; unsigned char arr[4]; } c_oth_payers_amt_print_row_ind;

struct { unsigned short len; unsigned char arr[4]; } c_bill_subsidized_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } c_bill_net_payable_ind;

struct { unsigned short len; unsigned char arr[4]; } c_addl_charge_amt_ind;

struct { unsigned short len; unsigned char arr[4]; } c_excl_addl_charge_yn;

struct { unsigned short len; unsigned char arr[2]; } c_servdate_in_dtlformat_yn;

struct { unsigned short len; unsigned char arr[2]; } c_disc_amt_in_dtl_yn;

struct { unsigned short len; unsigned char arr[4]; } status;

struct { unsigned short len; unsigned char arr[2]; } c_print_serv_date_with_time_yn;

struct { unsigned short len; unsigned char arr[2]; } c_print_zero_other_adj_yn;

struct { unsigned short len; unsigned char arr[2]; } c_print_zero_disc_column_yn;

struct { unsigned short len; unsigned char arr[2]; } c_qty_in_dtlformat_yn;

struct { unsigned short len; unsigned char arr[2]; } c_rate_in_dtlformat_yn;

struct { unsigned short len; unsigned char arr[2]; } p_print_serv_date_with_time_yn;

struct { unsigned short len; unsigned char arr[2]; } p_print_zero_other_adj_yn;

struct { unsigned short len; unsigned char arr[2]; } p_print_zero_disc_column_yn;

struct { unsigned short len; unsigned char arr[2]; } p_qty_in_dtlformat_yn;

struct { unsigned short len; unsigned char arr[2]; } p_rate_in_dtlformat_yn;

struct { unsigned short len; unsigned char arr[2]; } p_print_zero_adcharg_column_yn;

struct { unsigned short len; unsigned char arr[2]; } p_bill_addl_id_in_ftr_yn;

struct { unsigned short len; unsigned char arr[2]; } p_serv_desc_sep_line_yn;

struct { unsigned short len; unsigned char arr[2]; } c_serv_desc_sep_line_yn;

struct { unsigned short len; unsigned char arr[2]; } p_print_separator_line;

struct { unsigned short len; unsigned char arr[2]; } c_print_separator_line;

struct { unsigned short len; unsigned char arr[2]; } p_print_legend_yn;

struct { unsigned short len; unsigned char arr[2]; } c_print_legend_yn;

struct { unsigned short len; unsigned char arr[2]; } c_print_zero_adcharg_column_yn;

struct { unsigned short len; unsigned char arr[2]; } p_pract_name_in_dtlformat_ind;

struct { unsigned short len; unsigned char arr[2]; } c_pract_name_in_dtlformat_ind;

struct { unsigned short len; unsigned char arr[2]; } c_print_zero_subsid_column_yn;


/* varchar		original_text					[101],   //for crf-659
			copy_text						[101],
			bill_title_line1				[101],	
			bill_title_line2				[101],
			bill_title_line3				[101],
			bill_title_line4				[101],	
		    op_cash_bill_title_w_rcpt		[101],	
			op_cash_bill_title_wo_rcpt		[101],	
			op_credit_bill_title			[101],	
			ip_cash_bill_title_w_rcpt		[101],	
			ip_cash_bill_title_wo_rcpt		[101],	
			ip_credit_bill_title			[101],		
			cash_bill_title_addl_line		[101],	
			cash_bill_title_w_rcpt			[101],
			credit_bill_title_addl_line		[101],
			 bl_header_line_01					[101],
			 bl_header_line_02					[101],
			 bl_header_line_03					[101],
			 bl_header_line_04					[101],
			 bl_header_line_05					[101],
			 bl_header_line_06					[101],
			 bl_header_line_07					[101],
			 bl_header_line_08					[101],
			 bl_header_line_09					[101],
			 bl_header_line_10					[101],
			 bl_header_line_11					[101],
			 bl_header_line_12					[101],
			 bl_header_line_13					[101],
			 bl_header_line_14					[101],
			 bl_footer_line_01					[101],
			 bl_footer_line_02					[101],
			 bl_footer_line_03					[101],
			 bl_footer_line_04					[101],
			 bill_credit_footer_line1			[101],	
			 bill_credit_footer_line2			[101],
			 bill_credit_footer_line3			[101],
			 bill_credit_footer_line4			[101],
			 bill_ins_footer_line1				[101],
			 bill_ins_footer_line2				[101],
			 bill_ins_footer_line3				[101],
			 bill_ins_footer_line4				[101],
			 column_var							[101],
			 cr_addl_id_in_ftr_yn				[2],
			 print_ins_addl_id_in_ftr_yn		[2],
			 ip_cr_addl_id_in_ftr_yn			[2],
			 ip_ins_addl_id_in_ftr_yn			[2],
			nd_column_val					[1000],
			str_var1						[101],
			str_var2						[101],
			line_var						[101],
			dup_var							[101],
			lc_str_val						[101],
			lc_str_var						[101],
			tab_name						[31],
			ls_str_var						[101],
			lc_var							[3],
			ls_char_var						[3],
			ls_str							[101],
			ls_var							[101],
			d_doc_type_code1				[30],
			d_doc_number1					[30],
			nd_patient_id					[25],
			nd_REGION_CODE					[100],
			nd_RES_AREA_CODE				[100],
			nd_RES_TOWN_CODE				[100],
			nd_slmt_mode_yn					[2],
			d_cash_slmt_flag				[10],
			nd_counter_bldg					[10],
			loc_legend106					[500],
			d_rcpt_rfnd_id_no				[20],
			d_slmnt_doc_ref					[50],
			d_cash_counter					[5],
			str_has_to_print				[8000],
			nd_adm_doctor					[50],
			nd_adm_doctor1					[50],
			lc_splch_var					[101]; */ 
struct { unsigned short len; unsigned char arr[101]; } original_text;

struct { unsigned short len; unsigned char arr[101]; } copy_text;

struct { unsigned short len; unsigned char arr[101]; } bill_title_line1;

struct { unsigned short len; unsigned char arr[101]; } bill_title_line2;

struct { unsigned short len; unsigned char arr[101]; } bill_title_line3;

struct { unsigned short len; unsigned char arr[101]; } bill_title_line4;

struct { unsigned short len; unsigned char arr[101]; } op_cash_bill_title_w_rcpt;

struct { unsigned short len; unsigned char arr[101]; } op_cash_bill_title_wo_rcpt;

struct { unsigned short len; unsigned char arr[101]; } op_credit_bill_title;

struct { unsigned short len; unsigned char arr[101]; } ip_cash_bill_title_w_rcpt;

struct { unsigned short len; unsigned char arr[101]; } ip_cash_bill_title_wo_rcpt;

struct { unsigned short len; unsigned char arr[101]; } ip_credit_bill_title;

struct { unsigned short len; unsigned char arr[101]; } cash_bill_title_addl_line;

struct { unsigned short len; unsigned char arr[101]; } cash_bill_title_w_rcpt;

struct { unsigned short len; unsigned char arr[101]; } credit_bill_title_addl_line;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_01;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_02;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_03;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_04;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_05;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_06;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_07;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_08;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_09;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_10;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_11;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_12;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_13;

struct { unsigned short len; unsigned char arr[101]; } bl_header_line_14;

struct { unsigned short len; unsigned char arr[101]; } bl_footer_line_01;

struct { unsigned short len; unsigned char arr[101]; } bl_footer_line_02;

struct { unsigned short len; unsigned char arr[101]; } bl_footer_line_03;

struct { unsigned short len; unsigned char arr[101]; } bl_footer_line_04;

struct { unsigned short len; unsigned char arr[101]; } bill_credit_footer_line1;

struct { unsigned short len; unsigned char arr[101]; } bill_credit_footer_line2;

struct { unsigned short len; unsigned char arr[101]; } bill_credit_footer_line3;

struct { unsigned short len; unsigned char arr[101]; } bill_credit_footer_line4;

struct { unsigned short len; unsigned char arr[101]; } bill_ins_footer_line1;

struct { unsigned short len; unsigned char arr[101]; } bill_ins_footer_line2;

struct { unsigned short len; unsigned char arr[101]; } bill_ins_footer_line3;

struct { unsigned short len; unsigned char arr[101]; } bill_ins_footer_line4;

struct { unsigned short len; unsigned char arr[101]; } column_var;

struct { unsigned short len; unsigned char arr[2]; } cr_addl_id_in_ftr_yn;

struct { unsigned short len; unsigned char arr[2]; } print_ins_addl_id_in_ftr_yn;

struct { unsigned short len; unsigned char arr[2]; } ip_cr_addl_id_in_ftr_yn;

struct { unsigned short len; unsigned char arr[2]; } ip_ins_addl_id_in_ftr_yn;

struct { unsigned short len; unsigned char arr[1000]; } nd_column_val;

struct { unsigned short len; unsigned char arr[101]; } str_var1;

struct { unsigned short len; unsigned char arr[101]; } str_var2;

struct { unsigned short len; unsigned char arr[101]; } line_var;

struct { unsigned short len; unsigned char arr[101]; } dup_var;

struct { unsigned short len; unsigned char arr[101]; } lc_str_val;

struct { unsigned short len; unsigned char arr[101]; } lc_str_var;

struct { unsigned short len; unsigned char arr[31]; } tab_name;

struct { unsigned short len; unsigned char arr[101]; } ls_str_var;

struct { unsigned short len; unsigned char arr[3]; } lc_var;

struct { unsigned short len; unsigned char arr[3]; } ls_char_var;

struct { unsigned short len; unsigned char arr[101]; } ls_str;

struct { unsigned short len; unsigned char arr[101]; } ls_var;

struct { unsigned short len; unsigned char arr[30]; } d_doc_type_code1;

struct { unsigned short len; unsigned char arr[30]; } d_doc_number1;

struct { unsigned short len; unsigned char arr[25]; } nd_patient_id;

struct { unsigned short len; unsigned char arr[100]; } nd_REGION_CODE;

struct { unsigned short len; unsigned char arr[100]; } nd_RES_AREA_CODE;

struct { unsigned short len; unsigned char arr[100]; } nd_RES_TOWN_CODE;

struct { unsigned short len; unsigned char arr[2]; } nd_slmt_mode_yn;

struct { unsigned short len; unsigned char arr[10]; } d_cash_slmt_flag;

struct { unsigned short len; unsigned char arr[10]; } nd_counter_bldg;

struct { unsigned short len; unsigned char arr[500]; } loc_legend106;

struct { unsigned short len; unsigned char arr[20]; } d_rcpt_rfnd_id_no;

struct { unsigned short len; unsigned char arr[50]; } d_slmnt_doc_ref;

struct { unsigned short len; unsigned char arr[5]; } d_cash_counter;

struct { unsigned short len; unsigned char arr[8000]; } str_has_to_print;

struct { unsigned short len; unsigned char arr[50]; } nd_adm_doctor;

struct { unsigned short len; unsigned char arr[50]; } nd_adm_doctor1;

struct { unsigned short len; unsigned char arr[101]; } lc_splch_var;



/* VARCHAR 	nd_line_text[1000],nd_print_option[2],
			nd_temp_str[1000]; */ 
struct { unsigned short len; unsigned char arr[1000]; } nd_line_text;

struct { unsigned short len; unsigned char arr[2]; } nd_print_option;

struct { unsigned short len; unsigned char arr[1000]; } nd_temp_str;



int 		reprint_disc_copy_num=0,d_priority,d_oth_priority,d2_priority,
			nd_line_num=0,nd_page_num=0,	nd_print_seq=0;
			

	int	ln_age_year,rec_count=1;   
	
	char d_grp_code	[10],d_line_code [10],pk_grp_ind;               
	

	char	sql_stmt             [5000]; 			
 /* varchar    sql_stmt1            [1000],
			sql_stmt2            [1000]; */ 
struct { unsigned short len; unsigned char arr[1000]; } sql_stmt1;

struct { unsigned short len; unsigned char arr[1000]; } sql_stmt2;


int date_yn = 0,line_ctr = 0;
int splch_pos,st_pos,spchar_type,bold_st = 0,font_st = 0,uline_st=1;
int spchar_pos = 0,spchar_pos1,ctr;
int i,bl_doc_srl_no,pos_var,pos_var1,pos_var2,print_upto,pos_length,var_length;
int l_pos,lv_var,j,len_lc_str_val,prt_len,print_upto_c,ld_var,char_pos;
int ld_pos,ld_length,len=0,nd_length_of_string1=0,nd_length_of_string2=0;


int    lctr = 0,pctr = 1,nvalid = 0,ncancel = 0;
int    first = 1,l_grp_pkg_inside_cnt,l_pat_inside_pkg_disc,l_pay_inside_pkg_disc,l_grp_pkg_service_inside_cnt;

int		d_trade_posi ,
		d_batch_posi,
		d_exp_dt_posi,
		d_loc_posi,
		d_qty_posi,
		vExists=0,
		d_qty;

double  d_bill_amt				=0,
		d_other_bill_amt		=0,
		nd_rcpt_amt				=0,
		d_patient_deposidt_amt	=0,
		d_settled_amt			=0;

double  d_pay_amt				=0;

double  p_gross_amt		=0,
	    p_disc_amt		=0,
		p_net_amt		=0,
		nd_oth_payer_amt=0,
		nd_tot_oth_payer_amt=0,
		nd_tot_disc_amount=0,
		nd_tot_net_reimbursable_amt=0,
		nd_gnd_tot_net_reimbursable_amt=0,
		d_pk_pack_amount		=0,
		d_pk_appr_amount		=0,
		d_tax_amt_pkg			=0,
		d_pk_approval_amount	=0;

double	nd_pat_net_charge_amt	=0,
		p_pat_gross_amt			=0,
		p_pat_disc_amt			=0,
		p_pat_net_amt			=0,
		d1_upd_net_charge_amt	=0,
		d1_upd_gross_charge_amt	=0,
		d1_upd_disc_amt			=0,
		nd_tot_pat_net_charge_amt=0,
		nd_rounded_amt			=0,
		nd_net_pay_amt_after_rounded=0,
		p_tot_pat_gross_amt		=0,
		p_tot_pat_net_amt		=0,
		nd_subdiv_amt			=0,
		nd_tot_subdiv_amt		=0,
		nd_pat_gross_amt		=0,
		nd_pat_net_amt1			=0,
		nd_pat_disc_amt			=0,
		nd_pat_gross_amt1		=0,
		nd_pat_gross_amt2		=0,
		nd_pat_net_amt2			=0,
		nd_pat_disc_amt1		=0,
		d_pk_pack_tot_g_amount	=0,
		d_pk_pack_tot_n_amount	=0,
		d_pk_variance_amt		=0,
		nd_pat_addl_charge_amt	=0,
		nd_pat_tot_addl_charge_amt=0,
		l_tot_pkg_payable     =0,
		l_tot_var_payable	  =0,
		amount=0;

long    d_cust_code2;

char    v_c_billed_serv;

double	d_upd_gross_charge_amt=0,
		d_upd_disc_amt=0,
		d_upd_net_charge_amt=0,
		d_bill_tot_exmpt_amt=0,
		nd_upd_gross_charge_amt=0,
		nd_upd_net_charge_amt=0,
		nd_total_addl_charge_by_service=0,
		tot_upd_gross_charge_amt=0,
		tot_upd_net_charge_amt=0,
		pat_upd_gross_charge_amt=0,
		pat_upd_net_charge_amt=0,
		oth_p_upd_gross_charge_amt=0,
		oth_p_upd_net_charge_amt=0,
		tot_upd_disc_amt=0,
		nd_upd_disc_amt=0,
		oth_p_upd_disc_amt=0,
		pat_upd_disc_amt=0,
		nd_net_payable=0,
		d_net_reimbursable_amt=0,
		d_addl_charge_amt_in_charge=0,
		d_package_seq_no=0,
		pk_disc_pack_seqno =0,
		PkgTotalDiscount =0,
		vDisc	=0,
		d_rate=0,
		d_charge_discount=0,
        d_bill_discount=0,
        d_fund_adjustment=0,
        d_tot_disc=0,
		d1_charge_discount=0,
		d1_bill_discount=0,
		d1_fund_adjustment=0,
		d1_tot_disc=0,
		d1_addl_charge_amt_in_charge=0,
		d1_package_seq_no=0,
     	d1_rate=0,
		nd_tot_rate=0,
		nd1_tot_rate=0,
		nd_grd_tot_rate=0,
		nd1_grd_tot_rate=0,
		nd_total_addl_charge=0,
		nd_gnd_tot_net_non_reimbursable_amt=0,
		nd_net_non_reimbursable_amt=0,
		nd_tot_non_reimbursable_amt=0,
		nd_tot_pat_disc_amt		=0,
		nd_pat_net_amt=0,
		nd_serv_charge_discount=0,
		nd_serv_bill_discount=0,
		nd_serv_fund_adjustment=0,
		nd_serv_tot_disc=0,
		nd1_serv_charge_discount=0,
		nd1_serv_bill_discount=0,
		nd1_serv_fund_adjustment=0,
		nd1_serv_tot_disc=0,
		nd_tot_serv_charge_discount=0,
		nd_tot_serv_bill_discount=0,
		nd_tot_serv_fund_adjustment=0,
		nd_tot_serv_tot_disc=0,
		nd1_tot_serv_charge_discount=0,
		nd1_tot_serv_bill_discount=0,
		nd1_tot_serv_fund_adjustment=0,
		nd1_tot_serv_tot_disc=0,
/** added by raghava on 20/06/2009 ***/
		nd_inside_pkg_gross_amt=0,
		nd_inside_pkg_net_amt=0,
		nd_inside_pkg_amtpayable_amt=0,
		nd_inside_pkg_disc_amt=0,
		nd_inside_pkg_addchrg_amt=0;


int     d_serv_qty=0,
        d1_serv_qty=0,
		nd_tot_serv_qty=0,
		nd1_tot_serv_qty=0,
		nd_grd_tot_serv_qty=0,
		l_discount_count=0,
		l_addlcharge_count=0,
		l_subsidized_amt =0,
		l_gross_disc_amt=0,
		l_aviled_outside_pkg=0,
		l_package_seq_no = 0,
		l_pat_net_amt=0,
		nd1_grd_tot_serv_qty=0;

		
 
double 	nd_net_total=0,
		nd_gross_total=0,
		nd_disc_total=0,nd_othp_payer_amt=0,
		nd_tot_othp_payer_amt=0,
		p_tot_pat_disc_amt=0;


int     ccnt=0,
		ccnt1=0,
		rcnt=0,
		oth_cnt=0,
		k=1,i=0,p=1, //pvalue
		othp_cnt=0,
		lcol_cnt=0,
		l_no_of_clumns=0;

/* VARCHAR		dc_doc_type_code		[18],
			d_no					[17],
			d_doc_date				[11],
			dc_episode_id			[9],
			dc_epi_id				[9],
			dc_visit_id				[5],
			dc_admn_date			[17],
			dc_physician_id			[16],
			dc_physician_name		[100],
			dc1_physician_id		[16],
			dc1_physician_name		[100],
			dc_blng_grp_id			[5],
			d_added_by_id			[100],
			dc_patient_id			[21],
			d_org_dept				[100],
			dc_cust_code			[9],
			dc_bill_type_code		[3],
			dc_clinic_code			[5],
			dc_bill_print_flag		[2], 
			dc_credit_doc_ref_desc  [51],
			dc_short_name			[81],
			dc_short_name1			[81],
			dc_short_name2			[81],
			dc_short_name3			[81],
			dc_short_name_loc_lang  [81], 
			dc_date_of_birth		[11],
			dc_sex					[10],
			dc_full_name			[61],
			dc_long_name			[61],
			dc_long_desc			[105],
			dc_blng_grp_desc		[105],
			dc_short_desc			[51],
			dc_ind					[10],
			dc_mpi_id				[100],
			dc_credit_doc_ref_date  [11],
			dc_policy_type_code     [21] ,  
			dc_policy_number        [31],
			dc_policy_expiry_date   [11],
			d1_doc_type_code		[7],
			//d1_prt_grp_hdr_code   [3],
			//d1_prt_grp_line_code  [3],
			d1_long_desc 			[105],
			d1_long_desc1			[105],
			d1_mpi_id				[47],
			d2_doc_type_code		[7],
			d2_doc_date				[11],
			d2_mpi_ind				[2],
			d2_mpi_id				[47],
			d2_short_name			[16],
			d3_doc_type_code		[7],
			d3_patient_id			[21],
			d3_episode_id			[9],
			d4_doc_type_code		[7],
			d4_patient_id			[21],
			d4_episode_id			[9],

			d_bill_trx_type_code	[41],
			d_bill_nature_code		[2],
			d_nationality_num		[21],
			d_doc_num				[9],
			d2_doc_num				[9],
			d3_doc_num				[20],
			d4_doc_num				[20],
			dc_tot_dep_paid_amt		[21],
			last_recpt_doc_type_code[7],
			last_recpt_doc_num		[9],
			slmt_short_desc			[41],
			slmt_doc_ref_desc		[41],
			slmt_doc_ref_date	    [11],
			slmt_remarks			[31],
			temp					[10],
			d_service_code			[11],
			d_service_date			[20],
			d_service_date1			[20],
			nd_service_date			[20],
			nd_service_date1		[20],
			d_service_desc			[41],
			d_dis_date				[17],
			l_dflt_bill_print_in_summ_yn[5],
			nd_cust					[25],
			nd_serv_qty             [7],


			l_line1[50],
			l_line2[50],
			l_line3[50],
			l_line4[50],
			l_line5[50],
			l_line6[50],
			l_line7[50],

			l_bill_contact_name[50],

			l_bill_contact_name_p[50],
			l_bill_contact_name_p1[50],
			l_bill_contact_name_p2[50],

			l_bill_contact_name_c[50],
			l_bill_contact_name_c1[50],
			l_bill_contact_name_c2[50],

			l_bill_contact_name_title[50],
			l_bill_contact_name_title_p[50],
			l_bill_contact_name_title_p1[50],
			l_bill_contact_name_title_p2[50],

			l_bill_contact_name_title_c[50],
			l_bill_contact_name_title_c1[50],
			l_bill_contact_name_title_c2[50],

			
			l_bill_long_desc[40],

			l_bill_long_desc_p[40],
			l_bill_long_desc_p1[40],
			l_bill_long_desc_p2[40],

			l_bill_long_desc_c[40],
			l_bill_long_desc_c1[40],
			l_bill_long_desc_c2[40],

			l_bill_add1_desc[40],

			l_bill_add1_desc_p[40],
			l_bill_add1_desc_p1[40],
			l_bill_add1_desc_p2[40],

			l_bill_add1_desc_c[40],
			l_bill_add1_desc_c1[40],
			l_bill_add1_desc_c2[40],

			l_bill_add2_desc[40],

			l_bill_add2_desc_p[40],
			l_bill_add2_desc_p1[40],
			l_bill_add2_desc_p2[40],

			l_bill_add2_desc_c[40],
			l_bill_add2_desc_c1[40],
			l_bill_add2_desc_c2[40],

			l_bill_add3_desc[40],

			l_bill_add3_desc_p[40],
			l_bill_add3_desc_p1[40],
			l_bill_add3_desc_p2[40],

			l_bill_add3_desc_c[40],
			l_bill_add3_desc_c1[40],
			l_bill_add3_desc_c2[40],

			l_bill_add3_desc_temp[40],
			l_episode_settlement_ind[4],
			l_episode_cust_code[10],
			l_nric_number[25],
			l_gl_holder_name[181],
			l_gl_holder_name1[181],
			l_gl_holder_name2[181],
			l_gl_ic[1000],
			l_pat_reln_with_gl_holder[90],
			l_pat_reln_with_gl_holder1[90],
			l_pat_reln_with_gl_holder2[90],
			l_detail_report_flag[3],
			l_print_without_disc_func[4],
			l_no_settlement_details[5],
			l_credit_doc_ref_desc[90],
			l_credit_doc_ref_desc1[90],
			l_credit_doc_ref_desc2[90],
			l_coverage_title[500],
			nd_acc_entity_code[5],
			nd_facility_id[3],
			v_cur_bed_num[5], //added for crf-654 scrum
			v_detail_report[3], //added for crf-654 scrum
			v_user_id[31] , //added for crf-654 scrum
            v_credit_doc_ref_desc[31],   //added for crf-654 scrum
			v_gl_holder_name[61],   //added for crf-654 scrum
            V_pat_reln_with_gl_holder[31] ,  //added for crf-654 scrum
	        v_credit_auth_ref[21],
			v_credit_auth_ref_date[31], //added for IN23545
			v_policy_no[31]; */ 
struct { unsigned short len; unsigned char arr[18]; } dc_doc_type_code;

struct { unsigned short len; unsigned char arr[17]; } d_no;

struct { unsigned short len; unsigned char arr[11]; } d_doc_date;

struct { unsigned short len; unsigned char arr[9]; } dc_episode_id;

struct { unsigned short len; unsigned char arr[9]; } dc_epi_id;

struct { unsigned short len; unsigned char arr[5]; } dc_visit_id;

struct { unsigned short len; unsigned char arr[17]; } dc_admn_date;

struct { unsigned short len; unsigned char arr[16]; } dc_physician_id;

struct { unsigned short len; unsigned char arr[100]; } dc_physician_name;

struct { unsigned short len; unsigned char arr[16]; } dc1_physician_id;

struct { unsigned short len; unsigned char arr[100]; } dc1_physician_name;

struct { unsigned short len; unsigned char arr[5]; } dc_blng_grp_id;

struct { unsigned short len; unsigned char arr[100]; } d_added_by_id;

struct { unsigned short len; unsigned char arr[21]; } dc_patient_id;

struct { unsigned short len; unsigned char arr[100]; } d_org_dept;

struct { unsigned short len; unsigned char arr[9]; } dc_cust_code;

struct { unsigned short len; unsigned char arr[3]; } dc_bill_type_code;

struct { unsigned short len; unsigned char arr[5]; } dc_clinic_code;

struct { unsigned short len; unsigned char arr[2]; } dc_bill_print_flag;

struct { unsigned short len; unsigned char arr[51]; } dc_credit_doc_ref_desc;

struct { unsigned short len; unsigned char arr[81]; } dc_short_name;

struct { unsigned short len; unsigned char arr[81]; } dc_short_name1;

struct { unsigned short len; unsigned char arr[81]; } dc_short_name2;

struct { unsigned short len; unsigned char arr[81]; } dc_short_name3;

struct { unsigned short len; unsigned char arr[81]; } dc_short_name_loc_lang;

struct { unsigned short len; unsigned char arr[11]; } dc_date_of_birth;

struct { unsigned short len; unsigned char arr[10]; } dc_sex;

struct { unsigned short len; unsigned char arr[61]; } dc_full_name;

struct { unsigned short len; unsigned char arr[61]; } dc_long_name;

struct { unsigned short len; unsigned char arr[105]; } dc_long_desc;

struct { unsigned short len; unsigned char arr[105]; } dc_blng_grp_desc;

struct { unsigned short len; unsigned char arr[51]; } dc_short_desc;

struct { unsigned short len; unsigned char arr[10]; } dc_ind;

struct { unsigned short len; unsigned char arr[100]; } dc_mpi_id;

struct { unsigned short len; unsigned char arr[11]; } dc_credit_doc_ref_date;

struct { unsigned short len; unsigned char arr[21]; } dc_policy_type_code;

struct { unsigned short len; unsigned char arr[31]; } dc_policy_number;

struct { unsigned short len; unsigned char arr[11]; } dc_policy_expiry_date;

struct { unsigned short len; unsigned char arr[7]; } d1_doc_type_code;

struct { unsigned short len; unsigned char arr[105]; } d1_long_desc;

struct { unsigned short len; unsigned char arr[105]; } d1_long_desc1;

struct { unsigned short len; unsigned char arr[47]; } d1_mpi_id;

struct { unsigned short len; unsigned char arr[7]; } d2_doc_type_code;

struct { unsigned short len; unsigned char arr[11]; } d2_doc_date;

struct { unsigned short len; unsigned char arr[2]; } d2_mpi_ind;

struct { unsigned short len; unsigned char arr[47]; } d2_mpi_id;

struct { unsigned short len; unsigned char arr[16]; } d2_short_name;

struct { unsigned short len; unsigned char arr[7]; } d3_doc_type_code;

struct { unsigned short len; unsigned char arr[21]; } d3_patient_id;

struct { unsigned short len; unsigned char arr[9]; } d3_episode_id;

struct { unsigned short len; unsigned char arr[7]; } d4_doc_type_code;

struct { unsigned short len; unsigned char arr[21]; } d4_patient_id;

struct { unsigned short len; unsigned char arr[9]; } d4_episode_id;

struct { unsigned short len; unsigned char arr[41]; } d_bill_trx_type_code;

struct { unsigned short len; unsigned char arr[2]; } d_bill_nature_code;

struct { unsigned short len; unsigned char arr[21]; } d_nationality_num;

struct { unsigned short len; unsigned char arr[9]; } d_doc_num;

struct { unsigned short len; unsigned char arr[9]; } d2_doc_num;

struct { unsigned short len; unsigned char arr[20]; } d3_doc_num;

struct { unsigned short len; unsigned char arr[20]; } d4_doc_num;

struct { unsigned short len; unsigned char arr[21]; } dc_tot_dep_paid_amt;

struct { unsigned short len; unsigned char arr[7]; } last_recpt_doc_type_code;

struct { unsigned short len; unsigned char arr[9]; } last_recpt_doc_num;

struct { unsigned short len; unsigned char arr[41]; } slmt_short_desc;

struct { unsigned short len; unsigned char arr[41]; } slmt_doc_ref_desc;

struct { unsigned short len; unsigned char arr[11]; } slmt_doc_ref_date;

struct { unsigned short len; unsigned char arr[31]; } slmt_remarks;

struct { unsigned short len; unsigned char arr[10]; } temp;

struct { unsigned short len; unsigned char arr[11]; } d_service_code;

struct { unsigned short len; unsigned char arr[20]; } d_service_date;

struct { unsigned short len; unsigned char arr[20]; } d_service_date1;

struct { unsigned short len; unsigned char arr[20]; } nd_service_date;

struct { unsigned short len; unsigned char arr[20]; } nd_service_date1;

struct { unsigned short len; unsigned char arr[41]; } d_service_desc;

struct { unsigned short len; unsigned char arr[17]; } d_dis_date;

struct { unsigned short len; unsigned char arr[5]; } l_dflt_bill_print_in_summ_yn;

struct { unsigned short len; unsigned char arr[25]; } nd_cust;

struct { unsigned short len; unsigned char arr[7]; } nd_serv_qty;

struct { unsigned short len; unsigned char arr[50]; } l_line1;

struct { unsigned short len; unsigned char arr[50]; } l_line2;

struct { unsigned short len; unsigned char arr[50]; } l_line3;

struct { unsigned short len; unsigned char arr[50]; } l_line4;

struct { unsigned short len; unsigned char arr[50]; } l_line5;

struct { unsigned short len; unsigned char arr[50]; } l_line6;

struct { unsigned short len; unsigned char arr[50]; } l_line7;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_p;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_p1;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_p2;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_c;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_c1;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_c2;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_title;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_title_p;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_title_p1;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_title_p2;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_title_c;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_title_c1;

struct { unsigned short len; unsigned char arr[50]; } l_bill_contact_name_title_c2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_long_desc;

struct { unsigned short len; unsigned char arr[40]; } l_bill_long_desc_p;

struct { unsigned short len; unsigned char arr[40]; } l_bill_long_desc_p1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_long_desc_p2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_long_desc_c;

struct { unsigned short len; unsigned char arr[40]; } l_bill_long_desc_c1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_long_desc_c2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add1_desc;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add1_desc_p;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add1_desc_p1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add1_desc_p2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add1_desc_c;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add1_desc_c1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add1_desc_c2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add2_desc;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add2_desc_p;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add2_desc_p1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add2_desc_p2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add2_desc_c;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add2_desc_c1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add2_desc_c2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc_p;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc_p1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc_p2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc_c;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc_c1;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc_c2;

struct { unsigned short len; unsigned char arr[40]; } l_bill_add3_desc_temp;

struct { unsigned short len; unsigned char arr[4]; } l_episode_settlement_ind;

struct { unsigned short len; unsigned char arr[10]; } l_episode_cust_code;

struct { unsigned short len; unsigned char arr[25]; } l_nric_number;

struct { unsigned short len; unsigned char arr[181]; } l_gl_holder_name;

struct { unsigned short len; unsigned char arr[181]; } l_gl_holder_name1;

struct { unsigned short len; unsigned char arr[181]; } l_gl_holder_name2;

struct { unsigned short len; unsigned char arr[1000]; } l_gl_ic;

struct { unsigned short len; unsigned char arr[90]; } l_pat_reln_with_gl_holder;

struct { unsigned short len; unsigned char arr[90]; } l_pat_reln_with_gl_holder1;

struct { unsigned short len; unsigned char arr[90]; } l_pat_reln_with_gl_holder2;

struct { unsigned short len; unsigned char arr[3]; } l_detail_report_flag;

struct { unsigned short len; unsigned char arr[4]; } l_print_without_disc_func;

struct { unsigned short len; unsigned char arr[5]; } l_no_settlement_details;

struct { unsigned short len; unsigned char arr[90]; } l_credit_doc_ref_desc;

struct { unsigned short len; unsigned char arr[90]; } l_credit_doc_ref_desc1;

struct { unsigned short len; unsigned char arr[90]; } l_credit_doc_ref_desc2;

struct { unsigned short len; unsigned char arr[500]; } l_coverage_title;

struct { unsigned short len; unsigned char arr[5]; } nd_acc_entity_code;

struct { unsigned short len; unsigned char arr[3]; } nd_facility_id;

struct { unsigned short len; unsigned char arr[5]; } v_cur_bed_num;

struct { unsigned short len; unsigned char arr[3]; } v_detail_report;

struct { unsigned short len; unsigned char arr[31]; } v_user_id;

struct { unsigned short len; unsigned char arr[31]; } v_credit_doc_ref_desc;

struct { unsigned short len; unsigned char arr[61]; } v_gl_holder_name;

struct { unsigned short len; unsigned char arr[31]; } V_pat_reln_with_gl_holder;

struct { unsigned short len; unsigned char arr[21]; } v_credit_auth_ref;

struct { unsigned short len; unsigned char arr[31]; } v_credit_auth_ref_date;

struct { unsigned short len; unsigned char arr[31]; } v_policy_no;
 //added for remerging scrum 


/* VARCHAR	nd_blng_grp			[31],
		nd_nationality		[16],
		nd_cash_counter		[16],
		nd_base_rate_qty	[20]; */ 
struct { unsigned short len; unsigned char arr[31]; } nd_blng_grp;

struct { unsigned short len; unsigned char arr[16]; } nd_nationality;

struct { unsigned short len; unsigned char arr[16]; } nd_cash_counter;

struct { unsigned short len; unsigned char arr[20]; } nd_base_rate_qty;
	

/* VARCHAR	d_bill_type_desc[31],
		d_remarks_1[61],
		d_remarks_2[61],
		d_remarks_3[61],
		d_remarks_4[61],
		d_remarks_5[61],
		d_remarks_6[61],
		d_remarks_7[61],
		ar[10]; */ 
struct { unsigned short len; unsigned char arr[31]; } d_bill_type_desc;

struct { unsigned short len; unsigned char arr[61]; } d_remarks_1;

struct { unsigned short len; unsigned char arr[61]; } d_remarks_2;

struct { unsigned short len; unsigned char arr[61]; } d_remarks_3;

struct { unsigned short len; unsigned char arr[61]; } d_remarks_4;

struct { unsigned short len; unsigned char arr[61]; } d_remarks_5;

struct { unsigned short len; unsigned char arr[61]; } d_remarks_6;

struct { unsigned short len; unsigned char arr[61]; } d_remarks_7;

struct { unsigned short len; unsigned char arr[10]; } ar;

		
/* VARCHAR	nd_file_name [50],
		nd_temp_file_name [50],
		nd_hosp_name[1000],
		nd_add		[1000],
		nd_add_ln	[1000],
		nd_add_ln1	[1000],
		nd_add_ln2	[1000],
		nd_add_ln3	[1000],
	    nd_tel_fax	[1000],
		nd_telfax	[1000],
		nd_lang_id	[4],
		nd_hosp_add	[2000],
		loc_legend1	[201],
		loc_legend2	[201],
		loc_legend3	[201],
		loc_legend4	[201],
		loc_legend5	[201],
		loc_legend6	[201],
		loc_legend7	[201],
		loc_legend8	[201],
		loc_legend9	[201],
		loc_legend10[201],
		loc_legend11[201],
		loc_legend12[201],
		loc_legend13[201],
		loc_legend14[201],
		loc_legend15[201],
		loc_legend16[201],
		loc_legend17[201],
		loc_legend18[201],
		loc_legend19[201],
		loc_legend20[201],
		loc_legend21[201],
		loc_legend22[201],
		loc_legend23[201],
		loc_legend24[201],
		loc_legend25[201],
		loc_legend26[201],
		loc_legend27[201],
		loc_legend28[201],
		loc_legend29[201],
		loc_legend30[201],
		loc_legend31[201],
		loc_legend32[201],
		loc_legend33[201],
		loc_legend34[201],
		loc_legend35[201],
		loc_legend36[201],
		loc_legend37[201],
		loc_legend38[201],
					/o----22/09/2005----o/
		loc_legend39[201],
		loc_legend40[201],
		loc_legend41[201],
		loc_legend42[201],
		loc_legend43[201],
		loc_legend44[201],
		loc_legend45[201],
		loc_legend46[201],
		loc_legend47[201],
		loc_legend48[201],
		loc_legend49[201],
		loc_legend50[201],
		loc_legend51[201],
		loc_legend52[201],
		loc_legend53[201],
		loc_legend54[201],
		loc_legend55[201],
		loc_legend56[201],
		loc_legend57[201],
		loc_legend58[201],
		loc_legend59[201],
		loc_legend60[201],
		loc_legend61[201],
		loc_legend62[201],
		loc_legend63[201],
		loc_legend68[201],
		loc_legend69[201],
		loc_legend70[201],
		loc_legend71[201],
		loc_legend72[201],
		loc_legend73[201],
		loc_legend74[201],
		loc_legend75[201],
		loc_legend76[201],
		loc_legend77[201],
		loc_legend78[201],
		loc_legend79[201],
		loc_legend80[201],
		loc_legend81[201],
		loc_legend82[201],
		loc_legend83[201],
		loc_legend84[201],
		loc_legend85[201],
		loc_legend91[201], //ADDED FOR SCRUM CRF-654
		loc_legend92[201], //ADDED FOR SCRUM CRF-654
		loc_legend93[201], //ADDED FOR SCRUM CRF-654
		loc_legend94[201], //ADDED FOR SCRUM CRF-654
		loc_legend96[201],
        l_translated_value	[201],
		l_pk_value			[100]; */ 
struct { unsigned short len; unsigned char arr[50]; } nd_file_name;

struct { unsigned short len; unsigned char arr[50]; } nd_temp_file_name;

struct { unsigned short len; unsigned char arr[1000]; } nd_hosp_name;

struct { unsigned short len; unsigned char arr[1000]; } nd_add;

struct { unsigned short len; unsigned char arr[1000]; } nd_add_ln;

struct { unsigned short len; unsigned char arr[1000]; } nd_add_ln1;

struct { unsigned short len; unsigned char arr[1000]; } nd_add_ln2;

struct { unsigned short len; unsigned char arr[1000]; } nd_add_ln3;

struct { unsigned short len; unsigned char arr[1000]; } nd_tel_fax;

struct { unsigned short len; unsigned char arr[1000]; } nd_telfax;

struct { unsigned short len; unsigned char arr[4]; } nd_lang_id;

struct { unsigned short len; unsigned char arr[2000]; } nd_hosp_add;

struct { unsigned short len; unsigned char arr[201]; } loc_legend1;

struct { unsigned short len; unsigned char arr[201]; } loc_legend2;

struct { unsigned short len; unsigned char arr[201]; } loc_legend3;

struct { unsigned short len; unsigned char arr[201]; } loc_legend4;

struct { unsigned short len; unsigned char arr[201]; } loc_legend5;

struct { unsigned short len; unsigned char arr[201]; } loc_legend6;

struct { unsigned short len; unsigned char arr[201]; } loc_legend7;

struct { unsigned short len; unsigned char arr[201]; } loc_legend8;

struct { unsigned short len; unsigned char arr[201]; } loc_legend9;

struct { unsigned short len; unsigned char arr[201]; } loc_legend10;

struct { unsigned short len; unsigned char arr[201]; } loc_legend11;

struct { unsigned short len; unsigned char arr[201]; } loc_legend12;

struct { unsigned short len; unsigned char arr[201]; } loc_legend13;

struct { unsigned short len; unsigned char arr[201]; } loc_legend14;

struct { unsigned short len; unsigned char arr[201]; } loc_legend15;

struct { unsigned short len; unsigned char arr[201]; } loc_legend16;

struct { unsigned short len; unsigned char arr[201]; } loc_legend17;

struct { unsigned short len; unsigned char arr[201]; } loc_legend18;

struct { unsigned short len; unsigned char arr[201]; } loc_legend19;

struct { unsigned short len; unsigned char arr[201]; } loc_legend20;

struct { unsigned short len; unsigned char arr[201]; } loc_legend21;

struct { unsigned short len; unsigned char arr[201]; } loc_legend22;

struct { unsigned short len; unsigned char arr[201]; } loc_legend23;

struct { unsigned short len; unsigned char arr[201]; } loc_legend24;

struct { unsigned short len; unsigned char arr[201]; } loc_legend25;

struct { unsigned short len; unsigned char arr[201]; } loc_legend26;

struct { unsigned short len; unsigned char arr[201]; } loc_legend27;

struct { unsigned short len; unsigned char arr[201]; } loc_legend28;

struct { unsigned short len; unsigned char arr[201]; } loc_legend29;

struct { unsigned short len; unsigned char arr[201]; } loc_legend30;

struct { unsigned short len; unsigned char arr[201]; } loc_legend31;

struct { unsigned short len; unsigned char arr[201]; } loc_legend32;

struct { unsigned short len; unsigned char arr[201]; } loc_legend33;

struct { unsigned short len; unsigned char arr[201]; } loc_legend34;

struct { unsigned short len; unsigned char arr[201]; } loc_legend35;

struct { unsigned short len; unsigned char arr[201]; } loc_legend36;

struct { unsigned short len; unsigned char arr[201]; } loc_legend37;

struct { unsigned short len; unsigned char arr[201]; } loc_legend38;

struct { unsigned short len; unsigned char arr[201]; } loc_legend39;

struct { unsigned short len; unsigned char arr[201]; } loc_legend40;

struct { unsigned short len; unsigned char arr[201]; } loc_legend41;

struct { unsigned short len; unsigned char arr[201]; } loc_legend42;

struct { unsigned short len; unsigned char arr[201]; } loc_legend43;

struct { unsigned short len; unsigned char arr[201]; } loc_legend44;

struct { unsigned short len; unsigned char arr[201]; } loc_legend45;

struct { unsigned short len; unsigned char arr[201]; } loc_legend46;

struct { unsigned short len; unsigned char arr[201]; } loc_legend47;

struct { unsigned short len; unsigned char arr[201]; } loc_legend48;

struct { unsigned short len; unsigned char arr[201]; } loc_legend49;

struct { unsigned short len; unsigned char arr[201]; } loc_legend50;

struct { unsigned short len; unsigned char arr[201]; } loc_legend51;

struct { unsigned short len; unsigned char arr[201]; } loc_legend52;

struct { unsigned short len; unsigned char arr[201]; } loc_legend53;

struct { unsigned short len; unsigned char arr[201]; } loc_legend54;

struct { unsigned short len; unsigned char arr[201]; } loc_legend55;

struct { unsigned short len; unsigned char arr[201]; } loc_legend56;

struct { unsigned short len; unsigned char arr[201]; } loc_legend57;

struct { unsigned short len; unsigned char arr[201]; } loc_legend58;

struct { unsigned short len; unsigned char arr[201]; } loc_legend59;

struct { unsigned short len; unsigned char arr[201]; } loc_legend60;

struct { unsigned short len; unsigned char arr[201]; } loc_legend61;

struct { unsigned short len; unsigned char arr[201]; } loc_legend62;

struct { unsigned short len; unsigned char arr[201]; } loc_legend63;

struct { unsigned short len; unsigned char arr[201]; } loc_legend68;

struct { unsigned short len; unsigned char arr[201]; } loc_legend69;

struct { unsigned short len; unsigned char arr[201]; } loc_legend70;

struct { unsigned short len; unsigned char arr[201]; } loc_legend71;

struct { unsigned short len; unsigned char arr[201]; } loc_legend72;

struct { unsigned short len; unsigned char arr[201]; } loc_legend73;

struct { unsigned short len; unsigned char arr[201]; } loc_legend74;

struct { unsigned short len; unsigned char arr[201]; } loc_legend75;

struct { unsigned short len; unsigned char arr[201]; } loc_legend76;

struct { unsigned short len; unsigned char arr[201]; } loc_legend77;

struct { unsigned short len; unsigned char arr[201]; } loc_legend78;

struct { unsigned short len; unsigned char arr[201]; } loc_legend79;

struct { unsigned short len; unsigned char arr[201]; } loc_legend80;

struct { unsigned short len; unsigned char arr[201]; } loc_legend81;

struct { unsigned short len; unsigned char arr[201]; } loc_legend82;

struct { unsigned short len; unsigned char arr[201]; } loc_legend83;

struct { unsigned short len; unsigned char arr[201]; } loc_legend84;

struct { unsigned short len; unsigned char arr[201]; } loc_legend85;

struct { unsigned short len; unsigned char arr[201]; } loc_legend91;

struct { unsigned short len; unsigned char arr[201]; } loc_legend92;

struct { unsigned short len; unsigned char arr[201]; } loc_legend93;

struct { unsigned short len; unsigned char arr[201]; } loc_legend94;

struct { unsigned short len; unsigned char arr[201]; } loc_legend96;

struct { unsigned short len; unsigned char arr[201]; } l_translated_value;

struct { unsigned short len; unsigned char arr[100]; } l_pk_value;
		
		
	   /*------Up To here------*/
	  
      /*-------Added 06/07/2007-------*/

/* VARCHAR nd_temp_date		[20],
		nd_loc_date			[20],
		nd_temp_date1		[12],
		nd_loc_date1		[12],
		date_convert		[20],
		nd_doc_type			[50],
		nd_doc_num			[50],
		print_disc_flag		[2],
		nd_cashier_name		[500],
		nd_cahier_position  [500]; */ 
struct { unsigned short len; unsigned char arr[20]; } nd_temp_date;

struct { unsigned short len; unsigned char arr[20]; } nd_loc_date;

struct { unsigned short len; unsigned char arr[12]; } nd_temp_date1;

struct { unsigned short len; unsigned char arr[12]; } nd_loc_date1;

struct { unsigned short len; unsigned char arr[20]; } date_convert;

struct { unsigned short len; unsigned char arr[50]; } nd_doc_type;

struct { unsigned short len; unsigned char arr[50]; } nd_doc_num;

struct { unsigned short len; unsigned char arr[2]; } print_disc_flag;

struct { unsigned short len; unsigned char arr[500]; } nd_cashier_name;

struct { unsigned short len; unsigned char arr[500]; } nd_cahier_position;


double  nd_tot_disc=0;


/****** Added The following variables on 29/09/2009 for Package CRF-203 ******/

/* VARCHAR p_pkg_amt_str	    [200],
		p_pkg_dep_str	    [200],
		p_pkg_seq_num_str   [200],
		p_dep_str			[200],  //Rajesh
		p_pkg_variance_str	[200],  //Rajesh
		p_pkg_var_stax_str	[200],
		temp_dep_str		[200],  //Rajesh
temp_pkg_variance_str		[200],  //Rajesh
temp_pkg_variance_tax_str	[200],
		temp_pkg_amt_str	[200],
		temp_pkg_dep_str	[200],
		temp_pkg_seq_num_str[200],
		nd_package_code		[10],
		d_package_code		[10],
		nd_package_desc		[100],
		l_pkg_seq_num		[50],
		p_no_of_pkgs		[50],
		nd_round_flag		[2]; */ 
struct { unsigned short len; unsigned char arr[200]; } p_pkg_amt_str;

struct { unsigned short len; unsigned char arr[200]; } p_pkg_dep_str;

struct { unsigned short len; unsigned char arr[200]; } p_pkg_seq_num_str;

struct { unsigned short len; unsigned char arr[200]; } p_dep_str;

struct { unsigned short len; unsigned char arr[200]; } p_pkg_variance_str;

struct { unsigned short len; unsigned char arr[200]; } p_pkg_var_stax_str;

struct { unsigned short len; unsigned char arr[200]; } temp_dep_str;

struct { unsigned short len; unsigned char arr[200]; } temp_pkg_variance_str;

struct { unsigned short len; unsigned char arr[200]; } temp_pkg_variance_tax_str;

struct { unsigned short len; unsigned char arr[200]; } temp_pkg_amt_str;

struct { unsigned short len; unsigned char arr[200]; } temp_pkg_dep_str;

struct { unsigned short len; unsigned char arr[200]; } temp_pkg_seq_num_str;

struct { unsigned short len; unsigned char arr[10]; } nd_package_code;

struct { unsigned short len; unsigned char arr[10]; } d_package_code;

struct { unsigned short len; unsigned char arr[100]; } nd_package_desc;

struct { unsigned short len; unsigned char arr[50]; } l_pkg_seq_num;

struct { unsigned short len; unsigned char arr[50]; } p_no_of_pkgs;

struct { unsigned short len; unsigned char arr[2]; } nd_round_flag;


/******** Added on 1/5/2009 for Medicity ********/
/* VARCHAR	d_rcpt_doc_type_code[10],
		d_rcpt_doc_num[12],
		d_rcpt_doc_srno[3],
		d_settlement_type_code[7],
		d_settlement_desc	  [46],
		d_slmt_doc_ref_date   [20],
		d_settlement_type_code1[7],
		d_settlement_desc1	  [46],
		d_slmt_doc_ref_date1  [20],
		d_rcpt_doc_type_num1  [500],
		d_rcpt_doc_type_num   [500]; */ 
struct { unsigned short len; unsigned char arr[10]; } d_rcpt_doc_type_code;

struct { unsigned short len; unsigned char arr[12]; } d_rcpt_doc_num;

struct { unsigned short len; unsigned char arr[3]; } d_rcpt_doc_srno;

struct { unsigned short len; unsigned char arr[7]; } d_settlement_type_code;

struct { unsigned short len; unsigned char arr[46]; } d_settlement_desc;

struct { unsigned short len; unsigned char arr[20]; } d_slmt_doc_ref_date;

struct { unsigned short len; unsigned char arr[7]; } d_settlement_type_code1;

struct { unsigned short len; unsigned char arr[46]; } d_settlement_desc1;

struct { unsigned short len; unsigned char arr[20]; } d_slmt_doc_ref_date1;

struct { unsigned short len; unsigned char arr[500]; } d_rcpt_doc_type_num1;

struct { unsigned short len; unsigned char arr[500]; } d_rcpt_doc_type_num;




/* VARCHAR	amt_in_words	  [2000],
		amt_in_words_Sep  [2000],
		amt_in_words_Sep1 [2000]; */ 
struct { unsigned short len; unsigned char arr[2000]; } amt_in_words;

struct { unsigned short len; unsigned char arr[2000]; } amt_in_words_Sep;

struct { unsigned short len; unsigned char arr[2000]; } amt_in_words_Sep1;


/* VARCHAR d_attend_practitioner_id[20],
        d_admit_practitioner_id[20],
		nd_pract_id[20],
		pract_name[500],
        pract_name_1[500],
		d_location[500],
		d_locn_code[15]; */ 
struct { unsigned short len; unsigned char arr[20]; } d_attend_practitioner_id;

struct { unsigned short len; unsigned char arr[20]; } d_admit_practitioner_id;

struct { unsigned short len; unsigned char arr[20]; } nd_pract_id;

struct { unsigned short len; unsigned char arr[500]; } pract_name;

struct { unsigned short len; unsigned char arr[500]; } pract_name_1;

struct { unsigned short len; unsigned char arr[500]; } d_location;

struct { unsigned short len; unsigned char arr[15]; } d_locn_code;


/* VARCHAR l_bill_num  [100],
		l_bill_num_temp [100],
	    l_pat_bill_num[100],
		l_cust_code [10]; */ 
struct { unsigned short len; unsigned char arr[100]; } l_bill_num;

struct { unsigned short len; unsigned char arr[100]; } l_bill_num_temp;

struct { unsigned short len; unsigned char arr[100]; } l_pat_bill_num;

struct { unsigned short len; unsigned char arr[10]; } l_cust_code;


// Added by raghava for CRF-521

/* VARCHAR  l_detail_desc	[500]; */ 
struct { unsigned short len; unsigned char arr[500]; } l_detail_desc;


/* VARCHAR package_enable_yn[2]; */ 
struct { unsigned short len; unsigned char arr[2]; } package_enable_yn;


int      len_desc=0,r_ctrdesc=0,l_ctr=1;
char     cl_string_desc[500];
//   for CRF-521

int     no_of_lines1;

double  d_rcpt_amt=0,d_rcpt_amt1=0;



/******** UP TO Here ********/

char    p_pkg_seq_num       [1500][201],
		p_pkg_amt			[1500][201],
		p_pkg_dep_amt		[1500][201],
		p_pkg_variance_amt	[1500][201],
		p_pkg_variance_tax_amt	[1500][201],
		p_dep_amt			[1500][201];
	

int     l_pkg_len,l_lcnt=0,p_cnt=0;
double  l_pkg_amt=0,
		l_pkg_dep_amt=0,
		l_pk_variance_amt =0,
		p_pkg_var_stax_num=0,
		l_tot_var_tax	=0,
		l_pkg_dep_exist=0;

   
/****** on 29/09/2009 for Package CRF-203 ******/

					
char nd_reprint_yn, discount_print_yn, sett_print_yn, l_include_refund;
char print_y, rec_out, grp_out, sec_box_out;
		
char    filename[300],l_filename[300][300];
char	l_mesg[300];
char	a_filename[300];
char    str_var ='\0';
char    d_summary_yn,nd_episode_type, nd_lang_ind, nd_online_print_yn,l_print_option;

long    d_age, max_lines = 11;

int     l_lno = 0;

int     l_bill_print_opt_for_disc_print,
		cnt				= 0;
int	    l_page_no	= 0,l_fst_bill= 0,
		l_dmp			= 0, 
		l_lsr			= 0,
		l_margin_len	= 30,
		l_bill_page_no  = 0,
		l_bill_page_no_frmt2  = 0,
		l_main_hdr		= 1;
int     l_billpage_no	= 0,l_disc_page_no= 0; //27/06/2009 bangkok

int r_ctr = 0,l_len=0;
		
double		d_serv_disc_amt			= 0,
			d1_man_disc_amt			= 0,
			d1_overall_disc_amt		= 0,
			d_bill_tot_outst_amt	= 0,
			d1_tot_adjust_amt		= 0,
			nd1_tot_adjust_amt		= 0,
			d1_bill_tot_exmpt_amt	= 0,
			d1_tot_write_off_amt	= 0,
			d1_bill_amt			    = 0,
			d_overall_disc_amt		= 0,
			d_prepay_adj_amt		= 0,
			d_deposit_adj_amt		= 0,
			d_bill_paid_amt			= 0,
			d_pmnt_diff_adj_amt		= 0,
			l_rounding_amt			= 0,
			tot_amt					= 0,
			d_gross_amt				= 0,
			d_tot_bus_man_disc_amt	= 0,
			d_deposit_amt			= 0,
			d_tot_paid_amt			= 0,
			d1_gross_amt			= 0,
			grp_gross_amt			= 0,
			l_disc_grp_gross_amt,
			l_disc_grp_disc_amt,
			less_disc				= 0,
			vst_amt					= 0,
			p_vst_ded				= 0,
			d2_bill_tot_amt			= 0,
			vd_sub_total_amt		= 0,
			net_total				= 0,
			d_deposit_doc_num		= 0,
			dcp_outst_amt			= 0,
			out_adj_amt				= 0,
			balance_due				= 0,
			bill_outst_amt			= 0,
			d4_doc_amt				= 0,
			d3_doc_amt				= 0,
			d1_net_amt				= 0,
			bill_paid_amt			= 0,
			d_service_amt			= 0,
			d_service_net			= 0,
			d_service_disc			= 0,
			nd_tot_spl_agency_amt	= 0,
			nd_spl_agency_amt		= 0,
			d_service_amt_tot		= 0,
			deposit_tot				= 0,
			bi_tot					= 0,
			amt_payable				= 0,
			l_bill_line_pr_gp_disc_amt	= 0,
			l_bill_rounding_amt			= 0,
			l_bill_tot_adjust_amt		= 0,
			l_bill_tot_exempt_amt		= 0,
			l_bill_tot_write_off_amt	= 0,
			less_billed_amt,
			d_tot_outst_amt=0; //ADDED FOR SCRUM CRF-654;

char	l_bill_tot_adjust_amt_str[100];
char	l_bill_tot_exempt_amt_str[100];
char	l_bill_tot_write_off_amt_str[100];
char	l_less_amt_str[1000],l_less_ins_amt_str[1000],l_less_ins_amt_dtl[1000]; 

char   ar_cust_amt[45][30];	
char   ar_amt[30][30];	 
char   loc_legend[1500][201];
char   bill_code[20][20]; //FOR CRF-659

char st_var[5000]; 

char p_command_buf[500];

int			lv_Spawn_ret;

int				hl		 = 196,
				vl		 = 179,
				tlc		 = 218,
				trc		 = 191,
				blc		 = 192,
				brc		 = 217,
				vlti	 = 195,
				vrti	 = 180,
				htti	 = 194,
				hbti	 = 193,
				plus	 = 197;

	long 	ccount			= 0,
			glcheck			= 1,
			gcount			= 0,
			rcheck			= 0,
			last_line_check = 0,
			d_service_qty,
			d_base_rate,
			d_base_qty;

int mcount		= 0, 
	nd_decimal  = 0,
	l_tit_len	= 0,
	l_next_page,end_of_report,
    l_disc_cnt=0,
	l_billr_cnt=0,l_discr_cnt=0,
	flag=0,l_loop_cnt=1,z=0,l=0;

double nd_payable_amt;
// 27/11/2009
/* VARCHAR	nd_batch_filename		[20],
		nd_report_option		[3],
		nd_desc_with_spl_chr	[2000],
		orig_desc_string		[2000],
		orig_desc_string1		[2000],
		nd_pad_req_yn			[3]; */ 
struct { unsigned short len; unsigned char arr[20]; } nd_batch_filename;

struct { unsigned short len; unsigned char arr[3]; } nd_report_option;

struct { unsigned short len; unsigned char arr[2000]; } nd_desc_with_spl_chr;

struct { unsigned short len; unsigned char arr[2000]; } orig_desc_string;

struct { unsigned short len; unsigned char arr[2000]; } orig_desc_string1;

struct { unsigned short len; unsigned char arr[3]; } nd_pad_req_yn;


int		nd_length_of_string=0;
int rec_ctr = 0; //rajesh	

/* EXEC SQL END DECLARE SECTION; */ 


/* EXEC SQL INCLUDE SQLCA.H;
 */ 
/*
 * $Header: sqlca.h 24-apr-2003.12:50:58 mkandarp Exp $ sqlca.h 
 */

/* Copyright (c) 1985, 2003, Oracle Corporation.  All rights reserved.  */
 
/*
NAME
  SQLCA : SQL Communications Area.
FUNCTION
  Contains no code. Oracle fills in the SQLCA with status info
  during the execution of a SQL stmt.
NOTES
  **************************************************************
  ***                                                        ***
  *** This file is SOSD.  Porters must change the data types ***
  *** appropriately on their platform.  See notes/pcport.doc ***
  *** for more information.                                  ***
  ***                                                        ***
  **************************************************************

  If the symbol SQLCA_STORAGE_CLASS is defined, then the SQLCA
  will be defined to have this storage class. For example:
 
    #define SQLCA_STORAGE_CLASS extern
 
  will define the SQLCA as an extern.
 
  If the symbol SQLCA_INIT is defined, then the SQLCA will be
  statically initialized. Although this is not necessary in order
  to use the SQLCA, it is a good pgming practice not to have
  unitialized variables. However, some C compilers/OS's don't
  allow automatic variables to be init'd in this manner. Therefore,
  if you are INCLUDE'ing the SQLCA in a place where it would be
  an automatic AND your C compiler/OS doesn't allow this style
  of initialization, then SQLCA_INIT should be left undefined --
  all others can define SQLCA_INIT if they wish.

  If the symbol SQLCA_NONE is defined, then the SQLCA variable will
  not be defined at all.  The symbol SQLCA_NONE should not be defined
  in source modules that have embedded SQL.  However, source modules
  that have no embedded SQL, but need to manipulate a sqlca struct
  passed in as a parameter, can set the SQLCA_NONE symbol to avoid
  creation of an extraneous sqlca variable.
 
MODIFIED
    lvbcheng   07/31/98 -  long to int
    jbasu      12/12/94 -  Bug 217878: note this is an SOSD file
    losborne   08/11/92 -  No sqlca var if SQLCA_NONE macro set 
  Clare      12/06/84 - Ch SQLCA to not be an extern.
  Clare      10/21/85 - Add initialization.
  Bradbury   01/05/86 - Only initialize when SQLCA_INIT set
  Clare      06/12/86 - Add SQLCA_STORAGE_CLASS option.
*/
 
#ifndef SQLCA
#define SQLCA 1
 
struct   sqlca
         {
         /* ub1 */ char    sqlcaid[8];
         /* b4  */ int     sqlabc;
         /* b4  */ int     sqlcode;
         struct
           {
           /* ub2 */ unsigned short sqlerrml;
           /* ub1 */ char           sqlerrmc[70];
           } sqlerrm;
         /* ub1 */ char    sqlerrp[8];
         /* b4  */ int     sqlerrd[6];
         /* ub1 */ char    sqlwarn[8];
         /* ub1 */ char    sqlext[8];
         };

#ifndef SQLCA_NONE 
#ifdef   SQLCA_STORAGE_CLASS
SQLCA_STORAGE_CLASS struct sqlca sqlca
#else
         struct sqlca sqlca
#endif
 
#ifdef  SQLCA_INIT
         = {
         {'S', 'Q', 'L', 'C', 'A', ' ', ' ', ' '},
         sizeof(struct sqlca),
         0,
         { 0, {0}},
         {'N', 'O', 'T', ' ', 'S', 'E', 'T', ' '},
         {0, 0, 0, 0, 0, 0},
         {0, 0, 0, 0, 0, 0, 0, 0},
         {0, 0, 0, 0, 0, 0, 0, 0}
         }
#endif
         ;
#endif
 
#endif
 
/* end SQLCA */
/* EXEC SQL INCLUDE SQLDA.H;
 */ 
/*
 * $Header: sqlda.h 08-may-2007.05:58:33 ardesai Exp $ sqlda.h 
 */

/***************************************************************
*      The SQLDA descriptor definition                         *
*--------------------------------------------------------------*
*      VAX/3B Version                                          *
*                                                              *
* Copyright (c) 1987, 2007, Oracle. All rights reserved.  *
***************************************************************/


/* NOTES
  **************************************************************
  ***                                                        ***
  *** This file is SOSD.  Porters must change the data types ***
  *** appropriately on their platform.  See notes/pcport.doc ***
  *** for more information.                                  ***
  ***                                                        ***
  **************************************************************
*/

/*  MODIFIED
    ardesai    05/08/07  - Bug[6037057] Undef Y
    apopat     05/08/02  - [2362423] MVS PE to make lines shorter than 79
    apopat     07/31/99 -  [707588] TAB to blanks for OCCS
    lvbcheng   10/27/98 -  change long to int for sqlda
    lvbcheng   08/15/97 -  Move sqlda protos to sqlcpr.h
    lvbcheng   06/25/97 -  Move sqlda protos to this file
    jbasu      01/29/95 -  correct typo
    jbasu      01/27/95 -  correct comment - ub2->sb2
    jbasu      12/12/94 - Bug 217878: note this is an SOSD file
    Morse      12/01/87 - undef L and S for v6 include files
    Richey     07/13/87 - change int defs to long 
    Clare      09/13/84 - Port: Ch types to match SQLLIB structs
    Clare      10/02/86 - Add ifndef SQLDA
*/

#ifndef SQLDA_
#define SQLDA_ 1
 
#ifdef T
# undef T
#endif
#ifdef F
# undef F
#endif

#ifdef S
# undef S
#endif
#ifdef L
# undef L
#endif

#ifdef Y
 # undef Y
#endif
 
struct SQLDA {
  /* ub4    */ int        N; /* Descriptor size in number of entries        */
  /* text** */ char     **V; /* Ptr to Arr of addresses of main variables   */
  /* ub4*   */ int       *L; /* Ptr to Arr of lengths of buffers            */
  /* sb2*   */ short     *T; /* Ptr to Arr of types of buffers              */
  /* sb2**  */ short    **I; /* Ptr to Arr of addresses of indicator vars   */
  /* sb4    */ int        F; /* Number of variables found by DESCRIBE       */
  /* text** */ char     **S; /* Ptr to Arr of variable name pointers        */
  /* ub2*   */ short     *M; /* Ptr to Arr of max lengths of var. names     */
  /* ub2*   */ short     *C; /* Ptr to Arr of current lengths of var. names */
  /* text** */ char     **X; /* Ptr to Arr of ind. var. name pointers       */
  /* ub2*   */ short     *Y; /* Ptr to Arr of max lengths of ind. var. names*/
  /* ub2*   */ short     *Z; /* Ptr to Arr of cur lengths of ind. var. names*/
  };
 
typedef struct SQLDA SQLDA;
 
#endif

/* ----------------- */
/* defines for sqlda */
/* ----------------- */

#define SQLSQLDAAlloc(arg1, arg2, arg3, arg4) sqlaldt(arg1, arg2, arg3, arg4) 

#define SQLSQLDAFree(arg1, arg2) sqlclut(arg1, arg2) 




#include <winproc.h>

char string_var[200], font_wide_on[200], font_wide_off[200], buf[200];

int v_lno = 0,  v_pno = 0,l_cnt;  


FILE *fp, *fp1;
CHAR nd_str[1000];
char put_string(ls_var,ld_pos,ld_length)
char ls_var[101];

int ld_pos,ld_length;
{
 ls_str_var.arr[0] = '\0';
 ls_str_var.len = 0;

 strcpy(ls_str_var.arr,ls_var);
 ls_str_var.len = strlen(ls_str_var.arr);

 /* EXEC SQL select substr(:ls_str_var,:ld_pos,:ld_length)
	         into :ls_str
			 from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 4;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select substr(:b0,:b1,:b2) into :b3  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&ls_str_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&ld_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&ld_length;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&ls_str;
 sqlstm.sqhstl[3] = (unsigned int  )103;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 ls_str.arr[ls_str.len] = '\0';

 if (OERROR)
        err_mesg("SELECT failed on table DUAL",0,"");

 return(ls_str.arr);
 
}



/* Main Part */

void proc_main(argc,argv)
char *argv[];
int argc;
{
	if (argc < 6)
	{    
		//disp_message (ERR_MESG,"Usage : blrvsbl1 username/pwd@connect_string session_id pgm_date facility_id calling_pgm_id [filename]\n"); commented for SCRUM CRF-654
		 disp_message (ERR_MESG,"Usage : blr00101 username/pwd@connect_string session_id pgm_date facility_id calling_pgm_id [filename]\n");  // ADDED FOR SCRUM CRF-654

		proc_exit();
	}

	
	strcpy(uid_pwd.arr,argv[1]);
	uid_pwd.len = strlen(uid_pwd.arr);

	nd_session_id.len = 0;
	nd_session_id.arr[nd_session_id.len] = '\0';

	strcpy(nd_session_id.arr,argv[2]);
	nd_session_id.len = strlen(nd_session_id.arr);
	nd_session_id.arr[nd_session_id.len] = '\0'; 

	nd_pgm_date.len = 0;
	nd_pgm_date.arr[nd_pgm_date.len] = '\0';
	
	strcpy(nd_pgm_date.arr,argv[3]);
	nd_pgm_date.len = strlen(nd_pgm_date.arr);
	nd_pgm_date.arr[nd_pgm_date.len] = '\0';
	
	strcpy(nd_facility_id.arr,argv[4]);
	nd_facility_id.len = strlen(nd_facility_id.arr);
	nd_facility_id.arr[nd_facility_id.len] = '\0';

	strcpy(nd_calling_pgm_id.arr,argv[5]);		
	nd_calling_pgm_id.len = strlen(nd_calling_pgm_id.arr);	
	nd_calling_pgm_id.arr[nd_calling_pgm_id.len] = '\0';
	    

	//strcpy(nd_calling_pgm_id.arr,"BLRDISCN");
	if(argc > 6) 
	{
	 strcpy(nd_file_name.arr,argv[6]);
	 strcpy(nd_temp_file_name.arr,argv[6]);
	 strcpy(l_nd_calling_pgm_id.arr,nd_calling_pgm_id.arr);
	 l_nd_calling_pgm_id.len = strlen(l_nd_calling_pgm_id.arr);	
	 l_nd_calling_pgm_id.arr[l_nd_calling_pgm_id.len] = '\0';
	}
	else 
	{
	 strcpy(l_nd_calling_pgm_id.arr,nd_calling_pgm_id.arr);
	 l_nd_calling_pgm_id.len = strlen(l_nd_calling_pgm_id.arr);	
	 l_nd_calling_pgm_id.arr[l_nd_calling_pgm_id.len] = '\0';
	 //strcpy(nd_file_name.arr,"blrvsbil.lis"); commented for scrum crf-654
	 //strcpy(nd_temp_file_name.arr,"blrvsbil.lis"); commented for scrum crf-654
	 strcpy(nd_file_name.arr,"blr00101.lis"); //ADDED FOR SCRUM CRF-654
	 strcpy(nd_temp_file_name.arr,"blr00101.lis"); //ADDED FOR SCRUM CRF-654

    }
	nd_file_name.len = strlen(nd_file_name.arr);
	nd_file_name.arr[nd_file_name.len] = '\0';

	
	nd_fm_doc_type.arr[0]    = '\0';
	nd_fm_doc_num.arr[0]     = '\0';
	nd_fm_doc_date.arr[0]    = '\0';
	nd_to_doc_type.arr[0]    = '\0';
	nd_to_doc_num.arr[0]     = '\0';
	nd_to_doc_date.arr[0]    = '\0';
	trx_type.arr[0]			 = '\0';

	nd_fm_doc_type.len       = 0;
	nd_fm_doc_num.len        = 0;
	nd_fm_doc_date.len       = 0;
	nd_to_doc_type.len       = 0;
	nd_to_doc_num.len        = 0;
	nd_to_doc_date.len       = 0;
	trx_type.len	   	     = 0;
	
	
   /* EXEC SQL CONNECT :uid_pwd; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 4;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.iters = (unsigned int  )10;
   sqlstm.offset = (unsigned int  )36;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&uid_pwd;
   sqlstm.sqhstl[0] = (unsigned int  )134;
   sqlstm.sqhsts[0] = (         int  )134;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlstm.sqlcmax = (unsigned int )100;
   sqlstm.sqlcmin = (unsigned int )2;
   sqlstm.sqlcincr = (unsigned int )1;
   sqlstm.sqlctimeout = (unsigned int )0;
   sqlstm.sqlcnowait = (unsigned int )0;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  
	
  if(OERROR)
   {
	disp_message (ORA_MESG,"Error in connecting to Oracle\n");
	if (uid_pwd.len == 0)
	disp_message (ERR_MESG,"Null oracle uid/pwd\n\n\n");
	proc_exit();
   }
	
	
	set_meduser_role();
	
	strcpy(nd_lang_id.arr,l_language_id.arr);
    nd_lang_id.len = l_language_id.len;


	fetch_sy_prog_param();
	

	fetch_bill_format();


	get_print_routing();
	
	fun_Pad_desc_with_spl_char_yn();

	nd_print_option.arr[0]='N';

	l_logo_yniflaser.arr[0] = 'N';
	nd_line_text.arr[0]='\0';
	nd_line_text.len=0;
	strcpy(nd_line_text.arr," ");
	nd_line_text.len = strlen(nd_line_text.arr);
	nd_line_text.arr[nd_line_text.len]='\0';
	get_left_margin();
	get_disc_print_ind(); //added by raghava on 23/11/2009 for printing Dicsount doc as parametarized

	//prepare_file();

 
   nd_hosp_name.arr[0] = '\0';
   nd_hosp_name.len = 0;            

   nd_acc_entity_code.arr[0] = '\0';
   nd_acc_entity_code.len = 0;

   nd_add_ln1.arr[0] = '\0';
   nd_add_ln1.len = 0;
   
   nd_add_ln2.arr[0] = '\0';
   nd_add_ln2.len = 0;

   nd_add_ln3.arr[0] = '\0';
   nd_add_ln3.len = 0;

   nd_tel_fax.arr[0] = '\0';
   nd_tel_fax.len = 0;

   nd_hosp_add.arr[0] = '\0';
   nd_hosp_add.len    = 0;

  
   if (l_lsr != 0 && l_dmp == 0)
   {	
		if ( l_logo_yniflaser.arr[0] == 'Y')	
		{
		max_lines = 40; //58;  //25
		}
		else
		{
		max_lines = 56; //38; //56;  //25
		}

		l_print_option = 'L';
   }
   else
   {
		max_lines = 11;
   }  


   /* EXEC SQL select  acc_entity_code,
					lpad(' ',round((:l_margin_len-length(rtrim(substr(UPPER(ACC_ENTITY_NAME),1,50))))/2),' ')||UPPER(rtrim(substr(UPPER(ACC_ENTITY_NAME),1,50))),
					LN1_ADD,LN2_ADD,LN3_ADD,
					'Tel:'||TEL_NUM ||'  Fax:'||FAX_NUM,        
					LN1_ADD||','||LN2_ADD||','||LN3_ADD||','||'Tel:'||TEL_NUM
            into
					:nd_acc_entity_code ,
					:nd_hosp_name,
					:nd_add_ln1,:nd_add_ln2,:nd_add_ln3,
					:nd_tel_fax,
					:nd_hosp_add
	    from sy_acc_entity_lang_vw
	    where acc_entity_id = :nd_facility_id
		and	  language_id   = :nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 10;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select acc_entity_code ,(lpad(' ',round(((:b0-length(rtrim\
(substr(UPPER(ACC_ENTITY_NAME),1,50))))/2)),' ')||UPPER(rtrim(substr(UPPER(ACC\
_ENTITY_NAME),1,50)))) ,LN1_ADD ,LN2_ADD ,LN3_ADD ,((('Tel:'||TEL_NUM)||'  Fax\
:')||FAX_NUM) ,(((((((LN1_ADD||',')||LN2_ADD)||',')||LN3_ADD)||',')||'Tel:')||\
TEL_NUM) into :b1,:b2,:b3,:b4,:b5,:b6,:b7  from sy_acc_entity_lang_vw where (a\
cc_entity_id=:b8 and language_id=:b9)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )67;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_acc_entity_code;
   sqlstm.sqhstl[1] = (unsigned int  )7;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_hosp_name;
   sqlstm.sqhstl[2] = (unsigned int  )1002;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_add_ln1;
   sqlstm.sqhstl[3] = (unsigned int  )1002;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&nd_add_ln2;
   sqlstm.sqhstl[4] = (unsigned int  )1002;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&nd_add_ln3;
   sqlstm.sqhstl[5] = (unsigned int  )1002;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&nd_tel_fax;
   sqlstm.sqhstl[6] = (unsigned int  )1002;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&nd_hosp_add;
   sqlstm.sqhstl[7] = (unsigned int  )2002;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[8] = (unsigned int  )5;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[9] = (unsigned int  )6;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		

	if (OERROR)
	{ 
	disp_message (ERR_MESG,"Select failed in SY_ACC_ENTITY");
	proc_exit();
	}


	nd_acc_entity_code.arr[nd_acc_entity_code.len]  = '\0';
	nd_hosp_name.arr[nd_hosp_name.len]			    = '\0';
	nd_add_ln1.arr[nd_add_ln1.len]					= '\0';
	nd_add_ln2.arr[nd_add_ln2.len]					= '\0';
	nd_add_ln3.arr[nd_add_ln3.len]					= '\0';
	nd_tel_fax.arr[nd_tel_fax.len]					= '\0';
    nd_hosp_add.arr[nd_hosp_add.len]				= '\0';
	nd_add_ln.arr[0]								= '\0';
	nd_add_ln.len									= 0;
	
	if (nd_add_ln1.arr[0] != '\0')
	{
		strcpy(nd_add_ln.arr,nd_add_ln1.arr);
		nd_add_ln.len = strlen(nd_add_ln.arr);
	}

	if (nd_add_ln1.arr[0] == '\0' && nd_add_ln2.arr[0] != '\0')
	{
		strcpy(nd_add_ln.arr,nd_add_ln2.arr);
		nd_add_ln.len = strlen(nd_add_ln.arr);
	}
	else if (nd_add_ln1.arr[0] != '\0' && nd_add_ln2.arr[0] != '\0')
	{
		strcat(nd_add_ln.arr,", ");
		nd_add_ln.len = strlen(nd_add_ln.arr);

		strcat(nd_add_ln.arr,nd_add_ln2.arr);
		nd_add_ln.len = strlen(nd_add_ln.arr);
	}

	if (nd_add_ln1.arr[0] == '\0' && nd_add_ln2.arr[0] == '\0' && nd_add_ln3.arr[0] != '\0')
	{
		strcpy(nd_add_ln.arr,nd_add_ln2.arr);
		nd_add_ln.len = strlen(nd_add_ln.arr);
	}
	else if ((nd_add_ln1.arr[0] != '\0' || nd_add_ln2.arr[0] != '\0') && 
				nd_add_ln3.arr[0] != '\0')
	{
		strcat(nd_add_ln.arr,", ");
		nd_add_ln.len = strlen(nd_add_ln.arr);

		strcat(nd_add_ln.arr,nd_add_ln3.arr);
		nd_add_ln.len = strlen(nd_add_ln.arr);
	}

	if (l_lsr != 0 && l_dmp == 0)
	{
	    if ( l_logo_yniflaser.arr[0] == 'Y')	
	    l_tit_len = 0;
	    else
		l_tit_len = 32;
	}

 
	nd_add.arr[0] = '\0';
	nd_add.len = 0;

	/* EXEC SQL SELECT lpad(' ',round((:l_margin_len+:l_tit_len-length(rtrim(:nd_add_ln)))/2),' ')||UPPER(rtrim(:nd_add_ln))
	into :nd_add from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 10;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (lpad(' ',round((((:b0+:b1)-length(rtrim(:b2)))/2)),'\
 ')||UPPER(rtrim(:b2))) into :b4  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )122;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&l_tit_len;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_add_ln;
 sqlstm.sqhstl[2] = (unsigned int  )1002;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_add_ln;
 sqlstm.sqhstl[3] = (unsigned int  )1002;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&nd_add;
 sqlstm.sqhstl[4] = (unsigned int  )1002;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	nd_add.arr[nd_add.len] = '\0';


	nd_telfax.arr[0] = '\0';
	nd_telfax.len = 0;
	

	/* EXEC SQL SELECT lpad(' ',round((:l_margin_len+:l_tit_len-length(rtrim(:nd_tel_fax)))/2),' ')||UPPER(rtrim(:nd_tel_fax))
	into :nd_telfax from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 10;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (lpad(' ',round((((:b0+:b1)-length(rtrim(:b2)))/2)),'\
 ')||UPPER(rtrim(:b2))) into :b4  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )157;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&l_tit_len;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_tel_fax;
 sqlstm.sqhstl[2] = (unsigned int  )1002;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_tel_fax;
 sqlstm.sqhstl[3] = (unsigned int  )1002;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&nd_telfax;
 sqlstm.sqhstl[4] = (unsigned int  )1002;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	nd_telfax.arr[nd_telfax.len] = '\0';

//---Declare Cursors---

declare_master_cur(); 

open_master_cur();

nd_tot_spl_agency_amt = 0;

get_print_net_gross();

while(fetch_master_cur())
 {
	

  l_fst_bill++;

  if(d1_man_disc_amt!=0 || d1_overall_disc_amt!=0 || d_pmnt_diff_adj_amt!=0 ||d_serv_disc_amt!=0)
  { 
   if(disc_doc_appl_ind.arr[0]=='N')
   l_loop_cnt=1;
   else
   {	
	
	  if(strcmp(l_only_print_discount.arr,"Y")==0)
	  l_loop_cnt=1;
	  if(strcmp(l_only_print_discount.arr,"N")==0 && disc_doc_appl_ind.arr[0]=='S')
	  l_loop_cnt=1;
	  if(strcmp(l_only_print_discount.arr,"N")==0 && disc_doc_appl_ind.arr[0]=='B')
	  l_loop_cnt=2;
	
   }

  }  
  else
  l_loop_cnt=1;


  strcpy(nd_calling_pgm_id.arr,l_nd_calling_pgm_id.arr);

  for(z=1;z<=l_loop_cnt;z++) 
  {
 
	 if(disc_doc_appl_ind.arr[0]!='N')
	 {
	  		
		  l_disc_cnt=l_disc_cnt+1;
		  if (strcmp(l_only_print_discount.arr,"Y")==0)
		  strcpy(nd_calling_pgm_id.arr,"BLRDISCN");    //added by vani REGARDING IN11662
		  if(strcmp(l_only_print_discount.arr,"N")==0 && disc_doc_appl_ind.arr[0]=='B')
		  {
		   if(z==2) 
	       strcpy(nd_calling_pgm_id.arr,"BLRDISCN");
		  }
		
	  
		 /*
		  if (strcmp(l_only_print_discount.arr,"Y")==0) //added by vani REGARDING IN11662
		  strcpy(nd_calling_pgm_id.arr,"BLRDISCN");

		 if(strcmp(l_only_print_discount.arr,"N")==0)  
		 {  
		   if(z==2) 
		   strcpy(nd_calling_pgm_id.arr,"BLRDISCN");
		 }
 		 */
	 }


	 prepare_file();
 	

	 //c_servdate_in_dtlformat_yn.arr[0]='Y';
	 //p_servdate_in_dtlformat_yn.arr[0]='Y';

		get_adm_rec_flag();
		get_cashier_name();
	    get_cashier_designation();
		init_all_variables();

	
strcpy(d2_cust_code.arr,d_cust_code.arr);
strcpy(d2_cust_group_code.arr,d_cust_group_code.arr);
d2_cust_code.len=strlen(d_cust_code.arr);
d2_cust_code.arr[d2_cust_code.len]='\0';
d2_cust_group_code.arr[0]='\0';
d2_cust_group_code.len = 0;
get_closed_packages();

		
		
	/*	 if (l_lsr != 0 && l_dmp == 0)  //vani commented blank page is printing because of this
		{			
			l_main_hdr = 1;	
			if ( l_logo_yniflaser.arr[0] != 'Y')
			 {
			   if(l_fst_bill>1)
			   {
				//27/06/2009 bangkok

				 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
				 {
				   if (l_disc_page_no > 0)
					 {
					 	l_disc_page_no = 0;
						fprintf(fp,"\n");
						fprintf(fp,"");
						fprintf(fp,"\n");
						
					 }
				 }
				 else
				 {
					 if (l_billpage_no > 0)
					 {
						l_billpage_no = 0;
						fprintf(fp,"\n");
						fprintf(fp,"");
						fprintf(fp,"\n");
						
					 }
				}
			   }
			   //upto here 27/06/2009 bangkok
			   else
			   {
			    //l_page_no = 0;     //27/06/2009 bangkok	
			    l_billpage_no = 0;   //27/06/2009 bangkok
				l_disc_page_no = 0;  //27/06/2009 bangkok
			   }	
			 }
		}
		else
		{
			if ( l_logo_yniflaser.arr[0] != 'Y')
			 {
			
				if(l_fst_bill>1)
				{
				 if (l_page_no > 0)
				 {
					l_page_no = 0;
					fprintf(fp,"\n");
					fprintf(fp,"");
					fprintf(fp,"\n");
					
				 }
				}
				else
				l_page_no = 0;
				
			 }
		}
          */
	
		/*nd_lang_id.arr[0] = '\0';
		 nd_lang_id.len = 0;
  
		EXEC SQL EXECUTE
		BEGIN
			blcommon.get_language_ind_id(
				:nd_facility_id,
				:d_patient_id,
				:nd_lang_ind,
				:nd_lang_id);
		END;
		END-EXEC;
 		nd_lang_id.arr[strlen(nd_lang_id.arr)] = '\0';*/

		//fetch_legend_value();

		fetch_legend_value1();

		declare_package_service_qty(); //rajesh
		declare_grp_hdr_cur();
		
		if (l_lsr != 0 && l_dmp == 0)
		{
				get_bill_address_lsr();

	
				if ( l_logo_yniflaser.arr[0] != 'Y')
				{
				fprintf(fp,"%c&a2L",ESC); 	/* To Set the Left margin */
				fprintf(fp,"%c(s14H",ESC); 	/* To set the font size	  */
				fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */	      
				}
			
		}
		else
		{
			//get_bill_address();
			get_bill_address_lsr();
			fprintf(fp,"%cg",ESC); 	       /* To Set compressed mode */
		}


			nd_tot_disc_amount=d1_man_disc_amt+d1_overall_disc_amt;
			open_grp_hdr_cur();

/***********************************************************/
/*if (strcmp(d_bill_nature_code.arr,"C")==0)
  {


		EXEC SQL select 'Y' into :v_c_billed_serv
  		   from bl_patient_charges_folio a
		   where cust_code is not null 
		       and 
			exists (select 'x' TRX_DOC_REF,TRX_DOC_REF_LINE_NUM
         from bl_patient_charges_folio b
         where b.TRX_DOC_REF = a.TRX_DOC_REF
		 and   b.operating_facility_id=a.operating_facility_id
		 and   b.operating_facility_id=:nd_facility_id
         and   b.TRX_DOC_REF_LINE_NUM = a.TRX_DOC_REF_LINE_NUM
         and   b.bill_doc_type_code = :d1_doc_type
         and   b.bill_doc_num=:d1_doc_number)
		 and rownum=1;

		if (OERROR)
		{	
		disp_message(ERR_MESG,"Select bl_patient_charges_folio Failed");
		proc_exit();
		}

  }  b/z instead of v_c_billed_serv we are using adm_rec_flag */

/***********************************************************/

/*****This Condition will execute only If The Patient Have Customer******/

if ((strcmp(d_cust_code.arr,"\0")!=0)&& (strcmp(d_adm_rec_flag.arr,"2")==0))
 {
    
		get_column_count_cust();
	  
		 print_report_head();

		 if (strcmp(nd_bill_format_id.arr,"2")==0) //added for IN23425
		 {
			v_lno = line_ctr;	
		 }


		l_next_page=2;
        ccnt=0;
		nd_summary_dtl_ind.arr[0]='\0';  
		nd_prt_grp_hdr_code.arr[0]='\0';
		nd_prt_grp_line_code.arr[0]='\0';
		nd_cust_code1.arr[0]='\0';
	
/**The below code added by Rajesh Package Information is not getting printed when no service provided outside package***/		
		get_aviled_outside_pkg();

		if (l_aviled_outside_pkg ==0 )
		{
			get_payer_bill_header();

			if(l_pkg_len!=0)
			{
			 print_package_dtls(); //1
			}
		}
		/***** upto here *****/
			
			
		/***** This code added for printing package bill if it is there ****/

		/*
		if(l_pkg_len!=0)
		{
		 print_package_dtls(); 
		}
        */
		/***** upto here *****/
		
		while(fetch_grp_hdr_cur())
		{ 	
          /** The below code added by raghava on 23/11/2009 for Dn't print discount amount **/
		  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && d_tot_disc!=0)	  
   		  {
		  	 ccnt = ccnt + 1;
			 ccnt1 = ccnt1 + 1;		
			 print_prt_grp_hdr();	
	      }
		  else
		  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		  {
		  	 ccnt = ccnt + 1;
			 ccnt1 = ccnt1 + 1;		
			 print_prt_grp_hdr(); //22
		  }	
		}


		if(end_of_report)
		{
		  	 
			 			 			 
			 /* This commented stmts for displaying float values*/ 

			 /*sprintf(st_var,"%f",nd_pat_net_amt2);
			 disp_message(ERR_MESG,st_var);*/
         
			 nd_net_total=nd_net_total+nd_pat_net_amt2;
			 nd_gross_total=nd_gross_total+nd_pat_gross_amt1;
			 nd_disc_total=nd_disc_total+nd_pat_disc_amt1;
			 
			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 {
				 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
				 {
				  //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"C")==0) 
				  if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0||strcmp(p_addl_charge_amt_ind.arr,"B")==0)) 
				  {
				  get_addlcharge_count();
				  if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
				  print_formated_amt1(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt);
				  }
				  else
				  fprintf(fp,"%11.11s"," ");
				  
		         }

			  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && p_disc_amt_in_dtl_yn.arr[0]=='N')
              fprintf(fp,"%11.11s"," ");

				 
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
			 {
			  if (strcmp(p_gross_net_amt_ind.arr,"G")==0)
			  {
			 
			  print_formated_amt(nd_pat_gross_amt1-nd_inside_pkg_gross_amt);
			  }
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
			 {
			  if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
			  print_formated_amt(nd_pat_net_amt2-nd_inside_pkg_net_amt);
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 {
			  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			  {
				get_discount_count();
				   if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				   {
			   if (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
			   print_formated_amt(nd_pat_disc_amt1-nd_inside_pkg_disc_amt);
			   }
			  }

			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
			  {
				  if(p_disc_amt_in_dtl_yn.arr[0]=='N')
				  {
				   //if (strcmp(p_servdate_in_dtlformat_yn.arr,"N")==0)
				   //fprintf(fp,"%-18.18s"," ");
				   if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)  
				   fprintf(fp,"%-9.9s"," ");
				   print_formated_amt(nd_serv_tot_disc);
				   
				  }
				  else
				  {
					print_formated_amt(nd_serv_charge_discount);
					print_formated_amt(nd_serv_bill_discount);
					print_formated_amt(nd_serv_fund_adjustment);
				  }

			  }
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
			 {
			  //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"R")==0)
			  if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
			  print_formated_amt((nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt));
			  else
			  {
			   if (strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0)
			   print_formated_amt(nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt);
			  }
			 }
				
		}
        
		//if(end_of_report)
		fprintf(fp,"\n");lsr_line_cnt();
	
		if(strcmp(d_cust_code.arr,"\0")!=0 && lcol_cnt == 1)
		prt_line_uc();
		if(strcmp(d_cust_code.arr,"\0")!=0  && lcol_cnt == 2)
		prt_line_uc_wide();
		fprintf(fp,"\n");lsr_line_cnt();
	
  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)	
  {	

		get_cnt_remain_space(3);
		if((l_lcnt+5)<=max_lines-v_lno)
		{
		  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		  { 
					  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
						{
						  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-63.63s",loc_legend[680]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"%-63.63s",nd_desc_with_spl_chr.arr);				
																																																											
							}
							else
							   {
                                 fprintf(fp,"%-63.63s",loc_legend[680]);
                                }
						}
						else
						{
						   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[680]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);				
																																																											
							}
						    else
							   {
						          fprintf(fp,"%-45.45s",loc_legend[680]);
								}
						 }
		  }
		  else
		  {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-53.53s",loc_legend[680]);							
																																																											
				}
				else
				{
		           fprintf(fp,"%-53.53s",loc_legend[680]);
				}
		   }
		}
		else
		{
		  while(v_lno<=max_lines)
		  {
			fprintf(fp,"\n");
			v_lno++;
		  }
		  lsr_line_cnt();

		  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		  {
		  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
          {
		    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			{
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-63.63s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-63.63s",nd_desc_with_spl_chr.arr);								
																																																											
			 }
			   else
			   {
			      fprintf(fp,"%-63.63s",loc_legend[680]);
				}
		   }
		  else
		  {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr); 
																																																			
				 }
			    	else 
		                fprintf(fp,"%-45.45s",loc_legend[680]); 
		  }
		  }
		  else
		  {
		    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																		
			 }
			else
			    fprintf(fp,"%-53.53s",loc_legend[680]);
		   }
		
		}

	    if (strcmp(p_gross_net_amt_ind.arr,"G")==0) //PRINTING ROW LEVEL TOTAL 2
		 {			
			nd_gross_total=nd_gross_total+d_pk_pack_tot_g_amount; //Rajesh added d_pk_pack_tot_g_amount credit Bill
			print_formated_amt(nd_gross_total);
          }
		if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
		  {
			nd_net_total = nd_net_total+d_pk_pack_tot_n_amount;   //Rajesh added d_pk_pack_tot_n_amount Credit Bill
			print_formated_amt(nd_net_total);
           }
		fprintf(fp,"\n"); //lsr_line_cnt(); 
	//The below code added by Rajesh  IN22838	
	/*	if (PkgTotalDiscount > 0)
		{
		 fprintf(fp," %-41s",loc_legend[710]);
		print_formated_amt(nd_tot_disc_amount+PkgTotalDiscount);
		fprintf(fp,"\n");//lsr_line_cnt();
		}
      */    
		
		// To print total package discout in a row
		print_package_discount();

		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			if (strcmp(p_serv_disc_on_gross_ind.arr,"R")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
		{
		  if((nd_disc_total)!=0)
		  {
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
			{
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[710]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				 }
				else
			       fprintf(fp," %-62.62s",loc_legend[710]);
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[710]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp," %-44.44s",loc_legend[710]);
			 }
			}
			else
			{
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[710]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp," %-52.52s",loc_legend[710]);
			}
			
			print_formated_amt(nd_disc_total);
			fprintf(fp,"\n"); //lsr_line_cnt();  
	      }
	
		}

  /* THIS IS FOR DISPLAYING OF OTHER PAYER AMOUNT DEPENDING ON SETUP*/
  
 
 /*******commented by vani now its printing using cursor*******
 if(strcmp(d_customer2.arr,"\0")!=0)
   {
	
	 if (strcmp(p_oth_payers_amt_print_row_ind.arr,"R")==0)
      {
		d2_cust_code.arr[0]='\0';
		d2_cust_code.len = 0;  
		l_tot_pkg_payable = 0;
		strcpy(d2_cust_code.arr,nd_cust_code1.arr);
		d2_cust_code.len=strlen(nd_cust_code1.arr);
		d2_cust_code.arr[d2_cust_code.len]='\0';
		d2_cust_group_code.arr[0]='\0';
		d2_cust_group_code.len = 0;
		get_closed_packages();

		nd_oth_payer_amt=nd_oth_payer_amt+l_tot_pkg_payable ;
						   	     
		if(k<=1) 
		{
            
			if(strcmp(nd_cust_code1.arr,"\0")!=0)
			{ 
		   
	
				strcpy(leg_cust.arr,loc_legend[730]);
				strcat(leg_cust.arr," ");
				strcpy(leg_cust.arr,strcat(leg_cust.arr,d_customer2.arr));
				
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {		
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",leg_cust.arr);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					 }
					else
				        fprintf(fp," %-62.62s",leg_cust.arr);
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {	
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",leg_cust.arr);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-44.44s",leg_cust.arr);
				 }
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {		
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",leg_cust.arr);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-52.52s",leg_cust.arr);
				 }
				
			    leg_cust.arr[0] = '\0';

				//fprintf(fp,"%-14s %-35s %-s %-s"," ",loc_legend[730],nd_cust_code1.arr,d_customer.arr);
				//print_formated_amt(nd_oth_payer_amt);
				put_val(ar_amt[0],nd_oth_payer_amt); 

				nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+nd_oth_payer_amt;
				format_amt(ar_amt[0]);
				fprintf(fp,"%15s %-20s",ar_amt[0],bill_code[0]);
			
			}
		}

	   else
	   {    
	       
	   		if(strcmp(nd_cust_code1.arr,"\0")!=0)
			{
		       
			   // test fetch_customer1();
				//strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
				strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
				// test strcpy(leg_cust.arr,strcat(leg_cust.arr,nd_cust_code1.arr));
				strcpy(leg_cust.arr,strcat(leg_cust.arr,d_customer2.arr));
				
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {	
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",leg_cust.arr);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-62.62s",leg_cust.arr);
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {	
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",leg_cust.arr);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp," %-44.44s",leg_cust.arr);
				 }
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {		
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",leg_cust.arr);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-52.52s",leg_cust.arr);
				}

				leg_cust.arr[0] = '\0';
				//fprintf(fp,"%-14s %-35s %-s %-s"," ",loc_legend[730],nd_cust_code1.arr,d_customer.arr);
				put_val(ar_amt[0],nd_oth_payer_amt); 
				nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+nd_oth_payer_amt;
				
				format_amt(ar_amt[0]);
				fprintf(fp,"%15s %-20s",ar_amt[0],bill_code[0]);
				//fprintf(fp,"\n"); //lsr_line_cnt();
			}
			
	
			for (i=1;i<k;i++)  
			{
			 strcpy(ar_cust.arr,	ar_cust_amt[i]);
			 fprintf(fp,"\n");lsr_line_cnt();
			 if(strcmp(ar_cust_amt[i],"\0")!=0)
			 {
			  //fetch_customer2();
			  //strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
			  strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
			  strcpy(leg_cust.arr,strcat(leg_cust.arr,ar_cust.arr));
			  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			  {
			  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
			  {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {		
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",leg_cust.arr);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				    fprintf(fp," %-62.62s",leg_cust.arr);
			   }
			  else
			  {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {	
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",leg_cust.arr);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp," %-44.44s",leg_cust.arr);
			   }
			  }
			  else
			  {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {		
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",leg_cust.arr);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				 }
				else
			     fprintf(fp," %-52.52s",leg_cust.arr);
			  }
              leg_cust.arr[0] = '\0';
			  //fprintf(fp,"%-14s %-35s %-s"," ",loc_legend[730],d_customer.arr);
			  //fprintf(fp,"\n%s",ar_cust.arr);
			  fprintf(fp,"%15s %-20s",ar_amt[i],bill_code[i]);
				
			 } 
		  }
		}
      fprintf(fp,"\n");lsr_line_cnt();
    }
  }

  *******upto here******/

	/**********Added by vani ****************/

	if (strcmp(p_oth_payers_amt_print_row_ind.arr,"R")==0) //222
		{

	
			declare_other_payer_amt_for_payer();
			open_other_payer_amt_for_payer();
		  while(fetch_other_payer_amt_for_payer())
			{
				if(strcmp(d_oth_cust_code.arr,"\0")!=0)
				  {
					fetch_cust_name(d_oth_cust_code.arr);
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					strcpy(leg_cust.arr,strcat(leg_cust.arr,d_oth_cust_desc.arr));
					
					if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
					{
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
						 }
						 else
						   fprintf(fp," %-49.49s",leg_cust.arr);
					}
					else
					{
							if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 { 
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 							    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																						
							}
							else
							   fprintf(fp," %-41.41s",leg_cust.arr);
					}
					}
					else
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
  					        fprintf(fp," %-51.51s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-51.51s",leg_cust.arr);
					}

					leg_cust.arr[0] = '\0';
				
//Rajesh less payable by payer in credit bill

					d2_cust_code.arr[0]='\0';
					d2_cust_code.len = 0;  
					l_tot_var_payable = 0;
					strcpy(d2_cust_code.arr,d_oth_cust_code.arr);
					d2_cust_code.len=strlen(d_oth_cust_code.arr);
					d2_cust_code.arr[d2_cust_code.len]='\0';
					d2_cust_group_code.arr[0]='\0';
					d2_cust_group_code.len = 0;
					d2_priority=d_oth_priority;
					
					get_closed_packages();

					d_other_bill_amt=d_other_bill_amt+l_tot_var_payable+l_tot_var_tax ;
// upto here					
					put_val(ar_amt[0],d_other_bill_amt); 
					nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+d_other_bill_amt;
					format_amt(ar_amt[0]);
					fprintf(fp," %15s  %-20s\n",ar_amt[0],d_oth_doc_type_code.arr);
				}

			  }

			  close_other_payer_amt_for_payer();

			  lsr_line_cnt();

		}

	/*******upto here*********/


		if (strcmp(p_oth_payers_amt_print_row_ind.arr,"S")==0)
		{
		   get_sum_of_other_payer_amt();
		  
		  if(nd_tot_oth_payer_amt!=0)
		  {
	
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {		
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s ",loc_legend[810]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-62.62s ",loc_legend[810]);
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {		
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s ",loc_legend[810]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-44.44s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp," %-44.44s ",loc_legend[810]);
			 }
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {	
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s ",loc_legend[810]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-52.52s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp," %-52.52s ",loc_legend[810]);
			}
			print_formated_amt(nd_tot_oth_payer_amt+d_pk_pack_tot_n_amount);
			fprintf(fp,"\n"); //lsr_line_cnt();
		  }
		}
	
		if (strcmp(p_patient_amt_print_row_ind.arr,"R")==0)
		{

		     l_cust_code.arr[0] ='\0';

			 //get_bill_num(2);
           			
		  //if(pat_upd_net_charge_amt!=0)  //always it has to print
		  //{
		    if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[760]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp," %-61.61s",loc_legend[760]);
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[760]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-44.44s",loc_legend[760]);
			 }
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[760]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-52.52s",loc_legend[760]);
			}

// The below code added by Rajesh to get the correct amount of less payable by patient 

d2_cust_code.arr[0]='\0';
d2_cust_code.len=0;
d2_cust_group_code.arr[0]='\0';
d2_cust_group_code.len=0;

get_closed_packages();

pat_upd_net_charge_amt=pat_upd_net_charge_amt+l_tot_pkg_payable ;

//upto here

			print_formated_amt(pat_upd_net_charge_amt);
			fprintf(fp,"%-s",l_pat_bill_num.arr);
			fprintf(fp,"\n"); //lsr_line_cnt();
          //}
		}
		
		
		if (strcmp(p_addl_charge_amt_ind.arr,"R")==0||strcmp(p_addl_charge_amt_ind.arr,"B")==0)  //1st place for Tax Row Level
		{
			strcpy(d2_cust_code.arr,d_cust_code.arr);
			d2_cust_code.len=strlen(d_cust_code.arr);
			d2_cust_code.arr[d2_cust_code.len]='\0';
			d2_priority=d_priority;
			get_closed_packages();
					
			declare_tax_pkg();
		   open_tax_breakup_pkg();
		   fetch_tax_breakup_cur_pkg();
		   close_tax_break_cur_pkg();

		  //if(nd_total_addl_charge!=0) //IN24100
		  if((nd_total_addl_charge+d_tax_amt_pkg)!=0)  //IN24100
		  {
			  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			  {
			  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-63.63s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-63.63s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				    fprintf(fp,"%-63.63s",loc_legend[1230]);
			   }
			  else
			  {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-63.63s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-63.63s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp,"%-63.63s",loc_legend[1230]);
			  }
			  }
			  else
			  {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp,"%-53.53s",loc_legend[1230]);
			   }
			   //disp_message(ERR_MESG,"tax22");
			  //sprintf(st_var,"[%f] [%f] [%f]",nd_total_addl_charge,d_tax_amt_pkg,l_tot_var_tax);
			  //disp_message(ERR_MESG,st_var);
			  print_formated_amt(nd_total_addl_charge+d_tax_amt_pkg+l_tot_var_tax);
			  fprintf(fp,"\n"); //lsr_line_cnt();
		  }
		}

		if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
		{
				
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-62.62s",loc_legend[740]);
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp,"%-45.45s",loc_legend[740]);
			 }
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-53.53s",loc_legend[740]);
			}

			nd_net_payable = nd_net_payable + d_pk_pack_tot_n_amount; //Rajesh added package net payable
			print_formated_amt(nd_net_payable);
			fprintf(fp,"\n");lsr_line_cnt();
			get_rounded_amt(nd_net_payable);

	/*ADDED FOR SCRUM CRF-654*/
	   if (d_tot_outst_amt!=0)
	   {
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				 { 
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[993]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
                                          }
                                 else
                			  {
					fprintf(fp," %-62.62s",loc_legend[993]);
                                          }
				 }
				else 
				 {
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				  {
				   nd_temp_str.arr[0]='\0';
				   nd_temp_str.len=0;
				   sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[993]);
				   fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				   fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
				   }
                                else
				 {
				fprintf(fp,"%-45.45s",loc_legend[993]);
				 }
				 } 
			}
			else
			{
            if(strcmp(nd_pad_req_yn.arr,"Y")==0)
 			{
         			   nd_temp_str.arr[0]='\0';
				   nd_temp_str.len=0;
				   sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[993]);
				   fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				   fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
                          }     
                       else
                        {
			fprintf(fp,"%-53.53s",loc_legend[993]);
			}
			print_formated_amt(d_tot_outst_amt);
			fprintf(fp,"\n");lsr_line_cnt();
			//get_rounded_amt(d_tot_outst_amt);
			}
           } 
          /*ADDED FOR SCRUM CRF-654*/


		   if(nd_rounded_amt!=0)
		   {
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-63.63s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-63.63s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-63.63s",loc_legend[1240]);
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-45.45s",loc_legend[1240]);
			 }
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-53.53s",loc_legend[1240]);
			}
			
			print_formated_amt(nd_rounded_amt);
			fprintf(fp,"\n");lsr_line_cnt();

			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-63.63s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-63.63s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-63.63s",loc_legend[1250]);
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-45.45s",loc_legend[1250]);
			 }
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
 				}
				else
			        fprintf(fp,"%-53.53s",loc_legend[1250]);
			}

			print_formated_amt(nd_net_pay_amt_after_rounded);
			fprintf(fp,"\n"); //lsr_line_cnt();
		   }

			/*
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0)
			{
			 fprintf(fp,"%-53.53s",loc_legend[1150]);
			 print_formated_amt(d_bill_paid_amt);
			 fprintf(fp,"\n"); //lsr_line_cnt();
			}
			*/
		}


	/***** added on 30/09/2008 for printing package deposit if it is there ********/ 
// The Below code commented by Rajesh, Now package deposit we are not showing in Footer part
/*
		if(l_pkg_len!=0)
		{
		   
			for(i=1;i<=l_pkg_len;i++)
			{
			  l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]);
			  if(l_pkg_dep_amt!=0)
			  {
			   l_pkg_dep_exist=1; 
			   break;
			  }
			}
		   
		   if(l_pkg_dep_exist==1)
		   {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
					if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1260]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																					
						}
						 else
					       fprintf(fp,"%-62.62s",loc_legend[1260]);
					}
					else
					{
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[1260]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp,"%-44.44s",loc_legend[1260]);
					}
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp,"%-52.52s",loc_legend[1260]);
				}
				fprintf(fp,"\n");lsr_line_cnt(); 
		   
		
				for(i=1;i<=l_pkg_len;i++)
				{
				    l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]);	//atoi function will convert string to double
				    if(l_pkg_dep_amt!=0)
					{
							if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 &&(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0))
							{
								 if((strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)&&(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0))
								 {
                                     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-32.32s",loc_legend[1290]);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
									    fprintf(fp,"       %-32.32s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
									  }
									   else
									       fprintf(fp,"       %-32.32s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
								  }
								 else
								 {
								   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 								        fprintf(fp,"       %-21.21s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);																																																								
									 }
									  else
								         fprintf(fp,"       %-21.21s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
								 }
							}
						print_formated_amt(l_pkg_dep_amt);
						fprintf(fp,"\n"); //lsr_line_cnt(); 
					}
				}
			}
		}
*/ 
//UPTO HERE
	   /***** Printing the Bill Adjustments Amts *****/
	   
	        /* COMMENTED FOR SCRUM CRF-654
        if(strcmp(p_all_oth_adj_amt_row_ind.arr,"R")==0)  
		{
          if((d1_tot_adjust_amt!=0)||(strcmp(p_print_zero_other_adj_yn.arr,"Y")==0))
		  {
		   if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		   {
		   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
		   {
		      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp," %-62.62s",loc_legend[780]);
			}
		   else
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-44.44s",loc_legend[780]);
			}
		   }
		   else
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp," %-52.52s",loc_legend[780]);
			}
           print_formated_amt(d1_tot_adjust_amt);
		   fprintf(fp,"\n"); //lsr_line_cnt();
		  }


   		  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
		  { 
		  
		   if((nd_tot_disc_amount)!=0)
			 {
			 
			  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			  {
			  
			  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			  
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[790]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp," %-62.62s",loc_legend[790]);
			   }
			  else
			  {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[790]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp," %-44.44s",loc_legend[790]);
			   }
			  }
			  else
			  {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[790]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else 
				 fprintf(fp," %-52.52s",loc_legend[790]);
			   }
			  print_formated_amt(nd_tot_disc_amount);
			  fprintf(fp,"\n"); //lsr_line_cnt();
			 }
			
		  }

		  if(d1_bill_tot_exmpt_amt!=0)
		  {
		   if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		   {
		   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[720]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			    fprintf(fp," %-62.62s",loc_legend[720]);
			}
		   else
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[720]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			  fprintf(fp," %-44.44s",loc_legend[720]);
			}
		   }
		   else
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[720]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			  fprintf(fp," %-52.52s",loc_legend[720]);
			}
           print_formated_amt(d1_bill_tot_exmpt_amt);
		   fprintf(fp,"\n"); //lsr_line_cnt();
		  }

		  if(d1_tot_write_off_amt!=0)
		  {
		   if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		   {
		   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[800]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			   fprintf(fp," %-62.62s",loc_legend[800]);
			}
		   else
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[800]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			   fprintf(fp," %-44.44s",loc_legend[800]);
			}
		   }
		   else
		   {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[800]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			   fprintf(fp," %-52.52s",loc_legend[800]);
			}
           print_formated_amt(d1_tot_write_off_amt);
		   fprintf(fp,"\n"); //lsr_line_cnt();
		  }
        }
		  COMMENTED FOR SCRUM CRF-654 */

	 /****** Printing the Bill Adjustments Amts as Summarized Row******/
       //if (strcmp(p_all_oth_adj_amt_row_ind.arr,"S")==0)   COMMENTED FOR SCRUM CRF-654
	   //{ COMMENTED FOR SCRUM CRF-654
	   
	   /*COMMENTED FOR SCRUM CRF-654
		  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
		  {
			   if(d1_tot_adjust_amt!=0 || nd_tot_disc_amount!=0 || d1_bill_tot_exmpt_amt!=0 || d1_tot_write_off_amt!=0)
			   {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-49.49s",loc_legend[850]);
				}
				else
				{
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					 else
				        fprintf(fp," %-41.41s",loc_legend[850]);
				 }
				}
				else
				{
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[850]);
				}
				print_formated_amt(d1_tot_adjust_amt+nd_tot_disc_amount+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			   }
		  }
		   COMMENTED FOR SCRUM CRF-654*/
		   
		  /**** Discount Not printing when program is calling from No-Discount Funstions ****/
		 // else COMMENTED FOR SCRUM CRF-654
		  /*{ COMMENTED FOR SCRUM CRF-654
			   if(d1_tot_adjust_amt!=0 ||d1_bill_tot_exmpt_amt!=0 || d1_tot_write_off_amt!=0)
			   {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
				{
                   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[850]);
				}
				else
				{
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
						 																																														
					}
					else
                         fprintf(fp," %-41.41s",loc_legend[850]);
				 }
				}
				else
				{
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[850]);
				}
				print_formated_amt(d1_tot_adjust_amt+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			   }
		  }
          COMMENTED FOR SCRUM CRF-654*/		   
 
		   /*
		   if (strcmp(p_bill_adj_sep_row_yn.arr,"Y")==0 || strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0||
			   strcmp(p_bill_exm_sep_row_yn.arr,"Y")==0 || strcmp(p_bill_wo_sep_row_yn.arr,"Y")==0 )
		   {
			   fprintf(fp," %-49.49s",loc_legend[850]);
			   if (strcmp(p_bill_adj_sep_row_yn.arr,"Y")==0)
			   {
			    if(d1_tot_adjust_amt!=0)
				nd1_tot_adjust_amt=nd1_tot_adjust_amt+d1_tot_adjust_amt;
			   }
			   
			   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			   if (strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0)
			   {
			    if(nd_tot_disc_amount!=0)
				nd1_tot_adjust_amt=nd1_tot_adjust_amt+nd_tot_disc_amount;
			   }
			   if (strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0)
			   {
			     if(d1_bill_tot_exmpt_amt!=0)
				 nd1_tot_adjust_amt=nd1_tot_adjust_amt+d1_bill_tot_exmpt_amt;
			   }
			   if (strcmp(p_bill_wo_sep_row_yn.arr,"Y")==0)
			   {
			     if(d1_tot_write_off_amt!=0)
				 nd1_tot_adjust_amt=nd1_tot_adjust_amt+d1_tot_write_off_amt;
			   }
			   fprintf(fp,"\n");lsr_line_cnt();
		
          
		   }
		   */
		  
		  

		  /*	COMMENTED FOR SCRUM CRF-654		  
		   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
		   if (strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0)
			{
			
			  if((nd_tot_disc_amount)!=0)
			  { 
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[790]);
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else  
				        fprintf(fp," %-41.41s",loc_legend[790]);
				}

				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[790]);
				}
				print_formated_amt(nd_tot_disc_amount);
				fprintf(fp,"\n");lsr_line_cnt();
			   }
			}

			if (strcmp(p_bill_adj_sep_row_yn.arr,"Y")==0)
			{
			  if((d1_tot_adjust_amt!=0)|| (strcmp(p_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
			  {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-62.62s",loc_legend[780]);
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-44.44s",loc_legend[780]);
				 }
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-52.52s",loc_legend[780]);
				}
				print_formated_amt(d1_tot_adjust_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			  }	
			  
			}


			if (strcmp(p_bill_exm_sep_row_yn.arr,"Y")==0)
			{
			  if(d1_bill_tot_exmpt_amt!=0)
			  {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					     fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[720]);
				}
				else
				{
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-41.41s",loc_legend[720]);
				 }
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-49.49s",loc_legend[720]);
				}
				print_formated_amt(d1_bill_tot_exmpt_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			  }
			}

			if (strcmp(p_bill_wo_sep_row_yn.arr,"Y")==0)
			{
			  if(d1_tot_write_off_amt!=0)
			  {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-49.49s",loc_legend[800]);
				 }

				else
				{
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else 
					    fprintf(fp," %-41.41s",loc_legend[800]);
				 }
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[800]);
				}
				print_formated_amt(d1_tot_write_off_amt);
				fprintf(fp,"\n");lsr_line_cnt();
              }
			}
         }
	 
		 COMMENTED FOR SCRUM CRF-654*/	
       	if(strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS2")==0 ||strcmp(nd_calling_pgm_id.arr,"BLRIPDS3")==0 ||strcmp(nd_calling_pgm_id.arr,"BLRUCDS3")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLR00101")==0 || // added for scrum crf-654
		strcmp(l_no_settlement_details.arr,"R")==0 || strcmp(l_no_settlement_details.arr,"N")==0)
		{
			/***** Printing Deposit Amt as Row ****
			if(d_deposit_adj_amt!=0)
			{
			if(strcmp(d_cust_code.arr,"\0")==0) //added for scrum crf-654
			{ //added for scrum crf-654
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						//sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[880]); commented for scrum crf-654
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[992]); //added for scrum crf-654
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        //fprintf(fp," %-49.49s",loc_legend[880]); commented for scrum crf-654
						fprintf(fp," %-49.49s",loc_legend[992]);  //added for scrum crf-654
				}
				else
				{
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						//sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[880]); commented for scrum crf-654
						 sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[992]); //added for scrum crf-654
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       //fprintf(fp," %-41.41s",loc_legend[880]); commented for scrum crf-654
					     fprintf(fp," %-41.41s",loc_legend[992]);  //added for scrum crf-654
				 }
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						//sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[880]); commented for scrum crf-654
						 sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[992]); //added for scrum crf-654
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
 					}
					else  
				      //fprintf(fp," %-49.49s",loc_legend[880]); commented for scrum crf-654
					   fprintf(fp," %-49.49s",loc_legend[992]);  //added for scrum crf-654
				}
				print_formated_amt(d_deposit_adj_amt);
				fprintf(fp,"\n");lsr_line_cnt();
				}          //added for scrum crf-654

			} */



			
			/***** Printing Bill Paid Amt as Row *****/
			if(d_bill_paid_amt!=0)
			{
				 if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				 {
				 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[1150]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[1150]);
				 }
				 else
				 {
				     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[1150]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					     fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-41.41s",loc_legend[1150]);
				  }
				 }
				 else
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[1150]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-49.49s",loc_legend[1150]);
				  }
				 print_formated_amt(d_bill_paid_amt);
				 fprintf(fp,"\n");lsr_line_cnt();
			}
		
			/***** Printing Outstanding Amt as Row *****/
			
			//disp_message(ERR_MESG,"Outstanding Amount by Payer");

			
		//	if(d_bill_tot_outst_amt!=0)  //crf-659-resend_1
		//	{
		    
        // if(strcmp(d_cust_code.arr,"\0")==0) // added for scrum crf-654 remerging
			//	{                   // added for scrum crf-654	 remerging
				if((strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)&&(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0))
				{ 
		 		  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[890]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					        fprintf(fp," %-45.45s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																					
						}
						else   
					       fprintf(fp," %-45.45s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				 }
				else
				{
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-35.35s",loc_legend[890]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp," %-35.35s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																				
					}
					else
				       fprintf(fp," %-35.35s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				}
				
				//disp_message(ERR_MESG,"111");
				//sprintf(st_var,"[%f] [%f] [%f]",d_bill_tot_outst_amt,d_pk_variance_amt,l_tot_var_tax);
				//disp_message(ERR_MESG,st_var);

				d_bill_tot_outst_amt = d_bill_tot_outst_amt+ d_pk_variance_amt+l_tot_var_tax; //rajesh
				print_formated_amt(d_bill_tot_outst_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			//	}        // added for scrum crf-654  remerging
		//	}
			
		}
	   

	  if(nd_net_pay_amt_after_rounded!=0)
	  {
	  if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
	   amount=nd_net_pay_amt_after_rounded;
	  else
	   amount=nd_net_pay_amt_after_rounded+ d_pk_pack_tot_n_amount;
	   print_amt_in_words();
	  }
	  else
      {
	  if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
	   amount=nd_net_payable;
	  else
	   amount=nd_net_payable+ d_pk_pack_tot_n_amount;
	   print_amt_in_words();
	  }	
	   /***** Upto here *****/
	
	}
	else
	{
       		if(p_disc_amt_in_dtl_yn.arr[0]=='N' && p_servdate_in_dtlformat_yn.arr[0]=='Y')
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			 {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
    			    fprintf(fp,"%-62.62s",loc_legend[680]);
			 }
			 else
			 {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp,"%-44.44s",loc_legend[680]);
             }
			 print_formated_amt(nd_tot_serv_tot_disc);
			 }
			}
			else
			if(p_disc_amt_in_dtl_yn.arr[0]=='N' && p_servdate_in_dtlformat_yn.arr[0]=='N')
			{
              if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
                    fprintf(fp,"%-53.53s",loc_legend[680]);
			 print_formated_amt(nd_tot_serv_tot_disc);
			 amount=nd_tot_serv_tot_disc;
			 print_amt_in_words();
			}
			else
			{
			 fprintf(fp,"%-42.42s"," ");
			 print_formated_amt(nd_tot_serv_charge_discount);
			 print_formated_amt(nd_tot_serv_bill_discount);
			 print_formated_amt(nd_tot_serv_fund_adjustment);
			 fprintf(fp,"\n");lsr_line_cnt();
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			 fprintf(fp,"%-42.42s",loc_legend[680]);
			 print_formated_amt(nd_tot_serv_charge_discount+nd_tot_serv_bill_discount+nd_tot_serv_fund_adjustment);
			 amount=nd_tot_serv_charge_discount+nd_tot_serv_bill_discount+nd_tot_serv_fund_adjustment;
			 print_amt_in_words();

			}

	}
		//print_footer(); //commented Kuila sir	as per the instruction 
		
		//close_grp_hdr_cur(); // Rajesh
		declare_payer_approval();  //Rajesh	
		open_payer_approval();     //Rajesh	
		print_sign_designation();
		close_grp_hdr_cur(); //added by Rajesh
	    close_payer_approval(); 
			
		
	    /**** Below code added by raghava on 15/10/2009 for CRF-518(siriraj) *****/
		 //print_alter_id_num('I'); COMMENTED FOR SCRUM REMERGING ALTER ID NOT REQ.
		/*****  CRF-518(siriraj) *****/	
		if (strcmp(nd_bill_format_id.arr,"1")==0)
		if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
		{
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
					
				fun_Pad_desc_with_spl_char(loc_legend[1425]);
				fprintf(fp,"\n%-64.64s %-s"," ",nd_desc_with_spl_chr.arr);
				fun_Pad_desc_with_spl_char(loc_legend[1424]);
				fprintf(fp,"  %-s %-s\n"," ",nd_desc_with_spl_chr.arr);																															
			}
			else
		      fprintf(fp,"\n%-64.64s %-s  %-s %-s\n"," ",loc_legend[1425],nd_curr_date_t.arr,loc_legend[1424]);
		}
		if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0) //IN13383
		print_footer1();
		


 }

 /* THIS ELSE CONDITION WILL EXECUTE IF THE PATIENT DOES NOT HAVE CUSTOMER */

else
if(strcmp(d_cust_code.arr,"\0")==0) 
{
  
	fetch_single_bill_format_bg();

 if(strcmp(c_bill_subsidized_amt_ind.arr,"\0")==0)
	strcpy(c_bill_subsidized_amt_ind.arr,"N");

 if (strcmp(d_adm_rec_flag.arr,"2")==0)
//if (v_c_billed_serv=='Y')
 {
     	   
	   get_column_count_pat();
	   
	   print_report_head();

	   if (strcmp(nd_bill_format_id.arr,"2")==0) //added for IN23425
		 {
			v_lno = line_ctr;	
		 }

	   l_next_page=3;   
	   nd_cust_code1.arr[0] ='\0';

  /***** Added for CRF-440 (Discount Document Report *****/

  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
  {
     	
		
	 if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='N')
	 {
	  if(nd_print_option.arr[0]=='R')
	  {
	   strcat(nd_line_text.arr,loc_legend[110]);
	   if(strlen(loc_legend[110])<55)
       fun_add_space(55-strlen(loc_legend[110]));
	   fun_add_space(1);
	   if(strlen(loc_legend[840])<17)
       fun_add_space(17-strlen(loc_legend[840]));
	   strcat(nd_line_text.arr,loc_legend[840]);
	  }
	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
		 {
			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[110]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 		    fprintf(fp,"%-55.55s ",nd_desc_with_spl_chr.arr);
			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 		    fprintf(fp," %17.17s",nd_desc_with_spl_chr.arr);																																																	
		}
		else 
	      fprintf(fp,"%-55.55s %17.17s",loc_legend[110],loc_legend[840]);
	 }
	 if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='Y')
	 {
	 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
	 {
	  if(nd_print_option.arr[0]=='R')
	  {
	   strcat(nd_line_text.arr,loc_legend[110]);
	   if(strlen(loc_legend[110])<24)
	   fun_add_space(24-strlen(loc_legend[110]));
	   fun_add_space(1);
	   strcat(nd_line_text.arr,loc_legend[1402]);
	   if(strlen(loc_legend[1402])<15)
	   fun_add_space(15-strlen(loc_legend[1402]));
	   fun_add_space(1);
	   if(strlen(loc_legend[1405])<3)
	   fun_add_space(3-strlen(loc_legend[1405]));
       strcat(nd_line_text.arr,loc_legend[1405]);
	   if(strlen(loc_legend[1406])<15)
	   fun_add_space(15-strlen(loc_legend[1406]));
	   strcat(nd_line_text.arr,loc_legend[1406]);
	   fun_add_space(1);
	   if(strlen(loc_legend[840])<17)
	   fun_add_space(17-strlen(loc_legend[840]));
	   strcat(nd_line_text.arr,loc_legend[840]);
	  }

	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
		 {
			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	        fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	        fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);

			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	        fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);	

			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1406]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	        fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);

			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																																																					
		}
		else
	      fprintf(fp,"%-24.24s %-15.15s %3.3s%15.15s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[840]);
	 }
	 else
	 {
	  if(nd_print_option.arr[0]=='R')
	  {
	   strcat(nd_line_text.arr,loc_legend[110]);
	   if(strlen(loc_legend[110])<24)
	   fun_add_space(24-strlen(loc_legend[110]));
	   fun_add_space(1);
	   strcat(nd_line_text.arr,loc_legend[1402]);
	   if(strlen(loc_legend[1402])<15)
	   fun_add_space(15-strlen(loc_legend[1402]));
	   fun_add_space(1);
	   if(strlen(loc_legend[1405])<3)
	   fun_add_space(3-strlen(loc_legend[1405]));
       strcat(nd_line_text.arr,loc_legend[1405]);
	   fun_add_space(1);
	   if(strlen(loc_legend[840])<17)
	   fun_add_space(17-strlen(loc_legend[840]));
	   strcat(nd_line_text.arr,loc_legend[840]);
	  }
	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
	 {
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[1402]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
		
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
		
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 	    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
 																																																
	}
	else
	  fprintf(fp,"%-24.24s %-15.15s %3.3s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[840]);
	 } 
	 }
	 if(c_disc_amt_in_dtl_yn.arr[0]=='Y')
	 {
	  if(nd_print_option.arr[0]=='R')
	  {
	   strcat(nd_line_text.arr,loc_legend[110]);
	   if(strlen(loc_legend[110])<33)
	   fun_add_space(33-strlen(loc_legend[110]));
	   fun_add_space(1);
	   if(strlen(loc_legend[1402])<21)
	   fun_add_space(21-strlen(loc_legend[1402]));
	   strcat(nd_line_text.arr,loc_legend[1402]);
	   fun_add_space(1);
	   if(strlen(loc_legend[1421])<3)
	   fun_add_space(17-strlen(loc_legend[1421]));
       strcat(nd_line_text.arr,loc_legend[1421]);
	   fun_add_space(1);
	   if(strlen(loc_legend[1422])<17)
	   fun_add_space(17-strlen(loc_legend[1422]));
	   strcat(nd_line_text.arr,loc_legend[1422]);
	  }
	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
		 {
			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
			fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);

			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%21.21s",loc_legend[1420]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
			fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);

			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%17.17s",loc_legend[1421]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
			fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%17.17s",loc_legend[1422]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
			fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
   																																																	
		}
		else
	        fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s",loc_legend[110],loc_legend[1420],loc_legend[1421],loc_legend[1422]);
     }
  }
 /***** UPTO Added for CRF-440 (Discount Document Report) *****/
  else
  {
 
	
		if (strcmp(c_bill_net_payable_ind.arr,"R")==0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)   
		    && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
			{	
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				{
				  if(nd_print_option.arr[0]=='R')
				  {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<34)
				   fun_add_space(34-strlen(loc_legend[110]));
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<21)
				   fun_add_space(21-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[750])<17)
				   fun_add_space(17-strlen(loc_legend[750]));
				   strcat(nd_line_text.arr,loc_legend[750]);
	
				  }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-34.34s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-34.34s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
  																																																			
				}
				else
				  fprintf(fp,"%-34.34s %21.21s %17.17s",loc_legend[110],loc_legend[680],loc_legend[750]);
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				  {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<34)
				   fun_add_space(34-strlen(loc_legend[110]));
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<21)
				   fun_add_space(21-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);

				  }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-34.34s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-34.34s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);																																																			
				}
				else
				 fprintf(fp,"%-34.34s %21.21s ",loc_legend[110],loc_legend[680]);
				}
		    }

		 if(strcmp(c_bill_net_payable_ind.arr,"R")==0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0) 
		   &&  (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		  {
			
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{
				get_discount_count();
				if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					{
					  if(nd_print_option.arr[0]=='R')
					  {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<33)
					   fun_add_space(33-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<21)
					   fun_add_space(21-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
					   fun_add_space(1);
					   if(strlen(loc_legend[750])<17)
					   fun_add_space(17-strlen(loc_legend[750]));
					   strcat(nd_line_text.arr,loc_legend[750]);

					  }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);						
 					}
					else
					 fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[750]);
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					  {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<33)
					   fun_add_space(33-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<21)
					   fun_add_space(21-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
					   
					  }
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-21.21s ",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-17.17s",loc_legend[840]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-17.17s ",nd_desc_with_spl_chr.arr);						
 					}
					else
					  fprintf(fp,"%-33.33s %21.21s %17.17s ",loc_legend[110],loc_legend[680],loc_legend[840]);
					}
				}   
			}
			else
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				{
				  if(nd_print_option.arr[0]=='R')
				  {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<21)
				   fun_add_space(21-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[750])<17)
				   fun_add_space(17-strlen(loc_legend[750]));
				   strcat(nd_line_text.arr,loc_legend[750]);
				   
				  }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					{
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
					}
					else
				 fprintf(fp,"%-33.33s %21.21s %17.17s",loc_legend[110],loc_legend[680],loc_legend[750]);
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				  {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<21)
				   fun_add_space(21-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   
				  }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);
 				}
				else
				 fprintf(fp,"%-33.33s %21.21s ",loc_legend[110],loc_legend[680]);
				}
			}
		  }
		if (strcmp(c_bill_net_payable_ind.arr,"R")==0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0)
		  && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))  
			{
			if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			    if(nd_print_option.arr[0]=='R')
				{
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<24)
				   fun_add_space(24-strlen(loc_legend[110]));
				   fun_add_space(1);
				   strcat(nd_line_text.arr,loc_legend[1402]);
				   if(strlen(loc_legend[1402])<15)
				   fun_add_space(15-strlen(loc_legend[1402]));
				   fun_add_space(1);
				   if(strlen(loc_legend[1405])<3)
				   fun_add_space(3-strlen(loc_legend[1405]));
				   strcat(nd_line_text.arr,loc_legend[1405]);
				   if(strlen(loc_legend[1406])<11)
				   fun_add_space(11-strlen(loc_legend[1406]));
				   strcat(nd_line_text.arr,loc_legend[1406]);
				   if(strlen(loc_legend[680])<17)
				   fun_add_space(17-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   
				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
                    fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680]);
			   //fprintf(fp,"%-34.34s %-12.12s%19.19s \n",loc_legend[110],loc_legend[1402],loc_legend[680]); for discount doc
			  }
			  else
			  {
			    if(nd_print_option.arr[0]=='R')
				{
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<24)
				   fun_add_space(24-strlen(loc_legend[110]));
				   fun_add_space(1);
				   strcat(nd_line_text.arr,loc_legend[1402]);
				   if(strlen(loc_legend[1402])<15)
				   fun_add_space(15-strlen(loc_legend[1402]));
				   fun_add_space(3);
				   if(strlen(loc_legend[1405])<3)
				   fun_add_space(3-strlen(loc_legend[1405]));
				   strcat(nd_line_text.arr,loc_legend[1405]);
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<13)
				   fun_add_space(13-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   
				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                  	fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                  	fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);


					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                  	fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                  	fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
				}
				else
                 	fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680]);
			  }
			 }
			else
			{
			  if(nd_print_option.arr[0]=='R')
				{
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<21)
				   fun_add_space(21-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   
				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);
				}
				else
                   fprintf(fp,"%-33.33s %21.21s ",loc_legend[110],loc_legend[680]);
			}
		   }
		if (strcmp(c_bill_net_payable_ind.arr,"R")==0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0) 
		   && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))  
		 {
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{
				get_discount_count();
				if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{
				 if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				 {
				  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
 				  {
				    if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(1);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   fun_add_space(1);
					   if(strlen(loc_legend[1406])<11)
					   fun_add_space(11-strlen(loc_legend[1406]));
					   strcat(nd_line_text.arr,loc_legend[1406]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
				       fun_add_space(1);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
				    }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);						
					}
					else
				      fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840]);
				  }
				  else
				  {
				    if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(3);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<13)
					   fun_add_space(13-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
				       fun_add_space(1);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
				    }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);

						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);						

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
					}
					else
				      fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840]);
				  }
				 }
				 else
				 {
				    if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<33)
					   fun_add_space(33-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<21)
					   fun_add_space(21-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
				       fun_add_space(1);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
				    }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-33.33s %21.21s %17.17s",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
 				}
				else
				  fprintf(fp,"%-33.33s %21.21s %17.17s",loc_legend[110],loc_legend[680],loc_legend[840]);
                 }
				}
			    else
				{
				 if(nd_print_option.arr[0]=='R')
				  {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<33)
					   fun_add_space(33-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<21)
					   fun_add_space(21-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
				       fun_add_space(1);
	
				  }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);																																																			
				}
				else
				 fprintf(fp,"%-33.33s %21.21s ",loc_legend[110],loc_legend[680]);
				}
				
			}
				
		 }
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0 )
		   && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		{		
			
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{
			   get_addlcharge_count();
				if ((strcmp(c_addl_charge_amt_ind.arr,"C")==0) &&(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )) 
				{
				 if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{
				
				   if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<37)
					   fun_add_space(37-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[1230])<11)
					   fun_add_space(11-strlen(loc_legend[1230]));
					   strcat(nd_line_text.arr,loc_legend[1230]);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
				    }
	                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-37.37s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-37.37s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1230]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%11.11s",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
 																																																				
					}
					else
				      fprintf(fp,"%-37.37s %11.11s%17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[840],loc_legend[690]);
				  l_no_of_clumns =5;
				 }
				 else
				 {
					if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<37)
					   fun_add_space(37-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[1230])<11)
					   fun_add_space(11-strlen(loc_legend[1230]));
					   strcat(nd_line_text.arr,loc_legend[1230]);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
				    }
			          if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-37.37s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%-37.37s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1230]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%11.11s",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);				
					}
					else
				       fprintf(fp,"%-37.37s %11.11s%17.17s %17.17s",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
				 }
				}
				else
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				get_discount_count();
				 if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				 {
				   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				   {
				    if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(1);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   if(strlen(loc_legend[1406])<11)
					   fun_add_space(11-strlen(loc_legend[1406]));
					   strcat(nd_line_text.arr,loc_legend[1406]);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
				    }
			         if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    	fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    	fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
												
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    	fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    	fprintf(fp,"%11.11s",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    	fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
					

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    	fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);					

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    	fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																																	
					}
					else
					fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s%17.17s%17.17s%17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690]);
				    //fprintf(fp,"%-34.34s %-12.12s%19.19s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[680],loc_legend[840],loc_legend[690]); for discount doc
				   }
				   else
				   {
				    if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(3);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   if(strlen(loc_legend[680])<13)
					   fun_add_space(13-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
		
				    }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%13.13s",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);  																																				
				}
				else
					fprintf(fp,"%-24.24s %-15.15s   %3.3s%13.13s%17.17s%17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690]);
				   }
				 l_no_of_clumns =4;
				 }
				 else
				 {
				  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				  {
				    if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   if(strlen(loc_legend[1406])<11)
					   fun_add_space(11-strlen(loc_legend[1406]));
					   strcat(nd_line_text.arr,loc_legend[1406]);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
				    }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-24.24s",nd_desc_with_spl_chr.arr);
						 
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-15.15s",nd_desc_with_spl_chr.arr);						 
						 
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);						 
						 
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%11.11s",nd_desc_with_spl_chr.arr);						 
						 
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);						 
						 
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
					}
					else
				       fprintf(fp,"%-24.24s%-15.15s%3.3s%11.11s%17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
				  }
				  else
				  {
				    if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(2);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   if(strlen(loc_legend[680])<13)
					   fun_add_space(13-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);

				    }
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%-24.24s",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%-15.15s  ",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);						
 					}
					else
				   fprintf(fp,"%-24.24s%-15.15s  %3.3s%13.13s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
				  }
				 
				 }
				}
				else
				{
				get_discount_count();
				 if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				 {
				  if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<33)
					   fun_add_space(33-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<21)
					   fun_add_space(21-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
				       fun_add_space(1);
					   if(strlen(loc_legend[840])<17)
					   fun_add_space(17-strlen(loc_legend[840]));
					   strcat(nd_line_text.arr,loc_legend[840]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
				    }
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s\n",nd_desc_with_spl_chr.arr);																																																
					}
					else
				     fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
				 }
				 else
				 {
				   if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<35)
					   fun_add_space(35-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<18)
					   fun_add_space(18-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
				       fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
	
				    }
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-35.35s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%-35.35s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																										
					}
					else
				  fprintf(fp,"%-35.35s %18.18s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690]);
				 }
				}
			}
			else
			{
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0) //vani
				{
				 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				 { 
				   if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(1);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   if(strlen(loc_legend[1406])<11)
					   fun_add_space(11-strlen(loc_legend[1406]));
					   strcat(nd_line_text.arr,loc_legend[1406]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
				    }
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-26.26s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
 				}
				else
				  fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]); 
				 }
				 else
				 {
				  if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(3);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<13)
					   fun_add_space(13-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
		
				    }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
												
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
												
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																														
					}
					else
				      fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]); 
				 }
				 
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				    {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<35)
					   fun_add_space(35-strlen(loc_legend[110]));
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<18)
					   fun_add_space(18-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
				       fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
	
				    }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-35.35s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%-35.35s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
 					}
					else
				      fprintf(fp,"%-35.35s %18.18s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690]);
				}
			
			}
		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0)
		     && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0)
			 && strcmp(c_addl_charge_amt_ind.arr,"C")!=0)
			 {
			 if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0) //vvvvvvvvvvvvvvv
			 {
			  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			   if(nd_print_option.arr[0]=='R')
				{
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<24)
				   fun_add_space(24-strlen(loc_legend[110]));
				   fun_add_space(1);
				   strcat(nd_line_text.arr,loc_legend[1402]);
				   if(strlen(loc_legend[1402])<15)
				   fun_add_space(15-strlen(loc_legend[1402]));
				   fun_add_space(1);
				   if(strlen(loc_legend[1405])<3)
				   fun_add_space(3-strlen(loc_legend[1405]));
				   strcat(nd_line_text.arr,loc_legend[1405]);
				   if(strlen(loc_legend[1406])<11)
				   fun_add_space(11-strlen(loc_legend[1406]));
				   strcat(nd_line_text.arr,loc_legend[1406]);
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<17)
				   fun_add_space(17-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
	
				}
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
					

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);										
				    
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);										
				}
				else
			       fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
			  }
			  else
			  {
			   if(nd_print_option.arr[0]=='R')
				{
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<24)
				   fun_add_space(24-strlen(loc_legend[110]));
				   fun_add_space(1);
				   strcat(nd_line_text.arr,loc_legend[1402]);
				   if(strlen(loc_legend[1402])<15)
				   fun_add_space(15-strlen(loc_legend[1402]));
				   fun_add_space(3);
				   if(strlen(loc_legend[1405])<3)
				   fun_add_space(3-strlen(loc_legend[1405]));
				   strcat(nd_line_text.arr,loc_legend[1405]);
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<13)
				   fun_add_space(13-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
		
				}
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																														
				}
				else
			   fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
			   //fprintf(fp,"%-35.35s%-12.12s %18.18s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[680],loc_legend[690]); for discount doc
			   //l_no_of_clumns =5;
			  }
			 }
			 else
			 {
			  if(nd_print_option.arr[0]=='R')
				{
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<35)
				   fun_add_space(35-strlen(loc_legend[110]));
				   fun_add_space(2);
				   if(strlen(loc_legend[680])<18)
				   fun_add_space(18-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);

				}
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-35.35s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
			    fprintf(fp,"%-35.35s  ",nd_desc_with_spl_chr.arr);
				
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
			    fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);

				
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
			    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);																																																		
			}
			else
			  fprintf(fp,"%-35.35s  %18.18s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690]);
			 }
		    
			}

		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0)
			 && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0) 
			 && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
		{
			get_addlcharge_count();
			if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
			{
				if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
				{
					get_discount_count();
					if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
					{
						
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						{
							if(nd_print_option.arr[0]=='R')
							{
							   strcat(nd_line_text.arr,loc_legend[110]);
							   if(strlen(loc_legend[110])<33)
							   fun_add_space(33-strlen(loc_legend[110]));
							   fun_add_space(4);
							   if(strlen(loc_legend[1230])<15)
							   fun_add_space(15-strlen(loc_legend[1230]));
							   strcat(nd_line_text.arr,loc_legend[1230]);
							   if(strlen(loc_legend[680])<17)
							   fun_add_space(17-strlen(loc_legend[680]));
							   strcat(nd_line_text.arr,loc_legend[680]);
							   fun_add_space(1);
							   if(strlen(loc_legend[840])<17)
							   fun_add_space(17-strlen(loc_legend[840]));
							   strcat(nd_line_text.arr,loc_legend[840]);
							   fun_add_space(1);
							   if(strlen(loc_legend[690])<17)
							   fun_add_space(17-strlen(loc_legend[690]));
							   strcat(nd_line_text.arr,loc_legend[690]);
							   fun_add_space(1);
							   if(strlen(loc_legend[750])<17)
							   fun_add_space(17-strlen(loc_legend[750]));
							   strcat(nd_line_text.arr,loc_legend[750]);
							}
						   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
						        fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
								
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1230]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
						        fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);
								
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
						        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);								
																
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
						        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							 
							 
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
						        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							 
							 

								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
						        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);  																																														
							}
							else
						 fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						}
						else
						{
						 	if(nd_print_option.arr[0]=='R')
							{
							   strcat(nd_line_text.arr,loc_legend[110]);
							   if(strlen(loc_legend[110])<33)
							   fun_add_space(33-strlen(loc_legend[110]));
							   fun_add_space(4);
							   if(strlen(loc_legend[1230])<15)
							   fun_add_space(15-strlen(loc_legend[1230]));
							   strcat(nd_line_text.arr,loc_legend[1230]);
							   if(strlen(loc_legend[680])<17)
							   fun_add_space(17-strlen(loc_legend[680]));
							   strcat(nd_line_text.arr,loc_legend[680]);
							   fun_add_space(1);
							   if(strlen(loc_legend[840])<17)
							   fun_add_space(17-strlen(loc_legend[840]));
							   strcat(nd_line_text.arr,loc_legend[840]);
							   fun_add_space(1);
							   if(strlen(loc_legend[690])<17)
							   fun_add_space(17-strlen(loc_legend[690]));
							   strcat(nd_line_text.arr,loc_legend[690]);
							   fun_add_space(1);
				
							}
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1230]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);  																																		
						}
						else
						 fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[840],loc_legend[690]);
						}
					}
					else
					{
						
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						{
						 fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690],loc_legend[750]);
						}
						else
						{
						if(nd_print_option.arr[0]=='R')
						{
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(4);
						   if(strlen(loc_legend[1230])<15)
						   fun_add_space(15-strlen(loc_legend[1230]));
						   strcat(nd_line_text.arr,loc_legend[1230]);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
			
						}
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1230]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);  																																			
						}
						else
						 fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
					    }
					}
				}
				else
				{
					
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					{
					    if(nd_print_option.arr[0]=='R')
						{
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(4);
						   if(strlen(loc_legend[1230])<15)
						   fun_add_space(15-strlen(loc_legend[1230]));
						   strcat(nd_line_text.arr,loc_legend[1230]);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
			
						}
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1230]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);					
					
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																																				
					}
					else
					 fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690],loc_legend[750]);
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(4);
						   if(strlen(loc_legend[1230])<15)
						   fun_add_space(15-strlen(loc_legend[1230]));
						   strcat(nd_line_text.arr,loc_legend[1230]);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
			
					 }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1230]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);  																																							
					}
					else
					 fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
				    }
				}
			
				l_no_of_clumns =6;
			}
			else
			{
				if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
				{
					get_discount_count();
					if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
					{
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						{
						 if(nd_print_option.arr[0]=='R')
					     {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(4);
						   if(strlen(loc_legend[680])<15)
						   fun_add_space(15-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
			
					     }
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);
														

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
																																																				
						}
						else
						 fprintf(fp,"%-33.33s    %15.15s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						}
						else
						{
						 if(nd_print_option.arr[0]=='R')
					     {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(4);
						   if(strlen(loc_legend[680])<15)
						   fun_add_space(15-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
				
			
					     }
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							
						 
																																																					
						}
						else
						   fprintf(fp,"%-33.33s    %15.15s %17.17s %17.17s ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
						}
					}
					else
					{	get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						{
						 if(nd_print_option.arr[0]=='R')
					     {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(4);
						   if(strlen(loc_legend[680])<15)
						   fun_add_space(15-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
											
					     }
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);							
							}
						else
						 fprintf(fp,"%-33.33s    %15.15s %17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
						}
						else
						{
						 if(nd_print_option.arr[0]=='R')
					     {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(4);
						   if(strlen(loc_legend[680])<15)
						   fun_add_space(15-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
										
					     }
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
						}
						else
						 fprintf(fp,"%-33.33s    %15.15s %17.17s ",loc_legend[110],loc_legend[680],loc_legend[690]);
						}
					}
				}
				else
				{
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					{
				     if(nd_print_option.arr[0]=='R')
					 {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<33)
					   fun_add_space(33-strlen(loc_legend[110]));
					   fun_add_space(4);
					   if(strlen(loc_legend[680])<15)
					   fun_add_space(15-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
					   fun_add_space(1);
					   if(strlen(loc_legend[750])<17)
					   fun_add_space(17-strlen(loc_legend[750]));
					   strcat(nd_line_text.arr,loc_legend[750]);
									
					 }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
					}
					else
					 fprintf(fp,"%-33.33s    %15.15s %17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<33)
					   fun_add_space(33-strlen(loc_legend[110]));
					   fun_add_space(4);
					   if(strlen(loc_legend[680])<15)
					   fun_add_space(15-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
					   fun_add_space(1);
											
					 }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr); 																																										
					}
					else
					 fprintf(fp,"%-33.33s    %15.15s %17.17s ",loc_legend[110],loc_legend[680],loc_legend[690]);
					}
				}
			
				l_no_of_clumns =5;
			 }
		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0)&& strcmp(c_addl_charge_amt_ind.arr,"C")!=0 
			&& (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		{
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{	
				get_discount_count();
			
				if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{

					if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					 {
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						{
						 if(nd_print_option.arr[0]=='R')
						 {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   if(strlen(loc_legend[1406])<11)
						   fun_add_space(11-strlen(loc_legend[1406]));
						   strcat(nd_line_text.arr,loc_legend[1406]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);			
						 }
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																												
						}
						else
						 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						}
						else
						{
						 if(nd_print_option.arr[0]=='R')
						 {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   if(strlen(loc_legend[1406])<11)
						   fun_add_space(11-strlen(loc_legend[1406]));
						   strcat(nd_line_text.arr,loc_legend[1406]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
			
						 }
						 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);							
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);						
						

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);						
						}
						else
						 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690]);
						}
					 }
					 else
					 {
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						{
						 if(nd_print_option.arr[0]=='R')
						 {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(3);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<13)
						   fun_add_space(13-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
						 }
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);							

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);							
						}
						else
						 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						}
						else
						{
						 if(nd_print_option.arr[0]=='R')
						 {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(3);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<13)
						   fun_add_space(13-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
	
			
						 }
						 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);														

							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);	
							
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);								
						  
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);						  
					 	}
						else
						 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690]);
						}
					 }
					 l_no_of_clumns =4;
					}
					else
					{
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						{
						 if(nd_print_option.arr[0]=='R')
						 {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[680]);
						   if(strlen(loc_legend[680])<21)
						   fun_add_space(21-strlen(loc_legend[680]));
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
	
			
						 }
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
														
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							
										
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);							
						}
						else
						 fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						}
						else
						{
						 if(nd_print_option.arr[0]=='R')
						 {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<33)
						   fun_add_space(33-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[680]);
						   if(strlen(loc_legend[680])<21)
						   fun_add_space(21-strlen(loc_legend[680]));
						   fun_add_space(1);
						   if(strlen(loc_legend[840])<17)
						   fun_add_space(17-strlen(loc_legend[840]));
						   strcat(nd_line_text.arr,loc_legend[840]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
			
						 }
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);
							
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);

							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							
									
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);														
						 }
						else
						 fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
						}
					}

				}
				else
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					{
					  if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   if(strlen(loc_legend[1406])<11)
						   fun_add_space(11-strlen(loc_legend[1406]));
						   strcat(nd_line_text.arr,loc_legend[1406]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
						
					  }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
	
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);	
	
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);	
	
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
				   }
					else
					 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   if(strlen(loc_legend[1406])<11)
						   fun_add_space(11-strlen(loc_legend[1406]));
						   strcat(nd_line_text.arr,loc_legend[1406]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
	
			
					  }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
					   
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
											   
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);						
							
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);							
							
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
				   }
					else
					 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
					}
				}
				else
				{	get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					{
					  if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(3);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<13)
						   fun_add_space(13-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
			
					  }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);						
					 
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%13.13s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);					 
					 
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%13.13s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);	  																																										
					}
					else
					 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(3);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<13)
						   fun_add_space(13-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);

			
					  }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);						
						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);	

						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);	

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	
  				   }
					else
					 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
					}
				}

				}
          		//l_no_of_clumns =5;
			}
			else
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{	get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				{
				 if(nd_print_option.arr[0]=='R')
				   {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(1);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   if(strlen(loc_legend[1406])<11)
					   fun_add_space(11-strlen(loc_legend[1406]));
					   strcat(nd_line_text.arr,loc_legend[1406]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
					   fun_add_space(1);
					   if(strlen(loc_legend[750])<17)
					   fun_add_space(17-strlen(loc_legend[750]));
					   strcat(nd_line_text.arr,loc_legend[750]);

		
				  }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);


					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																													
				}
				else
				 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
				}
				else
				{
				  if(nd_print_option.arr[0]=='R')
				   {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(1);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   if(strlen(loc_legend[1406])<11)
					   fun_add_space(11-strlen(loc_legend[1406]));
					   strcat(nd_line_text.arr,loc_legend[1406]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<17)
					   fun_add_space(17-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
					   fun_add_space(1);
	
				  }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
					

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);					
					

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	  																																			
				}
				else
				 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
				}
			}
			else
			{	get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
			{
				 if(nd_print_option.arr[0]=='R')
				   {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(3);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<13)
					   fun_add_space(13-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
					   fun_add_space(1);
					   if(strlen(loc_legend[750])<17)
					   fun_add_space(17-strlen(loc_legend[750]));
					   strcat(nd_line_text.arr,loc_legend[750]);

		
				  }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);					
					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																											
				}
				else
				 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				   {
					   strcat(nd_line_text.arr,loc_legend[110]);
					   if(strlen(loc_legend[110])<24)
					   fun_add_space(24-strlen(loc_legend[110]));
					   fun_add_space(1);
					   strcat(nd_line_text.arr,loc_legend[1402]);
					   if(strlen(loc_legend[1402])<15)
					   fun_add_space(15-strlen(loc_legend[1402]));
					   fun_add_space(3);
					   if(strlen(loc_legend[1405])<3)
					   fun_add_space(3-strlen(loc_legend[1405]));
					   strcat(nd_line_text.arr,loc_legend[1405]);
					   fun_add_space(1);
					   if(strlen(loc_legend[680])<13)
					   fun_add_space(13-strlen(loc_legend[680]));
					   strcat(nd_line_text.arr,loc_legend[680]);
					   fun_add_space(1);
					   if(strlen(loc_legend[690])<17)
					   fun_add_space(17-strlen(loc_legend[690]));
					   strcat(nd_line_text.arr,loc_legend[690]);
					   fun_add_space(1);
		
				  }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);					
					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);						
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);	

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);																																																				
				}
				else
				 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
				}
			}
			}
			//fprintf(fp,"%-33.33s %-12.12s %19.19s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[680],loc_legend[690],loc_legend[750]); for discount doc

		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")==0
		    && (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0) && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
		{
			get_addlcharge_count();
			if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
			{
				
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(4);
				   if(strlen(loc_legend[1230])<12)
				   fun_add_space(12-strlen(loc_legend[1230]));
				   strcat(nd_line_text.arr,loc_legend[1230]);
				   if(strlen(loc_legend[680])<17)
				   fun_add_space(17-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
				   fun_add_space(1);
				   if(strlen(loc_legend[750])<17)
				   fun_add_space(17-strlen(loc_legend[750]));
				   strcat(nd_line_text.arr,loc_legend[750]);
	
				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%12.12s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%12.12s",nd_desc_with_spl_chr.arr);
										
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
					

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																					
				}
				else
				 fprintf(fp,"%-33.33s    %12.12s%17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690],loc_legend[750]);
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(4);
				   if(strlen(loc_legend[1230])<12)
				   fun_add_space(12-strlen(loc_legend[1230]));
				   strcat(nd_line_text.arr,loc_legend[1230]);
				   if(strlen(loc_legend[680])<17)
				   fun_add_space(17-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
				   fun_add_space(1);
	
				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%12.12s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%12.12s",nd_desc_with_spl_chr.arr);

					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);					

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	 
																																																			
				}
				else
				 fprintf(fp,"%-33.33s    %12.12s%17.17s %17.17s ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
				}
				l_no_of_clumns =5;
			}
			else
			{
				
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(5);
				   if(strlen(loc_legend[680])<17)
				   fun_add_space(17-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
				   fun_add_space(1);
				   if(strlen(loc_legend[750])<17)
				   fun_add_space(17-strlen(loc_legend[750]));
				   strcat(nd_line_text.arr,loc_legend[750]);
		
	
				 }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-33.33s     ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);						

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
					}
				else
				 fprintf(fp,"%-33.33s     %17.17s%17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(5);
				   if(strlen(loc_legend[680])<17)
				   fun_add_space(17-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
				   fun_add_space(1);
	
				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	
                   	}
				else
				 fprintf(fp,"%-33.33s    %17.17s%17.17s ",loc_legend[110],loc_legend[680],loc_legend[690]);
				}
				l_no_of_clumns =4;
			}
		}
		
		
	
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")==0
		    && (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0 )&& (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
		{
			
			get_addlcharge_count();
			if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
			{
			     if(nd_print_option.arr[0]=='R')
				 {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(4);
				   if(strlen(loc_legend[1230])<12)
				   fun_add_space(12-strlen(loc_legend[1230]));
				   strcat(nd_line_text.arr,loc_legend[1230]);
				   if(strlen(loc_legend[680])<17)
				   fun_add_space(17-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
	
				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%12.12s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%12.12s",nd_desc_with_spl_chr.arr);					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			    fprintf(fp,"%-33.33s    %12.12s%17.17s %17.17s",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
			    l_no_of_clumns =5;
			}
			else
			{
			 if(nd_print_option.arr[0]=='R')
			 {
			   strcat(nd_line_text.arr,loc_legend[110]);
			   if(strlen(loc_legend[110])<33)
			   fun_add_space(33-strlen(loc_legend[110]));
			   fun_add_space(4);
			   if(strlen(loc_legend[680])<17)
			   fun_add_space(17-strlen(loc_legend[680]));
			   strcat(nd_line_text.arr,loc_legend[680]);
			   fun_add_space(1);
			   if(strlen(loc_legend[690])<17)
			   fun_add_space(17-strlen(loc_legend[690]));
			   strcat(nd_line_text.arr,loc_legend[690]);

			 }
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%-33.33s    ",nd_desc_with_spl_chr.arr);
				
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																																		
			}
			else
			 fprintf(fp,"%-33.33s    %17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690]);
			 l_no_of_clumns =4;
			}
		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")!=0 &&
		 (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0)&& (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
		 {
			
			if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{	get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					{
					   if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[1406])<11)
						   fun_add_space(11-strlen(loc_legend[1406]));
						   strcat(nd_line_text.arr,loc_legend[1406]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
					
					  }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);						

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
												
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);					
					
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
				   }
					else
					 fprintf(fp,"%-24.24s %-15.15s %3.3s %11.11s %17.17s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[1406])<11)
						   fun_add_space(11-strlen(loc_legend[1406]));
						   strcat(nd_line_text.arr,loc_legend[1406]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<17)
						   fun_add_space(17-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
					
					  }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);						
						

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);	
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	
												
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	 
																																																				
					}
					else
					 fprintf(fp,"%-24.24s %-15.15s %3.3s %11.11s %17.17s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
					}
				}
				else
				{
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					{
					  if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<14)
						   fun_add_space(14-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						   if(strlen(loc_legend[750])<17)
						   fun_add_space(17-strlen(loc_legend[750]));
						   strcat(nd_line_text.arr,loc_legend[750]);
								
					  }
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);	

						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%14.14s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%14.14s ",nd_desc_with_spl_chr.arr);							
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%14.14s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);	
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%14.14s",loc_legend[750]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);		
																																																				
					}
					else
					 fprintf(fp,"%-24.24s %-15.15s %3.3s %14.14s %17.17s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					   {
						   strcat(nd_line_text.arr,loc_legend[110]);
						   if(strlen(loc_legend[110])<24)
						   fun_add_space(24-strlen(loc_legend[110]));
						   fun_add_space(1);
						   strcat(nd_line_text.arr,loc_legend[1402]);
						   if(strlen(loc_legend[1402])<15)
						   fun_add_space(15-strlen(loc_legend[1402]));
						   fun_add_space(1);
						   if(strlen(loc_legend[1405])<3)
						   fun_add_space(3-strlen(loc_legend[1405]));
						   strcat(nd_line_text.arr,loc_legend[1405]);
						   fun_add_space(1);
						   if(strlen(loc_legend[680])<14)
						   fun_add_space(14-strlen(loc_legend[680]));
						   strcat(nd_line_text.arr,loc_legend[680]);
						   fun_add_space(1);
						   if(strlen(loc_legend[690])<17)
						   fun_add_space(17-strlen(loc_legend[690]));
						   strcat(nd_line_text.arr,loc_legend[690]);
						   fun_add_space(1);
						
					  }
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);						
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);							
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%14.14s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%14.14s ",nd_desc_with_spl_chr.arr);	
						
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
				 																																																
					}
					else
					 fprintf(fp,"%-24.24s %-15.15s %3.3s %14.14s %17.17s ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
					}
				}
			}
			else
			{			
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<21)
				   fun_add_space(21-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
				   fun_add_space(1);
				   if(strlen(loc_legend[750])<17)
				   fun_add_space(17-strlen(loc_legend[750]));
				   strcat(nd_line_text.arr,loc_legend[750]);

				 }
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);					
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);

					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);																																																			
				}
				else
				 fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				   strcat(nd_line_text.arr,loc_legend[110]);
				   if(strlen(loc_legend[110])<33)
				   fun_add_space(33-strlen(loc_legend[110]));
				   fun_add_space(1);
				   if(strlen(loc_legend[680])<21)
				   fun_add_space(21-strlen(loc_legend[680]));
				   strcat(nd_line_text.arr,loc_legend[680]);
				   fun_add_space(1);
				   if(strlen(loc_legend[690])<17)
				   fun_add_space(17-strlen(loc_legend[690]));
				   strcat(nd_line_text.arr,loc_legend[690]);
				   fun_add_space(1);

				 }
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-33.33s ",nd_desc_with_spl_chr.arr);
					
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%21.21s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%21.21s ",nd_desc_with_spl_chr.arr);
										
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);				 
			 																																																
				}
				else
				 fprintf(fp,"%-33.33s %21.21s %17.17s ",loc_legend[110],loc_legend[680],loc_legend[690]);
				}
			}
		}
      
   }

		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		lsr_line_cnt();
		
		if( lcol_cnt == 1)
		prt_line_uc();
		if(lcol_cnt == 2)
		prt_line_uc_wide();
		if(lcol_cnt == 3)
		prt_line_uc_wide1();
		if(lcol_cnt == 5 || lcol_cnt == 6)
		prt_line_uc_wide2();
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n"); //lsr_line_cnt();
		
		open_patient_cur();

	    ccnt=0;
		nd2_summary_dtl_ind.arr[0]='\0';
		nd1_prt_grp_hdr_code.arr[0]='\0';
		nd1_prt_grp_line_code.arr[0]='\0';
		nd_cust_code1.arr[0]='\0';
	  	/***** This code added for printing package bill if it is there ****/

		if(l_pkg_len!=0)
		{
		 print_package_dtls(); 
		}
		/***** upto here *****/
	
		
	   while(fetch_patient_cur())
		{ 
		  /** The below Code added by raghava on 23/11/2009 for dn't print zero discount amount **/

			if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && d1_tot_disc!=0)
			{
				ccnt = ccnt + 1;
				print_patient_hdr();
			}
			else
			if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
			{

			  ccnt = ccnt + 1;
			  print_patient_hdr();
			}
				
		}
		
				
		if(end_of_report)
		{
						 
		 p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;  //total  gross
		 p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;       //total  net
		 p_tot_pat_disc_amt=p_tot_pat_disc_amt+nd_pat_disc_amt;     //total  discount
										    					
		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )									    					
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0) 
			{	
			get_addlcharge_count();
			if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
			print_formated_amt2(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt);
			}
		 }
		 
		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
		  {
		 
			nd_pat_gross_amt = nd_pat_gross_amt+d_pk_pack_tot_g_amount;  //added Rajesh d_pk_pack_tot_g_amount
		    print_formated_amt(nd_pat_gross_amt-nd_inside_pkg_gross_amt);  
		  }
		 }								 
		 
		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
		  {
			nd_pat_net_amt1 = nd_pat_net_amt1+d_pk_pack_tot_n_amount;
			print_formated_amt(nd_pat_net_amt1-nd_inside_pkg_net_amt);
		  }
		 }				
		 //if(nd_pat_net_amt1>=0)
		 //nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
		 //else
		 nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
		 
	    if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
		 {
			 if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			 {
			 get_discount_count();
			 if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
			 {
			  if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
			  print_formated_amt(nd_pat_disc_amt-nd_inside_pkg_disc_amt);
			  }
			 }

			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
			 {
			  if(c_disc_amt_in_dtl_yn.arr[0]=='N')
			  {
			   if (strcmp(c_servdate_in_dtlformat_yn.arr,"N")==0)
			   {
			    if(nd_print_option.arr[0]=='R')
				fun_add_space(18);
				else
				fprintf(fp,"%-18.18s"," ");
			   }
			   if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			   {
			    if(nd_print_option.arr[0]=='R')
				fun_add_space(9);
				else
				fprintf(fp,"%-9.9s"," ");
			   }
			   print_formated_amt(nd1_serv_tot_disc);
			   
			  }
			  else
			  {
			    print_formated_amt(nd1_serv_charge_discount);
				print_formated_amt(nd1_serv_bill_discount);
				print_formated_amt(nd1_serv_fund_adjustment);
			  }

			 }
		 
		 }

					
		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
		   print_formated_amt((nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt));
	
		  else
		  { 
		   if (strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0)
		   print_formated_amt(nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt);
		  }
		 }
		 
		 nd_tot_subdiv_amt=nd_tot_subdiv_amt+nd_subdiv_amt; //total Subsidized Amt

		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)
		  {
			get_subsidized_amt();
			if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
			print_formated_amt(nd_subdiv_amt);
		  }
		 }										                    
	    }

		//if(end_of_report)
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");lsr_line_cnt();

		if(lcol_cnt == 1)
		prt_line_uc();
		if( lcol_cnt == 2)
		prt_line_uc_wide();
		if( lcol_cnt == 3)
		prt_line_uc_wide1();
		if( lcol_cnt == 5 || lcol_cnt == 6)
		prt_line_uc_wide2();
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n"); lsr_line_cnt();


   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)	
   {
		get_cnt_remain_space(2);
		if((l_lcnt+5)<=max_lines-v_lno)  
		{
		
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],62);
			  if(strlen(loc_legend[680])<62)
			  fun_add_space(62-strlen(loc_legend[680]));
			 }
			 else
			 {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp,"%-62.62s",loc_legend[680]);
				}
			}
			else
			{
			 if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],44);
			  if(strlen(loc_legend[680])<44)
			  fun_add_space(44-strlen(loc_legend[680]));
			 }
			 else
			 {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[680]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 								fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																						
							}
							else
			                    fprintf(fp,"%-44.44s",loc_legend[680]);
			  }
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
			 {
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],53);
			  if(strlen(loc_legend[680])<53)
			  fun_add_space(53-strlen(loc_legend[680]));
			 }
			 else
			 {
                  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			            fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
			          fprintf(fp,"%-53.53s",loc_legend[680]);
			  }
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],56);
			  if(strlen(loc_legend[680])<56)
			  fun_add_space(56-strlen(loc_legend[680]));
			 }
			 else
			 {
			       if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			            fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else 
			           fprintf(fp,"%-56.56s",loc_legend[680]);
				}
			 }
			 else
			 {
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],42);
			  if(strlen(loc_legend[680])<42)
			  fun_add_space(42-strlen(loc_legend[680]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			            fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else  
				       fprintf(fp,"%-42.42s",loc_legend[680]);
				 }
			 }
			}
		}
		else
		{
			
			while(v_lno<=max_lines)
			  {
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");
				v_lno++;
			  }
			  lsr_line_cnt();
			
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],62);
			  if(strlen(loc_legend[680])<62)
			  fun_add_space(62-strlen(loc_legend[680]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			            fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else   
				       fprintf(fp,"%-62.62s",loc_legend[680]);
			  }
			}
			else
			{
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],44);
			  if(strlen(loc_legend[680])<44)
			  fun_add_space(44-strlen(loc_legend[680]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			            fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else    
				 fprintf(fp,"%-44.44s",loc_legend[680]);
				 }
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
			 {
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],53);
			  if(strlen(loc_legend[680])<53)
			  fun_add_space(53-strlen(loc_legend[680]));
			 }
			 else
			 {
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
			         fprintf(fp,"%-53.53s",loc_legend[680]);
			  }
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],56);
			  if(strlen(loc_legend[680])<56)
			  fun_add_space(56-strlen(loc_legend[680]));
			 }
			 else
			 {
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			     fprintf(fp,"%-56.56s",loc_legend[680]);
				 }
			 }
			 else
			 {
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[680],42);
			  if(strlen(loc_legend[680])<42)
			  fun_add_space(42-strlen(loc_legend[680]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
				    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			     fprintf(fp,"%-42.42s",loc_legend[680]);
			  }
			 }
			}
		}
		

		if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
		{
		//get_pat_inside_pkg_disc();
		p_tot_pat_gross_amt = p_tot_pat_gross_amt+d_pk_pack_tot_g_amount; //Rajesh
		print_formated_amt(p_tot_pat_gross_amt); 
		}
		if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
		{
			p_tot_pat_net_amt= p_tot_pat_net_amt+d_pk_pack_tot_n_amount; //Rajesh
			print_formated_amt(p_tot_pat_net_amt);
		}
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n"); //lsr_line_cnt();lsr_line_cnt();
		//The below code added by Rajesh  IN22838	
	/*	if (PkgTotalDiscount > 0)
		{
		 fprintf(fp," %-41s",loc_legend[710]);
		print_formated_amt(nd_tot_disc_amount+PkgTotalDiscount);
		fprintf(fp,"\n");//lsr_line_cnt();
		}
		*/
       /*
       if(strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 && strcmp(c_bill_net_payable_ind.arr,"R")!=0 )
	   fprintf(fp,"%18.18s"," ");
	   if(strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 && strcmp(c_bill_net_payable_ind.arr,"R")==0 )
       fprintf(fp,"%18.18s"," ");
       Commented on 25/3/2008 for proper printing */
	   //if(strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_bill_net_payable_ind.arr,"R")==0 )
       //fprintf(fp,"%18s"," ");
   
			
		if( strcmp(c_bill_subsidized_amt_ind.arr,"R")==0)
		{

		  if((nd_tot_subdiv_amt+d_pk_pack_tot_g_amount-d_pk_pack_tot_n_amount)!=0)
		  {
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],62);
			  if(strlen(loc_legend[750])<62)
			  fun_add_space(62-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
				     fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			     fprintf(fp,"%-62.62s",loc_legend[750]);
			  }
			}
			else
			{
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],44);
			  if(strlen(loc_legend[750])<44)
			  fun_add_space(44-strlen(loc_legend[750]));
			 }
			 else
			 {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			    fprintf(fp,"%-44.44s",loc_legend[750]);
			  }
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
			 {
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],53);
			  if(strlen(loc_legend[750])<53)
			  fun_add_space(53-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			     fprintf(fp,"%-53.53s",loc_legend[750]);
			  }
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			  if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],55);
			  if(strlen(loc_legend[750])<55)
			  fun_add_space(55-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-55.55s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				 fprintf(fp,"%-55.55s",loc_legend[750]);
				}
			 }
			 else
			 {
			   if(nd_print_option.arr[0]=='R')
			 {
			  fun_add_space(1);
			  strncat(nd_line_text.arr,loc_legend[750],41);
			  if(strlen(loc_legend[750])<41)
			  fun_add_space(41-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr," %-41.41s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			     fprintf(fp," %-41.41s",loc_legend[750]);
			  }
			 }
			}

			print_formated_amt(nd_tot_subdiv_amt+d_pk_pack_tot_g_amount-d_pk_pack_tot_n_amount);
			if(nd_print_option.arr[0]=='R')
			fun_bl_report_temp_format();
			else
			fprintf(fp,"\n");lsr_line_cnt();
		  }
		}
		if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0)
		{
		  if(nd_tot_subdiv_amt!=0)
		  {
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],61);
			  if(strlen(loc_legend[750])<61)
			  fun_add_space(61-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-61.61s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			     fprintf(fp,"%-61.61s ",loc_legend[750]);
			  }
			}
			else
			{
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],43);
			  if(strlen(loc_legend[750])<43)
			  fun_add_space(43-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-43.43s ",nd_desc_with_spl_chr.arr);
					 																																														
				}
				else
			       fprintf(fp,"%-43.43s ",loc_legend[750]);
			  }
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
			 {
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],52);
			  if(strlen(loc_legend[750])<52)
			  fun_add_space(52-strlen(loc_legend[750]));
			 }
			 else
			 {
                  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				    fprintf(fp,"%-52.52s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp,"%-52.52s ",loc_legend[750]);
				 
				}
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],55);
			  if(strlen(loc_legend[750])<55)
			  fun_add_space(55-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				     fprintf(fp,"%-55.55s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			     fprintf(fp,"%-55.55s ",loc_legend[750]);
			   }
			 }
			 else
			 {
			   if(nd_print_option.arr[0]=='R')
			 {
			  strncat(nd_line_text.arr,loc_legend[750],41);
			  if(strlen(loc_legend[750])<41)
			  fun_add_space(41-strlen(loc_legend[750]));
			 }
			 else
			 {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[750]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-41.41s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else  
				 fprintf(fp,"%-41.41s ",loc_legend[750]);
			  }
			 }
			}
			print_formated_amt(nd_tot_subdiv_amt);
			if(nd_print_option.arr[0]=='R')
			fun_bl_report_temp_format();
			else
			fprintf(fp,"\n");lsr_line_cnt();
		  }
		}

		// To print total package discout in a row
		print_package_discount();

		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
		{
		  if (strcmp(c_serv_disc_on_gross_ind.arr,"R")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
		  {
		  
			if((p_tot_pat_disc_amt)!=0)
			{
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[710],61);
				  if(strlen(loc_legend[710])<61)
				  fun_add_space(61-strlen(loc_legend[710]));
				 }
				 else
				 {
 				     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[710]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					    fprintf(fp," %-61.61s",loc_legend[710]);
					 }
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[710],43);
				  if(strlen(loc_legend[710])<43)
				  fun_add_space(43-strlen(loc_legend[710]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[710]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
 					}
					else
					fprintf(fp," %-43.43s",loc_legend[710]);
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[710],52);
				  if(strlen(loc_legend[710])<52)
				  fun_add_space(52-strlen(loc_legend[710]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[710]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp," %-52.52s",loc_legend[710]);
				  }
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[710],55);
				  if(strlen(loc_legend[710])<55)
				  fun_add_space(55-strlen(loc_legend[710]));
				 }
				 else
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[710]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-55.55s",loc_legend[710]);
				  }
				 }
				 else
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[710],41);
				  if(strlen(loc_legend[710])<41)
				  fun_add_space(41-strlen(loc_legend[710]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[710]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else 
				    	fprintf(fp," %-41.41s",loc_legend[710]);
				  }
				 }
				}
				print_formated_amt(p_tot_pat_disc_amt);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
			}
		  }
		}
		

   
		/***commented by vani and printing using cursor**** 
		 
		  if(strcmp(c_oth_payers_amt_print_row_ind.arr,"R")==0)
		  {
        	
			if(p<=1) 
			{
				
				//test strcpy(ar_cust_amt[0],nd_cust_code1.arr);
				if(strcmp(nd_cust_code1.arr,"\0")!=0)
				{
					//test fetch_customer1();
					//strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					strcpy(leg_cust.arr,strcat(leg_cust.arr,d_customer3.arr));
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,61);
					  if(strlen(leg_cust.arr)<61)
					  fun_add_space(61-strlen(leg_cust.arr));
					 }
					 else
					 {
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						 fprintf(fp," %-61.61s",leg_cust.arr);
						 }
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,43);
					  if(strlen(leg_cust.arr)<43)
					  fun_add_space(43-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 { 
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-44.44s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
	 					    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    	fprintf(fp," %-44.44s",leg_cust.arr);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,52);
					  if(strlen(leg_cust.arr)<52)
					  fun_add_space(52-strlen(leg_cust.arr));
					 }
					 else
					 {   
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					     fprintf(fp," %-52.52s",leg_cust.arr);
					  }
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,55);
					  if(strlen(leg_cust.arr)<55)
					  fun_add_space(55-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-55.55s",leg_cust.arr);
					  }
					 }
					 else
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,41);
					  if(strlen(leg_cust.arr)<41)
					  fun_add_space(41-strlen(leg_cust.arr));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
							 																																														
						}
						else
					      fprintf(fp," %-41.41s",leg_cust.arr);
					  }
					 }
					}
					leg_cust.arr[0] = '\0';

					//fprintf(fp,"%-6s %-20s %-14s"," ",loc_legend[730],nd_cust_code1.arr);

//The below part added by Rajesh for cash Bill

					d2_cust_code.arr[0]='\0';
					d2_cust_code.len = 0;  
					l_tot_pkg_payable = 0;
					strcpy(d2_cust_code.arr,nd_cust_code1.arr);
					d2_cust_code.len=strlen(nd_cust_code1.arr);
					d2_cust_code.arr[d2_cust_code.len]='\0';
					d2_cust_group_code.arr[0]='\0';
					d2_cust_group_code.len = 0;
			
					get_closed_packages();
					nd_othp_payer_amt=nd_othp_payer_amt+l_tot_pkg_payable ;
// upto here
				
					put_val(ar_amt[0],nd_othp_payer_amt); 
					format_amt(ar_amt[0]);

					if(nd_print_option.arr[0]=='R')
					{
					  if(strlen(ar_amt[0])<15)
					  {
					    fun_add_space(15-strlen(ar_amt[0]));
						strcat(nd_line_text.arr,ar_amt[0]);
					  }
					  else
					  strncat(nd_line_text.arr,ar_amt[0],15);
					  fun_add_space(1);
					  strncat(nd_line_text.arr,bill_code[0],20);
					  if(strlen(bill_code[0])<20)
					  fun_add_space(20-strlen(bill_code[0]));
					  fun_add_space(1);
					}
					else
					fprintf(fp,"%15s %-20s ",ar_amt[0],bill_code[0]);  //FOR CRF-659
				
				}

			}

		   else
		   {
		   		//strcpy(ar_cust_amt[0],nd_cust_code1.arr);
				if(strcmp(nd_cust_code1.arr,"\0")!=0)
				{
					//fetch_customer1();
					//strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					strcpy(leg_cust.arr,strcat(leg_cust.arr,d_customer3.arr));
			  		if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,61);
					  if(strlen(leg_cust.arr)<61)
					  fun_add_space(61-strlen(leg_cust.arr));
					 }
					 else
					 {
                        if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-61.61s",leg_cust.arr);
					  }
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,43);
					  if(strlen(leg_cust.arr)<43)
					  fun_add_space(43-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						   fprintf(fp," %-43.43s",leg_cust.arr);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,52);
					  if(strlen(leg_cust.arr)<52)
					  fun_add_space(52-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						  fprintf(fp," %-52.52s",leg_cust.arr);
						}
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,55);
					  if(strlen(leg_cust.arr)<55)
					  fun_add_space(55-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 							fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp," %-55.55s",leg_cust.arr);
						}
					 }
					 else
					 {
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,41);
					  if(strlen(leg_cust.arr)<41)
					  fun_add_space(41-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 { 
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp," %-41.41s",leg_cust.arr);
						}
					 }
					}
					leg_cust.arr[0] = '\0';

					//fprintf(fp,"%-6s %-20s %-14s"," ",loc_legend[730],nd_cust_code1.arr);

					
					put_val(ar_amt[0],nd_othp_payer_amt); 
					format_amt(ar_amt[0]);

				
					if(nd_print_option.arr[0]=='R')
					{
					  if(strlen(ar_amt[0])<15)
					  {
					    fun_add_space(15-strlen(ar_amt[0]));
						strcat(nd_line_text.arr,ar_amt[0]);
					  }
					  else
					  strncat(nd_line_text.arr,ar_amt[0],15);
					  fun_add_space(1);
					  strncat(nd_line_text.arr,bill_code[0],20);
					  if(strlen(bill_code[0])<20)
					  fun_add_space(20-strlen(bill_code[0]));
					  fun_add_space(1);
					}
					else
					fprintf(fp,"%15s %-20s",ar_amt[0],bill_code[0]); //bill_code[i] For CRF-659
				  
				}


				for (i=1;i<=p;i++)
				{
					strcpy(ar_cust.arr,	ar_cust_amt[i]);
					if(strcmp(ar_cust_amt[i],"\0")!=0)
					{
					fetch_customer2();
					//strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					strcpy(leg_cust.arr,strcat(leg_cust.arr,ar_cust.arr));

					ar_cust.arr[0] ='\0';
					if(nd_print_option.arr[0]=='R')
					fun_bl_report_temp_format();
					else
					fprintf(fp,"\n");lsr_line_cnt();
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,61);
					  if(strlen(leg_cust.arr)<61)
					  fun_add_space(61-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						     fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						   fprintf(fp," %-61.61s",leg_cust.arr);
						}

					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 { 
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,43);
					  if(strlen(leg_cust.arr)<43)
					  fun_add_space(43-strlen(leg_cust.arr));
					 }
					 else
					 {
                         if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 { 
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp," %-43.43s",leg_cust.arr);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(nd_print_option.arr[0]=='R')
					 { 
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,52);
					  if(strlen(leg_cust.arr)<52)
					  fun_add_space(52-strlen(leg_cust.arr));
					 }
					 else
					 {
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						  fprintf(fp," %-52.52s",leg_cust.arr);
						}
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(nd_print_option.arr[0]=='R')
					 { 
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,55);
					  if(strlen(leg_cust.arr)<55)
					  fun_add_space(55-strlen(leg_cust.arr));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						     fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						   fprintf(fp," %-55.55s",leg_cust.arr);
						
					  }
					 }
					 else
					 {
					  if(nd_print_option.arr[0]=='R')
					 { 
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,41);
					  if(strlen(leg_cust.arr)<41)
					  fun_add_space(41-strlen(leg_cust.arr));
					 }
					 else
					 {
                       if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
							//sprintf(st_var,"%d",strlen(nd_desc_with_spl_chr.arr));
							
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						   fprintf(fp," %-41.41s",leg_cust.arr);
						
					  }
					 }
					}
					leg_cust.arr[0] = '\0';

					//fprintf(fp,"%-6s %-20s %-14s"," ",loc_legend[730],ar_cust.arr);
					//fprintf(fp,"\n%s",ar_cust.arr);
					if(nd_print_option.arr[0]=='R')
					{
					  if(strlen(ar_amt[0])<15)
					  {
					    fun_add_space(15-strlen(ar_amt[i]));
						strcat(nd_line_text.arr,ar_amt[i]);
					  }
					  else
					  strncat(nd_line_text.arr,ar_amt[i],15);
					  fun_add_space(1);
					  strncat(nd_line_text.arr,bill_code[i],20);
					  if(strlen(bill_code[i])<20)
					  fun_add_space(20-strlen(bill_code[i]));
					  fun_add_space(1);
					}
					else
					fprintf(fp,"%15s %-20s",ar_amt[i],bill_code[i]);  //bill_code[i] For CRF-659
					//fprintf(fp,"\n");lsr_line_cnt();
					}
				}

			 }
			 if(nd_print_option.arr[0]=='R')
			 fun_bl_report_temp_format();
			 else
			 fprintf(fp,"\n");lsr_line_cnt();
		   }
		
			****upto Here*****/

		
		/********added by vani**********/
	
		if (strcmp(c_oth_payers_amt_print_row_ind.arr,"R")==0)
		{	
			declare_other_payer_amt_for_patient();

			open_other_payer_amt_for_patient();

			while(fetch_other_payer_amt_for_patient())
			{
				
				
				leg_cust.arr[0] = '\0';
				leg_cust.len = 0;

				if(strcmp(d_oth_cust_code.arr,"\0")!=0)
				{
					fetch_cust_name(d_oth_cust_code.arr);	
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					strcpy(leg_cust.arr,strcat(leg_cust.arr,d_oth_cust_desc.arr));
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,61);
					  if(strlen(leg_cust.arr)<61)
					  fun_add_space(61-strlen(leg_cust.arr));
					 }
					 else
					 {
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						 fprintf(fp," %-61.61s",leg_cust.arr);
						 }
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,43);
					  if(strlen(leg_cust.arr)<43)
					  fun_add_space(43-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 { 
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
	 					    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    	fprintf(fp," %-43.43s",leg_cust.arr);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,52);
					  if(strlen(leg_cust.arr)<52)
					  fun_add_space(52-strlen(leg_cust.arr));
					 }
					 else
					 {   
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						    fprintf(fp," %-52.52s",leg_cust.arr);
					 }
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,55);
					  if(strlen(leg_cust.arr)<55)
					  fun_add_space(55-strlen(leg_cust.arr));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						   fprintf(fp," %-55.55s",leg_cust.arr);
					  }
					 }
					 else
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,leg_cust.arr,41);
					  if(strlen(leg_cust.arr)<41)
					  fun_add_space(41-strlen(leg_cust.arr));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
							 																																														
						}
						else
					      fprintf(fp," %-41.41s",leg_cust.arr);
//Less payable by customer in cash bill is printing from here
					  }
					 }
					}

//Rajesh less payable by payer in cash patient

					d2_cust_code.arr[0]='\0';
					d2_cust_code.len = 0;  
					l_tot_var_payable = 0;
					strcpy(d2_cust_code.arr,d_oth_cust_code.arr);
					d2_cust_code.len=strlen(d_oth_cust_code.arr);
					d2_cust_code.arr[d2_cust_code.len]='\0';
					d2_cust_group_code.arr[0]='\0';
					d2_cust_group_code.len = 0;
					d2_priority=d_oth_priority;

					get_closed_packages();

					d_other_bill_amt=d_other_bill_amt+l_tot_var_payable +l_tot_var_tax;
// upto here
					put_val(ar_amt[0],d_other_bill_amt); 

					format_amt(ar_amt[0]);
									
					fprintf(fp,"%15s %-20s\n",ar_amt[0],d_oth_doc_type_code.arr);  //FOR CRF-659

						
				
				}


			}

			close_other_payer_amt_for_patient();

			lsr_line_cnt();
		}
		/******up to here*******/



			if (strcmp(c_oth_payers_amt_print_row_ind.arr,"S")==0)
			{
			  
				get_sum_of_other_payer_amt1();

			  if(nd_tot_othp_payer_amt!=0) // || nd_net_payable!=0)
			  { 
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[810],61);
				  if(strlen(loc_legend[810])<61)
				  fun_add_space(61-strlen(loc_legend[810]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[810]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					   fprintf(fp," %-61.61s",loc_legend[810]);
					}
				}
				else
				{
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[810],43);
				  if(strlen(loc_legend[810])<43)
				  fun_add_space(43-strlen(loc_legend[810]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[810]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					     fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					  fprintf(fp," %-43.43s",loc_legend[810]);
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[810],52);
				  if(strlen(loc_legend[810])<52)
				  fun_add_space(52-strlen(loc_legend[810]));
				 }
				 else
				 {
                  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[810]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp," %-52.52s",loc_legend[810]);
				  }
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[810],55);
				  if(strlen(loc_legend[810])<55)
				  fun_add_space(55-strlen(loc_legend[810]));
				 }
				 else
				 {
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[810]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-55.55s",loc_legend[810]);
				  }
				 }
				 else
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[810],41);
				  if(strlen(loc_legend[810])<41)
				  fun_add_space(41-strlen(loc_legend[810]));
				 }
				 else
				 {
				     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[810]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-41.41s",loc_legend[810]);
					 }
				 }
				}
				print_formated_amt(nd_tot_othp_payer_amt+d_pk_pack_tot_n_amount);   //+nd_net_payable);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");  //ADDED BY VANI REGARDING 14617
			  }
			}

			/**********************************************/

			/***** Printing Additional Charge Amt as Row *****/
			if(strcmp(c_addl_charge_amt_ind.arr,"R")==0)
			{  
			  if(nd_pat_tot_addl_charge_amt!=0)
			  {	  
				  if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				  {
				  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				  {
					 if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1230],62);
					  if(strlen(loc_legend[1230])<62)
					  fun_add_space(62-strlen(loc_legend[1230]));
					 }
					 else
					 {
				        if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1230]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						  	fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp,"%-62.62s",loc_legend[1230]);
						}
				  }
				  else
				   {
				     if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1230],44);
					  if(strlen(loc_legend[1230])<44)
					  fun_add_space(44-strlen(loc_legend[1230]));
					 }
					 else
					 {
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[1230]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					     fprintf(fp,"%-44.44s",loc_legend[1230]);
					  }
				   }
				  }
				  else
				  {
				   if(l_no_of_clumns ==5)
			       {
				     if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1230],53);
					  if(strlen(loc_legend[1230])<53)
					  fun_add_space(53-strlen(loc_legend[1230]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1230]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp,"%-53.53s",loc_legend[1230]);
					  }
				   }
				   else
				   {
				      if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1230],42);
					  if(strlen(loc_legend[1230])<42)
					  fun_add_space(42-strlen(loc_legend[1230]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1230]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp,"%-42.42s",loc_legend[1230]);
						}
				   }
				  }
				  print_formated_amt(nd_pat_tot_addl_charge_amt);
				  if(nd_print_option.arr[0]=='R')
				  fun_bl_report_temp_format();
				  else
				  fprintf(fp,"\n");lsr_line_cnt();lsr_line_cnt();
			  }
			
		    }

			if( strcmp(c_bill_net_payable_ind.arr,"B")==0 || strcmp(c_bill_net_payable_ind.arr,"R")==0)
			{
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[740],62);
				  if(strlen(loc_legend[740])<62)
				  fun_add_space(62-strlen(loc_legend[740]));
				 }
				 else
				 {
                     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[740]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					     fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				     fprintf(fp,"%-62.62s",loc_legend[740]);
					 }
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[740],44);
				  if(strlen(loc_legend[740])<44)
				  fun_add_space(44-strlen(loc_legend[740]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[740]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					fprintf(fp,"%-44.44s",loc_legend[740]);
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[740],53);
				  if(strlen(loc_legend[740])<53)
				  fun_add_space(53-strlen(loc_legend[740]));
				 }
				 else
				 {
                   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[740]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp,"%-53.53s",loc_legend[740]);
				  }
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[740],56);
				  if(strlen(loc_legend[740])<56)
				  fun_add_space(56-strlen(loc_legend[740]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[740]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				     	fprintf(fp,"%-56.56s",loc_legend[740]);
					}
				 }
				 else
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[740],42);
				  if(strlen(loc_legend[740])<42)
				  fun_add_space(42-strlen(loc_legend[740]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[740]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp,"%-42.42s",loc_legend[740]);
				  }
				 }
				}
				nd_tot_pat_net_charge_amt = nd_tot_pat_net_charge_amt + d_pk_pack_tot_n_amount; //Rajesh added package net payable
				print_formated_amt(nd_tot_pat_net_charge_amt);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
				get_rounded_amt(nd_tot_pat_net_charge_amt);
		       
	/****printing Patient deposit Details added on 26/07/2010****/
				
				declare_patient_deposit();

				open_patient_deposit();

				rec_count=1;
				while(fetch_patient_deposit())
				{
					if(d_patient_deposidt_amt!=0)
					 {
						if(strcmp(d_cust_code.arr,"\0")==0) 
						{ 
						
							
							if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							{
							if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
							{
							  if(rec_count==1)
							  {
								  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-47.47s",loc_legend[1463]); 
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 										fprintf(fp,"%-47.47s",nd_desc_with_spl_chr.arr);
																																																								
									}
									else
										fprintf(fp,"%-47.47s",loc_legend[1463]); 
							  } 
							  else
								fprintf(fp,"%-47.47s"," "); 
							}
							else
							{
								if(rec_count==1)
								{
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										 sprintf(nd_temp_str.arr,"%-29.29s",loc_legend[1463]);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
 										fprintf(fp,"%-29.29s",nd_desc_with_spl_chr.arr);
																																																								
									}
									else
											fprintf(fp,"%-29.29s",loc_legend[1463]);  
							   }
							   else
								 fprintf(fp,"%-29.29s"," "); 
							 }
							}
							else
							{
							  if(rec_count==1)
							  {
								  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										 sprintf(nd_temp_str.arr,"%-27.27s",loc_legend[1463]); 
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 										fprintf(fp,"%-27.27s",nd_desc_with_spl_chr.arr);
 									}
									else  
				      					   fprintf(fp,"%-27.27s",loc_legend[1463]); 
							  }
							  else
								fprintf(fp,"%-27.27s"," "); 
							}

							rec_count=rec_count+1;	
							fprintf(fp,"%-15.15s",d_patient_deposit_num.arr);
							print_formated_amt(d_patient_deposidt_amt);
							d_bill_tot_outst_amt= d_bill_tot_outst_amt-d_patient_deposidt_amt;
							fprintf(fp,"\n");lsr_line_cnt();

							}         
						}

					
			}
				
			close_patient_deposit();

			/****upto here****/
		   
/*ADDED FOR SCRUM CRF-654*/ 
         
   if (d_tot_outst_amt!=0)
	{
          if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				  {
             				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[993]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						{
          				      fprintf(fp,"%-62.62s",loc_legend[993]);
					        }
				  }
				else
				  {

				              if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[993]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						{
          				      fprintf(fp,"%-44.44s",loc_legend[993]);
					        }
				  }
		}
	 else
		{
				 if(l_no_of_clumns ==5)
				  {
				              if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[993]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						{
          				      fprintf(fp,"%-53.53s",loc_legend[993]);
					        }

                                  }
				 else
				  {
					 if(l_no_of_clumns ==6)
                                             {
							if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[993]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																	
							}
							else
							{
								fprintf(fp,"%-56.56s",loc_legend[993]);
							}

					     }
					 else
					     {
							if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[993]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																	
							}
							else
							{
								fprintf(fp,"%-42.42s",loc_legend[993]);
							}					               

					      }
                                  }
		}
				print_formated_amt(d_tot_outst_amt);
				fprintf(fp,"\n");lsr_line_cnt();
				//get_rounded_amt(d_tot_outst_amt);
        } 			/*ADDED FOR SCRUM CRF-654*/ 


			   /***** It will print the rounded amt *****/
				if(nd_rounded_amt!=0)
				{
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1240],62);
					  if(strlen(loc_legend[1240])<62)
					  fun_add_space(62-strlen(loc_legend[1240]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1240]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp,"%-62.62s",loc_legend[1240]);
					  }
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1240],44);
					  if(strlen(loc_legend[1240])<44)
					  fun_add_space(44-strlen(loc_legend[1240]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[1240]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp,"%-44.44s",loc_legend[1240]);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1240],53);
					  if(strlen(loc_legend[1240])<53)
					  fun_add_space(53-strlen(loc_legend[1240]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1240]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp,"%-53.53s",loc_legend[1240]);
					   }
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1240],56);
					  if(strlen(loc_legend[1240])<56)
					  fun_add_space(56-strlen(loc_legend[1240]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1240]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					  fprintf(fp,"%-56.56s",loc_legend[1240]);
					  }
					 }
					 else
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1240],42);
					  if(strlen(loc_legend[1240])<42)
					  fun_add_space(42-strlen(loc_legend[1240]));
					 }
					 else
					 {
                         if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1240]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					     fprintf(fp,"%-42.42s",loc_legend[1240]);
						 }
					 }
					}
					print_formated_amt(nd_rounded_amt);
					if(nd_print_option.arr[0]=='R')
					fun_bl_report_temp_format();
					else
					fprintf(fp,"\n");lsr_line_cnt();
				
				/*****  It Will Print the after rounded amt of net payable amt *****/
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					   if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1250],62);
					  if(strlen(loc_legend[1250])<62)
					  fun_add_space(62-strlen(loc_legend[1250]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1250]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp,"%-62.62s",loc_legend[1250]);
						}
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1250],44);
					  if(strlen(loc_legend[1250])<44)
					  fun_add_space(44-strlen(loc_legend[1250]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[1250]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
							fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
						    	fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp,"%-44.44s",loc_legend[1250]);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1250],53);
					  if(strlen(loc_legend[1250])<53)
					  fun_add_space(53-strlen(loc_legend[1250]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1250]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
						    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp,"%-53.53s",loc_legend[1250]);
						}
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1250],56);
					  if(strlen(loc_legend[1250])<56)
					  fun_add_space(56-strlen(loc_legend[1250]));
					 }
					 else
					 {
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1250]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
							fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
						    fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					     fprintf(fp,"%-56.56s",loc_legend[1250]);
						 }
					 }
					 else
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1250],42);
					  if(strlen(loc_legend[1250])<42)
					  fun_add_space(42-strlen(loc_legend[1250]));
					 }
					 else
					 {
                         if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1250]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
							    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																						
							}
							else
					            fprintf(fp,"%-42.42s",loc_legend[1250]);
						 }
					 }
					}
					print_formated_amt(nd_net_pay_amt_after_rounded);
					if(nd_print_option.arr[0]=='R')
					fun_bl_report_temp_format();
					else
					fprintf(fp,"\n");lsr_line_cnt();
				}
				
			}


			
			
			/***** added on 30/09/2008 for printing package deposit if it is there ********/ 

	/*
			if(l_pkg_len!=0)
			{
				for(i=1;i<=l_pkg_len;i++)
				{
				  l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]);
				  if(l_pkg_dep_amt!=0)
				  {
				   l_pkg_dep_exist=1; 
				   break;
				  }
				}
			
				
			  if(l_pkg_dep_exist==1)
			  {
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[1260],61);
				  if(strlen(loc_legend[1260])<61)
				  fun_add_space(61-strlen(loc_legend[1260]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					   fprintf(fp,"%-61.61s",loc_legend[1260]);
					}
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[1260],43);
				  if(strlen(loc_legend[1260])<43)
				  fun_add_space(43-strlen(loc_legend[1260]));
				 }
				 else
				 {
                     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-43.43s",nd_desc_with_spl_chr.arr);
						 																																														
					}
					else
				     fprintf(fp,"%-43.43s",loc_legend[1260]);
					 }
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[1260],52);
				  if(strlen(loc_legend[1260])<52)
				  fun_add_space(52-strlen(loc_legend[1260]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				    fprintf(fp,"%-52.52s",loc_legend[1260]);
					}
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[1260],56);
				  if(strlen(loc_legend[1260])<56)
				  fun_add_space(56-strlen(loc_legend[1260]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				     fprintf(fp,"%-56.56s",loc_legend[1260]);
					 }
				 }
				 else
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[1260],42);
				  if(strlen(loc_legend[1260])<42)
				  fun_add_space(42-strlen(loc_legend[1260]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp,"%-42.42s",loc_legend[1260]);
				  }
				 }
				}
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt(); 
				for(i=1;i<=l_pkg_len;i++)
				{
				   l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]);	//atoi function will convert string to double
                   if(l_pkg_dep_amt!=0)
				   {	
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-30.30s",loc_legend[1290]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					       fprintf(fp,"       %-30.30s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																					
						}
						else
					       fprintf(fp,"       %-30.30s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
					   }
					else
					{
					 if(l_no_of_clumns ==5)
					 {

					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					        fprintf(fp,"       %-21.21s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																					
						}
						else
					      fprintf(fp,"       %-21.21s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
				        if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"       %-21.21s : %-21.21s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																					
						}
						else
						   fprintf(fp,"       %-21.21s : %-21.21s",loc_legend[1290],p_pkg_seq_num[i]);
						}
					 else
					 {
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					         fprintf(fp,"       %-21.21s : %-11.11s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
						
																																																					
						}
						else
					      fprintf(fp,"       %-21.21s : %-11.11s",loc_legend[1290],p_pkg_seq_num[i]);
					 }
					}

					 print_formated_amt(l_pkg_dep_amt);
					 if(nd_print_option.arr[0]=='R')
					 fun_bl_report_temp_format();
					 else
					 fprintf(fp,"\n"); //lsr_line_cnt(); 
				  }
				}
			  }
			
			}
			*/


			/************* IT PRINTS THE BILL ADJUSTMENTS **************/
            /**** As Saparate Row ****/
			
			/*COMMENTED FOR SCRUM  CRF-654
			if(strcmp(c_all_oth_adj_amt_ind.arr,"R")==0)  
			{
			  if((d1_tot_adjust_amt!=0)|| (strcmp(c_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
			  {
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[780],61);
				  if(strlen(loc_legend[780])<61)
				  fun_add_space(61-strlen(loc_legend[780]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				    fprintf(fp,"%-61.61s",loc_legend[780]);
					}
				}
				else
				{
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[780],43);
				  if(strlen(loc_legend[780])<43)
				  fun_add_space(43-strlen(loc_legend[780]));
				 }
				 else
				 {
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-43.43s",loc_legend[780]);
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[780],52);
				  if(strlen(loc_legend[780])<52)
				  fun_add_space(52-strlen(loc_legend[780]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				        fprintf(fp," %-52.52s",loc_legend[780]);
				  }
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[780],55);
				  if(strlen(loc_legend[780])<55)
				  fun_add_space(55-strlen(loc_legend[780]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				  fprintf(fp," %-55.55s",loc_legend[780]);
				  }
				 }
				 else
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[780],41);
				  if(strlen(loc_legend[780])<41)
				  fun_add_space(41-strlen(loc_legend[780]));
				 }
				 else
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-41.41s",loc_legend[780]);
					}
				 }
				}
				print_formated_amt(d1_tot_adjust_amt);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
			  }
			  
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			{
			
			 if((nd_tot_disc_amount)!=0)
			 {
			 
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[790],61);
				  if(strlen(loc_legend[790])<61)
				  fun_add_space(61-strlen(loc_legend[790]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					   fprintf(fp," %-61.61s",loc_legend[790]);
					}
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[790],43);
				  if(strlen(loc_legend[790])<43)
				  fun_add_space(43-strlen(loc_legend[790]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					   fprintf(fp," %-43.43s",loc_legend[790]);
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[790],52);
				  if(strlen(loc_legend[790])<52)
				  fun_add_space(52-strlen(loc_legend[790]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp," %-52.52s",loc_legend[790]);
				  }
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[790],55);
				  if(strlen(loc_legend[790])<55)
				  fun_add_space(55-strlen(loc_legend[790]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-55.55s",loc_legend[790]);
					}
				 }
				 else
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[790],41);
				  if(strlen(loc_legend[790])<41)
				  fun_add_space(41-strlen(loc_legend[790]));
				 }
				 else
				 {
                   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp," %-41.41s",loc_legend[790]);
				  }
				 }
				}
				print_formated_amt(nd_tot_disc_amount);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
			 }
			}
			if(d1_bill_tot_exmpt_amt!=0)
			{
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[720],61);
				  if(strlen(loc_legend[720])<61)
				  fun_add_space(61-strlen(loc_legend[720]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					      fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					   fprintf(fp," %-61.61s",loc_legend[720]);
				 }
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[720],43);
				  if(strlen(loc_legend[720])<43)
				  fun_add_space(43-strlen(loc_legend[720]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
						 																																														
					}
					else
				   	fprintf(fp," %-43.43s",loc_legend[720]);
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[720],52);
				  if(strlen(loc_legend[720])<52)
				  fun_add_space(52-strlen(loc_legend[720]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					     fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-52.52s",loc_legend[720]);
				  }
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[720],55);
				  if(strlen(loc_legend[720])<55)
				  fun_add_space(55-strlen(loc_legend[720]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
					    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp," %-55.55s",loc_legend[720]);
				  }
				 }
				 else
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[720],41);
				  if(strlen(loc_legend[720])<41)
				  fun_add_space(41-strlen(loc_legend[720]));
				 }
				 else
				 {
                   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);																																														
			     	}
				       else
				        fprintf(fp," %-41.41s",loc_legend[720]);
				   }
				 }
				}
				print_formated_amt(d1_bill_tot_exmpt_amt);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
			}
			if(d1_tot_write_off_amt!=0)
			{
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
			     if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[800],61);
				  if(strlen(loc_legend[800])<61)
				  fun_add_space(61-strlen(loc_legend[800]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
						 																																														
					}
					else 
					   fprintf(fp," %-61.61s",loc_legend[800]);
				  }
				}
				else
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[800],43);
				  if(strlen(loc_legend[800])<43)
				  fun_add_space(43-strlen(loc_legend[800]));
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
					    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					fprintf(fp," %-43.43s",loc_legend[800]);
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[800],52);
				  if(strlen(loc_legend[800])<52)
				  fun_add_space(52-strlen(loc_legend[800]));
				 }
				 else
				 {
				     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					 fprintf(fp," %-52.52s",loc_legend[800]);
					 }
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[800],55);
				  if(strlen(loc_legend[800])<55)
				  fun_add_space(55-strlen(loc_legend[800]));
				 }
				 else
				  {
				     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					 fprintf(fp," %-55.55s",loc_legend[800]);
					 }
				 }
				 else
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  fun_add_space(1);
				  strncat(nd_line_text.arr,loc_legend[800],41);
				  if(strlen(loc_legend[800])<41)
				  fun_add_space(41-strlen(loc_legend[800]));
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
  					    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				      fprintf(fp," %-41.41s",loc_legend[800]);
				  }
				 }
				}
				print_formated_amt(d1_tot_write_off_amt);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
            } 
		   }
		   COMMENTED FOR SCRUM CRF-654*/

            /**** As Summrized Row ****/
			 /*COMMENTED FOR SCRUM CRF-654

			if (strcmp(c_all_oth_adj_amt_ind.arr,"S")==0)  
		    {
               if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			   {
				  if(d1_tot_adjust_amt!=0 ||nd_tot_disc_amount!=0 ||d1_bill_tot_exmpt_amt!=0||d1_tot_write_off_amt!=0)
				  {
				   if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				   {
				   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				   {
				     if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],61);
					  if(strlen(loc_legend[780])<61)
					  fun_add_space(61-strlen(loc_legend[780]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
                          fprintf(fp," %-61.61s",loc_legend[780]);
					   }
				   }
				   else
				   {
				    if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],43);
					  if(strlen(loc_legend[780])<43)
					  fun_add_space(43-strlen(loc_legend[780]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
							 																																														
						}
						else
						   fprintf(fp," %-43.43s",loc_legend[780]);
						}
				   }
				   }
				   else
				   {
					if(l_no_of_clumns ==5)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],52);
					  if(strlen(loc_legend[780])<52)
					  fun_add_space(52-strlen(loc_legend[780]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
							fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
						     fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-52.52s",loc_legend[780]);
					   }
					}
					else
					if(l_no_of_clumns ==6)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],55);
					  if(strlen(loc_legend[780])<55)
					  fun_add_space(55-strlen(loc_legend[780]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-55.55s",loc_legend[780]);
					   }
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],41);
					  if(strlen(loc_legend[780])<41)
					  fun_add_space(41-strlen(loc_legend[780]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-41.41s",loc_legend[780]);
						}
					}
				   }
				   print_formated_amt(d1_tot_adjust_amt+nd_tot_disc_amount+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
				   if(nd_print_option.arr[0]=='R')
				   fun_bl_report_temp_format();
				   else
				   fprintf(fp,"\n");lsr_line_cnt();
				  }

    		   }
			   else
			   {
			      if(d1_tot_adjust_amt!=0 ||d1_bill_tot_exmpt_amt!=0||d1_tot_write_off_amt!=0) 
				  {
				   if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				   {
				   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				   {
				     if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],61);
					  if(strlen(loc_legend[780])<61)
					  fun_add_space(61-strlen(loc_legend[780]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-61.61s",loc_legend[780]);
					   }
				   }
				   else
				   {
				    if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],43);
					  if(strlen(loc_legend[780])<43)
					  fun_add_space(43-strlen(loc_legend[780]));
					 }
					 else
					 {
				       if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					   fprintf(fp," %-43.43s",loc_legend[780]);
					   }
				   }
				   }
				   else
				   {
					if(l_no_of_clumns ==5)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],52);
					  if(strlen(loc_legend[780])<52)
					  fun_add_space(52-strlen(loc_legend[780]));
					 }
					 else
					 fprintf(fp," %-52.52s",loc_legend[780]);
					}
					else
					if(l_no_of_clumns ==6)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],55);
					  if(strlen(loc_legend[780])<55)
					  fun_add_space(55-strlen(loc_legend[780]));
					 }
					 else
					 fprintf(fp," %-55.55s",loc_legend[780]);
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],41);
					  if(strlen(loc_legend[780])<41)
					  fun_add_space(41-strlen(loc_legend[780]));
					 }
					 else
					 fprintf(fp," %-41.41s",loc_legend[780]);
					}
				   }
				   print_formated_amt(d1_tot_adjust_amt+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
				   if(nd_print_option.arr[0]=='R')
				   fun_bl_report_temp_format();
				   else
				   fprintf(fp,"\n");lsr_line_cnt();
				  }
			   
			   }

			   
			   if(strcmp(c_bill_adj_sep_row_yn.arr,"Y")==0)
			    {
				 if((d1_tot_adjust_amt!=0) || (strcmp(c_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
				 {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],61);
					  if(strlen(loc_legend[780])<61)
					  fun_add_space(61-strlen(loc_legend[780]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp," %-61.61s",loc_legend[780]);
						}
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],43);
					  if(strlen(loc_legend[780])<43)
					  fun_add_space(43-strlen(loc_legend[780]));
					 }
					 else
					 {
					   
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					   fprintf(fp," %-43.43s",loc_legend[780]);
                      }
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],52);
					  if(strlen(loc_legend[780])<52)
					  fun_add_space(52-strlen(loc_legend[780]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						      fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					      fprintf(fp," %-52.52s",loc_legend[780]);
					  }
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],55);
					  if(strlen(loc_legend[780])<55)
					  fun_add_space(55-strlen(loc_legend[780]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					  fprintf(fp," %-55.55s",loc_legend[780]);
					  }
					 }
					 else
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[780],41);
					  if(strlen(loc_legend[780])<41)
					  fun_add_space(41-strlen(loc_legend[780]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[780]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					   fprintf(fp," %-41.41s",loc_legend[780]);
					   }
					 }
					}
					print_formated_amt(d1_tot_adjust_amt);
					if(nd_print_option.arr[0]=='R')
					fun_bl_report_temp_format();
					else
					fprintf(fp,"\n");lsr_line_cnt();
				 }
				 

				}
			   
			   
			   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			    if (strcmp(c_bill_disc_sep_row_yn.arr,"Y")==0)
			    {
				
				  if((p_tot_pat_disc_amt)!=0)
				  {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[790],61);
					  if(strlen(loc_legend[790])<61)
					  fun_add_space(61-strlen(loc_legend[790]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[790]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					   fprintf(fp," %-61.61s",loc_legend[790]);
					   }
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[790],43);
					  if(strlen(loc_legend[790])<43)
					  fun_add_space(43-strlen(loc_legend[790]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[790]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp," %-43.43s",loc_legend[790]);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[790],52);
					  if(strlen(loc_legend[790])<52)
					  fun_add_space(52-strlen(loc_legend[790]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[790]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					  fprintf(fp," %-52.52s",loc_legend[790]);
					  }
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[790],55);
					  if(strlen(loc_legend[790])<55)
					  fun_add_space(55-strlen(loc_legend[790]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[790]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					  fprintf(fp," %-55.55s",loc_legend[790]);
					  }
					 }
					 else
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[790],41);
					  if(strlen(loc_legend[790])<41)
					  fun_add_space(41-strlen(loc_legend[790]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[790]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					  fprintf(fp," %-41.41s",loc_legend[790]);
					  }
					 }
					}
					print_formated_amt(p_tot_pat_disc_amt);
					if(nd_print_option.arr[0]=='R')
					fun_bl_report_temp_format();
					else
					fprintf(fp,"\n");lsr_line_cnt();
				  }
				}

				

				if(strcmp(c_bill_exm_sep_row_yn.arr,"Y")==0)
			    {
				 if(d1_bill_tot_exmpt_amt!=0)
				 {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[720],61);
					  if(strlen(loc_legend[720])<61)
					  fun_add_space(61-strlen(loc_legend[720]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[720]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-61.61s",loc_legend[720]);
						}
					}
					else
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[720],43);
					  if(strlen(loc_legend[720])<43)
					  fun_add_space(43-strlen(loc_legend[720]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[720]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
						fprintf(fp," %-43.43s",loc_legend[720]);
						}
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[720],52);
					  if(strlen(loc_legend[720])<52)
					  fun_add_space(52-strlen(loc_legend[720]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[720]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-52.52s",loc_legend[720]);
					  }
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[720],55);
					  if(strlen(loc_legend[720])<55)
					  fun_add_space(55-strlen(loc_legend[720]));
					 }
					 else
					 {
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[720]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-55.55s",loc_legend[720]);
						}
					 }
					 else
					 {
					   if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[720],41);
					  if(strlen(loc_legend[720])<41)
					  fun_add_space(41-strlen(loc_legend[720]));
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[720]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-41.41s",loc_legend[720]);
					  }
					 }
					}
					print_formated_amt(d1_bill_tot_exmpt_amt);
					if(nd_print_option.arr[0]=='R')
					fun_bl_report_temp_format();
					else
					fprintf(fp,"\n");lsr_line_cnt();
				 }
				}

				if (strcmp(c_bill_wo_sep_row_yn.arr,"Y")==0)
			    {
				  if(d1_tot_write_off_amt!=0)
				  {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[800],61);
					  if(strlen(loc_legend[800])<61)
					  fun_add_space(61-strlen(loc_legend[800]));
					 }
					 else
					 {
                        if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[800]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
							 																																														
						}
						else
					    fprintf(fp," %-61.61s",loc_legend[800]);
						}
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[800],43);
					  if(strlen(loc_legend[800])<43)
					  fun_add_space(43-strlen(loc_legend[800]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-43.43s",loc_legend[800]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
							fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
						    fprintf(fp," %-43.43s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					   fprintf(fp," %-43.43s",loc_legend[800]);
					   }
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[800],52);
					  if(strlen(loc_legend[800])<52)
					  fun_add_space(52-strlen(loc_legend[800]));
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[800]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp," %-52.52s",loc_legend[800]);
						}
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[800],55);
					  if(strlen(loc_legend[800])<55)
					  fun_add_space(55-strlen(loc_legend[800]));
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[800]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					      fprintf(fp," %-55.55s",loc_legend[800]);
					   }
					 }
					 else
					 {
					  if(nd_print_option.arr[0]=='R')
					 {
					  fun_add_space(1);
					  strncat(nd_line_text.arr,loc_legend[800],41);
					  if(strlen(loc_legend[800])<41)
					  fun_add_space(41-strlen(loc_legend[800]));
					 }
					 else
					 {
					     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[800]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					     fprintf(fp," %-41.41s",loc_legend[800]);
					  }
					 }
					}
					print_formated_amt(d1_tot_write_off_amt);
					if(nd_print_option.arr[0]=='R')
					fun_bl_report_temp_format();
					else
					fprintf(fp,"\n");lsr_line_cnt();
				  }
				}

             }
			  COMMENTED FOR SCRUM CRF-654*/

			/******************************/

				

		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS2")==0|| strcmp(nd_calling_pgm_id.arr,"BLRIPDS3")==0 ||strcmp(nd_calling_pgm_id.arr,"BLRUCDS3")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0|| strcmp(nd_calling_pgm_id.arr,"BLR00101")==0 || //added for scrum crf-654 
		   strcmp(l_no_settlement_details.arr,"R")==0 || strcmp(l_no_settlement_details.arr,"N")==0)
		{
			/***** Printing Deposit Amt as Row ****
			if(d_deposit_adj_amt!=0)
			{ 
    			if(strcmp(d_cust_code.arr,"\0")==0) //added for scrum crf-654
	    		{ //added for scrum crf-654
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[992],62); //changed for scrum 880-->992
				  if(strlen(loc_legend[992])<62)   //changed for scrum 880-->992
				  fun_add_space(62-strlen(loc_legend[992]));  //changed for scrum 880-->992
				 }
				 else
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[992]);   //changed for scrum 880-->992
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
					     fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				   fprintf(fp,"%-62.62s",loc_legend[992]); // changed for scrum 880-->992
				   }
				}
				else
				{
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[992],44); // changed for scrum 880-->992
				  if(strlen(loc_legend[992])<44)  // changed for scrum 880-->992
				  fun_add_space(44-strlen(loc_legend[992])); // changed for scrum 880-->992
				 }
				 else
				 {
                    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[992]); // changed for scrum 880-->992
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					     fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				    fprintf(fp,"%-44.44s",loc_legend[992]); // changed for scrum 880-->992
					}
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[992],53);// changed for scrum 880-->992
				  if(strlen(loc_legend[992])<53) // changed for scrum 880-->992
				  fun_add_space(53-strlen(loc_legend[992])); // changed for scrum 880-->992
				 }
				 else
				 {
                    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[992]); // changed for scrum 880-->992
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				    fprintf(fp,"%-53.53s",loc_legend[992]); // changed for scrum 880-->992
					}
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[992],56); // changed for scrum 880-->992
				  if(strlen(loc_legend[992])<56)                // changed for scrum 880-->992 
				  fun_add_space(56-strlen(loc_legend[992]));    // changed for scrum 880-->992
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[992]); // changed for scrum 880-->992
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    	fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					fprintf(fp,"%-56.56s",loc_legend[992]); // changed for scrum 880-->992
					}
				 }
				 else
				 {
				   if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[992],42); // changed for scrum 880-->992
				  if(strlen(loc_legend[992])<42) // changed for scrum 880-->992
				  fun_add_space(42-strlen(loc_legend[992])); // changed for scrum 880-->992
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[992]); // changed for scrum 880-->992
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					fprintf(fp,"%-42.42s",loc_legend[992]); // changed for scrum 880-->992
					}
				 }
				}
				print_formated_amt(d_deposit_adj_amt);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
				 } // added for scrum crf-654
			}*/


			/***** Printing Bill Paid Amt as Row *****/
			if(d_bill_paid_amt!=0)
			{
				
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[1150],62);
				  if(strlen(loc_legend[1150])<62)
				  fun_add_space(62-strlen(loc_legend[1150]));
				  fun_bl_report_temp_format();
				 }
				 else
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1150]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-62.62s\n",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				   fprintf(fp,"%-62.62s\n",loc_legend[1150]);
				   }
				}
				else
				 {
				  if(nd_print_option.arr[0]=='R')
				 {
				  strncat(nd_line_text.arr,loc_legend[1150],44);
				  if(strlen(loc_legend[1150])<44)
				  fun_add_space(44-strlen(loc_legend[1150]));
				  fun_bl_report_temp_format();
				 }
				 else
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[1150]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-44.44s\n",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					fprintf(fp,"%-44.44s\n",loc_legend[1150]);
				  }
				 }
				 print_payment_dtls();
			     if(nd_print_option.arr[0]=='R')
				 fun_add_space(48);
				 else
				 fprintf(fp,"%-48.48s","");
				}
				else
				{
					if(l_no_of_clumns ==5)
					{
			   		  if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1150],53);
					  if(strlen(loc_legend[1150])<53)
					  fun_add_space(53-strlen(loc_legend[1150]));
					  fun_bl_report_temp_format();
					 }
					 else
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1150]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-53.53s\n",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					  fprintf(fp,"%-53.53s\n",loc_legend[1150]);
					  print_payment_dtls();
					  if(nd_print_option.arr[0]=='R')
					  fun_add_space(53);
					  else
					  fprintf(fp,"%-53.53s","");
					}
					else
					if(l_no_of_clumns ==6)
					{
					  if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1150],56);
					  if(strlen(loc_legend[1150])<56)
					  fun_add_space(56-strlen(loc_legend[1150]));
					  fun_bl_report_temp_format();
					 }
					 else
					 {
					    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1150]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-56.56s\n",nd_desc_with_spl_chr.arr);																																														
						}
						else
						fprintf(fp,"%-56.56s\n",loc_legend[1150]);
						}
					  print_payment_dtls();
					  if(nd_print_option.arr[0]=='R')
					  fun_add_space(56);
					  else
					  fprintf(fp,"%-56.56s","");
					}
					else
					{
					 if(nd_print_option.arr[0]=='R')
					 {
					  strncat(nd_line_text.arr,loc_legend[1150],42);
					  if(strlen(loc_legend[1150])<42)
					  fun_add_space(42-strlen(loc_legend[1150]));
					  fun_bl_report_temp_format();
					 }
					 else
					 {
                        if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1150]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"%-42.42s\n",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					    fprintf(fp,"%-42.42s\n",loc_legend[1150]);
						}
					 print_payment_dtls();
					 if(nd_print_option.arr[0]=='R')
					 fun_add_space(42);
					 else
					 fprintf(fp,"%-42.42s","");
					}
				}
				print_formated_amt(d_bill_paid_amt);
				if(nd_print_option.arr[0]=='R')
				fun_bl_report_temp_format();
				else
				fprintf(fp,"\n");lsr_line_cnt();
			}
		
			/***** Printing Outstanding Amt as Row *****/
			
		//disp_message(ERR_MESG,"Outstanding ");
		// disp_message(ERR_MESG,"d_bill_tot_outst_amt");
		// sprintf(st_var,"%f",d_bill_tot_outst_amt);
		// disp_message(ERR_MESG,st_var);			

		//	if(d_bill_tot_outst_amt!=0)  //CRF-659-RESEND
		//	{
		//	if(strcmp(d_cust_code.arr,"\0")==0)	//ADDED FOR SCRUM CRF-654 remerging
			   //{                                    //ADDED FOR SCRUM CRF-654  remerging
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
                    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-31.31s",loc_legend[890]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%-31.31s %-30.30s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																				
					}
					else
				       fprintf(fp,"%-31.31s %-30.30s",loc_legend[890],nd_curr_date_t.arr);
				   }
				else
				{
                    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-25.25s",loc_legend[890]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				        fprintf(fp,"%-25.25s %-18.18s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																				
					}
					else
				    fprintf(fp,"%-25.25s %-18.18s",loc_legend[890],nd_curr_date_t.arr);
					}
				}
							else
				{
				 if(l_no_of_clumns ==5)
				 fprintf(fp,"%-36.36s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				 else
				 if(l_no_of_clumns ==6)
				 {
				    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-39.39s",loc_legend[890]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-39.39s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																				
					}
					else
					fprintf(fp,"%-39.39s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
					}
				 else
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-25.25s",loc_legend[890]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp,"%-25.25s %-16.16s",nd_desc_with_spl_chr.arr ,nd_curr_date_t.arr);
																																																				
					}
					else
				   fprintf(fp,"%-25.25s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				   }
				}
				//disp_message(ERR_MESG,"222");
				//sprintf(st_var,"[%f] [%f] [%f] [%f]",d_bill_tot_outst_amt,d_pk_variance_amt,l_tot_var_tax,d_deposit_adj_amt);
				//disp_message(ERR_MESG,st_var);
				d_bill_tot_outst_amt = d_bill_tot_outst_amt+ d_pk_variance_amt+d_deposit_adj_amt;//rajesh
				print_formated_amt(d_bill_tot_outst_amt);
				// } //ADDED FOR SCRUM CRF-654 remerging
			}
			
	//	}
		   
		    //print_footer(); //commented as per the instruction frm Kuila	
	   //sprintf(st_var,"%f",nd_net_pay_amt_after_rounded);
	   //disp_message(ERR_MESG,st_var);
	   //sprintf(st_var,"%f",d_pk_pack_tot_n_amount);
	   //disp_message(ERR_MESG,st_var);

			if(nd_net_pay_amt_after_rounded!=0)
			{
			if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
				amount=nd_net_pay_amt_after_rounded;
			else
			amount=nd_net_pay_amt_after_rounded+ d_pk_pack_tot_n_amount;

			 print_amt_in_words();
			}
			else
			{
			if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
				amount=nd_tot_pat_net_charge_amt;
			else
			amount=nd_tot_pat_net_charge_amt+ d_pk_pack_tot_n_amount;
			 print_amt_in_words();
			}


      }
	  else
	  {
	  		
			if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='Y')
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			 {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp,"%-62.62s",loc_legend[680]);
				}
			else
			fprintf(fp,"%-44.44s",loc_legend[680]);
			 print_formated_amt(nd1_tot_serv_tot_disc);
			}
			else
			if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='N')
			{
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-60.60s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%-60.60s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			 fprintf(fp,"%-60.60s",loc_legend[680]);
			 print_formated_amt(nd1_tot_serv_tot_disc);
			 amount=nd1_tot_serv_tot_disc;
			 print_amt_in_words();
			}
			else
			{
			 fprintf(fp,"%-42.42s"," ");
			 print_formated_amt(nd1_tot_serv_charge_discount);
			 print_formated_amt(nd1_tot_serv_bill_discount);
			 print_formated_amt(nd1_tot_serv_fund_adjustment);
			 fprintf(fp,"\n");lsr_line_cnt();
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			 fprintf(fp,"%-42.42s",loc_legend[680]);
			 print_formated_amt(nd1_tot_serv_charge_discount+nd1_tot_serv_bill_discount+nd1_tot_serv_fund_adjustment);
			 amount=nd1_tot_serv_charge_discount+nd1_tot_serv_bill_discount+nd1_tot_serv_fund_adjustment;
			 print_amt_in_words();

			}
	  }
	
	declare_payer_approval();  //Rajesh	
	open_payer_approval();     //Rajesh
	print_sign_designation();
	close_payer_approval();  //Rajesh

	if (strcmp(nd_bill_format_id.arr,"1")==0)
	if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
	{
      	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
		{
			
			fun_Pad_desc_with_spl_char(loc_legend[1425]); 
	         fprintf(fp,"\n%-64.64s %-s  %-s "," ",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
			fun_Pad_desc_with_spl_char(loc_legend[1424]); 
	         fprintf(fp,"%-s ",nd_desc_with_spl_chr.arr);
  		}
		else
	     fprintf(fp,"\n%-64.64s %-s  %-s %-s\n"," ",loc_legend[1425],nd_curr_date_t.arr,loc_legend[1424]);
	}
	
	if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0) //IN13383
	print_footer1();
	

  }        //end of if --v_c_billed_serv//


else 
  {
	
		get_column_count_pat();
	
		print_report_head();

		 if (strcmp(nd_bill_format_id.arr,"2")==0) //added for IN23425
		 {
			v_lno = line_ctr;	
		 }
		
		//get_legend_value();
		l_next_page=3;
			
		//fprintf(fp,"%-35s %21s %17s %17.17s\n",loc_legend[770],loc_legend[680],loc_legend[820],loc_legend[830]);
		lsr_line_cnt(); 
		
	    /*if( lcol_cnt == 1)
		prt_line_uc();
		if(lcol_cnt == 2)
		prt_line_uc_wide();
    	if(lcol_cnt == 3)
		prt_line_uc_wide1();
		if(lcol_cnt == 5 || lcol_cnt == 6)
		prt_line_uc_wide2();
        
		//prt_line_uc();
		fprintf(fp,"\n");lsr_line_cnt();*/

		open_patient_cur();

		ccnt=0;
		nd1_summary_dtl_ind.arr[0]='\0';
		nd2_summary_dtl_ind.arr[0]='\0';
		nd1_prt_grp_hdr_code.arr[0]='\0';
		nd1_prt_grp_line_code.arr[0]='\0';

		
		
		/***** this code added for printing package bill if it is there ****/
		//This code commented by Rajesh

		/*  
		if(l_pkg_len!=0)
		{
		 print_package_dtls(); 
		 
		}
		*/
		/***** upto here *****/
		   
		get_legend_value();
	
		if( lcol_cnt == 1)
		prt_line_uc();
		if(lcol_cnt == 2)
		prt_line_uc_wide();
    	if(lcol_cnt == 3)
		prt_line_uc_wide1();
		if(lcol_cnt == 5 || lcol_cnt == 6)
		prt_line_uc_wide2();
		
		fprintf(fp,"\n"); //rajesh line was not coming previously in package details for cash patient

		/***** RAJESH this code added for printing package bill if it is there ****/

		if(l_pkg_len!=0)
		{
		 print_package_dtls(); //3
		}
		/***** upto here *****/
	
	// The below code commented by Rajesh ICN389
	/*
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
  */

        while(fetch_patient_cur()) 
		{ 
	    /** The below Code added by raghava on 23/11/2009 for dn't print zero discount amount **/
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && d1_tot_disc!=0)
		 {
		 	ccnt = ccnt + 1;
			//print_cash_patient_hdr();// Commented as per kuila sir instruction 
			print_patient_hdr();  
		 } 
		 else
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  	ccnt = ccnt + 1;
			//print_cash_patient_hdr();// Commented as per kuila sir instruction 
			print_patient_hdr();  
		 }   
		}
		

		fun_print_end_of_report();

		
		
		/*
        if(end_of_report)
		{
		
		p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;	// Total Gross		
		p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;		// Total Net	
		nd_tot_pat_disc_amt=nd_tot_pat_disc_amt+nd_pat_disc_amt;	// Total discount Amt

		//nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_pat_net_charge_amt; 
		//nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt; commented at 04/11/07

		if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
		print_formated_amt(nd_pat_gross_amt);
		if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
		print_formated_amt(nd_pat_net_amt1);
		if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0)   
		print_formated_amt(nd_pat_disc_amt);
				
		if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0) 
		 {
			nd_pat_net_amt1=nd_pat_gross_amt-nd_pat_disc_amt;
			print_formated_amt(nd_pat_net_amt1); //Net Amount
		 }
		if(strcmp(c_reim_amt_ind.arr,"Y")==0)
		print_formated_amt(nd_tot_net_reimbursable_amt);
		fprintf(fp," ");
		if(strcmp(c_non_reim_amt_ind.arr,"Y")==0) 
		print_formated_amt(nd_tot_non_reimbursable_amt);

		//print_formated_amt(nd_net_non_reimbursable_amt);
		//print_formated_amt(nd_pat_net_charge_amt);

		
		}
	

		fprintf(fp,"\n");lsr_line_cnt();
		if( lcol_cnt == 1)
		prt_line_uc();
		if(lcol_cnt == 2)
		prt_line_uc_wide();
		if(lcol_cnt == 3)
		prt_line_uc_wide1();
		if(lcol_cnt == 5 || lcol_cnt == 6)
		prt_line_uc_wide2();

		//prt_line_uc();
		fprintf(fp,"\n");lsr_line_cnt();
		fprintf(fp,"%-41s ",loc_legend[680]);
		if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
		print_formated_amt(p_tot_pat_gross_amt);
		if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
		print_formated_amt(p_tot_pat_net_amt);

		if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0) 
		{
	      print_formated_amt(nd_tot_pat_disc_amt);			// Printing the discount as a column
		  print_formated_amt(nd_tot_pat_net_charge_amt);	// Printing the Net Amt as a column
		}

	    if (strcmp(c_reim_amt_ind.arr,"Y")==0)
		print_formated_amt(nd_gnd_tot_net_reimbursable_amt);     // Total Reimbursable Amt 
		fprintf(fp," ");
		if (strcmp(c_non_reim_amt_ind.arr,"Y")==0)
		print_formated_amt(nd_gnd_tot_net_non_reimbursable_amt); // Total Non Reimbursable Amt 
       	fprintf(fp,"\n");lsr_line_cnt();

		
		if (strcmp(c_serv_disc_on_gross_ind.arr,"R")==0) 
		{
		  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-39.39s",loc_legend[840]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-39.39s  ",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
		   fprintf(fp," %-39.39s  ",loc_legend[840]);
		  print_formated_amt(nd_tot_pat_disc_amt);		          // Printing the discount as a row
		  fprintf(fp,"\n");
		  lsr_line_cnt();
		} 

	
			

			if (strcmp(c_all_oth_adj_amt_ind.arr,"R")==0)  
			{
			if ((d1_tot_adjust_amt!=0)||(strcmp(c_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
			{
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41s",loc_legend[780]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			fprintf(fp," %-41s",loc_legend[780]);
			print_formated_amt(d1_tot_adjust_amt);
			fprintf(fp,"\n");lsr_line_cnt();
			}
           
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41s",loc_legend[790]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);																																														
			}
			else
			fprintf(fp," %-41s",loc_legend[790]);
			print_formated_amt(nd_tot_disc_amount);
			fprintf(fp,"\n");lsr_line_cnt();

			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41s",loc_legend[720]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
			    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			fprintf(fp," %-41s",loc_legend[720]);
			print_formated_amt(d1_bill_tot_exmpt_amt);
			fprintf(fp,"\n");lsr_line_cnt();
            
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41s",loc_legend[800]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			fprintf(fp," %-41s",loc_legend[800]);
			print_formated_amt(d1_tot_write_off_amt);
			fprintf(fp,"\n");lsr_line_cnt();
			}

			if (strcmp(c_all_oth_adj_amt_ind.arr,"S")==0)  
		     {
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
					 																																														
				}
				else
              fprintf(fp," %-41s",loc_legend[780]);
              print_formated_amt(d1_tot_adjust_amt+nd_tot_disc_amount+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);

				fprintf(fp,"\n");lsr_line_cnt();

			   if (strcmp(c_bill_disc_sep_row_yn.arr,"Y")==0)
			    {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41s",loc_legend[710]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				{
				
                fprintf(fp," %-41s",loc_legend[710]);
				}
				print_formated_amt(nd_tot_disc_amount);
				fprintf(fp,"\n");lsr_line_cnt();

				}

				 if (strcmp(c_bill_adj_sep_row_yn.arr,"Y")==0)
			    {
					if ((d1_tot_adjust_amt!=0) || (strcmp(c_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
					{
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
					    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
					fprintf(fp," %-41s",loc_legend[780]);
					print_formated_amt(d1_tot_adjust_amt);
					fprintf(fp,"\n");lsr_line_cnt();
					}
					
				}

				 if (strcmp(c_bill_exm_sep_row_yn.arr,"Y")==0)
			    {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
                fprintf(fp," %-41s",loc_legend[720]);
				print_formated_amt(d1_bill_tot_exmpt_amt);
				fprintf(fp,"\n");lsr_line_cnt();
				}

				if (strcmp(c_bill_wo_sep_row_yn.arr,"Y")==0)
			    {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
				    fprintf(fp," %-41s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
                fprintf(fp," %-41s",loc_legend[800]);
				print_formated_amt(d1_tot_write_off_amt);
				fprintf(fp,"\n");lsr_line_cnt();
				}

             }

			

	    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
		 {
			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%-41s",loc_legend[740]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 		    fprintf(fp,"%-41s ",nd_desc_with_spl_chr.arr);
																																																	
		}
		else	
		fprintf(fp,"%-41s ",loc_legend[740]);
		
		print_formated_amt(nd_tot_pat_net_charge_amt);	  // Printing the Net Payble Amt as a row

			//ADDED FOR SCRUM CRF-654
		if (d_tot_outst_amt!=0)
		{
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			{
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41s",loc_legend[993]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-41s ",nd_desc_with_spl_chr.arr);
			}
			else
			{
				fprintf(fp,"%-41s ",loc_legend[993]);
			}
		print_formated_amt(d_tot_outst_amt);	 
		}
		//ADDED FOR SCRUM CRF-654
		
		//print_formated_amt(nd_tot_pat_net_charge_amt+nd_gnd_tot_net_reimbursable_amt);
		fprintf(fp,"\n");lsr_line_cnt();

		//print_footer();//commented as per the instruction frm Kuila		

		*/
		
  }
  
}
else
{
 print_sponsor_patient_hdr();
} 
 
 		if (l_lsr != 0 && l_dmp == 0 )
		{
			l_main_hdr = 0;
			fprintf(fp,"\n");
			v_lno = v_lno+1;	
			if (v_lno > max_lines) print_next_page1();
		}
		else
		{
			while(v_lno <= max_lines)
			{
				fprintf(fp,"\n");
				v_lno++;
			}
		}

	/*	if (l_lsr != 0 && l_dmp == 0 )
		{
			fprintf(fp,"%-50.50s ",loc_legend[130]," ");
		}
		else
		{
			fprintf(fp,"%20.20s %30s",loc_legend[130]," ");
		}

       */

	/***** This function will call discount document Pro*C file and print *****/
	 //if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
	 //print_discount_document();


fflush(fp);
fclose(fp);

   } //End Loop
  
 
 } // END WHILE


delete_sy_prog();

//close_cust_cur();

 
	if ( l_logo_yniflaser.arr[0] != 'Y')
	{
	
	fprintf(fp,"");   /* Page break  */
	}

	if (l_lsr != 0 && l_dmp == 0)
	{
	     if ( l_logo_yniflaser.arr[0] != 'Y')
	     {
		  fprintf(fp,"%cE",ESC);  /* To Reset Printer */			
	     }
	}

//fflush(fp);  commented on 13/5/2008
//fclose(fp);  commented on 13/5/2008


	
	if (strcmp(nd_calling_pgm_id.arr,"BLTBILVT") == 0 )
	{	
		strcpy(nd_calling_pgm_id.arr,"BLRBILVT");
		nd_calling_pgm_id.arr[nd_calling_pgm_id.len] = '\0';
	}
 
			/*sprintf(nd_str,"[%s] [%s] [%s] [%s] [%s] ", uid_pwd.arr,nd_session_id.arr,
								d_cashfacility_id.arr, nd_calling_pgm_id.arr,
							filename);
			disp_message(ERR_MESG,nd_str);*/


	 
	if (nd_online_print_yn == 'Y')
	{
		if (l_logo_yniflaser.arr[0] != 'Y')
		{
	
		  if(l_discr_cnt>0)
	      l_loop_cnt=2; 
	      else
          l_loop_cnt=1; 
				

		     for(l=1;l<=l_loop_cnt;l++)
		     {				
				
				if (strcmp(l_only_print_discount.arr,"Y")==0) //ADDED BY VANI REGARDING IN11662
				l=2;

				strcpy(nd_calling_pgm_id.arr,l_nd_calling_pgm_id.arr);
				
				
	/* COMMENTED FOR SCRUM CRF-654							
				PrintDocument(uid_pwd.arr,		    //char	*PUidPwd;
						nd_session_id.arr,	        //char	*PSessionID;
						d_cashfacility_id.arr,		//char	*PFacilityID;
						"BL",						//char	*PModuleID;
						nd_calling_pgm_id.arr,		//char	*PDocumentID;
						l_filename[l],
						//filename,					//char	*POnlinePrintFileNames;
						"O",						//char	*PLocationTypes;
						" ",						//char	*PLocationCodes;
						0,							//int		PNumOfCopies;  // ealier 1 is there
						1,							//int		PPageFrom;
			
						9999);						//int		PPageTo;);
	COMMENTED FOR SCRUM CRF-654*/
		        
		        
		     }	  
			 
			 	 
		declare_bill_temp_cur();
		open_bill_temp_cur();
		fetch_bill_temp();  // ADDED FOR SCRUM CRF-654
		/*
		while(fetch_bill_temp())
		{
		 update_bill_print_flag();
		}
		close_bill_temp_cur();*/ // COMMENTED FOR SCRUM CRF-654
			
		}
	}
	else
	{
		if (l_lsr != 0 && l_dmp == 0 && l_logo_yniflaser.arr[0] == 'Y')
		{		

		l_errortext.arr[0] = '\0';
		l_errortext.len = 0;
					
/* COMMENTED FOR SCRUM CRF-654
		EXEC SQL EXECUTE
		DECLARE
			l_print_status BOOLEAN;
		BEGIN		
	
			 
			APPPRINT.SUBMIT_ORACLE_REPORT
				 (:nd_ws_no,
				  :d_cashfacility_id,
				  'BL',
				  :nd_logo_pgm_id,
				  'P', --p_report_option
				  '',  --p_outputfile_format
				  '',  --p_outputfile_name
				  'O',
				  ' ', --p_location_code
				  NULL, --:l_printer_names,
				  NULL,
				  NULL, --p_page_from
				  NULL, --p_page_to
				  NULL, --p_print_mode
				  'P_FILE_NAME='||:nd_file_name||'+'||'P_LOGO_NAME='||:l_logo_name, --p_param_list
				  l_print_status, --OUT BOOLEAN,
				 :l_errortext);			  
		
		END;
		END-EXEC;
COMMENTED FOR SCRUM CRF-654*/

		if (l_errortext.arr[0] != '\0')
		{
			disp_message(ERR_MESG,l_errortext.arr);			
			proc_exit(0);
			
		}
	

	     }
	}

    delete_bill_print_temp();
	return 1;
}


print_discount_document()
{

 	 if(l_disc_cnt==1)
	 {

		/***** For Calling Another Pro*C Program ******/

		sprintf(p_command_buf, "BLRDISCN %s %s %s %s %s",
				uid_pwd.arr,nd_session_id.arr,nd_pgm_date.arr,nd_facility_id.arr,"BLRDISCN");
   
	   //WinExec(p_command_buf,SW_SHOWNORMAL);

		lv_Spawn_ret = _spawnlp(_P_WAIT,"BLRDISCN",p_command_buf,NULL);
 
	 }
}

declare_bill_temp_cur()
{
  /*
  	EXEC SQL DECLARE BILL_TEMP_CUR CURSOR FOR
	SELECT a.DOC_TYPE_CODE,a.DOC_NUM,
		   nvl(a.MAN_DISC_AMT,0)+nvl(a.OVERALL_DISC_AMT,0)+
		   nvl(a.PMNT_DIFF_ADJ_AMT,0)+nvl(a.SERV_DISC_AMT,0)TOT_DISC_AMT 
	FROM BL_BILL_HDR a, BL_BILL_PRINT_TEMP b
		WHERE a.OPERATING_FACILITY_ID = :nd_facility_id
	    AND a.DOC_TYPE_CODE = b.DOC_TYPE_CODE 
		AND a.DOC_NUM       = b.DOC_NUM
		AND SESSION_ID		=:nd_session_id;
   commented for scrum remerging*/

  /*ADDED FOR SCRUM REMERGING*/
	/* EXEC SQL DECLARE BILL_TEMP_CUR CURSOR FOR
	SELECT PATIENT_ID,DOC_TYPE_CODE,DOC_NUM,EPISODE_ID //ADDED PATIENT_ID & EPISODE_ID FOR SCRUM CRF-654
	FROM BL_BILL_PRINT_TEMP
	WHERE OPERATING_FACILITY_ID  =:nd_facility_id
	AND SESSION_ID				 =:nd_session_id; */ 

	/*ADDED FOR SCRUM REMERGING*/



    if (OERROR)
		{ 
			disp_message (ERR_MESG,"declare failed FROM BL_BILL_PRINT_TEMP TABLE");
			proc_exit();
		}
	  	
}

open_bill_temp_cur()
{ 
		/* EXEC SQL OPEN BILL_TEMP_CUR; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 10;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = sq0006;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )192;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqcmod = (unsigned int )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )5;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_session_id;
  sqlstm.sqhstl[1] = (unsigned int  )18;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Open BILL_TEMP_CUR cursor failed");
		proc_exit();
		}
	return;
}

fetch_bill_temp()
{
  	nd_doc_type.arr[0]='\0';
	nd_doc_num.arr[0]='\0';
	nd_doc_type.len=0;
	nd_doc_num.len=0;

	v_patient_id.arr[0]='\0'; //added for scrum crf-654
	v_patient_id.len=0;       //added for scrum crf-654 

	nd_episode_id_1.arr[0]='\0'; //added for scrum crf-654  
	nd_episode_id_1.len=0; //added for scrum crf-654

/*
  EXEC SQL FETCH BILL_TEMP_CUR
   INTO :nd_doc_type,
		:nd_doc_num,
		:nd_tot_disc; commented for scrum remerging */

/*ADDED FOR SCRUM REMERGING*/
  /* EXEC SQL FETCH BILL_TEMP_CUR
   INTO :v_patient_id,   //added for scrum crf-654 
        :nd_doc_type,
	:nd_doc_num,
	:nd_episode_id_1; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 10;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )215;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqfoff = (           int )0;
  sqlstm.sqfmod = (unsigned int )2;
  sqlstm.sqhstv[0] = (         void  *)&v_patient_id;
  sqlstm.sqhstl[0] = (unsigned int  )63;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_doc_type;
  sqlstm.sqhstl[1] = (unsigned int  )52;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_doc_num;
  sqlstm.sqhstl[2] = (unsigned int  )52;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_episode_id_1;
  sqlstm.sqhstl[3] = (unsigned int  )11;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 //added for scrum crf-654 
/*ADDED FOR SCRUM REMERGING*/

	if(OERROR)
	{ 
		disp_message(ERR_MESG,"FETCH FAILED IN BILL_TEMP_CUR");
		
	}

	if(NODATAFOUND)
	{
		return 0;
	}

	nd_doc_type.arr[nd_doc_type.len]='\0';
    nd_doc_type.arr[nd_doc_type.len]='\0';
	v_patient_id.arr[v_patient_id.len]='\0'; //added for scrum crf-654 
	nd_episode_id_1.arr[nd_episode_id_1.len]='\0'; //added for scrum crf-654 


   return 1;
 
}
declare_receipt_cur()
{
  		/* EXEC SQL DECLARE RECEIPT_CUR CURSOR FOR
		select doc_type_code,doc_Number
		from BL_RECEIPT_REFUND_HDR 
		where Bill_doc_type_code=:nd_doc_type
		and bill_doc_number=:nd_doc_num; */ 



    if (OERROR)
		{ 
			disp_message (ERR_MESG,"declare failed FROM BL_RECEIPT_REFUND_HDR TABLE");
			proc_exit();
		}
	  	
}
open_receipt_cur()
{ 
		/* EXEC SQL OPEN RECEIPT_CUR; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 10;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = sq0007;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )246;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqcmod = (unsigned int )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_doc_type;
  sqlstm.sqhstl[0] = (unsigned int  )52;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_doc_num;
  sqlstm.sqhstl[1] = (unsigned int  )52;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Open RECEIPT_CUR cursor failed");
		proc_exit();
		}
	return;
}
fetch_receipt_cur()
{
 	d_rcpt_doc_type_code.arr[0]		='\0';
	d_rcpt_doc_num.arr[0]			='\0';
	d_rcpt_doc_srno.arr[0]			='\0';

	d_rcpt_doc_type_code.len = 0;
	d_rcpt_doc_num.len		 = 0;
	d_rcpt_doc_srno.len		 = 0;


  /* EXEC SQL FETCH RECEIPT_CUR
   INTO :d_rcpt_doc_type_code,
		:d_rcpt_doc_num; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 10;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )269;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqfoff = (           int )0;
  sqlstm.sqfmod = (unsigned int )2;
  sqlstm.sqhstv[0] = (         void  *)&d_rcpt_doc_type_code;
  sqlstm.sqhstl[0] = (unsigned int  )12;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_rcpt_doc_num;
  sqlstm.sqhstl[1] = (unsigned int  )14;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if(OERROR)
	{ 
		disp_message(ERR_MESG,"FETCH FAILED IN RECEIPT_CUR");
		
	}

	if(NODATAFOUND)
	{
		return 0;
	}

	d_rcpt_doc_type_code.arr[d_rcpt_doc_type_code.len]	= '\0'; 
	d_rcpt_doc_num.arr[d_rcpt_doc_num.len]				= '\0'; 
	d_rcpt_doc_srno.arr[d_rcpt_doc_srno.len]			= '\0'; 


   return 1;
 
}
update_bill_print_flag()
{
	
   
   /****if(l_no_settlement_details.arr[0]=='R' || 
				( strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS3")==0||strcmp(nd_calling_pgm_id.arr,"BLRUCDS3")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0
				  && strcmp(d_bill_nature_code.arr,"C")==0) )
				{  	****COMENTED FOR 16031***/ 
				
							
				  if(d_bill_paid_amt!=0) 
				  {
					
					

						/* EXEC SQL UPDATE BL_BILL_HDR SET
							BILL_PRINT_FLAG='Y' 
							WHERE DOC_TYPE_CODE=:nd_doc_type
							and DOC_NUM=:nd_doc_num; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 10;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "update BL_BILL_HDR  set BILL_PRINT_FLAG='Y' where (DOC_\
TYPE_CODE=:b0 and DOC_NUM=:b1)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )292;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&nd_doc_type;
      sqlstm.sqhstl[0] = (unsigned int  )52;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&nd_doc_num;
      sqlstm.sqhstl[1] = (unsigned int  )52;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


						
						  if(nd_tot_disc!=0 && l_disc_cnt>0)
						  {
							/* EXEC SQL UPDATE BL_BILL_HDR SET
								REPRINT_DISC_COPY_NUM=NVL(REPRINT_DISC_COPY_NUM,0)+1 
								WHERE DOC_TYPE_CODE=:nd_doc_type
								and DOC_NUM=:nd_doc_num; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 12;
       sqlstm.arrsiz = 10;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.stmt = "update BL_BILL_HDR  set REPRINT_DISC_COPY_NUM=(NVL(REP\
RINT_DISC_COPY_NUM,0)+1) where (DOC_TYPE_CODE=:b0 and DOC_NUM=:b1)";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )315;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)4352;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&nd_doc_type;
       sqlstm.sqhstl[0] = (unsigned int  )52;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&nd_doc_num;
       sqlstm.sqhstl[1] = (unsigned int  )52;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


						  }
							declare_receipt_cur();
							open_receipt_cur();
							while(fetch_receipt_cur())
							{
							 
							/* EXEC SQL UPDATE BL_RECEIPT_REFUND_HDR SET
							     PRINT_FLAG='Y' 
								 WHERE DOC_TYPE_CODE=:d_rcpt_doc_type_code
								 AND DOC_NUMBER=:d_rcpt_doc_num; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 12;
       sqlstm.arrsiz = 10;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.stmt = "update BL_RECEIPT_REFUND_HDR  set PRINT_FLAG='Y' where\
 (DOC_TYPE_CODE=:b0 and DOC_NUMBER=:b1)";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )338;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)4352;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&d_rcpt_doc_type_code;
       sqlstm.sqhstl[0] = (unsigned int  )12;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&d_rcpt_doc_num;
       sqlstm.sqhstl[1] = (unsigned int  )14;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


						    }
							close_receipt_cur();

								
						
						
						/* EXEC SQL COMMIT; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 10;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )361;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 

					
				  }
				  else
				  {
						
						/* EXEC SQL UPDATE BL_BILL_HDR SET
							BILL_PRINT_FLAG='Y' 
							WHERE DOC_TYPE_CODE=:nd_doc_type
							and DOC_NUM=:nd_doc_num; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 10;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "update BL_BILL_HDR  set BILL_PRINT_FLAG='Y' where (DOC_\
TYPE_CODE=:b0 and DOC_NUM=:b1)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )376;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&nd_doc_type;
      sqlstm.sqhstl[0] = (unsigned int  )52;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&nd_doc_num;
      sqlstm.sqhstl[1] = (unsigned int  )52;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


						 if(nd_tot_disc!=0 && l_disc_cnt>0)
						  {
							/* EXEC SQL UPDATE BL_BILL_HDR SET
								REPRINT_DISC_COPY_NUM=NVL(REPRINT_DISC_COPY_NUM,0)+1 
								WHERE DOC_TYPE_CODE=:nd_doc_type
								and DOC_NUM=:nd_doc_num; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 12;
       sqlstm.arrsiz = 10;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.stmt = "update BL_BILL_HDR  set REPRINT_DISC_COPY_NUM=(NVL(REP\
RINT_DISC_COPY_NUM,0)+1) where (DOC_TYPE_CODE=:b0 and DOC_NUM=:b1)";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )399;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)4352;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&nd_doc_type;
       sqlstm.sqhstl[0] = (unsigned int  )52;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&nd_doc_num;
       sqlstm.sqhstl[1] = (unsigned int  )52;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


						  }


							/* EXEC SQL COMMIT; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 12;
       sqlstm.arrsiz = 10;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )422;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)4352;
       sqlstm.occurs = (unsigned int  )0;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 


				   }

			 //}


	return 1;
		
}


close_bill_temp_cur()
{ 
	/* EXEC SQL CLOSE BILL_TEMP_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 10;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )437;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
	disp_message (ERR_MESG,"Close BILL_TEMP_CUR failed");
	proc_exit();
	}
	return;
}

close_receipt_cur()
{ 
	/* EXEC SQL CLOSE RECEIPT_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 10;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )452;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
	disp_message (ERR_MESG,"Close RECEIPT_CUR failed");
	proc_exit();
	}
	return;
}
declare_master_cur()
{
    /*ADDED FOR SCRUM REMERGING*/
			/* EXEC SQL DECLARE HEADER_CUR CURSOR FOR         
			SELECT 
			'**' DOC_TYPE_CODE, 00 DOC_NUM, NULL DOC_DATE,
			'**',
			b.episode_type,
			open_episode_id,
			C.VISIT_ID,
			a.patient_id,
			C.encounter_id,
			a.cust_code,
			a.policy_type_code,
			'N' BILL_PRINT_FLAG,
			nvl(b.tot_unadj_dep_amt, 0) tot_unadj_dep_amt,
			0,
			0,
			nvl(outst_amt, 0) outstand_amt,  
			decode(a.cust_code,null,nvl(unbld_amt, 0) + nvl(outst_amt,0)-nvl(tot_unadj_dep_amt,0),
			nvl(unbld_amt, 0) + nvl(outst_amt, 0)) total,
            //nvl(unbld_amt, 0) + nvl(outst_amt,0)-nvl(tot_unadj_dep_amt,0) total,
			--nvl(unbld_amt, 0) total,
			0 ,
			0 BILL_TOT_EXEMPT_AMT,
			0 BILL_TOT_WRITE_OFF_AMT,
			D.BILL_NATURE_CODE,
			B.cur_acct_seq_no,
			NULL INT_BILL_PRV_DOC_TYPE_CODE,
			NULL INT_BILL_PRV_DOC_NUMBER,
			A.BLNG_GRP_ID,
			0 ,
			NULL ADDED_BY_ID,
			0 PMNT_DIFF_ADJ_AMT,
			0 SERV_DISC_AMT, 
			NULL CASH_COUNTER_CODE,
			NVL(UNBLD_AMT,0),
			a.CUR_BED_NUM,
			B.CREDIT_DOC_REF_DESC,
			B.GL_HOLDER_NAME,
			B.pat_reln_with_gl_holder,
			c.CREDIT_AUTH_REF, // added for scrum remerging
			c.CREDIT_AUTH_DATE, // added for IN23545
			c.policy_number,
			a.CUST_GROUP_CODE,
			a.cust_code||'/'||a.cust_group_code||'/'||a.policy_type_code||'/'||c.policy_number Group_code,
			c.PRIORITY
			FROM bl_unbld_outst_vw           a,
			bl_episode_fin_dtls         b,
			bl_encounter_payer_priority c,
			BL_BILL_PRINT_TEMP D
			WHERE a.facility_id = b.operating_facility_id
			AND a.open_episode_id = b.episode_id
			AND b.operating_facility_id = c.operating_facility_id
			AND b.episode_id = c.episode_id
			AND b.cur_acct_seq_no = c.acct_seq_no
			AND nvl(a.cust_code, '!!!') = nvl(c.cust_code, '!!!')
			AND nvl(a.policy_type_code, '!!!') = nvl(c.policy_type_code, '!!!')
			AND A.BLNG_GRP_ID=C.BLNG_GRP_ID
			AND d.episode_id=b.episode_id 
			AND b.operating_facility_id=d.operating_facility_id
			AND NVL(a.cust_code,'!!!')=NVL(D.CUST_CODE,'!!!')
			AND D.SESSION_ID    = :nd_session_id
			AND B.PATIENT_ID=D.PATIENT_ID
			--AND B.ENCOUNTER_ID=D.ENCOUNTER_ID
			ORDER	BY 1,2; */ 

            
			/*ADDED FOR SCRUM REMERGING*/
			


		if (OERROR)
		{ 
			disp_message (ERR_MESG,"Declare Master Cursor failed");
			proc_exit();
		}
	
	return;
}


open_master_cur()
	{ 
		/* EXEC SQL OPEN HEADER_CUR; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 10;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlbuft((void **)0, 
    "select '**' DOC_TYPE_CODE ,00 DOC_NUM ,null  DOC_DATE ,'**' ,b.episode_\
type ,open_episode_id ,C.VISIT_ID ,a.patient_id ,C.encounter_id ,a.cust_code\
 ,a.policy_type_code ,'N' BILL_PRINT_FLAG ,nvl(b.tot_unadj_dep_amt,0) tot_un\
adj_dep_amt ,0 ,0 ,nvl(outst_amt,0) outstand_amt ,decode(a.cust_code,null ,(\
(nvl(unbld_amt,0)+nvl(outst_amt,0))-nvl(tot_unadj_dep_amt,0)),(nvl(unbld_amt\
,0)+nvl(outst_amt,0))) total ,0 ,0 BILL_TOT_EXEMPT_AMT ,0 BILL_TOT_WRITE_OFF\
_AMT ,D.BILL_NATURE_CODE ,B.cur_acct_seq_no ,null  INT_BILL_PRV_DOC_TYPE_COD\
E ,null  INT_BILL_PRV_DOC_NUMBER ,A.BLNG_GRP_ID ,0 ,null  ADDED_BY_ID ,0 PMN\
T_DIFF_ADJ_AMT ,0 SERV_DISC_AMT ,null  CASH_COUNTER_CODE ,NVL(UNBLD_AMT,0) ,\
a.CUR_BED_NUM ,B.CREDIT_DOC_REF_DESC ,B.GL_HOLDER_NAME ,B.pat_reln_with_gl_h\
older ,c.CREDIT_AUTH_REF ,c.CREDIT_AUTH_DATE ,c.policy_number ,a.CUST_GROUP_\
CODE ,((((((a.cust_code||'/')||a.cust_group_code)||'/')||a.policy_type_code)\
||'/')||c.policy_number) Group_code ,c.PRIORITY  from bl_unbld_outst_vw a ,b\
l_episode_fin_dtls b ,bl_encounter_payer_");
  sqlstm.stmt = sq0015;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )467;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqcmod = (unsigned int )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_session_id;
  sqlstm.sqhstl[0] = (unsigned int  )18;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Open HEADER_CUR cursor failed");
		proc_exit();
		}
	return;
	}

fetch_master_cur()
{

	d1_doc_type.arr[0]		='\0';
	d1_doc_number.arr[0]	='\0';
	d1_doc_date.arr[0]		='\0';
	d1_doc_type_num.arr[0]	='\0';
	d_episode_type.arr[0]	='\0';
	d_episode_type.len		= 0;
	d_episode_id.arr[0]		='\0';
	d_episode_id.len		= 0;
	d_visit_id.arr[0]		='\0';
	d_visit_id.len			= 0;
	d_patient_id.arr[0]		='\0';
	d_patient_id.len		= 0;
	d_encounter_id.arr[0]	='\0';
	d_encounter_id.len		= 0;
	d_cust_code.arr[0]		='\0';
	dc_bill_print_flag.arr[0] ='\0';
	d_bill_nature_code.arr[0] ='\0';
	d_acct_seq_no.arr[0]	  ='\0';
	d_int_bill_prv_doc_type_code.arr[0]='\0';
	d_int_bill_prv_doc_number.arr[0]   ='\0';
	d_bill_nature_code.len  = 0;
	dc_bill_print_flag.len  = 0;
	d_cust_code.len			= 0;
	d1_doc_type.len			= 0;
	d1_doc_number.len		= 0;
	d1_doc_type_num.len		= 0;
	d_acct_seq_no.len		= 0;
	d_int_bill_prv_doc_type_code.len=0;
	d_int_bill_prv_doc_number.len	=0;
	dc_blng_grp_id.arr[0]   ='\0';
	dc_blng_grp_id.len		=  0;
	d_added_by_id.arr[0]	= '\0';
	d_added_by_id.len		=  0;
	d_Policy_type_code.arr[0]	= '\0';
	d_Policy_type_code.len		=   0;
	/*alt_id_type.arr[0]			= '\0';
	alt_id_type.len				=   0;
	alt_id_no.arr[0]			= '\0';
	alt_id_no.len				=   0;
	patient_name.arr[0]			= '\0';
	patient_name.len			=   0; COMMENTED FOR SCRUM REMERGING*/
	v_cur_bed_num.arr[0]='\0'; //added for crf-654 scrum
	v_cur_bed_num.len=0; //added for crf-654 scrum
	v_credit_doc_ref_desc.arr[0]='\0'; //added for crf-654 scrum
	v_credit_doc_ref_desc.len=0; //added for crf-654 scrum
	v_gl_holder_name.arr[0]='\0'; //added for crf-654 scrum
	v_gl_holder_name.len=0;  //added for crf-654 scrum
	V_pat_reln_with_gl_holder.arr[0]='\0'; //added for crf-654 scrum
	V_pat_reln_with_gl_holder.len=0; //added for crf-654 scrum
	v_credit_auth_ref.arr[0]='\0'; //added for crf-654 scrum remerging
	v_credit_auth_ref.len=0;  //added for crf-654 scrum remerging
	v_credit_auth_ref_date.arr[0]='\0'; //added for IN23545
	v_credit_auth_ref_date.len=0;  //added for IN23545
	v_policy_no.arr[0]='\0';  //added for crf-654 scrum remerging
	v_policy_no.len=0;    //added for crf-654 scrum remerging
	d_cust_group_code.arr[0]	='\0';  //Rajesh
	d_cust_group_code.len		= 0;
    d_oth_group_code.arr[0]	='\0';  //Rajesh
	d_oth_group_code.len		= 0;



	/*ADDED FOR SCRUM REMERGING*/
	/* EXEC SQL FETCH HEADER_CUR INTO 
	d1_doc_type,
    d1_doc_number,
	d1_doc_date,
    d1_doc_type_num,
	d_episode_type,
	d_episode_id,
	d_visit_id,
	d_patient_id,
	d_encounter_id,
	d_cust_code,
	d_Policy_type_code,
	dc_bill_print_flag,
	d_deposit_adj_amt,
	d1_man_disc_amt,
	d1_overall_disc_amt,
	d_tot_outst_amt,
	d_bill_tot_outst_amt,
	d1_tot_adjust_amt,
	d1_bill_tot_exmpt_amt,
	d1_tot_write_off_amt,
	d_bill_nature_code,
	d_acct_seq_no,
	d_int_bill_prv_doc_type_code,
	d_int_bill_prv_doc_number,
	dc_blng_grp_id,
	d_bill_paid_amt,
	d_added_by_id,
	d_pmnt_diff_adj_amt,
	d_serv_disc_amt,
	d_cash_counter,
	d1_bill_amt,
	v_cur_bed_num,
	v_credit_doc_ref_desc,//ADDED FOR SCRUM CRF-654
	v_gl_holder_name,//ADDED FOR SCRUM CRF-654
	V_pat_reln_with_gl_holder, //ADDED FOR SCRUM CRF-654
	v_credit_auth_ref,
	v_credit_auth_ref_date,
	v_policy_no,  //ADDED FOR SCRUM CRF-654 remerging
	d_cust_group_code, //Rajesh
	d_oth_group_code,
	d_priority; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 41;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )486;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d1_doc_type;
 sqlstm.sqhstl[0] = (unsigned int  )27;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d1_doc_number;
 sqlstm.sqhstl[1] = (unsigned int  )52;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d1_doc_date;
 sqlstm.sqhstl[2] = (unsigned int  )22;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d1_doc_type_num;
 sqlstm.sqhstl[3] = (unsigned int  )102;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[4] = (unsigned int  )4;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[5] = (unsigned int  )11;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[6] = (unsigned int  )7;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[7] = (unsigned int  )63;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_encounter_id;
 sqlstm.sqhstl[8] = (unsigned int  )15;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_cust_code;
 sqlstm.sqhstl[9] = (unsigned int  )27;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d_Policy_type_code;
 sqlstm.sqhstl[10] = (unsigned int  )23;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&dc_bill_print_flag;
 sqlstm.sqhstl[11] = (unsigned int  )4;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&d_deposit_adj_amt;
 sqlstm.sqhstl[12] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d1_man_disc_amt;
 sqlstm.sqhstl[13] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&d1_overall_disc_amt;
 sqlstm.sqhstl[14] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&d_tot_outst_amt;
 sqlstm.sqhstl[15] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d_bill_tot_outst_amt;
 sqlstm.sqhstl[16] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d1_tot_adjust_amt;
 sqlstm.sqhstl[17] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&d1_bill_tot_exmpt_amt;
 sqlstm.sqhstl[18] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&d1_tot_write_off_amt;
 sqlstm.sqhstl[19] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&d_bill_nature_code;
 sqlstm.sqhstl[20] = (unsigned int  )4;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&d_acct_seq_no;
 sqlstm.sqhstl[21] = (unsigned int  )6;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&d_int_bill_prv_doc_type_code;
 sqlstm.sqhstl[22] = (unsigned int  )27;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&d_int_bill_prv_doc_number;
 sqlstm.sqhstl[23] = (unsigned int  )52;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&dc_blng_grp_id;
 sqlstm.sqhstl[24] = (unsigned int  )7;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&d_bill_paid_amt;
 sqlstm.sqhstl[25] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&d_added_by_id;
 sqlstm.sqhstl[26] = (unsigned int  )102;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&d_pmnt_diff_adj_amt;
 sqlstm.sqhstl[27] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqhstv[28] = (         void  *)&d_serv_disc_amt;
 sqlstm.sqhstl[28] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[28] = (         int  )0;
 sqlstm.sqindv[28] = (         void  *)0;
 sqlstm.sqinds[28] = (         int  )0;
 sqlstm.sqharm[28] = (unsigned int  )0;
 sqlstm.sqadto[28] = (unsigned short )0;
 sqlstm.sqtdso[28] = (unsigned short )0;
 sqlstm.sqhstv[29] = (         void  *)&d_cash_counter;
 sqlstm.sqhstl[29] = (unsigned int  )7;
 sqlstm.sqhsts[29] = (         int  )0;
 sqlstm.sqindv[29] = (         void  *)0;
 sqlstm.sqinds[29] = (         int  )0;
 sqlstm.sqharm[29] = (unsigned int  )0;
 sqlstm.sqadto[29] = (unsigned short )0;
 sqlstm.sqtdso[29] = (unsigned short )0;
 sqlstm.sqhstv[30] = (         void  *)&d1_bill_amt;
 sqlstm.sqhstl[30] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[30] = (         int  )0;
 sqlstm.sqindv[30] = (         void  *)0;
 sqlstm.sqinds[30] = (         int  )0;
 sqlstm.sqharm[30] = (unsigned int  )0;
 sqlstm.sqadto[30] = (unsigned short )0;
 sqlstm.sqtdso[30] = (unsigned short )0;
 sqlstm.sqhstv[31] = (         void  *)&v_cur_bed_num;
 sqlstm.sqhstl[31] = (unsigned int  )7;
 sqlstm.sqhsts[31] = (         int  )0;
 sqlstm.sqindv[31] = (         void  *)0;
 sqlstm.sqinds[31] = (         int  )0;
 sqlstm.sqharm[31] = (unsigned int  )0;
 sqlstm.sqadto[31] = (unsigned short )0;
 sqlstm.sqtdso[31] = (unsigned short )0;
 sqlstm.sqhstv[32] = (         void  *)&v_credit_doc_ref_desc;
 sqlstm.sqhstl[32] = (unsigned int  )33;
 sqlstm.sqhsts[32] = (         int  )0;
 sqlstm.sqindv[32] = (         void  *)0;
 sqlstm.sqinds[32] = (         int  )0;
 sqlstm.sqharm[32] = (unsigned int  )0;
 sqlstm.sqadto[32] = (unsigned short )0;
 sqlstm.sqtdso[32] = (unsigned short )0;
 sqlstm.sqhstv[33] = (         void  *)&v_gl_holder_name;
 sqlstm.sqhstl[33] = (unsigned int  )63;
 sqlstm.sqhsts[33] = (         int  )0;
 sqlstm.sqindv[33] = (         void  *)0;
 sqlstm.sqinds[33] = (         int  )0;
 sqlstm.sqharm[33] = (unsigned int  )0;
 sqlstm.sqadto[33] = (unsigned short )0;
 sqlstm.sqtdso[33] = (unsigned short )0;
 sqlstm.sqhstv[34] = (         void  *)&V_pat_reln_with_gl_holder;
 sqlstm.sqhstl[34] = (unsigned int  )33;
 sqlstm.sqhsts[34] = (         int  )0;
 sqlstm.sqindv[34] = (         void  *)0;
 sqlstm.sqinds[34] = (         int  )0;
 sqlstm.sqharm[34] = (unsigned int  )0;
 sqlstm.sqadto[34] = (unsigned short )0;
 sqlstm.sqtdso[34] = (unsigned short )0;
 sqlstm.sqhstv[35] = (         void  *)&v_credit_auth_ref;
 sqlstm.sqhstl[35] = (unsigned int  )23;
 sqlstm.sqhsts[35] = (         int  )0;
 sqlstm.sqindv[35] = (         void  *)0;
 sqlstm.sqinds[35] = (         int  )0;
 sqlstm.sqharm[35] = (unsigned int  )0;
 sqlstm.sqadto[35] = (unsigned short )0;
 sqlstm.sqtdso[35] = (unsigned short )0;
 sqlstm.sqhstv[36] = (         void  *)&v_credit_auth_ref_date;
 sqlstm.sqhstl[36] = (unsigned int  )33;
 sqlstm.sqhsts[36] = (         int  )0;
 sqlstm.sqindv[36] = (         void  *)0;
 sqlstm.sqinds[36] = (         int  )0;
 sqlstm.sqharm[36] = (unsigned int  )0;
 sqlstm.sqadto[36] = (unsigned short )0;
 sqlstm.sqtdso[36] = (unsigned short )0;
 sqlstm.sqhstv[37] = (         void  *)&v_policy_no;
 sqlstm.sqhstl[37] = (unsigned int  )33;
 sqlstm.sqhsts[37] = (         int  )0;
 sqlstm.sqindv[37] = (         void  *)0;
 sqlstm.sqinds[37] = (         int  )0;
 sqlstm.sqharm[37] = (unsigned int  )0;
 sqlstm.sqadto[37] = (unsigned short )0;
 sqlstm.sqtdso[37] = (unsigned short )0;
 sqlstm.sqhstv[38] = (         void  *)&d_cust_group_code;
 sqlstm.sqhstl[38] = (unsigned int  )6;
 sqlstm.sqhsts[38] = (         int  )0;
 sqlstm.sqindv[38] = (         void  *)0;
 sqlstm.sqinds[38] = (         int  )0;
 sqlstm.sqharm[38] = (unsigned int  )0;
 sqlstm.sqadto[38] = (unsigned short )0;
 sqlstm.sqtdso[38] = (unsigned short )0;
 sqlstm.sqhstv[39] = (         void  *)&d_oth_group_code;
 sqlstm.sqhstl[39] = (unsigned int  )202;
 sqlstm.sqhsts[39] = (         int  )0;
 sqlstm.sqindv[39] = (         void  *)0;
 sqlstm.sqinds[39] = (         int  )0;
 sqlstm.sqharm[39] = (unsigned int  )0;
 sqlstm.sqadto[39] = (unsigned short )0;
 sqlstm.sqtdso[39] = (unsigned short )0;
 sqlstm.sqhstv[40] = (         void  *)&d_priority;
 sqlstm.sqhstl[40] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[40] = (         int  )0;
 sqlstm.sqindv[40] = (         void  *)0;
 sqlstm.sqinds[40] = (         int  )0;
 sqlstm.sqharm[40] = (unsigned int  )0;
 sqlstm.sqadto[40] = (unsigned short )0;
 sqlstm.sqtdso[40] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	/*ADDED FOR SCRUM REMERGING*/


		
	if(OERROR)
	{ 
		disp_message(ERR_MESG,"FETCH FAILED IN HEADER_CUR");
		proc_exit();
	}

	if(NODATAFOUND)
	{
		return 0;
	}

	d_episode_type.arr[d_episode_type.len] = '\0';
	d_episode_id.arr[d_episode_id.len] = '\0';	
	d_visit_id.arr[d_visit_id.len] = '\0';	
	d_patient_id.arr[d_patient_id.len] = '\0';	
	d_encounter_id.arr[d_encounter_id.len] = '\0';	
	d_cust_code.arr[d_cust_code.len] = '\0';
	dc_bill_print_flag.arr[dc_bill_print_flag.len] = '\0';	
	d_bill_nature_code.arr[d_bill_nature_code.len] = '\0';
	d1_doc_type.arr[d1_doc_type.len]='\0';
	d1_doc_number.arr[d1_doc_number.len]='\0';
	d1_doc_date.arr[d1_doc_date.len]='\0';
	d1_doc_type_num.arr[d1_doc_type_num.len]='\0';
	d_acct_seq_no.arr[d_acct_seq_no.len]='\0';
	d_int_bill_prv_doc_type_code.arr[d_int_bill_prv_doc_type_code.len]='\0';
	d_int_bill_prv_doc_number.arr[d_int_bill_prv_doc_number.len]='\0';
	dc_blng_grp_id.arr[dc_blng_grp_id.len]='\0';
	d_added_by_id.arr[d_added_by_id.len]='\0';
	d_Policy_type_code.arr[d_Policy_type_code.len]='\0';
	/*alt_id_type.arr[alt_id_type.len]='\0';
	alt_id_no.arr[alt_id_no.len]='\0';
	patient_name.arr[patient_name.len]='\0'; COMMENTED FOR SCRUM REMERGING*/
	v_cur_bed_num.arr[v_cur_bed_num.len]='\0'; //added for crf-654 scrum
	v_credit_doc_ref_desc.arr[v_credit_doc_ref_desc.len]='\0'; //added for crf-654 scrum
	v_credit_auth_ref.arr[v_credit_auth_ref.len]='\0';  //added for crf-654 scrum remerging
	v_credit_auth_ref_date.arr[v_credit_auth_ref_date.len]='\0'; //added for IN23545
	v_policy_no.arr[v_policy_no.len]='\0';  //added for crf-654 scrum remerging
	d_cust_group_code.arr[d_cust_group_code.len] = '\0';
	d_oth_group_code.arr[d_oth_group_code.len] = '\0';
	
	d2_priority = d_priority;

	return 1;
}



close_master_cur()
{ 
	/* EXEC SQL CLOSE HEADER_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 41;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )665;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
	disp_message (ERR_MESG,"Close bl_bill_print_temp_cur failed");
	proc_exit();
	}
	return;
}


declare_grp_hdr_cur()
{

 /* EXEC SQL DECLARE BL_BILL_GRP_HDR_LINE_CUR CURSOR FOR
SELECT   trx_doc_ref trxdocref, 
		 trx_doc_ref_line_num trxdocreflinenum, 
		 trx_doc_ref_seq_num,
		 DECODE(PAYER_SERV_GRP_HDR,NULL, A.PRT_GRP_HDR_CODE, PAYER_SERV_GRP_HDR) payerservgrphdr, 
		 DECODE(PAYER_SERV_GRP_LINE, NULL,A.PRT_GRP_LINE_CODE, PAYER_SERV_GRP_LINE) payerservgrpline,
		 cust_code custcode,
         a.blng_serv_code, 
		 TO_CHAR (a.service_date, 'DD/MM/YYYY HH24:MI'),
         DECODE (module_id,
                 'PH', 'M',
                 'ST', 'M',
                 'MM', 'M',
                 'S'
                ) mapping_code_ind,
         serv_anal_grp1 || serv_anal_grp2, serv_item_code,
         DECODE (module_id,
                 'PH', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'ST', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'MM', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'X'
                ),
         payer_serv_grp_hdr, payer_serv_grp_line,PAYER_SERV_GRP_CUST_CODE,
		 PAYER_SERV_GRP_PAT_CLASS, a.prt_grp_hdr_code,
         a.prt_grp_line_code, bill_doc_type_code, bill_doc_num,
         ent_item_grp_code entitemgrpcode, payer_item_grp_code payeritemgrpcode,
		 PAYER_ITEM_GRP_CUST_CODE,
		 PAYER_ITEM_GRP_PAT_CLASS,
         blcore.get_payer_doc_print_seq (operating_facility_id,
                                         episode_type,
                                         cust_code,
                                         cust_group_code,
                                         payer_serv_grp_hdr,
                                         payer_serv_grp_line,
                                         a.prt_grp_hdr_code,
                                         a.prt_grp_line_code
                                        ) print_seq,
		 substr(DECODE(:v_detail_report ,'Y','ESGDLS',
						nvl(BLCORE.GET_BILL_FORMAT_IND(OPERATING_FACILITY_ID,
						CUST_GROUP_CODE,
						CUST_CODE,
						BLNG_GRP_ID,
						EPISODE_TYPE,
						PAYER_SERV_GRP_HDR, 
						PAYER_SERV_GRP_LINE, 
						A.PRT_GRP_HDR_CODE, 
						A.PRT_GRP_LINE_CODE,
						ENT_ITEM_GRP_CODE , 
						PAYER_ITEM_GRP_CODE),'ESGSGN')),1,3) GRP_IND,
         DECODE(:v_detail_report ,'Y','ESGDLS',
					nvl(BLCORE.GET_BILL_FORMAT_IND(OPERATING_FACILITY_ID,
					CUST_GROUP_CODE,
					CUST_CODE,
					BLNG_GRP_ID,
					EPISODE_TYPE,
					PAYER_SERV_GRP_HDR, 
					PAYER_SERV_GRP_LINE, 
					A.PRT_GRP_HDR_CODE, 
					A.PRT_GRP_LINE_CODE,
					ENT_ITEM_GRP_CODE, 
					PAYER_ITEM_GRP_CODE),'ESGSGN')) SUMMARY_DTL_IND,
         upd_gross_charge_amt, upd_disc_amt, upd_net_charge_amt,
         net_reimbursable_amt, addl_charge_amt_in_charge,
         NVL (package_trx_yn, 'N'), null package_seq_no,
         a.base_rate / a.base_qty rate, a.serv_qty,
         NVL (a.upd_disc_amt, 0) charge_discount,
           NVL (a.bill_level_disc_dstrbtn_amt, 0)
         + NVL (a.line_level_disc_dstrbtn_amt, 0) bill_discount,
         NVL (a.bill_level_pol_adj_dstrbtn_amt, 0) fund_adjustment,
           NVL (a.upd_disc_amt, 0)
         + NVL (a.bill_level_disc_dstrbtn_amt, 0)
         + NVL (a.line_level_disc_dstrbtn_amt, 0)
         + NVL (a.bill_level_pol_adj_dstrbtn_amt, 0) tot_disc,
         batch_id,
		 A.SERVICE_DATE servicedate,
		 NVL (A.package_trx_yn, 'N') package_trx_yn_1, //Rajesh
		 PHYSICIAN_ID				//added by vani for IN16294(PMG-CRF-810)
    FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
     AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   
					(REV_ADJ_TRX_IND='R' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) not in  //NVL ADDED HERE FOR IN21043
											 (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 
											 bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and
											 patient_id=:d_patient_id         and 
											 episode_id =:d_episode_id)
					  )

                      OR 
					  (REV_ADJ_TRX_IND='B' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) not in  //NVL ADDED HERE FOR IN21043
											 (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 
											 bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and
											 patient_id=:d_patient_id         and 
											 episode_id =:d_episode_id)
						)

					  OR  
					  (REV_ADJ_TRX_IND IS NULL AND (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM)   //this OR condition added for IN21043
												NOT IN (SELECT NVL(SOURCE_DOC_REF,'XXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,9999) FROM 
												BL_PATIENT_CHARGES_FOLIO WHERE OPERATING_FACILITY_ID = :nd_facility_id  AND
												patient_id=:d_patient_id           and 
												episode_id =:d_episode_id)	
					  )	
				   )
			 )
         )
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
and NVL (a.package_trx_yn, 'N')='N' 
and nvl(a.confirmed_yn,'N')!='N' //added by vani
union all
SELECT   trx_doc_ref trxdocref, trx_doc_ref_line_num trxdocreflinenum, trx_doc_ref_seq_num,
		 DECODE(PAYER_SERV_GRP_HDR,NULL, A.PRT_GRP_HDR_CODE, PAYER_SERV_GRP_HDR) payerservgrphdr, 
		 DECODE(PAYER_SERV_GRP_LINE, NULL,A.PRT_GRP_LINE_CODE, PAYER_SERV_GRP_LINE) payerservgrpline,
		  cust_code custcode,
         a.blng_serv_code, TO_CHAR (a.service_date, 'DD/MM/YYYY HH24:MI'),
         DECODE (module_id,
                 'PH', 'M',
                 'ST', 'M',
                 'MM', 'M',
                 'S'
                ) mapping_code_ind,
         serv_anal_grp1 || serv_anal_grp2, serv_item_code,
         DECODE (module_id,
                 'PH', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'ST', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'MM', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'X'
                ),
         payer_serv_grp_hdr, payer_serv_grp_line,PAYER_SERV_GRP_CUST_CODE,
		 PAYER_SERV_GRP_PAT_CLASS, a.prt_grp_hdr_code,
         a.prt_grp_line_code, bill_doc_type_code, bill_doc_num,
         ent_item_grp_code entitemgrpcode, payer_item_grp_code payeritemgrpcode,
		 PAYER_ITEM_GRP_CUST_CODE,
		 PAYER_ITEM_GRP_PAT_CLASS,
         blcore.get_payer_doc_print_seq (operating_facility_id,
                                         episode_type,
                                         cust_code,
                                         cust_group_code,
                                         payer_serv_grp_hdr,
                                         payer_serv_grp_line,
                                         a.prt_grp_hdr_code,
                                         a.prt_grp_line_code
                                        ) print_seq,
		 substr(DECODE(:v_detail_report ,'Y','ESGDLS',
					nvl(BLCORE.GET_BILL_FORMAT_IND(a.OPERATING_FACILITY_ID,
					a.CUST_GROUP_CODE,
					a.CUST_CODE,
					a.BLNG_GRP_ID,
					a.EPISODE_TYPE,
					a.PAYER_SERV_GRP_HDR, 
					a.PAYER_SERV_GRP_LINE, 
					a.PRT_GRP_HDR_CODE, 
					a.PRT_GRP_LINE_CODE,
					a.ENT_ITEM_GRP_CODE , 
					a.PAYER_ITEM_GRP_CODE),'ESGSGN')),1,3) GRP_IND,
         DECODE(:v_detail_report ,'Y','ESGDLS',
					nvl(BLCORE.GET_BILL_FORMAT_IND(a.OPERATING_FACILITY_ID,
					a.CUST_GROUP_CODE,
					a.CUST_CODE,
					a.BLNG_GRP_ID,
					a.EPISODE_TYPE,
					a.PAYER_SERV_GRP_HDR, 
					a.PAYER_SERV_GRP_LINE, 
					a.PRT_GRP_HDR_CODE, 
					a.PRT_GRP_LINE_CODE,
					a.ENT_ITEM_GRP_CODE , 
					a.PAYER_ITEM_GRP_CODE),'ESGSGN')) SUMMARY_DTL_IND,
         blpackage.get_serv_tot_gross_amt(a.operating_facility_id,
										  a.trx_doc_ref, 
										  a.trx_doc_ref_line_num,
										  a.trx_doc_ref_seq_num) upd_gross_charge_amt, 
		 blpackage.get_serv_tot_disc_amt (a.operating_facility_id,
										  a.trx_doc_ref, 
										  a.trx_doc_ref_line_num,
										  a.trx_doc_ref_seq_num) upd_disc_amt, 
         blpackage.get_serv_tot_net_amt  (a.operating_facility_id,
										  a.trx_doc_ref, 
										  a.trx_doc_ref_line_num,
										  a.trx_doc_ref_seq_num) upd_net_charge_amt, 
         net_reimbursable_amt, BL_GET_TAX_AMOUNT(a.operating_facility_id, 
			     a.TRX_DOC_REF, 
			     a.TRX_DOC_REF_LINE_NUM,
				 a.TRX_DOC_REF_SEQ_NUM,
				null,
				null,
				'Y','N', null) addl_charge_amt_in_charge,
         'N' package_trx_yn, null package_seq_no,
         a.base_rate / a.base_qty rate, a.serv_qty,
         NVL (a.upd_disc_amt, 0) charge_discount,
           NVL (a.bill_level_disc_dstrbtn_amt, 0)
         + NVL (a.line_level_disc_dstrbtn_amt, 0) bill_discount,
         NVL (a.bill_level_pol_adj_dstrbtn_amt, 0) fund_adjustment,
           NVL (a.upd_disc_amt, 0)
         + NVL (a.bill_level_disc_dstrbtn_amt, 0)
         + NVL (a.line_level_disc_dstrbtn_amt, 0)
         + NVL (a.bill_level_pol_adj_dstrbtn_amt, 0) tot_disc,
         batch_id,
		 A.SERVICE_DATE servicedate,		 
		 NVL (A.package_trx_yn, 'N') package_trx_yn_1, //Rajesh,
		 PHYSICIAN_ID
    FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
      AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   
					(REV_ADJ_TRX_IND='R' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) not in  //NVL ADDED HERE FOR IN21043
											 (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 
											 bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and
											 patient_id=:d_patient_id         and 
											 episode_id =:d_episode_id)
					  )

                      OR 
					  (REV_ADJ_TRX_IND='B' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) not in  //NVL ADDED HERE FOR IN21043
											 (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 
											 bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and
											 patient_id=:d_patient_id         and 
											 episode_id =:d_episode_id)
						)

					  OR  
					  (REV_ADJ_TRX_IND IS NULL AND (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM)   //this OR condition added for IN21043
												NOT IN (SELECT NVL(SOURCE_DOC_REF,'XXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,9999) FROM 
												BL_PATIENT_CHARGES_FOLIO WHERE OPERATING_FACILITY_ID = :nd_facility_id  AND
												patient_id=:d_patient_id           and 
												episode_id =:d_episode_id)	
					  )	
				   )
			 )
         )
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
AND EXISTS (
            SELECT 1
              FROM bl_package_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.package_trx_yn = 'N'
			   AND b.org_gross_charge_amt <> 0
             )
and NVL (a.package_trx_yn, 'N')='P' 
and nvl(a.confirmed_yn,'N')!='N'
	 ORDER BY custcode,payeritemgrpcode,entitemgrpcode,payerservgrphdr,
			print_seq,summary_dtl_ind,payerservgrpline,servicedate,trxdocref,trxdocreflinenum; */ 


     

/*	SELECT TRX_DOC_REF,
	TRX_DOC_REF_LINE_NUM,
	TRX_DOC_REF_SEQ_NUM, 
	CUST_CODE,
	A.BLNG_SERV_CODE,
	TO_CHAR(A.SERVICE_DATE,'DD/MM/YYYY HH24:MI'),
	DECODE(module_id,'PH','M','ST','M','MM','M','S') MAPPING_CODE_IND,
	SERV_ANAL_GRP1||SERV_ANAL_GRP2,
	SERV_ITEM_CODE, 
	DECODE(module_id,'PH',NVL(SERV_ITEM_DESC_OTH_LANG,SERV_ITEM_DESC),'ST',NVL(SERV_ITEM_DESC_OTH_LANG,SERV_ITEM_DESC),'MM',NVL(SERV_ITEM_DESC_OTH_LANG,SERV_ITEM_DESC),'X'),
	PAYER_SERV_GRP_HDR,
	PAYER_SERV_GRP_LINE,
	A.PRT_GRP_HDR_CODE,
	A.PRT_GRP_LINE_CODE,
	BILL_DOC_TYPE_CODE,
	BILL_DOC_NUM,
	ENT_ITEM_GRP_CODE,
	PAYER_ITEM_GRP_CODE,
	BLCORE.GET_PAYER_DOC_PRINT_SEQ(OPERATING_FACILITY_ID, 
	EPISODE_TYPE,
	CUST_CODE, 
	CUST_GROUP_CODE,
	PAYER_SERV_GRP_HDR, 
	PAYER_SERV_GRP_LINE, 
	A.PRT_GRP_HDR_CODE, 
	A.PRT_GRP_LINE_CODE) PRINT_SEQ,
	DECODE(:v_detail_report ,'Y','DLS',//CHANGED IN SCRUM CRF-654
	nvl(BLCORE.GET_BILL_FORMAT_IND(OPERATING_FACILITY_ID,
	CUST_GROUP_CODE,
	CUST_CODE,
	BLNG_GRP_ID,
	EPISODE_TYPE,
	PAYER_SERV_GRP_HDR, 
	PAYER_SERV_GRP_LINE, 
	A.PRT_GRP_HDR_CODE, 
	A.PRT_GRP_LINE_CODE,
	ENT_ITEM_GRP_CODE, 
	PAYER_ITEM_GRP_CODE),'SGN')) SUMMARY_DTL_IND,
	UPD_GROSS_CHARGE_AMT,
	UPD_DISC_AMT,
	UPD_NET_CHARGE_AMT,
	NET_REIMBURSABLE_AMT,
	ADDL_CHARGE_AMT_IN_CHARGE,
	NVL(PACKAGE_TRX_YN,'N'),
	PACKAGE_SEQ_NO,
	A.BASE_RATE/A.BASE_QTY RATE,
	A.SERV_QTY,
	NVL(A.UPD_DISC_AMT,0) CHARGE_DISCOUNT,
	NVL(A.BILL_LEVEL_DISC_DSTRBTN_AMT,0)+NVL(A.LINE_LEVEL_DISC_DSTRBTN_AMT,0) BILL_DISCOUNT,
	NVL(A.BILL_LEVEL_POL_ADJ_DSTRBTN_AMT,0) FUND_ADJUSTMENT,
    NVL(A.UPD_DISC_AMT,0)+NVL(A.BILL_LEVEL_DISC_DSTRBTN_AMT,0)+NVL(A.LINE_LEVEL_DISC_DSTRBTN_AMT,0)+NVL(A.BILL_LEVEL_POL_ADJ_DSTRBTN_AMT,0) TOT_DISC,
	BATCH_ID
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	 AND A.EPISODE_ID= :d_episode_id  //ADDED FOR SCRUM CRF-654
	and (trx_status is null 

                or (trx_status ='C' and  
				       
					   
					   ( (NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                         (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                         bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                         patient_id=:d_patient_id        // and COMMENTED FOR SCRUM CRF-654
						 AND A.EPISODE_ID= :d_episode_id  //ADDED FOR SCRUM CRF-654
			 )
						)
					   or (:d1_bill_amt=0)
					   )
			
				   )		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         //  and COMMENTED FOR SCRUM CRF-654

			 AND A.EPISODE_ID= :d_episode_id //ADDED FOR SCRUM CRF-654
			 )	//added by vani
       ))   //upto here ravi added
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	AND B.EPISODE_ID= :d_episode_id 
	and nvl(a.BILLED_FLAG,'N')='N'
	)
	ORDER BY CUST_CODE, PAYER_ITEM_GRP_CODE, ENT_ITEM_GRP_CODE,
	DECODE(PAYER_SERV_GRP_HDR,NULL, A.PRT_GRP_HDR_CODE, PAYER_SERV_GRP_HDR), 
	PRINT_SEQ , SUMMARY_DTL_IND, 
	DECODE(PAYER_SERV_GRP_LINE, NULL,A.PRT_GRP_LINE_CODE, PAYER_SERV_GRP_LINE),
	A.SERVICE_DATE,TRX_DOC_REF,TRX_DOC_REF_LINE_NUM;
	*/


	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Failed to Declare Group Header Cursor");
		proc_exit;
	}
	
	return;
}

open_grp_hdr_cur()
{
	/* EXEC SQL OPEN BL_BILL_GRP_HDR_LINE_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlbuft((void **)0, 
   "select trx_doc_ref trxdocref ,trx_doc_ref_line_num trxdocreflinenum ,trx\
_doc_ref_seq_num ,DECODE(PAYER_SERV_GRP_HDR,null ,A.PRT_GRP_HDR_CODE,PAYER_S\
ERV_GRP_HDR) payerservgrphdr ,DECODE(PAYER_SERV_GRP_LINE,null ,A.PRT_GRP_LIN\
E_CODE,PAYER_SERV_GRP_LINE) payerservgrpline ,cust_code custcode ,a.blng_ser\
v_code ,TO_CHAR(a.service_date,'DD/MM/YYYY HH24:MI') ,DECODE(module_id,'PH',\
'M','ST','M','MM','M','S') mapping_code_ind ,(serv_anal_grp1||serv_anal_grp2\
) ,serv_item_code ,DECODE(module_id,'PH',NVL(serv_item_desc_oth_lang,serv_it\
em_desc),'ST',NVL(serv_item_desc_oth_lang,serv_item_desc),'MM',NVL(serv_item\
_desc_oth_lang,serv_item_desc),'X') ,payer_serv_grp_hdr ,payer_serv_grp_line\
 ,PAYER_SERV_GRP_CUST_CODE ,PAYER_SERV_GRP_PAT_CLASS ,a.prt_grp_hdr_code ,a.\
prt_grp_line_code ,bill_doc_type_code ,bill_doc_num ,ent_item_grp_code entit\
emgrpcode ,payer_item_grp_code payeritemgrpcode ,PAYER_ITEM_GRP_CUST_CODE ,P\
AYER_ITEM_GRP_PAT_CLASS ,blcore.get_payer_doc_print_seq(operating_facility_i\
d,episode_type,cust_code,cust_group_code");
 sqlbuft((void **)0, 
   ",payer_serv_grp_hdr,payer_serv_grp_line,a.prt_grp_hdr_code,a.prt_grp_lin\
e_code) print_seq ,substr(DECODE(:b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT\
_IND(OPERATING_FACILITY_ID,CUST_GROUP_CODE,CUST_CODE,BLNG_GRP_ID,EPISODE_TYP\
E,PAYER_SERV_GRP_HDR,PAYER_SERV_GRP_LINE,A.PRT_GRP_HDR_CODE,A.PRT_GRP_LINE_C\
ODE,ENT_ITEM_GRP_CODE,PAYER_ITEM_GRP_CODE),'ESGSGN')),1,3) GRP_IND ,DECODE(:\
b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT_IND(OPERATING_FACILITY_ID,CUST_GR\
OUP_CODE,CUST_CODE,BLNG_GRP_ID,EPISODE_TYPE,PAYER_SERV_GRP_HDR,PAYER_SERV_GR\
P_LINE,A.PRT_GRP_HDR_CODE,A.PRT_GRP_LINE_CODE,ENT_ITEM_GRP_CODE,PAYER_ITEM_G\
RP_CODE),'ESGSGN')) SUMMARY_DTL_IND ,upd_gross_charge_amt ,upd_disc_amt ,upd\
_net_charge_amt ,net_reimbursable_amt ,addl_charge_amt_in_charge ,NVL(packag\
e_trx_yn,'N') ,null  package_seq_no ,(a.base_rate/a.base_qty) rate ,a.serv_q\
ty ,NVL(a.upd_disc_amt,0) charge_discount ,(NVL(a.bill_level_disc_dstrbtn_am\
t,0)+NVL(a.line_level_disc_dstrbtn_amt,0)) bill_discount ,NVL(a.bill_level_p\
ol_adj_dstrbtn_amt,0) fund_adjustment ,(");
 sqlbuft((void **)0, 
   "((NVL(a.upd_disc_amt,0)+NVL(a.bill_level_disc_dstrbtn_amt,0))+NVL(a.line\
_level_disc_dstrbtn_amt,0))+NVL(a.bill_level_pol_adj_dstrbtn_amt,0)) tot_dis\
c ,batch_id ,A.SERVICE_DATE servicedate ,NVL(A.package_trx_yn,'N') package_t\
rx_yn_1 ,PHYSICIAN_ID  from bl_patient_charges_folio a ,bl_blng_serv c where\
 ((((((((((operating_facility_id=:b2 and a.blng_serv_code=c.blng_serv_code) \
and episode_type=:b3) and ((:b3<>'R' and episode_id=:b5) or :b3='R')) and ((\
:b3 in ('O','E') and visit_id=:b8) or :b3 in ('I','D','R'))) and patient_id=\
:b10) and a.episode_id=:b5) and (trx_status is null  or (trx_status='C' and \
(((REV_ADJ_TRX_IND='R' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_RE\
F_LINE_NUM,99999999)) not  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  fro\
m bl_patient_charges_folio where ((OPERATING_FACILITY_ID=:b2 and patient_id=\
:b10) and episode_id=:b5))) or (REV_ADJ_TRX_IND='B' and (nvl(SOURCE_DOC_REF,\
'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) not  in (select TRX_DOC_R\
EF ,TRX_DOC_REF_LINE_NUM  from bl_patien");
 sqlbuft((void **)0, 
   "t_charges_folio where ((OPERATING_FACILITY_ID=:b2 and patient_id=:b10) a\
nd episode_id=:b5)))) or (REV_ADJ_TRX_IND is null  and (TRX_DOC_REF,TRX_DOC_\
REF_LINE_NUM) not  in (select NVL(SOURCE_DOC_REF,'XXXX') ,NVL(SOURCE_DOC_REF\
_LINE_NUM,9999)  from BL_PATIENT_CHARGES_FOLIO where ((OPERATING_FACILITY_ID\
=:b2 and patient_id=:b10) and episode_id=:b5))))))) and exists (select b.trx\
_doc_ref  from bl_patient_charges_folio b where (((((b.operating_facility_id\
=:b2 and b.operating_facility_id=a.operating_facility_id) and b.trx_doc_ref=\
a.trx_doc_ref) and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.epis\
ode_id=:b5) and NVL(a.billed_flag,'N')='N'))) and NVL(a.package_trx_yn,'N')=\
'N') and nvl(a.confirmed_yn,'N')<>'N') union all select trx_doc_ref trxdocre\
f ,trx_doc_ref_line_num trxdocreflinenum ,trx_doc_ref_seq_num ,DECODE(PAYER_\
SERV_GRP_HDR,null ,A.PRT_GRP_HDR_CODE,PAYER_SERV_GRP_HDR) payerservgrphdr ,D\
ECODE(PAYER_SERV_GRP_LINE,null ,A.PRT_GRP_LINE_CODE,PAYER_SERV_GRP_LINE) pay\
erservgrpline ,cust_code custcode ,a.bln");
 sqlbuft((void **)0, 
   "g_serv_code ,TO_CHAR(a.service_date,'DD/MM/YYYY HH24:MI') ,DECODE(module\
_id,'PH','M','ST','M','MM','M','S') mapping_code_ind ,(serv_anal_grp1||serv_\
anal_grp2) ,serv_item_code ,DECODE(module_id,'PH',NVL(serv_item_desc_oth_lan\
g,serv_item_desc),'ST',NVL(serv_item_desc_oth_lang,serv_item_desc),'MM',NVL(\
serv_item_desc_oth_lang,serv_item_desc),'X') ,payer_serv_grp_hdr ,payer_serv\
_grp_line ,PAYER_SERV_GRP_CUST_CODE ,PAYER_SERV_GRP_PAT_CLASS ,a.prt_grp_hdr\
_code ,a.prt_grp_line_code ,bill_doc_type_code ,bill_doc_num ,ent_item_grp_c\
ode entitemgrpcode ,payer_item_grp_code payeritemgrpcode ,PAYER_ITEM_GRP_CUS\
T_CODE ,PAYER_ITEM_GRP_PAT_CLASS ,blcore.get_payer_doc_print_seq(operating_f\
acility_id,episode_type,cust_code,cust_group_code,payer_serv_grp_hdr,payer_s\
erv_grp_line,a.prt_grp_hdr_code,a.prt_grp_line_code) print_seq ,substr(DECOD\
E(:b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT_IND(a.OPERATING_FACILITY_ID,a.\
CUST_GROUP_CODE,a.CUST_CODE,a.BLNG_GRP_ID,a.EPISODE_TYPE,a.PAYER_SERV_GRP_HD\
R,a.PAYER_SERV_GRP_LINE,a.PRT_GRP_HDR_CO");
 sqlbuft((void **)0, 
   "DE,a.PRT_GRP_LINE_CODE,a.ENT_ITEM_GRP_CODE,a.PAYER_ITEM_GRP_CODE),'ESGSG\
N')),1,3) GRP_IND ,DECODE(:b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT_IND(a.\
OPERATING_FACILITY_ID,a.CUST_GROUP_CODE,a.CUST_CODE,a.BLNG_GRP_ID,a.EPISODE_\
TYPE,a.PAYER_SERV_GRP_HDR,a.PAYER_SERV_GRP_LINE,a.PRT_GRP_HDR_CODE,a.PRT_GRP\
_LINE_CODE,a.ENT_ITEM_GRP_CODE,a.PAYER_ITEM_GRP_CODE),'ESGSGN')) SUMMARY_DTL\
_IND ,blpackage.get_serv_tot_gross_amt(a.operating_facility_id,a.trx_doc_ref\
,a.trx_doc_ref_line_num,a.trx_doc_ref_seq_num) upd_gross_charge_amt ,blpacka\
ge.get_serv_tot_disc_amt(a.operating_facility_id,a.trx_doc_ref,a.trx_doc_ref\
_line_num,a.trx_doc_ref_seq_num) upd_disc_amt ,blpackage.get_serv_tot_net_am\
t(a.operating_facility_id,a.trx_doc_ref,a.trx_doc_ref_line_num,a.trx_doc_ref\
_seq_num) upd_net_charge_amt ,net_reimbursable_amt ,BL_GET_TAX_AMOUNT(a.oper\
ating_facility_id,a.TRX_DOC_REF,a.TRX_DOC_REF_LINE_NUM,a.TRX_DOC_REF_SEQ_NUM\
,null ,null ,'Y','N',null ) addl_charge_amt_in_charge ,'N' package_trx_yn ,n\
ull  package_seq_no ,(a.base_rate/a.base");
 sqlbuft((void **)0, 
   "_qty) rate ,a.serv_qty ,NVL(a.upd_disc_amt,0) charge_discount ,(NVL(a.bi\
ll_level_disc_dstrbtn_amt,0)+NVL(a.line_level_disc_dstrbtn_amt,0)) bill_disc\
ount ,NVL(a.bill_level_pol_adj_dstrbtn_amt,0) fund_adjustment ,(((NVL(a.upd_\
disc_amt,0)+NVL(a.bill_level_disc_dstrbtn_amt,0))+NVL(a.line_level_disc_dstr\
btn_amt,0))+NVL(a.bill_level_pol_adj_dstrbtn_amt,0)) tot_disc ,batch_id ,A.S\
ERVICE_DATE servicedate ,NVL(A.package_trx_yn,'N') package_trx_yn_1 ,PHYSICI\
AN_ID  from bl_patient_charges_folio a ,bl_blng_serv c where (((((((((((oper\
ating_facility_id=:b2 and a.blng_serv_code=c.blng_serv_code) and episode_typ\
e=:b3) and ((:b3<>'R' and episode_id=:b5) or :b3='R')) and ((:b3 in ('O','E'\
) and visit_id=:b8) or :b3 in ('I','D','R'))) and patient_id=:b10) and a.epi\
sode_id=:b5) and (trx_status is null  or (trx_status='C' and (((REV_ADJ_TRX_\
IND='R' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,9999\
9999)) not  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_ch\
arges_folio where ((OPERATING_FACILITY_I");
 sqlbuft((void **)0, 
   "D=:b2 and patient_id=:b10) and episode_id=:b5))) or (REV_ADJ_TRX_IND='B'\
 and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) \
not  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_charges_f\
olio where ((OPERATING_FACILITY_ID=:b2 and patient_id=:b10) and episode_id=:\
b5)))) or (REV_ADJ_TRX_IND is null  and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) n\
ot  in (select NVL(SOURCE_DOC_REF,'XXXX') ,NVL(SOURCE_DOC_REF_LINE_NUM,9999)\
  from BL_PATIENT_CHARGES_FOLIO where ((OPERATING_FACILITY_ID=:b2 and patien\
t_id=:b10) and episode_id=:b5))))))) and exists (select b.trx_doc_ref  from \
bl_patient_charges_folio b where (((((b.operating_facility_id=:b2 and b.oper\
ating_facility_id=a.operating_facility_id) and b.trx_doc_ref=a.trx_doc_ref) \
and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.episode_id=:b5) and\
 NVL(a.billed_flag,'N')='N'))) and exists (select 1  from bl_package_folio b\
 where (((((b.operating_facility_id=:b2 and b.operating_facility_id=a.operat\
ing_facility_id) and b.trx_doc_ref=a.trx");
 sqlstm.stmt = sq0016;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )680;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )5;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[4] = (unsigned int  )4;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[5] = (unsigned int  )11;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[6] = (unsigned int  )4;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[7] = (unsigned int  )4;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[8] = (unsigned int  )7;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[9] = (unsigned int  )4;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[10] = (unsigned int  )63;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[11] = (unsigned int  )11;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[12] = (unsigned int  )5;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[13] = (unsigned int  )63;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[14] = (unsigned int  )11;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[15] = (unsigned int  )5;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[16] = (unsigned int  )63;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[17] = (unsigned int  )11;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[18] = (unsigned int  )5;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[19] = (unsigned int  )63;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[20] = (unsigned int  )11;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[21] = (unsigned int  )5;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[22] = (unsigned int  )11;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[23] = (unsigned int  )5;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[24] = (unsigned int  )5;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[25] = (unsigned int  )5;
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[26] = (unsigned int  )4;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[27] = (unsigned int  )4;
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqhstv[28] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[28] = (unsigned int  )11;
 sqlstm.sqhsts[28] = (         int  )0;
 sqlstm.sqindv[28] = (         void  *)0;
 sqlstm.sqinds[28] = (         int  )0;
 sqlstm.sqharm[28] = (unsigned int  )0;
 sqlstm.sqadto[28] = (unsigned short )0;
 sqlstm.sqtdso[28] = (unsigned short )0;
 sqlstm.sqhstv[29] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[29] = (unsigned int  )4;
 sqlstm.sqhsts[29] = (         int  )0;
 sqlstm.sqindv[29] = (         void  *)0;
 sqlstm.sqinds[29] = (         int  )0;
 sqlstm.sqharm[29] = (unsigned int  )0;
 sqlstm.sqadto[29] = (unsigned short )0;
 sqlstm.sqtdso[29] = (unsigned short )0;
 sqlstm.sqhstv[30] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[30] = (unsigned int  )4;
 sqlstm.sqhsts[30] = (         int  )0;
 sqlstm.sqindv[30] = (         void  *)0;
 sqlstm.sqinds[30] = (         int  )0;
 sqlstm.sqharm[30] = (unsigned int  )0;
 sqlstm.sqadto[30] = (unsigned short )0;
 sqlstm.sqtdso[30] = (unsigned short )0;
 sqlstm.sqhstv[31] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[31] = (unsigned int  )7;
 sqlstm.sqhsts[31] = (         int  )0;
 sqlstm.sqindv[31] = (         void  *)0;
 sqlstm.sqinds[31] = (         int  )0;
 sqlstm.sqharm[31] = (unsigned int  )0;
 sqlstm.sqadto[31] = (unsigned short )0;
 sqlstm.sqtdso[31] = (unsigned short )0;
 sqlstm.sqhstv[32] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[32] = (unsigned int  )4;
 sqlstm.sqhsts[32] = (         int  )0;
 sqlstm.sqindv[32] = (         void  *)0;
 sqlstm.sqinds[32] = (         int  )0;
 sqlstm.sqharm[32] = (unsigned int  )0;
 sqlstm.sqadto[32] = (unsigned short )0;
 sqlstm.sqtdso[32] = (unsigned short )0;
 sqlstm.sqhstv[33] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[33] = (unsigned int  )63;
 sqlstm.sqhsts[33] = (         int  )0;
 sqlstm.sqindv[33] = (         void  *)0;
 sqlstm.sqinds[33] = (         int  )0;
 sqlstm.sqharm[33] = (unsigned int  )0;
 sqlstm.sqadto[33] = (unsigned short )0;
 sqlstm.sqtdso[33] = (unsigned short )0;
 sqlstm.sqhstv[34] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[34] = (unsigned int  )11;
 sqlstm.sqhsts[34] = (         int  )0;
 sqlstm.sqindv[34] = (         void  *)0;
 sqlstm.sqinds[34] = (         int  )0;
 sqlstm.sqharm[34] = (unsigned int  )0;
 sqlstm.sqadto[34] = (unsigned short )0;
 sqlstm.sqtdso[34] = (unsigned short )0;
 sqlstm.sqhstv[35] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[35] = (unsigned int  )5;
 sqlstm.sqhsts[35] = (         int  )0;
 sqlstm.sqindv[35] = (         void  *)0;
 sqlstm.sqinds[35] = (         int  )0;
 sqlstm.sqharm[35] = (unsigned int  )0;
 sqlstm.sqadto[35] = (unsigned short )0;
 sqlstm.sqtdso[35] = (unsigned short )0;
 sqlstm.sqhstv[36] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[36] = (unsigned int  )63;
 sqlstm.sqhsts[36] = (         int  )0;
 sqlstm.sqindv[36] = (         void  *)0;
 sqlstm.sqinds[36] = (         int  )0;
 sqlstm.sqharm[36] = (unsigned int  )0;
 sqlstm.sqadto[36] = (unsigned short )0;
 sqlstm.sqtdso[36] = (unsigned short )0;
 sqlstm.sqhstv[37] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[37] = (unsigned int  )11;
 sqlstm.sqhsts[37] = (         int  )0;
 sqlstm.sqindv[37] = (         void  *)0;
 sqlstm.sqinds[37] = (         int  )0;
 sqlstm.sqharm[37] = (unsigned int  )0;
 sqlstm.sqadto[37] = (unsigned short )0;
 sqlstm.sqtdso[37] = (unsigned short )0;
 sqlstm.sqhstv[38] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[38] = (unsigned int  )5;
 sqlstm.sqhsts[38] = (         int  )0;
 sqlstm.sqindv[38] = (         void  *)0;
 sqlstm.sqinds[38] = (         int  )0;
 sqlstm.sqharm[38] = (unsigned int  )0;
 sqlstm.sqadto[38] = (unsigned short )0;
 sqlstm.sqtdso[38] = (unsigned short )0;
 sqlstm.sqhstv[39] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[39] = (unsigned int  )63;
 sqlstm.sqhsts[39] = (         int  )0;
 sqlstm.sqindv[39] = (         void  *)0;
 sqlstm.sqinds[39] = (         int  )0;
 sqlstm.sqharm[39] = (unsigned int  )0;
 sqlstm.sqadto[39] = (unsigned short )0;
 sqlstm.sqtdso[39] = (unsigned short )0;
 sqlstm.sqhstv[40] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[40] = (unsigned int  )11;
 sqlstm.sqhsts[40] = (         int  )0;
 sqlstm.sqindv[40] = (         void  *)0;
 sqlstm.sqinds[40] = (         int  )0;
 sqlstm.sqharm[40] = (unsigned int  )0;
 sqlstm.sqadto[40] = (unsigned short )0;
 sqlstm.sqtdso[40] = (unsigned short )0;
 sqlstm.sqhstv[41] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[41] = (unsigned int  )5;
 sqlstm.sqhsts[41] = (         int  )0;
 sqlstm.sqindv[41] = (         void  *)0;
 sqlstm.sqinds[41] = (         int  )0;
 sqlstm.sqharm[41] = (unsigned int  )0;
 sqlstm.sqadto[41] = (unsigned short )0;
 sqlstm.sqtdso[41] = (unsigned short )0;
 sqlstm.sqhstv[42] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[42] = (unsigned int  )63;
 sqlstm.sqhsts[42] = (         int  )0;
 sqlstm.sqindv[42] = (         void  *)0;
 sqlstm.sqinds[42] = (         int  )0;
 sqlstm.sqharm[42] = (unsigned int  )0;
 sqlstm.sqadto[42] = (unsigned short )0;
 sqlstm.sqtdso[42] = (unsigned short )0;
 sqlstm.sqhstv[43] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[43] = (unsigned int  )11;
 sqlstm.sqhsts[43] = (         int  )0;
 sqlstm.sqindv[43] = (         void  *)0;
 sqlstm.sqinds[43] = (         int  )0;
 sqlstm.sqharm[43] = (unsigned int  )0;
 sqlstm.sqadto[43] = (unsigned short )0;
 sqlstm.sqtdso[43] = (unsigned short )0;
 sqlstm.sqhstv[44] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[44] = (unsigned int  )5;
 sqlstm.sqhsts[44] = (         int  )0;
 sqlstm.sqindv[44] = (         void  *)0;
 sqlstm.sqinds[44] = (         int  )0;
 sqlstm.sqharm[44] = (unsigned int  )0;
 sqlstm.sqadto[44] = (unsigned short )0;
 sqlstm.sqtdso[44] = (unsigned short )0;
 sqlstm.sqhstv[45] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[45] = (unsigned int  )11;
 sqlstm.sqhsts[45] = (         int  )0;
 sqlstm.sqindv[45] = (         void  *)0;
 sqlstm.sqinds[45] = (         int  )0;
 sqlstm.sqharm[45] = (unsigned int  )0;
 sqlstm.sqadto[45] = (unsigned short )0;
 sqlstm.sqtdso[45] = (unsigned short )0;
 sqlstm.sqhstv[46] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[46] = (unsigned int  )5;
 sqlstm.sqhsts[46] = (         int  )0;
 sqlstm.sqindv[46] = (         void  *)0;
 sqlstm.sqinds[46] = (         int  )0;
 sqlstm.sqharm[46] = (unsigned int  )0;
 sqlstm.sqadto[46] = (unsigned short )0;
 sqlstm.sqtdso[46] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Open Cursor Group Header Failed");
		proc_exit();
	}
	return;
}

close_grp_hdr_cur()
{ 
	/* EXEC SQL CLOSE BL_BILL_GRP_HDR_LINE_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )883;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
	disp_message (ERR_MESG,"Close BL_BILL_GRP_HDR_LINE_CUR failed");
	proc_exit();
	}
	return;
}

fetch_grp_hdr_cur()
{
	d_trx_doc_ref.arr[0]			= '\0';
	d_trx_doc_ref_line_num.arr[0]	= '\0';
	d_trx_doc_ref_seq_num.arr[0]	= '\0';
	d_cust_code1.arr[0]				= '\0';
	d_blng_serv_code.arr[0]			= '\0';
	d_service_date.arr[0]			= '\0';
	d_mapping_code_ind.arr[0]		= '\0';
	d_serv_anal_grp.arr[0]			= '\0';
	d_serv_item_code.arr[0]			= '\0';
	d_serv_item_desc.arr[0]			= '\0';
	d_payer_serv_grp_hdr.arr[0]		= '\0';
	d_payer_serv_grp_line.arr[0]	= '\0';
	d_prt_grp_hdr_code.arr[0]		= '\0';
	d_prt_grp_line_code.arr[0]		= '\0';
	d_bill_doc_type_code.arr[0]		= '\0';
	d_bill_doc_num.arr[0]			= '\0';
	d_ent_item_grp_code.arr[0]		= '\0';
	d_payer_item_grp_code.arr[0]	= '\0';
	d_summary_dtl_ind.arr[0]		= '\0';
	d_package_trx_yn.arr[0]			= '\0';
	d_folio_batch_id.arr[0]			= '\0';
	d_last_col_trx_yn.arr[0]		= '\0'; //Rajesh
	dc_physician_id.arr[0]		= '\0';
	dc_physician_name.arr[0]		= '\0';

	/***ADDED for merging walkthrough corrections
	d_grp_ind.arr[0]			    = '\0';
	d_payer_serv_grp_cust_code.arr[0] ='\0';
	d_payer_serv_grp_pat_class.arr[0]='\0';
	d_payer_item_grp_cust_code.arr[0]='\0';
	d_payer_item_grp_pat_class.arr[0]='\0';
	/****upto here***/


	d_payer_serv_group_hdr.arr[0]  	= '\0';
	d_payer_serv_group_line.arr[0]  = '\0'; ////IN22491
	d_service_dt.arr[0]				= '\0';
	

	d_trx_doc_ref.len			= 0;
	d_trx_doc_ref_line_num.len	= 0;
	d_trx_doc_ref_seq_num.len	= 0;
	d_cust_code1.len			= 0;
	d_blng_serv_code.len		= 0;
	d_service_date.len			= 0;
	d_mapping_code_ind.len		= 0;
	d_serv_anal_grp.len			= 0;
	d_serv_item_code.len		= 0; 
	d_serv_item_desc.len	    = 0;
	d_payer_serv_grp_hdr.len	= 0;
	d_payer_serv_grp_line.len	= 0;
	d_prt_grp_hdr_code.len		= 0;
	d_prt_grp_line_code.len		= 0;
	d_bill_doc_type_code.len	= 0;
	d_bill_doc_num.len			= 0;
	d_ent_item_grp_code.len		= 0;
	d_payer_item_grp_code.len	= 0;
	d_summary_dtl_ind.len		= 0;
	d_package_trx_yn.len		= 0;
	d_folio_batch_id.len		= 0;
	d_last_col_trx_yn.len		= 0;
	dc_physician_id.len			= 0;
	dc_physician_name.len		= 0;
	
	/***ADDED for merging walkthrough corrections
	d_grp_ind.len			    = 0;
    d_payer_serv_grp_cust_code.len=0;
	d_payer_serv_grp_pat_class.len=0;
	d_payer_item_grp_cust_code.len=0;
	d_payer_item_grp_pat_class.len=0;	
	/***Upto here***/


	d_payer_serv_group_hdr.len  = 0;
	d_payer_serv_group_line.len = 0;
	d_service_dt.len			= 0;
	

//The below code added by Rajesh
	d_upd_gross_charge_amt		= 0;
	d_upd_disc_amt				= 0;
	d_upd_net_charge_amt		= 0;
	d_net_reimbursable_amt		= 0;
	d_addl_charge_amt_in_charge = 0;
//upto here
	/* EXEC SQL FETCH BL_BILL_GRP_HDR_LINE_CUR INTO	
		:d_trx_doc_ref,
		:d_trx_doc_ref_line_num,
		:d_trx_doc_ref_seq_num,
		:d_payer_serv_group_hdr,
		:d_payer_serv_group_line,
		:d_cust_code1,
		:d_blng_serv_code,
		:d_service_date,
		:d_mapping_code_ind,
		:d_serv_anal_grp,
		:d_serv_item_code,
		:d_serv_item_desc,
		:d_payer_serv_grp_hdr,
		:d_payer_serv_grp_line,
		:d_payer_serv_grp_cust_code,
		:d_payer_serv_grp_pat_class,
		:d_prt_grp_hdr_code,
		:d_prt_grp_line_code,
		:d_bill_doc_type_code,
		:d_bill_doc_num,
		:d_ent_item_grp_code,
		:d_payer_item_grp_code,
		:d_payer_item_grp_cust_code,
		:d_payer_item_grp_pat_class,
		:d_print_seq,
		:d_grp_ind,
		:d_summary_dtl_ind,
		:d_upd_gross_charge_amt,
		:d_upd_disc_amt,
		:d_upd_net_charge_amt,
		:d_net_reimbursable_amt,
		:d_addl_charge_amt_in_charge,
		:d_package_trx_yn,
		:d_package_seq_no,
		:d_rate,
		:d_serv_qty,
		:d_charge_discount,
		:d_bill_discount,
		:d_fund_adjustment,
		:d_tot_disc,
		:d_folio_batch_id,
		:d_service_dt,
		:d_last_col_trx_yn,
		:dc_physician_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )898;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d_trx_doc_ref;
 sqlstm.sqhstl[0] = (unsigned int  )63;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_trx_doc_ref_line_num;
 sqlstm.sqhstl[1] = (unsigned int  )11;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_trx_doc_ref_seq_num;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_payer_serv_group_hdr;
 sqlstm.sqhstl[3] = (unsigned int  )32;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_payer_serv_group_line;
 sqlstm.sqhstl[4] = (unsigned int  )32;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_cust_code1;
 sqlstm.sqhstl[5] = (unsigned int  )27;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_blng_serv_code;
 sqlstm.sqhstl[6] = (unsigned int  )33;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_service_date;
 sqlstm.sqhstl[7] = (unsigned int  )22;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_mapping_code_ind;
 sqlstm.sqhstl[8] = (unsigned int  )5;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_serv_anal_grp;
 sqlstm.sqhstl[9] = (unsigned int  )33;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d_serv_item_code;
 sqlstm.sqhstl[10] = (unsigned int  )63;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&d_serv_item_desc;
 sqlstm.sqhstl[11] = (unsigned int  )63;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&d_payer_serv_grp_hdr;
 sqlstm.sqhstl[12] = (unsigned int  )9;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d_payer_serv_grp_line;
 sqlstm.sqhstl[13] = (unsigned int  )9;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&d_payer_serv_grp_cust_code;
 sqlstm.sqhstl[14] = (unsigned int  )12;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&d_payer_serv_grp_pat_class;
 sqlstm.sqhstl[15] = (unsigned int  )7;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d_prt_grp_hdr_code;
 sqlstm.sqhstl[16] = (unsigned int  )9;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d_prt_grp_line_code;
 sqlstm.sqhstl[17] = (unsigned int  )9;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&d_bill_doc_type_code;
 sqlstm.sqhstl[18] = (unsigned int  )20;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&d_bill_doc_num;
 sqlstm.sqhstl[19] = (unsigned int  )11;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&d_ent_item_grp_code;
 sqlstm.sqhstl[20] = (unsigned int  )15;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&d_payer_item_grp_code;
 sqlstm.sqhstl[21] = (unsigned int  )9;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&d_payer_item_grp_cust_code;
 sqlstm.sqhstl[22] = (unsigned int  )12;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&d_payer_item_grp_pat_class;
 sqlstm.sqhstl[23] = (unsigned int  )7;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&d_print_seq;
 sqlstm.sqhstl[24] = (unsigned int  )7;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&d_grp_ind;
 sqlstm.sqhstl[25] = (unsigned int  )6;
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&d_summary_dtl_ind;
 sqlstm.sqhstl[26] = (unsigned int  )9;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&d_upd_gross_charge_amt;
 sqlstm.sqhstl[27] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqhstv[28] = (         void  *)&d_upd_disc_amt;
 sqlstm.sqhstl[28] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[28] = (         int  )0;
 sqlstm.sqindv[28] = (         void  *)0;
 sqlstm.sqinds[28] = (         int  )0;
 sqlstm.sqharm[28] = (unsigned int  )0;
 sqlstm.sqadto[28] = (unsigned short )0;
 sqlstm.sqtdso[28] = (unsigned short )0;
 sqlstm.sqhstv[29] = (         void  *)&d_upd_net_charge_amt;
 sqlstm.sqhstl[29] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[29] = (         int  )0;
 sqlstm.sqindv[29] = (         void  *)0;
 sqlstm.sqinds[29] = (         int  )0;
 sqlstm.sqharm[29] = (unsigned int  )0;
 sqlstm.sqadto[29] = (unsigned short )0;
 sqlstm.sqtdso[29] = (unsigned short )0;
 sqlstm.sqhstv[30] = (         void  *)&d_net_reimbursable_amt;
 sqlstm.sqhstl[30] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[30] = (         int  )0;
 sqlstm.sqindv[30] = (         void  *)0;
 sqlstm.sqinds[30] = (         int  )0;
 sqlstm.sqharm[30] = (unsigned int  )0;
 sqlstm.sqadto[30] = (unsigned short )0;
 sqlstm.sqtdso[30] = (unsigned short )0;
 sqlstm.sqhstv[31] = (         void  *)&d_addl_charge_amt_in_charge;
 sqlstm.sqhstl[31] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[31] = (         int  )0;
 sqlstm.sqindv[31] = (         void  *)0;
 sqlstm.sqinds[31] = (         int  )0;
 sqlstm.sqharm[31] = (unsigned int  )0;
 sqlstm.sqadto[31] = (unsigned short )0;
 sqlstm.sqtdso[31] = (unsigned short )0;
 sqlstm.sqhstv[32] = (         void  *)&d_package_trx_yn;
 sqlstm.sqhstl[32] = (unsigned int  )4;
 sqlstm.sqhsts[32] = (         int  )0;
 sqlstm.sqindv[32] = (         void  *)0;
 sqlstm.sqinds[32] = (         int  )0;
 sqlstm.sqharm[32] = (unsigned int  )0;
 sqlstm.sqadto[32] = (unsigned short )0;
 sqlstm.sqtdso[32] = (unsigned short )0;
 sqlstm.sqhstv[33] = (         void  *)&d_package_seq_no;
 sqlstm.sqhstl[33] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[33] = (         int  )0;
 sqlstm.sqindv[33] = (         void  *)0;
 sqlstm.sqinds[33] = (         int  )0;
 sqlstm.sqharm[33] = (unsigned int  )0;
 sqlstm.sqadto[33] = (unsigned short )0;
 sqlstm.sqtdso[33] = (unsigned short )0;
 sqlstm.sqhstv[34] = (         void  *)&d_rate;
 sqlstm.sqhstl[34] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[34] = (         int  )0;
 sqlstm.sqindv[34] = (         void  *)0;
 sqlstm.sqinds[34] = (         int  )0;
 sqlstm.sqharm[34] = (unsigned int  )0;
 sqlstm.sqadto[34] = (unsigned short )0;
 sqlstm.sqtdso[34] = (unsigned short )0;
 sqlstm.sqhstv[35] = (         void  *)&d_serv_qty;
 sqlstm.sqhstl[35] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[35] = (         int  )0;
 sqlstm.sqindv[35] = (         void  *)0;
 sqlstm.sqinds[35] = (         int  )0;
 sqlstm.sqharm[35] = (unsigned int  )0;
 sqlstm.sqadto[35] = (unsigned short )0;
 sqlstm.sqtdso[35] = (unsigned short )0;
 sqlstm.sqhstv[36] = (         void  *)&d_charge_discount;
 sqlstm.sqhstl[36] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[36] = (         int  )0;
 sqlstm.sqindv[36] = (         void  *)0;
 sqlstm.sqinds[36] = (         int  )0;
 sqlstm.sqharm[36] = (unsigned int  )0;
 sqlstm.sqadto[36] = (unsigned short )0;
 sqlstm.sqtdso[36] = (unsigned short )0;
 sqlstm.sqhstv[37] = (         void  *)&d_bill_discount;
 sqlstm.sqhstl[37] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[37] = (         int  )0;
 sqlstm.sqindv[37] = (         void  *)0;
 sqlstm.sqinds[37] = (         int  )0;
 sqlstm.sqharm[37] = (unsigned int  )0;
 sqlstm.sqadto[37] = (unsigned short )0;
 sqlstm.sqtdso[37] = (unsigned short )0;
 sqlstm.sqhstv[38] = (         void  *)&d_fund_adjustment;
 sqlstm.sqhstl[38] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[38] = (         int  )0;
 sqlstm.sqindv[38] = (         void  *)0;
 sqlstm.sqinds[38] = (         int  )0;
 sqlstm.sqharm[38] = (unsigned int  )0;
 sqlstm.sqadto[38] = (unsigned short )0;
 sqlstm.sqtdso[38] = (unsigned short )0;
 sqlstm.sqhstv[39] = (         void  *)&d_tot_disc;
 sqlstm.sqhstl[39] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[39] = (         int  )0;
 sqlstm.sqindv[39] = (         void  *)0;
 sqlstm.sqinds[39] = (         int  )0;
 sqlstm.sqharm[39] = (unsigned int  )0;
 sqlstm.sqadto[39] = (unsigned short )0;
 sqlstm.sqtdso[39] = (unsigned short )0;
 sqlstm.sqhstv[40] = (         void  *)&d_folio_batch_id;
 sqlstm.sqhstl[40] = (unsigned int  )102;
 sqlstm.sqhsts[40] = (         int  )0;
 sqlstm.sqindv[40] = (         void  *)0;
 sqlstm.sqinds[40] = (         int  )0;
 sqlstm.sqharm[40] = (unsigned int  )0;
 sqlstm.sqadto[40] = (unsigned short )0;
 sqlstm.sqtdso[40] = (unsigned short )0;
 sqlstm.sqhstv[41] = (         void  *)&d_service_dt;
 sqlstm.sqhstl[41] = (unsigned int  )32;
 sqlstm.sqhsts[41] = (         int  )0;
 sqlstm.sqindv[41] = (         void  *)0;
 sqlstm.sqinds[41] = (         int  )0;
 sqlstm.sqharm[41] = (unsigned int  )0;
 sqlstm.sqadto[41] = (unsigned short )0;
 sqlstm.sqtdso[41] = (unsigned short )0;
 sqlstm.sqhstv[42] = (         void  *)&d_last_col_trx_yn;
 sqlstm.sqhstl[42] = (unsigned int  )22;
 sqlstm.sqhsts[42] = (         int  )0;
 sqlstm.sqindv[42] = (         void  *)0;
 sqlstm.sqinds[42] = (         int  )0;
 sqlstm.sqharm[42] = (unsigned int  )0;
 sqlstm.sqadto[42] = (unsigned short )0;
 sqlstm.sqtdso[42] = (unsigned short )0;
 sqlstm.sqhstv[43] = (         void  *)&dc_physician_id;
 sqlstm.sqhstl[43] = (unsigned int  )18;
 sqlstm.sqhsts[43] = (         int  )0;
 sqlstm.sqindv[43] = (         void  *)0;
 sqlstm.sqinds[43] = (         int  )0;
 sqlstm.sqharm[43] = (unsigned int  )0;
 sqlstm.sqadto[43] = (unsigned short )0;
 sqlstm.sqtdso[43] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
 
	          
	if (OERROR)
	{ 
		disp_message(ERR_MESG,"Fetch Group Header Cursor Failed");
		proc_exit();
	}

    if(NODATAFOUND)
	{
   		return 0;
	}


/** added by raghava 30/07/2010 **/
    if(strcmp(d_summary_dtl_ind.arr,"ESLSGN")==0)
    strcpy(d_summary_dtl_ind.arr,"ESLSLN");
    if(strcmp(d_summary_dtl_ind.arr,"PSLSGN")==0)
    strcpy(d_summary_dtl_ind.arr,"PSLSLN");
    /** upto 30/07/2010 **/

	/** Added for medicity issue On 28/09/2010 by raghav from BKK**/
   if(strcmp(d_grp_ind.arr,"ESG")==0)
   {
    if (d_summary_dtl_ind.arr[3] == 'S' && d_summary_dtl_ind.arr[4] == 'L')
	strcpy(d_grp_ind.arr,"ESL");
   }
   
   if(strcmp(d_grp_ind.arr,"PSG")==0)
   {
    if (d_summary_dtl_ind.arr[3] == 'S' && d_summary_dtl_ind.arr[4] == 'L')
	strcpy(d_grp_ind.arr,"PSL");
   }
   /** upto here **/


	d_trx_doc_ref.arr[d_trx_doc_ref.len]					= '\0';
	d_trx_doc_ref_line_num.arr[d_trx_doc_ref_line_num.len]	= '\0';
	d_trx_doc_ref_seq_num.arr[d_trx_doc_ref_seq_num.len]	= '\0';
	d_cust_code1.arr[d_cust_code1.len]						= '\0';
	d_blng_serv_code.arr[d_blng_serv_code.len]				= '\0';
	d_mapping_code_ind.arr[d_mapping_code_ind.len]			= '\0';
	d_serv_anal_grp.arr[d_serv_anal_grp.len]				= '\0';
	d_serv_item_code.arr[d_serv_item_code.len]				= '\0';
	d_serv_item_desc.arr[d_serv_item_desc.len]				= '\0';
	d_payer_serv_grp_hdr.arr[d_payer_serv_grp_hdr.len]		= '\0';
	d_payer_serv_grp_line.arr[d_payer_serv_grp_line.len]	= '\0';
	d_prt_grp_hdr_code.arr[d_prt_grp_hdr_code.len]			= '\0';
	d_prt_grp_line_code.arr[d_prt_grp_line_code.len]		= '\0';
	d_bill_doc_type_code.arr[d_bill_doc_type_code.len]		= '\0';
	d_bill_doc_num.arr[d_bill_doc_num.len]					= '\0';
	d_ent_item_grp_code.arr[d_ent_item_grp_code.len]		= '\0';
	d_payer_item_grp_code.arr[d_payer_item_grp_code.len]	= '\0';
    d_summary_dtl_ind.arr[d_summary_dtl_ind.len]			= '\0';
	d_package_trx_yn.arr[d_package_trx_yn.len]				= '\0';
	d_folio_batch_id.arr[d_folio_batch_id.len]				= '\0';
	d_last_col_trx_yn.arr[d_last_col_trx_yn.len]			= '\0';
	dc_physician_id.arr[dc_physician_id.len]				= '\0';
	
	/***ADDED for merging walkthrough corrections
	d_grp_ind.arr[d_grp_ind.len]					        = '\0';
    d_payer_serv_grp_cust_code.arr[d_payer_serv_grp_cust_code.len] ='\0';
	d_payer_serv_grp_pat_class.arr[d_payer_serv_grp_pat_class.len]= '\0';
	d_payer_item_grp_cust_code.arr[d_payer_item_grp_cust_code.len]= '\0';
	d_payer_item_grp_pat_class.arr[d_payer_item_grp_pat_class.len]= '\0';
	/******upto here****/


	d_payer_serv_group_hdr.arr[d_payer_serv_group_hdr.len]	 = '\0';
	d_payer_serv_group_line.arr[d_payer_serv_group_line.len] = '\0';
	d_service_dt.arr[d_service_dt.len]						 = '\0';
	


if (strcmp(p_print_serv_date_with_time_yn.arr,"N")==0)
{	
	d_service_date1.arr[0]='\0';
	
	/* EXEC SQL select to_char(to_date(:d_service_date,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')
							into  :d_service_date1 from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select to_char(to_date(:b0,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY\
') into :b1  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1089;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_service_date;
 sqlstm.sqhstl[0] = (unsigned int  )22;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_service_date1;
 sqlstm.sqhstl[1] = (unsigned int  )22;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    strcpy(d_service_date.arr,d_service_date1.arr);

	if(d_service_date.arr[0]!='\0')
				{
				  init_date_temp_var();
				  strcpy(date_convert.arr,d_service_date.arr);
				  fun_change_loc_date();
				  strcpy(d_service_date.arr,nd_loc_date1.arr);
				 				  
				 }

}
else
{

	if(d_service_date.arr[0]!='\0')
				{
				  init_date_temp_var();
				  strcpy(date_convert.arr,d_service_date.arr);
				  fun_change_loc_date1();
				  strcpy(d_service_date.arr,date_convert.arr);
			
				 }

}


	/* EXEC SQL select FULL_NAME into :dc_physician_name
			 from sy_physician_mast_lang_vw
			where PHYSICIAN_ID=:dc_physician_id
			and facility_id=:nd_facility_id
			and language_id=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select FULL_NAME into :b0  from sy_physician_mast_lang_vw wh\
ere ((PHYSICIAN_ID=:b1 and facility_id=:b2) and language_id=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1112;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&dc_physician_name;
 sqlstm.sqhstl[0] = (unsigned int  )102;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&dc_physician_id;
 sqlstm.sqhstl[1] = (unsigned int  )18;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )5;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	dc_physician_name.arr[dc_physician_name.len]	= '\0';



	return 1;
}

// The below code added by Rajesh for Package approval Detail

declare_payer_approval()
{
				    
   /* EXEC SQL DECLARE BL_PAYER_APPROVAL_CUR CURSOR FOR
   SELECT   	b.package_code, 
				a.credit_auth_ref,
                a.credit_auth_date, d.package_amt, a.approved_amt,b.approved_amt 
           FROM bl_encounter_payer_approval a,
                bl_encnt_payer_pkg_approval b,
                bl_package_sub_hdr d
          WHERE a.operating_facility_id = b.operating_facility_id
            AND a.patient_id = b.patient_id
            AND a.episode_type = b.episode_type
            AND a.episode_id = b.episode_id
            AND a.acct_seq_no = b.acct_seq_no
            AND a.policy_type_code = b.policy_type_code
            AND a.policy_number = b.policy_number
            AND NVL (a.cust_group_code, '#') = NVL (b.cust_group_code, '#')
            AND NVL (a.cust_code, '#') = NVL (b.cust_code, '#')
            AND a.blng_grp_id = b.blng_grp_id
            AND a.priority = b.priority
            AND a.credit_auth_ref = b.credit_auth_ref
            AND NVL (a.appt_book_ref_num, '#') = NVL (b.appt_book_ref_num, '#')
            AND b.package_code = d.package_code
            AND b.package_seq_no = d.package_seq_no
			AND NVL(d.status,'X')= 'O'
            AND a.patient_id = :d_patient_id
            AND a.episode_id = NVL (:d_episode_id, a.episode_id)
            AND a.cust_code = :d_cust_code
            AND a.acct_seq_no = (            
                   SELECT cur_acct_seq_no
                     FROM bl_episode_fin_dtls
                    WHERE operating_facility_id = :nd_facility_id
                      AND patient_id = :d_patient_id
                      AND episode_type = :d_episode_type
                      AND episode_id = :d_episode_id)
UNION ALL
SELECT	null package_code,     
		a.credit_auth_ref, a.credit_auth_date,
       NULL package_amt, a.approved_amt, NULL approved_amt
  FROM bl_encounter_payer_approval a
 WHERE a.patient_id = :d_patient_id
   AND a.episode_id = :d_episode_id
   AND a.cust_code = :d_cust_code
   AND a.acct_seq_no =( SELECT cur_acct_seq_no
						FROM bl_episode_fin_dtls
					   WHERE operating_facility_id = :nd_facility_id
						 AND patient_id = :d_patient_id
						 AND episode_type = :d_episode_type
						 and episode_type in('I','D')
						 AND episode_id = :d_episode_id)
   AND NOT EXISTS (
          SELECT 'x'
            FROM bl_encnt_payer_pkg_approval b
           WHERE b.operating_facility_id = a.operating_facility_id
             AND b.patient_id = a.patient_id
             AND b.episode_type = a.episode_type
             AND b.episode_id = a.episode_id
             AND b.acct_seq_no = a.acct_seq_no
             AND b.policy_type_code = a.policy_type_code
             AND b.policy_number = a.policy_number
             AND NVL (b.cust_group_code, '#') = NVL (a.cust_group_code, '#')
             AND NVL (b.cust_code, '#') = NVL (a.cust_code, '#')
             AND b.blng_grp_id = a.blng_grp_id
             AND b.priority = a.priority
             AND b.credit_auth_ref = a.credit_auth_ref
             AND NVL (b.appt_book_ref_num, '#') = NVL (a.appt_book_ref_num, '#')); */ 


	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Failed to Declare Payer Approval Cursor");
		proc_exit;
	}
	
	return;
}


open_payer_approval()
{
		

	/* EXEC SQL OPEN BL_PAYER_APPROVAL_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlbuft((void **)0, 
   "select b.package_code ,a.credit_auth_ref ,a.credit_auth_date ,d.package_\
amt ,a.approved_amt ,b.approved_amt  from bl_encounter_payer_approval a ,bl_\
encnt_payer_pkg_approval b ,bl_package_sub_hdr d where (((((((((((((((((((a.\
operating_facility_id=b.operating_facility_id and a.patient_id=b.patient_id)\
 and a.episode_type=b.episode_type) and a.episode_id=b.episode_id) and a.acc\
t_seq_no=b.acct_seq_no) and a.policy_type_code=b.policy_type_code) and a.pol\
icy_number=b.policy_number) and NVL(a.cust_group_code,'#')=NVL(b.cust_group_\
code,'#')) and NVL(a.cust_code,'#')=NVL(b.cust_code,'#')) and a.blng_grp_id=\
b.blng_grp_id) and a.priority=b.priority) and a.credit_auth_ref=b.credit_aut\
h_ref) and NVL(a.appt_book_ref_num,'#')=NVL(b.appt_book_ref_num,'#')) and b.\
package_code=d.package_code) and b.package_seq_no=d.package_seq_no) and NVL(\
d.status,'X')='O') and a.patient_id=:b0) and a.episode_id=NVL(:b1,a.episode_\
id)) and a.cust_code=:b2) and a.acct_seq_no=(select cur_acct_seq_no  from bl\
_episode_fin_dtls where (((operating_fac");
 sqlbuft((void **)0, 
   "ility_id=:b3 and patient_id=:b0) and episode_type=:b5) and episode_id=:b\
1))) union all select null  package_code ,a.credit_auth_ref ,a.credit_auth_d\
ate ,null  package_amt ,a.approved_amt ,null  approved_amt  from bl_encounte\
r_payer_approval a where ((((a.patient_id=:b0 and a.episode_id=:b1) and a.cu\
st_code=:b2) and a.acct_seq_no=(select cur_acct_seq_no  from bl_episode_fin_\
dtls where ((((operating_facility_id=:b3 and patient_id=:b0) and episode_typ\
e=:b5) and episode_type in ('I','D')) and episode_id=:b1))) and  not exists \
(select 'x'  from bl_encnt_payer_pkg_approval b where ((((((((((((b.operatin\
g_facility_id=a.operating_facility_id and b.patient_id=a.patient_id) and b.e\
pisode_type=a.episode_type) and b.episode_id=a.episode_id) and b.acct_seq_no\
=a.acct_seq_no) and b.policy_type_code=a.policy_type_code) and b.policy_numb\
er=a.policy_number) and NVL(b.cust_group_code,'#')=NVL(a.cust_group_code,'#'\
)) and NVL(b.cust_code,'#')=NVL(a.cust_code,'#')) and b.blng_grp_id=a.blng_g\
rp_id) and b.priority=a.priority) and b.");
 sqlstm.stmt = sq0019;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1143;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[0] = (unsigned int  )63;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[1] = (unsigned int  )11;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_cust_code;
 sqlstm.sqhstl[2] = (unsigned int  )27;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[3] = (unsigned int  )5;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[4] = (unsigned int  )63;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[5] = (unsigned int  )4;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[6] = (unsigned int  )11;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[7] = (unsigned int  )63;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[8] = (unsigned int  )11;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_cust_code;
 sqlstm.sqhstl[9] = (unsigned int  )27;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[10] = (unsigned int  )5;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[11] = (unsigned int  )63;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[12] = (unsigned int  )4;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[13] = (unsigned int  )11;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Open Cursor bl payer approval Failed");
		proc_exit();
	}
	return;
}

close_payer_approval()
{ 
	/* EXEC SQL CLOSE BL_PAYER_APPROVAL_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1214;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
	disp_message (ERR_MESG,"Close bl payer approval failed");
	proc_exit();
	}
	return;
}

fetch_payer_approval()
{
	
	d_pk_short_desc.arr[0]			= '\0';	
	d_pk_credit_auth_ref.arr[0]		= '\0';
	d_pk_credit_auth_dt.arr[0]		= '\0';
	d_package_code.arr[0]			= '\0';

	d_pk_short_desc.len				= 0;
	d_pk_credit_auth_ref.len		= 0;
	d_pk_credit_auth_dt.len			= 0;
	d_package_code.len			= 0;


	/* EXEC SQL FETCH BL_PAYER_APPROVAL_CUR INTO
		:d_package_code,
		:d_pk_credit_auth_ref,
		:d_pk_credit_auth_dt,
		:d_pk_pack_amount,
		:d_pk_appr_amount,
		:d_pk_approval_amount; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1229;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d_package_code;
 sqlstm.sqhstl[0] = (unsigned int  )12;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_pk_credit_auth_ref;
 sqlstm.sqhstl[1] = (unsigned int  )23;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_pk_credit_auth_dt;
 sqlstm.sqhstl[2] = (unsigned int  )32;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_pk_pack_amount;
 sqlstm.sqhstl[3] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_pk_appr_amount;
 sqlstm.sqhstl[4] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_pk_approval_amount;
 sqlstm.sqhstl[5] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
	if (OERROR)
	{ 
			disp_message(ERR_MESG,"Fetch payer approval Cursor Failed");
		proc_exit();
	}
if(NODATAFOUND)
			{
   			
				return 0;
			}
	if(d_package_code.arr[0]!='\0')   
	{
		/* EXEC SQL select short_desc into :d_pk_short_desc 
				 from bl_package_lang_vw
				 where package_code=:d_package_code
				 and language_id=:nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select short_desc into :b0  from bl_package_lang_vw where (\
package_code=:b1 and language_id=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )1268;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_pk_short_desc;
  sqlstm.sqhstl[0] = (unsigned int  )103;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_package_code;
  sqlstm.sqhstl[1] = (unsigned int  )12;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}
	
	d_package_code.arr[d_package_code.len]	= '\0'; 
	d_pk_short_desc.arr[d_pk_short_desc.len]	= '\0'; 
	d_pk_credit_auth_ref.arr[d_pk_credit_auth_ref.len]	= '\0'; 
	d_pk_credit_auth_dt.arr[d_pk_credit_auth_dt.len]	= '\0'; 
	return 1;
}

// The below code added by Rajesh for showing package related service and qty

declare_package_service_qty()
{

   /* EXEC SQL DECLARE PACKAGE_SERVICE_QTY CURSOR FOR
   SELECT   a.blng_serv_code, 
			TO_CHAR (a.service_date, 'DD/MM/YYYY'),
			DECODE (module_id,
                 'PH', 'M',
                 'ST', 'M',
                 'MM', 'M',
                 'S'
                ) mapping_code_ind,
			serv_anal_grp1 || serv_anal_grp2, 
			serv_item_code,
			DECODE (module_id,
                 'PH', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'ST', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'MM', NVL (serv_item_desc_oth_lang, serv_item_desc),
                 'X'
                ),
			payer_serv_grp_hdr, 
			payer_serv_grp_line, 
		  a.prt_grp_hdr_code,
          a.prt_grp_line_code,
		    ent_item_grp_code, 
			payer_item_grp_code,
            blcore.get_payer_doc_print_seq (operating_facility_id,
				                             episode_type,
					                         cust_code,
						                     cust_group_code,
							                 payer_serv_grp_hdr,
								             payer_serv_grp_line,
									         a.prt_grp_hdr_code,
										     a.prt_grp_line_code
											) print_seq,
			DECODE(:v_detail_report,'Y', 'DLS',
					NVL (blcore.get_bill_format_ind (operating_facility_id,
													  cust_group_code,
													  cust_code,
													  blng_grp_id,
													  episode_type,
													  payer_serv_grp_hdr,
													  payer_serv_grp_line,
													  a.prt_grp_hdr_code,
													  a.prt_grp_line_code,
													  ent_item_grp_code,
													  payer_item_grp_code
													),
						'SGN'
						)
					) summary_dtl_ind,
			'Y' package_trx_yn,
			a.trx_doc_ref,
            a.trx_doc_ref_line_num,
			a.trx_doc_ref_seq_num
    FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
     AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   (    NVL (rev_adj_trx_ind, 'R') = 'R'
                       AND (source_doc_ref, source_doc_ref_line_num) NOT IN (
                              SELECT trx_doc_ref, trx_doc_ref_line_num
                                FROM bl_patient_charges_folio
                               WHERE operating_facility_id = :nd_facility_id
                                 AND patient_id = :d_patient_id
                                 AND a.episode_id = :d_episode_id)
                      )
                   OR (:d1_bill_amt = 0)
                  )
             )
          OR (    rev_adj_trx_ind = 'B'
              AND (trx_doc_ref, trx_doc_ref_line_num) NOT IN (
                     SELECT source_doc_ref, source_doc_ref_line_num
                       FROM bl_patient_charges_folio
                      WHERE operating_facility_id = :nd_facility_id
                        AND patient_id = :d_patient_id
                        AND a.episode_id = :d_episode_id)
             )
         )
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
AND EXISTS (
            SELECT 1
              FROM bl_package_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
			   AND b.package_seq_no = :l_pkg_seq_num
               AND b.package_trx_yn = 'Y'
             )
and NVL (a.package_trx_yn, 'N') IN ('P','Y') 
and nvl(a.confirmed_yn,'N')!='N' 

and ((:d2_cust_code is null and a.cust_code is null)
    or (:d2_cust_code is not null and a.cust_code = :d2_cust_code))
ORDER BY PRINT_SEQ,PAYER_ITEM_GRP_CODE,
summary_dtl_ind,a.TRX_DOC_REF,a.TRX_DOC_REF_LINE_NUM; */ 
	

	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Failed to Declare Package service qty Cursor");
		proc_exit;
	}
	
	return;
}


open_package_service_qty()
{
	/* EXEC SQL OPEN PACKAGE_SERVICE_QTY; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlbuft((void **)0, 
   "select a.blng_serv_code ,TO_CHAR(a.service_date,'DD/MM/YYYY') ,DECODE(mo\
dule_id,'PH','M','ST','M','MM','M','S') mapping_code_ind ,(serv_anal_grp1||s\
erv_anal_grp2) ,serv_item_code ,DECODE(module_id,'PH',NVL(serv_item_desc_oth\
_lang,serv_item_desc),'ST',NVL(serv_item_desc_oth_lang,serv_item_desc),'MM',\
NVL(serv_item_desc_oth_lang,serv_item_desc),'X') ,payer_serv_grp_hdr ,payer_\
serv_grp_line ,a.prt_grp_hdr_code ,a.prt_grp_line_code ,ent_item_grp_code ,p\
ayer_item_grp_code ,blcore.get_payer_doc_print_seq(operating_facility_id,epi\
sode_type,cust_code,cust_group_code,payer_serv_grp_hdr,payer_serv_grp_line,a\
.prt_grp_hdr_code,a.prt_grp_line_code) print_seq ,DECODE(:b0,'Y','DLS',NVL(b\
lcore.get_bill_format_ind(operating_facility_id,cust_group_code,cust_code,bl\
ng_grp_id,episode_type,payer_serv_grp_hdr,payer_serv_grp_line,a.prt_grp_hdr_\
code,a.prt_grp_line_code,ent_item_grp_code,payer_item_grp_code),'SGN')) summ\
ary_dtl_ind ,'Y' package_trx_yn ,a.trx_doc_ref ,a.trx_doc_ref_line_num ,a.tr\
x_doc_ref_seq_num  from bl_patient_charg");
 sqlbuft((void **)0, 
   "es_folio a ,bl_blng_serv c where ((((((((((((operating_facility_id=:b1 a\
nd a.blng_serv_code=c.blng_serv_code) and episode_type=:b2) and ((:b2<>'R' a\
nd episode_id=:b4) or :b2='R')) and ((:b2 in ('O','E') and visit_id=:b7) or \
:b2 in ('I','D','R'))) and patient_id=:b9) and a.episode_id=:b4) and ((trx_s\
tatus is null  or (trx_status='C' and ((NVL(rev_adj_trx_ind,'R')='R' and (so\
urce_doc_ref,source_doc_ref_line_num) not  in (select trx_doc_ref ,trx_doc_r\
ef_line_num  from bl_patient_charges_folio where ((operating_facility_id=:b1\
 and patient_id=:b9) and a.episode_id=:b4))) or :b14=0))) or (rev_adj_trx_in\
d='B' and (trx_doc_ref,trx_doc_ref_line_num) not  in (select source_doc_ref \
,source_doc_ref_line_num  from bl_patient_charges_folio where ((operating_fa\
cility_id=:b1 and patient_id=:b9) and a.episode_id=:b4))))) and exists (sele\
ct b.trx_doc_ref  from bl_patient_charges_folio b where (((((b.operating_fac\
ility_id=:b1 and b.operating_facility_id=a.operating_facility_id) and b.trx_\
doc_ref=a.trx_doc_ref) and b.trx_doc_ref");
 sqlstm.stmt = sq0021;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1295;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[4] = (unsigned int  )11;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[5] = (unsigned int  )4;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[6] = (unsigned int  )4;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[7] = (unsigned int  )7;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[8] = (unsigned int  )4;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[9] = (unsigned int  )63;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[10] = (unsigned int  )11;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[11] = (unsigned int  )5;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[12] = (unsigned int  )63;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[13] = (unsigned int  )11;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&d1_bill_amt;
 sqlstm.sqhstl[14] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[15] = (unsigned int  )5;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[16] = (unsigned int  )63;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[17] = (unsigned int  )11;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[18] = (unsigned int  )5;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[19] = (unsigned int  )11;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[20] = (unsigned int  )5;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&l_pkg_seq_num;
 sqlstm.sqhstl[21] = (unsigned int  )52;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&d2_cust_code;
 sqlstm.sqhstl[22] = (unsigned int  )27;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&d2_cust_code;
 sqlstm.sqhstl[23] = (unsigned int  )27;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&d2_cust_code;
 sqlstm.sqhstl[24] = (unsigned int  )27;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Open Cursor Package service qty Failed");
		proc_exit();
	}
	return;
}

close_package_service_qty()
{ 
	/* EXEC SQL CLOSE PACKAGE_SERVICE_QTY; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1410;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
	disp_message (ERR_MESG,"Close Cursor Package service qty failed");
	proc_exit();
	}
	return;
}

fetch_package_service_qty()
{
	
nd_pkg_serv_code.arr[0]			= '\0';	
nd_pkg_serv_dt.arr[0]			= '\0';	
nd_mapping_code_ind.arr[0]		= '\0';	
nd_serv_anal_group.arr[0]		= '\0';	
nd_serv_item_code.arr[0]		= '\0';	
nd_serv_item_desc.arr[0]		= '\0';	
nd_payer_serv_group_hdr.arr[0]	= '\0';	
nd_payer_serv_group_line.arr[0]	= '\0';	
nd_prt_group_hdr_code.arr[0]	= '\0';	
nd_prt_group_line_code.arr[0]	= '\0';	
nd_ent_item_grp_code.arr[0]		= '\0';	
nd_payer_item_grp_code.arr[0]	= '\0';	
nd_detail_report.arr[0]			= '\0';	
v_package_trx_yn.arr[0]			= '\0';	
d_pk_trx_doc_ref.arr[0]				= '\0';	
d_pk_trx_doc_ref_line_num.arr[0]		= '\0';	
d_pk_trx_doc_ref_seq_num.arr[0]		= '\0';	
nd_serv_qty.arr[0]		= '\0';	
		
nd_pkg_serv_code.len			= 0;
nd_pkg_serv_dt.len				= 0;
nd_mapping_code_ind.len			= 0;
nd_serv_anal_group.len			= 0;
nd_serv_item_code.len			= 0;
nd_serv_item_desc.len			= 0;
nd_payer_serv_group_hdr.len		= 0;
nd_payer_serv_group_line.len	= 0;
nd_prt_group_hdr_code.len		= 0;
nd_prt_group_line_code.len		= 0;
nd_ent_item_grp_code.len		= 0; 
nd_payer_item_grp_code.len		= 0;
nd_detail_report.len			= 0;
v_package_trx_yn.len			= 0;
d_pk_trx_doc_ref.len				= 0;
d_pk_trx_doc_ref_line_num.len		= 0;
d_pk_trx_doc_ref_seq_num.len		= 0;
nd_serv_qty.len                 = 0;




	/* EXEC SQL FETCH PACKAGE_SERVICE_QTY INTO
				:nd_pkg_serv_code,
				:nd_pkg_serv_dt,
				:nd_mapping_code_ind,
				:nd_serv_anal_group,
				:nd_serv_item_code,
				:nd_serv_item_desc,
				:nd_payer_serv_group_hdr,
				:nd_payer_serv_group_line,
				:nd_prt_group_hdr_code,
				:nd_prt_group_line_code,
				:nd_ent_item_grp_code ,
				:nd_payer_item_grp_code,
				:nd_print_seq,
				:nd_detail_report,
				:v_package_trx_yn,
				:d_pk_trx_doc_ref,
				:d_pk_trx_doc_ref_line_num,
				:d_pk_trx_doc_ref_seq_num; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1425;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&nd_pkg_serv_code;
 sqlstm.sqhstl[0] = (unsigned int  )32;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_pkg_serv_dt;
 sqlstm.sqhstl[1] = (unsigned int  )32;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_mapping_code_ind;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_serv_anal_group;
 sqlstm.sqhstl[3] = (unsigned int  )32;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&nd_serv_item_code;
 sqlstm.sqhstl[4] = (unsigned int  )32;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&nd_serv_item_desc;
 sqlstm.sqhstl[5] = (unsigned int  )103;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&nd_payer_serv_group_hdr;
 sqlstm.sqhstl[6] = (unsigned int  )103;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&nd_payer_serv_group_line;
 sqlstm.sqhstl[7] = (unsigned int  )103;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&nd_prt_group_hdr_code;
 sqlstm.sqhstl[8] = (unsigned int  )9;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&nd_prt_group_line_code;
 sqlstm.sqhstl[9] = (unsigned int  )103;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&nd_ent_item_grp_code;
 sqlstm.sqhstl[10] = (unsigned int  )103;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&nd_payer_item_grp_code;
 sqlstm.sqhstl[11] = (unsigned int  )103;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&nd_print_seq;
 sqlstm.sqhstl[12] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&nd_detail_report;
 sqlstm.sqhstl[13] = (unsigned int  )103;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&v_package_trx_yn;
 sqlstm.sqhstl[14] = (unsigned int  )4;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&d_pk_trx_doc_ref;
 sqlstm.sqhstl[15] = (unsigned int  )63;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d_pk_trx_doc_ref_line_num;
 sqlstm.sqhstl[16] = (unsigned int  )11;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d_pk_trx_doc_ref_seq_num;
 sqlstm.sqhstl[17] = (unsigned int  )7;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if(NODATAFOUND)
			{
   				return 0;
			}
	if (OERROR)
	{ 
		disp_message(ERR_MESG,"Fetch Package service qty Failed");
		proc_exit();
	}
	
nd_pkg_serv_code.arr[nd_pkg_serv_code.len]					= '\0'; 
nd_pkg_serv_dt.arr[nd_pkg_serv_dt.len]						= '\0'; 
nd_mapping_code_ind.arr[nd_mapping_code_ind.len]			= '\0'; 
nd_serv_anal_group.arr[nd_serv_anal_group.len]				= '\0'; 
nd_serv_item_code.arr[nd_serv_item_code.len]				= '\0'; 
nd_serv_item_desc.arr[nd_serv_item_desc.len]				= '\0'; 
nd_payer_serv_group_hdr.arr[nd_payer_serv_group_hdr.len]	= '\0'; 
nd_payer_serv_group_line.arr[nd_payer_serv_group_line.len]	= '\0'; 
nd_prt_group_hdr_code.arr[nd_prt_group_hdr_code.len]		= '\0'; 
nd_prt_group_line_code.arr[nd_prt_group_line_code.len]		= '\0'; 
nd_ent_item_grp_code.arr[nd_ent_item_grp_code.len]			= '\0'; 
nd_payer_item_grp_code.arr[nd_payer_item_grp_code.len]		= '\0'; 
nd_detail_report.arr[nd_detail_report.len]					= '\0'; 
v_package_trx_yn.arr[v_package_trx_yn.len]					= '\0'; 
d_pk_trx_doc_ref.arr[d_pk_trx_doc_ref.len]					= '\0'; 
d_pk_trx_doc_ref_line_num.arr[d_pk_trx_doc_ref_line_num.len] = '\0'; 
d_pk_trx_doc_ref_seq_num.arr[d_pk_trx_doc_ref_seq_num.len]	= '\0'; 


/* EXEC SQL SELECT to_char(nvl(serv_qty,0),'999.99') INTO :nd_serv_qty FROM bl_package_folio 
				where  operating_facility_id = :nd_facility_id
				AND patient_id = :d_patient_id
				AND episode_id = :d_episode_id
				AND package_trx_yn = 'Y'
				AND package_seq_no=:l_pkg_seq_num
				AND trx_doc_ref = :d_pk_trx_doc_ref
                AND trx_doc_ref_line_num = :d_pk_trx_doc_ref_line_num
				//AND trx_doc_ref_seq_num= :d_pk_trx_doc_ref_seq_num;
				AND rownum=1; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 47;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select to_char(nvl(serv_qty,0),'999.99') into :b0  from bl_pa\
ckage_folio where (((((((operating_facility_id=:b1 and patient_id=:b2) and epi\
sode_id=:b3) and package_trx_yn='Y') and package_seq_no=:b4) and trx_doc_ref=:\
b5) and trx_doc_ref_line_num=:b6) and rownum=1)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )1512;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&nd_serv_qty;
sqlstm.sqhstl[0] = (unsigned int  )9;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
sqlstm.sqhstl[2] = (unsigned int  )63;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_id;
sqlstm.sqhstl[3] = (unsigned int  )11;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&l_pkg_seq_num;
sqlstm.sqhstl[4] = (unsigned int  )52;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_pk_trx_doc_ref;
sqlstm.sqhstl[5] = (unsigned int  )63;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_pk_trx_doc_ref_line_num;
sqlstm.sqhstl[6] = (unsigned int  )11;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



nd_serv_qty.arr[nd_serv_qty.len]	= '\0'; 

  
	return 1;
}

     
open_patient_cur()
{	
	/* EXEC SQL OPEN BL_BILL_GRP_HDR_LINE_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlbuft((void **)0, 
   "select trx_doc_ref trxdocref ,trx_doc_ref_line_num trxdocreflinenum ,trx\
_doc_ref_seq_num ,DECODE(PAYER_SERV_GRP_HDR,null ,A.PRT_GRP_HDR_CODE,PAYER_S\
ERV_GRP_HDR) payerservgrphdr ,DECODE(PAYER_SERV_GRP_LINE,null ,A.PRT_GRP_LIN\
E_CODE,PAYER_SERV_GRP_LINE) payerservgrpline ,cust_code custcode ,a.blng_ser\
v_code ,TO_CHAR(a.service_date,'DD/MM/YYYY HH24:MI') ,DECODE(module_id,'PH',\
'M','ST','M','MM','M','S') mapping_code_ind ,(serv_anal_grp1||serv_anal_grp2\
) ,serv_item_code ,DECODE(module_id,'PH',NVL(serv_item_desc_oth_lang,serv_it\
em_desc),'ST',NVL(serv_item_desc_oth_lang,serv_item_desc),'MM',NVL(serv_item\
_desc_oth_lang,serv_item_desc),'X') ,payer_serv_grp_hdr ,payer_serv_grp_line\
 ,PAYER_SERV_GRP_CUST_CODE ,PAYER_SERV_GRP_PAT_CLASS ,a.prt_grp_hdr_code ,a.\
prt_grp_line_code ,bill_doc_type_code ,bill_doc_num ,ent_item_grp_code entit\
emgrpcode ,payer_item_grp_code payeritemgrpcode ,PAYER_ITEM_GRP_CUST_CODE ,P\
AYER_ITEM_GRP_PAT_CLASS ,blcore.get_payer_doc_print_seq(operating_facility_i\
d,episode_type,cust_code,cust_group_code");
 sqlbuft((void **)0, 
   ",payer_serv_grp_hdr,payer_serv_grp_line,a.prt_grp_hdr_code,a.prt_grp_lin\
e_code) print_seq ,substr(DECODE(:b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT\
_IND(OPERATING_FACILITY_ID,CUST_GROUP_CODE,CUST_CODE,BLNG_GRP_ID,EPISODE_TYP\
E,PAYER_SERV_GRP_HDR,PAYER_SERV_GRP_LINE,A.PRT_GRP_HDR_CODE,A.PRT_GRP_LINE_C\
ODE,ENT_ITEM_GRP_CODE,PAYER_ITEM_GRP_CODE),'ESGSGN')),1,3) GRP_IND ,DECODE(:\
b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT_IND(OPERATING_FACILITY_ID,CUST_GR\
OUP_CODE,CUST_CODE,BLNG_GRP_ID,EPISODE_TYPE,PAYER_SERV_GRP_HDR,PAYER_SERV_GR\
P_LINE,A.PRT_GRP_HDR_CODE,A.PRT_GRP_LINE_CODE,ENT_ITEM_GRP_CODE,PAYER_ITEM_G\
RP_CODE),'ESGSGN')) SUMMARY_DTL_IND ,upd_gross_charge_amt ,upd_disc_amt ,upd\
_net_charge_amt ,net_reimbursable_amt ,addl_charge_amt_in_charge ,NVL(packag\
e_trx_yn,'N') ,null  package_seq_no ,(a.base_rate/a.base_qty) rate ,a.serv_q\
ty ,NVL(a.upd_disc_amt,0) charge_discount ,(NVL(a.bill_level_disc_dstrbtn_am\
t,0)+NVL(a.line_level_disc_dstrbtn_amt,0)) bill_discount ,NVL(a.bill_level_p\
ol_adj_dstrbtn_amt,0) fund_adjustment ,(");
 sqlbuft((void **)0, 
   "((NVL(a.upd_disc_amt,0)+NVL(a.bill_level_disc_dstrbtn_amt,0))+NVL(a.line\
_level_disc_dstrbtn_amt,0))+NVL(a.bill_level_pol_adj_dstrbtn_amt,0)) tot_dis\
c ,batch_id ,A.SERVICE_DATE servicedate ,NVL(A.package_trx_yn,'N') package_t\
rx_yn_1 ,PHYSICIAN_ID  from bl_patient_charges_folio a ,bl_blng_serv c where\
 ((((((((((operating_facility_id=:b2 and a.blng_serv_code=c.blng_serv_code) \
and episode_type=:b3) and ((:b3<>'R' and episode_id=:b5) or :b3='R')) and ((\
:b3 in ('O','E') and visit_id=:b8) or :b3 in ('I','D','R'))) and patient_id=\
:b10) and a.episode_id=:b5) and (trx_status is null  or (trx_status='C' and \
(((REV_ADJ_TRX_IND='R' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_RE\
F_LINE_NUM,99999999)) not  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  fro\
m bl_patient_charges_folio where ((OPERATING_FACILITY_ID=:b2 and patient_id=\
:b10) and episode_id=:b5))) or (REV_ADJ_TRX_IND='B' and (nvl(SOURCE_DOC_REF,\
'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) not  in (select TRX_DOC_R\
EF ,TRX_DOC_REF_LINE_NUM  from bl_patien");
 sqlbuft((void **)0, 
   "t_charges_folio where ((OPERATING_FACILITY_ID=:b2 and patient_id=:b10) a\
nd episode_id=:b5)))) or (REV_ADJ_TRX_IND is null  and (TRX_DOC_REF,TRX_DOC_\
REF_LINE_NUM) not  in (select NVL(SOURCE_DOC_REF,'XXXX') ,NVL(SOURCE_DOC_REF\
_LINE_NUM,9999)  from BL_PATIENT_CHARGES_FOLIO where ((OPERATING_FACILITY_ID\
=:b2 and patient_id=:b10) and episode_id=:b5))))))) and exists (select b.trx\
_doc_ref  from bl_patient_charges_folio b where (((((b.operating_facility_id\
=:b2 and b.operating_facility_id=a.operating_facility_id) and b.trx_doc_ref=\
a.trx_doc_ref) and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.epis\
ode_id=:b5) and NVL(a.billed_flag,'N')='N'))) and NVL(a.package_trx_yn,'N')=\
'N') and nvl(a.confirmed_yn,'N')<>'N') union all select trx_doc_ref trxdocre\
f ,trx_doc_ref_line_num trxdocreflinenum ,trx_doc_ref_seq_num ,DECODE(PAYER_\
SERV_GRP_HDR,null ,A.PRT_GRP_HDR_CODE,PAYER_SERV_GRP_HDR) payerservgrphdr ,D\
ECODE(PAYER_SERV_GRP_LINE,null ,A.PRT_GRP_LINE_CODE,PAYER_SERV_GRP_LINE) pay\
erservgrpline ,cust_code custcode ,a.bln");
 sqlbuft((void **)0, 
   "g_serv_code ,TO_CHAR(a.service_date,'DD/MM/YYYY HH24:MI') ,DECODE(module\
_id,'PH','M','ST','M','MM','M','S') mapping_code_ind ,(serv_anal_grp1||serv_\
anal_grp2) ,serv_item_code ,DECODE(module_id,'PH',NVL(serv_item_desc_oth_lan\
g,serv_item_desc),'ST',NVL(serv_item_desc_oth_lang,serv_item_desc),'MM',NVL(\
serv_item_desc_oth_lang,serv_item_desc),'X') ,payer_serv_grp_hdr ,payer_serv\
_grp_line ,PAYER_SERV_GRP_CUST_CODE ,PAYER_SERV_GRP_PAT_CLASS ,a.prt_grp_hdr\
_code ,a.prt_grp_line_code ,bill_doc_type_code ,bill_doc_num ,ent_item_grp_c\
ode entitemgrpcode ,payer_item_grp_code payeritemgrpcode ,PAYER_ITEM_GRP_CUS\
T_CODE ,PAYER_ITEM_GRP_PAT_CLASS ,blcore.get_payer_doc_print_seq(operating_f\
acility_id,episode_type,cust_code,cust_group_code,payer_serv_grp_hdr,payer_s\
erv_grp_line,a.prt_grp_hdr_code,a.prt_grp_line_code) print_seq ,substr(DECOD\
E(:b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT_IND(a.OPERATING_FACILITY_ID,a.\
CUST_GROUP_CODE,a.CUST_CODE,a.BLNG_GRP_ID,a.EPISODE_TYPE,a.PAYER_SERV_GRP_HD\
R,a.PAYER_SERV_GRP_LINE,a.PRT_GRP_HDR_CO");
 sqlbuft((void **)0, 
   "DE,a.PRT_GRP_LINE_CODE,a.ENT_ITEM_GRP_CODE,a.PAYER_ITEM_GRP_CODE),'ESGSG\
N')),1,3) GRP_IND ,DECODE(:b0,'Y','ESGDLS',nvl(BLCORE.GET_BILL_FORMAT_IND(a.\
OPERATING_FACILITY_ID,a.CUST_GROUP_CODE,a.CUST_CODE,a.BLNG_GRP_ID,a.EPISODE_\
TYPE,a.PAYER_SERV_GRP_HDR,a.PAYER_SERV_GRP_LINE,a.PRT_GRP_HDR_CODE,a.PRT_GRP\
_LINE_CODE,a.ENT_ITEM_GRP_CODE,a.PAYER_ITEM_GRP_CODE),'ESGSGN')) SUMMARY_DTL\
_IND ,blpackage.get_serv_tot_gross_amt(a.operating_facility_id,a.trx_doc_ref\
,a.trx_doc_ref_line_num,a.trx_doc_ref_seq_num) upd_gross_charge_amt ,blpacka\
ge.get_serv_tot_disc_amt(a.operating_facility_id,a.trx_doc_ref,a.trx_doc_ref\
_line_num,a.trx_doc_ref_seq_num) upd_disc_amt ,blpackage.get_serv_tot_net_am\
t(a.operating_facility_id,a.trx_doc_ref,a.trx_doc_ref_line_num,a.trx_doc_ref\
_seq_num) upd_net_charge_amt ,net_reimbursable_amt ,BL_GET_TAX_AMOUNT(a.oper\
ating_facility_id,a.TRX_DOC_REF,a.TRX_DOC_REF_LINE_NUM,a.TRX_DOC_REF_SEQ_NUM\
,null ,null ,'Y','N',null ) addl_charge_amt_in_charge ,'N' package_trx_yn ,n\
ull  package_seq_no ,(a.base_rate/a.base");
 sqlbuft((void **)0, 
   "_qty) rate ,a.serv_qty ,NVL(a.upd_disc_amt,0) charge_discount ,(NVL(a.bi\
ll_level_disc_dstrbtn_amt,0)+NVL(a.line_level_disc_dstrbtn_amt,0)) bill_disc\
ount ,NVL(a.bill_level_pol_adj_dstrbtn_amt,0) fund_adjustment ,(((NVL(a.upd_\
disc_amt,0)+NVL(a.bill_level_disc_dstrbtn_amt,0))+NVL(a.line_level_disc_dstr\
btn_amt,0))+NVL(a.bill_level_pol_adj_dstrbtn_amt,0)) tot_disc ,batch_id ,A.S\
ERVICE_DATE servicedate ,NVL(A.package_trx_yn,'N') package_trx_yn_1 ,PHYSICI\
AN_ID  from bl_patient_charges_folio a ,bl_blng_serv c where (((((((((((oper\
ating_facility_id=:b2 and a.blng_serv_code=c.blng_serv_code) and episode_typ\
e=:b3) and ((:b3<>'R' and episode_id=:b5) or :b3='R')) and ((:b3 in ('O','E'\
) and visit_id=:b8) or :b3 in ('I','D','R'))) and patient_id=:b10) and a.epi\
sode_id=:b5) and (trx_status is null  or (trx_status='C' and (((REV_ADJ_TRX_\
IND='R' and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,9999\
9999)) not  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_ch\
arges_folio where ((OPERATING_FACILITY_I");
 sqlbuft((void **)0, 
   "D=:b2 and patient_id=:b10) and episode_id=:b5))) or (REV_ADJ_TRX_IND='B'\
 and (nvl(SOURCE_DOC_REF,'XXXXXXXX'),NVL(SOURCE_DOC_REF_LINE_NUM,99999999)) \
not  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_charges_f\
olio where ((OPERATING_FACILITY_ID=:b2 and patient_id=:b10) and episode_id=:\
b5)))) or (REV_ADJ_TRX_IND is null  and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) n\
ot  in (select NVL(SOURCE_DOC_REF,'XXXX') ,NVL(SOURCE_DOC_REF_LINE_NUM,9999)\
  from BL_PATIENT_CHARGES_FOLIO where ((OPERATING_FACILITY_ID=:b2 and patien\
t_id=:b10) and episode_id=:b5))))))) and exists (select b.trx_doc_ref  from \
bl_patient_charges_folio b where (((((b.operating_facility_id=:b2 and b.oper\
ating_facility_id=a.operating_facility_id) and b.trx_doc_ref=a.trx_doc_ref) \
and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.episode_id=:b5) and\
 NVL(a.billed_flag,'N')='N'))) and exists (select 1  from bl_package_folio b\
 where (((((b.operating_facility_id=:b2 and b.operating_facility_id=a.operat\
ing_facility_id) and b.trx_doc_ref=a.trx");
 sqlstm.stmt = sq0016;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1555;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )5;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[4] = (unsigned int  )4;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[5] = (unsigned int  )11;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[6] = (unsigned int  )4;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[7] = (unsigned int  )4;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[8] = (unsigned int  )7;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[9] = (unsigned int  )4;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[10] = (unsigned int  )63;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[11] = (unsigned int  )11;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[12] = (unsigned int  )5;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[13] = (unsigned int  )63;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[14] = (unsigned int  )11;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[15] = (unsigned int  )5;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[16] = (unsigned int  )63;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[17] = (unsigned int  )11;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[18] = (unsigned int  )5;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[19] = (unsigned int  )63;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[20] = (unsigned int  )11;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[21] = (unsigned int  )5;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[22] = (unsigned int  )11;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[23] = (unsigned int  )5;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&v_detail_report;
 sqlstm.sqhstl[24] = (unsigned int  )5;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[25] = (unsigned int  )5;
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[26] = (unsigned int  )4;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[27] = (unsigned int  )4;
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqhstv[28] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[28] = (unsigned int  )11;
 sqlstm.sqhsts[28] = (         int  )0;
 sqlstm.sqindv[28] = (         void  *)0;
 sqlstm.sqinds[28] = (         int  )0;
 sqlstm.sqharm[28] = (unsigned int  )0;
 sqlstm.sqadto[28] = (unsigned short )0;
 sqlstm.sqtdso[28] = (unsigned short )0;
 sqlstm.sqhstv[29] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[29] = (unsigned int  )4;
 sqlstm.sqhsts[29] = (         int  )0;
 sqlstm.sqindv[29] = (         void  *)0;
 sqlstm.sqinds[29] = (         int  )0;
 sqlstm.sqharm[29] = (unsigned int  )0;
 sqlstm.sqadto[29] = (unsigned short )0;
 sqlstm.sqtdso[29] = (unsigned short )0;
 sqlstm.sqhstv[30] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[30] = (unsigned int  )4;
 sqlstm.sqhsts[30] = (         int  )0;
 sqlstm.sqindv[30] = (         void  *)0;
 sqlstm.sqinds[30] = (         int  )0;
 sqlstm.sqharm[30] = (unsigned int  )0;
 sqlstm.sqadto[30] = (unsigned short )0;
 sqlstm.sqtdso[30] = (unsigned short )0;
 sqlstm.sqhstv[31] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[31] = (unsigned int  )7;
 sqlstm.sqhsts[31] = (         int  )0;
 sqlstm.sqindv[31] = (         void  *)0;
 sqlstm.sqinds[31] = (         int  )0;
 sqlstm.sqharm[31] = (unsigned int  )0;
 sqlstm.sqadto[31] = (unsigned short )0;
 sqlstm.sqtdso[31] = (unsigned short )0;
 sqlstm.sqhstv[32] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[32] = (unsigned int  )4;
 sqlstm.sqhsts[32] = (         int  )0;
 sqlstm.sqindv[32] = (         void  *)0;
 sqlstm.sqinds[32] = (         int  )0;
 sqlstm.sqharm[32] = (unsigned int  )0;
 sqlstm.sqadto[32] = (unsigned short )0;
 sqlstm.sqtdso[32] = (unsigned short )0;
 sqlstm.sqhstv[33] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[33] = (unsigned int  )63;
 sqlstm.sqhsts[33] = (         int  )0;
 sqlstm.sqindv[33] = (         void  *)0;
 sqlstm.sqinds[33] = (         int  )0;
 sqlstm.sqharm[33] = (unsigned int  )0;
 sqlstm.sqadto[33] = (unsigned short )0;
 sqlstm.sqtdso[33] = (unsigned short )0;
 sqlstm.sqhstv[34] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[34] = (unsigned int  )11;
 sqlstm.sqhsts[34] = (         int  )0;
 sqlstm.sqindv[34] = (         void  *)0;
 sqlstm.sqinds[34] = (         int  )0;
 sqlstm.sqharm[34] = (unsigned int  )0;
 sqlstm.sqadto[34] = (unsigned short )0;
 sqlstm.sqtdso[34] = (unsigned short )0;
 sqlstm.sqhstv[35] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[35] = (unsigned int  )5;
 sqlstm.sqhsts[35] = (         int  )0;
 sqlstm.sqindv[35] = (         void  *)0;
 sqlstm.sqinds[35] = (         int  )0;
 sqlstm.sqharm[35] = (unsigned int  )0;
 sqlstm.sqadto[35] = (unsigned short )0;
 sqlstm.sqtdso[35] = (unsigned short )0;
 sqlstm.sqhstv[36] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[36] = (unsigned int  )63;
 sqlstm.sqhsts[36] = (         int  )0;
 sqlstm.sqindv[36] = (         void  *)0;
 sqlstm.sqinds[36] = (         int  )0;
 sqlstm.sqharm[36] = (unsigned int  )0;
 sqlstm.sqadto[36] = (unsigned short )0;
 sqlstm.sqtdso[36] = (unsigned short )0;
 sqlstm.sqhstv[37] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[37] = (unsigned int  )11;
 sqlstm.sqhsts[37] = (         int  )0;
 sqlstm.sqindv[37] = (         void  *)0;
 sqlstm.sqinds[37] = (         int  )0;
 sqlstm.sqharm[37] = (unsigned int  )0;
 sqlstm.sqadto[37] = (unsigned short )0;
 sqlstm.sqtdso[37] = (unsigned short )0;
 sqlstm.sqhstv[38] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[38] = (unsigned int  )5;
 sqlstm.sqhsts[38] = (         int  )0;
 sqlstm.sqindv[38] = (         void  *)0;
 sqlstm.sqinds[38] = (         int  )0;
 sqlstm.sqharm[38] = (unsigned int  )0;
 sqlstm.sqadto[38] = (unsigned short )0;
 sqlstm.sqtdso[38] = (unsigned short )0;
 sqlstm.sqhstv[39] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[39] = (unsigned int  )63;
 sqlstm.sqhsts[39] = (         int  )0;
 sqlstm.sqindv[39] = (         void  *)0;
 sqlstm.sqinds[39] = (         int  )0;
 sqlstm.sqharm[39] = (unsigned int  )0;
 sqlstm.sqadto[39] = (unsigned short )0;
 sqlstm.sqtdso[39] = (unsigned short )0;
 sqlstm.sqhstv[40] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[40] = (unsigned int  )11;
 sqlstm.sqhsts[40] = (         int  )0;
 sqlstm.sqindv[40] = (         void  *)0;
 sqlstm.sqinds[40] = (         int  )0;
 sqlstm.sqharm[40] = (unsigned int  )0;
 sqlstm.sqadto[40] = (unsigned short )0;
 sqlstm.sqtdso[40] = (unsigned short )0;
 sqlstm.sqhstv[41] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[41] = (unsigned int  )5;
 sqlstm.sqhsts[41] = (         int  )0;
 sqlstm.sqindv[41] = (         void  *)0;
 sqlstm.sqinds[41] = (         int  )0;
 sqlstm.sqharm[41] = (unsigned int  )0;
 sqlstm.sqadto[41] = (unsigned short )0;
 sqlstm.sqtdso[41] = (unsigned short )0;
 sqlstm.sqhstv[42] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[42] = (unsigned int  )63;
 sqlstm.sqhsts[42] = (         int  )0;
 sqlstm.sqindv[42] = (         void  *)0;
 sqlstm.sqinds[42] = (         int  )0;
 sqlstm.sqharm[42] = (unsigned int  )0;
 sqlstm.sqadto[42] = (unsigned short )0;
 sqlstm.sqtdso[42] = (unsigned short )0;
 sqlstm.sqhstv[43] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[43] = (unsigned int  )11;
 sqlstm.sqhsts[43] = (         int  )0;
 sqlstm.sqindv[43] = (         void  *)0;
 sqlstm.sqinds[43] = (         int  )0;
 sqlstm.sqharm[43] = (unsigned int  )0;
 sqlstm.sqadto[43] = (unsigned short )0;
 sqlstm.sqtdso[43] = (unsigned short )0;
 sqlstm.sqhstv[44] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[44] = (unsigned int  )5;
 sqlstm.sqhsts[44] = (         int  )0;
 sqlstm.sqindv[44] = (         void  *)0;
 sqlstm.sqinds[44] = (         int  )0;
 sqlstm.sqharm[44] = (unsigned int  )0;
 sqlstm.sqadto[44] = (unsigned short )0;
 sqlstm.sqtdso[44] = (unsigned short )0;
 sqlstm.sqhstv[45] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[45] = (unsigned int  )11;
 sqlstm.sqhsts[45] = (         int  )0;
 sqlstm.sqindv[45] = (         void  *)0;
 sqlstm.sqinds[45] = (         int  )0;
 sqlstm.sqharm[45] = (unsigned int  )0;
 sqlstm.sqadto[45] = (unsigned short )0;
 sqlstm.sqtdso[45] = (unsigned short )0;
 sqlstm.sqhstv[46] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[46] = (unsigned int  )5;
 sqlstm.sqhsts[46] = (         int  )0;
 sqlstm.sqindv[46] = (         void  *)0;
 sqlstm.sqinds[46] = (         int  )0;
 sqlstm.sqharm[46] = (unsigned int  )0;
 sqlstm.sqadto[46] = (unsigned short )0;
 sqlstm.sqtdso[46] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Open Cursor Group Header Failed");
		proc_exit();
	}
	return;
}


close_patient_cur()
{ 
	/* EXEC SQL CLOSE BL_BILL_GRP_HDR_LINE_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1758;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
		disp_message (ERR_MESG,"Close BL_BILL_GRP_HDR_LINE_CUR failed");
		proc_exit();
	}
	return;
}

fetch_patient_cur()
{
	d1_trx_doc_ref.arr[0]			= '\0';
	d1_trx_doc_ref_line_num.arr[0]	= '\0';
	d1_trx_doc_ref_seq_num.arr[0]	= '\0';
	d1_cust_code1.arr[0]			= '\0';
	d1_blng_serv_code.arr[0]		= '\0';
	nd_service_date.arr[0]			= '\0';
	d1_mapping_code_ind.arr[0]		= '\0';
	d1_serv_anal_grp.arr[0]			= '\0';
	d1_serv_item_code.arr[0]		= '\0';
	d1_serv_item_desc.arr[0]		= '\0';
	d1_payer_serv_grp_hdr.arr[0]	= '\0';
	d1_payer_serv_grp_line.arr[0]	= '\0';
	d1_prt_grp_hdr_code.arr[0]		= '\0';
	d1_prt_grp_line_code.arr[0]		= '\0';
	d1_bill_doc_type_code.arr[0]	= '\0';
	d1_bill_doc_num.arr[0]			= '\0';
	d1_ent_item_grp_code.arr[0]		= '\0';
	d1_payer_item_grp_code.arr[0]	= '\0';
	d1_summary_dtl_ind.arr[0]		= '\0';
	d1_package_trx_yn.arr[0]		= '\0';
	d1_folio_batch_id.arr[0]		= '\0';
	d1_last_col_trx_yn.arr[0]		= '\0';
	dc1_physician_name.arr[0]		= '\0';
	dc1_physician_id.arr[0]	    	= '\0';
	
	/***added for merging walkthrough corrections***/
	d1_grp_ind.arr[0]				= '\0';
	d1_payer_serv_grp_cust_code.arr[0] ='\0';
	d1_payer_serv_grp_pat_class.arr[0]='\0';
	d1_payer_item_grp_cust_code.arr[0]='\0';
	d1_payer_item_grp_pat_class.arr[0]='\0';
	/***upto here***/


	d1_payer_serv_group_hdr.arr[0]	= '\0';
	d1_payer_serv_group_line.arr[0]	= '\0'; 
	d1_service_dt.arr[0]		    = '\0';


	d1_trx_doc_ref.len			= 0;
	d1_trx_doc_ref_line_num.len = 0;
	d1_trx_doc_ref_seq_num.len	= 0;
	d1_cust_code1.len			= 0;
	d1_blng_serv_code.len		= 0;
	nd_service_date.len				= 0;
	d1_mapping_code_ind.len		= 0;
	d1_serv_anal_grp.len		= 0;
	d1_serv_item_code.len		= 0; 
	d1_serv_item_desc.len		= 0;
	d1_payer_serv_grp_hdr.len	= 0;
	d1_payer_serv_grp_line.len	= 0;
	d1_prt_grp_hdr_code.len		= 0;
	d1_prt_grp_line_code.len	= 0;
	d1_bill_doc_type_code.len	= 0;
	d1_bill_doc_num.len			= 0;
	d1_ent_item_grp_code.len	= 0;
	d1_payer_item_grp_code.len	= 0;
	d1_summary_dtl_ind.len		= 0;
	d1_package_trx_yn.len		= 0;
	d1_folio_batch_id.len		= 0;
	d1_last_col_trx_yn.len		= 0;
	dc1_physician_id.len		= 0;
	dc1_physician_name.len		= 0;
	d1_payer_serv_group_hdr.len	 = 0;
	d1_payer_serv_group_line.len = 0; 
	d1_service_dt.len		     = 0;
	
	/***added for merging walkthrough corrections***/
	d1_grp_ind.len				= 0;
	d1_payer_serv_grp_cust_code.len=0;
	d1_payer_serv_grp_pat_class.len=0;
	d1_payer_item_grp_cust_code.len=0;
	d1_payer_item_grp_pat_class.len=0;
	/***upto here***/

//The below code added By Rajesh
	d1_upd_gross_charge_amt		= 0;
	d1_upd_disc_amt				= 0;
	d1_upd_net_charge_amt		= 0;
	d_net_reimbursable_amt		= 0;
	d1_addl_charge_amt_in_charge = 0;
// upto here

	/* EXEC SQL FETCH BL_BILL_GRP_HDR_LINE_CUR INTO	
		:d1_trx_doc_ref,
		:d1_trx_doc_ref_line_num,
		:d1_trx_doc_ref_seq_num,
		:d1_payer_serv_group_hdr,
		:d1_payer_serv_group_line,
		:d1_cust_code1,
		:d1_blng_serv_code,
		:nd_service_date,
		:d1_mapping_code_ind,
		:d1_serv_anal_grp,
		:d1_serv_item_code,
		:d1_serv_item_desc,
		:d1_payer_serv_grp_hdr,
		:d1_payer_serv_grp_line,
		:d1_payer_serv_grp_cust_code,
		:d1_payer_serv_grp_pat_class,
		:d1_prt_grp_hdr_code,
		:d1_prt_grp_line_code,
		:d1_bill_doc_type_code,
		:d1_bill_doc_num,
		:d1_ent_item_grp_code,
		:d1_payer_item_grp_code,
		:d1_payer_item_grp_cust_code,
		:d1_payer_item_grp_pat_class,
		:d1_print_seq,
		:d1_grp_ind,
		:d1_summary_dtl_ind,
		:d1_upd_gross_charge_amt,
		:d1_upd_disc_amt,
		:d1_upd_net_charge_amt,
		:d_net_reimbursable_amt,
		:d1_addl_charge_amt_in_charge,
		:d1_package_trx_yn,
		:d1_package_seq_no,
		:d1_rate,
		:d1_serv_qty,
		:d1_charge_discount,
		:d1_bill_discount,
		:d1_fund_adjustment,
		:d1_tot_disc,
		:d1_folio_batch_id,
		:d1_service_dt,
		:d1_last_col_trx_yn,
		:dc1_physician_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1773;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d1_trx_doc_ref;
 sqlstm.sqhstl[0] = (unsigned int  )63;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d1_trx_doc_ref_line_num;
 sqlstm.sqhstl[1] = (unsigned int  )11;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d1_trx_doc_ref_seq_num;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d1_payer_serv_group_hdr;
 sqlstm.sqhstl[3] = (unsigned int  )32;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d1_payer_serv_group_line;
 sqlstm.sqhstl[4] = (unsigned int  )32;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d1_cust_code1;
 sqlstm.sqhstl[5] = (unsigned int  )27;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d1_blng_serv_code;
 sqlstm.sqhstl[6] = (unsigned int  )33;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&nd_service_date;
 sqlstm.sqhstl[7] = (unsigned int  )22;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d1_mapping_code_ind;
 sqlstm.sqhstl[8] = (unsigned int  )5;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d1_serv_anal_grp;
 sqlstm.sqhstl[9] = (unsigned int  )33;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d1_serv_item_code;
 sqlstm.sqhstl[10] = (unsigned int  )63;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&d1_serv_item_desc;
 sqlstm.sqhstl[11] = (unsigned int  )63;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&d1_payer_serv_grp_hdr;
 sqlstm.sqhstl[12] = (unsigned int  )9;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d1_payer_serv_grp_line;
 sqlstm.sqhstl[13] = (unsigned int  )9;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&d1_payer_serv_grp_cust_code;
 sqlstm.sqhstl[14] = (unsigned int  )12;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&d1_payer_serv_grp_pat_class;
 sqlstm.sqhstl[15] = (unsigned int  )7;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d1_prt_grp_hdr_code;
 sqlstm.sqhstl[16] = (unsigned int  )9;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d1_prt_grp_line_code;
 sqlstm.sqhstl[17] = (unsigned int  )9;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&d1_bill_doc_type_code;
 sqlstm.sqhstl[18] = (unsigned int  )20;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&d1_bill_doc_num;
 sqlstm.sqhstl[19] = (unsigned int  )11;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&d1_ent_item_grp_code;
 sqlstm.sqhstl[20] = (unsigned int  )15;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&d1_payer_item_grp_code;
 sqlstm.sqhstl[21] = (unsigned int  )9;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&d1_payer_item_grp_cust_code;
 sqlstm.sqhstl[22] = (unsigned int  )12;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&d1_payer_item_grp_pat_class;
 sqlstm.sqhstl[23] = (unsigned int  )7;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&d1_print_seq;
 sqlstm.sqhstl[24] = (unsigned int  )7;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&d1_grp_ind;
 sqlstm.sqhstl[25] = (unsigned int  )6;
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&d1_summary_dtl_ind;
 sqlstm.sqhstl[26] = (unsigned int  )9;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&d1_upd_gross_charge_amt;
 sqlstm.sqhstl[27] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqhstv[28] = (         void  *)&d1_upd_disc_amt;
 sqlstm.sqhstl[28] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[28] = (         int  )0;
 sqlstm.sqindv[28] = (         void  *)0;
 sqlstm.sqinds[28] = (         int  )0;
 sqlstm.sqharm[28] = (unsigned int  )0;
 sqlstm.sqadto[28] = (unsigned short )0;
 sqlstm.sqtdso[28] = (unsigned short )0;
 sqlstm.sqhstv[29] = (         void  *)&d1_upd_net_charge_amt;
 sqlstm.sqhstl[29] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[29] = (         int  )0;
 sqlstm.sqindv[29] = (         void  *)0;
 sqlstm.sqinds[29] = (         int  )0;
 sqlstm.sqharm[29] = (unsigned int  )0;
 sqlstm.sqadto[29] = (unsigned short )0;
 sqlstm.sqtdso[29] = (unsigned short )0;
 sqlstm.sqhstv[30] = (         void  *)&d_net_reimbursable_amt;
 sqlstm.sqhstl[30] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[30] = (         int  )0;
 sqlstm.sqindv[30] = (         void  *)0;
 sqlstm.sqinds[30] = (         int  )0;
 sqlstm.sqharm[30] = (unsigned int  )0;
 sqlstm.sqadto[30] = (unsigned short )0;
 sqlstm.sqtdso[30] = (unsigned short )0;
 sqlstm.sqhstv[31] = (         void  *)&d1_addl_charge_amt_in_charge;
 sqlstm.sqhstl[31] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[31] = (         int  )0;
 sqlstm.sqindv[31] = (         void  *)0;
 sqlstm.sqinds[31] = (         int  )0;
 sqlstm.sqharm[31] = (unsigned int  )0;
 sqlstm.sqadto[31] = (unsigned short )0;
 sqlstm.sqtdso[31] = (unsigned short )0;
 sqlstm.sqhstv[32] = (         void  *)&d1_package_trx_yn;
 sqlstm.sqhstl[32] = (unsigned int  )4;
 sqlstm.sqhsts[32] = (         int  )0;
 sqlstm.sqindv[32] = (         void  *)0;
 sqlstm.sqinds[32] = (         int  )0;
 sqlstm.sqharm[32] = (unsigned int  )0;
 sqlstm.sqadto[32] = (unsigned short )0;
 sqlstm.sqtdso[32] = (unsigned short )0;
 sqlstm.sqhstv[33] = (         void  *)&d1_package_seq_no;
 sqlstm.sqhstl[33] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[33] = (         int  )0;
 sqlstm.sqindv[33] = (         void  *)0;
 sqlstm.sqinds[33] = (         int  )0;
 sqlstm.sqharm[33] = (unsigned int  )0;
 sqlstm.sqadto[33] = (unsigned short )0;
 sqlstm.sqtdso[33] = (unsigned short )0;
 sqlstm.sqhstv[34] = (         void  *)&d1_rate;
 sqlstm.sqhstl[34] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[34] = (         int  )0;
 sqlstm.sqindv[34] = (         void  *)0;
 sqlstm.sqinds[34] = (         int  )0;
 sqlstm.sqharm[34] = (unsigned int  )0;
 sqlstm.sqadto[34] = (unsigned short )0;
 sqlstm.sqtdso[34] = (unsigned short )0;
 sqlstm.sqhstv[35] = (         void  *)&d1_serv_qty;
 sqlstm.sqhstl[35] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[35] = (         int  )0;
 sqlstm.sqindv[35] = (         void  *)0;
 sqlstm.sqinds[35] = (         int  )0;
 sqlstm.sqharm[35] = (unsigned int  )0;
 sqlstm.sqadto[35] = (unsigned short )0;
 sqlstm.sqtdso[35] = (unsigned short )0;
 sqlstm.sqhstv[36] = (         void  *)&d1_charge_discount;
 sqlstm.sqhstl[36] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[36] = (         int  )0;
 sqlstm.sqindv[36] = (         void  *)0;
 sqlstm.sqinds[36] = (         int  )0;
 sqlstm.sqharm[36] = (unsigned int  )0;
 sqlstm.sqadto[36] = (unsigned short )0;
 sqlstm.sqtdso[36] = (unsigned short )0;
 sqlstm.sqhstv[37] = (         void  *)&d1_bill_discount;
 sqlstm.sqhstl[37] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[37] = (         int  )0;
 sqlstm.sqindv[37] = (         void  *)0;
 sqlstm.sqinds[37] = (         int  )0;
 sqlstm.sqharm[37] = (unsigned int  )0;
 sqlstm.sqadto[37] = (unsigned short )0;
 sqlstm.sqtdso[37] = (unsigned short )0;
 sqlstm.sqhstv[38] = (         void  *)&d1_fund_adjustment;
 sqlstm.sqhstl[38] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[38] = (         int  )0;
 sqlstm.sqindv[38] = (         void  *)0;
 sqlstm.sqinds[38] = (         int  )0;
 sqlstm.sqharm[38] = (unsigned int  )0;
 sqlstm.sqadto[38] = (unsigned short )0;
 sqlstm.sqtdso[38] = (unsigned short )0;
 sqlstm.sqhstv[39] = (         void  *)&d1_tot_disc;
 sqlstm.sqhstl[39] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[39] = (         int  )0;
 sqlstm.sqindv[39] = (         void  *)0;
 sqlstm.sqinds[39] = (         int  )0;
 sqlstm.sqharm[39] = (unsigned int  )0;
 sqlstm.sqadto[39] = (unsigned short )0;
 sqlstm.sqtdso[39] = (unsigned short )0;
 sqlstm.sqhstv[40] = (         void  *)&d1_folio_batch_id;
 sqlstm.sqhstl[40] = (unsigned int  )102;
 sqlstm.sqhsts[40] = (         int  )0;
 sqlstm.sqindv[40] = (         void  *)0;
 sqlstm.sqinds[40] = (         int  )0;
 sqlstm.sqharm[40] = (unsigned int  )0;
 sqlstm.sqadto[40] = (unsigned short )0;
 sqlstm.sqtdso[40] = (unsigned short )0;
 sqlstm.sqhstv[41] = (         void  *)&d1_service_dt;
 sqlstm.sqhstl[41] = (unsigned int  )32;
 sqlstm.sqhsts[41] = (         int  )0;
 sqlstm.sqindv[41] = (         void  *)0;
 sqlstm.sqinds[41] = (         int  )0;
 sqlstm.sqharm[41] = (unsigned int  )0;
 sqlstm.sqadto[41] = (unsigned short )0;
 sqlstm.sqtdso[41] = (unsigned short )0;
 sqlstm.sqhstv[42] = (         void  *)&d1_last_col_trx_yn;
 sqlstm.sqhstl[42] = (unsigned int  )22;
 sqlstm.sqhsts[42] = (         int  )0;
 sqlstm.sqindv[42] = (         void  *)0;
 sqlstm.sqinds[42] = (         int  )0;
 sqlstm.sqharm[42] = (unsigned int  )0;
 sqlstm.sqadto[42] = (unsigned short )0;
 sqlstm.sqtdso[42] = (unsigned short )0;
 sqlstm.sqhstv[43] = (         void  *)&dc1_physician_id;
 sqlstm.sqhstl[43] = (unsigned int  )18;
 sqlstm.sqhsts[43] = (         int  )0;
 sqlstm.sqindv[43] = (         void  *)0;
 sqlstm.sqinds[43] = (         int  )0;
 sqlstm.sqharm[43] = (unsigned int  )0;
 sqlstm.sqadto[43] = (unsigned short )0;
 sqlstm.sqtdso[43] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
  
	
	if (OERROR)
	{ 
		disp_message(ERR_MESG,"Fetch Group Header Cursor Failed");
		proc_exit();
	}

    if(NODATAFOUND)
	{
   				
		return 0;
	}


	/** added by raghava 30/07/2010 **/
   if(strcmp(d1_summary_dtl_ind.arr,"ESLSGN")==0)
   strcpy(d1_summary_dtl_ind.arr,"ESLSLN");
   if(strcmp(d1_summary_dtl_ind.arr,"PSLSGN")==0)
   strcpy(d1_summary_dtl_ind.arr,"PSLSLN");
  /** upto 30/07/2010 **/

  /** Added for medicity issue On 28/09/2010 by raghav from BKK**/
   if(strcmp(d1_grp_ind.arr,"ESG")==0)
   {
    if (d1_summary_dtl_ind.arr[3] == 'S' && d1_summary_dtl_ind.arr[4] == 'L')
	strcpy(d1_grp_ind.arr,"ESL");
   }
   
   if(strcmp(d1_grp_ind.arr,"PSG")==0)
   {
    if (d1_summary_dtl_ind.arr[3] == 'S' && d1_summary_dtl_ind.arr[4] == 'L')
	strcpy(d1_grp_ind.arr,"PSL");
   }
  /** upto here **/

	d1_trx_doc_ref.arr[d1_trx_doc_ref.len]					= '\0';
	d1_trx_doc_ref_line_num.arr[d1_trx_doc_ref_line_num.len]= '\0';
	d1_trx_doc_ref_seq_num.arr[d1_trx_doc_ref_seq_num.len]	= '\0';
	d1_cust_code1.arr[d1_cust_code1.len]					= '\0';
	d1_blng_serv_code.arr[d1_blng_serv_code.len]			= '\0';
	d1_mapping_code_ind.arr[d1_mapping_code_ind.len]		= '\0';
	d1_serv_anal_grp.arr[d1_serv_anal_grp.len]				= '\0';
	d1_serv_item_code.arr[d1_serv_item_code.len]			= '\0';
	d1_serv_item_desc.arr[d1_serv_item_desc.len]			= '\0';
	d1_payer_serv_grp_hdr.arr[d1_payer_serv_grp_hdr.len]	= '\0';
	d1_payer_serv_grp_line.arr[d1_payer_serv_grp_line.len]	= '\0';
	d1_prt_grp_hdr_code.arr[d1_prt_grp_hdr_code.len]		= '\0';
	d1_prt_grp_line_code.arr[d1_prt_grp_line_code.len]		= '\0';
	d1_bill_doc_type_code.arr[d1_bill_doc_type_code.len]	= '\0';
	d1_bill_doc_num.arr[d1_bill_doc_num.len]				= '\0';
	d1_ent_item_grp_code.arr[d1_ent_item_grp_code.len]		= '\0';
	d1_payer_item_grp_code.arr[d1_payer_item_grp_code.len]	= '\0';
    d1_summary_dtl_ind.arr[d1_summary_dtl_ind.len]			= '\0';
	d1_package_trx_yn.arr[d1_package_trx_yn.len]			= '\0';
	d1_folio_batch_id.arr[d1_folio_batch_id.len]			= '\0';
	d1_last_col_trx_yn.arr[d1_last_col_trx_yn.len]			= '\0';
	dc1_physician_id.arr[dc1_physician_id.len]				= '\0';
	d1_payer_serv_group_hdr.arr[d1_payer_serv_group_hdr.len]	= '\0';
	d1_payer_serv_group_line.arr[d1_payer_serv_group_line.len]	= '\0'; 
	d1_service_dt.arr[d1_service_dt.len]						= '\0';



if (strcmp(c_print_serv_date_with_time_yn.arr,"N")==0)
{	
	
	/* EXEC SQL  select to_char(to_date(:nd_service_date,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY')
							into  :nd_service_date1 from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select to_char(to_date(:b0,'DD/MM/YYYY HH24:MI'),'DD/MM/YYYY\
') into :b1  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1964;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_service_date;
 sqlstm.sqhstl[0] = (unsigned int  )22;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_service_date1;
 sqlstm.sqhstl[1] = (unsigned int  )22;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
    strcpy(nd_service_date.arr,nd_service_date1.arr);

	if(nd_service_date.arr[0]!='\0')
				{
				  init_date_temp_var();
				  strcpy(date_convert.arr,nd_service_date.arr);
				  fun_change_loc_date();
				  strcpy(nd_service_date.arr,nd_loc_date1.arr);
							  
				 }

	
}
else
{
	
	if(nd_service_date.arr[0]!='\0')
				{
				  init_date_temp_var();
				  strcpy(date_convert.arr,nd_service_date.arr);
				  fun_change_loc_date1();
				  strcpy(nd_service_date.arr,date_convert.arr);
				 				
				 }

}


	/* EXEC SQL select FULL_NAME into :dc1_physician_name
			 from sy_physician_mast_lang_vw
			where PHYSICIAN_ID=:dc1_physician_id
			and facility_id=:nd_facility_id
			and language_id=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select FULL_NAME into :b0  from sy_physician_mast_lang_vw wh\
ere ((PHYSICIAN_ID=:b1 and facility_id=:b2) and language_id=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )1987;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&dc1_physician_name;
 sqlstm.sqhstl[0] = (unsigned int  )102;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&dc1_physician_id;
 sqlstm.sqhstl[1] = (unsigned int  )18;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )5;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	dc1_physician_name.arr[dc1_physician_name.len]	= '\0';



  	return 1;
}

get_adm_rec_flag()
{


  d_adm_rec_flag.arr[d_adm_rec_flag.len]='\0';
  d_adm_rec_flag.len=0;


 /* EXEC SQL Select b.ADM_REC_FLAG  
		INTO :d_adm_rec_flag  
		from BL_ENCOUNTER_PAYER_PRIORITY a,bl_blng_grp b
		where OPERATING_FACILITY_ID =:nd_facility_id
		and a.patient_id =:d_patient_id
		and a.EPISODE_TYPE = :d_episode_type
		and ((:d_episode_type in ('O','E','I','D') and EPISODE_ID   =:d_episode_id) or :d_episode_type ='R')
		and ((:d_episode_type in ('O','E') and VISIT_ID =:d_visit_id ) or (:d_episode_type in ('R','I','D')))
		and a.ACCT_SEQ_NO  = :d_acct_seq_no
		and priority	 = 1
		and a.blng_grp_id = b.blng_grp_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select b.ADM_REC_FLAG into :b0  from BL_ENCOUNTER_PAYER_PRIO\
RITY a ,bl_blng_grp b where (((((((OPERATING_FACILITY_ID=:b1 and a.patient_id=\
:b2) and a.EPISODE_TYPE=:b3) and ((:b3 in ('O','E','I','D') and EPISODE_ID=:b5\
) or :b3='R')) and ((:b3 in ('O','E') and VISIT_ID=:b8) or :b3 in ('R','I','D'\
))) and a.ACCT_SEQ_NO=:b10) and priority=1) and a.blng_grp_id=b.blng_grp_id)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2018;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_adm_rec_flag;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[2] = (unsigned int  )63;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[4] = (unsigned int  )4;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[5] = (unsigned int  )11;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[6] = (unsigned int  )4;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[7] = (unsigned int  )4;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[8] = (unsigned int  )7;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[9] = (unsigned int  )4;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d_acct_seq_no;
 sqlstm.sqhstl[10] = (unsigned int  )6;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR) 
	{	
	  disp_message (ERR_MESG,"Failed to Declare Group Header Cursor");
	}
     d_adm_rec_flag.arr[d_adm_rec_flag.len]='\0';

}
/* Intialize the all the variables*/
init_all_variables()
{
	nd_oth_payer_amt=0;
	nd_gross_total =0; 
	p_tot_pat_net_amt=0;
	p_tot_pat_gross_amt=0;
	nd_gnd_tot_net_reimbursable_amt=0;
	nd_tot_pat_net_charge_amt=0;
	nd_rounded_amt=0;
	nd_net_pay_amt_after_rounded=0;
	nd_tot_pat_disc_amt=0;
	nd_gnd_tot_net_non_reimbursable_amt=0;
	nd_pat_net_amt=0;
	nd_tot_pat_disc_amt=0;
	nd_pat_gross_amt=0;
	nd_pat_net_amt1=0;
	nd_pat_disc_amt=0;
	nd_pat_gross_amt1=0;
	nd_pat_net_amt2=0;
	nd_pat_disc_amt1=0;
	nd_tot_net_reimbursable_amt=0;
	nd_tot_non_reimbursable_amt=0;
	nd_pat_net_charge_amt=0;
	nd_pat_addl_charge_amt=0;
	nd_pat_tot_addl_charge_amt=0;
	nd_upd_net_charge_amt=0;
	nd_tot_rate=0,
	nd1_tot_rate=0,
	nd_tot_serv_qty=0,
	nd1_tot_serv_qty=0,
	nd_grd_tot_rate=0,
	nd1_grd_tot_rate=0,
	nd_grd_tot_serv_qty=0,
	nd1_grd_tot_serv_qty=0,
	nd_total_addl_charge_by_service=0;
	nd_net_payable=0;
	nd_net_total=0;
	nd_tot_oth_payer_amt=0;
	nd_total_addl_charge=0;
	pat_upd_net_charge_amt=0;
	nd_serv_charge_discount=0;
	nd_serv_bill_discount=0;
	nd_serv_fund_adjustment=0;
	nd_serv_tot_disc=0;
	nd_tot_serv_charge_discount=0;
	nd_tot_serv_bill_discount=0;
	nd_tot_serv_fund_adjustment=0;
	nd_tot_serv_tot_disc=0;
	nd1_serv_charge_discount=0;
	nd1_serv_bill_discount=0;
	nd1_serv_fund_adjustment=0;
	nd1_serv_tot_disc=0;
	nd1_tot_serv_charge_discount=0;
	nd1_tot_serv_bill_discount=0;
	nd1_tot_serv_fund_adjustment=0;
	nd1_tot_serv_tot_disc=0;
    amount=0;
	nd1_tot_adjust_amt=0;
	v_pno = 1;
	l_cnt=0;
	ccnt1=0;
	l_bill_page_no = 0;
	l_bill_page_no_frmt2=0;
	nd_othp_payer_amt=0;
	othp_cnt=0;
	oth_cnt=0;
	k=1;
	l_no_of_clumns =0;
	v_lno=0;
	line_ctr=0;
	l_pkg_dep_exist=0;
	PkgPrintedYN.arr[0] = 'N';
	PkgPrintedYN.arr[PkgPrintedYN.len]='\0';

}

//The below function added by Rajesh to print package services after package description
print_pkg_grp_hdr()
 { 
 	
	//nd_prt_grp_hdr_code_old.arr[0]		= '\0';
	//nd_prt_grp_hdr_code_old.len		= 0;
		strcpy(d_prt_grp_hdr_code.arr,nd_prt_group_hdr_code.arr);
		strcpy(d_prt_grp_line_code.arr,nd_prt_group_line_code.arr);
		
		
    	  	//prt_grp_header code	   
			/* EXEC SQL  Select SHORT_DESC into :nd_prt_hd_desc 
					From BL_BLNG_PRT_GRP_HDR_LANG_VW
					Where  PRT_GRP_HDR_CODE= :nd_prt_group_hdr_code
					AND  LANGUAGE_ID = :nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select SHORT_DESC into :b0  from BL_BLNG_PRT_GRP_HDR_LANG_\
VW where (PRT_GRP_HDR_CODE=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )2077;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
   sqlstm.sqhstl[0] = (unsigned int  )48;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_prt_group_hdr_code;
   sqlstm.sqhstl[1] = (unsigned int  )9;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[2] = (unsigned int  )6;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			//prt_line_code
			/* EXEC SQL  Select substr(SHORT_DESC,1,20)  into :nd_prt_line_desc 
					  From BL_BLNG_PRT_GRP_LINE_lang_vw
					  Where  PRT_GRP_HDR_CODE=:nd_prt_group_hdr_code
					  and PRT_GRP_LINE_CODE=:nd_prt_group_line_code
					  AND LANGUAGE_ID = :nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_\
GRP_LINE_lang_vw where ((PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2) and L\
ANGUAGE_ID=:b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )2104;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
   sqlstm.sqhstl[0] = (unsigned int  )48;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_prt_group_hdr_code;
   sqlstm.sqhstl[1] = (unsigned int  )9;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_prt_group_line_code;
   sqlstm.sqhstl[2] = (unsigned int  )103;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[3] = (unsigned int  )6;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			/* EXEC SQL  SELECT substr(SHORT_DESC,1,13) into :nd1_mapping_code_desc 
					  FROM   BL_BLNG_SERV_LANG_VW
					  WHERE  blng_serv_code   =:nd_pkg_serv_code
					  AND    LANGUAGE_ID      =:nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(SHORT_DESC,1,13) into :b0  from BL_BLNG_SERV\
_LANG_VW where (blng_serv_code=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )2135;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd1_mapping_code_desc;
   sqlstm.sqhstl[0] = (unsigned int  )48;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_pkg_serv_code;
   sqlstm.sqhstl[1] = (unsigned int  )32;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[2] = (unsigned int  )6;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

	
			  		  					 
	
     				strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
					strcpy(d_line_code,d_prt_grp_line_code.arr);

				 get_grp_pkg_inside_cnt1('L',d_grp_code,d_line_code);
				if (l_grp_pkg_service_inside_cnt!=0) 
					{  
					if (rec_ctr == 0)
						{
							strcpy(nd_prt_grp_hdr_code_old.arr,nd_prt_group_hdr_code.arr);
							strcpy(nd_prt_grp_lin_code_old.arr,nd_prt_group_line_code.arr);
						 print_bold_underline();
//Here print group header is coming 
						   fprintf(fp,"\n");
						   print_bold_underline();
						   fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
						   Release_bold_underline();
				         } //rec_ctr ==0

					 if (strcmp(nd_prt_grp_hdr_code_old.arr,nd_prt_group_hdr_code.arr))
					   {
						fprintf(fp,"\n");
						print_bold_underline();
						fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
						Release_bold_underline();
						strcpy(nd_prt_grp_hdr_code_old.arr,nd_prt_group_hdr_code.arr);
					   }
					 rec_ctr++;
					 lsr_line_cnt();lsr_line_cnt();
					 Release_bold_underline();
					 fprintf(fp,"\n");lsr_line_cnt();
					  
		
				fprintf(fp," %-10.10s %-14.14s",nd_pkg_serv_code.arr,nd1_mapping_code_desc.arr); 
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				  {
				  fprintf(fp,"%16.16s",nd_pkg_serv_dt.arr);  //changed to 22 from 16 for testing purpose
				  }
			   print_formated_qty1();
		
										   
						} //l_grp_pkg_service_inside_cnt<>0
			/*********upto here********/																
					
   } //end prt_pkg


/* THIS FUNCTION WILL PRINT THE PAYER BILL */

print_prt_grp_hdr()
 { 
		
		/****added by vani for crf-0809 ***/
		p_get_pract_name_dtl_format_ind();
		p_get_print_pract_name_ind();
		/*********/
	
		fetch_bill_format_payer();/* This Function will fetch the Payer Setup Records */

		if (ccnt1==1)
		{
			//fetch_cust_cur();
			
			
			get_payer_bill_header();
	
	/***** This code added for printing package bill if it is there ****/

		if(l_pkg_len!=0)
		{
		 print_package_dtls(); //1
		}
		/***** upto here *****/

		}

	    /* This one Calculating the Patient Amounts */
       
	    if (strcmp(d_cust_code1.arr,"\0")==0)
	    {  
		 
	
     	   get_pat_bill_num(); //Getting Patient Bill Number

		   pat_upd_gross_charge_amt=pat_upd_gross_charge_amt+d_upd_gross_charge_amt;
		   pat_upd_net_charge_amt=pat_upd_net_charge_amt+d_upd_net_charge_amt;
		   pat_upd_disc_amt=pat_upd_disc_amt+d_upd_disc_amt;

		 
	    }
	  /* This one Calculating the Payer Amounts */
	  else
	   {
		  

		  if (strcmp(d_cust_code1.arr,d_cust_code.arr)==0)
		  {	
					
				  /*****************summary****************/
		
			   
			   if(d_summary_dtl_ind.arr[3] == 'S')  
				{
					
				   if( ccnt==1)
				   {
						 
						 get_print_group_hd_desc3(); 
						 get_print_group_line_desc3();
						 //get_blng_serv_desc();
											
						
					  if( d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
					  {
					  
						if(nd_summary_dtl_ind.arr[3] == 'D')
						{
							if(d_summary_dtl_ind.arr[4] == 'L')  
							{ 
							 
							  if (l_lsr != 0 && l_dmp == 0)
							  {
							  if( l_logo_yniflaser.arr[0] != 'Y')
							  {
							  print_bold_underline();
							  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							  {
					
								fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
								fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
								fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
								fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																									
							  }
							  else
							  fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
							  Release_bold_underline();
							  fprintf(fp,"\n");
							  }
							  }
								
							  if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							  {
								  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								  {
									  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									  {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									  {
							
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										fprintf(fp,"%-11.11s %s  \n"," ",nd_desc_with_spl_chr.arr," ");
																																					
									  }
									  else
									  fprintf(fp,"%-11.11s %s  \n"," ",nd_prt_line_desc.arr," ");
									  lsr_line_cnt();
									  fprintf(fp,"%-11.11s %-36.36s  "," "," "," ");
									  }
									  else
									  {
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-36.36s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"%-11.11s %-36.36s  "," ",nd_desc_with_spl_chr.arr," ");
																			
																																																									
										}
										else
										fprintf(fp,"%-11.11s %-36.36s  "," ",nd_prt_line_desc.arr," ");
									  }
								  }
								  else
								  {
									  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									  {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									  {
							
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										fprintf(fp,"%-11.11s %s  \n"," ",nd_desc_with_spl_chr.arr," ");																											
									  }
									  else
									  fprintf(fp,"%-11.11s %s  \n"," ",nd_prt_line_desc.arr," ");
									  lsr_line_cnt();
									  fprintf(fp,"%-11.11s %-20.20s  "," "," "," ");
									  }
									  else
									  {
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"%-11.11s %-20.20s  "," ",nd_desc_with_spl_chr.arr," ");
																	
																																																									
										}
										else
									  fprintf(fp,"%-11.11s %-20.20s  "," ",nd_prt_line_desc.arr," ");
									  }
								  }
							  }
							  else
							  {
								  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								  {
								  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
															
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										 fprintf(fp,"%-11.11s %-s    \n"," ",nd_desc_with_spl_chr.arr);																										
									  }
									  else
								  fprintf(fp,"%-11.11s %-s    \n"," ",nd_prt_line_desc.arr);

								  lsr_line_cnt();
								  fprintf(fp,"%-11.11s %-22.22s    "," "," ");
								  }
								  else
								  {
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-22.22s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								             fprintf(fp,"%-11.11s %-22.22s    "," ",nd_desc_with_spl_chr.arr);
																	
																																																									
										}
										else
								  fprintf(fp,"%-11.11s %-22.22s    "," ",nd_prt_line_desc.arr);
								  }
							  }
							
							//fprintf(fp,"%-11.11s   %-34.34s  "," ",nd_prt_line_desc.arr);
							//fprintf(fp,"%-23.23s    %-23.23s",nd_prt_line_desc.arr," ");	
							//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
							//fprintf(fp,"\n%-23.23s / %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	//uncommneted by vani
							//fprintf(fp,"\n%-s / %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	//uncommneted by vani
							}
							else
							{
								if (l_lsr != 0 && l_dmp == 0)
								{
							   if( l_logo_yniflaser.arr[0] != 'Y')
								{
								print_bold_underline();
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																					
									}
									else
										fprintf(fp,"%-s",nd_prt_hd_desc.arr);
								Release_bold_underline();
								fprintf(fp,"\n");lsr_line_cnt();
								}
								}
							
							 if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							 {
							 
								 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								 {
									 if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									 {
									 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									   {
							
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										fprintf(fp,"%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr," ");
																																					
									    }
									else
									 fprintf(fp,"%-11.11s %s   \n"," ",nd_prt_hd_desc.arr," ");
									 lsr_line_cnt();
									 fprintf(fp,"%-11.11s %-36.36s   "," "," "," ");
									 }
									 else
									 {
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-36.36s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										    fprintf(fp,"%-11.11s %-36.36s   "," ",nd_desc_with_spl_chr.arr," ");
										 }
												else
									      fprintf(fp,"%-11.11s %-36.36s   "," ",nd_prt_hd_desc.arr," ");
									 }
								 }
								 else
								 {
									 if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									 {
									 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr," ");																											
										}
										else
									 fprintf(fp,"%-11.11s %s   \n"," ",nd_prt_hd_desc.arr," ");
									 lsr_line_cnt();
									 fprintf(fp,"%-11.11s %-20.20s   "," "," "," ");
									 }
									 else
									 {
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										    fprintf(fp,"%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr," ");
																																																									
										}
										else
									 fprintf(fp,"%-11.11s %-20.20s   "," ",nd_prt_hd_desc.arr," ");
									 }
								 }
							 }
							 else
							 {
							  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
							  {
							  
								if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								{
						
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);
								}
								else
									  fprintf(fp,"%-11.11s %s    \n"," ",nd_prt_hd_desc.arr);
							  lsr_line_cnt();
							  fprintf(fp,"%-11.11s %-26.26s    "," "," ");
							  }
							  else
                              {
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-26.26s    "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
							      fprintf(fp,"%-11.11s %-26.26s    "," ",nd_prt_hd_desc.arr);
                               }
							 }
							//fprintf(fp,"%-23.23s   %-23.23s",nd_prt_hd_desc.arr," ");	
							}
												   
						}
						else
						{
							if(d_summary_dtl_ind.arr[4] == 'L') 
							{ 
								 
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								 print_bold_underline();
								 
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
							
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);	
										fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																													
									   }
									else
								       fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
								 Release_bold_underline();
								}
								}
							
							   if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							   {
								   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											{
												
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
											}
											else
											   fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_line_desc.arr);
									   lsr_line_cnt();
									   fprintf(fp,"%-11.11s %-36.36s   "," "," ");
									   }
									   else
									   {
										   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-36.36s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-36.36s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
										            fprintf(fp,"%-11.11s %-36.36s   "," ",nd_prt_line_desc.arr);
										}
								   }
								   else
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
											}
											else
									          fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_line_desc.arr);
									   lsr_line_cnt();
									   fprintf(fp,"%-11.11s %-20.20s   "," "," ");
									   }
									   else
									   {
									         if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
									                fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_line_desc.arr);
                                       }
								   }
							   }
							   else
							   {
							    if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								{
								 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										fprintf(fp,"\n%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);																											
									}
									else
								      fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
								lsr_line_cnt();
								fprintf(fp,"%-11.11s %-26.26s    "," "," ");
								}
								else
								 {
								   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										fprintf(fp,"\n%-11.11s %s    "," ",nd_desc_with_spl_chr.arr);  																											
									}
									else
								    fprintf(fp,"\n%-11.11s %s    "," ",nd_prt_line_desc.arr);  
                                  }
							   }
							
							//fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_line_desc.arr);
							//fprintf(fp,"\n%-23.23s    %-23.23s",nd_prt_line_desc.arr," ");	
							//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
							//fprintf(fp,"\n%-23.23s -  %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	
							//fprintf(fp,"\n%-s /  %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	 
							}
							else  
							{
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								
								 print_bold_underline();
								 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																											
									}
									else
								      fprintf(fp,"%-s",nd_prt_hd_desc.arr);
								 Release_bold_underline();
								}
								}
							
							   if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							   {
								   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"\n %-11.11s%s   \n"," ",nd_desc_with_spl_chr.arr);																											
										}
										else
									      fprintf(fp,"\n %-11.11s%s   \n"," ",nd_prt_hd_desc.arr);
									   lsr_line_cnt();
									   fprintf(fp," %-11.11s%-36.36s   "," "," ");
									   }
									   else
									   {
									     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-36.36s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n %-11.11s%-36.36s   "," ",nd_desc_with_spl_chr.arr); 
																																																											
												}
												else
										           fprintf(fp,"\n %-11.11s%-36.36s   "," ",nd_prt_hd_desc.arr); 
                                        }

								   }
								   else
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"\n %-11.11s%s   \n"," ",nd_desc_with_spl_chr.arr);																											
										}
										else
									       fprintf(fp,"\n %-11.11s%s   \n"," ",nd_prt_hd_desc.arr);
									   lsr_line_cnt();
									   fprintf(fp," %-11.11s%-20.20s   "," "," ");
									   }
									   else
									   {
									     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											    	fprintf(fp,"\n %-11.11s%-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
										             fprintf(fp,"\n %-11.11s%-20.20s   "," ",nd_prt_hd_desc.arr);
                                        }

								   }
							   }
							   else
							   {
								   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								   {
								      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											 fprintf(fp,"\n %-11.11s%s    \n"," ",nd_desc_with_spl_chr.arr); 																											
										}
										else
								            fprintf(fp,"\n %-11.11s%s    \n"," ",nd_prt_hd_desc.arr); 
								   lsr_line_cnt();
								   fprintf(fp," %-11.11s%-26.26s    "," "," "); 
								   }
								   else
								   {
								     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n %-11.11s%-26.26s    "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
									                 fprintf(fp,"\n %-11.11s%-26.26s    "," ",nd_prt_hd_desc.arr);
                                    }

							   }
							  //fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_hd_desc.arr);
							
							} 
							lsr_line_cnt();
						}
					
					  }	
						//fprintf(fp," %-10.10s %-20.20s %-17.17s",d_blng_serv_code.arr,nd_blng_desc.arr,d_serv_item_code.arr);
						
				/********added by vani*********/
			  if( d_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0)
			  {	
			 		//strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
					//strcpy(d_line_code,d_prt_grp_line_code.arr);
					//get_grp_pkg_outside_cnt1(d_grp_code,d_line_code); SENTHIL

					/***added for merging walkthrough corrections***/
					if( strcmp(d_grp_ind.arr,"ESG")==0||strcmp(d_grp_ind.arr,"ESL")==0)
					{
						strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
						strcpy(d_line_code,d_prt_grp_line_code.arr);
					}
					if(strcmp(d_grp_ind.arr,"EMG")==0)
					{
						strcpy(d_grp_code,d_ent_item_grp_code.arr);
						//strcpy(d_line_code,d_prt_grp_line_code.arr);
					}
					if(strcmp(d_grp_ind.arr,"PSG")==0||strcmp(d_grp_ind.arr,"PSL")==0)
					{
						strcpy(d_grp_code,d_payer_serv_grp_hdr.arr);
						strcpy(d_line_code,d_payer_serv_grp_line.arr);
					}
					if(strcmp(d_grp_ind.arr,"PMG")==0)
					{									
						 strcpy(d_grp_code,d_payer_item_grp_code.arr);
						//strcpy(d_line_code,d_prt_grp_line_code.arr);
					}

					/***upto here***/

					  get_grp_pkg_outside_cnt1('L',d_grp_code,d_line_code);
					if (l_grp_pkg_inside_cnt!=0)
					{  
						if(nd_summary_dtl_ind.arr[3] == 'D')
						{	 
							if(d_summary_dtl_ind.arr[4] == 'L')  
							{ 
							  if (l_lsr != 0 && l_dmp == 0)
							  {
							  if( l_logo_yniflaser.arr[0] != 'Y')
							  {
							  print_bold_underline();
							  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
						
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);	
									fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
									fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																																			
								}
								else
								{									
								   fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
								}
							  Release_bold_underline();
							  fprintf(fp,"\n");lsr_line_cnt();
							  }
							  }
								
							  if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							  {	
								  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								  {
									  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									  {
									  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"%-11.11s %-s   \n"," ",nd_desc_with_spl_chr.arr);																											
										}
										else
									       fprintf(fp,"%-11.11s %-s   \n"," ",nd_prt_line_desc.arr);
									  lsr_line_cnt();
									  fprintf(fp,"%-11.11s %-36.36s   "," "," ");
									  }
									  else
									  {
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-36.36s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-36.36s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
									               fprintf(fp,"%-11.11s %-36.36s   "," ",nd_prt_line_desc.arr);
                                       }
								  }
								  else
								  {
									  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									  {
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
										}
										else
									      fprintf(fp,"%-11.11s %s   \n"," ",nd_prt_line_desc.arr);
									  lsr_line_cnt();
									  fprintf(fp,"%-11.11s %-20.20s   "," "," ");
									  }
									  else
									  {
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
										              fprintf(fp,"%-11.11s %-20.20s   "," ",nd_prt_line_desc.arr);
                                       }
								  }
							  }
							  else
							  {
								  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								  {
								  	 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									  {
							
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										 fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);																											
									  }
									  else
								        fprintf(fp,"%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
								  lsr_line_cnt();
								  fprintf(fp,"%-11.11s %-26.26s    "," "," ");
								  }
								  else
								  {
								      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-26.26s    "," ",nd_desc_with_spl_chr.arr);
																																																											
										}
										else
								             fprintf(fp,"%-11.11s %-26.26s    "," ",nd_prt_line_desc.arr);
                                  }
							  }
							
							//fprintf(fp,"%-11.11s   %-34.34s  "," ",nd_prt_line_desc.arr);
							//fprintf(fp,"%-23.23s    %-23.23s",nd_prt_line_desc.arr," ");	
							//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
							//fprintf(fp,"\n%-23.23s / %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	//uncommneted by vani
							//fprintf(fp,"\n%-s / %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	//uncommneted by vani
							}
							else
							{
								if (l_lsr != 0 && l_dmp == 0)
								{
							   if( l_logo_yniflaser.arr[0] != 'Y')
								{
								print_bold_underline();
								
								if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								{
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																															
								}
								 else
								   fprintf(fp,"%-s",nd_prt_hd_desc.arr);
								Release_bold_underline();
								fprintf(fp,"\n");lsr_line_cnt();
								}
								}
					
							 if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							 {
								 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								 {
									 if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									 {
									 
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																															
										}
										 else
									         fprintf(fp,"%-11.11s %s   \n"," ",nd_prt_hd_desc.arr);
									 lsr_line_cnt();
									 fprintf(fp,"%-11.11s %-36.36s   "," "," ");
									 }
									 else
									 {
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-36.-6s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-36.36s   "," ",nd_desc_with_spl_chr.arr);
																																																											
										}
										else
									     fprintf(fp,"%-11.11s %-36.36s   "," ",nd_prt_hd_desc.arr);
                                      }
								 }
								 else
								 {
									 if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									 {
									 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
										}
										else
									     fprintf(fp,"%-11.11s %s   \n"," ",nd_prt_hd_desc.arr);
									 lsr_line_cnt();
									 fprintf(fp,"%-11.11s %-20.20s   "," "," ");
									 }
									 else
									 {
									     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
										  }
											else
										      fprintf(fp,"%-11.11s %-20.20s   "," ",nd_prt_hd_desc.arr);
                                      }
								 }
							 }
							 else
							 {
								 if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								 {
								 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);																											
									}
									else
								       fprintf(fp,"%-11.11s %s    \n"," ",nd_prt_hd_desc.arr);
								 lsr_line_cnt();
								 fprintf(fp,"%-11.11s %-26.26s    "," "," ");
								 }
								 else
								 {
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													    fprintf(fp,"%-11.11s %-26.26s   "," ",nd_desc_with_spl_chr.arr);
																																																												
										 }
										else
										   fprintf(fp,"%-11.11s %-26.26s   "," ",nd_prt_hd_desc.arr);
                                  }
							 }
							//fprintf(fp,"%-23.23s   %-23.23s",nd_prt_hd_desc.arr," ");	
							}
												   
						}
						else
						{
							if(d_summary_dtl_ind.arr[4] == 'L') 
							{ 
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								 print_bold_underline();
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
										 fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										 fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
										 fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										 fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);										 																															
									}
									else								 
										fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
								 Release_bold_underline();
								}
								}
						
							   if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							   {
								   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   	 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										  {
									         fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											 fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																												
											}
											else
									            fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_line_desc.arr);
									   lsr_line_cnt();lsr_line_cnt();
									   fprintf(fp,"%-11.11s %-36.36s   "," "," ");
									   }
									   else
									   {
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											{
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-36.36s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n%-11.11s %-36.36s   "," ",nd_desc_with_spl_chr.arr);
																																																											
											 }
											else
											  fprintf(fp,"\n%-11.11s %-36.36s   "," ",nd_prt_line_desc.arr);
                                       }

								   }
								   else
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   		if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
											}
											else
										      fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_line_desc.arr);
									   lsr_line_cnt();lsr_line_cnt();
									   fprintf(fp,"%-11.11s %-20.20s   "," "," ");
									   }
									   else
									   {
										   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
									               fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_line_desc.arr);
                                        }
								   }
							   }
							   else
							   {
								   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								   {
								   	 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										fprintf(fp,"\n%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);																											
									 }
									  else
								        fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
								   lsr_line_cnt();lsr_line_cnt();
								   fprintf(fp,"%-11.11s %-26.26s    "," "," ");
								   }
								   else
								   {
								      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_desc_with_spl_chr.arr);
																																																											
										}
										    else
									           fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_prt_line_desc.arr);
                                    }
							   }
							
							//fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_line_desc.arr);
							//fprintf(fp,"\n%-23.23s    %-23.23s",nd_prt_line_desc.arr," ");	
							//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
							//fprintf(fp,"\n%-23.23s -  %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	
							//fprintf(fp,"\n%-s /  %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	 
							}
							else  
							{
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								
								 print_bold_underline();
								 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																											
									}
									  else
								            fprintf(fp,"%-s",nd_prt_hd_desc.arr);
								 Release_bold_underline();
								}
								}
								
							   if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							   {
								   
								   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   	   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"\n %-11.11s%s   \n"," ",nd_desc_with_spl_chr.arr);																											
											}
											else
									            fprintf(fp,"\n %-11.11s%s   \n"," ",nd_prt_hd_desc.arr);
									   lsr_line_cnt();lsr_line_cnt();
									   fprintf(fp," %-11.11s%-20.20s   "," "," ");
									   }
									   else
									   {
									       if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n %-11.11s%-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else 
											        fprintf(fp,"\n %-11.11s%-20.20s   "," ",nd_prt_hd_desc.arr);
									    }		 

								   }
								   else
								   {
									   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									   {
									   		if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"\n %-11.11s%s   \n"," ",nd_desc_with_spl_chr.arr);																											
											}
											else
									           fprintf(fp,"\n %-11.11s%s   \n"," ",nd_prt_hd_desc.arr);
									   lsr_line_cnt();lsr_line_cnt();
									   fprintf(fp," %-11.11s%-20.20s   "," "," ");
									   }
									   else
                                        {
									         if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-2.2s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n %-11.11s%-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
										           fprintf(fp,"\n %-11.11s%-20.20s   "," ",nd_prt_hd_desc.arr);
                                         }
								   }
							   }
							   else
							   {
								   if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								   {
								   		if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"\n %-11.11s%s    \n"," ",nd_desc_with_spl_chr.arr); 																											
										}
										else
								            fprintf(fp,"\n %-11.11s%s    \n"," ",nd_prt_hd_desc.arr); 
								   lsr_line_cnt();lsr_line_cnt();
								   fprintf(fp," %-11.11s%-26.26s    "," "," "); 
								   }
								   else
								   {
								     
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n %-11.11s%-26.26s    "," ",nd_desc_with_spl_chr.arr); 
																																																											
										}
										  else
									          fprintf(fp,"\n %-11.11s%-26.26s    "," ",nd_prt_hd_desc.arr); 
                                    }

							   }
							  //fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_hd_desc.arr);
							
							} 
							lsr_line_cnt();
						}

					}

			   } 
			/*********upto here********/																
						get_gross_net_amt1();
						
						nd_pat_gross_amt1=nd_pat_gross_amt1+p_gross_amt;			
						//nd_pat_gross_amt1=nd_pat_gross_amt1+p_gross_amt;  //total service gross
						nd_pat_net_amt2=nd_pat_net_amt2+p_net_amt;		  //total service Total(Net Amt)	
						nd_pat_disc_amt1=nd_pat_disc_amt1+d_upd_disc_amt; //total service discount
						//nd_pat_disc_amt1=nd_pat_disc_amt1+p_disc_amt;	  //total service discount

						nd_upd_net_charge_amt=nd_upd_net_charge_amt+d_upd_net_charge_amt; //total service AmtPayable
						nd_net_payable=nd_net_payable+d_upd_net_charge_amt;				  //total AmtPayable
					
					    nd_total_addl_charge_by_service = nd_total_addl_charge_by_service+d_addl_charge_amt_in_charge; //Total Additional Charge By Service
					    nd_total_addl_charge=nd_total_addl_charge+d_addl_charge_amt_in_charge;						   //Total Additional Charge
						
										
						if(d_package_trx_yn.arr[0] == 'Y'  && l_pkg_len!=0)  // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
						{
						
						 nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_gross_amt;
						 nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_net_amt;
						 nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d_upd_net_charge_amt;
						 nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d_upd_disc_amt;
						 nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d_addl_charge_amt_in_charge;
						}
						
						/*******For CRF-440(Discount Document Report)*******/

						nd_serv_tot_disc=nd_serv_tot_disc+d_tot_disc;						//Service Wise Total Discount
						nd_tot_serv_tot_disc=nd_tot_serv_tot_disc+d_tot_disc;				//Grand Total Discount

						nd_serv_charge_discount=nd_serv_charge_discount+d_charge_discount;		 //Service Wise Total Charge Discount
						nd_tot_serv_charge_discount=nd_tot_serv_charge_discount+d_charge_discount;	//Grand Total Charge Discount

						nd_serv_bill_discount=nd_serv_bill_discount+d_bill_discount;			//Service Wise Total Bill Discount
						nd_tot_serv_bill_discount=nd_tot_serv_bill_discount+d_bill_discount;		//Grand Total Bill Discount

						nd_serv_fund_adjustment=nd_serv_fund_adjustment+d_fund_adjustment;		//Service Wise Total Fund(policy) Discount
						nd_tot_serv_fund_adjustment=nd_tot_serv_fund_adjustment+d_fund_adjustment;	//Grand Total Fund(policy) Discount

						/*******CRF-440 *******/
												
						end_of_report=1;


					   }
					  else
					  if(d_summary_dtl_ind.arr[4] == 'L')
					   {
					    							
						  /*if(strcmp(d_prt_grp_hdr_code.arr,nd_prt_grp_hdr_code.arr)==0 && strcmp(d_prt_grp_line_code.arr,nd_prt_grp_line_code.arr)==0
						  && strcmp(d_payer_serv_grp_hdr.arr,nd_payer_serv_grp_hdr.arr)==0 && strcmp(d_payer_serv_grp_line.arr,nd_payer_serv_grp_line.arr)==0)*/

						   if( (strcmp(d_grp_ind.arr,"ESL")==0 && (strcmp(d_prt_grp_hdr_code.arr,nd_prt_grp_hdr_code.arr)==0 && strcmp(d_prt_grp_line_code.arr,nd_prt_grp_line_code.arr)==0))||
					          (strcmp(d_grp_ind.arr,"PSL")==0 && (strcmp(d_payer_serv_grp_hdr.arr,nd_payer_serv_grp_hdr.arr)==0 && strcmp(d_payer_serv_grp_line.arr,nd_payer_serv_grp_line.arr)==0))
						    )
						  {

					   		nd_upd_net_charge_amt=nd_upd_net_charge_amt+d_upd_net_charge_amt; //total service AmtPayable
							nd_net_payable=nd_net_payable+d_upd_net_charge_amt;				  //total AmtPayable	
																		
							nd_total_addl_charge_by_service = nd_total_addl_charge_by_service+d_addl_charge_amt_in_charge; //Total Additional Charge By Service
					        nd_total_addl_charge=nd_total_addl_charge+d_addl_charge_amt_in_charge;						   //Total Additional Charge
							
							/*******For CRF-440(Discount Document Report)*******/

							nd_serv_tot_disc=nd_serv_tot_disc+d_tot_disc;							    //Service Wise Total Discount
							nd_tot_serv_tot_disc=nd_tot_serv_tot_disc+d_tot_disc;					    //Grand Total Discount

							nd_serv_charge_discount=nd_serv_charge_discount+d_charge_discount;			//Service Wise Total Charge Discount
							nd_tot_serv_charge_discount=nd_tot_serv_charge_discount+d_charge_discount;	//Grand Total Charge Discount

							nd_serv_bill_discount=nd_serv_bill_discount+d_bill_discount;				//Service Wise Total Bill Discount
							nd_tot_serv_bill_discount=nd_tot_serv_bill_discount+d_bill_discount;		//Grand Total Bill Discount

							nd_serv_fund_adjustment=nd_serv_fund_adjustment+d_fund_adjustment;			//Service Wise Total Fund(policy) Discount
							nd_tot_serv_fund_adjustment=nd_tot_serv_fund_adjustment+d_fund_adjustment;	//Grand Total Fund(policy) Discount

							/*******CRF-440 *******/
							
							
							
							get_gross_net_amt1();
						
							nd_pat_gross_amt1=nd_pat_gross_amt1+p_gross_amt;  //total service gross
							nd_pat_net_amt2=nd_pat_net_amt2+p_net_amt;		  //total service Net	
							nd_pat_disc_amt1=nd_pat_disc_amt1+d_upd_disc_amt; //total service discount

							//nd_pat_disc_amt1=nd_pat_disc_amt1+p_disc_amt;	  //total service discount
							
							if(d_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
							{
							
							 nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_gross_amt;
							 nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_net_amt;
							 nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d_upd_net_charge_amt;
							 nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d_upd_disc_amt;
							 nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d_addl_charge_amt_in_charge;
							}
									 				
							end_of_report=1;
						  }
						 else
						  {

							 nd_net_total=nd_net_total+nd_pat_net_amt2;
							 nd_gross_total=nd_gross_total+nd_pat_gross_amt1;
							 nd_disc_total=nd_disc_total+nd_pat_disc_amt1;
							 							 
					         if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 {
							  //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"C")==0) //changed from R to C by vani
							  if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0||strcmp(p_addl_charge_amt_ind.arr,"B")==0)) //changed from R to C by vani
							  {
								get_addlcharge_count();
								if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
								print_formated_amt1(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt);
							  }
							  else
							  {
							   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0 || (strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && p_disc_amt_in_dtl_yn.arr[0]=='N'))
							   fprintf(fp,"%-11.11s"," ");
							  }
							 }

							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							 {
							  if (strcmp(p_gross_net_amt_ind.arr,"G")==0)
							  {
							  
							  print_formated_amt(nd_pat_gross_amt1-nd_inside_pkg_gross_amt);
							  }
							 }
							 
							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							 {
							  if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
							  print_formated_amt(nd_pat_net_amt2-nd_inside_pkg_net_amt);
							 }	
							
							
							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 {
							  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function				
							  {
							   if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
							   {
							    if (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
							    print_formated_amt(nd_pat_disc_amt1-nd_inside_pkg_disc_amt);
							   }
							  }
							  
							  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)	
							  {
							      if(p_disc_amt_in_dtl_yn.arr[0]=='N')
								  {
								   if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
								   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								   fprintf(fp,"%-9.9s"," ");
								   print_formated_amt(nd_serv_tot_disc);
								  }
								  else
								  {
									print_formated_amt(nd_serv_charge_discount);
									print_formated_amt(nd_serv_bill_discount);
									print_formated_amt(nd_serv_fund_adjustment);
								  }

							  }
							 
							 }
							 
							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							 {
							 
							  //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"R")==0)
								if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
							  print_formated_amt((nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt)-nd_total_addl_charge_by_service);
							  else
							  {
							   if (strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0)
							   print_formated_amt((nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_inside_pkg_amtpayable_amt-nd_inside_pkg_addchrg_amt));
							  }
							 }
							 //fprintf(fp,"\n");commented on 20/3/2008 for removing space b/w records
							 
							 nd_pat_gross_amt1=0;
							 nd_pat_net_amt2=0;
							 nd_pat_disc_amt1=0;
							 nd_upd_net_charge_amt=0;
							 nd_total_addl_charge_by_service=0;
							 nd_serv_charge_discount=0;
							 nd_serv_bill_discount=0;
							 nd_serv_fund_adjustment=0;
							 nd_serv_tot_disc=0;
							 nd_inside_pkg_gross_amt=0;
							 nd_inside_pkg_net_amt=0;
							 nd_inside_pkg_amtpayable_amt=0;
							 nd_inside_pkg_disc_amt=0;
							 nd_inside_pkg_addchrg_amt=0;
							
							 get_print_group_hd_desc3();
							 get_print_group_line_desc3();
							 //Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
							 //fprintf(fp,"\n%-23.23s -  %-23.23s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	
							 
							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 if (l_lsr != 0 && l_dmp == 0)
							 {
							 if( l_logo_yniflaser.arr[0] != 'Y')
							 {
								fprintf(fp,"\n");
							  print_bold_underline();
							  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
						
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);																											
									fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
									fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);	
								}
								else
							      fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
							  lsr_line_cnt();
							  Release_bold_underline();
							 }
							 }
				
					/*********added by vani **********/
					if (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) 
						{
							//strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,d_prt_grp_line_code.arr);
								//get_grp_pkg_outside_cnt1(d_grp_code,d_line_code); SENTHIL
								
								/***added for merging walkthrough corrections
							if( strcmp(d_grp_ind.arr,"ESG")==0||strcmp(d_grp_ind.arr,"ESL")==0)
							{
								strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
								strcpy(d_line_code,d_prt_grp_line_code.arr);
							}
							if(strcmp(d_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,d_ent_item_grp_code.arr);
								//strcpy(d_line_code,d_prt_grp_line_code.arr);
							}
							if(strcmp(d_grp_ind.arr,"PSG")==0||strcmp(d_grp_ind.arr,"PSL")==0)
							{
								strcpy(d_grp_code,d_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,d_payer_serv_grp_line.arr);
							}
							if(strcmp(d_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,d_payer_item_grp_code.arr);
								//strcpy(d_line_code,d_prt_grp_line_code.arr);
							}
							/***upto here***/

								  get_grp_pkg_outside_cnt1('L',d_grp_code,d_line_code);
							if (l_grp_pkg_inside_cnt!=0)
							{
							if (l_lsr != 0 && l_dmp == 0)
							 {
							 if( l_logo_yniflaser.arr[0] != 'Y')
							 {
							 
							  print_bold_underline();
							  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
									fprintf(fp,"\n");
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);	
									fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
									fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
								 }
								  else
								  {
							         fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
									 }
							  lsr_line_cnt();
							  Release_bold_underline();
							 }
							 }
							}
						}
						
						/********upto here********/
							
							 if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							 {
								  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								  {
									  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									  {
									  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
										 }
										 else
									       fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_line_desc.arr);
									  lsr_line_cnt();lsr_line_cnt();
									  fprintf(fp,"%-11.11s %-20.20s   "," "," ");
									  }
									  else
									  {
									     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
										 }
										 else
									         fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_line_desc.arr);
                                       } 

								  }
								  else
								  {
									  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									  {
									  
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											{
												
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																														
											}
											else
									           fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_line_desc.arr);
									  lsr_line_cnt();lsr_line_cnt();
									  fprintf(fp,"%-11.11s %-20.20s   "," "," ");
									  }
									  else
									  {
									      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										   {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
										     }
											  else
										           fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_line_desc.arr);
                                       } 

								  }
							  }
							 else 
							 {
								 if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								 {
								 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										fprintf(fp,"\n%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);//RAGHAVA																											
									 }
									  else
								         fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_line_desc.arr);//RAGHAVA
								 lsr_line_cnt();lsr_line_cnt();
								 fprintf(fp,"%-11.11s %-26.26s    "," "," ");//RAGHAVA
								 }
								 else
								 {
								     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_desc_with_spl_chr.arr);//RAGHAVA	
																																																											
									 }
										else
								           fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_prt_line_desc.arr);//RAGHAVA
                                 }

							 }

							 //fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_line_desc.arr);
							 lsr_line_cnt();

							 nd_upd_net_charge_amt=nd_upd_net_charge_amt+d_upd_net_charge_amt;    //total service AmtPayable
							 nd_net_payable=nd_net_payable+d_upd_net_charge_amt;				  //total AmtPayable	

							 nd_total_addl_charge_by_service = nd_total_addl_charge_by_service+d_addl_charge_amt_in_charge; //Total Additional Charge By Service
					         nd_total_addl_charge=nd_total_addl_charge+d_addl_charge_amt_in_charge;						   //Total Additional Charge
								
							 
							/*******For CRF-440(Discount Document Report)*******/

							nd_serv_tot_disc=nd_serv_tot_disc+d_tot_disc;					//Service Wise Total Discount
							nd_tot_serv_tot_disc=nd_tot_serv_tot_disc+d_tot_disc;				//Grand Total Discount

							nd_serv_charge_discount=nd_serv_charge_discount+d_charge_discount;		 //Service Wise Total Charge Discount
							nd_tot_serv_charge_discount=nd_tot_serv_charge_discount+d_charge_discount;	//Grand Total Charge Discount

							nd_serv_bill_discount=nd_serv_bill_discount+d_bill_discount;			//Service Wise Total Bill Discount
							nd_tot_serv_bill_discount=nd_tot_serv_bill_discount+d_bill_discount;		//Grand Total Bill Discount

							nd_serv_fund_adjustment=nd_serv_fund_adjustment+d_fund_adjustment;		//Service Wise Total Fund(policy) Discount
							nd_tot_serv_fund_adjustment=nd_tot_serv_fund_adjustment+d_fund_adjustment;	//Grand Total Fund(policy) Discount

							/*******CRF-440 *******/	
											 
							 get_gross_net_amt1();
							 
							 
							 nd_pat_gross_amt1=nd_pat_gross_amt1+p_gross_amt;  //total service gross
							 nd_pat_net_amt2=nd_pat_net_amt2+p_net_amt;		   //total service Net	
						     nd_pat_disc_amt1=nd_pat_disc_amt1+d_upd_disc_amt; //total service discount
							 //nd_pat_disc_amt1=nd_pat_disc_amt1+p_disc_amt;	   //total service discount
							
							if(d_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
							{
							 
							 nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_gross_amt;
							 nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_net_amt;
							 nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d_upd_net_charge_amt;
							 nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d_upd_disc_amt;
							 nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d_addl_charge_amt_in_charge;
							}
							
							end_of_report=1;
						  }
						  
						   
					  }
						
					else
					  {
					    							
						 //if(strcmp(d_prt_grp_hdr_code.arr,nd_prt_grp_hdr_code.arr)==0 && strcmp(d_payer_serv_grp_hdr.arr,nd_payer_serv_grp_hdr.arr)==0) 
						 if( (strcmp(d_grp_ind.arr,"ESG")==0 && strcmp(d_prt_grp_hdr_code.arr,nd_prt_grp_hdr_code.arr)==0) ||
					        (strcmp(d_grp_ind.arr,"PSG")==0 && strcmp(d_payer_serv_grp_hdr.arr,nd_payer_serv_grp_hdr.arr)==0)||
						    (strcmp(d_grp_ind.arr,"EMG")==0 && strcmp(d_ent_item_grp_code.arr,nd_ent_item_grp_code.arr)==0)||
						    (strcmp(d_grp_ind.arr,"PMG")==0 && strcmp(d_payer_item_grp_code.arr,nd_payer_item_grp_code.arr)==0)    
					      )	
						  {

					   		nd_upd_net_charge_amt=nd_upd_net_charge_amt+d_upd_net_charge_amt; //total service AmtPayable
							nd_net_payable=nd_net_payable+d_upd_net_charge_amt;				  //total AmtPayable	
																
							nd_total_addl_charge_by_service = nd_total_addl_charge_by_service+d_addl_charge_amt_in_charge; //Total Additional Charge By Service
					        nd_total_addl_charge=nd_total_addl_charge+d_addl_charge_amt_in_charge;						   //Total Additional Charge
							
							
							/*******For CRF-440(Discount Document Report)*******/

							nd_serv_tot_disc=nd_serv_tot_disc+d_tot_disc;					//Service Wise Total Discount
							nd_tot_serv_tot_disc=nd_tot_serv_tot_disc+d_tot_disc;				//Grand Total Discount

							nd_serv_charge_discount=nd_serv_charge_discount+d_charge_discount;		 //Service Wise Total Charge Discount
							nd_tot_serv_charge_discount=nd_tot_serv_charge_discount+d_charge_discount;	//Grand Total Charge Discount

							nd_serv_bill_discount=nd_serv_bill_discount+d_bill_discount;			//Service Wise Total Bill Discount
							nd_tot_serv_bill_discount=nd_tot_serv_bill_discount+d_bill_discount;		//Grand Total Bill Discount

							nd_serv_fund_adjustment=nd_serv_fund_adjustment+d_fund_adjustment;		//Service Wise Total Fund(policy) Discount
							nd_tot_serv_fund_adjustment=nd_tot_serv_fund_adjustment+d_fund_adjustment;	//Grand Total Fund(policy) Discount

							/*******CRF-440 *******/

							get_gross_net_amt1();

							nd_pat_gross_amt1=nd_pat_gross_amt1+p_gross_amt;  //total service gross
							nd_pat_net_amt2=nd_pat_net_amt2+p_net_amt;		  //total service Net	
						    nd_pat_disc_amt1=nd_pat_disc_amt1+d_upd_disc_amt; //total service discount
							//nd_pat_disc_amt1=nd_pat_disc_amt1+p_disc_amt;	  //total service discount
						
							if(d_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
							{
							 
							 nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_gross_amt;
							 nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_net_amt;
							 nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d_upd_net_charge_amt;
							 nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d_upd_disc_amt;
							 nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d_addl_charge_amt_in_charge;
							}
									 				
							end_of_report=1;
						  }
						 else
						  {
						
							 nd_net_total=nd_net_total+nd_pat_net_amt2;
							 nd_gross_total=nd_gross_total+nd_pat_gross_amt1+nd_pat_gross_amt2;
							 nd_disc_total=nd_disc_total+nd_pat_disc_amt1;
							 
					         if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 {
							  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							  {
							   //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"C")==0)  //chnged from R to C by vani
							   if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0||strcmp(p_addl_charge_amt_ind.arr,"B")==0))  //chnged from R to C by vani
							   {
								get_addlcharge_count();
								if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
								print_formated_amt1(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt);
							   }
							   else
							   fprintf(fp,"%-11.11s"," ");
							    
							  }
							  
							   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && p_disc_amt_in_dtl_yn.arr[0]=='N')
						       fprintf(fp,"%-11.11s"," ");
			
							 }
						
						
							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							 {
							  if (strcmp(p_gross_net_amt_ind.arr,"G")==0)
							  {
							   
							  print_formated_amt(nd_pat_gross_amt1-nd_inside_pkg_gross_amt);
							  }
							 }

							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							 {
							  if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
							  print_formated_amt(nd_pat_net_amt2-nd_inside_pkg_net_amt);
						     }

							 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							 {
							  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function				
							  {
								get_discount_count();
							   if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
							   {
							    if (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
							    print_formated_amt(nd_pat_disc_amt1-nd_inside_pkg_disc_amt);
							   }
							  }
							  
							  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)	
							  {
							      if(p_disc_amt_in_dtl_yn.arr[0]=='N')
								  {
							       if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
								   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
								   fprintf(fp,"%-9.9s"," ");
								   print_formated_amt(nd_serv_tot_disc);
								  }
								  else
								  {
									print_formated_amt(nd_serv_charge_discount);
									print_formated_amt(nd_serv_bill_discount);
									print_formated_amt(nd_serv_fund_adjustment);
								  }

							  }
							 
							 }
							
					        if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"R")==0)
							 if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
							 print_formated_amt((nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt));
							 else
							 {
							  if(strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0)
							  print_formated_amt(nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt);
							 }
							 //fprintf(fp,"\n");commented on 20/3/2008 for removing space b/w records
							}
							 nd_pat_gross_amt1=0;
							 nd_pat_net_amt2=0;
							 nd_pat_disc_amt1=0;
							 nd_upd_net_charge_amt=0;
							 nd_total_addl_charge_by_service=0;
							 nd_serv_charge_discount=0;
							 nd_serv_bill_discount=0;
							 nd_serv_fund_adjustment=0;
							 nd_serv_tot_disc=0;
							 nd_inside_pkg_gross_amt=0;
							 nd_inside_pkg_net_amt=0;
							 nd_inside_pkg_amtpayable_amt=0;
							 nd_inside_pkg_disc_amt=0;
							 nd_inside_pkg_addchrg_amt=0;
													 
							
							 get_print_group_hd_desc3();
							 get_print_group_line_desc3();

							
							if( nd_package_trx_yn.arr[0] == 'N'|| (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							{
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')    //added by vani
								{ fprintf(fp,"\n");
							
								 print_bold_underline();
								 
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
											
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																															
									}
									  else
								         fprintf(fp,"%-s",nd_prt_hd_desc.arr);
								 Release_bold_underline(); 
								 
								}
								}
							
								if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
								{
									if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
									{
										if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
										{
										
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											{
													
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																															
											}
											 else
										        fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_hd_desc.arr);
										lsr_line_cnt();lsr_line_cnt();
										fprintf(fp,"%-11.11s %-20.20s   "," "," ");
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
										             fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_hd_desc.arr); 
                                         }

									}
									else
									{
										if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
											}
											else
										      fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_hd_desc.arr);
										lsr_line_cnt();lsr_line_cnt();
										fprintf(fp,"%-11.11s %-20.20s   "," "," ");
										}
										else
										{
										    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											{
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																											
											}
											 else 
											        fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_hd_desc.arr);
                                         }

									}
								}
								else
								{
									if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
								
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"\n%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);																											
										}
										else
									      fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_hd_desc.arr);//RAGHAVA
									lsr_line_cnt();lsr_line_cnt();
									fprintf(fp,"%-11.11s %-26.26s    "," "," ");//RAGHAVA
									}
									else
									{
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_desc_with_spl_chr.arr);
																																																											
										}
										else
									        fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_prt_hd_desc.arr);//RAGHAVA
                                     }

								}
								 //fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_hd_desc.arr);
								 //fprintf(fp,"\n%-23.23s    %-23.23s",nd_prt_hd_desc.arr," ");	
								 lsr_line_cnt();
							}  

						/********added by vani*********/
						if (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0)
							{
								//strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
								//strcpy(d_line_code,d_prt_grp_line_code.arr);
								//get_grp_pkg_outside_cnt1(d_grp_code,d_line_code); SENTHIL

								/***added for merging walkthrough corections***/
								if( strcmp(d_grp_ind.arr,"ESG")==0||strcmp(d_grp_ind.arr,"ESL")==0)
								{
									strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
									strcpy(d_line_code,d_prt_grp_line_code.arr);
								}
								if(strcmp(d_grp_ind.arr,"EMG")==0)
								{
									strcpy(d_grp_code,d_ent_item_grp_code.arr);
									//strcpy(d_line_code,d_prt_grp_line_code.arr);
								}
								if(strcmp(d_grp_ind.arr,"PSG")==0||strcmp(d_grp_ind.arr,"PSL")==0)
								{
									strcpy(d_grp_code,d_payer_serv_grp_hdr.arr);
									strcpy(d_line_code,d_payer_serv_grp_line.arr);
								}
								if(strcmp(d_grp_ind.arr,"PMG")==0)
								{									
									 strcpy(d_grp_code,d_payer_item_grp_code.arr);
									//strcpy(d_line_code,d_prt_grp_line_code.arr);
								}

								/***upto here**/


								  get_grp_pkg_outside_cnt1('G',d_grp_code,d_line_code);

								if (l_grp_pkg_inside_cnt!=0)
								{
									if (l_lsr != 0 && l_dmp == 0)
										{
										if( l_logo_yniflaser.arr[0] != 'Y')   
										{
											fprintf(fp,"\n");
										 print_bold_underline();
										 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																											
											}
											else
										       fprintf(fp,"%-s",nd_prt_hd_desc.arr);
										 lsr_line_cnt();
										 Release_bold_underline(); 
										 
										}
										}
										
										if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
										{
										
											if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
											{
												if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
											
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
													}
													else
												       fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												fprintf(fp,"%-11.11s %-20.20s   "," "," ");
												}
												else
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																												
													}
													   else
												         fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_hd_desc.arr);
                                                 }

											}
											else
											{
												if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
											
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s %s   \n"," ",nd_desc_with_spl_chr.arr);																											
													}
													else
												      fprintf(fp,"\n%-11.11s %s   \n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												fprintf(fp,"%-11.11s %-20.20s   "," "," ");
												}
												else
												{
													  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-20.20s",nd_prt_hd_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													    fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_desc_with_spl_chr.arr);
																																																												
													}
													  else
												         fprintf(fp,"\n%-11.11s %-20.20s   "," ",nd_prt_hd_desc.arr);
                                                 }

											}
										}
										else
										{
											if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
										
													fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
													fprintf(fp,"\n%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);																											
												}
												else
											       fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_hd_desc.arr);//RAGHAVA
											lsr_line_cnt();lsr_line_cnt();
											fprintf(fp,"%-11.11s %-26.26s    "," "," ");//RAGHAVA
											}
											else
											{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													    fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_desc_with_spl_chr.arr);
																																																												
													}
													else
													   fprintf(fp,"\n%-11.11s %-26.26s    "," ",nd_prt_hd_desc.arr);//RAGHAVA
                                             } 

										}
										 //fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_hd_desc.arr);
										 //fprintf(fp,"\n%-23.23s    %-23.23s",nd_prt_hd_desc.arr," ");	
										 lsr_line_cnt();
									}  

								
							}
	
							/********upto here****/

							 nd_upd_net_charge_amt=nd_upd_net_charge_amt+d_upd_net_charge_amt;    //total service AmtPayable
							 nd_net_payable=nd_net_payable+d_upd_net_charge_amt;				  //total AmtPayable	

							 nd_total_addl_charge_by_service = nd_total_addl_charge_by_service+d_addl_charge_amt_in_charge; //Total Additional Charge By Service
					         nd_total_addl_charge=nd_total_addl_charge+d_addl_charge_amt_in_charge;						   //Total Additional Charge
							
							/*******For CRF-440(Discount Document Report)*******/

							nd_serv_tot_disc=nd_serv_tot_disc+d_tot_disc;							//Service Wise Total Discount
							nd_tot_serv_tot_disc=nd_tot_serv_tot_disc+d_tot_disc;					//Grand Total Discount

							nd_serv_charge_discount=nd_serv_charge_discount+d_charge_discount;			//Service Wise Total Charge Discount
							nd_tot_serv_charge_discount=nd_tot_serv_charge_discount+d_charge_discount;	//Grand Total Charge Discount

							nd_serv_bill_discount=nd_serv_bill_discount+d_bill_discount;				//Service Wise Total Bill Discount
							nd_tot_serv_bill_discount=nd_tot_serv_bill_discount+d_bill_discount;		//Grand Total Bill Discount

							nd_serv_fund_adjustment=nd_serv_fund_adjustment+d_fund_adjustment;			//Service Wise Total Fund(policy) Discount
							nd_tot_serv_fund_adjustment=nd_tot_serv_fund_adjustment+d_fund_adjustment;	//Grand Total Fund(policy) Discount

							/*******CRF-440 *******/

							 get_gross_net_amt1();

							 nd_pat_gross_amt1=nd_pat_gross_amt1+p_gross_amt;		//total service gross
							 nd_pat_net_amt2=nd_pat_net_amt2+p_net_amt;				//total service Net	
						     nd_pat_disc_amt1=nd_pat_disc_amt1+d_upd_disc_amt;		//total service discount
							 //nd_pat_disc_amt1=nd_pat_disc_amt1+p_disc_amt;	    //total service discount

							if(d_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
							{
							
							  nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_gross_amt;
							  nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_net_amt;
							  nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d_upd_net_charge_amt;
							  nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+nd_pat_disc_amt1;
							  nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d_addl_charge_amt_in_charge;
							}
							
							 end_of_report=1;
						  }
						  
						   
					  }
						
			   }//summary end
					
						
			else
			   {
			

				 if(strcmp(d_prt_grp_hdr_code.arr,nd_prt_grp_hdr_code.arr)!=0 || strcmp(d_prt_grp_line_code.arr,nd_prt_grp_line_code.arr)!=0)
				 {
					
			
					if(nd_summary_dtl_ind.arr[3]=='S')
					{
				
						//nd_upd_net_charge_amt=0;
						nd_net_total=nd_net_total+nd_pat_net_amt2;
						nd_gross_total=nd_gross_total+nd_pat_gross_amt1;
						nd_disc_total=nd_disc_total+nd_pat_disc_amt1;
						
					  	if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
					    {
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"C")==0)  //changed from R to C by vani
							 if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0||strcmp(p_addl_charge_amt_ind.arr,"B")==0))  //changed from R to C by vani
							 {
								get_addlcharge_count();
								if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
					  		  print_formated_amt1(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt);
							  }
							 else
							 fprintf(fp,"%-11.11s"," ");
							 
							}
							
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && p_disc_amt_in_dtl_yn.arr[0]=='N')
							fprintf(fp,"%-11.11s"," ");
						
						}
						
						if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						{
						 if (strcmp(p_gross_net_amt_ind.arr,"G")==0)
						 {
						 
						 print_formated_amt(nd_pat_gross_amt1-nd_inside_pkg_gross_amt);
						 }
					    }

						if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						{
						 if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
						 print_formated_amt(nd_pat_net_amt2-nd_inside_pkg_net_amt);
						}
													
						if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						{
						 if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
						 {
						  get_discount_count();
						  if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
							{
						   if (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
						   print_formated_amt(nd_pat_disc_amt1-nd_inside_pkg_disc_amt);
						  }
						 }

						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
						 {
						   if(p_disc_amt_in_dtl_yn.arr[0]=='N')
						   {
						    if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
						    fprintf(fp,"%-9.9s"," ");
							print_formated_amt(nd_serv_tot_disc);
						   }
						   else
						   {
							print_formated_amt(nd_serv_charge_discount);
							print_formated_amt(nd_serv_bill_discount);
							print_formated_amt(nd_serv_fund_adjustment);
						   }
						 }
					
						}
						
					   if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
					   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
					   {
					    //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"R")==0)
						if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
						 print_formated_amt((nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt));
						else
						if (strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0)
					     print_formated_amt(nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt);
					   }
					
						nd_upd_net_charge_amt=0;
						nd_total_addl_charge_by_service=0;
						nd_serv_charge_discount=0;
						nd_serv_bill_discount=0;
						nd_serv_fund_adjustment=0;
						nd_serv_tot_disc=0;
						nd_inside_pkg_gross_amt=0;
						nd_inside_pkg_net_amt=0;
						nd_inside_pkg_amtpayable_amt=0;
						nd_inside_pkg_disc_amt=0;
						nd_inside_pkg_addchrg_amt=0;

					}

					 get_print_group_hd_desc3();
					 get_print_group_line_desc3();
					 get_blng_serv_desc();
					 //added by raghava on 18/03/2008
					 
					 if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					 if(nd_summary_dtl_ind.arr[3] == 'S')
					 {
					  fprintf(fp,"\n");
					  lsr_line_cnt();
					 }
					
					 /*Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e don't print the detail title description)	
					  fprintf(fp,"\n%-s/%-20s \n",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
					  Up to here*/

					//lsr_line_cnt();lsr_line_cnt();
					//fprintf(fp,"\n%-2s-%-3s\n",d_prt_grp_hdr_code.arr,d_prt_grp_line_code.arr);
					//fprintf(fp,"\n%-s/%-3s\n",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
				
					if(d_package_trx_yn.arr[0] == 'N')  // || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )  //medicity package print problem corrected here IN16757
					if (l_lsr != 0 && l_dmp == 0)
					{
					if( l_logo_yniflaser.arr[0] != 'Y')
					{
						fprintf(fp,"\n");

						print_bold_underline();
					 	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
				
							fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
							fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
							fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
							fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																											
																																		
						}
						else
					       fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); //by vani
					 lsr_line_cnt();
					 Release_bold_underline();

					 fprintf(fp,"\n");
					}
					}
					
					/********aded by vani***********/

					if (d_package_trx_yn.arr[0] == 'Y')  // && l_pkg_len!=0)  
						{													
								//strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
								//strcpy(d_line_code,d_prt_grp_line_code.arr);
								//get_grp_pkg_outside_cnt1(d_grp_code,d_line_code);SENTHIL

								/***added for merging walkthrough corrections***/
								if( strcmp(d_grp_ind.arr,"ESG")==0||strcmp(d_grp_ind.arr,"ESL")==0)
								{
									strcpy(d_grp_code,d_prt_grp_hdr_code.arr);
									strcpy(d_line_code,d_prt_grp_line_code.arr);
								}
								if(strcmp(d_grp_ind.arr,"EMG")==0)
								{
									strcpy(d_grp_code,d_ent_item_grp_code.arr);
									//strcpy(d_line_code,d_prt_grp_line_code.arr);
								}
								if(strcmp(d_grp_ind.arr,"PSG")==0||strcmp(d_grp_ind.arr,"PSL")==0)
								{
									strcpy(d_grp_code,d_payer_serv_grp_hdr.arr);
									strcpy(d_line_code,d_payer_serv_grp_line.arr);
								}
								if(strcmp(d_grp_ind.arr,"PMG")==0)
								{									
									 strcpy(d_grp_code,d_payer_item_grp_code.arr);
									//strcpy(d_line_code,d_prt_grp_line_code.arr);
								}
								/***upto here***/

								  get_grp_pkg_outside_cnt1('L',d_grp_code,d_line_code);

								if (l_grp_pkg_inside_cnt!=0)
								{
									if (l_lsr != 0 && l_dmp == 0)
									   {
									   if( l_logo_yniflaser.arr[0] != 'Y')
										{ fprintf(fp,"\n");
										  print_bold_underline();
										  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);	
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																																							
											 }
											    else
										           fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
										  lsr_line_cnt();lsr_line_cnt();
										  Release_bold_underline();
										  fprintf(fp,"\n");
										}
										}
								 }

						}

						/********upto here*******/
					

									
					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					{
						
						if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
						{
					
							if (d_summary_dtl_ind.arr[5] == 'S') 
							{
							//fprintf(fp," %-12.12s %-18.18s %-17.17s",d_blng_serv_code.arr,nd_blng_desc.arr,d_serv_item_code.arr);
							  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
							  {
							  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
									if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
									{
										fun_Pad_desc_with_spl_char(dc_physician_name.arr);
										fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 																											
									}
									else
									{
											fun_Pad_desc_with_spl_char(nd_blng_desc.arr);
											fprintf(fp," %-10.10s %s ",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr); 																											

											if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
											{
											
												fun_Pad_desc_with_spl_char(dc_physician_name.arr);
												fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr);	
											}
											else
											{
												fprintf(fp,"\n");
											}
									}
								}
								else
								{
							      if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
								  {
									fprintf(fp," %s \n",dc_physician_name.arr); 	
								  }
								  else
								  {
									  fprintf(fp," %-10.10s %s ",d_blng_serv_code.arr,nd_blng_desc.arr);   //,d_serv_item_code.arr);

									  if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
										{
											fprintf(fp," - %s \n",dc_physician_name.arr);	
										}
										else
										{
											fprintf(fp,"\n");
										}
								   }
								}
							  lsr_line_cnt();
							  fprintf(fp," %-10.10s %-14.14s "," "," ");   //,d_serv_item_code.arr);
							  }
							  else
							  {
							      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								  {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-14.14s",nd_blng_desc.arr);

											if(strcmp(d_print_pract_name_ind.arr,"I")==0)
											{
												fun_Pad_desc_with_spl_char(dc_physician_name.arr);
												fprintf(fp," %-25.25s ",nd_desc_with_spl_chr.arr);
											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp," %-10.10s %-14.14s ",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr);

												
											}
																																																											
									}
									else
									{
									   if(strcmp(d_print_pract_name_ind.arr,"I")==0)
										{
											fprintf(fp," %-25.25s ",dc_physician_name.arr);	
										}
									   fprintf(fp," %-10.10s %-14.14s ",d_blng_serv_code.arr,nd_blng_desc.arr);   //,d_serv_item_code.arr);

									   
									}
                               }

							 }
							if (d_summary_dtl_ind.arr[5] == 'A') 
							{
								if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								{
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_mapping_code_desc.arr);
										fprintf(fp," %-10.10s %s \n",d_mapping_code.arr,nd_desc_with_spl_chr.arr);																											
									}
									else
								      fprintf(fp," %-10.10s %s \n",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
								lsr_line_cnt();
								fprintf(fp," %-10.10s %-14.14s "," "," "); //,d_serv_item_code.arr);
								}
								else
								{
								   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-14.14s",nd_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-10.10s %-14.14s ",d_mapping_code.arr,nd_desc_with_spl_chr.arr); 
																																																											
									}
									 else
								        fprintf(fp," %-10.10s %-14.14s ",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
                                 }


							}
							//fprintf(fp," %-12.12s %-18.18s %-17.17s",d_mapping_code.arr,nd_mapping_code_desc.arr,d_serv_item_code.arr);
							//fprintf(fp," %-12.12s %-18.18s %-17.17s",d_serv_anal_grp.arr,nd_blng_desc.arr,d_serv_item_code.arr);
						}
						else
						{
						
							 if (d_summary_dtl_ind.arr[5] == 'S') 
							 {
								  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								  {
								  	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 																											
											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc.arr);
												fprintf(fp," %-10.10s %s",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr);																											
												if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
												{
												
													fun_Pad_desc_with_spl_char(dc_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr);	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										}
										else
										{
								           if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										  {
											fprintf(fp," %s \n",dc_physician_name.arr); 	
										  }
										  else
										  {
											   fprintf(fp," %-10.10s %s",d_blng_serv_code.arr,nd_blng_desc.arr);		//,d_serv_item_code.arr);
											   if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
												{
													fprintf(fp," - %s \n",dc_physician_name.arr);	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										}
								  lsr_line_cnt();
								  fprintf(fp," %-10.10s %-30.30s"," "," ");		//,d_serv_item_code.arr);
								  }
								  else
								  {
								      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									  {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-30.30s",nd_blng_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);

											if(strcmp(d_print_pract_name_ind.arr,"I")==0)
											{
												fun_Pad_desc_with_spl_char(dc_physician_name.arr);
												fprintf(fp," %-41.41s ",nd_desc_with_spl_chr.arr);
											}
											else
											fprintf(fp," %-10.10s %-30.30s",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr);
								 	
									 }
									 else
									 {
										if(strcmp(d_print_pract_name_ind.arr,"I")==0)
										{
											fprintf(fp," %-25.25s ",dc_physician_name.arr);	
										}
									    fprintf(fp," %-10.10s %-30.30s",d_blng_serv_code.arr,nd_blng_desc.arr);		//,d_serv_item_code.arr);
									 }
								   }

							  }
							 if (d_summary_dtl_ind.arr[5] == 'A') 
							 {
								  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								  {
								    	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										  {
								
											fun_Pad_desc_with_spl_char(nd_mapping_code_desc.arr);
											fprintf(fp," %-10.10s %s\n",d_mapping_code.arr,nd_desc_with_spl_chr.arr);																											
										}
										else
								           fprintf(fp," %-10.10s %s\n",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
								  lsr_line_cnt();
								  fprintf(fp," %-10.10s %-30.30s"," "," "); //,d_serv_item_code.arr);
								  }
								  else
								  {
								      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									  {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-30.30s",nd_mapping_code_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp," %-10.10s %-30.30s",d_mapping_code.arr,nd_desc_with_spl_chr.arr);
																																																									
									   }
										else
								           fprintf(fp," %-10.10s %-30.30s",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
								   }

							  }
						
						}
					}

				  }
				  else
				  {
					
					if(nd_summary_dtl_ind.arr[3]=='S')
					{
					

						//nd_upd_net_charge_amt=0;
						nd_net_total=nd_net_total+nd_pat_net_amt2;
						nd_gross_total=nd_gross_total+nd_pat_gross_amt1;
						nd_disc_total=nd_disc_total+nd_pat_disc_amt1;
						
					    if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						{
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"C")==0) //changed from  R to C by vani
							 if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) &&( strcmp(p_addl_charge_amt_ind.arr,"C")==0||strcmp(p_addl_charge_amt_ind.arr,"B")==0)) //changed from  R to C by vani
							 {
							 get_addlcharge_count();
							 if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
							 print_formated_amt1(nd_total_addl_charge_by_service-(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt));
							 }
							 else
							 fprintf(fp,"%-11.11s"," ");
							 
							}

							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && p_disc_amt_in_dtl_yn.arr[0]=='N')
							fprintf(fp,"%-11.11s"," ");

						}
						if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						{
						 if(strcmp(p_gross_net_amt_ind.arr,"G")==0)
						 {
						
						 print_formated_amt(nd_pat_gross_amt1-nd_inside_pkg_gross_amt);
						 }
						}
						
						if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						{
						 if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
						 print_formated_amt(nd_pat_net_amt2-nd_inside_pkg_net_amt);
						}
					
						if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						{
						 if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
						 {
						  get_discount_count();
						 if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
						 {
						  if (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
						  print_formated_amt(nd_pat_disc_amt1-nd_inside_pkg_disc_amt);
						  }
						 }

						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
						 {
						   if(p_disc_amt_in_dtl_yn.arr[0]=='N')
						   {
							if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
							fprintf(fp,"%-9.9s"," ");
							print_formated_amt(nd_serv_tot_disc);
						   }
						   else
						   {
							print_formated_amt(nd_serv_charge_discount);
							print_formated_amt(nd_serv_bill_discount);
							print_formated_amt(nd_serv_fund_adjustment);
						   }
						 }
					
						}
					    	
					   if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
					   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
					   { 
						//if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"R")==0)
						if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
					    print_formated_amt((nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt)-nd_total_addl_charge_by_service);
						else
					    {
						 if(strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0)
						 print_formated_amt(nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt);
						}
					   }
						nd_upd_net_charge_amt=0;
						nd_total_addl_charge_by_service=0;
						nd_serv_charge_discount=0;
						nd_serv_bill_discount=0;
						nd_serv_fund_adjustment=0;
						nd_serv_tot_disc=0;
						nd_inside_pkg_gross_amt=0;
						nd_inside_pkg_net_amt=0;
						nd_inside_pkg_amtpayable_amt=0;
						nd_inside_pkg_disc_amt=0;
						nd_inside_pkg_addchrg_amt=0;
					}

					get_blng_serv_desc();
					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					{
						
						if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
						{
							if (d_summary_dtl_ind.arr[5] == 'S') 
							{
							//fprintf(fp," %-12.12s %-18.18s %-17.17s",d_blng_serv_code.arr,nd_blng_desc.arr,d_serv_item_code.arr);
							  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
							  {
							  	   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										
										if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
											fun_Pad_desc_with_spl_char(dc_physician_name.arr);
											fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 																											
										}
										else
										{
											fun_Pad_desc_with_spl_char(nd_blng_desc.arr);
											fprintf(fp," %-10.10s %s",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr); 																											
											if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
										{
										
											fun_Pad_desc_with_spl_char(dc_physician_name.arr);
											fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr);	
										}
										else
										{
											fprintf(fp,"\n");
										}
										}
									}
									else
									{
							          if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
									  {
										fprintf(fp," %s \n",dc_physician_name.arr); 	
									  }
									  else
									  {
										  fprintf(fp," %-10.10s %s",d_blng_serv_code.arr,nd_blng_desc.arr);  //,d_serv_item_code.arr);
										  if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
											{
												fprintf(fp," - %s \n",dc_physician_name.arr);	
											}
											else
											{
												fprintf(fp,"\n");
											}
										}
									}
							  lsr_line_cnt();
							  fprintf(fp," %-10.10s %-14.14s "," "," ");  //,d_serv_item_code.arr);
							  }
							  else
							  {
							      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-14.14s",nd_blng_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);

											if(strcmp(d_print_pract_name_ind.arr,"I")==0)
											{
												fun_Pad_desc_with_spl_char(dc_physician_name.arr);
												fprintf(fp," %-25.25s ",nd_desc_with_spl_chr.arr);
											}
											else
											{
												fprintf(fp," %-10.10s %-14.14s ",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr);
											}
																																																											
									}
									 else
									 {
										if(strcmp(d_print_pract_name_ind.arr,"I")==0)
										{
											fprintf(fp," %-25.25s ",dc_physician_name.arr);	
										}
										else
									    fprintf(fp," %-10.10s %-14.14s ",d_blng_serv_code.arr,nd_blng_desc.arr);  //,d_serv_item_code.arr); //qunatity alignment corrected here
									 }
                               }

							 }
							if (d_summary_dtl_ind.arr[5] == 'A') 
							{
							  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
							  {
							  	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								   {
						
											fun_Pad_desc_with_spl_char(nd_mapping_code_desc.arr);
											fprintf(fp," %-10.10s %s \n",d_mapping_code.arr,nd_desc_with_spl_chr.arr);																									
								   }
								else
							        fprintf(fp," %-10.10s %s \n",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
							  lsr_line_cnt();
							  fprintf(fp," %-10.10s %-14.14s "," "," "); //,d_serv_item_code.arr);
							  }
							  else
							  {
							      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								   {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-14.14s",nd_mapping_code_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp," %-10.10s %-14.14s ",d_mapping_code.arr,nd_desc_with_spl_chr.arr);
																																																											
									}
									else
								       fprintf(fp," %-10.10s %-14.14s ",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
							   }

							 }
						//fprintf(fp," %-12.12s %-18.18s %-17.17s",d_mapping_code.arr,nd_mapping_code_desc.arr,d_serv_item_code.arr);
						//fprintf(fp," %-12.12s %-18.18s %-17.17s",d_serv_anal_grp.arr,nd_blng_desc.arr,d_serv_item_code.arr);
						}
						else
						{
						
							if (d_summary_dtl_ind.arr[5] == 'S') 
							{
							  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
							  {
							  	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
											fun_Pad_desc_with_spl_char(dc_physician_name.arr);
											fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 																											
										}
										else
										{
											fun_Pad_desc_with_spl_char(nd_blng_desc.arr);
											fprintf(fp," %-10.10s %s ",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr);																											
											if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
											{
											
												fun_Pad_desc_with_spl_char(dc_physician_name.arr);
												fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr);	
											}
											else
											{
												fprintf(fp,"\n");
											}
										}
									}
									else
									{
									  if(strcmp(d_print_pract_name_ind.arr,"I")==0) //added for crf-0809
									  {
										fprintf(fp," %s \n",dc_physician_name.arr); 	
									  }
									  else
									  {
										   fprintf(fp," %-10.10s %s ",d_blng_serv_code.arr,nd_blng_desc.arr); //,d_serv_item_code.arr);
										   if(strcmp(d_print_pract_name_ind.arr,"A")==0) //added for crf-0809
											{
												fprintf(fp," - %s \n",dc_physician_name.arr);	
											}
											else
											{
												fprintf(fp,"\n");
											}
										}
									}
							  lsr_line_cnt();
							  fprintf(fp," %-10.10s %-30.30s "," "," "); //,d_serv_item_code.arr);
							  }
							  else
							  {
							       if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-30.30s",nd_blng_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										if(strcmp(d_print_pract_name_ind.arr,"I")==0)
										{
											fun_Pad_desc_with_spl_char(dc_physician_name.arr);
											fprintf(fp," %-25.25s ",nd_desc_with_spl_chr.arr);
										}
										else
										fprintf(fp," %-10.10s %-30.30s ",d_blng_serv_code.arr,nd_desc_with_spl_chr.arr);		
																																																											
									}
									else
									{
										if(strcmp(d_print_pract_name_ind.arr,"I")==0)
										{
											fprintf(fp," %-25.25s ",dc_physician_name.arr);	
										}
										else
									    fprintf(fp," %-10.10s %-30.30s ",d_blng_serv_code.arr,nd_blng_desc.arr); //,d_serv_item_code.arr);
									}
                               }

							 }
							if (d_summary_dtl_ind.arr[5] == 'A') 
							{
								  if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")==0)
								  {
								    	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									      {
							
												fun_Pad_desc_with_spl_char(nd_mapping_code_desc.arr);
												fprintf(fp," %-10.10s %s \n",d_mapping_code.arr,nd_desc_with_spl_chr.arr);																									
								        	}
									         else
								                fprintf(fp," %-10.10s %s \n",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
								  lsr_line_cnt();
								  fprintf(fp," %-10.10s %-30.30s "," "," "); //,d_serv_item_code.arr);
								  }
								  else
								  {
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-30.30s",nd_mapping_code_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp," %-10.10s %-30.30s ",d_mapping_code.arr,nd_desc_with_spl_chr.arr); 	
																																																											
										 }
										  else
									         fprintf(fp," %-10.10s %-30.30s ",d_mapping_code.arr,nd_mapping_code_desc.arr); //,d_serv_item_code.arr);
                                   }

							 }
						
						}
					}
									
				  }
								
					get_gross_net_amt1();


					nd_net_total=nd_net_total+p_net_amt;
					nd_gross_total=nd_gross_total+p_gross_amt;
					nd_disc_total=nd_disc_total+d_upd_disc_amt;
					//nd_disc_total=nd_disc_total+p_disc_amt;
								
					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					{
						if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						{
							//if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"C")==0)  //changed by vani from R to C
							if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
							{
								get_addlcharge_count();
								if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
								print_formated_amt1(d_addl_charge_amt_in_charge);
							}
							
							else
							{
								if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
								{
								 fprintf(fp,"%-16.16s",d_service_date.arr);  //addded by vani for printing service date
								 print_formated_qty(d_serv_qty);
								 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) //for - crf-659
								 print_formated_amt(d_rate);
								}
								else
							    fprintf(fp,"%-11.11s"," "); 
								
								
							}
						}
						if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
						{
							if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
							{
							 fprintf(fp,"%-16.16s",d_service_date.arr);  //addded by vani for printing service date
							 print_formated_qty(d_serv_qty);
							 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) //for - crf-659
							 print_formated_amt(d_rate);
							}
							else
							{
							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && p_disc_amt_in_dtl_yn.arr[0]=='N')
							 fprintf(fp,"%-11.11s"," "); 
							}
					
						}
					
					}
					
					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
					{
					 if (strcmp(p_gross_net_amt_ind.arr,"G")==0)
					 {
	  				
					 print_formated_amt(p_gross_amt);
					 }
					}
					
					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
					{
					 if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
					 {
					 
					 print_formated_amt(p_net_amt);
					 }
					}

					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					{
					 if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
					 {
					 get_discount_count();
					 if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
					 {
					  if (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
					  print_formated_amt(d_upd_disc_amt);
					  }
					 }

					 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
					 {
					   if(p_disc_amt_in_dtl_yn.arr[0]=='N')
					   {
					    //if (strcmp(p_servdate_in_dtlformat_yn.arr,"N")==0)
						print_formated_amt(d_tot_disc);
					   }
					   else
					   {
					    print_formated_amt(d_charge_discount);
					    print_formated_amt(d_bill_discount);
					    print_formated_amt(d_fund_adjustment);
					   }
					 }

					}
					
					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
					{
				
					 //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"R")==0)
					 if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
					{ 
					//sprintf(st_var,"%f",d_upd_net_charge_amt);
					//disp_message(ERR_MESG,st_var); 

					  print_formated_amt(d_upd_net_charge_amt-d_addl_charge_amt_in_charge);
				}
					 else
					 {
					  if (strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0)
					  print_formated_amt(d_upd_net_charge_amt);
					 }
					}
					
					nd_total_addl_charge=nd_total_addl_charge+d_addl_charge_amt_in_charge; //Total Additional Charge For Detail Part
					nd_net_payable=nd_net_payable+d_upd_net_charge_amt;					   //Total Amt Paybale For Detail Part
				
					nd_tot_serv_tot_disc=nd_tot_serv_tot_disc+d_tot_disc;				//Grand Total Discount
					nd_tot_serv_charge_discount=nd_tot_serv_charge_discount+d_charge_discount;	//Grand Total Charge Discount
					nd_tot_serv_bill_discount=nd_tot_serv_bill_discount+d_bill_discount;		//Grand Total Bill Discount
					nd_tot_serv_fund_adjustment=nd_tot_serv_fund_adjustment+d_fund_adjustment;	//Grand Total Fund(policy) Discount
					
					
					if(d_package_trx_yn.arr[0] == 'N' || (d_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
					 fprintf(fp,"\n");
					 lsr_line_cnt();

					ccnt=0;
					nd_pat_gross_amt1=0;
					nd_pat_net_amt2=0;
					nd_pat_disc_amt1=0;
					nd_upd_net_charge_amt=0;
					nd_total_addl_charge_by_service=0;
					nd_serv_charge_discount=0;
					nd_serv_bill_discount=0;
					nd_serv_fund_adjustment=0;
					nd_serv_tot_disc=0;
					end_of_report=0;
				 }
				
				/*** added by vani for printing PH Batch Details*******/
				if(strcmp(d_mapping_code_ind.arr,"M")==0 && strcmp(d_folio_batch_id.arr,"\0")!=0)
				{
				if(d_summary_dtl_ind.arr[3] == 'D') 
				get_ph_batch_details();
				if(strcmp(d_print_pract_name_ind.arr,"S")==0)
					fprintf(fp," - ");
				}
				/*********End of Batch Id*******/

				/****Added by Vani for crf-0809***/
				//if (strcmp(p_serv_desc_sep_line_yn.arr,"Y")!=0)
				if(strcmp(d_print_pract_name_ind.arr,"S")==0)
				{
					fprintf(fp," %s",dc_physician_name.arr); 
					fprintf(fp,"\n");
				}
				/***upto Here***/
		  
			   strcpy(nd_prt_grp_hdr_code.arr,d_prt_grp_hdr_code.arr);
			   strcpy(nd_prt_grp_line_code.arr,d_prt_grp_line_code.arr);
			   strcpy(nd_payer_serv_grp_hdr.arr,d_payer_serv_grp_hdr.arr);
			   strcpy(nd_payer_serv_grp_line.arr,d_payer_serv_grp_line.arr);
			   strcpy(nd_blng_serv_code.arr,d_blng_serv_code.arr); //ADDED AT 29/10/2007
			   strcpy(nd_serv_anal_grp.arr,d_serv_anal_grp.arr); 
			   strcpy(nd_summary_dtl_ind.arr,d_summary_dtl_ind.arr);
			   strcpy(nd_package_trx_yn.arr,d_package_trx_yn.arr);
		  
		  
		  }
		 else
			{  					
				 oth_cnt=oth_cnt+1;
				 if (strcmp(d_cust_code1.arr,nd_cust_code1.arr)==0)
				 {
				   
				   nd_oth_payer_amt=nd_oth_payer_amt+d_upd_net_charge_amt;
				   nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+d_upd_net_charge_amt;

				 }
				 else
				 {

					if (oth_cnt==1)
					{					
					  nd_oth_payer_amt=nd_oth_payer_amt+d_upd_net_charge_amt;
					  nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+d_upd_net_charge_amt;
				
					}
					else
					{
					  //nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+nd_oth_payer_amt;

						/*** Below Code Added for CRF-659 ***/
						l_cust_code.arr[0] ='\0';
						l_cust_code.len = 0;
						strcpy(l_cust_code.arr,nd_cust_code1.arr);
						l_cust_code.len=strlen(nd_cust_code1.arr);
						l_cust_code.arr[l_cust_code.len]='\0';
						get_bill_num(2);
						strcpy(bill_code[k],l_bill_num_temp.arr);       
						/*** Up To Here ***/
						
						strcpy(ar_cust_amt[k],nd_cust_nm.arr);
						put_val(ar_amt[k],nd_oth_payer_amt); 
						format_amt(ar_amt[k]);
						sprintf(st_var,"%d",k);
							
						nd_oth_payer_amt=0;
						nd_oth_payer_amt=nd_oth_payer_amt+d_upd_net_charge_amt;
						nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+d_upd_net_charge_amt;
						k=k+1;

					}
					
				 }
				 
				ccnt=0;
				nd_cust_code1.arr[0] ='\0';
				nd_cust_code1.len = 0;
				l_bill_num_temp.arr[0]='\0';
			    l_bill_num_temp.len=0;
				strcpy(nd_cust_code1.arr,d_cust_code1.arr);

				fetch_customer1();
				strcpy(nd_cust_nm.arr,d_customer2.arr);

			    /*** Below Code Added for CRF-659 ***/
			    strcpy(l_cust_code.arr,d_cust_code1.arr);
			    l_cust_code.len=strlen(d_cust_code1.arr);
			    l_cust_code.arr[l_cust_code.len]='\0';
			    
							
				get_bill_num(2);
			   //disp_message(ERR_MESG,l_bill_num.arr);
			    strcpy(bill_code[0],l_bill_num.arr); 
				strcpy(l_bill_num_temp.arr,l_bill_num.arr); 
			   //disp_message(ERR_MESG,l_bill_num_temp.arr);
			    /*** Up To Here ***/

			  //nd_cust_code1.arr[nd_cust_code1.len]='\0';


		   }
		   
		  //strcpy(nd_cust_code1.arr,d_cust_code1.arr);
	   
	   /*
	   strcpy(nd_prt_grp_hdr_code.arr,d_prt_grp_hdr_code.arr);
	   strcpy(nd_prt_grp_line_code.arr,d_prt_grp_line_code.arr);
	   strcpy(nd_payer_serv_grp_hdr.arr,d_payer_serv_grp_hdr.arr);
	   strcpy(nd_payer_serv_grp_line.arr,d_payer_serv_grp_line.arr);
	   strcpy(nd_blng_serv_code.arr,d_blng_serv_code.arr); //ADDED AT 29/10/2007
	   strcpy(nd_serv_anal_grp.arr,d_serv_anal_grp.arr); 
	   strcpy(nd_summary_dtl_ind.arr,d_summary_dtl_ind.arr);
	   strcpy(nd_package_trx_yn.arr,d_package_trx_yn.arr);
	   */

	}


}
/* THIS FUNCTION WILL PRINT PATIENT BILL WITH  SUBSIDIZED AMT */

print_patient_hdr()
 {

	

	/****added by vani for crf-0809 ***/
		c_get_pract_name_dtl_format_ind();
		c_get_print_pract_name_ind();
	/*********/

	 if (strcmp(d1_cust_code1.arr,"\0")==0)
	  {
	  
		 if (d1_summary_dtl_ind.arr[3] == 'S')  
		  {
			
			  //sprintf(st_var,"%d",ccnt);
			  //disp_message(ERR_MESG,st_var);
				if( ccnt==1)
				 {                       
						get_print_group_hd_desc();  
						get_print_group_line_desc();
						//get_blng_serv_desc1();
	  

					 if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
					  {	

						if(nd2_summary_dtl_ind.arr[3] == 'D')
					    {
						    
							if(d1_summary_dtl_ind.arr[4] == 'L') 
							{
								
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								print_bold_underline();
								if(nd_print_option.arr[0]=='R')
								{
								 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
								 strcat(nd_line_text.arr,"/");
								 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
								}
								else
								if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								{
								  nd_temp_str.arr[0]='\0';
								  nd_temp_str.len=0;
								  fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
								  strcat(nd_temp_str.arr,nd_desc_with_spl_chr.arr);
								  strcat(nd_temp_str.arr,"/");
								  fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
								  strcat(nd_temp_str.arr,nd_desc_with_spl_chr.arr);
							      fprintf(fp,"%-s",nd_temp_str.arr);
								}
								else
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
							
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr); 
										fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
										fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr); 
										fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);																																					
									}
									else
								      fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
								Release_bold_underline();
								if(nd_print_option.arr[0]=='R')
								fun_bl_report_temp_format();
								else
								fprintf(fp,"\n");
								}
								}
						
								if(l_no_of_clumns ==5)
								{
									
									if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
									{
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
										if(nd_print_option.arr[0]=='R')
										{
										 fun_add_space(12);
										 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										 fun_add_space(4);
										 fun_bl_report_temp_format();
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
										  fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
										  fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);
										}
										else
										{
										  	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
									
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);																											
											}
											 else
										       fprintf(fp,"%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
                                         }
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(77);
										else
										fprintf(fp,"%-11.11s %-61.61s    "," "," ");
										}
										else
										{
										 if(nd_print_option.arr[0]=='R')
										 {
										   fun_add_space(12);
										   strncat(nd_line_text.arr,nd_prt_line_desc.arr,61);
										   if(strlen(nd_prt_line_desc.arr)<61)
										   fun_add_space(61-strlen(nd_prt_line_desc.arr));
										   fun_add_space(4);
										 }
										 else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										   nd_temp_str.arr[0]='\0';
										   nd_temp_str.len=0;
										   sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_line_desc.arr);
										   fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										   fprintf(fp,"%-11.11s %-61.61s    "," ",nd_desc_with_spl_chr.arr);

										 }
										   else
											 {
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
													    fprintf(fp,"%-11.11s %-61.61s    "," ",nd_desc_with_spl_chr.arr);
																																																												
													}
													else
													  fprintf(fp,"%-11.11s %-61.61s    "," ",nd_prt_line_desc.arr);
											 }
										}
									}
									else
									{
										if (strcmp(c_addl_charge_amt_ind.arr,"C")==0)
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_add_space(13);
											 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
											 fun_add_space(3);
											 fun_bl_report_temp_format();
											}
											else
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										    {
										     fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											 fprintf(fp,"%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
										    }
										    else
											fprintf(fp,"%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
											lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(39);
											else
											fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
											}
											else
											{
											 if(nd_print_option.arr[0]=='R')
											 {
											  fun_add_space(13);
											  strncat(nd_line_text.arr,nd_prt_line_desc.arr,23);
											  if(strlen(nd_prt_line_desc.arr)<23)
											  fun_add_space(23-strlen(nd_prt_line_desc.arr));
										      fun_add_space(3);
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);

											 }
											 else
											 fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_prt_line_desc.arr);
											}
										}
										else
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_add_space(13);
											  if(strlen(nd_prt_line_desc.arr)<34)
											   {
												fun_add_space(34-strlen(nd_prt_line_desc.arr));
												strcat(nd_line_text.arr,nd_prt_line_desc.arr);
											   }
											   else
											   strncat(nd_line_text.arr,nd_prt_line_desc.arr,34);
											}
											else
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-34.34s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"%-11.11s  %34.34s   \n"," ",nd_desc_with_spl_chr.arr);

											 }
											else
											fprintf(fp,"%-11.11s  %34.34s   \n"," ",nd_prt_line_desc.arr);
											lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(40);
											else
											fprintf(fp,"%-11.11s  %-34.34s   "," "," ");
											}
											else
											{
											  if(nd_print_option.arr[0]=='R')
											 {
											  fun_add_space(13);
											  strncat(nd_line_text.arr,nd_prt_line_desc.arr,34);
											  if(strlen(nd_prt_line_desc.arr)<34)
											  fun_add_space(34-strlen(nd_prt_line_desc.arr));
										      fun_add_space(3);
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-34.34s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"%-11.11s  %-34.34s   "," ",nd_desc_with_spl_chr.arr);
									
											 }
											 else
											 fprintf(fp,"%-11.11s  %-34.34s   "," ",nd_prt_line_desc.arr);
											}
										}
									}
								}
								else
								{
								if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
								{
								  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
								  {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(11);
										  strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										  fun_bl_report_temp_format();
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
								
										 }
										 else
										fprintf(fp,"%-11.11s%s\n"," ",nd_prt_line_desc.arr);
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(61);
										else
										fprintf(fp,"%-11.11s%-50.50s"," "," ");	
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(11);
									  strncat(nd_line_text.arr,nd_prt_line_desc.arr,50);
									  if(strlen(nd_prt_line_desc.arr)<50)
									  fun_add_space(50-strlen(nd_prt_line_desc.arr));
									 }
									 else
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_line_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
															
									 }
									 else
									 fprintf(fp,"%-11.11s%-50.50s"," ",nd_prt_line_desc.arr);
									}
								  }
								  else
								  {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									 {
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(14);
										  strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										  fun_add_space(2);
										  fun_bl_report_temp_format();
										}
										else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																
										 }
										 else
										fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(45);
										else
										fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									 {
									   fun_add_space(14);
									   strncat(nd_line_text.arr,nd_prt_line_desc.arr,29);
									   if(strlen(nd_prt_line_desc.arr)<29)
									   fun_add_space(29-strlen(nd_prt_line_desc.arr));
									   fun_add_space(2);
									 }
									 else
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_line_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
															
									 }
									 else
									 fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_prt_line_desc.arr);
									}
								  }
								}
								else
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(14);
										  strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										  fun_add_space(2);
										  fun_bl_report_temp_format();
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									    {
										 fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										 fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
															
									    }
									    else
										fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(40);
										else
										fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
									}
									else
									{ 
									 if(nd_print_option.arr[0]=='R')
									  {
									   fun_add_space(14);
									   strncat(nd_line_text.arr,nd_prt_line_desc.arr,26);
									   if(strlen(nd_prt_line_desc.arr)<26)
									   fun_add_space(26-strlen(nd_prt_line_desc.arr));
									   fun_add_space(2);
									 }
									 else
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
															
									 }
									 else
									 fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
									}
								}
								}
								//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
								//fprintf(fp,"%-19.19s / %-19.19s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
								
							}
							else
							{
							
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								print_bold_underline();
								if(nd_print_option.arr[0]=='R')
								strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
								else
								 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																					
								 }
								 else
							    fprintf(fp,"%-s",nd_prt_hd_desc.arr);
								Release_bold_underline();

								if(nd_print_option.arr[0]=='R')
								fun_bl_report_temp_format();
								else
								fprintf(fp,"\n");lsr_line_cnt();
								}
								}
								else
								{
								 if(nd_print_option.arr[0]=='R')
								 {
								  strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
								  fun_bl_report_temp_format();
								 }
								 else
							     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
								
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s\n",nd_prt_hd_desc.arr);
														
								 }
								 else
								 fprintf(fp,"%-s\n",nd_prt_hd_desc.arr);lsr_line_cnt();
								}
							
								if(l_no_of_clumns ==5)
								{
								
								  if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
								  {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										 fun_add_space(12);
										 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
										 fun_add_space(4);
										 fun_bl_report_temp_format();
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									    {
								
										fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);
																						
									    }
									    else
										fprintf(fp,"%-11.11s %s    \n"," ",nd_prt_hd_desc.arr);
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(77);
										else
										fprintf(fp,"%-11.11s %-61.61s    "," "," ");
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									 {
									   fun_add_space(12);
									   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,61);
									   if(strlen(nd_prt_hd_desc.arr)<61)
									   fun_add_space(61-strlen(nd_prt_hd_desc.arr));
									   fun_add_space(4);

									 }
									 else
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									{
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_hd_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"%-11.11s %-61.61s    "," ",nd_desc_with_spl_chr.arr);
							
									}
									else 
									 fprintf(fp,"%-11.11s %-61.61s    "," ",nd_prt_hd_desc.arr);
									}
								  }
								  else
								  {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										 fun_add_space(13);
										 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
										 fun_add_space(3);
										 fun_bl_report_temp_format();
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										{
						
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																
										}
										else
										fprintf(fp,"%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(39);
										else
										fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									 {
									   fun_add_space(12);
									   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,23);
									   if(strlen(nd_prt_hd_desc.arr)<23)
									   fun_add_space(23-strlen(nd_prt_hd_desc.arr));
									   fun_add_space(4);
									 }
									 else
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_hd_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
							
									  }
									  else 
									  fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_prt_hd_desc.arr);
									}
								  }
								}
								else
								{
										
								  if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
								  {
									  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
									  {
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_add_space(11);
											 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
											 fun_bl_report_temp_format();
											}
											else
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
										
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																		
											  }
											 else 
											fprintf(fp,"%-11.11s%s\n"," ",nd_prt_hd_desc.arr);
											lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(61);
											else
											fprintf(fp,"%-11.11s%-50.50s"," "," ");
										}
										else
										{
										if(nd_print_option.arr[0]=='R')
										 {
										   fun_add_space(11);
										   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,50);
										   if(strlen(nd_prt_hd_desc.arr)<50)
										   fun_add_space(50-strlen(nd_prt_hd_desc.arr));
										 }
										 else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																	
										  }
										  else 
										 fprintf(fp,"%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr);
										}
									  }
									  else
									  {
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_add_space(14);
											 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
											 fun_add_space(2);
											 fun_bl_report_temp_format();
											}
											else
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
											
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																										
											 }
											else 
											fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
											lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(45);
											else
											fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
										}
										else
										{
										 if(nd_print_option.arr[0]=='R')
										 {
										   fun_add_space(14);
										   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,29);
										   if(strlen(nd_prt_hd_desc.arr)<29)
										   fun_add_space(29-strlen(nd_prt_hd_desc.arr));
										   fun_add_space(2);
										 }
										 else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
								
																	
										  }
										  else 
										 fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_prt_hd_desc.arr);
										}
									  }
								  }
								  else
								  {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										 fun_add_space(14);
										 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
										 fun_add_space(2);
										 fun_bl_report_temp_format();
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
									
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																
																	
										 }
										fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(42);
										else
										fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
									}
									else
									{
									if(nd_print_option.arr[0]=='R')
									 {
									   fun_add_space(14);
									   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,26);
									   if(strlen(nd_prt_hd_desc.arr)<26)
									   fun_add_space(26-strlen(nd_prt_hd_desc.arr));
									   fun_add_space(2);
									 }
									 else
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																						
									  }
									  else 
									 fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_prt_hd_desc.arr);
									}
								  }

								}
							   //fprintf(fp," %-10.10s %-19.19s %-9.9s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
							}
						}
						else
						{
							if(d1_summary_dtl_ind.arr[4] == 'L') 
							{
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								print_bold_underline();
								if(nd_print_option.arr[0]=='R')
								{
								   strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
								   strcat(nd_line_text.arr,"/");
								   strcat(nd_line_text.arr,nd_prt_line_desc.arr);
								}
								else
								if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
							
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
									fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
									fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
					
															
								 }
								else 
								fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
								Release_bold_underline();
								}
								}
														
								if(l_no_of_clumns ==5)
								{
									if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
									{
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_bl_report_temp_format();
											 fun_add_space(13);
											 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
											 fun_add_space(3);
											 fun_bl_report_temp_format();
											}
											else
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												fun_Pad_desc_with_spl_char(nd_desc_with_spl_chr.arr);
												fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);												
											  }
											else 
											fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
											lsr_line_cnt();lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(77);
											else
											fprintf(fp,"%-11.11s  %-61.61s   "," "," ");
										}
										else
										{
										 
										 if(nd_print_option.arr[0]=='R')
										 {
										   fun_bl_report_temp_format();
										   fun_add_space(13);
										   strncat(nd_line_text.arr,nd_prt_line_desc.arr,61);
										   if(strlen(nd_prt_line_desc.arr)<61)
										   fun_add_space(61-strlen(nd_prt_line_desc.arr));
										   fun_add_space(3);
										 }
										 else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_desc_with_spl_chr.arr);
																							
										  }
										  else 
										 fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_prt_line_desc.arr);
										 //fprintf(fp,"\n%-11.11s  %-37.37s   "," ",nd_prt_line_desc.arr);
										}
									}
									else
									{
										if (strcmp(c_addl_charge_amt_ind.arr,"C")==0)
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												 fun_bl_report_temp_format();
												 fun_add_space(13);
												 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
												 fun_add_space(3);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
									
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																									
												  }
												else 
												fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(39);
												else
												fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
											 }
											else
											{
											 if(nd_print_option.arr[0]=='R')
											 {
											   fun_bl_report_temp_format();
											   fun_add_space(13);
											   strncat(nd_line_text.arr,nd_prt_line_desc.arr,23);
											   if(strlen(nd_prt_line_desc.arr)<23)
											   fun_add_space(23-strlen(nd_prt_line_desc.arr));
											   fun_add_space(3);
											 }
											 else
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											{
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
											}
											else
											fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_prt_line_desc.arr);
											}
										}
										else
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												 fun_bl_report_temp_format();
												 fun_add_space(13);
												 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
												 fun_add_space(3);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												{
										
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
												
												}
											   else
												fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(42);
												else
												fprintf(fp,"%-11.11s  %-26.26s   "," "," ");
											}
											else
											{
											 if(nd_print_option.arr[0]=='R')
											 {
											   fun_bl_report_temp_format();
											   fun_add_space(13);
											   strncat(nd_line_text.arr,nd_prt_line_desc.arr,26);
											   if(strlen(nd_prt_line_desc.arr)<26)
											   fun_add_space(26-strlen(nd_prt_line_desc.arr));
											   fun_add_space(3);
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_desc_with_spl_chr.arr);
												
											}
											else
											 fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_prt_line_desc.arr); 
											}
										}
									}
								
								}
								else
								{
									if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
									{
										if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												 fun_bl_report_temp_format();
												 fun_add_space(11);
												 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
												
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																							
												}
												fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(61);
												else
												fprintf(fp,"%-11.11s%-50.50s"," "," ");
											}
											else
											{
											 if(nd_print_option.arr[0]=='R')
											 {
											   fun_bl_report_temp_format();
											   fun_add_space(11);
											   strncat(nd_line_text.arr,nd_prt_line_desc.arr,50);
											   if(strlen(nd_prt_line_desc.arr)<50)
											   fun_add_space(50-strlen(nd_prt_line_desc.arr));
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																					
											}
											else
											 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_line_desc.arr);
											}
										}
										else
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												 fun_bl_report_temp_format();
												 fun_add_space(14);
												 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
												 fun_add_space(2);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
											
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																
												}
												else
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(45);
												else
												fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
											}
											else
											{
											  if(nd_print_option.arr[0]=='R')
											 {
											   fun_bl_report_temp_format();
											   fun_add_space(14);
											   strncat(nd_line_text.arr,nd_prt_line_desc.arr,29);
											   if(strlen(nd_prt_line_desc.arr)<29)
											   fun_add_space(29-strlen(nd_prt_line_desc.arr));
											   fun_add_space(14);
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
																														
											}
											else
											 fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_prt_line_desc.arr);
											}
										}
									}
									else
									{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												
												if(nd_print_option.arr[0]=='R')
												{
												 fun_bl_report_temp_format();
												 fun_add_space(14);
												 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
												 fun_add_space(2);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
																																									
												}
												else
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(42);
												else
												fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
											}
											else
											{
											  if(nd_print_option.arr[0]=='R')
											 {
											   fun_bl_report_temp_format();
											   fun_add_space(14);
											   strncat(nd_line_text.arr,nd_prt_line_desc.arr,26);
											   if(strlen(nd_prt_line_desc.arr)<26)
											   fun_add_space(26-strlen(nd_prt_line_desc.arr));
											   fun_add_space(2);
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																								
											}
											else
											 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
											}
									}
								}
								//fprintf(fp,"\n%-19.19s    %-19.19s",nd_prt_line_desc.arr," ");
								//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
								//fprintf(fp,"\n%-19.19s / %-19.19s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
								
							}
							else
							{
								if (l_lsr != 0 && l_dmp == 0)
								{
								if( l_logo_yniflaser.arr[0] != 'Y')
								{
								
								print_bold_underline();
								if(nd_print_option.arr[0]=='R')
								strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
								else
								if(strcmp(nd_pad_req_yn.arr,"Y")==0)
								 {
									fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
									fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																												
								}
								else
								fprintf(fp,"%-s",nd_prt_hd_desc.arr);
								Release_bold_underline();
								//fprintf(fp,"\n");
								}
								}
									
								if(l_no_of_clumns ==5)
								{								 
									if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
									{
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_bl_report_temp_format();
											 fun_add_space(13);
											 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
											 fun_add_space(3);
											 fun_bl_report_temp_format();
											}
											else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
										
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																																
											}
											else
											fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
											lsr_line_cnt();lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(77);
											else
											fprintf(fp,"%-11.11s  %-61.61s   "," "," ");
										}
										else
										{
									     if(nd_print_option.arr[0]=='R')
										 {
										   fun_bl_report_temp_format();
										   fun_add_space(13);
										   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,61);
										   if(strlen(nd_prt_hd_desc.arr)<61)
										   fun_add_space(61-strlen(nd_prt_hd_desc.arr));
										   fun_add_space(3);
										 }
										 else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_desc_with_spl_chr.arr);
								
																																							
										}
										else
										 fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_prt_hd_desc.arr);
										 //fprintf(fp,"\n%-11.11s  %-37.37s   "," ",nd_prt_hd_desc.arr);
										}
									}
									else
									{
										
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_bl_report_temp_format();
											 fun_add_space(13);
											 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
											 fun_add_space(3);
											 fun_bl_report_temp_format();
											}
											else
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
											
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
												
																																								
											}
											else
											fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
											lsr_line_cnt();lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(39);
											else
											fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
										}
										else
										{
										 if(nd_print_option.arr[0]=='R')
										 {
										   fun_bl_report_temp_format();
										   fun_add_space(13);
										   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,23);
										   if(strlen(nd_prt_hd_desc.arr)<23)
										   fun_add_space(23-strlen(nd_prt_hd_desc.arr));
										   fun_add_space(3);
										 }
										 else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
															
																																							
										}
										else
										 fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_prt_hd_desc.arr);
										}
									}
								
								}
								else
								{
									if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
									{
										if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												 fun_bl_report_temp_format();
												 fun_add_space(11);
												 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
											
													fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
													fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																								
																																									
												}
												else
												fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(61);
												else
												fprintf(fp,"%-11.11s%-50.50s"," "," ");
											}
											else
											{
											 if(nd_print_option.arr[0]=='R')
											 {
											   fun_bl_report_temp_format();
											   fun_add_space(11);
											   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,50);
											   if(strlen(nd_prt_hd_desc.arr)<50)
											   fun_add_space(50-strlen(nd_prt_hd_desc.arr));
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																	
																																								
											}
											else
											 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr);
											}
										}
										else
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												 fun_bl_report_temp_format();
												 fun_add_space(14);
												 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
												 fun_add_space(2);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
													
																																									
												}
												else
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(45);
												else
												fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
											}
											else
											{
											 if(nd_print_option.arr[0]=='R')
											 {
											   fun_bl_report_temp_format();
											   fun_add_space(11);
											   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,29);
											   if(strlen(nd_prt_line_desc.arr)<29)
											   fun_add_space(29-strlen(nd_prt_line_desc.arr));
											   fun_add_space(2);
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_hd_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
																									
																																								
											}
											else
											 fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_prt_hd_desc.arr);
										}   }
									}
									else
									{
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(nd_print_option.arr[0]=='R')
											{
											 fun_bl_report_temp_format();
											 fun_add_space(14);
											 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
											 fun_add_space(2);
											 fun_bl_report_temp_format();
											}
											else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
										
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
										        fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																	
																																						
											}
											else
											fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
											lsr_line_cnt();lsr_line_cnt();
											if(nd_print_option.arr[0]=='R')
											fun_add_space(42);
											else
											fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
										}
										else
										{
										 if(nd_print_option.arr[0]=='R')
										 {
										   fun_bl_report_temp_format();
										   fun_add_space(11);
										   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,26);
										   if(strlen(nd_prt_line_desc.arr)<26)
										   fun_add_space(26-strlen(nd_prt_line_desc.arr));
										   fun_add_space(2);
										 }
										 else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																
																																							
										}
										else
										 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_hd_desc.arr);
										}
									}
									
									lsr_line_cnt();
									//fprintf(fp," %-10.10s %-19.19s %-9.9s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
									
								}
							}
						
						 }
					   }

					/*******added by vani**********/
					if(d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) 
					 {
							//strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							//get_grp_pkg_outside_cnt(d_grp_code,d_line_code); SENTHIL


							/**added for merging walkthrough corrections**/
								if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,d1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,d1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,d1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,d1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							
							/***upto here***/


							 get_grp_pkg_outside_cnt('L',d_grp_code,d_line_code);
							if (l_grp_pkg_inside_cnt!=0)
							{
									if(nd2_summary_dtl_ind.arr[3] == 'D')
								{
									
									if(d1_summary_dtl_ind.arr[4] == 'L') 
									{
										if (l_lsr != 0 && l_dmp == 0)
										{
										if( l_logo_yniflaser.arr[0] != 'Y')
										{
										print_bold_underline();
										if(nd_print_option.arr[0]=='R')
										{
										 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
										 strcat(nd_line_text.arr,"/");
										 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																									
																																							
										}
										else
										fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
										Release_bold_underline();
										if(nd_print_option.arr[0]=='R')
										fun_bl_report_temp_format();
										else
										fprintf(fp,"\n");lsr_line_cnt();
										}
										}
								
										if(l_no_of_clumns ==5)
										{
											
											if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(nd_print_option.arr[0]=='R')
													{
													 fun_add_space(12);
													 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
													 fun_add_space(4);
													 fun_bl_report_temp_format();
													}
													else
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
													
														fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													    fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);
																																														
																																										
													}
													else
													fprintf(fp,"%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
													lsr_line_cnt();
													if(nd_print_option.arr[0]=='R')
													fun_add_space(77);
													else
													fprintf(fp,"%-11.11s %-61.61s    "," "," ");
												}
												else
												{
												 if(nd_print_option.arr[0]=='R')
												 {
											       fun_add_space(12);
												   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,61);
												   if(strlen(nd_prt_line_desc.arr)<61)
												   fun_add_space(61-strlen(nd_prt_line_desc.arr));
												   fun_add_space(4);
												 }
												 else
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												    fprintf(fp,"%-11.11s %-61.61s    "," ",nd_desc_with_spl_chr.arr);																					
																																									
												}
												else
												 fprintf(fp,"%-11.11s %-61.61s    "," ",nd_prt_line_desc.arr);
												}
											}
											else
											{
												if (strcmp(c_addl_charge_amt_ind.arr,"C")==0)
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(nd_print_option.arr[0]=='R')
														{
														 fun_add_space(13);
														 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
														 fun_add_space(3);
														 fun_bl_report_temp_format();
														}
														else
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
												
															fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
															fprintf(fp,"%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																										
														}
														else
														fprintf(fp,"%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();
														if(nd_print_option.arr[0]=='R')
														fun_add_space(39);
														else
														fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
													}
													else
													{
													 if(nd_print_option.arr[0]=='R')
													 {
													   fun_add_space(13);
													   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,23);
													   if(strlen(nd_prt_line_desc.arr)<23)
													   fun_add_space(23-strlen(nd_prt_line_desc.arr));
													   fun_add_space(3);
													 }
													 else
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
																															
																																										
													}
													else
													 fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_prt_line_desc.arr);
													}
												}
												else
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(nd_print_option.arr[0]=='R')
														{
														 fun_add_space(13);
														 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
														 fun_add_space(3);
														 fun_bl_report_temp_format();
														}
														else
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
															
															fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
															fprintf(fp,"%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																								
														}
														else
														fprintf(fp,"%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();
														if(nd_print_option.arr[0]=='R')
														fun_add_space(40);
														else
														fprintf(fp,"%-11.11s  %-34.34s   "," "," ");
													}
													else
													{
													  if(nd_print_option.arr[0]=='R')
													 {
													   fun_add_space(13);
													   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,34);
													   if(strlen(nd_prt_line_desc.arr)<34)
													   fun_add_space(34-strlen(nd_prt_line_desc.arr));
													   fun_add_space(3);
													 }
													 else
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-34.34s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"%-11.11s  %-34.34s   "," ",nd_desc_with_spl_chr.arr);
																															
																																										
													}
													else
													 fprintf(fp,"%-11.11s  %-34.34s   "," ",nd_prt_line_desc.arr);
													}
												}
											}
										}
										else
										{
											if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
											{
												if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(nd_print_option.arr[0]=='R')
														{
														 fun_add_space(11);
														 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
														 fun_bl_report_temp_format();
														}
														else
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
															fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
															fprintf(fp,"%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																																																				
														}
														else
														fprintf(fp,"%-11.11s%s\n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();
														if(nd_print_option.arr[0]=='R')
														fun_add_space(61);
														else
														fprintf(fp,"%-11.11s%-50.50s"," "," ");
													}
													else
													{
													  if(nd_print_option.arr[0]=='R')
													 {
													   fun_add_space(11);
													   strncat(nd_line_text.arr,nd_prt_line_desc.arr,50);
													   if(strlen(nd_prt_line_desc.arr)<50)
													   fun_add_space(50-strlen(nd_prt_line_desc.arr));
													 }
													 else
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																															
																																										
													}
													else
													 fprintf(fp,"%-11.11s%-50.50s"," ",nd_prt_line_desc.arr);
													}
												}
												else
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(nd_print_option.arr[0]=='R')
														{
														 fun_add_space(14);
														 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
														 fun_add_space(2);
														 fun_bl_report_temp_format();
														}
														else
														 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
														  fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
														  fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																							
														}
														else
														fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();
													    if(nd_print_option.arr[0]=='R')
														fun_add_space(45);
														else
														fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
													}
													else
													{
													  if(nd_print_option.arr[0]=='R')
													 {
													   fun_add_space(14);
													   strncat(nd_line_text.arr,nd_prt_line_desc.arr,29);
													   if(strlen(nd_prt_line_desc.arr)<29)
													   fun_add_space(29-strlen(nd_prt_line_desc.arr));
													   fun_add_space(2);
													 }
													 else
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
																		
																																										
													}
													else
													 fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_prt_line_desc.arr);
													}
												}
											}
										else
										  {
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(nd_print_option.arr[0]=='R')
													{
													 fun_add_space(14);
													 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
													 fun_add_space(2);
													 fun_bl_report_temp_format();
													}
													else
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
														fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																											
													}
													else
													fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
													lsr_line_cnt();
													if(nd_print_option.arr[0]=='R')
													fun_add_space(42);
													else
													fprintf(fp,"%-11.11s   %-29.29s  "," "," ");	
												}
												else
												{
												  if(nd_print_option.arr[0]=='R')
												 {
												   fun_add_space(14);
												   strncat(nd_line_text.arr,nd_prt_line_desc.arr,26);
												   if(strlen(nd_prt_line_desc.arr)<26)
												   fun_add_space(26-strlen(nd_prt_line_desc.arr));
												   fun_add_space(2);
												 }
												 else
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																							
												}
												else
												 fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
												}
										  }
										}
										//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
										//fprintf(fp,"%-19.19s / %-19.19s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
										
									}
									else
									{
									
										if (l_lsr != 0 && l_dmp == 0)
										{
										if( l_logo_yniflaser.arr[0] != 'Y')
										{
										print_bold_underline();
										if(nd_print_option.arr[0]=='R')
										strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										else
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																			
										}
										else
										fprintf(fp,"%-s",nd_prt_hd_desc.arr);
										Release_bold_underline();
										if(nd_print_option.arr[0]=='R')
										fun_bl_report_temp_format();
										else
										fprintf(fp,"\n");lsr_line_cnt();
										}
										}
										else
										{
										if(nd_print_option.arr[0]=='R')
										fun_bl_report_temp_format();
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-s\n",nd_desc_with_spl_chr.arr);
																																									
										}
										else
										fprintf(fp,"%-s\n",nd_prt_hd_desc.arr);
										}
									
										if(l_no_of_clumns ==5)
										{
										
										  if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
										  {
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(nd_print_option.arr[0]=='R')
													{
													 fun_add_space(12);
													 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
													 fun_add_space(4);
													 fun_bl_report_temp_format();
													}
													else
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
													
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);
																																																							
													}
													else
													fprintf(fp,"%-11.11s %s    \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();
													if(nd_print_option.arr[0]=='R')
													fun_add_space(77);
													else
													fprintf(fp,"%-11.11s %-61.61s    "," "," ");
												}
												else
												{
												  if(nd_print_option.arr[0]=='R')
												 {
												   fun_add_space(12);
												   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,61);
												   if(strlen(nd_prt_hd_desc.arr)<61)
												   fun_add_space(61-strlen(nd_prt_hd_desc.arr));
												   fun_add_space(4);
												 }
												 else
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"%-11.11s %-61.61s    "," ",nd_desc_with_spl_chr.arr);
																																	
																																									
												}
												else
												 fprintf(fp,"%-11.11s %-61.61s    "," ",nd_prt_hd_desc.arr);
												}
										  }
										  else
										  {
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(nd_print_option.arr[0]=='R')
													{
													 fun_add_space(13);
													 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
													 fun_add_space(3);
													 fun_bl_report_temp_format();
													}
													else
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																															
													}
													else
													fprintf(fp,"%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();
													if(nd_print_option.arr[0]=='R')
													fun_add_space(39);
													else
													fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
												}
												else
												{
												  if(nd_print_option.arr[0]=='R')
												 {
												   fun_add_space(13);
												   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,23);
												   if(strlen(nd_prt_hd_desc.arr)<23)
												   fun_add_space(23-strlen(nd_prt_hd_desc.arr));
												   fun_add_space(3);
												 }
												 else
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
																																		
																																									
												}
												else
												 fprintf(fp,"%-11.11s  %-23.23s   "," ",nd_prt_hd_desc.arr);
												}
										  }
										}
										else
										{
												
										  if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
										  {
											  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											  {
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(nd_print_option.arr[0]=='R')
													{
													 fun_add_space(11);
													 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
													 fun_bl_report_temp_format();
													}
													else
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
														
																																							
													}
													else
													fprintf(fp,"%-11.11s%s\n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();
													if(nd_print_option.arr[0]=='R')
													fun_add_space(60);
													else
													fprintf(fp,"%-11.11s%-50.50s"," "," ");
												}
												else
												{
												 if(nd_print_option.arr[0]=='R')
												 {
												   fun_add_space(13);
												   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,23);
												   if(strlen(nd_prt_hd_desc.arr)<23)
												   fun_add_space(23-strlen(nd_prt_hd_desc.arr));
												   fun_add_space(3);
												 }
												 else
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													 fprintf(fp,"%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																																							
												}
												else
												 fprintf(fp,"%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr);
												}
											  }
											  else
											  {
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(nd_print_option.arr[0]=='R')
													{
													 fun_add_space(14);
													 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
													 fun_add_space(2);
													 fun_bl_report_temp_format();
													}
													else
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																			
													}
													else
													fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();
													if(nd_print_option.arr[0]=='R')
													fun_add_space(45);
													else
													fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
												}
												else
												{
												 if(nd_print_option.arr[0]=='R')
												 {
												   fun_add_space(14);
												   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,29);
												   if(strlen(nd_prt_hd_desc.arr)<29)
												   fun_add_space(29-strlen(nd_prt_hd_desc.arr));
												   fun_add_space(2);
												 }
												 else
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
												
																																							
												}
												else
												fprintf(fp,"%-11.11s   %-29.29s  "," ",nd_prt_hd_desc.arr);
												}
											  }
										  }
										  else
										  {
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												 fun_add_space(14);
												 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
												 fun_add_space(2);
												 fun_bl_report_temp_format();
												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
													fprintf(fp,"%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																	
												}
												else
												fprintf(fp,"%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(42);
												else
												fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
											}
											else
											{
											  if(nd_print_option.arr[0]=='R')
											 {
											   fun_add_space(14);
											   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,26);
											   if(strlen(nd_prt_hd_desc.arr)<26)
											   fun_add_space(26-strlen(nd_prt_hd_desc.arr));
											   fun_add_space(2);
											 }
											 else
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																							
											}
											else
											 fprintf(fp,"%-11.11s   %-26.26s  "," ",nd_prt_hd_desc.arr);
											}
										   }

										}
									   //fprintf(fp," %-10.10s %-19.19s %-9.9s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
									}
								}
								else
								{
									if(d1_summary_dtl_ind.arr[3] == 'L') 
									{
										if (l_lsr != 0 && l_dmp == 0)
										{
										if( l_logo_yniflaser.arr[0] != 'Y')
										{
										print_bold_underline();
										if(nd_print_option.arr[0]=='R')
										{
										 strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
										 strcat(nd_line_text.arr,"/");
										 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										}
										else
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"%-s",nd_prt_line_desc.arr);
											
																																						
										}
										else
										fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
										Release_bold_underline();
										}
										}
																
										if(l_no_of_clumns ==5)
										{
											if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(nd_print_option.arr[0]=='R')
													{
													 fun_bl_report_temp_format();
													 fun_add_space(13);
													 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
													 fun_add_space(3);
													 fun_bl_report_temp_format();
													}
													else
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
												
																																									
													}
													else
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													if(nd_print_option.arr[0]=='R')
													fun_add_space(77);
													else
													fprintf(fp,"%-11.11s  %-61.61s   "," "," ");	
												}
												else
												{
												 if(nd_print_option.arr[0]=='R')
												 {
												   fun_add_space(13);
												   strncat(nd_line_text.arr,nd_prt_line_desc.arr,61);
												   if(strlen(nd_prt_line_desc.arr)<61)
												   fun_add_space(61-strlen(nd_prt_line_desc.arr));
												   fun_add_space(3);
												 }
												 else
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_desc_with_spl_chr.arr);
																																																			
												}
												else
												 fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_prt_line_desc.arr);
												//fprintf(fp,"\n%-11.11s  %-37.37s   "," ",nd_prt_line_desc.arr);
											    }
											}
											else
											{
												if (strcmp(c_addl_charge_amt_ind.arr,"C")==0)
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(nd_print_option.arr[0]=='R')
														{
														 fun_bl_report_temp_format();
														 fun_add_space(13);
														 strcat(nd_line_text.arr,nd_prt_line_desc.arr);
														 fun_add_space(3);
														 fun_bl_report_temp_format();
														}
														else
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
															fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
															fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
														
																																																					
														}
														else
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();lsr_line_cnt();
														if(nd_print_option.arr[0]=='R')
														fun_add_space(39);
														else
														fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
													}
													else
													{
													 if(nd_print_option.arr[0]=='R')
													 {
													   fun_bl_report_temp_format();
													   fun_add_space(13);
													   strncat(nd_line_text.arr,nd_prt_line_desc.arr,23);
													   if(strlen(nd_prt_line_desc.arr)<23)
													   fun_add_space(23-strlen(nd_prt_line_desc.arr));
													   fun_add_space(3);
													 }
													 else
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														 fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
																																																		
													}
													else
													 fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_prt_line_desc.arr);
													}
												}
												else
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();
														fprintf(fp,"%-11.11s  %-26.26s   "," "," ");
													}
													else
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_desc_with_spl_chr.arr);
																																																														
													}
													else
													fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_prt_line_desc.arr);
												}
											}
										
										}
										else
										{
											if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
											{
												if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
													
															fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
															fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																																																																																									
														}
														else
														fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();lsr_line_cnt();
														fprintf(fp,"%-11.11s%-50.50s"," "," ");
													}
													else
													{
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																																																																										
													}
													else
													 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_line_desc.arr);
													}
												}
												else
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
													
															fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
															fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																						
														}
														else
														fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
														lsr_line_cnt();lsr_line_cnt();
														fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
													}
													else
												    {
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																																																																							
													 }
													 else
													 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
												    }
												 }
											}
											else
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
												
														fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
														fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																
													}
													else
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
												}
												else
												{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
													
																																																																																						
												}
												else
												fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
											   }
											}
										}
										//fprintf(fp,"\n%-19.19s    %-19.19s",nd_prt_line_desc.arr," ");
										//Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
										//fprintf(fp,"\n%-19.19s / %-19.19s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
										
									}
									else
									{
										if (l_lsr != 0 && l_dmp == 0)
										{
										if( l_logo_yniflaser.arr[0] != 'Y')
										{
										
										print_bold_underline();
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
											fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																																																	
										}
										else
										fprintf(fp,"%-s",nd_prt_hd_desc.arr);
										Release_bold_underline();
										//fprintf(fp,"\n");
										}
										}
											
										if(l_no_of_clumns ==5)
										{								 
											if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											{	
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
												
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																											
													}
													else
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s  %-61.61s   "," "," ");
												}
												else
												{
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_desc_with_spl_chr.arr);
																																																																																				
												}
												else
												 fprintf(fp,"\n%-11.11s  %-61.61s   "," ",nd_prt_hd_desc.arr);
												 //fprntf(fp,"\n%-11.11s  %-37.37s   "," ",nd_prt_hd_desc.arr);
												}
											}
											else
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
												
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																								
													}
													else
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
																																																																																																
												}
												else
												 fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_prt_hd_desc.arr);
												}
											}
										
										}
										else
										{
											if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
											{
												if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
													
															fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
															fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																						
														}
														else
														fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_hd_desc.arr);
														lsr_line_cnt();lsr_line_cnt();
														fprintf(fp,"%-11.11s%-50.50s"," "," ");
													}
													else
													{
												       if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
															nd_temp_str.arr[0]='\0';
															nd_temp_str.len=0;
															sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
															fun_Pad_desc_with_spl_char(nd_temp_str.arr);
															fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
														
																																																																																																		
														}
														else
													   	fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr);

													 }
												}
												else
												{
													if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
													{
														if(strcmp(nd_pad_req_yn.arr,"Y")==0)
														 {
													
															fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
															fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																			
														}
														else
														fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
														lsr_line_cnt();lsr_line_cnt();
														fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
													}
													else
													{
													 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														nd_temp_str.arr[0]='\0';
														nd_temp_str.len=0;
														sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_hd_desc.arr);
														fun_Pad_desc_with_spl_char(nd_temp_str.arr);
														 fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
																																																																																															
													}
													else
													 fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_prt_hd_desc.arr);
													}
												}
											}
											else
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
												
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																															
													}
													else
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
												}
												else
												{
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
													
																																																																																														
												 }
												 else
												 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_hd_desc.arr);
												}
											}
											//fprintf(fp,"\n%-19.19s    %-19.19s",nd_prt_hd_desc.arr," ");	
											lsr_line_cnt();
											//fprintf(fp," %-10.10s %-19.19s %-9.9s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
											
										}
									}
								
								 }


									}
					
					  }

					  /********upto here*********/

						get_gross_net_amt();

					 									
						nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;       //total service gross
						nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;           //total service net
						//nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;        total service discount
						nd_pat_disc_amt=nd_pat_disc_amt+d1_upd_disc_amt;         //total service discount

						nd1_tot_serv_qty=nd1_tot_serv_qty+d1_serv_qty;        //Total Rate by Service wise
						nd1_grd_tot_serv_qty=nd1_grd_tot_serv_qty+d1_serv_qty;  //Grand Total Rate by Service wise
						
						nd1_tot_rate=nd1_tot_rate+d1_rate;          //Total Rate by Service wise
						nd1_grd_tot_rate=nd1_grd_tot_rate+d1_rate;  //Grand Total Rate by Service wise
						
						nd_pat_addl_charge_amt=nd_pat_addl_charge_amt+d1_addl_charge_amt_in_charge;        //total Addl Charge by service
						nd_pat_tot_addl_charge_amt=nd_pat_tot_addl_charge_amt+d1_addl_charge_amt_in_charge; //Total Addl Charge Amt
						
						nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;         //total service Amtpayble 
						nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt; //total Amtpayble 
						
						
						if(d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
						{  
						
						  nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_pat_gross_amt;
						  nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_pat_net_amt;
						  nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d1_upd_net_charge_amt;
						  nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d1_upd_disc_amt;
						  nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d1_addl_charge_amt_in_charge;
						  sprintf(st_var,"%d",nd_inside_pkg_disc_amt);
						
						}
						
						/******* For CRF-440(Discount Document Report)********/

						nd1_serv_tot_disc=nd1_serv_tot_disc+d1_tot_disc;								//Service Wise Total Discount
						nd1_tot_serv_tot_disc=nd1_tot_serv_tot_disc+d1_tot_disc;						//Grand Total Discount

						nd1_serv_charge_discount=nd1_serv_charge_discount+d1_charge_discount;			//Service Wise Total Charge Discount
						nd1_tot_serv_charge_discount=nd1_tot_serv_charge_discount+d1_charge_discount;	//Grand Total Charge Discount

						nd1_serv_bill_discount=nd1_serv_bill_discount+d1_bill_discount;					//Service Wise Total Bill Discount
						nd1_tot_serv_bill_discount=nd1_tot_serv_bill_discount+d1_bill_discount;			//Grand Total Bill Discount

						nd1_serv_fund_adjustment=nd1_serv_fund_adjustment+d1_fund_adjustment;			//Service Wise Total Fund(policy) Discount
						nd1_tot_serv_fund_adjustment=nd1_tot_serv_fund_adjustment+d1_fund_adjustment;	//Grand Total Fund(policy) Discount
												
						/********CRF-440 ***************/						
							
						end_of_report=1;	
					
				  }
				 else
				 if (d1_summary_dtl_ind.arr[4] == 'L') 
				  {
			
					
					  /*if(strcmp(d1_prt_grp_hdr_code.arr,nd1_prt_grp_hdr_code.arr)==0 && strcmp(d1_prt_grp_line_code.arr,nd1_prt_grp_line_code.arr)==0
					  && strcmp(d1_payer_serv_grp_hdr.arr,nd1_payer_serv_grp_hdr.arr)==0 && strcmp(d1_payer_serv_grp_line.arr,nd1_payer_serv_grp_line.arr)==0)*/

					  if( (strcmp(d1_grp_ind.arr,"ESL")==0 && (strcmp(d1_prt_grp_hdr_code.arr,nd1_prt_grp_hdr_code.arr)==0 && strcmp(d1_prt_grp_line_code.arr,nd1_prt_grp_line_code.arr)==0))||
					      (strcmp(d1_grp_ind.arr,"PSL")==0 && (strcmp(d1_payer_serv_grp_hdr.arr,nd1_payer_serv_grp_hdr.arr)==0 && strcmp(d1_payer_serv_grp_line.arr,nd1_payer_serv_grp_line.arr)==0))
						)	
					   {
						
						 nd1_tot_serv_qty=nd1_tot_serv_qty+d1_serv_qty;        //Total Rate by Service wise
						 nd1_grd_tot_serv_qty=nd1_grd_tot_serv_qty+d1_serv_qty;  //Grand Total Rate by Service wise
												 
						 nd1_tot_rate=nd1_tot_rate+d1_rate;          //Total Rate by Service wise
						 nd1_grd_tot_rate=nd1_grd_tot_rate+d1_rate;  //Grand Total Rate by Service wise
						 
						 nd_pat_addl_charge_amt=nd_pat_addl_charge_amt+d1_addl_charge_amt_in_charge;        //total Addl Charge by service
						 nd_pat_tot_addl_charge_amt=nd_pat_tot_addl_charge_amt+d1_addl_charge_amt_in_charge; //Total Addl Charge Amt
											 
						 nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;
						 nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;
																	
					     
						/******* For CRF-440(Discount Document Report)********/

						nd1_serv_tot_disc=nd1_serv_tot_disc+d1_tot_disc;								//Service Wise Total Discount
						nd1_tot_serv_tot_disc=nd1_tot_serv_tot_disc+d1_tot_disc;						//Grand Total Discount

						nd1_serv_charge_discount=nd1_serv_charge_discount+d1_charge_discount;			//Service Wise Total Charge Discount
						nd1_tot_serv_charge_discount=nd1_tot_serv_charge_discount+d1_charge_discount;	//Grand Total Charge Discount

						nd1_serv_bill_discount=nd1_serv_bill_discount+d1_bill_discount;					//Service Wise Total Bill Discount
						nd1_tot_serv_bill_discount=nd1_tot_serv_bill_discount+d1_bill_discount;			//Grand Total Bill Discount

						nd1_serv_fund_adjustment=nd1_serv_fund_adjustment+d1_fund_adjustment;			//Service Wise Total Fund(policy) Discount
						nd1_tot_serv_fund_adjustment=nd1_tot_serv_fund_adjustment+d1_fund_adjustment;	//Grand Total Fund(policy) Discount
												
						/********CRF-440 ***************/						
					
						 
						 get_gross_net_amt();
															 
						 nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;       //total service gross
						 nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;           //total service net
						 //nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;          total service discount
						 nd_pat_disc_amt=nd_pat_disc_amt+d1_upd_disc_amt;          //total service discount
						
						
						if(d_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
						{
						 
						  nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_pat_gross_amt;
						  nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_pat_net_amt;
						  nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d1_upd_net_charge_amt;
						  nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d1_upd_disc_amt;
						  nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d1_addl_charge_amt_in_charge;
						}
						
																						
						 end_of_report=1; 
					   }
					  else
					   {

						 p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;  //total  gross
					     p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;       //total  net
					     p_tot_pat_disc_amt=p_tot_pat_disc_amt+nd_pat_disc_amt;     //total  discount
						 
											 
						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						  if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
						  {
							get_addlcharge_count();
							if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
							print_formated_amt2(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt);
						  }
						 }
				
						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						  { 
						   if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
						   {
						       print_formated_amt(nd_pat_gross_amt-nd_inside_pkg_gross_amt);
						   }
						  }
					
												 
						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						  {
						   if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
						     print_formated_amt(nd_pat_net_amt1-nd_inside_pkg_net_amt);
						  }	
					
						 nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
						 
						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						 {
							 if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
							 {
							  get_discount_count();
							   if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
							   {
							   if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
							   print_formated_amt(nd_pat_disc_amt-nd_inside_pkg_disc_amt);
							  }
							 }

							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
							 {
							  if(c_disc_amt_in_dtl_yn.arr[0]=='N')
							  {
							   if (strcmp(c_servdate_in_dtlformat_yn.arr,"N")==0)
							   fprintf(fp,"%-18.18s"," ");
							   if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
							   fprintf(fp,"%-9.9s"," ");
							   print_formated_amt(nd1_serv_tot_disc);
							  }
							  else
							  {
							    print_formated_amt(nd1_serv_charge_discount);
								print_formated_amt(nd1_serv_bill_discount);
								print_formated_amt(nd1_serv_fund_adjustment);
							  }
							 }
						 }
						
						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						  
						   if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0) 
						   {
							print_formated_amt((nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt)); // Amt Payble
						   }
						   else
						   {
						    if (strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0)
						    print_formated_amt(nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt); // Amt Payble
						   }	
						  
						 }
						 
						 nd_tot_subdiv_amt=nd_tot_subdiv_amt+nd_subdiv_amt; //total Subsidized Amt

					     if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						   if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)
						   {
							get_subsidized_amt();
							if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
							print_formated_amt(nd_subdiv_amt);
						   }
					     }
						 
						 
						 //fprintf(fp,"\n"); commneted on 20/3/2008 for removing space b/w records


						 nd_pat_gross_amt=0;
						 nd_pat_net_amt1=0;
						 nd_pat_disc_amt =0;  //added on 23/08/2010 for medicity Hotfix regarding discount 
						 nd_pat_net_charge_amt=0;
						 nd_pat_addl_charge_amt=0;
						 nd1_serv_charge_discount=0;
						 nd1_serv_bill_discount=0;
						 nd1_serv_fund_adjustment=0;
						 nd1_serv_tot_disc=0;
						 nd1_tot_rate=0;
						 nd1_tot_serv_qty=0;
						 nd_subdiv_amt=0;
						 nd_inside_pkg_gross_amt=0;
						 nd_inside_pkg_net_amt=0;
						 nd_inside_pkg_amtpayable_amt=0;
						 nd_inside_pkg_disc_amt=0;
						 nd_inside_pkg_addchrg_amt=0;
					 	 						 
						 get_print_group_hd_desc();
						 get_print_group_line_desc();
						 
						 //Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e just print the printline description)	
						 //fprintf(fp,"\n%-19.19s -  %-19.19s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	 
						 if (l_lsr != 0 && l_dmp == 0)
						 {
						  if( l_logo_yniflaser.arr[0] != 'Y')
						  { fprintf(fp,"\n");
							print_bold_underline();
							if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
								fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
								fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
								fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
								fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																																																									
							 }
							 else
							fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
						    lsr_line_cnt();
							Release_bold_underline();
						  }
						
						}

						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						 {
							 if(l_no_of_clumns ==5)
							 {
								 if ((strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0  && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)||strcmp(c_addl_charge_amt_ind.arr,"C")==0)
								 {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)	
									{
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
									
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
																																																																																																																																																																											
										}
										else
										fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
										lsr_line_cnt();lsr_line_cnt();
										fprintf(fp,"%-11.11s %-61.61s    "," "," ");
									}
									else		    					
									{
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_line_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"\n%-11.11s %-61.61s    "," ",nd_desc_with_spl_chr.arr);
																																														
									}
									else
									 fprintf(fp,"\n%-11.11s %-61.61s    "," ",nd_prt_line_desc.arr);
									//fprintf(fp,"\n%-11.11s %-37.37s    "," ",nd_prt_line_desc.arr);
									}
								 }
								 else
								 {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
									
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																				
										}
										else
										fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
										lsr_line_cnt();lsr_line_cnt();
										fprintf(fp,"%-11.11s   %-34.34s  "," "," ");
									}	
									else
									{
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-34.34s",nd_prt_line_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_desc_with_spl_chr.arr);
																																																						
									}
									else
									fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_line_desc.arr);
									}
								 }
							 }
							 else
							 {
								 if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
								 {
									 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
									 {
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
										
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
											
																																																																																																																																																																																					
											}
											else
											fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_line_desc.arr);
											lsr_line_cnt();lsr_line_cnt();
											fprintf(fp,"%-11.11s%-50.50s"," "," ");
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																																																																
										}
										else
										 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_line_desc.arr);
										}
									 }
									 else
									 {
										if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
										{
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
										
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																															
											}
											else
											fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
											lsr_line_cnt();lsr_line_cnt();
											fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
										}
										else
										{
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																																														
										}
										else
										fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
									   }
									 }
								 }
								 else
								 {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
									
											fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
											fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																							
										}
										else
										fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
										lsr_line_cnt();lsr_line_cnt();
										fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
									}
									else
									{
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
									
																																																													
									}
									else
									 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
									}
								 }
								 lsr_line_cnt();
							 }
						 }

						/***********added by vani*********/
						if (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) 
						{
							
							//strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,d1_prt_grp_line_code.arr);
								//get_grp_pkg_outside_cnt(d_grp_code,d_line_code); SENTHIL


								/***added for walkthrough merging***/

							 if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,d1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,d1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,d1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,d1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
													
							/****upto here***/

								  get_grp_pkg_outside_cnt('L',d_grp_code,d_line_code);

								if (l_grp_pkg_inside_cnt!=0)
								{
									if(l_no_of_clumns ==5)
									 {
										 if ((strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 && strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0 )||strcmp(c_addl_charge_amt_ind.arr,"C")==0)
										 {
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
											
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s %s    \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																								
												}
												else
												fprintf(fp,"\n%-11.11s %s    \n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												fprintf(fp,"%-11.11s %-61.61s    "," "," ");
											}
											else
											{
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-61.61s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s %-61.61s    "," ",nd_desc_with_spl_chr.arr);
																				
																																																															
											}
											else
											fprintf(fp,"\n%-11.11s %-61.61s    "," ",nd_prt_line_desc.arr);
											}
										 }
										 else
										 {
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
											
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																						
												}
												else
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												fprintf(fp,"%-11.11s   %-34.34s  "," "," ");
											}
											else
											{
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-34.34s",nd_prt_line_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_desc_with_spl_chr.arr);
																																																														
											}
											else
											 fprintf(fp,"\n%-11.11s   %-34.34s  "," ",nd_prt_line_desc.arr);
											}
										 }
									 }
									 else
									 {
										 if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
										 {
											 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											 {
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
												
														fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
														fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																			
													}
													else
													fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_line_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s%-50.50s"," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																																																													
												}
												else
												 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_line_desc.arr);
												}
											 }
											 else
											 {
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
												
														fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
														fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																
													}
													else
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
																																																											
												}
												else
												 fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_prt_line_desc.arr);
												}
											 }
										 }
										 else
										 {
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
											
													fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																												
												}
												else
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_line_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
											}
											else
											{
											    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
												
																																																											
												}
												else
											   fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_line_desc.arr);
											}
										 }
										 lsr_line_cnt();
									 }

								}
						}
						
						/********upto here********/

						 //get_blng_serv_desc1();
						 //fprintf(fp," %-10.10s %-19.19s %-9.9s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);

						 get_gross_net_amt();

						 nd1_tot_serv_qty=nd1_tot_serv_qty+d1_serv_qty;        //Total Rate by Service wise
						 nd1_grd_tot_serv_qty=nd1_grd_tot_serv_qty+d1_serv_qty;  //Grand Total Rate by Service wise
						
						 
						 nd1_tot_rate=nd1_tot_rate+d1_rate;          //Total Rate by Service wise
						 nd1_grd_tot_rate=nd1_grd_tot_rate+d1_rate;  //Grand Total Rate by Service wise

						 nd_pat_addl_charge_amt=nd_pat_addl_charge_amt+d1_addl_charge_amt_in_charge;        //total Addl Charge by service
						 nd_pat_tot_addl_charge_amt=nd_pat_tot_addl_charge_amt+d1_addl_charge_amt_in_charge; //Total Addl Charge Amt
								
						 nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;
						 nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;

						/******* For CRF-440(Discount Document Report)********/

						nd1_serv_tot_disc=nd1_serv_tot_disc+d1_tot_disc;								//Service Wise Total Discount
						nd1_tot_serv_tot_disc=nd1_tot_serv_tot_disc+d1_tot_disc;						//Grand Total Discount

						nd1_serv_charge_discount=nd1_serv_charge_discount+d1_charge_discount;			//Service Wise Total Charge Discount
						nd1_tot_serv_charge_discount=nd1_tot_serv_charge_discount+d1_charge_discount;	//Grand Total Charge Discount

						nd1_serv_bill_discount=nd1_serv_bill_discount+d1_bill_discount;					//Service Wise Total Bill Discount
						nd1_tot_serv_bill_discount=nd1_tot_serv_bill_discount+d1_bill_discount;			//Grand Total Bill Discount

						nd1_serv_fund_adjustment=nd1_serv_fund_adjustment+d1_fund_adjustment;			//Service Wise Total Fund(policy) Discount
						nd1_tot_serv_fund_adjustment=nd1_tot_serv_fund_adjustment+d1_fund_adjustment;	//Grand Total Fund(policy) Discount
												
						/********CRF-440 ***************/						
							
											 
						 nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;       //total service gross
						 nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;           //total service net
						 //nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;        //total service discount	
						 nd_pat_disc_amt=nd_pat_disc_amt+d1_upd_disc_amt;         //total service discount	
						
						if(d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
						{
						  nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_pat_gross_amt;
						  nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_pat_net_amt;
						  nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d1_upd_net_charge_amt;
						  nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d1_upd_disc_amt;
						  nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d1_addl_charge_amt_in_charge;
						}
						
						
						 end_of_report=1;

					}

										   					    
				}

			  else
			  	{
														  
					  //if(strcmp(d1_prt_grp_hdr_code.arr,nd1_prt_grp_hdr_code.arr)==0 && strcmp(d1_payer_serv_grp_hdr.arr,nd1_payer_serv_grp_hdr.arr)==0) 
					  if( (strcmp(d1_grp_ind.arr,"ESG")==0 && strcmp(d1_prt_grp_hdr_code.arr,nd1_prt_grp_hdr_code.arr)==0) ||
					      (strcmp(d1_grp_ind.arr,"PSG")==0 && strcmp(d1_payer_serv_grp_hdr.arr,nd1_payer_serv_grp_hdr.arr)==0)||
						  (strcmp(d1_grp_ind.arr,"EMG")==0 && strcmp(d1_ent_item_grp_code.arr,nd1_ent_item_grp_code.arr)==0)||
						  (strcmp(d1_grp_ind.arr,"PMG")==0 && strcmp(d1_payer_item_grp_code.arr,nd1_payer_item_grp_code.arr)==0)    
					    )
					    {
						
						 nd1_tot_serv_qty=nd1_tot_serv_qty+d1_serv_qty;        //Total Rate by Service wise
						 nd1_grd_tot_serv_qty=nd1_grd_tot_serv_qty+d1_serv_qty;  //Grand Total Rate by Service wise
						
						 nd1_tot_rate=nd1_tot_rate+d1_rate;          //Total Rate by Service wise
						 nd1_grd_tot_rate=nd1_grd_tot_rate+d1_rate;  //Grand Total Rate by Service wise
						 
						 nd_pat_addl_charge_amt=nd_pat_addl_charge_amt+d1_addl_charge_amt_in_charge;        //total Addl Charge by service
						 nd_pat_tot_addl_charge_amt=nd_pat_tot_addl_charge_amt+d1_addl_charge_amt_in_charge; //Total Addl Charge Amt
								
						 nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;
						 nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;
																	
					     
						 /******* For CRF-440(Discount Document Report)********/

						nd1_serv_tot_disc=nd1_serv_tot_disc+d1_tot_disc;								//Service Wise Total Discount
						nd1_tot_serv_tot_disc=nd1_tot_serv_tot_disc+d1_tot_disc;						//Grand Total Discount

						nd1_serv_charge_discount=nd1_serv_charge_discount+d1_charge_discount;			//Service Wise Total Charge Discount
						nd1_tot_serv_charge_discount=nd1_tot_serv_charge_discount+d1_charge_discount;	//Grand Total Charge Discount

						nd1_serv_bill_discount=nd1_serv_bill_discount+d1_bill_discount;					//Service Wise Total Bill Discount
						nd1_tot_serv_bill_discount=nd1_tot_serv_bill_discount+d1_bill_discount;			//Grand Total Bill Discount

						nd1_serv_fund_adjustment=nd1_serv_fund_adjustment+d1_fund_adjustment;			//Service Wise Total Fund(policy) Discount
						nd1_tot_serv_fund_adjustment=nd1_tot_serv_fund_adjustment+d1_fund_adjustment;	//Grand Total Fund(policy) Discount
												
						/********CRF-440 ***************/						
							
					
						 get_gross_net_amt();
															 
						 nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;       //total service gross
						 nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;           //total service net
						 //nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;          //total service discount
						 nd_pat_disc_amt=nd_pat_disc_amt+d1_upd_disc_amt;          //total service discount
												
					 
										 
						 
						if(d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
						{
						
						  nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_pat_gross_amt;
						  nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_pat_net_amt;
						  nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d1_upd_net_charge_amt;
						  nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d1_upd_disc_amt;
						  nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d1_addl_charge_amt_in_charge;
						}
						
						
						 end_of_report=1; 
					   }
					  else
					   {

					     p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;  //total  gross
					     p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;       //total  net
					     p_tot_pat_disc_amt=p_tot_pat_disc_amt+nd_pat_disc_amt;     //total  discount
						
						 //16882 changes done here

							//strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

							/***added for walkthrough merging**/
							if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,nd1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							/***upto here***/

							get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);
												 
						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) )
						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						   if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
						   {
						    get_addlcharge_count();
							if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
						    print_formated_amt2(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt);
						   }
						 }
					
							//strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

							/***added for walkthrough merging***/

							 if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,nd1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							/**upto here**/


							get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) ) 
						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						  if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
						  {
						  
						  print_formated_amt(nd_pat_gross_amt-nd_inside_pkg_gross_amt);
						  }
					     }
						
							strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
							strcpy(d_line_code,nd1_prt_grp_line_code.arr);
							get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) ) 
					     if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						   if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
						     print_formated_amt(nd_pat_net_amt1-nd_inside_pkg_net_amt);
						 }
					

						 nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;

							//strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

							/***added for walkthrough merging***/
								  if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,nd1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
								/***upto here***/

							get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);
						 
						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) ) 
						 {
							 if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
							 {
							  get_discount_count();
							   if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
							   {
							   if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
							   print_formated_amt(nd_pat_disc_amt-nd_inside_pkg_disc_amt);
							  }
							 }

							 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
							 {
							   if(c_disc_amt_in_dtl_yn.arr[0]=='N')
							   {
							    if (strcmp(c_servdate_in_dtlformat_yn.arr,"N")==0)
								fprintf(fp,"%-18.18s"," ");
							    if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
								if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
								fprintf(fp,"%-9.9s"," ");
								print_formated_amt(nd1_serv_tot_disc);
							 							
							   }
							   else
							   {
							    print_formated_amt(nd1_serv_charge_discount);
								print_formated_amt(nd1_serv_bill_discount);
								print_formated_amt(nd1_serv_fund_adjustment);

							   }

							 }
						 }

							//strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

							/***added for merging walkthrough corrections***/
							  if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,nd1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
						
							/**upto here**/

							get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

						 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) ) 
						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						  if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0) 
						    print_formated_amt((nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt)); // Amt Payble
						
						  else
						  {
						   if (strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0)
						   print_formated_amt(nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt); // Amt Payble
						  }
					     }
						 nd_tot_subdiv_amt=nd_tot_subdiv_amt+nd_subdiv_amt; //total Subsidized Amt

							//strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
							//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

							/***added for walkthrough merging**/
							if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,nd1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							/**upto here***/

							get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

					     if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) ) 
						 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						 {
						   if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)
						   {
							get_subsidized_amt();
							if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
							print_formated_amt(nd_subdiv_amt);
						   }
						 }
						
						 
						 //fprintf(fp,"\n"); commneted on 20/3/2008 for removing space b/w records

						 nd_pat_gross_amt=0;
						 nd_pat_net_amt1=0;
						 nd_pat_disc_amt=0;
						 nd_pat_net_charge_amt=0;
						 nd_pat_addl_charge_amt=0;
						 nd1_serv_charge_discount=0;
						 nd1_serv_bill_discount=0;
						 nd1_serv_fund_adjustment=0;
						 nd1_serv_tot_disc=0;
						 nd1_tot_rate=0;
						 nd1_tot_serv_qty=0;
						 nd_subdiv_amt=0;
						 nd_inside_pkg_gross_amt=0;
						 nd_inside_pkg_net_amt=0;
						 nd_inside_pkg_amtpayable_amt=0;
						 nd_inside_pkg_disc_amt=0;
						 nd_inside_pkg_addchrg_amt=0;
					 	 												 
						 get_print_group_hd_desc();
						 get_print_group_line_desc();  
								
						 
						 if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
						  {
							 	  
								  if(l_no_of_clumns ==5)
									 {
									   if (l_lsr != 0 && l_dmp == 0)
									   {
									   if( l_logo_yniflaser.arr[0] != 'Y')
										{
													fprintf(fp,"\n");
											 print_bold_underline();
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																										
											}
											else
											 fprintf(fp,"%-s",nd_prt_hd_desc.arr);
											 Release_bold_underline();
											 //fprintf(fp,"\n");
										}
										}
												
											
										if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
										{
											if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr); 
																																																																								
													}
													else
													fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_hd_desc.arr); 
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s%-50.50s"," "," "); 
												}
												else
												{
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr); 
																				
																																																											
												}
												else
												 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr); 
												}
											}
											else
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																																																																				
													}
													else
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s  %-26.26s   "," "," ");
												}
												else
												{
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_desc_with_spl_chr.arr);
																		
																																																											
												}
												else
												 fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_prt_hd_desc.arr);
												}
											}
										}
										else
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																																																																															
												}
												else
												fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
											}
											else
											{
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_hd_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
																																																																		
											 }
											 else
											 fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_prt_hd_desc.arr);
											}
										}
									 }
									 else
									 {
									   if (l_lsr != 0 && l_dmp == 0)
									   {
										if( l_logo_yniflaser.arr[0] != 'Y')
										{	fprintf(fp,"\n");
										
											 print_bold_underline();
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																																																																									
											 }
											 else
											 fprintf(fp,"%-s",nd_prt_hd_desc.arr);
											 Release_bold_underline();
											 //fprintf(fp,"\n");
										}
										}
													   
										if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
										{
											if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																																																																																																													
													}
													else
													fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s%-50.50s"," "," ");
												}
												else
												{
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																																																																													
												 }
												 else
												 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr);
												}
											}
											else
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																													
													}
													else
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-29.29s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_desc_with_spl_chr.arr);
																																																																																									
												 }
												 else
												 fprintf(fp,"\n%-11.11s   %-29.29s  "," ",nd_prt_hd_desc.arr);
												}
											}
										}
										else
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																							
												}
												else
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
											}
											else
											{
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												nd_temp_str.arr[0]='\0';
												nd_temp_str.len=0;
												sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
												fun_Pad_desc_with_spl_char(nd_temp_str.arr);
												fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																																																																																			
											 }
											 else
											 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_hd_desc.arr);
											}
										}

									 }
									 lsr_line_cnt();
														 
						 }
				
				
					/**********added by vani*********/
				if (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0)
				{
						//strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
						//strcpy(d_line_code,d1_prt_grp_line_code.arr);
						//get_grp_pkg_outside_cnt(d_grp_code,d_line_code); SENTHIL

						/***added for walkthrough merging**/
						 if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,d1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,d1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,d1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,d1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
						/**upto here***/


						  get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

						if (l_grp_pkg_inside_cnt!=0)
							  {
								 if(l_no_of_clumns ==5)
									 {
									   if (l_lsr != 0 && l_dmp == 0)
									   {
									   if( l_logo_yniflaser.arr[0] != 'Y')
										{  fprintf(fp,"\n");
										
											 print_bold_underline();
											 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																																																																																																	
										 	 }
											 else
											 fprintf(fp,"%-s",nd_prt_hd_desc.arr);
											 Release_bold_underline();
											 //fprintf(fp,"\n");
										}
										}
												
											
										if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
										{
											if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr); 
																																																																																																																																				
													}
													else
													fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_hd_desc.arr); 
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s%-50.50s"," "," "); 
												}
												else
												{
												 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr); 
																																																																																																															
												 }
												 else
												 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr); 
												}
											}
											else
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																		
													}
													else
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s  %-26.26s   "," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_desc_with_spl_chr.arr);
																																																																																																																											
												 }
												 else
												 fprintf(fp,"\n%-11.11s  %-26.26s   "," ",nd_prt_hd_desc.arr);
												}
											}
										}
										else
										{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_desc_with_spl_chr.arr);
												
																																																																																																																																		
													}
													else
													fprintf(fp,"\n%-11.11s  %s   \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s  %-23.23s   "," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-23.23s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_desc_with_spl_chr.arr);
																																																																																																																																							
												 }
												 else
												 fprintf(fp,"\n%-11.11s  %-23.23s   "," ",nd_prt_hd_desc.arr);
												}
										}
									 }
									 else
									 {
									   if (l_lsr != 0 && l_dmp == 0)
									   {
										if( l_logo_yniflaser.arr[0] != 'Y')
										{	
												fprintf(fp,"\n");
											 print_bold_underline();
											if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											 {
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																																																																																																																					
											}
											else
											fprintf(fp,"%-s",nd_prt_hd_desc.arr);
											 Release_bold_underline();
											 //fprintf(fp,"\n");
										}
										}
													   
										if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0 )
										{
											if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s%s\n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																										
													}
													else
													fprintf(fp,"\n%-11.11s%s\n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s%-50.50s"," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-50.50s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																			
												 }
												 else
												 fprintf(fp,"\n%-11.11s%-50.50s"," ",nd_prt_hd_desc.arr);
												}
											}
											else
											{
												if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
												{
													if(strcmp(nd_pad_req_yn.arr,"Y")==0)
													 {
														fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
														fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																						
													}
													else
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
													lsr_line_cnt();lsr_line_cnt();
													fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
												}
												else
												{
												  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																															
												 }
												 else
												 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_hd_desc.arr);
												}
											}
										}
										else
										{
											if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
											{
												if(nd_print_option.arr[0]=='R')
												{
												  fun_bl_report_temp_format();
												  fun_add_space(14);
												  strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
												  fun_add_space(2);
												  fun_bl_report_temp_format();

												}
												else
												if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
													fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																			
												}
												else
												fprintf(fp,"\n%-11.11s   %s  \n"," ",nd_prt_hd_desc.arr);
												lsr_line_cnt();lsr_line_cnt();
												if(nd_print_option.arr[0]=='R')
												fun_add_space(42);
												else
												fprintf(fp,"%-11.11s   %-29.29s  "," "," ");
											}
											else
											{
											  if(nd_print_option.arr[0]=='R')
											  {
											   fun_bl_report_temp_format();
											   fun_add_space(14);
											   strncat(nd_line_text.arr,nd_prt_hd_desc.arr,26);
											   if(strlen(nd_prt_hd_desc.arr)<26)
											   fun_add_space(26-strlen(nd_prt_hd_desc.arr));
											   fun_add_space(2);
											  }
											  else
											  {
											    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
												 {
													nd_temp_str.arr[0]='\0';
													nd_temp_str.len=0;
													sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_hd_desc.arr);
													fun_Pad_desc_with_spl_char(nd_temp_str.arr);
													fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
																																																																																																																																																																											
												 }
											   else
											   fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_prt_hd_desc.arr);
											  }
											}
										}

									 }
									 lsr_line_cnt();
								}
						 
					}

				/*******upto here*******/


						 //get_blng_serv_desc1();
						 //fprintf(fp," %-10.10s %-19.19s %-9.9s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);

						 get_gross_net_amt();

						 nd1_tot_serv_qty=nd1_tot_serv_qty+d1_serv_qty;        //Total Rate by Service wise
						 nd1_grd_tot_serv_qty=nd1_grd_tot_serv_qty+d1_serv_qty;  //Grand Total Rate by Service wise
						
						 
						 nd1_tot_rate=nd1_tot_rate+d1_rate;          //Total Rate by Service wise
						 nd1_grd_tot_rate=nd1_grd_tot_rate+d1_rate;  //Grand Total Rate by Service wise

						 nd_pat_addl_charge_amt=nd_pat_addl_charge_amt+d1_addl_charge_amt_in_charge;        //total Addl Charge by service
						 nd_pat_tot_addl_charge_amt=nd_pat_tot_addl_charge_amt+d1_addl_charge_amt_in_charge; //Total Addl Charge Amt
			
						 nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;
						 nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;

						 
						 /******* For CRF-440(Discount Document Report)********/

						nd1_serv_tot_disc=nd1_serv_tot_disc+d1_tot_disc;								//Service Wise Total Discount
						nd1_tot_serv_tot_disc=nd1_tot_serv_tot_disc+d1_tot_disc;						//Grand Total Discount

						nd1_serv_charge_discount=nd1_serv_charge_discount+d1_charge_discount;			//Service Wise Total Charge Discount
						nd1_tot_serv_charge_discount=nd1_tot_serv_charge_discount+d1_charge_discount;	//Grand Total Charge Discount

						nd1_serv_bill_discount=nd1_serv_bill_discount+d1_bill_discount;					//Service Wise Total Bill Discount
						nd1_tot_serv_bill_discount=nd1_tot_serv_bill_discount+d1_bill_discount;			//Grand Total Bill Discount

						nd1_serv_fund_adjustment=nd1_serv_fund_adjustment+d1_fund_adjustment;			//Service Wise Total Fund(policy) Discount
						nd1_tot_serv_fund_adjustment=nd1_tot_serv_fund_adjustment+d1_fund_adjustment;	//Grand Total Fund(policy) Discount
												
						/********CRF-440 ***************/						
							
						 
						 nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;       //total service gross
						 nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;           //total service net
						 //nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;          //total service discount	
						 nd_pat_disc_amt=nd_pat_disc_amt+d1_upd_disc_amt;          //total service discount	
						 
											 
						if(d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len!=0) // l_pkg_len==0 (to) l_pkg_len!=0  changed by vani 
						{
						  nd_inside_pkg_gross_amt=nd_inside_pkg_gross_amt+p_pat_gross_amt;
						  nd_inside_pkg_net_amt=nd_inside_pkg_net_amt+p_pat_net_amt;
						  nd_inside_pkg_amtpayable_amt=nd_inside_pkg_amtpayable_amt+d1_upd_net_charge_amt;
						  nd_inside_pkg_disc_amt=nd_inside_pkg_disc_amt+d1_upd_disc_amt;
						  nd_inside_pkg_addchrg_amt=nd_inside_pkg_addchrg_amt+d1_addl_charge_amt_in_charge;
						}
				

						 end_of_report=1;

					}

										   					    
				}


			}//summary end

	      else
           {		
                
				if (strcmp(d1_prt_grp_hdr_code.arr,nd1_prt_grp_hdr_code.arr)!=0 || strcmp(d1_prt_grp_line_code.arr,nd1_prt_grp_line_code.arr)!=0)
				{
					
						if (nd2_summary_dtl_ind.arr[3] == 'S')  
						{
							
							p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;  //total  gross
							p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;       //total  net
							p_tot_pat_disc_amt=p_tot_pat_disc_amt+nd_pat_disc_amt;    //total  discount
										    					
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) 
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
			                 if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
							 {
								 get_addlcharge_count();
								if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
								print_formated_amt2(nd_pat_addl_charge_amt);
							 }
							 //print_formated_amt2(d1_addl_charge_amt_in_charge-nd_inside_pkg_addchrg_amt);
							}
							//else rag
							//if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							//fprintf(fp,"%11.11s"," ");  //added by vani for printing service date for patient
			
														
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{

							 if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
							 {
							 
							 print_formated_amt(nd_pat_gross_amt-nd_inside_pkg_gross_amt);
							 }
							}
													 
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
							 print_formated_amt(nd_pat_net_amt1-nd_inside_pkg_net_amt);
						    }
							
							//if(nd_pat_net_amt1>=0)
							//nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
							//els]e
							nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
													
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							{
								if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
								{
								 get_discount_count();
							    if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
							    {
								  if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
								  print_formated_amt(nd_pat_disc_amt-nd_inside_pkg_disc_amt);
								 }
								}

								if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
								{
								  if(c_disc_amt_in_dtl_yn.arr[0]=='N')
								  {
								   if (strcmp(c_servdate_in_dtlformat_yn.arr,"N")==0)
								   {
								   if(nd_print_option.arr[0]=='R')
								   fun_add_space(18);
									else
									fprintf(fp,"%-18.18s"," ");
								   }
								   if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
								   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
								   {
								    if(nd_print_option.arr[0]=='R')
									fun_add_space(9);
									else
									fprintf(fp,"%-9.9s"," ");
								   }
								   print_formated_amt(nd1_serv_tot_disc);
								  }
								  else
								  {
								    print_formated_amt(nd1_serv_charge_discount);
									print_formated_amt(nd1_serv_bill_discount);
									print_formated_amt(nd1_serv_fund_adjustment);
								  }
								}
							}
							
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
						    if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0) 
							  print_formated_amt((nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt));
						
						 	 else
							 {
							  if (strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0)
						      print_formated_amt(nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt);
							 }
						    }
							
							nd_tot_subdiv_amt=nd_tot_subdiv_amt+nd_subdiv_amt; //total Subsidized Amt

						   if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
						   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						   {
						    if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)
							{
								get_subsidized_amt();
								if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
								print_formated_amt(nd_subdiv_amt);
							}
						   }
							  
						}
						nd_ref_prt_grp_hdr_code.arr[nd_ref_prt_grp_hdr_code.len] ='\0';
					   
						get_print_group_hd_desc();
						get_print_group_line_desc();
						get_blng_serv_desc1();

						//added by raghava on 18/03/2008
						if(d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
						if(nd2_summary_dtl_ind.arr[3] == 'S')
						{
						 
						 if(nd_print_option.arr[0]=='R')
						 fun_bl_report_temp_format();
						 else
						 fprintf(fp,"\n");
						 lsr_line_cnt();
						}
										
					   /*Commented by raghava on 18/03/2008  as per requirement of CRF-105(i.e don't print the detail title description)	
					   
                       fprintf(fp,"\n%-19.19s / ",nd_prt_hd_desc.arr);
					   fprintf(fp," %-20.20s\n",nd_prt_line_desc.arr);
					   lsr_line_cnt();lsr_line_cnt(); Upto here*/

					   //fprintf(fp,"\n%-25s/%-45s\n",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
					   //fprintf(fp,"\n%-s/%-45s\n",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); 
					  
					   if(d1_package_trx_yn.arr[0] == 'N') // || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) ) //medicity package print problem corrected here IN16757
					   if (l_lsr != 0 && l_dmp == 0)
					   {
					   if( l_logo_yniflaser.arr[0] != 'Y')
						{  fprintf(fp,"\n");
						  print_bold_underline();
						  if(nd_print_option.arr[0]=='R')
						  {
						   fun_bl_report_temp_format();
						   strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
						   strcat(nd_line_text.arr,"/");
						   strcat(nd_line_text.arr,nd_prt_line_desc.arr);
						   fun_bl_report_temp_format();
						  }
						  else
						  {
						   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
															
								fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
								fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
								fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
								fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																					
							 }
						   else
						   fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr); //uncommented by vani

						  }
						  lsr_line_cnt();lsr_line_cnt();
						  Release_bold_underline();
						  fprintf(fp,"\n");
					    }
						}
							
							/*****added by vani********/
						if (d1_package_trx_yn.arr[0] == 'Y')   // && l_pkg_len!=0)  //medicity package print problem corrected here IN16757
						{													
								//strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
								//get_grp_pkg_outside_cnt(d_grp_code,d_line_code); SENTHIL

								if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
							{
								strcpy(d_grp_code,d1_prt_grp_hdr_code.arr);
								strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if(strcmp(d1_grp_ind.arr,"EMG")==0)
							{
								strcpy(d_grp_code,d1_ent_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
							if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
							{
								strcpy(d_grp_code,d1_payer_serv_grp_hdr.arr);
								strcpy(d_line_code,d1_payer_serv_grp_line.arr);
							}
							if(strcmp(d1_grp_ind.arr,"PMG")==0)
							{									
								 strcpy(d_grp_code,d1_payer_item_grp_code.arr);
								//strcpy(d_line_code,d1_prt_grp_line_code.arr);
							}
								

								  get_grp_pkg_outside_cnt('L',d_grp_code,d_line_code);

								if (l_grp_pkg_inside_cnt!=0)
								{
									if (l_lsr != 0 && l_dmp == 0)
									   {
									   if( l_logo_yniflaser.arr[0] != 'Y')
										{  fprintf(fp,"\n");
										  print_bold_underline();
										  if(nd_print_option.arr[0]=='R')
										  {
										   fun_bl_report_temp_format();
										   strcat(nd_line_text.arr,nd_prt_hd_desc.arr);
										   strcat(nd_line_text.arr,"/");
										   strcat(nd_line_text.arr,nd_prt_line_desc.arr);
										   fun_bl_report_temp_format();
										  }
										  else
										  {
										   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
											{
																			
												fun_Pad_desc_with_spl_char(nd_prt_hd_desc.arr);
												fprintf(fp,"%-s/",nd_desc_with_spl_chr.arr);
												fun_Pad_desc_with_spl_char(nd_prt_line_desc.arr);
												fprintf(fp,"%-s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																									
											 }
										   else
										   fprintf(fp,"%-s/%-s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);
										  }
										  lsr_line_cnt();lsr_line_cnt();
										  Release_bold_underline();
										  fprintf(fp,"\n");
										}
										}
								 }

						}

						/********upto here*******/

						/* This If Condition for checking if any additional charge is there 
						then it will print the below format otherwise else format*/

						if(d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
						if(l_no_of_clumns ==5)
						{
						    if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							{
								if (d1_summary_dtl_ind.arr[5] == 'S') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
										  if(strlen(d1_blng_serv_code.arr)<10)
										  fun_add_space(10-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
																																																									
										 }
										 else
										 {
												if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
												{
														fprintf(fp," %s \n",dc1_physician_name.arr);		

												}
												else
												{
													fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
													if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
													{
														fprintf(fp," - %s \n",dc1_physician_name.arr);
													}
													else
													{
														fprintf(fp,"\n");
													}
												}
										 }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(26);
										}
										else
										fprintf(fp," %-10.10s %-13.13s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									    if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
										  if(strlen(d1_blng_serv_code.arr)<10)
										  fun_add_space(10-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strncat(nd_line_text.arr,nd_blng_desc1.arr,13);
										  if(strlen(nd_blng_desc1.arr)<13)
										  fun_add_space(13-strlen(nd_blng_desc1.arr));
										  fun_add_space(1);
								
										}
										else
									    {
									
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-13.13s",nd_blng_desc1.arr);
											fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);

											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," %-24.24s ",nd_desc_with_spl_chr.arr);		

											}
											else
											fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																							
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fprintf(fp," %-24.24s ",dc1_physician_name.arr);		

											}
											else
											fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
										 }
										}
									}
								}
								if (d1_summary_dtl_ind.arr[5] == 'A') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_mapping_code.arr,10);
										  if(strlen(d1_mapping_code.arr)<10)
										  fun_add_space(10-strlen(d1_mapping_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd1_mapping_code_desc.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																																	
										 }
										 else
										 fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(26);
										else
										fprintf(fp," %-10.10s %-13.13s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									{
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,10);
									  if(strlen(d1_mapping_code.arr)<10)
									  fun_add_space(10-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,13);
									  if(strlen(nd1_mapping_code_desc.arr)<13)
									  fun_add_space(13-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									}
									else
									{ 
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-13.13s",nd1_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
									
																																																						
									 }
									 else
									 fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
									}
									}
								}
							 }
							 else
							 {
								 if (d1_summary_dtl_ind.arr[5] == 'S') 
								 {
									 if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									 {
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,11);
										  if(strlen(d1_blng_serv_code.arr)<11)
										  fun_add_space(11-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
												
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-11.11s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);

												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
																																																					
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fprintf(fp," %s \n",dc1_physician_name.arr);		

											}
											else
											{
												fprintf(fp," %-11.11s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fprintf(fp," - %s \n",dc1_physician_name.arr);
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										 }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(39);
										else
										fprintf(fp," %-11.11s %-25.25s "," "," "); //,d1_serv_item_code.arr);
									 }
									 else
									 {
									   if(nd_print_option.arr[0]=='R')
										 {
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,12);
										  if(strlen(d1_blng_serv_code.arr)<11)
										  fun_add_space(11-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strncat(nd_line_text.arr,nd_blng_desc1.arr,25);
										  if(strlen(nd_blng_desc1.arr)<25)
										  fun_add_space(25-strlen(nd_blng_desc1.arr));
										  fun_add_space(1);
								
										 }
									   else
									   {
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {	
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-25.25s",nd_blng_desc1.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);

											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," %-37.37s ",nd_desc_with_spl_chr.arr);		

											}
											else
											fprintf(fp," %-11.11s %-25.25s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																			
																																																							
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fprintf(fp," %-37.37s ",dc1_physician_name.arr);		

											}
											else
											fprintf(fp," %-11.11s %-25.25s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
										 }
									   }
									 }
								 }
								 if (d1_summary_dtl_ind.arr[5] == 'A') 
								 {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_mapping_code.arr,11);
										  if(strlen(d1_mapping_code.arr)<11)
										  fun_add_space(11-strlen(d1_mapping_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd1_mapping_code_desc.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-11.11s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																															
										 }
										 else
										 fprintf(fp," %-11.11s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(39);
										else
										fprintf(fp," %-11.11s %-25.25s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									{
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,11);
									  if(strlen(d1_mapping_code.arr)<11)
									  fun_add_space(11-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,25);
									  if(strlen(nd1_mapping_code_desc.arr)<25)
									  fun_add_space(25-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									}
									else
									 {
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-25.25s",nd1_mapping_code_desc.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											fprintf(fp," %-11.11s %-25.25s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																												
																																																							
										 }
										 else
									  fprintf(fp," %-11.11s %-25.25s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
									 }
									}
								  }
							 }
							
						}
						else
						{
							if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							{
								if(d1_summary_dtl_ind.arr[5] == 'S') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
										  if(strlen(d1_blng_serv_code.arr)<10)
										  fun_add_space(10-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
												
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
																																																																									
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fprintf(fp," %s \n",dc1_physician_name.arr);		

											}
											else
											{
												fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fprintf(fp," - %s \n",dc1_physician_name.arr);
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										  }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(26);
										else
										fprintf(fp," %-10.10s %-13.13s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
									  if(strlen(d1_blng_serv_code.arr)<10)
									  fun_add_space(10-strlen(d1_blng_serv_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd_blng_desc1.arr,13);
									  if(strlen(nd_blng_desc1.arr)<13)
									  fun_add_space(13-strlen(nd_blng_desc1.arr));
									  fun_add_space(1);
							
									 }
									 else
									 {
									    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-13.13s",nd_blng_desc1.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);

											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," %-24.24s ",nd_desc_with_spl_chr.arr);		

											}
											else
											fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																						
																																																							
										 }
									  else
									  {
										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
											fprintf(fp," %-24.24s ",dc1_physician_name.arr);		

										}
										else
										fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
									  }
									 }
									}
								}
								if(d1_summary_dtl_ind.arr[5] == 'A') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_mapping_code.arr,10);
										  if(strlen(d1_mapping_code.arr)<10)
										  fun_add_space(10-strlen(d1_mapping_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd1_mapping_code_desc.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																																																			
										 }
										 else
										 fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(26);
										else
										fprintf(fp," %-10.10s %-13.13s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,10);
									  if(strlen(d1_mapping_code.arr)<10)
									  fun_add_space(10-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,13);
									  if(strlen(nd1_mapping_code_desc.arr)<13)
									  fun_add_space(13-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									 }
									 else
									 {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-13.13s",nd1_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																					
																																																						
									 }
									  else
									  fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
									 }
									}
								}
							}
							else
							{
								if(d1_summary_dtl_ind.arr[5] == 'S') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,12);
										  if(strlen(d1_blng_serv_code.arr)<12)
										  fun_add_space(12-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-12.12s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
																																																																																														
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fprintf(fp," %s \n",dc1_physician_name.arr);		

											}
											else
											{
												fprintf(fp," %-12.12s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fprintf(fp," - %s \n",dc1_physician_name.arr);
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										 }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(42);
										else
										fprintf(fp," %-12.12s %-27.27s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_blng_serv_code.arr,12);
									  if(strlen(d1_blng_serv_code.arr)<12)
									  fun_add_space(12-strlen(d1_blng_serv_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd_blng_desc1.arr,27);
									  if(strlen(nd_blng_desc1.arr)<27)
									  fun_add_space(27-strlen(nd_blng_desc1.arr));
									  fun_add_space(1);
							
									 }
									 else
									 {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {	
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-27.27s",nd_blng_desc1.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);

										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %-40.40s ",nd_desc_with_spl_chr.arr);		

										}
										else
										fprintf(fp," %-12.12s %-27.27s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																												
																																																						
									 }
									  else
									  {
										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
											fprintf(fp," %-40.40s ",dc1_physician_name.arr);		

										}
										else
										fprintf(fp," %-12.12s %-27.27s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);

									  }
									 }
									}
								}
								if(d1_summary_dtl_ind.arr[5] == 'A')
								{ 
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_mapping_code.arr,12);
										  if(strlen(d1_mapping_code.arr)<12)
										  fun_add_space(12-strlen(d1_mapping_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd1_mapping_code_desc.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-12.12s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																																																																							
										 }
										 else
										 fprintf(fp," %-12.12s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(42);
										else
										fprintf(fp," %-12.12s %-27.27s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,12);
									  if(strlen(d1_mapping_code.arr)<12)
									  fun_add_space(12-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,27);
									  if(strlen(nd1_mapping_code_desc.arr)<27)
									  fun_add_space(27-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									 }
									 else
									 {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-27.27s",nd1_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-12.12s %-27.27s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																											
																																																						
									 }
									  else
									  fprintf(fp," %-12.12s %-27.27s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
									  //fprintf(fp," %-12.12s %-18.18s %-9.9s",d1_serv_anal_grp.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
									 }
									}
								}

							}

							
						}

						
				}
				else
				{
						if (nd2_summary_dtl_ind.arr[3] == 'S')  
						{
							
							p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;  //total  gross
							p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;       //total  net
							p_tot_pat_disc_amt=p_tot_pat_disc_amt+nd_pat_disc_amt;     //total  discount
										    					
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							  if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
							  {	
								get_addlcharge_count();
								if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
								print_formated_amt2(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt);
							  }
							  //print_formated_amt2(d1_addl_charge_amt_in_charge);
							}
							//else rag
							//if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							//fprintf(fp,"%11.11s"," ");  //added by vani for printing service date for patient
			
							
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
							 {
							
							 print_formated_amt(nd_pat_gross_amt-nd_inside_pkg_gross_amt);
							 }
							}
													 
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
							 print_formated_amt(nd_pat_net_amt1-nd_inside_pkg_net_amt);
							}
							
							//if(nd_pat_net_amt1>=0)
							//nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
							//else
							nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
													
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							{
								if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
								{
								 get_discount_count();
								if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
								{
								  if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
								  print_formated_amt(nd_pat_disc_amt);
								 }
								}
								if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
								{
								  if(c_disc_amt_in_dtl_yn.arr[0]=='N')
								  {
								   if (strcmp(c_servdate_in_dtlformat_yn.arr,"N")==0)
								   {
								    if(nd_print_option.arr[0]=='R')
									fun_add_space(18);
									else
									fprintf(fp,"%-18.18s"," ");
								   }
								   if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
								   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
								   {
								    if(nd_print_option.arr[0]=='R')
									fun_add_space(9);
									else
									fprintf(fp,"%-9.9s"," ");
								   }
								   print_formated_amt(nd1_serv_tot_disc);
								  }
								  else
								  {
								    print_formated_amt(nd1_serv_charge_discount);
									print_formated_amt(nd1_serv_bill_discount);
									print_formated_amt(nd1_serv_fund_adjustment);
								  }

								}
									
							}
							if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
							if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
							{
							 if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
							  print_formated_amt((nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt));
						
							 else
							 {
							  if (strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0)
							  print_formated_amt(nd_pat_net_charge_amt-nd_inside_pkg_amtpayable_amt);
							 }
							}
							nd_tot_subdiv_amt=nd_tot_subdiv_amt+nd_subdiv_amt; //total Subsidized Amt

						   if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
						   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
						   {
							if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)
							{
								get_subsidized_amt();
								if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
								print_formated_amt(nd_subdiv_amt);
							}
						   }
							  
						}

						get_blng_serv_desc1();
					    /* This If Condition for checking if any additional charge is there 
						then it will print the below format otherwise else format*/
						
					    if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
						if(l_no_of_clumns ==5)
						{
							if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							{
								if (d1_summary_dtl_ind.arr[5] == 'S') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
										  if(strlen(d1_blng_serv_code.arr)<10)
										  fun_add_space(10-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);

												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
																																																																																																																
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fprintf(fp," %s \n",dc1_physician_name.arr);		

											}
											else
											{
												fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fprintf(fp," - %s \n",dc1_physician_name.arr);
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										 }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(26);
									    else
										fprintf(fp," %-10.10s %-13.13s "," "," "); //,d1_serv_item_code.arr);

									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
										  if(strlen(d1_blng_serv_code.arr)<10)
										  fun_add_space(10-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strncat(nd_line_text.arr,nd_blng_desc1.arr,13);
										  if(strlen(nd_blng_desc1.arr)<13)
										  fun_add_space(13-strlen(nd_blng_desc1.arr));
										  fun_add_space(1);
								
										}
										else
									    {
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {	
											nd_temp_str.arr[0]='\0';
											nd_temp_str.len=0;
											sprintf(nd_temp_str.arr,"%-13.13s",nd_blng_desc1.arr);
											fun_Pad_desc_with_spl_char(nd_temp_str.arr);
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," %-24.24s ",nd_desc_with_spl_chr.arr);		

											}
											else
											fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																		
																																																							
										 }
										  else
										  {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fprintf(fp," %-23.23s ",dc1_physician_name.arr);		

											}
											else
											fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
										  }
										}
									} 
								}
								if (d1_summary_dtl_ind.arr[5] == 'A') 	
								{					
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_mapping_code.arr,10);
										  if(strlen(d1_mapping_code.arr)<10)
										  fun_add_space(10-strlen(d1_mapping_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd1_mapping_code_desc.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																																																																																									
										 }
										 else
										 fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(26);
										else
										fprintf(fp," %-10.10s %-13.13s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									{
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,10);
									  if(strlen(d1_mapping_code.arr)<10)
									  fun_add_space(10-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,13);
									  if(strlen(nd1_mapping_code_desc.arr)<13)
									  fun_add_space(13-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									}
									else
									{
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-13.13s",nd1_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																						
																																																						
									 }
									  else
									 fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
									}
									}
								}
							}
							else
							{
							
								if (d1_summary_dtl_ind.arr[5] == 'S') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,11);
										  if(strlen(d1_blng_serv_code.arr)<11)
										  fun_add_space(11-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-11.11s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
												
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
																																																																																																																																	
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fprintf(fp," %s \n",dc1_physician_name.arr);		

											}
											else
											{
												fprintf(fp," %-11.11s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);

												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fprintf(fp," - %s \n",dc1_physician_name.arr);
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										 }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(39);
										else
										fprintf(fp," %-11.11s %-25.25s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									   if(nd_print_option.arr[0]=='R')
										 {
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,12);
										  if(strlen(d1_blng_serv_code.arr)<11)
										  fun_add_space(11-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strncat(nd_line_text.arr,nd_blng_desc1.arr,25);
										  if(strlen(nd_blng_desc1.arr)<25)
										  fun_add_space(25-strlen(nd_blng_desc1.arr));
										  fun_add_space(1);
								
										 }
									 else
									 {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {	
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-25.25s",nd_blng_desc1.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);

										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %-37.37s ",nd_desc_with_spl_chr.arr);		

										}
										else
										fprintf(fp," %-11.11s %-25.25s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																													
																																																						
									 }
									  else
									  {
										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
											fprintf(fp," %-37.37s ",dc1_physician_name.arr);		

										}
										else
										fprintf(fp," %-11.11s %-25.25s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
									  }
									  
									 }
									}
								}
								if (d1_summary_dtl_ind.arr[5] == 'A') 	
								{					
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_mapping_code.arr,11);
										  if(strlen(d1_mapping_code.arr)<11)
										  fun_add_space(11-strlen(d1_mapping_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd1_mapping_code_desc.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-11.11s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																																																																																																										
										 }
										 else
										 fprintf(fp," %-11.11s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(39);
										else
										fprintf(fp," %-11.11s %-25.25s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									{
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,11);
									  if(strlen(d1_mapping_code.arr)<11)
									  fun_add_space(11-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,25);
									  if(strlen(nd1_mapping_code_desc.arr)<25)
									  fun_add_space(25-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									}
									else
									{
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-25.25s",nd1_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-11.11s %-25.25s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																																																
																																																						
									 }
									  else
									 fprintf(fp," %-11.11s %-25.25s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
									}
									}
								}
							}

							
						}
						else
						{	
							
							if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							{
								if (d1_summary_dtl_ind.arr[5] == 'S') 
							    {
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
										  if(strlen(d1_blng_serv_code.arr)<10)
										  fun_add_space(10-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr );  //,d1_serv_item_code.arr); 
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
											
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fprintf(fp," %s \n",dc1_physician_name.arr);		

											}
											else
											{
												fprintf(fp," %-10.10s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr );  //,d1_serv_item_code.arr); 
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fprintf(fp," - %s \n",dc1_physician_name.arr);
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										 }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(26);
										else
										fprintf(fp," %-10.10s %-13.13s "," "," " );  //,d1_serv_item_code.arr); 
									}
									else
									{
									 if(nd_print_option.arr[0]=='R')
									{
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
									  if(strlen(d1_blng_serv_code.arr)<10)
									  fun_add_space(10-strlen(d1_blng_serv_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd_blng_desc1.arr,13);
									  if(strlen(nd_blng_desc1.arr)<13)
									  fun_add_space(13-strlen(nd_blng_desc1.arr));
									  fun_add_space(1);
							
									}
									else
									{
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {	
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-13.13s",nd_blng_desc1.arr);
										nd_temp_str.len = strlen(nd_temp_str.arr);
										nd_temp_str.arr[nd_temp_str.len] = '\0';
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										
										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %-24.24s ",nd_desc_with_spl_chr.arr);		

										}
										else
										fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr );  //,d1_serv_item_code.arr); 
																																																				
									 }
									  else
									  {
										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
											fprintf(fp," %-24.24s ",dc1_physician_name.arr);		

										}
										else
										fprintf(fp," %-10.10s %-13.13s ",d1_blng_serv_code.arr,nd_blng_desc1.arr );  //,d1_serv_item_code.arr); 
									  }
									}
									}
								 }
								if (d1_summary_dtl_ind.arr[5] == 'A') 
								{						
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,10);
										  if(strlen(d1_blng_serv_code.arr)<10)
										  fun_add_space(10-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr);  //,d1_serv_item_code.arr);
																			
										 }
										 else
										 fprintf(fp," %-10.10s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr);  //,d1_serv_item_code.arr);
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(26);
										else
										fprintf(fp," %-10.10s %-13.13s "," "," ");  //,d1_serv_item_code.arr);
									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,10);
									  if(strlen(d1_mapping_code.arr)<10)
									  fun_add_space(10-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,13);
									  if(strlen(nd1_mapping_code_desc.arr)<13)
									  fun_add_space(13-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									 }
									 else
									 {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-13.13s",nd1_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr);  //,d1_serv_item_code.arr);
																																																													
									 }
									  else
									  fprintf(fp," %-10.10s %-13.13s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr);  //,d1_serv_item_code.arr);
									 //fprintf(fp," %-12.12s %-18.18s %-9.9s",d1_serv_anal_grp.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
								     }	
									}
								}
							}
							else
							{
							
								if (d1_summary_dtl_ind.arr[5] == 'S') 
								{
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_blng_serv_code.arr,12);
										  if(strlen(d1_blng_serv_code.arr)<12)
										  fun_add_space(12-strlen(d1_blng_serv_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd_blng_desc1.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %s \n",nd_desc_with_spl_chr.arr); 

											}
											else
											{
												fun_Pad_desc_with_spl_char(nd_blng_desc1.arr);
												fprintf(fp," %-12.12s %s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
													fprintf(fp," - %s \n",nd_desc_with_spl_chr.arr); 	
												}
												else
												{
													fprintf(fp,"\n");
												}

											}
																												
										 }
										 else
										 {
											if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
											{
													fprintf(fp," %s \n",dc1_physician_name.arr);		

											}
											else
											{
												fprintf(fp," %-12.12s %s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
												if(strcmp(d1_print_pract_name_ind.arr,"A")==0) //added for crf-0809	
												{
													fprintf(fp," - %s \n",dc1_physician_name.arr);
												}
												else
												{
													fprintf(fp,"\n");
												}
											}
										 }
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(42);
										else
										fprintf(fp," %-12.12s %-27.27s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_blng_serv_code.arr,12);
									  if(strlen(d1_blng_serv_code.arr)<12)
									  fun_add_space(12-strlen(d1_blng_serv_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd_blng_desc1.arr,27);
									  if(strlen(nd_blng_desc1.arr)<27)
									  fun_add_space(27-strlen(nd_blng_desc1.arr));
									  fun_add_space(1);
							
									 }
									 else
									 {
									  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {	
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-27.27s",nd_blng_desc1.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
												fun_Pad_desc_with_spl_char(dc1_physician_name.arr);
												fprintf(fp," %-40.40s ",nd_desc_with_spl_chr.arr);		

										}
										else
										fprintf(fp," %-12.12s %-27.27s ",d1_blng_serv_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
									
																																																													
									 }
									  else
									  {
										if(strcmp(d1_print_pract_name_ind.arr,"I")==0) //added for crf-0809
										{
											fprintf(fp," %-40.40s ",dc1_physician_name.arr);		

										}
										else
										fprintf(fp," %-12.12s %-27.27s ",d1_blng_serv_code.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);

									  }
									 }
									}
								}
								if (d1_summary_dtl_ind.arr[5] == 'A') 	
								{					
									if (strcmp(c_serv_desc_sep_line_yn.arr,"Y")==0)
									{
										if(nd_print_option.arr[0]=='R')
										{
										  fun_add_space(1);
										  strncat(nd_line_text.arr,d1_mapping_code.arr,12);
										  if(strlen(d1_mapping_code.arr)<12)
										  fun_add_space(12-strlen(d1_mapping_code.arr));
										  fun_add_space(1);
										  strcat(nd_line_text.arr,nd1_mapping_code_desc.arr);
										  fun_add_space(1);
										  fun_bl_report_temp_format();
								
										}
										else
										{
										  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										 {
										
											fun_Pad_desc_with_spl_char(nd1_mapping_code_desc.arr);
											fprintf(fp," %-12.12s %s \n",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																																					
										 }
										 else
										 fprintf(fp," %-12.12s %s \n",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
										 
										}
										lsr_line_cnt();
										if(nd_print_option.arr[0]=='R')
										fun_add_space(42);
										else
										fprintf(fp," %-12.12s %-27.27s "," "," "); //,d1_serv_item_code.arr);
									}
									else
									{
									  if(nd_print_option.arr[0]=='R')
									 {
									  fun_add_space(1);
									  strncat(nd_line_text.arr,d1_mapping_code.arr,12);
									  if(strlen(d1_mapping_code.arr)<12)
									  fun_add_space(12-strlen(d1_mapping_code.arr));
									  fun_add_space(1);
									  strncat(nd_line_text.arr,nd1_mapping_code_desc.arr,27);
									  if(strlen(nd1_mapping_code_desc.arr)<27)
									  fun_add_space(27-strlen(nd1_mapping_code_desc.arr));
									  fun_add_space(1);
							
									 }
									 else
									 {
									   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-27.27s",nd1_mapping_code_desc.arr);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
										fprintf(fp," %-12.12s %-27.27s ",d1_mapping_code.arr,nd_desc_with_spl_chr.arr); //,d1_serv_item_code.arr);
																	
																																																										
									 }
									  else
									  fprintf(fp," %-12.12s %-27.27s ",d1_mapping_code.arr,nd1_mapping_code_desc.arr); //,d1_serv_item_code.arr);
									 }
									}
								}
							}
							
						}

				}
			

				get_gross_net_amt();
				
				p_tot_pat_gross_amt=p_tot_pat_gross_amt+p_pat_gross_amt;
				p_tot_pat_net_amt=p_tot_pat_net_amt+p_pat_net_amt;
				//p_tot_pat_disc_amt=p_tot_pat_disc_amt+p_pat_disc_amt;
				p_tot_pat_disc_amt=p_tot_pat_disc_amt+d1_upd_disc_amt;
				
				if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
				{
					if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
					{
						if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
						{
						 get_addlcharge_count();
						 if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
						 print_formated_amt2(d1_addl_charge_amt_in_charge);
						}
					
						else
						if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
						{
						  if(nd_print_option.arr[0]=='R')
						  {
						   if(strlen(nd_service_date.arr)<16)
						   {
						    fun_add_space(16-strlen(nd_service_date.arr));
						    strcat(nd_line_text.arr,nd_service_date.arr);
						   }
						   else
						   strncat(nd_line_text.arr,nd_service_date.arr,16);
						  }
						  else
						  fprintf(fp,"%16.16s",nd_service_date.arr);  //added by vani for printing service date for patient
						  print_formated_qty(d1_serv_qty);
						  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
						  print_formated_amt(d1_rate);
						} 
					
					}

					if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
					{
					    if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
						{
						  if(nd_print_option.arr[0]=='R')
						  {
						   if(strlen(nd_service_date.arr)<16)
						   {
						    fun_add_space(16-strlen(nd_service_date.arr));
						    strcat(nd_line_text.arr,nd_service_date.arr);
						   }
						   else
						   strncat(nd_line_text.arr,nd_service_date.arr,16);
						  }
						  fprintf(fp,"%16.16s",nd_service_date.arr);  //added by vani for printing service date for patient
						  print_formated_qty(d1_serv_qty);
						  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
						  print_formated_amt(d1_rate);
						} 
					}
				}

				if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
				if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
				{
				 if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
				 {
			  	  print_formated_amt(p_pat_gross_amt);
				 }
				}
					
				if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
				if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
				{
				 if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
				 print_formated_amt(p_pat_net_amt);
				 
				}				 
				 //if(d1_upd_net_charge_amt>=0)
				 //nd_subdiv_amt=p_pat_net_amt-d1_upd_net_charge_amt;

				 nd_subdiv_amt=p_pat_net_amt-d1_upd_net_charge_amt;
				
				if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
				{
					if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
					{
					 get_discount_count();
					 if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
					 {
					  if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
					  print_formated_amt(d1_upd_disc_amt);
					 }
					}
					if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
					{
					 if(c_disc_amt_in_dtl_yn.arr[0]=='N')
					 {
					  if (strcmp(c_servdate_in_dtlformat_yn.arr,"N")==0)
					  if(nd_print_option.arr[0]=='R')
					  fun_add_space(18);
					  else
					  fprintf(fp,"%-18.18s"," ");
					  print_formated_amt(d1_tot_disc);  
					 }
					 else
					 {
					  print_formated_amt(d1_charge_discount);
					  print_formated_amt(d1_bill_discount);
					  print_formated_amt(d1_fund_adjustment);
					 }
					}

				}
				
				if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			    if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
				{
				 if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
				  print_formated_amt(d1_upd_net_charge_amt-d1_addl_charge_amt_in_charge);
			
				 else
				 {
				  if (strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0)
				  print_formated_amt(d1_upd_net_charge_amt);
					  
				 }
                }

			    /*
				if(d1_upd_net_charge_amt>=0)
				{
				nd_subdiv_amt=p_pat_gross_amt-d1_upd_net_charge_amt;
				}
				else
				{
				nd_subdiv_amt=p_pat_gross_amt+d1_upd_net_charge_amt;
				}
			   */
				nd_tot_subdiv_amt=nd_tot_subdiv_amt+nd_subdiv_amt;

				if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
				if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
				{
				 if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)
				 {
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					print_formated_amt(nd_subdiv_amt);
				 }
			    }

				nd1_grd_tot_rate=nd1_grd_tot_rate+d1_rate;  //Grand Total Rate by Service wise
				
				nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;	
				nd_pat_tot_addl_charge_amt=nd_pat_tot_addl_charge_amt+d1_addl_charge_amt_in_charge;			
				

				nd1_tot_serv_tot_disc=nd1_tot_serv_tot_disc+d1_tot_disc;						//Grand Total Discount
				nd1_tot_serv_charge_discount=nd1_tot_serv_charge_discount+d1_charge_discount;	//Grand Total Charge Discount
				nd1_tot_serv_bill_discount=nd1_tot_serv_bill_discount+d1_bill_discount;			//Grand Total Bill Discount
				nd1_tot_serv_fund_adjustment=nd1_tot_serv_fund_adjustment+d1_fund_adjustment;	//Grand Total Fund(policy) Discount

				if( d1_package_trx_yn.arr[0] == 'N' || (d1_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
				{
				  if(nd_print_option.arr[0]=='R')
				  fun_bl_report_temp_format();
				  else
				  fprintf(fp,"\n");
				  lsr_line_cnt();
				}


				/*** added by vani for printing PH Batch Details*******/
				
				if(strcmp(d1_mapping_code_ind.arr,"M")==0 && strcmp(d1_folio_batch_id.arr,"\0")!=0)
				{
				
				if(d1_summary_dtl_ind.arr[3] == 'D') 
				get_payer_batch_details();
				if(strcmp(d1_print_pract_name_ind.arr,"S")==0) //added for crf-0809
					fprintf(fp," - "); 
				}

				/*********End of Batch Id*******/

				/***added by vani for CRF-809***/
				
				if(strcmp(d1_print_pract_name_ind.arr,"S")==0) //added for crf-0809
				{
					fprintf(fp," %s",dc1_physician_name.arr); 
					fprintf(fp,"\n");
				}

				/********up to here******/
			
				nd_pat_gross_amt=0;
				nd_pat_net_amt1=0;
				nd_pat_disc_amt=0;
				nd_subdiv_amt=0;
				nd_pat_net_charge_amt=0;
				nd_pat_addl_charge_amt=0;
				nd1_serv_tot_disc=0;
				nd1_serv_charge_discount=0;
				nd1_serv_bill_discount=0;
				nd1_serv_fund_adjustment=0;
				nd1_tot_rate=0;
				nd1_tot_serv_qty=0;
				nd_inside_pkg_gross_amt=0;
				 nd_inside_pkg_net_amt=0;
				 nd_inside_pkg_amtpayable_amt=0;
				 nd_inside_pkg_disc_amt=0;
				 nd_inside_pkg_addchrg_amt=0;
				end_of_report=0;
				ccnt=0;

             }
     strcpy(nd1_prt_grp_hdr_code.arr,d1_prt_grp_hdr_code.arr);
     strcpy(nd1_prt_grp_line_code.arr,d1_prt_grp_line_code.arr);
     strcpy(nd1_payer_serv_grp_hdr.arr,d1_payer_serv_grp_hdr.arr);
     strcpy(nd1_payer_serv_grp_line.arr,d1_payer_serv_grp_line.arr);
	 strcpy(nd2_blng_serv_code.arr,d1_blng_serv_code.arr); //ADDED AT 29/10/2007
	 strcpy(nd2_serv_anal_grp.arr,d1_serv_anal_grp.arr); 
	 strcpy(nd2_summary_dtl_ind.arr,d1_summary_dtl_ind.arr);
	 strcpy(nd1_package_trx_yn.arr,d1_package_trx_yn.arr);

	
  }

 else
 {
			 ccnt=0;
			 othp_cnt=othp_cnt+1;
	
			 if (strcmp(d1_cust_code1.arr,nd_cust_code1.arr)==0)
			 {
			  
			   nd_othp_payer_amt=nd_othp_payer_amt+d1_upd_net_charge_amt;
			   //nd_tot_othp_payer_amt=nd_tot_othp_payer_amt+nd_othp_payer_amt;
			   nd_tot_othp_payer_amt=nd_tot_othp_payer_amt+d1_upd_net_charge_amt;
			 }
			 else
			 {

				if (othp_cnt==1)
				{					
				 
				  nd_othp_payer_amt=nd_othp_payer_amt+d1_upd_net_charge_amt;
				  nd_tot_othp_payer_amt=nd_tot_othp_payer_amt+d1_upd_net_charge_amt;
				  //nd_tot_othp_payer_amt=nd_tot_othp_payer_amt+nd_othp_payer_amt;
				}
				else
				{
				
				  //nd_tot_othp_payer_amt=nd_tot_othp_payer_amt+nd_othp_payer_amt;
              		
					strcpy(ar_cust_amt[p],nd_cust_nm.arr); 

					/*** Below Code Added for CRF-659 ***/
					l_cust_code.arr[0] ='\0';
			        l_cust_code.len = 0;
					
		            strcpy(l_cust_code.arr,nd_cust_code1.arr);
					l_cust_code.len=strlen(nd_cust_code1.arr);
		            l_cust_code.arr[l_cust_code.len]='\0';
					get_bill_num(1);
					strcpy(bill_code[p],l_bill_num_temp.arr); 
					/*** Up To Here ***/

				    put_val(ar_amt[p],nd_othp_payer_amt); 
					format_amt(ar_amt[p]);
					nd_othp_payer_amt=0;
					nd_othp_payer_amt=nd_othp_payer_amt+d1_upd_net_charge_amt;
					nd_tot_othp_payer_amt=nd_tot_othp_payer_amt+d1_upd_net_charge_amt;
					p=p+1;
				}
			 	
			 }

			 //sprintf(st_var,"%d",p);
			 //disp_message(ERR_MESG,st_var);
			 //disp_message(ERR_MESG,d1_cust_code1.arr);
			 
			  nd_cust_code1.arr[0] ='\0';
			  nd_cust_code1.len = 0;
			  l_cust_code.arr[0] ='\0';
			  l_cust_code.len = 0;
		      l_bill_num_temp.arr[0]='\0';
			  l_bill_num_temp.len=0;
			   
			  strcpy(nd_cust_code1.arr,d1_cust_code1.arr);
			  fetch_customer2();
		      strcpy(nd_cust_nm.arr,d_customer3.arr);
			  /*** Below Code Added for CRF-659 ***/
			  strcpy(l_cust_code.arr,d1_cust_code1.arr);
			  l_cust_code.len=strlen(d1_cust_code1.arr);
		      l_cust_code.arr[l_cust_code.len]='\0';
		      get_bill_num(1);
			  strcpy(bill_code[0],l_bill_num.arr); 
		      strcpy(l_bill_num_temp.arr,l_bill_num.arr); 
			  
			  /*** Up To Here ***/
			
             //nd_cust_code1.arr[nd_cust_code1.len] ='\0';


  }




} //END OF print_patient_hdr

/* THIS FUNCTION WILL PRINT THE PURE CASH BILL */

print_cash_patient_hdr()
 { 
  	if(strcmp(d1_cust_code1.arr,"\0")!=0)
	{
	  ccnt=0;
    } 

	if(strcmp(d1_cust_code1.arr,"\0")==0)
	  {
             
		   if(d1_summary_dtl_ind.arr[3]=='S') 
			  {  
                 	 
			      if(ccnt==1)
				    {
					   					
						get_print_group_hd_desc();
						get_print_group_line_desc();
						//get_blng_serv_desc1();
											
						fprintf(fp,"\n%-19.19s / %-19.19s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	
						lsr_line_cnt();
					
						//fprintf(fp," %-10.10s %-19.19s %-9.9s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
								   
					    get_gross_net_amt();
					
						nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;  //total service gross
						nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;		//total service net
						nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;		//total service discount
											
						nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;  
						nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;				//total Net Amt
						nd_tot_net_reimbursable_amt=nd_tot_net_reimbursable_amt+d_net_reimbursable_amt;			//total service Reimbursable Amt
						nd_net_non_reimbursable_amt=nd_pat_net_amt1-nd_tot_net_reimbursable_amt;                
						nd_tot_non_reimbursable_amt=nd_tot_non_reimbursable_amt+nd_net_non_reimbursable_amt;    //total service Non Reimbursable Amt
						nd_gnd_tot_net_reimbursable_amt=nd_gnd_tot_net_reimbursable_amt+d_net_reimbursable_amt; //total Reimbursable Amt
						nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt; //total Non Reimbursable Amt

						//nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt; //total Non Reimbursable Amt
					
						
						end_of_report=1;

			        }

					else
					{

					  if(strcmp(d1_prt_grp_hdr_code.arr,nd1_prt_grp_hdr_code.arr)==0 && strcmp(d1_prt_grp_line_code.arr,nd1_prt_grp_line_code.arr)==0
				      && strcmp(d1_payer_serv_grp_hdr.arr,nd1_payer_serv_grp_hdr.arr)==0 && strcmp(d1_payer_serv_grp_line.arr,nd1_payer_serv_grp_line.arr)==0)
				      {
					   
																	
						get_gross_net_amt();						
						nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;	//total service gross
						nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;		//total service net
						nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;		//total service discount

						nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;
						nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;			   //total Net Amt
						nd_tot_net_reimbursable_amt=nd_tot_net_reimbursable_amt+d_net_reimbursable_amt;		   //total service Reimbursable Amt
						nd_net_non_reimbursable_amt=p_pat_net_amt-d_net_reimbursable_amt; 
						nd_tot_non_reimbursable_amt=nd_tot_non_reimbursable_amt+nd_net_non_reimbursable_amt;   //total service Non Reimbursable Amt
						nd_gnd_tot_net_reimbursable_amt=nd_gnd_tot_net_reimbursable_amt+d_net_reimbursable_amt;//total Reimbursable Amt
						nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt; //total Non Reimbursable Amt
						//nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt; 
															
						
									
						end_of_report=1;

					  }

					   else
					   {
					   						
						p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;	//total gross Amt
						p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;		//total net Amt
						nd_tot_pat_disc_amt=nd_tot_pat_disc_amt+nd_pat_disc_amt;	//total discount Amt
																											
						if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
						{
						
						print_formated_amt(nd_pat_gross_amt);
						}
						if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
						print_formated_amt(nd_pat_net_amt1);
						if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0)   
						print_formated_amt(nd_pat_disc_amt);

						if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0) 
						{
						nd_pat_net_amt1=nd_pat_gross_amt-nd_pat_disc_amt;
						print_formated_amt(nd_pat_net_amt1);					//Net Amount for summary services
						}
						else
						{
						nd_pat_net_amt1= nd_pat_net_amt1;
						}

						if (strcmp(c_reim_amt_ind.arr,"Y")==0)
						print_formated_amt(nd_tot_net_reimbursable_amt);		//printing the Reimbursable Amt

						//nd_net_non_reimbursable_amt=nd_pat_net_amt1-nd_tot_net_reimbursable_amt;
						//nd_tot_non_reimbursable_amt=nd_tot_non_reimbursable_amt+nd_net_non_reimbursable_amt;   //total service Non Reimbursable Amt
		
						fprintf(fp," ");
						if (strcmp(c_non_reim_amt_ind.arr,"Y")==0)
						print_formated_amt(nd_tot_non_reimbursable_amt);        //printing the Non Reimbursable Amt
						
						//print_formated_amt(nd_net_non_reimbursable_amt);		//printing the Non Reimbursable Amt
						
						
						nd_pat_gross_amt=0;
						nd_pat_net_amt1=0;
						nd_pat_disc_amt=0;
						nd_tot_net_reimbursable_amt=0;
						nd_tot_non_reimbursable_amt=0;
						//nd_net_non_reimbursable_amt=0;
						nd_pat_net_charge_amt=0;

						get_print_group_hd_desc();
						get_print_group_line_desc();
						fprintf(fp,"\n%-19.19s -  %-19.19s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	
						lsr_line_cnt();

						get_gross_net_amt();
					
						nd_pat_gross_amt=nd_pat_gross_amt+p_pat_gross_amt;  //total service gross
						nd_pat_net_amt1=nd_pat_net_amt1+p_pat_net_amt;		//total service net
						nd_pat_disc_amt=nd_pat_disc_amt+p_pat_disc_amt;		//total service discount
											
						nd_pat_net_charge_amt=nd_pat_net_charge_amt+d1_upd_net_charge_amt;  
						nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt;							//total Net Amt
						nd_tot_net_reimbursable_amt=nd_tot_net_reimbursable_amt+d_net_reimbursable_amt;						//total service Reimbursable Amt
						nd_net_non_reimbursable_amt=p_pat_net_amt-d_net_reimbursable_amt;							//total servicewise Non Reimbursable Amt
						nd_tot_non_reimbursable_amt=nd_tot_non_reimbursable_amt+ nd_net_non_reimbursable_amt;                //total service Non Reimbursable Amt
						nd_gnd_tot_net_reimbursable_amt=nd_gnd_tot_net_reimbursable_amt+d_net_reimbursable_amt;				 //total Reimbursable Amt
						nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt; //total Non Reimbursable Amt

						//nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt; //total Non Reimbursable Amt
											
						

						end_of_report=1;
					

					   }
				
			
				   }
				 
			   d_net_reimbursable_amt=0;

			}
			
		
        else
           {    
			    
				if (strcmp(d1_prt_grp_hdr_code.arr,nd1_prt_grp_hdr_code.arr)!=0 || strcmp(d1_prt_grp_line_code.arr,nd1_prt_grp_line_code.arr)!=0)
				 {
				        nd_tot_non_reimbursable_amt=0;    
						if (nd1_summary_dtl_ind.arr[3]=='S')
						{
                          
						p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;	//total gross Amt
						p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;		//total net Amt
						nd_tot_pat_disc_amt=nd_tot_pat_disc_amt+nd_pat_disc_amt;	//total discount Amt
																											
						if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
						{
						
						print_formated_amt(nd_pat_gross_amt);
						}
						if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
						print_formated_amt(nd_pat_net_amt1);
						if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0)   
						print_formated_amt(nd_pat_disc_amt);

						if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0) 
						{
						nd_pat_net_amt1=nd_pat_gross_amt-nd_pat_disc_amt;
						print_formated_amt(nd_pat_net_amt1);					//Net Amount for summary services
						}
						else
						{
						nd_pat_net_amt1= nd_pat_net_amt1;
						}

						if (strcmp(c_reim_amt_ind.arr,"Y")==0)
						print_formated_amt(nd_tot_net_reimbursable_amt);		//printing the Reimbursable Amt

						nd_net_non_reimbursable_amt=nd_pat_net_amt1-nd_tot_net_reimbursable_amt;
						nd_tot_non_reimbursable_amt=nd_tot_non_reimbursable_amt+nd_net_non_reimbursable_amt;
						fprintf(fp," ");
						if (strcmp(c_non_reim_amt_ind.arr,"Y")==0)
						print_formated_amt(nd_tot_non_reimbursable_amt);
						//print_formated_amt(nd_net_non_reimbursable_amt);		//printing the Non Reimbursable Amt
						
						}

						nd_ref_prt_grp_hdr_code.arr[nd_ref_prt_grp_hdr_code.len] ='\0';
					  	get_print_group_hd_desc();
    					get_print_group_line_desc();
						get_blng_serv_desc1();
					    
						//fprintf(fp,"\n%-s%6s",nd_prt_hd_desc.arr," ");
					    //fprintf(fp," %-20s\n",nd_prt_line_desc.arr);
						fprintf(fp,"\n%-19.19s -  %-19.19s\n",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);	

					    lsr_line_cnt();lsr_line_cnt();

						//fprintf(fp,"\n%-45s-%-45s",nd_prt_hd_desc.arr,nd_prt_line_desc.arr);

						//fprintf(fp,"\n%-2s-%-3s\n",d1_prt_grp_hdr_code.arr,d1_prt_grp_line_code.arr);
     										
					     
						 //fprintf(fp," %-10.10s %-20.20s %-8.8s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
						 fprintf(fp," %-12.12s %-26.26s  ",d1_serv_anal_grp.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);
	                    
				
				}
				else
				{	
						if (nd1_summary_dtl_ind.arr[3]=='S')
						{

							p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;	//total gross Amt
							p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;		//total net Amt
							nd_tot_pat_disc_amt=nd_tot_pat_disc_amt+nd_pat_disc_amt;	//total discount Amt
																												
							if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
							{
							
							print_formated_amt(nd_pat_gross_amt);
							}
							if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
							print_formated_amt(nd_pat_net_amt1);
							if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0)   
							print_formated_amt(nd_pat_disc_amt);

							if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0) 
							{
							nd_pat_net_amt1=nd_pat_gross_amt-nd_pat_disc_amt;
							print_formated_amt(nd_pat_net_amt1);					//Net Amount for summary services
							}
							else
							{
							nd_pat_net_amt1= nd_pat_net_amt1;
							}

							if (strcmp(c_reim_amt_ind.arr,"Y")==0)
							print_formated_amt(nd_tot_net_reimbursable_amt);		//printing the Reimbursable Amt

							nd_net_non_reimbursable_amt=nd_pat_net_amt1-nd_tot_net_reimbursable_amt;
							nd_tot_non_reimbursable_amt=nd_tot_non_reimbursable_amt+nd_net_non_reimbursable_amt;

							fprintf(fp," ");
							if (strcmp(c_non_reim_amt_ind.arr,"Y")==0)
							print_formated_amt(nd_tot_non_reimbursable_amt);
							//print_formated_amt(nd_net_non_reimbursable_amt);		//printing the Non Reimbursable Amt
							
						}
						
						get_blng_serv_desc1();
						//fprintf(fp," %-10.10s %-20.20s %-8.8s ",d1_blng_serv_code.arr,nd_blng_desc1.arr,d1_serv_item_code.arr);
						fprintf(fp," %-12.12s %-26.26s  ",d1_serv_anal_grp.arr,nd_blng_desc1.arr); //,d1_serv_item_code.arr);

				 }
			
				
						nd_tot_non_reimbursable_amt=0;
						get_gross_net_amt();
					
						p_tot_pat_gross_amt=p_tot_pat_gross_amt+p_pat_gross_amt;
						p_tot_pat_net_amt=p_tot_pat_net_amt+p_pat_net_amt;
			    					
						if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
						{
						print_formated_amt(p_pat_gross_amt);  
						}     //Gross
						if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
						print_formated_amt(p_pat_net_amt);		   // Net
						if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0)   
						print_formated_amt(p_pat_disc_amt);

						if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0) 
						{
						nd_pat_net_amt=p_pat_gross_amt-p_pat_disc_amt;
						print_formated_amt(nd_pat_net_amt); //Net Amount
						}
						else
						{
						nd_pat_net_amt=	p_pat_net_amt;
						}
              			
						if (strcmp(c_reim_amt_ind.arr,"Y")==0)
						print_formated_amt(d_net_reimbursable_amt);    //Reimbursable Amt
						
						fprintf(fp," ");
						nd_net_non_reimbursable_amt=nd_pat_net_amt-d_net_reimbursable_amt;
						nd_tot_non_reimbursable_amt=nd_tot_non_reimbursable_amt+nd_net_non_reimbursable_amt;
						
						if (strcmp(c_non_reim_amt_ind.arr,"Y")==0)
						print_formated_amt(nd_tot_non_reimbursable_amt);//Non Reimbursable Amt
						
						//print_formated_amt(nd_net_non_reimbursable_amt);//Non Reimbursable Amt
               			//print_formated_amt(d1_upd_net_charge_amt);				
												
						nd_tot_pat_disc_amt=nd_tot_pat_disc_amt+p_pat_disc_amt;//raghava
						nd_tot_pat_net_charge_amt=nd_tot_pat_net_charge_amt+d1_upd_net_charge_amt; //Net payable
						//nd_tot_net_reimbursable_amt=nd_tot_net_reimbursable_amt+d_net_reimbursable_amt;	
						nd_gnd_tot_net_reimbursable_amt=nd_gnd_tot_net_reimbursable_amt+d_net_reimbursable_amt;
						nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_tot_non_reimbursable_amt; //total Non Reimbursable Amt

						//nd_gnd_tot_net_non_reimbursable_amt=nd_gnd_tot_net_non_reimbursable_amt+nd_net_non_reimbursable_amt;//raghava			
						
						fprintf(fp,"\n");
						lsr_line_cnt();
						
						ccnt=0;
						nd_pat_gross_amt=0;
						nd_pat_net_amt1=0;
						nd_pat_disc_amt=0;
						nd_tot_net_reimbursable_amt=0;
						//nd_net_non_reimbursable_amt=0;
						nd_tot_non_reimbursable_amt=0;
						nd_pat_net_charge_amt=0;
						d_net_reimbursable_amt=0; //ADDED AT 05/11/07
						end_of_report=0;


             }
		  strcpy(nd1_prt_grp_hdr_code.arr,d1_prt_grp_hdr_code.arr);
		  strcpy(nd1_prt_grp_line_code.arr,d1_prt_grp_line_code.arr);
		  strcpy(nd1_payer_serv_grp_hdr.arr,d1_payer_serv_grp_hdr.arr);
		  strcpy(nd1_payer_serv_grp_line.arr,d1_payer_serv_grp_line.arr);
		  strcpy(nd1_blng_serv_code.arr,d1_blng_serv_code.arr); //ADDED AT 29/10/2007
		  strcpy(nd1_serv_anal_grp.arr,d1_serv_anal_grp.arr); 
		  strcpy(nd1_summary_dtl_ind.arr,d1_summary_dtl_ind.arr);
  }


} //end of print_cash_patient_hdr

print_sponsor_patient_hdr()
{
	    get_column_count_cust();
		
        print_report_head();

		 if (strcmp(nd_bill_format_id.arr,"2")==0) //added for IN23425
		 {
			v_lno = line_ctr;	
		 }

		l_next_page=2;
        ccnt=0;
		nd_summary_dtl_ind.arr[0]='\0';
		nd_prt_grp_hdr_code.arr[0]='\0';
		nd_prt_grp_line_code.arr[0]='\0';
		nd_cust_code1.arr[0]='\0';
	
			
	/**The below code added by Rajesh Package Information is not getting printed when no service provided outside package***/		
		get_aviled_outside_pkg();

		if (l_aviled_outside_pkg ==0 )
		{	
			if(l_pkg_len!=0)
			{
			get_payer_bill_header();
			 print_package_dtls(); //1
			}
		}
		/***** upto here *****/


		/***** This code added for printing package bill if it is there ***
	;
		if(l_pkg_len!=0)
		{
		 print_package_dtls(); 
		}
		**** upto here *****/


		while(fetch_grp_hdr_cur())
		{ 	
		 /** The below code added by raghava on 23/11/2009 for Dn't print zero discount amount **/		 	
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && d_tot_disc!=0)
		 {
			 ccnt = ccnt + 1;
			 ccnt1 = ccnt1 + 1;		
			 print_prt_grp_hdr();
		 }
		 else
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  	 ccnt = ccnt + 1;
			 ccnt1 = ccnt1 + 1;		
			 print_prt_grp_hdr();  //11
		 }	 		
		}

       if(end_of_report)
		{
		  	 
			 /* This commented stmts for displaying float values*/ 

			 /*sprintf(st_var,"%f",nd_pat_net_amt2);
			 disp_message(ERR_MESG,st_var);*/
         
			 nd_net_total=nd_net_total+nd_pat_net_amt2;
			 nd_gross_total=nd_gross_total+nd_pat_gross_amt1;
			 nd_disc_total=nd_disc_total+nd_pat_disc_amt1;
			 
			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 {
				 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
				 {
				  //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"C")==0) 
				  if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
				  {
				   get_addlcharge_count();
				   if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
				   print_formated_amt1(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt);
				  }
				  else
				  fprintf(fp,"%11.11s"," ");
				  
		         }

			  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0 && p_disc_amt_in_dtl_yn.arr[0]=='N')
              fprintf(fp,"%11.11s"," ");

				 
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
			 {
			  if (strcmp(p_gross_net_amt_ind.arr,"G")==0)
			  {
			   
			  print_formated_amt(nd_pat_gross_amt1-nd_inside_pkg_gross_amt);
			  }
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
			 {
			  if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
			  print_formated_amt(nd_pat_net_amt2-nd_inside_pkg_net_amt);
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 {
			  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			  {
			  get_discount_count();
			 if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{
			   if (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
			   print_formated_amt(nd_pat_disc_amt1-nd_inside_pkg_disc_amt);
			   }
			  }

			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
			  {
				  if(p_disc_amt_in_dtl_yn.arr[0]=='N')
				  {
				   //if (strcmp(p_servdate_in_dtlformat_yn.arr,"N")==0)
				   //fprintf(fp,"%-18.18s"," ");
				   if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) //for - crf-659
				   fprintf(fp,"%-9.9s"," ");
				   print_formated_amt(nd_serv_tot_disc);
				   
				  }
				  else
				  {
					print_formated_amt(nd_serv_charge_discount);
					print_formated_amt(nd_serv_bill_discount);
					print_formated_amt(nd_serv_fund_adjustment);
				  }

			  }
			 }

			 if( nd_package_trx_yn.arr[0] == 'N' || (nd_package_trx_yn.arr[0] == 'Y' && l_pkg_len==0) )
			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
			 {
			  //if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_addl_charge_amt_ind.arr,"R")==0)
			  if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
			  print_formated_amt((nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt)-(nd_total_addl_charge_by_service-nd_inside_pkg_addchrg_amt));
			  else
			  {
			   if (strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0)
			   print_formated_amt(nd_upd_net_charge_amt-nd_inside_pkg_amtpayable_amt);
			  }
			 }
				
		}
      
      
		//if(end_of_report)
		fprintf(fp,"\n");lsr_line_cnt();
	
		if(strcmp(d_cust_code.arr,"\0")!=0 && lcol_cnt == 1)
		prt_line_uc();
		if(strcmp(d_cust_code.arr,"\0")!=0  && lcol_cnt == 2)
		prt_line_uc_wide();
		fprintf(fp,"\n");lsr_line_cnt();

  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
  { 
		
		get_cnt_remain_space(3);
		if((l_lcnt+5)<=max_lines-v_lno)
		{
		  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		  {
		  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
		  {
		    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			   fprintf(fp,"%-62.62s",loc_legend[680]);
		   }
		   else
		   {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-46.46s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-46.46s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp,"%-46.46s",loc_legend[680]);
			}
		   }
		   else
		   {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-53.53s",loc_legend[680]);
			}
		}
		else
		{
		  while(v_lno<=max_lines)
		  {
			fprintf(fp,"\n");
			v_lno++;
		  }
		  lsr_line_cnt();

		  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		  {
		  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
          {
		      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
			 	 }
				else
			        fprintf(fp,"%-62.62s",loc_legend[680]);
		   }
		  else
		  {
             if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-46.46s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%-46.46s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			     fprintf(fp,"%-46.46s",loc_legend[680]);
		  }
		  }
		  else
		  {
		    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
				 																																														
			}
			else  
			  fprintf(fp,"%-53.53s",loc_legend[680]);
		   }
		
		}

		if (strcmp(p_gross_net_amt_ind.arr,"G")==0)  //PRINTING ROW LEVEL TOTAL
		{
		
		get_pay_inside_pkg_disc();
		print_formated_amt(nd_gross_total+d_pk_pack_tot_g_amount-l_pay_inside_pkg_disc);
		}
		if (strcmp(p_gross_net_amt_ind.arr,"N")==0)
		print_formated_amt(nd_net_total+d_pk_pack_tot_n_amount);
		fprintf(fp,"\n");lsr_line_cnt();


		// To print total package discout in a row
		print_package_discount();

		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
		{
			if (strcmp(p_serv_disc_on_gross_ind.arr,"R")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)   
			{
			
			  if((nd_disc_total)!=0)
			  {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[710]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				   fprintf(fp," %-61.61s",loc_legend[710]);
				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[710]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp," %-44.44s",loc_legend[710]);
				}
				}
				else
				{
			        if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[710]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else	   				   
                        fprintf(fp," %-52.52s",loc_legend[710]);
				   }

				print_formated_amt(nd_disc_total);
				fprintf(fp,"\n");lsr_line_cnt();
			  }			
			}
		}

       



  /* THIS IS FOR DISPLAYING OF OTHER PAYER AMOUNT DEPENDING ON SETUP*/

	

    /*****commneted by vani and printing using cursor*********
	   if(strcmp(d_customer2.arr,"\0")!=0)
	   {
		
		 if (strcmp(p_oth_payers_amt_print_row_ind.arr,"R")==0)
		  {
	   			 
			if(k<=1) 
			{
            
				if(strcmp(nd_cust_code1.arr,"\0")!=0)
				{
					
					//test fetch_customer1();
					//strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					// test strcpy(leg_cust.arr,strcat(leg_cust.arr,nd_cust_code1.arr));
					strcpy(leg_cust.arr,strcat(leg_cust.arr,d_customer2.arr));
					
					if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
					{
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
						 }
						 else
						   fprintf(fp," %-49.49s",leg_cust.arr);
					}
					else
					{
							if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 { 
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 							    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																						
							}
							else
							   fprintf(fp," %-41.41s",leg_cust.arr);
					}
					}
					else
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
  					        fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-49.49s",leg_cust.arr);
					}

					leg_cust.arr[0] = '\0';
					//fprintf(fp,"%-14s %-35s %-s %-s"," ",loc_legend[730],nd_cust_code1.arr,d_customer.arr);
					//print_formated_amt(nd_oth_payer_amt);
					put_val(ar_amt[0],nd_oth_payer_amt); 
					nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+nd_oth_payer_amt;
					format_amt(ar_amt[0]);
					fprintf(fp,"%15s %-20s",ar_amt[0],bill_code[0]);
				}
			}

		   else
		   {    
			   	if(strcmp(nd_cust_code1.arr,"\0")!=0)
				{	
				
					// test fetch_customer1();
					//strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					// test strcpy(leg_cust.arr,strcat(leg_cust.arr,nd_cust_code1.arr));
					strcpy(leg_cust.arr,strcat(leg_cust.arr,d_customer2.arr));
					
					if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-49.49s",leg_cust.arr);
					  }
					else
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-41.41s",leg_cust.arr);
					}
					}
					else
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-49.49s",leg_cust.arr);
					 }

					leg_cust.arr[0] = '\0';
					//fprintf(fp,"%-14s %-35s %-s %-s"," ",loc_legend[730],nd_cust_code1.arr,d_customer.arr);
					put_val(ar_amt[0],nd_oth_payer_amt); 
					nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+nd_oth_payer_amt;
					format_amt(ar_amt[0]);
					fprintf(fp,"%15s %-20s",ar_amt[0],bill_code[0]);
				}

	
				for (i=1;i<k;i++) 
				{
				 
				strcpy(ar_cust.arr,	ar_cust_amt[i]);
				fprintf(fp,"\n");lsr_line_cnt();
				if(strcmp(ar_cust_amt[i],"\0")!=0)
				{
					 //fetch_customer2();
					//strcpy(leg_cust.arr,strcat(loc_legend[730]," "));
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					strcpy(leg_cust.arr,strcat(leg_cust.arr,ar_cust.arr));
					if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-62.62s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					        fprintf(fp," %-62.62s",leg_cust.arr);
					}
					else
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-44.44s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
 						}
						else
					        fprintf(fp," %-44.44s",leg_cust.arr);
					}
					}
					else
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {		
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-49.49s",leg_cust.arr);
					}
					leg_cust.arr[0] = '\0';
					//fprintf(fp,"%-14s %-35s %-s"," ",loc_legend[730],d_customer.arr);
					//fprintf(fp,"\n%s",ar_cust.arr);
					fprintf(fp,"%15s %-20s",ar_amt[i],bill_code[i]);
					
				} 
			  }
			}
		}
		 fprintf(fp,"\n");lsr_line_cnt();
	  }

	  *************upto here**************/


	  /**********added by vani **********/
	 if (strcmp(p_oth_payers_amt_print_row_ind.arr,"R")==0)  //1111
		{
						
			declare_other_payer_amt_for_payer();

			open_other_payer_amt_for_payer();

		  while(fetch_other_payer_amt_for_payer())
			{
				
				if(strcmp(d_oth_cust_code.arr,"\0")!=0)
				  {
					fetch_cust_name(d_oth_cust_code.arr);				
					strcpy(leg_cust.arr,loc_legend[730]);
					strcat(leg_cust.arr," ");
					strcpy(leg_cust.arr,strcat(leg_cust.arr,d_oth_cust_desc.arr));

					d2_cust_code.arr[0]='\0';
					d2_cust_code.len=0;
					d2_cust_group_code.arr[0]='\0';
					d2_cust_group_code.len=0;
				

					strcpy(d2_cust_code.arr,d_oth_cust_code.arr);
			
					d2_cust_code.len = strlen(d2_cust_code.arr);
					d2_cust_code.arr[d2_cust_code.len] = '\0';
					l_tot_var_payable=0;
					d2_priority=d_oth_priority;

					//sprintf(st_var,"%s %d",d2_cust_code.arr,d2_priority);
				    //disp_message(ERR_MESG,d2_cust_code.arr);

						get_closed_packages();
					
					if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
					{
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
						 }
						 else
						   fprintf(fp," %-49.49s",leg_cust.arr);
					}
					else
					{
							if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 { 
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-41.41s",leg_cust.arr);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 							    fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																						
							}
							else
							   fprintf(fp," %-41.41s",leg_cust.arr);
					}
					}
					else
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {	
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-49.49s",leg_cust.arr);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
  					        fprintf(fp," %-51.51s",nd_desc_with_spl_chr.arr);
																																																					
						}
						else
					       fprintf(fp," %-51.51s",leg_cust.arr);
					}

					leg_cust.arr[0] = '\0';

					put_val(ar_amt[0],d_other_bill_amt+l_tot_var_payable+l_tot_var_tax); 
					nd_tot_oth_payer_amt=nd_tot_oth_payer_amt+d_other_bill_amt;
					format_amt(ar_amt[0]);
					fprintf(fp," %15s  %-20s\n",ar_amt[0],d_oth_doc_type_code.arr);
				}

			  }

			  close_other_payer_amt_for_payer();

			  lsr_line_cnt();

			  

		}

		/******upto here*********/

	   
		if (strcmp(p_oth_payers_amt_print_row_ind.arr,"S")==0)
		{
			
			get_sum_of_other_payer_amt();

		  if(nd_tot_oth_payer_amt!=0)
		  {
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s ",loc_legend[810]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-62.62s ",loc_legend[810]);
			}
			else
			{
 			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s ",loc_legend[810]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-44.44s ",nd_desc_with_spl_chr.arr);
					 																																														
				}
				else
			       fprintf(fp," %-44.44s ",loc_legend[810]);
			 }
			}
			else
			{
               if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s ",loc_legend[810]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-52.52s ",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-52.52s ",loc_legend[810]);
             }
			print_formated_amt(nd_tot_oth_payer_amt+d_pk_pack_tot_n_amount);
		    fprintf(fp,"\n");lsr_line_cnt();
		  }	

		}
		
		if (strcmp(p_patient_amt_print_row_ind.arr,"R")==0)
		{

		
		     l_cust_code.arr[0] ='\0';

		 //get_bill_num(2);

		 //if(pat_upd_net_charge_amt!=0) //always it has to print
		  //{
		    if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[760]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else   
				    fprintf(fp," %-61.61s",loc_legend[760]);
			}
			else
			{
             if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[760]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			   fprintf(fp," %-45.45s",loc_legend[760]);
			}
			}
			else
			{
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[760]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-52.52s",loc_legend[760]);
			}
// The below code added to get the correct amount of less payable by patient

d2_cust_code.arr[0]='\0';
d2_cust_code.len=0;
d2_cust_group_code.arr[0]='\0';
d2_cust_group_code.len=0;

	
get_closed_packages();


pat_upd_net_charge_amt=pat_upd_net_charge_amt+l_tot_pkg_payable ;

//upto here

			print_formated_amt(pat_upd_net_charge_amt);
			fprintf(fp,"%-s",l_bill_num.arr);

			fprintf(fp,"\n");lsr_line_cnt();
		  //}		
		}

				
		if (strcmp(p_addl_charge_amt_ind.arr,"R")==0||strcmp(p_addl_charge_amt_ind.arr,"B")==0)  //2nd place for Tax Row Level
		{
			
			strcpy(d2_cust_code.arr,d_cust_code.arr);
			d2_cust_code.len=strlen(d2_cust_code.arr);
			d2_cust_code.arr[d2_cust_code.len]='\0';
			d2_priority=d_priority;
		
			get_closed_packages();
			declare_tax_pkg();
		   open_tax_breakup_pkg();
		   fetch_tax_breakup_cur_pkg();
		   close_tax_break_cur_pkg();

		  //if(nd_total_addl_charge!=0)
		  if((nd_total_addl_charge+d_tax_amt_pkg)!=0)  //IN24100
		  {
			  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			  {
			  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp,"%-62.62s",loc_legend[1230]);
			   }
			  else
			  {
                 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-45.45s",loc_legend[1230]);
			   }
			  }
			  else
			  {
                  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp,"%-53.53s",loc_legend[1230]);
			   }
			//disp_message(ERR_MESG,"tax11");
			// sprintf(st_var,"[%f] [%f] [%f]",nd_total_addl_charge,d_tax_amt_pkg,l_tot_var_tax);
			 // disp_message(ERR_MESG,st_var);
			  print_formated_amt(nd_total_addl_charge+d_tax_amt_pkg+l_tot_var_tax);
			  fprintf(fp,"\n");lsr_line_cnt();
		  }
		}

		if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
		{
			
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
               if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			        fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-61.61s",loc_legend[740]);
			}
			else
			{
                 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			        fprintf(fp," %-45.45s",loc_legend[740]);
			 }
			}
			else
			{
                              
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				     fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			         fprintf(fp,"%-53.53s",loc_legend[740]);
             }
			

			  nd_net_payable= nd_net_payable+d_pk_pack_tot_n_amount;
			  print_formated_amt(nd_net_payable); 
			//print_formated_amt(nd_net_payable+d_pk_pack_tot_n_amount-PkgTotalDiscount);   //NET PAYABLE AS ROW

			fprintf(fp,"\n");lsr_line_cnt();
			get_rounded_amt(nd_net_payable);
				

									/*ADDED FOR SCRUM CRF-654*/
					if (d_tot_outst_amt!=0)
					{             
					if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
							if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
							   {
		     						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[993]);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 											fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
																																																								
									 }
											 else
										 {
										 fprintf(fp," %-61.61s",loc_legend[993]);
											 }	         
								}
							else
								{ 
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										   {
		          							nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[993]);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 											fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
														}
											  else
											{
										 fprintf(fp," %-45.45s",loc_legend[993]);
											}
										} 
					}
					else
					{
  
									 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
										   {
		          							nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[993]);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 											fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
														}
								else	    
														{
															 fprintf(fp,"%-53.53s",loc_legend[993]);
														}
					}

					print_formated_amt(d_tot_outst_amt);
									fprintf(fp,"\n");lsr_line_cnt();
					//get_rounded_amt(d_tot_outst_amt);
					}
					/*ADDED FOR SCRUM CRF-654*/

			if(nd_rounded_amt!=0)
			{
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
                    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1240]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp,"%-62.62s",loc_legend[1240]);
				}
				else
				{
                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			    	fprintf(fp,"%-45.45s",loc_legend[1240]);
				}
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1240]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp,"%-53.53s",loc_legend[1240]);
				}
				print_formated_amt(nd_rounded_amt);
				fprintf(fp,"\n");lsr_line_cnt();

				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
 				}
				else
				    fprintf(fp,"%-53.53s",loc_legend[1250]);
				print_formated_amt(nd_net_pay_amt_after_rounded);
				fprintf(fp,"\n");lsr_line_cnt();
			}
		
		   /*
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0)
			{
			 fprintf(fp,"%-53.53s",loc_legend[1150]);
			 print_formated_amt(d_bill_paid_amt);
			 fprintf(fp,"\n");lsr_line_cnt();
			}
		   */
		}
		
      	/***** added on 30/09/2008 for printing package deposit if it is there ********/ 
/*
		if(l_pkg_len!=0)
		{
		
			for(i=1;i<=l_pkg_len;i++)
			{
			  l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]);
			  if(l_pkg_dep_amt!=0)
			  {
			   l_pkg_dep_exist=1; 
			   break;
			  }
			}
		   if(l_pkg_dep_exist==1)
		   {
			   	
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1260]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp,"%-62.62s",loc_legend[1260]);
				}
				else
				{
                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1260]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp,"%-45.45s",loc_legend[1260]);
				}
				}
				else
				{
                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[1260]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
				    fprintf(fp,"%-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				   fprintf(fp,"%-52.52s",loc_legend[1260]);
				}
				fprintf(fp,"\n");lsr_line_cnt(); 
				for(i=1;i<=l_pkg_len;i++)
				{
					l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]);	//atoi function will convert string to double
					if(l_pkg_dep_amt!=0)	
					{
						if((l_no_of_clumns ==5) || strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
						{
						 if((strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)&&(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)) //for - crf-659
						 {
						     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							 {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-31.31s",loc_legend[1290]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
							    fprintf(fp,"       %-31.31s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);																																																						
							}
							else   
							  fprintf(fp,"       %-31.31s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
							 }
						 else
						 {
                         if(strcmp(nd_pad_req_yn.arr,"Y")==0)
						 {
							nd_temp_str.arr[0]='\0';
							nd_temp_str.len=0;
							sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
							fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 						    fprintf(fp,"       %-21.21s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																					
						}
						else
						    fprintf(fp,"       %-21.21s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
						 }
						}
						 print_formated_amt(l_pkg_dep_amt);
						 fprintf(fp,"\n"); //lsr_line_cnt(); 
					}
				}
			   
			}
		  }
*/
		
		
      /****** Printing the Bill Adjustments Amts as Saparate Row******/

        /*COMMENETED FOR SCRUM CRF-654
       if(strcmp(p_all_oth_adj_amt_row_ind.arr,"R")==0)  
	   {
         if ((d1_tot_adjust_amt!=0)||(strcmp(p_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
		 {
		  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		  {
		  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
		  {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[780]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
			}
			else  
			 fprintf(fp," %-61.61s",loc_legend[780]);
		   }
		  else
		  {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[780]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
			}
			else  
		     fprintf(fp," %-45.45s",loc_legend[780]);
		  }
		  }
		  else
		  {
		     if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
                fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
			}
			else  
    		     fprintf(fp," %-52.52s",loc_legend[780]);
		   }
          print_formated_amt(d1_tot_adjust_amt);
		  fprintf(fp,"\n");lsr_line_cnt();
		 }

   		  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
		  {
		  
			if((nd_tot_disc_amount)!=0)
			{
			
			  if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			  {
			  
			  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			  
			      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
 					}
					else
			           fprintf(fp," %-62.62s",loc_legend[790]);
			   }
			  else
			  {
			      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
                         fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
 					}
					else 
				         fprintf(fp," %-44.44s",loc_legend[790]);
			   }
			  }
			  else
			  {
                  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[790]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			         fprintf(fp," %-49.49s",loc_legend[790]);
			   }
			  print_formated_amt(nd_tot_disc_amount);
			  fprintf(fp,"\n");lsr_line_cnt();
			}
		  }

		  if(d1_bill_tot_exmpt_amt!=0)
		  {
		   if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		   {
		   if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
		   {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
 				}
				else
		            fprintf(fp," %-62.62s",loc_legend[720]);
		   }
		   else
		   {
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[720]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
 			}
			else
		         fprintf(fp," %-45.45s",loc_legend[720]);
		   }
		   }
		   else
		   {
             if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[720]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
		       fprintf(fp," %-49.49s",loc_legend[720]);
			}
           print_formated_amt(d1_bill_tot_exmpt_amt);
		   fprintf(fp,"\n");lsr_line_cnt();
		  }

		  if(d1_tot_write_off_amt!=0)
		  {
		   if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
		   {
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
		      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
 				}
				else
			       fprintf(fp," %-62.62s",loc_legend[800]);
			 }
		   else
		   {
           if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[800]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				 fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
 																																																		
			}
			else
		        fprintf(fp," %-45.45s",loc_legend[800]);
		   }
		   }
		   else
		   {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
 				}
				else
		          fprintf(fp," %-49.49s",loc_legend[800]);
		   }
		   print_formated_amt(d1_tot_write_off_amt);
		   fprintf(fp,"\n");lsr_line_cnt();
		  }
       }
	   COMMENTED FOR SCRUM CRF-654*/

	/****** Printing the Bill Adjustments Amts as Summarized Row******/
		

       //if (strcmp(p_all_oth_adj_amt_row_ind.arr,"S")==0)  COMMENTED FOR SCRUM CRF-654
	   //{  COMMENTED FOR SCRUM CRF-654
	      /*COMMENTED FOR SCRUM CRF-654
		  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
		  {
			   if(d1_tot_adjust_amt!=0 || nd_tot_disc_amount!=0 || d1_bill_tot_exmpt_amt!=0 || d1_tot_write_off_amt!=0)
			   {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
                  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-26.26s",nd_prt_line_desc.arr);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
				
																																																			
				}
				else
				    fprintf(fp," %-62.62s",loc_legend[850]);
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[850]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				    fprintf(fp," %-45.45s",loc_legend[850]);
				}
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
 					}
					else
				       fprintf(fp," %-49.49s",loc_legend[850]);
				  }
				print_formated_amt(d1_tot_adjust_amt+nd_tot_disc_amount+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			   }
		  }
		   COMMENTED FOR SCRUM CRF-654*/
		  /**** Discount Not printing when program is calling from No-Discount Funstions ****/
		        /*COMMENTED FOR SCRUM CRF-654
		  else
		  {
			   if(d1_tot_adjust_amt!=0 ||d1_bill_tot_exmpt_amt!=0 || d1_tot_write_off_amt!=0)
			   {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-63.63s",loc_legend[850]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-63.63s",nd_desc_with_spl_chr.arr);
 				}
				else
				   fprintf(fp," %-63.63s",loc_legend[850]);
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					     fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
 					}
					else
				      fprintf(fp," %-45.45s",loc_legend[850]);
				   }
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				       fprintf(fp," %-49.49s",loc_legend[850]);
				}
				print_formated_amt(d1_tot_adjust_amt+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			   }
		  }
		     COMMENTED FOR SCRUM CRF-654*/
		   /*
		   if (strcmp(p_bill_adj_sep_row_yn.arr,"Y")==0 || strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0||
			   strcmp(p_bill_exm_sep_row_yn.arr,"Y")==0 || strcmp(p_bill_wo_sep_row_yn.arr,"Y")==0 )
		   {
			   fprintf(fp," %-49.49s",loc_legend[850]);
			   if (strcmp(p_bill_adj_sep_row_yn.arr,"Y")==0)
			   {
			    if(d1_tot_adjust_amt!=0)
				nd1_tot_adjust_amt=nd1_tot_adjust_amt+d1_tot_adjust_amt;
			   }
			   
			   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			   if (strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0)
			   {
			    if(nd_tot_disc_amount!=0)
				nd1_tot_adjust_amt=nd1_tot_adjust_amt+nd_tot_disc_amount;
			   }
			   if (strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0)
			   {
			     if(d1_bill_tot_exmpt_amt!=0)
				 nd1_tot_adjust_amt=nd1_tot_adjust_amt+d1_bill_tot_exmpt_amt;
			   }
			   if (strcmp(p_bill_wo_sep_row_yn.arr,"Y")==0)
			   {
			     if(d1_tot_write_off_amt!=0)
				 nd1_tot_adjust_amt=nd1_tot_adjust_amt+d1_tot_write_off_amt;
			   }
			   fprintf(fp,"\n");lsr_line_cnt();
		
          
		   }
		   */
		  
	/* COMMENTED FOR SCRUM CRF-654
		   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
		   if (strcmp(p_bill_disc_sep_row_yn.arr,"Y")==0)
			{
			  if((nd_tot_disc_amount)!=0)
			  { 
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[790]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
 				}
				else
				fprintf(fp," %-62.62s",loc_legend[790]);
				}
				else
				{
                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[790]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
 				}
				else
				fprintf(fp," %-45.45s",loc_legend[790]);
				}
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 					    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																				
					}
					else
				  fprintf(fp," %-49.49s",loc_legend[790]);
				 }
				print_formated_amt(nd_tot_disc_amount);
				fprintf(fp,"\n");lsr_line_cnt();
			   }
			}

			if (strcmp(p_bill_adj_sep_row_yn.arr,"Y")==0)
			{
			  if((d1_tot_adjust_amt!=0)|| (strcmp(p_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
			  {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
                 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-61.61s",loc_legend[780]);
				}
				else
				{
                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-45.45s",loc_legend[780]);
				}

				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 				    fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-52.52s",loc_legend[780]);
				}
				print_formated_amt(d1_tot_adjust_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			  }	
			  
			}


			if (strcmp(p_bill_exm_sep_row_yn.arr,"Y")==0)
			{
			  if(d1_bill_tot_exmpt_amt!=0)
			  {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				        fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);	
																																																				
					}
					else
				  fprintf(fp," %-62.62s",loc_legend[720]);
				  }
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-45.45s",loc_legend[720]);
				}

				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-49.49s",loc_legend[720]);
				}

				print_formated_amt(d1_bill_tot_exmpt_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			  }
			}

			if (strcmp(p_bill_wo_sep_row_yn.arr,"Y")==0)
			{
			  if(d1_tot_write_off_amt!=0)
			  {
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-62.62s",loc_legend[800]);
				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-45.45s",loc_legend[800]);
				}

				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-49.49s",loc_legend[800]);
				}
				print_formated_amt(d1_tot_write_off_amt);
				fprintf(fp,"\n");lsr_line_cnt();
              }
			}
         }
	 	COMMENTED FOR SCRUM CRF-654*/	
		
		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS2")==0|| strcmp(nd_calling_pgm_id.arr,"BLRIPDS3")==0|| strcmp(nd_calling_pgm_id.arr,"BLRUCDS3")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0 || 
		strcmp(l_no_settlement_details.arr,"R")==0 || strcmp(l_no_settlement_details.arr,"N")==0)
		{
			/***** Printing Deposit Amt as Row ****
			if(d_deposit_adj_amt!=0)
			{
				if(strcmp(d_cust_code.arr,"\0")==0) //added for scrum crf-654
				{
				if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[992]); // CHANGED FOR SCRUM 880-->992 REMERGING
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-62.62s",loc_legend[992]); // CHANGED FOR SCRUM 880-->992 REMERGING
				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[992]); // CHANGED FOR SCRUM 880-->992 REMERGING
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-45.45s",loc_legend[992]); // CHANGED FOR SCRUM 880-->992 REMERGING
				}

				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[992]); // CHANGED FOR SCRUM 880-->992 REMERGING
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				fprintf(fp," %-49.49s",loc_legend[992]); // CHANGED FOR SCRUM 880-->992 REMERGING
				}
				print_formated_amt(d_deposit_adj_amt);
				fprintf(fp,"\n");lsr_line_cnt();
			} //added for scrum crf-654
			} */


			/***** Printing Bill Paid Amt as Row *****/
			if(d_bill_paid_amt!=0)
			{
				 if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				 {
				 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				 {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1150]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				 fprintf(fp," %-62.62s",loc_legend[1150]);
				 }
				 else
				 {
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1150]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				 fprintf(fp," %-45.45s",loc_legend[1150]);
				 }
				 }
				 else
				 {
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-49.49s",loc_legend[1150]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-49.49s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
				 fprintf(fp," %-49.49s",loc_legend[1150]);
				 }
				 print_formated_amt(d_bill_paid_amt);
				 fprintf(fp,"\n");lsr_line_cnt();
			}
		
			/***** Printing Outstanding Amt as Row *****/
			
			//if(d_bill_tot_outst_amt!=0)
		//	{
				
        //if(strcmp(d_cust_code.arr,"\0")==0) //added for scrum CRF-654 remerging
			    //{				//added for scrum CRF-654 remerging
				if((strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)) //for - crf-659

				{
				if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if (strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[890]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					    fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																				
					}
					else
                  		fprintf(fp," %-61.61s",loc_legend[890],nd_curr_date_t.arr);
				}
				else
				{
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[890]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																			
				}
				else
				fprintf(fp," %-45.45s",loc_legend[890],nd_curr_date_t.arr);
				}
				}
				else
				{
                 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-35.35s",loc_legend[890]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp," %-35.35s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																			
				}
				else
				fprintf(fp," %-35.35s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
			    }

				d_bill_tot_outst_amt = d_bill_tot_outst_amt+ d_pk_variance_amt;
				print_formated_amt(d_bill_tot_outst_amt);
				fprintf(fp,"\n");lsr_line_cnt();
				                  //           } //ADDED FOR SCRUM CRF-654 remerging
		//	}
			
		}
	  
	  
	  if(nd_net_pay_amt_after_rounded!=0)
	  {

			if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
				amount=nd_net_pay_amt_after_rounded;
			else
			amount=nd_net_pay_amt_after_rounded+ d_pk_pack_tot_n_amount;

	   print_amt_in_words();
	  }
	  else
      {
			if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
				amount=nd_net_payable;
			else
			amount=nd_net_payable+ d_pk_pack_tot_n_amount;

	   print_amt_in_words();
	  }	
	   /***** Upto here *****/
	
	}
	else
	{
       		if(p_disc_amt_in_dtl_yn.arr[0]=='N' && p_servdate_in_dtlformat_yn.arr[0]=='Y') //for - crf-659)
			{
			 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			 {
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			    fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else	
			 fprintf(fp,"%-62.62s",loc_legend[680]);
			 }
			 else
			 {
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			    fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			 fprintf(fp,"%-44.44s",loc_legend[680]);
			 }
			 print_formated_amt(nd_tot_serv_tot_disc);
			}
			else
			if (p_disc_amt_in_dtl_yn.arr[0]=='N' && p_servdate_in_dtlformat_yn.arr[0]=='N') 
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				    fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
        			 fprintf(fp,"%-53.53s",loc_legend[680]);
			 print_formated_amt(nd_tot_serv_tot_disc);
			 amount=nd_tot_serv_tot_disc;
			 print_amt_in_words();
			}
			else
			{
			 fprintf(fp,"%-42.42s"," ");
			 print_formated_amt(nd_tot_serv_charge_discount);
			 print_formated_amt(nd_tot_serv_bill_discount);
			 print_formated_amt(nd_tot_serv_fund_adjustment);
			 fprintf(fp,"\n");lsr_line_cnt();

			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
			    fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			 fprintf(fp,"%-42.42s",loc_legend[680]);
			 print_formated_amt(nd_tot_serv_charge_discount+nd_tot_serv_bill_discount+nd_tot_serv_fund_adjustment);
			 amount=nd_tot_serv_charge_discount+nd_tot_serv_bill_discount+nd_tot_serv_fund_adjustment;
			 print_amt_in_words();

			}

	}
	    //print_footer(); //commented as per the Kuila sir instruction
		//close_grp_hdr_cur();
				
	    declare_payer_approval();  //Rajesh	
		open_payer_approval();     //Rajesh		
	    print_sign_designation();
		close_payer_approval();

		close_grp_hdr_cur(); //Rajesh

         /**** Below code added by raghava on 15/10/2009 for CRF-518(siriraj) *****/
		 //print_alter_id_num('C'); //COMMENTED FOR SCRUM REMERGING ALTER ID NOT REQ.
		/*****  CRF-518(siriraj) *****/	
		if (strcmp(nd_bill_format_id.arr,"1")==0)
		if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
		{
          	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					 {
			
						fun_Pad_desc_with_spl_char(loc_legend[1425]);
                        fprintf(fp,"\n%-64.64s %-s  %-s"," ",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);																																	

						fun_Pad_desc_with_spl_char(loc_legend[1424]);
                        fprintf(fp," %-s\n",nd_desc_with_spl_chr.arr);																																	
					}
					else
           		        fprintf(fp,"\n%-64.64s %-s  %-s %-s\n"," ",loc_legend[1425],nd_curr_date_t.arr,loc_legend[1424]);
		}
		if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0) //IN13383	
		print_footer1();
		


}

print_package_dtls()   
{


PkgTotalDiscount          = 0;
d_pk_variance_amt=0;
d_pk_pack_tot_n_amount=0;
d_pk_pack_tot_g_amount=0;

	for(i=1;i<=l_pkg_len;i++)
	{
	
		strcpy(l_pkg_seq_num.arr,p_pkg_seq_num[i]);
	
		l_pkg_seq_num.len = strlen(p_pkg_seq_num[i]);
		l_pkg_seq_num.arr[l_pkg_seq_num.len] = '\0';
		get_pkg_name();
		get_package_discount();
		if(strcmp(nd_pad_req_yn.arr,"Y")==0)
		 {
			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%-30.30s",nd_package_desc.arr);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 		    fprintf(fp," %-30.30s",nd_desc_with_spl_chr.arr);
	
			nd_temp_str.arr[0]='\0';
			nd_temp_str.len=0;
			sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
			fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 		    fprintf(fp,"  (%-21.21s : %s)",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);																																																
		}
		else
		   fprintf(fp," %-30.30s  (%-21.21s : %s)",nd_package_desc.arr,loc_legend[1290],p_pkg_seq_num[i]);
	
		l_pkg_amt=atof(p_pkg_amt[i]);	//atoi function will convert string to double
		print_formated_amt(l_pkg_amt);

	 /* The below code added by Rajesh to print package deposit amt along with package amt */
		l_pkg_dep_amt=atof(p_pkg_dep_amt[i]);
		print_formated_amt(l_pkg_dep_amt);
		
		l_pk_variance_amt=atof(p_pkg_variance_amt[i]);
		d_pk_variance_amt=d_pk_variance_amt+l_pk_variance_amt;

		d_pk_pack_tot_g_amount = d_pk_pack_tot_g_amount + l_pkg_amt;  //Rajesh
		d_pk_pack_tot_n_amount = d_pk_pack_tot_n_amount + l_pkg_dep_amt; //Rajesh

	 /* upto here */
	  // Rajesh The below code added to print package services
	  //commneted by senthil as this is not required now 386
	/*	open_package_service_qty();
		
		
		nd_prt_grp_hdr_code_old.arr[0]		= '\0';
		nd_prt_grp_hdr_code_old.len		= 0;
		nd_prt_grp_hdr_code_old.arr[nd_prt_grp_hdr_code_old.len] = '\0';	
		
		while(fetch_package_service_qty())
		{
		
		if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
				  {
		  			 ccnt = ccnt + 1;
					 ccnt1 = ccnt1 + 1;		
					 print_pkg_grp_hdr();
				  }	
		}  

				close_package_service_qty();
				*/


		fprintf(fp,"\n");lsr_line_cnt();
		
	
	}

	if(l_next_page=3)
	{
		//fprintf(fp,"\n");lsr_line_cnt();
		get_aviled_outside_pkg();
		if (l_aviled_outside_pkg!=0 )
		{
          if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-50.50s",loc_legend[1270]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-50.50s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			{
					 prt_line_uc();
				  	 fprintf(fp,"\n");
				 //Line added by rajesh
	 	             fprintf(fp," %-50.50s",loc_legend[1270]);
			}
		fprintf(fp,"\n");lsr_line_cnt(); //added by rajesh ICN-389
		}
	
	//	fprintf(fp,"\n");lsr_line_cnt(); Commented by Rajesh ICN-389
	}
	else
	{
		fprintf(fp,"\n");lsr_line_cnt();
		// prt_line_uc(); //Rajesh for remove line in package details
		fprintf(fp,"\n"); lsr_line_cnt();
		get_aviled_outside_pkg();
		if (l_aviled_outside_pkg!=0 )
		{
		   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-50.50s",loc_legend[1270]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 			    fprintf(fp," %-50.50s",nd_desc_with_spl_chr.arr);
																																																		
			}
			else
			{		//Line added by rajesh
						prt_line_uc();
			  			fprintf(fp,"\n");
					//upto here	 
	 	            fprintf(fp," %-50.50s",loc_legend[1270]);
            }
		}
		fprintf(fp,"\n");lsr_line_cnt();
		prt_line_uc();
		fprintf(fp,"\n"); lsr_line_cnt();
	}

}


fun_print_end_of_report()
{
  	
	if(end_of_report)
	 {
								 
		 p_tot_pat_gross_amt=p_tot_pat_gross_amt+nd_pat_gross_amt;  //total  gross
		 p_tot_pat_net_amt=p_tot_pat_net_amt+nd_pat_net_amt1;       //total  net
		 p_tot_pat_disc_amt=p_tot_pat_disc_amt+nd_pat_disc_amt;     //total  discount
		
		//strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
		//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

		/***addded for walkthrough merging***/
			if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
				{
					strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
					strcpy(d_line_code,nd1_prt_grp_line_code.arr);
				}
				if(strcmp(d1_grp_ind.arr,"EMG")==0)
				{
					strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
				if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
				{
					strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
					strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
				}
				if(strcmp(d1_grp_ind.arr,"PMG")==0)
				{									
					 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
			/***upto here***/


		get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);
	      
		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) )									    					
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)  
		  {
		   get_addlcharge_count();
		   if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
		   print_formated_amt2(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt);
		  }
		  //print_formated_amt2(d1_addl_charge_amt_in_charge);
		 }
		  
		 //strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
		//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

		/***addded for walkthrough***/
			if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
				{
					strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
					strcpy(d_line_code,nd1_prt_grp_line_code.arr);
				}
				if(strcmp(d1_grp_ind.arr,"EMG")==0)
				{
					strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
				if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
				{
					strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
					strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
				}
				if(strcmp(d1_grp_ind.arr,"PMG")==0)
				{									
					 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
			
			/***upto here***/

		get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
		  {
		  
		  print_formated_amt(nd_pat_gross_amt-nd_inside_pkg_gross_amt);
		  }
		 }								 
		  
		  //strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
		//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

		/***addded for walkthrough***/
			if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
				{
					strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
					strcpy(d_line_code,nd1_prt_grp_line_code.arr);
				}
				if(strcmp(d1_grp_ind.arr,"EMG")==0)
				{
					strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
				if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
				{
					strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
					strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
				}
				if(strcmp(d1_grp_ind.arr,"PMG")==0)
				{									
					 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
			
			/***upto here***/

		get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
		  print_formated_amt(nd_pat_net_amt1-nd_inside_pkg_net_amt);
		 }				
		 //if(nd_pat_net_amt1>=0)
		 //nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;
		 //else
		 nd_subdiv_amt=nd_pat_net_amt1-nd_pat_net_charge_amt;

		  //strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
		//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

		/***added for walkthrough ***/
			if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
				{
					strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
					strcpy(d_line_code,nd1_prt_grp_line_code.arr);
				}
				if(strcmp(d1_grp_ind.arr,"EMG")==0)
				{
					strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
				if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
				{
					strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
					strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
				}
				if(strcmp(d1_grp_ind.arr,"PMG")==0)
				{									
					 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
			/**upto here***/

		get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) )
		 {
			 if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0 && strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			 {
			 get_discount_count();
			   if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
			   {
			  if (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
			  print_formated_amt(nd_pat_disc_amt-nd_inside_pkg_disc_amt);
			  }
			 }

			 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
			 {
			  if(c_disc_amt_in_dtl_yn.arr[0]=='N')
			  {
			   if (strcmp(c_servdate_in_dtlformat_yn.arr,"N")==0)
			   fprintf(fp,"%-18.18s"," ");
			   if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			   fprintf(fp,"%-9.9s"," ");
			   print_formated_amt(nd1_serv_tot_disc);
			   
			  }
			  else
			  {
			    print_formated_amt(nd1_serv_charge_discount);
				print_formated_amt(nd1_serv_bill_discount);
				print_formated_amt(nd1_serv_fund_adjustment);
			  }

			 }
		 
		 }

		//strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
		//strcpy(d_line_code,nd1_prt_grp_line_code.arr);

		/***added for walkthrouth***/
		if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
				{
					strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
					strcpy(d_line_code,nd1_prt_grp_line_code.arr);
				}
				if(strcmp(d1_grp_ind.arr,"EMG")==0)
				{
					strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
				if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
				{
					strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
					strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
				}
				if(strcmp(d1_grp_ind.arr,"PMG")==0)
				{									
					 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
		/**upto here***/

		get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if((strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0) && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
		  {
		 
			print_formated_amt((nd_pat_net_charge_amt-nd_inside_pkg_net_amt)-(nd_pat_addl_charge_amt-nd_inside_pkg_addchrg_amt));
		  }
		  else
		  {
		   if (strcmp(c_bill_net_payable_ind.arr,"C")==0 || strcmp(c_bill_net_payable_ind.arr,"B")==0)
		   {
		   print_formated_amt(nd_pat_net_charge_amt-nd_inside_pkg_net_amt);
		   }
		  }
		 }			
		
		 nd_tot_subdiv_amt=nd_tot_subdiv_amt+nd_subdiv_amt; //total Subsidized Amt

		  //strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
		  //strcpy(d_line_code,nd1_prt_grp_line_code.arr);

		  /***added for walkthrouth***/
		if( (strcmp(d1_grp_ind.arr,"ESG")==0)||(strcmp(d1_grp_ind.arr,"ESL")==0))
				{
					strcpy(d_grp_code,nd1_prt_grp_hdr_code.arr);
					strcpy(d_line_code,nd1_prt_grp_line_code.arr);
				}
				if(strcmp(d1_grp_ind.arr,"EMG")==0)
				{
					strcpy(d_grp_code,nd1_ent_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
				if((strcmp(d1_grp_ind.arr,"PSG")==0)||(strcmp(d1_grp_ind.arr,"PSL")==0))
				{
					strcpy(d_grp_code,nd1_payer_serv_grp_hdr.arr);
					strcpy(d_line_code,nd1_payer_serv_grp_line.arr);
				}
				if(strcmp(d1_grp_ind.arr,"PMG")==0)
				{									
					 strcpy(d_grp_code,nd1_payer_item_grp_code.arr);
					//strcpy(d_line_code,d1_prt_grp_line_code.arr);
				}
		/**upto here***/

		get_grp_pkg_outside_cnt('G',d_grp_code,d_line_code);

		 if( nd1_package_trx_yn.arr[0] == 'N' || (nd1_package_trx_yn.arr[0] == 'Y' && l_grp_pkg_inside_cnt!=0) )
		 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
		 {
		  if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)
		  {
			get_subsidized_amt();
			if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
			print_formated_amt(nd_subdiv_amt);
		  }
		 }										                    
	 }

		//if(end_of_report)
		fprintf(fp,"\n");lsr_line_cnt();
				
		if(lcol_cnt == 1)
		prt_line_uc();
		if( lcol_cnt == 2)
		prt_line_uc_wide();
		if( lcol_cnt == 3)
		prt_line_uc_wide1();
		if( lcol_cnt == 5 || lcol_cnt == 6)
		prt_line_uc_wide2();

		//prt_line_uc();
		fprintf(fp,"\n");lsr_line_cnt();
		/*if(l_no_of_clumns ==5)
		fprintf(fp,"%-53.53s",loc_legend[680]);
		else
		if(l_no_of_clumns ==6)
		fprintf(fp,"%-56.56s",loc_legend[680]);
		else
		fprintf(fp,"%-42.42s",loc_legend[680]);*/
	
   if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
   {

	   get_cnt_remain_space(1);
	/* Here l_lcnt+5 Meaning 'l_lcnt' for how many line for footer part and '5' for Signature*/ 	

		if((l_lcnt+5)<=max_lines-v_lno)  //added by vani 
		{
		  if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		  {
		  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
		  {
		   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
			
																																																		
			}
		  else
		  fprintf(fp,"%-61.61s",loc_legend[680]);
		 
		  }
		  else
		  {
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
			
																																																		
			}
		  else
		   fprintf(fp,"%-45.45s",loc_legend[680]);
		  }
		  }
		  else
		  {
			if(l_no_of_clumns ==5)
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
			
																																																		
			}
		     else
			 fprintf(fp,"%-53.53s",loc_legend[680]);
			}
			else
			if(l_no_of_clumns ==6)
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
			
																																																		
			}
		     else
			 fprintf(fp,"%-56.56s",loc_legend[680]);
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
			
																																																		
			}
		     else
			 fprintf(fp,"%-42.42s",loc_legend[680]);
			}
		 } 
		}
		else
		{
			
			while(v_lno<=max_lines)
			  {
				fprintf(fp,"\n");
				v_lno++;
			  }
			  lsr_line_cnt();
			
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
			
																																																		
			}
		     else
			 fprintf(fp,"%-61.61s",loc_legend[680]);
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			 {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
			
																																																		
			}
		     else
			 fprintf(fp,"%-45.45s",loc_legend[680]);
			}
			}
			else
			{
				if(l_no_of_clumns ==5)
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			    {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[680]);;
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																					
				}
				 else
				 fprintf(fp,"%-53.53s",loc_legend[680]);
				}
				else
				if(l_no_of_clumns ==6)
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			    {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																					
				}
				 else
				 fprintf(fp,"%-56.56s",loc_legend[680]);
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			    {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																					
				}
				 else
				 fprintf(fp,"%-42.42s",loc_legend[680]);
				}
			}
		}
		

		if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
		{
		
		get_pat_inside_pkg_disc();
		p_tot_pat_gross_amt = p_tot_pat_gross_amt+d_pk_pack_tot_g_amount; //aded Rajesh d_pk_pack_tot_g_amount cash bill
		print_formated_amt(p_tot_pat_gross_amt); //-l_pat_inside_pkg_disc);
		}
		if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
		{
			p_tot_pat_net_amt = p_tot_pat_net_amt+d_pk_pack_tot_n_amount;
			print_formated_amt(p_tot_pat_net_amt);
		}
		fprintf(fp,"\n"); //lsr_line_cnt();
	//The below code added by Rajesh IN22838
	/*	
		if (PkgTotalDiscount > 0)
		{
		 fprintf(fp," %-41s",loc_legend[710]);
		print_formated_amt(nd_tot_disc_amount+PkgTotalDiscount);
		fprintf(fp,"\n");//lsr_line_cnt();
		}
		*/
		//upto here
	    /*
		if(strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 && strcmp(c_bill_net_payable_ind.arr,"R")!=0 )
	    fprintf(fp,"%18.18s"," ");
	    if(strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 && strcmp(c_bill_net_payable_ind.arr,"R")==0 )
	    fprintf(fp,"%18.18s"," ");
		 Commented on 25/3/2008 for proper printing */

	   //if(strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_bill_net_payable_ind.arr,"R")==0 )
       //fprintf(fp,"%18.18s"," ");
   
		if( strcmp(c_bill_subsidized_amt_ind.arr,"R")==0)
		{

		 if((nd_tot_subdiv_amt+d_pk_pack_tot_g_amount-d_pk_pack_tot_n_amount)!=0)
		 {
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-61.61s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-61.61s ",nd_desc_with_spl_chr.arr);
																																																					
			 }
			else
			 fprintf(fp,"\n%-61.61s ",loc_legend[750]);
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-45.45s ",nd_desc_with_spl_chr.arr);
																																																					
			 }
			else
			 fprintf(fp,"\n%-45.45s ",loc_legend[750]);
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-52.52s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
																																																		
			 }
			 else
			  fprintf(fp,"\n%-52.52s ",loc_legend[750]);
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-55.55s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-55.55s ",nd_desc_with_spl_chr.arr);
		
																																																					
			 }
			 else
			  fprintf(fp,"\n%-55.55s ",loc_legend[750]);
			 }
			 else
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41.41s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-41.41s ",nd_desc_with_spl_chr.arr);
																																																					
			 }
			 else
			  fprintf(fp,"\n%-41.41s ",loc_legend[750]);
			 }
			}
			 print_formated_amt(nd_tot_subdiv_amt+d_pk_pack_tot_g_amount-d_pk_pack_tot_n_amount);
			fprintf(fp,"\n"); //lsr_line_cnt();
		 }
		}
		if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0)
		{
		 if(nd_tot_subdiv_amt!=0)
		 {
			
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-61.61s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-61.61s ",nd_desc_with_spl_chr.arr);
																																																						
			 }
			 else
			 fprintf(fp,"\n%-61.61s ",loc_legend[750]);
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-45.45s ",nd_desc_with_spl_chr.arr);
																																																					
			 }
			 else
			 fprintf(fp,"\n%-45.45s ",loc_legend[750]);
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-52.52s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-52.52s ",nd_desc_with_spl_chr.arr);
																																																			
			 }
			 else
			  fprintf(fp,"\n%-52.52s ",loc_legend[750]);
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-55.55s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-55.55s ",nd_desc_with_spl_chr.arr);
																																																					
			 }
			 else
			  fprintf(fp,"\n%-55.55s ",loc_legend[750]);
			 }
			 else
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41.41s ",loc_legend[750]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"\n%-41.41s ",nd_desc_with_spl_chr.arr);
		
																																																					
			 }
			 else
			  fprintf(fp,"\n%-41.41s ",loc_legend[750]);
			 }
			 print_formated_amt(nd_tot_subdiv_amt);
			 fprintf(fp,"\n"); //lsr_line_cnt();
		   }
		 }
		}
	
	    // To print total package discout in a row
		print_package_discount();


		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
		{
		
		 if (strcmp(c_serv_disc_on_gross_ind.arr,"R")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
		 {
		 
		   if((p_tot_pat_disc_amt)!=0)
		   {	
			
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
			  
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[710]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
						
																																																					
			 }
			 else
			 fprintf(fp," %-61.61s",loc_legend[710]);
			 }
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[710]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
										
																																																					
			 }
			 else
			 {
			 
			 fprintf(fp," %-45.45s",loc_legend[710]);
			 }
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
		     {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[710]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
													
																																																					
			 }
			 else
			  fprintf(fp," %-52.52s",loc_legend[710]);
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[710]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																							
			 }
			 else
			  fprintf(fp," %-55.55s",loc_legend[710]);
			 }
			 else
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[710]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																											
			 }
			 else
			  fprintf(fp," %-41.41s",loc_legend[710]);
			 }
			}
			
			 print_formated_amt(p_tot_pat_disc_amt);
			 fprintf(fp,"\n"); //lsr_line_cnt();

		   }
		 }
		}
		
  		
			/**********************************************/

			/***** Printing Additional Charge Amt as Row *****/
			if(strcmp(c_addl_charge_amt_ind.arr,"R")==0)
			{			
			  if(nd_pat_tot_addl_charge_amt!=0)
			  {
				  if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				  {
				  if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				  {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
					
																																																												
				   }
				   else
				   fprintf(fp,"%-61.61s",loc_legend[1230]);
				  }
				  else
				  {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
		
																																																												
				   }
				   else
				   fprintf(fp,"%-45.45s",loc_legend[1230]);
				  }
				  }
				  else
				  { 
				  if(l_no_of_clumns ==5)
				  {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
					
																																																												
				   }
				   else
				   fprintf(fp,"%-53.53s",loc_legend[1230]);
				  }
				  else
				  {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																												
				   }
				   else
				   fprintf(fp,"%-42.42s",loc_legend[1230]);
				  }
				  }

				  print_formated_amt(nd_pat_tot_addl_charge_amt);
				  fprintf(fp,"\n"); //lsr_line_cnt();lsr_line_cnt();
				 
			  }
			
		    }
			
			if( strcmp(c_bill_net_payable_ind.arr,"B")==0 || strcmp(c_bill_net_payable_ind.arr,"R")==0)
			{
				
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
																																																																
				   }
				   else
				 fprintf(fp,"%-61.61s",loc_legend[740]);
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																																					
				   }
				   else
				 fprintf(fp,"%-45.45s",loc_legend[740]);
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
			     {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																																																																										
				   }
				   else
				  fprintf(fp,"%-53.53s",loc_legend[740]);
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																																															
				   }
				   else
				  fprintf(fp,"%-56.56s",loc_legend[740]);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[740]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																																																	
				   }
				   else
				  fprintf(fp,"%-42.42s",loc_legend[740]);
				 }
				}
				nd_tot_pat_net_charge_amt = nd_tot_pat_net_charge_amt + d_pk_pack_tot_n_amount; //RAJESH
				print_formated_amt(nd_tot_pat_net_charge_amt);
				fprintf(fp,"\n");lsr_line_cnt();
		

				get_rounded_amt(nd_tot_pat_net_charge_amt);



		/****printing Patient deposit Details added on 26/07/2010****/
				
				declare_patient_deposit();

				open_patient_deposit();

				rec_count=1;
				while(fetch_patient_deposit())
				{
					if(d_patient_deposidt_amt!=0)
					 {
						if(strcmp(d_cust_code.arr,"\0")==0) 
						{ 
						
							
							if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
							{
							if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
							{
							  if(rec_count==1)
							  {
								  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										sprintf(nd_temp_str.arr,"%-47.47s",loc_legend[1463]); 
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 										fprintf(fp,"%-47.47s",nd_desc_with_spl_chr.arr);
																																																								
									}
									else
										fprintf(fp,"%-47.47s",loc_legend[1463]); 
							  } 
							  else
								fprintf(fp,"%-47.47s"," "); 
							}
							else
							{
								if(rec_count==1)
								{
									if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										 sprintf(nd_temp_str.arr,"%-29.29s",loc_legend[1463]);
										fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
 										fprintf(fp,"%-29.29s",nd_desc_with_spl_chr.arr);
																																																								
									}
									else
											fprintf(fp,"%-29.29s",loc_legend[1463]);  
							   }
							   else
								 fprintf(fp,"%-29.29s"," "); 
							 }
							}
							else
							{
							  if(rec_count==1)
							  {
								  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
									 {
										nd_temp_str.arr[0]='\0';
										nd_temp_str.len=0;
										 sprintf(nd_temp_str.arr,"%-27.27s",loc_legend[1463]); 
										fun_Pad_desc_with_spl_char(nd_temp_str.arr);
 										fprintf(fp,"%-27.27s",nd_desc_with_spl_chr.arr);
 									}
									else  
				      					   fprintf(fp,"%-27.27s",loc_legend[1463]); 
							  }
							  else
								fprintf(fp,"%-27.27s"," "); 
							}

							rec_count=rec_count+1;	
							fprintf(fp,"%-15.15s",d_patient_deposit_num.arr);
							print_formated_amt(d_patient_deposidt_amt);
							d_bill_tot_outst_amt= d_bill_tot_outst_amt-d_patient_deposidt_amt;  //here patient outstanding
							fprintf(fp,"\n");lsr_line_cnt();

							}         
						}

					
			}
				
			close_patient_deposit();

			/****upto here****/


               /*ADDED FOR SCRUM CRF-654*/
if (d_tot_outst_amt!=0)	
 {

       if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		{
	        	if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			    {	
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					{
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[993]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
					}
                                 else   
				        {
			         fprintf(fp,"%-62.62s",loc_legend[993]);
				        } 
                             }
			else
			     {
                                if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				       {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[993]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-44.44s",nd_desc_with_spl_chr.arr);
					} 
                                 else
				        {
               				 fprintf(fp,"%-44.44s",loc_legend[993]);
				         }
                             }
		}
	else
		{
			if(l_no_of_clumns ==5)
			   { 
			      if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				       {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[993]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
					}
                               else
			               {
               			       fprintf(fp,"%-53.53s",loc_legend[993]);
				       }
                            }
			 else
			   {
			    if(l_no_of_clumns ==6)
			      {
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					       {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[993]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
						}
					  else
						{
					 fprintf(fp,"%-56.56s",loc_legend[993]);
						}
                              }
			    else
			      {
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					       {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[993]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
						}
                                         else
					       {
                				 fprintf(fp,"%-42.42s",loc_legend[993]);
				                }
                              }
                            }
		}
				print_formated_amt(d_tot_outst_amt);
				fprintf(fp,"\n");lsr_line_cnt();
				//get_rounded_amt(d_tot_outst_amt);
  }
/*ADDED FOR SCRUM CRF-654*/


			   if(nd_rounded_amt!=0)
			   {
				/***** It will print the rounded amt *****/
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					 fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
																																																																																						
				   }
				   else
				 fprintf(fp,"%-61.61s",loc_legend[1240]);
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
					 																																																																																						
				   }
				   else
				 fprintf(fp,"%-45.45s",loc_legend[1240]);
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
										 																																																																																						
				   }
				   else
				  fprintf(fp,"%-53.53s",loc_legend[1240]);
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
											 																																																																																						
				   }
				   else
				  fprintf(fp,"%-56.56s",loc_legend[1240]);
			     }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1240]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																 																																																																																						
				   }
				   else
				  fprintf(fp,"%-42.42s",loc_legend[1240]);
				 }
				}
				print_formated_amt(nd_rounded_amt);
				fprintf(fp,"\n");lsr_line_cnt();

				/***** It Will Print the after rounded amt of Net Payable Amt ********/ 
			 	if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
																					 																																																																																						
				   }
				   else
				 fprintf(fp,"%-61.61s",loc_legend[1250]);
				}
				else
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																										 																																																																																						
				   }
				   else
				 fprintf(fp,"%-45.45s",loc_legend[1250]);
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																															 																																																																																						
				   }
				   else
				  fprintf(fp,"%-53.53s",loc_legend[1250]);
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																				 																																																																																						
				   }
				   else
				  fprintf(fp,"%-56.56s",loc_legend[1250]);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1250]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																									 																																																																																						
				   }
				   else
				  fprintf(fp,"%-42.42s",loc_legend[1250]);
				 }
				}
				print_formated_amt(nd_net_pay_amt_after_rounded);
				fprintf(fp,"\n"); //lsr_line_cnt(); 
               }

			 }
				 
				/***** upto here ********/

				/***** added on 30/09/2008 for printing package deposit if it is there ********/ 
/*
				if(l_pkg_len!=0)
				{
					for(i=1;i<=l_pkg_len;i++)
					{
					  l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]);
					  if(l_pkg_dep_amt!=0)
					  {
					   l_pkg_dep_exist=1; 
					   break;
					  }
					}
				  if(l_pkg_dep_exist==1)
				  {  	
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
																																															 																																																																																							
					   }
					   else
					 fprintf(fp,"%-61.61s",loc_legend[1260]);
					}
					else
					{
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-46.46s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-46.46s",nd_desc_with_spl_chr.arr);
																																																					 																																																																																							
					   }
					   else
					 fprintf(fp,"%-46.46s",loc_legend[1260]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-52.52s",nd_desc_with_spl_chr.arr);
																																																											 																																																																																							
					   }
					   else
					  fprintf(fp,"%-52.52s",loc_legend[1260]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																																																																	 																																																																																							
					   }
					   else
					  fprintf(fp,"%-56.56s",loc_legend[1260]);
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1260]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																																							 																																																																																							
					   }
					   else
					  fprintf(fp,"%-42.42s",loc_legend[1260]);
					 }
					}
					fprintf(fp,"\n");lsr_line_cnt(); 
					for(i=1;i<=l_pkg_len;i++)
					{
					   l_pkg_dep_amt=atoi(p_pkg_dep_amt[i]); //atoi function will convert string to double
                       if(l_pkg_dep_amt!=0)
					   {
					  
							if((strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0) &&(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0))
							{
							  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							   {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-30.30s",loc_legend[1290]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"       %-30.30s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																																															 																																																																																									
							   }
							   else
							 fprintf(fp,"       %-30.30s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
							}
							else
							{
							 if(l_no_of_clumns ==5)
							 {
							  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							   {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"       %-21.21s : %-18.18s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																																																							 																																																																																									
							   }
							   else
							  fprintf(fp,"       %-21.21s : %-18.18s",loc_legend[1290],p_pkg_seq_num[i]);
							 }
							 else
							 if(l_no_of_clumns ==6)
				    		 {
							  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							   {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"       %-21.21s : %-21.21s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																																																															 																																																																																									
							   }
							   else
							  fprintf(fp,"       %-21.21s : %-21.21s",loc_legend[1290],p_pkg_seq_num[i]);
							 }
							 else
							 {
							  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							   {
								nd_temp_str.arr[0]='\0';
								nd_temp_str.len=0;
								sprintf(nd_temp_str.arr,"%-21.21s",loc_legend[1290]);
								fun_Pad_desc_with_spl_char(nd_temp_str.arr);
								fprintf(fp,"       %-21.21s : %-11.11s",nd_desc_with_spl_chr.arr,p_pkg_seq_num[i]);
																																																																																																							 																																																																																									
							   }
							   else
							  fprintf(fp,"       %-21.21s : %-11.11s",loc_legend[1290],p_pkg_seq_num[i]);
							 }
							}
								
							print_formated_amt(l_pkg_dep_amt);
							fprintf(fp,"\n"); //lsr_line_cnt();
						} 
					}

				  }
				}

				*/	
			
			/************* IT PRINTS THE BILL ADJUSTMENTS **************/

			/****** Bill Adjustments As Saparate Row ******/
	/*COMMENTED FOR SCRUM CRF-654
	
			if (strcmp(c_all_oth_adj_amt_ind.arr,"R")==0)  
			{
			    if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
				{
				 if((nd_tot_disc_amount)!=0)
				 {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-60.60s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-60.60s",nd_desc_with_spl_chr.arr);
																																																																																																											 																																																																																							
					   }
					   else
					 fprintf(fp," %-60.60s",loc_legend[790]);
					}
					else
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																																																																																	 																																																																																							
					   }
					   else
					 fprintf(fp," %-45.45s",loc_legend[790]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
				     {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																							 																																																																																							
					   }
					   else
					  fprintf(fp," %-52.52s",loc_legend[790]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																													 																																																																																							
					   }
					   else
					  fprintf(fp," %-55.55s",loc_legend[790]);
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																			 																																																																																							
					   }
					   else
					  fprintf(fp," %-41.41s",loc_legend[790]);
					 }
					}
					print_formated_amt(nd_tot_disc_amount);
					fprintf(fp,"\n"); //lsr_line_cnt();
				 }
				}
				
			  if((d1_tot_adjust_amt!=0)||(strcmp(c_print_zero_other_adj_yn.arr,"Y")==0))
			  {	
				
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-60.60s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-60.60s",nd_desc_with_spl_chr.arr);
																																																																																																																																								 																																																																																						
				   }
				   else
				 fprintf(fp," %-60.60s",loc_legend[780]);
				}
				else
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																																																																																																													 																																																																																						
				   }
				   else
				 fprintf(fp," %-44.44s",loc_legend[780]);
				}
				}
				else
			    {
				 if(l_no_of_clumns ==5)
			     {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																															 																																																																																						
				   }
				   else
				  fprintf(fp," %-52.52s",loc_legend[780]);
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																				 																																																																																						
				   }
				   else
				  fprintf(fp," %-55.55s",loc_legend[780]);
				 }
				 else
				 {
					if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[780]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																		 																																																																																						
				   }
				   else
				  fprintf(fp," %-41.41s",loc_legend[780]);
				 }
				}
				print_formated_amt(d1_tot_adjust_amt);
				fprintf(fp,"\n"); //lsr_line_cnt();
			  }

			  if(d1_bill_tot_exmpt_amt!=0)
			  {
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																																																																																																		 																																																																																						
				   }
				   else
				 fprintf(fp," %-61.61s",loc_legend[720]);
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																																																																																																							 																																																																																						
				   }
				   else
				 fprintf(fp," %-45.45s",loc_legend[720]);
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
			     {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																												 																																																																																						
				   }
				   else
				  fprintf(fp," %-52.52s",loc_legend[720]);
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																	 																																																																																						
				   }
				   else
				  fprintf(fp," %-55.55s",loc_legend[720]);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[720]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																																						 																																																																																						
				   }
				   else
				  fprintf(fp," %-41.41s",loc_legend[720]);
				 }
				}
				print_formated_amt(d1_bill_tot_exmpt_amt);
				fprintf(fp,"\n"); //lsr_line_cnt();
			  }
			
			  if(d1_tot_write_off_amt!=0)
			  {
				
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																																																																																																																											 																																																																																						
				   }
				   else
				 fprintf(fp," %-61.61s",loc_legend[800]);
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																 																																																																																						
				   }
				   else
				 fprintf(fp," %-45.45s",loc_legend[800]);
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
			     {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																					 																																																																																						
				   }
				   else
				  fprintf(fp," %-52.52s",loc_legend[800]);
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																										 																																																																																						
				   }
				   else
				  fprintf(fp," %-55.55s",loc_legend[800]);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[800]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																															 																																																																																						
				   }
				   else
				  fprintf(fp," %-41.41s",loc_legend[800]);
				 }
				}
				print_formated_amt(d1_tot_write_off_amt);
				fprintf(fp,"\n"); //lsr_line_cnt();
              }
			}
	COMMENETED FOR SCRUM CRF-654*/

			/****** Bill Adjustments As Summerized row ******/
			//if (strcmp(c_all_oth_adj_amt_ind.arr,"S")==0)  COMMENETED FOR SCRUM CRF-654
		      //{ COMMENETED FOR SCRUM CRF-654
			   /*COMMENETED FOR SCRUM CRF-654
               
			   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			   {	
				   if(d1_tot_adjust_amt!=0 || nd_tot_disc_amount!=0||d1_bill_tot_exmpt_amt!=0||d1_tot_write_off_amt!=0)
				   {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																					 																																																																																							
					   }
					   else
					 fprintf(fp," %-61.61s",loc_legend[850]);
					}
					else
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																											 																																																																																							
					   }
					   else
					 fprintf(fp," %-44.44s",loc_legend[850]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																	 																																																																																							
					   }
					   else
					  fprintf(fp," %-52.52s",loc_legend[850]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																							 																																																																																							
					   }
					   else
					  fprintf(fp," %-55.55s",loc_legend[850]);
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																													 																																																																																							
					   }
					   else
					  fprintf(fp," %-41.41s",loc_legend[850]);
					 }
					}
					print_formated_amt(d1_tot_adjust_amt+nd_tot_disc_amount+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
					fprintf(fp,"\n"); //lsr_line_cnt();
				   }
                }
				                } COMMENETED FOR SCRUM CRF-654*/
				/**** Discount amount not printing from No Discount Fundtions ****/
			/*COMMENETED FOR SCRUM CRF-654
				else
				{
				   if(d1_tot_adjust_amt!=0 ||d1_bill_tot_exmpt_amt!=0||d1_tot_write_off_amt!=0)
				   {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																			 																																																																																							
					   }
					   else
					 fprintf(fp," %-61.61s",loc_legend[850]);
					}
					else
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																								 																																																																																							
					   }
					   else
					 fprintf(fp," %-44.44s",loc_legend[850]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[850]);;
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																														 																																																																																							
					   }
					   else
					  fprintf(fp," %-52.52s",loc_legend[850]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																				 																																																																																							
					   }
					   else
					  fprintf(fp," %-55.55s",loc_legend[850]);
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[850]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																										 																																																																																							
					   }
					   else
					  fprintf(fp," %-41.41s",loc_legend[850]);
					 }
					}
					print_formated_amt(d1_tot_adjust_amt+d1_bill_tot_exmpt_amt+d1_tot_write_off_amt);
					fprintf(fp,"\n"); //lsr_line_cnt();
				   }
				
				}
			   if (strcmp(c_bill_adj_sep_row_yn.arr,"Y")==0)
			    {
				  if((d1_tot_adjust_amt!=0)|| (strcmp(c_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
				  {
				 	if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																 																																																																																							
					   }
					   else
					 fprintf(fp," %-61.61s",loc_legend[780]);
					}
					else
					{
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																						 																																																																																							
					   }
					   else
					 fprintf(fp," %-44.44s",loc_legend[780]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																											 																																																																																							
					   }
					   else
					  fprintf(fp," %-52.52s",loc_legend[780]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																 																																																																																							
					   }
					   else
					  fprintf(fp," %-55.55s",loc_legend[780]);
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[780]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																						 																																																																																							
					   }
					   else
					  fprintf(fp," %-41.41s",loc_legend[780]);
					 }
					}
					print_formated_amt(d1_tot_adjust_amt);
					fprintf(fp,"\n"); //lsr_line_cnt();
				  }
				  
				}
			 
			   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			   {
				 if (strcmp(c_bill_disc_sep_row_yn.arr,"Y")==0)
				 {
				   if((nd_tot_disc_amount)!=0)
				   {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-60.60s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-60.60s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																												 																																																																																							
					   }
					   else
					 fprintf(fp," %-60.60s",loc_legend[790]);
					}
					else
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																		 																																																																																							
					   }
					   else
					 fprintf(fp," %-45.45s",loc_legend[790]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																							 																																																																																							
					   }
					   else
					  fprintf(fp," %-52.52s",loc_legend[790]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																													 																																																																																							
					   }
					   else
					  fprintf(fp," %-55.55s",loc_legend[790]);
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[790]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																			 																																																																																							
					   }
					   else
					  fprintf(fp," %-41.41s",loc_legend[790]);
					 }
					}
					print_formated_amt(nd_tot_disc_amount);
					fprintf(fp,"\n"); //lsr_line_cnt();
				   }			
				 }
			   }
			 
			 	if (strcmp(c_bill_exm_sep_row_yn.arr,"Y")==0)
			    {
                 if(d1_bill_tot_exmpt_amt!=0)
				 {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																									 																																																																																							
					   }
					   else
					 fprintf(fp," %-61.61s",loc_legend[720]);
					}
					else
					{
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																															 																																																																																							
					   }
					   else
					 fprintf(fp," %-45.45s",loc_legend[720]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																																				 																																																																																							
					   }
					   else
					  fprintf(fp," %-52.52s",loc_legend[720]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						 fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																																										 																																																																																							
					   }
					   else
					  fprintf(fp," %-55.55s",loc_legend[720]);
					 }
					 else
					 {
					  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[720]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																																										 																																																																																							
					   }
					   else
					  fprintf(fp," %-41.41s",loc_legend[720]);
					 }
					}
					print_formated_amt(d1_bill_tot_exmpt_amt);
					fprintf(fp,"\n"); //lsr_line_cnt();
				 }
				}
			 
			    if (strcmp(c_bill_wo_sep_row_yn.arr,"Y")==0)
			    {
				  if(d1_tot_write_off_amt!=0)
				  {
					if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-61.61s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																																															 																																																																																							
					   }
					   else
					 fprintf(fp," %-61.61s",loc_legend[800]);
					}
					else
					{
					 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-45.45s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																																																		 																																																																																							
					   }
					   else
					 fprintf(fp," %-45.45s",loc_legend[800]);
					}
					}
					else
					{
					 if(l_no_of_clumns ==5)
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						 fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																																																																																																																																																																																																																																																																																																							 																																																																																							
					   }
					   else
					  fprintf(fp," %-52.52s",loc_legend[800]);
					 }
					 else
					 if(l_no_of_clumns ==6)
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-55.55s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						fprintf(fp," %-55.55s",nd_desc_with_spl_chr.arr);
						 																																																																																																																																																																																																																																																																																																																																						 																																																																																							
					   }
					   else
					  fprintf(fp," %-55.55s",loc_legend[800]);
					 }
					 else
					 {
					   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
					   {
						nd_temp_str.arr[0]='\0';
						nd_temp_str.len=0;
						sprintf(nd_temp_str.arr,"%-41.41s",loc_legend[800]);
						fun_Pad_desc_with_spl_char(nd_temp_str.arr);
						 fprintf(fp," %-41.41s",nd_desc_with_spl_chr.arr);
											 																																																																																																																																																																																																																																																																																																																																						 																																																																																							
					   }
					   else
					  fprintf(fp," %-41.41s",loc_legend[800]);
					 }
					}
					print_formated_amt(d1_tot_write_off_amt);
					fprintf(fp,"\n"); //lsr_line_cnt();
				  }
				}
								COMMENETED FOR SCRUM CRF-654*/
			 
			 		  // } COMMENETED FOR SCRUM CRF-654
	
	
		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS3")==0||strcmp(nd_calling_pgm_id.arr,"BLRIPDS2")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS3")==0 ||strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLR00101")==0  // added for scrum crf-654
		 || strcmp(l_no_settlement_details.arr,"R")==0 || strcmp(l_no_settlement_details.arr,"N")==0)
		{
		    	
			/****** Deposit Printing *****
			if(d_deposit_adj_amt!=0)
			{
				if(strcmp(d_cust_code.arr,"\0")==0) //added for scrum crf-654
				{ //added for scrum crf-654
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				//sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[880]); commented for scrum remerging
				  sprintf(nd_temp_str.arr,"%-61.61s",loc_legend[992]); //added for scrum remerging
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-61.61s",nd_desc_with_spl_chr.arr);
										 																																																																																																																																																																																																																																																																																																																																						 																																																																																					
			   }
			   else
			 //fprintf(fp,"%-61.61s",loc_legend[880]);  commented for scrum remerging
			   fprintf(fp,"%-61.61s",loc_legend[992]);
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				//sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[880]);  commented for scrum remerging
				  sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[992]);  //added for scrum remerging
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
													 																																																																																																																																																																																																																																																																																																																																						 																																																																																					
			   }
			   else
			 //fprintf(fp,"%-45.45s",loc_legend[880]); commented for scrum remerging
			 fprintf(fp,"%-45.45s",loc_legend[992]);  //added for scrum remerging
			}
			}
			else
			{
			 if(l_no_of_clumns ==5)
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				//sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[880]);  commented for scrum remerging
				  sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[992]);  //added for scrum remerging
				fun_Pad_desc_with_spl_char(nd_temp_str.arr); 
				printf(fp,"%-53.53s",nd_desc_with_spl_chr.arr);
																	 																																																																																																																																																																																																																																																																																																																																						 																																																																																					
			   }
			   else
			  //fprintf(fp,"%-53.53s",loc_legend[880]); commented for scrum remerging
			  fprintf(fp,"%-53.53s",loc_legend[992]);   //added for scrum remerging
			 }
			 else
			 if(l_no_of_clumns ==6)
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				//sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[880]); commented for scrum remerging
				sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[992]); //added for scrum remerging
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-56.56s",nd_desc_with_spl_chr.arr);
																				 																																																																																																																																																																																																																																																																																																																																						 																																																																																					
			   }
			   else
			  //fprintf(fp,"%-56.56s",loc_legend[880]); commented for scrum remerging
			  fprintf(fp,"%-56.56s",loc_legend[992]);  //added for scrum remerging
			 }
			 else
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				//sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[880]); commented for scrum remerging
				sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[992]);   //added for scrum remerging
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																							 																																																																																																																																																																																																																																																																																																																																						 																																																																																					
			   }
			   else
			  //fprintf(fp,"%-42.42s",loc_legend[880]); commented for scrum remerging
			  fprintf(fp,"%-42.42s",loc_legend[992]);   //added for scrum remerging
			 }
			}
			print_formated_amt(d_deposit_adj_amt);
			fprintf(fp,"\n"); //lsr_line_cnt();
			}
			} */   //ADDED FOR SCRUM CRF-654


			/****** Bill Paid Amt Printing ******/
		   if(d_bill_paid_amt!=0)
		   {
			if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
            {
			   if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			   {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[1150]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-62.62s\n",nd_desc_with_spl_chr.arr);
																										 																																																																																																																																																																																																																																																																																																																																						 																																																																																					
			   }
			   else
				fprintf(fp,"%-62.62s\n",loc_legend[1150]);
			   }
			   else
			   {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[1150]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-44.44s\n",nd_desc_with_spl_chr.arr);
																														 																																																																																																																																																																																																																																																																																																																																						 																																																																																					
			   }
			   else
				fprintf(fp,"%-44.44s\n",loc_legend[1150]);
			   }
			   print_payment_dtls();
				
			   fprintf(fp,"%-48.48s"," ");
			}
			else
			{
				if(l_no_of_clumns ==5)
				{
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-53.53s",loc_legend[1150]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-53.53s\n",nd_desc_with_spl_chr.arr);
																																		 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				   else
				  fprintf(fp,"%-53.53s\n",loc_legend[1150]);
				  print_payment_dtls();
				  fprintf(fp,"%-53.53s"," ");
				}
				else
				if(l_no_of_clumns ==6)
				{
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-56.56s",loc_legend[1150]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-56.56s\n",nd_desc_with_spl_chr.arr);
																																						 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				   else
				 fprintf(fp,"%-56.56s\n",loc_legend[1150]);
				 print_payment_dtls();
				 fprintf(fp,"%-56.56s"," ");
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[1150]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-42.42s\n",nd_desc_with_spl_chr.arr);
																																										 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else
				 fprintf(fp,"%-42.42s\n",loc_legend[1150]);
				 print_payment_dtls();
				 fprintf(fp,"%-42.42s"," ");
				}
			}
			print_formated_amt(d_bill_paid_amt);
			fprintf(fp,"\n"); //lsr_line_cnt();
		   }
		   	
		    /****** Outstanding Amt  Printing ******/


					
		   //if(d_bill_tot_outst_amt!=0)
		  // {
//if(strcmp(d_cust_code.arr,"\0")==0) // ADDED FOR SCRUM CRF-654 remerging
			   //{					// ADDED FOR SCRUM CRF-654 remerging

					
				if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-31.31s",loc_legend[890]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-31.31s %-30.30s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																															 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else
				 fprintf(fp,"%-31.31s %-30.30s",loc_legend[890],nd_curr_date_t.arr);
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-31.31s",loc_legend[890]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-31.31s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																				 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else
				 fprintf(fp,"%-31.31s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				}
				}
				else
				{
				 if(l_no_of_clumns ==5)
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-36.36s",loc_legend[890]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-36.36s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																				 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else
				  fprintf(fp,"%-36.36s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				 }
				 else
				 if(l_no_of_clumns ==6)
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-39.39s",loc_legend[890]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-39.39s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																									 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else
				  fprintf(fp,"%-39.39s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-25.25s",loc_legend[890]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-25.25s %-16.16s",nd_desc_with_spl_chr.arr,nd_curr_date_t.arr);
																																																														 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else
				  fprintf(fp,"%-25.25s %-16.16s",loc_legend[890],nd_curr_date_t.arr);
				 }
				}
			
				d_bill_tot_outst_amt = d_bill_tot_outst_amt+ d_pk_variance_amt+d_deposit_adj_amt;
				print_formated_amt(d_bill_tot_outst_amt);
			   }	
						  // }	// ADDED FOR SCRUM CRF-654	remerging		

       // }
      
	  
	  if(nd_net_pay_amt_after_rounded!=0)
	  {

			if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
				amount=nd_net_pay_amt_after_rounded;
			else
			amount=nd_net_pay_amt_after_rounded+ d_pk_pack_tot_n_amount;

	   print_amt_in_words();
	  }
	  else
      {
			if (strcmp(p_bill_net_payable_ind.arr,"R")==0  || strcmp(p_bill_net_payable_ind.arr,"B")==0)
				amount=nd_tot_pat_net_charge_amt;
			else
			amount=nd_tot_pat_net_charge_amt+ d_pk_pack_tot_n_amount;

	   print_amt_in_words();
	  }	
	 } 
	 /**** Discount Document *****/
	 else
	 {
		
	     get_cnt_remain_space(1);
	  /* Here l_lcnt+5 Meaning 'l_lcnt' for how many line for footer part and '5' for Signature */ 	

		if((l_lcnt+5)<=(max_lines-v_lno))  
		{
			
			if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='Y')
			{
			 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			 {
			  
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-62.62s",nd_desc_with_spl_chr.arr);
																																																																		 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else 
			  fprintf(fp,"%-62.62s",loc_legend[680]);
			 }
			 else
			 {
			  
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-45.45s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-45.45s",nd_desc_with_spl_chr.arr);
																																																																			 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else 
			  fprintf(fp,"%-45.45s",loc_legend[680]);
			 }
			 print_formated_amt(nd1_tot_serv_tot_disc);
			}
			else
			if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='N')
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-60.60s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-60.60s",nd_desc_with_spl_chr.arr);
																																																																							 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else 
			 fprintf(fp,"%-60.60s",loc_legend[680]);
			 print_formated_amt(nd1_tot_serv_tot_disc);
			 amount=nd1_tot_serv_tot_disc;
			 print_amt_in_words();
			}
			else
			{
			 fprintf(fp,"%-42.42s"," ");
			 print_formated_amt(nd1_tot_serv_charge_discount);
			 print_formated_amt(nd1_tot_serv_bill_discount);
			 print_formated_amt(nd1_tot_serv_fund_adjustment);
			 fprintf(fp,"\n");lsr_line_cnt();
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																																												 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else 
			 fprintf(fp,"%-42.42s",loc_legend[680]);
			 print_formated_amt(nd1_tot_serv_charge_discount+nd1_tot_serv_bill_discount+nd1_tot_serv_fund_adjustment);
			 amount=nd1_tot_serv_charge_discount+nd1_tot_serv_bill_discount+nd1_tot_serv_fund_adjustment;
			 print_amt_in_words();

			}
		}
		else
		{
			
			 while(v_lno<=max_lines)
			  {
				fprintf(fp,"\n");
				v_lno++;
			  }
			lsr_line_cnt();
			if(c_disc_amt_in_dtl_yn.arr[0]=='N')
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-60.60s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-60.60s",nd_desc_with_spl_chr.arr);
																																																																							 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else 
			 fprintf(fp,"%-60.60s",loc_legend[680]);
			 print_formated_amt(nd1_tot_serv_tot_disc);
			 amount=nd1_tot_serv_tot_disc;
			 print_amt_in_words();
			}
			else
			{
			 fprintf(fp,"%-42.42s"," ");
			 print_formated_amt(nd1_tot_serv_charge_discount);
			 print_formated_amt(nd1_tot_serv_bill_discount);
			 print_formated_amt(nd1_tot_serv_fund_adjustment);
			 fprintf(fp,"\n");lsr_line_cnt();
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-42.42s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
																																																																												 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
				 else 
			 fprintf(fp,"%-42.42s",loc_legend[680]);
			 print_formated_amt(nd1_tot_serv_charge_discount+nd1_tot_serv_bill_discount+nd1_tot_serv_fund_adjustment);
			 amount=nd1_tot_serv_charge_discount+nd1_tot_serv_bill_discount+nd1_tot_serv_fund_adjustment;
			 print_amt_in_words();

			}
		}

	 }

		declare_payer_approval();  //Rajesh	
		 open_payer_approval();     //Rajesh
		print_sign_designation();
		close_payer_approval();

		if (strcmp(nd_bill_format_id.arr,"1")==0)
		if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
		{
		  fprintf(fp,"\n%-64.64s %-s  %-s %-s\n"," ",loc_legend[1425],nd_curr_date_t.arr,loc_legend[1424]);
		}
		if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0) //IN13383
		print_footer1();
		

}
print_payment_dtls()
{

    declare_payment_type_det();
	open_payment_cur();
 
   while(fetch_payment_det_cur())
   {
	  
	if(d_slmt_doc_ref_date.arr[0]!='\0')
	{
	  init_date_temp_var();
	  strcpy(date_convert.arr,d_slmt_doc_ref_date.arr);
	  fun_change_loc_date();
	  strcpy(d_slmt_doc_ref_date.arr,nd_loc_date1.arr);
	 }
	  
	  if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
	  {
		  if(strcmp(c_addl_charge_amt_ind.arr,"C")==0 || strcmp(c_addl_charge_amt_ind.arr,"B")==0 )
		  {
		  get_addlcharge_count();
		  if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
		  {
		   if(nd_print_option.arr[0]=='R')
		   {
		    strncat(nd_line_text.arr,d_rcpt_doc_type_num.arr,25);
			if(strlen(d_rcpt_doc_type_num.arr)<25)
			fun_add_space(25-strlen(d_rcpt_doc_type_num.arr));
			fun_add_space(1);
			strncat(nd_line_text.arr,d_slmt_doc_ref_date.arr,10);
			if(strlen(d_slmt_doc_ref_date.arr)<10)
			fun_add_space(10-strlen(d_slmt_doc_ref_date.arr));
			fun_add_space(1);
			strcat(nd_line_text.arr,"(");
			strncat(nd_line_text.arr,d_settlement_desc.arr,14);
			if(strlen(d_settlement_desc.arr)<14)
			fun_add_space(14-strlen(d_settlement_desc.arr));
			strcat(nd_line_text.arr,")");

		   }
		   else
		   fprintf(fp,"%-25.25s %-10.10s (%-14.14s)",d_rcpt_doc_type_num.arr,d_slmt_doc_ref_date.arr,d_settlement_desc.arr);
		  }
		  else
		  {
		   if(nd_print_option.arr[0]=='R')
		   {
		    strncat(nd_line_text.arr,d_rcpt_doc_type_num.arr,25);
			if(strlen(d_rcpt_doc_type_num.arr)<25)
			fun_add_space(25-strlen(d_rcpt_doc_type_num.arr));
			fun_add_space(1);
			strncat(nd_line_text.arr,d_slmt_doc_ref_date.arr,10);
			if(strlen(d_slmt_doc_ref_date.arr)<10)
			fun_add_space(10-strlen(d_slmt_doc_ref_date.arr));
			fun_add_space(1);
			strcat(nd_line_text.arr,"(");
			strncat(nd_line_text.arr,d_settlement_desc.arr,9);
			if(strlen(d_settlement_desc.arr)<9)
			fun_add_space(9-strlen(d_settlement_desc.arr));
			strcat(nd_line_text.arr,")");

		   }
		   else
		   fprintf(fp,"%-25.25s %-10.10s (%-9.9s)",d_rcpt_doc_type_num.arr,d_slmt_doc_ref_date.arr,d_settlement_desc.arr);
		  }
		  }
		  else
		  {
		   if(nd_print_option.arr[0]=='R')
		   {
		    strncat(nd_line_text.arr,d_rcpt_doc_type_num.arr,25);
			if(strlen(d_rcpt_doc_type_num.arr)<25)
			fun_add_space(25-strlen(d_rcpt_doc_type_num.arr));
			fun_add_space(1);
			strncat(nd_line_text.arr,d_slmt_doc_ref_date.arr,10);
			if(strlen(d_slmt_doc_ref_date.arr)<10)
			fun_add_space(10-strlen(d_slmt_doc_ref_date.arr));
			fun_add_space(1);
			strcat(nd_line_text.arr,"(");
			strncat(nd_line_text.arr,d_settlement_desc.arr,9);
			if(strlen(d_settlement_desc.arr)<9)
			fun_add_space(9-strlen(d_settlement_desc.arr));
			strcat(nd_line_text.arr,")");

		   }
		   else
		   fprintf(fp,"%-25.25s %-10.10s (%-9.9s)",d_rcpt_doc_type_num.arr,d_slmt_doc_ref_date.arr,d_settlement_desc.arr);
		  }
	  }
	  else
	  if(l_no_of_clumns ==6)
	  {
	   if(nd_print_option.arr[0]=='R')
	   {
		strncat(nd_line_text.arr,d_rcpt_doc_type_num.arr,29);
		if(strlen(d_rcpt_doc_type_num.arr)<29)
		fun_add_space(29-strlen(d_rcpt_doc_type_num.arr));
		fun_add_space(1);
		strncat(nd_line_text.arr,d_slmt_doc_ref_date.arr,10);
		if(strlen(d_slmt_doc_ref_date.arr)<10)
		fun_add_space(10-strlen(d_slmt_doc_ref_date.arr));
		fun_add_space(1);
		strcat(nd_line_text.arr,"(");
		strncat(nd_line_text.arr,d_settlement_desc.arr,9);
		if(strlen(d_settlement_desc.arr)<9)
		fun_add_space(9-strlen(d_settlement_desc.arr));
		strcat(nd_line_text.arr,")");

	   }
	   else
	   fprintf(fp,"%-29.29s %-10.10s (%-9.9s)",d_rcpt_doc_type_num.arr,d_slmt_doc_ref_date.arr,d_settlement_desc.arr);
	  }
	  else
	  {
	    if(nd_print_option.arr[0]=='R')
	    {
		strncat(nd_line_text.arr,d_rcpt_doc_type_num.arr,15);
		if(strlen(d_rcpt_doc_type_num.arr)<15)
		fun_add_space(15-strlen(d_rcpt_doc_type_num.arr));
		fun_add_space(1);
		strncat(nd_line_text.arr,d_slmt_doc_ref_date.arr,10);
		if(strlen(d_slmt_doc_ref_date.arr)<10)
		fun_add_space(10-strlen(d_slmt_doc_ref_date.arr));
		fun_add_space(1);
		strcat(nd_line_text.arr,"(");
		strncat(nd_line_text.arr,d_settlement_desc.arr,13);
		if(strlen(d_settlement_desc.arr)<13)
		fun_add_space(13-strlen(d_settlement_desc.arr));
		strcat(nd_line_text.arr,")");

	   }
	   else
	   fprintf(fp,"%-15.15s %-10.10s (%-13.13s)",d_rcpt_doc_type_num.arr,d_slmt_doc_ref_date.arr,d_settlement_desc.arr);
	  }
	  
	  print_formated_amt(d_rcpt_amt);
      
     if(nd_print_option.arr[0]=='R')
	 fun_bl_report_temp_format();
	 else
	 fprintf(fp,"\n");
	 lsr_line_cnt();
   }
	close_payment_cur();

}


print_deposit_dtls()
{
	
    declare_deposit();
	open_deposit();
 
   while(fetch_deposit())
   {
	  
	 
	if(d_slmt_doc_ref_date1.arr[0]!='\0')
	{
	  init_date_temp_var();
	  strcpy(date_convert.arr,d_slmt_doc_ref_date1.arr);
	  fun_change_loc_date();
	  strcpy(d_slmt_doc_ref_date1.arr,nd_loc_date1.arr);
	 }

		d_settlement_desc1.arr[0]		= '\0';
		d_settlement_desc1.len		= 0;

		/* EXEC SQL select short_desc into :d_settlement_desc1
				from BL_SLMT_TYPE_lang_vw 
				where slmt_type_code=:d_settlement_type_code1
				and language_id=:nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select short_desc into :b0  from BL_SLMT_TYPE_lang_vw where\
 (slmt_type_code=:b1 and language_id=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )2162;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_settlement_desc1;
  sqlstm.sqhstl[0] = (unsigned int  )48;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_settlement_type_code1;
  sqlstm.sqhstl[1] = (unsigned int  )9;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		d_settlement_desc1.arr[d_settlement_desc1.len]			= '\0';
		  
	  if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
	  {
		  if(strcmp(c_addl_charge_amt_ind.arr,"C")==0 || strcmp(c_addl_charge_amt_ind.arr,"B")==0 )
		  {
		  get_addlcharge_count();
		  if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
		  {
		   if(nd_print_option.arr[0]=='R')
		   {
		    strncat(nd_line_text.arr,d_rcpt_doc_type_num1.arr,25);
			if(strlen(d_rcpt_doc_type_num.arr)<25)
			fun_add_space(25-strlen(d_rcpt_doc_type_num1.arr));
			fun_add_space(1);
			strncat(nd_line_text.arr,d_slmt_doc_ref_date1.arr,10);
			if(strlen(d_slmt_doc_ref_date.arr)<10)
			fun_add_space(10-strlen(d_slmt_doc_ref_date1.arr));
			fun_add_space(1);
			strcat(nd_line_text.arr,"(");
			strncat(nd_line_text.arr,d_settlement_desc1.arr,14);
			if(strlen(d_settlement_desc.arr)<14)
			fun_add_space(14-strlen(d_settlement_desc1.arr));
			strcat(nd_line_text.arr,")");

		   }
		   else
		   fprintf(fp,"%-25.25s %-10.10s (%-14.14s)",d_rcpt_doc_type_num1.arr,d_slmt_doc_ref_date1.arr,d_settlement_desc1.arr);
		  }
		  else
		  {
		   if(nd_print_option.arr[0]=='R')
		   {
		    strncat(nd_line_text.arr,d_rcpt_doc_type_num1.arr,25);
			if(strlen(d_rcpt_doc_type_num.arr)<25)
			fun_add_space(25-strlen(d_rcpt_doc_type_num1.arr));
			fun_add_space(1);
			strncat(nd_line_text.arr,d_slmt_doc_ref_date1.arr,10);
			if(strlen(d_slmt_doc_ref_date.arr)<10)
			fun_add_space(10-strlen(d_slmt_doc_ref_date1.arr));
			fun_add_space(1);
			strcat(nd_line_text.arr,"(");
			strncat(nd_line_text.arr,d_settlement_desc1.arr,9);
			if(strlen(d_settlement_desc.arr)<9)
			fun_add_space(9-strlen(d_settlement_desc1.arr));
			strcat(nd_line_text.arr,")");

		   }
		   else
		   fprintf(fp,"%-25.25s %-10.10s (%-9.9s)",d_rcpt_doc_type_num1.arr,d_slmt_doc_ref_date1.arr,d_settlement_desc1.arr);
		  }
		  }
		  else
		  {
		   if(nd_print_option.arr[0]=='R')
		   {
		    strncat(nd_line_text.arr,d_rcpt_doc_type_num1.arr,25);
			if(strlen(d_rcpt_doc_type_num.arr)<25)
			fun_add_space(25-strlen(d_rcpt_doc_type_num1.arr));
			fun_add_space(1);
			strncat(nd_line_text.arr,d_slmt_doc_ref_date1.arr,10);
			if(strlen(d_slmt_doc_ref_date.arr)<10)
			fun_add_space(10-strlen(d_slmt_doc_ref_date1.arr));
			fun_add_space(1);
			strcat(nd_line_text.arr,"(");
			strncat(nd_line_text.arr,d_settlement_desc1.arr,9);
			if(strlen(d_settlement_desc.arr)<9)
			fun_add_space(9-strlen(d_settlement_desc1.arr));
			strcat(nd_line_text.arr,")");

		   }
		   else
		   fprintf(fp,"%-25.25s %-10.10s (%-9.9s)",d_rcpt_doc_type_num1.arr,d_slmt_doc_ref_date1.arr,d_settlement_desc1.arr);
		  }
	  }
	  else
	  if(l_no_of_clumns ==6)
	  {
	   if(nd_print_option.arr[0]=='R')
	   {
		strncat(nd_line_text.arr,d_rcpt_doc_type_num1.arr,29);
		if(strlen(d_rcpt_doc_type_num.arr)<29)
		fun_add_space(29-strlen(d_rcpt_doc_type_num1.arr));
		fun_add_space(1);
		strncat(nd_line_text.arr,d_slmt_doc_ref_date1.arr,10);
		if(strlen(d_slmt_doc_ref_date.arr)<10)
		fun_add_space(10-strlen(d_slmt_doc_ref_date1.arr));
		fun_add_space(1);
		strcat(nd_line_text.arr,"(");
		strncat(nd_line_text.arr,d_settlement_desc1.arr,9);
		if(strlen(d_settlement_desc.arr)<9)
		fun_add_space(9-strlen(d_settlement_desc1.arr));
		strcat(nd_line_text.arr,")");

	   }
	   else
	   fprintf(fp,"%-29.29s %-10.10s (%-9.9s))",d_rcpt_doc_type_num1.arr,d_slmt_doc_ref_date1.arr,d_settlement_desc1.arr);
	  }
	  else
	  {
	    if(nd_print_option.arr[0]=='R')
	    {
		strncat(nd_line_text.arr,d_rcpt_doc_type_num1.arr,15);
		if(strlen(d_rcpt_doc_type_num.arr)<15)
		fun_add_space(15-strlen(d_rcpt_doc_type_num1.arr));
		fun_add_space(1);
		strncat(nd_line_text.arr,d_slmt_doc_ref_date1.arr,10);
		if(strlen(d_slmt_doc_ref_date.arr)<10)
		fun_add_space(10-strlen(d_slmt_doc_ref_date1.arr));
		fun_add_space(1);
		strcat(nd_line_text.arr,"(");
		strncat(nd_line_text.arr,d_settlement_desc1.arr,13);
		if(strlen(d_settlement_desc.arr)<13)
		fun_add_space(13-strlen(d_settlement_desc1.arr));
		strcat(nd_line_text.arr,")");

	   }
	   else
	   fprintf(fp,"%-15.15s %-10.10s (%-13.13s)",d_rcpt_doc_type_num1.arr,d_slmt_doc_ref_date1.arr,d_settlement_desc1.arr);
	  }
	  
	  print_formated_amt(d_rcpt_amt1);
      
     if(nd_print_option.arr[0]=='R')
	 fun_bl_report_temp_format();
	 else
	 fprintf(fp,"\n");
	 lsr_line_cnt();
   }
	close_deposit();

}



print_amt_in_words()
{
      fun_amt_in_words();
	  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
	  {
	  	  if(nd_print_option.arr[0]=='R')
		  {
			fun_bl_report_temp_format();
			fun_bl_report_temp_format();
			//strncat(nd_line_text.arr,loc_legend[1403],20); commented for scrum remerging
			strncat(nd_line_text.arr,loc_legend[994],25); //added for scrum remerging
			//if(strlen(loc_legend[1403])<20)  commented for scrum remerging
			//fun_add_space(20-strlen(loc_legend[1403]));commented for scrum remerging
              
            if(strlen(loc_legend[994])<25) //added for scrum remerging
			fun_add_space(25-strlen(loc_legend[994])); //added for scrum remerging

			fun_add_space(1);
			strcat(nd_line_text.arr,":");
			fun_add_space(1);
			strcat(nd_line_text.arr,amt_in_words_Sep.arr);
		  }
		  
		  else
		  {
		   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					//sprintf(nd_temp_str.arr,"%-20.20s",loc_legend[1403]); commented for scrum remerging
					  sprintf(nd_temp_str.arr,"%-25.25s",loc_legend[994]); //added for scrum remerging
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					 //fprintf(fp,"\n\n%-20.20s : %-s",nd_desc_with_spl_chr.arr,amt_in_words_Sep.arr); commented for scrum remerging
					 //fprintf(fp,"\n\n%-25.25s : %-s",nd_desc_with_spl_chr.arr,amt_in_words_Sep.arr); // added for scrum remerging
					 fprintf(fp,"\n\n%-s",amt_in_words_Sep.arr); // added for scrum remerging
																																																																																	 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
			 else 
		  //fprintf(fp,"\n\n%-20.20s : %-s",loc_legend[1403],amt_in_words_Sep.arr); commented for scrum remerging
		  //fprintf(fp,"\n\n%-25.25s : %-s",loc_legend[994],amt_in_words_Sep.arr); //added for scrum remerging
		  fprintf(fp,"\n\n%-s",amt_in_words_Sep.arr); //added for scrum remerging
		}
	  }
	  else
	  {
	     if(nd_print_option.arr[0]=='R')
		  {
			fun_bl_report_temp_format();
			fun_bl_report_temp_format();
			strcat(nd_line_text.arr,loc_legend[1000]);
			strcat(nd_line_text.arr,"(");
			strcat(nd_line_text.arr,loc_legend[1423]);
			strcat(nd_line_text.arr,")");
			fun_add_space(4);
			strcat(nd_line_text.arr,"(");
			strcat(nd_line_text.arr,amt_in_words_Sep.arr);
			strcat(nd_line_text.arr,")");
					
		  }
		  else
	     {
		   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
		
					fun_Pad_desc_with_spl_char(loc_legend[1000]);
					fprintf(fp,"\n\n%-s",nd_desc_with_spl_chr.arr);
					fun_Pad_desc_with_spl_char(loc_legend[1423]);
					fprintf(fp,"(%-s)    (%-s)",nd_desc_with_spl_chr.arr,amt_in_words_Sep.arr);
																																																																																						 																																																																																																																																																																																																																																																																																																																																						 																																																																																						
				   }
			 else 
		  fprintf(fp,"\n\n%-s(%-s)    (%-s)",loc_legend[1000],loc_legend[1423],amt_in_words_Sep.arr);
		 }
	  }
	  if(nd_print_option.arr[0]=='R')
	  {
		fun_bl_report_temp_format();
		fun_bl_report_temp_format();
	  }
	  else
	  fprintf(fp,"\n\n");
	  lsr_line_cnt();lsr_line_cnt();
}

fun_amt_in_words()
{

 	amt_in_words.arr[0]='\0';
	amt_in_words.len=0;
	
	amt_in_words_Sep.arr[0]='\0';
	amt_in_words_Sep.len=0;
						 //abs(nvl(:nd_tot_pat_net_charge_amt,0)),
	/* EXEC SQL EXECUTE
	BEGIN		
	:no_of_lines1:=bl_spell_number.print_in_words
						(:nd_facility_id,
						  //abs(nvl(:amount,0)),
						  abs(nvl(:d_bill_tot_outst_amt,0)),
						  70,
						 :currency,
						 :sub_cur,
						 :nd_decimal,
						 :amt_in_words,
						 :amt_in_words_Sep1);
  	END;
	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin :no_of_lines1 := bl_spell_number . print_in_words ( :n\
d_facility_id , abs ( nvl ( :d_bill_tot_outst_amt , 0 ) ) , 70 , :currency , :\
sub_cur , :nd_decimal , :amt_in_words , :amt_in_words_Sep1 ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2189;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&no_of_lines1;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_bill_tot_outst_amt;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&currency;
 sqlstm.sqhstl[3] = (unsigned int  )18;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&sub_cur;
 sqlstm.sqhstl[4] = (unsigned int  )12;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&nd_decimal;
 sqlstm.sqhstl[5] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&amt_in_words;
 sqlstm.sqhstl[6] = (unsigned int  )2002;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&amt_in_words_Sep1;
 sqlstm.sqhstl[7] = (unsigned int  )2002;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	amt_in_words.arr[amt_in_words.len]='\0';
	amt_in_words_Sep1.arr[amt_in_words_Sep1.len]='\0';

if(amount!=0)
{

	/* EXEC SQL SELECT REPLACE(:amt_in_words_Sep1,'~',CHR(10)||'                              ') 
			 INTO :amt_in_words_Sep
			 FROM DUAL; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select REPLACE(:b0,'~',(CHR(10)||'                          \
    ')) into :b1  from DUAL ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2236;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&amt_in_words_Sep1;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&amt_in_words_Sep;
 sqlstm.sqhstl[1] = (unsigned int  )2002;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
else
{
  	/* EXEC SQL SELECT :amt_in_words
			 INTO :amt_in_words_Sep
			 FROM DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select :b0 into :b1  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )2259;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&amt_in_words;
   sqlstm.sqhstl[0] = (unsigned int  )2002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&amt_in_words_Sep;
   sqlstm.sqhstl[1] = (unsigned int  )2002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
	amt_in_words_Sep.arr[amt_in_words_Sep.len]='\0';

}

/****The Below function added by Rajesh IN20942****/
fun_package_enable_yn() 
{
 	package_enable_yn.arr[0]='\0';
	package_enable_yn.len=0;
	
	/* EXEC SQL EXECUTE
	BEGIN		
	:package_enable_yn :=bl_package_enabled_yn
						(:nd_facility_id
						);
  	END;
	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin :package_enable_yn := bl_package_enabled_yn ( :nd_faci\
lity_id ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2282;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&package_enable_yn;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	package_enable_yn.arr[package_enable_yn.len]='\0';
}

declare_payment_type_det()
{
 
 /* EXEC SQL DECLARE PAYMENT_CUR CURSOR FOR
			Select DOC_TYPE_CODE||'/'||DOC_NUMBER||'/'||DOC_SRNO,
			DOC_DATE,DOC_AMT,A.SLMT_TYPE_CODE,b.SHORT_DESC        
			from bl_receipt_refund_dtl_vw A,BL_SLMT_TYPE B
			Where operating_facility_id = :nd_facility_id
			and a.SLMT_TYPE_CODE=b.SLMT_TYPE_CODE
			and patient_id = :d_patient_id
			and RECPT_NATURE_CODE in ('BI','DC','IN')
			and nvl(CANCELLED_IND,'N')='N'
			and ((BILL_DOC_TYPE_CODE = :d1_doc_type and BILL_DOC_NUMBER = :d1_doc_number) OR
			((DOC_TYPE_CODE, DOC_NUMBER,DOC_SRNO) In ( select ORG_DOC_TYPE_CODE,  ORG_DOC_NUM ,ORG_DOC_SRNO from bl_patient_ledger 
			Where operating_facility_id = :nd_facility_id
			and AD_PR_ADJ_BILL_DOC_TYPE = :d1_doc_type and AD_PR_ADJ_BILL_DOC_NUM = :d1_doc_number))); */ 


	if (OERROR) 
	{
		disp_message (ERR_MESG,"Failed to Declare Pyament Type Cursor");
		proc_exit;
	}
	
	return;
}
open_payment_cur()
{ 
	/* EXEC SQL OPEN PAYMENT_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0034;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2305;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[1] = (unsigned int  )63;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d1_doc_type;
 sqlstm.sqhstl[2] = (unsigned int  )27;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d1_doc_number;
 sqlstm.sqhstl[3] = (unsigned int  )52;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[4] = (unsigned int  )5;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d1_doc_type;
 sqlstm.sqhstl[5] = (unsigned int  )27;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d1_doc_number;
 sqlstm.sqhstl[6] = (unsigned int  )52;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Open payment_det_cur cursor failed");
		proc_exit();
	}
	return;
}
fetch_payment_det_cur()
{

	d_rcpt_doc_type_num.arr[0]		= '\0';
	d_slmt_doc_ref_date.arr[0]		= '\0';
	d_settlement_type_code.arr[0]   = '\0'; 
	d_settlement_desc.arr[0]		= '\0';
	
	

	d_rcpt_doc_type_num.len		= 0;
	d_slmt_doc_ref_date.len		= 0;
	d_settlement_type_code.len	= 0;
	d_settlement_desc.len		= 0;
	
	

	/* EXEC SQL FETCH PAYMENT_CUR INTO 
	  d_rcpt_doc_type_num,
	  d_slmt_doc_ref_date,
	  d_rcpt_amt,
	  d_settlement_type_code,
	  d_settlement_desc; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2348;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d_rcpt_doc_type_num;
 sqlstm.sqhstl[0] = (unsigned int  )502;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_slmt_doc_ref_date;
 sqlstm.sqhstl[1] = (unsigned int  )22;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_rcpt_amt;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_settlement_type_code;
 sqlstm.sqhstl[3] = (unsigned int  )9;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_settlement_desc;
 sqlstm.sqhstl[4] = (unsigned int  )48;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	d_rcpt_doc_type_num.arr[d_rcpt_doc_type_num.len]	    = '\0'; 
	d_slmt_doc_ref_date.arr[d_slmt_doc_ref_date.len]		= '\0';
	d_settlement_type_code.arr[d_settlement_type_code.len]	= '\0';
	d_settlement_desc.arr[d_settlement_desc.len]			= '\0';
	


  if(NODATAFOUND)
	{
		return 0;
	}
  

  if(OERROR)
	{ 
		err_mesg("FETCH FAILED IN PAYMENT_CUR",0,"");
		proc_exit();
	}

    return 1;

}
close_payment_cur()
{ 
	/* EXEC SQL CLOSE PAYMENT_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2383;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
		disp_message (ERR_MESG,"Close header cursor failed");
		proc_exit();
	}
	return;
}


declare_deposit()
{
 

 /* EXEC SQL DECLARE DEPOSIT_CUR CURSOR FOR
			SELECT ORG_DOC_TYPE_CODE||'/'||ORG_DOC_NUM||'/'||ORG_DOC_SRNO, A.DOC_DATE,ABS(A.DOC_AMT),B.SLMT_TYPE_CODE  
			 FROM BL_PATIENT_LEDGER_TRN A,BL_RECEIPT_REFUND_DTL B
			WHERE A.operating_facility_id=:nd_facility_id
			and AD_PR_ADJ_BILL_DOC_TYPE=:d1_doc_type
			AND AD_PR_ADJ_BILL_DOC_NUM=:d1_doc_number
			AND a.patient_id=:d_patient_id
			AND TRX_STATUS IS NULL
			AND A.operating_facility_id=B.operating_facility_id
			AND A.ORG_DOC_TYPE_CODE=B.doc_type_code
			AND A.ORG_DOC_NUM = B.DOC_NUMBER
			AND A.ORG_DOC_SRNO= B.DOC_SRNO
			ORDER BY A.DOC_DATE,A.ORG_DOC_TYPE_CODE,A.ORG_DOC_NUM; */ 

			
	if (OERROR) 
	{
		disp_message (ERR_MESG,"Failed to Declare DEPOSIT_CUR Cursor");
		proc_exit;
	}
	
	return;
}


open_deposit()
{ 
	/* EXEC SQL OPEN DEPOSIT_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0035;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2398;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d1_doc_type;
 sqlstm.sqhstl[1] = (unsigned int  )27;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d1_doc_number;
 sqlstm.sqhstl[2] = (unsigned int  )52;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[3] = (unsigned int  )63;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR) 
	{	
		disp_message (ERR_MESG,"Open DEPOSIT_CUR cursor failed");
		proc_exit();
	}
	return;
}


fetch_deposit()
{

	d_rcpt_doc_type_num1.arr[0]		= '\0';
	d_slmt_doc_ref_date1.arr[0]		= '\0';
	d_settlement_type_code1.arr[0]   = '\0'; 
	
	
	

	d_rcpt_doc_type_num1.len		= 0;
	d_slmt_doc_ref_date1.len		= 0;
	d_settlement_type_code1.len	= 0;
	
	
	

	/* EXEC SQL FETCH DEPOSIT_CUR INTO 
	  d_rcpt_doc_type_num1,
	  d_slmt_doc_ref_date1,
	  d_rcpt_amt1,
	  d_settlement_type_code1 ; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2429;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d_rcpt_doc_type_num1;
 sqlstm.sqhstl[0] = (unsigned int  )502;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_slmt_doc_ref_date1;
 sqlstm.sqhstl[1] = (unsigned int  )22;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_rcpt_amt1;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_settlement_type_code1;
 sqlstm.sqhstl[3] = (unsigned int  )9;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	d_rcpt_doc_type_num1.arr[d_rcpt_doc_type_num1.len]	    = '\0'; 
	d_slmt_doc_ref_date1.arr[d_slmt_doc_ref_date1.len]		= '\0';
	d_settlement_type_code1.arr[d_settlement_type_code1.len]	= '\0';
	
	


  if(NODATAFOUND)
	{
		return 0;
	}
  

  if(OERROR)
	{ 
		err_mesg("FETCH FAILED IN DEPOSIT_CUR",0,"");
		proc_exit();
	}

    return 1;

}

close_deposit()
{ 
	/* EXEC SQL CLOSE DEPOSIT_CUR; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2460;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	if (OERROR) 
	{
		disp_message (ERR_MESG,"Close DEPOSIT_CUR cursor failed");
		proc_exit();
	}
	return;
}


get_cnt_remain_space(int cnt)
{

if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
{ 
 if (cnt==1 || cnt==2 || cnt==3)
 {
	if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
	 l_lcnt++;
	else
	if(l_no_of_clumns ==6)
	 l_lcnt++;
	else
	l_lcnt++;

	if (strcmp(c_gross_net_amt_ind.arr,"G")==0)
	l_lcnt++;
	if (strcmp(c_gross_net_amt_ind.arr,"N")==0)
	l_lcnt++;

	 if (cnt==1 || cnt==2)
	 { 
		if( strcmp(c_bill_subsidized_amt_ind.arr,"R")==0)
		{
		 if((nd_tot_subdiv_amt+d_pk_pack_tot_g_amount-d_pk_pack_tot_n_amount)!=0)
		 {
			if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			l_lcnt++;
			else
			if(l_no_of_clumns ==6)
			l_lcnt++;
			else
			l_lcnt++;
		 }
		}

		if( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0)
		{
		 if(nd_tot_subdiv_amt!=0)
		 {
			if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			l_lcnt++;
			else
			if(l_no_of_clumns ==6)
			l_lcnt++;
			else
			l_lcnt++;
		 }
		}

	 }

	if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
	{
	 if (strcmp(c_serv_disc_on_gross_ind.arr,"R")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0)   
	 {
	   if(p_tot_pat_disc_amt!=0)
	   {	
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	   }
	 }
	}

 if (cnt==2)
 {
   if(strcmp(c_oth_payers_amt_print_row_ind.arr,"R")==0)
	{
       	if(p<=1) 
	{
	  if(strcmp(nd_cust_code1.arr,"\0")!=0)
	  {
	     if(l_no_of_clumns ==5 || l_no_of_clumns ==6|| strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
	      l_lcnt++;
	     else
	      l_lcnt++;
				
	  }

	}
	else
	{
	  if(strcmp(nd_cust_code1.arr,"\0")!=0)
	  {
		if(l_no_of_clumns ==5 || l_no_of_clumns ==6|| strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		l_lcnt++;
				  
	  }
	for (i=1;i<=p;++i)
	{
	 if(strcmp(ar_cust_amt[i],"\0")!=0)
	 l_lcnt=l_lcnt+1;
	}
	 l_lcnt=l_lcnt+1;
	}

   }
	
 }	
	
	if(strcmp(c_addl_charge_amt_ind.arr,"R")==0)
	{

	  if(nd_pat_tot_addl_charge_amt!=0)
	  {
	  if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
	  l_lcnt++;
	  else
	  l_lcnt++;
	  }

	}

	if( strcmp(c_bill_net_payable_ind.arr,"B")==0 || strcmp(c_bill_net_payable_ind.arr,"R")==0)
	{
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;

	   if(nd_rounded_amt!=0)
	   {
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;

		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	   }

	 }

	if(l_pkg_len!=0)
	{
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
		for(i=1;i<=l_pkg_len;i++)
		{
			if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			l_lcnt++;
			else
			if(l_no_of_clumns ==6)
			l_lcnt++;
			else
			l_lcnt++;
		}
	}

	if (strcmp(c_all_oth_adj_amt_ind.arr,"R")==0)  
	{
	  if((d1_tot_adjust_amt!=0)||(strcmp(c_print_zero_other_adj_yn.arr,"Y")==0))
	  {	
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	  }

		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
		{
		 if(nd_tot_disc_amount!=0)
		 {
			if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			l_lcnt++;
			else
			if(l_no_of_clumns ==6)
			l_lcnt++;
			else
			l_lcnt++;
		 }
		}
		
	  if(d1_bill_tot_exmpt_amt!=0)
	  {
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	  }

	  if(d1_tot_write_off_amt!=0)
	  {
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	  }
	}


	if (strcmp(c_all_oth_adj_amt_ind.arr,"S")==0)  
	{
	  if(d1_tot_adjust_amt!=0 || nd_tot_disc_amount!=0||d1_bill_tot_exmpt_amt!=0||d1_tot_write_off_amt!=0)
	   {
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	   }

      if (strcmp(c_bill_adj_sep_row_yn.arr,"Y")==0)
	  {
	   if((d1_tot_adjust_amt!=0)|| (strcmp(c_print_zero_other_adj_yn.arr,"Y")==0)) //for crf-659
	   l_lcnt++;
	   
	  }
	  if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
	  {
	   if (strcmp(c_bill_disc_sep_row_yn.arr,"Y")==0)
	   {
	    if(nd_tot_disc_amount!=0)
	    l_lcnt++;
	   }
	  }
	
	 if (strcmp(c_bill_exm_sep_row_yn.arr,"Y")==0)
	 {
	  if(d1_bill_tot_exmpt_amt!=0)
	  l_lcnt++;
	 }
	
	 if (strcmp(c_bill_wo_sep_row_yn.arr,"Y")==0)
	 {
	  if(d1_tot_write_off_amt!=0)
	  l_lcnt++;
	 }
	}

	if(strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0)
	{
   		if(d_deposit_adj_amt!=0)
		{
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
		}
	
	   if(d_bill_paid_amt!=0)
	   {
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	   }
		
	   if(d_bill_tot_outst_amt!=0)
	   {
		if((l_no_of_clumns ==5) || strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
		l_lcnt++;
		else
		if(l_no_of_clumns ==6)
		l_lcnt++;
		else
		l_lcnt++;
	   }	
		

	  }
  }

 }
 else
 {
  	if(c_disc_amt_in_dtl_yn.arr[0]=='N')
	l_lcnt=l_lcnt+7;
	else
	l_lcnt=l_lcnt+8;
 }

}
print_bold_underline()
{
	fprintf(fp,"%c(s12H",ESC);
	fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style  */
	fprintf(fp,"%c&d0D",ESC);   /* set Underline mode */
}
Release_bold_underline()
{
	fprintf(fp,"%c(s14H",ESC); 
	fprintf(fp,"%c&d@",ESC); 
	fprintf(fp,"%c(s-3B",ESC);
}
/* THIS FUNCTION FOR GETTING GROSS,NET,DISCOUNT AMT for cash patient*/
get_gross_net_amt()
{
  if(strcmp(d1_last_col_trx_yn.arr,"N")==0) 
  {
  /* EXEC SQL EXECUTE
				BEGIN
				BLCOMMON.GET_SERV_TOT_AMT_BY_TRX(
				:nd_facility_id,
				:d1_trx_doc_ref,
				:d1_trx_doc_ref_line_num,
				:p_pat_gross_amt,
				:p_pat_disc_amt,
				:p_pat_net_amt,
				:p_err_level,
				:p_sys_message_id,
				:p_error_text);
                 
				if :p_sys_message_id is not null then
				:p_err_level := '10';
				:p_error_text := blcommon.get_error_text(:p_sys_message_id);
				end if;

				END;
				END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "begin BLCOMMON . GET_SERV_TOT_AMT_BY_TRX ( :nd_facility_id \
, :d1_trx_doc_ref , :d1_trx_doc_ref_line_num , :p_pat_gross_amt , :p_pat_disc_\
amt , :p_pat_net_amt , :p_err_level , :p_sys_message_id , :p_error_text ) ; if\
 :p_sys_message_id is not null then :p_err_level := '10' ; :p_error_text := bl\
common . get_error_text ( :p_sys_message_id ) ; end if ; END ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )2475;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )5;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d1_trx_doc_ref;
  sqlstm.sqhstl[1] = (unsigned int  )63;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d1_trx_doc_ref_line_num;
  sqlstm.sqhstl[2] = (unsigned int  )11;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&p_pat_gross_amt;
  sqlstm.sqhstl[3] = (unsigned int  )sizeof(double);
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&p_pat_disc_amt;
  sqlstm.sqhstl[4] = (unsigned int  )sizeof(double);
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&p_pat_net_amt;
  sqlstm.sqhstl[5] = (unsigned int  )sizeof(double);
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&p_err_level;
  sqlstm.sqhstl[6] = (unsigned int  )12;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&p_sys_message_id;
  sqlstm.sqhstl[7] = (unsigned int  )12;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqhstv[8] = (         void  *)&p_error_text;
  sqlstm.sqhstl[8] = (unsigned int  )202;
  sqlstm.sqhsts[8] = (         int  )0;
  sqlstm.sqindv[8] = (         void  *)0;
  sqlstm.sqinds[8] = (         int  )0;
  sqlstm.sqharm[8] = (unsigned int  )0;
  sqlstm.sqadto[8] = (unsigned short )0;
  sqlstm.sqtdso[8] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			if (strcmp(p_err_level.arr,"10") == 0 && p_error_text.arr[0] != '\0')
				{
					disp_message(ERR_MESG,p_error_text.arr);
					proc_exit(0);
				}

				p_err_level.arr[0] = '\0';
				p_err_level.len = 0;

				p_sys_message_id.arr[0] = '\0';
				p_sys_message_id.len = 0;

				p_error_text.arr[0] = '\0';
				p_error_text.len = 0;
		}
		else
   if(strcmp(d1_last_col_trx_yn.arr,"P")==0) 
  {
  /* EXEC SQL EXECUTE
				BEGIN
				BLPACKAGE.GET_SERV_TOT_AMT_BY_TRX(
				:nd_facility_id,
				:d1_trx_doc_ref,
				:d1_trx_doc_ref_line_num,
				:d1_trx_doc_ref_seq_num,
				:p_pat_gross_amt,
				:p_pat_disc_amt,
				:p_pat_net_amt,
				:p_err_level,
				:p_sys_message_id,
				:p_error_text);
                 
				if :p_sys_message_id is not null then
				:p_err_level := '10';
				:p_error_text := blcommon.get_error_text(:p_sys_message_id);
				end if;

				END;
				END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "begin BLPACKAGE . GET_SERV_TOT_AMT_BY_TRX ( :nd_facility_id\
 , :d1_trx_doc_ref , :d1_trx_doc_ref_line_num , :d1_trx_doc_ref_seq_num , :p_p\
at_gross_amt , :p_pat_disc_amt , :p_pat_net_amt , :p_err_level , :p_sys_messag\
e_id , :p_error_text ) ; if :p_sys_message_id is not null then :p_err_level :=\
 '10' ; :p_error_text := blcommon . get_error_text ( :p_sys_message_id ) ; end\
 if ; END ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )2526;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )5;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d1_trx_doc_ref;
  sqlstm.sqhstl[1] = (unsigned int  )63;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d1_trx_doc_ref_line_num;
  sqlstm.sqhstl[2] = (unsigned int  )11;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d1_trx_doc_ref_seq_num;
  sqlstm.sqhstl[3] = (unsigned int  )7;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&p_pat_gross_amt;
  sqlstm.sqhstl[4] = (unsigned int  )sizeof(double);
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&p_pat_disc_amt;
  sqlstm.sqhstl[5] = (unsigned int  )sizeof(double);
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&p_pat_net_amt;
  sqlstm.sqhstl[6] = (unsigned int  )sizeof(double);
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&p_err_level;
  sqlstm.sqhstl[7] = (unsigned int  )12;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqhstv[8] = (         void  *)&p_sys_message_id;
  sqlstm.sqhstl[8] = (unsigned int  )12;
  sqlstm.sqhsts[8] = (         int  )0;
  sqlstm.sqindv[8] = (         void  *)0;
  sqlstm.sqinds[8] = (         int  )0;
  sqlstm.sqharm[8] = (unsigned int  )0;
  sqlstm.sqadto[8] = (unsigned short )0;
  sqlstm.sqtdso[8] = (unsigned short )0;
  sqlstm.sqhstv[9] = (         void  *)&p_error_text;
  sqlstm.sqhstl[9] = (unsigned int  )202;
  sqlstm.sqhsts[9] = (         int  )0;
  sqlstm.sqindv[9] = (         void  *)0;
  sqlstm.sqinds[9] = (         int  )0;
  sqlstm.sqharm[9] = (unsigned int  )0;
  sqlstm.sqadto[9] = (unsigned short )0;
  sqlstm.sqtdso[9] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			if (strcmp(p_err_level.arr,"10") == 0 && p_error_text.arr[0] != '\0')
				{
					disp_message(ERR_MESG,p_error_text.arr);
					proc_exit(0);
				}

				p_err_level.arr[0] = '\0';
				p_err_level.len = 0;

				p_sys_message_id.arr[0] = '\0';
				p_sys_message_id.len = 0;

				p_error_text.arr[0] = '\0';
				p_error_text.len = 0;
	
 }

}
get_gross_net_amt1()  //credit patient
{
if(strcmp(d_last_col_trx_yn.arr,"N")==0) 
  {	
	/* EXEC SQL EXECUTE
				BEGIN
				BLCOMMON.GET_SERV_TOT_AMT_BY_TRX(
				:nd_facility_id,
				:d_trx_doc_ref,
				:d_trx_doc_ref_line_num,
				:p_gross_amt,
				:p_disc_amt,
				:p_net_amt,
				:p_err_level,
				:p_sys_message_id,
				:p_error_text);

				if :p_sys_message_id is not null then
				:p_err_level := '10';
				:p_error_text := blcommon.get_error_text(:p_sys_message_id);
				end if;

				END;
				END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin BLCOMMON . GET_SERV_TOT_AMT_BY_TRX ( :nd_facility_id ,\
 :d_trx_doc_ref , :d_trx_doc_ref_line_num , :p_gross_amt , :p_disc_amt , :p_ne\
t_amt , :p_err_level , :p_sys_message_id , :p_error_text ) ; if :p_sys_message\
_id is not null then :p_err_level := '10' ; :p_error_text := blcommon . get_er\
ror_text ( :p_sys_message_id ) ; end if ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2581;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_trx_doc_ref;
 sqlstm.sqhstl[1] = (unsigned int  )63;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_trx_doc_ref_line_num;
 sqlstm.sqhstl[2] = (unsigned int  )11;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&p_gross_amt;
 sqlstm.sqhstl[3] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&p_disc_amt;
 sqlstm.sqhstl[4] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&p_net_amt;
 sqlstm.sqhstl[5] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&p_err_level;
 sqlstm.sqhstl[6] = (unsigned int  )12;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_sys_message_id;
 sqlstm.sqhstl[7] = (unsigned int  )12;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_error_text;
 sqlstm.sqhstl[8] = (unsigned int  )202;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




				if (strcmp(p_err_level.arr,"10") == 0 && p_error_text.arr[0] != '\0')
				{
				proc_exit(0);
				}

				p_err_level.arr[0] = '\0';
				p_err_level.len = 0;

				p_sys_message_id.arr[0] = '\0';
				p_sys_message_id.len = 0;

				p_error_text.arr[0] = '\0';
				p_error_text.len = 0;

   }
  
else
	if(strcmp(d_last_col_trx_yn.arr,"P")==0) 
  	{
//disp_message(ERR_MESG,d_trx_doc_ref.arr);
	/* EXEC SQL EXECUTE
				BEGIN
				BLPACKAGE.GET_SERV_TOT_AMT_BY_TRX(
				:nd_facility_id,
				:d_trx_doc_ref,
				:d_trx_doc_ref_line_num,
				:d_trx_doc_ref_seq_num,
				:p_gross_amt,
				:p_disc_amt,
				:p_net_amt,
				:p_err_level,
				:p_sys_message_id,
				:p_error_text);

				if :p_sys_message_id is not null then
				:p_err_level := '10';
				:p_error_text := blcommon.get_error_text(:p_sys_message_id);
				end if;

				END;
				END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin BLPACKAGE . GET_SERV_TOT_AMT_BY_TRX ( :nd_facility_id \
, :d_trx_doc_ref , :d_trx_doc_ref_line_num , :d_trx_doc_ref_seq_num , :p_gross\
_amt , :p_disc_amt , :p_net_amt , :p_err_level , :p_sys_message_id , :p_error_\
text ) ; if :p_sys_message_id is not null then :p_err_level := '10' ; :p_error\
_text := blcommon . get_error_text ( :p_sys_message_id ) ; end if ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )2632;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_trx_doc_ref;
 sqlstm.sqhstl[1] = (unsigned int  )63;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_trx_doc_ref_line_num;
 sqlstm.sqhstl[2] = (unsigned int  )11;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_trx_doc_ref_seq_num;
 sqlstm.sqhstl[3] = (unsigned int  )7;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&p_gross_amt;
 sqlstm.sqhstl[4] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&p_disc_amt;
 sqlstm.sqhstl[5] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&p_net_amt;
 sqlstm.sqhstl[6] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_err_level;
 sqlstm.sqhstl[7] = (unsigned int  )12;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_sys_message_id;
 sqlstm.sqhstl[8] = (unsigned int  )12;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&p_error_text;
 sqlstm.sqhstl[9] = (unsigned int  )202;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

        


				if (strcmp(p_err_level.arr,"10") == 0 && p_error_text.arr[0] != '\0')
				{
				disp_message(ERR_MESG,p_error_text.arr);
				proc_exit(0);
				}

				p_err_level.arr[0] = '\0';
				p_err_level.len = 0;

				p_sys_message_id.arr[0] = '\0';
				p_sys_message_id.len = 0;

				p_error_text.arr[0] = '\0';
				p_error_text.len = 0;
  }
  
}
get_closed_packages()
{
  	p_pkg_seq_num_str.arr[0] ='\0';
	p_pkg_seq_num_str.len	 =  0;
	p_pkg_amt_str.arr[0]	 ='\0';
	p_pkg_amt_str.len		 =  0;
	p_pkg_dep_str.arr[0]	 ='\0';
	p_pkg_dep_str.len		 =  0;
	p_dep_str.arr[0]		 ='\0';
	p_dep_str.len			 = 0;
	p_pkg_variance_str.arr[0]	 ='\0';
	p_pkg_variance_str.len		 = 0;
	p_pkg_var_stax_str.arr[0]	 ='\0';
	p_pkg_var_stax_str.len		 = 0;


	temp_pkg_seq_num_str.arr[0] ='\0';
	temp_pkg_seq_num_str.len	 =  0;
	temp_pkg_amt_str.arr[0]	 ='\0';
	temp_pkg_amt_str.len		 =  0;
	temp_pkg_dep_str.arr[0]	 ='\0';
	temp_pkg_dep_str.len		 =  0;
	temp_dep_str.arr[0]		='\0';
	temp_dep_str.len		= 0;
	temp_pkg_variance_str.arr[0] ='\0';
	temp_pkg_variance_str.len		= 0;
	temp_pkg_variance_tax_str.arr[0] ='\0';
	temp_pkg_variance_tax_str.len		= 0;
	
	//d_pk_pack_tot_g_amount =0;
	//d_pk_pack_tot_n_amount =0;
	l_tot_pkg_payable	   =0;
	l_tot_var_payable		=0;
	l_tot_var_tax			=0;


  /* EXEC SQL EXECUTE
		
		   BEGIN
		 
 blpackage.open_pkg_list( :nd_facility_id,
						  :d_patient_id,
						  :d_episode_type,
						  :d_episode_id,
						  :d_visit_id,
						  :d2_cust_group_code ,
						  :d2_cust_code,			//:d2_cust_code,
						  :d2_priority,
						  :nd_ws_no,
						  :nd_user,
						  :p_pkg_seq_num_str,
						  :p_pkg_amt_str,
						  :p_pkg_dep_str,
						  :p_dep_str,
						  :p_pkg_variance_str,
						  :p_pkg_var_stax_str,
						  :p_err_level,
						  :p_sys_message_id,
						  :p_error_text
							);
		
			if :p_sys_message_id is not null then
			:p_err_level := '10';
			:p_error_text := blcommon.get_error_text(:p_sys_message_id);
			end if;
			
			
			END;
			END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "begin blpackage . open_pkg_list ( :nd_facility_id , :d_pati\
ent_id , :d_episode_type , :d_episode_id , :d_visit_id , :d2_cust_group_code ,\
 :d2_cust_code , :d2_priority , :nd_ws_no , :nd_user , :p_pkg_seq_num_str , :p\
_pkg_amt_str , :p_pkg_dep_str , :p_dep_str , :p_pkg_variance_str , :p_pkg_var_\
stax_str , :p_err_level , :p_sys_message_id , :p_error_text ) ; if :p_sys_mess\
age_id is not null then :p_err_level := '10' ; :p_error_text := blcommon . get\
_error_text ( :p_sys_message_id ) ; end if ; END ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )2687;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )5;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_patient_id;
  sqlstm.sqhstl[1] = (unsigned int  )63;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
  sqlstm.sqhstl[2] = (unsigned int  )4;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d_episode_id;
  sqlstm.sqhstl[3] = (unsigned int  )11;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&d_visit_id;
  sqlstm.sqhstl[4] = (unsigned int  )7;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&d2_cust_group_code;
  sqlstm.sqhstl[5] = (unsigned int  )6;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&d2_cust_code;
  sqlstm.sqhstl[6] = (unsigned int  )27;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&d2_priority;
  sqlstm.sqhstl[7] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqhstv[8] = (         void  *)&nd_ws_no;
  sqlstm.sqhstl[8] = (unsigned int  )42;
  sqlstm.sqhsts[8] = (         int  )0;
  sqlstm.sqindv[8] = (         void  *)0;
  sqlstm.sqinds[8] = (         int  )0;
  sqlstm.sqharm[8] = (unsigned int  )0;
  sqlstm.sqadto[8] = (unsigned short )0;
  sqlstm.sqtdso[8] = (unsigned short )0;
  sqlstm.sqhstv[9] = (         void  *)&nd_user;
  sqlstm.sqhstl[9] = (unsigned int  )43;
  sqlstm.sqhsts[9] = (         int  )0;
  sqlstm.sqindv[9] = (         void  *)0;
  sqlstm.sqinds[9] = (         int  )0;
  sqlstm.sqharm[9] = (unsigned int  )0;
  sqlstm.sqadto[9] = (unsigned short )0;
  sqlstm.sqtdso[9] = (unsigned short )0;
  sqlstm.sqhstv[10] = (         void  *)&p_pkg_seq_num_str;
  sqlstm.sqhstl[10] = (unsigned int  )202;
  sqlstm.sqhsts[10] = (         int  )0;
  sqlstm.sqindv[10] = (         void  *)0;
  sqlstm.sqinds[10] = (         int  )0;
  sqlstm.sqharm[10] = (unsigned int  )0;
  sqlstm.sqadto[10] = (unsigned short )0;
  sqlstm.sqtdso[10] = (unsigned short )0;
  sqlstm.sqhstv[11] = (         void  *)&p_pkg_amt_str;
  sqlstm.sqhstl[11] = (unsigned int  )202;
  sqlstm.sqhsts[11] = (         int  )0;
  sqlstm.sqindv[11] = (         void  *)0;
  sqlstm.sqinds[11] = (         int  )0;
  sqlstm.sqharm[11] = (unsigned int  )0;
  sqlstm.sqadto[11] = (unsigned short )0;
  sqlstm.sqtdso[11] = (unsigned short )0;
  sqlstm.sqhstv[12] = (         void  *)&p_pkg_dep_str;
  sqlstm.sqhstl[12] = (unsigned int  )202;
  sqlstm.sqhsts[12] = (         int  )0;
  sqlstm.sqindv[12] = (         void  *)0;
  sqlstm.sqinds[12] = (         int  )0;
  sqlstm.sqharm[12] = (unsigned int  )0;
  sqlstm.sqadto[12] = (unsigned short )0;
  sqlstm.sqtdso[12] = (unsigned short )0;
  sqlstm.sqhstv[13] = (         void  *)&p_dep_str;
  sqlstm.sqhstl[13] = (unsigned int  )202;
  sqlstm.sqhsts[13] = (         int  )0;
  sqlstm.sqindv[13] = (         void  *)0;
  sqlstm.sqinds[13] = (         int  )0;
  sqlstm.sqharm[13] = (unsigned int  )0;
  sqlstm.sqadto[13] = (unsigned short )0;
  sqlstm.sqtdso[13] = (unsigned short )0;
  sqlstm.sqhstv[14] = (         void  *)&p_pkg_variance_str;
  sqlstm.sqhstl[14] = (unsigned int  )202;
  sqlstm.sqhsts[14] = (         int  )0;
  sqlstm.sqindv[14] = (         void  *)0;
  sqlstm.sqinds[14] = (         int  )0;
  sqlstm.sqharm[14] = (unsigned int  )0;
  sqlstm.sqadto[14] = (unsigned short )0;
  sqlstm.sqtdso[14] = (unsigned short )0;
  sqlstm.sqhstv[15] = (         void  *)&p_pkg_var_stax_str;
  sqlstm.sqhstl[15] = (unsigned int  )202;
  sqlstm.sqhsts[15] = (         int  )0;
  sqlstm.sqindv[15] = (         void  *)0;
  sqlstm.sqinds[15] = (         int  )0;
  sqlstm.sqharm[15] = (unsigned int  )0;
  sqlstm.sqadto[15] = (unsigned short )0;
  sqlstm.sqtdso[15] = (unsigned short )0;
  sqlstm.sqhstv[16] = (         void  *)&p_err_level;
  sqlstm.sqhstl[16] = (unsigned int  )12;
  sqlstm.sqhsts[16] = (         int  )0;
  sqlstm.sqindv[16] = (         void  *)0;
  sqlstm.sqinds[16] = (         int  )0;
  sqlstm.sqharm[16] = (unsigned int  )0;
  sqlstm.sqadto[16] = (unsigned short )0;
  sqlstm.sqtdso[16] = (unsigned short )0;
  sqlstm.sqhstv[17] = (         void  *)&p_sys_message_id;
  sqlstm.sqhstl[17] = (unsigned int  )12;
  sqlstm.sqhsts[17] = (         int  )0;
  sqlstm.sqindv[17] = (         void  *)0;
  sqlstm.sqinds[17] = (         int  )0;
  sqlstm.sqharm[17] = (unsigned int  )0;
  sqlstm.sqadto[17] = (unsigned short )0;
  sqlstm.sqtdso[17] = (unsigned short )0;
  sqlstm.sqhstv[18] = (         void  *)&p_error_text;
  sqlstm.sqhstl[18] = (unsigned int  )202;
  sqlstm.sqhsts[18] = (         int  )0;
  sqlstm.sqindv[18] = (         void  *)0;
  sqlstm.sqinds[18] = (         int  )0;
  sqlstm.sqharm[18] = (unsigned int  )0;
  sqlstm.sqadto[18] = (unsigned short )0;
  sqlstm.sqtdso[18] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
		sprintf(st_var,"%d",sqlca.sqlcode );
		
		if (OERROR && strcmp(st_var,"-1405")!=0) 
		{ 
			disp_message (ERR_MESG,"blpackage.open_pkg_list failed");
			proc_exit();
		}

			if (strcmp(p_err_level.arr,"10") == 0 && p_error_text.arr[0] != '\0')
			{
			 disp_message(ERR_MESG,p_error_text.arr);
			 proc_exit(0);
			}

			p_err_level.arr[0] = '\0';
			p_err_level.len = 0;

			p_sys_message_id.arr[0] = '\0';
			p_sys_message_id.len = 0;

			p_error_text.arr[0] = '\0';
			p_error_text.len = 0;

			

			p_pkg_seq_num_str.arr[p_pkg_seq_num_str.len]='\0';
			p_pkg_amt_str.arr[p_pkg_amt_str.len]='\0';
			p_pkg_dep_str.arr[p_pkg_dep_str.len]='\0';
			p_dep_str.arr[p_dep_str.len]	   ='\0';
			p_pkg_variance_str.arr[p_pkg_variance_str.len]	   ='\0';
			p_pkg_var_stax_str.arr[p_pkg_var_stax_str.len]	   ='\0';
			
			strcpy(temp_pkg_seq_num_str.arr,p_pkg_seq_num_str.arr);
			strcpy(temp_pkg_amt_str.arr,p_pkg_amt_str.arr);
			strcpy(temp_pkg_dep_str.arr,p_pkg_dep_str.arr);
			strcpy(temp_dep_str.arr,p_dep_str.arr);
			strcpy(temp_pkg_variance_str.arr,p_pkg_variance_str.arr);
			strcpy(temp_pkg_variance_tax_str.arr,p_pkg_var_stax_str.arr);
			
			temp_pkg_seq_num_str.len = strlen(temp_pkg_seq_num_str.arr);
			temp_pkg_seq_num_str.arr[temp_pkg_seq_num_str.len] = '\0';

			temp_pkg_amt_str.len = strlen(temp_pkg_amt_str.arr);
			temp_pkg_amt_str.arr[temp_pkg_amt_str.len] = '\0';

			temp_pkg_dep_str.len = strlen(temp_pkg_dep_str.arr);
			temp_pkg_dep_str.arr[temp_pkg_dep_str.len] = '\0';
			
			temp_dep_str.len = strlen(temp_dep_str.arr);
			temp_dep_str.arr[temp_dep_str.len] = '\0';

			temp_pkg_variance_str.len = strlen(temp_pkg_variance_str.arr);
			temp_pkg_variance_str.arr[temp_pkg_variance_str.len] = '\0';

			temp_pkg_variance_tax_str.len = strlen(temp_pkg_variance_tax_str.arr);
			temp_pkg_variance_tax_str.arr[temp_pkg_variance_tax_str.len] = '\0';
						

			p_pkg_seq_num_str.arr[0]='\0';
			p_pkg_amt_str.arr[0]='\0';
			p_pkg_dep_str.arr[0]='\0';
			p_dep_str.arr[0]='\0';
			p_pkg_variance_str.arr[0]='\0';
			p_pkg_var_stax_str.arr[0]='\0';
			
		

			if (temp_pkg_seq_num_str.arr[0] != '\0')
			{
				
				  /* EXEC SQL SELECT length(:temp_pkg_seq_num_str)-length(replace(:temp_pkg_seq_num_str,',',null)) + 1
						   INTO :l_pkg_len
						   FROM DUAL; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 47;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select ((length(:b0)-length(replace(:b0,',',null )))+1)\
 into :b2  from DUAL ";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )2778;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&temp_pkg_seq_num_str;
      sqlstm.sqhstl[0] = (unsigned int  )202;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&temp_pkg_seq_num_str;
      sqlstm.sqhstl[1] = (unsigned int  )202;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&l_pkg_len;
      sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

   //PACKAGE LENGTH 
	
				  for(i=1;i<=l_pkg_len;i++)
				  {
					  
					  /* EXEC SQL SELECT SUBSTR(:temp_pkg_seq_num_str,1,INSTR(:temp_pkg_seq_num_str,',')-1),
									  SUBSTR(:temp_pkg_amt_str,1,INSTR(:temp_pkg_amt_str,',')-1),
									  SUBSTR(:temp_pkg_dep_str,1,INSTR(:temp_pkg_dep_str,',')-1),
  									  SUBSTR(:temp_dep_str,1,INSTR(:temp_dep_str,',')-1),
									  SUBSTR(:temp_pkg_variance_str,1,INSTR(:temp_pkg_variance_str,',')-1),
									  SUBSTR(:temp_pkg_variance_tax_str,1,INSTR(:temp_pkg_variance_tax_str,',')-1),
									  rtrim(SUBSTR(:temp_pkg_seq_num_str,INSTR(:temp_pkg_seq_num_str,',')+1)),
									   rtrim(SUBSTR(:temp_pkg_amt_str,INSTR(:temp_pkg_amt_str,',')+1)),
									   rtrim(SUBSTR(:temp_pkg_dep_str,INSTR(:temp_pkg_dep_str,',')+1)),
   									   rtrim(SUBSTR(:temp_dep_str,INSTR(:temp_dep_str,',')+1)),
									   rtrim(SUBSTR(:temp_pkg_variance_str,INSTR(:temp_pkg_variance_str,',')+1)),
									   rtrim(SUBSTR(:temp_pkg_variance_tax_str,INSTR(:temp_pkg_variance_tax_str,',')+1))


							   INTO   :p_pkg_seq_num_str,
									  :p_pkg_amt_str,
									  :p_pkg_dep_str,
 									  :p_dep_str,
									  :p_pkg_variance_str,
									  :p_pkg_var_stax_str,
									  :temp_pkg_seq_num_str,
									  :temp_pkg_amt_str,
									  :temp_pkg_dep_str,
 									  :temp_dep_str,
									  :temp_pkg_variance_str,
									  :temp_pkg_variance_tax_str
								FROM DUAL; */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 12;
       sqlstm.arrsiz = 47;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlstm.stmt = "select SUBSTR(:b0,1,(INSTR(:b0,',')-1)) ,SUBSTR(:b2,1,\
(INSTR(:b2,',')-1)) ,SUBSTR(:b4,1,(INSTR(:b4,',')-1)) ,SUBSTR(:b6,1,(INSTR(:b6\
,',')-1)) ,SUBSTR(:b8,1,(INSTR(:b8,',')-1)) ,SUBSTR(:b10,1,(INSTR(:b10,',')-1)\
) ,rtrim(SUBSTR(:b0,(INSTR(:b0,',')+1))) ,rtrim(SUBSTR(:b2,(INSTR(:b2,',')+1))\
) ,rtrim(SUBSTR(:b4,(INSTR(:b4,',')+1))) ,rtrim(SUBSTR(:b6,(INSTR(:b6,',')+1))\
) ,rtrim(SUBSTR(:b8,(INSTR(:b8,',')+1))) ,rtrim(SUBSTR(:b10,(INSTR(:b10,',')+1\
))) into :b24,:b25,:b26,:b27,:b28,:b29,:b0,:b2,:b4,:b6,:b8,:b10  from DUAL ";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )2805;
       sqlstm.selerr = (unsigned short)1;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)4352;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&temp_pkg_seq_num_str;
       sqlstm.sqhstl[0] = (unsigned int  )202;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&temp_pkg_seq_num_str;
       sqlstm.sqhstl[1] = (unsigned int  )202;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqhstv[2] = (         void  *)&temp_pkg_amt_str;
       sqlstm.sqhstl[2] = (unsigned int  )202;
       sqlstm.sqhsts[2] = (         int  )0;
       sqlstm.sqindv[2] = (         void  *)0;
       sqlstm.sqinds[2] = (         int  )0;
       sqlstm.sqharm[2] = (unsigned int  )0;
       sqlstm.sqadto[2] = (unsigned short )0;
       sqlstm.sqtdso[2] = (unsigned short )0;
       sqlstm.sqhstv[3] = (         void  *)&temp_pkg_amt_str;
       sqlstm.sqhstl[3] = (unsigned int  )202;
       sqlstm.sqhsts[3] = (         int  )0;
       sqlstm.sqindv[3] = (         void  *)0;
       sqlstm.sqinds[3] = (         int  )0;
       sqlstm.sqharm[3] = (unsigned int  )0;
       sqlstm.sqadto[3] = (unsigned short )0;
       sqlstm.sqtdso[3] = (unsigned short )0;
       sqlstm.sqhstv[4] = (         void  *)&temp_pkg_dep_str;
       sqlstm.sqhstl[4] = (unsigned int  )202;
       sqlstm.sqhsts[4] = (         int  )0;
       sqlstm.sqindv[4] = (         void  *)0;
       sqlstm.sqinds[4] = (         int  )0;
       sqlstm.sqharm[4] = (unsigned int  )0;
       sqlstm.sqadto[4] = (unsigned short )0;
       sqlstm.sqtdso[4] = (unsigned short )0;
       sqlstm.sqhstv[5] = (         void  *)&temp_pkg_dep_str;
       sqlstm.sqhstl[5] = (unsigned int  )202;
       sqlstm.sqhsts[5] = (         int  )0;
       sqlstm.sqindv[5] = (         void  *)0;
       sqlstm.sqinds[5] = (         int  )0;
       sqlstm.sqharm[5] = (unsigned int  )0;
       sqlstm.sqadto[5] = (unsigned short )0;
       sqlstm.sqtdso[5] = (unsigned short )0;
       sqlstm.sqhstv[6] = (         void  *)&temp_dep_str;
       sqlstm.sqhstl[6] = (unsigned int  )202;
       sqlstm.sqhsts[6] = (         int  )0;
       sqlstm.sqindv[6] = (         void  *)0;
       sqlstm.sqinds[6] = (         int  )0;
       sqlstm.sqharm[6] = (unsigned int  )0;
       sqlstm.sqadto[6] = (unsigned short )0;
       sqlstm.sqtdso[6] = (unsigned short )0;
       sqlstm.sqhstv[7] = (         void  *)&temp_dep_str;
       sqlstm.sqhstl[7] = (unsigned int  )202;
       sqlstm.sqhsts[7] = (         int  )0;
       sqlstm.sqindv[7] = (         void  *)0;
       sqlstm.sqinds[7] = (         int  )0;
       sqlstm.sqharm[7] = (unsigned int  )0;
       sqlstm.sqadto[7] = (unsigned short )0;
       sqlstm.sqtdso[7] = (unsigned short )0;
       sqlstm.sqhstv[8] = (         void  *)&temp_pkg_variance_str;
       sqlstm.sqhstl[8] = (unsigned int  )202;
       sqlstm.sqhsts[8] = (         int  )0;
       sqlstm.sqindv[8] = (         void  *)0;
       sqlstm.sqinds[8] = (         int  )0;
       sqlstm.sqharm[8] = (unsigned int  )0;
       sqlstm.sqadto[8] = (unsigned short )0;
       sqlstm.sqtdso[8] = (unsigned short )0;
       sqlstm.sqhstv[9] = (         void  *)&temp_pkg_variance_str;
       sqlstm.sqhstl[9] = (unsigned int  )202;
       sqlstm.sqhsts[9] = (         int  )0;
       sqlstm.sqindv[9] = (         void  *)0;
       sqlstm.sqinds[9] = (         int  )0;
       sqlstm.sqharm[9] = (unsigned int  )0;
       sqlstm.sqadto[9] = (unsigned short )0;
       sqlstm.sqtdso[9] = (unsigned short )0;
       sqlstm.sqhstv[10] = (         void  *)&temp_pkg_variance_tax_str;
       sqlstm.sqhstl[10] = (unsigned int  )202;
       sqlstm.sqhsts[10] = (         int  )0;
       sqlstm.sqindv[10] = (         void  *)0;
       sqlstm.sqinds[10] = (         int  )0;
       sqlstm.sqharm[10] = (unsigned int  )0;
       sqlstm.sqadto[10] = (unsigned short )0;
       sqlstm.sqtdso[10] = (unsigned short )0;
       sqlstm.sqhstv[11] = (         void  *)&temp_pkg_variance_tax_str;
       sqlstm.sqhstl[11] = (unsigned int  )202;
       sqlstm.sqhsts[11] = (         int  )0;
       sqlstm.sqindv[11] = (         void  *)0;
       sqlstm.sqinds[11] = (         int  )0;
       sqlstm.sqharm[11] = (unsigned int  )0;
       sqlstm.sqadto[11] = (unsigned short )0;
       sqlstm.sqtdso[11] = (unsigned short )0;
       sqlstm.sqhstv[12] = (         void  *)&temp_pkg_seq_num_str;
       sqlstm.sqhstl[12] = (unsigned int  )202;
       sqlstm.sqhsts[12] = (         int  )0;
       sqlstm.sqindv[12] = (         void  *)0;
       sqlstm.sqinds[12] = (         int  )0;
       sqlstm.sqharm[12] = (unsigned int  )0;
       sqlstm.sqadto[12] = (unsigned short )0;
       sqlstm.sqtdso[12] = (unsigned short )0;
       sqlstm.sqhstv[13] = (         void  *)&temp_pkg_seq_num_str;
       sqlstm.sqhstl[13] = (unsigned int  )202;
       sqlstm.sqhsts[13] = (         int  )0;
       sqlstm.sqindv[13] = (         void  *)0;
       sqlstm.sqinds[13] = (         int  )0;
       sqlstm.sqharm[13] = (unsigned int  )0;
       sqlstm.sqadto[13] = (unsigned short )0;
       sqlstm.sqtdso[13] = (unsigned short )0;
       sqlstm.sqhstv[14] = (         void  *)&temp_pkg_amt_str;
       sqlstm.sqhstl[14] = (unsigned int  )202;
       sqlstm.sqhsts[14] = (         int  )0;
       sqlstm.sqindv[14] = (         void  *)0;
       sqlstm.sqinds[14] = (         int  )0;
       sqlstm.sqharm[14] = (unsigned int  )0;
       sqlstm.sqadto[14] = (unsigned short )0;
       sqlstm.sqtdso[14] = (unsigned short )0;
       sqlstm.sqhstv[15] = (         void  *)&temp_pkg_amt_str;
       sqlstm.sqhstl[15] = (unsigned int  )202;
       sqlstm.sqhsts[15] = (         int  )0;
       sqlstm.sqindv[15] = (         void  *)0;
       sqlstm.sqinds[15] = (         int  )0;
       sqlstm.sqharm[15] = (unsigned int  )0;
       sqlstm.sqadto[15] = (unsigned short )0;
       sqlstm.sqtdso[15] = (unsigned short )0;
       sqlstm.sqhstv[16] = (         void  *)&temp_pkg_dep_str;
       sqlstm.sqhstl[16] = (unsigned int  )202;
       sqlstm.sqhsts[16] = (         int  )0;
       sqlstm.sqindv[16] = (         void  *)0;
       sqlstm.sqinds[16] = (         int  )0;
       sqlstm.sqharm[16] = (unsigned int  )0;
       sqlstm.sqadto[16] = (unsigned short )0;
       sqlstm.sqtdso[16] = (unsigned short )0;
       sqlstm.sqhstv[17] = (         void  *)&temp_pkg_dep_str;
       sqlstm.sqhstl[17] = (unsigned int  )202;
       sqlstm.sqhsts[17] = (         int  )0;
       sqlstm.sqindv[17] = (         void  *)0;
       sqlstm.sqinds[17] = (         int  )0;
       sqlstm.sqharm[17] = (unsigned int  )0;
       sqlstm.sqadto[17] = (unsigned short )0;
       sqlstm.sqtdso[17] = (unsigned short )0;
       sqlstm.sqhstv[18] = (         void  *)&temp_dep_str;
       sqlstm.sqhstl[18] = (unsigned int  )202;
       sqlstm.sqhsts[18] = (         int  )0;
       sqlstm.sqindv[18] = (         void  *)0;
       sqlstm.sqinds[18] = (         int  )0;
       sqlstm.sqharm[18] = (unsigned int  )0;
       sqlstm.sqadto[18] = (unsigned short )0;
       sqlstm.sqtdso[18] = (unsigned short )0;
       sqlstm.sqhstv[19] = (         void  *)&temp_dep_str;
       sqlstm.sqhstl[19] = (unsigned int  )202;
       sqlstm.sqhsts[19] = (         int  )0;
       sqlstm.sqindv[19] = (         void  *)0;
       sqlstm.sqinds[19] = (         int  )0;
       sqlstm.sqharm[19] = (unsigned int  )0;
       sqlstm.sqadto[19] = (unsigned short )0;
       sqlstm.sqtdso[19] = (unsigned short )0;
       sqlstm.sqhstv[20] = (         void  *)&temp_pkg_variance_str;
       sqlstm.sqhstl[20] = (unsigned int  )202;
       sqlstm.sqhsts[20] = (         int  )0;
       sqlstm.sqindv[20] = (         void  *)0;
       sqlstm.sqinds[20] = (         int  )0;
       sqlstm.sqharm[20] = (unsigned int  )0;
       sqlstm.sqadto[20] = (unsigned short )0;
       sqlstm.sqtdso[20] = (unsigned short )0;
       sqlstm.sqhstv[21] = (         void  *)&temp_pkg_variance_str;
       sqlstm.sqhstl[21] = (unsigned int  )202;
       sqlstm.sqhsts[21] = (         int  )0;
       sqlstm.sqindv[21] = (         void  *)0;
       sqlstm.sqinds[21] = (         int  )0;
       sqlstm.sqharm[21] = (unsigned int  )0;
       sqlstm.sqadto[21] = (unsigned short )0;
       sqlstm.sqtdso[21] = (unsigned short )0;
       sqlstm.sqhstv[22] = (         void  *)&temp_pkg_variance_tax_str;
       sqlstm.sqhstl[22] = (unsigned int  )202;
       sqlstm.sqhsts[22] = (         int  )0;
       sqlstm.sqindv[22] = (         void  *)0;
       sqlstm.sqinds[22] = (         int  )0;
       sqlstm.sqharm[22] = (unsigned int  )0;
       sqlstm.sqadto[22] = (unsigned short )0;
       sqlstm.sqtdso[22] = (unsigned short )0;
       sqlstm.sqhstv[23] = (         void  *)&temp_pkg_variance_tax_str;
       sqlstm.sqhstl[23] = (unsigned int  )202;
       sqlstm.sqhsts[23] = (         int  )0;
       sqlstm.sqindv[23] = (         void  *)0;
       sqlstm.sqinds[23] = (         int  )0;
       sqlstm.sqharm[23] = (unsigned int  )0;
       sqlstm.sqadto[23] = (unsigned short )0;
       sqlstm.sqtdso[23] = (unsigned short )0;
       sqlstm.sqhstv[24] = (         void  *)&p_pkg_seq_num_str;
       sqlstm.sqhstl[24] = (unsigned int  )202;
       sqlstm.sqhsts[24] = (         int  )0;
       sqlstm.sqindv[24] = (         void  *)0;
       sqlstm.sqinds[24] = (         int  )0;
       sqlstm.sqharm[24] = (unsigned int  )0;
       sqlstm.sqadto[24] = (unsigned short )0;
       sqlstm.sqtdso[24] = (unsigned short )0;
       sqlstm.sqhstv[25] = (         void  *)&p_pkg_amt_str;
       sqlstm.sqhstl[25] = (unsigned int  )202;
       sqlstm.sqhsts[25] = (         int  )0;
       sqlstm.sqindv[25] = (         void  *)0;
       sqlstm.sqinds[25] = (         int  )0;
       sqlstm.sqharm[25] = (unsigned int  )0;
       sqlstm.sqadto[25] = (unsigned short )0;
       sqlstm.sqtdso[25] = (unsigned short )0;
       sqlstm.sqhstv[26] = (         void  *)&p_pkg_dep_str;
       sqlstm.sqhstl[26] = (unsigned int  )202;
       sqlstm.sqhsts[26] = (         int  )0;
       sqlstm.sqindv[26] = (         void  *)0;
       sqlstm.sqinds[26] = (         int  )0;
       sqlstm.sqharm[26] = (unsigned int  )0;
       sqlstm.sqadto[26] = (unsigned short )0;
       sqlstm.sqtdso[26] = (unsigned short )0;
       sqlstm.sqhstv[27] = (         void  *)&p_dep_str;
       sqlstm.sqhstl[27] = (unsigned int  )202;
       sqlstm.sqhsts[27] = (         int  )0;
       sqlstm.sqindv[27] = (         void  *)0;
       sqlstm.sqinds[27] = (         int  )0;
       sqlstm.sqharm[27] = (unsigned int  )0;
       sqlstm.sqadto[27] = (unsigned short )0;
       sqlstm.sqtdso[27] = (unsigned short )0;
       sqlstm.sqhstv[28] = (         void  *)&p_pkg_variance_str;
       sqlstm.sqhstl[28] = (unsigned int  )202;
       sqlstm.sqhsts[28] = (         int  )0;
       sqlstm.sqindv[28] = (         void  *)0;
       sqlstm.sqinds[28] = (         int  )0;
       sqlstm.sqharm[28] = (unsigned int  )0;
       sqlstm.sqadto[28] = (unsigned short )0;
       sqlstm.sqtdso[28] = (unsigned short )0;
       sqlstm.sqhstv[29] = (         void  *)&p_pkg_var_stax_str;
       sqlstm.sqhstl[29] = (unsigned int  )202;
       sqlstm.sqhsts[29] = (         int  )0;
       sqlstm.sqindv[29] = (         void  *)0;
       sqlstm.sqinds[29] = (         int  )0;
       sqlstm.sqharm[29] = (unsigned int  )0;
       sqlstm.sqadto[29] = (unsigned short )0;
       sqlstm.sqtdso[29] = (unsigned short )0;
       sqlstm.sqhstv[30] = (         void  *)&temp_pkg_seq_num_str;
       sqlstm.sqhstl[30] = (unsigned int  )202;
       sqlstm.sqhsts[30] = (         int  )0;
       sqlstm.sqindv[30] = (         void  *)0;
       sqlstm.sqinds[30] = (         int  )0;
       sqlstm.sqharm[30] = (unsigned int  )0;
       sqlstm.sqadto[30] = (unsigned short )0;
       sqlstm.sqtdso[30] = (unsigned short )0;
       sqlstm.sqhstv[31] = (         void  *)&temp_pkg_amt_str;
       sqlstm.sqhstl[31] = (unsigned int  )202;
       sqlstm.sqhsts[31] = (         int  )0;
       sqlstm.sqindv[31] = (         void  *)0;
       sqlstm.sqinds[31] = (         int  )0;
       sqlstm.sqharm[31] = (unsigned int  )0;
       sqlstm.sqadto[31] = (unsigned short )0;
       sqlstm.sqtdso[31] = (unsigned short )0;
       sqlstm.sqhstv[32] = (         void  *)&temp_pkg_dep_str;
       sqlstm.sqhstl[32] = (unsigned int  )202;
       sqlstm.sqhsts[32] = (         int  )0;
       sqlstm.sqindv[32] = (         void  *)0;
       sqlstm.sqinds[32] = (         int  )0;
       sqlstm.sqharm[32] = (unsigned int  )0;
       sqlstm.sqadto[32] = (unsigned short )0;
       sqlstm.sqtdso[32] = (unsigned short )0;
       sqlstm.sqhstv[33] = (         void  *)&temp_dep_str;
       sqlstm.sqhstl[33] = (unsigned int  )202;
       sqlstm.sqhsts[33] = (         int  )0;
       sqlstm.sqindv[33] = (         void  *)0;
       sqlstm.sqinds[33] = (         int  )0;
       sqlstm.sqharm[33] = (unsigned int  )0;
       sqlstm.sqadto[33] = (unsigned short )0;
       sqlstm.sqtdso[33] = (unsigned short )0;
       sqlstm.sqhstv[34] = (         void  *)&temp_pkg_variance_str;
       sqlstm.sqhstl[34] = (unsigned int  )202;
       sqlstm.sqhsts[34] = (         int  )0;
       sqlstm.sqindv[34] = (         void  *)0;
       sqlstm.sqinds[34] = (         int  )0;
       sqlstm.sqharm[34] = (unsigned int  )0;
       sqlstm.sqadto[34] = (unsigned short )0;
       sqlstm.sqtdso[34] = (unsigned short )0;
       sqlstm.sqhstv[35] = (         void  *)&temp_pkg_variance_tax_str;
       sqlstm.sqhstl[35] = (unsigned int  )202;
       sqlstm.sqhsts[35] = (         int  )0;
       sqlstm.sqindv[35] = (         void  *)0;
       sqlstm.sqinds[35] = (         int  )0;
       sqlstm.sqharm[35] = (unsigned int  )0;
       sqlstm.sqadto[35] = (unsigned short )0;
       sqlstm.sqtdso[35] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


									

						p_pkg_seq_num_str.arr[p_pkg_seq_num_str.len]='\0';
						p_pkg_amt_str.arr[p_pkg_amt_str.len]='\0';
						p_pkg_dep_str.arr[p_pkg_dep_str.len]='\0';
						p_dep_str.arr[p_dep_str.len]='\0';
						p_pkg_variance_str.arr[p_pkg_variance_str.len]='\0';
						p_pkg_var_stax_str.arr[p_pkg_var_stax_str.len]='\0';
					
						strcpy(p_pkg_seq_num[i],p_pkg_seq_num_str.arr);
						strcpy(p_pkg_amt[i],p_pkg_amt_str.arr);
						strcpy(p_pkg_dep_amt[i],p_pkg_dep_str.arr);
					    strcpy(p_dep_amt[i],p_dep_str.arr);
					
						strcpy(p_pkg_variance_amt[i],p_pkg_variance_str.arr);
						strcpy(p_pkg_variance_tax_amt[i],p_pkg_var_stax_str.arr);

						temp_pkg_seq_num_str.arr[temp_pkg_seq_num_str.len]='\0';
						temp_pkg_amt_str.arr[temp_pkg_amt_str.len]='\0';
						temp_pkg_dep_str.arr[temp_pkg_dep_str.len]='\0';
						temp_dep_str.arr[temp_dep_str.len]='\0';					
						temp_pkg_variance_str.arr[temp_pkg_variance_str.len]='\0';
						temp_pkg_variance_tax_str.arr[temp_pkg_variance_tax_str.len]='\0';		
						
						
				   }
					
						
						strcpy(p_pkg_seq_num[l_pkg_len],temp_pkg_seq_num_str.arr);
						strcpy(p_pkg_amt[l_pkg_len],temp_pkg_amt_str.arr);
						strcpy(p_pkg_dep_amt[l_pkg_len],temp_pkg_dep_str.arr);
						strcpy(p_dep_amt[l_pkg_len],temp_dep_str.arr);
						strcpy(p_pkg_variance_amt[l_pkg_len],temp_pkg_variance_str.arr);
						strcpy(p_pkg_variance_tax_amt[l_pkg_len],temp_pkg_variance_tax_str.arr);

				}

				

	for(i=1;i<=l_pkg_len;i++)
	{
		l_tot_pkg_payable=l_tot_pkg_payable+atof(p_pkg_dep_amt[i]);
		l_tot_var_payable=l_tot_var_payable+atof(p_pkg_variance_amt[i]);
		l_tot_var_tax	 = l_tot_var_tax+atof(p_pkg_variance_tax_amt[i]);	
     }


}			

// The below function added by rajesh for package discount

get_package_discount()
{
  	
/*
disp_message(ERR_MESG,v_user_id.arr);
	disp_message(ERR_MESG,nd_ws_no.arr);
	disp_message(ERR_MESG,l_pkg_seq_num.arr);
	disp_message(ERR_MESG,d_patient_id.arr);
	disp_message(ERR_MESG,d_episode_id.arr);
	disp_message(ERR_MESG,d_episode_type.arr);
	disp_message(ERR_MESG,dc_blng_grp_id.arr);
	disp_message(ERR_MESG,d_cust_group_code.arr);
	disp_message(ERR_MESG,d_cust_code.arr);
*/

	vDisc				   = 0;

  /* EXEC SQL EXECUTE
		
   Declare 
       vtrx_date  date:=sysdate;

		   BEGIN
			BLPACKAGE.getOpenpkgdiscountamt (
									:nd_facility_id,
									:d_patient_id,
									:d_episode_type,
									:d_episode_id,
									:d_visit_id,
									:l_pkg_seq_num ,
									:nd_package_code,
									:dc_blng_grp_id,
									vtrx_date,
									:d_cust_group_code,
									:d_cust_code,     
									:nd_ws_no,
									:v_user_id,
									:vDisc,
									:p_error_text,   
									:p_err_level,
									:p_sys_message_id);


     if :p_sys_message_id is not null then
			:p_err_level := '10';
			:p_error_text := blcommon.get_error_text(:p_sys_message_id);
	 end if;
		
  	END;
	END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "declare vtrx_date date := sysdate ; BEGIN BLPACKAGE . getOp\
enpkgdiscountamt ( :nd_facility_id , :d_patient_id , :d_episode_type , :d_epis\
ode_id , :d_visit_id , :l_pkg_seq_num , :nd_package_code , :dc_blng_grp_id , v\
trx_date , :d_cust_group_code , :d_cust_code , :nd_ws_no , :v_user_id , :vDisc\
 , :p_error_text , :p_err_level , :p_sys_message_id ) ; if :p_sys_message_id i\
s not null then :p_err_level := '10' ; :p_error_text := blcommon . get_error_t\
ext ( :p_sys_message_id ) ; end if ; END ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )2964;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )5;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_patient_id;
  sqlstm.sqhstl[1] = (unsigned int  )63;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
  sqlstm.sqhstl[2] = (unsigned int  )4;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d_episode_id;
  sqlstm.sqhstl[3] = (unsigned int  )11;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&d_visit_id;
  sqlstm.sqhstl[4] = (unsigned int  )7;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&l_pkg_seq_num;
  sqlstm.sqhstl[5] = (unsigned int  )52;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&nd_package_code;
  sqlstm.sqhstl[6] = (unsigned int  )12;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&dc_blng_grp_id;
  sqlstm.sqhstl[7] = (unsigned int  )7;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqhstv[8] = (         void  *)&d_cust_group_code;
  sqlstm.sqhstl[8] = (unsigned int  )6;
  sqlstm.sqhsts[8] = (         int  )0;
  sqlstm.sqindv[8] = (         void  *)0;
  sqlstm.sqinds[8] = (         int  )0;
  sqlstm.sqharm[8] = (unsigned int  )0;
  sqlstm.sqadto[8] = (unsigned short )0;
  sqlstm.sqtdso[8] = (unsigned short )0;
  sqlstm.sqhstv[9] = (         void  *)&d_cust_code;
  sqlstm.sqhstl[9] = (unsigned int  )27;
  sqlstm.sqhsts[9] = (         int  )0;
  sqlstm.sqindv[9] = (         void  *)0;
  sqlstm.sqinds[9] = (         int  )0;
  sqlstm.sqharm[9] = (unsigned int  )0;
  sqlstm.sqadto[9] = (unsigned short )0;
  sqlstm.sqtdso[9] = (unsigned short )0;
  sqlstm.sqhstv[10] = (         void  *)&nd_ws_no;
  sqlstm.sqhstl[10] = (unsigned int  )42;
  sqlstm.sqhsts[10] = (         int  )0;
  sqlstm.sqindv[10] = (         void  *)0;
  sqlstm.sqinds[10] = (         int  )0;
  sqlstm.sqharm[10] = (unsigned int  )0;
  sqlstm.sqadto[10] = (unsigned short )0;
  sqlstm.sqtdso[10] = (unsigned short )0;
  sqlstm.sqhstv[11] = (         void  *)&v_user_id;
  sqlstm.sqhstl[11] = (unsigned int  )33;
  sqlstm.sqhsts[11] = (         int  )0;
  sqlstm.sqindv[11] = (         void  *)0;
  sqlstm.sqinds[11] = (         int  )0;
  sqlstm.sqharm[11] = (unsigned int  )0;
  sqlstm.sqadto[11] = (unsigned short )0;
  sqlstm.sqtdso[11] = (unsigned short )0;
  sqlstm.sqhstv[12] = (         void  *)&vDisc;
  sqlstm.sqhstl[12] = (unsigned int  )sizeof(double);
  sqlstm.sqhsts[12] = (         int  )0;
  sqlstm.sqindv[12] = (         void  *)0;
  sqlstm.sqinds[12] = (         int  )0;
  sqlstm.sqharm[12] = (unsigned int  )0;
  sqlstm.sqadto[12] = (unsigned short )0;
  sqlstm.sqtdso[12] = (unsigned short )0;
  sqlstm.sqhstv[13] = (         void  *)&p_error_text;
  sqlstm.sqhstl[13] = (unsigned int  )202;
  sqlstm.sqhsts[13] = (         int  )0;
  sqlstm.sqindv[13] = (         void  *)0;
  sqlstm.sqinds[13] = (         int  )0;
  sqlstm.sqharm[13] = (unsigned int  )0;
  sqlstm.sqadto[13] = (unsigned short )0;
  sqlstm.sqtdso[13] = (unsigned short )0;
  sqlstm.sqhstv[14] = (         void  *)&p_err_level;
  sqlstm.sqhstl[14] = (unsigned int  )12;
  sqlstm.sqhsts[14] = (         int  )0;
  sqlstm.sqindv[14] = (         void  *)0;
  sqlstm.sqinds[14] = (         int  )0;
  sqlstm.sqharm[14] = (unsigned int  )0;
  sqlstm.sqadto[14] = (unsigned short )0;
  sqlstm.sqtdso[14] = (unsigned short )0;
  sqlstm.sqhstv[15] = (         void  *)&p_sys_message_id;
  sqlstm.sqhstl[15] = (unsigned int  )12;
  sqlstm.sqhsts[15] = (         int  )0;
  sqlstm.sqindv[15] = (         void  *)0;
  sqlstm.sqinds[15] = (         int  )0;
  sqlstm.sqharm[15] = (unsigned int  )0;
  sqlstm.sqadto[15] = (unsigned short )0;
  sqlstm.sqtdso[15] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  /*
sprintf(st_var,"%f",vDisc);
disp_message(ERR_MESG,st_var);
*/

	if (strcmp(p_err_level.arr,"10") == 0 && p_error_text.arr[0] != '\0')
	{
	 disp_message(ERR_MESG,p_error_text.arr);
	 proc_exit(0);
	}

PkgTotalDiscount = PkgTotalDiscount + vDisc;
			

}			


print_package_discount()
{

 //To Print Package Discount 

		if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
		  if((PkgTotalDiscount)!=0)
		  {
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0) 
			{
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-62.62s",loc_legend[996]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-62.62s",nd_desc_with_spl_chr.arr);
																																																			
				 }
				else
			       fprintf(fp," %-62.62s",loc_legend[996]);
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-44.44s",loc_legend[996]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-44.44s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			      fprintf(fp," %-44.44s",loc_legend[996]);
			 }
			}
			else
			{
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				 {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-52.52s",loc_legend[996]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-52.52s",nd_desc_with_spl_chr.arr);
																																																			
				}
				else
			       fprintf(fp," %-52.52s",loc_legend[996]);
			}
			
			print_formated_amt(PkgTotalDiscount);
			fprintf(fp,"\n"); 
	      }
	
}



get_cashier_name()   
{

  nd_cashier_name.arr[0]='\0';
  nd_cashier_name.len	  =0; 

  

  /* EXEC SQL SELECT DISTINCT APPL_USER_NAME
  INTO  :nd_cashier_name
  FROM   SM_APPL_USER_LANG 
  WHERE  APPL_USER_ID=:v_user_id //:d_added_by_id changed for scrum crf-654
  AND	 LANGUAGE_ID  =:nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select distinct APPL_USER_NAME into :b0  from SM_APPL_USER_\
LANG where (APPL_USER_ID=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )3043;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_cashier_name;
  sqlstm.sqhstl[0] = (unsigned int  )502;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&v_user_id;
  sqlstm.sqhstl[1] = (unsigned int  )33;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  


 if (OERROR)
	  { 
		disp_message (ERR_MESG,"FETCH FAILED FROM SM_APPL_USER TABLE");
	  }
 
  nd_cashier_name.arr[nd_cashier_name.len]='\0';
   
}

/* Getting designation of cashier */

get_cashier_designation()
{
 
 
 nd_cahier_position.arr[0] ='\0';
 nd_cahier_position.len	   = 0;


 /* EXEC SQL EXECUTE
    
	DECLARE
    nd_func_role  VARCHAR2(3);
	
	BEGIN
		
		SELECT FUNC_ROLE 
		INTO nd_func_role
        FROM SM_APPL_USER_LANG_VW 
		WHERE  APPL_USER_ID=:d_added_by_id
        AND	 LANGUAGE_ID  =:nd_lang_id;

		IF nd_func_role='O' THEN

		SELECT long_desc 
		INTO :nd_cahier_position
		FROM sm_appl_user_lang_vw a,am_other_staff b,am_other_staff_type_lang_vw C
		WHERE a.appl_user_id=:d_added_by_id
		AND a.FUNC_ROLE='O'
		AND b.OTHER_STAFF_ID = a.FUNC_ROLE_ID
		AND c.OTHER_STAFF_TYPE = b.OTHER_STAFF_TYPE
		AND c.language_id=:nd_lang_id
		AND a.language_id=:nd_lang_id;

		END IF;



	END;

END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "declare nd_func_role VARCHAR2 ( 3 ) ; BEGIN SELECT FUNC_ROLE\
 INTO nd_func_role FROM SM_APPL_USER_LANG_VW WHERE APPL_USER_ID = :d_added_by_\
id AND LANGUAGE_ID = :nd_lang_id ; IF nd_func_role = 'O' THEN SELECT long_desc\
 INTO :nd_cahier_position FROM sm_appl_user_lang_vw a , am_other_staff b , am_\
other_staff_type_lang_vw C WHERE a . appl_user_id = :d_added_by_id AND a . FUN\
C_ROLE = 'O' AND b . OTHER_STAFF_ID = a . FUNC_ROLE_ID AND c . OTHER_STAFF_TYP\
E = b . OTHER_STAFF_TYPE AND c . language_id = :nd_lang_id AND a . language_id\
 = :nd_lang_id ; END IF ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3070;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_added_by_id;
 sqlstm.sqhstl[0] = (unsigned int  )102;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_cahier_position;
 sqlstm.sqhstl[2] = (unsigned int  )502;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
    
    nd_cahier_position.arr[nd_cahier_position.len]='\0';

 if (OERROR)
	  { 
		disp_message (ERR_MESG,"FETCH FAILED FROM SM_APPL_USER TABLE");
	  }

 
}  
get_pkg_name()  
{

  nd_package_code.arr[0]='\0';
  nd_package_code.len	  =0; 

// Added by Rajesh :nd_package_code value should come from bl_package_sub_hdr table

	/* EXEC SQL SELECT DISTINCT package_code 
	INTO :nd_package_code
	FROM BL_PACKAGE_SUB_HDR
	WHERE operating_facility_id = :nd_facility_id
	AND patient_id = :d_patient_id
	AND package_seq_no = :l_pkg_seq_num; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select distinct package_code into :b0  from BL_PACKAGE_SUB_H\
DR where ((operating_facility_id=:b1 and patient_id=:b2) and package_seq_no=:b\
3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3097;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_package_code;
 sqlstm.sqhstl[0] = (unsigned int  )12;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[2] = (unsigned int  )63;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&l_pkg_seq_num;
 sqlstm.sqhstl[3] = (unsigned int  )52;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




   if (OERROR)
	  { 
		disp_message (ERR_MESG,"FETCH FAILED FROM BL_PACKAGE_SUB_HDR TABLE");
	  }
 
    nd_package_code.arr[nd_package_code.len]='\0';

	if(nd_package_code.arr[0]!='\0')
	{
    
	  get_package_desc();

	} 

}
get_package_desc()
{
  nd_package_desc.arr[0]='\0';
  nd_package_desc.len	  =0; 

// Added by Rajesh on 10th feb 2010 :nd_package_desc value should come from BL_PACKAGE_LANG_VW table

  /* EXEC SQL SELECT long_desc
  INTO :nd_package_desc
  FROM BL_PACKAGE_LANG_VW
 WHERE operating_facility_id = :nd_facility_id
   AND language_id = :nd_lang_id
   AND package_code = :nd_package_code; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select long_desc into :b0  from BL_PACKAGE_LANG_VW where ((\
operating_facility_id=:b1 and language_id=:b2) and package_code=:b3)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )3128;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_package_desc;
  sqlstm.sqhstl[0] = (unsigned int  )102;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )5;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_package_code;
  sqlstm.sqhstl[3] = (unsigned int  )12;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



    if (OERROR)
	  { 
		disp_message (ERR_MESG,"FETCH FAILED FROM BL_PACKAGE_LANG_VW TABLE");
	  }
 
  nd_package_desc.arr[nd_package_desc.len]='\0';



}
print_alter_id_num(char pat_type)
{

  if(strcmp(nd_bill_format_id.arr,"1")==0)
  {
    if(strcmp(p_bill_addl_id_in_ftr_yn.arr,"Y")==0)
    {
	 if (strcmp(alt_id_no.arr,"\0")!=0)
      {
		 get_alter_type_desc();
		 
		 fprintf(fp,"\n%-s: %-s",l_alt_id_type_desc.arr,alt_id_no.arr);
		 lsr_line_cnt();
		 lsr_line_cnt();

      }
     if(strcmp(patient_name.arr,"\0")!=0)
	 {
	   fprintf(fp,"\n%-s: %-s\n",loc_legend[100],patient_name.arr);
	   lsr_line_cnt();
	   lsr_line_cnt();
	 }
     else
	 fprintf(fp,"\n");lsr_line_cnt();
	}
  }
  
  else
  {
    if ((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)||(strcmp(d_episode_type.arr,"R")==0))
	{
	 if((pat_type=='I' && (print_ins_addl_id_in_ftr_yn.arr[0]='Y'))||(pat_type =='C' && (print_ins_addl_id_in_ftr_yn.arr[0]='Y')))
 	 {
	  if (strcmp(alt_id_no.arr,"\0")!=0)
	   {
	     get_alter_type_desc();
		 
		 fprintf(fp,"\n%-s: %-s",l_alt_id_type_desc.arr,alt_id_no.arr);
		 lsr_line_cnt();
		 lsr_line_cnt();
	   } 
	   if(strcmp(patient_name.arr,"\0")!=0)
	   {
	     if (l_lsr != 0 && l_dmp == 0)
		 fprintf(fp,"\n%-s: %-s\n",loc_legend[100],patient_name.arr);
	     else
		 fprintf(fp,"\n%-12.12s: %-s\n"," ",patient_name.arr);
		 lsr_line_cnt();
	     lsr_line_cnt();
	   }
	   else
	   fprintf(fp,"\n");lsr_line_cnt();
	 }
	}
	else
	{
	  if((pat_type=='I' && (ip_ins_addl_id_in_ftr_yn.arr[0]='Y'))||(pat_type =='C' && (ip_cr_addl_id_in_ftr_yn.arr[0]='Y')))
      { 
	   if (strcmp(alt_id_no.arr,"\0")!=0)
	   {
	     get_alter_type_desc();
		 
		 fprintf(fp,"\n%-s: %-s",l_alt_id_type_desc.arr,alt_id_no.arr);
		 lsr_line_cnt();
		 lsr_line_cnt();
	   } 
	   if(strcmp(patient_name.arr,"\0")!=0)
	   {
	     
		 if (l_lsr != 0 && l_dmp == 0)
		 fprintf(fp,"\n%-s: %-s\n",loc_legend[100],patient_name.arr);
		 else
		 fprintf(fp,"\n%-12.12s: %-s\n"," ",patient_name.arr);
	     lsr_line_cnt();
	     lsr_line_cnt();
	   }
	   else
	   fprintf(fp,"\n");lsr_line_cnt();
	  }
	  
	}
  } 
  
} 
get_alter_type_desc()
{
		l_alt_id_type_desc.arr[0] ='\0';
		l_alt_id_type_desc.len=0;

		if (strcmp(alt_id_type.arr,"****")==0)  /***added by vani for crf-518 *****/
		{
			/* EXEC SQL select decode(ACCEPT_NATIONAL_ID_NO_YN,'Y',NAT_ID_PROMPT,'')
					INTO  l_alt_id_type_desc
					FROM MP_PARAM; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select decode(ACCEPT_NATIONAL_ID_NO_YN,'Y',NAT_ID_PROMPT,'\
') into :b0  from MP_PARAM ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )3159;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&l_alt_id_type_desc;
   sqlstm.sqhstl[0] = (unsigned int  )302;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			if(OERROR)
			{ 
			disp_message (ERR_MESG,"FETCH FAILED FROM MP_PARAM TABLE");
			}
		}
		else 
		{
			/* EXEC SQL SELECT SHORT_DESC
              INTO  l_alt_id_type_desc
              FROM  MP_ALTERNATE_ID_TYPE_LANG_VW
              WHERE Upper(LANGUAGE_ID)=Upper(:nd_lang_id)
              AND   ALT_ID_TYPE=:alt_id_type; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select SHORT_DESC into :b0  from MP_ALTERNATE_ID_TYPE_LANG\
_VW where (Upper(LANGUAGE_ID)=Upper(:b1) and ALT_ID_TYPE=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )3178;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&l_alt_id_type_desc;
   sqlstm.sqhstl[0] = (unsigned int  )302;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[1] = (unsigned int  )6;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&alt_id_type;
   sqlstm.sqhstl[2] = (unsigned int  )7;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		

			if(OERROR)
			{ 
			disp_message (ERR_MESG,"FETCH FAILED FROM MP_ALTERNATE_ID_TYPE_LANG_VW TABLE");
			}
	    }

 
		 l_alt_id_type_desc.arr[l_alt_id_type_desc.len]='\0';
}
print_sign_designation()
{
  
 get_bill_format();

 if (strcmp(nd_bill_format_id.arr,"1")==0)
 {

	  fprintf(fp,"\n\n");lsr_line_cnt();lsr_line_cnt();
	  fprintf(fp,"%-37.37s %23.23s----------------------------\n"," ",loc_legend[1170]);
	  lsr_line_cnt();

	  if (l_lsr != 0 && l_dmp == 0)
	   {
	   if( l_logo_yniflaser.arr[0] != 'Y')
		fprintf(fp,"%-51.51s %-s :"," ",loc_legend[1180]); //Prepared By legend Has Moved Down by vani and only for laser printer it has to be print
		}

	  lsr_line_cnt();
	  if (l_lsr != 0 && l_dmp == 0)
	   {
	  fprintf(fp,"(%-s%-s\n",nd_cashier_name.arr,")");
	  }
	  else
	  {
	  fprintf(fp,"(%-60s.60s%-s\n",nd_cashier_name.arr,")");
	  }
	  lsr_line_cnt();
	  
	  if (strcmp(nd_cahier_position.arr,"\0")!=0)
	  {
	  fprintf(fp," %50.50s %-9.9s %-60.60s\n"," ",loc_legend[1190],nd_cahier_position.arr);
	  lsr_line_cnt();
	  }
	  /*
	  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
	  {
		fprintf(fp,"\n%-64.64s %-s  %-s %-s\n"," ",loc_legend[1425],nd_curr_date_t.arr,loc_legend[1424]);
	  }
	  */
	}
  else 
    {
	if(nd_print_option.arr[0]=='R')
	fun_bl_report_temp_format();
	else
	fprintf(fp,"\n");
	print_bill_footer();
	if (d_cust_code.arr[0]!='\0')
	{
	  if (d_Policy_type_code.arr[0]!='\0')
	 {
		fun_package_enable_yn();
		if (package_enable_yn.arr[0] == 'Y')
		 {
		  fprintf(fp,"%-20s: \n",loc_legend[1443]);
		  prt_line_uc();
		  fprintf(fp,"\n");
		  fprintf(fp,"\n%-20.20s %-20.20s %-14.14s %-15.15s %-14.14s %-21.21s \n",loc_legend[1444],loc_legend[1445],loc_legend[1446],loc_legend[1447],loc_legend[1448],loc_legend[1449]);
		  prt_line_uc();
		  while(fetch_payer_approval())
		  {
		  	
			if (d_pk_short_desc.arr[0]!='\0')
		    {	
		  		fprintf(fp,"\n%-20.20s %-20.20s %-10.10s ",d_pk_short_desc.arr,d_pk_credit_auth_ref.arr,d_pk_credit_auth_dt.arr);
				print_formated_amt(d_pk_pack_amount);
				print_formated_amt(d_pk_appr_amount);
				print_formated_amt(d_pk_approval_amount);     
				fprintf(fp,"\n");  
			  }
         else
		   {
		    fprintf(fp,"\n%-20.20s %-20.20s %-10.10s %17.17s",d_pk_short_desc.arr,d_pk_credit_auth_ref.arr,d_pk_credit_auth_dt.arr," ");
			
			print_formated_amt(d_pk_appr_amount);
			fprintf(fp,"\n");  
			}

		   }
		  prt_line_uc();
		  fprintf(fp,"\n");
		  }  //End if of package_enable_yn==Y 

           print_ins_bill_footer(); 
	    } // End if of d_Policy_type_code.arr[0]!='\0'
		else
	    print_credit_bill_footer();  
		 } 
	 
	 
	}

  
}

get_logo_dtl()
{
	
	  l_logo_yniflaser.arr[0] = 'N';

	  l_errorlevel.arr[0] = '\0';
	  l_errorlevel.len = 0;

	  l_sysmessageid.arr[0] = '\0';
	  l_sysmessageid.len = 0;

	  l_errortext.arr[0] = '\0';
	  l_errortext.len = 0;
			

	   if (l_lsr != 0 && l_dmp == 0)
	   {
		/* EXEC SQL EXECUTE	
		BEGIN					
			
			BLOPIN.GET_PRINT_SETUP_COL_VALUE(
				:nd_facility_id,
				'BLR00101' ,//'BLRVSBL1', CHANGED FOR scrum CRF-654
				'PRINT_LOGO_YN_IF_LASER',
				:l_logo_yniflaser,
				:l_errorlevel,
				:l_sysmessageid,
				:l_errortext) ;
				
			:l_logo_yniflaser := nvl(:l_logo_yniflaser,'N');

			if  :l_sysmessageid is not null then
				:l_errorlevel := '10';
				:l_errortext := blcommon.get_error_text(:l_sysmessageid);
			end if;

		END;
		END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 47;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "begin BLOPIN . GET_PRINT_SETUP_COL_VALUE ( :nd_facility_id \
, 'BLR00101' , 'PRINT_LOGO_YN_IF_LASER' , :l_logo_yniflaser , :l_errorlevel , \
:l_sysmessageid , :l_errortext ) ; :l_logo_yniflaser := nvl ( :l_logo_yniflase\
r , 'N' ) ; if :l_sysmessageid is not null then :l_errorlevel := '10' ; :l_err\
ortext := blcommon . get_error_text ( :l_sysmessageid ) ; end if ; END ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )3205;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[0] = (unsigned int  )5;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&l_logo_yniflaser;
  sqlstm.sqhstl[1] = (unsigned int  )1002;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&l_errorlevel;
  sqlstm.sqhstl[2] = (unsigned int  )12;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&l_sysmessageid;
  sqlstm.sqhstl[3] = (unsigned int  )12;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&l_errortext;
  sqlstm.sqhstl[4] = (unsigned int  )1002;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if (strcmp(l_errorlevel.arr,"10") == 0 && l_errortext.arr[0] != '\0')
		{
			disp_message(ERR_MESG,l_errortext.arr);
			proc_exit(0);
		}

		l_errorlevel.arr[0] = '\0';
		l_errorlevel.len = 0;

		l_sysmessageid.arr[0] = '\0';
		l_sysmessageid.len = 0;

		l_errortext.arr[0] = '\0';
		l_errortext.len = 0;
	
		
		if (l_logo_yniflaser.arr[0] == 'Y')
		{
			/* EXEC SQL EXECUTE	
			BEGIN				
				BLOPIN.GET_PRINT_SETUP_COL_VALUE(
					:nd_facility_id,
					'BLRBILLO',
					'LOGO_NAME',
					:l_logo_name,
					:l_errorlevel,
					:l_sysmessageid,
					:l_errortext) ;
				

				if :l_sysmessageid is not null then
					:l_errorlevel := '10';
					:l_errortext := blcommon.get_error_text(:l_sysmessageid);
				end if;

			END;
			END-EXEC; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "begin BLOPIN . GET_PRINT_SETUP_COL_VALUE ( :nd_facility_id\
 , 'BLRBILLO' , 'LOGO_NAME' , :l_logo_name , :l_errorlevel , :l_sysmessageid ,\
 :l_errortext ) ; if :l_sysmessageid is not null then :l_errorlevel := '10' ; \
:l_errortext := blcommon . get_error_text ( :l_sysmessageid ) ; end if ; END ;";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )3240;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )5;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_logo_name;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&l_errorlevel;
   sqlstm.sqhstl[2] = (unsigned int  )12;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&l_sysmessageid;
   sqlstm.sqhstl[3] = (unsigned int  )12;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&l_errortext;
   sqlstm.sqhstl[4] = (unsigned int  )1002;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			if (strcmp(l_errorlevel.arr,"10") == 0 && l_errortext.arr[0] != '\0')
			{
				disp_message(ERR_MESG,l_errortext.arr);
				proc_exit(0);
			}

			LOGO_DIR.arr[0] = '\0';
			LOGO_DIR.len = 0;

		       l_errorlevel.arr[0] = '\0';
		       l_errorlevel.len = 0;

		       l_sysmessageid.arr[0] = '\0';
		       l_sysmessageid.len = 0;

		       l_errortext.arr[0] = '\0';
		       l_errortext.len = 0;	

			if (nd_online_print_yn == 'N')
			{			
				/* EXEC SQL EXECUTE	
				BEGIN				
					WORKSTATION.GET_WS_PARAM(
						:nd_ws_no,				
						'BLLOGODIR',
						:LOGO_DIR,
						:l_errortext);			
					if :l_errortext is not null then 
						:l_errortext	:= 'BLLOGODIR:'||:l_errortext;
					end if;

				END;
				END-EXEC; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 47;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "begin WORKSTATION . GET_WS_PARAM ( :nd_ws_no , 'BLLOGODIR\
' , :LOGO_DIR , :l_errortext ) ; if :l_errortext is not null then :l_errortext\
 := 'BLLOGODIR:' || :l_errortext ; end if ; END ;";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )3275;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_ws_no;
    sqlstm.sqhstl[0] = (unsigned int  )42;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&LOGO_DIR;
    sqlstm.sqhstl[1] = (unsigned int  )1002;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&l_errortext;
    sqlstm.sqhstl[2] = (unsigned int  )1002;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


				if (l_errortext.arr[0] != '\0')
				{
					disp_message(ERR_MESG,l_errortext.arr);
					proc_exit(0);
				}		
			}
		}
	    }
   }

get_print_routing()
{
	/* EXEC SQL EXECUTE
	DECLARE
		l_sys_mesg_id VARCHAR2(10);
		l_err_level VARCHAR2(10);
		l_err_text VARCHAR2(1000);
		l_document_value blcommon.rectype_Tab;
		l_format_type VARCHAR2(200);
		l_report_tool_ind VARCHAR2(1);
	BEGIN
	
		blcommon.get_doc_print_format_Tab(
     			:nd_facility_id,
			:nd_calling_pgm_id,
			l_document_value,
			l_sys_mesg_id,
			l_err_level,
			l_err_text);						

		FOR i IN l_document_value.FIRST..l_document_value.LAST LOOP
			if  l_document_value(i).id = 'FORMAT_TYPE' then
				l_format_type := l_document_value(i).value;
			end if;				
			
			if l_document_value(i).id = 'REPORT_TOOL_IND' then 
				l_report_tool_ind := l_document_value(i).value;
			end if;		 	

			if l_document_value(i).id = 'INCL_PRV_RFND_AMT_IN_TOT_OUTST' then 
				:l_include_refund := NVL(l_document_value(i).value,'N');
			end if;		 			
		END LOOP;		

		if l_format_type = 'DMP_PREPRINTED' then
			:l_dmp := 1;
			:l_lsr := 0;
		elsif l_format_type in('LASER_WITH_LOGO','LASER_WITHOUT_LOGO') then
			:l_dmp := 0;
			:l_lsr := 1;
		else
			:l_dmp := 0;
			:l_lsr := 0;
		end if;
		
		if :l_dmp = 0 and :l_lsr = 0 then

			APPPRINT.GET_ROUTING_PRINTERS(
			 :nd_ws_no,
			 :d_cashfacility_id,
			 'BL',
			 :nd_calling_pgm_id,
			 'O',
			 ' ',
			 :l_printer_ids,
			 :l_printer_names,
			 :l_printer_types, 
			 :l_queue_names,
			 :l_no_of_copies,
			 :l_errortext);

			 :l_dmp := NVL(instr(:l_printer_types,'D'),0);
			 :l_lsr := NVL(instr(:l_printer_types,'S'),0);			 

			 if :l_dmp != 0 and :l_lsr != 0 then 
			    :l_dmp := 0;
			    --if there is a laser setup, then output format will be laser
			 end if;	

			 if :l_dmp = 0 and :l_lsr = 0 then 
			    :l_lsr := 1;
			    --Default is Laser Format
			 end if;	 		 
		end if;

END;
END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlbuft((void **)0, 
   "declare l_sys_mesg_id VARCHAR2 ( 10 ) ; l_err_level VARCHAR2 ( 10 ) ; l_\
err_text VARCHAR2 ( 1000 ) ; l_document_value blcommon . rectype_Tab ; l_for\
mat_type VARCHAR2 ( 200 ) ; l_report_tool_ind VARCHAR2 ( 1 ) ; BEGIN blcommo\
n . get_doc_print_format_Tab ( :nd_facility_id , :nd_calling_pgm_id , l_docu\
ment_value , l_sys_mesg_id , l_err_level , l_err_text ) ; FOR i IN l_documen\
t_value . FIRST .. l_document_value . LAST LOOP if l_document_value ( i ) . \
id = 'FORMAT_TYPE' then l_format_type := l_document_value ( i ) . value ; en\
d if ; if l_document_value ( i ) . id = 'REPORT_TOOL_IND' then l_report_tool\
_ind := l_document_value ( i ) . value ; end if ; if l_document_value ( i ) \
. id = 'INCL_PRV_RFND_AMT_IN_TOT_OUTST' then :l_include_refund := NVL ( l_do\
cument_value ( i ) . value , 'N' ) ; end if ; END LOOP ; if l_format_type = \
'DMP_PREPRINTED' then :l_dmp := 1 ; :l_lsr := 0 ; elsif l_format_type in ( '\
LASER_WITH_LOGO' , 'LASER_WITHOUT_LOGO' ) then :l_dmp := 0 ; :l_lsr := 1 ; e\
lse :l_dmp := 0 ; :l_lsr := 0 ; end if ;");
 sqlstm.stmt = " if :l_dmp = 0 and :l_lsr = 0 then APPPRINT . GET_ROUTING_PR\
INTERS ( :nd_ws_no , :d_cashfacility_id , 'BL' , :nd_calling_pgm_id , 'O' , ' \
' , :l_printer_ids , :l_printer_names , :l_printer_types , :l_queue_names , :l\
_no_of_copies , :l_errortext ) ; :l_dmp := NVL ( instr ( :l_printer_types , 'D\
' ) , 0 ) ; :l_lsr := NVL ( instr ( :l_printer_types , 'S' ) , 0 ) ; if :l_dmp\
 != 0 and :l_lsr != 0 then :l_dmp := 0 ; end if ; if :l_dmp = 0 and :l_lsr = 0\
 then :l_lsr := 1 ; end if ; end if ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3302;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[0] = (unsigned int  )5;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_calling_pgm_id;
 sqlstm.sqhstl[1] = (unsigned int  )12;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&l_include_refund;
 sqlstm.sqhstl[2] = (unsigned int  )1;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&l_dmp;
 sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&l_lsr;
 sqlstm.sqhstl[4] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&nd_ws_no;
 sqlstm.sqhstl[5] = (unsigned int  )42;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_cashfacility_id;
 sqlstm.sqhstl[6] = (unsigned int  )5;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&l_printer_ids;
 sqlstm.sqhstl[7] = (unsigned int  )1002;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&l_printer_names;
 sqlstm.sqhstl[8] = (unsigned int  )1002;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&l_printer_types;
 sqlstm.sqhstl[9] = (unsigned int  )1002;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&l_queue_names;
 sqlstm.sqhstl[10] = (unsigned int  )1002;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&l_no_of_copies;
 sqlstm.sqhstl[11] = (unsigned int  )1002;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&l_errortext;
 sqlstm.sqhstl[12] = (unsigned int  )1002;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		if ( l_errortext.arr[0] != '\0')
		{
			l_errortext.arr[0] = '\0';
			l_errortext.len = 0;
		}

}

get_print_net_gross()
{
	//Modified by Harish against the instructions from Mr. Kuila 
	//Date - 06/11/2003 Point # 18 - Customization document.
	l_bill_print_opt_for_disc_print=0;
	
	/* EXEC SQL SELECT bill_print_opt_for_disc_print
	           INTO :l_bill_print_opt_for_disc_print
	           FROM bl_parameters
			  WHERE operating_facility_id = :nd_facility_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 47;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select bill_print_opt_for_disc_print into :b0  from bl_param\
eters where operating_facility_id=:b1";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3369;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_bill_print_opt_for_disc_print;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   if (OERROR)
        err_mesg("SELECT failed on table BL_PARAMETERS",0,"");

   if (NODATAFOUND)
        err_mesg("No Record found in BL_PARAMETERS",0,"");

	//This option will be used while the bill is printed form 
	//Print Visit Bill - No Discount option.
	if(strcmp(l_print_without_disc_func.arr,"1")==0)
	{
		l_bill_print_opt_for_disc_print=3;
	}
}


/* Procedure Part */

fetch_sy_prog_param()
{


   l_detail_report_flag.arr[0]      = '\0';
   l_print_without_disc_func.arr[0] = '\0';
   l_no_settlement_details.arr[0]   = '\0';  
   l_only_print_discount.arr[0]		= '\0'; 
   nd_ws_no.arr[0]                  = '\0';
   nd_ws_no.len                     = 0;
   nd_logo_pgm_id.arr[0]	        = '\0';
   nd_logo_pgm_id.len	            = 0;
	v_detail_report.arr[0]='\0'; //added for scrum crf-654
	v_user_id.arr[0]='\0'; //added for scrum crf-654
   
   
   
   /* EXEC SQL SELECT  OPERATING_FACILITY_ID,PARAM1,NVL(PARAM2,0),PARAM3,
					NVL(PARAM4,99999999), PARAM5,PARAM6,PARAM7,PARAM8,
					'Y',NVL(PARAM10,'N'),PARAM20,PARAM21,
					NVL(PARAM22,operating_facility_id), NVL(PARAM30,'Y'),
					PARAM14, PARAM15, PARAM24,    --NVL(PARAM25,'N'),
					PARAM29,
					PARAM28,
					nvl(PARAM11,'N'),  //added by vani 
					PARAM9, //param9 added for scrum crf-654
					PARAM30 //param9 added for scrum crf-654

             INTO  :nd_facility_id,:nd_fm_doc_type,:nd_fm_doc_num,
                   :nd_to_doc_type,:nd_to_doc_num, 
   				   :nd_fm_doc_date,:nd_to_doc_date,
   				   :trx_type,:nd_reprint_yn,:discount_print_yn, 
				   :sett_print_yn,:p_cash_counter,:p_shift,
				   :d_cashfacility_id, :nd_online_print_yn,
				   :l_detail_report_flag, :l_print_without_disc_func,
				   :l_no_settlement_details,
				   :nd_ws_no,
				   :nd_logo_pgm_id,
				   :l_only_print_discount,
					:v_detail_report, // v_detail_report added for scrum crf-654
					:v_user_id // v_user_id added for scrum crf-654

              FROM SY_PROG_PARAM
			 //WHERE PGM_ID     = 'BLRVSBIL' //ADDED FOR SCRUM CRF-654
			  WHERE PGM_ID     = 'BLR00101'
              AND SESSION_ID = :nd_session_id
			  AND PGM_DATE   = :nd_pgm_date; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 47;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select OPERATING_FACILITY_ID ,PARAM1 ,NVL(PARAM2,0) ,PARAM\
3 ,NVL(PARAM4,99999999) ,PARAM5 ,PARAM6 ,PARAM7 ,PARAM8 ,'Y' ,NVL(PARAM10,'N')\
 ,PARAM20 ,PARAM21 ,NVL(PARAM22,operating_facility_id) ,NVL(PARAM30,'Y') ,PARA\
M14 ,PARAM15 ,PARAM24 ,PARAM29 ,PARAM28 ,nvl(PARAM11,'N') ,PARAM9 ,PARAM30 int\
o :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16,:\
b17,:b18,:b19,:b20,:b21,:b22  from SY_PROG_PARAM where ((PGM_ID='BLR00101' and\
 SESSION_ID=:b23) and PGM_DATE=:b24)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )3392;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[0] = (unsigned int  )5;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_fm_doc_type;
   sqlstm.sqhstl[1] = (unsigned int  )33;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_fm_doc_num;
   sqlstm.sqhstl[2] = (unsigned int  )33;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_to_doc_type;
   sqlstm.sqhstl[3] = (unsigned int  )33;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&nd_to_doc_num;
   sqlstm.sqhstl[4] = (unsigned int  )33;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&nd_fm_doc_date;
   sqlstm.sqhstl[5] = (unsigned int  )14;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&nd_to_doc_date;
   sqlstm.sqhstl[6] = (unsigned int  )33;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&trx_type;
   sqlstm.sqhstl[7] = (unsigned int  )4;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&nd_reprint_yn;
   sqlstm.sqhstl[8] = (unsigned int  )1;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&discount_print_yn;
   sqlstm.sqhstl[9] = (unsigned int  )1;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&sett_print_yn;
   sqlstm.sqhstl[10] = (unsigned int  )1;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&p_cash_counter;
   sqlstm.sqhstl[11] = (unsigned int  )9;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqhstv[12] = (         void  *)&p_shift;
   sqlstm.sqhstl[12] = (unsigned int  )4;
   sqlstm.sqhsts[12] = (         int  )0;
   sqlstm.sqindv[12] = (         void  *)0;
   sqlstm.sqinds[12] = (         int  )0;
   sqlstm.sqharm[12] = (unsigned int  )0;
   sqlstm.sqadto[12] = (unsigned short )0;
   sqlstm.sqtdso[12] = (unsigned short )0;
   sqlstm.sqhstv[13] = (         void  *)&d_cashfacility_id;
   sqlstm.sqhstl[13] = (unsigned int  )5;
   sqlstm.sqhsts[13] = (         int  )0;
   sqlstm.sqindv[13] = (         void  *)0;
   sqlstm.sqinds[13] = (         int  )0;
   sqlstm.sqharm[13] = (unsigned int  )0;
   sqlstm.sqadto[13] = (unsigned short )0;
   sqlstm.sqtdso[13] = (unsigned short )0;
   sqlstm.sqhstv[14] = (         void  *)&nd_online_print_yn;
   sqlstm.sqhstl[14] = (unsigned int  )1;
   sqlstm.sqhsts[14] = (         int  )0;
   sqlstm.sqindv[14] = (         void  *)0;
   sqlstm.sqinds[14] = (         int  )0;
   sqlstm.sqharm[14] = (unsigned int  )0;
   sqlstm.sqadto[14] = (unsigned short )0;
   sqlstm.sqtdso[14] = (unsigned short )0;
   sqlstm.sqhstv[15] = (         void  *)&l_detail_report_flag;
   sqlstm.sqhstl[15] = (unsigned int  )5;
   sqlstm.sqhsts[15] = (         int  )0;
   sqlstm.sqindv[15] = (         void  *)0;
   sqlstm.sqinds[15] = (         int  )0;
   sqlstm.sqharm[15] = (unsigned int  )0;
   sqlstm.sqadto[15] = (unsigned short )0;
   sqlstm.sqtdso[15] = (unsigned short )0;
   sqlstm.sqhstv[16] = (         void  *)&l_print_without_disc_func;
   sqlstm.sqhstl[16] = (unsigned int  )6;
   sqlstm.sqhsts[16] = (         int  )0;
   sqlstm.sqindv[16] = (         void  *)0;
   sqlstm.sqinds[16] = (         int  )0;
   sqlstm.sqharm[16] = (unsigned int  )0;
   sqlstm.sqadto[16] = (unsigned short )0;
   sqlstm.sqtdso[16] = (unsigned short )0;
   sqlstm.sqhstv[17] = (         void  *)&l_no_settlement_details;
   sqlstm.sqhstl[17] = (unsigned int  )7;
   sqlstm.sqhsts[17] = (         int  )0;
   sqlstm.sqindv[17] = (         void  *)0;
   sqlstm.sqinds[17] = (         int  )0;
   sqlstm.sqharm[17] = (unsigned int  )0;
   sqlstm.sqadto[17] = (unsigned short )0;
   sqlstm.sqtdso[17] = (unsigned short )0;
   sqlstm.sqhstv[18] = (         void  *)&nd_ws_no;
   sqlstm.sqhstl[18] = (unsigned int  )42;
   sqlstm.sqhsts[18] = (         int  )0;
   sqlstm.sqindv[18] = (         void  *)0;
   sqlstm.sqinds[18] = (         int  )0;
   sqlstm.sqharm[18] = (unsigned int  )0;
   sqlstm.sqadto[18] = (unsigned short )0;
   sqlstm.sqtdso[18] = (unsigned short )0;
   sqlstm.sqhstv[19] = (         void  *)&nd_logo_pgm_id;
   sqlstm.sqhstl[19] = (unsigned int  )1002;
   sqlstm.sqhsts[19] = (         int  )0;
   sqlstm.sqindv[19] = (         void  *)0;
   sqlstm.sqinds[19] = (         int  )0;
   sqlstm.sqharm[19] = (unsigned int  )0;
   sqlstm.sqadto[19] = (unsigned short )0;
   sqlstm.sqtdso[19] = (unsigned short )0;
   sqlstm.sqhstv[20] = (         void  *)&l_only_print_discount;
   sqlstm.sqhstl[20] = (unsigned int  )4;
   sqlstm.sqhsts[20] = (         int  )0;
   sqlstm.sqindv[20] = (         void  *)0;
   sqlstm.sqinds[20] = (         int  )0;
   sqlstm.sqharm[20] = (unsigned int  )0;
   sqlstm.sqadto[20] = (unsigned short )0;
   sqlstm.sqtdso[20] = (unsigned short )0;
   sqlstm.sqhstv[21] = (         void  *)&v_detail_report;
   sqlstm.sqhstl[21] = (unsigned int  )5;
   sqlstm.sqhsts[21] = (         int  )0;
   sqlstm.sqindv[21] = (         void  *)0;
   sqlstm.sqinds[21] = (         int  )0;
   sqlstm.sqharm[21] = (unsigned int  )0;
   sqlstm.sqadto[21] = (unsigned short )0;
   sqlstm.sqtdso[21] = (unsigned short )0;
   sqlstm.sqhstv[22] = (         void  *)&v_user_id;
   sqlstm.sqhstl[22] = (unsigned int  )33;
   sqlstm.sqhsts[22] = (         int  )0;
   sqlstm.sqindv[22] = (         void  *)0;
   sqlstm.sqinds[22] = (         int  )0;
   sqlstm.sqharm[22] = (unsigned int  )0;
   sqlstm.sqadto[22] = (unsigned short )0;
   sqlstm.sqtdso[22] = (unsigned short )0;
   sqlstm.sqhstv[23] = (         void  *)&nd_session_id;
   sqlstm.sqhstl[23] = (unsigned int  )18;
   sqlstm.sqhsts[23] = (         int  )0;
   sqlstm.sqindv[23] = (         void  *)0;
   sqlstm.sqinds[23] = (         int  )0;
   sqlstm.sqharm[23] = (unsigned int  )0;
   sqlstm.sqadto[23] = (unsigned short )0;
   sqlstm.sqtdso[23] = (unsigned short )0;
   sqlstm.sqhstv[24] = (         void  *)&nd_pgm_date;
   sqlstm.sqhstl[24] = (unsigned int  )15;
   sqlstm.sqhsts[24] = (         int  )0;
   sqlstm.sqindv[24] = (         void  *)0;
   sqlstm.sqinds[24] = (         int  )0;
   sqlstm.sqharm[24] = (unsigned int  )0;
   sqlstm.sqadto[24] = (unsigned short )0;
   sqlstm.sqtdso[24] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


              
   if (OERROR)
        err_mesg("SELECT failed on table SY_PROG_PARAM",0,"");

   
   if (NODATAFOUND)
        err_mesg("No Record found in SY_PROG_PARAM",0,"");


   nd_facility_id.arr[nd_facility_id.len]				= '\0';
   nd_fm_doc_type.arr[nd_fm_doc_type.len]				= '\0';
   nd_fm_doc_num.arr[nd_fm_doc_num.len]					= '\0';
   nd_to_doc_type.arr[nd_to_doc_type.len]				= '\0';
   nd_to_doc_num.arr[nd_to_doc_num.len]					= '\0';
   nd_fm_doc_date.arr[nd_fm_doc_date.len]				= '\0';
   nd_to_doc_date.arr[nd_to_doc_date.len]				= '\0';
   d_cashfacility_id.arr[d_cashfacility_id.len]			= '\0';
   p_cash_counter.arr[p_cash_counter.len]				= '\0';
   p_shift.arr[p_shift.len]  							= '\0';
   trx_type.arr[trx_type.len]	  						= '\0';
   l_detail_report_flag.arr[l_detail_report_flag.len]	= '\0';
   l_print_without_disc_func.arr[l_print_without_disc_func.len]	= '\0';
   l_no_settlement_details.arr[l_no_settlement_details.len] = '\0';
   nd_ws_no.arr[nd_ws_no.len] = '\0';
   nd_logo_pgm_id.arr[nd_logo_pgm_id.len]		= '\0';

   	    v_detail_report.arr[v_detail_report.len]='\0'; //added for scrum crf-654   	   	
	strcpy(g_facility_id,nd_facility_id.arr);



}

fetch_bill_format()
{

p_gross_net_amt_ind.arr[0]				= '\0';              
p_serv_disc_on_gross_ind.arr[0]			= '\0';            
p_all_oth_adj_amt_row_ind.arr[0]		= '\0';           
p_bill_disc_sep_row_yn.arr[0]			= '\0';              
p_bill_adj_sep_row_yn.arr[0]			= '\0';               
p_bill_exm_sep_row_yn.arr[0]			= '\0';               
p_bill_wo_sep_row_yn.arr[0]				= '\0';                
p_oth_payers_amt_print_row_ind.arr[0]	= '\0';      
p_patient_amt_print_row_ind.arr[0]		= '\0';         
p_bill_net_payable_ind.arr[0]			= '\0'; 
p_addl_charge_amt_ind .arr[0]			= '\0';
p_excl_addl_charge_yn.arr[0]			= '\0';  
p_servdate_in_dtlformat_yn.arr[0]		= '\0'; 
p_disc_amt_in_dtl_yn.arr[0]				= '\0';            
c_gross_net_amt_ind.arr[0]				= '\0';                 
c_serv_disc_on_gross_ind.arr[0]			= '\0';            
c_all_oth_adj_amt_ind.arr[0]			= '\0';               
c_bill_disc_sep_row_yn.arr[0]			= '\0';              
c_bill_adj_sep_row_yn.arr[0]			= '\0';               
c_bill_exm_sep_row_yn.arr[0]			= '\0';               
c_bill_wo_sep_row_yn.arr[0]				= '\0';                
c_oth_payers_amt_print_row_ind.arr[0]	= '\0';      
c_bill_subsidized_amt_ind.arr[0]		= '\0';           
c_bill_net_payable_ind.arr[0]			= '\0'; 
c_addl_charge_amt_ind.arr[0]			= '\0';
c_excl_addl_charge_yn.arr[0]			= '\0'; 
c_servdate_in_dtlformat_yn.arr[0]		= '\0'; 
c_disc_amt_in_dtl_yn.arr[0]				= '\0';
p_print_zero_disc_column_yn.arr[0]		= '\0'; 
c_print_zero_disc_column_yn.arr[0]		= '\0'; 
p_print_zero_adcharg_column_yn.arr[0]	= '\0';
c_print_zero_adcharg_column_yn.arr[0]	= '\0';  
c_print_zero_subsid_column_yn.arr[0]	= '\0';  
p_bill_addl_id_in_ftr_yn.arr[0]			= '\0';     
p_serv_desc_sep_line_yn.arr[0]			= '\0'; 
c_serv_desc_sep_line_yn.arr[0]			= '\0';    
status.arr[0]							= '\0'; 
p_print_legend_yn.arr[0]				= '\0';
c_print_legend_yn.arr[0]				= '\0';   
                          


 /* EXEC SQL SELECT         
			P_GROSS_NET_AMT_IND,              
			P_SERV_DISC_ON_GROSS_IND,         
			P_ALL_OTH_ADJ_AMT_ROW_IND,        
			P_BILL_DISC_SEP_ROW_YN,           
			P_BILL_ADJ_SEP_ROW_YN,            
			P_BILL_EXM_SEP_ROW_YN,            
			P_BILL_WO_SEP_ROW_YN,             
			P_OTH_PAYERS_AMT_PRINT_ROW_IND,   
			P_PATIENT_AMT_PRINT_ROW_IND,      
			P_BILL_NET_PAYABLE_IND,
			P_ADDL_CHARGE_AMT_IND,
			P_EXCL_ADDL_CHARGE_YN,
			P_SERVDATE_IN_DTLFORMAT_YN, 
			P_DISC_AMT_IN_DTL_YN,           
			C_GROSS_NET_AMT_IND,              
			C_SERV_DISC_ON_GROSS_IND,         
			C_ALL_OTH_ADJ_AMT_IND,            
			C_BILL_DISC_SEP_ROW_YN,           
			C_BILL_ADJ_SEP_ROW_YN,            
			C_BILL_EXM_SEP_ROW_YN,            
			C_BILL_WO_SEP_ROW_YN,             
			C_OTH_PAYERS_AMT_PRINT_ROW_IND,   
			C_BILL_SUBSIDIZED_AMT_IND,        
			C_BILL_NET_PAYABLE_IND, 
			C_ADDL_CHARGE_AMT_IND,
			C_EXCL_ADDL_CHARGE_YN,  
			C_SERVDATE_IN_DTLFORMAT_YN,
			C_DISC_AMT_IN_DTL_YN,                    
			STATUS,
			C_PRINT_SERV_DATE_WITH_TIME_YN,
			C_PRINT_ZERO_OTHER_ADJ_YN,	
			C_PRINT_ZERO_DISC_COLUMN_YN,	
			C_QTY_IN_DTLFORMAT_YN,
			C_RATE_IN_DTLFORMAT_YN,		
			P_PRINT_SERV_DATE_WITH_TIME_YN,
			P_PRINT_ZERO_OTHER_ADJ_YN,	
			P_PRINT_ZERO_DISC_COLUMN_YN,
			P_QTY_IN_DTLFORMAT_YN,
			P_RATE_IN_DTLFORMAT_YN,
			P_PRINT_ZERO_ADCHARG_COLUMN_YN,
			C_PRINT_ZERO_ADCHARG_COLUMN_YN,
			c_print_zero_subsid_column_yn,
			P_BILL_ADDL_ID_IN_FTR_YN,
			P_SERV_DESC_SEP_LINE_YN,
			C_SERV_DESC_SEP_LINE_YN	,
			P_PRINT_SEPARATOR_LINE,
			C_PRINT_SEPARATOR_LINE,
			C_PRINT_LEGEND_YN,
			P_PRINT_LEGEND_YN,	
			C_PRACT_NAME_IN_DTLFORMAT_IND,
			P_PRACT_NAME_IN_DTLFORMAT_IND	

			                        
  INTO       
			:p_gross_net_amt_ind,              
			:p_serv_disc_on_gross_ind,         
			:p_all_oth_adj_amt_row_ind,        
			:p_bill_disc_sep_row_yn,           
			:p_bill_adj_sep_row_yn,            
			:p_bill_exm_sep_row_yn,            
			:p_bill_wo_sep_row_yn,             
			:p_oth_payers_amt_print_row_ind,   
			:p_patient_amt_print_row_ind,      
			:p_bill_net_payable_ind,
			:p_addl_charge_amt_ind,
			:p_excl_addl_charge_yn, 
			:p_servdate_in_dtlformat_yn, 
			:p_disc_amt_in_dtl_yn,         
			:c_gross_net_amt_ind,              
			:c_serv_disc_on_gross_ind,         
			:c_all_oth_adj_amt_ind,            
			:c_bill_disc_sep_row_yn,           
			:c_bill_adj_sep_row_yn,            
			:c_bill_exm_sep_row_yn,            
			:c_bill_wo_sep_row_yn,             
			:c_oth_payers_amt_print_row_ind,   
			:c_bill_subsidized_amt_ind,        
			:c_bill_net_payable_ind,
			:c_addl_charge_amt_ind,
			:c_excl_addl_charge_yn, 
			:c_servdate_in_dtlformat_yn, 
			:c_disc_amt_in_dtl_yn,                 
			:status,
			:c_print_serv_date_with_time_yn,
			:c_print_zero_other_adj_yn,	
			:c_print_zero_disc_column_yn,	
			:c_qty_in_dtlformat_yn,
			:c_rate_in_dtlformat_yn,		
			:p_print_serv_date_with_time_yn,
			:p_print_zero_other_adj_yn,	
			:p_print_zero_disc_column_yn,
			:p_qty_in_dtlformat_yn,
			:p_rate_in_dtlformat_yn,
			:p_print_zero_adcharg_column_yn,
			:c_print_zero_adcharg_column_yn,
			:c_print_zero_subsid_column_yn,
			:p_bill_addl_id_in_ftr_yn,
			:p_serv_desc_sep_line_yn,
			:c_serv_desc_sep_line_yn,
			:p_print_separator_line,
			:c_print_separator_line,
			:c_print_legend_yn,
			:p_print_legend_yn,
			:c_pract_name_in_dtlformat_ind,
			:p_pract_name_in_dtlformat_ind		
			
 
   FROM
   BL_BILL_PRINT_FORMAT
   WHERE OPERATING_FACILITY_ID=:nd_facility_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlbuft((void **)0, 
   "select P_GROSS_NET_AMT_IND ,P_SERV_DISC_ON_GROSS_IND ,P_ALL_OTH_ADJ_AMT_\
ROW_IND ,P_BILL_DISC_SEP_ROW_YN ,P_BILL_ADJ_SEP_ROW_YN ,P_BILL_EXM_SEP_ROW_Y\
N ,P_BILL_WO_SEP_ROW_YN ,P_OTH_PAYERS_AMT_PRINT_ROW_IND ,P_PATIENT_AMT_PRINT\
_ROW_IND ,P_BILL_NET_PAYABLE_IND ,P_ADDL_CHARGE_AMT_IND ,P_EXCL_ADDL_CHARGE_\
YN ,P_SERVDATE_IN_DTLFORMAT_YN ,P_DISC_AMT_IN_DTL_YN ,C_GROSS_NET_AMT_IND ,C\
_SERV_DISC_ON_GROSS_IND ,C_ALL_OTH_ADJ_AMT_IND ,C_BILL_DISC_SEP_ROW_YN ,C_BI\
LL_ADJ_SEP_ROW_YN ,C_BILL_EXM_SEP_ROW_YN ,C_BILL_WO_SEP_ROW_YN ,C_OTH_PAYERS\
_AMT_PRINT_ROW_IND ,C_BILL_SUBSIDIZED_AMT_IND ,C_BILL_NET_PAYABLE_IND ,C_ADD\
L_CHARGE_AMT_IND ,C_EXCL_ADDL_CHARGE_YN ,C_SERVDATE_IN_DTLFORMAT_YN ,C_DISC_\
AMT_IN_DTL_YN ,STATUS ,C_PRINT_SERV_DATE_WITH_TIME_YN ,C_PRINT_ZERO_OTHER_AD\
J_YN ,C_PRINT_ZERO_DISC_COLUMN_YN ,C_QTY_IN_DTLFORMAT_YN ,C_RATE_IN_DTLFORMA\
T_YN ,P_PRINT_SERV_DATE_WITH_TIME_YN ,P_PRINT_ZERO_OTHER_ADJ_YN ,P_PRINT_ZER\
O_DISC_COLUMN_YN ,P_QTY_IN_DTLFORMAT_YN ,P_RATE_IN_DTLFORMAT_YN ,P_PRINT_ZER\
O_ADCHARG_COLUMN_YN ,C_PRINT_ZERO_ADCHAR");
 sqlstm.stmt = "G_COLUMN_YN ,c_print_zero_subsid_column_yn ,P_BILL_ADDL_ID_I\
N_FTR_YN ,P_SERV_DESC_SEP_LINE_YN ,C_SERV_DESC_SEP_LINE_YN ,P_PRINT_SEPARATOR_\
LINE ,C_PRINT_SEPARATOR_LINE ,C_PRINT_LEGEND_YN ,P_PRINT_LEGEND_YN ,C_PRACT_NA\
ME_IN_DTLFORMAT_IND ,P_PRACT_NAME_IN_DTLFORMAT_IND into :b0,:b1,:b2,:b3,:b4,:b\
5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16,:b17,:b18,:b19,:b20,:b21,\
:b22,:b23,:b24,:b25,:b26,:b27,:b28,:b29,:b30,:b31,:b32,:b33,:b34,:b35,:b36,:b3\
7,:b38,:b39,:b40,:b41,:b42,:b43,:b44,:b45,:b46,:b47,:b48,:b49,:b50  from BL_BI\
LL_PRINT_FORMAT where OPERATING_FACILITY_ID=:b51";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3507;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&p_gross_net_amt_ind;
 sqlstm.sqhstl[0] = (unsigned int  )6;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&p_serv_disc_on_gross_ind;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&p_all_oth_adj_amt_row_ind;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&p_bill_disc_sep_row_yn;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&p_bill_adj_sep_row_yn;
 sqlstm.sqhstl[4] = (unsigned int  )6;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&p_bill_exm_sep_row_yn;
 sqlstm.sqhstl[5] = (unsigned int  )6;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&p_bill_wo_sep_row_yn;
 sqlstm.sqhstl[6] = (unsigned int  )6;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_oth_payers_amt_print_row_ind;
 sqlstm.sqhstl[7] = (unsigned int  )6;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_patient_amt_print_row_ind;
 sqlstm.sqhstl[8] = (unsigned int  )6;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&p_bill_net_payable_ind;
 sqlstm.sqhstl[9] = (unsigned int  )6;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&p_addl_charge_amt_ind;
 sqlstm.sqhstl[10] = (unsigned int  )6;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&p_excl_addl_charge_yn;
 sqlstm.sqhstl[11] = (unsigned int  )6;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&p_servdate_in_dtlformat_yn;
 sqlstm.sqhstl[12] = (unsigned int  )4;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&p_disc_amt_in_dtl_yn;
 sqlstm.sqhstl[13] = (unsigned int  )4;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&c_gross_net_amt_ind;
 sqlstm.sqhstl[14] = (unsigned int  )6;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&c_serv_disc_on_gross_ind;
 sqlstm.sqhstl[15] = (unsigned int  )6;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&c_all_oth_adj_amt_ind;
 sqlstm.sqhstl[16] = (unsigned int  )6;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&c_bill_disc_sep_row_yn;
 sqlstm.sqhstl[17] = (unsigned int  )6;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&c_bill_adj_sep_row_yn;
 sqlstm.sqhstl[18] = (unsigned int  )6;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&c_bill_exm_sep_row_yn;
 sqlstm.sqhstl[19] = (unsigned int  )6;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&c_bill_wo_sep_row_yn;
 sqlstm.sqhstl[20] = (unsigned int  )6;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&c_oth_payers_amt_print_row_ind;
 sqlstm.sqhstl[21] = (unsigned int  )6;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&c_bill_subsidized_amt_ind;
 sqlstm.sqhstl[22] = (unsigned int  )6;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&c_bill_net_payable_ind;
 sqlstm.sqhstl[23] = (unsigned int  )6;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&c_addl_charge_amt_ind;
 sqlstm.sqhstl[24] = (unsigned int  )6;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&c_excl_addl_charge_yn;
 sqlstm.sqhstl[25] = (unsigned int  )6;
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&c_servdate_in_dtlformat_yn;
 sqlstm.sqhstl[26] = (unsigned int  )4;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&c_disc_amt_in_dtl_yn;
 sqlstm.sqhstl[27] = (unsigned int  )4;
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqhstv[28] = (         void  *)&status;
 sqlstm.sqhstl[28] = (unsigned int  )6;
 sqlstm.sqhsts[28] = (         int  )0;
 sqlstm.sqindv[28] = (         void  *)0;
 sqlstm.sqinds[28] = (         int  )0;
 sqlstm.sqharm[28] = (unsigned int  )0;
 sqlstm.sqadto[28] = (unsigned short )0;
 sqlstm.sqtdso[28] = (unsigned short )0;
 sqlstm.sqhstv[29] = (         void  *)&c_print_serv_date_with_time_yn;
 sqlstm.sqhstl[29] = (unsigned int  )4;
 sqlstm.sqhsts[29] = (         int  )0;
 sqlstm.sqindv[29] = (         void  *)0;
 sqlstm.sqinds[29] = (         int  )0;
 sqlstm.sqharm[29] = (unsigned int  )0;
 sqlstm.sqadto[29] = (unsigned short )0;
 sqlstm.sqtdso[29] = (unsigned short )0;
 sqlstm.sqhstv[30] = (         void  *)&c_print_zero_other_adj_yn;
 sqlstm.sqhstl[30] = (unsigned int  )4;
 sqlstm.sqhsts[30] = (         int  )0;
 sqlstm.sqindv[30] = (         void  *)0;
 sqlstm.sqinds[30] = (         int  )0;
 sqlstm.sqharm[30] = (unsigned int  )0;
 sqlstm.sqadto[30] = (unsigned short )0;
 sqlstm.sqtdso[30] = (unsigned short )0;
 sqlstm.sqhstv[31] = (         void  *)&c_print_zero_disc_column_yn;
 sqlstm.sqhstl[31] = (unsigned int  )4;
 sqlstm.sqhsts[31] = (         int  )0;
 sqlstm.sqindv[31] = (         void  *)0;
 sqlstm.sqinds[31] = (         int  )0;
 sqlstm.sqharm[31] = (unsigned int  )0;
 sqlstm.sqadto[31] = (unsigned short )0;
 sqlstm.sqtdso[31] = (unsigned short )0;
 sqlstm.sqhstv[32] = (         void  *)&c_qty_in_dtlformat_yn;
 sqlstm.sqhstl[32] = (unsigned int  )4;
 sqlstm.sqhsts[32] = (         int  )0;
 sqlstm.sqindv[32] = (         void  *)0;
 sqlstm.sqinds[32] = (         int  )0;
 sqlstm.sqharm[32] = (unsigned int  )0;
 sqlstm.sqadto[32] = (unsigned short )0;
 sqlstm.sqtdso[32] = (unsigned short )0;
 sqlstm.sqhstv[33] = (         void  *)&c_rate_in_dtlformat_yn;
 sqlstm.sqhstl[33] = (unsigned int  )4;
 sqlstm.sqhsts[33] = (         int  )0;
 sqlstm.sqindv[33] = (         void  *)0;
 sqlstm.sqinds[33] = (         int  )0;
 sqlstm.sqharm[33] = (unsigned int  )0;
 sqlstm.sqadto[33] = (unsigned short )0;
 sqlstm.sqtdso[33] = (unsigned short )0;
 sqlstm.sqhstv[34] = (         void  *)&p_print_serv_date_with_time_yn;
 sqlstm.sqhstl[34] = (unsigned int  )4;
 sqlstm.sqhsts[34] = (         int  )0;
 sqlstm.sqindv[34] = (         void  *)0;
 sqlstm.sqinds[34] = (         int  )0;
 sqlstm.sqharm[34] = (unsigned int  )0;
 sqlstm.sqadto[34] = (unsigned short )0;
 sqlstm.sqtdso[34] = (unsigned short )0;
 sqlstm.sqhstv[35] = (         void  *)&p_print_zero_other_adj_yn;
 sqlstm.sqhstl[35] = (unsigned int  )4;
 sqlstm.sqhsts[35] = (         int  )0;
 sqlstm.sqindv[35] = (         void  *)0;
 sqlstm.sqinds[35] = (         int  )0;
 sqlstm.sqharm[35] = (unsigned int  )0;
 sqlstm.sqadto[35] = (unsigned short )0;
 sqlstm.sqtdso[35] = (unsigned short )0;
 sqlstm.sqhstv[36] = (         void  *)&p_print_zero_disc_column_yn;
 sqlstm.sqhstl[36] = (unsigned int  )4;
 sqlstm.sqhsts[36] = (         int  )0;
 sqlstm.sqindv[36] = (         void  *)0;
 sqlstm.sqinds[36] = (         int  )0;
 sqlstm.sqharm[36] = (unsigned int  )0;
 sqlstm.sqadto[36] = (unsigned short )0;
 sqlstm.sqtdso[36] = (unsigned short )0;
 sqlstm.sqhstv[37] = (         void  *)&p_qty_in_dtlformat_yn;
 sqlstm.sqhstl[37] = (unsigned int  )4;
 sqlstm.sqhsts[37] = (         int  )0;
 sqlstm.sqindv[37] = (         void  *)0;
 sqlstm.sqinds[37] = (         int  )0;
 sqlstm.sqharm[37] = (unsigned int  )0;
 sqlstm.sqadto[37] = (unsigned short )0;
 sqlstm.sqtdso[37] = (unsigned short )0;
 sqlstm.sqhstv[38] = (         void  *)&p_rate_in_dtlformat_yn;
 sqlstm.sqhstl[38] = (unsigned int  )4;
 sqlstm.sqhsts[38] = (         int  )0;
 sqlstm.sqindv[38] = (         void  *)0;
 sqlstm.sqinds[38] = (         int  )0;
 sqlstm.sqharm[38] = (unsigned int  )0;
 sqlstm.sqadto[38] = (unsigned short )0;
 sqlstm.sqtdso[38] = (unsigned short )0;
 sqlstm.sqhstv[39] = (         void  *)&p_print_zero_adcharg_column_yn;
 sqlstm.sqhstl[39] = (unsigned int  )4;
 sqlstm.sqhsts[39] = (         int  )0;
 sqlstm.sqindv[39] = (         void  *)0;
 sqlstm.sqinds[39] = (         int  )0;
 sqlstm.sqharm[39] = (unsigned int  )0;
 sqlstm.sqadto[39] = (unsigned short )0;
 sqlstm.sqtdso[39] = (unsigned short )0;
 sqlstm.sqhstv[40] = (         void  *)&c_print_zero_adcharg_column_yn;
 sqlstm.sqhstl[40] = (unsigned int  )4;
 sqlstm.sqhsts[40] = (         int  )0;
 sqlstm.sqindv[40] = (         void  *)0;
 sqlstm.sqinds[40] = (         int  )0;
 sqlstm.sqharm[40] = (unsigned int  )0;
 sqlstm.sqadto[40] = (unsigned short )0;
 sqlstm.sqtdso[40] = (unsigned short )0;
 sqlstm.sqhstv[41] = (         void  *)&c_print_zero_subsid_column_yn;
 sqlstm.sqhstl[41] = (unsigned int  )4;
 sqlstm.sqhsts[41] = (         int  )0;
 sqlstm.sqindv[41] = (         void  *)0;
 sqlstm.sqinds[41] = (         int  )0;
 sqlstm.sqharm[41] = (unsigned int  )0;
 sqlstm.sqadto[41] = (unsigned short )0;
 sqlstm.sqtdso[41] = (unsigned short )0;
 sqlstm.sqhstv[42] = (         void  *)&p_bill_addl_id_in_ftr_yn;
 sqlstm.sqhstl[42] = (unsigned int  )4;
 sqlstm.sqhsts[42] = (         int  )0;
 sqlstm.sqindv[42] = (         void  *)0;
 sqlstm.sqinds[42] = (         int  )0;
 sqlstm.sqharm[42] = (unsigned int  )0;
 sqlstm.sqadto[42] = (unsigned short )0;
 sqlstm.sqtdso[42] = (unsigned short )0;
 sqlstm.sqhstv[43] = (         void  *)&p_serv_desc_sep_line_yn;
 sqlstm.sqhstl[43] = (unsigned int  )4;
 sqlstm.sqhsts[43] = (         int  )0;
 sqlstm.sqindv[43] = (         void  *)0;
 sqlstm.sqinds[43] = (         int  )0;
 sqlstm.sqharm[43] = (unsigned int  )0;
 sqlstm.sqadto[43] = (unsigned short )0;
 sqlstm.sqtdso[43] = (unsigned short )0;
 sqlstm.sqhstv[44] = (         void  *)&c_serv_desc_sep_line_yn;
 sqlstm.sqhstl[44] = (unsigned int  )4;
 sqlstm.sqhsts[44] = (         int  )0;
 sqlstm.sqindv[44] = (         void  *)0;
 sqlstm.sqinds[44] = (         int  )0;
 sqlstm.sqharm[44] = (unsigned int  )0;
 sqlstm.sqadto[44] = (unsigned short )0;
 sqlstm.sqtdso[44] = (unsigned short )0;
 sqlstm.sqhstv[45] = (         void  *)&p_print_separator_line;
 sqlstm.sqhstl[45] = (unsigned int  )4;
 sqlstm.sqhsts[45] = (         int  )0;
 sqlstm.sqindv[45] = (         void  *)0;
 sqlstm.sqinds[45] = (         int  )0;
 sqlstm.sqharm[45] = (unsigned int  )0;
 sqlstm.sqadto[45] = (unsigned short )0;
 sqlstm.sqtdso[45] = (unsigned short )0;
 sqlstm.sqhstv[46] = (         void  *)&c_print_separator_line;
 sqlstm.sqhstl[46] = (unsigned int  )4;
 sqlstm.sqhsts[46] = (         int  )0;
 sqlstm.sqindv[46] = (         void  *)0;
 sqlstm.sqinds[46] = (         int  )0;
 sqlstm.sqharm[46] = (unsigned int  )0;
 sqlstm.sqadto[46] = (unsigned short )0;
 sqlstm.sqtdso[46] = (unsigned short )0;
 sqlstm.sqhstv[47] = (         void  *)&c_print_legend_yn;
 sqlstm.sqhstl[47] = (unsigned int  )4;
 sqlstm.sqhsts[47] = (         int  )0;
 sqlstm.sqindv[47] = (         void  *)0;
 sqlstm.sqinds[47] = (         int  )0;
 sqlstm.sqharm[47] = (unsigned int  )0;
 sqlstm.sqadto[47] = (unsigned short )0;
 sqlstm.sqtdso[47] = (unsigned short )0;
 sqlstm.sqhstv[48] = (         void  *)&p_print_legend_yn;
 sqlstm.sqhstl[48] = (unsigned int  )4;
 sqlstm.sqhsts[48] = (         int  )0;
 sqlstm.sqindv[48] = (         void  *)0;
 sqlstm.sqinds[48] = (         int  )0;
 sqlstm.sqharm[48] = (unsigned int  )0;
 sqlstm.sqadto[48] = (unsigned short )0;
 sqlstm.sqtdso[48] = (unsigned short )0;
 sqlstm.sqhstv[49] = (         void  *)&c_pract_name_in_dtlformat_ind;
 sqlstm.sqhstl[49] = (unsigned int  )4;
 sqlstm.sqhsts[49] = (         int  )0;
 sqlstm.sqindv[49] = (         void  *)0;
 sqlstm.sqinds[49] = (         int  )0;
 sqlstm.sqharm[49] = (unsigned int  )0;
 sqlstm.sqadto[49] = (unsigned short )0;
 sqlstm.sqtdso[49] = (unsigned short )0;
 sqlstm.sqhstv[50] = (         void  *)&p_pract_name_in_dtlformat_ind;
 sqlstm.sqhstl[50] = (unsigned int  )4;
 sqlstm.sqhsts[50] = (         int  )0;
 sqlstm.sqindv[50] = (         void  *)0;
 sqlstm.sqinds[50] = (         int  )0;
 sqlstm.sqharm[50] = (unsigned int  )0;
 sqlstm.sqadto[50] = (unsigned short )0;
 sqlstm.sqtdso[50] = (unsigned short )0;
 sqlstm.sqhstv[51] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[51] = (unsigned int  )5;
 sqlstm.sqhsts[51] = (         int  )0;
 sqlstm.sqindv[51] = (         void  *)0;
 sqlstm.sqinds[51] = (         int  )0;
 sqlstm.sqharm[51] = (unsigned int  )0;
 sqlstm.sqadto[51] = (unsigned short )0;
 sqlstm.sqtdso[51] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   
 	//c_servdate_in_dtlformat_yn.arr[0]='Y';  //only medicity
	//p_servdate_in_dtlformat_yn.arr[0]='Y';  //only medicity 
 
 if (OERROR)
        err_mesg("SELECT failed on table BL_BILL_PRINT_FORMAT",0,"");

   if (NODATAFOUND)
        err_mesg("No Record found in BL_BILL_PRINT_FORMAT",0,"");


p_gross_net_amt_ind.arr[p_gross_net_amt_ind.len]						= '\0';              
p_serv_disc_on_gross_ind.arr[p_serv_disc_on_gross_ind.len]				= '\0';            
p_all_oth_adj_amt_row_ind.arr[p_all_oth_adj_amt_row_ind.len]			= '\0';           
p_bill_disc_sep_row_yn.arr[p_bill_disc_sep_row_yn.len]					= '\0';              
p_bill_adj_sep_row_yn.arr[p_bill_adj_sep_row_yn.len]					= '\0';               
p_bill_exm_sep_row_yn.arr[p_bill_exm_sep_row_yn.len]					= '\0';               
p_bill_wo_sep_row_yn.arr[p_bill_wo_sep_row_yn.len]						= '\0';                
p_oth_payers_amt_print_row_ind.arr[p_oth_payers_amt_print_row_ind.len]	= '\0';      
p_patient_amt_print_row_ind.arr[p_patient_amt_print_row_ind.len]		= '\0';         
p_bill_net_payable_ind.arr[p_bill_net_payable_ind.len]					= '\0';              
p_addl_charge_amt_ind.arr[p_addl_charge_amt_ind.len]					= '\0';              
p_excl_addl_charge_yn.arr[p_excl_addl_charge_yn.len]					= '\0';              
p_servdate_in_dtlformat_yn.arr[p_servdate_in_dtlformat_yn.len]			= '\0';              
p_disc_amt_in_dtl_yn.arr[p_disc_amt_in_dtl_yn.len]						= '\0';  
c_gross_net_amt_ind.arr[c_gross_net_amt_ind.len]						= '\0';                 
c_serv_disc_on_gross_ind.arr[c_serv_disc_on_gross_ind.len]				= '\0';            
c_all_oth_adj_amt_ind.arr[c_all_oth_adj_amt_ind.len]					= '\0';               
c_bill_disc_sep_row_yn.arr[c_bill_disc_sep_row_yn.len]					= '\0';              
c_bill_adj_sep_row_yn.arr[c_bill_adj_sep_row_yn.len]					= '\0';               
c_bill_exm_sep_row_yn.arr[c_bill_exm_sep_row_yn.len]					= '\0';               
c_bill_wo_sep_row_yn.arr[c_bill_wo_sep_row_yn.len]						= '\0';                
c_oth_payers_amt_print_row_ind.arr[c_oth_payers_amt_print_row_ind.len]	= '\0';      
c_bill_subsidized_amt_ind.arr[c_bill_subsidized_amt_ind.len]			= '\0';           
c_bill_net_payable_ind.arr[c_bill_net_payable_ind.len]					= '\0';              
c_addl_charge_amt_ind.arr[c_addl_charge_amt_ind.len]					= '\0';              
c_excl_addl_charge_yn.arr[c_excl_addl_charge_yn.len]					= '\0';              
c_servdate_in_dtlformat_yn.arr[c_servdate_in_dtlformat_yn.len]			= '\0'; 
c_disc_amt_in_dtl_yn.arr[c_disc_amt_in_dtl_yn.len]						= '\0'; 
p_print_zero_adcharg_column_yn.arr[p_print_zero_adcharg_column_yn.len]	= '\0'; 
c_print_zero_adcharg_column_yn.arr[c_print_zero_adcharg_column_yn.len]	= '\0'; 
c_print_zero_subsid_column_yn.arr[c_print_zero_subsid_column_yn.len]	= '\0'; 
p_bill_addl_id_in_ftr_yn.arr[p_bill_addl_id_in_ftr_yn.len]				= '\0';
p_serv_desc_sep_line_yn.arr[p_serv_desc_sep_line_yn.len]				= '\0';
c_serv_desc_sep_line_yn.arr[c_serv_desc_sep_line_yn.len]				= '\0';
status.arr[status.len]													= '\0';                              

}

/* This Function will fetch the Payer Setup Records */
fetch_bill_format_payer()
{

p_gross_net_amt_ind.arr[0]				= '\0';              
p_serv_disc_on_gross_ind.arr[0]			= '\0';            
p_all_oth_adj_amt_row_ind.arr[0]		= '\0';           
p_bill_disc_sep_row_yn.arr[0]			= '\0';              
p_bill_adj_sep_row_yn.arr[0]			= '\0';               
p_bill_exm_sep_row_yn.arr[0]			= '\0';               
p_bill_wo_sep_row_yn.arr[0]				= '\0';                
p_oth_payers_amt_print_row_ind.arr[0]	= '\0';      
p_patient_amt_print_row_ind.arr[0]		= '\0';         
p_bill_net_payable_ind.arr[0]			= '\0'; 
p_addl_charge_amt_ind.arr[0]			= '\0';
p_excl_addl_charge_yn.arr[0]			= '\0';             
p_servdate_in_dtlformat_yn.arr[0]		= '\0'; 
p_disc_amt_in_dtl_yn.arr[0]				= '\0'; 
p_print_zero_disc_column_yn.arr[0]		= '\0'; 
p_print_zero_adcharg_column_yn.arr[0]	= '\0';
p_serv_desc_sep_line_yn.arr[0]			= '\0';
p_bill_addl_id_in_ftr_yn.arr[0]			= '\0';
status.arr[0]							= '\0'; 
                          


 /* EXEC SQL SELECT         
			P_GROSS_NET_AMT_IND,              
			P_SERV_DISC_ON_GROSS_IND,         
			P_ALL_OTH_ADJ_AMT_ROW_IND,        
			P_BILL_DISC_SEP_ROW_YN,           
			P_BILL_ADJ_SEP_ROW_YN,            
			P_BILL_EXM_SEP_ROW_YN,            
			P_BILL_WO_SEP_ROW_YN,             
			P_OTH_PAYERS_AMT_PRINT_ROW_IND,   
			P_PATIENT_AMT_PRINT_ROW_IND,      
			P_BILL_NET_PAYABLE_IND,
			P_ADDL_CHARGE_AMT_IND,
			P_EXCL_ADDL_CHARGE_YN,  
			P_SERVDATE_IN_DTLFORMAT_YN,   
			P_DISC_AMT_IN_DTL_YN,         
			STATUS,
			P_PRINT_SERV_DATE_WITH_TIME_YN,
			P_PRINT_ZERO_OTHER_ADJ_YN,	
			P_PRINT_ZERO_DISC_COLUMN_YN,
			P_QTY_IN_DTLFORMAT_YN,	
		    P_RATE_IN_DTLFORMAT_YN,
			P_PRINT_ZERO_ADCHARG_COLUMN_YN,
			P_SERV_DESC_SEP_LINE_YN,
			P_BILL_ADDL_ID_IN_FTR_YN,
			P_PRINT_SEPARATOR_LINE,
			P_PRINT_LEGEND_YN,
			P_PRACT_NAME_IN_DTLFORMAT_IND
	                      
		INTO       
			:p_gross_net_amt_ind,              
			:p_serv_disc_on_gross_ind,         
			:p_all_oth_adj_amt_row_ind,        
			:p_bill_disc_sep_row_yn,           
			:p_bill_adj_sep_row_yn,            
			:p_bill_exm_sep_row_yn,            
			:p_bill_wo_sep_row_yn,             
			:p_oth_payers_amt_print_row_ind,   
			:p_patient_amt_print_row_ind,      
			:p_bill_net_payable_ind, 
			:p_addl_charge_amt_ind,
			:p_excl_addl_charge_yn, 
			:p_servdate_in_dtlformat_yn,            
			:p_disc_amt_in_dtl_yn,
			:status,
			:p_print_serv_date_with_time_yn,
			:p_print_zero_other_adj_yn,	
			:p_print_zero_disc_column_yn,
			:p_qty_in_dtlformat_yn,	
			:p_rate_in_dtlformat_yn,
			:p_print_zero_adcharg_column_yn,
			:p_serv_desc_sep_line_yn,
			:p_bill_addl_id_in_ftr_yn,
			:p_print_separator_line,
			:p_print_legend_yn,
			:p_pract_name_in_dtlformat_ind
			
		
   FROM
   BL_BILL_PRINT_PAYER_FORMAT
   WHERE 
   OPERATING_FACILITY_ID=:nd_facility_id
   AND PAYER_CODE=:d_cust_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select P_GROSS_NET_AMT_IND ,P_SERV_DISC_ON_GROSS_IND ,P_ALL_\
OTH_ADJ_AMT_ROW_IND ,P_BILL_DISC_SEP_ROW_YN ,P_BILL_ADJ_SEP_ROW_YN ,P_BILL_EXM\
_SEP_ROW_YN ,P_BILL_WO_SEP_ROW_YN ,P_OTH_PAYERS_AMT_PRINT_ROW_IND ,P_PATIENT_A\
MT_PRINT_ROW_IND ,P_BILL_NET_PAYABLE_IND ,P_ADDL_CHARGE_AMT_IND ,P_EXCL_ADDL_C\
HARGE_YN ,P_SERVDATE_IN_DTLFORMAT_YN ,P_DISC_AMT_IN_DTL_YN ,STATUS ,P_PRINT_SE\
RV_DATE_WITH_TIME_YN ,P_PRINT_ZERO_OTHER_ADJ_YN ,P_PRINT_ZERO_DISC_COLUMN_YN ,\
P_QTY_IN_DTLFORMAT_YN ,P_RATE_IN_DTLFORMAT_YN ,P_PRINT_ZERO_ADCHARG_COLUMN_YN \
,P_SERV_DESC_SEP_LINE_YN ,P_BILL_ADDL_ID_IN_FTR_YN ,P_PRINT_SEPARATOR_LINE ,P_\
PRINT_LEGEND_YN ,P_PRACT_NAME_IN_DTLFORMAT_IND into :b0,:b1,:b2,:b3,:b4,:b5,:b\
6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16,:b17,:b18,:b19,:b20,:b21,:b22\
,:b23,:b24,:b25  from BL_BILL_PRINT_PAYER_FORMAT where (OPERATING_FACILITY_ID=\
:b26 and PAYER_CODE=:b27)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3730;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&p_gross_net_amt_ind;
 sqlstm.sqhstl[0] = (unsigned int  )6;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&p_serv_disc_on_gross_ind;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&p_all_oth_adj_amt_row_ind;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&p_bill_disc_sep_row_yn;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&p_bill_adj_sep_row_yn;
 sqlstm.sqhstl[4] = (unsigned int  )6;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&p_bill_exm_sep_row_yn;
 sqlstm.sqhstl[5] = (unsigned int  )6;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&p_bill_wo_sep_row_yn;
 sqlstm.sqhstl[6] = (unsigned int  )6;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&p_oth_payers_amt_print_row_ind;
 sqlstm.sqhstl[7] = (unsigned int  )6;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&p_patient_amt_print_row_ind;
 sqlstm.sqhstl[8] = (unsigned int  )6;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&p_bill_net_payable_ind;
 sqlstm.sqhstl[9] = (unsigned int  )6;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&p_addl_charge_amt_ind;
 sqlstm.sqhstl[10] = (unsigned int  )6;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&p_excl_addl_charge_yn;
 sqlstm.sqhstl[11] = (unsigned int  )6;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&p_servdate_in_dtlformat_yn;
 sqlstm.sqhstl[12] = (unsigned int  )4;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&p_disc_amt_in_dtl_yn;
 sqlstm.sqhstl[13] = (unsigned int  )4;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&status;
 sqlstm.sqhstl[14] = (unsigned int  )6;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&p_print_serv_date_with_time_yn;
 sqlstm.sqhstl[15] = (unsigned int  )4;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&p_print_zero_other_adj_yn;
 sqlstm.sqhstl[16] = (unsigned int  )4;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&p_print_zero_disc_column_yn;
 sqlstm.sqhstl[17] = (unsigned int  )4;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&p_qty_in_dtlformat_yn;
 sqlstm.sqhstl[18] = (unsigned int  )4;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&p_rate_in_dtlformat_yn;
 sqlstm.sqhstl[19] = (unsigned int  )4;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&p_print_zero_adcharg_column_yn;
 sqlstm.sqhstl[20] = (unsigned int  )4;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&p_serv_desc_sep_line_yn;
 sqlstm.sqhstl[21] = (unsigned int  )4;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&p_bill_addl_id_in_ftr_yn;
 sqlstm.sqhstl[22] = (unsigned int  )4;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&p_print_separator_line;
 sqlstm.sqhstl[23] = (unsigned int  )4;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&p_print_legend_yn;
 sqlstm.sqhstl[24] = (unsigned int  )4;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&p_pract_name_in_dtlformat_ind;
 sqlstm.sqhstl[25] = (unsigned int  )4;
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[26] = (unsigned int  )5;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&d_cust_code;
 sqlstm.sqhstl[27] = (unsigned int  )27;
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 //p_servdate_in_dtlformat_yn.arr[0]='Y';  
 
 if (OERROR)
        err_mesg("SELECT failed on table BL_BILL_PRINT_PAYER_FORMAT",0,"");

 if (NODATAFOUND)
        fetch_bill_format();
 
 
p_gross_net_amt_ind.arr[p_gross_net_amt_ind.len]						= '\0';              
p_serv_disc_on_gross_ind.arr[p_serv_disc_on_gross_ind.len]				= '\0';            
p_all_oth_adj_amt_row_ind.arr[p_all_oth_adj_amt_row_ind.len]			= '\0';           
p_bill_disc_sep_row_yn.arr[p_bill_disc_sep_row_yn.len]					= '\0';              
p_bill_adj_sep_row_yn.arr[p_bill_adj_sep_row_yn.len]					= '\0';               
p_bill_exm_sep_row_yn.arr[p_bill_exm_sep_row_yn.len]					= '\0';               
p_bill_wo_sep_row_yn.arr[p_bill_wo_sep_row_yn.len]						= '\0';                
p_oth_payers_amt_print_row_ind.arr[p_oth_payers_amt_print_row_ind.len]	= '\0';      
p_patient_amt_print_row_ind.arr[p_patient_amt_print_row_ind.len]		= '\0';         
p_bill_net_payable_ind.arr[p_bill_net_payable_ind.len]					= '\0';  
p_addl_charge_amt_ind.arr[p_addl_charge_amt_ind.len]					= '\0';              
p_excl_addl_charge_yn.arr[p_excl_addl_charge_yn.len]					= '\0';            
p_servdate_in_dtlformat_yn.arr[p_servdate_in_dtlformat_yn.len]			= '\0';            
p_disc_amt_in_dtl_yn.arr[p_disc_amt_in_dtl_yn.len]						= '\0';            
p_print_zero_disc_column_yn.arr[p_print_zero_disc_column_yn.len]		= '\0'; 
p_print_zero_adcharg_column_yn.arr[p_print_zero_adcharg_column_yn.len]	= '\0'; 
p_serv_desc_sep_line_yn.arr[p_serv_desc_sep_line_yn.len]				= '\0';
p_bill_addl_id_in_ftr_yn.arr[p_bill_addl_id_in_ftr_yn.len]				= '\0';
status.arr[status.len]													= '\0';                              

}

fetch_single_bill_format_bg()
{
     
c_gross_net_amt_ind.arr[0]							= '\0';                 
c_serv_disc_on_gross_ind.arr[0]						= '\0';            
c_all_oth_adj_amt_ind.arr[0]						= '\0';               
c_bill_disc_sep_row_yn.arr[0]						= '\0';              
c_bill_adj_sep_row_yn.arr[0]						= '\0';               
c_bill_exm_sep_row_yn.arr[0]						= '\0';               
c_bill_wo_sep_row_yn.arr[0]							= '\0';                
c_oth_payers_amt_print_row_ind.arr[0]				= '\0';      
c_bill_subsidized_amt_ind.arr[0]					= '\0';           
c_bill_net_payable_ind.arr[0]						= '\0'; 
c_addl_charge_amt_ind.arr[0]						= '\0';
c_excl_addl_charge_yn.arr[0]						= '\0'; 
c_servdate_in_dtlformat_yn.arr[0]					= '\0'; 
c_disc_amt_in_dtl_yn.arr[0]							= '\0';
c_print_zero_adcharg_column_yn.arr[0]				= '\0';  
c_print_zero_subsid_column_yn.arr[0]				= '\0'; 
c_serv_desc_sep_line_yn.arr[0]						= '\0';  
c_print_separator_line.arr[0]						= '\0';  
c_print_legend_yn.arr[0]							= '\0';
status.arr[0]										= '\0'; 
c_pract_name_in_dtlformat_ind.arr[0]				= '\0';
c_rate_in_dtlformat_yn.arr[0]						= '\0';                         


c_gross_net_amt_ind.len =0;             
c_serv_disc_on_gross_ind.len =0;       
c_all_oth_adj_amt_ind.len =0;             
c_bill_disc_sep_row_yn.len =0;        
c_bill_adj_sep_row_yn.len =0;           
c_bill_exm_sep_row_yn.len =0;       
c_bill_wo_sep_row_yn.len =0;       
c_oth_payers_amt_print_row_ind.len =0; 
c_bill_subsidized_amt_ind.len =0;       
c_bill_net_payable_ind.len =0;
c_addl_charge_amt_ind.len =0;
c_excl_addl_charge_yn.len =0;
c_servdate_in_dtlformat_yn.len =0;
c_disc_amt_in_dtl_yn.len =0;
c_print_zero_adcharg_column_yn.len =0;
c_print_zero_subsid_column_yn.len =0;
c_serv_desc_sep_line_yn.len =0;
c_print_separator_line.len =0;
c_print_legend_yn.len =0;
status.len =0;
c_pract_name_in_dtlformat_ind.len =0;
c_rate_in_dtlformat_yn.len =0;

/* EXEC SQL SELECT         
			C_GROSS_NET_AMT_IND,              
			C_SERV_DISC_ON_GROSS_IND,         
			C_BILL_DISC_SEP_ROW_YN,           
			C_BILL_ADJ_SEP_ROW_YN,            
			C_BILL_EXM_SEP_ROW_YN,            
			C_BILL_WO_SEP_ROW_YN,             
			C_BILL_NET_PAYABLE_IND,
			C_ADDL_CHARGE_AMT_IND,
			C_EXCL_ADDL_CHARGE_YN,  
			STATUS,
			C_PRINT_ZERO_OTHER_ADJ_YN,	
			C_PRINT_ZERO_DISC_COLUMN_YN,
			C_PRINT_ZERO_ADCHARG_COLUMN_YN,
			C_SERV_DESC_SEP_LINE_YN,
			C_PRINT_SEPARATOR_LINE,
			C_PRACT_NAME_IN_DTLFORMAT_IND,
			C_OTH_PAYERS_AMT_PRINT_ROW_IND,
			C_BILL_SUBSIDIZED_AMT_IND,
			C_SERVDATE_IN_DTLFORMAT_YN,
			C_DISC_AMT_IN_DTL_YN,
			C_PRINT_SERV_DATE_WITH_TIME_YN,
			C_QTY_IN_DTLFORMAT_YN,
			C_PRINT_ZERO_SUBSID_COLUMN_YN,
			C_PRINT_LEGEND_YN,
			C_ALL_OTH_ADJ_AMT_IND,
			C_RATE_IN_DTLFORMAT_YN


	                      
		INTO       
			:c_gross_net_amt_ind,              
			:c_serv_disc_on_gross_ind,         
			:c_bill_disc_sep_row_yn,           
			:c_bill_adj_sep_row_yn,            
			:c_bill_exm_sep_row_yn, 
			:c_bill_wo_sep_row_yn,           
			:c_bill_net_payable_ind, 
			:c_addl_charge_amt_ind,
			:c_excl_addl_charge_yn, 
			:status,
			:c_print_zero_other_adj_yn,	
			:c_print_zero_disc_column_yn,
			:c_print_zero_adcharg_column_yn,
			:c_serv_desc_sep_line_yn,
			:c_print_separator_line,
			:c_pract_name_in_dtlformat_ind,
			:c_oth_payers_amt_print_row_ind,
			:c_bill_subsidized_amt_ind,
			:c_servdate_in_dtlformat_yn,
			:c_disc_amt_in_dtl_yn,
			:c_print_serv_date_with_time_yn,
			:c_qty_in_dtlformat_yn,
			:c_print_zero_subsid_column_yn,
			:c_print_legend_yn,
			:c_all_oth_adj_amt_ind,
			:c_rate_in_dtlformat_yn


   FROM
   BL_CASH_BILL_PRINT_FORMAT
   WHERE OPERATING_FACILITY_ID=:nd_facility_id
   AND   BLNG_GRP_ID          =:dc_blng_grp_id
   AND	 BILL_RCPT_IND		  ='B' //added on 19/01/2010 for crf-530 
   AND   NVL(LANGUAGE_ID,'en')=:nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select C_GROSS_NET_AMT_IND ,C_SERV_DISC_ON_GROSS_IND ,C_BILL_\
DISC_SEP_ROW_YN ,C_BILL_ADJ_SEP_ROW_YN ,C_BILL_EXM_SEP_ROW_YN ,C_BILL_WO_SEP_R\
OW_YN ,C_BILL_NET_PAYABLE_IND ,C_ADDL_CHARGE_AMT_IND ,C_EXCL_ADDL_CHARGE_YN ,S\
TATUS ,C_PRINT_ZERO_OTHER_ADJ_YN ,C_PRINT_ZERO_DISC_COLUMN_YN ,C_PRINT_ZERO_AD\
CHARG_COLUMN_YN ,C_SERV_DESC_SEP_LINE_YN ,C_PRINT_SEPARATOR_LINE ,C_PRACT_NAME\
_IN_DTLFORMAT_IND ,C_OTH_PAYERS_AMT_PRINT_ROW_IND ,C_BILL_SUBSIDIZED_AMT_IND ,\
C_SERVDATE_IN_DTLFORMAT_YN ,C_DISC_AMT_IN_DTL_YN ,C_PRINT_SERV_DATE_WITH_TIME_\
YN ,C_QTY_IN_DTLFORMAT_YN ,C_PRINT_ZERO_SUBSID_COLUMN_YN ,C_PRINT_LEGEND_YN ,C\
_ALL_OTH_ADJ_AMT_IND ,C_RATE_IN_DTLFORMAT_YN into :b0,:b1,:b2,:b3,:b4,:b5,:b6,\
:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:b16,:b17,:b18,:b19,:b20,:b21,:b22,:\
b23,:b24,:b25  from BL_CASH_BILL_PRINT_FORMAT where (((OPERATING_FACILITY_ID=:\
b26 and BLNG_GRP_ID=:b27) and BILL_RCPT_IND='B') and NVL(LANGUAGE_ID,'en')=:b2\
8)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )3857;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&c_gross_net_amt_ind;
sqlstm.sqhstl[0] = (unsigned int  )6;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&c_serv_disc_on_gross_ind;
sqlstm.sqhstl[1] = (unsigned int  )6;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&c_bill_disc_sep_row_yn;
sqlstm.sqhstl[2] = (unsigned int  )6;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&c_bill_adj_sep_row_yn;
sqlstm.sqhstl[3] = (unsigned int  )6;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&c_bill_exm_sep_row_yn;
sqlstm.sqhstl[4] = (unsigned int  )6;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&c_bill_wo_sep_row_yn;
sqlstm.sqhstl[5] = (unsigned int  )6;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&c_bill_net_payable_ind;
sqlstm.sqhstl[6] = (unsigned int  )6;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&c_addl_charge_amt_ind;
sqlstm.sqhstl[7] = (unsigned int  )6;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&c_excl_addl_charge_yn;
sqlstm.sqhstl[8] = (unsigned int  )6;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&status;
sqlstm.sqhstl[9] = (unsigned int  )6;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&c_print_zero_other_adj_yn;
sqlstm.sqhstl[10] = (unsigned int  )4;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&c_print_zero_disc_column_yn;
sqlstm.sqhstl[11] = (unsigned int  )4;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&c_print_zero_adcharg_column_yn;
sqlstm.sqhstl[12] = (unsigned int  )4;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&c_serv_desc_sep_line_yn;
sqlstm.sqhstl[13] = (unsigned int  )4;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&c_print_separator_line;
sqlstm.sqhstl[14] = (unsigned int  )4;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&c_pract_name_in_dtlformat_ind;
sqlstm.sqhstl[15] = (unsigned int  )4;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&c_oth_payers_amt_print_row_ind;
sqlstm.sqhstl[16] = (unsigned int  )6;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&c_bill_subsidized_amt_ind;
sqlstm.sqhstl[17] = (unsigned int  )6;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&c_servdate_in_dtlformat_yn;
sqlstm.sqhstl[18] = (unsigned int  )4;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&c_disc_amt_in_dtl_yn;
sqlstm.sqhstl[19] = (unsigned int  )4;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&c_print_serv_date_with_time_yn;
sqlstm.sqhstl[20] = (unsigned int  )4;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqhstv[21] = (         void  *)&c_qty_in_dtlformat_yn;
sqlstm.sqhstl[21] = (unsigned int  )4;
sqlstm.sqhsts[21] = (         int  )0;
sqlstm.sqindv[21] = (         void  *)0;
sqlstm.sqinds[21] = (         int  )0;
sqlstm.sqharm[21] = (unsigned int  )0;
sqlstm.sqadto[21] = (unsigned short )0;
sqlstm.sqtdso[21] = (unsigned short )0;
sqlstm.sqhstv[22] = (         void  *)&c_print_zero_subsid_column_yn;
sqlstm.sqhstl[22] = (unsigned int  )4;
sqlstm.sqhsts[22] = (         int  )0;
sqlstm.sqindv[22] = (         void  *)0;
sqlstm.sqinds[22] = (         int  )0;
sqlstm.sqharm[22] = (unsigned int  )0;
sqlstm.sqadto[22] = (unsigned short )0;
sqlstm.sqtdso[22] = (unsigned short )0;
sqlstm.sqhstv[23] = (         void  *)&c_print_legend_yn;
sqlstm.sqhstl[23] = (unsigned int  )4;
sqlstm.sqhsts[23] = (         int  )0;
sqlstm.sqindv[23] = (         void  *)0;
sqlstm.sqinds[23] = (         int  )0;
sqlstm.sqharm[23] = (unsigned int  )0;
sqlstm.sqadto[23] = (unsigned short )0;
sqlstm.sqtdso[23] = (unsigned short )0;
sqlstm.sqhstv[24] = (         void  *)&c_all_oth_adj_amt_ind;
sqlstm.sqhstl[24] = (unsigned int  )6;
sqlstm.sqhsts[24] = (         int  )0;
sqlstm.sqindv[24] = (         void  *)0;
sqlstm.sqinds[24] = (         int  )0;
sqlstm.sqharm[24] = (unsigned int  )0;
sqlstm.sqadto[24] = (unsigned short )0;
sqlstm.sqtdso[24] = (unsigned short )0;
sqlstm.sqhstv[25] = (         void  *)&c_rate_in_dtlformat_yn;
sqlstm.sqhstl[25] = (unsigned int  )4;
sqlstm.sqhsts[25] = (         int  )0;
sqlstm.sqindv[25] = (         void  *)0;
sqlstm.sqinds[25] = (         int  )0;
sqlstm.sqharm[25] = (unsigned int  )0;
sqlstm.sqadto[25] = (unsigned short )0;
sqlstm.sqtdso[25] = (unsigned short )0;
sqlstm.sqhstv[26] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[26] = (unsigned int  )5;
sqlstm.sqhsts[26] = (         int  )0;
sqlstm.sqindv[26] = (         void  *)0;
sqlstm.sqinds[26] = (         int  )0;
sqlstm.sqharm[26] = (unsigned int  )0;
sqlstm.sqadto[26] = (unsigned short )0;
sqlstm.sqtdso[26] = (unsigned short )0;
sqlstm.sqhstv[27] = (         void  *)&dc_blng_grp_id;
sqlstm.sqhstl[27] = (unsigned int  )7;
sqlstm.sqhsts[27] = (         int  )0;
sqlstm.sqindv[27] = (         void  *)0;
sqlstm.sqinds[27] = (         int  )0;
sqlstm.sqharm[27] = (unsigned int  )0;
sqlstm.sqadto[27] = (unsigned short )0;
sqlstm.sqtdso[27] = (unsigned short )0;
sqlstm.sqhstv[28] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[28] = (unsigned int  )6;
sqlstm.sqhsts[28] = (         int  )0;
sqlstm.sqindv[28] = (         void  *)0;
sqlstm.sqinds[28] = (         int  )0;
sqlstm.sqharm[28] = (unsigned int  )0;
sqlstm.sqadto[28] = (unsigned short )0;
sqlstm.sqtdso[28] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  
   
   if (NODATAFOUND)
   {
    
	/* EXEC SQL SELECT         
			C_GROSS_NET_AMT_IND,              
			C_SERV_DISC_ON_GROSS_IND,         
			C_BILL_DISC_SEP_ROW_YN,           
			C_BILL_ADJ_SEP_ROW_YN,            
			C_BILL_EXM_SEP_ROW_YN,            
			C_BILL_WO_SEP_ROW_YN,             
			C_BILL_NET_PAYABLE_IND,
			C_ADDL_CHARGE_AMT_IND,
			C_EXCL_ADDL_CHARGE_YN,  
			STATUS,
			C_PRINT_ZERO_OTHER_ADJ_YN,	
			C_PRINT_ZERO_DISC_COLUMN_YN,
			C_PRINT_ZERO_ADCHARG_COLUMN_YN,
			C_SERV_DESC_SEP_LINE_YN,
			C_PRINT_SEPARATOR_LINE,
			C_PRACT_NAME_IN_DTLFORMAT_IND,
			C_PRINT_LEGEND_YN,					//Added by raghava for UAT
			C_ALL_OTH_ADJ_AMT_IND,
			C_RATE_IN_DTLFORMAT_YN
	                      
		INTO       
			:c_gross_net_amt_ind,              
			:c_serv_disc_on_gross_ind,         
			:c_bill_disc_sep_row_yn,           
			:c_bill_adj_sep_row_yn,            
			:c_bill_exm_sep_row_yn, 
			:c_bill_wo_sep_row_yn,           
			:c_bill_net_payable_ind, 
			:c_addl_charge_amt_ind,
			:c_excl_addl_charge_yn, 
			:status,
			:c_print_zero_other_adj_yn,	
			:c_print_zero_disc_column_yn,
			:c_print_zero_adcharg_column_yn,
			:c_serv_desc_sep_line_yn,
			:c_print_separator_line,
			:c_pract_name_in_dtlformat_ind,
			:c_print_legend_yn,					//Added by raghava for UAT
			:c_all_oth_adj_amt_ind,
			:c_rate_in_dtlformat_yn
   FROM
   BL_CASH_BILL_PRINT_FORMAT
   WHERE OPERATING_FACILITY_ID=:nd_facility_id
   AND   BLNG_GRP_ID          =:dc_blng_grp_id
   AND	 BILL_RCPT_IND		  ='B' //added on 19/01/2010 for crf-530
   AND   NVL(LANGUAGE_ID,'en')='en'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select C_GROSS_NET_AMT_IND ,C_SERV_DISC_ON_GROSS_IND ,C_BILL\
_DISC_SEP_ROW_YN ,C_BILL_ADJ_SEP_ROW_YN ,C_BILL_EXM_SEP_ROW_YN ,C_BILL_WO_SEP_\
ROW_YN ,C_BILL_NET_PAYABLE_IND ,C_ADDL_CHARGE_AMT_IND ,C_EXCL_ADDL_CHARGE_YN ,\
STATUS ,C_PRINT_ZERO_OTHER_ADJ_YN ,C_PRINT_ZERO_DISC_COLUMN_YN ,C_PRINT_ZERO_A\
DCHARG_COLUMN_YN ,C_SERV_DESC_SEP_LINE_YN ,C_PRINT_SEPARATOR_LINE ,C_PRACT_NAM\
E_IN_DTLFORMAT_IND ,C_PRINT_LEGEND_YN ,C_ALL_OTH_ADJ_AMT_IND ,C_RATE_IN_DTLFOR\
MAT_YN into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:\
b15,:b16,:b17,:b18  from BL_CASH_BILL_PRINT_FORMAT where (((OPERATING_FACILITY\
_ID=:b19 and BLNG_GRP_ID=:b20) and BILL_RCPT_IND='B') and NVL(LANGUAGE_ID,'en'\
)='en')";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )3988;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&c_gross_net_amt_ind;
 sqlstm.sqhstl[0] = (unsigned int  )6;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&c_serv_disc_on_gross_ind;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&c_bill_disc_sep_row_yn;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&c_bill_adj_sep_row_yn;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&c_bill_exm_sep_row_yn;
 sqlstm.sqhstl[4] = (unsigned int  )6;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&c_bill_wo_sep_row_yn;
 sqlstm.sqhstl[5] = (unsigned int  )6;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&c_bill_net_payable_ind;
 sqlstm.sqhstl[6] = (unsigned int  )6;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&c_addl_charge_amt_ind;
 sqlstm.sqhstl[7] = (unsigned int  )6;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&c_excl_addl_charge_yn;
 sqlstm.sqhstl[8] = (unsigned int  )6;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&status;
 sqlstm.sqhstl[9] = (unsigned int  )6;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&c_print_zero_other_adj_yn;
 sqlstm.sqhstl[10] = (unsigned int  )4;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&c_print_zero_disc_column_yn;
 sqlstm.sqhstl[11] = (unsigned int  )4;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&c_print_zero_adcharg_column_yn;
 sqlstm.sqhstl[12] = (unsigned int  )4;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&c_serv_desc_sep_line_yn;
 sqlstm.sqhstl[13] = (unsigned int  )4;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&c_print_separator_line;
 sqlstm.sqhstl[14] = (unsigned int  )4;
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&c_pract_name_in_dtlformat_ind;
 sqlstm.sqhstl[15] = (unsigned int  )4;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&c_print_legend_yn;
 sqlstm.sqhstl[16] = (unsigned int  )4;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&c_all_oth_adj_amt_ind;
 sqlstm.sqhstl[17] = (unsigned int  )6;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&c_rate_in_dtlformat_yn;
 sqlstm.sqhstl[18] = (unsigned int  )4;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[19] = (unsigned int  )5;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&dc_blng_grp_id;
 sqlstm.sqhstl[20] = (unsigned int  )7;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   }

 if (OERROR)
  {
        err_mesg("SELECT failed on table BL_CASH_BILL_PRINT_FORMAT",0,"");
		return;
  }

 if (NODATAFOUND)
   {

   /* EXEC SQL SELECT         
			C_GROSS_NET_AMT_IND,              
			C_SERV_DISC_ON_GROSS_IND,         
			C_BILL_DISC_SEP_ROW_YN,           
			C_BILL_ADJ_SEP_ROW_YN,            
			C_BILL_EXM_SEP_ROW_YN,            
			C_BILL_WO_SEP_ROW_YN,             
			C_BILL_NET_PAYABLE_IND,
			C_ADDL_CHARGE_AMT_IND,
			C_EXCL_ADDL_CHARGE_YN,  
			STATUS,
			C_PRINT_ZERO_OTHER_ADJ_YN,	
			C_PRINT_ZERO_DISC_COLUMN_YN,
			C_PRINT_ZERO_ADCHARG_COLUMN_YN,
			C_SERV_DESC_SEP_LINE_YN,
			C_PRINT_SEPARATOR_LINE,
			C_PRACT_NAME_IN_DTLFORMAT_IND,
			C_PRINT_LEGEND_YN,				//Added by raghava for UAT
			C_ALL_OTH_ADJ_AMT_IND,
			C_RATE_IN_DTLFORMAT_YN
	                      
		INTO       
			:c_gross_net_amt_ind,              
			:c_serv_disc_on_gross_ind,         
			:c_bill_disc_sep_row_yn,           
			:c_bill_adj_sep_row_yn,            
			:c_bill_exm_sep_row_yn, 
			:c_bill_wo_sep_row_yn,           
			:c_bill_net_payable_ind, 
			:c_addl_charge_amt_ind,
			:c_excl_addl_charge_yn, 
			:status,
			:c_print_zero_other_adj_yn,	
			:c_print_zero_disc_column_yn,
			:c_print_zero_adcharg_column_yn,
			:c_serv_desc_sep_line_yn,
			:c_print_separator_line,
			:c_pract_name_in_dtlformat_ind,
			:c_print_legend_yn,					//Added by raghava for UAT
			:c_all_oth_adj_amt_ind,
			:c_rate_in_dtlformat_yn
   FROM
   BL_CASH_BILL_PRINT_FORMAT
   WHERE OPERATING_FACILITY_ID=:nd_facility_id
   AND   BLNG_GRP_ID          ='**'
   AND	 BILL_RCPT_IND		  ='B' //added on 19/01/2010 for crf-530 
   AND   NVL(LANGUAGE_ID,'en')=:nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select C_GROSS_NET_AMT_IND ,C_SERV_DISC_ON_GROSS_IND ,C_BI\
LL_DISC_SEP_ROW_YN ,C_BILL_ADJ_SEP_ROW_YN ,C_BILL_EXM_SEP_ROW_YN ,C_BILL_WO_SE\
P_ROW_YN ,C_BILL_NET_PAYABLE_IND ,C_ADDL_CHARGE_AMT_IND ,C_EXCL_ADDL_CHARGE_YN\
 ,STATUS ,C_PRINT_ZERO_OTHER_ADJ_YN ,C_PRINT_ZERO_DISC_COLUMN_YN ,C_PRINT_ZERO\
_ADCHARG_COLUMN_YN ,C_SERV_DESC_SEP_LINE_YN ,C_PRINT_SEPARATOR_LINE ,C_PRACT_N\
AME_IN_DTLFORMAT_IND ,C_PRINT_LEGEND_YN ,C_ALL_OTH_ADJ_AMT_IND ,C_RATE_IN_DTLF\
ORMAT_YN into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14\
,:b15,:b16,:b17,:b18  from BL_CASH_BILL_PRINT_FORMAT where (((OPERATING_FACILI\
TY_ID=:b19 and BLNG_GRP_ID='**') and BILL_RCPT_IND='B') and NVL(LANGUAGE_ID,'e\
n')=:b20)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4087;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&c_gross_net_amt_ind;
   sqlstm.sqhstl[0] = (unsigned int  )6;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&c_serv_disc_on_gross_ind;
   sqlstm.sqhstl[1] = (unsigned int  )6;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&c_bill_disc_sep_row_yn;
   sqlstm.sqhstl[2] = (unsigned int  )6;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&c_bill_adj_sep_row_yn;
   sqlstm.sqhstl[3] = (unsigned int  )6;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&c_bill_exm_sep_row_yn;
   sqlstm.sqhstl[4] = (unsigned int  )6;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&c_bill_wo_sep_row_yn;
   sqlstm.sqhstl[5] = (unsigned int  )6;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&c_bill_net_payable_ind;
   sqlstm.sqhstl[6] = (unsigned int  )6;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&c_addl_charge_amt_ind;
   sqlstm.sqhstl[7] = (unsigned int  )6;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&c_excl_addl_charge_yn;
   sqlstm.sqhstl[8] = (unsigned int  )6;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&status;
   sqlstm.sqhstl[9] = (unsigned int  )6;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&c_print_zero_other_adj_yn;
   sqlstm.sqhstl[10] = (unsigned int  )4;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&c_print_zero_disc_column_yn;
   sqlstm.sqhstl[11] = (unsigned int  )4;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqhstv[12] = (         void  *)&c_print_zero_adcharg_column_yn;
   sqlstm.sqhstl[12] = (unsigned int  )4;
   sqlstm.sqhsts[12] = (         int  )0;
   sqlstm.sqindv[12] = (         void  *)0;
   sqlstm.sqinds[12] = (         int  )0;
   sqlstm.sqharm[12] = (unsigned int  )0;
   sqlstm.sqadto[12] = (unsigned short )0;
   sqlstm.sqtdso[12] = (unsigned short )0;
   sqlstm.sqhstv[13] = (         void  *)&c_serv_desc_sep_line_yn;
   sqlstm.sqhstl[13] = (unsigned int  )4;
   sqlstm.sqhsts[13] = (         int  )0;
   sqlstm.sqindv[13] = (         void  *)0;
   sqlstm.sqinds[13] = (         int  )0;
   sqlstm.sqharm[13] = (unsigned int  )0;
   sqlstm.sqadto[13] = (unsigned short )0;
   sqlstm.sqtdso[13] = (unsigned short )0;
   sqlstm.sqhstv[14] = (         void  *)&c_print_separator_line;
   sqlstm.sqhstl[14] = (unsigned int  )4;
   sqlstm.sqhsts[14] = (         int  )0;
   sqlstm.sqindv[14] = (         void  *)0;
   sqlstm.sqinds[14] = (         int  )0;
   sqlstm.sqharm[14] = (unsigned int  )0;
   sqlstm.sqadto[14] = (unsigned short )0;
   sqlstm.sqtdso[14] = (unsigned short )0;
   sqlstm.sqhstv[15] = (         void  *)&c_pract_name_in_dtlformat_ind;
   sqlstm.sqhstl[15] = (unsigned int  )4;
   sqlstm.sqhsts[15] = (         int  )0;
   sqlstm.sqindv[15] = (         void  *)0;
   sqlstm.sqinds[15] = (         int  )0;
   sqlstm.sqharm[15] = (unsigned int  )0;
   sqlstm.sqadto[15] = (unsigned short )0;
   sqlstm.sqtdso[15] = (unsigned short )0;
   sqlstm.sqhstv[16] = (         void  *)&c_print_legend_yn;
   sqlstm.sqhstl[16] = (unsigned int  )4;
   sqlstm.sqhsts[16] = (         int  )0;
   sqlstm.sqindv[16] = (         void  *)0;
   sqlstm.sqinds[16] = (         int  )0;
   sqlstm.sqharm[16] = (unsigned int  )0;
   sqlstm.sqadto[16] = (unsigned short )0;
   sqlstm.sqtdso[16] = (unsigned short )0;
   sqlstm.sqhstv[17] = (         void  *)&c_all_oth_adj_amt_ind;
   sqlstm.sqhstl[17] = (unsigned int  )6;
   sqlstm.sqhsts[17] = (         int  )0;
   sqlstm.sqindv[17] = (         void  *)0;
   sqlstm.sqinds[17] = (         int  )0;
   sqlstm.sqharm[17] = (unsigned int  )0;
   sqlstm.sqadto[17] = (unsigned short )0;
   sqlstm.sqtdso[17] = (unsigned short )0;
   sqlstm.sqhstv[18] = (         void  *)&c_rate_in_dtlformat_yn;
   sqlstm.sqhstl[18] = (unsigned int  )4;
   sqlstm.sqhsts[18] = (         int  )0;
   sqlstm.sqindv[18] = (         void  *)0;
   sqlstm.sqinds[18] = (         int  )0;
   sqlstm.sqharm[18] = (unsigned int  )0;
   sqlstm.sqadto[18] = (unsigned short )0;
   sqlstm.sqtdso[18] = (unsigned short )0;
   sqlstm.sqhstv[19] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[19] = (unsigned int  )5;
   sqlstm.sqhsts[19] = (         int  )0;
   sqlstm.sqindv[19] = (         void  *)0;
   sqlstm.sqinds[19] = (         int  )0;
   sqlstm.sqharm[19] = (unsigned int  )0;
   sqlstm.sqadto[19] = (unsigned short )0;
   sqlstm.sqtdso[19] = (unsigned short )0;
   sqlstm.sqhstv[20] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[20] = (unsigned int  )6;
   sqlstm.sqhsts[20] = (         int  )0;
   sqlstm.sqindv[20] = (         void  *)0;
   sqlstm.sqinds[20] = (         int  )0;
   sqlstm.sqharm[20] = (unsigned int  )0;
   sqlstm.sqadto[20] = (unsigned short )0;
   sqlstm.sqtdso[20] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


    
   if (NODATAFOUND)
   {

	   /* EXEC SQL SELECT         
			C_GROSS_NET_AMT_IND,              
			C_SERV_DISC_ON_GROSS_IND,         
			C_BILL_DISC_SEP_ROW_YN,           
			C_BILL_ADJ_SEP_ROW_YN,            
			C_BILL_EXM_SEP_ROW_YN,            
			C_BILL_WO_SEP_ROW_YN,             
			C_BILL_NET_PAYABLE_IND,
			C_ADDL_CHARGE_AMT_IND,
			C_EXCL_ADDL_CHARGE_YN,  
			STATUS,
			C_PRINT_ZERO_OTHER_ADJ_YN,	
			C_PRINT_ZERO_DISC_COLUMN_YN,
			C_PRINT_ZERO_ADCHARG_COLUMN_YN,
			C_SERV_DESC_SEP_LINE_YN,
			C_PRINT_SEPARATOR_LINE,
			C_PRACT_NAME_IN_DTLFORMAT_IND,
			C_PRINT_LEGEND_YN,				//Added by raghava for UAT
			C_ALL_OTH_ADJ_AMT_IND,
			C_RATE_IN_DTLFORMAT_YN
	                      
		INTO       
			:c_gross_net_amt_ind,              
			:c_serv_disc_on_gross_ind,         
			:c_bill_disc_sep_row_yn,           
			:c_bill_adj_sep_row_yn,            
			:c_bill_exm_sep_row_yn, 
			:c_bill_wo_sep_row_yn,           
			:c_bill_net_payable_ind, 
			:c_addl_charge_amt_ind,
			:c_excl_addl_charge_yn, 
			:status,
			:c_print_zero_other_adj_yn,	
			:c_print_zero_disc_column_yn,
			:c_print_zero_adcharg_column_yn,
			:c_serv_desc_sep_line_yn,
			:c_print_separator_line,
			:c_pract_name_in_dtlformat_ind,
			:c_print_legend_yn,					//Added by raghava for UAT
			:c_all_oth_adj_amt_ind,
			:c_rate_in_dtlformat_yn
	   FROM
	   BL_CASH_BILL_PRINT_FORMAT
	   WHERE OPERATING_FACILITY_ID=:nd_facility_id
	   AND   BLNG_GRP_ID          ='**'
	   AND	 BILL_RCPT_IND		  ='B'
	   AND   NVL(LANGUAGE_ID,'en')='en'; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select C_GROSS_NET_AMT_IND ,C_SERV_DISC_ON_GROSS_IND ,C_B\
ILL_DISC_SEP_ROW_YN ,C_BILL_ADJ_SEP_ROW_YN ,C_BILL_EXM_SEP_ROW_YN ,C_BILL_WO_S\
EP_ROW_YN ,C_BILL_NET_PAYABLE_IND ,C_ADDL_CHARGE_AMT_IND ,C_EXCL_ADDL_CHARGE_Y\
N ,STATUS ,C_PRINT_ZERO_OTHER_ADJ_YN ,C_PRINT_ZERO_DISC_COLUMN_YN ,C_PRINT_ZER\
O_ADCHARG_COLUMN_YN ,C_SERV_DESC_SEP_LINE_YN ,C_PRINT_SEPARATOR_LINE ,C_PRACT_\
NAME_IN_DTLFORMAT_IND ,C_PRINT_LEGEND_YN ,C_ALL_OTH_ADJ_AMT_IND ,C_RATE_IN_DTL\
FORMAT_YN into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b1\
4,:b15,:b16,:b17,:b18  from BL_CASH_BILL_PRINT_FORMAT where (((OPERATING_FACIL\
ITY_ID=:b19 and BLNG_GRP_ID='**') and BILL_RCPT_IND='B') and NVL(LANGUAGE_ID,'\
en')='en')";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )4186;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&c_gross_net_amt_ind;
    sqlstm.sqhstl[0] = (unsigned int  )6;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&c_serv_disc_on_gross_ind;
    sqlstm.sqhstl[1] = (unsigned int  )6;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&c_bill_disc_sep_row_yn;
    sqlstm.sqhstl[2] = (unsigned int  )6;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&c_bill_adj_sep_row_yn;
    sqlstm.sqhstl[3] = (unsigned int  )6;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&c_bill_exm_sep_row_yn;
    sqlstm.sqhstl[4] = (unsigned int  )6;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&c_bill_wo_sep_row_yn;
    sqlstm.sqhstl[5] = (unsigned int  )6;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&c_bill_net_payable_ind;
    sqlstm.sqhstl[6] = (unsigned int  )6;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&c_addl_charge_amt_ind;
    sqlstm.sqhstl[7] = (unsigned int  )6;
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqhstv[8] = (         void  *)&c_excl_addl_charge_yn;
    sqlstm.sqhstl[8] = (unsigned int  )6;
    sqlstm.sqhsts[8] = (         int  )0;
    sqlstm.sqindv[8] = (         void  *)0;
    sqlstm.sqinds[8] = (         int  )0;
    sqlstm.sqharm[8] = (unsigned int  )0;
    sqlstm.sqadto[8] = (unsigned short )0;
    sqlstm.sqtdso[8] = (unsigned short )0;
    sqlstm.sqhstv[9] = (         void  *)&status;
    sqlstm.sqhstl[9] = (unsigned int  )6;
    sqlstm.sqhsts[9] = (         int  )0;
    sqlstm.sqindv[9] = (         void  *)0;
    sqlstm.sqinds[9] = (         int  )0;
    sqlstm.sqharm[9] = (unsigned int  )0;
    sqlstm.sqadto[9] = (unsigned short )0;
    sqlstm.sqtdso[9] = (unsigned short )0;
    sqlstm.sqhstv[10] = (         void  *)&c_print_zero_other_adj_yn;
    sqlstm.sqhstl[10] = (unsigned int  )4;
    sqlstm.sqhsts[10] = (         int  )0;
    sqlstm.sqindv[10] = (         void  *)0;
    sqlstm.sqinds[10] = (         int  )0;
    sqlstm.sqharm[10] = (unsigned int  )0;
    sqlstm.sqadto[10] = (unsigned short )0;
    sqlstm.sqtdso[10] = (unsigned short )0;
    sqlstm.sqhstv[11] = (         void  *)&c_print_zero_disc_column_yn;
    sqlstm.sqhstl[11] = (unsigned int  )4;
    sqlstm.sqhsts[11] = (         int  )0;
    sqlstm.sqindv[11] = (         void  *)0;
    sqlstm.sqinds[11] = (         int  )0;
    sqlstm.sqharm[11] = (unsigned int  )0;
    sqlstm.sqadto[11] = (unsigned short )0;
    sqlstm.sqtdso[11] = (unsigned short )0;
    sqlstm.sqhstv[12] = (         void  *)&c_print_zero_adcharg_column_yn;
    sqlstm.sqhstl[12] = (unsigned int  )4;
    sqlstm.sqhsts[12] = (         int  )0;
    sqlstm.sqindv[12] = (         void  *)0;
    sqlstm.sqinds[12] = (         int  )0;
    sqlstm.sqharm[12] = (unsigned int  )0;
    sqlstm.sqadto[12] = (unsigned short )0;
    sqlstm.sqtdso[12] = (unsigned short )0;
    sqlstm.sqhstv[13] = (         void  *)&c_serv_desc_sep_line_yn;
    sqlstm.sqhstl[13] = (unsigned int  )4;
    sqlstm.sqhsts[13] = (         int  )0;
    sqlstm.sqindv[13] = (         void  *)0;
    sqlstm.sqinds[13] = (         int  )0;
    sqlstm.sqharm[13] = (unsigned int  )0;
    sqlstm.sqadto[13] = (unsigned short )0;
    sqlstm.sqtdso[13] = (unsigned short )0;
    sqlstm.sqhstv[14] = (         void  *)&c_print_separator_line;
    sqlstm.sqhstl[14] = (unsigned int  )4;
    sqlstm.sqhsts[14] = (         int  )0;
    sqlstm.sqindv[14] = (         void  *)0;
    sqlstm.sqinds[14] = (         int  )0;
    sqlstm.sqharm[14] = (unsigned int  )0;
    sqlstm.sqadto[14] = (unsigned short )0;
    sqlstm.sqtdso[14] = (unsigned short )0;
    sqlstm.sqhstv[15] = (         void  *)&c_pract_name_in_dtlformat_ind;
    sqlstm.sqhstl[15] = (unsigned int  )4;
    sqlstm.sqhsts[15] = (         int  )0;
    sqlstm.sqindv[15] = (         void  *)0;
    sqlstm.sqinds[15] = (         int  )0;
    sqlstm.sqharm[15] = (unsigned int  )0;
    sqlstm.sqadto[15] = (unsigned short )0;
    sqlstm.sqtdso[15] = (unsigned short )0;
    sqlstm.sqhstv[16] = (         void  *)&c_print_legend_yn;
    sqlstm.sqhstl[16] = (unsigned int  )4;
    sqlstm.sqhsts[16] = (         int  )0;
    sqlstm.sqindv[16] = (         void  *)0;
    sqlstm.sqinds[16] = (         int  )0;
    sqlstm.sqharm[16] = (unsigned int  )0;
    sqlstm.sqadto[16] = (unsigned short )0;
    sqlstm.sqtdso[16] = (unsigned short )0;
    sqlstm.sqhstv[17] = (         void  *)&c_all_oth_adj_amt_ind;
    sqlstm.sqhstl[17] = (unsigned int  )6;
    sqlstm.sqhsts[17] = (         int  )0;
    sqlstm.sqindv[17] = (         void  *)0;
    sqlstm.sqinds[17] = (         int  )0;
    sqlstm.sqharm[17] = (unsigned int  )0;
    sqlstm.sqadto[17] = (unsigned short )0;
    sqlstm.sqtdso[17] = (unsigned short )0;
    sqlstm.sqhstv[18] = (         void  *)&c_rate_in_dtlformat_yn;
    sqlstm.sqhstl[18] = (unsigned int  )4;
    sqlstm.sqhsts[18] = (         int  )0;
    sqlstm.sqindv[18] = (         void  *)0;
    sqlstm.sqinds[18] = (         int  )0;
    sqlstm.sqharm[18] = (unsigned int  )0;
    sqlstm.sqadto[18] = (unsigned short )0;
    sqlstm.sqtdso[18] = (unsigned short )0;
    sqlstm.sqhstv[19] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[19] = (unsigned int  )5;
    sqlstm.sqhsts[19] = (         int  )0;
    sqlstm.sqindv[19] = (         void  *)0;
    sqlstm.sqinds[19] = (         int  )0;
    sqlstm.sqharm[19] = (unsigned int  )0;
    sqlstm.sqadto[19] = (unsigned short )0;
    sqlstm.sqtdso[19] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   }
   
   }
       
 if (NODATAFOUND)
 {
       
	   fetch_bill_format();
	    //err_mesg("Setup is not defined in Rules for Detiled for Bill Formatting",0,"");
		//return;
		//err_mesg("No Record found in BL_CASH_BILL_PRINT_FORMAT",0,"");
 }	
           
c_gross_net_amt_ind.arr[c_gross_net_amt_ind.len]						= '\0';                 
c_serv_disc_on_gross_ind.arr[c_serv_disc_on_gross_ind.len]				= '\0';            
c_all_oth_adj_amt_ind.arr[c_all_oth_adj_amt_ind.len]					= '\0';               
c_bill_disc_sep_row_yn.arr[c_bill_disc_sep_row_yn.len]					= '\0';              
c_bill_adj_sep_row_yn.arr[c_bill_adj_sep_row_yn.len]					= '\0';               
c_bill_exm_sep_row_yn.arr[c_bill_exm_sep_row_yn.len]					= '\0';               
c_bill_wo_sep_row_yn.arr[c_bill_wo_sep_row_yn.len]						= '\0';                
c_oth_payers_amt_print_row_ind.arr[c_oth_payers_amt_print_row_ind.len]	= '\0';      
c_bill_subsidized_amt_ind.arr[c_bill_subsidized_amt_ind.len]			= '\0';           
c_bill_net_payable_ind.arr[c_bill_net_payable_ind.len]					= '\0';              
c_addl_charge_amt_ind.arr[c_addl_charge_amt_ind.len]					= '\0';              
c_excl_addl_charge_yn.arr[c_excl_addl_charge_yn.len]					= '\0';              
c_servdate_in_dtlformat_yn.arr[c_servdate_in_dtlformat_yn.len]			= '\0'; 
c_disc_amt_in_dtl_yn.arr[c_disc_amt_in_dtl_yn.len]						= '\0'; 
c_print_zero_adcharg_column_yn.arr[c_print_zero_adcharg_column_yn.len]	= '\0'; 
c_print_zero_subsid_column_yn.arr[c_print_zero_subsid_column_yn.len]	= '\0'; 
c_serv_desc_sep_line_yn.arr[c_serv_desc_sep_line_yn.len]				= '\0';
c_print_separator_line.arr[c_print_separator_line.len]					= '\0';	
c_print_legend_yn.arr[c_print_legend_yn.len]							= '\0';
status.arr[status.len]													= '\0';                              
c_pract_name_in_dtlformat_ind.arr[c_pract_name_in_dtlformat_ind.len]	= '\0';                          
c_rate_in_dtlformat_yn.arr[c_rate_in_dtlformat_yn.len]					= '\0';  				
}

prepare_file()
{
	if (LOGO_DIR.arr[0] != '\0') 
		strcpy(filename,LOGO_DIR.arr);
	else 
		strcpy(filename,WORKING_DIR);

	 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
	 {
			
		 l_billr_cnt=l_billr_cnt+1;
		 //strcpy(nd_file_name.arr,"blrvsbil.lis");
		 strcpy(nd_file_name.arr,nd_temp_file_name.arr);
		 flag=l_billr_cnt;
		 strcpy(l_filename[1],WORKING_DIR);
		 strcat(l_filename[1],nd_temp_file_name.arr);
		 
		 
	 }
	 /**** This LIS for Discount Document Report ****/
	 else
	 {
	 	 
		 l_discr_cnt=l_discr_cnt+1;
		 strcpy(nd_file_name.arr,"blrdiscn.lis");
		 flag=l_discr_cnt;
		 strcpy(l_filename[2],WORKING_DIR);
		 strcat(l_filename[2],nd_file_name.arr);

	 }
	
	
		strcat(filename,nd_file_name.arr);
		// strcpy (OUTPUT_FILE_NAME, filename); commented for scrum crf-654
		strcpy (OUTPUT_FILE_NAME, nd_file_name.arr);
  
	  
	  if(flag>1)
	  { 
		  if ((fp = fopen(filename,"a")) == NULL)
		   {
				err_mesg("Error while opening output file",0,"");
				proc_exit();
		   }
		   else
		   {
		   
		  // if (p_cnt==0)
		  // {
		 
		   	fprintf(fp,"");
			fprintf(fp,"\n"); 
			p_cnt=p_cnt+1;
		//	}
			}

	  } 
	  else
	  {
		   if((fp = fopen(filename,"w")) == NULL)
			{ 		
				err_mesg(ERR_MESG,"Error Opening Output File");
				proc_exit();
			}
	  }
		return;
}


declare_cust_cur()
{
    /* EXEC SQL DECLARE BL_BILL_HDR_CUST_CUR CURSOR FOR
        SELECT SHORT_NAME
	 FROM	AR_CUSTOMER_LANG_VW 
	 WHERE  
	 CUST_CODE = :d_cust_code1
	 AND  acc_entity_code = :nd_acc_entity_code
	 AND LANGUAGE_ID=:nd_lang_id; */ 


if (OERROR) 
	{	
		disp_message (ERR_MESG,"Failed to Declare customer cursor");
		proc_exit;
	}
return;
}


fetch_cust_cur()
{
d2_short_name.arr[0] = '\0';
d2_short_name.len=0;
 /* EXEC SQL SELECT SHORT_NAME into :d2_short_name
	 FROM	AR_CUSTOMER_LANG_VW 
	 WHERE  
	 CUST_CODE = :d_cust_code1
	 AND  acc_entity_code = :nd_acc_entity_code
	 AND LANGUAGE_ID=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select SHORT_NAME into :b0  from AR_CUSTOMER_LANG_VW where (\
(CUST_CODE=:b1 and acc_entity_code=:b2) and LANGUAGE_ID=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4281;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d2_short_name;
 sqlstm.sqhstl[0] = (unsigned int  )18;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_cust_code1;
 sqlstm.sqhstl[1] = (unsigned int  )27;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_acc_entity_code;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



d2_short_name.arr[d2_short_name.len] = '\0';
if (OERROR)
	{	
		disp_message(ERR_MESG,"Fetch Cust Cursor Failed");
		proc_exit();
	}
  }

/*
open_cust_cur()
{
	EXEC SQL OPEN BL_BILL_HDR_CUST_CUR;

	if (OERROR) 
	{	
		disp_message(ERR_MESG,"Open Customer Cursor Failed");
		proc_exit();
	}

	return;
}


fetch_cust_cur()
{
	d2_short_name.arr[0] = '\0';
	d2_short_name.len = 0;

	EXEC SQL FETCH BL_BILL_HDR_CUST_CUR INTO	
			:d2_short_name;

	if (OERROR)
	{	
		disp_message(ERR_MESG,"Fetch Customer Cursor Failed");
		proc_exit();
	}

	if(NODATAFOUND)
	{
   		return 0;
	}

	d2_short_name.arr[d2_short_name.len] = '\0';

	return 1;
}



close_cust_cur()
{
	EXEC SQL CLOSE BL_BILL_HDR_CUST_CUR;
}	
*/

fetch_customer()
{
d_customer1.arr[0] = '\0';
d_customer1.len=0;
 /* EXEC SQL SELECT LONG_NAME into :d_customer1
	 FROM	AR_CUSTOMER_LANG_VW 
	 WHERE  
	 CUST_CODE = :d_cust_code
	 AND  acc_entity_code = :nd_acc_entity_code
	 AND LANGUAGE_ID=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select LONG_NAME into :b0  from AR_CUSTOMER_LANG_VW where ((\
CUST_CODE=:b1 and acc_entity_code=:b2) and LANGUAGE_ID=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4312;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_customer1;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_cust_code;
 sqlstm.sqhstl[1] = (unsigned int  )27;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_acc_entity_code;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



d_customer1.arr[d_customer1.len] = '\0';
if (OERROR)
	{	
		disp_message(ERR_MESG,"Fetch Customer Cursor0 Failed");
		proc_exit();
	}
  }

fetch_customer1()
{

d_customer2.arr[0] = '\0';
d_customer2.len=0;

nd_cust_cd1.arr[0] = '\0';
nd_cust_cd1.len =0;
strcpy(nd_cust_cd1.arr,nd_cust_code1.arr);
nd_cust_cd1.arr[nd_cust_cd1.len]= '\0';


/* EXEC SQL SELECT substr(LONG_NAME,1,45) into :d_customer2
	 FROM	AR_CUSTOMER_LANG_VW 
	 WHERE  
	 CUST_CODE =:d_cust_code1	  
	 AND  acc_entity_code =:nd_acc_entity_code
	 AND LANGUAGE_ID=:nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select substr(LONG_NAME,1,45) into :b0  from AR_CUSTOMER_LANG\
_VW where ((CUST_CODE=:b1 and acc_entity_code=:b2) and LANGUAGE_ID=:b3)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )4343;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&d_customer2;
sqlstm.sqhstl[0] = (unsigned int  )48;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&d_cust_code1;
sqlstm.sqhstl[1] = (unsigned int  )27;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd_acc_entity_code;
sqlstm.sqhstl[2] = (unsigned int  )7;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[3] = (unsigned int  )6;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



d_customer2.arr[d_customer2.len] = '\0';
if (OERROR)
	{	
		disp_message(ERR_MESG,"Fetch Customer Cursor1 Failed");
		proc_exit();
	}
  }

fetch_customer2()
{
	
d_customer3.arr[0] = '\0';
d_customer3.len=0;
	

 /* EXEC SQL SELECT LONG_NAME into :d_customer3
	 FROM	AR_CUSTOMER_LANG_VW 
	 WHERE  
	 CUST_CODE = :d1_cust_code1
	AND  acc_entity_code = :nd_acc_entity_code
   AND LANGUAGE_ID=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select LONG_NAME into :b0  from AR_CUSTOMER_LANG_VW where ((\
CUST_CODE=:b1 and acc_entity_code=:b2) and LANGUAGE_ID=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4374;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_customer3;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d1_cust_code1;
 sqlstm.sqhstl[1] = (unsigned int  )27;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_acc_entity_code;
 sqlstm.sqhstl[2] = (unsigned int  )7;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	d_customer3.arr[d_customer3.len] = '\0';


	if (OERROR)
	{	
		disp_message(ERR_MESG,"Fetch Customer2 Cursor Failed");
		proc_exit();
	}

  }

print_report_head()
{	
	int len1 = 0, i = 0;
	v_lno = 0;	

	//l_page_no++; commented at 27/06/2009 bangkok
	//l_bill_page_no++;

  get_bill_format();

  	currency.arr[0] = '\0';
	sub_cur.arr[0]  = '\0';
	currency.len = 0;
	sub_cur.len = 0;
	nd_acc_name.arr[0] = '\0';
	nd_acc_name.len = 0;
	nd_decimal = 0;

	/* EXEC SQL SELECT base_currency,
			base_currency_dec,
			acc_entity_name||', ',
			accounting_name,
			no_of_decimal 
	INTO    :currency,
			:sub_cur,
			:nd_facility_name ,
			:nd_acc_name,
			:nd_decimal
	FROM SY_ACC_ENTITY_LANG_VW
	WHERE acc_entity_id = :d_cashfacility_id
	AND LANGUAGE_ID=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select base_currency ,base_currency_dec ,(acc_entity_name||'\
, ') ,accounting_name ,no_of_decimal into :b0,:b1,:b2,:b3,:b4  from SY_ACC_ENT\
ITY_LANG_VW where (acc_entity_id=:b5 and LANGUAGE_ID=:b6)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4405;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&currency;
 sqlstm.sqhstl[0] = (unsigned int  )18;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sub_cur;
 sqlstm.sqhstl[1] = (unsigned int  )12;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_name;
 sqlstm.sqhstl[2] = (unsigned int  )502;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_acc_name;
 sqlstm.sqhstl[3] = (unsigned int  )33;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&nd_decimal;
 sqlstm.sqhstl[4] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_cashfacility_id;
 sqlstm.sqhstl[5] = (unsigned int  )5;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[6] = (unsigned int  )6;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR) 
	{ 
		disp_message (ERR_MESG,"SELECT FACILITY STATEMENT FAILED");
		proc_exit();
	}

	currency.arr[currency.len] = '\0';
	sub_cur.arr[sub_cur.len] = '\0';
	nd_facility_name.arr[nd_facility_name.len] = '\0';
	nd_acc_name.arr[nd_acc_name.len] = '\0';

	 /* EXEC SQL SELECT acc_entity_name 
		 INTO :nd_facility
		 FROM SY_ACC_ENTITY_LANG_VW
		 WHERE acc_entity_id = :nd_facility_id
		 AND LANGUAGE_ID=:nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select acc_entity_name into :b0  from SY_ACC_ENTITY_LANG_VW\
 where (acc_entity_id=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4448;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_facility;
  sqlstm.sqhstl[0] = (unsigned int  )33;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[1] = (unsigned int  )5;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	nd_facility.arr[nd_facility.len] = '\0';
	nd_curr_date.arr[0] = '\0';
	nd_curr_date.len = 0;

	/* EXEC SQL SELECT TO_CHAR(SYSDATE,'dd/mm/yyyy') 
		 INTO :nd_curr_date
		 FROM dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select TO_CHAR(SYSDATE,'dd/mm/yyyy') into :b0  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4475;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_curr_date;
 sqlstm.sqhstl[0] = (unsigned int  )22;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	nd_curr_date.arr[nd_curr_date.len] = '\0';

	if(nd_curr_date.arr[0]!='\0')
	{
	  init_date_temp_var();
	  strcpy(date_convert.arr,nd_curr_date.arr);
	  fun_change_loc_date();
	  strcpy(nd_curr_date1.arr,nd_loc_date1.arr);
	 }

/***** Medicity******/

	nd_curr_date_t.arr[0] = '\0';
	nd_curr_date_t.len = 0;

	/* EXEC SQL SELECT TO_CHAR(SYSDATE,'dd/mm/yyyy hh24:mi') 
		 INTO :nd_curr_date_t
		 FROM dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select TO_CHAR(SYSDATE,'dd/mm/yyyy hh24:mi') into :b0  from \
dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4494;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_curr_date_t;
 sqlstm.sqhstl[0] = (unsigned int  )22;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	nd_curr_date_t.arr[nd_curr_date_t.len] = '\0';

	if(nd_curr_date_t.arr[0]!='\0')
	{
		init_date_temp_var();
		strcpy(date_convert.arr,nd_curr_date_t.arr);
		fun_change_loc_date1();
		strcpy(nd_curr_date_t.arr,date_convert.arr);

	 }	

nd_curr_date_t.arr[nd_curr_date_t.len]='\0';

/***** Medicity******/	   
	get_gl_holder_name_nric();
    get_patient_name();
	get_adm_dis_date();

	bill_title.arr[0] = '\0';
	bill_title.len = 0;

	if (dc_ind.arr[0] == 'P')
		strcpy(bill_title.arr,loc_legend[320]);
	else if (dc_ind.arr[0] == 'I')
		strcpy(bill_title.arr,loc_legend[330]);
	else
		strcpy(bill_title.arr," ");

       bill_title.len = strlen(bill_title.arr); 
  
 if (strcmp(nd_bill_format_id.arr,"1")==0)
  {

 /**** Added on 6/5/2009 for Printing the Header part for Discount Document Report *****/

 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
 {
    
	   l_disc_page_no++; //27/06/2009 bangkok

	   /** Laser Printer Format **/

	   if (l_lsr != 0 && l_dmp == 0)
	   {
	  	   if( l_logo_yniflaser.arr[0] != 'Y')
	       {
		
				strcat(nd_facility_name.arr,loc_legend[1417]);

				fprintf(fp,"%c(s10H",ESC);	
				fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */
				if(l_no_settlement_details.arr[0]!='R' || l_no_settlement_details.arr[0]=='\0')
				{
					if(strcmp(dc_bill_print_flag.arr,"Y") == 0)
					{
					  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
					  {
					   if(d1_man_disc_amt!=0 || d1_overall_disc_amt!=0 || d_pmnt_diff_adj_amt!=0 ||d_serv_disc_amt!=0)
					   {
						if(reprint_disc_copy_num>1)
						fprintf(fp,"\n%-68.68s%-10.10s\n"," ",loc_legend[190]);
					   }
					 }
					 else
					 fprintf(fp,"\n%-68.68s%-10.10s\n"," ",loc_legend[190]);
					 lsr_line_cnt();
				    }
				}
				fun_centre(loc_legend[1415],80);
				fprintf(fp,"%s\n",loc_legend[1415]);
				lsr_line_cnt();
				fprintf(fp,"%c(s-3B",ESC);	   /* To release bold style   */

				if(d_bill_nature_code.arr[0] == 'A')
				{
				 l_coverage_title.arr[0]='\0';
				 l_coverage_title.len=0;

				 strcpy(l_coverage_title.arr,loc_legend[1416]);
				 strcat(l_coverage_title.arr,": ");
				 get_policy_desc();
				 if (l_Policy_type_desc.arr[0] !='\0')
				 {
				  
				 strcat(l_coverage_title.arr,l_Policy_type_desc.arr);
				 }
				 else
				 strcat(l_coverage_title.arr,l_bill_long_desc_c.arr);
			
				 fprintf(fp,"%c(s14H",ESC);
				 fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */
				 fun_centre(l_coverage_title.arr,113);
				 fprintf(fp,"%s\n\n",l_coverage_title.arr);
				 lsr_line_cnt();lsr_line_cnt();
				 fprintf(fp,"%c(s-3B",ESC);	   /* To release bold style   */
				}

				else
				{
				
					if (d_cust_code.arr[0]=='\0')
					{
					strcpy(l_coverage_title.arr,loc_legend[1416]);
					strcat(l_coverage_title.arr,": ");
					strcat(l_coverage_title.arr,loc_legend[1426]);

					 fprintf(fp,"%c(s14H",ESC);
					 fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */
					 fun_centre(l_coverage_title.arr,105);
					 fprintf(fp,"%s\n\n",l_coverage_title.arr);
					 lsr_line_cnt();lsr_line_cnt();
					 fprintf(fp,"%c(s-3B",ESC);	   /* To release bold style   */
					}
				}
				fprintf(fp,"%c(s14H",ESC);
				fprintf(fp,"%-70.70s %-s: %-s\n",nd_facility_name.arr,loc_legend[1418],d1_doc_type_num.arr);
	   			fprintf(fp,"%-70.70s %-s: %-s %-s\n",nd_hosp_add.arr,loc_legend[1419],nd_curr_date_t.arr,loc_legend[1424]);
				lsr_line_cnt();lsr_line_cnt();
				fprintf(fp,"\n\n");
				lsr_line_cnt();lsr_line_cnt();
				fprintf(fp,"%-17.17s: %-51.51s ",loc_legend[100],dc_short_name.arr);
				fprintf(fp,"%-s: %-25.25s \n",loc_legend[1030],d_patient_id.arr); 
				lsr_line_cnt();
			
			
			   if (l_lsr != 0 && l_dmp == 0)
			   {
				  if(strcmp(d_cust_code.arr,"\0")!=0 && lcol_cnt == 1)
				  prt_line_uc();
				  if(strcmp(d_cust_code.arr,"\0")!=0  && lcol_cnt == 2)
				  prt_line_uc_wide();

				  if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 1)
				  prt_line_uc();
				  if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 2)
				  prt_line_uc_wide();
				  if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 3)
				  prt_line_uc_wide1();
				  if(strcmp(d_cust_code.arr,"\0")==0 && (lcol_cnt == 6 || lcol_cnt == 5))
				  prt_line_uc_wide2();
	
				  fprintf(fp,"\n");
				  lsr_line_cnt();
				  if (l_main_hdr == 0)
				  {
					// no need to print Subhdr 
				  }
				  else
				  {
					
					//fprintf(fp,"%6s %-20.20s %5s %-20.20s        %8.8s \n"," ",loc_legend[110]," "," ",currency.arr);		
					fprintf(fp,"%6s %-20.20s %5s %-20.20s (%s %s)\n  "," "," "," "," ",loc_legend[1401],currency.arr);		
					//fprintf(fp,"%-35s %21s %17s %17.17s\n",loc_legend[770],loc_legend[680],loc_legend[820],loc_legend[830]);
					lsr_line_cnt();
					l_cnt=l_cnt+1;

				  }
			    }
				
				if (l_lsr != 0 && l_dmp == 0)
				{
					l_main_hdr = 1;
				}
				else
				{
					v_lno = 0;
				}	
			
		    }
	   }
	   /** Dotmatrix Printer Format **/
	   else
	   {
	     	strcat(nd_facility_name.arr,loc_legend[1417]);
			if(l_no_settlement_details.arr[0]!='R' || l_no_settlement_details.arr[0]=='\0')
			{
		 	 if(strcmp(dc_bill_print_flag.arr,"Y") == 0)
			 {
				 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
				 {
				   if(d1_man_disc_amt!=0 || d1_overall_disc_amt!=0 || d_pmnt_diff_adj_amt!=0 ||d_serv_disc_amt!=0)
				   {
				    if(reprint_disc_copy_num>1)
					fprintf(fp,"%-68.68s%-10.10s\n"," ",loc_legend[190]);
				   }
				 }
				 else
				 fprintf(fp,"%-68.68s%-10.10s\n"," ",loc_legend[190]);
				 lsr_line_cnt();
			 }
			}
			fun_centre(loc_legend[1415],80);
			fprintf(fp,"%s\n",loc_legend[1415]);
			lsr_line_cnt();

			if(d_bill_nature_code.arr[0] == 'A')
			{
				 l_coverage_title.arr[0]='\0';
				 l_coverage_title.len=0;

				 strcpy(l_coverage_title.arr,loc_legend[1416]);
				 strcat(l_coverage_title.arr,": ");

				 get_policy_desc();

				 if (l_Policy_type_desc.arr[0]!='\0')
				 {
				
				 strcat(l_coverage_title.arr,l_Policy_type_desc.arr);
				 }
				 else
				 {
				 
				 strcat(l_coverage_title.arr,l_bill_long_desc_c.arr);
				}

			
				 fprintf(fp,"%c(s14H",ESC);
				 fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */
				 fun_centre(l_coverage_title.arr,113);
				 fprintf(fp,"%s\n\n",l_coverage_title.arr);
				 lsr_line_cnt();lsr_line_cnt();
				 printf(fp,"%c(s-3B",ESC);	   /* To release bold style   */
			
			}
			else
			{
			 if (d_cust_code.arr[0]=='\0')
			 {
			 strcpy(l_coverage_title.arr,loc_legend[1416]);
			 strcat(l_coverage_title.arr,": ");
			 strcat(l_coverage_title.arr,loc_legend[1426]);

			 fprintf(fp,"%c(s14H",ESC);
			 fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */
			 fun_centre(l_coverage_title.arr,105);
			 fprintf(fp,"%s\n\n",l_coverage_title.arr);
			 lsr_line_cnt();lsr_line_cnt();
			 fprintf(fp,"%c(s-3B",ESC);	   /* To release bold style   */
			}
			}

			fprintf(fp,"%-70.70s %-s: %-s\n",nd_facility_name.arr,loc_legend[1418],d1_doc_type_num.arr);
	   		fprintf(fp,"%-70.70s %-s: %-s \n",nd_hosp_add.arr,loc_legend[1419],nd_curr_date_t.arr);
			lsr_line_cnt();lsr_line_cnt();
			fprintf(fp,"\n\n");
			lsr_line_cnt();lsr_line_cnt();
			fprintf(fp,"%-17.17s: %-51.51s ",loc_legend[100],dc_short_name.arr);
			fprintf(fp,"%-s: %-25.25s \n",loc_legend[1030],d_patient_id.arr); 
			lsr_line_cnt();

			prt_line_uc();
		    fprintf(fp,"\n");lsr_line_cnt();
			if (l_lsr != 0 && l_dmp == 0)
			{
				l_main_hdr = 1;
			}
			else
			{
				v_lno = 0;
			}
	   }

 }
 else
 {
   l_billpage_no++; //27/06/2009 bangkok

	if (l_lsr != 0 && l_dmp == 0)
	{	 

	   if( l_logo_yniflaser.arr[0] != 'Y')
	    {
		   fprintf(fp,"%c(s10H",ESC);	
		   fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */
	    }

		//fprintf(fp,"%-80.80s\n",loc_legend[380]);		
		//lsr_line_cnt();

		//fprintf(fp,"%-80.80s\n",loc_legend[370]);
		//lsr_line_cnt();

          if(l_no_settlement_details.arr[0]!='R' || l_no_settlement_details.arr[0]=='\0')
		  {
		   if(strcmp(dc_bill_print_flag.arr,"Y") == 0)
		   fprintf(fp,"%-68.68s%-10.10s\n"," ",loc_legend[190]);
          }
		  fun_centre(nd_hosp_name.arr,60);
		  fprintf(fp,"%s\n",nd_hosp_name.arr);
		  lsr_line_cnt();
		  fprintf(fp,"%c(s-3B",ESC);	/* To release bold style   */
		  lsr_line_cnt(); 
		
		if (l_lsr != 0 && l_dmp == 0)
		{
	    if ( l_logo_yniflaser.arr[0] != 'Y')
		fprintf(fp,"%c(s14H",ESC);	
		}	

		//fprintf(fp,"%-80.80s\n",nd_add.arr);
		//lsr_line_cnt();
		
		fun_centre(nd_telfax.arr,80);
		fprintf(fp,"%s\n",nd_telfax.arr);
		lsr_line_cnt();
		
	    if (l_lsr != 0 && l_dmp == 0)
		{
		 if( l_logo_yniflaser.arr[0] != 'Y')
	     {
		   fprintf(fp,"%c(s10H",ESC);
		   fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 	  */
		  	   			
	     }
		}


		
		if(l_no_settlement_details.arr[0]=='R' || 
		( strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS3")==0||strcmp(nd_calling_pgm_id.arr,"BLRUCDS3")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0
          && strcmp(d_bill_nature_code.arr,"C")==0) )
		{
			
		  if(d_bill_paid_amt!=0)
		  {
		   fun_centre(loc_legend[1404],80);
		   fprintf(fp,"%c&d0D",ESC); /* set Underline mode */
		   fprintf(fp,"%s\n",loc_legend[1404]);
		   fprintf(fp,"%c&d@",ESC); /* release Underline mode */
		   lsr_line_cnt();		
		   fprintf(fp,"%c(s-3B",ESC);	/* To release bold style  */  
		  }
		  else
		  {
				
			fprintf(fp,"%c&d0D",ESC); /* set Underline mode */
			//fprintf(fp,"%s\n",loc_legend[300]); commented FOR SCRUM CRF-654
			fprintf(fp,"%s\n",loc_legend[991]); // ADDED FOR SCRUM CRF-654
			fprintf(fp,"%c&d@",ESC); /* release Underline mode */
			lsr_line_cnt();		
			fprintf(fp,"%c(s-3B",ESC);	/* To release bold style  */  
		
		  }  
      
		  
		}
		else
		{
			fun_centre(loc_legend[300],80);
			fprintf(fp,"%c&d0D",ESC); /* set Underline mode */
			//fprintf(fp,"%s\n",loc_legend[300]); commented FOR SCRUM CRF-654
			fprintf(fp,"%s\n",loc_legend[991]);   // ADDED FOR SCRUM CRF-654
			fprintf(fp,"%c&d@",ESC); /* release Underline mode */
			lsr_line_cnt();		
			fprintf(fp,"%c(s-3B",ESC);	/* To release bold style  */  
		
		}  
      

		fprintf(fp,"%-80.80s\n",bill_title.arr);
	    lsr_line_cnt();

		if (l_lsr != 0 && l_dmp == 0)
		{
        if(l_logo_yniflaser.arr[0] != 'Y')
	    {
		  fprintf(fp,"%c(s14H",ESC);	      	      
	    }
		}	      
	   
		//fprintf(fp,"%-s: %-s ",loc_legend[70],d1_doc_type_num.arr);  commented for scrum crf-654
		//fprintf(fp,"%-s: %-s/%-s ",loc_legend[70],nd_fm_doc_type.arr,nd_fm_doc_num.arr); 
	    
	   if(d1_doc_date.arr[0]!='\0')
		{
		  init_date_temp_var();
		  strcpy(date_convert.arr,d1_doc_date.arr);
		  fun_change_loc_date();
		  strcpy(d1_doc_date1.arr,nd_loc_date1.arr);
		}
		
		//fprintf(fp,"%-s: %-s      ",loc_legend[80],d1_doc_date1.arr); commented for scrum crf-654
			
	    if (nd_reprint_yn == 'Y')
	    {
		
			if(l_no_settlement_details.arr[0]!='R' || l_no_settlement_details.arr[0]=='\0')
			{
				if (strcmp(dc_bill_print_flag.arr,"Y") == 0)
				{			
					if (l_lsr != 0 && l_dmp == 0)
					{				
					  fprintf(fp,"%35.35s: %-s ",loc_legend[290],nd_curr_date1.arr);
					  fprintf(fp,"\n");
					  lsr_line_cnt();
					}
					else
					{			
					  fprintf(fp,"%35.35s: %-s ",loc_legend[290],nd_curr_date1.arr);
					  fprintf(fp,"\n");
					  lsr_line_cnt();
					}		     
				}
				else
				{
					fprintf(fp,"\n");
					lsr_line_cnt();
				}
			}
	    }
	
		if(d_int_bill_prv_doc_type_code.arr[0]!='\0') //added at 31/07/07 
		{
		  fprintf(fp,"%89.89s: ",loc_legend[860]);
		  fprintf(fp,"%-s/%-s\n ",d_int_bill_prv_doc_type_code.arr,d_int_bill_prv_doc_number.arr);
        }

	    else
	    {	
			fprintf(fp,"\n");
			lsr_line_cnt();
	    }


	
	    fprintf(fp,"%-45.45s",loc_legend[560]);
	    fprintf(fp,"%-45.45s\n",loc_legend[570]);	    
	    lsr_line_cnt();

	   if(strcmp(d_cust_code.arr,"\0")!=0 && lcol_cnt == 1)
		prt_line_uc();
	   if(strcmp(d_cust_code.arr,"\0")!=0  && lcol_cnt == 2)
	    prt_line_uc_wide();

		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 1)
		prt_line_uc();
		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 2)
		prt_line_uc_wide();
		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 3)
		prt_line_uc_wide1();
		if(strcmp(d_cust_code.arr,"\0")==0 && (lcol_cnt == 6||lcol_cnt == 5))
		prt_line_uc_wide2();

	    //prt_line();
	    fprintf(fp,"\n");    
	    lsr_line_cnt();	    
	    

	    dc_short_name1.arr[i] = '\0';
	    dc_short_name1.len = 0;	    

	    dc_short_name2.arr[0] = '\0';
	    dc_short_name2.len = 0;	    

	    dc_short_name3.arr[0] = '\0';
	    dc_short_name3.len = 0;	    

	    r_ctr = 0;   
	    if (dc_short_name.len >0)	
        split_text(dc_short_name.arr,25,dc_short_name1.arr,&r_ctr);	 
	    if (dc_short_name.len >25)
	    split_text(dc_short_name.arr,25,dc_short_name2.arr,&r_ctr);
	    if (dc_short_name.len >50)
	    split_text(dc_short_name.arr,25,dc_short_name3.arr,&r_ctr);	    
	    
	    
	    l_gl_holder_name1.arr[0] = '\0';
	    l_gl_holder_name1.len = 0;

	    l_gl_holder_name2.arr[0] = '\0';
	    l_gl_holder_name2.len = 0;	    


        r_ctr = 0; 
	    if(l_gl_holder_name.len > 0)
	    split_text(l_gl_holder_name.arr,25,l_gl_holder_name1.arr,&r_ctr);	    
	    if(l_gl_holder_name.len > 25)
	    split_text(l_gl_holder_name.arr,25,l_gl_holder_name2.arr,&r_ctr);	    
	    
		//printing Patient Name 1st line

		if(strcmp(d_bill_nature_code.arr,"C")==0)
			if (l_lsr != 0 && l_dmp == 0)
			{
			if (l_logo_yniflaser.arr[0] != 'Y')			    
			{
				fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style */
				fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[100],dc_short_name1.arr);
				fprintf(fp,"%c(s-3B",ESC); 	/* To set Bold style */
			}
			}
			else
			fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[100],dc_short_name1.arr);
		else
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[100],dc_short_name1.arr);

		fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[571],l_gl_holder_name1.arr);
	    //fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[10],l_gl_holder_name1.arr);
	    lsr_line_cnt();
	    

	    if (dc_short_name2.arr[0] != '\0' || l_gl_holder_name2.arr[0] != '\0')
	    {
		  fprintf(fp,"%-17.17s  %-25.25s ","",dc_short_name2.arr);
	      fprintf(fp,"%-18.18s  %-25.25s\n","",l_gl_holder_name2.arr);
	      lsr_line_cnt();
	    }
		

	    if (dc_short_name3.arr[0] != '\0')
	    {
		  fprintf(fp,"%-17.17s  %-25.25s ","",dc_short_name3.arr);
	      fprintf(fp,"\n");
	      lsr_line_cnt();
	    }
	    
        //printing Patient Details 2nd line
      if(l_nric_number.arr[0]!='\0' || l_gl_ic.arr[0]!='\0')		
	   { 
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[560],l_nric_number.arr);   
	    fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[580],l_gl_ic.arr);   
	    lsr_line_cnt();	
	   }
	 
      
	  if(l_bill_contact_name_p.arr[0]!='\0' || l_credit_doc_ref_desc.arr[0]!='\0' 
	     || l_bill_contact_name_title_p.arr[0]!='\0')
	   {
	    fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[590],l_bill_contact_name_p.arr);	    
	    fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[600],l_credit_doc_ref_desc.arr);
	    lsr_line_cnt();
	   }
	   
	   
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_contact_name_title_p.arr); 
		   	    	    
	  if(l_bill_contact_name_title_c.arr[0]!='\0' || l_bill_long_desc_p.arr[0]!='\0' ||
	     l_bill_long_desc_c.arr[0]!='\0' || l_bill_add1_desc_p.arr[0]!='\0' ||
		 l_bill_add1_desc_c.arr[0]!='\0' || l_bill_add2_desc_p.arr[0]!='\0' ||
		 l_bill_add2_desc_c.arr[0]!='\0' || l_bill_add3_desc_p.arr[0]!='\0' ||
		 l_bill_add3_desc_p.arr[0]!='\0' || l_bill_add3_desc_c.arr[0]!='\0')
	   {  
	    
		fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[610],l_bill_contact_name_title_c.arr);   
	    lsr_line_cnt();
      
	   		
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_long_desc_p.arr);	        
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_long_desc_c.arr);
	    lsr_line_cnt();

	   
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_add1_desc_p.arr);	    
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_add1_desc_c.arr);
	    lsr_line_cnt();
	   

	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_add2_desc_p.arr);	    
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_add2_desc_c.arr);
	    lsr_line_cnt();
		
	   
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_add3_desc_p.arr);	    
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_add3_desc_c.arr);	    
	    lsr_line_cnt();

	  }
	  else
	  fprintf(fp,"\n");
	  if (l_pat_reln_with_gl_holder.arr[0] != '\0')
	  {

        l_pat_reln_with_gl_holder1.arr[0] = '\0';
		l_pat_reln_with_gl_holder1.len = 0;

		r_ctr = 0; 
		if(l_pat_reln_with_gl_holder.len > 0)
		split_text(l_pat_reln_with_gl_holder.arr,25,l_pat_reln_with_gl_holder1.arr,&r_ctr);
		if(l_pat_reln_with_gl_holder.len > 25)
		split_text(l_pat_reln_with_gl_holder.arr,25,l_pat_reln_with_gl_holder2.arr,&r_ctr);
	  }
		
    //printing admission date & discharge date

	
		if(dc_admn_date.arr[0]!='\0')
		{
			init_date_temp_var();
			strcpy(date_convert.arr,dc_admn_date.arr);
			fun_change_loc_date1();
			strcpy(dc_admn_date.arr,date_convert.arr);
		}

	    
		//if ((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)) 
		//{
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[20],dc_admn_date.arr);
	    fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[240],l_pat_reln_with_gl_holder1.arr);
	    lsr_line_cnt();
		//}
		
		
		if(d_dis_date.arr[0]!='\0')
		{
		  init_date_temp_var();
		  strcpy(date_convert.arr,d_dis_date.arr);
		  fun_change_loc_date1();
		  strcpy(d_dis_date.arr,date_convert.arr);
		}

	    
		//if ((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0))
		//{
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[40],d_dis_date.arr);
		fprintf(fp,"%-18.18s  %-25.25s\n","",l_pat_reln_with_gl_holder2.arr);
		lsr_line_cnt();
		//}
		//else
		//fprintf(fp,"\n");
		//lsr_line_cnt();
		//fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[40],dc_admn_date.arr);
		//else
		
	 //printing patient id


	 	if(d_date_of_birth.arr[0]!='\0')
		{
		  init_date_temp_var();
		  strcpy(date_convert.arr,d_date_of_birth.arr);
		  fun_change_loc_date();
		  strcpy(d_date_of_birth.arr,nd_loc_date1.arr);
		 }

	
		fprintf(fp,"%-17.17s: %-25.25s \n",loc_legend[50],d_patient_id.arr);   
	    fprintf(fp,"%-6.6s/%-10.10s: %-11.11s /%-10.10s",loc_legend[1200],loc_legend[1411],d_date_of_birth.arr,d_gender_desc.arr);
		get_location();
		if(d_location.arr[0]!='\0')
		fprintf(fp,"   %-18.18s: %-25.25s\n",loc_legend[1407],d_location.arr);
	    else
        fprintf(fp,"\n");
		lsr_line_cnt();

	   //printing episode id

		fprintf(fp,"%-17.17s: %1s",loc_legend[90],d_episode_type.arr); 
		if (strcmp(d_episode_type.arr,"R")!=0)
       	fprintf(fp,"/%-8.8s",d_episode_id.arr); 
		if ((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)) 
		fprintf(fp,"/%-4.4s",d_visit_id.arr);
		else
		fprintf(fp,"%-5.5s"," ");
		
	 /**** Treating Adm.Doct ****/
     	get_attd_admit_pract();
		pract_name_1.arr[0]='\0';
		pract_name_1.len=0;
		nd_pract_id.arr[0]='\0';
		nd_pract_id.len=0;

	    if(d_attend_practitioner_id.arr[0]!='\0' && d_admit_practitioner_id.arr[0]!='\0') 
	    {
	 		if(strcmp(d_attend_practitioner_id.arr,d_admit_practitioner_id.arr)==0)
			{
			  strcpy(nd_pract_id.arr,d_attend_practitioner_id.arr);
			  nd_pract_id.len=strlen(d_attend_practitioner_id.arr);
		      nd_pract_id.arr[nd_pract_id.len]='\0';
			  get_pract_name();
			  fprintf(fp,"%-10.10s %-18.18s: %-30.30s"," ",loc_legend[1408],pract_name.arr);
			} 
			else
			if(strcmp(d_attend_practitioner_id.arr,d_admit_practitioner_id.arr)!=0)
			{
			  
			  strcpy(nd_pract_id.arr,d_attend_practitioner_id.arr);
			  nd_pract_id.len=strlen(d_attend_practitioner_id.arr);
		      nd_pract_id.arr[nd_pract_id.len]='\0';
			  get_pract_name();
			  strcpy(pract_name_1.arr,pract_name.arr);
			  strcat(pract_name_1.arr,"/");
			  nd_pract_id.arr[0]='\0';
			  strcpy(nd_pract_id.arr,d_admit_practitioner_id.arr);
			  nd_pract_id.len=strlen(d_admit_practitioner_id.arr);
		      nd_pract_id.arr[nd_pract_id.len]='\0';
			  get_pract_name(d_admit_practitioner_id.arr);
			  strcat(pract_name_1.arr,pract_name.arr);

			  fprintf(fp,"%-10.10s %-18.18s: %-30.30s"," ",loc_legend[1408],pract_name_1.arr);
			} 
		}
		else
		if(d_attend_practitioner_id.arr[0]!='\0' && d_admit_practitioner_id.arr[0]=='\0') 
		{
		 
		  strcpy(nd_pract_id.arr,d_attend_practitioner_id.arr);
		  nd_pract_id.len=strlen(d_attend_practitioner_id.arr);
		  nd_pract_id.arr[nd_pract_id.len]='\0';
		  get_pract_name();
		  fprintf(fp,"%-10.10s %-18.18s: %-15.15s"," ",loc_legend[1408],pract_name.arr);
		} 
        
		if(d_attend_practitioner_id.arr[0]=='\0' && d_admit_practitioner_id.arr[0]!='\0') 
		{
		  strcpy(nd_pract_id.arr,d_admit_practitioner_id.arr);
		  nd_pract_id.len=strlen(d_admit_practitioner_id.arr);
		  nd_pract_id.arr[nd_pract_id.len]='\0';
		  get_pract_name();
		  fprintf(fp,"%-10.10s %-18.18s: %-15.15s"," ",loc_legend[1408],pract_name.arr);
		} 
	    if(d_attend_practitioner_id.arr[0]!='\0' || d_admit_practitioner_id.arr[0]!='\0')
		{
		  fprintf(fp,"\n");
		  lsr_line_cnt();
		}
	   		
		if (d_org_dept.arr[0]!='\0')
		{
		 if(d_attend_practitioner_id.arr[0]!='\0' || d_admit_practitioner_id.arr[0]!='\0')
		 fprintf(fp,"   %-17.17s: %-100.100s \n",loc_legend[1210],d_org_dept.arr);
		 else
		 fprintf(fp,"\n   %-17.17s: %-100.100s \n",loc_legend[1210],d_org_dept.arr);
		}
		else
		{
		 if (d_org_dept.arr[0]=='\0' && d_attend_practitioner_id.arr[0]=='\0' && d_admit_practitioner_id.arr[0]=='\0')
		 fprintf(fp,"\n");
	    }
		lsr_line_cnt(); 
	    
	
	}
	else //added by raghava at 15/11/07 for printing header as same as laser format
	{

	    fprintf(fp,"\n%-42.42s%-80.80s\n"," ",nd_hosp_name.arr);
		lsr_line_cnt();lsr_line_cnt();
		fprintf(fp,"%-42.42s%-80.80s\n\n"," ",nd_telfax.arr);
		lsr_line_cnt();
		//fprintf(fp,"%-80.80s\n\n",loc_legend[300]); commented for scrum remerging
		fprintf(fp,"%-80.80s\n\n",loc_legend[991]); //ADDED FOR SCRUM CRF-654
		lsr_line_cnt();lsr_line_cnt();
		//fprintf(fp,"%-s: %-s ",loc_legend[70],d1_doc_type_num.arr); commented for scrum crf-654

		if(d1_doc_date.arr[0]!='\0')
		{
		  init_date_temp_var();
		  strcpy(date_convert.arr,d1_doc_date.arr);
		  fun_change_loc_date();
		  strcpy(d1_doc_date1.arr,nd_loc_date1.arr);
		}
		
		//fprintf(fp,"%-s: %-s      ",loc_legend[80],d1_doc_date1.arr); commented for scrum crf-654

		if(l_no_settlement_details.arr[0]!='R' || l_no_settlement_details.arr[0]=='\0')
		{
			if (strcmp(dc_bill_print_flag.arr,"Y") == 0)
			{			
			   
				fprintf(fp,"%35.35s: %-s ",loc_legend[290],nd_curr_date1.arr);
				fprintf(fp,"\n\n\n");
				lsr_line_cnt();lsr_line_cnt();lsr_line_cnt();
			}
			
			else
			{
				fprintf(fp,"\n\n\n");
				lsr_line_cnt();lsr_line_cnt();lsr_line_cnt();
			}
		}
		
		fprintf(fp,"%-45.45s",loc_legend[560]);
	    fprintf(fp,"%-45.45s\n",loc_legend[570]);	    
	    lsr_line_cnt();

		if(strcmp(d_cust_code.arr,"\0")!=0 && lcol_cnt == 1)
		prt_line_uc();
	    if(strcmp(d_cust_code.arr,"\0")!=0  && lcol_cnt == 2)
	    prt_line_uc_wide();

		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 1)
		prt_line_uc();
		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 2)
		prt_line_uc_wide();
		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 3)
		prt_line_uc_wide1();
		if(strcmp(d_cust_code.arr,"\0")==0 && (lcol_cnt == 6 || lcol_cnt == 5))
		prt_line_uc_wide2();
	   
	    fprintf(fp,"\n");    
	    lsr_line_cnt();
		
		dc_short_name1.arr[i] = '\0';
	    dc_short_name1.len = 0;	    

	    dc_short_name2.arr[0] = '\0';
	    dc_short_name2.len = 0;	    

	    dc_short_name3.arr[0] = '\0';
	    dc_short_name3.len = 0;	    

	    r_ctr = 0;   
	    if (dc_short_name.len >0)	
        split_text(dc_short_name.arr,25,dc_short_name1.arr,&r_ctr);	 
	    if (dc_short_name.len >25)
	    split_text(dc_short_name.arr,25,dc_short_name2.arr,&r_ctr);
	    if (dc_short_name.len >50)
	    split_text(dc_short_name.arr,25,dc_short_name3.arr,&r_ctr);	    
	    
	    
	    l_gl_holder_name1.arr[0] = '\0';
	    l_gl_holder_name1.len = 0;

	    l_gl_holder_name2.arr[0] = '\0';
	    l_gl_holder_name2.len = 0;	    


        r_ctr = 0; 
	    if(l_gl_holder_name.len > 0)
	    split_text(l_gl_holder_name.arr,25,l_gl_holder_name1.arr,&r_ctr);	    
	    if(l_gl_holder_name.len > 25)
	    split_text(l_gl_holder_name.arr,25,l_gl_holder_name2.arr,&r_ctr);	    
	    
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[100],dc_short_name1.arr);
		fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[571],l_gl_holder_name1.arr);
	    //fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[10],l_gl_holder_name1.arr);
	    lsr_line_cnt();
	    

	    if (dc_short_name2.arr[0] != '\0' || l_gl_holder_name2.arr[0] != '\0')
	    {
		  fprintf(fp,"%-17.17s  %-25.25s ","",dc_short_name2.arr);
	      fprintf(fp,"%-18.18s  %-25.25s\n","",l_gl_holder_name2.arr);
	      lsr_line_cnt();
	    }

	    if (dc_short_name3.arr[0] != '\0')
	    {
		  fprintf(fp,"%-17.17s  %-25.25s ","",dc_short_name3.arr);
	      fprintf(fp,"\n");
	      lsr_line_cnt();
	    }
	    
      //printing Patient Details 2nd line
      if(l_nric_number.arr[0]!='\0' || l_gl_ic.arr[0]!='\0')		
	   { 
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[560],l_nric_number.arr);   
	    fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[580],l_gl_ic.arr);   
	    lsr_line_cnt();	
	   }
	 
      
	  if(l_bill_contact_name_p.arr[0]!='\0' || l_credit_doc_ref_desc.arr[0]!='\0' 
	     || l_bill_contact_name_title_p.arr[0]!='\0')
	   {
	    fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[590],l_bill_contact_name_p.arr);	    
	    fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[600],l_credit_doc_ref_desc.arr);
	    lsr_line_cnt();
	   }
	   
	   
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_contact_name_title_p.arr); 
		   	    	    
	  if(l_bill_contact_name_title_c.arr[0]!='\0' || l_bill_long_desc_p.arr[0]!='\0' ||
	     l_bill_long_desc_c.arr[0]!='\0' || l_bill_add1_desc_p.arr[0]!='\0' ||
		 l_bill_add1_desc_c.arr[0]!='\0' || l_bill_add2_desc_p.arr[0]!='\0' ||
		 l_bill_add2_desc_c.arr[0]!='\0' || l_bill_add3_desc_p.arr[0]!='\0' ||
		 l_bill_add3_desc_p.arr[0]!='\0' || l_bill_add3_desc_c.arr[0]!='\0')
	   {  
	    
		fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[610],l_bill_contact_name_title_c.arr);   
	    lsr_line_cnt();
      
	   		
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_long_desc_p.arr);	        
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_long_desc_c.arr);
	    lsr_line_cnt();

	   
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_add1_desc_p.arr);	    
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_add1_desc_c.arr);
	    lsr_line_cnt();
	   

	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_add2_desc_p.arr);	    
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_add2_desc_c.arr);
	    lsr_line_cnt();
		
	   
	    fprintf(fp,"%-17.17s  %-25.25s ","",l_bill_add3_desc_p.arr);	    
	    fprintf(fp,"%-18.18s  %-25.25s\n","",l_bill_add3_desc_c.arr);	    
	    lsr_line_cnt();

	  }
	  else
	  fprintf(fp,"\n");
	    if (l_pat_reln_with_gl_holder.arr[0] != '\0')
	    {

        l_pat_reln_with_gl_holder1.arr[0] = '\0';
		l_pat_reln_with_gl_holder1.len = 0;

		r_ctr = 0; 
		if(l_pat_reln_with_gl_holder.len > 0)
		split_text(l_pat_reln_with_gl_holder.arr,25,l_pat_reln_with_gl_holder1.arr,&r_ctr);
		if(l_pat_reln_with_gl_holder.len > 25)
		split_text(l_pat_reln_with_gl_holder.arr,25,l_pat_reln_with_gl_holder2.arr,&r_ctr);
	    }
		
    //printing admission date & discharge date

	
		if(dc_admn_date.arr[0]!='\0')
		{
			init_date_temp_var();
			strcpy(date_convert.arr,dc_admn_date.arr);
			fun_change_loc_date1();
			strcpy(dc_admn_date.arr,date_convert.arr);
		}

	    
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[20],dc_admn_date.arr);
	    fprintf(fp,"%-18.18s: %-25.25s\n",loc_legend[240],l_pat_reln_with_gl_holder1.arr);
	    lsr_line_cnt();
		
		
		 if(d_dis_date.arr[0]!='\0')
		{
			init_date_temp_var();
			strcpy(date_convert.arr,d_dis_date.arr);
			fun_change_loc_date1();
			strcpy(d_dis_date.arr,date_convert.arr);
		}

	    
		fprintf(fp,"%-17.17s: %-25.25s ",loc_legend[40],d_dis_date.arr);
	    if(l_pat_reln_with_gl_holder2.arr[0]!='\0')
	 	fprintf(fp,"%-18.18s  %-25.25s\n","",l_pat_reln_with_gl_holder2.arr);
	    lsr_line_cnt();
	
	 //printing patient id

	    if(d_date_of_birth.arr[0]!='\0')
		{
		  init_date_temp_var();
		  strcpy(date_convert.arr,d_date_of_birth.arr);
		  fun_change_loc_date();
		  strcpy(d_date_of_birth.arr,nd_loc_date1.arr);
		 }

		fprintf(fp,"%-17.17s: %-25.25s \n",loc_legend[50],d_patient_id.arr);   
	    fprintf(fp,"%-6.6s/%-10.10s: %-11.11s /%-10.10s",loc_legend[1200],loc_legend[1411],d_date_of_birth.arr,d_gender_desc.arr);
		get_location();
		if(d_location.arr[0]!='\0')
		fprintf(fp,"   %-18.18s: %-25.25s",loc_legend[1407],d_location.arr);
		if (d_org_dept.arr[0]!='\0')
		fprintf(fp,"\n   %-18.18s: %-100.100s \n",loc_legend[1210],d_org_dept.arr);
		else
		fprintf(fp,"\n");
	    lsr_line_cnt();
   
	//printing episode id

		fprintf(fp,"%-17.17s: %1s",loc_legend[90],d_episode_type.arr); 

		if (strcmp(d_episode_type.arr,"R")!=0)
       	fprintf(fp,"/%-8.8s",d_episode_id.arr); 
			
		if ((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)) 
		fprintf(fp,"/%-4.4s\n",d_visit_id.arr);
		else
		fprintf(fp,"%-5.5s\n"," ");	
	 	
		/**** Treating Adm.Doct ****/
        get_attd_admit_pract();
		pract_name_1.arr[0]='\0';
		pract_name_1.len=0;
		nd_pract_id.arr[0]='\0';
		nd_pract_id.len=0;

	    if(d_attend_practitioner_id.arr[0]!='\0' && d_admit_practitioner_id.arr[0]!='\0') 
	    {
	 		if(strcmp(d_attend_practitioner_id.arr,d_admit_practitioner_id.arr)==0)
			{
			  strcpy(nd_pract_id.arr,d_attend_practitioner_id.arr);
			  nd_pract_id.len=strlen(d_attend_practitioner_id.arr);
		      nd_pract_id.arr[nd_pract_id.len]='\0';
			  get_pract_name();
			  fprintf(fp,"%-10.10s %-18.18s: %-30.30s\n"," ",loc_legend[1408],pract_name.arr);
			} 
			else
			if(strcmp(d_attend_practitioner_id.arr,d_admit_practitioner_id.arr)!=0)
			{
			  
			  strcpy(nd_pract_id.arr,d_attend_practitioner_id.arr);
			  nd_pract_id.len=strlen(d_attend_practitioner_id.arr);
		      nd_pract_id.arr[nd_pract_id.len]='\0';
			  get_pract_name();
			  strcpy(pract_name_1.arr,pract_name.arr);
			  strcat(pract_name_1.arr,"/");
			  nd_pract_id.arr[0]='\0';
			  strcpy(nd_pract_id.arr,d_admit_practitioner_id.arr);
			  nd_pract_id.len=strlen(d_admit_practitioner_id.arr);
		      nd_pract_id.arr[nd_pract_id.len]='\0';
			  get_pract_name(d_admit_practitioner_id.arr);
			  strcat(pract_name_1.arr,pract_name.arr);

			  fprintf(fp,"%-10.10s %-18.18s: %-30.30s\n"," ",loc_legend[1408],pract_name_1.arr);
			} 
		}
		else
		if(d_attend_practitioner_id.arr[0]!='\0' && d_admit_practitioner_id.arr[0]=='\0') 
		{
		 
		  strcpy(nd_pract_id.arr,d_attend_practitioner_id.arr);
		  nd_pract_id.len=strlen(d_attend_practitioner_id.arr);
		  nd_pract_id.arr[nd_pract_id.len]='\0';
		  get_pract_name();
		  fprintf(fp,"%-10.10s %-18.18s: %-15.15s/%-15.15s\n"," ",loc_legend[1408],pract_name.arr," ");
		} 
        
		if(d_attend_practitioner_id.arr[0]=='\0' && d_admit_practitioner_id.arr[0]!='\0') 
		{
		  strcpy(nd_pract_id.arr,d_admit_practitioner_id.arr);
		  nd_pract_id.len=strlen(d_admit_practitioner_id.arr);
		  nd_pract_id.arr[nd_pract_id.len]='\0';
		  get_pract_name();
		  fprintf(fp,"%-10.10s %-18.18s: %-15.15s/%-15.15s\n"," ",loc_legend[1408]," ",pract_name.arr);
		} 
	
	    if(d_attend_practitioner_id.arr[0]=='\0' && d_admit_practitioner_id.arr[0]=='\0') 
		fprintf(fp,"\n");
		lsr_line_cnt();
	    
	}

	  if (dc_ind.arr[0] == 'P')
		strcpy(bill_title.arr,loc_legend[320]);
	  else if (dc_ind.arr[0] == 'I')
		strcpy(bill_title.arr,loc_legend[330]);
	  else
		strcpy(bill_title.arr," ");
	
	
	if (nd_reprint_yn == 'Y')
	{
		
		/*
		if (strcmp(dc_bill_print_flag.arr,"Y") == 0)
		{    
		     //fprintf(fp,"%c(s4H",ESC);
			
		     if (l_lsr != 0 && l_dmp == 0)
		     {		        
			  
				fprintf(fp,"%52.52s        ",bill_title.arr);
				fprintf(fp,"%-17.17s: %-40.40s ",loc_legend[290],nd_curr_date1.arr);
				fprintf(fp,"\n");
		 			
		     }
		     else
		     {
				//fprintf(fp,"%-79.79s %s\n"," ",loc_legend[190]);
				fprintf(fp,"%52.52s        ",bill_title.arr);
				fprintf(fp,"%-17.17s: %-40.40s ",loc_legend[290],nd_curr_date1.arr);
				fprintf(fp,"\n");
				lsr_line_cnt();
		     }
		     // fprintf(fp,"%c&k2S",ESC);
		}
		
		else
		{
		     if (l_lsr != 0 && l_dmp == 0)
		     {
			//
		     }
		     else
		     {
			  fprintf(fp,"%52.52s        \n\n", bill_title.arr);
		     }
		}
		*/
	}
	else
	{
	   if (l_lsr != 0 && l_dmp == 0)
	   {
		//
	   }
	   else
	   {
		fprintf(fp,"%57.57s        \n\n",bill_title.arr);
	   }

	}

	/* LINE 3 */

	//if(d_bill_nature_code.arr[0] == 'C')
	//	fprintf(fp,"%-16.16s : %-20.20s ",loc_legend[10],dc_credit_doc_ref_desc.arr);
	//else

	if(d_bill_nature_code.arr[0] == 'A')
	{
	
	  if (l_lsr != 0 && l_dmp == 0)
	  {
	    
		
		//fprintf(fp,"%-20.20s : %-20.20s ",loc_legend[10],dc_long_name.arr);
		fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style */
	    
		//Below Code Added by Raghava on 28/10/2009 for IN13922
		
		get_detail_desc_for_cust();
	    len_desc = strlen(l_detail_desc.arr);
		while(r_ctrdesc < len_desc)
		{	
			split_text(l_detail_desc.arr,70,cl_string_desc,&r_ctrdesc);
			if(l_ctr==1)
			fprintf(fp,"%-16.16s : %-70.70s ",loc_legend[10],cl_string_desc);
			else
			fprintf(fp,"%-17.17s  %-70.70s "," ",cl_string_desc);
			strcpy(cl_string_desc,"");  
			fprintf(fp,"\n");lsr_line_cnt();
			l_ctr++;
		} 
		r_ctrdesc=0;
		l_ctr=1;
		
		//fprintf(fp,"%-16.16s : %-40.40s ",loc_legend[10],l_bill_long_desc_c.arr); Commented By raghava on 29/10/2009
		fprintf(fp,"%c(s-3B",ESC); 	/* To release Bold style */
	    fprintf(fp,"\n");
	    lsr_line_cnt();
	  }
	  else
	  {
		//fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style */
		fprintf(fp,"%-16.16s : %-40.40s ",loc_legend[10],l_bill_long_desc_c.arr);
		//fprintf(fp,"%c(s-3B",ESC); 	/* To release Bold style */
	    fprintf(fp,"\n");
	    lsr_line_cnt();
	  }

    }

	 if (l_lsr != 0 && l_dmp == 0)
     {
		//
     }

     /* FOR DMP PRINTER */
	 
	 /*
	 else
      {
		//fprintf(fp,"%-17.17s: %-40.40s ",loc_legend[10],l_gl_holder_name.arr);
		//fprintf(fp,"%-17.17s: %-40.40s ",loc_legend[10],l_bill_long_desc_c.arr);
		
		if(dc_admn_date.arr[0]!='\0')
		{
			init_date_temp_var();
			strcpy(date_convert.arr,dc_admn_date.arr);
			fun_change_loc_date1();
			strcpy(dc_admn_date.arr,date_convert.arr);
		}

		fprintf(fp,"%-60.60s%-17.17s: %-25.25s\n"," ",loc_legend[20],dc_admn_date.arr);	

		fprintf(fp,"%-17.17s: %-40.40s ",loc_legend[30],l_credit_doc_ref_desc.arr);

		if(d_dis_date.arr[0]!='\0')
		{
			init_date_temp_var();
			strcpy(date_convert.arr,d_dis_date.arr);
			fun_change_loc_date1();
			strcpy(d_dis_date.arr,date_convert.arr);
		}

		fprintf(fp,"%-17.17s: %-25.25s\n",loc_legend[40],d_dis_date.arr);
	
		//fprintf(fp,"%-55.55s",l_bill_contact_name_title.arr);
	
	
		if((strlen(l_bill_contact_name.arr)>0)&&(strlen(l_bill_contact_name_title.arr)>0))
			fprintf(fp,"%-19.19s%-19.19s/%-20.20s"," ",l_bill_contact_name.arr, l_bill_contact_name_title.arr);
		else if((strlen(l_bill_contact_name.arr)>0)||(strlen(l_bill_contact_name_title.arr)==0)) 
			fprintf(fp,"%-19.19s%-40.40s"," ",l_bill_contact_name.arr);
		else if((strlen(l_bill_contact_name.arr)==0)||(strlen(l_bill_contact_name_title.arr)>0)) 
			fprintf(fp,"%-19.19s%-40.40s"," ",l_bill_contact_name_title.arr);
		else if((strlen(l_bill_contact_name.arr)==0)||(strlen(l_bill_contact_name_title.arr)==0))
			fprintf(fp,"%-19.19s%-19.19s %-20.20s"," "," ", " ");
		
		fprintf(fp," %-17.17s: %-20.20s\n",loc_legend[50],d_patient_id.arr);   

		//fprintf(fp,"%-55.55s",l_bill_long_desc.arr);
		fprintf(fp,"%-19.19s%-40.40s"," ",l_bill_long_desc.arr);
		fprintf(fp," %-17.17s: %-20.20s\n",loc_legend[560],l_nric_number.arr);   

		//fprintf(fp,"%-55.55s",l_bill_add1_desc.arr);
		fprintf(fp,"%-19.19s%-40.40s"," ",l_bill_add1_desc.arr);
		
		//fprintf(fp," %-17.17s: %-s\n",loc_legend[70],d1_doc_type_num.arr); commented for scrum crf-654

		//fprintf(fp,"%-55.55s",l_bill_add2_desc.arr);
		fprintf(fp,"%-19.19s%-40.40s"," ",l_bill_add2_desc.arr);

		if(d1_doc_date.arr[0]!='\0')
		{
		  init_date_temp_var();
		  strcpy(date_convert.arr,d1_doc_date.arr);
		  fun_change_loc_date();
		  strcpy(d1_doc_date1.arr,nd_loc_date1.arr);
		 }
		//fprintf(fp," %-17.17s: %-12.12s\n",loc_legend[80],d1_doc_date1.arr); commented for scrum crf-654
	
	  	//fprintf(fp,"%-55.55s"," ",l_bill_add3_desc.arr);
		fprintf(fp,"%-19.19s%-40.40s"," ",l_bill_add3_desc.arr);

		fprintf(fp," %-17.17s: %1s",loc_legend[90],d_episode_type.arr); 

		if (strcmp(d_episode_type.arr,"R")!=0)
       	fprintf(fp,"/%-8s",d_episode_id.arr); 
			
		if ((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)) 
			fprintf(fp,"/%-4s\n",d_visit_id.arr);	
	    else
			fprintf(fp,"\n");
		
		lsr_line_cnt();


		// LINE 4 
	
		//After Incoropation Pat Relation legend	
		fprintf(fp,"%-17.17s: %-40.40s ",loc_legend[100],dc_short_name.arr);
		fprintf(fp,"%-17.17s: %-16.16s",loc_legend[240],l_pat_reln_with_gl_holder.arr);

		fprintf(fp,"\n");
		lsr_line_cnt();
	}*/

		//check_report_format();

		/* LINE 5 */
		//if(d_summary_yn=='Y')

	if (l_lsr != 0 && l_dmp == 0)
	{
	   if(strcmp(d_cust_code.arr,"\0")!=0 && lcol_cnt == 1)
		prt_line_uc();
	   if(strcmp(d_cust_code.arr,"\0")!=0  && lcol_cnt == 2)
	    prt_line_uc_wide();

		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 1)
		prt_line_uc();
		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 2)
		prt_line_uc_wide();
		if(strcmp(d_cust_code.arr,"\0")==0 && lcol_cnt == 3)
		prt_line_uc_wide1();
		if(strcmp(d_cust_code.arr,"\0")==0 && (lcol_cnt == 6 || lcol_cnt == 5))
		prt_line_uc_wide2();
				
				
		fprintf(fp,"\n");
		lsr_line_cnt();
		if (l_main_hdr == 0)
		{
			// no need to print Subhdr 
		}
		else
		{
			
			//fprintf(fp,"%6s %-20.20s %5s %-20.20s        %8.8s \n"," ",loc_legend[110]," "," ",currency.arr);		
			fprintf(fp,"%6s %-20.20s %5s %-20.20s (%s %s)\n  "," "," "," "," ",loc_legend[1401],currency.arr);		
			//fprintf(fp,"%-35s %21s %17s %17.17s\n",loc_legend[770],loc_legend[680],loc_legend[820],loc_legend[830]);
			lsr_line_cnt();
		    l_cnt=l_cnt+1;
			/*if(l_cnt==2)
			{ 
		    prt_line();
			fprintf(fp,"\n");
			lsr_line_cnt();
			}*/	
		}
	}	
	else
	{	
		prt_line_uc();
		fprintf(fp,"\n");lsr_line_cnt();
		//fprintf(fp,"%6s %-20.20s %5s %-20.20s        %8.8s  \n"," ",loc_legend[110]," "," ",currency.arr);
	    fprintf(fp,"%6s %-20.20s %5s %-20.20s        %8.8s  \n"," "," "," "," ",currency.arr);
		lsr_line_cnt();
		l_cnt=l_cnt+1;
		/*if(l_cnt==2)
		{ 
		prt_line();
		fprintf(fp,"\n");
		lsr_line_cnt();
		}*/	
	}

		//else			
		//fprintf(fp,"%6s %-20.20s %5s %-20.20s %12s%-20.20s\n\n"," ",loc_legend[110]," ",loc_legend[180]," ",loc_legend[120]);
	
	if (l_lsr != 0 && l_dmp == 0)
	{
		l_main_hdr = 1;
	}
	else
	{
		v_lno = 0;
	}

	 }

 }  
 else  //billformatid !=1
 {

  	
	fprintf(fp,"%c(s14H",ESC);
	fprintf(fp,"%c(s-3B",ESC);
    	
	fetch_dtl();
	
    print_title();
	
	print_bill_title();
	
	print_addl_line();
		 
	print_body();
	
	prt_line_uc_wide();
   	if(nd_print_option.arr[0]=='R')
	fun_bl_report_temp_format();
	else
	fprintf(fp,"\n");
   
    line_ctr++;
	get_currency();

	if(nd_print_option.arr[0]=='R')
	{
	  fun_add_space(55);
	  strcat(nd_line_text.arr,"(");
	  strcat(nd_line_text.arr,loc_legend[1401]);
	  strcat(nd_line_text.arr,currency.arr);
	  strcat(nd_line_text.arr,")");
	  fun_bl_report_temp_format();
	}
	else
	fprintf(fp,"%6s %-20.20s %5s %-20.20s (%s %s)\n  "," "," "," "," ",loc_legend[1401],currency.arr);
	
   if (l_lsr != 0 && l_dmp == 0)
	{
		l_main_hdr = 1;
	}
	else
	{
		v_lno = 0;
	}
	v_lno=line_ctr; //Added by raghava on 24/11/2009

 }


}  //end of print_report_head procedure
/**** Added by Raghava For CRF-521 *******/
get_detail_desc_for_cust()
{
		l_detail_desc.arr[0]='\0';
		l_detail_desc.len=0;
  /* EXEC SQL SELECT	NVL(DETAIL_DESC,LONG_NAME)
		            INTO 
				    l_detail_desc
		FROM ar_customer_lang_vw
		WHERE cust_code = :d_cust_code
		AND LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select NVL(DETAIL_DESC,LONG_NAME) into :b0  from ar_custome\
r_lang_vw where (cust_code=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4513;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_detail_desc;
  sqlstm.sqhstl[0] = (unsigned int  )502;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_cust_code;
  sqlstm.sqhstl[1] = (unsigned int  )27;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  

		  if (OERROR)
		  err_mesg("SELECT failed on table ar_customer_lang_vw",0,"");

   l_detail_desc.arr[l_detail_desc.len] = '\0';
 }


print_footer1()  
{
     	
  if (strcmp(nd_bill_format_id.arr,"1")==0)	 // need to check senthil
    {  
    l_bill_page_no++;
  	if(nd_print_option.arr[0]=='R')
	{
	 if(strlen(loc_legend[210])<80)
     {
	  fun_add_space(80-strlen(loc_legend[210]));
	  strcat(nd_line_text.arr,loc_legend[210]);
     }
     else
     strncat(nd_line_text.arr,loc_legend[210],80);
	}
	else
	fprintf(fp,"%80.80s %d\n",loc_legend[210],l_bill_page_no);
  }
  else
  {
 	l_bill_page_no_frmt2++;
  	if(nd_print_option.arr[0]=='R')
	{
	 if(strlen(loc_legend[210])<80)
     {
	  fun_add_space(80-strlen(loc_legend[210]));
	  strcat(nd_line_text.arr,loc_legend[210]);
     }
     else
     strncat(nd_line_text.arr,loc_legend[210],80);
	}
	else
	fprintf(fp,"%80.80s %d\n",loc_legend[210],l_bill_page_no_frmt2);
  }

}
get_rounded_amt(nd_payable_amt)
{
  
  get_round_flag();

	/* EXEC SQL EXECUTE
	BEGIN
		blcommon.proc_get_rounded_Amt(:nd_payable_amt,
									  :nd_round_flag,
									  :nd_net_pay_amt_after_rounded,
									  :nd_rounded_amt
									  );

	END;
	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin blcommon . proc_get_rounded_Amt ( :nd_payable_amt , :n\
d_round_flag , :nd_net_pay_amt_after_rounded , :nd_rounded_amt ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4540;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_payable_amt;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_round_flag;
 sqlstm.sqhstl[1] = (unsigned int  )4;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_net_pay_amt_after_rounded;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_rounded_amt;
 sqlstm.sqhstl[3] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}





}
get_round_flag()
{

nd_round_flag.arr[0]='\0';
nd_round_flag.len=0;

/* EXEC SQL SELECT nvl(BILL_ROUNDING_IND,0) 
		 INTO :nd_round_flag
		 FROM BL_PARAMETERS	
         WHERE OPERATING_FACILITY_ID=:nd_facility_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select nvl(BILL_ROUNDING_IND,0) into :b0  from BL_PARAMETERS \
where OPERATING_FACILITY_ID=:b1";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )4571;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&nd_round_flag;
sqlstm.sqhstl[0] = (unsigned int  )4;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



nd_round_flag.arr[nd_round_flag.len]='\0';
}
/* FOR GETTING DISCHARGE DATE */

get_adm_dis_date()
{

 dc_admn_date.arr[dc_admn_date.len]='\0';
 d_dis_date.arr[d_dis_date.len]    ='\0';
 dc_admn_date.len=0;
 d_dis_date.len  =0;
 
   /* EXEC SQL  Select TO_CHAR(ADM_VISIT_DATE,'DD/MM/YYYY HH24:MI')ADM_VISIT_DATE,
		   TO_CHAR(DISCHARGE_DATE_TIME,'DD/MM/YYYY HH24:MI')DISCHARGE_DATE_TIME
		   INTO
		   :dc_admn_date,
		   :d_dis_date
           FROM BL_ENCOUNTER_FOR_QRY_VW
           WHERE
		   FACILITY_ID		= :nd_facility_id
		   AND nvl(LANGUAGE_ID,:nd_lang_id)  = :nd_lang_id
		   AND EPISODE_TYPE = :d_episode_type
		   AND ( :d_episode_type ='R' or (:d_episode_type not in ('R') and episode_id= :d_episode_id))
		   AND ( :d_episode_type in ('R','I','D') or (:d_episode_type in ('O','E') and VISIT_ID=:d_visit_id)); */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select TO_CHAR(ADM_VISIT_DATE,'DD/MM/YYYY HH24:MI') ADM_VI\
SIT_DATE ,TO_CHAR(DISCHARGE_DATE_TIME,'DD/MM/YYYY HH24:MI') DISCHARGE_DATE_TIM\
E into :b0,:b1  from BL_ENCOUNTER_FOR_QRY_VW where ((((FACILITY_ID=:b2 and nvl\
(LANGUAGE_ID,:b3)=:b3) and EPISODE_TYPE=:b5) and (:b5='R' or (:b5 not  in ('R'\
) and episode_id=:b8))) and (:b5 in ('R','I','D') or (:b5 in ('O','E') and VIS\
IT_ID=:b11)))";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )4594;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&dc_admn_date;
   sqlstm.sqhstl[0] = (unsigned int  )19;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&d_dis_date;
   sqlstm.sqhstl[1] = (unsigned int  )19;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )5;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[3] = (unsigned int  )6;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[4] = (unsigned int  )6;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
   sqlstm.sqhstl[5] = (unsigned int  )4;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
   sqlstm.sqhstl[6] = (unsigned int  )4;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&d_episode_type;
   sqlstm.sqhstl[7] = (unsigned int  )4;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&d_episode_id;
   sqlstm.sqhstl[8] = (unsigned int  )11;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&d_episode_type;
   sqlstm.sqhstl[9] = (unsigned int  )4;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&d_episode_type;
   sqlstm.sqhstl[10] = (unsigned int  )4;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&d_visit_id;
   sqlstm.sqhstl[11] = (unsigned int  )7;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (OERROR) 
	{	
	  disp_message (ERR_MESG,"Failed to FETCH FROM BL_ENCOUNTER_FOR_QRY_VW");

	}
     dc_admn_date.arr[dc_admn_date.len] ='\0';
	 d_dis_date.arr[d_dis_date.len]	    ='\0';
	 

}

prt_line()
{
  int i;
  {
    for (i=0;i<105;i++)
    {
	 if ( l_logo_yniflaser.arr[0] == 'Y')	
		fprintf(fp,"%c",175);
	 else
		fprintf(fp,"_");		     
    }
  } 	      
}


prt_line_uc_wide()
{
  int i;
  {
     for (i=0;i<105;i++)
     {
	  if(nd_print_option.arr[0]=='R')
	   strcat(nd_line_text.arr,"_");
      else
	  fprintf(fp,"_");		     
     }
  } 	      
}

prt_line_uc_wide1()
{
  int i;
  {
     for (i=0;i<120;i++)
     {
	  if(nd_print_option.arr[0]=='R')
	  strcat(nd_line_text.arr,"_");
	  else
	  fprintf(fp,"_");		     
     }
  } 	      
}
prt_line_uc_wide2()
{
  int i;
  {
     for (i=0;i<125;i++)
     {
	  if(nd_print_option.arr[0]=='R')
	  strcat(nd_line_text.arr,"_");
	  else
	  fprintf(fp,"_");		     
     }
  } 	      
}

prt_line_uc()
{
  int i;
  {
     for (i=0;i<105;i++)
     {
	  if(nd_print_option.arr[0]=='R')
	  strcat(nd_line_text.arr,"_");
	  else
	  fprintf(fp,"_");		     
     }
  } 	      
}

lsr_line_cnt()
{
	if (l_lsr != 0 && l_dmp == 0)
	{
	  v_lno = v_lno  + 1;

	  if (v_lno > max_lines) 
	  print_next_page1();
	  
	}

}


delete_sy_prog()
{
  
	/* EXEC SQL DELETE FROM SY_PROG_PARAM
			  WHERE PGM_ID     = 'BLR00101'  //ADDED FOR SCRUM CRF-654 'BLRVSBIL' 
			  AND SESSION_ID = :nd_session_id
			  AND PGM_DATE   = :nd_pgm_date; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "delete  from SY_PROG_PARAM  where ((PGM_ID='BLR00101' and SE\
SSION_ID=:b0) and PGM_DATE=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4657;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_session_id;
 sqlstm.sqhstl[0] = (unsigned int  )18;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_pgm_date;
 sqlstm.sqhstl[1] = (unsigned int  )15;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/* EXEC SQL COMMIT WORK; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )4680;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	return 1;
}

delete_bill_print_temp()
{

	/* EXEC SQL DELETE FROM BL_BILL_PRINT_TEMP
			 WHERE  SESSION_ID = :nd_session_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "delete  from BL_BILL_PRINT_TEMP  where SESSION_ID=:b0";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4695;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_session_id;
 sqlstm.sqhstl[0] = (unsigned int  )18;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




/* EXEC SQL COMMIT WORK; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )4714;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	return 1;
}


print_footer()
 {
    int i,r,j,l;
	char first_line_yn;
    int no_of_lines = 0;

   if (l_lsr != 0 && l_dmp == 0 )
			{
			   /*-----------------------22/09/2005------------------*/

	            if (loc_legend[390][0] != '\0' || loc_legend[400][0] != '\0'||
				   loc_legend[410][0] != '\0' || loc_legend[420][0] != '\0'||
				   loc_legend[430][0] != '\0' || loc_legend[440][0] != '\0'||
				   loc_legend[450][0] != '\0' || loc_legend[460][0] != '\0'||
				   loc_legend[470][0] != '\0' || loc_legend[480][0] != '\0'||
				   loc_legend[490][0] != '\0' || loc_legend[500][0] != '\0'||
				   loc_legend[510][0] != '\0' || loc_legend[520][0] != '\0'||
				   loc_legend[530][0] != '\0' || loc_legend[540][0] != '\0') 
			     {
				   remarks_cnt_chk();


				   while(v_lno <= (max_lines-l_lno-5))
				   {
					fprintf(fp,"\n");
					v_lno++;
				   }


				   // This  is a check for accommodating remarks with in a page.

				    l_main_hdr = 0;	
				    fprintf(fp,"\n"); 
				    v_lno++;
				    if (v_lno > max_lines) print_next_page1();
				    

				if (l_lsr != 0 && l_dmp == 0)
				{
				if (l_logo_yniflaser.arr[0] != 'Y')			    
				{
				      fprintf(fp,"%c9",ESC);        /* To Release the margin */				  
				      fprintf(fp,"%c(s8H",ESC); 	/* To set the font size*/
				      fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style */
				      
				      l_main_hdr = 0;
				      fprintf(fp,"\n");					      
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				}
				}

					/*if (loc_legend[390][0]	!= '\0')
					{
					fprintf(fp,"%-s\n\n",loc_legend[390]);
					l_main_hdr = 0;
					 v_lno=v_lno+2;
					 if (v_lno > max_lines) print_next_page1();
					}*/
				
				if (l_lsr != 0 && l_dmp == 0)
				{
				if (l_logo_yniflaser.arr[0] != 'Y')			    
				{
				      fprintf(fp,"%c(s12.5H",ESC); 	/* To set the font size	  */
				}
				  
				  }  				      
				      /*if (loc_legend[400][0] != '\0')	
				      {
				      fprintf(fp,"%-s\n",loc_legend[400]); 
				      l_main_hdr = 0;
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				      if (loc_legend[410][0] != '\0') 
				      {
				      fprintf(fp,"%-s\n",loc_legend[410]);
				      l_main_hdr = 0;
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				      if (loc_legend[420][0] != '\0') 
				      {
				      l_main_hdr = 0;
				      fprintf(fp,"%-s\n",loc_legend[420]);
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				      if (loc_legend[430][0] != '\0') 
				      {
				      l_main_hdr = 0;
				      fprintf(fp,"%-s\n",loc_legend[430]);
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				      if (loc_legend[440][0] != '\0') 
				      {
				      l_main_hdr = 0;
				      fprintf(fp,"%-s\n",loc_legend[440]);
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				      if (loc_legend[450][0] != '\0') 
				      {
				      l_main_hdr = 0;
				      fprintf(fp,"%-s\n",loc_legend[450]);
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				      if (loc_legend[460][0] != '\0') 
				      {
				      l_main_hdr = 0;
				       fprintf(fp,"%-s\n",loc_legend[460]);
				       v_lno++;
				       if (v_lno > max_lines) print_next_page1();
				       }


				      if (loc_legend[470][0] != '\0') 
				      {
					l_main_hdr = 0;
				      fprintf(fp,"%-s\n",loc_legend[470]);
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				      if (loc_legend[480][0] != '\0') 
				      {
				      l_main_hdr = 0;
				      fprintf(fp,"%-s\n",loc_legend[480]);
				      v_lno++;
				      if (v_lno > max_lines) print_next_page1();
				      }

				     
				     //fprintf(fp,"\n"); v_lno++;

				     if (loc_legend[490][0] != '\0') 
				     {
				     l_main_hdr = 0;
				     fprintf(fp,"%-s\n",loc_legend[490]);
				     v_lno++;
				     if (v_lno > max_lines) print_next_page1();
				     }

				     if (loc_legend[500][0] != '\0') 
				     {
				     l_main_hdr = 0;
				     fprintf(fp,"%-s\n",loc_legend[500]);
				     v_lno++;
				     if (v_lno > max_lines) print_next_page1();
				     }

				     if (loc_legend[510][0] != '\0') 
				     {
				     l_main_hdr = 0;
				     fprintf(fp,"%-s\n",loc_legend[510]);
				     v_lno++;
				     if (v_lno > max_lines) print_next_page1();
				     }

				     if (loc_legend[520][0] != '\0') 
				     {
				     l_main_hdr = 0;
				     fprintf(fp,"%-s\n",loc_legend[520]);
				     v_lno++;
				     if (v_lno > max_lines) print_next_page1();
				     }

				     if (loc_legend[530][0] != '\0') 
				     {
				     l_main_hdr = 0;
				     fprintf(fp,"%-s\n",loc_legend[530]);
				     v_lno++;
				     if (v_lno > max_lines) print_next_page1();
				     }

				     if (loc_legend[540][0] != '\0') 
				     {
				     l_main_hdr = 0;
				     fprintf(fp,"%-s\n",loc_legend[540]);
				     v_lno++;
				     if (v_lno > max_lines) print_next_page1();
				     }*/  //commented as per the instruction frm Kuila sir
				 }
				 else
				 {
					fprintf(fp,"\n");
					v_lno++;
				 }
				 
				 /*fprintf(fp,"%-s\n",loc_legend[550]);
				 v_lno++;*/
				
				                           
			/*	while(v_lno <= max_lines)
				{
					fprintf(fp,"\n");
					v_lno++;
				}
                             
				fprintf(fp,"\n\n");	
				v_lno=v_lno+2;
				*/					
		}
	}
			
/********************************************************/



remarks_cnt_chk()
{
      l_lno = 0;      
				    
      // fprintf(fp,"\n"); 
      l_lno++;			    

      if (l_logo_yniflaser.arr[0] != 'Y')			    
      {				      
	l_lno++;				    
      }

      if (loc_legend[390][0]	!= '\0')
      {					
	l_lno = l_lno + 2;
      }				    				      
      if (loc_legend[400][0] != '\0')	
      {      
	l_lno++;      
      }

      if (loc_legend[410][0] != '\0') 
      {				      
	l_lno++;      
      }

      if (loc_legend[420][0] != '\0') 
      {      
	l_lno++;      
      }

      if (loc_legend[430][0] != '\0') 
      {      
	l_lno++;      
      }

      if (loc_legend[440][0] != '\0') 
      {				      
	l_lno++;      
      }

      if (loc_legend[450][0] != '\0') 
      {				      
	l_lno++;      
      }

      if (loc_legend[460][0] != '\0') 
      {      
	l_lno++;       
      }

      if (loc_legend[470][0] != '\0') 
      {	
	l_lno++;      
      }

      if (loc_legend[480][0] != '\0') 
      {				      
	l_lno++;				      
      }			     

     if (loc_legend[490][0] != '\0') 
     {				     
	l_lno++;				     
     }

     if (loc_legend[500][0] != '\0') 
     {				     
	l_lno++;				     
     }

     if (loc_legend[510][0] != '\0') 
     {				     
	l_lno++;				     
     }

     if (loc_legend[520][0] != '\0') 
     {     
	l_lno++;     
     }

     if (loc_legend[530][0] != '\0') 
     {     
	l_lno++;     
     }

     if (loc_legend[540][0] != '\0') 
     {     
	l_lno++;     
     }                  
          
    //fprintf(fp,"%-s\n",loc_legend[550]); 
    
    l_lno++;   
    
    if ( (l_lno+v_lno) > max_lines) 
    {       
       print_next_page1();
    }		
}


last_line_prt()
{	
	fprintf(fp,"\n");
	last_line_check = 0;
	rec_out = 'Y';
}

fetch_legend_value()
{
	loc_legend1.arr[0]		= '\0';
	loc_legend2.arr[0]		= '\0';
	loc_legend3.arr[0]		= '\0';
	loc_legend4.arr[0]		= '\0';
	loc_legend5.arr[0]		= '\0';
	loc_legend6.arr[0]		= '\0';
	loc_legend7.arr[0]		= '\0';
	loc_legend8.arr[0]		= '\0';
	loc_legend9.arr[0]		= '\0';
	loc_legend10.arr[0]		= '\0';
	loc_legend11.arr[0]		= '\0';
	loc_legend12.arr[0]		= '\0';
	loc_legend13.arr[0]		= '\0';
	loc_legend14.arr[0]		= '\0';
	loc_legend15.arr[0]		= '\0';
	loc_legend16.arr[0]		= '\0';
	loc_legend17.arr[0]		= '\0';
	loc_legend18.arr[0]		= '\0';
	loc_legend19.arr[0]		= '\0';
	loc_legend20.arr[0]		= '\0';
	loc_legend21.arr[0]		= '\0';
	loc_legend22.arr[0]		= '\0';
	loc_legend23.arr[0]		= '\0';
	loc_legend24.arr[0]		= '\0';
	loc_legend25.arr[0]		= '\0';
	loc_legend26.arr[0]		= '\0';
	loc_legend27.arr[0]		= '\0';
	loc_legend28.arr[0]		= '\0';
	loc_legend29.arr[0]		= '\0';
	loc_legend30.arr[0]		= '\0';
	loc_legend31.arr[0]		= '\0';
	loc_legend32.arr[0]		= '\0';
	loc_legend33.arr[0]		= '\0';
	loc_legend34.arr[0]		= '\0';
	loc_legend35.arr[0]		= '\0';
	loc_legend36.arr[0]		= '\0';
	loc_legend37.arr[0]		= '\0';
	loc_legend38.arr[0]		= '\0';
	loc_legend39.arr[0]		= '\0';
	loc_legend40.arr[0]		= '\0';
	loc_legend41.arr[0]		= '\0';
	loc_legend42.arr[0]		= '\0';
	loc_legend43.arr[0]		= '\0';
	loc_legend44.arr[0]		= '\0';
	loc_legend45.arr[0]		= '\0';
	loc_legend46.arr[0]		= '\0';
	loc_legend47.arr[0]		= '\0';
	loc_legend48.arr[0]		= '\0';
	loc_legend49.arr[0]		= '\0';
	loc_legend50.arr[0]		= '\0';
	loc_legend51.arr[0]		= '\0';
	loc_legend52.arr[0]		= '\0';
	loc_legend53.arr[0]		= '\0';
	loc_legend54.arr[0]		= '\0';
	loc_legend55.arr[0]		= '\0';
	loc_legend56.arr[0]		= '\0';
	loc_legend57.arr[0]		= '\0';
	loc_legend58.arr[0]		= '\0';
	loc_legend59.arr[0]		= '\0';
	loc_legend60.arr[0]		= '\0';
	loc_legend61.arr[0]		= '\0';
	loc_legend62.arr[0]		= '\0';
	loc_legend63.arr[0]		= '\0';
		loc_legend68.arr[0]		= '\0';
		loc_legend69.arr[0]		= '\0';
		loc_legend70.arr[0]		= '\0';
		loc_legend71.arr[0]		= '\0';
		loc_legend72.arr[0]		= '\0';
		loc_legend73.arr[0]		= '\0';
		loc_legend74.arr[0]		= '\0';
		loc_legend75.arr[0]		= '\0';
		loc_legend76.arr[0]		= '\0';
		loc_legend[770][0]		= '\0';
		loc_legend78.arr[0]		= '\0';
		loc_legend79.arr[0]		= '\0';
		loc_legend80.arr[0]		= '\0';
		loc_legend81.arr[0]		= '\0';
		loc_legend82.arr[0]		= '\0';
		loc_legend83.arr[0]		= '\0';
		loc_legend84.arr[0]		= '\0';
		loc_legend85.arr[0]		= '\0';
		loc_legend91.arr[0]		= '\0'; //ADDED FOR SCRUM CRF-654
		loc_legend92.arr[0]		= '\0'; //ADDED FOR SCRUM CRF-654
        loc_legend93.arr[0]		= '\0'; //ADDED FOR SCRUM CRF-654
		loc_legend94.arr[0]		= '\0'; //ADDED FOR SCRUM CRF-654
		loc_legend96.arr[0]		= '\0';




	loc_legend1.len			= 0;
	loc_legend2.len			= 0;
	loc_legend3.len			= 0;
	loc_legend4.len			= 0;
	loc_legend5.len			= 0;
	loc_legend6.len			= 0;
	loc_legend7.len			= 0;
	loc_legend8.len			= 0;
	loc_legend9.len			= 0;
	loc_legend10.len		= 0;
	loc_legend11.len		= 0;
	loc_legend12.len		= 0;
	loc_legend13.len		= 0;
	loc_legend14.len		= 0;
	loc_legend15.len		= 0;
	loc_legend16.len		= 0;
	loc_legend17.len		= 0;
	loc_legend18.len		= 0;
	loc_legend19.len		= 0;
	loc_legend20.len		= 0;
	loc_legend21.len		= 0;
	loc_legend22.len		= 0;
	loc_legend23.len		= 0;
	loc_legend24.len		= 0;
	loc_legend25.len		= 0;
	loc_legend26.len		= 0;
	loc_legend27.len		= 0;
	loc_legend28.len		= 0;
	loc_legend29.len		= 0;
	loc_legend30.len		= 0;
	loc_legend31.len		= 0;
	loc_legend32.len		= 0;
	loc_legend33.len		= 0;
	loc_legend34.len		= 0;
	loc_legend35.len		= 0;
	loc_legend36.len		= 0;
	loc_legend37.len		= 0;
	loc_legend38.len		= 0;
	loc_legend39.len		= 0;
	loc_legend40.len		= 0;
	loc_legend41.len		= 0;
	loc_legend42.len		= 0;
	loc_legend43.len		= 0;
	loc_legend44.len		= 0;
	loc_legend45.len		= 0;
	loc_legend46.len		= 0;
	loc_legend47.len		= 0;
	loc_legend48.len		= 0;
	loc_legend49.len		= 0;
	loc_legend50.len		= 0;
	loc_legend51.len		= 0;
	loc_legend52.len		= 0;
	loc_legend53.len		= 0;
	loc_legend54.len		= 0;
	loc_legend55.len		= 0;
	loc_legend56.len		= 0;
	loc_legend57.len		= 0;
	loc_legend58.len		= 0;
	loc_legend59.len		= 0;
	loc_legend60.len		= 0;
	loc_legend61.len		= 0;
	loc_legend62.len		= 0;
	loc_legend63.len		= 0;
	loc_legend68.len		= 0;
	loc_legend69.len		= 0;
	loc_legend70.len		= 0;
	loc_legend71.len		= 0;
	loc_legend72.len		= 0;
	loc_legend73.len		= 0;
	loc_legend74.len		= 0;
	loc_legend75.len		= 0;
	loc_legend76.len		= 0;
	loc_legend77.len		= 0;
	loc_legend78.len		= 0;
	loc_legend79.len		= 0;
	loc_legend80.len		= 0;
	loc_legend81.len		= 0;
	loc_legend82.len		= 0;
	loc_legend83.len		= 0;
	loc_legend84.len		= 0;
	loc_legend85.len		= 0;
	loc_legend91.len		= 0; //ADDED FOR SCRUM CRF-654
	loc_legend92.len		= 0; //ADDED FOR SCRUM CRF-654
	loc_legend93.len        =0;          //ADDED FOR SCRUM CRF-654
	loc_legend94.len        =0;          //ADDED FOR SCRUM CRF-654
	loc_legend96.len        =0;


	/* EXEC SQL	select	rtrim(substr(COLUMN_VALUE,1,50))
				  into	:loc_legend1
				  from	SM_RECORD_TRANS_DATA a,
						sm_lang_legend b
				 where	MODULE_ID   = 'SM' 
				   and	TABLE_ID    = 'SM_LANG_LEGEND'
				   and  COLUMN_ID   = 'DFLT_LEGEND_VALUE'
				   and  PK_VALUE    = LEGEND_ID
				   and  LEGEND_ID   = 'BILL_01.LEGEND_010' 
				   and  LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_010') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4729;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend1;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if(sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value 
		           into :loc_legend1
			  	   from sm_lang_legend
				  where LEGEND_ID = 'BILL_01.LEGEND_010'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_010'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4752;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend1;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 1",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
			 into  :loc_legend2
			 from  SM_RECORD_TRANS_DATA a,sm_lang_legend b
			 where MODULE_ID = 'SM' 
			 and   TABLE_ID = 'SM_LANG_LEGEND'
			 and   COLUMN_ID = 'DFLT_LEGEND_VALUE'
			 and   PK_VALUE = LEGEND_ID
			 and   LEGEND_ID = 'BILL_01.LEGEND_020' 
			 and   LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_020') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4771;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend2;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend2
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_020'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_020'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4794;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend2;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 2",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend3
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_030' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_030') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4813;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend3;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend3
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_030'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_030'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4836;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend3;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 3",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend4
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_040' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_040') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4855;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend4;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend4
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_040'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_040'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4878;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend4;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 4",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend5
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_050' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_050') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4897;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend5;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend5
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_050'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_050'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )4920;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend5;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 5",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend6
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_060' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_060') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4939;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend6;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend6
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_060'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_060'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4962;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend6;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 6",0,"");
	}


	/* EXEC SQL select /ortrim(substr(COLUMN_VALUE,1,50))o/ rtrim(COLUMN_VALUE)
				into :loc_legend7
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_070' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(COLUMN_VALUE) into :b0  from SM_RECORD_TRANS_DA\
TA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND'\
) and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BI\
LL_01.LEGEND_070') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )4981;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend7;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend7
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_070'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_070'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5004;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend7;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 7",0,"");
	}


	/* EXEC SQL select /ortrim(substr(COLUMN_VALUE,1,50))o/ rtrim(COLUMN_VALUE)
				into :loc_legend8
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_080' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(COLUMN_VALUE) into :b0  from SM_RECORD_TRANS_DA\
TA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND'\
) and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BI\
LL_01.LEGEND_080') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5023;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend8;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend8
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_080'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_080'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5046;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend8;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 8",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend9
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_090' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_090') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5065;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend9;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend9
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_090'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_090'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5088;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend9;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 9",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend10
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_100' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_100') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5107;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend10;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend10
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_100'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_100'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5130;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend10;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 10",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend11
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_110' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_110') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5149;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend11;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend11
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_110'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_110'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5172;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend11;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 11",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend12
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_120' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_120') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5191;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend12;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend12
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_120'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_120'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5214;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend12;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 12",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend13
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_130' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_130') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5233;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend13;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend13
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_130'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_130'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5256;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend13;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 13",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend14
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_140' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_140') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5275;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend14;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend14
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_140'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_140'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5298;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend14;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 14",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend15
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_150' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_150') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5317;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend15;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend15
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_150'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_150'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5340;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend15;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 15",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend16
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_160' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_160') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5359;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend16;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend16
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_160'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_160'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5382;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend16;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 16",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend17
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_170' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_170') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5401;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend17;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend17
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_170'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_170'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5424;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend17;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 17",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend18
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_180' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_180') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5443;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend18;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend18
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_180'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_180'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5466;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend18;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 18",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend19
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_190' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_190') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5485;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend19;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



if (sqlca.sqlcode == 1403)
{
	/* EXEC SQL select dflt_legend_value into :loc_legend19
				from sm_lang_legend
				where LEGEND_ID = 'BILL_01.LEGEND_190'; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend where\
 LEGEND_ID='BILL_01.LEGEND_190'";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5508;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend19;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 19",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend20
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_200' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_200') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5527;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend20;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend20
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_200'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_200'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5550;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend20;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 20",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend21
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_210' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_210') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5569;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend21;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend21
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_210'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_210'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5592;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend21;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 21",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend22
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_220' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_220') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5611;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend22;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend22
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_220'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_220'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5634;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend22;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 22",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend23
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_230' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_230') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5653;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend23;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend23
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_230'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_230'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5676;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend23;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 23",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend24
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_240' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_240') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5695;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend24;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend24
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_240'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_240'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5718;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend24;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 24",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend25
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_250' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_250') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5737;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend25;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend25
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_250'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_250'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5760;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend25;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 25",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend26
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_260' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_260') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5779;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend26;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend26
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_260'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_260'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5802;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend26;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 26",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend27
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_270' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_270') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5821;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend27;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend27
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_270'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_270'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5844;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend27;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 27",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend28
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_280' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_280') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5863;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend28;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend28
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_280'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_280'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5886;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend28;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 28",0,"");
	}


	/* EXEC SQL select /ortrim(substr(COLUMN_VALUE,1,50))o/ rtrim(COLUMN_VALUE)
				into :loc_legend29
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_290' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(COLUMN_VALUE) into :b0  from SM_RECORD_TRANS_DA\
TA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND'\
) and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BI\
LL_01.LEGEND_290') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5905;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend29;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend29
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_290'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_290'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5928;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend29;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 29",0,"");
	}

     if (l_lsr != 0 && l_dmp == 0)
      {
	/* EXEC SQL select lpad(' ',round((:l_margin_len-length(rtrim(substr(COLUMN_VALUE,1,50))))/2),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))	   
				into :loc_legend30
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_300' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (lpad(' ',round(((:b0-length(rtrim(substr(COLUMN_VALU\
E,1,50))))/2)),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))) into :b1  from S\
M_RECORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID\
='SM_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) \
and LEGEND_ID='BILL_01.LEGEND_300') and LANGUAGE_ID=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5947;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&loc_legend30;
 sqlstm.sqhstl[1] = (unsigned int  )203;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


     }
     else
     {

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend30
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_300' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_300') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )5974;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend30;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


      }      

	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend30
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_300'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_300'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )5997;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend30;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 30",0,"");
	}


	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend31
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_310' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_310') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6016;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend31;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend31
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_310'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_310'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6039;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend31;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 31",0,"");
	}

	if (l_lsr != 0 && l_dmp == 0)
       {
		/* EXEC SQL select lpad(' ',round((:l_margin_len-length(rtrim(substr(COLUMN_VALUE,1,50))))/2),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))	   
				into :loc_legend32
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_320' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select (lpad(' ',round(((:b0-length(rtrim(substr(COLUMN_VAL\
UE,1,50))))/2)),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))) into :b1  from \
SM_RECORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_I\
D='SM_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID)\
 and LEGEND_ID='BILL_01.LEGEND_320') and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6058;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&loc_legend32;
  sqlstm.sqhstl[1] = (unsigned int  )203;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}
	else
	{
		/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend32
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_320' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_R\
ECORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='S\
M_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and\
 LEGEND_ID='BILL_01.LEGEND_320') and LANGUAGE_ID=:b1)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6085;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend32;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[1] = (unsigned int  )6;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend32
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_320'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_320'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6108;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend32;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 32",0,"");
	}

	if (l_lsr != 0 && l_dmp == 0)
	{
		/* EXEC SQL select lpad(' ',round((:l_margin_len-length(rtrim(substr(COLUMN_VALUE,1,50))))/2),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))	   
				into :loc_legend33
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_330' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select (lpad(' ',round(((:b0-length(rtrim(substr(COLUMN_VAL\
UE,1,50))))/2)),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))) into :b1  from \
SM_RECORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_I\
D='SM_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID)\
 and LEGEND_ID='BILL_01.LEGEND_330') and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6127;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&loc_legend33;
  sqlstm.sqhstl[1] = (unsigned int  )203;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}
	else
	{
		/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend33
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_330' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_R\
ECORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='S\
M_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and\
 LEGEND_ID='BILL_01.LEGEND_330') and LANGUAGE_ID=:b1)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6154;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend33;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[1] = (unsigned int  )6;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	}

	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend33
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_330'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_330'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6177;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend33;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 33",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend34
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_340' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_340') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6196;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend34;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend34
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_340'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_340'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6219;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend34;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 34",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend35
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and	TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_350' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_350') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6238;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend35;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend35
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_350'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_350'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6261;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend35;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 35",0,"");
	}

	/* EXEC SQL select rtrim(substr(COLUMN_VALUE,1,50))
				into :loc_legend36
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_360' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rtrim(substr(COLUMN_VALUE,1,50)) into :b0  from SM_RE\
CORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM\
_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and \
LEGEND_ID='BILL_01.LEGEND_360') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6280;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend36;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend36
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_360'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_360'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6303;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend36;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 36",0,"");
	}



	/* EXEC SQL select lpad(' ',round((:l_margin_len-length(rtrim(substr(COLUMN_VALUE,1,50))))/2),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))	
				into :loc_legend37
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_370' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (lpad(' ',round(((:b0-length(rtrim(substr(COLUMN_VALU\
E,1,50))))/2)),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))) into :b1  from S\
M_RECORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID\
='SM_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) \
and LEGEND_ID='BILL_01.LEGEND_370') and LANGUAGE_ID=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6322;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&loc_legend37;
 sqlstm.sqhstl[1] = (unsigned int  )203;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select lpad(' ',round((:l_margin_len-length(rtrim(substr(dflt_legend_value,1,50))))/2),' ')||UPPER(rtrim(substr(dflt_legend_value,1,50)))				
				        into :loc_legend37
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_370'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select (lpad(' ',round(((:b0-length(rtrim(substr(dflt_legen\
d_value,1,50))))/2)),' ')||UPPER(rtrim(substr(dflt_legend_value,1,50)))) into \
:b1  from sm_lang_legend where LEGEND_ID='BILL_01.LEGEND_370'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6349;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&loc_legend37;
  sqlstm.sqhstl[1] = (unsigned int  )203;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 37",0,"");
	}


	/* EXEC SQL select lpad(' ',round((:l_margin_len-length(rtrim(substr(COLUMN_VALUE,1,50))))/2),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))	
				into :loc_legend38
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_380' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (lpad(' ',round(((:b0-length(rtrim(substr(COLUMN_VALU\
E,1,50))))/2)),' ')||UPPER(rtrim(substr(COLUMN_VALUE,1,50)))) into :b1  from S\
M_RECORD_TRANS_DATA a ,sm_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID\
='SM_LANG_LEGEND') and COLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) \
and LEGEND_ID='BILL_01.LEGEND_380') and LANGUAGE_ID=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6372;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&loc_legend38;
 sqlstm.sqhstl[1] = (unsigned int  )203;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select lpad(' ',round((:l_margin_len-length(rtrim(substr(dflt_legend_value,1,50))))/2),' ')||UPPER(rtrim(substr(dflt_legend_value,1,50)))				
					into :loc_legend38
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_380'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select (lpad(' ',round(((:b0-length(rtrim(substr(dflt_legen\
d_value,1,50))))/2)),' ')||UPPER(rtrim(substr(dflt_legend_value,1,50)))) into \
:b1  from sm_lang_legend where LEGEND_ID='BILL_01.LEGEND_380'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6399;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_margin_len;
  sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&loc_legend38;
  sqlstm.sqhstl[1] = (unsigned int  )203;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 38",0,"");
	}

	/*------------------------22/09/2005-----------------------*/

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend39
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_390' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_390') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6422;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend39;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend39
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_390'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_390'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6445;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend39;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 39",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend40
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_400' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_400') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6464;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend40;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend40
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_400'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_400'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6487;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend40;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 40",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend41
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_410' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_410') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6506;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend41;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend41
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_410'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_410'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6529;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend41;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 41",0,"");
	}



 /* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend42
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_420' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_420') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6548;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend42;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend42
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_420'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_420'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6571;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend42;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 42",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend43
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_430' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_430') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6590;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend43;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend43
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_430'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_430'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6613;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend43;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 43",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend44
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_440' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_440') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6632;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend44;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend44
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_440'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_440'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6655;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend44;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 44",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend45
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_450' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_450') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6674;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend45;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend45
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_450'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_450'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6697;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend45;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 45",0,"");
	}


	
	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend46
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_460' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_460') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6716;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend46;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend46
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_460'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_460'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6739;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend46;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 46",0,"");
	}






	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend47
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_470' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_470') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6758;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend47;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend47
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_470'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_470'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6781;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend47;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 47",0,"");
	}




	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend48
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_480' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_480') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6800;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend48;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend48
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_480'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_480'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6823;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend48;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 48",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend49
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_490' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_490') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6842;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend49;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend49
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_490'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_490'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6865;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend49;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 49",0,"");
	}





	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend50
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_500' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_500') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6884;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend50;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend50
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_500'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_500'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6907;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend50;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 50",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend51
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_510' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_510') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6926;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend51;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend51
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_510'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_510'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6949;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend51;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 51",0,"");
	}




	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend52
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_520' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_520') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )6968;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend52;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend52
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_520'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_520'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )6991;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend52;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 52",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend53
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_530' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_530') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7010;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend53;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend53
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_530'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_530'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7033;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend53;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 53",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend54
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_540' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_540') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7052;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend54;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend54
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_540'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_540'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7075;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend54;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 54",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend55
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_550' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_550') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7094;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend55;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend55
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_550'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_550'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7117;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend55;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 55",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend56
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_560' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_560') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7136;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend56;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend56
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_560'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_560'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7159;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend56;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 56",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend57
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_570' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_570') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7178;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend57;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend57
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_570'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_570'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7201;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend57;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 57",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend58
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_580' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_580') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7220;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend58;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend58
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_580'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_580'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7243;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend58;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 58",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend59
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_590' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_590') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7262;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend59;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend59
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_590'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_590'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7285;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend59;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 59",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend60
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_600' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_600') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7304;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend60;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend60
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_600'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_600'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7327;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend60;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 60",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend61
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_610' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_610') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7346;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend61;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend61
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_610'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_610'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7369;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend61;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 61",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend62
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_620' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_620') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7388;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend62;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend62
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_620'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_620'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7411;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend62;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 62",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend63
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_630' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_630') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7430;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend63;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend63
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_630'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_630'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7453;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend63;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 63",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend68
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_680' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_680') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7472;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend68;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend68
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_680'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_680'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7495;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend68;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 68",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend69
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_690' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_690') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7514;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend69;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend69
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_690'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_690'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7537;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend69;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 69",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend70
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_700' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_700') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7556;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend70;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend70
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_700'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_700'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7579;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend70;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 70",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend71
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_710' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_710') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7598;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend71;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend71
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_710'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_710'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7621;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend71;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 71",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend72
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_720' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_720') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7640;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend72;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend72
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_720'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_720'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7663;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend72;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 72",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend73
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_730' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_730') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7682;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend73;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend73
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_730'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_730'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7705;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend73;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 73",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend74
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_740' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_740') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7724;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend74;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend74
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_740'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_740'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7747;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend74;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 74",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend75
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_750' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_750') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7766;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend75;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend75
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_750'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_750'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7789;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend75;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 75",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend76
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_760' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_760') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7808;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend76;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend76
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_760'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_760'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7831;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend76;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 76",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend77
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_770' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_770') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7850;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend77;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend77
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_770'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_770'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7873;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend77;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 77",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend78
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_780' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_780') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7892;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend78;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend78
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_780'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_780'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7915;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend78;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 78",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend79
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_790' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_790') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7934;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend79;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend79
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_790'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_790'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7957;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend79;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 79",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend80
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_800' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_800') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )7976;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend80;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend80
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_800'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_800'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )7999;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend80;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 80",0,"");
	}


	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend81
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_810' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_810') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8018;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend81;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend81
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_810'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_810'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8041;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend81;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 81",0,"");
	}



	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend82
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_820' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_820') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8060;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend82;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend82
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_820'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_820'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8083;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend82;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 82",0,"");
	}


/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend83
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_830' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,sm\
_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and CO\
LUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.LE\
GEND_830') and LANGUAGE_ID=:b1)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8102;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&loc_legend83;
sqlstm.sqhstl[0] = (unsigned int  )203;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[1] = (unsigned int  )6;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend83
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_830'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_830'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8125;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend83;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 83",0,"");
	}


/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend84
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_840' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,sm\
_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and CO\
LUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.LE\
GEND_840') and LANGUAGE_ID=:b1)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8144;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&loc_legend84;
sqlstm.sqhstl[0] = (unsigned int  )203;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[1] = (unsigned int  )6;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend84
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_840'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_840'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8167;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend84;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 84",0,"");
	}

/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend85
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_850' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,sm\
_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and CO\
LUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.LE\
GEND_850') and LANGUAGE_ID=:b1)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8186;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&loc_legend85;
sqlstm.sqhstl[0] = (unsigned int  )203;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[1] = (unsigned int  )6;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend85
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_850'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_850'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8209;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend85;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 85",0,"");
	}

		/*ADDED FOR SCRUM CRF-654*/
/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend91
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_991' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,sm\
_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and CO\
LUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.LE\
GEND_991') and LANGUAGE_ID=:b1)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8228;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&loc_legend91;
sqlstm.sqhstl[0] = (unsigned int  )203;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[1] = (unsigned int  )6;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend91
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_991'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_991'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8251;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend91;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 91",0,"");
	}

/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend92
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_992' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,sm\
_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and CO\
LUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.LE\
GEND_992') and LANGUAGE_ID=:b1)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8270;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&loc_legend92;
sqlstm.sqhstl[0] = (unsigned int  )203;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[1] = (unsigned int  )6;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend92
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_992'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_992'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8293;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend92;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 92",0,"");
	}

/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend93
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_993' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,sm\
_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and CO\
LUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.LE\
GEND_993') and LANGUAGE_ID=:b1)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8312;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&loc_legend93;
sqlstm.sqhstl[0] = (unsigned int  )203;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[1] = (unsigned int  )6;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend93
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_993'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_993'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8335;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend93;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 93",0,"");
	}

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend94
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_994' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_994') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8354;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend94;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend94
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_994'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_994'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8377;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend94;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 94",0,"");
	}
 

	/* EXEC SQL select  COLUMN_VALUE 
				into :loc_legend96
				from SM_RECORD_TRANS_DATA a,sm_lang_legend b
				where MODULE_ID = 'SM' 
				and TABLE_ID = 'SM_LANG_LEGEND'
				and COLUMN_ID = 'DFLT_LEGEND_VALUE'
				and PK_VALUE = LEGEND_ID
				and LEGEND_ID = 'BILL_01.LEGEND_996' 
				and LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select COLUMN_VALUE into :b0  from SM_RECORD_TRANS_DATA a ,s\
m_lang_legend b where (((((MODULE_ID='SM' and TABLE_ID='SM_LANG_LEGEND') and C\
OLUMN_ID='DFLT_LEGEND_VALUE') and PK_VALUE=LEGEND_ID) and LEGEND_ID='BILL_01.L\
EGEND_996') and LANGUAGE_ID=:b1)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8396;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&loc_legend96;
 sqlstm.sqhstl[0] = (unsigned int  )203;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (sqlca.sqlcode == 1403)
	{
		/* EXEC SQL select dflt_legend_value into :loc_legend96
					from sm_lang_legend
					where LEGEND_ID = 'BILL_01.LEGEND_996'; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select dflt_legend_value into :b0  from sm_lang_legend wher\
e LEGEND_ID='BILL_01.LEGEND_996'";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8419;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&loc_legend96;
  sqlstm.sqhstl[0] = (unsigned int  )203;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	}

	if (sqlca.sqlcode < 0)
	{   
		err_mesg("SELECT failed on LEGEND 96",0,"");
	}

/*ADDED FOR SCRUM CRF-654*/



	loc_legend1.arr[loc_legend1.len]		= '\0';
	loc_legend2.arr[loc_legend2.len]		= '\0';
	loc_legend3.arr[loc_legend3.len]		= '\0';
	loc_legend4.arr[loc_legend4.len]		= '\0';
	loc_legend5.arr[loc_legend5.len]		= '\0';
	loc_legend6.arr[loc_legend6.len]		= '\0';
	loc_legend7.arr[loc_legend7.len]		= '\0';
	loc_legend8.arr[loc_legend8.len]		= '\0';
	loc_legend9.arr[loc_legend9.len]		= '\0';
	loc_legend10.arr[loc_legend10.len]		= '\0';
	loc_legend11.arr[loc_legend11.len]		= '\0';
	loc_legend12.arr[loc_legend12.len]		= '\0';
	loc_legend13.arr[loc_legend13.len]		= '\0';
	loc_legend14.arr[loc_legend14.len]		= '\0';
	loc_legend15.arr[loc_legend15.len]		= '\0';
	loc_legend16.arr[loc_legend16.len]		= '\0';
	loc_legend17.arr[loc_legend17.len]		= '\0';
	loc_legend18.arr[loc_legend18.len]		= '\0';
	loc_legend19.arr[loc_legend19.len]		= '\0';
	loc_legend20.arr[loc_legend20.len]		= '\0';
	loc_legend21.arr[loc_legend21.len]		= '\0';
	loc_legend22.arr[loc_legend22.len]		= '\0';
	loc_legend23.arr[loc_legend23.len]		= '\0';
	loc_legend24.arr[loc_legend24.len]		= '\0';
	loc_legend25.arr[loc_legend25.len]		= '\0';
	loc_legend26.arr[loc_legend26.len]		= '\0';
	loc_legend27.arr[loc_legend27.len]		= '\0';
	loc_legend28.arr[loc_legend28.len]		= '\0';
	loc_legend29.arr[loc_legend29.len]		= '\0';
	loc_legend30.arr[loc_legend30.len]		= '\0';
	loc_legend31.arr[loc_legend31.len]		= '\0';
	loc_legend32.arr[loc_legend32.len]		= '\0';
	loc_legend33.arr[loc_legend33.len]		= '\0';
	loc_legend34.arr[loc_legend34.len]		= '\0';
	loc_legend35.arr[loc_legend35.len]		= '\0';
	loc_legend36.arr[loc_legend36.len]		= '\0';
	loc_legend37.arr[loc_legend37.len]		= '\0';
	loc_legend38.arr[loc_legend38.len]		= '\0';
	loc_legend39.arr[loc_legend39.len]		= '\0';
	loc_legend40.arr[loc_legend40.len]		= '\0';
	loc_legend41.arr[loc_legend41.len]		= '\0';
	loc_legend42.arr[loc_legend42.len]		= '\0';
	loc_legend43.arr[loc_legend43.len]		= '\0';
	loc_legend44.arr[loc_legend44.len]		= '\0';
	loc_legend45.arr[loc_legend45.len]		= '\0';
	loc_legend46.arr[loc_legend46.len]		= '\0';
	loc_legend47.arr[loc_legend47.len]		= '\0';
	loc_legend48.arr[loc_legend48.len]		= '\0';
	loc_legend49.arr[loc_legend49.len]		= '\0';
	loc_legend50.arr[loc_legend50.len]		= '\0';
	loc_legend51.arr[loc_legend51.len]		= '\0';
	loc_legend52.arr[loc_legend52.len]		= '\0';
	loc_legend53.arr[loc_legend53.len]		= '\0';
	loc_legend54.arr[loc_legend54.len]		= '\0';
	loc_legend55.arr[loc_legend55.len]		= '\0';
	loc_legend56.arr[loc_legend56.len]		= '\0';
	loc_legend57.arr[loc_legend57.len]		= '\0';
	loc_legend58.arr[loc_legend58.len]		= '\0';
	loc_legend59.arr[loc_legend59.len]		= '\0';	
	loc_legend60.arr[loc_legend60.len]		= '\0';	
	loc_legend61.arr[loc_legend61.len]		= '\0';	
	loc_legend62.arr[loc_legend62.len]		= '\0';	
	loc_legend63.arr[loc_legend63.len]		= '\0';	
	loc_legend68.arr[loc_legend68.len]		= '\0';	
	loc_legend69.arr[loc_legend69.len]		= '\0';	
	loc_legend70.arr[loc_legend70.len]		= '\0';	
	loc_legend71.arr[loc_legend71.len]		= '\0';	
	loc_legend72.arr[loc_legend72.len]		= '\0';	
	loc_legend73.arr[loc_legend73.len]		= '\0';	
	loc_legend74.arr[loc_legend74.len]		= '\0';	
	loc_legend75.arr[loc_legend75.len]		= '\0';	
	loc_legend76.arr[loc_legend76.len]		= '\0';	
	loc_legend77.arr[loc_legend77.len]		= '\0';	
	loc_legend78.arr[loc_legend78.len]		= '\0';	
	loc_legend79.arr[loc_legend79.len]		= '\0';	
	loc_legend80.arr[loc_legend80.len]		= '\0';
	loc_legend81.arr[loc_legend81.len]		= '\0';
	loc_legend82.arr[loc_legend82.len]		= '\0';
	loc_legend83.arr[loc_legend83.len]		= '\0';	
	loc_legend84.arr[loc_legend84.len]		= '\0';
	loc_legend85.arr[loc_legend85.len]		= '\0';		
	loc_legend91.arr[loc_legend91.len]		= '\0';		//added for scrum crf-654	
	loc_legend92.arr[loc_legend92.len]		= '\0';         //added for scrum crf-654
	loc_legend93.arr[loc_legend93.len]		= '\0';         //added for scrum crf-654
	loc_legend94.arr[loc_legend94.len]		= '\0';         //added for scrum crf-654
	loc_legend96.arr[loc_legend96.len]		= '\0'; 
		

}
print_formated_qty(loc_qty) 
int loc_qty;
{
  char str_qty[30];

  sprintf(str_qty,"%d",loc_qty); 
  ltrim (str_qty);
  rtrim (str_qty);
  if(nd_print_option.arr[0]=='R')
  {
   if(strlen(str_qty)<3)
   fun_add_space(3-strlen(str_qty));
   strcat(nd_line_text.arr,str_qty);
  }
  else
  fprintf(fp,"%3.3s",str_qty);
}

print_formated_qty1()
{
  
  fprintf(fp,"%7.7s",nd_serv_qty.arr);
}

print_formated_amt(loc_amount)
double loc_amount;
{
	char s_amt[30], str_amt[30], fstr_amt[30];

    if(loc_amount < 0)
	{
        put_val(s_amt,-loc_amount);        
        format_amt(s_amt);        
        sprintf(str_amt,"%14s",s_amt);				
		ltrim (str_amt);		
		rtrim (str_amt);		
		//strcpy(fstr_amt,"CR ");
		//strcat(fstr_amt,str_amt);		
		//ltrim (fstr_amt);		
		//rtrim (fstr_amt);
		//sprintf(str_amt,"%15s",str_amt);		
        
		if(nd_print_option.arr[0]=='R')
		{
		  if(strlen(str_amt)<15)
		  fun_add_space(15-strlen(str_amt));
		  strcat(nd_line_text.arr,str_amt);
		  fun_add_space(1);
		  strcat(nd_line_text.arr,"CR");
		}
		else
		//fprintf(fp,"%15s CR",str_amt); 
		fprintf(fp,"%15sCR",str_amt); // Changed here for IN17711
    }
	
		   else 
	{
        put_val(s_amt,loc_amount);         
        format_amt(s_amt);
        sprintf(str_amt,"%15s",s_amt);
        if(nd_print_option.arr[0]=='R')
		{
		  if(strlen(str_amt)<15)
		  fun_add_space(15-strlen(str_amt));
		  strcat(nd_line_text.arr,str_amt);
		  fun_add_space(1);
		}
		else
		fprintf(fp,"%15s  ",str_amt);
     }
	 
}  
//This for printing Additional Charge Amt for payer Bill                      
print_formated_amt1(loc_amount)
double loc_amount;
{
	char s_amt[30], str_amt[30], fstr_amt[30];

    if(loc_amount < 0)
	{
        put_val(s_amt,-loc_amount);        
        format_amt(s_amt);        
        sprintf(str_amt,"%9.9s",s_amt);				
		ltrim (str_amt);		
		rtrim (str_amt);		
		//strcpy(fstr_amt,"CR ");
		//strcat(fstr_amt,str_amt);		
		//ltrim (fstr_amt);		
		//rtrim (fstr_amt);
		//sprintf(str_amt,"%15s",str_amt);		
        if(nd_print_option.arr[0]=='R')
		{
		  if(strlen(str_amt)<9)
		  fun_add_space(9-strlen(str_amt));
		  strcat(nd_line_text.arr,str_amt);
   	      strcat(nd_line_text.arr,"CR");
		}
		else
		fprintf(fp,"%9.9sCR",str_amt);
    }
    else 
	{
        put_val(s_amt,loc_amount);         
        format_amt(s_amt);
        sprintf(str_amt,"%9.9s",s_amt);
        if(nd_print_option.arr[0]=='R')
		{
		  if(strlen(str_amt)<9)
		  fun_add_space(9-strlen(str_amt));
		  strcat(nd_line_text.arr,str_amt);
   	      fun_add_space(2);
		}
		else
		fprintf(fp,"%9.9s  ",str_amt);
     }

} 
//This for printing Additional Charge Amt for Patient Bill 
print_formated_amt2(loc_amount)
double loc_amount;
{
	char s_amt[30], str_amt[30], fstr_amt[30];

   	if(loc_amount < 0)
	{
        put_val(s_amt,-loc_amount);        
        format_amt(s_amt);        
        sprintf(str_amt,"%11.11s",s_amt);				
		ltrim (str_amt);		
		rtrim (str_amt);		
		//strcpy(fstr_amt,"CR ");
		//strcat(fstr_amt,str_amt);		
		//ltrim (fstr_amt);		
		//rtrim (fstr_amt);
		//sprintf(str_amt,"%15s",str_amt);	
		if(nd_print_option.arr[0]=='R')
		{
		  fun_add_space(1);
		  if(strlen(str_amt)<11)
		  fun_add_space(11-strlen(str_amt));
		  strcat(nd_line_text.arr,str_amt);
   	      strcat(nd_line_text.arr,"CR");
		}
		else	
        fprintf(fp," %11.11sCR",str_amt);
    }
    else 
	{
        put_val(s_amt,loc_amount);         
        format_amt(s_amt);
        sprintf(str_amt,"%11.11s",s_amt);
        if(nd_print_option.arr[0]=='R')
		{
		  fun_add_space(1);
		  if(strlen(str_amt)<11)
		  fun_add_space(11-strlen(str_amt));
		  strcat(nd_line_text.arr,str_amt);
   	      fun_add_space(2);
		}
		else	
		fprintf(fp," %11.11s  ",str_amt);
     }

}                                         
print_formated(loc_amount)
double loc_amount;
{
    char s_amt[30], str_amt[30], fstr_amt[30];

    if(loc_amount < 0)
	{
        put_val(s_amt,-loc_amount);        
        format_amt(s_amt);        
        sprintf(str_amt,"%14s",s_amt);				
		ltrim (str_amt);		
		rtrim (str_amt);
		sprintf(str_amt,"%sCR",str_amt);
		return str_amt;
 
    }
    else 
	{
        put_val(s_amt,loc_amount);         
        format_amt(s_amt);
        sprintf(str_amt,"%sDR",s_amt);
	    return str_amt;
    }
}                        

print_next_page1()
{
	int i;
	
	while(v_lno <= max_lines)
	{
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		v_lno++;
	}	

	if (l_lsr != 0 && l_dmp == 0)
	{	 
		if(nd_print_option.arr[0]=='R')
		{
		 fun_bl_report_temp_format();
		 fun_bl_report_temp_format();
		}
		else
		fprintf(fp,"\n\n");
	}
	else
	{
		if(nd_print_option.arr[0]=='R')
		{
		 fun_bl_report_temp_format();
		 fun_bl_report_temp_format();
		 fun_bl_report_temp_format();
		 fun_bl_report_temp_format();
		}
		fprintf(fp,"\n\n\n\n");
	}
	
	if ((l_lsr != 0 && l_dmp == 0))
	{
	 if ( l_logo_yniflaser.arr[0] != 'Y')
	 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0) //IN13383	
     print_footer1();
	}  //IN13383

	
	if ( l_logo_yniflaser.arr[0] != 'Y')
	{

	 fprintf(fp,""); /* To Eject Page */
	}
	
    if(nd_print_option.arr[0]=='R')
	fun_bl_report_temp_format();
	else
    fprintf(fp,"\n");

	if (l_lsr != 0 && l_dmp == 0 )
	{
		if ( l_logo_yniflaser.arr[0] == 'Y')
		{
			if(nd_print_option.arr[0]=='R')
			{
			 fun_bl_report_temp_format();
			 fun_bl_report_temp_format();
			}
			else
			fprintf(fp,"\n\n");
		}
	}
	v_lno=0;
	line_ctr=0; //added by raghava on 24/11/2009
	
	if (l_lsr != 0 && l_dmp == 0 )  //added for IN23425 Relesing bold and underline  after moving to second page
	Release_bold_underline();

	print_report_head();

	 if (strcmp(nd_bill_format_id.arr,"2")==0) //added for IN23425
	 {
		v_lno = line_ctr;	
	 }

	if(l_next_page==2)
	{
	get_payer_bill_header();
	}

	if(l_next_page==3)
	{
	 get_legend_value();
	 if( lcol_cnt == 1)
	 prt_line_uc();
	 if(lcol_cnt == 2)
	 prt_line_uc_wide();
     if(lcol_cnt == 3)
	 prt_line_uc_wide1();
	 if(lcol_cnt == 6 || lcol_cnt == 5)
	 prt_line_uc_wide2();
	 if(nd_print_option.arr[0]=='R')
	 fun_bl_report_temp_format();
	 else		
	 fprintf(fp,"\n");
  	}
    

}



ltrim(l_str)
char *l_str;
{
   char *ptr;
   ptr = l_str;
   while (*ptr== ' ') ptr++;
   for(;*ptr!='\0';ptr++,l_str++)
    *l_str = *ptr;
   *l_str = '\0';
}

rtrim(l_str)
char *l_str;
{
  while (*l_str != '\0') *l_str++;
  l_str--;
  while (*l_str == ' ') *l_str--;
  *(l_str+1) = '\0';
}

get_left_margin()
{

	if (l_lsr != 0 && l_dmp == 0)
	  {
		if (l_logo_yniflaser.arr[0] == 'Y')			    
			l_margin_len = 94;				
		else
			l_margin_len = 60;

	  }
}


get_bill_address()
{
	l_bill_contact_name.arr[0] = '\0';
	l_bill_contact_name.len = 0;

	l_bill_contact_name_title.arr[0] = '\0';
	l_bill_contact_name_title.len = 0;

	l_bill_long_desc.arr[0] = '\0';
	l_bill_long_desc.len = 0;

	l_bill_add1_desc.arr[0] = '\0';
	l_bill_add1_desc.len = 0;

	l_bill_add2_desc.arr[0] = '\0';
	l_bill_add2_desc.len = 0;

	l_bill_add3_desc.arr[0] = '\0';
	l_bill_add3_desc.len = 0;
	
	if(strcmp(d_bill_nature_code.arr,"A")==0)
	{
		/* EXEC SQL SELECT substr(contact_name,1,19),
						substr(contact_name_title,1,20),
						substr(long_name,1,40),
						substr(add1_desc,1,40),
						substr(add2_desc,1,40),
						substr(add3_desc,1,40)						
				   INTO :l_bill_contact_name,
						:l_bill_contact_name_title,
						:l_bill_long_desc,
						:l_bill_add1_desc,
						:l_bill_add2_desc,
						:l_bill_add3_desc
				   FROM ar_customer_lang_vw
				  WHERE cust_code    = :d_cust_code
				  AND   language_id  = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(contact_name,1,19) ,substr(contact_name_title\
,1,20) ,substr(long_name,1,40) ,substr(add1_desc,1,40) ,substr(add2_desc,1,40)\
 ,substr(add3_desc,1,40) into :b0,:b1,:b2,:b3,:b4,:b5  from ar_customer_lang_v\
w where (cust_code=:b6 and language_id=:b7)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8438;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_bill_contact_name;
  sqlstm.sqhstl[0] = (unsigned int  )52;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&l_bill_contact_name_title;
  sqlstm.sqhstl[1] = (unsigned int  )52;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&l_bill_long_desc;
  sqlstm.sqhstl[2] = (unsigned int  )42;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&l_bill_add1_desc;
  sqlstm.sqhstl[3] = (unsigned int  )42;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&l_bill_add2_desc;
  sqlstm.sqhstl[4] = (unsigned int  )42;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&l_bill_add3_desc;
  sqlstm.sqhstl[5] = (unsigned int  )42;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&d_cust_code;
  sqlstm.sqhstl[6] = (unsigned int  )27;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[7] = (unsigned int  )6;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  

			   if (OERROR)
					err_mesg("SELECT failed on table AR_CUSTOMER_LANG_VW",0,"");

	}
	else if(strcmp(d_bill_nature_code.arr,"C")==0)
	{
		/* EXEC SQL SELECT substr(mail_contact_name,1,19),
						substr(mail_postal_code,1,20),
						substr(ln1_mail_add,1,40),
						substr(ln2_mail_add,1,40),
						substr(ln3_mail_add,1,40),
						substr(mail_country_code,1,40)						
				   INTO :l_bill_contact_name,
						:l_bill_contact_name_title,
						:l_bill_long_desc,
						:l_bill_add1_desc,
						:l_bill_add2_desc,
						:l_bill_add3_desc
				   FROM mp_pat_other_dtls
				  WHERE patient_id = :d_patient_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(mail_contact_name,1,19) ,substr(mail_postal_c\
ode,1,20) ,substr(ln1_mail_add,1,40) ,substr(ln2_mail_add,1,40) ,substr(ln3_ma\
il_add,1,40) ,substr(mail_country_code,1,40) into :b0,:b1,:b2,:b3,:b4,:b5  fro\
m mp_pat_other_dtls where patient_id=:b6";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8485;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_bill_contact_name;
  sqlstm.sqhstl[0] = (unsigned int  )52;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&l_bill_contact_name_title;
  sqlstm.sqhstl[1] = (unsigned int  )52;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&l_bill_long_desc;
  sqlstm.sqhstl[2] = (unsigned int  )42;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&l_bill_add1_desc;
  sqlstm.sqhstl[3] = (unsigned int  )42;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&l_bill_add2_desc;
  sqlstm.sqhstl[4] = (unsigned int  )42;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&l_bill_add3_desc;
  sqlstm.sqhstl[5] = (unsigned int  )42;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&d_patient_id;
  sqlstm.sqhstl[6] = (unsigned int  )63;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			   if (OERROR)
					err_mesg("SELECT failed on table MP_PAT_OTHER_DTLS",0,"");
	}

	l_bill_contact_name.arr[l_bill_contact_name.len] = '\0';
	l_bill_contact_name_title.arr[l_bill_contact_name_title.len] = '\0';
	l_bill_long_desc.arr[l_bill_long_desc.len] = '\0';
	l_bill_add1_desc.arr[l_bill_add1_desc.len] = '\0';
	l_bill_add2_desc.arr[l_bill_add2_desc.len] = '\0';
	l_bill_add3_desc.arr[l_bill_add3_desc.len] = '\0';

	if(l_bill_add3_desc.len > 0)
	{
		l_bill_add3_desc_temp.arr[0] = '\0';
		l_bill_add3_desc_temp.len = 0;		

		/* EXEC SQL SELECT long_name
				   INTO :l_bill_add3_desc_temp
				   FROM mp_country_LANG_VW
				  WHERE country_code = :l_bill_add3_desc
				  AND LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select long_name into :b0  from mp_country_LANG_VW where (c\
ountry_code=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )8528;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_bill_add3_desc_temp;
  sqlstm.sqhstl[0] = (unsigned int  )42;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&l_bill_add3_desc;
  sqlstm.sqhstl[1] = (unsigned int  )42;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		l_bill_add3_desc_temp.arr[l_bill_add3_desc_temp.len] = '\0';

		if((strcmp(l_bill_add3_desc_temp.arr,l_bill_add3_desc.arr)!=0) && (l_bill_add3_desc_temp.len > 0))
		{
			strcpy(l_bill_add3_desc.arr,l_bill_add3_desc_temp.arr);
			l_bill_add3_desc.len = strlen(l_bill_add3_desc.arr);
		}
	}
}


get_print_group_hd_desc3()
{
	nd_prt_hd_desc.arr[0] = '\0';
	nd_prt_hd_desc.len=0;


 if(strcmp(d_grp_ind.arr,"ESG")==0)
 {
	/* EXEC SQL  Select SHORT_DESC into :nd_prt_hd_desc 
			  From BL_BLNG_PRT_GRP_HDR_LANG_VW
			  Where  PRT_GRP_HDR_CODE=:d_prt_grp_hdr_code
			  AND  LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select SHORT_DESC into :b0  from BL_BLNG_PRT_GRP_HDR_LANG_VW\
 where (PRT_GRP_HDR_CODE=:b1 and LANGUAGE_ID=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8555;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_prt_grp_hdr_code;
 sqlstm.sqhstl[1] = (unsigned int  )9;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 }
 if(strcmp(d_grp_ind.arr,"EMG")==0)
 {
	/* EXEC SQL  Select long_desc into :nd_prt_hd_desc 
			  from   bl_ent_item_grp_lang_vw
			  where  ent_item_grp_code=:d_ent_item_grp_code
			  and    operating_facility_id=:nd_facility_id
			  and    language_id=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select long_desc into :b0  from bl_ent_item_grp_lang_vw wher\
e ((ent_item_grp_code=:b1 and operating_facility_id=:b2) and language_id=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8582;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_ent_item_grp_code;
 sqlstm.sqhstl[1] = (unsigned int  )15;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )5;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 }
 if(strcmp(d_grp_ind.arr,"PSG")==0)
 {
   	/* EXEC SQL Select SHORT_DESC into :nd_prt_hd_desc
			From   BL_PAYER_SERV_GRP_HDR_LANG_VW
			Where  OPERATING_FACILITY_ID=:nd_facility_id
			And    CUST_CODE  =:d_payer_serv_grp_cust_code
			And    PATIENT_CLASS=:d_payer_serv_grp_pat_class
			And    PAYER_SERV_GRP_HDR=:d_payer_serv_grp_hdr
			And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select SHORT_DESC into :b0  from BL_PAYER_SERV_GRP_HDR_LA\
NG_VW where ((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) and PATIENT_CLASS\
=:b3) and PAYER_SERV_GRP_HDR=:b4) and LANGUAGE_ID=:b5)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8613;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_payer_serv_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d_payer_serv_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d_payer_serv_grp_hdr;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[5] = (unsigned int  )6;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  
 }

 if(strcmp(d_grp_ind.arr,"PMG")==0)
 {
   	/* EXEC SQL Select SHORT_DESC into :nd_prt_hd_desc
			From   BL_PAYER_ITEM_GRP_LANG_VW 
			Where  OPERATING_FACILITY_ID=:nd_facility_id
			And    CUST_CODE  =:d_payer_item_grp_cust_code
			And    PATIENT_CLASS=:d_payer_item_grp_pat_class
			And    PAYER_ITEM_GRP_CODE=:d_payer_item_grp_code
			And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select SHORT_DESC into :b0  from BL_PAYER_ITEM_GRP_LANG_V\
W where ((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) and PATIENT_CLASS=:b3\
) and PAYER_ITEM_GRP_CODE=:b4) and LANGUAGE_ID=:b5)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8652;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_payer_item_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d_payer_item_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d_payer_item_grp_code;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[5] = (unsigned int  )6;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   
 }
nd_prt_hd_desc.arr[nd_prt_hd_desc.len] = '\0';

 if (OERROR)
	err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_HDR",0,"");
//disp_message(ERR_MESG,nd_prt_hd_desc.arr);
}

get_print_group_line_desc3()
{
nd_prt_line_desc.arr[0] = '\0';
nd_prt_line_desc.len=0;
 


 if(strcmp(d_grp_ind.arr,"ESL")==0)
 {
	/* EXEC SQL  Select substr(SHORT_DESC,1,20)  into :nd_prt_line_desc 
			  From BL_BLNG_PRT_GRP_LINE_lang_vw
			  Where  PRT_GRP_HDR_CODE=:d_prt_grp_hdr_code
			  and PRT_GRP_LINE_CODE=:d_prt_grp_line_code
			  AND LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GR\
P_LINE_lang_vw where ((PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2) and LAN\
GUAGE_ID=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8691;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_prt_grp_hdr_code;
 sqlstm.sqhstl[1] = (unsigned int  )9;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_prt_grp_line_code;
 sqlstm.sqhstl[2] = (unsigned int  )9;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 }
 if(strcmp(d_grp_ind.arr,"PSL")==0)
 {
   	/* EXEC SQL  Select substr(SHORT_DESC,1,20)  into :nd_prt_line_desc 
			  From BL_PAYER_SERV_GRP_LINE_LANG_VW
			  Where  OPERATING_FACILITY_ID=:nd_facility_id
			  And    CUST_CODE  =:d_payer_serv_grp_cust_code
			  And    PATIENT_CLASS=:d_payer_serv_grp_pat_class
			  And    PAYER_SERV_GRP_HDR=:d_payer_serv_grp_hdr
			  And    PAYER_SERV_GRP_LINE=:d_payer_serv_grp_line
			  And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_PAYER_SE\
RV_GRP_LINE_LANG_VW where (((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) an\
d PATIENT_CLASS=:b3) and PAYER_SERV_GRP_HDR=:b4) and PAYER_SERV_GRP_LINE=:b5) \
and LANGUAGE_ID=:b6)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8722;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_payer_serv_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d_payer_serv_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d_payer_serv_grp_hdr;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&d_payer_serv_grp_line;
    sqlstm.sqhstl[5] = (unsigned int  )9;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[6] = (unsigned int  )6;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 }

/***added by vani at the time of merging walkthrough***/
if(strcmp(d_grp_ind.arr,"ESG")==0)
 {
	/* EXEC SQL  Select substr(SHORT_DESC,1,20)  into :nd_prt_line_desc 
			  From BL_BLNG_PRT_GRP_LINE_lang_vw
			  Where  PRT_GRP_HDR_CODE=:d_prt_grp_hdr_code
			  and PRT_GRP_LINE_CODE=:d_prt_grp_line_code
			  AND LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GR\
P_LINE_lang_vw where ((PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2) and LAN\
GUAGE_ID=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8765;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_prt_grp_hdr_code;
 sqlstm.sqhstl[1] = (unsigned int  )9;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_prt_grp_line_code;
 sqlstm.sqhstl[2] = (unsigned int  )9;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 }
 if(strcmp(d_grp_ind.arr,"PSG")==0)
 {
   	/* EXEC SQL  Select substr(SHORT_DESC,1,20)  into :nd_prt_line_desc 
			  From BL_PAYER_SERV_GRP_LINE_LANG_VW
			  Where  OPERATING_FACILITY_ID=:nd_facility_id
			  And    CUST_CODE  =:d_payer_serv_grp_cust_code
			  And    PATIENT_CLASS=:d_payer_serv_grp_pat_class
			  And    PAYER_SERV_GRP_HDR=:d_payer_serv_grp_hdr
			  And    PAYER_SERV_GRP_LINE=:d_payer_serv_grp_line
			  And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_PAYER_SE\
RV_GRP_LINE_LANG_VW where (((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) an\
d PATIENT_CLASS=:b3) and PAYER_SERV_GRP_HDR=:b4) and PAYER_SERV_GRP_LINE=:b5) \
and LANGUAGE_ID=:b6)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8796;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_payer_serv_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d_payer_serv_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d_payer_serv_grp_hdr;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&d_payer_serv_grp_line;
    sqlstm.sqhstl[5] = (unsigned int  )9;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[6] = (unsigned int  )6;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 }
/**upto here***/
nd_prt_line_desc.arr[nd_prt_line_desc.len] = '\0';
//disp_message(ERR_MESG,nd_prt_line_desc.arr);
 if (OERROR)
	 err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_LINE",0,"");


}

get_print_group_hd_desc2()
{
nd_prt_hd_desc.arr[0] = '\0';
nd_prt_hd_desc.len=0;

/* EXEC SQL  Select substr(SHORT_DESC,1,20) into :nd_prt_hd_desc 
          From BL_BLNG_PRT_GRP_HDR_LANG_VW
		  Where  PRT_GRP_HDR_CODE=:nd_prt_grp_hdr_code
		  AND LANGUAGE_ID =: nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GRP\
_HDR_LANG_VW where (PRT_GRP_HDR_CODE=:b1 and LANGUAGE_ID=:b2)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8839;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
sqlstm.sqhstl[0] = (unsigned int  )48;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_prt_grp_hdr_code;
sqlstm.sqhstl[1] = (unsigned int  )9;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[2] = (unsigned int  )6;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}





nd_prt_hd_desc.arr[nd_prt_hd_desc.len] = '\0';

 if (OERROR)
	err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_HDR",0,"");


 //strcpy(nd_ref_prt_grp_hdr_code.arr,nd_prt_grp_hdr_code.arr);
 strcpy(nd_ref_prt_grp_line_code.arr,nd_prt_grp_line_code.arr);


}

get_print_group_line_desc2()
{
nd_prt_line_desc.arr[0] = '\0';
nd_prt_line_desc.len=0;

/* EXEC SQL  Select substr(SHORT_DESC,1,20) into :nd_prt_line_desc 
          From   BL_BLNG_PRT_GRP_LINE_LANG_VW
		  Where  PRT_GRP_HDR_CODE=:nd_prt_grp_hdr_code
		  and    PRT_GRP_LINE_CODE=:nd_prt_grp_line_code
		  AND    LANGUAGE_ID =: nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GRP\
_LINE_LANG_VW where ((PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2) and LANG\
UAGE_ID=:b3)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )8866;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
sqlstm.sqhstl[0] = (unsigned int  )48;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_prt_grp_hdr_code;
sqlstm.sqhstl[1] = (unsigned int  )9;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd_prt_grp_line_code;
sqlstm.sqhstl[2] = (unsigned int  )9;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[3] = (unsigned int  )6;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




nd_prt_line_desc.arr[nd_prt_line_desc.len] = '\0';

 if (OERROR)
	err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_LINE",0,"");


}

get_print_group_hd_desc()
{
nd_prt_hd_desc.arr[0] = '\0';
nd_prt_hd_desc.len=0;


 if(strcmp(d1_grp_ind.arr,"ESG")==0)
 {
	/* EXEC SQL  Select substr(SHORT_DESC,1,20) into :nd_prt_hd_desc 
			  From BL_BLNG_PRT_GRP_HDR_LANG_VW
			  Where  PRT_GRP_HDR_CODE=:d1_prt_grp_hdr_code
			  AND LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GR\
P_HDR_LANG_VW where (PRT_GRP_HDR_CODE=:b1 and LANGUAGE_ID=:b2)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )8897;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d1_prt_grp_hdr_code;
 sqlstm.sqhstl[1] = (unsigned int  )9;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[2] = (unsigned int  )6;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
 }
 if(strcmp(d1_grp_ind.arr,"PSG")==0)
 {
   	/* EXEC SQL Select substr(SHORT_DESC,1,20) into :nd_prt_hd_desc 
			From   BL_PAYER_SERV_GRP_HDR_LANG_VW
			Where  OPERATING_FACILITY_ID=:nd_facility_id
			And    CUST_CODE  =:d1_payer_serv_grp_cust_code
			And    PATIENT_CLASS=:d1_payer_serv_grp_pat_class
			And    PAYER_SERV_GRP_HDR=:d1_payer_serv_grp_hdr
			And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_PAYER_SE\
RV_GRP_HDR_LANG_VW where ((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) and \
PATIENT_CLASS=:b3) and PAYER_SERV_GRP_HDR=:b4) and LANGUAGE_ID=:b5)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8924;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d1_payer_serv_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d1_payer_serv_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d1_payer_serv_grp_hdr;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[5] = (unsigned int  )6;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


  
 }

 if(strcmp(d1_grp_ind.arr,"PMG")==0)
 {
   	/* EXEC SQL Select substr(SHORT_DESC,1,20) into :nd_prt_hd_desc 
			From   BL_PAYER_ITEM_GRP_LANG_VW 
			Where  OPERATING_FACILITY_ID=:nd_facility_id
			And    CUST_CODE  =:d1_payer_item_grp_cust_code
			And    PATIENT_CLASS=:d1_payer_item_grp_pat_class
			And    PAYER_ITEM_GRP_CODE=:d1_payer_item_grp_code
			And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_PAYER_IT\
EM_GRP_LANG_VW where ((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) and PATI\
ENT_CLASS=:b3) and PAYER_ITEM_GRP_CODE=:b4) and LANGUAGE_ID=:b5)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )8963;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d1_payer_item_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d1_payer_item_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d1_payer_item_grp_code;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[5] = (unsigned int  )6;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   
 }

nd_prt_hd_desc.arr[nd_prt_hd_desc.len] = '\0';


 if (OERROR)
	err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_HDR",0,"");


}

get_print_group_hd_desc1()
{
nd_prt_hd_desc.arr[0] = '\0';
nd_prt_hd_desc.len=0;

/* EXEC SQL  Select substr(SHORT_DESC,1,20) into :nd_prt_hd_desc 
          From BL_BLNG_PRT_GRP_HDR_LANG_VW
		  Where  PRT_GRP_HDR_CODE=:nd1_prt_grp_hdr_code
		  AND LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GRP\
_HDR_LANG_VW where (PRT_GRP_HDR_CODE=:b1 and LANGUAGE_ID=:b2)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )9002;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&nd_prt_hd_desc;
sqlstm.sqhstl[0] = (unsigned int  )48;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd1_prt_grp_hdr_code;
sqlstm.sqhstl[1] = (unsigned int  )9;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[2] = (unsigned int  )6;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




nd_prt_hd_desc.arr[nd_prt_hd_desc.len] = '\0';

 if (OERROR)
	err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_HDR",0,"");

}

get_print_group_line_desc()
{
nd_prt_line_desc.arr[0] = '\0';
nd_prt_line_desc.len=0;

 
 if(strcmp(d1_grp_ind.arr,"ESL")==0)
 {
	/* EXEC SQL  Select substr(SHORT_DESC,1,20) into :nd_prt_line_desc 
			  From BL_BLNG_PRT_GRP_LINE_LANG_VW
			  Where  PRT_GRP_HDR_CODE=:d1_prt_grp_hdr_code
			  and PRT_GRP_LINE_CODE=:d1_prt_grp_line_code
			  AND LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GR\
P_LINE_LANG_VW where ((PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2) and LAN\
GUAGE_ID=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )9029;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d1_prt_grp_hdr_code;
 sqlstm.sqhstl[1] = (unsigned int  )9;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d1_prt_grp_line_code;
 sqlstm.sqhstl[2] = (unsigned int  )9;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 }
 if(strcmp(d1_grp_ind.arr,"PSL")==0)
 {
   	/* EXEC SQL  Select substr(SHORT_DESC,1,20)  into :nd_prt_line_desc 
			  From BL_PAYER_SERV_GRP_LINE_LANG_VW
			  Where  OPERATING_FACILITY_ID=:nd_facility_id
			  And    CUST_CODE  =:d1_payer_serv_grp_cust_code
			  And    PATIENT_CLASS=:d1_payer_serv_grp_pat_class
			  And    PAYER_SERV_GRP_HDR=:d1_payer_serv_grp_hdr
			  And    PAYER_SERV_GRP_LINE=:d1_payer_serv_grp_line
			  And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_PAYER_SE\
RV_GRP_LINE_LANG_VW where (((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) an\
d PATIENT_CLASS=:b3) and PAYER_SERV_GRP_HDR=:b4) and PAYER_SERV_GRP_LINE=:b5) \
and LANGUAGE_ID=:b6)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )9060;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d1_payer_serv_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d1_payer_serv_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d1_payer_serv_grp_hdr;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&d1_payer_serv_grp_line;
    sqlstm.sqhstl[5] = (unsigned int  )9;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[6] = (unsigned int  )6;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 }

/***added by vani at the time of merging walkthrough***/
if(strcmp(d1_grp_ind.arr,"ESG")==0)
 {
	/* EXEC SQL  Select substr(SHORT_DESC,1,20) into :nd_prt_line_desc 
			  From BL_BLNG_PRT_GRP_LINE_LANG_VW
			  Where  PRT_GRP_HDR_CODE=:d1_prt_grp_hdr_code
			  and PRT_GRP_LINE_CODE=:d1_prt_grp_line_code
			  AND LANGUAGE_ID = :nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GR\
P_LINE_LANG_VW where ((PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2) and LAN\
GUAGE_ID=:b3)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )9103;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
 sqlstm.sqhstl[0] = (unsigned int  )48;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d1_prt_grp_hdr_code;
 sqlstm.sqhstl[1] = (unsigned int  )9;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d1_prt_grp_line_code;
 sqlstm.sqhstl[2] = (unsigned int  )9;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 }

if(strcmp(d1_grp_ind.arr,"PSG")==0)
 {
   	/* EXEC SQL  Select substr(SHORT_DESC,1,20)  into :nd_prt_line_desc 
			  From BL_PAYER_SERV_GRP_LINE_LANG_VW
			  Where  OPERATING_FACILITY_ID=:nd_facility_id
			  And    CUST_CODE  =:d1_payer_serv_grp_cust_code
			  And    PATIENT_CLASS=:d1_payer_serv_grp_pat_class
			  And    PAYER_SERV_GRP_HDR=:d1_payer_serv_grp_hdr
			  And    PAYER_SERV_GRP_LINE=:d1_payer_serv_grp_line
			  And    LANGUAGE_ID =:nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_PAYER_SE\
RV_GRP_LINE_LANG_VW where (((((OPERATING_FACILITY_ID=:b1 and CUST_CODE=:b2) an\
d PATIENT_CLASS=:b3) and PAYER_SERV_GRP_HDR=:b4) and PAYER_SERV_GRP_LINE=:b5) \
and LANGUAGE_ID=:b6)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )9134;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
    sqlstm.sqhstl[0] = (unsigned int  )48;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d1_payer_serv_grp_cust_code;
    sqlstm.sqhstl[2] = (unsigned int  )12;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&d1_payer_serv_grp_pat_class;
    sqlstm.sqhstl[3] = (unsigned int  )7;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&d1_payer_serv_grp_hdr;
    sqlstm.sqhstl[4] = (unsigned int  )9;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&d1_payer_serv_grp_line;
    sqlstm.sqhstl[5] = (unsigned int  )9;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[6] = (unsigned int  )6;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 }
/**upto here***/
nd_prt_line_desc.arr[nd_prt_line_desc.len] = '\0';


 if (OERROR)
	err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_LINE",0,"");


}
  


get_print_group_line_desc1()
{
nd_prt_line_desc.arr[0] = '\0';
nd_prt_line_desc.len=0;

/* EXEC SQL  Select substr(SHORT_DESC,1,20) into :nd_prt_line_desc 
          From BL_BLNG_PRT_GRP_LINE_LANG_VW
		  Where  PRT_GRP_HDR_CODE=:nd1_prt_grp_hdr_code
		  and PRT_GRP_LINE_CODE=:nd1_prt_grp_line_code
		  AND LANGUAGE_ID = :nd_lang_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select substr(SHORT_DESC,1,20) into :b0  from BL_BLNG_PRT_GRP\
_LINE_LANG_VW where ((PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2) and LANG\
UAGE_ID=:b3)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )9177;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&nd_prt_line_desc;
sqlstm.sqhstl[0] = (unsigned int  )48;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd1_prt_grp_hdr_code;
sqlstm.sqhstl[1] = (unsigned int  )9;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd1_prt_grp_line_code;
sqlstm.sqhstl[2] = (unsigned int  )9;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[3] = (unsigned int  )6;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



nd_prt_line_desc.arr[nd_prt_line_desc.len] = '\0';

 if (OERROR)
	 err_mesg("SELECT failed on table BL_BLNG_PRT_GRP_LINE",0,"");


}


get_blng_serv_desc()
{
nd_blng_desc.arr[0] = '\0';
nd_blng_desc.len=0;
nd_mapping_code_desc.arr[0] = '\0';
nd_mapping_code_desc.len =0;

if (d_summary_dtl_ind.arr[5] == 'A') 
 {
  
  /* EXEC SQL  SELECT b.MAPPING_CODE,substr(a.LONG_DESC,1,80)
			  INTO :d_mapping_code,nd_mapping_code_desc	
			  FROM BL_SERV_MAPPING_CODE a, BL_ITEMS_FOR_MAPPING_CODE b
			  WHERE a.OPERATING_FACILITY_ID= b.OPERATING_FACILITY_Id
			  AND a.MAPPING_CODE_IND       = b.MAPPING_CODE_IND
			  AND a.MAPPING_CODE           = b.MAPPING_CODE
			  AND a.MAPPING_CODE_IND	   = :d_mapping_code_ind
    		  AND b.ITEM_CODE=DECODE(:d_mapping_code_ind,'S',:d_blng_serv_code,:d_serv_item_code); */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select b.MAPPING_CODE ,substr(a.LONG_DESC,1,80) into :b0,:b\
1  from BL_SERV_MAPPING_CODE a ,BL_ITEMS_FOR_MAPPING_CODE b where ((((a.OPERAT\
ING_FACILITY_ID=b.OPERATING_FACILITY_Id and a.MAPPING_CODE_IND=b.MAPPING_CODE_\
IND) and a.MAPPING_CODE=b.MAPPING_CODE) and a.MAPPING_CODE_IND=:b2) and b.ITEM\
_CODE=DECODE(:b2,'S',:b4,:b5))";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9208;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_mapping_code;
  sqlstm.sqhstl[0] = (unsigned int  )14;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_mapping_code_desc;
  sqlstm.sqhstl[1] = (unsigned int  )48;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d_mapping_code_ind;
  sqlstm.sqhstl[2] = (unsigned int  )5;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d_mapping_code_ind;
  sqlstm.sqhstl[3] = (unsigned int  )5;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&d_blng_serv_code;
  sqlstm.sqhstl[4] = (unsigned int  )33;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&d_serv_item_code;
  sqlstm.sqhstl[5] = (unsigned int  )63;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		
		if (OERROR)
	    err_mesg("SELECT failed on table BL_MAPPING_CODE",0,"");
		
		if(NODATAFOUND)
		{
		 strcpy(d1_mapping_code.arr," ");
			/* EXEC SQL  Select substr(SHORT_DESC,1,80) into :nd_mapping_code_desc 
					  From BL_BLNG_SERV_LANG_VW
					  Where  blng_serv_code=:d_blng_serv_code
					  AND LANGUAGE_ID = :nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(SHORT_DESC,1,80) into :b0  from BL_BLNG_SERV\
_LANG_VW where (blng_serv_code=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )9247;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_mapping_code_desc;
   sqlstm.sqhstl[0] = (unsigned int  )48;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&d_blng_serv_code;
   sqlstm.sqhstl[1] = (unsigned int  )33;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[2] = (unsigned int  )6;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		 
		}
	    d_mapping_code.arr[d_mapping_code.len]			   = '\0';
		nd_mapping_code_desc.arr[nd_mapping_code_desc.len] = '\0';
  
 }
else
 {
   if(strcmp(d_serv_item_desc.arr,"X")==0)
   {
		/* EXEC SQL  Select substr(SHORT_DESC,1,30) into :nd_blng_desc 
				  From BL_BLNG_SERV_LANG_VW
				  Where  blng_serv_code=:d_blng_serv_code
				  AND LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(SHORT_DESC,1,30) into :b0  from BL_BLNG_SERV_\
LANG_VW where (blng_serv_code=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9274;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_blng_desc;
  sqlstm.sqhstl[0] = (unsigned int  )83;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_blng_serv_code;
  sqlstm.sqhstl[1] = (unsigned int  )33;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


       
	   nd_blng_desc.arr[nd_blng_desc.len] = '\0';

	   
   }
   else
   {
     strcpy(nd_blng_desc.arr,d_serv_item_desc.arr);
   }
	

	 if (OERROR)
		 err_mesg("SELECT failed on table BL_BLNG_SERV",0,"");
	}

}

get_blng_serv_desc1()
{
nd_blng_desc1.arr[0] = '\0';
nd_blng_desc1.len=0;
nd1_mapping_code_desc.arr[0] = '\0';
nd1_mapping_code_desc.len =0;

if (d1_summary_dtl_ind.arr[5] == 'A') 
{
  
  /* EXEC SQL  SELECT b.MAPPING_CODE,substr(a.LONG_DESC,1,30)
			  INTO :d1_mapping_code,nd1_mapping_code_desc	
			  FROM BL_SERV_MAPPING_CODE a, BL_ITEMS_FOR_MAPPING_CODE b
			  WHERE a.OPERATING_FACILITY_ID= b.OPERATING_FACILITY_Id
			  AND a.MAPPING_CODE_IND       = b.MAPPING_CODE_IND
			  AND a.MAPPING_CODE           = b.MAPPING_CODE
			  AND a.MAPPING_CODE_IND	   = :d1_mapping_code_ind
    		  AND b.ITEM_CODE=DECODE(:d1_mapping_code_ind,'S',:d1_blng_serv_code,:d1_serv_item_code); */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select b.MAPPING_CODE ,substr(a.LONG_DESC,1,30) into :b0,:b\
1  from BL_SERV_MAPPING_CODE a ,BL_ITEMS_FOR_MAPPING_CODE b where ((((a.OPERAT\
ING_FACILITY_ID=b.OPERATING_FACILITY_Id and a.MAPPING_CODE_IND=b.MAPPING_CODE_\
IND) and a.MAPPING_CODE=b.MAPPING_CODE) and a.MAPPING_CODE_IND=:b2) and b.ITEM\
_CODE=DECODE(:b2,'S',:b4,:b5))";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9301;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d1_mapping_code;
  sqlstm.sqhstl[0] = (unsigned int  )14;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd1_mapping_code_desc;
  sqlstm.sqhstl[1] = (unsigned int  )48;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d1_mapping_code_ind;
  sqlstm.sqhstl[2] = (unsigned int  )5;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d1_mapping_code_ind;
  sqlstm.sqhstl[3] = (unsigned int  )5;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&d1_blng_serv_code;
  sqlstm.sqhstl[4] = (unsigned int  )33;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&d1_serv_item_code;
  sqlstm.sqhstl[5] = (unsigned int  )63;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		
		if (OERROR)
	    err_mesg("SELECT failed on table BL_MAPPING_CODE",0,"");
		
		if(NODATAFOUND)
		{
		 strcpy(d1_mapping_code.arr," ");

		 /* EXEC SQL  SELECT substr(SHORT_DESC,1,30) into :nd1_mapping_code_desc 
			  FROM   BL_BLNG_SERV_LANG_VW
			  WHERE  blng_serv_code   =:d1_blng_serv_code
			  AND    LANGUAGE_ID      =:nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(SHORT_DESC,1,30) into :b0  from BL_BLNG_SERV\
_LANG_VW where (blng_serv_code=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )9340;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd1_mapping_code_desc;
   sqlstm.sqhstl[0] = (unsigned int  )48;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&d1_blng_serv_code;
   sqlstm.sqhstl[1] = (unsigned int  )33;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[2] = (unsigned int  )6;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		 
		}
	    d1_mapping_code.arr[d1_mapping_code.len]			 = '\0';
		nd1_mapping_code_desc.arr[nd1_mapping_code_desc.len] = '\0';
  
}
else
{
  if(strcmp(d1_serv_item_desc.arr,"X")==0)
   {
		/* EXEC SQL  Select substr(SHORT_DESC,1,30) into :nd_blng_desc1 
				  From BL_BLNG_SERV_LANG_VW
				  Where  blng_serv_code=:d1_blng_serv_code
				  AND LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(SHORT_DESC,1,30) into :b0  from BL_BLNG_SERV_\
LANG_VW where (blng_serv_code=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9367;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_blng_desc1;
  sqlstm.sqhstl[0] = (unsigned int  )63;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d1_blng_serv_code;
  sqlstm.sqhstl[1] = (unsigned int  )33;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	    nd_blng_desc1.arr[nd_blng_desc1.len] = '\0';
	
   }
   else
   {
     strcpy(nd_blng_desc1.arr,d1_serv_item_desc.arr);
   }
	

	 if (OERROR)
		err_mesg("SELECT failed on table BL_BLNG_SERV",0,"");
}

}

get_bill_address_lsr()
{   
        int cnt1 = 0;

	l_bill_contact_name_p.arr[0] = '\0';
	l_bill_contact_name_p.len = 0;

	l_bill_contact_name_title_p.arr[0] = '\0';
	l_bill_contact_name_title_p.len = 0;

	l_bill_long_desc_p.arr[0] = '\0';
	l_bill_long_desc_p.len = 0;

	l_bill_add1_desc_p.arr[0] = '\0';
	l_bill_add1_desc_p.len = 0;

	l_bill_add2_desc_p.arr[0] = '\0';
	l_bill_add2_desc_p.len = 0;

	l_bill_add3_desc_p.arr[0] = '\0';
	l_bill_add3_desc_p.len = 0;


	l_bill_contact_name_c.arr[0] = '\0';
	l_bill_contact_name_c.len = 0;

	l_bill_contact_name_title_c.arr[0] = '\0';
	l_bill_contact_name_title_c.len = 0;

	l_bill_long_desc_c.arr[0] = '\0';
	l_bill_long_desc_c.len = 0;

	l_bill_add1_desc_c.arr[0] = '\0';
	l_bill_add1_desc_c.len = 0;

	l_bill_add2_desc_c.arr[0] = '\0';
	l_bill_add2_desc_c.len = 0;

	l_bill_add3_desc_c.arr[0] = '\0';
	l_bill_add3_desc_c.len = 0;


	l_line1.arr[0] = '\0';
	l_line2.arr[0] = '\0';
	l_line3.arr[0] = '\0';
	l_line4.arr[0] = '\0';
	l_line5.arr[0] = '\0';
	l_line6.arr[0] = '\0';

	l_line1.len = 0;
	l_line2.len = 0;
	l_line3.len = 0;
	l_line4.len = 0;
	l_line5.len = 0;
	l_line6.len = 0;
	
	if(strcmp(d_bill_nature_code.arr,"A")==0)
	{
		/* EXEC SQL SELECT		contact_name,
					contact_name_title,
					long_name,
					add1_desc,
					add2_desc,
					add3_desc
				   INTO 
						/o:l_bill_contact_name_c,
						:l_bill_contact_name_title_c,
						:l_bill_long_desc_c,
						:l_bill_add1_desc_c,
						:l_bill_add2_desc_c,
						:l_bill_add3_desc_co/
					:l_line1,
					:l_line2,
					:l_line3,
					:l_line4,
					:l_line5,
					:l_line6
				   FROM ar_customer_lang_vw
				  WHERE cust_code = :d_cust_code
				  AND LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select contact_name ,contact_name_title ,long_name ,add1_de\
sc ,add2_desc ,add3_desc into :b0,:b1,:b2,:b3,:b4,:b5  from ar_customer_lang_v\
w where (cust_code=:b6 and LANGUAGE_ID=:b7)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9394;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_line1;
  sqlstm.sqhstl[0] = (unsigned int  )52;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&l_line2;
  sqlstm.sqhstl[1] = (unsigned int  )52;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&l_line3;
  sqlstm.sqhstl[2] = (unsigned int  )52;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&l_line4;
  sqlstm.sqhstl[3] = (unsigned int  )52;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&l_line5;
  sqlstm.sqhstl[4] = (unsigned int  )52;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&l_line6;
  sqlstm.sqhstl[5] = (unsigned int  )52;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqhstv[6] = (         void  *)&d_cust_code;
  sqlstm.sqhstl[6] = (unsigned int  )27;
  sqlstm.sqhsts[6] = (         int  )0;
  sqlstm.sqindv[6] = (         void  *)0;
  sqlstm.sqinds[6] = (         int  )0;
  sqlstm.sqharm[6] = (unsigned int  )0;
  sqlstm.sqadto[6] = (unsigned short )0;
  sqlstm.sqtdso[6] = (unsigned short )0;
  sqlstm.sqhstv[7] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[7] = (unsigned int  )6;
  sqlstm.sqhsts[7] = (         int  )0;
  sqlstm.sqindv[7] = (         void  *)0;
  sqlstm.sqinds[7] = (         int  )0;
  sqlstm.sqharm[7] = (unsigned int  )0;
  sqlstm.sqadto[7] = (unsigned short )0;
  sqlstm.sqtdso[7] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  


			   if (OERROR)
					err_mesg("SELECT failed on table AR_CUSTOMER",0,"");

	l_line1.arr[l_line1.len] = '\0';
	l_line2.arr[l_line2.len] = '\0';
	l_line3.arr[l_line3.len] = '\0';
	l_line4.arr[l_line4.len] = '\0';
	l_line5.arr[l_line5.len] = '\0';
	l_line6.arr[l_line6.len] = '\0';

	if(l_line6.len > 0)
		{
			l_bill_add3_desc_temp.arr[0] = '\0';
			l_bill_add3_desc_temp.len = 0;

			/* EXEC SQL SELECT long_name
				 INTO :l_bill_add3_desc_temp
				 FROM mp_country_lang_vw
				 WHERE country_code = :l_line6
				 AND LANGUAGE_ID = :nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select long_name into :b0  from mp_country_lang_vw where (\
country_code=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )9441;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&l_bill_add3_desc_temp;
   sqlstm.sqhstl[0] = (unsigned int  )42;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_line6;
   sqlstm.sqhstl[1] = (unsigned int  )52;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[2] = (unsigned int  )6;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  

			l_bill_add3_desc_temp.arr[l_bill_add3_desc_temp.len] = '\0';

			if((strcmp(l_bill_add3_desc_temp.arr,l_line6.arr)!=0)
				&& (l_bill_add3_desc_temp.len > 0))
			{
				strcpy(l_line6.arr,l_bill_add3_desc_temp.arr);
				l_line6.len = strlen(l_line6.arr);
			}
		}
	
	if (l_line1.arr[0] != '\0')
	{
		cnt1 = cnt1+1;
		strcpy(l_bill_contact_name_c.arr,l_line1.arr);
	}

	if (l_line2.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_c.arr,l_line2.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_c.arr,l_line2.arr);	
		}
	}

	if (l_line3.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_c.arr,l_line3.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_c.arr,l_line3.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_c.arr,l_line3.arr);	
		}
	}

	if (l_line4.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_c.arr,l_line4.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_c.arr,l_line4.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_c.arr,l_line4.arr);	
		}
		else if (cnt1 == 3)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add1_desc_c.arr,l_line4.arr);	
		}
	}

	if (l_line5.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_c.arr,l_line5.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_c.arr,l_line5.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_c.arr,l_line5.arr);	
		}
		else if (cnt1 == 3)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add1_desc_c.arr,l_line5.arr);	
		}

		else if (cnt1 == 4)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add2_desc_c.arr,l_line5.arr);	
		}
	}

	if (l_line6.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_c.arr,l_line6.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_c.arr,l_line6.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_c.arr,l_line6.arr);	
		}
		else if (cnt1 == 3)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add1_desc_c.arr,l_line6.arr);	
		}

		else if (cnt1 == 4)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add2_desc_c.arr,l_line6.arr);	
		}

		else if (cnt1 == 5)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add3_desc_c.arr,l_line6.arr);	
		}
	}
	
	l_bill_contact_name_c.len = strlen(l_bill_contact_name_c.arr);
	l_bill_contact_name_title_c.len = strlen(l_bill_contact_name_title_c.arr);
	l_bill_long_desc_c.len = strlen(l_bill_long_desc_c.arr);
	l_bill_add1_desc_c.len = strlen(l_bill_add1_desc_c.arr);
	l_bill_add2_desc_c.len = strlen(l_bill_add2_desc_c.arr);
	l_bill_add3_desc_c.len = strlen(l_bill_add3_desc_c.arr);
	
	l_bill_contact_name_c.arr[l_bill_contact_name_c.len] = '\0';
	l_bill_contact_name_title_c.arr[l_bill_contact_name_title_c.len] = '\0';
	l_bill_long_desc_c.arr[l_bill_long_desc_c.len] = '\0';
	l_bill_add1_desc_c.arr[l_bill_add1_desc_c.len] = '\0';
	l_bill_add2_desc_c.arr[l_bill_add2_desc_c.len] = '\0';
	l_bill_add3_desc_c.arr[l_bill_add3_desc_c.len] = '\0';


	}

	cnt1 = 0;

	l_line1.arr[0] = '\0';
	l_line2.arr[0] = '\0';
	l_line3.arr[0] = '\0';
	l_line4.arr[0] = '\0';
	l_line5.arr[0] = '\0';
	l_line6.arr[0] = '\0';	

	l_line1.len = 0;
	l_line2.len = 0;
	l_line3.len = 0;
	l_line4.len = 0;
	l_line5.len = 0;
	l_line6.len = 0;	

	
	/* EXEC SQL SELECT		mail_contact_name,								
				ln1_mail_add,
				ln2_mail_add,
				ln3_mail_add,
				mail_postal_code,
				mail_country_code
			   INTO 
				:l_line1,
				:l_line2,
				:l_line3,
				:l_line4,
				:l_line5,
				:l_line6
			   FROM mp_pat_other_dtls
			   WHERE patient_id = :d_patient_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select mail_contact_name ,ln1_mail_add ,ln2_mail_add ,ln3_ma\
il_add ,mail_postal_code ,mail_country_code into :b0,:b1,:b2,:b3,:b4,:b5  from\
 mp_pat_other_dtls where patient_id=:b6";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )9468;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_line1;
 sqlstm.sqhstl[0] = (unsigned int  )52;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&l_line2;
 sqlstm.sqhstl[1] = (unsigned int  )52;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&l_line3;
 sqlstm.sqhstl[2] = (unsigned int  )52;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&l_line4;
 sqlstm.sqhstl[3] = (unsigned int  )52;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&l_line5;
 sqlstm.sqhstl[4] = (unsigned int  )52;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&l_line6;
 sqlstm.sqhstl[5] = (unsigned int  )52;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[6] = (unsigned int  )63;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			   if (OERROR)
				  err_mesg("SELECT failed on table MP_PAT_OTHER_DTLS",0,"");

	l_line1.arr[l_line1.len] = '\0';
	l_line2.arr[l_line2.len] = '\0';
	l_line3.arr[l_line3.len] = '\0';
	l_line4.arr[l_line4.len] = '\0';
	l_line5.arr[l_line5.len] = '\0';
	l_line6.arr[l_line6.len] = '\0';		

	if (l_line5.arr[0] != '\0' && loc_legend[630][0] != '\0')
	{
		strcat(loc_legend[630]," ");		
		strcat(loc_legend[630],l_line5.arr);		

		l_line5.arr[0] = '\0';
		l_line5.len = 0;
		strcpy(l_line5.arr,loc_legend[630]);
		l_line5.len = strlen(l_line5.arr);

	}

	if(l_line6.len > 0)   // country code
	{
		l_bill_add3_desc_temp.arr[0] = '\0';
		l_bill_add3_desc_temp.len = 0;

		/* EXEC SQL SELECT long_name
			 INTO :l_bill_add3_desc_temp
			 FROM mp_country_lang_vw
			 WHERE country_code = :l_line6
			 AND LANGUAGE_ID = :nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select long_name into :b0  from mp_country_lang_vw where (c\
ountry_code=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9511;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_bill_add3_desc_temp;
  sqlstm.sqhstl[0] = (unsigned int  )42;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&l_line6;
  sqlstm.sqhstl[1] = (unsigned int  )52;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

  

		l_bill_add3_desc_temp.arr[l_bill_add3_desc_temp.len] = '\0';

		if((strcmp(l_bill_add3_desc_temp.arr,l_line6.arr)!=0)
			&& (l_bill_add3_desc_temp.len > 0))
		{
			strcpy(l_line6.arr,l_bill_add3_desc_temp.arr);
			l_line6.len = strlen(l_line6.arr);
		}
	}

	if (l_line1.arr[0] != '\0')
	{
		cnt1 = cnt1+1;
		strcpy(l_bill_contact_name_p.arr,l_line1.arr);
	}

	if (l_line2.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_p.arr,l_line2.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_p.arr,l_line2.arr);	
		}
	}

	if (l_line3.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_p.arr,l_line3.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_p.arr,l_line3.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_p.arr,l_line3.arr);	
		}
	}

	if (l_line4.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_p.arr,l_line4.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_p.arr,l_line4.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_p.arr,l_line4.arr);	
		}
		else if (cnt1 == 3)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add1_desc_p.arr,l_line4.arr);	
		}
	}

	if (l_line5.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_p.arr,l_line5.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_p.arr,l_line5.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_p.arr,l_line5.arr);	
		}
		else if (cnt1 == 3)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add1_desc_p.arr,l_line5.arr);	
		}

		else if (cnt1 == 4)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add2_desc_p.arr,l_line5.arr);	
		}
	}

	if (l_line6.arr[0] != '\0')
	{
		if (cnt1 == 0)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_p.arr,l_line6.arr);
		}
		else if (cnt1 == 1)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_contact_name_title_p.arr,l_line6.arr);	
		}
		else if (cnt1 == 2)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_long_desc_p.arr,l_line6.arr);	
		}
		else if (cnt1 == 3)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add1_desc_p.arr,l_line6.arr);	
		}

		else if (cnt1 == 4)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add2_desc_p.arr,l_line6.arr);	
		}

		else if (cnt1 == 5)
		{
		   cnt1 = cnt1+1;
		   strcpy(l_bill_add3_desc_p.arr,l_line6.arr);	
		}
	}
	
	
	l_bill_contact_name_p.len = strlen(l_bill_contact_name_p.arr);
	l_bill_contact_name_title_p.len = strlen(l_bill_contact_name_title_p.arr);
	l_bill_long_desc_p.len = strlen(l_bill_long_desc_p.arr);
	l_bill_add1_desc_p.len = strlen(l_bill_add1_desc_p.arr);
	l_bill_add2_desc_p.len = strlen(l_bill_add2_desc_p.arr);
	l_bill_add3_desc_p.len = strlen(l_bill_add3_desc_p.arr);

	l_bill_contact_name_p.arr[l_bill_contact_name_p.len] = '\0';
	l_bill_contact_name_title_p.arr[l_bill_contact_name_title_p.len] = '\0';
	l_bill_long_desc_p.arr[l_bill_long_desc_p.len] = '\0';
	l_bill_add1_desc_p.arr[l_bill_add1_desc_p.len] = '\0';
	l_bill_add2_desc_p.arr[l_bill_add2_desc_p.len] = '\0';
	l_bill_add3_desc_p.arr[l_bill_add3_desc_p.len] = '\0';
		
}


get_gl_holder_name_nric()
{
	l_gl_holder_name.arr[0] = '\0';
	l_gl_holder_name.len = 0;

	l_pat_reln_with_gl_holder.arr[0] = '\0';
	l_pat_reln_with_gl_holder.len = 0;

	l_credit_doc_ref_desc.arr[0] = '\0';
	l_credit_doc_ref_desc.len = 0;
	
	l_gl_ic.arr[0] = '\0';
	l_gl_ic.len = 0;


	if(strcmp(d_bill_nature_code.arr,"A")==0)
	{
	   if (l_lsr != 0 && l_dmp == 0)
	   {
	   /*
		EXEC SQL SELECT (substr(gl_holder_name,1,decode(instr(gl_holder_name,';'),0,9999,instr(gl_holder_name,';'))-1)),
			            pat_reln_with_gl_holder,
				        credit_doc_ref_desc,
						ltrim(substr(gl_holder_name,decode(instr(gl_holder_name,';'),0,9999,instr(gl_holder_name,';'))+1)) 
			     INTO   :l_gl_holder_name,
						:l_pat_reln_with_gl_holder,
						:l_credit_doc_ref_desc,
						:l_gl_ic
				FROM bl_bill_hdr
				WHERE operating_facility_id = :nd_facility_id
				AND doc_type_code			= :d1_doc_type
				AND doc_num                 = :d1_doc_number; commented for scrum crf-654*/
/*ADDED FOR SCRUM REMERGING*/
      /* EXEC SQL SELECT (substr(gl_holder_name,1,decode(instr(gl_holder_name,';'),0,9999,instr(gl_holder_name,';'))-1)),
				pat_reln_with_gl_holder,
				credit_doc_ref_desc,
				ltrim(substr(gl_holder_name,decode(instr(gl_holder_name,';'),0,9999,instr(gl_holder_name,';'))+1)) 
		 INTO   :l_gl_holder_name,
				:l_pat_reln_with_gl_holder,
				:l_credit_doc_ref_desc,
				:l_gl_ic
		FROM BL_EPISODE_FIN_DTLS
		WHERE operating_facility_id = :nd_facility_id
		and episode_id=:d_episode_id
		and episode_type=:d_episode_type; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 52;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select substr(gl_holder_name,1,(decode(instr(gl_holder_\
name,';'),0,9999,instr(gl_holder_name,';'))-1)) ,pat_reln_with_gl_holder ,cred\
it_doc_ref_desc ,ltrim(substr(gl_holder_name,(decode(instr(gl_holder_name,';')\
,0,9999,instr(gl_holder_name,';'))+1))) into :b0,:b1,:b2,:b3  from BL_EPISODE_\
FIN_DTLS where ((operating_facility_id=:b4 and episode_id=:b5) and episode_typ\
e=:b6)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )9538;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&l_gl_holder_name;
      sqlstm.sqhstl[0] = (unsigned int  )183;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&l_pat_reln_with_gl_holder;
      sqlstm.sqhstl[1] = (unsigned int  )92;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&l_credit_doc_ref_desc;
      sqlstm.sqhstl[2] = (unsigned int  )92;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&l_gl_ic;
      sqlstm.sqhstl[3] = (unsigned int  )1002;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&nd_facility_id;
      sqlstm.sqhstl[4] = (unsigned int  )5;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqhstv[5] = (         void  *)&d_episode_id;
      sqlstm.sqhstl[5] = (unsigned int  )11;
      sqlstm.sqhsts[5] = (         int  )0;
      sqlstm.sqindv[5] = (         void  *)0;
      sqlstm.sqinds[5] = (         int  )0;
      sqlstm.sqharm[5] = (unsigned int  )0;
      sqlstm.sqadto[5] = (unsigned short )0;
      sqlstm.sqtdso[5] = (unsigned short )0;
      sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
      sqlstm.sqhstl[6] = (unsigned int  )4;
      sqlstm.sqhsts[6] = (         int  )0;
      sqlstm.sqindv[6] = (         void  *)0;
      sqlstm.sqinds[6] = (         int  )0;
      sqlstm.sqharm[6] = (unsigned int  )0;
      sqlstm.sqadto[6] = (unsigned short )0;
      sqlstm.sqtdso[6] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


/*ADDED FOR SCRUM REMERGING*/


				
	   }
	   else
	   {
		/*
		EXEC SQL SELECT substr(gl_holder_name,1,40),
						pat_reln_with_gl_holder,
						substr(credit_doc_ref_desc,1,29)||' '||to_char(credit_doc_ref_date,'DD/MM/YYYY')		   
				INTO	:l_gl_holder_name,
						:l_pat_reln_with_gl_holder,
						:l_credit_doc_ref_desc
				FROM bl_bill_hdr
				WHERE operating_facility_id = :nd_facility_id
				AND doc_type_code			= :d1_doc_type
				AND doc_num                 = :d1_doc_number;commented for scrum*/
/*ADDED FOR SCRUM REMERGING*/
		/* EXEC SQL SELECT substr(gl_holder_name,1,40),
		pat_reln_with_gl_holder,
		substr(credit_doc_ref_desc,1,29)||' '||to_char(credit_doc_ref_date,'DD/MM/YYYY')		   
		INTO	:l_gl_holder_name,
		:l_pat_reln_with_gl_holder,
		:l_credit_doc_ref_desc
		FROM BL_EPISODE_FIN_DTLS
		WHERE operating_facility_id = :nd_facility_id
		and episode_id=:d_episode_id
		and episode_type=:d_episode_type; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(gl_holder_name,1,40) ,pat_reln_with_gl_holder\
 ,((substr(credit_doc_ref_desc,1,29)||' ')||to_char(credit_doc_ref_date,'DD/MM\
/YYYY')) into :b0,:b1,:b2  from BL_EPISODE_FIN_DTLS where ((operating_facility\
_id=:b3 and episode_id=:b4) and episode_type=:b5)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9581;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&l_gl_holder_name;
  sqlstm.sqhstl[0] = (unsigned int  )183;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&l_pat_reln_with_gl_holder;
  sqlstm.sqhstl[1] = (unsigned int  )92;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&l_credit_doc_ref_desc;
  sqlstm.sqhstl[2] = (unsigned int  )92;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[3] = (unsigned int  )5;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
  sqlstm.sqhstl[4] = (unsigned int  )11;
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
  sqlstm.sqhstl[5] = (unsigned int  )4;
  sqlstm.sqhsts[5] = (         int  )0;
  sqlstm.sqindv[5] = (         void  *)0;
  sqlstm.sqinds[5] = (         int  )0;
  sqlstm.sqharm[5] = (unsigned int  )0;
  sqlstm.sqadto[5] = (unsigned short )0;
  sqlstm.sqtdso[5] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

;
/*ADDED FOR SCRUM REMERGING*/
			
	   }

	  if (OERROR)
		//err_mesg("SELECT failed on table BL_BILL_HDR - get_gl_holder_name_nric",0,""); //commeneted for scrum crf-654
		err_mesg("SELECT failed on table BL_EPISODE_FIN_DTLS - get_gl_holder_name_nric",0,""); // added for scrum crf-654

	
	
		l_gl_holder_name.arr[l_gl_holder_name.len] = '\0';
		l_pat_reln_with_gl_holder.arr[l_pat_reln_with_gl_holder.len] = '\0';
		l_gl_ic.arr[l_gl_ic.len] = '\0';
	}
	else
	{
		if (l_lsr != 0 && l_dmp == 0)
		{
			strcpy(l_gl_holder_name.arr,"");
			l_gl_holder_name.len = strlen(l_gl_holder_name.arr);
			strcpy(l_pat_reln_with_gl_holder.arr,""); //added for scrum crf-654
			l_pat_reln_with_gl_holder.len=strlen(l_pat_reln_with_gl_holder.arr);  //added for scrum crf-654

		}
		else
		{
			//strcpy(l_gl_holder_name.arr,dc_short_name.arr);
			strcpy(l_gl_holder_name.arr,"");
			l_gl_holder_name.len = strlen(l_gl_holder_name.arr);
			strcpy(l_pat_reln_with_gl_holder.arr,""); //added for scrum crf-654
			l_pat_reln_with_gl_holder.len=strlen(l_pat_reln_with_gl_holder.arr);  //added for scrum crf-654

		}
	}
	
	l_nric_number.arr[0]    = '\0';
	d_date_of_birth.arr[0]	= '\0';
	d_org_dept.arr[0]		= '\0';
	d_gender.arr[0]			= '\0';
	d_gender_desc.arr[0]='\0';
	d_gender_desc.len=0;

	/* EXEC SQL SELECT  national_id_num,
				     to_char(DATE_OF_BIRTH,'dd/mm/yyyy'),
				     blcommon.get_pat_EmpOrgDept (:d_patient_id,:nd_lang_id),
					 sex
	           INTO :l_nric_number,
					:d_date_of_birth,
					:d_org_dept,
					:d_gender
			   FROM mp_patient_mast
			   WHERE patient_id = :d_patient_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select national_id_num ,to_char(DATE_OF_BIRTH,'dd/mm/yyyy') \
,blcommon.get_pat_EmpOrgDept(:b0,:b1) ,sex into :b2,:b3,:b4,:b5  from mp_patie\
nt_mast where patient_id=:b0";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )9620;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[0] = (unsigned int  )63;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&l_nric_number;
 sqlstm.sqhstl[2] = (unsigned int  )27;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_date_of_birth;
 sqlstm.sqhstl[3] = (unsigned int  )33;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_org_dept;
 sqlstm.sqhstl[4] = (unsigned int  )102;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_gender;
 sqlstm.sqhstl[5] = (unsigned int  )4;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[6] = (unsigned int  )63;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	if (OERROR)
		err_mesg("SELECT failed on table MP_PATIENT_MAST - get_gl_holder_name_nric",0,"");

	l_nric_number.arr[l_nric_number.len]				 = '\0';
	l_credit_doc_ref_desc.arr[l_credit_doc_ref_desc.len] = '\0';
	d_date_of_birth.arr[d_date_of_birth.len]			 = '\0';
	d_org_dept.arr[d_org_dept.len]						 = '\0';
	d_gender.arr[d_gender.len]							 = '\0';


	if(d_gender.arr[0]=='M')
	strcpy(d_gender_desc.arr,loc_legend[1412]);
	else
	if(d_gender.arr[0]=='F')
	strcpy(d_gender_desc.arr,loc_legend[1413]);
	else
	strcpy(d_gender_desc.arr,loc_legend[1414]);


}


get_patient_name()
{

dc_short_name.arr[0]  ='\0';
dc_short_name.len     =  0;

	/* EXEC SQL SELECT  decode(:nd_lang_id,'en',short_name,short_name_loc_lang)
	           INTO :dc_short_name
			   FROM  mp_patient_mast
			  WHERE  patient_id = :d_patient_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select decode(:b0,'en',short_name,short_name_loc_lang) into \
:b1  from mp_patient_mast where patient_id=:b2";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )9663;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[0] = (unsigned int  )6;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&dc_short_name;
 sqlstm.sqhstl[1] = (unsigned int  )83;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[2] = (unsigned int  )63;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}





	if (OERROR)
		err_mesg("SELECT failed on table mp_patient_mast",0,"");

dc_short_name.arr[dc_short_name.len]  ='\0';

}
get_location()
{

d_location.arr[0]='\0';
d_location.len=0;
d_locn_code.arr[0]='\0';
d_locn_code.len=0;

/* EXEC SQL Select Decode(Upper(LOCN_TYPE),'CLINIC',LOCN_TYPE||': '||LOCN_DESC,
					  LOCN_TYPE||': '||LOCN_DESC||'/'||CUR_BED_NUM),LOCN_CODE
		Into  :d_location,:d_locn_code
		From BL_ENCOUNTER_FOR_QRY_VW
		Where FACILITY_ID=:nd_facility_id 
		And   PATIENT_ID=:d_patient_id
		And   UPPER(LANGUAGE_ID) = UPPER(:nd_lang_id)
		AND   EPISODE_TYPE = :d_episode_type
		And  (:d_episode_type ='R' or (:d_episode_type <> 'R' and EPISODE_ID=:d_episode_id))
		And  (:d_episode_type in ('R','I','D') or (:d_episode_type in ('O','E') and VISIT_ID=:d_visit_id)); */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select Decode(Upper(LOCN_TYPE),'CLINIC',((LOCN_TYPE||': ')||L\
OCN_DESC),((((LOCN_TYPE||': ')||LOCN_DESC)||'/')||CUR_BED_NUM)) ,LOCN_CODE int\
o :b0,:b1  from BL_ENCOUNTER_FOR_QRY_VW where (((((FACILITY_ID=:b2 and PATIENT\
_ID=:b3) and UPPER(LANGUAGE_ID)=UPPER(:b4)) and EPISODE_TYPE=:b5) and (:b5='R'\
 or (:b5<>'R' and EPISODE_ID=:b8))) and (:b5 in ('R','I','D') or (:b5 in ('O',\
'E') and VISIT_ID=:b11)))";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )9690;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&d_location;
sqlstm.sqhstl[0] = (unsigned int  )502;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&d_locn_code;
sqlstm.sqhstl[1] = (unsigned int  )17;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[2] = (unsigned int  )5;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_patient_id;
sqlstm.sqhstl[3] = (unsigned int  )63;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[4] = (unsigned int  )6;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_episode_type;
sqlstm.sqhstl[7] = (unsigned int  )4;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_id;
sqlstm.sqhstl[8] = (unsigned int  )11;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_episode_type;
sqlstm.sqhstl[9] = (unsigned int  )4;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_episode_type;
sqlstm.sqhstl[10] = (unsigned int  )4;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_visit_id;
sqlstm.sqhstl[11] = (unsigned int  )7;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
	if (OERROR)
		err_mesg("SELECT failed on table BL_ENCOUNTER_FOR_QRY_VW",0,"");

	d_location.arr[d_location.len]='\0';
	d_locn_code.arr[d_locn_code.len]='\0';
}
get_attd_admit_pract()
{
  d_attend_practitioner_id.arr[0]='\0';
  d_attend_practitioner_id.len=0;
  d_admit_practitioner_id.arr[0] ='\0';
  d_admit_practitioner_id.len=0;

/* EXEC SQL Select  ATTEND_PRACTITIONER_ID,ADMIT_PRACTITIONER_ID
		Into    :d_attend_practitioner_id,:d_admit_practitioner_id
		From pr_encounter 
		Where facility_id=:nd_facility_id 
		And   patient_id=:d_patient_id
		And   PATIENT_CLASS = Decode(:d_episode_type,'E','EM','O','OP','R','XT','I','IP','D','DC')
		And  (:d_episode_type ='R' or (:d_episode_type <> 'R' and EPISODE_ID=:d_episode_id))
		And  (:d_episode_type in ('R','I','D') or (:d_episode_type in ('O','E') and OP_EPISODE_VISIT_NUM=:d_visit_id)); */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select ATTEND_PRACTITIONER_ID ,ADMIT_PRACTITIONER_ID into :b0\
,:b1  from pr_encounter where ((((facility_id=:b2 and patient_id=:b3) and PATI\
ENT_CLASS=Decode(:b4,'E','EM','O','OP','R','XT','I','IP','D','DC')) and (:b4='\
R' or (:b4<>'R' and EPISODE_ID=:b7))) and (:b4 in ('R','I','D') or (:b4 in ('O\
','E') and OP_EPISODE_VISIT_NUM=:b10)))";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )9753;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&d_attend_practitioner_id;
sqlstm.sqhstl[0] = (unsigned int  )22;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&d_admit_practitioner_id;
sqlstm.sqhstl[1] = (unsigned int  )22;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[2] = (unsigned int  )5;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_patient_id;
sqlstm.sqhstl[3] = (unsigned int  )63;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_type;
sqlstm.sqhstl[4] = (unsigned int  )4;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_episode_id;
sqlstm.sqhstl[7] = (unsigned int  )11;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_episode_type;
sqlstm.sqhstl[9] = (unsigned int  )4;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_visit_id;
sqlstm.sqhstl[10] = (unsigned int  )7;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	if (OERROR)
		err_mesg("SELECT failed on table pr_encounter",0,"");


	d_attend_practitioner_id.arr[d_attend_practitioner_id.len]='\0';
    d_admit_practitioner_id.arr[d_admit_practitioner_id.len]  ='\0';

}
get_pract_name()
{
pract_name.arr[0]='\0';
pract_name.len=0;	

/* EXEC SQL SELECT NAME
		 INTO :pract_name
		 FROM BL_AM_PRACT_STAFF_VW
		 WHERE FACILITY_ID = :nd_facility_id 
		 AND UPPER(LANGUAGE_ID) = UPPER(:nd_lang_id)
		 AND PRACTITIONER_ID = :nd_pract_id
		 AND PRACT_STAFF_IND = 'P'; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select NAME into :b0  from BL_AM_PRACT_STAFF_VW where (((FACI\
LITY_ID=:b1 and UPPER(LANGUAGE_ID)=UPPER(:b2)) and PRACTITIONER_ID=:b3) and PR\
ACT_STAFF_IND='P')";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )9812;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&pract_name;
sqlstm.sqhstl[0] = (unsigned int  )502;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
sqlstm.sqhstl[2] = (unsigned int  )6;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&nd_pract_id;
sqlstm.sqhstl[3] = (unsigned int  )22;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR)
		err_mesg("SELECT failed on table pr_encounter",0,"");

	pract_name.arr[pract_name.len]='\0';


}
print_formated_amt_varstr(loc_amount_varstr,loc_amount)
char loc_amount_varstr[100];
double loc_amount;
{
    char s_amt[30], str_amt[30], fstr_amt[30];    

   if(loc_amount < 0)
    {
    put_val(loc_amount_varstr,-loc_amount);        
    format_amt(loc_amount_varstr);                
	ltrim (loc_amount_varstr);		
	rtrim (loc_amount_varstr);		
	strcpy(fstr_amt,"(-)");
	strcat(fstr_amt,loc_amount_varstr);		
	ltrim (fstr_amt);		
	rtrim (fstr_amt);
	sprintf(loc_amount_varstr,"%s",fstr_amt);		  
    }
    else 
	{
    put_val(loc_amount_varstr,loc_amount);         	
	format_amt(loc_amount_varstr);		
	ltrim (loc_amount_varstr);		
	rtrim (loc_amount_varstr);		
    }


}                        

print_formated_amt_total(loc_amount)
double loc_amount;
{
	char s_amt[30], str_amt[30], fstr_amt[30];

    if(loc_amount < 0)
	{
        put_val(s_amt,-loc_amount);        
        format_amt(s_amt);        
        sprintf(str_amt,"%14s",s_amt);				
		ltrim (str_amt);		
		rtrim (str_amt);		
		//strcpy(fstr_amt,"CR ");
		//strcat(fstr_amt,str_amt);		
		//ltrim (fstr_amt);		
		//rtrim (fstr_amt);
		//sprintf(str_amt,"%15s",fstr_amt);	
        
		if(nd_print_option.arr[0]=='R')
		{
		 if(strlen(str_amt)<15)
		 fun_add_space(15-strlen(str_amt));
		 strcat(nd_line_text.arr,str_amt);
		 fun_add_space(1);
		 strcat(nd_line_text.arr,"CR");
		}
		else
		fprintf(fp,"%15s CR",str_amt);
    }
    else if(loc_amount > 0)
	{
        put_val(s_amt,loc_amount);         
        format_amt(s_amt);
        sprintf(str_amt,"%15s",s_amt);
        if(nd_print_option.arr[0]=='R')
		{
		 if(strlen(str_amt)<15)
		 fun_add_space(15-strlen(str_amt));
		 strcat(nd_line_text.arr,str_amt);
		 fun_add_space(1);
		 strcat(nd_line_text.arr,"DR");
		}
		else
		fprintf(fp,"%15s DR",str_amt);
    }
	else if(loc_amount==0)
	{
        put_val(s_amt,loc_amount);         
        format_amt(s_amt);
        sprintf(str_amt,"%15s",s_amt);
        if(nd_print_option.arr[0]=='R')
		{
		 if(strlen(str_amt)<15)
		 fun_add_space(15-strlen(str_amt));
		 strcat(nd_line_text.arr,str_amt);
		}
		else
		fprintf(fp,"%15s",str_amt);
	 }
}

print_cust_header()
{
	if (ccnt==1)
				{
			
				fetch_cust_cur();
				if (strcmp(p_bill_net_payable_ind.arr,"R")==0 && strcmp(p_serv_disc_on_gross_ind.arr,"C")==0)
				 {get_discount_count();
					if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
					{
					fprintf(fp," \n%-25.25s %-20s %18s %18s",d2_short_name.arr,loc_legend[700],loc_legend[680],loc_legend[840]);
					lsr_line_cnt();
					}
				 }

				 if (strcmp(p_bill_net_payable_ind.arr,"R")==0 && strcmp(p_serv_disc_on_gross_ind.arr,"C")!=0)
				 {
					fprintf(fp," \n%-25.25s %-20s %18s",d2_short_name.arr,loc_legend[700],loc_legend[680]);
					lsr_line_cnt();
				 }


               if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_serv_disc_on_gross_ind.arr,"C")==0)
			    {
				get_discount_count();
				if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				{
				fprintf(fp," \n%-25.25s %-20s %18s %18s %18s",d2_short_name.arr,loc_legend[700],loc_legend[680],loc_legend[840],loc_legend[690]);  
				lsr_line_cnt();
				}
				}

               if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && strcmp(p_serv_disc_on_gross_ind.arr,"C")!=0)
			    {
				fprintf(fp," \n%-25.25s %-20s %18s %18s",d2_short_name.arr,loc_legend[700],loc_legend[680],loc_legend[690]);
				lsr_line_cnt();
				}

				fprintf(fp,"\n");
				lsr_line_cnt();
				if(strcmp(d_cust_code.arr,"\0")!=0 && lcol_cnt == 1)
				prt_line_uc();
				if(strcmp(d_cust_code.arr,"\0")!=0  && lcol_cnt == 2)
				prt_line_uc_wide();

				
				}
}

get_column_count_cust()
{
  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
  {
	if (strcmp(p_bill_net_payable_ind.arr,"R")==0 && (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0))
	lcol_cnt =1;

	if (strcmp(p_bill_net_payable_ind.arr,"R")==0 && (strcmp(p_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(p_serv_disc_on_gross_ind.arr,"B")!=0))
	lcol_cnt =1;

	if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && 
	   (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0))
	lcol_cnt =2;

	if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && 
	   (strcmp(p_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(p_serv_disc_on_gross_ind.arr,"B")!=0))
	lcol_cnt =1;
  }
  else
  lcol_cnt =1;
}

get_column_count_pat()
{

if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
{

	if (strcmp(c_bill_net_payable_ind.arr,"R")==0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0) &&  
	    ( strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
	lcol_cnt =1;
	if (strcmp(c_bill_net_payable_ind.arr,"R")==0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0) &&  
	   ( strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
	lcol_cnt =2;
	if (strcmp(c_bill_net_payable_ind.arr,"R")==0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0) && 
	   ( strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))  
	lcol_cnt =1;
  	if (strcmp(c_bill_net_payable_ind.arr,"R")==0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0) && 
	   ( strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))  
	lcol_cnt =1;
 	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0) && 
	   ( strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
	lcol_cnt =2;
  	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0) && 
	   ( strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
	lcol_cnt =1;
  	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0 ) && 
	   ( strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
	lcol_cnt =3;
   	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0 )&& 
	   ( strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
	lcol_cnt =2;
 	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")==0
		&& (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0) && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && 
		strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
	lcol_cnt =5;
	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0)
		 && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0) && 
		 strcmp(c_addl_charge_amt_ind.arr,"C")==0)
	lcol_cnt =6;
   /*
	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 
		     && strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")!=0)
	 {
		if(strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0) //vvvvvvvvvvvvvvv
	    lcol_cnt =6;
	 }	
	*/
	
 }
 else
 {
   lcol_cnt =1;
 }	
}

get_legend_value()
{
    fetch_single_bill_format_bg();

	if(strcmp(c_bill_subsidized_amt_ind.arr,"\0")==0)
	strcpy(c_bill_subsidized_amt_ind.arr,"N");

	
	/*
	if (strcmp(c_gross_net_amt_ind.arr,"X")==0 && strcmp(c_reim_amt_ind.arr,"Y")==0 && strcmp(c_non_reim_amt_ind.arr,"Y")==0) 
		fprintf(fp,"%-34s      %17s  %17s\n",loc_legend[770],loc_legend[820],loc_legend[830]);
	else
	if (strcmp(c_gross_net_amt_ind.arr,"X")==0 && strcmp(c_reim_amt_ind.arr,"Y")==0 && strcmp(c_non_reim_amt_ind.arr,"N")==0) 
		fprintf(fp,"%-34s      %17s  \n",loc_legend[770],loc_legend[820]);
	else
	if (strcmp(c_gross_net_amt_ind.arr,"X")!=0 && strcmp(c_reim_amt_ind.arr,"N")==0 && strcmp(c_non_reim_amt_ind.arr,"N")==0) 
		fprintf(fp,"%-34s      %17s\n",loc_legend[770],loc_legend[680]);
    else
	if (strcmp(c_gross_net_amt_ind.arr,"N")==0 && strcmp(c_reim_amt_ind.arr,"Y")==0 && strcmp(c_non_reim_amt_ind.arr,"Y")!=0) 
		fprintf(fp,"%-34s      %17s  %17s\n",loc_legend[770],loc_legend[680],loc_legend[820]);
	else
	if (strcmp(c_gross_net_amt_ind.arr,"N")==0 && strcmp(c_reim_amt_ind.arr,"Y")!=0 && strcmp(c_non_reim_amt_ind.arr,"Y")==0) 
		fprintf(fp,"%-34s      %17s  %17s\n",loc_legend[770],loc_legend[680],loc_legend[830]);
	else
	if (strcmp(c_bill_net_payable_ind.arr,"R")==0  &&  strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0)
	fprintf(fp,"%-35s %21s %17s  %17s\n",loc_legend[770],loc_legend[680],loc_legend[820],loc_legend[830]);

	else
	if (strcmp(c_bill_net_payable_ind.arr,"R")==0 && strcmp(c_serv_disc_on_gross_ind.arr,"C")==0)
	{get_discount_count();
	if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659   
	fprintf(fp,"%-35s %21s %17s %17s %17s  %17s\n",loc_legend[770],loc_legend[680],loc_legend[840],loc_legend[870],loc_legend[820],loc_legend[830]);
	}
	else
	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0)
	fprintf(fp,"%-35s %21s %17s  %17s\n",loc_legend[770],loc_legend[680],loc_legend[820],loc_legend[830]);
			
	if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"C")==0)
	{get_discount_count();
	if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
	fprintf(fp,"%-35s %21s %17s %17s %17s  %17s\n",loc_legend[770],loc_legend[680],loc_legend[840],loc_legend[870],loc_legend[820],loc_legend[830]);
	}
	*/

	/* legend has been changed i.e loc_legend[770] to loc_legend[110] as per Siriraj Hospital Bill format */

  /***** Added for CRF-440 (Discount Document Report *****/

  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
  {
     	
		
	 if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='N')
	 fprintf(fp,"%-55.55s %17.17s\n",loc_legend[110],loc_legend[840]);
	 if(c_disc_amt_in_dtl_yn.arr[0]=='N' && c_servdate_in_dtlformat_yn.arr[0]=='Y')
	 {
	 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
	 fprintf(fp,"%-24.24s %-15.15s %3.3s%15.15s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[840]);
	 else
	 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[840]);
	 }
	 if(c_disc_amt_in_dtl_yn.arr[0]=='Y')
	 fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s\n",loc_legend[110],loc_legend[1420],loc_legend[1421],loc_legend[1422]);
  
  }
  /***** UPTO Added for CRF-440 (Discount Document Report) *****/
  else
  {
 	
	
		if (strcmp(c_bill_net_payable_ind.arr,"R")==0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0)   
		    && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
			{
				get_subsidized_amt();
			 if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%-34.34s %21.21s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[750]);
				else
				fprintf(fp,"%-34.34s %21.21s \n",loc_legend[110],loc_legend[680]);
			}

		 if(strcmp(c_bill_net_payable_ind.arr,"R")==0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"B")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"C")==0) 
		   &&  (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		  {
			
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{
			get_discount_count();
			if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[750]);
				else
				fprintf(fp,"%-33.33s %21.21s %17.17s \n",loc_legend[110],loc_legend[680],loc_legend[840]);
			}
			}
			else
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%-33.33s %21.21s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[750]);
				else
				fprintf(fp,"%-33.33s %21.21s \n",loc_legend[110],loc_legend[680]);
			}
		  }
		if (strcmp(c_bill_net_payable_ind.arr,"R")==0 && ( strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0)
		  && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))  
			{
			if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			 fprintf(fp,"%-24.24s %-15.15s %3.3s%15.15s %17.17s \n ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680]);   //34 to 24 
			 //fprintf(fp,"%-34.34s %-12.12s%19.19s \n",loc_legend[110],loc_legend[1402],loc_legend[680]); for discount doc
			 else
			 {
			 
			 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s \n ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680]);   //34 to 24 
			 }
		    }
			else
			{  
		
			fprintf(fp,"%-33.33s %21.21s \n",loc_legend[110],loc_legend[680]); //modified by Rajesh ICN-389
			}
			}
		if (strcmp(c_bill_net_payable_ind.arr,"R")==0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0) 
		   && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))  
		 {
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{	get_discount_count();
				if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{
				 if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				 {
				 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
 				 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840]);
				 else
				 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840]);
				 }
				 else
				 fprintf(fp,"%-33.33s %21.21s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[840]);
				}
				else
				fprintf(fp,"%-33.33s %21.21s\n ",loc_legend[110],loc_legend[680]);
			}
				
		 }
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0)
		   && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		{		
		
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{
				if (strcmp(c_addl_charge_amt_ind.arr,"C")==0)
				{
				get_discount_count();
				get_addlcharge_count();
				if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{
				 if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
				 {
				 fprintf(fp,"%-37.37s %11.11s%17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[840],loc_legend[690]);
				 l_no_of_clumns =5;
				 }
				 else
				 {
				  fprintf(fp,"%-37.37s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
				 l_no_of_clumns =4;	
				 }

				 }
				}
				else
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				get_discount_count();
				if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
				{
				 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690]);  //34 to 24
				 else
				 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690]);  //34 to 24
				 //fprintf(fp,"%-34.34s %-12.12s%19.19s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[680],loc_legend[840],loc_legend[690]); for discount doc
				 l_no_of_clumns =4;
				 }
				}
				else
				{
				get_discount_count();
				 if(l_discount_count!=0  || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				 fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
				 else
				 fprintf(fp,"%-35.35s %18.18s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690]);
				}
			}
			else
			{
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0) //vani
				{
				 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				 fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);   //34 to 24
				 else
				 {
				 
				 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);   //34 to 24
				 }
				}
				else
				fprintf(fp,"%-35.35s %18.18s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690]);
			
			}
		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0)
		     && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0)
			 && strcmp(c_addl_charge_amt_ind.arr,"C")!=0)
			 {
			 
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0) 
				{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);  //34 to 24
					else
					{
			  
					 fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);  //34 to 24
					}
			  
					//fprintf(fp,"%-35.35s%-12.12s %18.18s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[680],loc_legend[690]); for discount doc
					//l_no_of_clumns =4;
				}
				else
				fprintf(fp,"%-35.35s  %18.18s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690]);
		    
			}

		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0)
			 && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0) 
			 && strcmp(c_addl_charge_amt_ind.arr,"C")==0)
		{	
			
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{
				 get_discount_count();
				 get_addlcharge_count();
				if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
				{ 
					if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
					{
						
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s \n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[840],loc_legend[690]);
					}
					else
					{
						
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s \n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
					}
			    }
				else
				{
					if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0 )  //for crf 659
					{	get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp,"%-33.33s    %17.17s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp,"%-33.33s    %17.17s %17.17s %17.17s \n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
					}
					else
					{
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )	
						fprintf(fp,"%-33.33s    %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp,"%-33.33s    %17.17s %17.17s \n",loc_legend[110],loc_legend[680],loc_legend[690]);
					}

				 }
			}
			else
			{
				get_addlcharge_count();
				if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
				{
					
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )	
						fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp,"%-33.33s    %15.15s%17.17s %17.17s \n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
						l_no_of_clumns =6;
				}
				else
				{
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp,"%-33.33s    %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp,"%-33.33s    %17.17s %17.17s \n",loc_legend[110],loc_legend[680],loc_legend[690]);
						l_no_of_clumns =5;
				}
			}
		
		    
		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 &&  (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0 )&& strcmp(c_addl_charge_amt_ind.arr,"C")!=0 
			&& (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		{	
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)
			{
					get_discount_count();
				if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				{

					if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
					 if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					 {
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);  //34 to 24
						else
						fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s \n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690]);  //34 to 24
					 }
					 else
					 {
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);  //34 to 24
						else
						fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s \n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690]);  //34 to 24
					 }
					 l_no_of_clumns =5;
					}
					else
					{
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s \n",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);

					}

				}
				else
				{
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
					else
					fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s \n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);

				}
				else
				{
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
					else
					fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s \n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);

				}
				}
				}
          		//l_no_of_clumns =5;
			}
			else
			{
			if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp,"%-24.24s %-15.15s %3.3s%11.11s %17.17s %17.17s \n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
			}
			else
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp,"%-24.24s %-15.15s   %3.3s %13.13s %17.17s \n",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
			}
			}
			}
			//fprintf(fp,"%-33.33s %-12.12s %19.19s %17.17s %17.17s\n",loc_legend[110],loc_legend[1402],loc_legend[680],loc_legend[690],loc_legend[750]); for discount doc

		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")==0
		    && (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0) && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
		{
	
		 get_addlcharge_count();
		if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
		{
				
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%-33.33s    %12.12s%17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp,"%-33.33s    %12.12s%17.17s %17.17s \n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
				l_no_of_clumns =5;
		}
		else
		{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%-33.33s    %17.17s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp,"%-33.33s    %17.17s %17.17s \n",loc_legend[110],loc_legend[680],loc_legend[690]);
		 l_no_of_clumns =4;
		 }
		
		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")==0
		    && (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0 || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0)&& (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
		{
			
			get_addlcharge_count();
			if(l_addlcharge_count!=0 || strcmp(c_print_zero_adcharg_column_yn.arr,"Y")==0 )
			{
			fprintf(fp,"%-33.33s    %12.12s%17.17s %17.17s\n",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
			l_no_of_clumns =5;
			}
			else
			{
			fprintf(fp,"%-33.33s    %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690]);
			l_no_of_clumns =4;
			}
		}
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")!=0 &&
		 (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0 && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0) && (strcmp(c_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(c_serv_disc_on_gross_ind.arr,"B")!=0))
		 {
				/*****changed on 28/10/2009********** added by vani*****/
				if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
					if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
					{
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp," %-2.2s %-20.20s %-16.16s %3.3s%11.11s %17.17s %18.18s %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp," %-2.2s %-20.20s %-16.16s %3.3s%11.11s %17.17s %18.18s \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
					}
					else
					{
						get_subsidized_amt();
						if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
						fprintf(fp," %-2.2s %-20.20s %-16.16s %3.3s %17.17s %18.18s %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
						else
						fprintf(fp," %-2.2s %-20.20s %-16.16s %3.3s %17.17s %18.18s \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);

					}
				}	
				else
				{
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s\n",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
					else
					fprintf(fp,"%-33.33s %21.21s %17.17s \n",loc_legend[110],loc_legend[680],loc_legend[690]);
				}
				
			/*****uptp here**********/
				

		}

		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")!=0 &&
		 (strcmp(c_bill_subsidized_amt_ind.arr,"R")!=0  && strcmp(c_bill_subsidized_amt_ind.arr,"N")!=0) && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		 {
		 		get_discount_count();
		   if(l_discount_count!=0 || strcmp(c_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
		  {

		   if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
				if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
				{	
					get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %10.10s %18.18s %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
					else
					fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %10.10s %18.18s \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690]);
				}
				else
				{	get_subsidized_amt();
					if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
					fprintf(fp," %-2.2s %-20.20s %-15.15s   %3.3s %13.13s %10.10s %18.18s %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
					else
					fprintf(fp," %-2.2s %-20.20s %-15.15s   %3.3s %13.13s %10.10s %18.18s \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690]);
				}
			}
			else
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%5.5s %-27.27s %18.18s %10.10s %18.18s  %15.15s\n"," ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp,"%5.5s %-27.27s %18.18s %10.10s %18.18s  \n"," ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
			}
		 }
		 else
		  {
			if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %18.18s %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %18.18s \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
			}
			else
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp," %-2.2s %-20.20s %-15.15s   %3.3s %13.13s %18.18s %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp," %-2.2s %-20.20s %-15.15s   %3.3s %13.13s %18.18s \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
			}
			}
			else
			{
				get_subsidized_amt();
				if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
				fprintf(fp,"%5.5s %-27.27s %18.18s %18.18s  %15.15s\n"," ",loc_legend[110],loc_legend[680],loc_legend[690],loc_legend[750]);
				else
				fprintf(fp,"%5.5s %-27.27s %18.18s %18.18s  \n"," ",loc_legend[110],loc_legend[680],loc_legend[690]);

			}
		   }



		}


		/***added by vani bcpz print service date is checked in rules for detailed bill is not working ***/
		if (strcmp(c_bill_net_payable_ind.arr,"R")!=0 && strcmp(c_addl_charge_amt_ind.arr,"C")!=0 &&
		 (strcmp(c_bill_subsidized_amt_ind.arr,"R")==0  || strcmp(c_bill_subsidized_amt_ind.arr,"N")==0) && (strcmp(c_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(c_serv_disc_on_gross_ind.arr,"B")==0))
		 {
				 if (strcmp(c_servdate_in_dtlformat_yn.arr,"Y")==0)
					{
						if(strcmp(c_rate_in_dtlformat_yn.arr,"Y")==0)
						{
								
								get_subsidized_amt();
								if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
								fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %10.10s  %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690],loc_legend[750]);
								else
								fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %15.15s  \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
						}
						else
						{

								get_subsidized_amt();
								if(l_subsidized_amt!=0 || strcmp(c_print_zero_subsid_column_yn.arr,"Y")==0 )
								fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s %17.17s %10.10s  %15.15s\n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690],loc_legend[750]);
								else
								fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s %17.17s %15.15s  \n"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
						}
					}
					
					

		 }

		/****upto here***/
      
   }

}

get_payer_bill_header()
{

		//fetch_cust_cur();

  /***** Added for CRF-440 (Discount Document Report *****/

  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
  {
     	
		
	 if(p_disc_amt_in_dtl_yn.arr[0]=='N' && p_servdate_in_dtlformat_yn.arr[0]=='N')
	 {
	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
	  {
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-12.12s",loc_legend[110]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp," %-12.12s %-34.34s "," ",nd_desc_with_spl_chr.arr);
		fprintf(fp,"\n%-11.11s   %-26.26s  "," ",nd_desc_with_spl_chr.arr);
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-18.18s",loc_legend[840]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%18.18s"," ",loc_legend[110],nd_desc_with_spl_chr.arr);
	
																																																
	  }
	  else
	  fprintf(fp," %-12.12s %-34.34s %18.18s"," ",loc_legend[110],loc_legend[840]);
	 }
	 if(p_disc_amt_in_dtl_yn.arr[0]=='N' && p_servdate_in_dtlformat_yn.arr[0]=='Y')
	 {
	 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
	 {
	  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
	  {
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
        nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1406]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
	    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
																																																
	  }
	  else
	  fprintf(fp,"%-24.24s %-15.15s %3.3s%15.15s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[840]);
	 }
	 else
	  {
	   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
	  {
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-24.24s",loc_legend[110]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%-24.24s ",nd_desc_with_spl_chr.arr);
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
        nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
		fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
		nd_temp_str.arr[0]='\0';
		nd_temp_str.len=0;
		sprintf(nd_temp_str.arr,"%17.17s",loc_legend[840]);
		fun_Pad_desc_with_spl_char(nd_temp_str.arr);
	    fprintf(fp,"%17.17s",nd_desc_with_spl_chr.arr);
																																																
	  }
	  else
	   fprintf(fp,"%-24.24s %-15.15s %3.3s %17.17s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[840]);
	  }
	 }
	 if(p_disc_amt_in_dtl_yn.arr[0]=='Y')
	 fprintf(fp,"%-33.33s %21.21s %17.17s %17.17s",loc_legend[110],loc_legend[1420],loc_legend[1421],loc_legend[1422]);
  
  }
  /***** Added for CRF-440 (Discount Document Report *****/

 if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")!=0)
 {		
  
    
		get_discount_count();							
	
		if (strcmp(p_bill_net_payable_ind.arr,"R")==0 && (strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0))
		 {	
			
			//fprintf(fp," \n%-25.25s %-20s %18s %18s",d2_short_name.arr,loc_legend[700],loc_legend[680],loc_legend[840]);
			if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			{
			if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{ 
				get_discount_count();
			 if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
			 {
			  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			   fprintf(fp," \n%-2.2s %-23.23s %-15.15s %3.3s%11.11s %17.17s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840]);
			  }
			  else
			  {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			   fprintf(fp," \n%-2.2s %-23.23s %-15.15s   %3.3s %13.13s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840]);
			  }
			 }
			 else
			 {
			  if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%15.15s",loc_legend[1406]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%15.15s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
			
																																																		
			  }
			  else
			   fprintf(fp," \n%-2.2s %-23.23s %-15.15s %3.3s%15.15s %17.17s "," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680]);
			  }
			  else
			  {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
			
																																																		
			  }
			  else
			   fprintf(fp," \n%-2.2s %-23.23s %-15.15s   %3.3s %13.13s "," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680]);
			  }
			  }
			}
			else
			{
			get_discount_count();
			if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-36.36s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-12.12s %-36.36s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
					
																																																		
			  }
			  else
			  fprintf(fp," \n%-12.12s %-36.36s %18.18s%18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[840]);
			 }
			 else
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-36.36s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-12.12s %-36.36s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																		
			  }
			  else
			  fprintf(fp," \n%-12.12s %-36.36s %18.18s"," ",loc_legend[110],loc_legend[680]);
			 }
			}
			}
			else
			{
			 if(strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			 {
			 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			  {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
			
																																																		
			  }
			  else
			   fprintf(fp," \n%-2.2s %-23.23s %-15.15s %3.3s%11.11s %17.17s "," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680]);
			  }
			  else
			  { 
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
			
																																																		
			  }
			  else
			   fprintf(fp," \n%-2.2s %-23.23s %-15.15s   %3.3s %13.13s "," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680]);
			  }
			  }
			 else
			  {
			    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-36.36s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-12.12s %-36.36s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																						
			  }
			  else
			   fprintf(fp," \n%-12.12s %-36.36s %18.18s"," ",loc_legend[110],loc_legend[680]);
			  }
			}
			lsr_line_cnt();
		 }
		
		if (strcmp(p_bill_net_payable_ind.arr,"R")==0 && (strcmp(p_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(p_serv_disc_on_gross_ind.arr,"B")!=0))
		{
		
			
			//fprintf(fp," \n%-25.25s %-20s %18s",d2_short_name.arr,loc_legend[700],loc_legend[680]);
			if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			 {
			   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
			
																																																		
			  }
			  else
			  fprintf(fp," \n%-2.2s %-23.23s %-15.15s %3.3s%11.11s %17.17s "," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680]);
			 }
			else
			 {
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
			
																																																		
			  }
			  else
			  fprintf(fp," \n%-2.2s %-23.23s %-15.15s   %3.3s %13.13s "," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680]);
		     }
			}
			else
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			   {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-12.12s %-36.36s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
					
																																																		
			  }
			  else
			 fprintf(fp," \n%-12.12s %-36.36s %18.18s"," ",loc_legend[110],loc_legend[680]);
			}
			lsr_line_cnt();
		}
		
       if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && 
	      ( strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0)  && 
		   (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
		{
		   	
			
			get_addlcharge_count();
			if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )	
			{	
				if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
				{
				
				get_discount_count();
				 if(l_discount_count!=0  || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," \n%-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  //fprintf(fp," \n%-12.12s %-33.33s %18.18s%18.18s%18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
				  fprintf(fp," \n%-12.12s %-28.28s %11.11s%15.15s%18.18s%18.18s"," ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[840],loc_legend[690]);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," \n%-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%11.11s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  fprintf(fp," \n%-12.12s %-33.33s %11.11s%18.18s %18.18s"," ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
				 }
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," \n%-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1230]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%11.11s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				 fprintf(fp," \n%-12.12s %-33.33s %11.11s%18.18s %18.18s"," ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);
				}
				lsr_line_cnt();
			}
			else
			{
				if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
				{
				get_discount_count();
				 if(l_discount_count!=0  || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," \n%-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  //fprintf(fp," \n%-12.12s %-33.33s %18.18s%18.18s%18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
				  fprintf(fp," \n%-12.12s %-28.28s %15.15s%18.18s%18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," \n%-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  fprintf(fp," \n%-12.12s %-33.33s %18.18s %18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);
				 }
				}
				else
				{
				 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," \n%-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				 fprintf(fp," \n%-12.12s %-33.33s %18.18s %18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);
				}
				lsr_line_cnt();
			}

		
		}
		
		if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && 
		   ( strcmp(p_serv_disc_on_gross_ind.arr,"C")==0 || strcmp(p_serv_disc_on_gross_ind.arr,"B")==0) && 
		   strcmp(p_addl_charge_amt_ind.arr,"C")!=0)
		{
		  
		   
		   if(strcmp(nd_calling_pgm_id.arr,"BLROPPV3")!=0)//added on 25/3/2008 Discount should not print for Reprint Vist Bills-No Discount function
			//fprintf(fp," \n%-12.12s %-33.33s %18.18s%18.18s%18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[840],loc_legend[690]);
		   {
				if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
				{
					get_discount_count();
				 if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				 {
				 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-20.20s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"  %-20.20s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  fprintf(fp,"  %-20.20s %-15.15s %3.3s%11.11s %17.17s%18.18s%18.18s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[840],loc_legend[690]);
				 }
				 else
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-20.20s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"  %-20.20s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  fprintf(fp,"  %-20.20s %-15.15s   %3.3s %13.13s%18.18s%18.18s",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[840],loc_legend[690]);
				 }
				 }
				 else
				 {
				 if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
		
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-20.20s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-2.2s %-20.20s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
				 }
				 else
				 { 
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-20.20s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-2.2s %-20.20s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  fprintf(fp," %-2.2s %-20.20s %-15.15s   %3.3s %13.13s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
				 }
				 }
				}
				else
			    {  
					get_discount_count();
				 if(l_discount_count!=0 || strcmp(p_print_zero_disc_column_yn.arr,"Y")==0)  //for crf 659
				 {
				  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-25.25s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-12.12s %-25.25s %-11.11s"," ",nd_desc_with_spl_chr.arr," ");
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[840]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
				
																																																			
				  }
				  else
				  fprintf(fp," %-12.12s %-25.25s %-11.11s%15.15s%18.18s%18.18s"," ",loc_legend[110]," ",loc_legend[680],loc_legend[840],loc_legend[690]);
				 }
				 else
				 {
				   if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				   {
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp," %-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
					nd_temp_str.arr[0]='\0';
					nd_temp_str.len=0;
					sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
					fun_Pad_desc_with_spl_char(nd_temp_str.arr);
					fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																						
				  }
				  else
				  fprintf(fp," %-12.12s %-33.33s %18.18s %18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);
				 }
				}
		   }
		  else
		  {
		    if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0)
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
			
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-20.20s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-2.2s %-20.20s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			 fprintf(fp," %-2.2s %-20.20s %-15.15s %3.3s%11.11s %17.17s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-20.20s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-2.2s %-20.20s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			 fprintf(fp," %-2.2s %-20.20s %-15.15s   %3.3s %13.13s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
			}
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-33.33s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," %-12.12s %-33.33s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s ",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			 fprintf(fp," %-12.12s %-33.33s %18.18s %18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);
			}
		  }
		   lsr_line_cnt();
					
		}
		
		
		if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && 
		   ( strcmp(p_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(p_serv_disc_on_gross_ind.arr,"B")!=0) && 
		    (strcmp(p_addl_charge_amt_ind.arr,"C")==0 || strcmp(p_addl_charge_amt_ind.arr,"B")==0))
		{
			
			
			get_addlcharge_count();
			//fprintf(fp," \n%-12.12s %-33.33s %18.18s %18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);// as per kuila sir instruction "d2_short_name.arr" removed
			if(l_addlcharge_count!=0 || strcmp(p_print_zero_adcharg_column_yn.arr,"Y")==0 )
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-28.28s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-12.12s %-28.28s"," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1230]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%11.11s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			 fprintf(fp," \n%-12.12s %-28.28s %11.11s%15.15s%18.18s"," ",loc_legend[110],loc_legend[1230],loc_legend[680],loc_legend[690]);// as per kuila sir instruction "d2_short_name.arr" removed
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-28.28s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-12.12s %-28.28s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%15.15s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%15.15s",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			 fprintf(fp," \n%-12.12s %-28.28s %15.15s%18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);// as per kuila sir instruction "d2_short_name.arr" removed
			}
			lsr_line_cnt();
		}
	   else
       if ((strcmp(p_bill_net_payable_ind.arr,"C")==0 || strcmp(p_bill_net_payable_ind.arr,"B")==0) && 
	      ( strcmp(p_serv_disc_on_gross_ind.arr,"C")!=0 && strcmp(p_serv_disc_on_gross_ind.arr,"B")!=0))
	    {
			
			
			//fprintf(fp," \n%-12.12s %-33.33s %18.18s %18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);// as per kuila sir instruction "d2_short_name.arr" removed
			if (strcmp(p_servdate_in_dtlformat_yn.arr,"Y")==0) 
			{
			if(strcmp(p_rate_in_dtlformat_yn.arr,"Y")==0)
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%11.11s",loc_legend[1406]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%11.11s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%17.17s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%17.17s ",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			   fprintf(fp," \n%-2.2s %-23.23s %-15.15s %3.3s%11.11s %17.17s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[1406],loc_legend[680],loc_legend[690]);
			 //fprintf(fp," \n%-2.2s %-24.24s%-12.12s %18.18s%18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[680],loc_legend[690]);
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-23.23s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-2.2s %-23.23s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-15.15s",loc_legend[1402]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%-15.15s   ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%3.3s",loc_legend[1405]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%3.3s ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%13.13s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%13.13s ",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			 fprintf(fp," \n%-2.2s %-23.23s %-15.15s   %3.3s %13.13s %18.18s"," ",loc_legend[110],loc_legend[1402],loc_legend[1405],loc_legend[680],loc_legend[690]);
			}
			}
			else
			{
			 if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			  {
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%-36.36s",loc_legend[110]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp," \n%-12.12s %-36.36s "," ",nd_desc_with_spl_chr.arr);
				nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[680]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
			    nd_temp_str.arr[0]='\0';
				nd_temp_str.len=0;
				sprintf(nd_temp_str.arr,"%18.18s",loc_legend[690]);
				fun_Pad_desc_with_spl_char(nd_temp_str.arr);
				fprintf(fp,"%18.18s",nd_desc_with_spl_chr.arr);
																																																		
			  }
			  else
			 fprintf(fp," \n%-12.12s %-36.36s %18.18s%18.18s"," ",loc_legend[110],loc_legend[680],loc_legend[690]);
			}

			lsr_line_cnt();
		}

  }
		fprintf(fp,"\n");
		lsr_line_cnt();
		prt_line_uc();
		fprintf(fp,"\n"); //lsr_line_cnt();
	

}

fetch_legend_value1()
{
		
	for(i=1;i<=1500;i++)
	{
		
		if(i<1000)
		{
		  	
			l_pk_value.arr[0] = '\0';
     
			/* EXEC SQL SELECT LTRIM(RTRIM('BILL_01.LEGEND_'||LTRIM(RTRIM(TO_CHAR(:i,'009')))))
					   INTO :l_pk_value
					   FROM dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select LTRIM(RTRIM(('BILL_01.LEGEND_'||LTRIM(RTRIM(TO_CHAR\
(:b0,'009')))))) into :b1  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )9843;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&i;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_pk_value;
   sqlstm.sqhstl[1] = (unsigned int  )102;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			l_pk_value.arr[l_pk_value.len]	= '\0';
			l_translated_value.arr[0]		= '\0';

			/* EXEC SQL EXECUTE
			BEGIN
				blcommon.get_local_lang_desc(:nd_facility,
											'SM',
											'SM_LANG_LEGEND',
											'DFLT_LEGEND_VALUE',
											:l_pk_value,
											:l_translated_value,
											:nd_lang_id);

      

			END;
			END-EXEC; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "begin blcommon . get_local_lang_desc ( :nd_facility , 'SM'\
 , 'SM_LANG_LEGEND' , 'DFLT_LEGEND_VALUE' , :l_pk_value , :l_translated_value \
, :nd_lang_id ) ; END ;";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )9866;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_facility;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_pk_value;
   sqlstm.sqhstl[1] = (unsigned int  )102;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&l_translated_value;
   sqlstm.sqhstl[2] = (unsigned int  )203;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[3] = (unsigned int  )6;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


       
			l_translated_value.arr[l_translated_value.len] = '\0';
			strcpy(loc_legend[i],l_translated_value.arr);

				
		}
		else
		{
			l_pk_value.arr[0] = '\0';
     
			/* EXEC SQL SELECT LTRIM(RTRIM('BILL_01.LEGEND_'||LTRIM(RTRIM(TO_CHAR(:i,'0009')))))
					   INTO :l_pk_value
					   FROM dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select LTRIM(RTRIM(('BILL_01.LEGEND_'||LTRIM(RTRIM(TO_CHAR\
(:b0,'0009')))))) into :b1  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )9897;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&i;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_pk_value;
   sqlstm.sqhstl[1] = (unsigned int  )102;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			l_pk_value.arr[l_pk_value.len]	= '\0';
			l_translated_value.arr[0]		= '\0';

			/* EXEC SQL EXECUTE
			BEGIN
				blcommon.get_local_lang_desc(:nd_facility,
											'SM',
											'SM_LANG_LEGEND',
											'DFLT_LEGEND_VALUE',
											:l_pk_value,
											:l_translated_value,
											:nd_lang_id);

      

			END;
			END-EXEC; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "begin blcommon . get_local_lang_desc ( :nd_facility , 'SM'\
 , 'SM_LANG_LEGEND' , 'DFLT_LEGEND_VALUE' , :l_pk_value , :l_translated_value \
, :nd_lang_id ) ; END ;";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )9920;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_facility;
   sqlstm.sqhstl[0] = (unsigned int  )33;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&l_pk_value;
   sqlstm.sqhstl[1] = (unsigned int  )102;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&l_translated_value;
   sqlstm.sqhstl[2] = (unsigned int  )203;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[3] = (unsigned int  )6;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


       
			l_translated_value.arr[l_translated_value.len] = '\0';
			strcpy(loc_legend[i],l_translated_value.arr);
		}

	}

	
}



check_report_format()
{
	//Modified by Harish 
	//Date - 06/11/2003 Point # 1 - modification document.
	//----------------------------------------------------------

    d_summary_yn = '\0';

	l_dflt_bill_print_in_summ_yn.arr[0] = '\0';

	/* EXEC SQL SELECT NVL(DFLT_BILL_PRINT_IN_SUMM_YN,'N')
			   INTO l_dflt_bill_print_in_summ_yn 
	           FROM bl_parameters
			  WHERE operating_facility_id = :nd_facility_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select NVL(DFLT_BILL_PRINT_IN_SUMM_YN,'N') into :b0  from bl\
_parameters where operating_facility_id=:b1";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )9951;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_dflt_bill_print_in_summ_yn;
 sqlstm.sqhstl[0] = (unsigned int  )7;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	l_dflt_bill_print_in_summ_yn.arr[l_dflt_bill_print_in_summ_yn.len] = '\0';

	//First preference given to front end Summary parameter.	
	if(strcmp(l_dflt_bill_print_in_summ_yn.arr,"Y")==0)
	{
		d_summary_yn='Y';
	}
	else
	{
		/* EXEC SQL SELECT NVL(SUMMARY_YN,'N')
				   INTO :d_summary_yn
				   FROM BL_SUM_DET_PRINT
				  WHERE BLNG_GRP_ID       = :dc_blng_grp_id
    				AND PRT_GRP_HDR_CODE  = :d1_prt_grp_hdr_code
					AND operating_facility_id = :nd_facility_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select NVL(SUMMARY_YN,'N') into :b0  from BL_SUM_DET_PRINT \
where ((BLNG_GRP_ID=:b1 and PRT_GRP_HDR_CODE=:b2) and operating_facility_id=:b\
3)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )9974;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_summary_yn;
  sqlstm.sqhstl[0] = (unsigned int  )1;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&dc_blng_grp_id;
  sqlstm.sqhstl[1] = (unsigned int  )7;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d1_prt_grp_hdr_code;
  sqlstm.sqhstl[2] = (unsigned int  )9;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[3] = (unsigned int  )5;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

       	

			if (sqlca.sqlcode == 1403 )
			{
				     /* EXEC SQL SELECT NVL(summary_yn,'N')
							    INTO :d_summary_yn
							    FROM bl_sum_det_print
							   WHERE blng_grp_id           = '**'
    						 	 AND prt_grp_hdr_code      = :d1_prt_grp_hdr_code
								 AND operating_facility_id = :nd_facility_id; */ 

{
         struct sqlexd sqlstm;
         sqlstm.sqlvsn = 12;
         sqlstm.arrsiz = 52;
         sqlstm.sqladtp = &sqladt;
         sqlstm.sqltdsp = &sqltds;
         sqlstm.stmt = "select NVL(summary_yn,'N') into :b0  from bl_sum_det\
_print where ((blng_grp_id='**' and prt_grp_hdr_code=:b1) and operating_facili\
ty_id=:b2)";
         sqlstm.iters = (unsigned int  )1;
         sqlstm.offset = (unsigned int  )10005;
         sqlstm.selerr = (unsigned short)1;
         sqlstm.cud = sqlcud0;
         sqlstm.sqlest = (unsigned char  *)&sqlca;
         sqlstm.sqlety = (unsigned short)4352;
         sqlstm.occurs = (unsigned int  )0;
         sqlstm.sqhstv[0] = (         void  *)&d_summary_yn;
         sqlstm.sqhstl[0] = (unsigned int  )1;
         sqlstm.sqhsts[0] = (         int  )0;
         sqlstm.sqindv[0] = (         void  *)0;
         sqlstm.sqinds[0] = (         int  )0;
         sqlstm.sqharm[0] = (unsigned int  )0;
         sqlstm.sqadto[0] = (unsigned short )0;
         sqlstm.sqtdso[0] = (unsigned short )0;
         sqlstm.sqhstv[1] = (         void  *)&d1_prt_grp_hdr_code;
         sqlstm.sqhstl[1] = (unsigned int  )9;
         sqlstm.sqhsts[1] = (         int  )0;
         sqlstm.sqindv[1] = (         void  *)0;
         sqlstm.sqinds[1] = (         int  )0;
         sqlstm.sqharm[1] = (unsigned int  )0;
         sqlstm.sqadto[1] = (unsigned short )0;
         sqlstm.sqtdso[1] = (unsigned short )0;
         sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
         sqlstm.sqhstl[2] = (unsigned int  )5;
         sqlstm.sqhsts[2] = (         int  )0;
         sqlstm.sqindv[2] = (         void  *)0;
         sqlstm.sqinds[2] = (         int  )0;
         sqlstm.sqharm[2] = (unsigned int  )0;
         sqlstm.sqadto[2] = (unsigned short )0;
         sqlstm.sqtdso[2] = (unsigned short )0;
         sqlstm.sqphsv = sqlstm.sqhstv;
         sqlstm.sqphsl = sqlstm.sqhstl;
         sqlstm.sqphss = sqlstm.sqhsts;
         sqlstm.sqpind = sqlstm.sqindv;
         sqlstm.sqpins = sqlstm.sqinds;
         sqlstm.sqparm = sqlstm.sqharm;
         sqlstm.sqparc = sqlstm.sqharc;
         sqlstm.sqpadto = sqlstm.sqadto;
         sqlstm.sqptdso = sqlstm.sqtdso;
         sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					 if (sqlca.sqlcode == 1403 )
							d_summary_yn='Y';
			}
	}

	//If condition will be considered only in reprint options.
	if(strcmp(l_detail_report_flag.arr,"Y")==0)
	{
			/* EXEC SQL SELECT NVL(SUMMARY_YN,'N')
					   INTO :d_summary_yn
					   FROM BL_SUM_DET_PRINT
					  WHERE BLNG_GRP_ID       = :dc_blng_grp_id
    					AND PRT_GRP_HDR_CODE  = :d1_prt_grp_hdr_code
						AND operating_facility_id = :nd_facility_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select NVL(SUMMARY_YN,'N') into :b0  from BL_SUM_DET_PRINT\
 where ((BLNG_GRP_ID=:b1 and PRT_GRP_HDR_CODE=:b2) and operating_facility_id=:\
b3)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )10032;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&d_summary_yn;
   sqlstm.sqhstl[0] = (unsigned int  )1;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&dc_blng_grp_id;
   sqlstm.sqhstl[1] = (unsigned int  )7;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&d1_prt_grp_hdr_code;
   sqlstm.sqhstl[2] = (unsigned int  )9;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[3] = (unsigned int  )5;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

       	

			if (sqlca.sqlcode == 1403 )
			{
				     /* EXEC SQL SELECT NVL(summary_yn,'N')
							    INTO :d_summary_yn
							    FROM bl_sum_det_print
							   WHERE blng_grp_id           = '**'
    						 	 AND prt_grp_hdr_code      = :d1_prt_grp_hdr_code
								 AND operating_facility_id = :nd_facility_id; */ 

{
         struct sqlexd sqlstm;
         sqlstm.sqlvsn = 12;
         sqlstm.arrsiz = 52;
         sqlstm.sqladtp = &sqladt;
         sqlstm.sqltdsp = &sqltds;
         sqlstm.stmt = "select NVL(summary_yn,'N') into :b0  from bl_sum_det\
_print where ((blng_grp_id='**' and prt_grp_hdr_code=:b1) and operating_facili\
ty_id=:b2)";
         sqlstm.iters = (unsigned int  )1;
         sqlstm.offset = (unsigned int  )10063;
         sqlstm.selerr = (unsigned short)1;
         sqlstm.cud = sqlcud0;
         sqlstm.sqlest = (unsigned char  *)&sqlca;
         sqlstm.sqlety = (unsigned short)4352;
         sqlstm.occurs = (unsigned int  )0;
         sqlstm.sqhstv[0] = (         void  *)&d_summary_yn;
         sqlstm.sqhstl[0] = (unsigned int  )1;
         sqlstm.sqhsts[0] = (         int  )0;
         sqlstm.sqindv[0] = (         void  *)0;
         sqlstm.sqinds[0] = (         int  )0;
         sqlstm.sqharm[0] = (unsigned int  )0;
         sqlstm.sqadto[0] = (unsigned short )0;
         sqlstm.sqtdso[0] = (unsigned short )0;
         sqlstm.sqhstv[1] = (         void  *)&d1_prt_grp_hdr_code;
         sqlstm.sqhstl[1] = (unsigned int  )9;
         sqlstm.sqhsts[1] = (         int  )0;
         sqlstm.sqindv[1] = (         void  *)0;
         sqlstm.sqinds[1] = (         int  )0;
         sqlstm.sqharm[1] = (unsigned int  )0;
         sqlstm.sqadto[1] = (unsigned short )0;
         sqlstm.sqtdso[1] = (unsigned short )0;
         sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
         sqlstm.sqhstl[2] = (unsigned int  )5;
         sqlstm.sqhsts[2] = (         int  )0;
         sqlstm.sqindv[2] = (         void  *)0;
         sqlstm.sqinds[2] = (         int  )0;
         sqlstm.sqharm[2] = (unsigned int  )0;
         sqlstm.sqadto[2] = (unsigned short )0;
         sqlstm.sqtdso[2] = (unsigned short )0;
         sqlstm.sqphsv = sqlstm.sqhstv;
         sqlstm.sqphsl = sqlstm.sqhstl;
         sqlstm.sqphss = sqlstm.sqhsts;
         sqlstm.sqpind = sqlstm.sqindv;
         sqlstm.sqpins = sqlstm.sqinds;
         sqlstm.sqparm = sqlstm.sqharm;
         sqlstm.sqparc = sqlstm.sqharc;
         sqlstm.sqpadto = sqlstm.sqadto;
         sqlstm.sqptdso = sqlstm.sqtdso;
         sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					 if (sqlca.sqlcode == 1403 )
							d_summary_yn='Y';
			}
	}
}


/* Added by Raghava.S for Thai date conversion 06/07/2007 */

get_local_date()
{
	
	/* EXEC SQL EXECUTE

	DECLARE

	t_date  date;
	
	BEGIN
		get_locale_date.convert_to_locale_date(to_date(:nd_temp_date1,'DD/MM/YY'),:nd_lang_id,t_date);

		 :nd_loc_date1:= to_char(t_date,'DD/MM/YYYY');


	END;

	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "declare t_date date ; BEGIN get_locale_date . convert_to_loc\
ale_date ( to_date ( :nd_temp_date1 , 'DD/MM/YY' ) , :nd_lang_id , t_date ) ; \
:nd_loc_date1 := to_char ( t_date , 'DD/MM/YYYY' ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )10090;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_temp_date1;
 sqlstm.sqhstl[0] = (unsigned int  )14;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_loc_date1;
 sqlstm.sqhstl[2] = (unsigned int  )14;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


     		
		if (OERROR)
        err_mesg("SELECTING Date failed",0,"");


}

get_local_date1()
{
	
	/* EXEC SQL EXECUTE

	DECLARE

	t_date  date;
	
	BEGIN
		 get_locale_date.convert_to_locale_date(to_date(:nd_temp_date,'DD/MM/YY HH24:MI'),:nd_lang_id,t_date);

		 :nd_loc_date := to_char(t_date,'DD/MM/YYYY HH24:MI');


	END;

	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "declare t_date date ; BEGIN get_locale_date . convert_to_loc\
ale_date ( to_date ( :nd_temp_date , 'DD/MM/YY HH24:MI' ) , :nd_lang_id , t_da\
te ) ; :nd_loc_date := to_char ( t_date , 'DD/MM/YYYY HH24:MI' ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )10117;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_temp_date;
 sqlstm.sqhstl[0] = (unsigned int  )22;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_loc_date;
 sqlstm.sqhstl[2] = (unsigned int  )22;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
		if (OERROR)
        err_mesg("SELECTING Date failed",0,"");


}


/*---06/07/2007----*/

init_date_temp_var()
{
nd_temp_date.arr[0] =  '\0';
nd_loc_date.arr[0]  =  '\0';
nd_temp_date1.arr[0]=  '\0';
nd_loc_date1.arr[0] =  '\0';
date_convert.arr[0] =  '\0';
d1_doc_date1.arr[0] =  '\0';


nd_temp_date.len = 0;
nd_loc_date.len  = 0;
nd_temp_date1.len= 0;
nd_loc_date1.len = 0;
date_convert.len = 0;
d1_doc_date1.len = 0;

}

/*---06/07/2007----*/

fun_change_loc_date()
{

strcpy(nd_temp_date1.arr,date_convert.arr);
nd_temp_date1.len = strlen(nd_temp_date1.arr);

get_local_date();

}

/*---06/07/2007----*/

fun_change_loc_date1()
{

strcpy(nd_temp_date.arr,date_convert.arr);
nd_temp_date.len = strlen(nd_temp_date.arr);

get_local_date1();

strcpy(date_convert.arr,nd_loc_date.arr); 
}


fun_centre(v_text,v_size)
{
int l_length,i;

l_length=strlen(v_text);

for (i=0;i<(v_size-l_length)/2;i++)
{
 if(nd_print_option.arr[0]=='R')
 strcat(nd_line_text.arr," ");
 else
 fprintf(fp," ");
}
 
}


get_policy_desc()
{

int l_len;
l_Policy_type_desc.arr[0] =  '\0';

	/* EXEC SQL SELECT substr(long_desc,1,46)
		INTO :l_Policy_type_desc
		FROM bl_ins_policy_types_lang_vw
		WHERE policy_type_code       =:d_Policy_type_code
		AND operating_facility_id =    :nd_facility_id
		and upper(language_id)=upper(:nd_lang_id); */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select substr(long_desc,1,46) into :b0  from bl_ins_policy_t\
ypes_lang_vw where ((policy_type_code=:b1 and operating_facility_id=:b2) and u\
pper(language_id)=upper(:b3))";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )10144;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_Policy_type_desc;
 sqlstm.sqhstl[0] = (unsigned int  )302;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_Policy_type_code;
 sqlstm.sqhstl[1] = (unsigned int  )23;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[2] = (unsigned int  )5;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[3] = (unsigned int  )6;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

    

	l_Policy_type_desc.arr[l_Policy_type_desc.len]	= '\0';


}
/*** Added by raghava on 21/7/2009 at Bangkok For CRF-659 ***/
get_bill_num(int ind)
{

    l_bill_num.arr[0]='\0';
	l_bill_num.len=0;


   if(ind==1)
   { 

	  /* EXEC SQL SELECT ' ' //:d1_bill_doc_type_code||'/'||:d1_bill_doc_num COMMENTED AND ADDED NULL FOR SCRUM REMERGING
		       INTO   :l_bill_num
               FROM    DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select ' ' into :b0  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )10175;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&l_bill_num;
   sqlstm.sqhstl[0] = (unsigned int  )102;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



   }
   else
   {
	  /* EXEC SQL SELECT ' ' //:d_bill_doc_type_code||'/'||:d_bill_doc_num COMMENTED AND ADDED NULL FOR SCRUM REMERGING
		       INTO   :l_bill_num
               FROM    DUAL; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select ' ' into :b0  from DUAL ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )10194;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&l_bill_num;
   sqlstm.sqhstl[0] = (unsigned int  )102;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


   }
    l_bill_num.arr[l_bill_num.len]='\0';
}
get_pat_bill_num()
{
 l_pat_bill_num.arr[0]='\0';
 l_pat_bill_num.len=0;
 
 /* EXEC SQL SELECT ' ' //:d_bill_doc_type_code||'/'||:d_bill_doc_num COMMENTED AND ADDED NULL FOR SCRUM REMERGING
		  INTO   :l_pat_bill_num
          FROM    DUAL; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select ' ' into :b0  from DUAL ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )10213;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_pat_bill_num;
 sqlstm.sqhstl[0] = (unsigned int  )102;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



 l_pat_bill_num.arr[l_pat_bill_num.len]='\0';
}
get_discount_count()  //added for IN9051
{

l_discount_count=0;

/* EXEC SQL SELECT  count(*) into  l_discount_count
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						A.bill_doc_type_code =:d1_doc_type			//added by vani

                        AND A.BILL_DOC_NUM =  :d1_doc_number))		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						A.bill_doc_type_code =:d1_doc_type		

                        AND A.BILL_DOC_NUM =  :d1_doc_number )	

        ))   
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	AND B.BILL_DOC_NUM =:d1_doc_number)
	and NVL(A.UPD_DISC_AMT,0)>0
	and BILL_DOC_TYPE_CODE=:d1_doc_type
	and BILL_DOC_NUM=:d1_doc_number; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select count(*)  into :b0  from BL_PATIENT_CHARGES_FOLIO A ,BL_BLNG_SERV \
C where ((((((((((OPERATING_FACILITY_ID=:b1 and A.BLNG_SERV_CODE=C.BLNG_SERV\
_CODE) and EPISODE_TYPE=:b2) and ((:b2<>'R' and EPISODE_ID=:b4) or :b2='R'))\
 and ((:b2 in ('O','E') and VISIT_ID=:b7) or :b2 in ('I','D','R'))) and PATI\
ENT_ID=:b9) and ((trx_status is null  or ((trx_status='C' and NVL(REV_ADJ_TR\
X_IND,'R')='R') and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not  in (select\
 TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_charges_folio where (((O\
PERATING_FACILITY_ID=:b1 and patient_id=:b9) and A.bill_doc_type_code=:b12) \
and A.BILL_DOC_NUM=:b13)))) or (REV_ADJ_TRX_IND='B' and (TRX_DOC_REF,TRX_DOC\
_REF_LINE_NUM) not  in (select SOURCE_DOC_REF ,SOURCE_DOC_REF_LINE_NUM  from\
 bl_patient_charges_folio where (((OPERATING_FACILITY_ID=:b1 and patient_id=\
:b9) and A.bill_doc_type_code=:b12) and A.BILL_DOC_NUM=:b13))))) and exists \
(select B.TRX_DOC_REF  from BL_PATIENT_CHARGES_FOLIO B where (((((B.OPERATIN\
G_FACILITY_ID=:b1 and B.OPERATING_FACIL");
sqlstm.stmt = "ITY_ID=A.OPERATING_FACILITY_ID) and B.TRX_DOC_REF=A.TRX_DOC_R\
EF) and B.TRX_DOC_REF_LINE_NUM=A.TRX_DOC_REF_LINE_NUM) and B.BILL_DOC_TYPE_COD\
E=:b12) and B.BILL_DOC_NUM=:b13))) and NVL(A.UPD_DISC_AMT,0)>0) and BILL_DOC_T\
YPE_CODE=:b12) and BILL_DOC_NUM=:b13)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )10232;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_discount_count;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[10] = (unsigned int  )5;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_patient_id;
sqlstm.sqhstl[11] = (unsigned int  )63;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[12] = (unsigned int  )27;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[13] = (unsigned int  )52;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[14] = (unsigned int  )5;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&d_patient_id;
sqlstm.sqhstl[15] = (unsigned int  )63;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[16] = (unsigned int  )27;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[17] = (unsigned int  )52;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[18] = (unsigned int  )5;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[19] = (unsigned int  )27;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[20] = (unsigned int  )52;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqhstv[21] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[21] = (unsigned int  )27;
sqlstm.sqhsts[21] = (         int  )0;
sqlstm.sqindv[21] = (         void  *)0;
sqlstm.sqinds[21] = (         int  )0;
sqlstm.sqharm[21] = (unsigned int  )0;
sqlstm.sqadto[21] = (unsigned short )0;
sqlstm.sqtdso[21] = (unsigned short )0;
sqlstm.sqhstv[22] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[22] = (unsigned int  )52;
sqlstm.sqhsts[22] = (         int  )0;
sqlstm.sqindv[22] = (         void  *)0;
sqlstm.sqinds[22] = (         int  )0;
sqlstm.sqharm[22] = (unsigned int  )0;
sqlstm.sqadto[22] = (unsigned short )0;
sqlstm.sqtdso[22] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




		
}

get_addlcharge_count()  //added for IN9051
{

l_addlcharge_count=0;
 /* EXEC SQL SELECT  count(*) into  l_addlcharge_count
 from (
SELECT 1
    FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
     AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   (    NVL (rev_adj_trx_ind, 'R') = 'R'
                       AND (source_doc_ref, source_doc_ref_line_num) NOT IN (
                              SELECT trx_doc_ref, trx_doc_ref_line_num
                                FROM bl_patient_charges_folio
                               WHERE operating_facility_id = :nd_facility_id
                                 AND patient_id = :d_patient_id
                                 AND a.episode_id = :d_episode_id)
                      )
                   OR (:d1_bill_amt = 0)
                  )
             )
          OR (    rev_adj_trx_ind = 'B'
              AND (trx_doc_ref, trx_doc_ref_line_num) NOT IN (
                     SELECT source_doc_ref, source_doc_ref_line_num
                       FROM bl_patient_charges_folio
                      WHERE operating_facility_id = :nd_facility_id
                        AND patient_id = :d_patient_id
                        AND a.episode_id = :d_episode_id)
             )
         )
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
and NVL (a.package_trx_yn, 'N')='N' 
and nvl(a.confirmed_yn,'N')!='N'              
union all
SELECT  1
    FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
     AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   (    NVL (rev_adj_trx_ind, 'R') = 'R'
                       AND (source_doc_ref, source_doc_ref_line_num) NOT IN (
                              SELECT trx_doc_ref, trx_doc_ref_line_num
                                FROM bl_patient_charges_folio
                               WHERE operating_facility_id = :nd_facility_id
                                 AND patient_id = :d_patient_id
                                 AND a.episode_id = :d_episode_id)
                      )
                   OR (:d1_bill_amt = 0)
                  )
             )
          OR (    rev_adj_trx_ind = 'B'
              AND (trx_doc_ref, trx_doc_ref_line_num) NOT IN (
                     SELECT source_doc_ref, source_doc_ref_line_num
                       FROM bl_patient_charges_folio
                      WHERE operating_facility_id = :nd_facility_id
                        AND patient_id = :d_patient_id
                        AND a.episode_id = :d_episode_id)
             )
         )
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
     AND EXISTS (
            SELECT 1
              FROM bl_package_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.package_trx_yn = 'N'
			   AND b.org_gross_charge_amt <> 0
             )
and NVL (a.package_trx_yn, 'N')='P'
and nvl(a.confirmed_yn,'N')!='N')  ; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlbuft((void **)0, 
   "select count(*)  into :b0  from (select 1  from bl_patient_charges_folio\
 a ,bl_blng_serv c where ((((((((((operating_facility_id=:b1 and a.blng_serv\
_code=c.blng_serv_code) and episode_type=:b2) and ((:b2<>'R' and episode_id=\
:b4) or :b2='R')) and ((:b2 in ('O','E') and visit_id=:b7) or :b2 in ('I','D\
','R'))) and patient_id=:b9) and a.episode_id=:b4) and ((trx_status is null \
 or (trx_status='C' and ((NVL(rev_adj_trx_ind,'R')='R' and (source_doc_ref,s\
ource_doc_ref_line_num) not  in (select trx_doc_ref ,trx_doc_ref_line_num  f\
rom bl_patient_charges_folio where ((operating_facility_id=:b1 and patient_i\
d=:b9) and a.episode_id=:b4))) or :b14=0))) or (rev_adj_trx_ind='B' and (trx\
_doc_ref,trx_doc_ref_line_num) not  in (select source_doc_ref ,source_doc_re\
f_line_num  from bl_patient_charges_folio where ((operating_facility_id=:b1 \
and patient_id=:b9) and a.episode_id=:b4))))) and exists (select b.trx_doc_r\
ef  from bl_patient_charges_folio b where (((((b.operating_facility_id=:b1 a\
nd b.operating_facility_id=a.operating_f");
 sqlbuft((void **)0, 
   "acility_id) and b.trx_doc_ref=a.trx_doc_ref) and b.trx_doc_ref_line_num=\
a.trx_doc_ref_line_num) and b.episode_id=:b4) and NVL(a.billed_flag,'N')='N'\
))) and NVL(a.package_trx_yn,'N')='N') and nvl(a.confirmed_yn,'N')<>'N') uni\
on all select 1  from bl_patient_charges_folio a ,bl_blng_serv c where (((((\
((((((operating_facility_id=:b1 and a.blng_serv_code=c.blng_serv_code) and e\
pisode_type=:b2) and ((:b2<>'R' and episode_id=:b4) or :b2='R')) and ((:b2 i\
n ('O','E') and visit_id=:b7) or :b2 in ('I','D','R'))) and patient_id=:b9) \
and a.episode_id=:b4) and ((trx_status is null  or (trx_status='C' and ((NVL\
(rev_adj_trx_ind,'R')='R' and (source_doc_ref,source_doc_ref_line_num) not  \
in (select trx_doc_ref ,trx_doc_ref_line_num  from bl_patient_charges_folio \
where ((operating_facility_id=:b1 and patient_id=:b9) and a.episode_id=:b4))\
) or :b14=0))) or (rev_adj_trx_ind='B' and (trx_doc_ref,trx_doc_ref_line_num\
) not  in (select source_doc_ref ,source_doc_ref_line_num  from bl_patient_c\
harges_folio where ((operating_facility_");
 sqlstm.stmt = "id=:b1 and patient_id=:b9) and a.episode_id=:b4))))) and exi\
sts (select b.trx_doc_ref  from bl_patient_charges_folio b where (((((b.operat\
ing_facility_id=:b1 and b.operating_facility_id=a.operating_facility_id) and b\
.trx_doc_ref=a.trx_doc_ref) and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num)\
 and b.episode_id=:b4) and NVL(a.billed_flag,'N')='N'))) and exists (select 1 \
 from bl_package_folio b where (((((b.operating_facility_id=:b1 and b.operatin\
g_facility_id=a.operating_facility_id) and b.trx_doc_ref=a.trx_doc_ref) and b.\
trx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.package_trx_yn='N') and b.o\
rg_gross_charge_amt<>0))) and NVL(a.package_trx_yn,'N')='P') and nvl(a.confirm\
ed_yn,'N')<>'N')) ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )10339;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&l_addlcharge_count;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[3] = (unsigned int  )4;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[4] = (unsigned int  )11;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[5] = (unsigned int  )4;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[6] = (unsigned int  )4;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[7] = (unsigned int  )7;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[8] = (unsigned int  )4;
 sqlstm.sqhsts[8] = (         int  )0;
 sqlstm.sqindv[8] = (         void  *)0;
 sqlstm.sqinds[8] = (         int  )0;
 sqlstm.sqharm[8] = (unsigned int  )0;
 sqlstm.sqadto[8] = (unsigned short )0;
 sqlstm.sqtdso[8] = (unsigned short )0;
 sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[9] = (unsigned int  )63;
 sqlstm.sqhsts[9] = (         int  )0;
 sqlstm.sqindv[9] = (         void  *)0;
 sqlstm.sqinds[9] = (         int  )0;
 sqlstm.sqharm[9] = (unsigned int  )0;
 sqlstm.sqadto[9] = (unsigned short )0;
 sqlstm.sqtdso[9] = (unsigned short )0;
 sqlstm.sqhstv[10] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[10] = (unsigned int  )11;
 sqlstm.sqhsts[10] = (         int  )0;
 sqlstm.sqindv[10] = (         void  *)0;
 sqlstm.sqinds[10] = (         int  )0;
 sqlstm.sqharm[10] = (unsigned int  )0;
 sqlstm.sqadto[10] = (unsigned short )0;
 sqlstm.sqtdso[10] = (unsigned short )0;
 sqlstm.sqhstv[11] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[11] = (unsigned int  )5;
 sqlstm.sqhsts[11] = (         int  )0;
 sqlstm.sqindv[11] = (         void  *)0;
 sqlstm.sqinds[11] = (         int  )0;
 sqlstm.sqharm[11] = (unsigned int  )0;
 sqlstm.sqadto[11] = (unsigned short )0;
 sqlstm.sqtdso[11] = (unsigned short )0;
 sqlstm.sqhstv[12] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[12] = (unsigned int  )63;
 sqlstm.sqhsts[12] = (         int  )0;
 sqlstm.sqindv[12] = (         void  *)0;
 sqlstm.sqinds[12] = (         int  )0;
 sqlstm.sqharm[12] = (unsigned int  )0;
 sqlstm.sqadto[12] = (unsigned short )0;
 sqlstm.sqtdso[12] = (unsigned short )0;
 sqlstm.sqhstv[13] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[13] = (unsigned int  )11;
 sqlstm.sqhsts[13] = (         int  )0;
 sqlstm.sqindv[13] = (         void  *)0;
 sqlstm.sqinds[13] = (         int  )0;
 sqlstm.sqharm[13] = (unsigned int  )0;
 sqlstm.sqadto[13] = (unsigned short )0;
 sqlstm.sqtdso[13] = (unsigned short )0;
 sqlstm.sqhstv[14] = (         void  *)&d1_bill_amt;
 sqlstm.sqhstl[14] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[14] = (         int  )0;
 sqlstm.sqindv[14] = (         void  *)0;
 sqlstm.sqinds[14] = (         int  )0;
 sqlstm.sqharm[14] = (unsigned int  )0;
 sqlstm.sqadto[14] = (unsigned short )0;
 sqlstm.sqtdso[14] = (unsigned short )0;
 sqlstm.sqhstv[15] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[15] = (unsigned int  )5;
 sqlstm.sqhsts[15] = (         int  )0;
 sqlstm.sqindv[15] = (         void  *)0;
 sqlstm.sqinds[15] = (         int  )0;
 sqlstm.sqharm[15] = (unsigned int  )0;
 sqlstm.sqadto[15] = (unsigned short )0;
 sqlstm.sqtdso[15] = (unsigned short )0;
 sqlstm.sqhstv[16] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[16] = (unsigned int  )63;
 sqlstm.sqhsts[16] = (         int  )0;
 sqlstm.sqindv[16] = (         void  *)0;
 sqlstm.sqinds[16] = (         int  )0;
 sqlstm.sqharm[16] = (unsigned int  )0;
 sqlstm.sqadto[16] = (unsigned short )0;
 sqlstm.sqtdso[16] = (unsigned short )0;
 sqlstm.sqhstv[17] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[17] = (unsigned int  )11;
 sqlstm.sqhsts[17] = (         int  )0;
 sqlstm.sqindv[17] = (         void  *)0;
 sqlstm.sqinds[17] = (         int  )0;
 sqlstm.sqharm[17] = (unsigned int  )0;
 sqlstm.sqadto[17] = (unsigned short )0;
 sqlstm.sqtdso[17] = (unsigned short )0;
 sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[18] = (unsigned int  )5;
 sqlstm.sqhsts[18] = (         int  )0;
 sqlstm.sqindv[18] = (         void  *)0;
 sqlstm.sqinds[18] = (         int  )0;
 sqlstm.sqharm[18] = (unsigned int  )0;
 sqlstm.sqadto[18] = (unsigned short )0;
 sqlstm.sqtdso[18] = (unsigned short )0;
 sqlstm.sqhstv[19] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[19] = (unsigned int  )11;
 sqlstm.sqhsts[19] = (         int  )0;
 sqlstm.sqindv[19] = (         void  *)0;
 sqlstm.sqinds[19] = (         int  )0;
 sqlstm.sqharm[19] = (unsigned int  )0;
 sqlstm.sqadto[19] = (unsigned short )0;
 sqlstm.sqtdso[19] = (unsigned short )0;
 sqlstm.sqhstv[20] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[20] = (unsigned int  )5;
 sqlstm.sqhsts[20] = (         int  )0;
 sqlstm.sqindv[20] = (         void  *)0;
 sqlstm.sqinds[20] = (         int  )0;
 sqlstm.sqharm[20] = (unsigned int  )0;
 sqlstm.sqadto[20] = (unsigned short )0;
 sqlstm.sqtdso[20] = (unsigned short )0;
 sqlstm.sqhstv[21] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[21] = (unsigned int  )4;
 sqlstm.sqhsts[21] = (         int  )0;
 sqlstm.sqindv[21] = (         void  *)0;
 sqlstm.sqinds[21] = (         int  )0;
 sqlstm.sqharm[21] = (unsigned int  )0;
 sqlstm.sqadto[21] = (unsigned short )0;
 sqlstm.sqtdso[21] = (unsigned short )0;
 sqlstm.sqhstv[22] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[22] = (unsigned int  )4;
 sqlstm.sqhsts[22] = (         int  )0;
 sqlstm.sqindv[22] = (         void  *)0;
 sqlstm.sqinds[22] = (         int  )0;
 sqlstm.sqharm[22] = (unsigned int  )0;
 sqlstm.sqadto[22] = (unsigned short )0;
 sqlstm.sqtdso[22] = (unsigned short )0;
 sqlstm.sqhstv[23] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[23] = (unsigned int  )11;
 sqlstm.sqhsts[23] = (         int  )0;
 sqlstm.sqindv[23] = (         void  *)0;
 sqlstm.sqinds[23] = (         int  )0;
 sqlstm.sqharm[23] = (unsigned int  )0;
 sqlstm.sqadto[23] = (unsigned short )0;
 sqlstm.sqtdso[23] = (unsigned short )0;
 sqlstm.sqhstv[24] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[24] = (unsigned int  )4;
 sqlstm.sqhsts[24] = (         int  )0;
 sqlstm.sqindv[24] = (         void  *)0;
 sqlstm.sqinds[24] = (         int  )0;
 sqlstm.sqharm[24] = (unsigned int  )0;
 sqlstm.sqadto[24] = (unsigned short )0;
 sqlstm.sqtdso[24] = (unsigned short )0;
 sqlstm.sqhstv[25] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[25] = (unsigned int  )4;
 sqlstm.sqhsts[25] = (         int  )0;
 sqlstm.sqindv[25] = (         void  *)0;
 sqlstm.sqinds[25] = (         int  )0;
 sqlstm.sqharm[25] = (unsigned int  )0;
 sqlstm.sqadto[25] = (unsigned short )0;
 sqlstm.sqtdso[25] = (unsigned short )0;
 sqlstm.sqhstv[26] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[26] = (unsigned int  )7;
 sqlstm.sqhsts[26] = (         int  )0;
 sqlstm.sqindv[26] = (         void  *)0;
 sqlstm.sqinds[26] = (         int  )0;
 sqlstm.sqharm[26] = (unsigned int  )0;
 sqlstm.sqadto[26] = (unsigned short )0;
 sqlstm.sqtdso[26] = (unsigned short )0;
 sqlstm.sqhstv[27] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[27] = (unsigned int  )4;
 sqlstm.sqhsts[27] = (         int  )0;
 sqlstm.sqindv[27] = (         void  *)0;
 sqlstm.sqinds[27] = (         int  )0;
 sqlstm.sqharm[27] = (unsigned int  )0;
 sqlstm.sqadto[27] = (unsigned short )0;
 sqlstm.sqtdso[27] = (unsigned short )0;
 sqlstm.sqhstv[28] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[28] = (unsigned int  )63;
 sqlstm.sqhsts[28] = (         int  )0;
 sqlstm.sqindv[28] = (         void  *)0;
 sqlstm.sqinds[28] = (         int  )0;
 sqlstm.sqharm[28] = (unsigned int  )0;
 sqlstm.sqadto[28] = (unsigned short )0;
 sqlstm.sqtdso[28] = (unsigned short )0;
 sqlstm.sqhstv[29] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[29] = (unsigned int  )11;
 sqlstm.sqhsts[29] = (         int  )0;
 sqlstm.sqindv[29] = (         void  *)0;
 sqlstm.sqinds[29] = (         int  )0;
 sqlstm.sqharm[29] = (unsigned int  )0;
 sqlstm.sqadto[29] = (unsigned short )0;
 sqlstm.sqtdso[29] = (unsigned short )0;
 sqlstm.sqhstv[30] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[30] = (unsigned int  )5;
 sqlstm.sqhsts[30] = (         int  )0;
 sqlstm.sqindv[30] = (         void  *)0;
 sqlstm.sqinds[30] = (         int  )0;
 sqlstm.sqharm[30] = (unsigned int  )0;
 sqlstm.sqadto[30] = (unsigned short )0;
 sqlstm.sqtdso[30] = (unsigned short )0;
 sqlstm.sqhstv[31] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[31] = (unsigned int  )63;
 sqlstm.sqhsts[31] = (         int  )0;
 sqlstm.sqindv[31] = (         void  *)0;
 sqlstm.sqinds[31] = (         int  )0;
 sqlstm.sqharm[31] = (unsigned int  )0;
 sqlstm.sqadto[31] = (unsigned short )0;
 sqlstm.sqtdso[31] = (unsigned short )0;
 sqlstm.sqhstv[32] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[32] = (unsigned int  )11;
 sqlstm.sqhsts[32] = (         int  )0;
 sqlstm.sqindv[32] = (         void  *)0;
 sqlstm.sqinds[32] = (         int  )0;
 sqlstm.sqharm[32] = (unsigned int  )0;
 sqlstm.sqadto[32] = (unsigned short )0;
 sqlstm.sqtdso[32] = (unsigned short )0;
 sqlstm.sqhstv[33] = (         void  *)&d1_bill_amt;
 sqlstm.sqhstl[33] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[33] = (         int  )0;
 sqlstm.sqindv[33] = (         void  *)0;
 sqlstm.sqinds[33] = (         int  )0;
 sqlstm.sqharm[33] = (unsigned int  )0;
 sqlstm.sqadto[33] = (unsigned short )0;
 sqlstm.sqtdso[33] = (unsigned short )0;
 sqlstm.sqhstv[34] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[34] = (unsigned int  )5;
 sqlstm.sqhsts[34] = (         int  )0;
 sqlstm.sqindv[34] = (         void  *)0;
 sqlstm.sqinds[34] = (         int  )0;
 sqlstm.sqharm[34] = (unsigned int  )0;
 sqlstm.sqadto[34] = (unsigned short )0;
 sqlstm.sqtdso[34] = (unsigned short )0;
 sqlstm.sqhstv[35] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[35] = (unsigned int  )63;
 sqlstm.sqhsts[35] = (         int  )0;
 sqlstm.sqindv[35] = (         void  *)0;
 sqlstm.sqinds[35] = (         int  )0;
 sqlstm.sqharm[35] = (unsigned int  )0;
 sqlstm.sqadto[35] = (unsigned short )0;
 sqlstm.sqtdso[35] = (unsigned short )0;
 sqlstm.sqhstv[36] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[36] = (unsigned int  )11;
 sqlstm.sqhsts[36] = (         int  )0;
 sqlstm.sqindv[36] = (         void  *)0;
 sqlstm.sqinds[36] = (         int  )0;
 sqlstm.sqharm[36] = (unsigned int  )0;
 sqlstm.sqadto[36] = (unsigned short )0;
 sqlstm.sqtdso[36] = (unsigned short )0;
 sqlstm.sqhstv[37] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[37] = (unsigned int  )5;
 sqlstm.sqhsts[37] = (         int  )0;
 sqlstm.sqindv[37] = (         void  *)0;
 sqlstm.sqinds[37] = (         int  )0;
 sqlstm.sqharm[37] = (unsigned int  )0;
 sqlstm.sqadto[37] = (unsigned short )0;
 sqlstm.sqtdso[37] = (unsigned short )0;
 sqlstm.sqhstv[38] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[38] = (unsigned int  )11;
 sqlstm.sqhsts[38] = (         int  )0;
 sqlstm.sqindv[38] = (         void  *)0;
 sqlstm.sqinds[38] = (         int  )0;
 sqlstm.sqharm[38] = (unsigned int  )0;
 sqlstm.sqadto[38] = (unsigned short )0;
 sqlstm.sqtdso[38] = (unsigned short )0;
 sqlstm.sqhstv[39] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[39] = (unsigned int  )5;
 sqlstm.sqhsts[39] = (         int  )0;
 sqlstm.sqindv[39] = (         void  *)0;
 sqlstm.sqinds[39] = (         int  )0;
 sqlstm.sqharm[39] = (unsigned int  )0;
 sqlstm.sqadto[39] = (unsigned short )0;
 sqlstm.sqtdso[39] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


/* 
 EXEC SQL SELECT  count(*) into  l_addlcharge_count
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						A.bill_doc_type_code =:d1_doc_type			//added by vani

                        AND A.BILL_DOC_NUM =  :d1_doc_number))		//added by vani

                         or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						A.bill_doc_type_code =:d1_doc_type	

                        AND A.BILL_DOC_NUM =  :d1_doc_number )

                     
        ))  
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	AND B.BILL_DOC_NUM =:d1_doc_number)
	and NVL(A.ADDL_CHARGE_AMT_IN_CHARGE,0)>0
	and BILL_DOC_TYPE_CODE=:d1_doc_type
	and BILL_DOC_NUM=:d1_doc_number;
*/

	
}


get_aviled_outside_pkg()  //added for IN9051
{

l_aviled_outside_pkg=0;
l_package_seq_no =0;

/* EXEC SQL SELECT package_seq_no 
	INTO l_package_seq_no 
	FROM BL_PACKAGE_ENCOUNTER_DTLS
	WHERE operating_facility_id =:nd_facility_id 
	AND patient_id = :d_patient_id
	AND episode_type = :d_episode_type
	AND encounter_id = :d_episode_id; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select package_seq_no into :b0  from BL_PACKAGE_ENCOUNTER_DTL\
S where (((operating_facility_id=:b1 and patient_id=:b2) and episode_type=:b3)\
 and encounter_id=:b4)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )10514;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_package_seq_no;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
sqlstm.sqhstl[2] = (unsigned int  )63;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/* EXEC SQL SELECT NVL(STATUS,'N')  
    INTO :l_pakage_yn
	FROM BL_PACKAGE_SUB_HDR 
	WHERE operating_facility_id=:nd_facility_id 
	AND patient_id= :d_patient_id
	AND package_seq_no = :l_package_seq_no; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select NVL(STATUS,'N') into :b0  from BL_PACKAGE_SUB_HDR wher\
e ((operating_facility_id=:b1 and patient_id=:b2) and package_seq_no=:b3)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )10549;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_pakage_yn;
sqlstm.sqhstl[0] = (unsigned int  )4;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
sqlstm.sqhstl[2] = (unsigned int  )63;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&l_package_seq_no;
sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	

if (strcmp(l_pakage_yn.arr,"O")=='\0')
{

/* EXEC SQL SELECT  count(*) into  l_aviled_outside_pkg
from (
SELECT 1
    FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
     AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   (    NVL (rev_adj_trx_ind, 'R') = 'R'
                       AND (source_doc_ref, source_doc_ref_line_num) NOT IN (
                              SELECT trx_doc_ref, trx_doc_ref_line_num
                                FROM bl_patient_charges_folio
                               WHERE operating_facility_id = :nd_facility_id
                                 AND patient_id = :d_patient_id
                                 AND a.episode_id = :d_episode_id)
                      )
                   OR (:d1_bill_amt = 0)
                  )
             )
          OR (    rev_adj_trx_ind = 'B'
              AND (trx_doc_ref, trx_doc_ref_line_num) NOT IN (
                     SELECT source_doc_ref, source_doc_ref_line_num
                       FROM bl_patient_charges_folio
                      WHERE operating_facility_id = :nd_facility_id
                        AND patient_id = :d_patient_id
                        AND a.episode_id = :d_episode_id)
             )
         )
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
and NVL (a.package_trx_yn, 'N')='N'   
and nvl(a.confirmed_yn,'N')!='N'            
union all
SELECT  1
    FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
     AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   (    NVL (rev_adj_trx_ind, 'R') = 'R'
                       AND (source_doc_ref, source_doc_ref_line_num) NOT IN (
                              SELECT trx_doc_ref, trx_doc_ref_line_num
                                FROM bl_patient_charges_folio
                               WHERE operating_facility_id = :nd_facility_id
                                 AND patient_id = :d_patient_id
                                 AND a.episode_id = :d_episode_id)
                      )
                   OR (:d1_bill_amt = 0)
                  )
             )
          OR (    rev_adj_trx_ind = 'B'
              AND (trx_doc_ref, trx_doc_ref_line_num) NOT IN (
                     SELECT source_doc_ref, source_doc_ref_line_num
                       FROM bl_patient_charges_folio
                      WHERE operating_facility_id = :nd_facility_id
                        AND patient_id = :d_patient_id
                        AND a.episode_id = :d_episode_id)
             )
         )
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
     AND EXISTS (
            SELECT 1
              FROM bl_package_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.package_trx_yn = 'N'
			   AND b.org_gross_charge_amt <> 0
             )
and NVL (a.package_trx_yn, 'N')='P'
and nvl(a.confirmed_yn,'N')!='N')  ; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select count(*)  into :b0  from (select 1  from bl_patient_charges_folio \
a ,bl_blng_serv c where ((((((((((operating_facility_id=:b1 and a.blng_serv_\
code=c.blng_serv_code) and episode_type=:b2) and ((:b2<>'R' and episode_id=:\
b4) or :b2='R')) and ((:b2 in ('O','E') and visit_id=:b7) or :b2 in ('I','D'\
,'R'))) and patient_id=:b9) and a.episode_id=:b4) and ((trx_status is null  \
or (trx_status='C' and ((NVL(rev_adj_trx_ind,'R')='R' and (source_doc_ref,so\
urce_doc_ref_line_num) not  in (select trx_doc_ref ,trx_doc_ref_line_num  fr\
om bl_patient_charges_folio where ((operating_facility_id=:b1 and patient_id\
=:b9) and a.episode_id=:b4))) or :b14=0))) or (rev_adj_trx_ind='B' and (trx_\
doc_ref,trx_doc_ref_line_num) not  in (select source_doc_ref ,source_doc_ref\
_line_num  from bl_patient_charges_folio where ((operating_facility_id=:b1 a\
nd patient_id=:b9) and a.episode_id=:b4))))) and exists (select b.trx_doc_re\
f  from bl_patient_charges_folio b where (((((b.operating_facility_id=:b1 an\
d b.operating_facility_id=a.operating_f");
sqlbuft((void **)0, 
  "acility_id) and b.trx_doc_ref=a.trx_doc_ref) and b.trx_doc_ref_line_num=a\
.trx_doc_ref_line_num) and b.episode_id=:b4) and NVL(a.billed_flag,'N')='N')\
)) and NVL(a.package_trx_yn,'N')='N') and nvl(a.confirmed_yn,'N')<>'N') unio\
n all select 1  from bl_patient_charges_folio a ,bl_blng_serv c where ((((((\
(((((operating_facility_id=:b1 and a.blng_serv_code=c.blng_serv_code) and ep\
isode_type=:b2) and ((:b2<>'R' and episode_id=:b4) or :b2='R')) and ((:b2 in\
 ('O','E') and visit_id=:b7) or :b2 in ('I','D','R'))) and patient_id=:b9) a\
nd a.episode_id=:b4) and ((trx_status is null  or (trx_status='C' and ((NVL(\
rev_adj_trx_ind,'R')='R' and (source_doc_ref,source_doc_ref_line_num) not  i\
n (select trx_doc_ref ,trx_doc_ref_line_num  from bl_patient_charges_folio w\
here ((operating_facility_id=:b1 and patient_id=:b9) and a.episode_id=:b4)))\
 or :b14=0))) or (rev_adj_trx_ind='B' and (trx_doc_ref,trx_doc_ref_line_num)\
 not  in (select source_doc_ref ,source_doc_ref_line_num  from bl_patient_ch\
arges_folio where ((operating_facility_");
sqlstm.stmt = "id=:b1 and patient_id=:b9) and a.episode_id=:b4))))) and exis\
ts (select b.trx_doc_ref  from bl_patient_charges_folio b where (((((b.operati\
ng_facility_id=:b1 and b.operating_facility_id=a.operating_facility_id) and b.\
trx_doc_ref=a.trx_doc_ref) and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num) \
and b.episode_id=:b4) and NVL(a.billed_flag,'N')='N'))) and exists (select 1  \
from bl_package_folio b where (((((b.operating_facility_id=:b1 and b.operating\
_facility_id=a.operating_facility_id) and b.trx_doc_ref=a.trx_doc_ref) and b.t\
rx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.package_trx_yn='N') and b.or\
g_gross_charge_amt<>0))) and NVL(a.package_trx_yn,'N')='P') and nvl(a.confirme\
d_yn,'N')<>'N')) ";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )10580;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_aviled_outside_pkg;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_episode_id;
sqlstm.sqhstl[10] = (unsigned int  )11;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[11] = (unsigned int  )5;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d_patient_id;
sqlstm.sqhstl[12] = (unsigned int  )63;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d_episode_id;
sqlstm.sqhstl[13] = (unsigned int  )11;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&d1_bill_amt;
sqlstm.sqhstl[14] = (unsigned int  )sizeof(double);
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[15] = (unsigned int  )5;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d_patient_id;
sqlstm.sqhstl[16] = (unsigned int  )63;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d_episode_id;
sqlstm.sqhstl[17] = (unsigned int  )11;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[18] = (unsigned int  )5;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d_episode_id;
sqlstm.sqhstl[19] = (unsigned int  )11;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[20] = (unsigned int  )5;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqhstv[21] = (         void  *)&d_episode_type;
sqlstm.sqhstl[21] = (unsigned int  )4;
sqlstm.sqhsts[21] = (         int  )0;
sqlstm.sqindv[21] = (         void  *)0;
sqlstm.sqinds[21] = (         int  )0;
sqlstm.sqharm[21] = (unsigned int  )0;
sqlstm.sqadto[21] = (unsigned short )0;
sqlstm.sqtdso[21] = (unsigned short )0;
sqlstm.sqhstv[22] = (         void  *)&d_episode_type;
sqlstm.sqhstl[22] = (unsigned int  )4;
sqlstm.sqhsts[22] = (         int  )0;
sqlstm.sqindv[22] = (         void  *)0;
sqlstm.sqinds[22] = (         int  )0;
sqlstm.sqharm[22] = (unsigned int  )0;
sqlstm.sqadto[22] = (unsigned short )0;
sqlstm.sqtdso[22] = (unsigned short )0;
sqlstm.sqhstv[23] = (         void  *)&d_episode_id;
sqlstm.sqhstl[23] = (unsigned int  )11;
sqlstm.sqhsts[23] = (         int  )0;
sqlstm.sqindv[23] = (         void  *)0;
sqlstm.sqinds[23] = (         int  )0;
sqlstm.sqharm[23] = (unsigned int  )0;
sqlstm.sqadto[23] = (unsigned short )0;
sqlstm.sqtdso[23] = (unsigned short )0;
sqlstm.sqhstv[24] = (         void  *)&d_episode_type;
sqlstm.sqhstl[24] = (unsigned int  )4;
sqlstm.sqhsts[24] = (         int  )0;
sqlstm.sqindv[24] = (         void  *)0;
sqlstm.sqinds[24] = (         int  )0;
sqlstm.sqharm[24] = (unsigned int  )0;
sqlstm.sqadto[24] = (unsigned short )0;
sqlstm.sqtdso[24] = (unsigned short )0;
sqlstm.sqhstv[25] = (         void  *)&d_episode_type;
sqlstm.sqhstl[25] = (unsigned int  )4;
sqlstm.sqhsts[25] = (         int  )0;
sqlstm.sqindv[25] = (         void  *)0;
sqlstm.sqinds[25] = (         int  )0;
sqlstm.sqharm[25] = (unsigned int  )0;
sqlstm.sqadto[25] = (unsigned short )0;
sqlstm.sqtdso[25] = (unsigned short )0;
sqlstm.sqhstv[26] = (         void  *)&d_visit_id;
sqlstm.sqhstl[26] = (unsigned int  )7;
sqlstm.sqhsts[26] = (         int  )0;
sqlstm.sqindv[26] = (         void  *)0;
sqlstm.sqinds[26] = (         int  )0;
sqlstm.sqharm[26] = (unsigned int  )0;
sqlstm.sqadto[26] = (unsigned short )0;
sqlstm.sqtdso[26] = (unsigned short )0;
sqlstm.sqhstv[27] = (         void  *)&d_episode_type;
sqlstm.sqhstl[27] = (unsigned int  )4;
sqlstm.sqhsts[27] = (         int  )0;
sqlstm.sqindv[27] = (         void  *)0;
sqlstm.sqinds[27] = (         int  )0;
sqlstm.sqharm[27] = (unsigned int  )0;
sqlstm.sqadto[27] = (unsigned short )0;
sqlstm.sqtdso[27] = (unsigned short )0;
sqlstm.sqhstv[28] = (         void  *)&d_patient_id;
sqlstm.sqhstl[28] = (unsigned int  )63;
sqlstm.sqhsts[28] = (         int  )0;
sqlstm.sqindv[28] = (         void  *)0;
sqlstm.sqinds[28] = (         int  )0;
sqlstm.sqharm[28] = (unsigned int  )0;
sqlstm.sqadto[28] = (unsigned short )0;
sqlstm.sqtdso[28] = (unsigned short )0;
sqlstm.sqhstv[29] = (         void  *)&d_episode_id;
sqlstm.sqhstl[29] = (unsigned int  )11;
sqlstm.sqhsts[29] = (         int  )0;
sqlstm.sqindv[29] = (         void  *)0;
sqlstm.sqinds[29] = (         int  )0;
sqlstm.sqharm[29] = (unsigned int  )0;
sqlstm.sqadto[29] = (unsigned short )0;
sqlstm.sqtdso[29] = (unsigned short )0;
sqlstm.sqhstv[30] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[30] = (unsigned int  )5;
sqlstm.sqhsts[30] = (         int  )0;
sqlstm.sqindv[30] = (         void  *)0;
sqlstm.sqinds[30] = (         int  )0;
sqlstm.sqharm[30] = (unsigned int  )0;
sqlstm.sqadto[30] = (unsigned short )0;
sqlstm.sqtdso[30] = (unsigned short )0;
sqlstm.sqhstv[31] = (         void  *)&d_patient_id;
sqlstm.sqhstl[31] = (unsigned int  )63;
sqlstm.sqhsts[31] = (         int  )0;
sqlstm.sqindv[31] = (         void  *)0;
sqlstm.sqinds[31] = (         int  )0;
sqlstm.sqharm[31] = (unsigned int  )0;
sqlstm.sqadto[31] = (unsigned short )0;
sqlstm.sqtdso[31] = (unsigned short )0;
sqlstm.sqhstv[32] = (         void  *)&d_episode_id;
sqlstm.sqhstl[32] = (unsigned int  )11;
sqlstm.sqhsts[32] = (         int  )0;
sqlstm.sqindv[32] = (         void  *)0;
sqlstm.sqinds[32] = (         int  )0;
sqlstm.sqharm[32] = (unsigned int  )0;
sqlstm.sqadto[32] = (unsigned short )0;
sqlstm.sqtdso[32] = (unsigned short )0;
sqlstm.sqhstv[33] = (         void  *)&d1_bill_amt;
sqlstm.sqhstl[33] = (unsigned int  )sizeof(double);
sqlstm.sqhsts[33] = (         int  )0;
sqlstm.sqindv[33] = (         void  *)0;
sqlstm.sqinds[33] = (         int  )0;
sqlstm.sqharm[33] = (unsigned int  )0;
sqlstm.sqadto[33] = (unsigned short )0;
sqlstm.sqtdso[33] = (unsigned short )0;
sqlstm.sqhstv[34] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[34] = (unsigned int  )5;
sqlstm.sqhsts[34] = (         int  )0;
sqlstm.sqindv[34] = (         void  *)0;
sqlstm.sqinds[34] = (         int  )0;
sqlstm.sqharm[34] = (unsigned int  )0;
sqlstm.sqadto[34] = (unsigned short )0;
sqlstm.sqtdso[34] = (unsigned short )0;
sqlstm.sqhstv[35] = (         void  *)&d_patient_id;
sqlstm.sqhstl[35] = (unsigned int  )63;
sqlstm.sqhsts[35] = (         int  )0;
sqlstm.sqindv[35] = (         void  *)0;
sqlstm.sqinds[35] = (         int  )0;
sqlstm.sqharm[35] = (unsigned int  )0;
sqlstm.sqadto[35] = (unsigned short )0;
sqlstm.sqtdso[35] = (unsigned short )0;
sqlstm.sqhstv[36] = (         void  *)&d_episode_id;
sqlstm.sqhstl[36] = (unsigned int  )11;
sqlstm.sqhsts[36] = (         int  )0;
sqlstm.sqindv[36] = (         void  *)0;
sqlstm.sqinds[36] = (         int  )0;
sqlstm.sqharm[36] = (unsigned int  )0;
sqlstm.sqadto[36] = (unsigned short )0;
sqlstm.sqtdso[36] = (unsigned short )0;
sqlstm.sqhstv[37] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[37] = (unsigned int  )5;
sqlstm.sqhsts[37] = (         int  )0;
sqlstm.sqindv[37] = (         void  *)0;
sqlstm.sqinds[37] = (         int  )0;
sqlstm.sqharm[37] = (unsigned int  )0;
sqlstm.sqadto[37] = (unsigned short )0;
sqlstm.sqtdso[37] = (unsigned short )0;
sqlstm.sqhstv[38] = (         void  *)&d_episode_id;
sqlstm.sqhstl[38] = (unsigned int  )11;
sqlstm.sqhsts[38] = (         int  )0;
sqlstm.sqindv[38] = (         void  *)0;
sqlstm.sqinds[38] = (         int  )0;
sqlstm.sqharm[38] = (unsigned int  )0;
sqlstm.sqadto[38] = (unsigned short )0;
sqlstm.sqtdso[38] = (unsigned short )0;
sqlstm.sqhstv[39] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[39] = (unsigned int  )5;
sqlstm.sqhsts[39] = (         int  )0;
sqlstm.sqindv[39] = (         void  *)0;
sqlstm.sqinds[39] = (         int  )0;
sqlstm.sqharm[39] = (unsigned int  )0;
sqlstm.sqadto[39] = (unsigned short )0;
sqlstm.sqtdso[39] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



/*
EXEC SQL SELECT  count(*) into  l_aviled_outside_pkg
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	and (trx_status is null 
                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						A.bill_doc_type_code =:d1_doc_type	

                        AND A.BILL_DOC_NUM =  :d1_doc_number))		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						A.bill_doc_type_code =:d1_doc_type		

                        AND A.BILL_DOC_NUM =  :d1_doc_number )	

                      
        ))   
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	AND B.BILL_DOC_NUM =:d1_doc_number)
	and NVL(PACKAGE_TRX_YN,'N')='N'
	and	PACKAGE_SEQ_NO is null
	and BILL_DOC_TYPE_CODE=:d1_doc_type
	and BILL_DOC_NUM=:d1_doc_number;
*/
}
	

	
}


get_bill_format()
{
	/* EXEC SQL select BILL_FORMAT_IND
			 into :nd_bill_format_id
			 from bl_parameters
			 where operating_facility_id=:nd_facility_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select BILL_FORMAT_IND into :b0  from bl_parameters where op\
erating_facility_id=:b1";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )10755;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_bill_format_id;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}
get_disc_print_ind()
{

  disc_doc_appl_ind.arr[0]='\0';
  disc_doc_appl_ind.len   = 0;
  
  	/* EXEC SQL select Nvl(DISC_DOC_APPL_IND,'N')
			 into :disc_doc_appl_ind
			 from bl_parameters
			 where operating_facility_id=:nd_facility_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select Nvl(DISC_DOC_APPL_IND,'N') into :b0  from bl_parame\
ters where operating_facility_id=:b1";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )10778;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&disc_doc_appl_ind;
   sqlstm.sqhstl[0] = (unsigned int  )4;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[1] = (unsigned int  )5;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



       if(NODATAFOUND)
	     disc_doc_appl_ind.arr[0]='N'; 

  disc_doc_appl_ind.arr[disc_doc_appl_ind.len]='\0';
}

fetch_dtl()
{
	original_text.arr[0]	='\0';
	copy_text.arr[0]		= '\0';	
	bill_title_line1.arr[0]		= '\0';
	bill_title_line2.arr[0]		= '\0';		
	bill_title_line3.arr[0]		= '\0';		
	bill_title_line4.arr[0]		= '\0';		
	op_cash_bill_title_w_rcpt.arr[0]		= '\0';		
	op_cash_bill_title_wo_rcpt.arr[0]		= '\0';	
	op_credit_bill_title.arr[0]		= '\0';		
	ip_cash_bill_title_w_rcpt.arr[0]		= '\0';	
	ip_cash_bill_title_wo_rcpt.arr[0]		= '\0';	
	ip_credit_bill_title.arr[0]		= '\0';		
	cash_bill_title_addl_line.arr[0]		= '\0';	
	credit_bill_title_addl_line.arr[0]		= '\0';	
	bl_header_line_01.arr[0]		= '\0';			
	bl_header_line_02.arr[0]		= '\0';			
	bl_header_line_03.arr[0]		= '\0';			
	bl_header_line_04.arr[0]		= '\0';			
	bl_header_line_05.arr[0]		= '\0';			
	bl_header_line_06.arr[0]		= '\0';			
	bl_header_line_07.arr[0]		= '\0';			
	bl_header_line_08.arr[0]		= '\0';			
	bl_header_line_09.arr[0]		= '\0';			
	bl_header_line_10.arr[0]		= '\0';			
	bl_header_line_11.arr[0]		= '\0';			
	bl_header_line_12.arr[0]		= '\0';			
	bl_header_line_13.arr[0]		= '\0';			
	bl_header_line_14.arr[0]		= '\0';			
	bl_footer_line_01.arr[0]		= '\0';			
	bl_footer_line_02.arr[0]		= '\0';			
	bl_footer_line_03.arr[0]		= '\0';			
	bl_footer_line_04.arr[0]		= '\0';			
	bill_credit_footer_line1.arr[0]		= '\0';		
	bill_credit_footer_line2.arr[0]		= '\0';		
	bill_credit_footer_line3.arr[0]		= '\0';		
	bill_credit_footer_line4.arr[0]		= '\0';	
	bill_ins_footer_line1.arr[0]		= '\0';
	bill_ins_footer_line2.arr[0]		= '\0';
	bill_ins_footer_line3.arr[0]		= '\0';
	bill_ins_footer_line4.arr[0]		= '\0';
	cr_addl_id_in_ftr_yn.arr[0]			= '\0';
	print_ins_addl_id_in_ftr_yn.arr[0]	= '\0';
	ip_cr_addl_id_in_ftr_yn.arr[0]		= '\0';
	ip_ins_addl_id_in_ftr_yn.arr[0]		= '\0';

	original_text.len=0;
	copy_text.len= 0;	
	bill_title_line1.len= 0;
	bill_title_line2.len= 0;		
	bill_title_line3.len= 0;		
	bill_title_line4.len= 0;		
	op_cash_bill_title_w_rcpt.len= 0;		
	op_cash_bill_title_wo_rcpt.len= 0;	
	op_credit_bill_title.len= 0;		
	ip_cash_bill_title_w_rcpt.len= 0;	
	ip_cash_bill_title_wo_rcpt.len= 0;	
	ip_credit_bill_title.len= 0;		
	cash_bill_title_addl_line.len= 0;	
	credit_bill_title_addl_line.len= 0;	
	bl_header_line_01.len= 0;			
	bl_header_line_02.len= 0;			
	bl_header_line_03.len= 0;			
	bl_header_line_04.len= 0;			
	bl_header_line_05.len= 0;			
	bl_header_line_06.len= 0;			
	bl_header_line_07.len= 0;			
	bl_header_line_08.len= 0;			
	bl_header_line_09.len= 0;			
	bl_header_line_10.len= 0;			
	bl_header_line_11.len= 0;			
	bl_header_line_12.len= 0;			
	bl_header_line_13.len= 0;			
	bl_header_line_14.len= 0;			
	bl_footer_line_01.len= 0;			
	bl_footer_line_02.len= 0;			
	bl_footer_line_03.len= 0;			
	bl_footer_line_04.len= 0;			
	bill_credit_footer_line1.len= 0;		
	bill_credit_footer_line2.len= 0;		
	bill_credit_footer_line3.len= 0;		
	bill_credit_footer_line4.len= 0;
	bill_ins_footer_line1.len	= 0;
	bill_ins_footer_line2.len	= 0;
	bill_ins_footer_line3.len	= 0;
	bill_ins_footer_line4.len	= 0;
	cr_addl_id_in_ftr_yn.len	= 0;
	print_ins_addl_id_in_ftr_yn.len	= 0;
	ip_cr_addl_id_in_ftr_yn.len	= 0;
	ip_ins_addl_id_in_ftr_yn.len= 0;

		
		/* EXEC SQL SELECT REGION_CODE,RES_AREA_CODE,RES_TOWN_CODE
				into :nd_REGION_CODE,:nd_RES_AREA_CODE,:nd_RES_TOWN_CODE
				from sm_facility_param
				where FACILITY_ID=:nd_facility_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select REGION_CODE ,RES_AREA_CODE ,RES_TOWN_CODE into :b0,:\
b1,:b2  from sm_facility_param where FACILITY_ID=:b3";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )10801;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_REGION_CODE;
  sqlstm.sqhstl[0] = (unsigned int  )102;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_RES_AREA_CODE;
  sqlstm.sqhstl[1] = (unsigned int  )102;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_RES_TOWN_CODE;
  sqlstm.sqhstl[2] = (unsigned int  )102;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&nd_facility_id;
  sqlstm.sqhstl[3] = (unsigned int  )5;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


     	
		/*	EXEC SQL SELECT REGION_CODE,RES_AREA_CODE,RES_TOWN_CODE
				into :nd_REGION_CODE1,:nd_RES_AREA_CODE1,:nd_RES_TOWN_CODE1
				from mp_patient
				where patient_id=:d_patient_id;*/

		

       if((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)||(strcmp(d_episode_type.arr,"R")==0))
	   {
	   
       /* EXEC SQL SELECT ORIGINAL_TEXT,			
						COPY_TEXT,			
						BILL_TITLE_LINE1,		
						BILL_TITLE_LINE2,		
						BILL_TITLE_LINE3,		
						BILL_TITLE_LINE4,		
						OP_CASH_BILL_TITLE_W_RCPT,	
						OP_CASH_BILL_TITLE_WO_RCPT,	
						OP_CREDIT_BILL_TITLE,		
						IP_CASH_INT_BILL_TITLE,//IP_CASH_BILL_TITLE_W_RCPT,		added while remerging scrum
						IP_CASH_INT_BILL_TITLE,//IP_CASH_BILL_TITLE_WO_RCPT,		added while remerging scrum
						IP_CREDIT_INT_BILL_TITLE,//IP_CREDIT_BILL_TITLE,		added while remerging scrum
						CASH_BILL_TITLE_ADDL_LINE,	
						CREDIT_BILL_TITLE_ADDL_LINE,	
						BILL_HEADER_LINE1,		
						BILL_HEADER_LINE2,		
						BILL_HEADER_LINE3,		
						BILL_HEADER_LINE4,		
						BILL_HEADER_LINE5,		
						BILL_HEADER_LINE6,		
						BILL_HEADER_LINE7,		
						BILL_HEADER_LINE8,		
						BILL_HEADER_LINE9,		
						BILL_HEADER_LINE10,		
						BILL_HEADER_LINE11,		
						BILL_HEADER_LINE12,		
						BILL_HEADER_LINE13,		
						BILL_HEADER_LINE14,		
						BILL_FOOTER_LINE1,		
						BILL_FOOTER_LINE2,		
						BILL_FOOTER_LINE3,		
						BILL_FOOTER_LINE4,		
						BILL_CREDIT_FOOTER_LINE1,	
						BILL_CREDIT_FOOTER_LINE2,	
						BILL_CREDIT_FOOTER_LINE3,	
						BILL_CREDIT_FOOTER_LINE4,
						bill_ins_footer_line1,
						bill_ins_footer_line2,
						bill_ins_footer_line3,
						bill_ins_footer_line4,
						CR_ADDL_ID_IN_FTR_YN,
						PRINT_INS_ADDL_ID_IN_FTR_YN	
	            into	:original_text,
						:copy_text,			
						:bill_title_line1,		
						:bill_title_line2,		
						:bill_title_line3,		
						:bill_title_line4,		
						:op_cash_bill_title_w_rcpt,	
						:op_cash_bill_title_wo_rcpt,	
						:op_credit_bill_title,		
						:ip_cash_bill_title_w_rcpt,	
						:ip_cash_bill_title_wo_rcpt,	
						:ip_credit_bill_title,		
						:cash_bill_title_addl_line,	
						:credit_bill_title_addl_line,
						 :bl_header_line_01,
						 :bl_header_line_02,
						 :bl_header_line_03,
						 :bl_header_line_04,
						 :bl_header_line_05,
						 :bl_header_line_06,
						 :bl_header_line_07,
						 :bl_header_line_08,
						 :bl_header_line_09,
						 :bl_header_line_10,
						 :bl_header_line_11,
						 :bl_header_line_12,
						 :bl_header_line_13,
						 :bl_header_line_14,
						 :bl_footer_line_01,
						 :bl_footer_line_02,
						 :bl_footer_line_03,
						 :bl_footer_line_04,
						 :bill_credit_footer_line1,	
						 :bill_credit_footer_line2,
						 :bill_credit_footer_line3,
						 :bill_credit_footer_line4,
						 :bill_ins_footer_line1,
						 :bill_ins_footer_line2,
						 :bill_ins_footer_line3,
						 :bill_ins_footer_line4,
						 :cr_addl_id_in_ftr_yn,
						 :print_ins_addl_id_in_ftr_yn
                FROM BL_BILL_HDR_FTR_FORMAT
		        WHERE Operating_Facility_Id = :nd_facility_id
				AND   UPPER(NVL(LANGUAGE_ID,'en'))=UPPER(:nd_lang_id); */ 

{
       struct sqlexd sqlstm;
       sqlstm.sqlvsn = 12;
       sqlstm.arrsiz = 52;
       sqlstm.sqladtp = &sqladt;
       sqlstm.sqltdsp = &sqltds;
       sqlbuft((void **)0, 
         "select ORIGINAL_TEXT ,COPY_TEXT ,BILL_TITLE_LINE1 ,BILL_TITLE_LINE\
2 ,BILL_TITLE_LINE3 ,BILL_TITLE_LINE4 ,OP_CASH_BILL_TITLE_W_RCPT ,OP_CASH_BI\
LL_TITLE_WO_RCPT ,OP_CREDIT_BILL_TITLE ,IP_CASH_INT_BILL_TITLE ,IP_CASH_INT_\
BILL_TITLE ,IP_CREDIT_INT_BILL_TITLE ,CASH_BILL_TITLE_ADDL_LINE ,CREDIT_BILL\
_TITLE_ADDL_LINE ,BILL_HEADER_LINE1 ,BILL_HEADER_LINE2 ,BILL_HEADER_LINE3 ,B\
ILL_HEADER_LINE4 ,BILL_HEADER_LINE5 ,BILL_HEADER_LINE6 ,BILL_HEADER_LINE7 ,B\
ILL_HEADER_LINE8 ,BILL_HEADER_LINE9 ,BILL_HEADER_LINE10 ,BILL_HEADER_LINE11 \
,BILL_HEADER_LINE12 ,BILL_HEADER_LINE13 ,BILL_HEADER_LINE14 ,BILL_FOOTER_LIN\
E1 ,BILL_FOOTER_LINE2 ,BILL_FOOTER_LINE3 ,BILL_FOOTER_LINE4 ,BILL_CREDIT_FOO\
TER_LINE1 ,BILL_CREDIT_FOOTER_LINE2 ,BILL_CREDIT_FOOTER_LINE3 ,BILL_CREDIT_F\
OOTER_LINE4 ,bill_ins_footer_line1 ,bill_ins_footer_line2 ,bill_ins_footer_l\
ine3 ,bill_ins_footer_line4 ,CR_ADDL_ID_IN_FTR_YN ,PRINT_INS_ADDL_ID_IN_FTR_\
YN into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b1\
5,:b16,:b17,:b18,:b19,:b20,:b21,:b22,:b23,:b24");
       sqlstm.stmt = ",:b25,:b26,:b27,:b28,:b29,:b30,:b31,:b32,:b33,:b34,:b3\
5,:b36,:b37,:b38,:b39,:b40,:b41  from BL_BILL_HDR_FTR_FORMAT where (Operating_\
Facility_Id=:b42 and UPPER(NVL(LANGUAGE_ID,'en'))=UPPER(:b43))";
       sqlstm.iters = (unsigned int  )1;
       sqlstm.offset = (unsigned int  )10832;
       sqlstm.selerr = (unsigned short)1;
       sqlstm.cud = sqlcud0;
       sqlstm.sqlest = (unsigned char  *)&sqlca;
       sqlstm.sqlety = (unsigned short)4352;
       sqlstm.occurs = (unsigned int  )0;
       sqlstm.sqhstv[0] = (         void  *)&original_text;
       sqlstm.sqhstl[0] = (unsigned int  )103;
       sqlstm.sqhsts[0] = (         int  )0;
       sqlstm.sqindv[0] = (         void  *)0;
       sqlstm.sqinds[0] = (         int  )0;
       sqlstm.sqharm[0] = (unsigned int  )0;
       sqlstm.sqadto[0] = (unsigned short )0;
       sqlstm.sqtdso[0] = (unsigned short )0;
       sqlstm.sqhstv[1] = (         void  *)&copy_text;
       sqlstm.sqhstl[1] = (unsigned int  )103;
       sqlstm.sqhsts[1] = (         int  )0;
       sqlstm.sqindv[1] = (         void  *)0;
       sqlstm.sqinds[1] = (         int  )0;
       sqlstm.sqharm[1] = (unsigned int  )0;
       sqlstm.sqadto[1] = (unsigned short )0;
       sqlstm.sqtdso[1] = (unsigned short )0;
       sqlstm.sqhstv[2] = (         void  *)&bill_title_line1;
       sqlstm.sqhstl[2] = (unsigned int  )103;
       sqlstm.sqhsts[2] = (         int  )0;
       sqlstm.sqindv[2] = (         void  *)0;
       sqlstm.sqinds[2] = (         int  )0;
       sqlstm.sqharm[2] = (unsigned int  )0;
       sqlstm.sqadto[2] = (unsigned short )0;
       sqlstm.sqtdso[2] = (unsigned short )0;
       sqlstm.sqhstv[3] = (         void  *)&bill_title_line2;
       sqlstm.sqhstl[3] = (unsigned int  )103;
       sqlstm.sqhsts[3] = (         int  )0;
       sqlstm.sqindv[3] = (         void  *)0;
       sqlstm.sqinds[3] = (         int  )0;
       sqlstm.sqharm[3] = (unsigned int  )0;
       sqlstm.sqadto[3] = (unsigned short )0;
       sqlstm.sqtdso[3] = (unsigned short )0;
       sqlstm.sqhstv[4] = (         void  *)&bill_title_line3;
       sqlstm.sqhstl[4] = (unsigned int  )103;
       sqlstm.sqhsts[4] = (         int  )0;
       sqlstm.sqindv[4] = (         void  *)0;
       sqlstm.sqinds[4] = (         int  )0;
       sqlstm.sqharm[4] = (unsigned int  )0;
       sqlstm.sqadto[4] = (unsigned short )0;
       sqlstm.sqtdso[4] = (unsigned short )0;
       sqlstm.sqhstv[5] = (         void  *)&bill_title_line4;
       sqlstm.sqhstl[5] = (unsigned int  )103;
       sqlstm.sqhsts[5] = (         int  )0;
       sqlstm.sqindv[5] = (         void  *)0;
       sqlstm.sqinds[5] = (         int  )0;
       sqlstm.sqharm[5] = (unsigned int  )0;
       sqlstm.sqadto[5] = (unsigned short )0;
       sqlstm.sqtdso[5] = (unsigned short )0;
       sqlstm.sqhstv[6] = (         void  *)&op_cash_bill_title_w_rcpt;
       sqlstm.sqhstl[6] = (unsigned int  )103;
       sqlstm.sqhsts[6] = (         int  )0;
       sqlstm.sqindv[6] = (         void  *)0;
       sqlstm.sqinds[6] = (         int  )0;
       sqlstm.sqharm[6] = (unsigned int  )0;
       sqlstm.sqadto[6] = (unsigned short )0;
       sqlstm.sqtdso[6] = (unsigned short )0;
       sqlstm.sqhstv[7] = (         void  *)&op_cash_bill_title_wo_rcpt;
       sqlstm.sqhstl[7] = (unsigned int  )103;
       sqlstm.sqhsts[7] = (         int  )0;
       sqlstm.sqindv[7] = (         void  *)0;
       sqlstm.sqinds[7] = (         int  )0;
       sqlstm.sqharm[7] = (unsigned int  )0;
       sqlstm.sqadto[7] = (unsigned short )0;
       sqlstm.sqtdso[7] = (unsigned short )0;
       sqlstm.sqhstv[8] = (         void  *)&op_credit_bill_title;
       sqlstm.sqhstl[8] = (unsigned int  )103;
       sqlstm.sqhsts[8] = (         int  )0;
       sqlstm.sqindv[8] = (         void  *)0;
       sqlstm.sqinds[8] = (         int  )0;
       sqlstm.sqharm[8] = (unsigned int  )0;
       sqlstm.sqadto[8] = (unsigned short )0;
       sqlstm.sqtdso[8] = (unsigned short )0;
       sqlstm.sqhstv[9] = (         void  *)&ip_cash_bill_title_w_rcpt;
       sqlstm.sqhstl[9] = (unsigned int  )103;
       sqlstm.sqhsts[9] = (         int  )0;
       sqlstm.sqindv[9] = (         void  *)0;
       sqlstm.sqinds[9] = (         int  )0;
       sqlstm.sqharm[9] = (unsigned int  )0;
       sqlstm.sqadto[9] = (unsigned short )0;
       sqlstm.sqtdso[9] = (unsigned short )0;
       sqlstm.sqhstv[10] = (         void  *)&ip_cash_bill_title_wo_rcpt;
       sqlstm.sqhstl[10] = (unsigned int  )103;
       sqlstm.sqhsts[10] = (         int  )0;
       sqlstm.sqindv[10] = (         void  *)0;
       sqlstm.sqinds[10] = (         int  )0;
       sqlstm.sqharm[10] = (unsigned int  )0;
       sqlstm.sqadto[10] = (unsigned short )0;
       sqlstm.sqtdso[10] = (unsigned short )0;
       sqlstm.sqhstv[11] = (         void  *)&ip_credit_bill_title;
       sqlstm.sqhstl[11] = (unsigned int  )103;
       sqlstm.sqhsts[11] = (         int  )0;
       sqlstm.sqindv[11] = (         void  *)0;
       sqlstm.sqinds[11] = (         int  )0;
       sqlstm.sqharm[11] = (unsigned int  )0;
       sqlstm.sqadto[11] = (unsigned short )0;
       sqlstm.sqtdso[11] = (unsigned short )0;
       sqlstm.sqhstv[12] = (         void  *)&cash_bill_title_addl_line;
       sqlstm.sqhstl[12] = (unsigned int  )103;
       sqlstm.sqhsts[12] = (         int  )0;
       sqlstm.sqindv[12] = (         void  *)0;
       sqlstm.sqinds[12] = (         int  )0;
       sqlstm.sqharm[12] = (unsigned int  )0;
       sqlstm.sqadto[12] = (unsigned short )0;
       sqlstm.sqtdso[12] = (unsigned short )0;
       sqlstm.sqhstv[13] = (         void  *)&credit_bill_title_addl_line;
       sqlstm.sqhstl[13] = (unsigned int  )103;
       sqlstm.sqhsts[13] = (         int  )0;
       sqlstm.sqindv[13] = (         void  *)0;
       sqlstm.sqinds[13] = (         int  )0;
       sqlstm.sqharm[13] = (unsigned int  )0;
       sqlstm.sqadto[13] = (unsigned short )0;
       sqlstm.sqtdso[13] = (unsigned short )0;
       sqlstm.sqhstv[14] = (         void  *)&bl_header_line_01;
       sqlstm.sqhstl[14] = (unsigned int  )103;
       sqlstm.sqhsts[14] = (         int  )0;
       sqlstm.sqindv[14] = (         void  *)0;
       sqlstm.sqinds[14] = (         int  )0;
       sqlstm.sqharm[14] = (unsigned int  )0;
       sqlstm.sqadto[14] = (unsigned short )0;
       sqlstm.sqtdso[14] = (unsigned short )0;
       sqlstm.sqhstv[15] = (         void  *)&bl_header_line_02;
       sqlstm.sqhstl[15] = (unsigned int  )103;
       sqlstm.sqhsts[15] = (         int  )0;
       sqlstm.sqindv[15] = (         void  *)0;
       sqlstm.sqinds[15] = (         int  )0;
       sqlstm.sqharm[15] = (unsigned int  )0;
       sqlstm.sqadto[15] = (unsigned short )0;
       sqlstm.sqtdso[15] = (unsigned short )0;
       sqlstm.sqhstv[16] = (         void  *)&bl_header_line_03;
       sqlstm.sqhstl[16] = (unsigned int  )103;
       sqlstm.sqhsts[16] = (         int  )0;
       sqlstm.sqindv[16] = (         void  *)0;
       sqlstm.sqinds[16] = (         int  )0;
       sqlstm.sqharm[16] = (unsigned int  )0;
       sqlstm.sqadto[16] = (unsigned short )0;
       sqlstm.sqtdso[16] = (unsigned short )0;
       sqlstm.sqhstv[17] = (         void  *)&bl_header_line_04;
       sqlstm.sqhstl[17] = (unsigned int  )103;
       sqlstm.sqhsts[17] = (         int  )0;
       sqlstm.sqindv[17] = (         void  *)0;
       sqlstm.sqinds[17] = (         int  )0;
       sqlstm.sqharm[17] = (unsigned int  )0;
       sqlstm.sqadto[17] = (unsigned short )0;
       sqlstm.sqtdso[17] = (unsigned short )0;
       sqlstm.sqhstv[18] = (         void  *)&bl_header_line_05;
       sqlstm.sqhstl[18] = (unsigned int  )103;
       sqlstm.sqhsts[18] = (         int  )0;
       sqlstm.sqindv[18] = (         void  *)0;
       sqlstm.sqinds[18] = (         int  )0;
       sqlstm.sqharm[18] = (unsigned int  )0;
       sqlstm.sqadto[18] = (unsigned short )0;
       sqlstm.sqtdso[18] = (unsigned short )0;
       sqlstm.sqhstv[19] = (         void  *)&bl_header_line_06;
       sqlstm.sqhstl[19] = (unsigned int  )103;
       sqlstm.sqhsts[19] = (         int  )0;
       sqlstm.sqindv[19] = (         void  *)0;
       sqlstm.sqinds[19] = (         int  )0;
       sqlstm.sqharm[19] = (unsigned int  )0;
       sqlstm.sqadto[19] = (unsigned short )0;
       sqlstm.sqtdso[19] = (unsigned short )0;
       sqlstm.sqhstv[20] = (         void  *)&bl_header_line_07;
       sqlstm.sqhstl[20] = (unsigned int  )103;
       sqlstm.sqhsts[20] = (         int  )0;
       sqlstm.sqindv[20] = (         void  *)0;
       sqlstm.sqinds[20] = (         int  )0;
       sqlstm.sqharm[20] = (unsigned int  )0;
       sqlstm.sqadto[20] = (unsigned short )0;
       sqlstm.sqtdso[20] = (unsigned short )0;
       sqlstm.sqhstv[21] = (         void  *)&bl_header_line_08;
       sqlstm.sqhstl[21] = (unsigned int  )103;
       sqlstm.sqhsts[21] = (         int  )0;
       sqlstm.sqindv[21] = (         void  *)0;
       sqlstm.sqinds[21] = (         int  )0;
       sqlstm.sqharm[21] = (unsigned int  )0;
       sqlstm.sqadto[21] = (unsigned short )0;
       sqlstm.sqtdso[21] = (unsigned short )0;
       sqlstm.sqhstv[22] = (         void  *)&bl_header_line_09;
       sqlstm.sqhstl[22] = (unsigned int  )103;
       sqlstm.sqhsts[22] = (         int  )0;
       sqlstm.sqindv[22] = (         void  *)0;
       sqlstm.sqinds[22] = (         int  )0;
       sqlstm.sqharm[22] = (unsigned int  )0;
       sqlstm.sqadto[22] = (unsigned short )0;
       sqlstm.sqtdso[22] = (unsigned short )0;
       sqlstm.sqhstv[23] = (         void  *)&bl_header_line_10;
       sqlstm.sqhstl[23] = (unsigned int  )103;
       sqlstm.sqhsts[23] = (         int  )0;
       sqlstm.sqindv[23] = (         void  *)0;
       sqlstm.sqinds[23] = (         int  )0;
       sqlstm.sqharm[23] = (unsigned int  )0;
       sqlstm.sqadto[23] = (unsigned short )0;
       sqlstm.sqtdso[23] = (unsigned short )0;
       sqlstm.sqhstv[24] = (         void  *)&bl_header_line_11;
       sqlstm.sqhstl[24] = (unsigned int  )103;
       sqlstm.sqhsts[24] = (         int  )0;
       sqlstm.sqindv[24] = (         void  *)0;
       sqlstm.sqinds[24] = (         int  )0;
       sqlstm.sqharm[24] = (unsigned int  )0;
       sqlstm.sqadto[24] = (unsigned short )0;
       sqlstm.sqtdso[24] = (unsigned short )0;
       sqlstm.sqhstv[25] = (         void  *)&bl_header_line_12;
       sqlstm.sqhstl[25] = (unsigned int  )103;
       sqlstm.sqhsts[25] = (         int  )0;
       sqlstm.sqindv[25] = (         void  *)0;
       sqlstm.sqinds[25] = (         int  )0;
       sqlstm.sqharm[25] = (unsigned int  )0;
       sqlstm.sqadto[25] = (unsigned short )0;
       sqlstm.sqtdso[25] = (unsigned short )0;
       sqlstm.sqhstv[26] = (         void  *)&bl_header_line_13;
       sqlstm.sqhstl[26] = (unsigned int  )103;
       sqlstm.sqhsts[26] = (         int  )0;
       sqlstm.sqindv[26] = (         void  *)0;
       sqlstm.sqinds[26] = (         int  )0;
       sqlstm.sqharm[26] = (unsigned int  )0;
       sqlstm.sqadto[26] = (unsigned short )0;
       sqlstm.sqtdso[26] = (unsigned short )0;
       sqlstm.sqhstv[27] = (         void  *)&bl_header_line_14;
       sqlstm.sqhstl[27] = (unsigned int  )103;
       sqlstm.sqhsts[27] = (         int  )0;
       sqlstm.sqindv[27] = (         void  *)0;
       sqlstm.sqinds[27] = (         int  )0;
       sqlstm.sqharm[27] = (unsigned int  )0;
       sqlstm.sqadto[27] = (unsigned short )0;
       sqlstm.sqtdso[27] = (unsigned short )0;
       sqlstm.sqhstv[28] = (         void  *)&bl_footer_line_01;
       sqlstm.sqhstl[28] = (unsigned int  )103;
       sqlstm.sqhsts[28] = (         int  )0;
       sqlstm.sqindv[28] = (         void  *)0;
       sqlstm.sqinds[28] = (         int  )0;
       sqlstm.sqharm[28] = (unsigned int  )0;
       sqlstm.sqadto[28] = (unsigned short )0;
       sqlstm.sqtdso[28] = (unsigned short )0;
       sqlstm.sqhstv[29] = (         void  *)&bl_footer_line_02;
       sqlstm.sqhstl[29] = (unsigned int  )103;
       sqlstm.sqhsts[29] = (         int  )0;
       sqlstm.sqindv[29] = (         void  *)0;
       sqlstm.sqinds[29] = (         int  )0;
       sqlstm.sqharm[29] = (unsigned int  )0;
       sqlstm.sqadto[29] = (unsigned short )0;
       sqlstm.sqtdso[29] = (unsigned short )0;
       sqlstm.sqhstv[30] = (         void  *)&bl_footer_line_03;
       sqlstm.sqhstl[30] = (unsigned int  )103;
       sqlstm.sqhsts[30] = (         int  )0;
       sqlstm.sqindv[30] = (         void  *)0;
       sqlstm.sqinds[30] = (         int  )0;
       sqlstm.sqharm[30] = (unsigned int  )0;
       sqlstm.sqadto[30] = (unsigned short )0;
       sqlstm.sqtdso[30] = (unsigned short )0;
       sqlstm.sqhstv[31] = (         void  *)&bl_footer_line_04;
       sqlstm.sqhstl[31] = (unsigned int  )103;
       sqlstm.sqhsts[31] = (         int  )0;
       sqlstm.sqindv[31] = (         void  *)0;
       sqlstm.sqinds[31] = (         int  )0;
       sqlstm.sqharm[31] = (unsigned int  )0;
       sqlstm.sqadto[31] = (unsigned short )0;
       sqlstm.sqtdso[31] = (unsigned short )0;
       sqlstm.sqhstv[32] = (         void  *)&bill_credit_footer_line1;
       sqlstm.sqhstl[32] = (unsigned int  )103;
       sqlstm.sqhsts[32] = (         int  )0;
       sqlstm.sqindv[32] = (         void  *)0;
       sqlstm.sqinds[32] = (         int  )0;
       sqlstm.sqharm[32] = (unsigned int  )0;
       sqlstm.sqadto[32] = (unsigned short )0;
       sqlstm.sqtdso[32] = (unsigned short )0;
       sqlstm.sqhstv[33] = (         void  *)&bill_credit_footer_line2;
       sqlstm.sqhstl[33] = (unsigned int  )103;
       sqlstm.sqhsts[33] = (         int  )0;
       sqlstm.sqindv[33] = (         void  *)0;
       sqlstm.sqinds[33] = (         int  )0;
       sqlstm.sqharm[33] = (unsigned int  )0;
       sqlstm.sqadto[33] = (unsigned short )0;
       sqlstm.sqtdso[33] = (unsigned short )0;
       sqlstm.sqhstv[34] = (         void  *)&bill_credit_footer_line3;
       sqlstm.sqhstl[34] = (unsigned int  )103;
       sqlstm.sqhsts[34] = (         int  )0;
       sqlstm.sqindv[34] = (         void  *)0;
       sqlstm.sqinds[34] = (         int  )0;
       sqlstm.sqharm[34] = (unsigned int  )0;
       sqlstm.sqadto[34] = (unsigned short )0;
       sqlstm.sqtdso[34] = (unsigned short )0;
       sqlstm.sqhstv[35] = (         void  *)&bill_credit_footer_line4;
       sqlstm.sqhstl[35] = (unsigned int  )103;
       sqlstm.sqhsts[35] = (         int  )0;
       sqlstm.sqindv[35] = (         void  *)0;
       sqlstm.sqinds[35] = (         int  )0;
       sqlstm.sqharm[35] = (unsigned int  )0;
       sqlstm.sqadto[35] = (unsigned short )0;
       sqlstm.sqtdso[35] = (unsigned short )0;
       sqlstm.sqhstv[36] = (         void  *)&bill_ins_footer_line1;
       sqlstm.sqhstl[36] = (unsigned int  )103;
       sqlstm.sqhsts[36] = (         int  )0;
       sqlstm.sqindv[36] = (         void  *)0;
       sqlstm.sqinds[36] = (         int  )0;
       sqlstm.sqharm[36] = (unsigned int  )0;
       sqlstm.sqadto[36] = (unsigned short )0;
       sqlstm.sqtdso[36] = (unsigned short )0;
       sqlstm.sqhstv[37] = (         void  *)&bill_ins_footer_line2;
       sqlstm.sqhstl[37] = (unsigned int  )103;
       sqlstm.sqhsts[37] = (         int  )0;
       sqlstm.sqindv[37] = (         void  *)0;
       sqlstm.sqinds[37] = (         int  )0;
       sqlstm.sqharm[37] = (unsigned int  )0;
       sqlstm.sqadto[37] = (unsigned short )0;
       sqlstm.sqtdso[37] = (unsigned short )0;
       sqlstm.sqhstv[38] = (         void  *)&bill_ins_footer_line3;
       sqlstm.sqhstl[38] = (unsigned int  )103;
       sqlstm.sqhsts[38] = (         int  )0;
       sqlstm.sqindv[38] = (         void  *)0;
       sqlstm.sqinds[38] = (         int  )0;
       sqlstm.sqharm[38] = (unsigned int  )0;
       sqlstm.sqadto[38] = (unsigned short )0;
       sqlstm.sqtdso[38] = (unsigned short )0;
       sqlstm.sqhstv[39] = (         void  *)&bill_ins_footer_line4;
       sqlstm.sqhstl[39] = (unsigned int  )103;
       sqlstm.sqhsts[39] = (         int  )0;
       sqlstm.sqindv[39] = (         void  *)0;
       sqlstm.sqinds[39] = (         int  )0;
       sqlstm.sqharm[39] = (unsigned int  )0;
       sqlstm.sqadto[39] = (unsigned short )0;
       sqlstm.sqtdso[39] = (unsigned short )0;
       sqlstm.sqhstv[40] = (         void  *)&cr_addl_id_in_ftr_yn;
       sqlstm.sqhstl[40] = (unsigned int  )4;
       sqlstm.sqhsts[40] = (         int  )0;
       sqlstm.sqindv[40] = (         void  *)0;
       sqlstm.sqinds[40] = (         int  )0;
       sqlstm.sqharm[40] = (unsigned int  )0;
       sqlstm.sqadto[40] = (unsigned short )0;
       sqlstm.sqtdso[40] = (unsigned short )0;
       sqlstm.sqhstv[41] = (         void  *)&print_ins_addl_id_in_ftr_yn;
       sqlstm.sqhstl[41] = (unsigned int  )4;
       sqlstm.sqhsts[41] = (         int  )0;
       sqlstm.sqindv[41] = (         void  *)0;
       sqlstm.sqinds[41] = (         int  )0;
       sqlstm.sqharm[41] = (unsigned int  )0;
       sqlstm.sqadto[41] = (unsigned short )0;
       sqlstm.sqtdso[41] = (unsigned short )0;
       sqlstm.sqhstv[42] = (         void  *)&nd_facility_id;
       sqlstm.sqhstl[42] = (unsigned int  )5;
       sqlstm.sqhsts[42] = (         int  )0;
       sqlstm.sqindv[42] = (         void  *)0;
       sqlstm.sqinds[42] = (         int  )0;
       sqlstm.sqharm[42] = (unsigned int  )0;
       sqlstm.sqadto[42] = (unsigned short )0;
       sqlstm.sqtdso[42] = (unsigned short )0;
       sqlstm.sqhstv[43] = (         void  *)&nd_lang_id;
       sqlstm.sqhstl[43] = (unsigned int  )6;
       sqlstm.sqhsts[43] = (         int  )0;
       sqlstm.sqindv[43] = (         void  *)0;
       sqlstm.sqinds[43] = (         int  )0;
       sqlstm.sqharm[43] = (unsigned int  )0;
       sqlstm.sqadto[43] = (unsigned short )0;
       sqlstm.sqtdso[43] = (unsigned short )0;
       sqlstm.sqphsv = sqlstm.sqhstv;
       sqlstm.sqphsl = sqlstm.sqhstl;
       sqlstm.sqphss = sqlstm.sqhsts;
       sqlstm.sqpind = sqlstm.sqindv;
       sqlstm.sqpins = sqlstm.sqinds;
       sqlstm.sqparm = sqlstm.sqharm;
       sqlstm.sqparc = sqlstm.sqharc;
       sqlstm.sqpadto = sqlstm.sqadto;
       sqlstm.sqptdso = sqlstm.sqtdso;
       sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			
			
			if(NODATAFOUND) 
			{
			 /* EXEC SQL SELECT ORIGINAL_TEXT,			
						COPY_TEXT,			
						BILL_TITLE_LINE1,		
						BILL_TITLE_LINE2,		
						BILL_TITLE_LINE3,		
						BILL_TITLE_LINE4,		
						OP_CASH_BILL_TITLE_W_RCPT,	
						OP_CASH_BILL_TITLE_WO_RCPT,	
						OP_CREDIT_BILL_TITLE,		
						IP_CASH_INT_BILL_TITLE,//IP_CASH_BILL_TITLE_W_RCPT,	commented for scrum remerging	
						IP_CASH_INT_BILL_TITLE,//IP_CASH_BILL_TITLE_WO_RCPT,	commented for scrum remerging	
						IP_CREDIT_INT_BILL_TITLE,//IP_CREDIT_BILL_TITLE, commented for scrum remerging		
						CASH_BILL_TITLE_ADDL_LINE,	
						CREDIT_BILL_TITLE_ADDL_LINE,	
						BILL_HEADER_LINE1,		
						BILL_HEADER_LINE2,		
						BILL_HEADER_LINE3,		
						BILL_HEADER_LINE4,		
						BILL_HEADER_LINE5,		
						BILL_HEADER_LINE6,		
						BILL_HEADER_LINE7,		
						BILL_HEADER_LINE8,		
						BILL_HEADER_LINE9,		
						BILL_HEADER_LINE10,		
						BILL_HEADER_LINE11,		
						BILL_HEADER_LINE12,		
						BILL_HEADER_LINE13,		
						BILL_HEADER_LINE14,		
						BILL_FOOTER_LINE1,		
						BILL_FOOTER_LINE2,		
						BILL_FOOTER_LINE3,		
						BILL_FOOTER_LINE4,		
						BILL_CREDIT_FOOTER_LINE1,	
						BILL_CREDIT_FOOTER_LINE2,	
						BILL_CREDIT_FOOTER_LINE3,	
						BILL_CREDIT_FOOTER_LINE4,
						bill_ins_footer_line1,
						bill_ins_footer_line2,
						bill_ins_footer_line3,
						bill_ins_footer_line4,
						CR_ADDL_ID_IN_FTR_YN,
						PRINT_INS_ADDL_ID_IN_FTR_YN	
	            into	:original_text,
						:copy_text,			
						:bill_title_line1,		
						:bill_title_line2,		
						:bill_title_line3,		
						:bill_title_line4,		
						:op_cash_bill_title_w_rcpt,	
						:op_cash_bill_title_wo_rcpt,	
						:op_credit_bill_title,		
						:ip_cash_bill_title_w_rcpt,	
						:ip_cash_bill_title_wo_rcpt,	
						:ip_credit_bill_title,		
						:cash_bill_title_addl_line,	
						:credit_bill_title_addl_line,
						 :bl_header_line_01,
						 :bl_header_line_02,
						 :bl_header_line_03,
						 :bl_header_line_04,
						 :bl_header_line_05,
						 :bl_header_line_06,
						 :bl_header_line_07,
						 :bl_header_line_08,
						 :bl_header_line_09,
						 :bl_header_line_10,
						 :bl_header_line_11,
						 :bl_header_line_12,
						 :bl_header_line_13,
						 :bl_header_line_14,
						 :bl_footer_line_01,
						 :bl_footer_line_02,
						 :bl_footer_line_03,
						 :bl_footer_line_04,
						 :bill_credit_footer_line1,	
						 :bill_credit_footer_line2,
						 :bill_credit_footer_line3,
						 :bill_credit_footer_line4,
						 :bill_ins_footer_line1,
						 :bill_ins_footer_line2,
						 :bill_ins_footer_line3,
						 :bill_ins_footer_line4,
						 :cr_addl_id_in_ftr_yn,
						 :print_ins_addl_id_in_ftr_yn
                FROM BL_BILL_HDR_FTR_FORMAT
		        WHERE Operating_Facility_Id = :nd_facility_id
				AND   UPPER(NVL(LANGUAGE_ID,'en'))=UPPER('en'); */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlbuft((void **)0, 
      "select ORIGINAL_TEXT ,COPY_TEXT ,BILL_TITLE_LINE1 ,BILL_TITLE_LINE2 ,\
BILL_TITLE_LINE3 ,BILL_TITLE_LINE4 ,OP_CASH_BILL_TITLE_W_RCPT ,OP_CASH_BILL_\
TITLE_WO_RCPT ,OP_CREDIT_BILL_TITLE ,IP_CASH_INT_BILL_TITLE ,IP_CASH_INT_BIL\
L_TITLE ,IP_CREDIT_INT_BILL_TITLE ,CASH_BILL_TITLE_ADDL_LINE ,CREDIT_BILL_TI\
TLE_ADDL_LINE ,BILL_HEADER_LINE1 ,BILL_HEADER_LINE2 ,BILL_HEADER_LINE3 ,BILL\
_HEADER_LINE4 ,BILL_HEADER_LINE5 ,BILL_HEADER_LINE6 ,BILL_HEADER_LINE7 ,BILL\
_HEADER_LINE8 ,BILL_HEADER_LINE9 ,BILL_HEADER_LINE10 ,BILL_HEADER_LINE11 ,BI\
LL_HEADER_LINE12 ,BILL_HEADER_LINE13 ,BILL_HEADER_LINE14 ,BILL_FOOTER_LINE1 \
,BILL_FOOTER_LINE2 ,BILL_FOOTER_LINE3 ,BILL_FOOTER_LINE4 ,BILL_CREDIT_FOOTER\
_LINE1 ,BILL_CREDIT_FOOTER_LINE2 ,BILL_CREDIT_FOOTER_LINE3 ,BILL_CREDIT_FOOT\
ER_LINE4 ,bill_ins_footer_line1 ,bill_ins_footer_line2 ,bill_ins_footer_line\
3 ,bill_ins_footer_line4 ,CR_ADDL_ID_IN_FTR_YN ,PRINT_INS_ADDL_ID_IN_FTR_YN \
into :b0,:b1,:b2,:b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,:\
b16,:b17,:b18,:b19,:b20,:b21,:b22,:b23,:b24");
    sqlstm.stmt = ",:b25,:b26,:b27,:b28,:b29,:b30,:b31,:b32,:b33,:b34,:b35,:\
b36,:b37,:b38,:b39,:b40,:b41  from BL_BILL_HDR_FTR_FORMAT where (Operating_Fac\
ility_Id=:b42 and UPPER(NVL(LANGUAGE_ID,'en'))=UPPER('en'))";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )11023;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&original_text;
    sqlstm.sqhstl[0] = (unsigned int  )103;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&copy_text;
    sqlstm.sqhstl[1] = (unsigned int  )103;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&bill_title_line1;
    sqlstm.sqhstl[2] = (unsigned int  )103;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqhstv[3] = (         void  *)&bill_title_line2;
    sqlstm.sqhstl[3] = (unsigned int  )103;
    sqlstm.sqhsts[3] = (         int  )0;
    sqlstm.sqindv[3] = (         void  *)0;
    sqlstm.sqinds[3] = (         int  )0;
    sqlstm.sqharm[3] = (unsigned int  )0;
    sqlstm.sqadto[3] = (unsigned short )0;
    sqlstm.sqtdso[3] = (unsigned short )0;
    sqlstm.sqhstv[4] = (         void  *)&bill_title_line3;
    sqlstm.sqhstl[4] = (unsigned int  )103;
    sqlstm.sqhsts[4] = (         int  )0;
    sqlstm.sqindv[4] = (         void  *)0;
    sqlstm.sqinds[4] = (         int  )0;
    sqlstm.sqharm[4] = (unsigned int  )0;
    sqlstm.sqadto[4] = (unsigned short )0;
    sqlstm.sqtdso[4] = (unsigned short )0;
    sqlstm.sqhstv[5] = (         void  *)&bill_title_line4;
    sqlstm.sqhstl[5] = (unsigned int  )103;
    sqlstm.sqhsts[5] = (         int  )0;
    sqlstm.sqindv[5] = (         void  *)0;
    sqlstm.sqinds[5] = (         int  )0;
    sqlstm.sqharm[5] = (unsigned int  )0;
    sqlstm.sqadto[5] = (unsigned short )0;
    sqlstm.sqtdso[5] = (unsigned short )0;
    sqlstm.sqhstv[6] = (         void  *)&op_cash_bill_title_w_rcpt;
    sqlstm.sqhstl[6] = (unsigned int  )103;
    sqlstm.sqhsts[6] = (         int  )0;
    sqlstm.sqindv[6] = (         void  *)0;
    sqlstm.sqinds[6] = (         int  )0;
    sqlstm.sqharm[6] = (unsigned int  )0;
    sqlstm.sqadto[6] = (unsigned short )0;
    sqlstm.sqtdso[6] = (unsigned short )0;
    sqlstm.sqhstv[7] = (         void  *)&op_cash_bill_title_wo_rcpt;
    sqlstm.sqhstl[7] = (unsigned int  )103;
    sqlstm.sqhsts[7] = (         int  )0;
    sqlstm.sqindv[7] = (         void  *)0;
    sqlstm.sqinds[7] = (         int  )0;
    sqlstm.sqharm[7] = (unsigned int  )0;
    sqlstm.sqadto[7] = (unsigned short )0;
    sqlstm.sqtdso[7] = (unsigned short )0;
    sqlstm.sqhstv[8] = (         void  *)&op_credit_bill_title;
    sqlstm.sqhstl[8] = (unsigned int  )103;
    sqlstm.sqhsts[8] = (         int  )0;
    sqlstm.sqindv[8] = (         void  *)0;
    sqlstm.sqinds[8] = (         int  )0;
    sqlstm.sqharm[8] = (unsigned int  )0;
    sqlstm.sqadto[8] = (unsigned short )0;
    sqlstm.sqtdso[8] = (unsigned short )0;
    sqlstm.sqhstv[9] = (         void  *)&ip_cash_bill_title_w_rcpt;
    sqlstm.sqhstl[9] = (unsigned int  )103;
    sqlstm.sqhsts[9] = (         int  )0;
    sqlstm.sqindv[9] = (         void  *)0;
    sqlstm.sqinds[9] = (         int  )0;
    sqlstm.sqharm[9] = (unsigned int  )0;
    sqlstm.sqadto[9] = (unsigned short )0;
    sqlstm.sqtdso[9] = (unsigned short )0;
    sqlstm.sqhstv[10] = (         void  *)&ip_cash_bill_title_wo_rcpt;
    sqlstm.sqhstl[10] = (unsigned int  )103;
    sqlstm.sqhsts[10] = (         int  )0;
    sqlstm.sqindv[10] = (         void  *)0;
    sqlstm.sqinds[10] = (         int  )0;
    sqlstm.sqharm[10] = (unsigned int  )0;
    sqlstm.sqadto[10] = (unsigned short )0;
    sqlstm.sqtdso[10] = (unsigned short )0;
    sqlstm.sqhstv[11] = (         void  *)&ip_credit_bill_title;
    sqlstm.sqhstl[11] = (unsigned int  )103;
    sqlstm.sqhsts[11] = (         int  )0;
    sqlstm.sqindv[11] = (         void  *)0;
    sqlstm.sqinds[11] = (         int  )0;
    sqlstm.sqharm[11] = (unsigned int  )0;
    sqlstm.sqadto[11] = (unsigned short )0;
    sqlstm.sqtdso[11] = (unsigned short )0;
    sqlstm.sqhstv[12] = (         void  *)&cash_bill_title_addl_line;
    sqlstm.sqhstl[12] = (unsigned int  )103;
    sqlstm.sqhsts[12] = (         int  )0;
    sqlstm.sqindv[12] = (         void  *)0;
    sqlstm.sqinds[12] = (         int  )0;
    sqlstm.sqharm[12] = (unsigned int  )0;
    sqlstm.sqadto[12] = (unsigned short )0;
    sqlstm.sqtdso[12] = (unsigned short )0;
    sqlstm.sqhstv[13] = (         void  *)&credit_bill_title_addl_line;
    sqlstm.sqhstl[13] = (unsigned int  )103;
    sqlstm.sqhsts[13] = (         int  )0;
    sqlstm.sqindv[13] = (         void  *)0;
    sqlstm.sqinds[13] = (         int  )0;
    sqlstm.sqharm[13] = (unsigned int  )0;
    sqlstm.sqadto[13] = (unsigned short )0;
    sqlstm.sqtdso[13] = (unsigned short )0;
    sqlstm.sqhstv[14] = (         void  *)&bl_header_line_01;
    sqlstm.sqhstl[14] = (unsigned int  )103;
    sqlstm.sqhsts[14] = (         int  )0;
    sqlstm.sqindv[14] = (         void  *)0;
    sqlstm.sqinds[14] = (         int  )0;
    sqlstm.sqharm[14] = (unsigned int  )0;
    sqlstm.sqadto[14] = (unsigned short )0;
    sqlstm.sqtdso[14] = (unsigned short )0;
    sqlstm.sqhstv[15] = (         void  *)&bl_header_line_02;
    sqlstm.sqhstl[15] = (unsigned int  )103;
    sqlstm.sqhsts[15] = (         int  )0;
    sqlstm.sqindv[15] = (         void  *)0;
    sqlstm.sqinds[15] = (         int  )0;
    sqlstm.sqharm[15] = (unsigned int  )0;
    sqlstm.sqadto[15] = (unsigned short )0;
    sqlstm.sqtdso[15] = (unsigned short )0;
    sqlstm.sqhstv[16] = (         void  *)&bl_header_line_03;
    sqlstm.sqhstl[16] = (unsigned int  )103;
    sqlstm.sqhsts[16] = (         int  )0;
    sqlstm.sqindv[16] = (         void  *)0;
    sqlstm.sqinds[16] = (         int  )0;
    sqlstm.sqharm[16] = (unsigned int  )0;
    sqlstm.sqadto[16] = (unsigned short )0;
    sqlstm.sqtdso[16] = (unsigned short )0;
    sqlstm.sqhstv[17] = (         void  *)&bl_header_line_04;
    sqlstm.sqhstl[17] = (unsigned int  )103;
    sqlstm.sqhsts[17] = (         int  )0;
    sqlstm.sqindv[17] = (         void  *)0;
    sqlstm.sqinds[17] = (         int  )0;
    sqlstm.sqharm[17] = (unsigned int  )0;
    sqlstm.sqadto[17] = (unsigned short )0;
    sqlstm.sqtdso[17] = (unsigned short )0;
    sqlstm.sqhstv[18] = (         void  *)&bl_header_line_05;
    sqlstm.sqhstl[18] = (unsigned int  )103;
    sqlstm.sqhsts[18] = (         int  )0;
    sqlstm.sqindv[18] = (         void  *)0;
    sqlstm.sqinds[18] = (         int  )0;
    sqlstm.sqharm[18] = (unsigned int  )0;
    sqlstm.sqadto[18] = (unsigned short )0;
    sqlstm.sqtdso[18] = (unsigned short )0;
    sqlstm.sqhstv[19] = (         void  *)&bl_header_line_06;
    sqlstm.sqhstl[19] = (unsigned int  )103;
    sqlstm.sqhsts[19] = (         int  )0;
    sqlstm.sqindv[19] = (         void  *)0;
    sqlstm.sqinds[19] = (         int  )0;
    sqlstm.sqharm[19] = (unsigned int  )0;
    sqlstm.sqadto[19] = (unsigned short )0;
    sqlstm.sqtdso[19] = (unsigned short )0;
    sqlstm.sqhstv[20] = (         void  *)&bl_header_line_07;
    sqlstm.sqhstl[20] = (unsigned int  )103;
    sqlstm.sqhsts[20] = (         int  )0;
    sqlstm.sqindv[20] = (         void  *)0;
    sqlstm.sqinds[20] = (         int  )0;
    sqlstm.sqharm[20] = (unsigned int  )0;
    sqlstm.sqadto[20] = (unsigned short )0;
    sqlstm.sqtdso[20] = (unsigned short )0;
    sqlstm.sqhstv[21] = (         void  *)&bl_header_line_08;
    sqlstm.sqhstl[21] = (unsigned int  )103;
    sqlstm.sqhsts[21] = (         int  )0;
    sqlstm.sqindv[21] = (         void  *)0;
    sqlstm.sqinds[21] = (         int  )0;
    sqlstm.sqharm[21] = (unsigned int  )0;
    sqlstm.sqadto[21] = (unsigned short )0;
    sqlstm.sqtdso[21] = (unsigned short )0;
    sqlstm.sqhstv[22] = (         void  *)&bl_header_line_09;
    sqlstm.sqhstl[22] = (unsigned int  )103;
    sqlstm.sqhsts[22] = (         int  )0;
    sqlstm.sqindv[22] = (         void  *)0;
    sqlstm.sqinds[22] = (         int  )0;
    sqlstm.sqharm[22] = (unsigned int  )0;
    sqlstm.sqadto[22] = (unsigned short )0;
    sqlstm.sqtdso[22] = (unsigned short )0;
    sqlstm.sqhstv[23] = (         void  *)&bl_header_line_10;
    sqlstm.sqhstl[23] = (unsigned int  )103;
    sqlstm.sqhsts[23] = (         int  )0;
    sqlstm.sqindv[23] = (         void  *)0;
    sqlstm.sqinds[23] = (         int  )0;
    sqlstm.sqharm[23] = (unsigned int  )0;
    sqlstm.sqadto[23] = (unsigned short )0;
    sqlstm.sqtdso[23] = (unsigned short )0;
    sqlstm.sqhstv[24] = (         void  *)&bl_header_line_11;
    sqlstm.sqhstl[24] = (unsigned int  )103;
    sqlstm.sqhsts[24] = (         int  )0;
    sqlstm.sqindv[24] = (         void  *)0;
    sqlstm.sqinds[24] = (         int  )0;
    sqlstm.sqharm[24] = (unsigned int  )0;
    sqlstm.sqadto[24] = (unsigned short )0;
    sqlstm.sqtdso[24] = (unsigned short )0;
    sqlstm.sqhstv[25] = (         void  *)&bl_header_line_12;
    sqlstm.sqhstl[25] = (unsigned int  )103;
    sqlstm.sqhsts[25] = (         int  )0;
    sqlstm.sqindv[25] = (         void  *)0;
    sqlstm.sqinds[25] = (         int  )0;
    sqlstm.sqharm[25] = (unsigned int  )0;
    sqlstm.sqadto[25] = (unsigned short )0;
    sqlstm.sqtdso[25] = (unsigned short )0;
    sqlstm.sqhstv[26] = (         void  *)&bl_header_line_13;
    sqlstm.sqhstl[26] = (unsigned int  )103;
    sqlstm.sqhsts[26] = (         int  )0;
    sqlstm.sqindv[26] = (         void  *)0;
    sqlstm.sqinds[26] = (         int  )0;
    sqlstm.sqharm[26] = (unsigned int  )0;
    sqlstm.sqadto[26] = (unsigned short )0;
    sqlstm.sqtdso[26] = (unsigned short )0;
    sqlstm.sqhstv[27] = (         void  *)&bl_header_line_14;
    sqlstm.sqhstl[27] = (unsigned int  )103;
    sqlstm.sqhsts[27] = (         int  )0;
    sqlstm.sqindv[27] = (         void  *)0;
    sqlstm.sqinds[27] = (         int  )0;
    sqlstm.sqharm[27] = (unsigned int  )0;
    sqlstm.sqadto[27] = (unsigned short )0;
    sqlstm.sqtdso[27] = (unsigned short )0;
    sqlstm.sqhstv[28] = (         void  *)&bl_footer_line_01;
    sqlstm.sqhstl[28] = (unsigned int  )103;
    sqlstm.sqhsts[28] = (         int  )0;
    sqlstm.sqindv[28] = (         void  *)0;
    sqlstm.sqinds[28] = (         int  )0;
    sqlstm.sqharm[28] = (unsigned int  )0;
    sqlstm.sqadto[28] = (unsigned short )0;
    sqlstm.sqtdso[28] = (unsigned short )0;
    sqlstm.sqhstv[29] = (         void  *)&bl_footer_line_02;
    sqlstm.sqhstl[29] = (unsigned int  )103;
    sqlstm.sqhsts[29] = (         int  )0;
    sqlstm.sqindv[29] = (         void  *)0;
    sqlstm.sqinds[29] = (         int  )0;
    sqlstm.sqharm[29] = (unsigned int  )0;
    sqlstm.sqadto[29] = (unsigned short )0;
    sqlstm.sqtdso[29] = (unsigned short )0;
    sqlstm.sqhstv[30] = (         void  *)&bl_footer_line_03;
    sqlstm.sqhstl[30] = (unsigned int  )103;
    sqlstm.sqhsts[30] = (         int  )0;
    sqlstm.sqindv[30] = (         void  *)0;
    sqlstm.sqinds[30] = (         int  )0;
    sqlstm.sqharm[30] = (unsigned int  )0;
    sqlstm.sqadto[30] = (unsigned short )0;
    sqlstm.sqtdso[30] = (unsigned short )0;
    sqlstm.sqhstv[31] = (         void  *)&bl_footer_line_04;
    sqlstm.sqhstl[31] = (unsigned int  )103;
    sqlstm.sqhsts[31] = (         int  )0;
    sqlstm.sqindv[31] = (         void  *)0;
    sqlstm.sqinds[31] = (         int  )0;
    sqlstm.sqharm[31] = (unsigned int  )0;
    sqlstm.sqadto[31] = (unsigned short )0;
    sqlstm.sqtdso[31] = (unsigned short )0;
    sqlstm.sqhstv[32] = (         void  *)&bill_credit_footer_line1;
    sqlstm.sqhstl[32] = (unsigned int  )103;
    sqlstm.sqhsts[32] = (         int  )0;
    sqlstm.sqindv[32] = (         void  *)0;
    sqlstm.sqinds[32] = (         int  )0;
    sqlstm.sqharm[32] = (unsigned int  )0;
    sqlstm.sqadto[32] = (unsigned short )0;
    sqlstm.sqtdso[32] = (unsigned short )0;
    sqlstm.sqhstv[33] = (         void  *)&bill_credit_footer_line2;
    sqlstm.sqhstl[33] = (unsigned int  )103;
    sqlstm.sqhsts[33] = (         int  )0;
    sqlstm.sqindv[33] = (         void  *)0;
    sqlstm.sqinds[33] = (         int  )0;
    sqlstm.sqharm[33] = (unsigned int  )0;
    sqlstm.sqadto[33] = (unsigned short )0;
    sqlstm.sqtdso[33] = (unsigned short )0;
    sqlstm.sqhstv[34] = (         void  *)&bill_credit_footer_line3;
    sqlstm.sqhstl[34] = (unsigned int  )103;
    sqlstm.sqhsts[34] = (         int  )0;
    sqlstm.sqindv[34] = (         void  *)0;
    sqlstm.sqinds[34] = (         int  )0;
    sqlstm.sqharm[34] = (unsigned int  )0;
    sqlstm.sqadto[34] = (unsigned short )0;
    sqlstm.sqtdso[34] = (unsigned short )0;
    sqlstm.sqhstv[35] = (         void  *)&bill_credit_footer_line4;
    sqlstm.sqhstl[35] = (unsigned int  )103;
    sqlstm.sqhsts[35] = (         int  )0;
    sqlstm.sqindv[35] = (         void  *)0;
    sqlstm.sqinds[35] = (         int  )0;
    sqlstm.sqharm[35] = (unsigned int  )0;
    sqlstm.sqadto[35] = (unsigned short )0;
    sqlstm.sqtdso[35] = (unsigned short )0;
    sqlstm.sqhstv[36] = (         void  *)&bill_ins_footer_line1;
    sqlstm.sqhstl[36] = (unsigned int  )103;
    sqlstm.sqhsts[36] = (         int  )0;
    sqlstm.sqindv[36] = (         void  *)0;
    sqlstm.sqinds[36] = (         int  )0;
    sqlstm.sqharm[36] = (unsigned int  )0;
    sqlstm.sqadto[36] = (unsigned short )0;
    sqlstm.sqtdso[36] = (unsigned short )0;
    sqlstm.sqhstv[37] = (         void  *)&bill_ins_footer_line2;
    sqlstm.sqhstl[37] = (unsigned int  )103;
    sqlstm.sqhsts[37] = (         int  )0;
    sqlstm.sqindv[37] = (         void  *)0;
    sqlstm.sqinds[37] = (         int  )0;
    sqlstm.sqharm[37] = (unsigned int  )0;
    sqlstm.sqadto[37] = (unsigned short )0;
    sqlstm.sqtdso[37] = (unsigned short )0;
    sqlstm.sqhstv[38] = (         void  *)&bill_ins_footer_line3;
    sqlstm.sqhstl[38] = (unsigned int  )103;
    sqlstm.sqhsts[38] = (         int  )0;
    sqlstm.sqindv[38] = (         void  *)0;
    sqlstm.sqinds[38] = (         int  )0;
    sqlstm.sqharm[38] = (unsigned int  )0;
    sqlstm.sqadto[38] = (unsigned short )0;
    sqlstm.sqtdso[38] = (unsigned short )0;
    sqlstm.sqhstv[39] = (         void  *)&bill_ins_footer_line4;
    sqlstm.sqhstl[39] = (unsigned int  )103;
    sqlstm.sqhsts[39] = (         int  )0;
    sqlstm.sqindv[39] = (         void  *)0;
    sqlstm.sqinds[39] = (         int  )0;
    sqlstm.sqharm[39] = (unsigned int  )0;
    sqlstm.sqadto[39] = (unsigned short )0;
    sqlstm.sqtdso[39] = (unsigned short )0;
    sqlstm.sqhstv[40] = (         void  *)&cr_addl_id_in_ftr_yn;
    sqlstm.sqhstl[40] = (unsigned int  )4;
    sqlstm.sqhsts[40] = (         int  )0;
    sqlstm.sqindv[40] = (         void  *)0;
    sqlstm.sqinds[40] = (         int  )0;
    sqlstm.sqharm[40] = (unsigned int  )0;
    sqlstm.sqadto[40] = (unsigned short )0;
    sqlstm.sqtdso[40] = (unsigned short )0;
    sqlstm.sqhstv[41] = (         void  *)&print_ins_addl_id_in_ftr_yn;
    sqlstm.sqhstl[41] = (unsigned int  )4;
    sqlstm.sqhsts[41] = (         int  )0;
    sqlstm.sqindv[41] = (         void  *)0;
    sqlstm.sqinds[41] = (         int  )0;
    sqlstm.sqharm[41] = (unsigned int  )0;
    sqlstm.sqadto[41] = (unsigned short )0;
    sqlstm.sqtdso[41] = (unsigned short )0;
    sqlstm.sqhstv[42] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[42] = (unsigned int  )5;
    sqlstm.sqhsts[42] = (         int  )0;
    sqlstm.sqindv[42] = (         void  *)0;
    sqlstm.sqinds[42] = (         int  )0;
    sqlstm.sqharm[42] = (unsigned int  )0;
    sqlstm.sqadto[42] = (unsigned short )0;
    sqlstm.sqtdso[42] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			}
		   }
		  else
		   {
			/* EXEC SQL SELECT IP_ORIGINAL_TEXT,			
						IP_COPY_TEXT,			
						IP_BILL_TITLE_LINE1,		
						IP_BILL_TITLE_LINE2,		
						IP_BILL_TITLE_LINE3,		
						IP_BILL_TITLE_LINE4,		
						OP_CASH_BILL_TITLE_W_RCPT,	
						OP_CASH_BILL_TITLE_WO_RCPT,	
						OP_CREDIT_BILL_TITLE,		
						IP_CASH_INT_BILL_TITLE,//IP_CASH_BILL_TITLE_W_RCPT,	ADDED FOR SCRUM REMERGING		 
						IP_CASH_INT_BILL_TITLE,//IP_CASH_BILL_TITLE_WO_RCPT, ADDED FOR SCRUM REMERGING		 	
						IP_CREDIT_INT_BILL_TITLE,//IP_CREDIT_BILL_TITLE, ADDED FOR SCRUM REMERGING		 
						IP_CASH_BILL_TITLE_ADDL_LINE,	
						IP_CREDIT_BILL_TITLE_ADDL_LINE,	
						IP_BILL_HEADER_LINE1,		
						IP_BILL_HEADER_LINE2,		
						IP_BILL_HEADER_LINE3,		
						IP_BILL_HEADER_LINE4,		
						IP_BILL_HEADER_LINE5,		
						IP_BILL_HEADER_LINE6,		
						IP_BILL_HEADER_LINE7,		
						IP_BILL_HEADER_LINE8,		
						IP_BILL_HEADER_LINE9,		
						IP_BILL_HEADER_LINE10,		
						IP_BILL_HEADER_LINE11,		
						IP_BILL_HEADER_LINE12,		
						IP_BILL_HEADER_LINE13,		
						IP_BILL_HEADER_LINE14,		
						IP_BILL_FOOTER_LINE1,		
						IP_BILL_FOOTER_LINE2,		
						IP_BILL_FOOTER_LINE3,		
						IP_BILL_FOOTER_LINE4,		
						IP_BILL_CREDIT_FOOTER_LINE1,	
						IP_BILL_CREDIT_FOOTER_LINE2,	
						IP_BILL_CREDIT_FOOTER_LINE3,	
						IP_BILL_CREDIT_FOOTER_LINE4,
						ip_bill_ins_footer_line1,
						ip_bill_ins_footer_line2,
						ip_bill_ins_footer_line3,
						ip_bill_ins_footer_line4,
						IP_CR_ADDL_ID_IN_FTR_YN,
						IP_INS_ADDL_ID_IN_FTR_YN  
	            into	:original_text,
						:copy_text,			
						:bill_title_line1,		
						:bill_title_line2,		
						:bill_title_line3,		
						:bill_title_line4,		
						:op_cash_bill_title_w_rcpt,	
						:op_cash_bill_title_wo_rcpt,	
						:op_credit_bill_title,		
						:ip_cash_bill_title_w_rcpt,	
						:ip_cash_bill_title_wo_rcpt,	
						:ip_credit_bill_title,		
						:cash_bill_title_addl_line,	
						:credit_bill_title_addl_line,
						 :bl_header_line_01,
						 :bl_header_line_02,
						 :bl_header_line_03,
						 :bl_header_line_04,
						 :bl_header_line_05,
						 :bl_header_line_06,
						 :bl_header_line_07,
						 :bl_header_line_08,
						 :bl_header_line_09,
						 :bl_header_line_10,
						 :bl_header_line_11,
						 :bl_header_line_12,
						 :bl_header_line_13,
						 :bl_header_line_14,
						 :bl_footer_line_01,
						 :bl_footer_line_02,
						 :bl_footer_line_03,
						 :bl_footer_line_04,
						 :bill_credit_footer_line1,	
						 :bill_credit_footer_line2,
						 :bill_credit_footer_line3,
						 :bill_credit_footer_line4,
						 :bill_ins_footer_line1,
						 :bill_ins_footer_line2,
						 :bill_ins_footer_line3,
						 :bill_ins_footer_line4,
						 :ip_cr_addl_id_in_ftr_yn,
						 :ip_ins_addl_id_in_ftr_yn 
                FROM BL_BILL_HDR_FTR_FORMAT
		        WHERE Operating_Facility_Id = :nd_facility_id
				AND   UPPER(NVL(LANGUAGE_ID,'en'))=UPPER(:nd_lang_id); */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlbuft((void **)0, 
     "select IP_ORIGINAL_TEXT ,IP_COPY_TEXT ,IP_BILL_TITLE_LINE1 ,IP_BILL_TI\
TLE_LINE2 ,IP_BILL_TITLE_LINE3 ,IP_BILL_TITLE_LINE4 ,OP_CASH_BILL_TITLE_W_RC\
PT ,OP_CASH_BILL_TITLE_WO_RCPT ,OP_CREDIT_BILL_TITLE ,IP_CASH_INT_BILL_TITLE\
 ,IP_CASH_INT_BILL_TITLE ,IP_CREDIT_INT_BILL_TITLE ,IP_CASH_BILL_TITLE_ADDL_\
LINE ,IP_CREDIT_BILL_TITLE_ADDL_LINE ,IP_BILL_HEADER_LINE1 ,IP_BILL_HEADER_L\
INE2 ,IP_BILL_HEADER_LINE3 ,IP_BILL_HEADER_LINE4 ,IP_BILL_HEADER_LINE5 ,IP_B\
ILL_HEADER_LINE6 ,IP_BILL_HEADER_LINE7 ,IP_BILL_HEADER_LINE8 ,IP_BILL_HEADER\
_LINE9 ,IP_BILL_HEADER_LINE10 ,IP_BILL_HEADER_LINE11 ,IP_BILL_HEADER_LINE12 \
,IP_BILL_HEADER_LINE13 ,IP_BILL_HEADER_LINE14 ,IP_BILL_FOOTER_LINE1 ,IP_BILL\
_FOOTER_LINE2 ,IP_BILL_FOOTER_LINE3 ,IP_BILL_FOOTER_LINE4 ,IP_BILL_CREDIT_FO\
OTER_LINE1 ,IP_BILL_CREDIT_FOOTER_LINE2 ,IP_BILL_CREDIT_FOOTER_LINE3 ,IP_BIL\
L_CREDIT_FOOTER_LINE4 ,ip_bill_ins_footer_line1 ,ip_bill_ins_footer_line2 ,i\
p_bill_ins_footer_line3 ,ip_bill_ins_footer_line4 ,IP_CR_ADDL_ID_IN_FTR_YN ,\
IP_INS_ADDL_ID_IN_FTR_YN into :b0,:b1,:b2,");
   sqlstm.stmt = ":b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b15,\
:b16,:b17,:b18,:b19,:b20,:b21,:b22,:b23,:b24,:b25,:b26,:b27,:b28,:b29,:b30,:b3\
1,:b32,:b33,:b34,:b35,:b36,:b37,:b38,:b39,:b40,:b41  from BL_BILL_HDR_FTR_FORM\
AT where (Operating_Facility_Id=:b42 and UPPER(NVL(LANGUAGE_ID,'en'))=UPPER(:b\
43))";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11210;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&original_text;
   sqlstm.sqhstl[0] = (unsigned int  )103;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&copy_text;
   sqlstm.sqhstl[1] = (unsigned int  )103;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&bill_title_line1;
   sqlstm.sqhstl[2] = (unsigned int  )103;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&bill_title_line2;
   sqlstm.sqhstl[3] = (unsigned int  )103;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqhstv[4] = (         void  *)&bill_title_line3;
   sqlstm.sqhstl[4] = (unsigned int  )103;
   sqlstm.sqhsts[4] = (         int  )0;
   sqlstm.sqindv[4] = (         void  *)0;
   sqlstm.sqinds[4] = (         int  )0;
   sqlstm.sqharm[4] = (unsigned int  )0;
   sqlstm.sqadto[4] = (unsigned short )0;
   sqlstm.sqtdso[4] = (unsigned short )0;
   sqlstm.sqhstv[5] = (         void  *)&bill_title_line4;
   sqlstm.sqhstl[5] = (unsigned int  )103;
   sqlstm.sqhsts[5] = (         int  )0;
   sqlstm.sqindv[5] = (         void  *)0;
   sqlstm.sqinds[5] = (         int  )0;
   sqlstm.sqharm[5] = (unsigned int  )0;
   sqlstm.sqadto[5] = (unsigned short )0;
   sqlstm.sqtdso[5] = (unsigned short )0;
   sqlstm.sqhstv[6] = (         void  *)&op_cash_bill_title_w_rcpt;
   sqlstm.sqhstl[6] = (unsigned int  )103;
   sqlstm.sqhsts[6] = (         int  )0;
   sqlstm.sqindv[6] = (         void  *)0;
   sqlstm.sqinds[6] = (         int  )0;
   sqlstm.sqharm[6] = (unsigned int  )0;
   sqlstm.sqadto[6] = (unsigned short )0;
   sqlstm.sqtdso[6] = (unsigned short )0;
   sqlstm.sqhstv[7] = (         void  *)&op_cash_bill_title_wo_rcpt;
   sqlstm.sqhstl[7] = (unsigned int  )103;
   sqlstm.sqhsts[7] = (         int  )0;
   sqlstm.sqindv[7] = (         void  *)0;
   sqlstm.sqinds[7] = (         int  )0;
   sqlstm.sqharm[7] = (unsigned int  )0;
   sqlstm.sqadto[7] = (unsigned short )0;
   sqlstm.sqtdso[7] = (unsigned short )0;
   sqlstm.sqhstv[8] = (         void  *)&op_credit_bill_title;
   sqlstm.sqhstl[8] = (unsigned int  )103;
   sqlstm.sqhsts[8] = (         int  )0;
   sqlstm.sqindv[8] = (         void  *)0;
   sqlstm.sqinds[8] = (         int  )0;
   sqlstm.sqharm[8] = (unsigned int  )0;
   sqlstm.sqadto[8] = (unsigned short )0;
   sqlstm.sqtdso[8] = (unsigned short )0;
   sqlstm.sqhstv[9] = (         void  *)&ip_cash_bill_title_w_rcpt;
   sqlstm.sqhstl[9] = (unsigned int  )103;
   sqlstm.sqhsts[9] = (         int  )0;
   sqlstm.sqindv[9] = (         void  *)0;
   sqlstm.sqinds[9] = (         int  )0;
   sqlstm.sqharm[9] = (unsigned int  )0;
   sqlstm.sqadto[9] = (unsigned short )0;
   sqlstm.sqtdso[9] = (unsigned short )0;
   sqlstm.sqhstv[10] = (         void  *)&ip_cash_bill_title_wo_rcpt;
   sqlstm.sqhstl[10] = (unsigned int  )103;
   sqlstm.sqhsts[10] = (         int  )0;
   sqlstm.sqindv[10] = (         void  *)0;
   sqlstm.sqinds[10] = (         int  )0;
   sqlstm.sqharm[10] = (unsigned int  )0;
   sqlstm.sqadto[10] = (unsigned short )0;
   sqlstm.sqtdso[10] = (unsigned short )0;
   sqlstm.sqhstv[11] = (         void  *)&ip_credit_bill_title;
   sqlstm.sqhstl[11] = (unsigned int  )103;
   sqlstm.sqhsts[11] = (         int  )0;
   sqlstm.sqindv[11] = (         void  *)0;
   sqlstm.sqinds[11] = (         int  )0;
   sqlstm.sqharm[11] = (unsigned int  )0;
   sqlstm.sqadto[11] = (unsigned short )0;
   sqlstm.sqtdso[11] = (unsigned short )0;
   sqlstm.sqhstv[12] = (         void  *)&cash_bill_title_addl_line;
   sqlstm.sqhstl[12] = (unsigned int  )103;
   sqlstm.sqhsts[12] = (         int  )0;
   sqlstm.sqindv[12] = (         void  *)0;
   sqlstm.sqinds[12] = (         int  )0;
   sqlstm.sqharm[12] = (unsigned int  )0;
   sqlstm.sqadto[12] = (unsigned short )0;
   sqlstm.sqtdso[12] = (unsigned short )0;
   sqlstm.sqhstv[13] = (         void  *)&credit_bill_title_addl_line;
   sqlstm.sqhstl[13] = (unsigned int  )103;
   sqlstm.sqhsts[13] = (         int  )0;
   sqlstm.sqindv[13] = (         void  *)0;
   sqlstm.sqinds[13] = (         int  )0;
   sqlstm.sqharm[13] = (unsigned int  )0;
   sqlstm.sqadto[13] = (unsigned short )0;
   sqlstm.sqtdso[13] = (unsigned short )0;
   sqlstm.sqhstv[14] = (         void  *)&bl_header_line_01;
   sqlstm.sqhstl[14] = (unsigned int  )103;
   sqlstm.sqhsts[14] = (         int  )0;
   sqlstm.sqindv[14] = (         void  *)0;
   sqlstm.sqinds[14] = (         int  )0;
   sqlstm.sqharm[14] = (unsigned int  )0;
   sqlstm.sqadto[14] = (unsigned short )0;
   sqlstm.sqtdso[14] = (unsigned short )0;
   sqlstm.sqhstv[15] = (         void  *)&bl_header_line_02;
   sqlstm.sqhstl[15] = (unsigned int  )103;
   sqlstm.sqhsts[15] = (         int  )0;
   sqlstm.sqindv[15] = (         void  *)0;
   sqlstm.sqinds[15] = (         int  )0;
   sqlstm.sqharm[15] = (unsigned int  )0;
   sqlstm.sqadto[15] = (unsigned short )0;
   sqlstm.sqtdso[15] = (unsigned short )0;
   sqlstm.sqhstv[16] = (         void  *)&bl_header_line_03;
   sqlstm.sqhstl[16] = (unsigned int  )103;
   sqlstm.sqhsts[16] = (         int  )0;
   sqlstm.sqindv[16] = (         void  *)0;
   sqlstm.sqinds[16] = (         int  )0;
   sqlstm.sqharm[16] = (unsigned int  )0;
   sqlstm.sqadto[16] = (unsigned short )0;
   sqlstm.sqtdso[16] = (unsigned short )0;
   sqlstm.sqhstv[17] = (         void  *)&bl_header_line_04;
   sqlstm.sqhstl[17] = (unsigned int  )103;
   sqlstm.sqhsts[17] = (         int  )0;
   sqlstm.sqindv[17] = (         void  *)0;
   sqlstm.sqinds[17] = (         int  )0;
   sqlstm.sqharm[17] = (unsigned int  )0;
   sqlstm.sqadto[17] = (unsigned short )0;
   sqlstm.sqtdso[17] = (unsigned short )0;
   sqlstm.sqhstv[18] = (         void  *)&bl_header_line_05;
   sqlstm.sqhstl[18] = (unsigned int  )103;
   sqlstm.sqhsts[18] = (         int  )0;
   sqlstm.sqindv[18] = (         void  *)0;
   sqlstm.sqinds[18] = (         int  )0;
   sqlstm.sqharm[18] = (unsigned int  )0;
   sqlstm.sqadto[18] = (unsigned short )0;
   sqlstm.sqtdso[18] = (unsigned short )0;
   sqlstm.sqhstv[19] = (         void  *)&bl_header_line_06;
   sqlstm.sqhstl[19] = (unsigned int  )103;
   sqlstm.sqhsts[19] = (         int  )0;
   sqlstm.sqindv[19] = (         void  *)0;
   sqlstm.sqinds[19] = (         int  )0;
   sqlstm.sqharm[19] = (unsigned int  )0;
   sqlstm.sqadto[19] = (unsigned short )0;
   sqlstm.sqtdso[19] = (unsigned short )0;
   sqlstm.sqhstv[20] = (         void  *)&bl_header_line_07;
   sqlstm.sqhstl[20] = (unsigned int  )103;
   sqlstm.sqhsts[20] = (         int  )0;
   sqlstm.sqindv[20] = (         void  *)0;
   sqlstm.sqinds[20] = (         int  )0;
   sqlstm.sqharm[20] = (unsigned int  )0;
   sqlstm.sqadto[20] = (unsigned short )0;
   sqlstm.sqtdso[20] = (unsigned short )0;
   sqlstm.sqhstv[21] = (         void  *)&bl_header_line_08;
   sqlstm.sqhstl[21] = (unsigned int  )103;
   sqlstm.sqhsts[21] = (         int  )0;
   sqlstm.sqindv[21] = (         void  *)0;
   sqlstm.sqinds[21] = (         int  )0;
   sqlstm.sqharm[21] = (unsigned int  )0;
   sqlstm.sqadto[21] = (unsigned short )0;
   sqlstm.sqtdso[21] = (unsigned short )0;
   sqlstm.sqhstv[22] = (         void  *)&bl_header_line_09;
   sqlstm.sqhstl[22] = (unsigned int  )103;
   sqlstm.sqhsts[22] = (         int  )0;
   sqlstm.sqindv[22] = (         void  *)0;
   sqlstm.sqinds[22] = (         int  )0;
   sqlstm.sqharm[22] = (unsigned int  )0;
   sqlstm.sqadto[22] = (unsigned short )0;
   sqlstm.sqtdso[22] = (unsigned short )0;
   sqlstm.sqhstv[23] = (         void  *)&bl_header_line_10;
   sqlstm.sqhstl[23] = (unsigned int  )103;
   sqlstm.sqhsts[23] = (         int  )0;
   sqlstm.sqindv[23] = (         void  *)0;
   sqlstm.sqinds[23] = (         int  )0;
   sqlstm.sqharm[23] = (unsigned int  )0;
   sqlstm.sqadto[23] = (unsigned short )0;
   sqlstm.sqtdso[23] = (unsigned short )0;
   sqlstm.sqhstv[24] = (         void  *)&bl_header_line_11;
   sqlstm.sqhstl[24] = (unsigned int  )103;
   sqlstm.sqhsts[24] = (         int  )0;
   sqlstm.sqindv[24] = (         void  *)0;
   sqlstm.sqinds[24] = (         int  )0;
   sqlstm.sqharm[24] = (unsigned int  )0;
   sqlstm.sqadto[24] = (unsigned short )0;
   sqlstm.sqtdso[24] = (unsigned short )0;
   sqlstm.sqhstv[25] = (         void  *)&bl_header_line_12;
   sqlstm.sqhstl[25] = (unsigned int  )103;
   sqlstm.sqhsts[25] = (         int  )0;
   sqlstm.sqindv[25] = (         void  *)0;
   sqlstm.sqinds[25] = (         int  )0;
   sqlstm.sqharm[25] = (unsigned int  )0;
   sqlstm.sqadto[25] = (unsigned short )0;
   sqlstm.sqtdso[25] = (unsigned short )0;
   sqlstm.sqhstv[26] = (         void  *)&bl_header_line_13;
   sqlstm.sqhstl[26] = (unsigned int  )103;
   sqlstm.sqhsts[26] = (         int  )0;
   sqlstm.sqindv[26] = (         void  *)0;
   sqlstm.sqinds[26] = (         int  )0;
   sqlstm.sqharm[26] = (unsigned int  )0;
   sqlstm.sqadto[26] = (unsigned short )0;
   sqlstm.sqtdso[26] = (unsigned short )0;
   sqlstm.sqhstv[27] = (         void  *)&bl_header_line_14;
   sqlstm.sqhstl[27] = (unsigned int  )103;
   sqlstm.sqhsts[27] = (         int  )0;
   sqlstm.sqindv[27] = (         void  *)0;
   sqlstm.sqinds[27] = (         int  )0;
   sqlstm.sqharm[27] = (unsigned int  )0;
   sqlstm.sqadto[27] = (unsigned short )0;
   sqlstm.sqtdso[27] = (unsigned short )0;
   sqlstm.sqhstv[28] = (         void  *)&bl_footer_line_01;
   sqlstm.sqhstl[28] = (unsigned int  )103;
   sqlstm.sqhsts[28] = (         int  )0;
   sqlstm.sqindv[28] = (         void  *)0;
   sqlstm.sqinds[28] = (         int  )0;
   sqlstm.sqharm[28] = (unsigned int  )0;
   sqlstm.sqadto[28] = (unsigned short )0;
   sqlstm.sqtdso[28] = (unsigned short )0;
   sqlstm.sqhstv[29] = (         void  *)&bl_footer_line_02;
   sqlstm.sqhstl[29] = (unsigned int  )103;
   sqlstm.sqhsts[29] = (         int  )0;
   sqlstm.sqindv[29] = (         void  *)0;
   sqlstm.sqinds[29] = (         int  )0;
   sqlstm.sqharm[29] = (unsigned int  )0;
   sqlstm.sqadto[29] = (unsigned short )0;
   sqlstm.sqtdso[29] = (unsigned short )0;
   sqlstm.sqhstv[30] = (         void  *)&bl_footer_line_03;
   sqlstm.sqhstl[30] = (unsigned int  )103;
   sqlstm.sqhsts[30] = (         int  )0;
   sqlstm.sqindv[30] = (         void  *)0;
   sqlstm.sqinds[30] = (         int  )0;
   sqlstm.sqharm[30] = (unsigned int  )0;
   sqlstm.sqadto[30] = (unsigned short )0;
   sqlstm.sqtdso[30] = (unsigned short )0;
   sqlstm.sqhstv[31] = (         void  *)&bl_footer_line_04;
   sqlstm.sqhstl[31] = (unsigned int  )103;
   sqlstm.sqhsts[31] = (         int  )0;
   sqlstm.sqindv[31] = (         void  *)0;
   sqlstm.sqinds[31] = (         int  )0;
   sqlstm.sqharm[31] = (unsigned int  )0;
   sqlstm.sqadto[31] = (unsigned short )0;
   sqlstm.sqtdso[31] = (unsigned short )0;
   sqlstm.sqhstv[32] = (         void  *)&bill_credit_footer_line1;
   sqlstm.sqhstl[32] = (unsigned int  )103;
   sqlstm.sqhsts[32] = (         int  )0;
   sqlstm.sqindv[32] = (         void  *)0;
   sqlstm.sqinds[32] = (         int  )0;
   sqlstm.sqharm[32] = (unsigned int  )0;
   sqlstm.sqadto[32] = (unsigned short )0;
   sqlstm.sqtdso[32] = (unsigned short )0;
   sqlstm.sqhstv[33] = (         void  *)&bill_credit_footer_line2;
   sqlstm.sqhstl[33] = (unsigned int  )103;
   sqlstm.sqhsts[33] = (         int  )0;
   sqlstm.sqindv[33] = (         void  *)0;
   sqlstm.sqinds[33] = (         int  )0;
   sqlstm.sqharm[33] = (unsigned int  )0;
   sqlstm.sqadto[33] = (unsigned short )0;
   sqlstm.sqtdso[33] = (unsigned short )0;
   sqlstm.sqhstv[34] = (         void  *)&bill_credit_footer_line3;
   sqlstm.sqhstl[34] = (unsigned int  )103;
   sqlstm.sqhsts[34] = (         int  )0;
   sqlstm.sqindv[34] = (         void  *)0;
   sqlstm.sqinds[34] = (         int  )0;
   sqlstm.sqharm[34] = (unsigned int  )0;
   sqlstm.sqadto[34] = (unsigned short )0;
   sqlstm.sqtdso[34] = (unsigned short )0;
   sqlstm.sqhstv[35] = (         void  *)&bill_credit_footer_line4;
   sqlstm.sqhstl[35] = (unsigned int  )103;
   sqlstm.sqhsts[35] = (         int  )0;
   sqlstm.sqindv[35] = (         void  *)0;
   sqlstm.sqinds[35] = (         int  )0;
   sqlstm.sqharm[35] = (unsigned int  )0;
   sqlstm.sqadto[35] = (unsigned short )0;
   sqlstm.sqtdso[35] = (unsigned short )0;
   sqlstm.sqhstv[36] = (         void  *)&bill_ins_footer_line1;
   sqlstm.sqhstl[36] = (unsigned int  )103;
   sqlstm.sqhsts[36] = (         int  )0;
   sqlstm.sqindv[36] = (         void  *)0;
   sqlstm.sqinds[36] = (         int  )0;
   sqlstm.sqharm[36] = (unsigned int  )0;
   sqlstm.sqadto[36] = (unsigned short )0;
   sqlstm.sqtdso[36] = (unsigned short )0;
   sqlstm.sqhstv[37] = (         void  *)&bill_ins_footer_line2;
   sqlstm.sqhstl[37] = (unsigned int  )103;
   sqlstm.sqhsts[37] = (         int  )0;
   sqlstm.sqindv[37] = (         void  *)0;
   sqlstm.sqinds[37] = (         int  )0;
   sqlstm.sqharm[37] = (unsigned int  )0;
   sqlstm.sqadto[37] = (unsigned short )0;
   sqlstm.sqtdso[37] = (unsigned short )0;
   sqlstm.sqhstv[38] = (         void  *)&bill_ins_footer_line3;
   sqlstm.sqhstl[38] = (unsigned int  )103;
   sqlstm.sqhsts[38] = (         int  )0;
   sqlstm.sqindv[38] = (         void  *)0;
   sqlstm.sqinds[38] = (         int  )0;
   sqlstm.sqharm[38] = (unsigned int  )0;
   sqlstm.sqadto[38] = (unsigned short )0;
   sqlstm.sqtdso[38] = (unsigned short )0;
   sqlstm.sqhstv[39] = (         void  *)&bill_ins_footer_line4;
   sqlstm.sqhstl[39] = (unsigned int  )103;
   sqlstm.sqhsts[39] = (         int  )0;
   sqlstm.sqindv[39] = (         void  *)0;
   sqlstm.sqinds[39] = (         int  )0;
   sqlstm.sqharm[39] = (unsigned int  )0;
   sqlstm.sqadto[39] = (unsigned short )0;
   sqlstm.sqtdso[39] = (unsigned short )0;
   sqlstm.sqhstv[40] = (         void  *)&ip_cr_addl_id_in_ftr_yn;
   sqlstm.sqhstl[40] = (unsigned int  )4;
   sqlstm.sqhsts[40] = (         int  )0;
   sqlstm.sqindv[40] = (         void  *)0;
   sqlstm.sqinds[40] = (         int  )0;
   sqlstm.sqharm[40] = (unsigned int  )0;
   sqlstm.sqadto[40] = (unsigned short )0;
   sqlstm.sqtdso[40] = (unsigned short )0;
   sqlstm.sqhstv[41] = (         void  *)&ip_ins_addl_id_in_ftr_yn;
   sqlstm.sqhstl[41] = (unsigned int  )4;
   sqlstm.sqhsts[41] = (         int  )0;
   sqlstm.sqindv[41] = (         void  *)0;
   sqlstm.sqinds[41] = (         int  )0;
   sqlstm.sqharm[41] = (unsigned int  )0;
   sqlstm.sqadto[41] = (unsigned short )0;
   sqlstm.sqtdso[41] = (unsigned short )0;
   sqlstm.sqhstv[42] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[42] = (unsigned int  )5;
   sqlstm.sqhsts[42] = (         int  )0;
   sqlstm.sqindv[42] = (         void  *)0;
   sqlstm.sqinds[42] = (         int  )0;
   sqlstm.sqharm[42] = (unsigned int  )0;
   sqlstm.sqadto[42] = (unsigned short )0;
   sqlstm.sqtdso[42] = (unsigned short )0;
   sqlstm.sqhstv[43] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[43] = (unsigned int  )6;
   sqlstm.sqhsts[43] = (         int  )0;
   sqlstm.sqindv[43] = (         void  *)0;
   sqlstm.sqinds[43] = (         int  )0;
   sqlstm.sqharm[43] = (unsigned int  )0;
   sqlstm.sqadto[43] = (unsigned short )0;
   sqlstm.sqtdso[43] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				if(NODATAFOUND) 
				{
				  /* EXEC SQL SELECT IP_ORIGINAL_TEXT,			
							IP_COPY_TEXT,			
							IP_BILL_TITLE_LINE1,		
							IP_BILL_TITLE_LINE2,		
							IP_BILL_TITLE_LINE3,		
							IP_BILL_TITLE_LINE4,		
							OP_CASH_BILL_TITLE_W_RCPT,	
							OP_CASH_BILL_TITLE_WO_RCPT,	
							OP_CREDIT_BILL_TITLE,		
							IP_CASH_INT_BILL_TITLE, //IP_CASH_BILL_TITLE_W_RCPT, ADDED FOR SCRUM REMERGING			
							IP_CASH_INT_BILL_TITLE, //IP_CASH_BILL_TITLE_WO_RCPT, ADDED FOR SCRUM REMERGING			
							IP_CREDIT_INT_BILL_TITLE,//IP_CREDIT_BILL_TITLE, ADDED FOR SCRUM REMERGING		
							IP_CASH_BILL_TITLE_ADDL_LINE,	
							IP_CREDIT_BILL_TITLE_ADDL_LINE,	
							IP_BILL_HEADER_LINE1,		
							IP_BILL_HEADER_LINE2,		
							IP_BILL_HEADER_LINE3,		
							IP_BILL_HEADER_LINE4,		
							IP_BILL_HEADER_LINE5,		
							IP_BILL_HEADER_LINE6,		
							IP_BILL_HEADER_LINE7,		
							IP_BILL_HEADER_LINE8,		
							IP_BILL_HEADER_LINE9,		
							IP_BILL_HEADER_LINE10,		
							IP_BILL_HEADER_LINE11,		
							IP_BILL_HEADER_LINE12,		
							IP_BILL_HEADER_LINE13,		
							IP_BILL_HEADER_LINE14,		
							IP_BILL_FOOTER_LINE1,		
							IP_BILL_FOOTER_LINE2,		
							IP_BILL_FOOTER_LINE3,		
							IP_BILL_FOOTER_LINE4,		
							IP_BILL_CREDIT_FOOTER_LINE1,	
							IP_BILL_CREDIT_FOOTER_LINE2,	
							IP_BILL_CREDIT_FOOTER_LINE3,	
							IP_BILL_CREDIT_FOOTER_LINE4,
							ip_bill_ins_footer_line1,
							ip_bill_ins_footer_line2,
							ip_bill_ins_footer_line3,
							ip_bill_ins_footer_line4,
							IP_CR_ADDL_ID_IN_FTR_YN,
							IP_INS_ADDL_ID_IN_FTR_YN  
					into	:original_text,
							:copy_text,			
							:bill_title_line1,		
							:bill_title_line2,		
							:bill_title_line3,		
							:bill_title_line4,		
							:op_cash_bill_title_w_rcpt,	
							:op_cash_bill_title_wo_rcpt,	
							:op_credit_bill_title,		
							:ip_cash_bill_title_w_rcpt,	
							:ip_cash_bill_title_wo_rcpt,	
							:ip_credit_bill_title,		
							:cash_bill_title_addl_line,	
							:credit_bill_title_addl_line,
							 :bl_header_line_01,
							 :bl_header_line_02,
							 :bl_header_line_03,
							 :bl_header_line_04,
							 :bl_header_line_05,
							 :bl_header_line_06,
							 :bl_header_line_07,
							 :bl_header_line_08,
							 :bl_header_line_09,
							 :bl_header_line_10,
							 :bl_header_line_11,
							 :bl_header_line_12,
							 :bl_header_line_13,
							 :bl_header_line_14,
							 :bl_footer_line_01,
							 :bl_footer_line_02,
							 :bl_footer_line_03,
							 :bl_footer_line_04,
							 :bill_credit_footer_line1,	
							 :bill_credit_footer_line2,
							 :bill_credit_footer_line3,
							 :bill_credit_footer_line4,
							 :bill_ins_footer_line1,
							 :bill_ins_footer_line2,
							 :bill_ins_footer_line3,
							 :bill_ins_footer_line4,
							 :ip_cr_addl_id_in_ftr_yn,
							 :ip_ins_addl_id_in_ftr_yn 
					FROM BL_BILL_HDR_FTR_FORMAT
					WHERE Operating_Facility_Id = :nd_facility_id
					AND   UPPER(NVL(LANGUAGE_ID,'en'))=UPPER('en'); */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 52;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlbuft((void **)0, 
        "select IP_ORIGINAL_TEXT ,IP_COPY_TEXT ,IP_BILL_TITLE_LINE1 ,IP_BILL\
_TITLE_LINE2 ,IP_BILL_TITLE_LINE3 ,IP_BILL_TITLE_LINE4 ,OP_CASH_BILL_TITLE_W\
_RCPT ,OP_CASH_BILL_TITLE_WO_RCPT ,OP_CREDIT_BILL_TITLE ,IP_CASH_INT_BILL_TI\
TLE ,IP_CASH_INT_BILL_TITLE ,IP_CREDIT_INT_BILL_TITLE ,IP_CASH_BILL_TITLE_AD\
DL_LINE ,IP_CREDIT_BILL_TITLE_ADDL_LINE ,IP_BILL_HEADER_LINE1 ,IP_BILL_HEADE\
R_LINE2 ,IP_BILL_HEADER_LINE3 ,IP_BILL_HEADER_LINE4 ,IP_BILL_HEADER_LINE5 ,I\
P_BILL_HEADER_LINE6 ,IP_BILL_HEADER_LINE7 ,IP_BILL_HEADER_LINE8 ,IP_BILL_HEA\
DER_LINE9 ,IP_BILL_HEADER_LINE10 ,IP_BILL_HEADER_LINE11 ,IP_BILL_HEADER_LINE\
12 ,IP_BILL_HEADER_LINE13 ,IP_BILL_HEADER_LINE14 ,IP_BILL_FOOTER_LINE1 ,IP_B\
ILL_FOOTER_LINE2 ,IP_BILL_FOOTER_LINE3 ,IP_BILL_FOOTER_LINE4 ,IP_BILL_CREDIT\
_FOOTER_LINE1 ,IP_BILL_CREDIT_FOOTER_LINE2 ,IP_BILL_CREDIT_FOOTER_LINE3 ,IP_\
BILL_CREDIT_FOOTER_LINE4 ,ip_bill_ins_footer_line1 ,ip_bill_ins_footer_line2\
 ,ip_bill_ins_footer_line3 ,ip_bill_ins_footer_line4 ,IP_CR_ADDL_ID_IN_FTR_Y\
N ,IP_INS_ADDL_ID_IN_FTR_YN into :b0,:b1,:b2,");
      sqlstm.stmt = ":b3,:b4,:b5,:b6,:b7,:b8,:b9,:b10,:b11,:b12,:b13,:b14,:b\
15,:b16,:b17,:b18,:b19,:b20,:b21,:b22,:b23,:b24,:b25,:b26,:b27,:b28,:b29,:b30,\
:b31,:b32,:b33,:b34,:b35,:b36,:b37,:b38,:b39,:b40,:b41  from BL_BILL_HDR_FTR_F\
ORMAT where (Operating_Facility_Id=:b42 and UPPER(NVL(LANGUAGE_ID,'en'))=UPPER\
('en'))";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )11401;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&original_text;
      sqlstm.sqhstl[0] = (unsigned int  )103;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&copy_text;
      sqlstm.sqhstl[1] = (unsigned int  )103;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&bill_title_line1;
      sqlstm.sqhstl[2] = (unsigned int  )103;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqhstv[3] = (         void  *)&bill_title_line2;
      sqlstm.sqhstl[3] = (unsigned int  )103;
      sqlstm.sqhsts[3] = (         int  )0;
      sqlstm.sqindv[3] = (         void  *)0;
      sqlstm.sqinds[3] = (         int  )0;
      sqlstm.sqharm[3] = (unsigned int  )0;
      sqlstm.sqadto[3] = (unsigned short )0;
      sqlstm.sqtdso[3] = (unsigned short )0;
      sqlstm.sqhstv[4] = (         void  *)&bill_title_line3;
      sqlstm.sqhstl[4] = (unsigned int  )103;
      sqlstm.sqhsts[4] = (         int  )0;
      sqlstm.sqindv[4] = (         void  *)0;
      sqlstm.sqinds[4] = (         int  )0;
      sqlstm.sqharm[4] = (unsigned int  )0;
      sqlstm.sqadto[4] = (unsigned short )0;
      sqlstm.sqtdso[4] = (unsigned short )0;
      sqlstm.sqhstv[5] = (         void  *)&bill_title_line4;
      sqlstm.sqhstl[5] = (unsigned int  )103;
      sqlstm.sqhsts[5] = (         int  )0;
      sqlstm.sqindv[5] = (         void  *)0;
      sqlstm.sqinds[5] = (         int  )0;
      sqlstm.sqharm[5] = (unsigned int  )0;
      sqlstm.sqadto[5] = (unsigned short )0;
      sqlstm.sqtdso[5] = (unsigned short )0;
      sqlstm.sqhstv[6] = (         void  *)&op_cash_bill_title_w_rcpt;
      sqlstm.sqhstl[6] = (unsigned int  )103;
      sqlstm.sqhsts[6] = (         int  )0;
      sqlstm.sqindv[6] = (         void  *)0;
      sqlstm.sqinds[6] = (         int  )0;
      sqlstm.sqharm[6] = (unsigned int  )0;
      sqlstm.sqadto[6] = (unsigned short )0;
      sqlstm.sqtdso[6] = (unsigned short )0;
      sqlstm.sqhstv[7] = (         void  *)&op_cash_bill_title_wo_rcpt;
      sqlstm.sqhstl[7] = (unsigned int  )103;
      sqlstm.sqhsts[7] = (         int  )0;
      sqlstm.sqindv[7] = (         void  *)0;
      sqlstm.sqinds[7] = (         int  )0;
      sqlstm.sqharm[7] = (unsigned int  )0;
      sqlstm.sqadto[7] = (unsigned short )0;
      sqlstm.sqtdso[7] = (unsigned short )0;
      sqlstm.sqhstv[8] = (         void  *)&op_credit_bill_title;
      sqlstm.sqhstl[8] = (unsigned int  )103;
      sqlstm.sqhsts[8] = (         int  )0;
      sqlstm.sqindv[8] = (         void  *)0;
      sqlstm.sqinds[8] = (         int  )0;
      sqlstm.sqharm[8] = (unsigned int  )0;
      sqlstm.sqadto[8] = (unsigned short )0;
      sqlstm.sqtdso[8] = (unsigned short )0;
      sqlstm.sqhstv[9] = (         void  *)&ip_cash_bill_title_w_rcpt;
      sqlstm.sqhstl[9] = (unsigned int  )103;
      sqlstm.sqhsts[9] = (         int  )0;
      sqlstm.sqindv[9] = (         void  *)0;
      sqlstm.sqinds[9] = (         int  )0;
      sqlstm.sqharm[9] = (unsigned int  )0;
      sqlstm.sqadto[9] = (unsigned short )0;
      sqlstm.sqtdso[9] = (unsigned short )0;
      sqlstm.sqhstv[10] = (         void  *)&ip_cash_bill_title_wo_rcpt;
      sqlstm.sqhstl[10] = (unsigned int  )103;
      sqlstm.sqhsts[10] = (         int  )0;
      sqlstm.sqindv[10] = (         void  *)0;
      sqlstm.sqinds[10] = (         int  )0;
      sqlstm.sqharm[10] = (unsigned int  )0;
      sqlstm.sqadto[10] = (unsigned short )0;
      sqlstm.sqtdso[10] = (unsigned short )0;
      sqlstm.sqhstv[11] = (         void  *)&ip_credit_bill_title;
      sqlstm.sqhstl[11] = (unsigned int  )103;
      sqlstm.sqhsts[11] = (         int  )0;
      sqlstm.sqindv[11] = (         void  *)0;
      sqlstm.sqinds[11] = (         int  )0;
      sqlstm.sqharm[11] = (unsigned int  )0;
      sqlstm.sqadto[11] = (unsigned short )0;
      sqlstm.sqtdso[11] = (unsigned short )0;
      sqlstm.sqhstv[12] = (         void  *)&cash_bill_title_addl_line;
      sqlstm.sqhstl[12] = (unsigned int  )103;
      sqlstm.sqhsts[12] = (         int  )0;
      sqlstm.sqindv[12] = (         void  *)0;
      sqlstm.sqinds[12] = (         int  )0;
      sqlstm.sqharm[12] = (unsigned int  )0;
      sqlstm.sqadto[12] = (unsigned short )0;
      sqlstm.sqtdso[12] = (unsigned short )0;
      sqlstm.sqhstv[13] = (         void  *)&credit_bill_title_addl_line;
      sqlstm.sqhstl[13] = (unsigned int  )103;
      sqlstm.sqhsts[13] = (         int  )0;
      sqlstm.sqindv[13] = (         void  *)0;
      sqlstm.sqinds[13] = (         int  )0;
      sqlstm.sqharm[13] = (unsigned int  )0;
      sqlstm.sqadto[13] = (unsigned short )0;
      sqlstm.sqtdso[13] = (unsigned short )0;
      sqlstm.sqhstv[14] = (         void  *)&bl_header_line_01;
      sqlstm.sqhstl[14] = (unsigned int  )103;
      sqlstm.sqhsts[14] = (         int  )0;
      sqlstm.sqindv[14] = (         void  *)0;
      sqlstm.sqinds[14] = (         int  )0;
      sqlstm.sqharm[14] = (unsigned int  )0;
      sqlstm.sqadto[14] = (unsigned short )0;
      sqlstm.sqtdso[14] = (unsigned short )0;
      sqlstm.sqhstv[15] = (         void  *)&bl_header_line_02;
      sqlstm.sqhstl[15] = (unsigned int  )103;
      sqlstm.sqhsts[15] = (         int  )0;
      sqlstm.sqindv[15] = (         void  *)0;
      sqlstm.sqinds[15] = (         int  )0;
      sqlstm.sqharm[15] = (unsigned int  )0;
      sqlstm.sqadto[15] = (unsigned short )0;
      sqlstm.sqtdso[15] = (unsigned short )0;
      sqlstm.sqhstv[16] = (         void  *)&bl_header_line_03;
      sqlstm.sqhstl[16] = (unsigned int  )103;
      sqlstm.sqhsts[16] = (         int  )0;
      sqlstm.sqindv[16] = (         void  *)0;
      sqlstm.sqinds[16] = (         int  )0;
      sqlstm.sqharm[16] = (unsigned int  )0;
      sqlstm.sqadto[16] = (unsigned short )0;
      sqlstm.sqtdso[16] = (unsigned short )0;
      sqlstm.sqhstv[17] = (         void  *)&bl_header_line_04;
      sqlstm.sqhstl[17] = (unsigned int  )103;
      sqlstm.sqhsts[17] = (         int  )0;
      sqlstm.sqindv[17] = (         void  *)0;
      sqlstm.sqinds[17] = (         int  )0;
      sqlstm.sqharm[17] = (unsigned int  )0;
      sqlstm.sqadto[17] = (unsigned short )0;
      sqlstm.sqtdso[17] = (unsigned short )0;
      sqlstm.sqhstv[18] = (         void  *)&bl_header_line_05;
      sqlstm.sqhstl[18] = (unsigned int  )103;
      sqlstm.sqhsts[18] = (         int  )0;
      sqlstm.sqindv[18] = (         void  *)0;
      sqlstm.sqinds[18] = (         int  )0;
      sqlstm.sqharm[18] = (unsigned int  )0;
      sqlstm.sqadto[18] = (unsigned short )0;
      sqlstm.sqtdso[18] = (unsigned short )0;
      sqlstm.sqhstv[19] = (         void  *)&bl_header_line_06;
      sqlstm.sqhstl[19] = (unsigned int  )103;
      sqlstm.sqhsts[19] = (         int  )0;
      sqlstm.sqindv[19] = (         void  *)0;
      sqlstm.sqinds[19] = (         int  )0;
      sqlstm.sqharm[19] = (unsigned int  )0;
      sqlstm.sqadto[19] = (unsigned short )0;
      sqlstm.sqtdso[19] = (unsigned short )0;
      sqlstm.sqhstv[20] = (         void  *)&bl_header_line_07;
      sqlstm.sqhstl[20] = (unsigned int  )103;
      sqlstm.sqhsts[20] = (         int  )0;
      sqlstm.sqindv[20] = (         void  *)0;
      sqlstm.sqinds[20] = (         int  )0;
      sqlstm.sqharm[20] = (unsigned int  )0;
      sqlstm.sqadto[20] = (unsigned short )0;
      sqlstm.sqtdso[20] = (unsigned short )0;
      sqlstm.sqhstv[21] = (         void  *)&bl_header_line_08;
      sqlstm.sqhstl[21] = (unsigned int  )103;
      sqlstm.sqhsts[21] = (         int  )0;
      sqlstm.sqindv[21] = (         void  *)0;
      sqlstm.sqinds[21] = (         int  )0;
      sqlstm.sqharm[21] = (unsigned int  )0;
      sqlstm.sqadto[21] = (unsigned short )0;
      sqlstm.sqtdso[21] = (unsigned short )0;
      sqlstm.sqhstv[22] = (         void  *)&bl_header_line_09;
      sqlstm.sqhstl[22] = (unsigned int  )103;
      sqlstm.sqhsts[22] = (         int  )0;
      sqlstm.sqindv[22] = (         void  *)0;
      sqlstm.sqinds[22] = (         int  )0;
      sqlstm.sqharm[22] = (unsigned int  )0;
      sqlstm.sqadto[22] = (unsigned short )0;
      sqlstm.sqtdso[22] = (unsigned short )0;
      sqlstm.sqhstv[23] = (         void  *)&bl_header_line_10;
      sqlstm.sqhstl[23] = (unsigned int  )103;
      sqlstm.sqhsts[23] = (         int  )0;
      sqlstm.sqindv[23] = (         void  *)0;
      sqlstm.sqinds[23] = (         int  )0;
      sqlstm.sqharm[23] = (unsigned int  )0;
      sqlstm.sqadto[23] = (unsigned short )0;
      sqlstm.sqtdso[23] = (unsigned short )0;
      sqlstm.sqhstv[24] = (         void  *)&bl_header_line_11;
      sqlstm.sqhstl[24] = (unsigned int  )103;
      sqlstm.sqhsts[24] = (         int  )0;
      sqlstm.sqindv[24] = (         void  *)0;
      sqlstm.sqinds[24] = (         int  )0;
      sqlstm.sqharm[24] = (unsigned int  )0;
      sqlstm.sqadto[24] = (unsigned short )0;
      sqlstm.sqtdso[24] = (unsigned short )0;
      sqlstm.sqhstv[25] = (         void  *)&bl_header_line_12;
      sqlstm.sqhstl[25] = (unsigned int  )103;
      sqlstm.sqhsts[25] = (         int  )0;
      sqlstm.sqindv[25] = (         void  *)0;
      sqlstm.sqinds[25] = (         int  )0;
      sqlstm.sqharm[25] = (unsigned int  )0;
      sqlstm.sqadto[25] = (unsigned short )0;
      sqlstm.sqtdso[25] = (unsigned short )0;
      sqlstm.sqhstv[26] = (         void  *)&bl_header_line_13;
      sqlstm.sqhstl[26] = (unsigned int  )103;
      sqlstm.sqhsts[26] = (         int  )0;
      sqlstm.sqindv[26] = (         void  *)0;
      sqlstm.sqinds[26] = (         int  )0;
      sqlstm.sqharm[26] = (unsigned int  )0;
      sqlstm.sqadto[26] = (unsigned short )0;
      sqlstm.sqtdso[26] = (unsigned short )0;
      sqlstm.sqhstv[27] = (         void  *)&bl_header_line_14;
      sqlstm.sqhstl[27] = (unsigned int  )103;
      sqlstm.sqhsts[27] = (         int  )0;
      sqlstm.sqindv[27] = (         void  *)0;
      sqlstm.sqinds[27] = (         int  )0;
      sqlstm.sqharm[27] = (unsigned int  )0;
      sqlstm.sqadto[27] = (unsigned short )0;
      sqlstm.sqtdso[27] = (unsigned short )0;
      sqlstm.sqhstv[28] = (         void  *)&bl_footer_line_01;
      sqlstm.sqhstl[28] = (unsigned int  )103;
      sqlstm.sqhsts[28] = (         int  )0;
      sqlstm.sqindv[28] = (         void  *)0;
      sqlstm.sqinds[28] = (         int  )0;
      sqlstm.sqharm[28] = (unsigned int  )0;
      sqlstm.sqadto[28] = (unsigned short )0;
      sqlstm.sqtdso[28] = (unsigned short )0;
      sqlstm.sqhstv[29] = (         void  *)&bl_footer_line_02;
      sqlstm.sqhstl[29] = (unsigned int  )103;
      sqlstm.sqhsts[29] = (         int  )0;
      sqlstm.sqindv[29] = (         void  *)0;
      sqlstm.sqinds[29] = (         int  )0;
      sqlstm.sqharm[29] = (unsigned int  )0;
      sqlstm.sqadto[29] = (unsigned short )0;
      sqlstm.sqtdso[29] = (unsigned short )0;
      sqlstm.sqhstv[30] = (         void  *)&bl_footer_line_03;
      sqlstm.sqhstl[30] = (unsigned int  )103;
      sqlstm.sqhsts[30] = (         int  )0;
      sqlstm.sqindv[30] = (         void  *)0;
      sqlstm.sqinds[30] = (         int  )0;
      sqlstm.sqharm[30] = (unsigned int  )0;
      sqlstm.sqadto[30] = (unsigned short )0;
      sqlstm.sqtdso[30] = (unsigned short )0;
      sqlstm.sqhstv[31] = (         void  *)&bl_footer_line_04;
      sqlstm.sqhstl[31] = (unsigned int  )103;
      sqlstm.sqhsts[31] = (         int  )0;
      sqlstm.sqindv[31] = (         void  *)0;
      sqlstm.sqinds[31] = (         int  )0;
      sqlstm.sqharm[31] = (unsigned int  )0;
      sqlstm.sqadto[31] = (unsigned short )0;
      sqlstm.sqtdso[31] = (unsigned short )0;
      sqlstm.sqhstv[32] = (         void  *)&bill_credit_footer_line1;
      sqlstm.sqhstl[32] = (unsigned int  )103;
      sqlstm.sqhsts[32] = (         int  )0;
      sqlstm.sqindv[32] = (         void  *)0;
      sqlstm.sqinds[32] = (         int  )0;
      sqlstm.sqharm[32] = (unsigned int  )0;
      sqlstm.sqadto[32] = (unsigned short )0;
      sqlstm.sqtdso[32] = (unsigned short )0;
      sqlstm.sqhstv[33] = (         void  *)&bill_credit_footer_line2;
      sqlstm.sqhstl[33] = (unsigned int  )103;
      sqlstm.sqhsts[33] = (         int  )0;
      sqlstm.sqindv[33] = (         void  *)0;
      sqlstm.sqinds[33] = (         int  )0;
      sqlstm.sqharm[33] = (unsigned int  )0;
      sqlstm.sqadto[33] = (unsigned short )0;
      sqlstm.sqtdso[33] = (unsigned short )0;
      sqlstm.sqhstv[34] = (         void  *)&bill_credit_footer_line3;
      sqlstm.sqhstl[34] = (unsigned int  )103;
      sqlstm.sqhsts[34] = (         int  )0;
      sqlstm.sqindv[34] = (         void  *)0;
      sqlstm.sqinds[34] = (         int  )0;
      sqlstm.sqharm[34] = (unsigned int  )0;
      sqlstm.sqadto[34] = (unsigned short )0;
      sqlstm.sqtdso[34] = (unsigned short )0;
      sqlstm.sqhstv[35] = (         void  *)&bill_credit_footer_line4;
      sqlstm.sqhstl[35] = (unsigned int  )103;
      sqlstm.sqhsts[35] = (         int  )0;
      sqlstm.sqindv[35] = (         void  *)0;
      sqlstm.sqinds[35] = (         int  )0;
      sqlstm.sqharm[35] = (unsigned int  )0;
      sqlstm.sqadto[35] = (unsigned short )0;
      sqlstm.sqtdso[35] = (unsigned short )0;
      sqlstm.sqhstv[36] = (         void  *)&bill_ins_footer_line1;
      sqlstm.sqhstl[36] = (unsigned int  )103;
      sqlstm.sqhsts[36] = (         int  )0;
      sqlstm.sqindv[36] = (         void  *)0;
      sqlstm.sqinds[36] = (         int  )0;
      sqlstm.sqharm[36] = (unsigned int  )0;
      sqlstm.sqadto[36] = (unsigned short )0;
      sqlstm.sqtdso[36] = (unsigned short )0;
      sqlstm.sqhstv[37] = (         void  *)&bill_ins_footer_line2;
      sqlstm.sqhstl[37] = (unsigned int  )103;
      sqlstm.sqhsts[37] = (         int  )0;
      sqlstm.sqindv[37] = (         void  *)0;
      sqlstm.sqinds[37] = (         int  )0;
      sqlstm.sqharm[37] = (unsigned int  )0;
      sqlstm.sqadto[37] = (unsigned short )0;
      sqlstm.sqtdso[37] = (unsigned short )0;
      sqlstm.sqhstv[38] = (         void  *)&bill_ins_footer_line3;
      sqlstm.sqhstl[38] = (unsigned int  )103;
      sqlstm.sqhsts[38] = (         int  )0;
      sqlstm.sqindv[38] = (         void  *)0;
      sqlstm.sqinds[38] = (         int  )0;
      sqlstm.sqharm[38] = (unsigned int  )0;
      sqlstm.sqadto[38] = (unsigned short )0;
      sqlstm.sqtdso[38] = (unsigned short )0;
      sqlstm.sqhstv[39] = (         void  *)&bill_ins_footer_line4;
      sqlstm.sqhstl[39] = (unsigned int  )103;
      sqlstm.sqhsts[39] = (         int  )0;
      sqlstm.sqindv[39] = (         void  *)0;
      sqlstm.sqinds[39] = (         int  )0;
      sqlstm.sqharm[39] = (unsigned int  )0;
      sqlstm.sqadto[39] = (unsigned short )0;
      sqlstm.sqtdso[39] = (unsigned short )0;
      sqlstm.sqhstv[40] = (         void  *)&ip_cr_addl_id_in_ftr_yn;
      sqlstm.sqhstl[40] = (unsigned int  )4;
      sqlstm.sqhsts[40] = (         int  )0;
      sqlstm.sqindv[40] = (         void  *)0;
      sqlstm.sqinds[40] = (         int  )0;
      sqlstm.sqharm[40] = (unsigned int  )0;
      sqlstm.sqadto[40] = (unsigned short )0;
      sqlstm.sqtdso[40] = (unsigned short )0;
      sqlstm.sqhstv[41] = (         void  *)&ip_ins_addl_id_in_ftr_yn;
      sqlstm.sqhstl[41] = (unsigned int  )4;
      sqlstm.sqhsts[41] = (         int  )0;
      sqlstm.sqindv[41] = (         void  *)0;
      sqlstm.sqinds[41] = (         int  )0;
      sqlstm.sqharm[41] = (unsigned int  )0;
      sqlstm.sqadto[41] = (unsigned short )0;
      sqlstm.sqtdso[41] = (unsigned short )0;
      sqlstm.sqhstv[42] = (         void  *)&nd_facility_id;
      sqlstm.sqhstl[42] = (unsigned int  )5;
      sqlstm.sqhsts[42] = (         int  )0;
      sqlstm.sqindv[42] = (         void  *)0;
      sqlstm.sqinds[42] = (         int  )0;
      sqlstm.sqharm[42] = (unsigned int  )0;
      sqlstm.sqadto[42] = (unsigned short )0;
      sqlstm.sqtdso[42] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


				}
			
			
		    }
       if(NODATAFOUND)
	     err_mesg("No Format Setup is Found, Please Check the Setup",0,"");	 

	original_text.arr[original_text.len]='\0';			
	copy_text.arr[copy_text.len]		= '\0';	
	bill_title_line1.arr[bill_title_line1.len]		= '\0';
	bill_title_line2.arr[bill_title_line2.len]		= '\0';		
	bill_title_line3.arr[bill_title_line3.len]		= '\0';		
	bill_title_line4.arr[bill_title_line4.len]		= '\0';		
	op_cash_bill_title_w_rcpt.arr[op_cash_bill_title_w_rcpt.len]		= '\0';		
	op_cash_bill_title_wo_rcpt.arr[op_cash_bill_title_wo_rcpt.len]		= '\0';	
	op_credit_bill_title.arr[op_credit_bill_title.len]		= '\0';		
	ip_cash_bill_title_w_rcpt.arr[ip_cash_bill_title_w_rcpt.len]		= '\0';	
	ip_cash_bill_title_wo_rcpt.arr[ip_cash_bill_title_wo_rcpt.len]		= '\0';	
	ip_credit_bill_title.arr[ip_credit_bill_title.len]		= '\0';		
	cash_bill_title_addl_line.arr[cash_bill_title_addl_line.len]		= '\0';	
	credit_bill_title_addl_line.arr[credit_bill_title_addl_line.len]		= '\0';	
	bl_header_line_01.arr[bl_header_line_01.len]		= '\0';			
	bl_header_line_02.arr[bl_header_line_02.len]		= '\0';			
	bl_header_line_03.arr[bl_header_line_03.len]		= '\0';			
	bl_header_line_04.arr[bl_header_line_04.len]		= '\0';			
	bl_header_line_05.arr[bl_header_line_05.len]		= '\0';			
	bl_header_line_06.arr[bl_header_line_06.len]		= '\0';			
	bl_header_line_07.arr[bl_header_line_07.len]		= '\0';			
	bl_header_line_08.arr[bl_header_line_08.len]		= '\0';			
	bl_header_line_09.arr[bl_header_line_09.len]		= '\0';			
	bl_header_line_10.arr[bl_header_line_10.len]		= '\0';			
	bl_header_line_11.arr[bl_header_line_11.len]		= '\0';			
	bl_header_line_12.arr[bl_header_line_12.len]		= '\0';			
	bl_header_line_13.arr[bl_header_line_13.len]		= '\0';			
	bl_header_line_14.arr[bl_header_line_14.len]		= '\0';			
	bl_footer_line_01.arr[bl_footer_line_01.len]		= '\0';			
	bl_footer_line_02.arr[bl_footer_line_02.len]		= '\0';			
	bl_footer_line_03.arr[bl_footer_line_03.len]		= '\0';			
	bl_footer_line_04.arr[bl_footer_line_04.len]		= '\0';			
	bill_credit_footer_line1.arr[bill_credit_footer_line1.len]		= '\0';		
	bill_credit_footer_line2.arr[bill_credit_footer_line2.len]		= '\0';		
	bill_credit_footer_line3.arr[bill_credit_footer_line3.len]		= '\0';		
	bill_credit_footer_line4.arr[bill_credit_footer_line4.len]		= '\0';
	cr_addl_id_in_ftr_yn.arr[cr_addl_id_in_ftr_yn.len]				= '\0';
	print_ins_addl_id_in_ftr_yn.arr[print_ins_addl_id_in_ftr_yn.len] = '\0';
	ip_cr_addl_id_in_ftr_yn.arr[ip_cr_addl_id_in_ftr_yn.len]		 = '\0';
	ip_ins_addl_id_in_ftr_yn.arr[ip_cr_addl_id_in_ftr_yn.len]		 = '\0'; 		
}

print_title()
{
	
	if(strcmp(dc_bill_print_flag.arr,"N") == 0)    
	{

	  if (original_text.arr[0] != '\0')
      {
		print_line(original_text.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
       }
	}
	else
	{
    /* added by raghava on 23/11/2009 for Medicity Test Patch */
	  if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
	  {
	   if(d1_man_disc_amt!=0 || d1_overall_disc_amt!=0 || d_pmnt_diff_adj_amt!=0 ||d_serv_disc_amt!=0)
	   {
	    if(reprint_disc_copy_num>1)
        {
		  
		   if(copy_text.arr[0] != '\0')
		   {
			print_line(copy_text.arr);
			if(nd_print_option.arr[0]=='R')
		    fun_bl_report_temp_format();
			else
			fprintf(fp,"\n");
			line_ctr++;
		   }
		}
	    else
		{
		   if (original_text.arr[0] != '\0')
		   {
			print_line(original_text.arr);
			if(nd_print_option.arr[0]=='R')
		    fun_bl_report_temp_format();
			else
			fprintf(fp,"\n");
			line_ctr++;
		   }
		}
	   }
	  }
      else
	  {
		if(copy_text.arr[0] != '\0')
		{
		  print_line(copy_text.arr);
	
		  if(nd_print_option.arr[0]=='R')
		  fun_bl_report_temp_format();
		  else
		  fprintf(fp,"\n");
		  line_ctr++;
		}
	  }
	 
	 }


	if (bill_title_line1.arr[0] != '\0')
      {

		print_line(bill_title_line1.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
       }
	if (bill_title_line2.arr[0] != '\0')
      {
		print_line(bill_title_line2.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
       }
	if (bill_title_line3.arr[0] != '\0')
      {
		print_line(bill_title_line3.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
       }
	if (bill_title_line4.arr[0] != '\0')
      {
		print_line(bill_title_line4.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
       }
	
}


print_line(line_var) varchar line_var[101];  //print_line definition

{
	dup_var.arr[0] = '\0';
	dup_var.len = 0;

    pos_var  = 0;
	pos_var1 = 0;
	pos_var2 = 0;
	print_upto = 0;
	lv_var  = 1;
	i = 0;
	
	strcpy(dup_var.arr,line_var);
	dup_var.len = strlen(dup_var.arr);
	var_length = strlen(dup_var.arr);
	pos_var = char_position(dup_var.arr,"+",1);
    sprintf(st_var,"%d",var_length);
	

	while(i < var_length)
	{ 
	if (pos_var == 0)
	{
    pos_length = var_length - i + 2;
	sprintf(st_var,"%d",pos_length);
	
	put_string(dup_var.arr,i,pos_length);
	strcpy(str_var1.arr,ls_str.arr);
	
	

	str_var1.len= strlen(str_var1.arr);
	
	check_splch(str_var1.arr);
	pos_var1 = 0;
	pos_var2 = 0;
	i = var_length;
	}

	if (pos_var != 0 && pos_var1 == 0)
	{	    
	pos_var1 = pos_var;

	pos_length = pos_var1-print_upto-1;	

    put_string(dup_var.arr,print_upto+1,pos_length);
    strcpy(str_var1.arr,ls_str.arr);
	str_var1.len = strlen(str_var1.arr);
	check_splch(str_var1.arr);

    print_upto = pos_var1 - 1;
	i = pos_var1+1;
    

	pos_var2 = char_position(dup_var.arr,"+",i);

     if (pos_var2 == 0)
	 {
	  pos_length = var_length - pos_var1 + 1;
      put_string(dup_var.arr,pos_var1,pos_length);
      strcpy(str_var1.arr,ls_str.arr);
	  str_var1.len = strlen(str_var1.arr);

	  check_splch(str_var1.arr);
	  print_upto = var_length+1;
	  i = var_length+1;
     }

    }

    if (pos_var2 != 0)
	{
    nd_column_val.arr[0] = '\0';
	nd_column_val.len = 0;
	column_var.arr[0] = '\0';
	column_var.len = 0;
	tab_name.arr[0] = '\0';
	tab_name.len = 0;

	sql_stmt1.arr[0] = '\0';
	sql_stmt1.len = 0;
	sql_stmt2.arr[0] = '\0';
	sql_stmt2.len = 0;


	pos_length = pos_var2 - pos_var1 - 1;

    column_var.arr[0] = '\0';
	column_var.len = 0;
	
	 put_string(dup_var.arr,pos_var1+1,pos_length);
	 //disp_message(ERR_MESG,ls_str.arr); SENTHIL
     strcpy(column_var.arr,ls_str.arr);
	 column_var.len = strlen(column_var.arr);
	 date_yn = chk_date_yn(column_var.arr);
	 

		 
	  /* EXEC SQL SELECT  decode(:date_yn,0,'select to_char(ltrim('|| LET_MAPPED_COL_NAME || ')) from '|| LET_MAPPED_TABLE_NAME ||' WHERE ',
										 'select to_char('|| LET_MAPPED_COL_NAME || ',''DD/MM/YYYY'') from '|| LET_MAPPED_TABLE_NAME ||' WHERE '),LET_MAPPED_TABLE_NAME
					into  :sql_stmt1,tab_name
                    FROM BL_RECEIPT_MAPPING_COL
                    WHERE LET_COLUMN_ID = :column_var
					AND APPL_TRX_IND = 'B'; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select decode(:b0,0,(((('select to_char(ltrim('||LET_MAPPE\
D_COL_NAME)||')) from ')||LET_MAPPED_TABLE_NAME)||' WHERE '),(((('select to_ch\
ar('||LET_MAPPED_COL_NAME)||',''DD/MM/YYYY'') from ')||LET_MAPPED_TABLE_NAME)|\
|' WHERE ')) ,LET_MAPPED_TABLE_NAME into :b1,:b2  from BL_RECEIPT_MAPPING_COL \
where (LET_COLUMN_ID=:b3 and APPL_TRX_IND='B')";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11588;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&date_yn;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&sql_stmt1;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&tab_name;
   sqlstm.sqhstl[2] = (unsigned int  )33;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&column_var;
   sqlstm.sqhstl[3] = (unsigned int  )103;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			
	

	len = strlen(sql_stmt1.arr);
		sql_stmt1.arr[sql_stmt1.len]  ='\0';


    tab_name.arr[tab_name.len] = '\0';
	

	if(strcmp(tab_name.arr,"BL_RECEIPT_REFUND_HDR") == 0 || strcmp(tab_name.arr,"BL_RECEIPT_REFUND_HDRDTL_VW") == 0) 
	{
    
	strcpy(sql_stmt2.arr, "DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_doc_type_code1.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUMBER) =");
	strcat(sql_stmt2.arr,d_doc_number1.arr);

	if(strcmp(column_var.arr,"CASHIER_NAME")==0)
	{
		strcat(sql_stmt2.arr," AND ROWNUM=1");
	}
      
	}

	
	if(strcmp(tab_name.arr,"BL_BILL_HDR") == 0 ) 
	{
    
	strcpy(sql_stmt2.arr, "DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d1_doc_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUM) =");
	strcat(sql_stmt2.arr,d1_doc_number.arr);

	}
	
	if(strcmp(tab_name.arr,"AR_CUSTOMER") == 0 ) 
	{

		if(strcmp(d_cust_code.arr,"\0")!=0)
		strcpy(d_copy_cust_code.arr,d_cust_code.arr);
		else
		strcpy(d_copy_cust_code.arr,"$$$$$");
	

    strcpy(sql_stmt2.arr, "cust_code = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_copy_cust_code.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	if(strcmp(tab_name.arr,"BL_CASH_COUNTER") == 0 ) 
	{
	strcpy(sql_stmt2.arr,"operating_facility_id = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
    strcat(sql_stmt2.arr, " and CASH_COUNTER_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_cash_counter.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	if(strcmp(tab_name.arr,"BL_EPISODE_FIN_DTLS") == 0 ) 
	{
    strcpy(sql_stmt2.arr, "EPISODE_TYPE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and EPISODE_ID= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_id.arr);
	strcat(sql_stmt2.arr,"'");
	}
	

	if(strcmp(tab_name.arr,"BL_ENCOUNTER_FOR_QRY_VW") == 0 ) 
	{
	
    strcpy(sql_stmt2.arr,"episode_type = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_type.arr);
	strcat(sql_stmt2.arr,"'");

    if (strcmp(d_episode_type.arr,"R")!=0)
	{
		strcat(sql_stmt2.arr," and episode_id= ");
		strcat(sql_stmt2.arr,"'");
		strcat(sql_stmt2.arr,d_episode_id.arr);
		strcat(sql_stmt2.arr,"'");
    }

   if (strcmp(d_episode_type.arr,"R")!=0 && strcmp(d_episode_type.arr,"I")!=0 && strcmp(d_episode_type.arr,"D")!=0)
   {
	strcat(sql_stmt2.arr," and visit_id= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_visit_id.arr);
	strcat(sql_stmt2.arr,"'");
   }

	//strcat(sql_stmt2.arr," and NVL(LANGUAGE_ID,'en')= ");

	strcat(sql_stmt2.arr," and NVL(LANGUAGE_ID,'");
	strcat(sql_stmt2.arr,nd_lang_id.arr);
	strcat(sql_stmt2.arr,"' )= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_lang_id.arr);
	strcat(sql_stmt2.arr,"'");

	strcat(sql_stmt2.arr," and patient_id= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and facility_id = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	//disp_message(ERR_MESG,sql_stmt2.arr);
	}

	if(strcmp(tab_name.arr,"PR_ENCOUNTER") == 0 ) 
	{
	strcpy(sql_stmt2.arr,"FACILITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
    strcat(sql_stmt2.arr," and patient_id = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and episode_id= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and substr(PATIENT_CLASS,1,1)= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_type.arr);
	strcat(sql_stmt2.arr,"'");

	if(strcmp(d_episode_type.arr,"O")==0 || strcmp(d_episode_type.arr,"E")==0)
	{
		strcat(sql_stmt2.arr," and OP_EPISODE_VISIT_NUM= ");
		strcat(sql_stmt2.arr,d_visit_id.arr);
	}

	}


	if(strcmp(tab_name.arr,"MP_PATIENT_MAST") == 0)
	{ 
	strcpy(sql_stmt2.arr, "PATIENT_ID = "); ;
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}
	
	if(strcmp(tab_name.arr,"MP_PATIENT") == 0)
	{ 
	
	strcpy(sql_stmt2.arr, "PATIENT_ID = "); ;
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}

	if(strcmp(tab_name.arr,"MP_REGION") == 0) 
	{
	strcpy(sql_stmt2.arr, "REGION_CODE = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_REGION_CODE.arr);
	strcat(sql_stmt2.arr,"'");
    
	}
	
	if(strcmp(tab_name.arr,"SY_ACC_ENTITY") == 0) 
	{
	strcpy(sql_stmt2.arr, "ACC_ENTITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}
	

	if(strcmp(tab_name.arr,"MP_PAT_OTHER_DTLS") == 0) 
	{
	strcpy(sql_stmt2.arr, "PATIENT_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}
	
	if(strcmp(tab_name.arr,"MP_PAT_ADDRESSES") == 0) 
	{
	strcpy(sql_stmt2.arr, "PATIENT_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}

    if(strcmp(tab_name.arr,"MP_RES_AREA") == 0) 
	{
	strcpy(sql_stmt2.arr, "RES_AREA_CODE = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_RES_AREA_CODE.arr);
	strcat(sql_stmt2.arr,"'");
    
	}

//disp_message(ERR_MESG,nd_RES_TOWN_CODE.arr);

	if(strcmp(tab_name.arr,"MP_RES_TOWN") == 0) 
	{
	strcpy(sql_stmt2.arr, "RES_TOWN_CODE = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_RES_TOWN_CODE.arr);
	strcat(sql_stmt2.arr,"'");
    
	}

	if(strcmp(tab_name.arr,"SM_FACILITY_PARAM") == 0) 
	{
    strcpy(sql_stmt2.arr, "FACILITY_ID = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	if(strcmp(tab_name.arr,"SY_ACC_ENTITY") == 0) 
	{
    strcpy(sql_stmt2.arr, "acc_entity_id = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	/********SCRUM CHANGES FOR CRF-23 STARTS HERE*********/

	if(strcmp(tab_name.arr,"BL_BILL_REF_PATCATG_VW") == 0 ) 
	{
   	strcpy(sql_stmt2.arr," OPERATING_FACILITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr, " and DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d1_doc_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUM) =");
	strcat(sql_stmt2.arr,d1_doc_number.arr);
 	}


  	if(strcmp(tab_name.arr,"BL_BILL_REF_SPLTY_VW") == 0 ) 
	{
	strcpy(sql_stmt2.arr,"OPERATING_FACILITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr, "and DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d1_doc_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUM) =");
	strcat(sql_stmt2.arr,d1_doc_number.arr);
 	} 

	/*******CRF-23 UPTO HERE*******/



	strcpy(sql_stmt,sql_stmt1.arr);

	strcat(sql_stmt,sql_stmt2.arr); 

  

/* EXEC SQL EXECUTE
	BEGIN
	 EXECUTE IMMEDIATE :sql_stmt INTO :nd_column_val;
	END;
END-EXEC; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "begin EXECUTE IMMEDIATE :sql_stmt INTO :nd_column_val ; END ;";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )11619;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)sql_stmt;
sqlstm.sqhstl[0] = (unsigned int  )5000;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
sqlstm.sqhstl[1] = (unsigned int  )1002;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




nd_column_val.arr[nd_column_val.len]  ='\0';

//disp_message(ERR_MESG,column_var.arr);
sprintf(st_var,"%d",sqlca.sqlcode);


 	if (OERROR)
	 {
	  column_var.arr[0] = '\0';
	  column_var.len = 0;
      pos_length = pos_var2 - pos_var1 + 1;
	  put_string(dup_var.arr,pos_var1,pos_length);
      strcpy(column_var.arr,ls_str.arr);
	  

	  column_var.len = strlen(column_var.arr);

		
		/* commented for scrum crf-654			
	   if (strcmp(column_var.arr,"+REPRINT_DATE+")==0)
		 {
		
			EXEC SQL SELECT TO_CHAR(SYSDATE,'dd/mm/yyyy') 
				 INTO :nd_curr_date
				FROM dual;
				nd_curr_date.arr[nd_curr_date.len] = '\0';

				if(nd_curr_date.arr[0]!='\0')
				{
				  init_date_temp_var();
				  strcpy(date_convert.arr,nd_curr_date.arr);
				  fun_change_loc_date();
				  strcpy(nd_curr_date.arr,nd_loc_date1.arr);
				  if(nd_print_option.arr[0]=='R')
				  {
				   strcat(nd_line_text.arr,nd_curr_date.arr);
				  }
				  else
				  fprintf(fp,"%s",nd_curr_date.arr);
				 }
		  }

		  	
		  
			
		  if (strcmp(column_var.arr,"+REPRINT_DATE_TIME+")==0)
		 {
		
			EXEC SQL SELECT TO_CHAR(SYSDATE,'dd/mm/yyyy hh24:mi') 
				 INTO :nd_curr_date
				FROM dual;
				nd_curr_date.arr[nd_curr_date.len] = '\0';

				if(nd_print_option.arr[0]=='R')
				strcat(nd_line_text.arr,nd_curr_date.arr);
				else
				fprintf(fp,"%s",nd_curr_date.arr);
				 
		  }

      	 commented for scrum crf-654 added while remerging*/
		
		/***added on 28/10/2009*** added by vani****/
		if (strcmp(column_var.arr,"+ADM_DOCTOR+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			nd_adm_doctor.arr[0] = '\0';
			nd_adm_doctor.len=0;
			if(nd_print_option.arr[0]=='R')
			fun_add_space(31);
			else
			fprintf(fp,"%-31.31s"," ");
			
		 }
		 /***upto here***/

		 if (strcmp(column_var.arr,"+TREATING_DOCTOR+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			if(nd_print_option.arr[0]=='R')
			fun_add_space(31);
			else
			fprintf(fp,"%-31.31s"," ");
			
		 }
		 /***upto here***/

				
		/* if (strcmp(column_var.arr,"+TREATING_DOCTOR+")==0 && strcmp(st_var,"-1405")==0)
		 { 
		 	if(strcmp(nd_adm_doctor.arr,"\0")==0)
			{
			 if(nd_print_option.arr[0]=='R')
			 fun_add_space(31);
			 else
			 fprintf(fp,"%-31.31s"," ");
			}
			else
			{
			  if(nd_print_option.arr[0]=='R') 
			  {
			   strcat(nd_line_text.arr,nd_adm_doctor.arr);
			   if(strlen(nd_adm_doctor.arr)<31)
			   fun_add_space(31-strlen(nd_adm_doctor.arr));
			  }
			  else
			  fprintf(fp,"%-31.31s",nd_adm_doctor.arr);
			}
		 }*/ //commented for medicity testpatch at live time
		
		 
		 if (strcmp(column_var.arr,"+PATIENT_MAIL_ADD1+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			if(nd_print_option.arr[0]=='R') 
			fun_add_space(42);
			else
			fprintf(fp,"%-42.42s"," ");
			
		 }
		 
		 if (strcmp(column_var.arr,"+PATIENT_MAIL_ADD2+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			if(nd_print_option.arr[0]=='R') 
			fun_add_space(42);
			else
			fprintf(fp,"%-42.42s"," ");
			
		 }

		 if (strcmp(column_var.arr,"+PATIENT_MAIL_ADD3+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			if(nd_print_option.arr[0]=='R') 
			fun_add_space(42);
			else
			fprintf(fp,"%-42.42s"," ");
			
		 }

		 if (strcmp(column_var.arr,"+PATIENT_MAIL_ADD4+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			if(nd_print_option.arr[0]=='R') 
			fun_add_space(42);
			else
			fprintf(fp,"%-42.42s"," ");
			
		 }
		
		if (strcmp(column_var.arr,"+PAT_CONTACT_NUM+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			if(nd_print_option.arr[0]=='R') 
			fun_add_space(42);
			else
			fprintf(fp,"%-42.42s"," ");
			
		 }

		 
		 /*if (strcmp(column_var.arr,"+VISIT_ID+")==0 && strcmp(st_var,"-1405")==0)
		 { 
			strcpy(nd_column_val.arr,"1");
			fprintf(fp,"%-s",nd_column_val.arr);
			
		 }*/
		 
		/***added for IN23545***/
		if (strcmp(column_var.arr,"+CREDIT_AUTH_REF_DTL+")==0 || strcmp(column_var.arr,"+CREDIT_AUTH_REF+")==0)
			{
						fprintf(fp,"\n%s/%s",v_credit_auth_ref.arr,v_credit_auth_ref_date.arr);
						
			}
		/*******Upto here********/


		  if((strcmp(st_var,"-1405")!=0) && (strcmp(column_var.arr,"+REPRINT_DATE+")!=0) 
										&& (strcmp(column_var.arr,"+REPRINT_DATE_TIME+")!=0) && (strcmp(column_var.arr,"+CREDIT_AUTH_REF+")!=0) )
		  {	
			if(nd_print_option.arr[0]=='R') 
			strcat(nd_line_text.arr,column_var.arr);
			else
			fprintf(fp,"%s",column_var.arr);
		  }
	  }
    else
	{
        

			 nd_column_val.arr[nd_column_val.len] = '\0';
	
						 
		 if (strcmp(column_var.arr,"PAYER_NAME")==0 && strcmp(nd_column_val.arr,"\0")==0)
		 { 
			/* EXEC SQL select substr(ltrim(decode(:nd_lang_id,'en',SHORT_NAME,SHORT_NAME_LOC_LANG)),1,35) 
			into :nd_column_val 
			from MP_PATIENT_MAST WHERE PATIENT_ID=:d_patient_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(decode(:b0,'en',SHORT_NAME,SHORT_NAME_\
LOC_LANG)),1,35) into :b1  from MP_PATIENT_MAST where PATIENT_ID=:b2";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11642;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[0] = (unsigned int  )6;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
   sqlstm.sqhstl[2] = (unsigned int  )63;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		       if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{	
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}
				
			nd_column_val.arr[nd_column_val.len] = '\0';
		 
		 }
					

		if (strcmp(column_var.arr,"PATIENT_MAIL_ADD1")==0)
		 { 
				
			if (strcmp(nd_column_val.arr,"\0")==0)
			 {
			   if(nd_print_option.arr[0]=='R')
		       fun_add_space(42);
			   else
			   fprintf(fp,"%-42.42s"," ");
			 }
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,42) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,42) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11669;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  fun_add_space(10);
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%-10.10s%-32.32s"," ",nd_column_val.arr);
			 }
			 
		 }
		
		if (strcmp(column_var.arr,"PATIENT_MAIL_ADD2")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			 { 
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(42);
			   else
			   fprintf(fp,"%-42.42s"," ");
		     }
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,42) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,42) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11692;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  fun_add_space(10);
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%-10.10s%-32.32s"," ",nd_column_val.arr);
			}
			
		 }
		 if (strcmp(column_var.arr,"PATIENT_MAIL_ADD3")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(42);
			   else
			   fprintf(fp,"%-42.42s"," ");
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,42) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,42) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11715;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  fun_add_space(10);
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%10.10s%-32.32s"," ",nd_column_val.arr);
			}
			
		 }
		 if (strcmp(column_var.arr,"PATIENT_MAIL_ADD4")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			{ 
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(42);
			   fprintf(fp,"%-42.42s"," ");
			}
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,42) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,42) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11738;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  fun_add_space(10);
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-42.42s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%10.10s%-32.32s"," ",nd_column_val.arr);
			}
			
		 }
		 
		 if (strcmp(column_var.arr,"PAT_CONTACT_NUM")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			{
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(42);
			   fprintf(fp,"%-42.42s"," ");
			}
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,42) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,42) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11761;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  fun_add_space(10);
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
					fprintf(fp,"%10.10s%-32.32s"," ",nd_column_val.arr);
			}
			
		 }
		
		 if (strcmp(column_var.arr,"PAYER_ADDR_LINE1")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			{   
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(32);
			   fprintf(fp,"%-32.32s"," ");
			}
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,32) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,32) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11784;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-32.32s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%-32.32s",nd_column_val.arr);
			}
			
		 }
		
		if (strcmp(column_var.arr,"PAYER_ADDR_LINE2")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			{
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(32);
			   fprintf(fp,"%-32.32s"," ");
			}
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,32) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,32) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11807;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-32.32s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%-32.32s",nd_column_val.arr);
			}
			
		 }
		
		if (strcmp(column_var.arr,"PAYER_ADDR_LINE3")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			{
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(32);
			   fprintf(fp,"%-32.32s"," ");
			}
			else
			{
			/* EXEC SQL select substr(ltrim(:nd_column_val),1,32) into :nd_column_val 
					from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(:b0),1,32) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )11830;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					  strcat(nd_line_text.arr,nd_column_val.arr);
					  if(strlen(nd_column_val.arr)<32)
					  fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-32.32s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%-32.32s",nd_column_val.arr);
			}
			
		 }
		
		if (strcmp(column_var.arr,"PAYER_ADDR_LINE4")==0 )
		 { 
			if (strcmp(nd_column_val.arr,"\0")==0)
			{
			   if(nd_print_option.arr[0]=='R')
			   fun_add_space(32);
			   else
			   fprintf(fp,"%-32.32s"," ");
			}
			else
			{
				/* EXEC SQL select substr(ltrim(:nd_column_val),1,32) into :nd_column_val 
					from dual; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select substr(ltrim(:b0),1,32) into :b0  from dual ";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )11853;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
    sqlstm.sqhstl[0] = (unsigned int  )1002;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
    sqlstm.sqhstl[1] = (unsigned int  )1002;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					nd_column_val.arr[nd_column_val.len] = '\0';
					if(nd_print_option.arr[0]=='R')
					{
					 strcat(nd_line_text.arr,nd_column_val.arr);
					 if(strlen(nd_column_val.arr)<32)
					 fun_add_space(32-strlen(nd_column_val.arr));
					}
					else
						if(strcmp(nd_pad_req_yn.arr,"Y")==0)
							{
								nd_column_val.arr[nd_column_val.len] = '\0';
								nd_desc_with_spl_chr.arr[0] = '\0';
								nd_desc_with_spl_chr.len	=	0;
								fun_Pad_desc_with_spl_char(nd_column_val.arr);
								fprintf(fp,"%-32.32s",nd_desc_with_spl_chr.arr);
								nd_column_val.arr[0] = '\0';
								nd_column_val.len	=0;	
								nd_column_val.arr[nd_column_val.len] = '\0';
							}
							else
							fprintf(fp,"%-32.32s",nd_column_val.arr);
			}
			
		 }
		

		if (strcmp(column_var.arr,"EPISODE_ID")==0 && strcmp(st_var,"-1405")!=0)
		{
		  nd_episode.arr[0]='\0';
		  nd_episode.len=0;
		  if(nd_print_option.arr[0]=='R')
		  strcat(nd_line_text.arr,"/");
		  else
		  fprintf(fp,"/");
		  strcpy(nd_episode.arr,nd_column_val.arr);

		 }
		if (strcmp(column_var.arr,"VISIT_ID")==0 && strcmp(st_var,"-1405")!=0)
		 { 
			if (strcmp(nd_episode.arr,"\0")!=0 )
			{
			 if(nd_print_option.arr[0]=='R')
			 strcat(nd_line_text.arr,"/");
			 else
			 fprintf(fp,"/");	
			}
					
		 }
		
	  if (strcmp(column_var.arr,"PAT_AGE")==0)
		{
		 get_pat_details();
		 sprintf(nd_column_val.arr,"%d",ln_age_year);
		 if(nd_print_option.arr[0]=='R')
		 {
		   strcat(nd_line_text.arr,nd_column_val.arr);
		   if(strlen(nd_column_val.arr)<2)
		   fun_add_space(2-strlen(nd_column_val.arr));
		 }
		 else
		 fprintf(fp,"%-2.2s",nd_column_val.arr);
		 }

		if (strcmp(column_var.arr,"PAT_SEX")==0)
		{		
				nd_pat_sex.arr[0] = '\0';
				nd_pat_sex.len	= 0;
				
			
				strcpy(nd_pat_sex.arr,nd_column_val.arr);
				
				nd_pat_sex.len=strlen(nd_pat_sex.arr);
				nd_pat_sex.arr[nd_pat_sex.len] = '\0';

				nd_column_val.arr[0] = '\0';
				nd_column_val.len	= 0;
				
					
				if (strcmp(nd_pat_sex.arr,"M")==0)
				{
					/* EXEC SQL select substr(COLUMN_VALUE,1.8) into :nd_column_val 
						 from sm_record_trans_data
						 where pk_value='BILL_01.LEGEND_1412'
						 and language_id=:nd_lang_id; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 12;
     sqlstm.arrsiz = 52;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select substr(COLUMN_VALUE,1.8) into :b0  from sm_record\
_trans_data where (pk_value='BILL_01.LEGEND_1412' and language_id=:b1)";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )11876;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)4352;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
     sqlstm.sqhstl[0] = (unsigned int  )1002;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
     sqlstm.sqhstl[1] = (unsigned int  )6;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					 if(NODATAFOUND)
					  {
						/* EXEC SQL select substr(COLUMN_VALUE,1,8) into :nd_column_val 
						 from sm_record_trans_data
						 where pk_value='BILL_01.LEGEND_1412'
						 and language_id='en'; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 52;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select substr(COLUMN_VALUE,1,8) into :b0  from sm_recor\
d_trans_data where (pk_value='BILL_01.LEGEND_1412' and language_id='en')";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )11899;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
      sqlstm.sqhstl[0] = (unsigned int  )1002;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					  }
				
				 }
				 
				if (strcmp(nd_pat_sex.arr,"F")==0)
				{
					/* EXEC SQL select substr(COLUMN_VALUE,1,8) into :nd_column_val 
						 from sm_record_trans_data
						 where pk_value='BILL_01.LEGEND_1413'
						 and language_id=:nd_lang_id; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 12;
     sqlstm.arrsiz = 52;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select substr(COLUMN_VALUE,1,8) into :b0  from sm_record\
_trans_data where (pk_value='BILL_01.LEGEND_1413' and language_id=:b1)";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )11918;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)4352;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
     sqlstm.sqhstl[0] = (unsigned int  )1002;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
     sqlstm.sqhstl[1] = (unsigned int  )6;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					if(NODATAFOUND)
					{
						/* EXEC SQL select substr(COLUMN_VALUE,1,8) into :nd_column_val 
						 from sm_record_trans_data
						 where pk_value='BILL_01.LEGEND_1413'
						 and language_id='en'; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 52;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select substr(COLUMN_VALUE,1,8) into :b0  from sm_recor\
d_trans_data where (pk_value='BILL_01.LEGEND_1413' and language_id='en')";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )11941;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
      sqlstm.sqhstl[0] = (unsigned int  )1002;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

	
					}
				
				 }
				 
				if (strcmp(nd_pat_sex.arr,"U")==0)
				{
					/* EXEC SQL select substr(COLUMN_VALUE,1,8) into :nd_column_val 
						 from sm_record_trans_data
						 where pk_value='BILL_01.LEGEND_1414'
						 and language_id=:nd_lang_id; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 12;
     sqlstm.arrsiz = 52;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select substr(COLUMN_VALUE,1,8) into :b0  from sm_record\
_trans_data where (pk_value='BILL_01.LEGEND_1414' and language_id=:b1)";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )11960;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)4352;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
     sqlstm.sqhstl[0] = (unsigned int  )1002;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
     sqlstm.sqhstl[1] = (unsigned int  )6;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					if(NODATAFOUND)
					 {
						/* EXEC SQL select substr(COLUMN_VALUE,1,8) into :nd_column_val 
						 from sm_record_trans_data
						 where pk_value='BILL_01.LEGEND_1414'
						 and language_id='en'; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 52;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select substr(COLUMN_VALUE,1,8) into :b0  from sm_recor\
d_trans_data where (pk_value='BILL_01.LEGEND_1414' and language_id='en')";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )11983;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
      sqlstm.sqhstl[0] = (unsigned int  )1002;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


					 }
				
				 }
		
		/*EXEC SQL select decode(:nd_column_val,'M','Male','F','Female','U','Unknown')
					into  :nd_column_val from dual;*/

		nd_column_val.arr[nd_column_val.len] = '\0';

		if(nd_print_option.arr[0]=='R')
		{
		  strcat(nd_line_text.arr,nd_column_val.arr);
		  if(strlen(nd_column_val.arr)<6)
		  fun_add_space(6-strlen(nd_column_val.arr));
		}
		else
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%-8.8s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}
				else
			 	fprintf(fp,"%-7.7s",nd_column_val.arr);
		
	   }


        
		//ADDED FOR SCRUM CRF-654
			if (strcmp(column_var.arr,"PATIENT_ID")==0)
			{
			
			strcpy(nd_column_val.arr,d_patient_id.arr);
			fprintf(fp,"%-20.20s",nd_column_val.arr);
			}

			if (strcmp(column_var.arr,"EPISODE_TYPE")==0)
			{
			strcpy(nd_column_val.arr,d_episode_type.arr);
			} 

			if (strcmp(column_var.arr,"EPISODE_ID")==0)
			{
			
			strcpy(nd_column_val.arr,d_episode_id.arr); //ADDED FOR SCRUM CRF-654

			} 

		//added for scrum crf-654

		 if (strcmp(column_var.arr,"POLICY_TYPE_CODE")==0)
		{
		/* EXEC SQL select substr(long_desc,1,30) 
					into  :nd_column_val 
					from BL_INS_POLICY_TYPES_lang_vw
					where  POLICY_TYPE_CODE=:nd_column_val
					and language_id=:nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(long_desc,1,30) into :b0  from BL_INS_POLICY_\
TYPES_lang_vw where (POLICY_TYPE_CODE=:b0 and language_id=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )12002;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[0] = (unsigned int  )1002;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[1] = (unsigned int  )1002;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		

				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%-30.30s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}
				nd_column_val.arr[nd_column_val.len] = '\0';
		
		 }
		
		if (strcmp(column_var.arr,"BLNG_GRP_DESC")==0)
		{
		/* EXEC SQL select substr(long_desc,1,30) 
					into  :nd_column_val 
					from BL_BLNG_GRP_LANG_VW
					where  blng_grp_id=:nd_column_val
					and language_id=:nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(long_desc,1,30) into :b0  from BL_BLNG_GRP_LA\
NG_VW where (blng_grp_id=:b0 and language_id=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )12029;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[0] = (unsigned int  )1002;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[1] = (unsigned int  )1002;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


				nd_column_val.arr[nd_column_val.len] = '\0';

				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%-40.40s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}
		nd_column_val.arr[nd_column_val.len] = '\0';
		
		 }

		 if (strcmp(column_var.arr,"HOSP_NAME")==0)
			 {
				nd_column_val.arr[0]  ='\0';
				nd_column_val.len	  =0;

				/* EXEC SQL select  ACC_ENTITY_NAME
								into
								:nd_column_val
							   from sy_acc_entity_lang_vw
							   where acc_entity_id = :nd_facility_id
							   and	  language_id   = :nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ACC_ENTITY_NAME into :b0  from sy_acc_entity_lang_\
vw where (acc_entity_id=:b1 and language_id=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )12056;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
    sqlstm.sqhstl[0] = (unsigned int  )1002;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[2] = (unsigned int  )6;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


				
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}		
			
				nd_column_val.arr[nd_column_val.len] = '\0';
				
			 }

        if (strcmp(column_var.arr,"HOSP_ADD_LINE1")==0)
			 {
				nd_column_val.arr[0]  ='\0';
				nd_column_val.len	  =0;

				/* EXEC SQL select  ADDR_LINE1
								into :nd_column_val
							   from sm_facility_param_lang_vw
							   where FACILITY_ID = :nd_facility_id
							   and	 language_id   = :nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ADDR_LINE1 into :b0  from sm_facility_param_lang_v\
w where (FACILITY_ID=:b1 and language_id=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )12083;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
    sqlstm.sqhstl[0] = (unsigned int  )1002;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[2] = (unsigned int  )6;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%-40.40s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}		
			
				nd_column_val.arr[nd_column_val.len] = '\0';
				
			 }


			 if (strcmp(column_var.arr,"HOSP_ADD_LINE2")==0)
			 {
				nd_column_val.arr[0]  ='\0';
				nd_column_val.len	  =0;

				/* EXEC SQL select  ADDR_LINE2
								into :nd_column_val
							   from sm_facility_param_lang_vw
							   where FACILITY_ID = :nd_facility_id
							   and	  language_id   = :nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ADDR_LINE2 into :b0  from sm_facility_param_lang_v\
w where (FACILITY_ID=:b1 and language_id=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )12110;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
    sqlstm.sqhstl[0] = (unsigned int  )1002;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[2] = (unsigned int  )6;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




	
				
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%-40.40s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}		
			
				nd_column_val.arr[nd_column_val.len] = '\0';
				
			 }
			
			if (strcmp(column_var.arr,"HOSP_ADD_LINE3")==0)
			 {
				nd_column_val.arr[0]  ='\0';
				nd_column_val.len	  =0;

				/* EXEC SQL select  ADDR_LINE3
								into
								:nd_column_val
							   from sm_facility_param_lang_vw
							   where FACILITY_ID = :nd_facility_id
							   and	  language_id   = :nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ADDR_LINE3 into :b0  from sm_facility_param_lang_v\
w where (FACILITY_ID=:b1 and language_id=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )12137;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
    sqlstm.sqhstl[0] = (unsigned int  )1002;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[2] = (unsigned int  )6;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




			
				
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%-40.40s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}		
			
				nd_column_val.arr[nd_column_val.len] = '\0';
				
			 }


			 if (strcmp(column_var.arr,"HOSP_ADD_LINE4")==0)
			 {
				nd_column_val.arr[0]  ='\0';
				nd_column_val.len	  =0;

				/* EXEC SQL select  ADDR_LINE4
								into
								:nd_column_val
							   from sm_facility_param_lang_vw
							   where FACILITY_ID = :nd_facility_id
							   and	  language_id   = :nd_lang_id; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select ADDR_LINE4 into :b0  from sm_facility_param_lang_v\
w where (FACILITY_ID=:b1 and language_id=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )12164;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
    sqlstm.sqhstl[0] = (unsigned int  )1002;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
    sqlstm.sqhstl[1] = (unsigned int  )5;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
    sqlstm.sqhstl[2] = (unsigned int  )6;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




						
				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_column_val.arr[nd_column_val.len] = '\0';
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%-40.40s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}		
			
				nd_column_val.arr[nd_column_val.len] = '\0';
				
			 }
		
		if (strcmp(column_var.arr,"PATIENT_ID")==0)
		{
		
		/* EXEC SQL select substr(:nd_column_val,1,20) into :nd_column_val from dual; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(:b0,1,20) into :b0  from dual ";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )12191;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[0] = (unsigned int  )1002;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[1] = (unsigned int  )1002;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		nd_column_val.arr[nd_column_val.len] = '\0';
			if(nd_print_option.arr[0]=='R')
			{
			 strcat(nd_line_text.arr,nd_column_val.arr);
			 if(strlen(nd_column_val.arr)<20)
			 fun_add_space(20-strlen(nd_column_val.arr));
			}
			else
			fprintf(fp,"%-20.20s",nd_column_val.arr);
		}

		 if (strcmp(column_var.arr,"PATIENT_NAME")==0)
		{
			//EXEC SQL select substr(:nd_column_val,1,40) into :nd_column_val from dual;
			/* EXEC SQL select substr(ltrim(decode(:nd_lang_id,'en',SHORT_NAME,SHORT_NAME_LOC_LANG)),1,40) 
			into :nd_column_val 
			from MP_PATIENT_MAST WHERE PATIENT_ID=:d_patient_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(ltrim(decode(:b0,'en',SHORT_NAME,SHORT_NAME_\
LOC_LANG)),1,40) into :b1  from MP_PATIENT_MAST where PATIENT_ID=:b2";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )12214;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[0] = (unsigned int  )6;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&d_patient_id;
   sqlstm.sqhstl[2] = (unsigned int  )63;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			nd_column_val.arr[nd_column_val.len] = '\0';
			
		 if(strcmp(d_cust_code.arr,"\0")==0 && (strcmp(d_bill_nature_code.arr,"C")==0))
		   if (l_lsr != 0 && l_dmp == 0)
			fprintf(fp,"%c(s3B",ESC);
			if(nd_print_option.arr[0]=='R')
			{
			  strcat(nd_line_text.arr,nd_column_val.arr);
			  if(strlen(nd_column_val.arr)<40)
			  fun_add_space(40-strlen(nd_column_val.arr));
			}
			else
		   	if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			{
				nd_desc_with_spl_chr.arr[0] = '\0';
				nd_desc_with_spl_chr.len	=	0;
				fun_Pad_desc_with_spl_char(nd_column_val.arr);
				fprintf(fp,"%-40.40s",nd_desc_with_spl_chr.arr);
				nd_column_val.arr[0] = '\0';
				nd_column_val.len	=0;	
			}		
            else
			fprintf(fp,"%-40.40s",nd_column_val.arr);
		 }
		
		if (strcmp(column_var.arr,"ADM_DOCTOR")==0)
		{ 
			nd_adm_doctor.arr[0]='\0';
			  nd_adm_doctor.len=0;
			
			
			  /* EXEC SQL select substr(FULL_NAME,1,31) into :nd_column_val
				 from sy_physician_mast_lang_vw
				where PHYSICIAN_ID=:nd_column_val
				and facility_id=:nd_facility_id
				and language_id=:nd_lang_id; */ 

{
     struct sqlexd sqlstm;
     sqlstm.sqlvsn = 12;
     sqlstm.arrsiz = 52;
     sqlstm.sqladtp = &sqladt;
     sqlstm.sqltdsp = &sqltds;
     sqlstm.stmt = "select substr(FULL_NAME,1,31) into :b0  from sy_physicia\
n_mast_lang_vw where ((PHYSICIAN_ID=:b0 and facility_id=:b2) and language_id=:\
b3)";
     sqlstm.iters = (unsigned int  )1;
     sqlstm.offset = (unsigned int  )12241;
     sqlstm.selerr = (unsigned short)1;
     sqlstm.cud = sqlcud0;
     sqlstm.sqlest = (unsigned char  *)&sqlca;
     sqlstm.sqlety = (unsigned short)4352;
     sqlstm.occurs = (unsigned int  )0;
     sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
     sqlstm.sqhstl[0] = (unsigned int  )1002;
     sqlstm.sqhsts[0] = (         int  )0;
     sqlstm.sqindv[0] = (         void  *)0;
     sqlstm.sqinds[0] = (         int  )0;
     sqlstm.sqharm[0] = (unsigned int  )0;
     sqlstm.sqadto[0] = (unsigned short )0;
     sqlstm.sqtdso[0] = (unsigned short )0;
     sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
     sqlstm.sqhstl[1] = (unsigned int  )1002;
     sqlstm.sqhsts[1] = (         int  )0;
     sqlstm.sqindv[1] = (         void  *)0;
     sqlstm.sqinds[1] = (         int  )0;
     sqlstm.sqharm[1] = (unsigned int  )0;
     sqlstm.sqadto[1] = (unsigned short )0;
     sqlstm.sqtdso[1] = (unsigned short )0;
     sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
     sqlstm.sqhstl[2] = (unsigned int  )5;
     sqlstm.sqhsts[2] = (         int  )0;
     sqlstm.sqindv[2] = (         void  *)0;
     sqlstm.sqinds[2] = (         int  )0;
     sqlstm.sqharm[2] = (unsigned int  )0;
     sqlstm.sqadto[2] = (unsigned short )0;
     sqlstm.sqtdso[2] = (unsigned short )0;
     sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
     sqlstm.sqhstl[3] = (unsigned int  )6;
     sqlstm.sqhsts[3] = (         int  )0;
     sqlstm.sqindv[3] = (         void  *)0;
     sqlstm.sqinds[3] = (         int  )0;
     sqlstm.sqharm[3] = (unsigned int  )0;
     sqlstm.sqadto[3] = (unsigned short )0;
     sqlstm.sqtdso[3] = (unsigned short )0;
     sqlstm.sqphsv = sqlstm.sqhstv;
     sqlstm.sqphsl = sqlstm.sqhstl;
     sqlstm.sqphss = sqlstm.sqhsts;
     sqlstm.sqpind = sqlstm.sqindv;
     sqlstm.sqpins = sqlstm.sqinds;
     sqlstm.sqparm = sqlstm.sqharm;
     sqlstm.sqparc = sqlstm.sqharc;
     sqlstm.sqpadto = sqlstm.sqadto;
     sqlstm.sqptdso = sqlstm.sqtdso;
     sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				
			nd_column_val.arr[nd_column_val.len] = '\0';

			strcpy(nd_adm_doctor.arr,nd_column_val.arr);

			//nd_adm_doctor.len=strlen(nd_adm_doctor.arr);
				
			//nd_adm_doctor.arr[nd_adm_doctor.len] = '\0';

			//disp_message(ERR_MESG,nd_adm_doctor.arr);

			if(nd_print_option.arr[0]=='R')
			{
			 strcat(nd_line_text.arr,nd_column_val.arr);
			 if(strlen(nd_column_val.arr)<31)
		     fun_add_space(31-strlen(nd_column_val.arr));
			}
			else
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			{
				nd_desc_with_spl_chr.arr[0] = '\0';
				nd_desc_with_spl_chr.len	=	0;
				fun_Pad_desc_with_spl_char(nd_column_val.arr);
				fprintf(fp,"%-31.31s",nd_desc_with_spl_chr.arr);
				nd_column_val.arr[0] = '\0';
				nd_column_val.len	=0;	
			}
			else
			fprintf(fp,"%-31.31s",nd_column_val.arr);  //added for medicity test patch patch at live time
						

		}
		
		if (strcmp(column_var.arr,"TREATING_DOCTOR")==0)
		{
			/* EXEC SQL select substr(FULL_NAME,1,31) into :nd_column_val
			 from sy_physician_mast_lang_vw
			where PHYSICIAN_ID=:nd_column_val
			and facility_id=:nd_facility_id
			and language_id=:nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(FULL_NAME,1,31) into :b0  from sy_physician_\
mast_lang_vw where ((PHYSICIAN_ID=:b0 and facility_id=:b2) and language_id=:b3\
)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )12272;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_facility_id;
   sqlstm.sqhstl[2] = (unsigned int  )5;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[3] = (unsigned int  )6;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

 

			nd_column_val.arr[nd_column_val.len] = '\0';
			if(nd_print_option.arr[0]=='R')
			{
			 strcat(nd_line_text.arr,nd_column_val.arr);
			 if(strlen(nd_column_val.arr)<31)
		     fun_add_space(31-strlen(nd_column_val.arr));
			}
			else
			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			{
				nd_desc_with_spl_chr.arr[0] = '\0';
				nd_desc_with_spl_chr.len	=	0;
				fun_Pad_desc_with_spl_char(nd_column_val.arr);
				fprintf(fp,"%-31.31s",nd_desc_with_spl_chr.arr);
				nd_column_val.arr[0] = '\0';
				nd_column_val.len	=0;	
			}
			else
			fprintf(fp,"%-31.31s",nd_column_val.arr); //added for medicity test patch patch at live time
			
			
			/* if (strcmp(nd_adm_doctor.arr,"\0")==0)
			fprintf(fp,"%-31.31s",nd_column_val.arr);
			
			if (strcmp(nd_adm_doctor.arr,"\0")!=0 && strcmp(nd_adm_doctor.arr,nd_column_val.arr)==0)
				fprintf(fp,"%-31.31s",nd_adm_doctor.arr);
					
			if(strcmp(nd_adm_doctor.arr,nd_column_val.arr)!=0 && strcmp(nd_adm_doctor.arr,"\0")!=0)
			{ */


				/*if (strcmp(nd_column_val.arr,"\0")!=0)
				{
				strcat(nd_adm_doctor1.arr,"/");
				strcat(nd_adm_doctor1.arr,nd_column_val.arr);
				fprintf(fp,"%-31.31s",nd_adm_doctor1.arr);
				}
				else
				fprintf(fp,"%-31.31s",nd_adm_doctor.arr);*/

				/*fprintf(fp,"%-31.31s",nd_adm_doctor.arr);
				if (strcmp(nd_column_val.arr,"\0")!=0)
				fprintf(fp,"\n%-14.14s %-31.31s"," ",nd_column_val.arr);
			
			} */  //commented for medicity test patch patch at live time
			
			
		}


		if (strcmp(column_var.arr,"COUNTER_NUM")==0)
		{
		/* EXEC SQL select substr(:nd_column_val,1,4) into :nd_column_val from dual; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(:b0,1,4) into :b0  from dual ";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )12303;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[0] = (unsigned int  )1002;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
  sqlstm.sqhstl[1] = (unsigned int  )1002;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		nd_column_val.arr[nd_column_val.len] = '\0';
		if(nd_print_option.arr[0]=='R')
		{
		 strcat(nd_line_text.arr,nd_column_val.arr);
		 if(strlen(nd_column_val.arr)<4)
		 fun_add_space(4-strlen(nd_column_val.arr));
		}
		else
		fprintf(fp,"%-4.4s",nd_column_val.arr);
		}
		
		if (strcmp(column_var.arr,"COUNTER_BLDG")==0)
		{
		nd_counter_bldg.arr[0]='\0';
		nd_counter_bldg.len=0;
		strcpy(nd_counter_bldg.arr,nd_column_val.arr);
		
		}

		
		if (strcmp(column_var.arr,"COUNTER_FLOOR")==0)
		{
		 if (strcmp(nd_counter_bldg.arr,"\0")!=0 )
		  {	
			if(nd_print_option.arr[0]=='R')
			strcat(nd_line_text.arr,"/");
			else
			fprintf(fp,"/");
		  }
		}

		if (strcmp(column_var.arr,"PREPARED_BY")==0)
		 {
		      // strcpy(nd_column_val.arr,v_user_id.arr); //added for scrum remerging
			  	/* EXEC SQL SELECT DISTINCT APPL_USER_NAME
				 INTO  :nd_column_val
				 FROM   SM_APPL_USER_LANG 
				 WHERE  APPL_USER_ID=:v_user_id //:nd_column_val
				AND	 LANGUAGE_ID  =:nd_lang_id; */ 

{
      struct sqlexd sqlstm;
      sqlstm.sqlvsn = 12;
      sqlstm.arrsiz = 52;
      sqlstm.sqladtp = &sqladt;
      sqlstm.sqltdsp = &sqltds;
      sqlstm.stmt = "select distinct APPL_USER_NAME into :b0  from SM_APPL_U\
SER_LANG where (APPL_USER_ID=:b1 and LANGUAGE_ID=:b2)";
      sqlstm.iters = (unsigned int  )1;
      sqlstm.offset = (unsigned int  )12326;
      sqlstm.selerr = (unsigned short)1;
      sqlstm.cud = sqlcud0;
      sqlstm.sqlest = (unsigned char  *)&sqlca;
      sqlstm.sqlety = (unsigned short)4352;
      sqlstm.occurs = (unsigned int  )0;
      sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
      sqlstm.sqhstl[0] = (unsigned int  )1002;
      sqlstm.sqhsts[0] = (         int  )0;
      sqlstm.sqindv[0] = (         void  *)0;
      sqlstm.sqinds[0] = (         int  )0;
      sqlstm.sqharm[0] = (unsigned int  )0;
      sqlstm.sqadto[0] = (unsigned short )0;
      sqlstm.sqtdso[0] = (unsigned short )0;
      sqlstm.sqhstv[1] = (         void  *)&v_user_id;
      sqlstm.sqhstl[1] = (unsigned int  )33;
      sqlstm.sqhsts[1] = (         int  )0;
      sqlstm.sqindv[1] = (         void  *)0;
      sqlstm.sqinds[1] = (         int  )0;
      sqlstm.sqharm[1] = (unsigned int  )0;
      sqlstm.sqadto[1] = (unsigned short )0;
      sqlstm.sqtdso[1] = (unsigned short )0;
      sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
      sqlstm.sqhstl[2] = (unsigned int  )6;
      sqlstm.sqhsts[2] = (         int  )0;
      sqlstm.sqindv[2] = (         void  *)0;
      sqlstm.sqinds[2] = (         int  )0;
      sqlstm.sqharm[2] = (unsigned int  )0;
      sqlstm.sqadto[2] = (unsigned short )0;
      sqlstm.sqtdso[2] = (unsigned short )0;
      sqlstm.sqphsv = sqlstm.sqhstv;
      sqlstm.sqphsl = sqlstm.sqhstl;
      sqlstm.sqphss = sqlstm.sqhsts;
      sqlstm.sqpind = sqlstm.sqindv;
      sqlstm.sqpins = sqlstm.sqinds;
      sqlstm.sqparm = sqlstm.sqharm;
      sqlstm.sqparc = sqlstm.sqharc;
      sqlstm.sqpadto = sqlstm.sqadto;
      sqlstm.sqptdso = sqlstm.sqtdso;
      sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				if(strcmp(nd_pad_req_yn.arr,"Y")==0)
				{
					nd_desc_with_spl_chr.arr[0] = '\0';
					nd_desc_with_spl_chr.len	=	0;
					fun_Pad_desc_with_spl_char(nd_column_val.arr);
					fprintf(fp,"%s",nd_desc_with_spl_chr.arr);
					nd_column_val.arr[0] = '\0';
					nd_column_val.len	=0;	
				}
				
				nd_column_val.arr[nd_column_val.len] = '\0';

		  }
		


		if (strcmp(column_var.arr,"PAYER_NAME")==0 && strcmp(nd_column_val.arr,"\0")!=0)
		{
		    nd_column_val.arr[0] = '\0';
			nd_column_val.len	= 0;

			/* EXEC SQL select short_name 
					 into :nd_column_val
					 from ar_customer_lang_vw
					 where cust_code=:d_cust_code
					 and LANGUAGE_ID  =:nd_lang_id; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select short_name into :b0  from ar_customer_lang_vw where\
 (cust_code=:b1 and LANGUAGE_ID=:b2)";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )12353;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&d_cust_code;
   sqlstm.sqhstl[1] = (unsigned int  )27;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
   sqlstm.sqhstl[2] = (unsigned int  )6;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			
			nd_column_val.len = strlen(nd_column_val.arr);
			nd_column_val.arr[nd_column_val.len] = 0;

			/* EXEC SQL select substr(:nd_column_val,1,39) into :nd_column_val from dual; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select substr(:b0,1,39) into :b0  from dual ";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )12380;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[0] = (unsigned int  )1002;
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			

			if(strcmp(nd_pad_req_yn.arr,"Y")==0)
			{
				nd_desc_with_spl_chr.arr[0] = '\0';
				nd_desc_with_spl_chr.len	=	0;
				fun_Pad_desc_with_spl_char(nd_column_val.arr);
				fprintf(fp,"%s",nd_desc_with_spl_chr.arr);
				nd_column_val.arr[0] = '\0';
				nd_column_val.len	=0;	
			}
			nd_column_val.arr[nd_column_val.len] = '\0';	
			if(strcmp(d_cust_code.arr,"\0")!=0 && (strcmp(d_bill_nature_code.arr,"A")==0))
		   if (l_lsr != 0 && l_dmp == 0)
			fprintf(fp,"%c(s3B",ESC);
		 }


			//ADDED FOR SCRUM CRF-654
			if (strcmp(column_var.arr,"BED_NUM")==0)
			{
			strcpy(nd_column_val.arr,v_cur_bed_num.arr);
			}
			//ADDED FOR SCRUM CRF-654

			//ADDED FOR SCRUM CRF-654
		/*	if (strcmp(column_var.arr,"PREPARED_BY")==0)
			{
			
			strcpy(nd_column_val.arr,v_user_id.arr);
			}*/ //commented for remerging scrum


			if (strcmp(column_var.arr,"CREDIT_DOC_REF_DESC")==0)
			{
			
			strcpy(nd_column_val.arr,v_credit_doc_ref_desc.arr);
			}

			if (strcmp(column_var.arr,"CREDIT_AUTH_REF_DTL")==0 || strcmp(column_var.arr,"CREDIT_AUTH_REF")==0)
			{
						fprintf(fp,"\n");
						strcpy(nd_column_val.arr,v_credit_auth_ref.arr);
						strcat(nd_column_val.arr,"/");
						strcat(nd_column_val.arr,v_credit_auth_ref_date.arr);
			}

			if (strcmp(column_var.arr,"POLICY_NO")==0)
			{
						strcpy(nd_column_val.arr,v_policy_no.arr);
			}

			//ADDED FOR SCRUM CRF-654

	
		
     
	if (strcmp(column_var.arr,"PATIENT_NAME")!=0 && strcmp(column_var.arr,"PATIENT_ID")!=0 && strcmp(column_var.arr,"ADM_DOCTOR")!=0 && strcmp(column_var.arr,"TREATING_DOCTOR")!=0 
				&& strcmp(column_var.arr,"COUNTER_NUM")!=0 && strcmp(column_var.arr,"PATIENT_MAIL_ADD1")!=0 && strcmp(column_var.arr,"PATIENT_MAIL_ADD2")!=0 
				&& strcmp(column_var.arr,"PATIENT_MAIL_ADD3")!=0 && strcmp(column_var.arr,"PATIENT_MAIL_ADD4")!=0
				&& strcmp(column_var.arr,"PAT_CONTACT_NUM")!=0
				&& strcmp(column_var.arr,"PAYER_ADDR_LINE1")!=0
				&& strcmp(column_var.arr,"PAYER_ADDR_LINE2")!=0
				&& strcmp(column_var.arr,"PAYER_ADDR_LINE3")!=0
				&& strcmp(column_var.arr,"PAYER_ADDR_LINE4")!=0
				&& strcmp(column_var.arr,"PAT_SEX")!=0
				&& strcmp(column_var.arr,"PAT_AGE")!=0)
	{
	
	 if(nd_print_option.arr[0]=='R')
	 strcat(nd_line_text.arr,nd_column_val.arr);
	 else
	 fprintf(fp,"%-s",nd_column_val.arr); //Final values are printing here only
    }

	if ((strcmp(column_var.arr,"PAYER_NAME")==0 && strcmp(nd_column_val.arr,"\0")!=0 )|| (strcmp(column_var.arr,"PATIENT_NAME")==0))
	fprintf(fp,"%c(s-3B",ESC);

    }

	print_upto = pos_var2;
	i = pos_var2+1;  
	
    pos_var1 = 0;
	pos_var2 = 0;

	pos_var = char_position(dup_var.arr,"+",i);
    }
   } 
} 

check_splch(str_var1)
char str_var1[101];
{
 prt_len = 0;
 spchar_pos = 0;
 spchar_pos1 = 0;
 lc_str_val.arr[0]	='\0';
 lc_str_val.len		= 0;
 lc_str_var.arr[0]	='\0';
 lc_str_var.len		= 0;
 
 ctr = 1;
 print_upto_c = 0;
 strcpy(lc_str_val.arr,str_var1);
 lc_str_val.len = strlen(lc_str_val.arr);
 len_lc_str_val = strlen(lc_str_val.arr);


 while(ctr <= len_lc_str_val)
 {
 prt_len = 0;
 spchar_pos = 0;
 spchar_pos1 = 0;
 
 
 spchar_pos = chk_esc_pos(lc_str_val.arr,ctr);
 
 spchar_pos1 = chk_nwln_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0  && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 1;
   }

 spchar_pos1 = chk_cp_nwln_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 2;
   }

 
 spchar_pos1 = chk_tab_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 3;
   }

 spchar_pos1 = chk_bold_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 4;
   }

 spchar_pos1 = chk_font_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 5;
   }

spchar_pos1 = chk_line_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 6;
   }

spchar_pos1 = chk_uline_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 7;
   }


 if (spchar_pos == 0)   
 {
 lc_str_var.arr[0]	='\0';
 lc_str_var.len		= 0;
 prt_len = len_lc_str_val - print_upto_c ;

 put_string(lc_str_val.arr,print_upto_c + 1,prt_len);
 strcpy(lc_str_var.arr,ls_str.arr);

 lc_str_var.len=strlen(lc_str_var.arr);

 if(nd_print_option.arr[0]=='R')
 {
  strcat(nd_line_text.arr,lc_str_var.arr);
 }
 else
 {

    if(strcmp(nd_pad_req_yn.arr,"Y")==0)
	{
		nd_desc_with_spl_chr.arr[0] = '\0';
		nd_desc_with_spl_chr.len	=	0;
		
		fun_Pad_desc_with_spl_char_1(lc_str_var.arr);
		fprintf(fp,"%s",nd_desc_with_spl_chr.arr);
	}
	else
	fprintf(fp,"%s",lc_str_var.arr);

 }
 ctr = len_lc_str_val+1;
 print_upto_c = len_lc_str_val;
 }
 else
 {
 lc_str_var.arr[0]	='\0';
 lc_str_var.len		= 0;

 prt_len = spchar_pos - print_upto_c -1;
 
 put_string(lc_str_val.arr,print_upto_c+1,prt_len);
 strcpy(lc_str_var.arr,ls_str.arr);
 lc_str_var.len = strlen(lc_str_var.arr);

  if(nd_print_option.arr[0]=='R')
  {
   strcat(nd_line_text.arr,lc_str_var.arr);
  }
  else
  if(strcmp(nd_pad_req_yn.arr,"Y")==0)
	{
		nd_desc_with_spl_chr.arr[0] = '\0';
		nd_desc_with_spl_chr.len	=	0;
		fun_Pad_desc_with_spl_char_1(lc_str_var.arr);
		fprintf(fp,"%s",nd_desc_with_spl_chr.arr);
	
	}
  else
  fprintf(fp,"%s",lc_str_var.arr);
  
  if (spchar_type == 1)
  {
	 if(nd_print_option.arr[0]=='R')
	 {
	  strcat(nd_line_text.arr,"\n");
	  fun_bl_report_temp_format();
	 }
	 else
	 fprintf(fp,"\n");
	 line_ctr++;
  }

  if (spchar_type == 2)
  {
  	 if(nd_print_option.arr[0]=='R')
	 {
	  fun_bl_report_temp_format();
	 }
	 else
	 fprintf(fp,"\n");
	 line_ctr++;
  }

  if (spchar_type == 3)
  {
     if(nd_print_option.arr[0]=='R')
	 {
	  strcat(nd_line_text.arr,"        ");
 
     }
     else
     fprintf(fp,"        ");
  }
  if (spchar_type == 4)
  {
	if (bold_st)
	{
	  fprintf(fp,"%c(s-3B",ESC); /* release bold style */
	  bold_st = 0;
	}
    else
	{
	  fprintf(fp,"%c(s3B",ESC); 	/* To set Bold style 			*/
	  bold_st = 1;
	}
  }

  if (spchar_type == 5)
  {
	if (font_st)
	{
	fprintf(fp,"%c(s14H",ESC); 	/* To set the font 			*/
	font_st = 0;
	}
    else
	{
	fprintf(fp,"%c(s10H",ESC); 	/* To set the font 			*/
	font_st = 1;
	}
  }
if (spchar_type == 6)
  {
	prt_line_uc_wide();
  }

  if (spchar_type == 7)
  {
	if (uline_st)
	{
	
	fprintf (fp,"%c&d0D",ESC); 	/* To set the underline 			*/
	uline_st = 0;
	}
    else
	{
	fprintf (fp,"%c&d@",ESC); 	/* To set the underline 			*/
	uline_st = 1;
	}
  }

  ctr = spchar_pos+2;
  print_upto_c = spchar_pos+1;
  }  
 }

}

int chk_tab_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;
splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\t',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\t',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12403;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

int chk_nwln_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;

splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\n',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\n',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12430;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

int chk_cp_nwln_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;

splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\N',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\N',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12457;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

int chk_bold_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;
splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\b',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\b',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12484;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

int chk_font_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;
splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\f',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\f',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12511;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

int chk_line_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;
splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\l',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\l',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12538;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

int chk_uline_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;
splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\u',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\u',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12565;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}
int chk_esc_pos(str_var2,st_pos)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;
splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'\',:st_pos)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'\\',:b1) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12592;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&st_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&splch_pos;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

int chk_date_yn(str_var2)
char str_var2[101];
{
lc_splch_var.arr[0] = '\0';
lc_splch_var.len = 0;
splch_pos = 0;

 strcpy(lc_splch_var.arr,str_var2);
 lc_splch_var.len = strlen(lc_splch_var.arr);
 
 /* EXEC SQL select instr(:lc_splch_var,'DATE',1)
   into :splch_pos
   from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,'DATE',1) into :b1  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12619;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&lc_splch_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&splch_pos;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 return(splch_pos);
}

check_page_end(l_lead_lines, l_print_flag)
int l_lead_lines;
int	l_print_flag;
{
	if(l_print_flag==1)
		l_lead_lines=l_lead_lines+10;

	if((line_ctr+l_lead_lines)> 55) 
	{
		fprintf(fp,"%-70s %s %d\n"," ","Contd...",++pctr);
		fprintf(fp,"\f");
		fprintf(fp,"%-45s Page : %d\n\n"," ",pctr);
		line_ctr = 2;
		print_title();
	}
}

int char_position(ls_var,lc_var,ld_var)
char ls_var[101];
char lc_var[3];
int ld_var;
{
 ls_str_var.arr[0] = '\0';
 ls_str_var.len = 0;

 ls_char_var.arr[0] = '\0';
 ls_char_var.len = 0;

 strcpy(ls_str_var.arr,ls_var);
 strcpy(ls_char_var.arr,lc_var);

 ls_str_var.len = strlen(ls_str_var.arr);
 ls_char_var.len = strlen(ls_char_var.arr);

  
 /* EXEC SQL select instr(:ls_str_var,:ls_char_var,:ld_var)
	         into :char_pos
			 from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select instr(:b0,:b1,:b2) into :b3  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12642;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&ls_str_var;
 sqlstm.sqhstl[0] = (unsigned int  )103;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&ls_char_var;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&ld_var;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&char_pos;
 sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


 
 if (OERROR)
        err_mesg("SELECT failed on table DUAL",0,"");

 
 ld_var = 0;
 return(char_pos);
}

print_bill_footer()
{

if (bl_footer_line_01.arr[0] != '\0')
      {
		print_line(bl_footer_line_01.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bl_footer_line_02.arr[0] != '\0')
      {
		print_line(bl_footer_line_02.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bl_footer_line_03.arr[0] != '\0')
      {
		print_line(bl_footer_line_03.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bl_footer_line_04.arr[0] != '\0')
      {
		print_line(bl_footer_line_04.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }

}

fun_change_loc_date2()
{

strcpy(nd_temp_date.arr,date_convert.arr);
nd_temp_date.len = strlen(nd_temp_date.arr);

get_local_date2();
nd_loc_date.arr[nd_loc_date.len]='\0';

}

get_local_date2()
{
	
	/* EXEC SQL EXECUTE

	DECLARE

	t_date  date;
	
	BEGIN
		get_locale_date.convert_to_locale_date(to_date(:nd_temp_date,'DD/MM/YY'),:nd_lang_id,t_date);

		 :nd_loc_date:= to_char(t_date,'DD/MM/YYYY');


	END;

	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "declare t_date date ; BEGIN get_locale_date . convert_to_loc\
ale_date ( to_date ( :nd_temp_date , 'DD/MM/YY' ) , :nd_lang_id , t_date ) ; :\
nd_loc_date := to_char ( t_date , 'DD/MM/YYYY' ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12673;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_temp_date;
 sqlstm.sqhstl[0] = (unsigned int  )22;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[1] = (unsigned int  )6;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_loc_date;
 sqlstm.sqhstl[2] = (unsigned int  )22;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


     		
		if (OERROR)
        err_mesg("SELECTING Date failed",0,"");


}


fun_amt_in_words1()
{
 	amt_in_words.arr[0]='\0';
	amt_in_words.len=0;
	
	amt_in_words_Sep.arr[0]='\0';
	amt_in_words_Sep.len=0;
						 //abs(nvl(:nd_tot_pat_net_charge_amt,0)),
	/* EXEC SQL EXECUTE
	BEGIN		
	:no_of_lines1:=bl_spell_number.print_in_words
						(:nd_facility_id,
						  abs(nvl(:amount,0)),
						  70,
						 :currency,
						 :sub_cur,
						 :nd_decimal,
						 :amt_in_words,
						 :amt_in_words_Sep1);
  	END;
	END-EXEC; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "begin :no_of_lines1 := bl_spell_number . print_in_words ( :n\
d_facility_id , abs ( nvl ( :amount , 0 ) ) , 70 , :currency , :sub_cur , :nd_\
decimal , :amt_in_words , :amt_in_words_Sep1 ) ; END ;";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12700;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&no_of_lines1;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&amount;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&currency;
 sqlstm.sqhstl[3] = (unsigned int  )18;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&sub_cur;
 sqlstm.sqhstl[4] = (unsigned int  )12;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&nd_decimal;
 sqlstm.sqhstl[5] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&amt_in_words;
 sqlstm.sqhstl[6] = (unsigned int  )2002;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqhstv[7] = (         void  *)&amt_in_words_Sep1;
 sqlstm.sqhstl[7] = (unsigned int  )2002;
 sqlstm.sqhsts[7] = (         int  )0;
 sqlstm.sqindv[7] = (         void  *)0;
 sqlstm.sqinds[7] = (         int  )0;
 sqlstm.sqharm[7] = (unsigned int  )0;
 sqlstm.sqadto[7] = (unsigned short )0;
 sqlstm.sqtdso[7] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	amt_in_words.arr[amt_in_words.len]='\0';
	amt_in_words_Sep1.arr[amt_in_words_Sep1.len]='\0';

/* EXEC SQL SELECT REPLACE(:amt_in_words_Sep1,'~',CHR(10)||'                              ') 
		 INTO :amt_in_words_Sep
		 FROM DUAL; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "select REPLACE(:b0,'~',(CHR(10)||'                           \
   ')) into :b1  from DUAL ";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )12747;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&amt_in_words_Sep1;
sqlstm.sqhstl[0] = (unsigned int  )2002;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&amt_in_words_Sep;
sqlstm.sqhstl[1] = (unsigned int  )2002;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	amt_in_words_Sep.arr[amt_in_words_Sep.len]='\0';

}


print_bill_title()
{ 
	if(strcmp(nd_calling_pgm_id.arr,"BLRDISCN")==0)
	{ 
	   fun_centre(loc_legend[1415],80);
	   if(nd_print_option.arr[0]=='R')
	   {
	    strcat(nd_line_text.arr,loc_legend[1415]);
		fun_bl_report_temp_format();
	   }
	   else
	   {
	    fprintf(fp,"%s",loc_legend[1415]);
	    fprintf(fp,"\n");
	   }
	   line_ctr++;
	   check_page_end(1,0);
	 }
	else
	 {
	   
			if ( strcmp(d_bill_nature_code.arr,"C")!=0)
			{
				    if((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)||(strcmp(d_episode_type.arr,"R")==0))
				    {
					 print_line(op_credit_bill_title.arr);
					 if(nd_print_option.arr[0]=='R')
					 fun_bl_report_temp_format();
					 else
					 fprintf(fp,"\n");
					 line_ctr++;
					 check_page_end(1,0);
					}
					if((strcmp(d_episode_type.arr,"I")==0)||(strcmp(d_episode_type.arr,"D")==0))
					{
                        //strcpy(ip_credit_bill_title.arr,"\t\t\t       Intermediate Draft Report"); // added for scrum crf-654 remerging
						print_line(ip_credit_bill_title.arr);
						if(nd_print_option.arr[0]=='R')
						fun_bl_report_temp_format();
						else
						fprintf(fp,"\n");
						line_ctr++;
						check_page_end(1,0);
					}

			}
			else
			{
			if(l_no_settlement_details.arr[0]=='R' || 
				( strcmp(nd_calling_pgm_id.arr,"BLROPPV5")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS4")==0 || strcmp(nd_calling_pgm_id.arr,"BLRIPDS3")==0||strcmp(nd_calling_pgm_id.arr,"BLRUCDS3")==0 || strcmp(nd_calling_pgm_id.arr,"BLRUCDS4")==0
				  && strcmp(d_bill_nature_code.arr,"C")==0) )
				{  				
				  if(d_bill_paid_amt!=0) 
				  {
					if((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)||(strcmp(d_episode_type.arr,"R")==0))
					{
					 if (op_cash_bill_title_w_rcpt.arr[0] != '\0')
					  {
						print_line(op_cash_bill_title_w_rcpt.arr);
						if(nd_print_option.arr[0]=='R')
						fun_bl_report_temp_format();
						else
						fprintf(fp,"\n");
						line_ctr++;
						check_page_end(1,0);
					   }
					  }
				   if((strcmp(d_episode_type.arr,"I")==0)||(strcmp(d_episode_type.arr,"D")==0))
					{
					 if (ip_cash_bill_title_w_rcpt.arr[0] != '\0')
					  {
					    
						//strcpy(ip_cash_bill_title_w_rcpt.arr,"\t\t\t       Intermediate Draft Report"); // added for scrum crf-654 remerging
						print_line(ip_cash_bill_title_w_rcpt.arr);
						if(nd_print_option.arr[0]=='R')
						fun_bl_report_temp_format();
						else
						fprintf(fp,"\n");
						line_ctr++;
						check_page_end(1,0);
					   }
					  }
				   }
				   else
				   {
					if((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)||(strcmp(d_episode_type.arr,"R")==0))
					{
					 if (op_cash_bill_title_wo_rcpt.arr[0] != '\0')
					  {
						print_line(op_cash_bill_title_wo_rcpt.arr);
						if(nd_print_option.arr[0]=='R')
						fun_bl_report_temp_format();
						else
						fprintf(fp,"\n");
						line_ctr++;
						check_page_end(1,0);
					   }
					  }
				   if((strcmp(d_episode_type.arr,"I")==0)||(strcmp(d_episode_type.arr,"D")==0))
					{
					 if (ip_cash_bill_title_wo_rcpt.arr[0] != '\0')
					  {
					  	//strcpy(ip_cash_bill_title_wo_rcpt.arr,"\t\t\t       Intermediate Draft Report"); // added for scrum crf-654 remerging
						print_line(ip_cash_bill_title_wo_rcpt.arr);
						if(nd_print_option.arr[0]=='R')
						fun_bl_report_temp_format();
						else
						fprintf(fp,"\n");
						line_ctr++;
						check_page_end(1,0);
					   }
					  }

					}


				}
				else
				 {

					if((strcmp(d_episode_type.arr,"O")==0)||(strcmp(d_episode_type.arr,"E")==0)||(strcmp(d_episode_type.arr,"R")==0))
					{
					 if (op_cash_bill_title_wo_rcpt.arr[0] != '\0')
					  {
						print_line(op_cash_bill_title_wo_rcpt.arr);
						if(nd_print_option.arr[0]=='R')
						fun_bl_report_temp_format();
						else
						fprintf(fp,"\n");
						line_ctr++;
						check_page_end(1,0);
					   }
					  }
				   if((strcmp(d_episode_type.arr,"I")==0)||(strcmp(d_episode_type.arr,"D")==0))
					{
					 if (ip_cash_bill_title_wo_rcpt.arr[0] != '\0')
					  {
					  	//strcpy(ip_cash_bill_title_wo_rcpt.arr,"\t\t\t       Intermediate Draft Report"); // added for scrum crf-654 remerging
						print_line(ip_cash_bill_title_wo_rcpt.arr);
						if(nd_print_option.arr[0]=='R')
						fun_bl_report_temp_format();
						else
						fprintf(fp,"\n");
						line_ctr++;
						check_page_end(1,0);
					   }
					  }

				  }

				  }
			
		}

}

print_addl_line()
{
		if ( strcmp(d_bill_nature_code.arr,"C")==0)
		{
		if (cash_bill_title_addl_line.arr[0]!= '\0')
		 {
		 print_line(cash_bill_title_addl_line.arr);
		 if(nd_print_option.arr[0]=='R')
		 fun_bl_report_temp_format();
		 else
		 fprintf(fp,"\n");
		 line_ctr++;
		 check_page_end(1,0);
		 }
		}
		else
		{
		 if (credit_bill_title_addl_line.arr[0]!= '\0')
		 {
		 print_line(credit_bill_title_addl_line.arr);
		 if(nd_print_option.arr[0]=='R')
		 fun_bl_report_temp_format();
		 else
		 fprintf(fp,"\n");
		 line_ctr++;
		 check_page_end(1,0);
		 }
		}
}

print_body()
{
	if (bl_header_line_01.arr[0] != '\0')
      { 
	    str_has_to_print.arr[0]='\0';
	    str_has_to_print.len=0;
		print_line_1(bl_header_line_01.arr);
		str_has_to_print.arr[str_has_to_print.len]='\0';
		if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_01.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }

	if (bl_header_line_02.arr[0] != '\0')
      {	
		print_line(bl_header_line_02.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		
       }
	if (bl_header_line_03.arr[0] != '\0')
      {
	   str_has_to_print.arr[0]='\0';
	   str_has_to_print.len=0;
	   print_line_1(bl_header_line_03.arr);
	   //str_has_to_print.arr[str_has_to_print.len]='\0'; COMMENTED FOR REMERGING senthil
	   //disp_message(ERR_MESG,str_has_to_print.arr);
	   if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
	    
        
		print_line(bl_header_line_03.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_04.arr[0] != '\0')
	   {
	   str_has_to_print.arr[0]='\0';
	   str_has_to_print.len=0;
	   print_line_1(bl_header_line_04.arr);
	   str_has_to_print.arr[str_has_to_print.len]='\0';
	   if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_04.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_05.arr[0] != '\0')
      {
	  str_has_to_print.arr[0]='\0';
	  str_has_to_print.len=0;
      print_line_1(bl_header_line_05.arr);
	  str_has_to_print.arr[str_has_to_print.len]='\0';
	    if (strcmp(str_has_to_print.arr,"\0")!=0)
	    {
	    print_line(bl_header_line_05.arr);
	   	if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else	
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
	    }
       }

	   
	if (bl_header_line_06.arr[0] != '\0')
	{ 
	  str_has_to_print.arr[0]='\0';
	  str_has_to_print.len=0;
      print_line_1(bl_header_line_06.arr);
	  str_has_to_print.arr[str_has_to_print.len]='\0';
	   if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_06.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_07.arr[0] != '\0')
	  {	
	     str_has_to_print.arr[0]='\0';
	     str_has_to_print.len=0;
		print_line_1(bl_header_line_07.arr);
		str_has_to_print.arr[str_has_to_print.len]='\0';
		if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_07.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_08.arr[0] != '\0')
      {
	   str_has_to_print.arr[0]='\0';
	   str_has_to_print.len=0;
	   print_line_1(bl_header_line_08.arr);
	   str_has_to_print.arr[str_has_to_print.len]='\0';
	   if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_08.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_09.arr[0] != '\0')
      {
	   str_has_to_print.arr[0]='\0';
	   str_has_to_print.len=0;
	   print_line_1(bl_header_line_09.arr);
	   str_has_to_print.arr[str_has_to_print.len]='\0';
	   if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_09.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_10.arr[0] != '\0')
      { 
	  str_has_to_print.arr[0]='\0';
	     str_has_to_print.len=0;
	  print_line_1(bl_header_line_10.arr);
	  str_has_to_print.arr[str_has_to_print.len]='\0';
	    if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_10.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_11.arr[0] != '\0')
      {
	   str_has_to_print.arr[0]='\0';
	   str_has_to_print.len=0;
	   print_line_1(bl_header_line_11.arr);
	   str_has_to_print.arr[str_has_to_print.len]='\0';
	   if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_11.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_12.arr[0] != '\0')
      {
	  str_has_to_print.arr[0]='\0';
	     str_has_to_print.len=0;
	  print_line_1(bl_header_line_12.arr);
	  str_has_to_print.arr[str_has_to_print.len]='\0';
	  if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
	    print_line(bl_header_line_12.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
	if (bl_header_line_13.arr[0] != '\0')
      {
	  str_has_to_print.arr[0]='\0';
	  str_has_to_print.len=0;
	  print_line_1(bl_header_line_13.arr);
	  str_has_to_print.arr[str_has_to_print.len]='\0';
	   if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_13.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
		
	
	if (bl_header_line_14.arr[0] != '\0')
      {
	   str_has_to_print.arr[0]='\0';
	   str_has_to_print.len=0;
	   print_line_1(bl_header_line_14.arr);
	   str_has_to_print.arr[str_has_to_print.len]='\0';
	    if (strcmp(str_has_to_print.arr,"\0")!=0)
		{
		print_line(bl_header_line_14.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
		}
       }
}
print_credit_bill_footer()
{

	if (bill_credit_footer_line1.arr[0] != '\0')
      {
		print_line(bill_credit_footer_line1.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bill_credit_footer_line2.arr[0] != '\0')
      {
		print_line(bill_credit_footer_line2.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bill_credit_footer_line3.arr[0] != '\0')
      {
		print_line(bill_credit_footer_line3.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bill_credit_footer_line4.arr[0] != '\0')
      {
		print_line(bill_credit_footer_line4.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
 
 
 
       }
}

print_ins_bill_footer()
{

	if (bill_ins_footer_line1.arr[0] != '\0')
      {
		print_line(bill_ins_footer_line1.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bill_ins_footer_line2.arr[0] != '\0')
      {
		print_line(bill_ins_footer_line2.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bill_ins_footer_line3.arr[0] != '\0')
      {
		print_line(bill_ins_footer_line3.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
       }
	if (bill_ins_footer_line4.arr[0] != '\0')
      {
		print_line(bill_ins_footer_line4.arr);
		if(nd_print_option.arr[0]=='R')
		fun_bl_report_temp_format();
		else
		fprintf(fp,"\n");
		line_ctr++;
		check_page_end(1,0);
 
 
 
       }
}

get_pat_details()
{
 


  /* EXEC SQL EXECUTE

  DECLARE
    lv_deceased_yn	varchar2(2);
	lv_deceased_date date;
	x_today     date;
	lv_dob		date;
	X_MONTH number;
	X_year  number;

  BEGIN
  
   select DECEASED_YN,DECEASED_DATE,DATE_OF_BIRTH 
		into lv_deceased_yn,lv_deceased_date,lv_dob
		from mp_patient where patient_id=:d_patient_id;

  
  IF lv_deceased_yn='Y' then
  		x_today := lv_deceased_date;
  ELSE
	 X_TODAY := SYSDATE;
  END IF;
				X_MONTH := ABS(MONTHS_BETWEEN(X_TODAY, lv_dob));
				IF trunc(X_month) > 0 THEN
				 X_year := trunc(X_month/12);
				ELSE
				 X_year := 0;
				END IF;

				:ln_age_year := trunc(X_year);


END;
END-EXEC; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "declare lv_deceased_yn varchar2 ( 2 ) ; lv_deceased_date da\
te ; x_today date ; lv_dob date ; X_MONTH number ; X_year number ; BEGIN selec\
t DECEASED_YN , DECEASED_DATE , DATE_OF_BIRTH into lv_deceased_yn , lv_decease\
d_date , lv_dob from mp_patient where patient_id = :d_patient_id ; IF lv_decea\
sed_yn = 'Y' then x_today := lv_deceased_date ; ELSE X_TODAY := SYSDATE ; END \
IF ; X_MONTH := ABS ( MONTHS_BETWEEN ( X_TODAY , lv_dob ) ) ; IF trunc ( X_mon\
th ) > 0 THEN X_year := trunc ( X_month / 12 ) ; ELSE X_year := 0 ; END IF ; :\
ln_age_year := trunc ( X_year ) ; END ;";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )12770;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_patient_id;
  sqlstm.sqhstl[0] = (unsigned int  )63;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&ln_age_year;
  sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
		if (OERROR)
        err_mesg("get_patient_details failed",0,"");

}


print_line_1(line_var) varchar line_var[101];  //print_line definition

{
	dup_var.arr[0] = '\0';
	dup_var.len = 0;

    pos_var  = 0;
	pos_var1 = 0;
	pos_var2 = 0;
	print_upto = 0;
	lv_var  = 1;
	i = 0;
	
	strcpy(dup_var.arr,line_var);
	dup_var.len = strlen(dup_var.arr);
	var_length = strlen(dup_var.arr);
	pos_var = char_position(dup_var.arr,"+",1);
    sprintf(st_var,"%d",var_length);
	

	while(i < var_length)
	{ 
	if (pos_var == 0)
	{
    pos_length = var_length - i + 2;
	sprintf(st_var,"%d",pos_length);
	
	put_string(dup_var.arr,i,pos_length);
	strcpy(str_var1.arr,ls_str.arr);

	str_var1.len= strlen(str_var1.arr);
	
	check_splch_1(str_var1.arr);
	pos_var1 = 0;
	pos_var2 = 0;
	i = var_length;
	}

	if (pos_var != 0 && pos_var1 == 0)
	{	    
	pos_var1 = pos_var;

	pos_length = pos_var1-print_upto-1;	

    put_string(dup_var.arr,print_upto+1,pos_length);
    strcpy(str_var1.arr,ls_str.arr);
	str_var1.len = strlen(str_var1.arr);
	check_splch_1(str_var1.arr);

    print_upto = pos_var1 - 1;
	i = pos_var1+1;
    

	pos_var2 = char_position(dup_var.arr,"+",i);

     if (pos_var2 == 0)
	 {
	  pos_length = var_length - pos_var1 + 1;
      put_string(dup_var.arr,pos_var1,pos_length);
      strcpy(str_var1.arr,ls_str.arr);
	  str_var1.len = strlen(str_var1.arr);

	  check_splch_1(str_var1.arr);
	  print_upto = var_length+1;
	  i = var_length+1;
     }

    }

    if (pos_var2 != 0)
	{
    nd_column_val.arr[0] = '\0';
	nd_column_val.len = 0;
	column_var.arr[0] = '\0';
	column_var.len = 0;
	tab_name.arr[0] = '\0';
	tab_name.len = 0;

sql_stmt1.arr[0] = '\0';
sql_stmt1.len = 0;
sql_stmt2.arr[0] = '\0';
sql_stmt2.len = 0;


	pos_length = pos_var2 - pos_var1 - 1;

    column_var.arr[0] = '\0';
	column_var.len = 0;
	
	 put_string(dup_var.arr,pos_var1+1,pos_length);
     strcpy(column_var.arr,ls_str.arr);
	 column_var.len = strlen(column_var.arr);
	 date_yn = chk_date_yn(column_var.arr);
	 


		 
	  /* EXEC SQL SELECT  decode(:date_yn,0,'select to_char(ltrim('|| LET_MAPPED_COL_NAME || ')) from '|| LET_MAPPED_TABLE_NAME ||' WHERE ',
										 'select to_char('|| LET_MAPPED_COL_NAME || ',''DD/MM/YYYY'') from '|| LET_MAPPED_TABLE_NAME ||' WHERE '),LET_MAPPED_TABLE_NAME
					into  :sql_stmt1,tab_name
                    FROM BL_RECEIPT_MAPPING_COL
                    WHERE LET_COLUMN_ID = :column_var
					AND APPL_TRX_IND = 'B'; */ 

{
   struct sqlexd sqlstm;
   sqlstm.sqlvsn = 12;
   sqlstm.arrsiz = 52;
   sqlstm.sqladtp = &sqladt;
   sqlstm.sqltdsp = &sqltds;
   sqlstm.stmt = "select decode(:b0,0,(((('select to_char(ltrim('||LET_MAPPE\
D_COL_NAME)||')) from ')||LET_MAPPED_TABLE_NAME)||' WHERE '),(((('select to_ch\
ar('||LET_MAPPED_COL_NAME)||',''DD/MM/YYYY'') from ')||LET_MAPPED_TABLE_NAME)|\
|' WHERE ')) ,LET_MAPPED_TABLE_NAME into :b1,:b2  from BL_RECEIPT_MAPPING_COL \
where (LET_COLUMN_ID=:b3 and APPL_TRX_IND='B')";
   sqlstm.iters = (unsigned int  )1;
   sqlstm.offset = (unsigned int  )12793;
   sqlstm.selerr = (unsigned short)1;
   sqlstm.cud = sqlcud0;
   sqlstm.sqlest = (unsigned char  *)&sqlca;
   sqlstm.sqlety = (unsigned short)4352;
   sqlstm.occurs = (unsigned int  )0;
   sqlstm.sqhstv[0] = (         void  *)&date_yn;
   sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
   sqlstm.sqhsts[0] = (         int  )0;
   sqlstm.sqindv[0] = (         void  *)0;
   sqlstm.sqinds[0] = (         int  )0;
   sqlstm.sqharm[0] = (unsigned int  )0;
   sqlstm.sqadto[0] = (unsigned short )0;
   sqlstm.sqtdso[0] = (unsigned short )0;
   sqlstm.sqhstv[1] = (         void  *)&sql_stmt1;
   sqlstm.sqhstl[1] = (unsigned int  )1002;
   sqlstm.sqhsts[1] = (         int  )0;
   sqlstm.sqindv[1] = (         void  *)0;
   sqlstm.sqinds[1] = (         int  )0;
   sqlstm.sqharm[1] = (unsigned int  )0;
   sqlstm.sqadto[1] = (unsigned short )0;
   sqlstm.sqtdso[1] = (unsigned short )0;
   sqlstm.sqhstv[2] = (         void  *)&tab_name;
   sqlstm.sqhstl[2] = (unsigned int  )33;
   sqlstm.sqhsts[2] = (         int  )0;
   sqlstm.sqindv[2] = (         void  *)0;
   sqlstm.sqinds[2] = (         int  )0;
   sqlstm.sqharm[2] = (unsigned int  )0;
   sqlstm.sqadto[2] = (unsigned short )0;
   sqlstm.sqtdso[2] = (unsigned short )0;
   sqlstm.sqhstv[3] = (         void  *)&column_var;
   sqlstm.sqhstl[3] = (unsigned int  )103;
   sqlstm.sqhsts[3] = (         int  )0;
   sqlstm.sqindv[3] = (         void  *)0;
   sqlstm.sqinds[3] = (         int  )0;
   sqlstm.sqharm[3] = (unsigned int  )0;
   sqlstm.sqadto[3] = (unsigned short )0;
   sqlstm.sqtdso[3] = (unsigned short )0;
   sqlstm.sqphsv = sqlstm.sqhstv;
   sqlstm.sqphsl = sqlstm.sqhstl;
   sqlstm.sqphss = sqlstm.sqhsts;
   sqlstm.sqpind = sqlstm.sqindv;
   sqlstm.sqpins = sqlstm.sqinds;
   sqlstm.sqparm = sqlstm.sqharm;
   sqlstm.sqparc = sqlstm.sqharc;
   sqlstm.sqpadto = sqlstm.sqadto;
   sqlstm.sqptdso = sqlstm.sqtdso;
   sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}





	len = strlen(sql_stmt1.arr);
		sql_stmt1.arr[sql_stmt1.len]  ='\0';


    tab_name.arr[tab_name.len] = '\0';
	
//	disp_message(ERR_MESG,tab_name.arr);

	if(strcmp(tab_name.arr,"BL_RECEIPT_REFUND_HDR") == 0 || strcmp(tab_name.arr,"BL_RECEIPT_REFUND_HDRDTL_VW") == 0) 
	{
    
	strcpy(sql_stmt2.arr, "DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_doc_type_code1.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUMBER) =");
	strcat(sql_stmt2.arr,d_doc_number1.arr);

	if(strcmp(column_var.arr,"CASHIER_NAME")==0)
	{
		strcat(sql_stmt2.arr," AND ROWNUM=1");
	}
      
	}

	
	if(strcmp(tab_name.arr,"BL_BILL_HDR") == 0 ) 
	{
    
	strcpy(sql_stmt2.arr, "DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d1_doc_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUM) =");
	strcat(sql_stmt2.arr,d1_doc_number.arr);

	}
	
	if(strcmp(tab_name.arr,"AR_CUSTOMER") == 0 ) 
	{

		if(strcmp(d_cust_code.arr,"\0")!=0)
		strcpy(d_copy_cust_code.arr,d_cust_code.arr);
		else
		strcpy(d_copy_cust_code.arr,"$$$$$");
	

    strcpy(sql_stmt2.arr, "cust_code = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_copy_cust_code.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	if(strcmp(tab_name.arr,"BL_CASH_COUNTER") == 0 ) 
	{
	strcpy(sql_stmt2.arr,"operating_facility_id = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
    strcat(sql_stmt2.arr, " and CASH_COUNTER_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_cash_counter.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	if(strcmp(tab_name.arr,"BL_EPISODE_FIN_DTLS") == 0 ) 
	{
	
    strcpy(sql_stmt2.arr, "EPISODE_TYPE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and EPISODE_ID= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_id.arr);
	strcat(sql_stmt2.arr,"'");
	}
	

	if(strcmp(tab_name.arr,"BL_ENCOUNTER_FOR_QRY_VW") == 0 ) 
	{
	
    strcpy(sql_stmt2.arr,"episode_type = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_type.arr);
	strcat(sql_stmt2.arr,"'");

    if (strcmp(d_episode_type.arr,"R")!=0)
	{
		strcat(sql_stmt2.arr," and episode_id= ");
		strcat(sql_stmt2.arr,"'");
		strcat(sql_stmt2.arr,d_episode_id.arr);
		strcat(sql_stmt2.arr,"'");
    }

   if (strcmp(d_episode_type.arr,"R")!=0 && strcmp(d_episode_type.arr,"I")!=0 && strcmp(d_episode_type.arr,"D")!=0)
   {
	strcat(sql_stmt2.arr," and visit_id= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_visit_id.arr);
	strcat(sql_stmt2.arr,"'");
   }

	//strcat(sql_stmt2.arr," and NVL(LANGUAGE_ID,'en')= ");
	strcat(sql_stmt2.arr," and NVL(LANGUAGE_ID,'");
	strcat(sql_stmt2.arr,nd_lang_id.arr);
	strcat(sql_stmt2.arr,"' )= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_lang_id.arr);
	strcat(sql_stmt2.arr,"'");


	strcat(sql_stmt2.arr," and patient_id= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and facility_id = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	//disp_message(ERR_MESG,sql_stmt2.arr);
	}

	if(strcmp(tab_name.arr,"PR_ENCOUNTER") == 0 ) 
	{
	strcpy(sql_stmt2.arr,"FACILITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
    strcat(sql_stmt2.arr," and patient_id = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and episode_id= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and substr(PATIENT_CLASS,1,1)= ");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_episode_type.arr);
	strcat(sql_stmt2.arr,"'");

	if(strcmp(d_episode_type.arr,"O")==0 || strcmp(d_episode_type.arr,"E")==0)
	{
		strcat(sql_stmt2.arr," and OP_EPISODE_VISIT_NUM= ");
		strcat(sql_stmt2.arr,d_visit_id.arr);
	}

	}


	if(strcmp(tab_name.arr,"MP_PATIENT_MAST") == 0)
	{ 
	strcpy(sql_stmt2.arr, "PATIENT_ID = "); ;
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}
	
	if(strcmp(tab_name.arr,"MP_PATIENT") == 0)
	{ 
	strcpy(sql_stmt2.arr, "PATIENT_ID = "); ;
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}

	if(strcmp(tab_name.arr,"MP_REGION") == 0) 
	{
	strcpy(sql_stmt2.arr, "REGION_CODE = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_REGION_CODE.arr);
	strcat(sql_stmt2.arr,"'");
    
	}
	
	if(strcmp(tab_name.arr,"SY_ACC_ENTITY") == 0) 
	{
	strcpy(sql_stmt2.arr, "ACC_ENTITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}
	

	if(strcmp(tab_name.arr,"MP_PAT_OTHER_DTLS") == 0) 
	{
	strcpy(sql_stmt2.arr, "PATIENT_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d_patient_id.arr);
	strcat(sql_stmt2.arr,"'");
    
	}


    if(strcmp(tab_name.arr,"MP_RES_AREA") == 0) 
	{
	strcpy(sql_stmt2.arr, "RES_AREA_CODE = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_RES_AREA_CODE.arr);
	strcat(sql_stmt2.arr,"'");
    
	}

	if(strcmp(tab_name.arr,"MP_RES_TOWN") == 0) 
	{
	strcpy(sql_stmt2.arr, "RES_TOWN_CODE = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_RES_TOWN_CODE.arr);
	strcat(sql_stmt2.arr,"'");
    
	}

	if(strcmp(tab_name.arr,"SM_FACILITY_PARAM") == 0) 
	{
    strcpy(sql_stmt2.arr, "FACILITY_ID = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	if(strcmp(tab_name.arr,"SY_ACC_ENTITY") == 0) 
	{
    strcpy(sql_stmt2.arr, "acc_entity_id = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	}
	
	/**************SCRUM -CRF-23 CHANGES***************/
	if(strcmp(tab_name.arr,"BL_BILL_REF_PATCATG_VW") == 0 ) 
	{
   	strcpy(sql_stmt2.arr," OPERATING_FACILITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr, " and DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d1_doc_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUM) =");
	strcat(sql_stmt2.arr,d1_doc_number.arr);
 	}


  	if(strcmp(tab_name.arr,"BL_BILL_REF_SPLTY_VW") == 0 ) 
	{
	strcpy(sql_stmt2.arr,"OPERATING_FACILITY_ID = "); 
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,nd_facility_id.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr, "and DOC_TYPE_CODE = "); //:nd_facility");
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr,d1_doc_type.arr);
	strcat(sql_stmt2.arr,"'");
	strcat(sql_stmt2.arr," and to_char(DOC_NUM) =");
	strcat(sql_stmt2.arr,d1_doc_number.arr);
 	} 
	/***********CRF-23 CHANGES UPTO HERE *******/

	strcpy(sql_stmt,sql_stmt1.arr);

	strcat(sql_stmt,sql_stmt2.arr); 


/* EXEC SQL EXECUTE
	BEGIN
	 EXECUTE IMMEDIATE :sql_stmt INTO :nd_column_val;
	END;
END-EXEC; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "begin EXECUTE IMMEDIATE :sql_stmt INTO :nd_column_val ; END ;";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )12824;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)sql_stmt;
sqlstm.sqhstl[0] = (unsigned int  )5000;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_column_val;
sqlstm.sqhstl[1] = (unsigned int  )1002;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




nd_column_val.arr[nd_column_val.len]  ='\0';

if (OERROR)
{
	nd_column_val.arr[0]='\0';
}

if(nd_column_val.arr[0]!='\0')
{
 strcat(str_has_to_print.arr,nd_column_val.arr);
 str_has_to_print.len=strlen(str_has_to_print.arr);
    
}	print_upto = pos_var2;
	i = pos_var2+1;  
	
    pos_var1 = 0;
	pos_var2 = 0;

	pos_var = char_position(dup_var.arr,"+",i);
    }
   } 

} 

check_splch_1(str_var1)
char str_var1[101];
{
 prt_len = 0;
 spchar_pos = 0;
 spchar_pos1 = 0;
 lc_str_val.arr[0]	='\0';
 lc_str_val.len		= 0;
 lc_str_var.arr[0]	='\0';
 lc_str_var.len		= 0;
 
 ctr = 1;
 print_upto_c = 0;
 strcpy(lc_str_val.arr,str_var1);
 lc_str_val.len = strlen(lc_str_val.arr);
 len_lc_str_val = strlen(lc_str_val.arr);

 while(ctr <= len_lc_str_val)
 {
 prt_len = 0;
 spchar_pos = 0;
 spchar_pos1 = 0;
 
 
 spchar_pos = chk_esc_pos(lc_str_val.arr,ctr);
 
 spchar_pos1 = chk_nwln_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0  && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 1;
   }

 spchar_pos1 = chk_cp_nwln_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 2;
   }

 
 spchar_pos1 = chk_tab_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 3;
   }

 spchar_pos1 = chk_bold_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 4;
   }

 spchar_pos1 = chk_font_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 5;
   }

spchar_pos1 = chk_line_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 6;
   }

spchar_pos1 = chk_uline_pos(lc_str_val.arr,ctr);
 if (spchar_pos1 > 0 && spchar_pos1 <= spchar_pos)
   {
   spchar_pos = spchar_pos1;
   spchar_type = 7;
   }


 if (spchar_pos == 0)   
 {
 lc_str_var.arr[0]	='\0';
 lc_str_var.len		= 0;
 prt_len = len_lc_str_val - print_upto_c ;

 put_string(lc_str_val.arr,print_upto_c + 1,prt_len);
 strcpy(lc_str_var.arr,ls_str.arr);

 lc_str_var.len=strlen(lc_str_var.arr);

 //fprintf(fp,"%s",lc_str_var.arr);

 strcat(str_has_to_print.arr,lc_str_var.arr);
 

 ctr = len_lc_str_val+1;
 print_upto_c = len_lc_str_val;
 }
 else
 {
 lc_str_var.arr[0]	='\0';
 lc_str_var.len		= 0;

 prt_len = spchar_pos - print_upto_c -1;
 
 put_string(lc_str_val.arr,print_upto_c+1,prt_len);
 strcpy(lc_str_var.arr,ls_str.arr);
 lc_str_var.len = strlen(lc_str_var.arr);

  //fprintf(fp,"%s",lc_str_var.arr);

   strcat(str_has_to_print.arr,lc_str_var.arr);
  

  ctr = spchar_pos+2;
  print_upto_c = spchar_pos+1;

  }
  
 }
}



get_currency()
{

	currency.arr[0] = '\0';
	sub_cur.arr[0]  = '\0';
	currency.len = 0;
	sub_cur.len = 0;
	nd_acc_name.arr[0] = '\0';
	nd_acc_name.len = 0;
	nd_decimal = 0;

	/* EXEC SQL SELECT base_currency,
			base_currency_dec,
			acc_entity_name||', ',
			accounting_name,
			no_of_decimal 
	INTO    :currency,
			:sub_cur,
			:nd_facility_name ,
			:nd_acc_name,
			:nd_decimal
	FROM SY_ACC_ENTITY_LANG_VW
	WHERE acc_entity_id = :d_cashfacility_id
	AND LANGUAGE_ID=:nd_lang_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select base_currency ,base_currency_dec ,(acc_entity_name||'\
, ') ,accounting_name ,no_of_decimal into :b0,:b1,:b2,:b3,:b4  from SY_ACC_ENT\
ITY_LANG_VW where (acc_entity_id=:b5 and LANGUAGE_ID=:b6)";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )12847;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&currency;
 sqlstm.sqhstl[0] = (unsigned int  )18;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&sub_cur;
 sqlstm.sqhstl[1] = (unsigned int  )12;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_facility_name;
 sqlstm.sqhstl[2] = (unsigned int  )502;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&nd_acc_name;
 sqlstm.sqhstl[3] = (unsigned int  )33;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&nd_decimal;
 sqlstm.sqhstl[4] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_cashfacility_id;
 sqlstm.sqhstl[5] = (unsigned int  )5;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqhstv[6] = (         void  *)&nd_lang_id;
 sqlstm.sqhstl[6] = (unsigned int  )6;
 sqlstm.sqhsts[6] = (         int  )0;
 sqlstm.sqindv[6] = (         void  *)0;
 sqlstm.sqinds[6] = (         int  )0;
 sqlstm.sqharm[6] = (unsigned int  )0;
 sqlstm.sqadto[6] = (unsigned short )0;
 sqlstm.sqtdso[6] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	if (OERROR) 
	{ 
		disp_message (ERR_MESG,"SELECT FACILITY STATEMENT FAILED");
		proc_exit();
	}

	currency.arr[currency.len] = '\0';
	sub_cur.arr[sub_cur.len] = '\0';
	nd_facility_name.arr[nd_facility_name.len] = '\0';
	nd_acc_name.arr[nd_acc_name.len] = '\0';

}

get_subsidized_amt()  //added for IN9051
{

l_gross_disc_amt=0;
l_pat_net_amt=0;
l_subsidized_amt=0;


/* EXEC SQL SELECT  (SUM( nvl(UPD_GROSS_CHARGE_AMT,0))-SUM( nvl(UPD_DISC_AMT,0)))
		 into  l_gross_disc_amt
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						bill_doc_type_code =:d1_doc_type			//added by vani

                        and bill_doc_num =  :d1_doc_number))		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						bill_doc_type_code =:d1_doc_type		

                        and bill_doc_num =  :d1_doc_number )	

        ))   
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	AND B.BILL_DOC_NUM =:d1_doc_number); */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select (sum(nvl(UPD_GROSS_CHARGE_AMT,0))-sum(nvl(UPD_DISC_AMT,0))) into :\
b0  from BL_PATIENT_CHARGES_FOLIO A ,BL_BLNG_SERV C where (((((((OPERATING_F\
ACILITY_ID=:b1 and A.BLNG_SERV_CODE=C.BLNG_SERV_CODE) and EPISODE_TYPE=:b2) \
and ((:b2<>'R' and EPISODE_ID=:b4) or :b2='R')) and ((:b2 in ('O','E') and V\
ISIT_ID=:b7) or :b2 in ('I','D','R'))) and PATIENT_ID=:b9) and ((trx_status \
is null  or ((trx_status='C' and NVL(REV_ADJ_TRX_IND,'R')='R') and (SOURCE_D\
OC_REF,SOURCE_DOC_REF_LINE_NUM) not  in (select TRX_DOC_REF ,TRX_DOC_REF_LIN\
E_NUM  from bl_patient_charges_folio where (((OPERATING_FACILITY_ID=:b1 and \
patient_id=:b9) and bill_doc_type_code=:b12) and bill_doc_num=:b13)))) or (R\
EV_ADJ_TRX_IND='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) not  in (select SO\
URCE_DOC_REF ,SOURCE_DOC_REF_LINE_NUM  from bl_patient_charges_folio where (\
((OPERATING_FACILITY_ID=:b1 and patient_id=:b9) and bill_doc_type_code=:b12)\
 and bill_doc_num=:b13))))) and exists (select B.TRX_DOC_REF  from BL_PATIEN\
T_CHARGES_FOLIO B where (((((B.OPERATIN");
sqlstm.stmt = "G_FACILITY_ID=:b1 and B.OPERATING_FACILITY_ID=A.OPERATING_FAC\
ILITY_ID) and B.TRX_DOC_REF=A.TRX_DOC_REF) and B.TRX_DOC_REF_LINE_NUM=A.TRX_DO\
C_REF_LINE_NUM) and B.BILL_DOC_TYPE_CODE=:b12) and B.BILL_DOC_NUM=:b13)))";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )12890;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_gross_disc_amt;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[10] = (unsigned int  )5;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_patient_id;
sqlstm.sqhstl[11] = (unsigned int  )63;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[12] = (unsigned int  )27;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[13] = (unsigned int  )52;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[14] = (unsigned int  )5;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&d_patient_id;
sqlstm.sqhstl[15] = (unsigned int  )63;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[16] = (unsigned int  )27;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[17] = (unsigned int  )52;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[18] = (unsigned int  )5;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[19] = (unsigned int  )27;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[20] = (unsigned int  )52;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	
	
/* EXEC SQL SELECT  sum(nvl(UPD_NET_CHARGE_AMT,0))  into  l_pat_net_amt
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						bill_doc_type_code =:d1_doc_type			//added by vani

                        and bill_doc_num =  :d1_doc_number))		//added by vani
                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						bill_doc_type_code =:d1_doc_type		

                        and bill_doc_num =  :d1_doc_number )	
     
        ))   
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	AND B.BILL_DOC_NUM =:d1_doc_number)
	and cust_code is null; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select sum(nvl(UPD_NET_CHARGE_AMT,0)) into :b0  from BL_PATIENT_CHARGES_F\
OLIO A ,BL_BLNG_SERV C where ((((((((OPERATING_FACILITY_ID=:b1 and A.BLNG_SE\
RV_CODE=C.BLNG_SERV_CODE) and EPISODE_TYPE=:b2) and ((:b2<>'R' and EPISODE_I\
D=:b4) or :b2='R')) and ((:b2 in ('O','E') and VISIT_ID=:b7) or :b2 in ('I',\
'D','R'))) and PATIENT_ID=:b9) and ((trx_status is null  or ((trx_status='C'\
 and NVL(REV_ADJ_TRX_IND,'R')='R') and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_N\
UM) not  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_charg\
es_folio where (((OPERATING_FACILITY_ID=:b1 and patient_id=:b9) and bill_doc\
_type_code=:b12) and bill_doc_num=:b13)))) or (REV_ADJ_TRX_IND='B' and (TRX_\
DOC_REF,TRX_DOC_REF_LINE_NUM) not  in (select SOURCE_DOC_REF ,SOURCE_DOC_REF\
_LINE_NUM  from bl_patient_charges_folio where (((OPERATING_FACILITY_ID=:b1 \
and patient_id=:b9) and bill_doc_type_code=:b12) and bill_doc_num=:b13))))) \
and exists (select B.TRX_DOC_REF  from BL_PATIENT_CHARGES_FOLIO B where ((((\
(B.OPERATING_FACILITY_ID=:b1 and B.OPER");
sqlstm.stmt = "ATING_FACILITY_ID=A.OPERATING_FACILITY_ID) and B.TRX_DOC_REF=\
A.TRX_DOC_REF) and B.TRX_DOC_REF_LINE_NUM=A.TRX_DOC_REF_LINE_NUM) and B.BILL_D\
OC_TYPE_CODE=:b12) and B.BILL_DOC_NUM=:b13))) and cust_code is null )";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )12989;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_pat_net_amt;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[10] = (unsigned int  )5;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_patient_id;
sqlstm.sqhstl[11] = (unsigned int  )63;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[12] = (unsigned int  )27;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[13] = (unsigned int  )52;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[14] = (unsigned int  )5;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&d_patient_id;
sqlstm.sqhstl[15] = (unsigned int  )63;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[16] = (unsigned int  )27;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[17] = (unsigned int  )52;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[18] = (unsigned int  )5;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[19] = (unsigned int  )27;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[20] = (unsigned int  )52;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	l_subsidized_amt = l_gross_disc_amt-l_pat_net_amt;


	
}

get_ph_batch_details()
{
d_trade_name.arr[0] = '\0';
d_batch_name.arr[0] = '\0';
d_exp_dt.arr[0] = '\0';
d_loc_code.arr[0] = '\0';

d_trade_name.len = 0;
d_batch_name.len = 0;
d_exp_dt.len = 0;
d_loc_code.len = 0;

/* EXEC SQL EXECUTE
BEGIN
BLCORE.GET_SUB_STR_AND_POSI
			(:d_folio_batch_id,
			 :d_trade_posi , :d_trade_name ,
			 :d_batch_posi , :d_batch_name ,
			 :d_exp_dt_posi, :d_exp_dt	,
			 :d_loc_posi   , :d_loc_code	,
			 :d_qty_posi   , :d_qty  );

END;
END-EXEC; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "begin BLCORE . GET_SUB_STR_AND_POSI ( :d_folio_batch_id , :d_\
trade_posi , :d_trade_name , :d_batch_posi , :d_batch_name , :d_exp_dt_posi , \
:d_exp_dt , :d_loc_posi , :d_loc_code , :d_qty_posi , :d_qty ) ; END ;";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )13088;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&d_folio_batch_id;
sqlstm.sqhstl[0] = (unsigned int  )102;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&d_trade_posi;
sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_trade_name;
sqlstm.sqhstl[2] = (unsigned int  )102;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_batch_posi;
sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_batch_name;
sqlstm.sqhstl[4] = (unsigned int  )102;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_exp_dt_posi;
sqlstm.sqhstl[5] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_exp_dt;
sqlstm.sqhstl[6] = (unsigned int  )22;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_loc_posi;
sqlstm.sqhstl[7] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_loc_code;
sqlstm.sqhstl[8] = (unsigned int  )102;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_qty_posi;
sqlstm.sqhstl[9] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_qty;
sqlstm.sqhstl[10] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



d_trade_name.arr[strlen(d_trade_name.arr)]	= '\0';
d_batch_name.arr[strlen(d_batch_name.arr)]	= '\0';
d_exp_dt.arr[strlen(d_exp_dt.arr)]			= '\0';
d_loc_code.arr[strlen(d_loc_code.arr)]		= '\0';

fprintf(fp,"%-12.12s%-8.8s %-11.11s %-13.13s %-12.12s%"," ",loc_legend[1427],d_batch_name.arr,loc_legend[1428],d_exp_dt.arr);
fprintf(fp,"\n");
}


get_payer_batch_details()
{
d_trade_name.arr[0] = '\0';
d_batch_name.arr[0] = '\0';
d_exp_dt.arr[0] = '\0';
d_loc_code.arr[0] = '\0';

d_trade_name.len = 0;
d_batch_name.len = 0;
d_exp_dt.len = 0;
d_loc_code.len = 0;

/* EXEC SQL EXECUTE
BEGIN
BLCORE.GET_SUB_STR_AND_POSI
			(:d1_folio_batch_id,
			 :d_trade_posi , :d_trade_name ,
			 :d_batch_posi , :d_batch_name ,
			 :d_exp_dt_posi, :d_exp_dt	,
			 :d_loc_posi   , :d_loc_code	,
			 :d_qty_posi   , :d_qty  );

END;
END-EXEC; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.stmt = "begin BLCORE . GET_SUB_STR_AND_POSI ( :d1_folio_batch_id , :d\
_trade_posi , :d_trade_name , :d_batch_posi , :d_batch_name , :d_exp_dt_posi ,\
 :d_exp_dt , :d_loc_posi , :d_loc_code , :d_qty_posi , :d_qty ) ; END ;";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )13147;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&d1_folio_batch_id;
sqlstm.sqhstl[0] = (unsigned int  )102;
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&d_trade_posi;
sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_trade_name;
sqlstm.sqhstl[2] = (unsigned int  )102;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_batch_posi;
sqlstm.sqhstl[3] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_batch_name;
sqlstm.sqhstl[4] = (unsigned int  )102;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_exp_dt_posi;
sqlstm.sqhstl[5] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_exp_dt;
sqlstm.sqhstl[6] = (unsigned int  )22;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_loc_posi;
sqlstm.sqhstl[7] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_loc_code;
sqlstm.sqhstl[8] = (unsigned int  )102;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_qty_posi;
sqlstm.sqhstl[9] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_qty;
sqlstm.sqhstl[10] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



d_trade_name.arr[strlen(d_trade_name.arr)]	= '\0';
d_batch_name.arr[strlen(d_batch_name.arr)]	= '\0';
d_exp_dt.arr[strlen(d_exp_dt.arr)]			= '\0';
d_loc_code.arr[strlen(d_loc_code.arr)]		= '\0';

fprintf(fp,"%-12.12s%-8.8s %-11.11s %-13.13s %-12.12s%"," ",loc_legend[1427],d_batch_name.arr,loc_legend[1428],d_exp_dt.arr);
fprintf(fp,"\n");
}

get_grp_pkg_outside_cnt(pk_grp_ind,d_grp_code,d_line_code)  //,d_serv_code
{
l_grp_pkg_inside_cnt=0;


/* EXEC SQL SELECT  count(*) into  l_grp_pkg_inside_cnt
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	AND (A.trx_doc_ref,A.trx_doc_ref_line_num,A.trx_doc_ref_seq_num) NOT IN 
	 	 (SELECT E.trx_doc_ref,E.trx_doc_ref_line_num,E.trx_doc_ref_seq_num 
            FROM bl_patient_charges_folio E
	 		WHERE trx_status = 'C'
		AND	 EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	 		//AND E.bill_doc_type_code = A.bill_doc_type_code
			//AND E.bill_doc_num = A.bill_doc_num
			AND E.operating_facility_id = A.operating_facility_id
			AND E.rev_adj_trx_ind IN ('R','B','A')
			AND E.orig_doc_ref IS NOT NULL AND E.orig_doc_ref_line_num IS NOT NULL
		UNION 
			SELECT orig_doc_ref,orig_doc_ref_line_num,orig_doc_ref_seq_num 
            FROM bl_patient_charges_folio E
	 		WHERE trx_status = 'C'
			AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	 		//AND E.bill_doc_type_code = A.bill_doc_type_code
			//AND E.bill_doc_num = A.bill_doc_num
			AND E.operating_facility_id = A.operating_facility_id
			AND E.rev_adj_trx_ind IN ('R','B','A')
            AND E.orig_doc_ref IS NOT NULL AND E.orig_doc_ref_line_num IS NOT NULL
		 )
	/o commented by Rajesh   
	and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						bill_doc_type_code =:d1_doc_type			//added by vani

                        and bill_doc_num =  :d1_doc_number))		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						bill_doc_type_code =:d1_doc_type		

                        and bill_doc_num =  :d1_doc_number )	

                      
        ))   o/

	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM)
	//AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	//AND B.BILL_DOC_NUM =:d1_doc_number)
	and NVL(PACKAGE_TRX_YN,'N')='N'
	and	PACKAGE_SEQ_NO is null
	//and BILL_DOC_TYPE_CODE=:d1_doc_type
	//and BILL_DOC_NUM=:d1_doc_number
	and ( (:pk_grp_ind='G' and ( (:d_grp_ind='ESG' and A.PRT_GRP_HDR_CODE=:d_grp_code)or
									 (:d1_grp_ind='EMG' and A.ENT_ITEM_GRP_CODE=:d_grp_code)or
									 (:d1_grp_ind='PSG' and A.PAYER_SERV_GRP_HDR=:d_grp_code)or
									 (:d1_grp_ind='PMG' and A.PAYER_ITEM_GRP_CODE=:d_grp_code) 
								   )
			  ) or
			  (:pk_grp_ind='L' and ( (:d1_grp_ind='ESL' and A.PRT_GRP_HDR_CODE=:d_grp_code and A.PRT_GRP_LINE_CODE=:d_line_code) or
									 (:d_grp_ind='PSL' and A.PAYER_SERV_GRP_HDR=:d_grp_code and A.PAYER_SERV_GRP_LINE=:d_line_code)
								   )
			  )
			) 
	/o*and ( (:pk_grp_ind='G' and A.PRT_GRP_HDR_CODE=:d_grp_code) or
	      (:pk_grp_ind='L' and A.PRT_GRP_HDR_CODE=:d_grp_code and A.PRT_GRP_LINE_CODE=:d_line_code)
		) *o/ //commented for walkthrough
	
	//and A.BLNG_SERV_CODE=:d_serv_code
	and cust_code is null
	and nvl(a.confirmed_yn,'N')!='N'; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select count(*)  into :b0  from BL_PATIENT_CHARGES_FOLIO A ,BL_BLNG_SERV \
C where ((((((((((((OPERATING_FACILITY_ID=:b1 and A.BLNG_SERV_CODE=C.BLNG_SE\
RV_CODE) and EPISODE_TYPE=:b2) and ((:b2<>'R' and EPISODE_ID=:b4) or :b2='R'\
)) and ((:b2 in ('O','E') and VISIT_ID=:b7) or :b2 in ('I','D','R'))) and PA\
TIENT_ID=:b9) and (A.trx_doc_ref,A.trx_doc_ref_line_num,A.trx_doc_ref_seq_nu\
m) not  in (select E.trx_doc_ref ,E.trx_doc_ref_line_num ,E.trx_doc_ref_seq_\
num  from bl_patient_charges_folio E where ((((((((trx_status='C' and EPISOD\
E_TYPE=:b2) and ((:b2<>'R' and EPISODE_ID=:b4) or :b2='R')) and ((:b2 in ('O\
','E') and VISIT_ID=:b7) or :b2 in ('I','D','R'))) and PATIENT_ID=:b9) and E\
.operating_facility_id=A.operating_facility_id) and E.rev_adj_trx_ind in ('R\
','B','A')) and E.orig_doc_ref is  not null ) and E.orig_doc_ref_line_num is\
  not null ) union select orig_doc_ref ,orig_doc_ref_line_num ,orig_doc_ref_\
seq_num  from bl_patient_charges_folio E where ((((((((trx_status='C' and EP\
ISODE_TYPE=:b2) and ((:b2<>'R' and EPIS");
sqlstm.stmt = "ODE_ID=:b4) or :b2='R')) and ((:b2 in ('O','E') and VISIT_ID=\
:b7) or :b2 in ('I','D','R'))) and PATIENT_ID=:b9) and E.operating_facility_id\
=A.operating_facility_id) and E.rev_adj_trx_ind in ('R','B','A')) and E.orig_d\
oc_ref is  not null ) and E.orig_doc_ref_line_num is  not null ))) and exists \
(select B.TRX_DOC_REF  from BL_PATIENT_CHARGES_FOLIO B where (((B.OPERATING_FA\
CILITY_ID=:b1 and B.OPERATING_FACILITY_ID=A.OPERATING_FACILITY_ID) and B.TRX_D\
OC_REF=A.TRX_DOC_REF) and B.TRX_DOC_REF_LINE_NUM=A.TRX_DOC_REF_LINE_NUM))) and\
 NVL(PACKAGE_TRX_YN,'N')='N') and PACKAGE_SEQ_NO is null ) and ((:b27='G' and \
((((:b28='ESG' and A.PRT_GRP_HDR_CODE=:b29) or (:b30='EMG' and A.ENT_ITEM_GRP_\
CODE=:b29)) or (:b30='PSG' and A.PAYER_SERV_GRP_HDR=:b29)) or (:b30='PMG' and \
A.PAYER_ITEM_GRP_CODE=:b29))) or (:b27='L' and (((:b30='ESL' and A.PRT_GRP_HDR\
_CODE=:b29) and A.PRT_GRP_LINE_CODE=:b39) or ((:b28='PSL' and A.PAYER_SERV_GRP\
_HDR=:b29) and A.PAYER_SERV_GRP_LINE=:b39))))) and cust_code is null ) and nvl\
(a.confirmed_yn,'N')<>'N')";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )13206;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_grp_pkg_inside_cnt;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_episode_type;
sqlstm.sqhstl[10] = (unsigned int  )4;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_episode_type;
sqlstm.sqhstl[11] = (unsigned int  )4;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d_episode_id;
sqlstm.sqhstl[12] = (unsigned int  )11;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d_episode_type;
sqlstm.sqhstl[13] = (unsigned int  )4;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&d_episode_type;
sqlstm.sqhstl[14] = (unsigned int  )4;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&d_visit_id;
sqlstm.sqhstl[15] = (unsigned int  )7;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d_episode_type;
sqlstm.sqhstl[16] = (unsigned int  )4;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d_patient_id;
sqlstm.sqhstl[17] = (unsigned int  )63;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&d_episode_type;
sqlstm.sqhstl[18] = (unsigned int  )4;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d_episode_type;
sqlstm.sqhstl[19] = (unsigned int  )4;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&d_episode_id;
sqlstm.sqhstl[20] = (unsigned int  )11;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqhstv[21] = (         void  *)&d_episode_type;
sqlstm.sqhstl[21] = (unsigned int  )4;
sqlstm.sqhsts[21] = (         int  )0;
sqlstm.sqindv[21] = (         void  *)0;
sqlstm.sqinds[21] = (         int  )0;
sqlstm.sqharm[21] = (unsigned int  )0;
sqlstm.sqadto[21] = (unsigned short )0;
sqlstm.sqtdso[21] = (unsigned short )0;
sqlstm.sqhstv[22] = (         void  *)&d_episode_type;
sqlstm.sqhstl[22] = (unsigned int  )4;
sqlstm.sqhsts[22] = (         int  )0;
sqlstm.sqindv[22] = (         void  *)0;
sqlstm.sqinds[22] = (         int  )0;
sqlstm.sqharm[22] = (unsigned int  )0;
sqlstm.sqadto[22] = (unsigned short )0;
sqlstm.sqtdso[22] = (unsigned short )0;
sqlstm.sqhstv[23] = (         void  *)&d_visit_id;
sqlstm.sqhstl[23] = (unsigned int  )7;
sqlstm.sqhsts[23] = (         int  )0;
sqlstm.sqindv[23] = (         void  *)0;
sqlstm.sqinds[23] = (         int  )0;
sqlstm.sqharm[23] = (unsigned int  )0;
sqlstm.sqadto[23] = (unsigned short )0;
sqlstm.sqtdso[23] = (unsigned short )0;
sqlstm.sqhstv[24] = (         void  *)&d_episode_type;
sqlstm.sqhstl[24] = (unsigned int  )4;
sqlstm.sqhsts[24] = (         int  )0;
sqlstm.sqindv[24] = (         void  *)0;
sqlstm.sqinds[24] = (         int  )0;
sqlstm.sqharm[24] = (unsigned int  )0;
sqlstm.sqadto[24] = (unsigned short )0;
sqlstm.sqtdso[24] = (unsigned short )0;
sqlstm.sqhstv[25] = (         void  *)&d_patient_id;
sqlstm.sqhstl[25] = (unsigned int  )63;
sqlstm.sqhsts[25] = (         int  )0;
sqlstm.sqindv[25] = (         void  *)0;
sqlstm.sqinds[25] = (         int  )0;
sqlstm.sqharm[25] = (unsigned int  )0;
sqlstm.sqadto[25] = (unsigned short )0;
sqlstm.sqtdso[25] = (unsigned short )0;
sqlstm.sqhstv[26] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[26] = (unsigned int  )5;
sqlstm.sqhsts[26] = (         int  )0;
sqlstm.sqindv[26] = (         void  *)0;
sqlstm.sqinds[26] = (         int  )0;
sqlstm.sqharm[26] = (unsigned int  )0;
sqlstm.sqadto[26] = (unsigned short )0;
sqlstm.sqtdso[26] = (unsigned short )0;
sqlstm.sqhstv[27] = (         void  *)&pk_grp_ind;
sqlstm.sqhstl[27] = (unsigned int  )1;
sqlstm.sqhsts[27] = (         int  )0;
sqlstm.sqindv[27] = (         void  *)0;
sqlstm.sqinds[27] = (         int  )0;
sqlstm.sqharm[27] = (unsigned int  )0;
sqlstm.sqadto[27] = (unsigned short )0;
sqlstm.sqtdso[27] = (unsigned short )0;
sqlstm.sqhstv[28] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[28] = (unsigned int  )6;
sqlstm.sqhsts[28] = (         int  )0;
sqlstm.sqindv[28] = (         void  *)0;
sqlstm.sqinds[28] = (         int  )0;
sqlstm.sqharm[28] = (unsigned int  )0;
sqlstm.sqadto[28] = (unsigned short )0;
sqlstm.sqtdso[28] = (unsigned short )0;
sqlstm.sqhstv[29] = (         void  *)d_grp_code;
sqlstm.sqhstl[29] = (unsigned int  )10;
sqlstm.sqhsts[29] = (         int  )0;
sqlstm.sqindv[29] = (         void  *)0;
sqlstm.sqinds[29] = (         int  )0;
sqlstm.sqharm[29] = (unsigned int  )0;
sqlstm.sqadto[29] = (unsigned short )0;
sqlstm.sqtdso[29] = (unsigned short )0;
sqlstm.sqhstv[30] = (         void  *)&d1_grp_ind;
sqlstm.sqhstl[30] = (unsigned int  )6;
sqlstm.sqhsts[30] = (         int  )0;
sqlstm.sqindv[30] = (         void  *)0;
sqlstm.sqinds[30] = (         int  )0;
sqlstm.sqharm[30] = (unsigned int  )0;
sqlstm.sqadto[30] = (unsigned short )0;
sqlstm.sqtdso[30] = (unsigned short )0;
sqlstm.sqhstv[31] = (         void  *)d_grp_code;
sqlstm.sqhstl[31] = (unsigned int  )10;
sqlstm.sqhsts[31] = (         int  )0;
sqlstm.sqindv[31] = (         void  *)0;
sqlstm.sqinds[31] = (         int  )0;
sqlstm.sqharm[31] = (unsigned int  )0;
sqlstm.sqadto[31] = (unsigned short )0;
sqlstm.sqtdso[31] = (unsigned short )0;
sqlstm.sqhstv[32] = (         void  *)&d1_grp_ind;
sqlstm.sqhstl[32] = (unsigned int  )6;
sqlstm.sqhsts[32] = (         int  )0;
sqlstm.sqindv[32] = (         void  *)0;
sqlstm.sqinds[32] = (         int  )0;
sqlstm.sqharm[32] = (unsigned int  )0;
sqlstm.sqadto[32] = (unsigned short )0;
sqlstm.sqtdso[32] = (unsigned short )0;
sqlstm.sqhstv[33] = (         void  *)d_grp_code;
sqlstm.sqhstl[33] = (unsigned int  )10;
sqlstm.sqhsts[33] = (         int  )0;
sqlstm.sqindv[33] = (         void  *)0;
sqlstm.sqinds[33] = (         int  )0;
sqlstm.sqharm[33] = (unsigned int  )0;
sqlstm.sqadto[33] = (unsigned short )0;
sqlstm.sqtdso[33] = (unsigned short )0;
sqlstm.sqhstv[34] = (         void  *)&d1_grp_ind;
sqlstm.sqhstl[34] = (unsigned int  )6;
sqlstm.sqhsts[34] = (         int  )0;
sqlstm.sqindv[34] = (         void  *)0;
sqlstm.sqinds[34] = (         int  )0;
sqlstm.sqharm[34] = (unsigned int  )0;
sqlstm.sqadto[34] = (unsigned short )0;
sqlstm.sqtdso[34] = (unsigned short )0;
sqlstm.sqhstv[35] = (         void  *)d_grp_code;
sqlstm.sqhstl[35] = (unsigned int  )10;
sqlstm.sqhsts[35] = (         int  )0;
sqlstm.sqindv[35] = (         void  *)0;
sqlstm.sqinds[35] = (         int  )0;
sqlstm.sqharm[35] = (unsigned int  )0;
sqlstm.sqadto[35] = (unsigned short )0;
sqlstm.sqtdso[35] = (unsigned short )0;
sqlstm.sqhstv[36] = (         void  *)&pk_grp_ind;
sqlstm.sqhstl[36] = (unsigned int  )1;
sqlstm.sqhsts[36] = (         int  )0;
sqlstm.sqindv[36] = (         void  *)0;
sqlstm.sqinds[36] = (         int  )0;
sqlstm.sqharm[36] = (unsigned int  )0;
sqlstm.sqadto[36] = (unsigned short )0;
sqlstm.sqtdso[36] = (unsigned short )0;
sqlstm.sqhstv[37] = (         void  *)&d1_grp_ind;
sqlstm.sqhstl[37] = (unsigned int  )6;
sqlstm.sqhsts[37] = (         int  )0;
sqlstm.sqindv[37] = (         void  *)0;
sqlstm.sqinds[37] = (         int  )0;
sqlstm.sqharm[37] = (unsigned int  )0;
sqlstm.sqadto[37] = (unsigned short )0;
sqlstm.sqtdso[37] = (unsigned short )0;
sqlstm.sqhstv[38] = (         void  *)d_grp_code;
sqlstm.sqhstl[38] = (unsigned int  )10;
sqlstm.sqhsts[38] = (         int  )0;
sqlstm.sqindv[38] = (         void  *)0;
sqlstm.sqinds[38] = (         int  )0;
sqlstm.sqharm[38] = (unsigned int  )0;
sqlstm.sqadto[38] = (unsigned short )0;
sqlstm.sqtdso[38] = (unsigned short )0;
sqlstm.sqhstv[39] = (         void  *)d_line_code;
sqlstm.sqhstl[39] = (unsigned int  )10;
sqlstm.sqhsts[39] = (         int  )0;
sqlstm.sqindv[39] = (         void  *)0;
sqlstm.sqinds[39] = (         int  )0;
sqlstm.sqharm[39] = (unsigned int  )0;
sqlstm.sqadto[39] = (unsigned short )0;
sqlstm.sqtdso[39] = (unsigned short )0;
sqlstm.sqhstv[40] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[40] = (unsigned int  )6;
sqlstm.sqhsts[40] = (         int  )0;
sqlstm.sqindv[40] = (         void  *)0;
sqlstm.sqinds[40] = (         int  )0;
sqlstm.sqharm[40] = (unsigned int  )0;
sqlstm.sqadto[40] = (unsigned short )0;
sqlstm.sqtdso[40] = (unsigned short )0;
sqlstm.sqhstv[41] = (         void  *)d_grp_code;
sqlstm.sqhstl[41] = (unsigned int  )10;
sqlstm.sqhsts[41] = (         int  )0;
sqlstm.sqindv[41] = (         void  *)0;
sqlstm.sqinds[41] = (         int  )0;
sqlstm.sqharm[41] = (unsigned int  )0;
sqlstm.sqadto[41] = (unsigned short )0;
sqlstm.sqtdso[41] = (unsigned short )0;
sqlstm.sqhstv[42] = (         void  *)d_line_code;
sqlstm.sqhstl[42] = (unsigned int  )10;
sqlstm.sqhsts[42] = (         int  )0;
sqlstm.sqindv[42] = (         void  *)0;
sqlstm.sqinds[42] = (         int  )0;
sqlstm.sqharm[42] = (unsigned int  )0;
sqlstm.sqadto[42] = (unsigned short )0;
sqlstm.sqtdso[42] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




}


get_grp_pkg_outside_cnt1(pk_grp_ind,d_grp_code,d_line_code)  //,d_serv_code
{
l_grp_pkg_inside_cnt=0;


/* EXEC SQL SELECT  count(*) into  l_grp_pkg_inside_cnt
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	AND (A.trx_doc_ref,A.trx_doc_ref_line_num,A.trx_doc_ref_seq_num) NOT IN 
	 	 (SELECT E.trx_doc_ref,E.trx_doc_ref_line_num,E.trx_doc_ref_seq_num 
            FROM bl_patient_charges_folio E
	 		WHERE trx_status = 'C'
			AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	 		//AND E.bill_doc_type_code = A.bill_doc_type_code
			//AND E.bill_doc_num = A.bill_doc_num
			AND E.operating_facility_id = A.operating_facility_id
			AND E.rev_adj_trx_ind IN ('R','B','A')
			AND E.orig_doc_ref IS NOT NULL AND E.orig_doc_ref_line_num IS NOT NULL
		UNION 
			SELECT orig_doc_ref,orig_doc_ref_line_num,orig_doc_ref_seq_num 
            FROM bl_patient_charges_folio E
	 		WHERE trx_status = 'C'
			AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	 		//AND E.bill_doc_type_code = A.bill_doc_type_code
			//AND E.bill_doc_num = A.bill_doc_num
			AND E.operating_facility_id = A.operating_facility_id
			AND E.rev_adj_trx_ind IN ('R','B','A')
            AND E.orig_doc_ref IS NOT NULL AND E.orig_doc_ref_line_num IS NOT NULL
		 )
	/o commented by Rajesh
	  and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						bill_doc_type_code =:d1_doc_type			//added by vani

                        and bill_doc_num =  :d1_doc_number))		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						bill_doc_type_code =:d1_doc_type		

                        and bill_doc_num =  :d1_doc_number )	

                      
        ))   
		o/
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM)
	//AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	//AND B.BILL_DOC_NUM =:d1_doc_number)
	and NVL(PACKAGE_TRX_YN,'N')='N'
	and	PACKAGE_SEQ_NO is null
	//and BILL_DOC_TYPE_CODE=:d1_doc_type
	//and BILL_DOC_NUM=:d1_doc_number
	and ( (:pk_grp_ind='G' and ( (:d_grp_ind='ESG' and A.PRT_GRP_HDR_CODE=:d_grp_code)or
	                             (:d_grp_ind='EMG' and A.ENT_ITEM_GRP_CODE=:d_grp_code)or
								 (:d_grp_ind='PSG' and A.PAYER_SERV_GRP_HDR=:d_grp_code)or
								 (:d_grp_ind='PMG' and A.PAYER_ITEM_GRP_CODE=:d_grp_code) 
							   )
		  ) or
	      (:pk_grp_ind='L' and ( (:d_grp_ind='ESL' and A.PRT_GRP_HDR_CODE=:d_grp_code and A.PRT_GRP_LINE_CODE=:d_line_code) or
		                         (:d_grp_ind='PSL' and A.PAYER_SERV_GRP_HDR=:d_grp_code and A.PAYER_SERV_GRP_LINE=:d_line_code)
							   )
		  )
		) 
	/o*and ( (:pk_grp_ind='G' and A.PRT_GRP_HDR_CODE=:d_grp_code) or
	      (:pk_grp_ind='L' and A.PRT_GRP_HDR_CODE=:d_grp_code and A.PRT_GRP_LINE_CODE=:d_line_code)
		) *o/ //commented for walkthrough
	and cust_code is not null
	and nvl(a.confirmed_yn,'N')!='N'; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select count(*)  into :b0  from BL_PATIENT_CHARGES_FOLIO A ,BL_BLNG_SERV \
C where ((((((((((((OPERATING_FACILITY_ID=:b1 and A.BLNG_SERV_CODE=C.BLNG_SE\
RV_CODE) and EPISODE_TYPE=:b2) and ((:b2<>'R' and EPISODE_ID=:b4) or :b2='R'\
)) and ((:b2 in ('O','E') and VISIT_ID=:b7) or :b2 in ('I','D','R'))) and PA\
TIENT_ID=:b9) and (A.trx_doc_ref,A.trx_doc_ref_line_num,A.trx_doc_ref_seq_nu\
m) not  in (select E.trx_doc_ref ,E.trx_doc_ref_line_num ,E.trx_doc_ref_seq_\
num  from bl_patient_charges_folio E where ((((((((trx_status='C' and EPISOD\
E_TYPE=:b2) and ((:b2<>'R' and EPISODE_ID=:b4) or :b2='R')) and ((:b2 in ('O\
','E') and VISIT_ID=:b7) or :b2 in ('I','D','R'))) and PATIENT_ID=:b9) and E\
.operating_facility_id=A.operating_facility_id) and E.rev_adj_trx_ind in ('R\
','B','A')) and E.orig_doc_ref is  not null ) and E.orig_doc_ref_line_num is\
  not null ) union select orig_doc_ref ,orig_doc_ref_line_num ,orig_doc_ref_\
seq_num  from bl_patient_charges_folio E where ((((((((trx_status='C' and EP\
ISODE_TYPE=:b2) and ((:b2<>'R' and EPIS");
sqlbuft((void **)0, 
  "ODE_ID=:b4) or :b2='R')) and ((:b2 in ('O','E') and VISIT_ID=:b7) or :b2 \
in ('I','D','R'))) and PATIENT_ID=:b9) and E.operating_facility_id=A.operati\
ng_facility_id) and E.rev_adj_trx_ind in ('R','B','A')) and E.orig_doc_ref i\
s  not null ) and E.orig_doc_ref_line_num is  not null ))) and exists (selec\
t B.TRX_DOC_REF  from BL_PATIENT_CHARGES_FOLIO B where (((B.OPERATING_FACILI\
TY_ID=:b1 and B.OPERATING_FACILITY_ID=A.OPERATING_FACILITY_ID) and B.TRX_DOC\
_REF=A.TRX_DOC_REF) and B.TRX_DOC_REF_LINE_NUM=A.TRX_DOC_REF_LINE_NUM))) and\
 NVL(PACKAGE_TRX_YN,'N')='N') and PACKAGE_SEQ_NO is null ) and ((:b27='G' an\
d ((((:b28='ESG' and A.PRT_GRP_HDR_CODE=:b29) or (:b28='EMG' and A.ENT_ITEM_\
GRP_CODE=:b29)) or (:b28='PSG' and A.PAYER_SERV_GRP_HDR=:b29)) or (:b28='PMG\
' and A.PAYER_ITEM_GRP_CODE=:b29))) or (:b27='L' and (((:b28='ESL' and A.PRT\
_GRP_HDR_CODE=:b29) and A.PRT_GRP_LINE_CODE=:b39) or ((:b28='PSL' and A.PAYE\
R_SERV_GRP_HDR=:b29) and A.PAYER_SERV_GRP_LINE=:b39))))) and cust_code is  n\
ot null ) and nvl(a.confirm");
sqlstm.stmt = "ed_yn,'N')<>'N')";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )13393;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_grp_pkg_inside_cnt;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_episode_type;
sqlstm.sqhstl[10] = (unsigned int  )4;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_episode_type;
sqlstm.sqhstl[11] = (unsigned int  )4;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d_episode_id;
sqlstm.sqhstl[12] = (unsigned int  )11;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d_episode_type;
sqlstm.sqhstl[13] = (unsigned int  )4;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&d_episode_type;
sqlstm.sqhstl[14] = (unsigned int  )4;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&d_visit_id;
sqlstm.sqhstl[15] = (unsigned int  )7;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d_episode_type;
sqlstm.sqhstl[16] = (unsigned int  )4;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d_patient_id;
sqlstm.sqhstl[17] = (unsigned int  )63;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&d_episode_type;
sqlstm.sqhstl[18] = (unsigned int  )4;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d_episode_type;
sqlstm.sqhstl[19] = (unsigned int  )4;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&d_episode_id;
sqlstm.sqhstl[20] = (unsigned int  )11;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqhstv[21] = (         void  *)&d_episode_type;
sqlstm.sqhstl[21] = (unsigned int  )4;
sqlstm.sqhsts[21] = (         int  )0;
sqlstm.sqindv[21] = (         void  *)0;
sqlstm.sqinds[21] = (         int  )0;
sqlstm.sqharm[21] = (unsigned int  )0;
sqlstm.sqadto[21] = (unsigned short )0;
sqlstm.sqtdso[21] = (unsigned short )0;
sqlstm.sqhstv[22] = (         void  *)&d_episode_type;
sqlstm.sqhstl[22] = (unsigned int  )4;
sqlstm.sqhsts[22] = (         int  )0;
sqlstm.sqindv[22] = (         void  *)0;
sqlstm.sqinds[22] = (         int  )0;
sqlstm.sqharm[22] = (unsigned int  )0;
sqlstm.sqadto[22] = (unsigned short )0;
sqlstm.sqtdso[22] = (unsigned short )0;
sqlstm.sqhstv[23] = (         void  *)&d_visit_id;
sqlstm.sqhstl[23] = (unsigned int  )7;
sqlstm.sqhsts[23] = (         int  )0;
sqlstm.sqindv[23] = (         void  *)0;
sqlstm.sqinds[23] = (         int  )0;
sqlstm.sqharm[23] = (unsigned int  )0;
sqlstm.sqadto[23] = (unsigned short )0;
sqlstm.sqtdso[23] = (unsigned short )0;
sqlstm.sqhstv[24] = (         void  *)&d_episode_type;
sqlstm.sqhstl[24] = (unsigned int  )4;
sqlstm.sqhsts[24] = (         int  )0;
sqlstm.sqindv[24] = (         void  *)0;
sqlstm.sqinds[24] = (         int  )0;
sqlstm.sqharm[24] = (unsigned int  )0;
sqlstm.sqadto[24] = (unsigned short )0;
sqlstm.sqtdso[24] = (unsigned short )0;
sqlstm.sqhstv[25] = (         void  *)&d_patient_id;
sqlstm.sqhstl[25] = (unsigned int  )63;
sqlstm.sqhsts[25] = (         int  )0;
sqlstm.sqindv[25] = (         void  *)0;
sqlstm.sqinds[25] = (         int  )0;
sqlstm.sqharm[25] = (unsigned int  )0;
sqlstm.sqadto[25] = (unsigned short )0;
sqlstm.sqtdso[25] = (unsigned short )0;
sqlstm.sqhstv[26] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[26] = (unsigned int  )5;
sqlstm.sqhsts[26] = (         int  )0;
sqlstm.sqindv[26] = (         void  *)0;
sqlstm.sqinds[26] = (         int  )0;
sqlstm.sqharm[26] = (unsigned int  )0;
sqlstm.sqadto[26] = (unsigned short )0;
sqlstm.sqtdso[26] = (unsigned short )0;
sqlstm.sqhstv[27] = (         void  *)&pk_grp_ind;
sqlstm.sqhstl[27] = (unsigned int  )1;
sqlstm.sqhsts[27] = (         int  )0;
sqlstm.sqindv[27] = (         void  *)0;
sqlstm.sqinds[27] = (         int  )0;
sqlstm.sqharm[27] = (unsigned int  )0;
sqlstm.sqadto[27] = (unsigned short )0;
sqlstm.sqtdso[27] = (unsigned short )0;
sqlstm.sqhstv[28] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[28] = (unsigned int  )6;
sqlstm.sqhsts[28] = (         int  )0;
sqlstm.sqindv[28] = (         void  *)0;
sqlstm.sqinds[28] = (         int  )0;
sqlstm.sqharm[28] = (unsigned int  )0;
sqlstm.sqadto[28] = (unsigned short )0;
sqlstm.sqtdso[28] = (unsigned short )0;
sqlstm.sqhstv[29] = (         void  *)d_grp_code;
sqlstm.sqhstl[29] = (unsigned int  )10;
sqlstm.sqhsts[29] = (         int  )0;
sqlstm.sqindv[29] = (         void  *)0;
sqlstm.sqinds[29] = (         int  )0;
sqlstm.sqharm[29] = (unsigned int  )0;
sqlstm.sqadto[29] = (unsigned short )0;
sqlstm.sqtdso[29] = (unsigned short )0;
sqlstm.sqhstv[30] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[30] = (unsigned int  )6;
sqlstm.sqhsts[30] = (         int  )0;
sqlstm.sqindv[30] = (         void  *)0;
sqlstm.sqinds[30] = (         int  )0;
sqlstm.sqharm[30] = (unsigned int  )0;
sqlstm.sqadto[30] = (unsigned short )0;
sqlstm.sqtdso[30] = (unsigned short )0;
sqlstm.sqhstv[31] = (         void  *)d_grp_code;
sqlstm.sqhstl[31] = (unsigned int  )10;
sqlstm.sqhsts[31] = (         int  )0;
sqlstm.sqindv[31] = (         void  *)0;
sqlstm.sqinds[31] = (         int  )0;
sqlstm.sqharm[31] = (unsigned int  )0;
sqlstm.sqadto[31] = (unsigned short )0;
sqlstm.sqtdso[31] = (unsigned short )0;
sqlstm.sqhstv[32] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[32] = (unsigned int  )6;
sqlstm.sqhsts[32] = (         int  )0;
sqlstm.sqindv[32] = (         void  *)0;
sqlstm.sqinds[32] = (         int  )0;
sqlstm.sqharm[32] = (unsigned int  )0;
sqlstm.sqadto[32] = (unsigned short )0;
sqlstm.sqtdso[32] = (unsigned short )0;
sqlstm.sqhstv[33] = (         void  *)d_grp_code;
sqlstm.sqhstl[33] = (unsigned int  )10;
sqlstm.sqhsts[33] = (         int  )0;
sqlstm.sqindv[33] = (         void  *)0;
sqlstm.sqinds[33] = (         int  )0;
sqlstm.sqharm[33] = (unsigned int  )0;
sqlstm.sqadto[33] = (unsigned short )0;
sqlstm.sqtdso[33] = (unsigned short )0;
sqlstm.sqhstv[34] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[34] = (unsigned int  )6;
sqlstm.sqhsts[34] = (         int  )0;
sqlstm.sqindv[34] = (         void  *)0;
sqlstm.sqinds[34] = (         int  )0;
sqlstm.sqharm[34] = (unsigned int  )0;
sqlstm.sqadto[34] = (unsigned short )0;
sqlstm.sqtdso[34] = (unsigned short )0;
sqlstm.sqhstv[35] = (         void  *)d_grp_code;
sqlstm.sqhstl[35] = (unsigned int  )10;
sqlstm.sqhsts[35] = (         int  )0;
sqlstm.sqindv[35] = (         void  *)0;
sqlstm.sqinds[35] = (         int  )0;
sqlstm.sqharm[35] = (unsigned int  )0;
sqlstm.sqadto[35] = (unsigned short )0;
sqlstm.sqtdso[35] = (unsigned short )0;
sqlstm.sqhstv[36] = (         void  *)&pk_grp_ind;
sqlstm.sqhstl[36] = (unsigned int  )1;
sqlstm.sqhsts[36] = (         int  )0;
sqlstm.sqindv[36] = (         void  *)0;
sqlstm.sqinds[36] = (         int  )0;
sqlstm.sqharm[36] = (unsigned int  )0;
sqlstm.sqadto[36] = (unsigned short )0;
sqlstm.sqtdso[36] = (unsigned short )0;
sqlstm.sqhstv[37] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[37] = (unsigned int  )6;
sqlstm.sqhsts[37] = (         int  )0;
sqlstm.sqindv[37] = (         void  *)0;
sqlstm.sqinds[37] = (         int  )0;
sqlstm.sqharm[37] = (unsigned int  )0;
sqlstm.sqadto[37] = (unsigned short )0;
sqlstm.sqtdso[37] = (unsigned short )0;
sqlstm.sqhstv[38] = (         void  *)d_grp_code;
sqlstm.sqhstl[38] = (unsigned int  )10;
sqlstm.sqhsts[38] = (         int  )0;
sqlstm.sqindv[38] = (         void  *)0;
sqlstm.sqinds[38] = (         int  )0;
sqlstm.sqharm[38] = (unsigned int  )0;
sqlstm.sqadto[38] = (unsigned short )0;
sqlstm.sqtdso[38] = (unsigned short )0;
sqlstm.sqhstv[39] = (         void  *)d_line_code;
sqlstm.sqhstl[39] = (unsigned int  )10;
sqlstm.sqhsts[39] = (         int  )0;
sqlstm.sqindv[39] = (         void  *)0;
sqlstm.sqinds[39] = (         int  )0;
sqlstm.sqharm[39] = (unsigned int  )0;
sqlstm.sqadto[39] = (unsigned short )0;
sqlstm.sqtdso[39] = (unsigned short )0;
sqlstm.sqhstv[40] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[40] = (unsigned int  )6;
sqlstm.sqhsts[40] = (         int  )0;
sqlstm.sqindv[40] = (         void  *)0;
sqlstm.sqinds[40] = (         int  )0;
sqlstm.sqharm[40] = (unsigned int  )0;
sqlstm.sqadto[40] = (unsigned short )0;
sqlstm.sqtdso[40] = (unsigned short )0;
sqlstm.sqhstv[41] = (         void  *)d_grp_code;
sqlstm.sqhstl[41] = (unsigned int  )10;
sqlstm.sqhsts[41] = (         int  )0;
sqlstm.sqindv[41] = (         void  *)0;
sqlstm.sqinds[41] = (         int  )0;
sqlstm.sqharm[41] = (unsigned int  )0;
sqlstm.sqadto[41] = (unsigned short )0;
sqlstm.sqtdso[41] = (unsigned short )0;
sqlstm.sqhstv[42] = (         void  *)d_line_code;
sqlstm.sqhstl[42] = (unsigned int  )10;
sqlstm.sqhsts[42] = (         int  )0;
sqlstm.sqindv[42] = (         void  *)0;
sqlstm.sqinds[42] = (         int  )0;
sqlstm.sqharm[42] = (unsigned int  )0;
sqlstm.sqadto[42] = (unsigned short )0;
sqlstm.sqtdso[42] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




}

//The below code added by Rajesh for service inside package

get_grp_pkg_inside_cnt1(pk_grp_ind,d_grp_code,d_line_code)  //,d_serv_code
{
l_grp_pkg_service_inside_cnt=0;

/* EXEC SQL SELECT  count(*) into  l_grp_pkg_service_inside_cnt
	FROM bl_patient_charges_folio a, bl_blng_serv c
   WHERE operating_facility_id = :nd_facility_id
     AND a.blng_serv_code = c.blng_serv_code
     AND episode_type = :d_episode_type
     AND (   (:d_episode_type != 'R' AND episode_id = :d_episode_id)
          OR (:d_episode_type = 'R')
         )
     AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
          OR (:d_episode_type IN ('I', 'D', 'R'))
         )
     AND patient_id = :d_patient_id
     AND a.episode_id = :d_episode_id
     AND (   trx_status IS NULL
          OR (    trx_status = 'C'
              AND (   (    NVL (rev_adj_trx_ind, 'R') = 'R'
                       AND (source_doc_ref, source_doc_ref_line_num) NOT IN (
                              SELECT trx_doc_ref, trx_doc_ref_line_num
                                FROM bl_patient_charges_folio
                               WHERE operating_facility_id = :nd_facility_id
                                 AND patient_id = :d_patient_id
                                 AND a.episode_id = :d_episode_id)
                      )
                   OR (:d1_bill_amt = 0)
                  )
             )
          OR (    rev_adj_trx_ind = 'B'
              AND (trx_doc_ref, trx_doc_ref_line_num) NOT IN (
                     SELECT source_doc_ref, source_doc_ref_line_num
                       FROM bl_patient_charges_folio
                      WHERE operating_facility_id = :nd_facility_id
                        AND patient_id = :d_patient_id
                        AND a.episode_id = :d_episode_id)
             )
         )   
     AND EXISTS (
            SELECT b.trx_doc_ref
              FROM bl_patient_charges_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.episode_id = :d_episode_id
               AND NVL (a.billed_flag, 'N') = 'N')
AND EXISTS (
            SELECT 1
              FROM bl_package_folio b
             WHERE b.operating_facility_id = :nd_facility_id
               AND b.operating_facility_id = a.operating_facility_id
               AND b.trx_doc_ref = a.trx_doc_ref
               AND b.trx_doc_ref_line_num = a.trx_doc_ref_line_num
               AND b.package_trx_yn = 'Y'
             )
			 and ( (:pk_grp_ind='G' and ( (:d_grp_ind='ESG' and A.PRT_GRP_HDR_CODE=:d_grp_code)or
	                             (:d_grp_ind='EMG' and A.ENT_ITEM_GRP_CODE=:d_grp_code)or
								 (:d_grp_ind='PSG' and A.PAYER_SERV_GRP_HDR=:d_grp_code)or
								 (:d_grp_ind='PMG' and A.PAYER_ITEM_GRP_CODE=:d_grp_code) 
							   )
				  ) or
				  (:pk_grp_ind='L' and ( (:d_grp_ind='ESL' and A.PRT_GRP_HDR_CODE=:d_grp_code and A.PRT_GRP_LINE_CODE=:d_line_code) or
										 (:d_grp_ind='PSL' and A.PAYER_SERV_GRP_HDR=:d_grp_code and A.PAYER_SERV_GRP_LINE=:d_line_code)
									   )
				  )
				) 
			/oand ( (:pk_grp_ind='G' and A.PRT_GRP_HDR_CODE=:d_grp_code) or
					  (:pk_grp_ind='L' and A.PRT_GRP_HDR_CODE=:d_grp_code and A.PRT_GRP_LINE_CODE=:d_line_code)
					) o/
			and NVL (a.package_trx_yn, 'N') IN ('Y','P') 
			and nvl(a.confirmed_yn,'N')!='N' ; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select count(*)  into :b0  from bl_patient_charges_folio a ,bl_blng_serv \
c where ((((((((((((operating_facility_id=:b1 and a.blng_serv_code=c.blng_se\
rv_code) and episode_type=:b2) and ((:b2<>'R' and episode_id=:b4) or :b2='R'\
)) and ((:b2 in ('O','E') and visit_id=:b7) or :b2 in ('I','D','R'))) and pa\
tient_id=:b9) and a.episode_id=:b4) and ((trx_status is null  or (trx_status\
='C' and ((NVL(rev_adj_trx_ind,'R')='R' and (source_doc_ref,source_doc_ref_l\
ine_num) not  in (select trx_doc_ref ,trx_doc_ref_line_num  from bl_patient_\
charges_folio where ((operating_facility_id=:b1 and patient_id=:b9) and a.ep\
isode_id=:b4))) or :b14=0))) or (rev_adj_trx_ind='B' and (trx_doc_ref,trx_do\
c_ref_line_num) not  in (select source_doc_ref ,source_doc_ref_line_num  fro\
m bl_patient_charges_folio where ((operating_facility_id=:b1 and patient_id=\
:b9) and a.episode_id=:b4))))) and exists (select b.trx_doc_ref  from bl_pat\
ient_charges_folio b where (((((b.operating_facility_id=:b1 and b.operating_\
facility_id=a.operating_facility_id) an");
sqlstm.stmt = "d b.trx_doc_ref=a.trx_doc_ref) and b.trx_doc_ref_line_num=a.t\
rx_doc_ref_line_num) and b.episode_id=:b4) and NVL(a.billed_flag,'N')='N'))) a\
nd exists (select 1  from bl_package_folio b where ((((b.operating_facility_id\
=:b1 and b.operating_facility_id=a.operating_facility_id) and b.trx_doc_ref=a.\
trx_doc_ref) and b.trx_doc_ref_line_num=a.trx_doc_ref_line_num) and b.package_\
trx_yn='Y'))) and ((:b21='G' and ((((:b22='ESG' and A.PRT_GRP_HDR_CODE=:b23) o\
r (:b22='EMG' and A.ENT_ITEM_GRP_CODE=:b23)) or (:b22='PSG' and A.PAYER_SERV_G\
RP_HDR=:b23)) or (:b22='PMG' and A.PAYER_ITEM_GRP_CODE=:b23))) or (:b21='L' an\
d (((:b22='ESL' and A.PRT_GRP_HDR_CODE=:b23) and A.PRT_GRP_LINE_CODE=:b33) or \
((:b22='PSL' and A.PAYER_SERV_GRP_HDR=:b23) and A.PAYER_SERV_GRP_LINE=:b33))))\
) and NVL(a.package_trx_yn,'N') in ('Y','P')) and nvl(a.confirmed_yn,'N')<>'N'\
)";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )13580;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_grp_pkg_service_inside_cnt;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&d_episode_id;
sqlstm.sqhstl[10] = (unsigned int  )11;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[11] = (unsigned int  )5;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d_patient_id;
sqlstm.sqhstl[12] = (unsigned int  )63;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d_episode_id;
sqlstm.sqhstl[13] = (unsigned int  )11;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&d1_bill_amt;
sqlstm.sqhstl[14] = (unsigned int  )sizeof(double);
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[15] = (unsigned int  )5;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d_patient_id;
sqlstm.sqhstl[16] = (unsigned int  )63;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d_episode_id;
sqlstm.sqhstl[17] = (unsigned int  )11;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[18] = (unsigned int  )5;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d_episode_id;
sqlstm.sqhstl[19] = (unsigned int  )11;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[20] = (unsigned int  )5;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqhstv[21] = (         void  *)&pk_grp_ind;
sqlstm.sqhstl[21] = (unsigned int  )1;
sqlstm.sqhsts[21] = (         int  )0;
sqlstm.sqindv[21] = (         void  *)0;
sqlstm.sqinds[21] = (         int  )0;
sqlstm.sqharm[21] = (unsigned int  )0;
sqlstm.sqadto[21] = (unsigned short )0;
sqlstm.sqtdso[21] = (unsigned short )0;
sqlstm.sqhstv[22] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[22] = (unsigned int  )6;
sqlstm.sqhsts[22] = (         int  )0;
sqlstm.sqindv[22] = (         void  *)0;
sqlstm.sqinds[22] = (         int  )0;
sqlstm.sqharm[22] = (unsigned int  )0;
sqlstm.sqadto[22] = (unsigned short )0;
sqlstm.sqtdso[22] = (unsigned short )0;
sqlstm.sqhstv[23] = (         void  *)d_grp_code;
sqlstm.sqhstl[23] = (unsigned int  )10;
sqlstm.sqhsts[23] = (         int  )0;
sqlstm.sqindv[23] = (         void  *)0;
sqlstm.sqinds[23] = (         int  )0;
sqlstm.sqharm[23] = (unsigned int  )0;
sqlstm.sqadto[23] = (unsigned short )0;
sqlstm.sqtdso[23] = (unsigned short )0;
sqlstm.sqhstv[24] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[24] = (unsigned int  )6;
sqlstm.sqhsts[24] = (         int  )0;
sqlstm.sqindv[24] = (         void  *)0;
sqlstm.sqinds[24] = (         int  )0;
sqlstm.sqharm[24] = (unsigned int  )0;
sqlstm.sqadto[24] = (unsigned short )0;
sqlstm.sqtdso[24] = (unsigned short )0;
sqlstm.sqhstv[25] = (         void  *)d_grp_code;
sqlstm.sqhstl[25] = (unsigned int  )10;
sqlstm.sqhsts[25] = (         int  )0;
sqlstm.sqindv[25] = (         void  *)0;
sqlstm.sqinds[25] = (         int  )0;
sqlstm.sqharm[25] = (unsigned int  )0;
sqlstm.sqadto[25] = (unsigned short )0;
sqlstm.sqtdso[25] = (unsigned short )0;
sqlstm.sqhstv[26] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[26] = (unsigned int  )6;
sqlstm.sqhsts[26] = (         int  )0;
sqlstm.sqindv[26] = (         void  *)0;
sqlstm.sqinds[26] = (         int  )0;
sqlstm.sqharm[26] = (unsigned int  )0;
sqlstm.sqadto[26] = (unsigned short )0;
sqlstm.sqtdso[26] = (unsigned short )0;
sqlstm.sqhstv[27] = (         void  *)d_grp_code;
sqlstm.sqhstl[27] = (unsigned int  )10;
sqlstm.sqhsts[27] = (         int  )0;
sqlstm.sqindv[27] = (         void  *)0;
sqlstm.sqinds[27] = (         int  )0;
sqlstm.sqharm[27] = (unsigned int  )0;
sqlstm.sqadto[27] = (unsigned short )0;
sqlstm.sqtdso[27] = (unsigned short )0;
sqlstm.sqhstv[28] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[28] = (unsigned int  )6;
sqlstm.sqhsts[28] = (         int  )0;
sqlstm.sqindv[28] = (         void  *)0;
sqlstm.sqinds[28] = (         int  )0;
sqlstm.sqharm[28] = (unsigned int  )0;
sqlstm.sqadto[28] = (unsigned short )0;
sqlstm.sqtdso[28] = (unsigned short )0;
sqlstm.sqhstv[29] = (         void  *)d_grp_code;
sqlstm.sqhstl[29] = (unsigned int  )10;
sqlstm.sqhsts[29] = (         int  )0;
sqlstm.sqindv[29] = (         void  *)0;
sqlstm.sqinds[29] = (         int  )0;
sqlstm.sqharm[29] = (unsigned int  )0;
sqlstm.sqadto[29] = (unsigned short )0;
sqlstm.sqtdso[29] = (unsigned short )0;
sqlstm.sqhstv[30] = (         void  *)&pk_grp_ind;
sqlstm.sqhstl[30] = (unsigned int  )1;
sqlstm.sqhsts[30] = (         int  )0;
sqlstm.sqindv[30] = (         void  *)0;
sqlstm.sqinds[30] = (         int  )0;
sqlstm.sqharm[30] = (unsigned int  )0;
sqlstm.sqadto[30] = (unsigned short )0;
sqlstm.sqtdso[30] = (unsigned short )0;
sqlstm.sqhstv[31] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[31] = (unsigned int  )6;
sqlstm.sqhsts[31] = (         int  )0;
sqlstm.sqindv[31] = (         void  *)0;
sqlstm.sqinds[31] = (         int  )0;
sqlstm.sqharm[31] = (unsigned int  )0;
sqlstm.sqadto[31] = (unsigned short )0;
sqlstm.sqtdso[31] = (unsigned short )0;
sqlstm.sqhstv[32] = (         void  *)d_grp_code;
sqlstm.sqhstl[32] = (unsigned int  )10;
sqlstm.sqhsts[32] = (         int  )0;
sqlstm.sqindv[32] = (         void  *)0;
sqlstm.sqinds[32] = (         int  )0;
sqlstm.sqharm[32] = (unsigned int  )0;
sqlstm.sqadto[32] = (unsigned short )0;
sqlstm.sqtdso[32] = (unsigned short )0;
sqlstm.sqhstv[33] = (         void  *)d_line_code;
sqlstm.sqhstl[33] = (unsigned int  )10;
sqlstm.sqhsts[33] = (         int  )0;
sqlstm.sqindv[33] = (         void  *)0;
sqlstm.sqinds[33] = (         int  )0;
sqlstm.sqharm[33] = (unsigned int  )0;
sqlstm.sqadto[33] = (unsigned short )0;
sqlstm.sqtdso[33] = (unsigned short )0;
sqlstm.sqhstv[34] = (         void  *)&d_grp_ind;
sqlstm.sqhstl[34] = (unsigned int  )6;
sqlstm.sqhsts[34] = (         int  )0;
sqlstm.sqindv[34] = (         void  *)0;
sqlstm.sqinds[34] = (         int  )0;
sqlstm.sqharm[34] = (unsigned int  )0;
sqlstm.sqadto[34] = (unsigned short )0;
sqlstm.sqtdso[34] = (unsigned short )0;
sqlstm.sqhstv[35] = (         void  *)d_grp_code;
sqlstm.sqhstl[35] = (unsigned int  )10;
sqlstm.sqhsts[35] = (         int  )0;
sqlstm.sqindv[35] = (         void  *)0;
sqlstm.sqinds[35] = (         int  )0;
sqlstm.sqharm[35] = (unsigned int  )0;
sqlstm.sqadto[35] = (unsigned short )0;
sqlstm.sqtdso[35] = (unsigned short )0;
sqlstm.sqhstv[36] = (         void  *)d_line_code;
sqlstm.sqhstl[36] = (unsigned int  )10;
sqlstm.sqhsts[36] = (         int  )0;
sqlstm.sqindv[36] = (         void  *)0;
sqlstm.sqinds[36] = (         int  )0;
sqlstm.sqharm[36] = (unsigned int  )0;
sqlstm.sqadto[36] = (unsigned short )0;
sqlstm.sqtdso[36] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			}  
//upto here  

get_pat_inside_pkg_disc()
{

l_pat_inside_pkg_disc =0;

/* EXEC SQL SELECT SUM(nvl(UPD_DISC_AMT,0)) 
		into l_pat_inside_pkg_disc
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						bill_doc_type_code =:d1_doc_type			//added by vani

                        and bill_doc_num =  :d1_doc_number))		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						bill_doc_type_code =:d1_doc_type		

                        and bill_doc_num =  :d1_doc_number )	

        ))   
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	//AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	//AND B.BILL_DOC_NUM =:d1_doc_number
	AND NVL(PACKAGE_TRX_YN,'N')='Y'
	AND PACKAGE_SEQ_NO IS NOT NULL
	AND CUST_CODE IS NULL); */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select sum(nvl(UPD_DISC_AMT,0)) into :b0  from BL_PATIENT_CHARGES_FOLIO A\
 ,BL_BLNG_SERV C where (((((((OPERATING_FACILITY_ID=:b1 and A.BLNG_SERV_CODE\
=C.BLNG_SERV_CODE) and EPISODE_TYPE=:b2) and ((:b2<>'R' and EPISODE_ID=:b4) \
or :b2='R')) and ((:b2 in ('O','E') and VISIT_ID=:b7) or :b2 in ('I','D','R'\
))) and PATIENT_ID=:b9) and ((trx_status is null  or ((trx_status='C' and NV\
L(REV_ADJ_TRX_IND,'R')='R') and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not\
  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_charges_foli\
o where (((OPERATING_FACILITY_ID=:b1 and patient_id=:b9) and bill_doc_type_c\
ode=:b12) and bill_doc_num=:b13)))) or (REV_ADJ_TRX_IND='B' and (TRX_DOC_REF\
,TRX_DOC_REF_LINE_NUM) not  in (select SOURCE_DOC_REF ,SOURCE_DOC_REF_LINE_N\
UM  from bl_patient_charges_folio where (((OPERATING_FACILITY_ID=:b1 and pat\
ient_id=:b9) and bill_doc_type_code=:b12) and bill_doc_num=:b13))))) and exi\
sts (select B.TRX_DOC_REF  from BL_PATIENT_CHARGES_FOLIO B where ((((((B.OPE\
RATING_FACILITY_ID=:b1 and B.OPERATING_");
sqlstm.stmt = "FACILITY_ID=A.OPERATING_FACILITY_ID) and B.TRX_DOC_REF=A.TRX_\
DOC_REF) and B.TRX_DOC_REF_LINE_NUM=A.TRX_DOC_REF_LINE_NUM) and NVL(PACKAGE_TR\
X_YN,'N')='Y') and PACKAGE_SEQ_NO is  not null ) and CUST_CODE is null )))";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )13743;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_pat_inside_pkg_disc;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[10] = (unsigned int  )5;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_patient_id;
sqlstm.sqhstl[11] = (unsigned int  )63;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[12] = (unsigned int  )27;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[13] = (unsigned int  )52;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[14] = (unsigned int  )5;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&d_patient_id;
sqlstm.sqhstl[15] = (unsigned int  )63;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[16] = (unsigned int  )27;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[17] = (unsigned int  )52;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[18] = (unsigned int  )5;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




}
    
get_pay_inside_pkg_disc()
{

l_pay_inside_pkg_disc =0;

/* EXEC SQL SELECT SUM(nvl(UPD_DISC_AMT,0)) 
		into l_pay_inside_pkg_disc
	FROM BL_PATIENT_CHARGES_FOLIO A, BL_BLNG_SERV C
	WHERE OPERATING_FACILITY_ID = :nd_facility_id
	AND A.BLNG_SERV_CODE = C.BLNG_SERV_CODE
	AND EPISODE_TYPE = :d_episode_type
	AND (
	(:d_episode_type != 'R' AND EPISODE_ID = :d_episode_id) 
	OR 
	(:d_episode_type = 'R')
	)
	AND  (
	(:d_episode_type IN ('O','E') AND VISIT_ID = :d_visit_id) 
	OR
	(:d_episode_type IN ('I','D','R'))
	)
	AND PATIENT_ID = :d_patient_id
	and (trx_status is null 

                or (trx_status ='C' and  NVL(REV_ADJ_TRX_IND,'R')='R' and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not in 

                        (Select TRX_DOC_REF,TRX_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id         and 

						bill_doc_type_code =:d1_doc_type			//added by vani

                        and bill_doc_num =  :d1_doc_number))		//added by vani

                        or (REV_ADJ_TRX_IND ='B' and (TRX_DOC_REF,TRX_DOC_REF_LINE_NUM) 

                        not in (Select SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM from 

                        bl_patient_charges_folio where OPERATING_FACILITY_ID = :nd_facility_id and

                        patient_id=:d_patient_id           and 

						bill_doc_type_code =:d1_doc_type		

                        and bill_doc_num =  :d1_doc_number )	

        ))   
	AND EXISTS (SELECT B.TRX_DOC_REF FROM BL_PATIENT_CHARGES_FOLIO B
	WHERE B.OPERATING_FACILITY_ID = :nd_facility_id
	AND B.OPERATING_FACILITY_ID = A.OPERATING_FACILITY_ID
	AND B.TRX_DOC_REF = A.TRX_DOC_REF
	AND B.TRX_DOC_REF_LINE_NUM = A.TRX_DOC_REF_LINE_NUM
	AND B.BILL_DOC_TYPE_CODE = :d1_doc_type
	AND B.BILL_DOC_NUM =:d1_doc_number
	AND NVL(PACKAGE_TRX_YN,'N')='Y'
	AND PACKAGE_SEQ_NO IS NOT NULL
	AND CUST_CODE IS NOT NULL); */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlbuft((void **)0, 
  "select sum(nvl(UPD_DISC_AMT,0)) into :b0  from BL_PATIENT_CHARGES_FOLIO A\
 ,BL_BLNG_SERV C where (((((((OPERATING_FACILITY_ID=:b1 and A.BLNG_SERV_CODE\
=C.BLNG_SERV_CODE) and EPISODE_TYPE=:b2) and ((:b2<>'R' and EPISODE_ID=:b4) \
or :b2='R')) and ((:b2 in ('O','E') and VISIT_ID=:b7) or :b2 in ('I','D','R'\
))) and PATIENT_ID=:b9) and ((trx_status is null  or ((trx_status='C' and NV\
L(REV_ADJ_TRX_IND,'R')='R') and (SOURCE_DOC_REF,SOURCE_DOC_REF_LINE_NUM) not\
  in (select TRX_DOC_REF ,TRX_DOC_REF_LINE_NUM  from bl_patient_charges_foli\
o where (((OPERATING_FACILITY_ID=:b1 and patient_id=:b9) and bill_doc_type_c\
ode=:b12) and bill_doc_num=:b13)))) or (REV_ADJ_TRX_IND='B' and (TRX_DOC_REF\
,TRX_DOC_REF_LINE_NUM) not  in (select SOURCE_DOC_REF ,SOURCE_DOC_REF_LINE_N\
UM  from bl_patient_charges_folio where (((OPERATING_FACILITY_ID=:b1 and pat\
ient_id=:b9) and bill_doc_type_code=:b12) and bill_doc_num=:b13))))) and exi\
sts (select B.TRX_DOC_REF  from BL_PATIENT_CHARGES_FOLIO B where ((((((((B.O\
PERATING_FACILITY_ID=:b1 and B.OPERATIN");
sqlstm.stmt = "G_FACILITY_ID=A.OPERATING_FACILITY_ID) and B.TRX_DOC_REF=A.TR\
X_DOC_REF) and B.TRX_DOC_REF_LINE_NUM=A.TRX_DOC_REF_LINE_NUM) and B.BILL_DOC_T\
YPE_CODE=:b12) and B.BILL_DOC_NUM=:b13) and NVL(PACKAGE_TRX_YN,'N')='Y') and P\
ACKAGE_SEQ_NO is  not null ) and CUST_CODE is  not null )))";
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )13834;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqhstv[0] = (         void  *)&l_pay_inside_pkg_disc;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqhstv[1] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[1] = (unsigned int  )5;
sqlstm.sqhsts[1] = (         int  )0;
sqlstm.sqindv[1] = (         void  *)0;
sqlstm.sqinds[1] = (         int  )0;
sqlstm.sqharm[1] = (unsigned int  )0;
sqlstm.sqadto[1] = (unsigned short )0;
sqlstm.sqtdso[1] = (unsigned short )0;
sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
sqlstm.sqhstl[2] = (unsigned int  )4;
sqlstm.sqhsts[2] = (         int  )0;
sqlstm.sqindv[2] = (         void  *)0;
sqlstm.sqinds[2] = (         int  )0;
sqlstm.sqharm[2] = (unsigned int  )0;
sqlstm.sqadto[2] = (unsigned short )0;
sqlstm.sqtdso[2] = (unsigned short )0;
sqlstm.sqhstv[3] = (         void  *)&d_episode_type;
sqlstm.sqhstl[3] = (unsigned int  )4;
sqlstm.sqhsts[3] = (         int  )0;
sqlstm.sqindv[3] = (         void  *)0;
sqlstm.sqinds[3] = (         int  )0;
sqlstm.sqharm[3] = (unsigned int  )0;
sqlstm.sqadto[3] = (unsigned short )0;
sqlstm.sqtdso[3] = (unsigned short )0;
sqlstm.sqhstv[4] = (         void  *)&d_episode_id;
sqlstm.sqhstl[4] = (unsigned int  )11;
sqlstm.sqhsts[4] = (         int  )0;
sqlstm.sqindv[4] = (         void  *)0;
sqlstm.sqinds[4] = (         int  )0;
sqlstm.sqharm[4] = (unsigned int  )0;
sqlstm.sqadto[4] = (unsigned short )0;
sqlstm.sqtdso[4] = (unsigned short )0;
sqlstm.sqhstv[5] = (         void  *)&d_episode_type;
sqlstm.sqhstl[5] = (unsigned int  )4;
sqlstm.sqhsts[5] = (         int  )0;
sqlstm.sqindv[5] = (         void  *)0;
sqlstm.sqinds[5] = (         int  )0;
sqlstm.sqharm[5] = (unsigned int  )0;
sqlstm.sqadto[5] = (unsigned short )0;
sqlstm.sqtdso[5] = (unsigned short )0;
sqlstm.sqhstv[6] = (         void  *)&d_episode_type;
sqlstm.sqhstl[6] = (unsigned int  )4;
sqlstm.sqhsts[6] = (         int  )0;
sqlstm.sqindv[6] = (         void  *)0;
sqlstm.sqinds[6] = (         int  )0;
sqlstm.sqharm[6] = (unsigned int  )0;
sqlstm.sqadto[6] = (unsigned short )0;
sqlstm.sqtdso[6] = (unsigned short )0;
sqlstm.sqhstv[7] = (         void  *)&d_visit_id;
sqlstm.sqhstl[7] = (unsigned int  )7;
sqlstm.sqhsts[7] = (         int  )0;
sqlstm.sqindv[7] = (         void  *)0;
sqlstm.sqinds[7] = (         int  )0;
sqlstm.sqharm[7] = (unsigned int  )0;
sqlstm.sqadto[7] = (unsigned short )0;
sqlstm.sqtdso[7] = (unsigned short )0;
sqlstm.sqhstv[8] = (         void  *)&d_episode_type;
sqlstm.sqhstl[8] = (unsigned int  )4;
sqlstm.sqhsts[8] = (         int  )0;
sqlstm.sqindv[8] = (         void  *)0;
sqlstm.sqinds[8] = (         int  )0;
sqlstm.sqharm[8] = (unsigned int  )0;
sqlstm.sqadto[8] = (unsigned short )0;
sqlstm.sqtdso[8] = (unsigned short )0;
sqlstm.sqhstv[9] = (         void  *)&d_patient_id;
sqlstm.sqhstl[9] = (unsigned int  )63;
sqlstm.sqhsts[9] = (         int  )0;
sqlstm.sqindv[9] = (         void  *)0;
sqlstm.sqinds[9] = (         int  )0;
sqlstm.sqharm[9] = (unsigned int  )0;
sqlstm.sqadto[9] = (unsigned short )0;
sqlstm.sqtdso[9] = (unsigned short )0;
sqlstm.sqhstv[10] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[10] = (unsigned int  )5;
sqlstm.sqhsts[10] = (         int  )0;
sqlstm.sqindv[10] = (         void  *)0;
sqlstm.sqinds[10] = (         int  )0;
sqlstm.sqharm[10] = (unsigned int  )0;
sqlstm.sqadto[10] = (unsigned short )0;
sqlstm.sqtdso[10] = (unsigned short )0;
sqlstm.sqhstv[11] = (         void  *)&d_patient_id;
sqlstm.sqhstl[11] = (unsigned int  )63;
sqlstm.sqhsts[11] = (         int  )0;
sqlstm.sqindv[11] = (         void  *)0;
sqlstm.sqinds[11] = (         int  )0;
sqlstm.sqharm[11] = (unsigned int  )0;
sqlstm.sqadto[11] = (unsigned short )0;
sqlstm.sqtdso[11] = (unsigned short )0;
sqlstm.sqhstv[12] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[12] = (unsigned int  )27;
sqlstm.sqhsts[12] = (         int  )0;
sqlstm.sqindv[12] = (         void  *)0;
sqlstm.sqinds[12] = (         int  )0;
sqlstm.sqharm[12] = (unsigned int  )0;
sqlstm.sqadto[12] = (unsigned short )0;
sqlstm.sqtdso[12] = (unsigned short )0;
sqlstm.sqhstv[13] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[13] = (unsigned int  )52;
sqlstm.sqhsts[13] = (         int  )0;
sqlstm.sqindv[13] = (         void  *)0;
sqlstm.sqinds[13] = (         int  )0;
sqlstm.sqharm[13] = (unsigned int  )0;
sqlstm.sqadto[13] = (unsigned short )0;
sqlstm.sqtdso[13] = (unsigned short )0;
sqlstm.sqhstv[14] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[14] = (unsigned int  )5;
sqlstm.sqhsts[14] = (         int  )0;
sqlstm.sqindv[14] = (         void  *)0;
sqlstm.sqinds[14] = (         int  )0;
sqlstm.sqharm[14] = (unsigned int  )0;
sqlstm.sqadto[14] = (unsigned short )0;
sqlstm.sqtdso[14] = (unsigned short )0;
sqlstm.sqhstv[15] = (         void  *)&d_patient_id;
sqlstm.sqhstl[15] = (unsigned int  )63;
sqlstm.sqhsts[15] = (         int  )0;
sqlstm.sqindv[15] = (         void  *)0;
sqlstm.sqinds[15] = (         int  )0;
sqlstm.sqharm[15] = (unsigned int  )0;
sqlstm.sqadto[15] = (unsigned short )0;
sqlstm.sqtdso[15] = (unsigned short )0;
sqlstm.sqhstv[16] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[16] = (unsigned int  )27;
sqlstm.sqhsts[16] = (         int  )0;
sqlstm.sqindv[16] = (         void  *)0;
sqlstm.sqinds[16] = (         int  )0;
sqlstm.sqharm[16] = (unsigned int  )0;
sqlstm.sqadto[16] = (unsigned short )0;
sqlstm.sqtdso[16] = (unsigned short )0;
sqlstm.sqhstv[17] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[17] = (unsigned int  )52;
sqlstm.sqhsts[17] = (         int  )0;
sqlstm.sqindv[17] = (         void  *)0;
sqlstm.sqinds[17] = (         int  )0;
sqlstm.sqharm[17] = (unsigned int  )0;
sqlstm.sqadto[17] = (unsigned short )0;
sqlstm.sqtdso[17] = (unsigned short )0;
sqlstm.sqhstv[18] = (         void  *)&nd_facility_id;
sqlstm.sqhstl[18] = (unsigned int  )5;
sqlstm.sqhsts[18] = (         int  )0;
sqlstm.sqindv[18] = (         void  *)0;
sqlstm.sqinds[18] = (         int  )0;
sqlstm.sqharm[18] = (unsigned int  )0;
sqlstm.sqadto[18] = (unsigned short )0;
sqlstm.sqtdso[18] = (unsigned short )0;
sqlstm.sqhstv[19] = (         void  *)&d1_doc_type;
sqlstm.sqhstl[19] = (unsigned int  )27;
sqlstm.sqhsts[19] = (         int  )0;
sqlstm.sqindv[19] = (         void  *)0;
sqlstm.sqinds[19] = (         int  )0;
sqlstm.sqharm[19] = (unsigned int  )0;
sqlstm.sqadto[19] = (unsigned short )0;
sqlstm.sqtdso[19] = (unsigned short )0;
sqlstm.sqhstv[20] = (         void  *)&d1_doc_number;
sqlstm.sqhstl[20] = (unsigned int  )52;
sqlstm.sqhsts[20] = (         int  )0;
sqlstm.sqindv[20] = (         void  *)0;
sqlstm.sqinds[20] = (         int  )0;
sqlstm.sqharm[20] = (unsigned int  )0;
sqlstm.sqadto[20] = (unsigned short )0;
sqlstm.sqtdso[20] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}




}

fun_bl_report_temp_format()
{
  

nd_line_text.len=strlen(nd_line_text.arr);
nd_line_text.arr[nd_line_text.len]='\0';
/*
  This procedure using for inserting bill format in temp table 
	EXEC SQL EXECUTE
	BEGIN
	:nd_line_num:=:nd_line_num+1;

		BLCOMMON.PROC_BL_REPORT_TEMP_FORMAT(:nd_session_id,
										    'KUILA',
											'BLRVSBL1',
											:nd_pgm_date,
										    :nd_line_num,
										    :nd_page_num,
											:nd_line_text
										   );

	END;
	END-EXEC;
*/
	nd_line_text.arr[0]='\0';
	strcpy(nd_line_text.arr," ");
	nd_line_text.len = strlen(nd_line_text.arr);
	nd_line_text.arr[nd_line_text.len]='\0';

}

fun_add_space(int space)
{
  int i;
 for (i=0;i<space;i++)
 {
  strcat(nd_line_text.arr," ");
 }
}
fun_Pad_desc_with_spl_char_yn()
{
nd_pad_req_yn.arr[0]		= '\0';
nd_pad_req_yn.len			=	0;
nd_print_option.arr[0]		= '\0';	
nd_print_option.len			=	0;		

    if (strcmp(nd_lang_id.arr,"ar")==0 || strcmp(nd_lang_id.arr,"th")==0)
	{
		fun_get_batch_filename();

		if( strcmp(nd_batch_filename.arr,"LOCAL")==0) 
			{
				nd_pad_req_yn.arr[0]='Y';
				nd_print_option.arr[0]='N';	
			}
		
		else
			{
				nd_pad_req_yn.arr[0]='N';
				//nd_print_option.arr[0]='R';	
			}	 
		
		
		nd_pad_req_yn.len=strlen(nd_pad_req_yn.arr);
		nd_print_option.len=strlen(nd_print_option.arr);

		nd_pad_req_yn.arr[nd_pad_req_yn.len]	 = '\0';
		nd_print_option.arr[nd_print_option.len] = '\0';
		
	}
	else
    {
	  nd_pad_req_yn.arr[0]='N';
	  nd_print_option.arr[0]='N';	
	}


}

fun_get_batch_filename()
{
	nd_batch_filename.arr[0] = '\0';
	nd_batch_filename,len	= 0;
	nd_report_option.arr[0]	= '\0';
	nd_report_option.len	= 0;


	/* EXEC SQL select batch_file_name ,
					report_tool_ch
			 into :nd_batch_filename,
				  :nd_report_option
			 from sm_report
			 where report_id=:l_nd_calling_pgm_id; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select batch_file_name ,report_tool_ch into :b0,:b1  from sm\
_report where report_id=:b2";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )13933;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_batch_filename;
 sqlstm.sqhstl[0] = (unsigned int  )22;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_report_option;
 sqlstm.sqhstl[1] = (unsigned int  )5;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&l_nd_calling_pgm_id;
 sqlstm.sqhstl[2] = (unsigned int  )12;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	nd_batch_filename.arr[nd_batch_filename.len] = '\0';
	nd_report_option.arr[nd_report_option.len] = '\0';
	  

}

fun_Pad_desc_with_spl_char_1(orig_string)
char orig_string[101];
{
	

	orig_desc_string.arr[0]		= '\0';
	orig_desc_string.len		=	0;
	nd_desc_with_spl_chr.arr[0]	= '\0';
	nd_desc_with_spl_chr.len	= 0;
	nd_length_of_string=0;

	strcpy(orig_desc_string.arr,orig_string);
		
	orig_desc_string.len	= strlen(orig_desc_string.arr);
	orig_desc_string.arr[orig_desc_string.len] = '\0';
		
	/* EXEC SQL select length(:orig_desc_string)+1 into :nd_length_of_string from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (length(:b0)+1) into :b1  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )13960;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&orig_desc_string;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_length_of_string;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



					
	/* EXEC SQL select rpad(:orig_desc_string,:nd_length_of_string,chr(20))
				into :nd_desc_with_spl_chr from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rpad(:b0,:b1,chr(20)) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )13983;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&orig_desc_string;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_length_of_string;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_desc_with_spl_chr;
 sqlstm.sqhstl[2] = (unsigned int  )2002;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
		
		nd_desc_with_spl_chr.arr[nd_desc_with_spl_chr.len] = '\0';


	
}


fetch_cust_name(orig_string)
char orig_string[100];
{
	d_oth_cust_desc.arr[0] = '\0';
	d_oth_cust_desc.len=0;

	orig_desc_string.arr[0]		= '\0';
	orig_desc_string.len		=	0;

	strcpy(orig_desc_string.arr,orig_string);

	orig_desc_string.len	= strlen(orig_desc_string.arr);
	orig_desc_string.arr[orig_desc_string.len] = '\0';


		/* EXEC SQL SELECT substr(LONG_NAME,1,45) into :d_oth_cust_desc
			 FROM	AR_CUSTOMER_LANG_VW 
			 WHERE  
			 CUST_CODE =:orig_desc_string
			 AND LANGUAGE_ID=:nd_lang_id; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(LONG_NAME,1,45) into :b0  from AR_CUSTOMER_LA\
NG_VW where (CUST_CODE=:b1 and LANGUAGE_ID=:b2)";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )14010;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_oth_cust_desc;
  sqlstm.sqhstl[0] = (unsigned int  )202;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&orig_desc_string;
  sqlstm.sqhstl[1] = (unsigned int  )2002;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&nd_lang_id;
  sqlstm.sqhstl[2] = (unsigned int  )6;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		
	  if(NODATAFOUND)
	  {
			
		/* EXEC SQL SELECT substr(LONG_NAME,1,45) into :d_oth_cust_desc
			 FROM	AR_CUSTOMER
			 WHERE  
			 CUST_CODE =:orig_desc_string; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = "select substr(LONG_NAME,1,45) into :b0  from AR_CUSTOMER wh\
ere CUST_CODE=:b1";
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )14037;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqhstv[0] = (         void  *)&d_oth_cust_desc;
  sqlstm.sqhstl[0] = (unsigned int  )202;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&orig_desc_string;
  sqlstm.sqhstl[1] = (unsigned int  )2002;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			
	  }

	  d_oth_cust_desc.arr[d_oth_cust_desc.len] = '\0';
	

}

fun_Pad_desc_with_spl_char(orig_string)
char orig_string[1000];
{
	orig_desc_string.arr[0]		= '\0';
	orig_desc_string.len		=	0;
	
	nd_desc_with_spl_chr.arr[0]	= '\0';
	nd_desc_with_spl_chr.len	= 0;

	nd_length_of_string=0;
	

	strcpy(orig_desc_string.arr,orig_string);
		
	orig_desc_string.len	= strlen(orig_desc_string.arr);
	orig_desc_string.arr[orig_desc_string.len] = '\0';
	

	/* EXEC SQL select length(:orig_desc_string) into :nd_length_of_string from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select length(:b0) into :b1  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14060;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&orig_desc_string;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_length_of_string;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		
	
	/* EXEC SQL select (:nd_length_of_string)-1 into :nd_length_of_string1 from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (:b0-1) into :b1  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14083;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_length_of_string;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_length_of_string1;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


		

		orig_desc_string1.arr[0]		= '\0';
		orig_desc_string1.len		=	0;
		orig_desc_string1.arr[orig_desc_string1.len] = '\0';
		
	
		strcpy(orig_desc_string1.arr,orig_desc_string.arr);

		orig_desc_string1.arr[nd_length_of_string1]		= '\0';
			
	 		
		orig_desc_string1.len	= strlen(orig_desc_string1.arr);
		orig_desc_string1.arr[orig_desc_string1.len] = '\0';
		
	
	/* EXEC SQL select length(:orig_desc_string1)+1 into :nd_length_of_string2 from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select (length(:b0)+1) into :b1  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14106;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&orig_desc_string1;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_length_of_string2;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
					
	/* EXEC SQL select rpad(:orig_desc_string1,:nd_length_of_string2,chr(20))
				into :nd_desc_with_spl_chr from dual; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select rpad(:b0,:b1,chr(20)) into :b2  from dual ";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14129;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&orig_desc_string1;
 sqlstm.sqhstl[0] = (unsigned int  )2002;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&nd_length_of_string2;
 sqlstm.sqhstl[1] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&nd_desc_with_spl_chr;
 sqlstm.sqhstl[2] = (unsigned int  )2002;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
		
	nd_desc_with_spl_chr.arr[nd_desc_with_spl_chr.len] = '\0';
	 

	
}

declare_other_payer_amt_for_patient()
{
	
	

	/* EXEC SQL DECLARE GET_OTHER_PAYER CURSOR FOR 
			 select sum(upd_net_charge_amt),cust_code,cust_group_code,policy_type_code,policy_number, priority
			 from bl_patient_charges_folio
			 where  patient_id=:d_patient_id
				and episode_id=:d_episode_id
				and cust_code is not null
				and bill_doc_num is null
				and trx_status is null
			 group by cust_code,cust_group_code,policy_type_code,policy_number, priority; */ 




			 
			 
	if (OERROR)
		{ 
			disp_message (ERR_MESG,"declare failed FOR GET_OTHER_PAYER ");
			proc_exit();
		}

	
}

open_other_payer_amt_for_patient()
{

	/* EXEC SQL OPEN GET_OTHER_PAYER; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0388;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14156;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[0] = (unsigned int  )63;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[1] = (unsigned int  )11;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

	

	
	if (OERROR) 
			{ 
			disp_message (ERR_MESG,"Open GET_OTHER_PAYER cursor failed");
			proc_exit();
			}
		return;

}


close_other_payer_amt_for_patient()
{
	
	/* EXEC SQL CLOSE GET_OTHER_PAYER; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14179;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	

	if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Close GET_OTHER_PAYER cursor failed");
		proc_exit();
		}
	

}


fetch_other_payer_amt_for_patient()
{
	
		d_oth_cust_code.arr[0]='\0';
		d_oth_cust_code.len	=0;

		d_oth_cust_group_code.arr[0]='\0';
		d_oth_cust_group_code.len	=0;
		
		d_oth_policy_code.arr[0]='\0';
		d_oth_policy_code.len	=0;
	
		d_oth_policy_number.arr[0]='\0';
		d_oth_policy_number.len	=0;


		d_other_bill_amt=0;

		d_oth_priority=0;
		
	/* EXEC SQL FETCH GET_OTHER_PAYER 
				into
			 :d_other_bill_amt,
			 :d_oth_cust_code,
			 :d_oth_cust_group_code,
			 :d_oth_policy_code,
			 :d_oth_policy_number,
			 :d_oth_priority; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14194;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d_other_bill_amt;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_oth_cust_code;
 sqlstm.sqhstl[1] = (unsigned int  )22;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_oth_cust_group_code;
 sqlstm.sqhstl[2] = (unsigned int  )22;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_oth_policy_code;
 sqlstm.sqhstl[3] = (unsigned int  )52;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_oth_policy_number;
 sqlstm.sqhstl[4] = (unsigned int  )52;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_oth_priority;
 sqlstm.sqhstl[5] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			  
		
		d_oth_doc_type_code.arr[d_oth_doc_type_code.len]		= '\0';
		d_oth_cust_code.arr[d_oth_cust_code.len]				= '\0';
		d_oth_cust_group_code.arr[d_oth_cust_group_code.len]	= '\0';
		d_oth_policy_code.arr[d_oth_policy_code.len]			= '\0';
		d_oth_policy_number.arr[d_oth_policy_number.len]		= '\0';
		
			
	if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Fetch failed on GET_OTHER_PAYER ");
		proc_exit();
		}

	if(NODATAFOUND)
	{
		return 0;
	}
			 	
	return 1;



}

declare_other_payer_amt_for_payer()
{
	
	

	/* EXEC SQL DECLARE GET_OTH_PAYER CURSOR FOR 
			 select sum(upd_net_charge_amt) ,cust_code,cust_group_code,policy_type_code,policy_number,priority
			 from bl_patient_charges_folio
			 where  patient_id=:d_patient_id
				and episode_id=:d_episode_id
				and cust_code is not null
				and bill_doc_num is null
				and trx_status is null
			    and  cust_code||'/'||cust_group_code||'/'||policy_type_code||'/'||policy_number !=:d_oth_group_code 
			 group by cust_code,cust_group_code,policy_type_code,policy_number,priority; */ 


			 
	if (OERROR)
		{ 
			disp_message (ERR_MESG,"declare failed FOR GET_OTH_PAYER ");
			proc_exit();
		}

	
}

open_other_payer_amt_for_payer()
{

	/* EXEC SQL OPEN GET_OTH_PAYER; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0389;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14233;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[0] = (unsigned int  )63;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[1] = (unsigned int  )11;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_oth_group_code;
 sqlstm.sqhstl[2] = (unsigned int  )202;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}

	

	
	if (OERROR) 
			{ 
			disp_message (ERR_MESG,"Open GET_OTH_PAYER cursor failed");
			proc_exit();
			}
		return;

}


close_other_payer_amt_for_payer()
{
	
	/* EXEC SQL CLOSE GET_OTH_PAYER; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14260;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	

	if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Close GET_OTH_PAYER cursor failed");
		proc_exit();
		}
	

}

fetch_other_payer_amt_for_payer()
{
	
		d_oth_cust_code.arr[0]='\0';
		d_oth_cust_code.len	=0;

		d_oth_cust_group_code.arr[0]='\0';
		d_oth_cust_group_code.len	=0;
		
		d_oth_policy_code.arr[0]='\0';
		d_oth_policy_code.len	=0;
	
		d_oth_policy_number.arr[0]='\0';
		d_oth_policy_number.len	=0;


		d_other_bill_amt=0;
		
	/* EXEC SQL FETCH GET_OTH_PAYER 
				into
			 :d_other_bill_amt,
			 :d_oth_cust_code,
			 :d_oth_cust_group_code,
			 :d_oth_policy_code,
			 :d_oth_policy_number,
			 :d_oth_priority; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14275;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d_other_bill_amt;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_oth_cust_code;
 sqlstm.sqhstl[1] = (unsigned int  )22;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_oth_cust_group_code;
 sqlstm.sqhstl[2] = (unsigned int  )22;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_oth_policy_code;
 sqlstm.sqhstl[3] = (unsigned int  )52;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_oth_policy_number;
 sqlstm.sqhstl[4] = (unsigned int  )52;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_oth_priority;
 sqlstm.sqhstl[5] = (unsigned int  )sizeof(int);
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			  
		
		d_oth_doc_type_code.arr[d_oth_doc_type_code.len]		= '\0';
		d_oth_cust_code.arr[d_oth_cust_code.len]				= '\0';
		d_oth_cust_group_code.arr[d_oth_cust_group_code.len]	= '\0';
		d_oth_policy_code.arr[d_oth_policy_code.len]			= '\0';
		d_oth_policy_number.arr[d_oth_policy_number.len]		= '\0';
		
		
	if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Fetch failed on GET_OTHER_PAYER ");
		proc_exit();
		}

	if(NODATAFOUND)
	{
		return 0;
	}
			 	
	return 1;



}

get_sum_of_other_payer_amt()
{
	nd_tot_oth_payer_amt=0;

	/* EXEC SQL select sum(upd_net_charge_amt) into :nd_tot_oth_payer_amt
			 from bl_patient_charges_folio
			 where  patient_id=:d_patient_id
				and episode_id=:d_episode_id
				and cust_code is not null
				and bill_doc_num is null
				and cust_code != :d_cust_code
			  group by cust_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select sum(upd_net_charge_amt) into :b0  from bl_patient_cha\
rges_folio where ((((patient_id=:b1 and episode_id=:b2) and cust_code is  not \
null ) and bill_doc_num is null ) and cust_code<>:b3) group by cust_code";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14314;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_tot_oth_payer_amt;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[1] = (unsigned int  )63;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[2] = (unsigned int  )11;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_cust_code;
 sqlstm.sqhstl[3] = (unsigned int  )27;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			 
}


get_sum_of_other_payer_amt1()
{
	nd_tot_othp_payer_amt=0;

	/* EXEC SQL select sum(upd_net_charge_amt) into :nd_tot_othp_payer_amt
			 from bl_patient_charges_folio
			 where  patient_id=:d_patient_id
				and episode_id=:d_episode_id
				and cust_code is not null
				and bill_doc_num is null
				and cust_code != :d_cust_code
				and	cust_code||'/'||cust_group_code||'/'||policy_type_code||'/'||policy_number !=:d_oth_group_code 
			  group by cust_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select sum(upd_net_charge_amt) into :b0  from bl_patient_cha\
rges_folio where (((((patient_id=:b1 and episode_id=:b2) and cust_code is  not\
 null ) and bill_doc_num is null ) and cust_code<>:b3) and ((((((cust_code||'/\
')||cust_group_code)||'/')||policy_type_code)||'/')||policy_number)<>:b4) grou\
p by cust_code";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14345;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&nd_tot_othp_payer_amt;
 sqlstm.sqhstl[0] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[1] = (unsigned int  )63;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[2] = (unsigned int  )11;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_cust_code;
 sqlstm.sqhstl[3] = (unsigned int  )27;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_oth_group_code;
 sqlstm.sqhstl[4] = (unsigned int  )202;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


			
}


/*****added for crf-0809********/

p_get_pract_name_dtl_format_ind()
{
	
	p_pract_name_incexc_ind.arr[0] = '\0';
	p_pract_name_incexc_ind.len	   = 0;
	
	pract_name_in_dtlformat_ind.arr[0] = '\0';
	pract_name_in_dtlformat_ind.len	   = 0;
	
	p_pract_name_incexc_ind_ent.arr[0] = '\0';
	p_pract_name_incexc_ind_ent.len	   = 0;
	
	d_pract_name_ind.arr[0] = '\0';
	d_pract_name_ind.len	   = 0;
	
	
	/* EXEC SQL select PRINT_PRACT_NAME_INCEXC_IND,PRACT_NAME_IN_DTLFORMAT_IND
					into  :p_pract_name_incexc_ind,:pract_name_in_dtlformat_ind
					from bl_blng_serv
					where blng_serv_code=:d_blng_serv_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select PRINT_PRACT_NAME_INCEXC_IND ,PRACT_NAME_IN_DTLFORMAT_\
IND into :b0,:b1  from bl_blng_serv where blng_serv_code=:b2";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14380;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&p_pract_name_incexc_ind;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&pract_name_in_dtlformat_ind;
 sqlstm.sqhstl[1] = (unsigned int  )4;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_blng_serv_code;
 sqlstm.sqhstl[2] = (unsigned int  )33;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			p_pract_name_incexc_ind.arr[p_pract_name_incexc_ind.len] = '\0';
			pract_name_in_dtlformat_ind.arr[pract_name_in_dtlformat_ind.len] = '\0';
			
   if(strcmp(p_pract_name_incexc_ind.arr,"E")==0)
    {
		strcpy(d_pract_name_ind.arr,"N");

	}
	else
	{
		if(strcmp(p_pract_name_incexc_ind.arr,"L")==0)	
		 {
				/* EXEC SQL select PRINT_PRACT_NAME_INCEXC_IND 
				into :p_pract_name_incexc_ind_ent
				from BL_BLNG_PRT_GRP_LINE
				where PRT_GRP_HDR_CODE =:d_prt_grp_hdr_code
				  and PRT_GRP_LINE_CODE=:d_prt_grp_line_code; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select PRINT_PRACT_NAME_INCEXC_IND into :b0  from BL_BLNG\
_PRT_GRP_LINE where (PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )14407;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&p_pract_name_incexc_ind_ent;
    sqlstm.sqhstl[0] = (unsigned int  )4;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d_prt_grp_hdr_code;
    sqlstm.sqhstl[1] = (unsigned int  )9;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d_prt_grp_line_code;
    sqlstm.sqhstl[2] = (unsigned int  )9;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				p_pract_name_incexc_ind_ent.arr[p_pract_name_incexc_ind_ent.len] = '\0';
				
				if(strcmp(p_pract_name_incexc_ind_ent.arr,"E")==0)	
				 {
					strcpy(d_pract_name_ind.arr,"N");
				 }
				 else
				 {
					strcpy(d_pract_name_ind.arr,pract_name_in_dtlformat_ind.arr);
				 }

		 }
		 else
		 {
			strcpy(d_pract_name_ind.arr,pract_name_in_dtlformat_ind.arr);

		 }
			 
	}


}


p_get_print_pract_name_ind()
{

	d_print_pract_name_ind.arr[0] = '\0';
	d_print_pract_name_ind.len	   = 0;

	if(strcmp(d_pract_name_ind.arr,"R")!=0)	
	{
		
			if(strcmp(d_pract_name_ind.arr,"A")==0)	
			{
			  if(strcmp(p_serv_desc_sep_line_yn.arr,"N")==0)
			  strcpy(d_print_pract_name_ind.arr,"S");  /**Note! : if Service Description prinitng is not a separate line then we have to print pract name in Separate line only Even thoug selected as print After service Name	**/
			  else
			  strcpy(d_print_pract_name_ind.arr,d_pract_name_ind.arr);
			  	
			}
			else
			{
				strcpy(d_print_pract_name_ind.arr,d_pract_name_ind.arr);
			}	

	}
    else
	 {
		strcpy(d_print_pract_name_ind.arr,p_pract_name_in_dtlformat_ind.arr);	
		 
	 }
	
	
	
}

c_get_pract_name_dtl_format_ind()
{
	
	p_pract_name_incexc_ind.arr[0] = '\0';
	p_pract_name_incexc_ind.len	   = 0;
	
	pract_name_in_dtlformat_ind.arr[0] = '\0';
	pract_name_in_dtlformat_ind.len	   = 0;
	
	p_pract_name_incexc_ind_ent.arr[0] = '\0';
	p_pract_name_incexc_ind_ent.len	   = 0;

	d1_pract_name_ind.arr[0] = '\0';
	d1_pract_name_ind.len	   = 0;


	/* EXEC SQL select PRINT_PRACT_NAME_INCEXC_IND,PRACT_NAME_IN_DTLFORMAT_IND
					into  :p_pract_name_incexc_ind,:pract_name_in_dtlformat_ind
					from bl_blng_serv
					where blng_serv_code=:d1_blng_serv_code; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = "select PRINT_PRACT_NAME_INCEXC_IND ,PRACT_NAME_IN_DTLFORMAT_\
IND into :b0,:b1  from bl_blng_serv where blng_serv_code=:b2";
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14434;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqhstv[0] = (         void  *)&p_pract_name_incexc_ind;
 sqlstm.sqhstl[0] = (unsigned int  )4;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&pract_name_in_dtlformat_ind;
 sqlstm.sqhstl[1] = (unsigned int  )4;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d1_blng_serv_code;
 sqlstm.sqhstl[2] = (unsigned int  )33;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



			p_pract_name_incexc_ind.arr[p_pract_name_incexc_ind.len] = '\0';
			pract_name_in_dtlformat_ind.arr[pract_name_in_dtlformat_ind.len] = '\0';
		
   if(strcmp(p_pract_name_incexc_ind.arr,"E")==0)
    {
		strcpy(d1_pract_name_ind.arr,"N");

	}
	else
	{
		
		if(strcmp(p_pract_name_incexc_ind.arr,"L")==0)	
		 {
				/* EXEC SQL select PRINT_PRACT_NAME_INCEXC_IND 
				into :p_pract_name_incexc_ind_ent
				from BL_BLNG_PRT_GRP_LINE
				where PRT_GRP_HDR_CODE =:d1_prt_grp_hdr_code
				  and PRT_GRP_LINE_CODE=:d1_prt_grp_line_code; */ 

{
    struct sqlexd sqlstm;
    sqlstm.sqlvsn = 12;
    sqlstm.arrsiz = 52;
    sqlstm.sqladtp = &sqladt;
    sqlstm.sqltdsp = &sqltds;
    sqlstm.stmt = "select PRINT_PRACT_NAME_INCEXC_IND into :b0  from BL_BLNG\
_PRT_GRP_LINE where (PRT_GRP_HDR_CODE=:b1 and PRT_GRP_LINE_CODE=:b2)";
    sqlstm.iters = (unsigned int  )1;
    sqlstm.offset = (unsigned int  )14461;
    sqlstm.selerr = (unsigned short)1;
    sqlstm.cud = sqlcud0;
    sqlstm.sqlest = (unsigned char  *)&sqlca;
    sqlstm.sqlety = (unsigned short)4352;
    sqlstm.occurs = (unsigned int  )0;
    sqlstm.sqhstv[0] = (         void  *)&p_pract_name_incexc_ind_ent;
    sqlstm.sqhstl[0] = (unsigned int  )4;
    sqlstm.sqhsts[0] = (         int  )0;
    sqlstm.sqindv[0] = (         void  *)0;
    sqlstm.sqinds[0] = (         int  )0;
    sqlstm.sqharm[0] = (unsigned int  )0;
    sqlstm.sqadto[0] = (unsigned short )0;
    sqlstm.sqtdso[0] = (unsigned short )0;
    sqlstm.sqhstv[1] = (         void  *)&d1_prt_grp_hdr_code;
    sqlstm.sqhstl[1] = (unsigned int  )9;
    sqlstm.sqhsts[1] = (         int  )0;
    sqlstm.sqindv[1] = (         void  *)0;
    sqlstm.sqinds[1] = (         int  )0;
    sqlstm.sqharm[1] = (unsigned int  )0;
    sqlstm.sqadto[1] = (unsigned short )0;
    sqlstm.sqtdso[1] = (unsigned short )0;
    sqlstm.sqhstv[2] = (         void  *)&d1_prt_grp_line_code;
    sqlstm.sqhstl[2] = (unsigned int  )9;
    sqlstm.sqhsts[2] = (         int  )0;
    sqlstm.sqindv[2] = (         void  *)0;
    sqlstm.sqinds[2] = (         int  )0;
    sqlstm.sqharm[2] = (unsigned int  )0;
    sqlstm.sqadto[2] = (unsigned short )0;
    sqlstm.sqtdso[2] = (unsigned short )0;
    sqlstm.sqphsv = sqlstm.sqhstv;
    sqlstm.sqphsl = sqlstm.sqhstl;
    sqlstm.sqphss = sqlstm.sqhsts;
    sqlstm.sqpind = sqlstm.sqindv;
    sqlstm.sqpins = sqlstm.sqinds;
    sqlstm.sqparm = sqlstm.sqharm;
    sqlstm.sqparc = sqlstm.sqharc;
    sqlstm.sqpadto = sqlstm.sqadto;
    sqlstm.sqptdso = sqlstm.sqtdso;
    sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



				  p_pract_name_incexc_ind_ent.arr[p_pract_name_incexc_ind_ent.len] = '\0';

				
				if(strcmp(p_pract_name_incexc_ind_ent.arr,"E")==0)	
				 {
					strcpy(d1_pract_name_ind.arr,"N");
				 }
				 else
				 {
					strcpy(d1_pract_name_ind.arr,pract_name_in_dtlformat_ind.arr);
				 }

		 }
		 else
		 {
			strcpy(d1_pract_name_ind.arr,pract_name_in_dtlformat_ind.arr);

		 }
			 
	}


}


c_get_print_pract_name_ind()
{

	d1_print_pract_name_ind.arr[0] = '\0';
	d1_print_pract_name_ind.len	   = 0;
		
	
	if(strcmp(d1_pract_name_ind.arr,"R")!=0)	
	{
		
			if(strcmp(d1_pract_name_ind.arr,"A")==0)	
			{
			  if(strcmp(c_serv_desc_sep_line_yn.arr,"N")==0)
			  strcpy(d1_print_pract_name_ind.arr,"S");  /**Note! : if Service Description prinitng is not a separate line then we have to print pract name in Separate line only Even thoug selected as print After service Name	**/
			  else
			  strcpy(d1_print_pract_name_ind.arr,d1_pract_name_ind.arr);
			  	
			}
			else
			{
				strcpy(d1_print_pract_name_ind.arr,d1_pract_name_ind.arr);
			}	

	}
    else
	 {
		strcpy(d1_print_pract_name_ind.arr,c_pract_name_in_dtlformat_ind.arr);	
		 
	 }

}


/*******upto here**********/


declare_patient_deposit()
{
	/* EXEC SQL DECLARE GET_PATIENT_DEPOSIT CURSOR FOR 
			SELECT ORG_DOC_TYPE_CODE||'/'||ORG_DOC_NUM||'/'||ORG_DOC_SRNO,
			SLMT_TYPE_CODE,ABS(DOC_AMT),ORG_DOC_DATE
			FROM BL_PATIENT_LEDGER
			WHERE 
			PATIENT_ID=:d_patient_id
			AND EPISODE_ID=:d_episode_id
			AND (   (:d_episode_type IN ('O', 'E') AND visit_id = :d_visit_id)
				  OR (:d_episode_type IN ('I', 'D', 'R'))
				 )
			AND tRX_TYPE_CODE='5'
			and RECPT_NATURE_CODE in ('AD','PR')
			AND DOC_OUTST_AMT <> 0
			AND TRX_STATUS IS NULL
			UNION
			SELECT ORG_DOC_TYPE_CODE||'/'||ORG_DOC_NUM||'/'||ORG_DOC_SRNO,
			SLMT_TYPE_CODE,ABS(DOC_AMT),ORG_DOC_DATE
			FROM BL_PATIENT_LEDGER
			WHERE 
			PATIENT_ID=:d_patient_id
			AND EPISODE_TYPE='R'
			AND tRX_TYPE_CODE='5'
			and RECPT_NATURE_CODE in ('AD','PR')
			AND DOC_OUTST_AMT <> 0
			AND TRX_STATUS IS NULL
			ORDER BY ORG_DOC_DATE; */ 
		

}




open_patient_deposit()
{
	/* EXEC SQL OPEN GET_PATIENT_DEPOSIT; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.stmt = sq0396;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14488;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqcmod = (unsigned int )0;
 sqlstm.sqhstv[0] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[0] = (unsigned int  )63;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_episode_id;
 sqlstm.sqhstl[1] = (unsigned int  )11;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[2] = (unsigned int  )4;
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_visit_id;
 sqlstm.sqhstl[3] = (unsigned int  )7;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqhstv[4] = (         void  *)&d_episode_type;
 sqlstm.sqhstl[4] = (unsigned int  )4;
 sqlstm.sqhsts[4] = (         int  )0;
 sqlstm.sqindv[4] = (         void  *)0;
 sqlstm.sqinds[4] = (         int  )0;
 sqlstm.sqharm[4] = (unsigned int  )0;
 sqlstm.sqadto[4] = (unsigned short )0;
 sqlstm.sqtdso[4] = (unsigned short )0;
 sqlstm.sqhstv[5] = (         void  *)&d_patient_id;
 sqlstm.sqhstl[5] = (unsigned int  )63;
 sqlstm.sqhsts[5] = (         int  )0;
 sqlstm.sqindv[5] = (         void  *)0;
 sqlstm.sqinds[5] = (         int  )0;
 sqlstm.sqharm[5] = (unsigned int  )0;
 sqlstm.sqadto[5] = (unsigned short )0;
 sqlstm.sqtdso[5] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

fetch_patient_deposit()
{
	d_patient_deposit_num.arr[0] = '\0';
	d_patient_deposit_num.len    = 0;

	d_patient_deposit_sett.arr[0] = '\0';
	d_patient_deposit_num.len	  = 0;

	d_patient_deposit_date.arr[0] = '\0';
	d_patient_deposit_date.len	  = 0;

	d_patient_deposidt_amt=0;


	/* EXEC SQL FETCH GET_PATIENT_DEPOSIT into
			:d_patient_deposit_num,
			:d_patient_deposit_sett,
			:d_patient_deposidt_amt,
			:d_patient_deposit_date; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14527;
 sqlstm.selerr = (unsigned short)1;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlstm.sqfoff = (           int )0;
 sqlstm.sqfmod = (unsigned int )2;
 sqlstm.sqhstv[0] = (         void  *)&d_patient_deposit_num;
 sqlstm.sqhstl[0] = (unsigned int  )42;
 sqlstm.sqhsts[0] = (         int  )0;
 sqlstm.sqindv[0] = (         void  *)0;
 sqlstm.sqinds[0] = (         int  )0;
 sqlstm.sqharm[0] = (unsigned int  )0;
 sqlstm.sqadto[0] = (unsigned short )0;
 sqlstm.sqtdso[0] = (unsigned short )0;
 sqlstm.sqhstv[1] = (         void  *)&d_patient_deposit_sett;
 sqlstm.sqhstl[1] = (unsigned int  )42;
 sqlstm.sqhsts[1] = (         int  )0;
 sqlstm.sqindv[1] = (         void  *)0;
 sqlstm.sqinds[1] = (         int  )0;
 sqlstm.sqharm[1] = (unsigned int  )0;
 sqlstm.sqadto[1] = (unsigned short )0;
 sqlstm.sqtdso[1] = (unsigned short )0;
 sqlstm.sqhstv[2] = (         void  *)&d_patient_deposidt_amt;
 sqlstm.sqhstl[2] = (unsigned int  )sizeof(double);
 sqlstm.sqhsts[2] = (         int  )0;
 sqlstm.sqindv[2] = (         void  *)0;
 sqlstm.sqinds[2] = (         int  )0;
 sqlstm.sqharm[2] = (unsigned int  )0;
 sqlstm.sqadto[2] = (unsigned short )0;
 sqlstm.sqtdso[2] = (unsigned short )0;
 sqlstm.sqhstv[3] = (         void  *)&d_patient_deposit_date;
 sqlstm.sqhstl[3] = (unsigned int  )52;
 sqlstm.sqhsts[3] = (         int  )0;
 sqlstm.sqindv[3] = (         void  *)0;
 sqlstm.sqinds[3] = (         int  )0;
 sqlstm.sqharm[3] = (unsigned int  )0;
 sqlstm.sqadto[3] = (unsigned short )0;
 sqlstm.sqtdso[3] = (unsigned short )0;
 sqlstm.sqphsv = sqlstm.sqhstv;
 sqlstm.sqphsl = sqlstm.sqhstl;
 sqlstm.sqphss = sqlstm.sqhsts;
 sqlstm.sqpind = sqlstm.sqindv;
 sqlstm.sqpins = sqlstm.sqinds;
 sqlstm.sqparm = sqlstm.sqharm;
 sqlstm.sqparc = sqlstm.sqharc;
 sqlstm.sqpadto = sqlstm.sqadto;
 sqlstm.sqptdso = sqlstm.sqtdso;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		
	if (OERROR) 
		{ 
		disp_message (ERR_MESG,"Fetch failed on GET_PATIENT_DEPOSIT ");
		proc_exit();
		}

	d_patient_deposit_num.arr[d_patient_deposit_num.len]   = '\0';
	d_patient_deposit_sett.arr[d_patient_deposit_sett.len] = '\0';


	if(NODATAFOUND)
	{
		return 0;
	}
			 	
	return 1;

}

close_patient_deposit()
{
	/* EXEC SQL CLOSE GET_PATIENT_DEPOSIT; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14558;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


}

/***Tax break up chgs ***/

declare_tax_pkg()
{

/* EXEC SQL DECLARE TAX_BREAK_CUR_PKG CURSOR FOR
SELECT SUM(BL_GET_TAX_AMOUNT(a.operating_facility_id, 
			     a.TRX_DOC_REF, 
			     a.TRX_DOC_REF_LINE_NUM,
				a.TRX_DOC_REF_SEQ_NUM,
				a.RULE_CODE,
				a.ADDL_CHARGE_AMT,
				a.SERV_TAX_YN,'P',null)) Tax_amt  
FROM BL_PAT_CHRG_FOLIO_ADDL_CHARGE A
WHERE (a.operating_facility_id, a.TRX_DOC_REF, a.TRX_DOC_REF_LINE_NUM ,  a.TRX_DOC_REF_SEQ_NUM) in
(SELECT c.operating_facility_id, c.TRX_DOC_REF, c.TRX_DOC_REF_LINE_NUM ,  c.TRX_DOC_REF_SEQ_NUM
FROM BL_PATIENT_CHARGES_FOLIO C
WHERE c.TRX_DOC_REF=a.TRX_DOC_REF
AND c.TRX_DOC_REF_LINE_NUM =a.TRX_DOC_REF_LINE_NUM
AND  c.TRX_DOC_REF_SEQ_NUM=a.TRX_DOC_REF_SEQ_NUM
AND NVL (c.billed_flag, 'N') = 'N'
AND c.episode_type = :d_episode_type
AND c.patient_id = :d_patient_id
AND c.episode_id = :d_episode_id
and c.cust_code  = :d2_cust_code
and nvl(c.priority,0)   = nvl(:d_priority,0)
 )
and EXISTS 
(SELECT 'Y' 
FROM BL_package_FOLIO d
WHERE d.TRX_DOC_REF=a.TRX_DOC_REF
AND d.TRX_DOC_REF_LINE_NUM =a.TRX_DOC_REF_LINE_NUM
AND  d.TRX_DOC_REF_SEQ_NUM=a.TRX_DOC_REF_SEQ_NUM
and d.package_trx_yn='Y'
 ); */ 



sprintf(st_var,"%d",sqlca.sqlcode );

if ( OERROR && strcmp(st_var,"-1405")!=0)
{ 

disp_message (ERR_MESG,"Declare declare_tax_breakup_pkg Cursor failed");
proc_exit();
}

	return;
}

open_tax_breakup_pkg()
	{ 
		/* EXEC SQL OPEN TAX_BREAK_CUR_PKG; */ 

{
  struct sqlexd sqlstm;
  sqlstm.sqlvsn = 12;
  sqlstm.arrsiz = 52;
  sqlstm.sqladtp = &sqladt;
  sqlstm.sqltdsp = &sqltds;
  sqlstm.stmt = sq0397;
  sqlstm.iters = (unsigned int  )1;
  sqlstm.offset = (unsigned int  )14573;
  sqlstm.selerr = (unsigned short)1;
  sqlstm.cud = sqlcud0;
  sqlstm.sqlest = (unsigned char  *)&sqlca;
  sqlstm.sqlety = (unsigned short)4352;
  sqlstm.occurs = (unsigned int  )0;
  sqlstm.sqcmod = (unsigned int )0;
  sqlstm.sqhstv[0] = (         void  *)&d_episode_type;
  sqlstm.sqhstl[0] = (unsigned int  )4;
  sqlstm.sqhsts[0] = (         int  )0;
  sqlstm.sqindv[0] = (         void  *)0;
  sqlstm.sqinds[0] = (         int  )0;
  sqlstm.sqharm[0] = (unsigned int  )0;
  sqlstm.sqadto[0] = (unsigned short )0;
  sqlstm.sqtdso[0] = (unsigned short )0;
  sqlstm.sqhstv[1] = (         void  *)&d_patient_id;
  sqlstm.sqhstl[1] = (unsigned int  )63;
  sqlstm.sqhsts[1] = (         int  )0;
  sqlstm.sqindv[1] = (         void  *)0;
  sqlstm.sqinds[1] = (         int  )0;
  sqlstm.sqharm[1] = (unsigned int  )0;
  sqlstm.sqadto[1] = (unsigned short )0;
  sqlstm.sqtdso[1] = (unsigned short )0;
  sqlstm.sqhstv[2] = (         void  *)&d_episode_id;
  sqlstm.sqhstl[2] = (unsigned int  )11;
  sqlstm.sqhsts[2] = (         int  )0;
  sqlstm.sqindv[2] = (         void  *)0;
  sqlstm.sqinds[2] = (         int  )0;
  sqlstm.sqharm[2] = (unsigned int  )0;
  sqlstm.sqadto[2] = (unsigned short )0;
  sqlstm.sqtdso[2] = (unsigned short )0;
  sqlstm.sqhstv[3] = (         void  *)&d2_cust_code;
  sqlstm.sqhstl[3] = (unsigned int  )27;
  sqlstm.sqhsts[3] = (         int  )0;
  sqlstm.sqindv[3] = (         void  *)0;
  sqlstm.sqinds[3] = (         int  )0;
  sqlstm.sqharm[3] = (unsigned int  )0;
  sqlstm.sqadto[3] = (unsigned short )0;
  sqlstm.sqtdso[3] = (unsigned short )0;
  sqlstm.sqhstv[4] = (         void  *)&d_priority;
  sqlstm.sqhstl[4] = (unsigned int  )sizeof(int);
  sqlstm.sqhsts[4] = (         int  )0;
  sqlstm.sqindv[4] = (         void  *)0;
  sqlstm.sqinds[4] = (         int  )0;
  sqlstm.sqharm[4] = (unsigned int  )0;
  sqlstm.sqadto[4] = (unsigned short )0;
  sqlstm.sqtdso[4] = (unsigned short )0;
  sqlstm.sqphsv = sqlstm.sqhstv;
  sqlstm.sqphsl = sqlstm.sqhstl;
  sqlstm.sqphss = sqlstm.sqhsts;
  sqlstm.sqpind = sqlstm.sqindv;
  sqlstm.sqpins = sqlstm.sqinds;
  sqlstm.sqparm = sqlstm.sqharm;
  sqlstm.sqparc = sqlstm.sqharc;
  sqlstm.sqpadto = sqlstm.sqadto;
  sqlstm.sqptdso = sqlstm.sqtdso;
  sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



		sprintf(st_var,"%d",sqlca.sqlcode );
		
		if (OERROR && strcmp(st_var,"-1405")!=0) 
		{ 
		disp_message (ERR_MESG,"Open TAX_BREAK_CUR_PKG cursor failed");
		proc_exit();
		}
	return;
	}
 
fetch_tax_breakup_cur_pkg()
{



/* EXEC SQL FETCH TAX_BREAK_CUR_PKG INTO d_tax_amt_pkg; */ 

{
struct sqlexd sqlstm;
sqlstm.sqlvsn = 12;
sqlstm.arrsiz = 52;
sqlstm.sqladtp = &sqladt;
sqlstm.sqltdsp = &sqltds;
sqlstm.iters = (unsigned int  )1;
sqlstm.offset = (unsigned int  )14608;
sqlstm.selerr = (unsigned short)1;
sqlstm.cud = sqlcud0;
sqlstm.sqlest = (unsigned char  *)&sqlca;
sqlstm.sqlety = (unsigned short)4352;
sqlstm.occurs = (unsigned int  )0;
sqlstm.sqfoff = (           int )0;
sqlstm.sqfmod = (unsigned int )2;
sqlstm.sqhstv[0] = (         void  *)&d_tax_amt_pkg;
sqlstm.sqhstl[0] = (unsigned int  )sizeof(double);
sqlstm.sqhsts[0] = (         int  )0;
sqlstm.sqindv[0] = (         void  *)0;
sqlstm.sqinds[0] = (         int  )0;
sqlstm.sqharm[0] = (unsigned int  )0;
sqlstm.sqadto[0] = (unsigned short )0;
sqlstm.sqtdso[0] = (unsigned short )0;
sqlstm.sqphsv = sqlstm.sqhstv;
sqlstm.sqphsl = sqlstm.sqhstl;
sqlstm.sqphss = sqlstm.sqhsts;
sqlstm.sqpind = sqlstm.sqindv;
sqlstm.sqpins = sqlstm.sqinds;
sqlstm.sqparm = sqlstm.sqharm;
sqlstm.sqparc = sqlstm.sqharc;
sqlstm.sqpadto = sqlstm.sqadto;
sqlstm.sqptdso = sqlstm.sqtdso;
sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}


	
	sprintf(st_var,"%d",sqlca.sqlcode );
		
	if(OERROR && strcmp(st_var,"-1405")!=0 )
	{ 
		disp_message(ERR_MESG,"FETCH FAILED IN TAX_BREAK_CUR_PKG");
		proc_exit();
	}


	if(NODATAFOUND)
	{
		return 0;
	}


return 1;
		

}

close_tax_break_cur_pkg()
{ 
	/* EXEC SQL CLOSE TAX_BREAK_CUR_PKG; */ 

{
 struct sqlexd sqlstm;
 sqlstm.sqlvsn = 12;
 sqlstm.arrsiz = 52;
 sqlstm.sqladtp = &sqladt;
 sqlstm.sqltdsp = &sqltds;
 sqlstm.iters = (unsigned int  )1;
 sqlstm.offset = (unsigned int  )14627;
 sqlstm.cud = sqlcud0;
 sqlstm.sqlest = (unsigned char  *)&sqlca;
 sqlstm.sqlety = (unsigned short)4352;
 sqlstm.occurs = (unsigned int  )0;
 sqlcxt((void **)0, &sqlctx, &sqlstm, &sqlfpn);
}



	sprintf(st_var,"%d",sqlca.sqlcode );

	if (OERROR && strcmp(st_var,"-1405")!=0) 
	{
	disp_message (ERR_MESG,"Close tax_break_cur_pkg failed");
	proc_exit();
	}
	return;
}

/****upto here tax break up****/