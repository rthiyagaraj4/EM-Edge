/*******************************************************************************
 * Copyright 1999-2015, Computer Sciences Corporation. All rights reserved.
 *  
 * Warning: This computer program is protected by copyright law and international treaties.
 * Unauthorized reproduction or distribution of this program, or any portion of it, 
 * may result in severe civil and criminal penalties, and will be prosecuted to 
 * the maximum extent possible under the law.
 ******************************************************************************/
/* 
--------------------------------------------------------------------------------------------------------
Date		Edit History	Name			Rev.Date		Rev.Name		Description
--------------------------------------------------------------------------------------------------------
?            100            ?           		created
10/18/2011	 IN29270		Dinesh T			Changed for removing the unnecessary commas in the combined text
28/06/2012	 IN032576	    Chowminya G         Discrete Measure linked Standard Value Reference was wrong display when Login Thai. 
16/08/2012	 IN034386	    Chowminya G         Discrete Measure linked Standard Value Reference was wrong display for practitioner(Short text).
25/07/2014	 IN048864		Vijayakumar K	25/07/2014		Ramesh Goli		Bru-HIMS-CRF-433 - Employee Name And Employee Address In Standard Value Link
--------------------------------------------------------------------------------------------------------
Date       	Edit History     Name      	Rev.Date		Rev.Name		Description
--------------------------------------------------------------------------------------------------------
16/08/2017	IN060946		RajaS		17/08/2017		Raja S			ML-MMOH-CRF-0520
22/04/2018	IN065908		Sharanraj	03/05/2018		Ramesh G		GHL-CRF-0493
09/05/2018  IN067570		Sharanraj	09/05/2018		Ramesh      	CA-GHL-CRF-0493/05-Record Clinical Note	
10/05/2018  IN067582		Sharanraj	10/05/2018		Ramesh			CA-GHL-CRF-0493/08-Record Clinical Note
17/05/2018  IN067664		Sharanraj	09/05/2018		Ramesh      	CA-GHL-CRF-0493/09-Record Clinical Note	
22/10/2018  IN067855		Ramya Maddena 22/10/2018	Ramesh      	ML-MMOH-CRF-1202
28/02/2025	  68801	            Twinkle Shah		28/02/2025			ML-MMOH-CRF-0579 
-------------------------------------------------------------------------------------------------------------------------------
*/
package eCA ;
import java.util.* ;
public class StandardCompRepository 
{
	private static StandardCompRepository instance ;
	private int i=0;

	protected HashMap dataMap ;
	/*public static final int DISPLAY_MIN_RECORDS = 8;
	public static final int DISPLAY_RECORDS 	= 36;
	public static final int DISPLAY_EQ_RECORDS 	= 12;
	public static final int DISPLAY_MAX_RECORDS = 44;
	public static final int SHOW_MODAL_WINDOW   = 1;*/

	public StandardCompRepository() throws Exception 
	{
		dataMap = new HashMap() ;
		load() ;
	}

	public int getSqlSize()
	{
		return dataMap.size();
	}

	public static synchronized String getCAKeyValue( String key ) throws Exception
	{

		if ( instance == null )
		{
			instance = new StandardCompRepository() ;
			instance.i++;
		}
		return ( instance.getValue( key.trim().toUpperCase()) ) ;
	}

	public static int getI()
	{
		return instance.i;
	}

	private String getValue( String key ) throws Exception
	{
		String value = "" ;
		try
		{
			value = (String) dataMap.get(key) ;

			if ( value == null )
				value = "";
			//throw new Exception( key + " : Key not found" ) ;

		}
		catch ( Exception e )
		{
			throw new Exception( key + " : Key not found" ) ;
		}
	
		return value ;
	}
	protected void finalize() throws Throwable
	{
		if ( dataMap != null )
			dataMap = null ;
	}
	private void load() throws Exception 
	{
		dataMap.put( "ADM_ADMISSIONTYPE","SELECT ADMISSION_TYPE_CODE,SHORT_DESC FROM IP_ADMISSION_TYPE WHERE EFF_STATUS='E' ORDER BY SHORT_DESC" );
		dataMap.put( "ADM_DEPARTMENT","SELECT DEPT_CODE,SHORT_DESC FROM AM_DEPT WHERE EFF_STATUS='E' ORDER BY SHORT_DESC ");
		dataMap.put( "ADM_DISCHARGETYPE","SELECT DISCHARGE_TYPE_CODE,SHORT_DESC FROM IP_DISCHARGE_TYPE WHERE EFF_STATUS='E' ORDER BY SHORT_DESC ");
		dataMap.put( "ADM_PATIENT_CLASS","SELECT PATIENT_CLASS,SHORT_DESC FROM AM_PATIENT_CLASS ORDER BY SHORT_DESC");
		dataMap.put( "ADM_PRACTITIONER","SELECT PRACTITIONER_ID, PRACTITIONER_NAME FROM AM_PRACTITIONER_LANG_VW WHERE EFF_STATUS='E' AND LANGUAGE_ID=$$LANGUAGE_ID## ORDER BY PRACTITIONER_NAME ");
		dataMap.put( "ADM_NURSE","SELECT PRACTITIONER_ID,PRACTITIONER_NAME FROM AM_PRACTITIONER_LANG_VW WHERE EFF_STATUS='E' and PRACT_TYPE in ('NS','MW') AND LANGUAGE_ID=$$LANGUAGE_ID## ORDER BY PRACTITIONER_NAME ");
		/*IN067570 starts*/
		//dataMap.put( "ADM_NURSE_ID","SELECT PRACTITIONER_NAME,PRACTITIONER_ID FROM AM_PRACTITIONER_LANG_VW WHERE EFF_STATUS='E' and PRACT_TYPE in ('NS','MW') AND LANGUAGE_ID=$$LANGUAGE_ID## ORDER BY PRACTITIONER_NAME ");
		dataMap.put( "ADM_NURSE_ID","SELECT PRACTITIONER_ID,PRACTITIONER_NAME FROM AM_PRACTITIONER_LANG_VW WHERE EFF_STATUS='E' and PRACT_TYPE in ('NS','MW') AND LANGUAGE_ID=$$LANGUAGE_ID## ORDER BY PRACTITIONER_NAME "); 
		/*IN067570 ends*/
		dataMap.put( "ADM_PRACTMDSG","SELECT PRACTITIONER_ID,PRACTITIONER_NAME FROM AM_PRACTITIONER WHERE EFF_STATUS='E' and PRACT_TYPE in ('MD','SG') ORDER BY PRACTITIONER_NAME ");
		dataMap.put( "ADM_SERVICE","SELECT SERVICE_CODE,SHORT_DESC FROM AM_SERVICE WHERE EFF_STATUS='E'ORDER BY SHORT_DESC");
		dataMap.put( "ADM_SPECIALITY","SELECT SPECIALITY_CODE,SHORT_DESC FROM AM_SPECIALITY WHERE EFF_STATUS='E' ORDER BY SHORT_DESC");
		dataMap.put( "ADM_TRANSFERTYPE","SELECT TRANSFER_TYPE_CODE,SHORT_DESC FROM IP_TRANSFER_TYPE WHERE EFF_STATUS='E' ORDER BY SHORT_DESC");
		dataMap.put( "CM_ANAESTHESIA","SELECT ANAESTHESIA_CODE,SHORT_DESC FROM AM_ANAESTHESIA WHERE EFF_STATUS='E' ORDER BY SHORT_DESC");
		dataMap.put( "CM_DIAGNOSIS-ICD10","SELECT TERM_CODE,SHORT_DESC FROM MR_TERM_CODE WHERE TERM_SET_ID='ICD10' ORDER BY TERM_CODE");
		dataMap.put( "CM_DIAGNOSIS-ICD9CM","SELECT TERM_CODE,SHORT_DESC FROM MR_TERM_CODE WHERE TERM_SET_ID='ICD9CMD' ORDER BY TERM_CODE");
		dataMap.put( "CM_DRUG","SELECT DRUG_CODE, DRUG_DESC FROM PH_DRUG ORDER BY DRUG_DESC");
		dataMap.put( "CM_PROCEDURE-CPT4","SELECT CPT_CODE,SHORT_DESC FROM MR_CPT_CODE ORDER BY CPT_CODE");
		dataMap.put( "CM_PROCEDURE-ICD9CM","SELECT TERM_CODE,SHORT_DESC FROM MR_TERM_CODE WHERE TERM_SET_ID='ICD9CMP' ORDER BY TERM_CODE");
		dataMap.put( "CM_PROC-ICD10PCS","SELECT TERM_CODE,SHORT_DESC FROM MR_TERM_CODE WHERE TERM_SET_ID='ICD10PCS' ORDER BY TERM_CODE");
		dataMap.put( "DG_PATIENT_AGE","SELECT get_age(date_of_birth) FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##" );
		dataMap.put( "DG_PATIENT_ALT_ID1","SELECT ALT_ID1_NO FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PATIENT_ALT_ID2","SELECT ALT_ID2_NO FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PATIENT_DOB", "SELECT TO_CHAR(DATE_OF_BIRTH,'DD/MM/YYYY') FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PATIENT_ETHNICITY","SELECT SHORT_DESC FROM MP_PATIENT A, MP_ETHNIC_GROUP B WHERE A.PATIENT_ID=$$PATIENT_ID## AND B.ETHNIC_GROUP_CODE(+)=A.ETHNIC_GRP_CODE");
		dataMap.put( "DG_PATIENT_ID", "SELECT $$PATIENT_ID## FROM DUAL ");
		dataMap.put( "DG_PATIENT_NAME", "SELECT DECODE ($$LANGUAGE_ID##,'en', patient_name,NVL(patient_name_loc_lang,patient_name)) PATIENT_NAME FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID## ");
		dataMap.put( "DG_PATIENT_NATIONAL","SELECT B.LONG_DESC FROM MP_PATIENT A, MP_COUNTRY B WHERE A.PATIENT_ID=$$PATIENT_ID## AND B.COUNTRY_CODE=A.NATIONALITY_CODE");
		dataMap.put( "DG_PATIENT_NAT_ID","SELECT NATIONAL_ID_NO FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID## ");
		dataMap.put( "DG_PATIENT_RACE","SELECT B.SHORT_DESC FROM MP_PATIENT A, MP_RACE B WHERE A.PATIENT_ID=$$PATIENT_ID## AND A.RACE_CODE=B.RACE_CODE");
		dataMap.put( "DG_PAT_MARITIAL_STAT","SELECT B.SHORT_DESC FROM MP_PATIENT A, MP_MARITAL_STATUS B WHERE B.MAR_STATUS_CODE=A.MAR_STATUS_CODE AND A.PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PATIENT_OTH_ALT_I","SELECT OTH_ALT_ID_NO FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PATIENT_GENDER","SELECT DECODE(SEX,'M','Male','F','Female','Unknown') FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID## ");

		dataMap.put( "STD_CURR_DATE" ,"SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY') FROM DUAL");
		dataMap.put( "STD_CURR_DATETM","SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY HH24:MI') FROM DUAL");
		dataMap.put( "STD_CURR_TIME" ,"SELECT TO_CHAR(SYSDATE,'HH24:MI') FROM DUAL");
		//Administration
		
		
		dataMap.put( "DG_DEATH_DATE_TIME","SELECT TO_CHAR(DECEASED_DATE,'DD/MM/YYYY HH24:MI') DECEASED_DATE FROM mp_patient WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_AUTOPSY_NUM" ,"SELECT O.AUTOPSY_NO FROM mo_mortuary_regn O WHERE O.PATIENT_ID=$$PATIENT_ID## AND O.BODY_RECEIVED_DATE=(SELECT MAX(I.BODY_RECEIVED_DATE ) FROM mo_mortuary_regn I WHERE I.PATIENT_ID=O.PATIENT_ID) AND ROWNUM=1 ");
		dataMap.put( "DG_POLICE_STATION ","SELECT O.POL_STN_ID FROM mo_mortuary_regn O WHERE O.PATIENT_ID=$$PATIENT_ID## AND O.BODY_RECEIVED_DATE=(SELECT MAX(I.BODY_RECEIVED_DATE ) FROM mo_mortuary_regn I WHERE I.PATIENT_ID=O.PATIENT_ID) AND ROWNUM=1");
		dataMap.put( "DG_REPORT_NUM" ,"SELECT O.POL_REP_NO FROM mo_mortuary_regn O WHERE O.PATIENT_ID=$$PATIENT_ID## AND O.BODY_RECEIVED_DATE=(SELECT MAX(I.BODY_RECEIVED_DATE ) FROM mo_mortuary_regn I WHERE I.PATIENT_ID=O.PATIENT_ID) AND ROWNUM=1 ");
		dataMap.put( "NB_GENDER","SELECT DECODE(NB_SEX,'M','Male','F','Female','Unknown') FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_BIRTH_WEIGHT" ,"SELECT WEIGHT FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_BIRTH_LENGTH" ,"SELECT LENGTH FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_BIRTH_COH" ,"SELECT CIRCUMFERENCE FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_BIRTH_COC" ,"SELECT CHEST_CIRCUMFERENCE FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DELIVERY_GESTATION" ,"SELECT decode(GESTATIONAL_UNIT,'W', decode(nvl(GESTATIONAL_PERIOD,0),0,null,GESTATIONAL_PERIOD||' Weeks ')||decode(nvl(GESTATIONAL_PERIOD_IN_DAYS,0),0, null,GESTATIONAL_PERIOD_IN_DAYS||' Days' ),nvl(GESTATIONAL_PERIOD,GESTATIONAL_PERIOD_IN_DAYS)||' Days')  GESTATIONAL_PERIOD FROM	 mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DEL_NUM_OF_BIRTH" ,"SELECT NO_OF_BIRTHS FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_BCG_YN" ,"SELECT POLIO_N_BCG_GIVEN_YN FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_HEP_B_YN" ,"SELECT VITK_N_HEPB_GIVEN_YN FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_VIT_K_YN" ,"SELECT VITK_N_HEPB_GIVEN_YN FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_APGAR_1" ,"SELECT APGAR_SCORE FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_APGAR_5" ,"SELECT APGAR_SCORE_IN_5_MINS FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_APGAR_10" ,"SELECT APGAR_SCORE_IN_10_MINS FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_CONG_ANOMALIES" ,"SELECT CONG_ANOMALIES_CODE  FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_PATENCY_OF_ANUS" ,"SELECT PATENCY_OF_ANUS_YN  FROM mp_birth_register WHERE PATIENT_ID=$$PATIENT_ID##");
		//dataMap.put( "PI_RESI_ADDRESS" ,"SELECT  NVL2(RESI_ADDR_LINE1,RESI_ADDR_LINE1||',',NULL)||NVL2(RESI_ADDR_LINE2,RESI_ADDR_LINE2||',',NULL)||NVL2(RESI_ADDR_LINE3,RESI_ADDR_LINE3||',',NULL)||NVL2(RESI_ADDR_LINE4,RESI_ADDR_LINE4||',',NULL)||RES_TOWN_DESC||','||RES_AREA_DESC||','||RESI_COUNTRY_NAME||','||RESI_POSTAL_CODE ADDRESS from mp_chg_pat_dtls_vw WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "PI_RESI_ADDRESS" ,"SELECT  (  NVL2 (resi_addr_line1, resi_addr_line1 || ',', NULL) || NVL2 (resi_addr_line2, resi_addr_line2 || ',', NULL)|| NVL2 (resi_addr_line3, resi_addr_line3 || ',', NULL)|| NVL2 (resi_addr_line4, resi_addr_line4 || ',', NULL) || (Select DESC2_VALUE from SM_OTH_LANG_DATA_SKEY  where  pk_value = res_town_code  and language_id=$$LANGUAGE_ID## and table_id='MP_RES_TOWN')   || ',' || (Select DESC2_VALUE from SM_OTH_LANG_DATA_SKEY  where  pk_value = res_area_code  and language_id=$$LANGUAGE_ID## and table_id='MP_RES_AREA') || ',' || (Select DESC2_VALUE from SM_OTH_LANG_DATA_SKEY  where  pk_value = resi_country_code  and language_id=$$LANGUAGE_ID## and table_id='MP_COUNTRY') || ',' || (select short_desc from mp_postal_code where postal_code = resi_postal_code)) address FROM mp_chg_pat_dtls_vw WHERE patient_id = $$PATIENT_ID##"); //--[IN032576]
		dataMap.put( "PI_EDUC_LEVEL" ,"SELECT  EDUC_LEVEL_DESC from mp_chg_pat_dtls_vw WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "PI_OCCUP" ,"SELECT  OCCUPATION_DESC from mp_chg_pat_dtls_vw WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "PI_HOME_TEL_NO" ,"SELECT  PRN_TEL_NO from mp_chg_pat_dtls_vw WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "PI_OFF_TEL_NO" ,"SELECT  EMPLR_OFF_TEL_NO from mp_chg_pat_dtls_vw WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "ENC_VISITADM_DATE" ,"SELECT TO_CHAR(VISIT_ADM_DATE_TIME,'DD/MM/YYYY HH24:MI') FROM PR_ENCOUNTER WHERE FACILITY_ID=$$FACILITY_ID## AND ENCOUNTER_ID=$$ENCOUNTER_ID##");
		dataMap.put( "ENC_CURR_LOCN" ,"SELECT B.SHORT_DESC FROM PR_ENCOUNTER A,IP_NURSING_UNIT B WHERE A.FACILITY_ID=$$FACILITY_ID## AND A.ENCOUNTER_ID=$$ENCOUNTER_ID## AND B.FACILITY_ID=A.FACILITY_ID AND B.NURSING_UNIT_CODE=A.ASSIGN_CARE_LOCN_CODE ");
		dataMap.put( "ENC_REFERRAL_SOURCE" ,"select  decode(a.FROM_REF_TYPE,'L','Login Facility','E','Enterprise','X','External')    ||','|| d.SHORT_DESC    ||','|| c.SHORT_DESC    ||','|| case when a.FROM_REF_TYPE='X' then   (select b.short_desc from am_referral b where b.REFERRAL_CODE=a.FROM_ref_code)    when a.FROM_REF_TYPE in ('E','L') then   (select facility_name from sm_facility_param where facility_id = a.FROM_FACILITY_ID)    end    ||','|| case when a.FROM_REF_TYPE='X' then a.FROM_LOCN_DESC         when a.FROM_LOCN_TYPE in ('C','Y','E') then      (select short_desc from op_clinic where Facility_id=a.FROM_FACILITY_ID and clinic_code=a.FRom_LOCN_CODE)   when a.FROM_LOCN_TYPE in ('N') then      (select short_desc from ip_nursing_unit where Facility_id=a.FROM_FACILITY_ID and Nursing_unit_CODE=a.FRom_LOCN_CODE)    end from  pr_referral_register a , am_speciality c , am_hcare_setting_type d where     a.FROM_FACILITY_ID=$$FACILITY_ID## AND a.FROM_ENCOUNTER_ID = $$ENCOUNTER_ID## and a.FROM_HCARE_SETTING_TYPE = d.HCARE_SETTING_TYPE_CODE and a.FROM_SPECIALITY_CODE = c.SPECIALITY_CODE (+) AND ROWNUM=1 ");
		dataMap.put( "SPL_CODE_LIST","select SPLTY_MST_CODE,SHORT_DESC from CA_SPLTY_MAST_CODE_VAL where MAST_TYPE_REF=$$MAST_TYPE_REF##  order by 2");
		dataMap.put( "SPL_OCCU_LIST","SELECT OCPN_CODE,SHORT_DESC FROM MP_OCCUPATION WHERE EFF_STATUS='E' ORDER BY 2");
		dataMap.put( "SPL_GEST_AGE","SELECT RESULT_NUM FROM CA_SPLTY_DISCR_MSR WHERE DISCR_MSR_ID='MC01GESTNAGE' AND PATIENT_ID=$$PATIENT_ID## AND TRANS_DATE=(SELECT MAX(TRANS_DATE) FROM CA_SPLTY_DISCR_MSR WHERE DISCR_MSR_ID='MC01GESTNAGE' AND PATIENT_ID=$$PATIENT_ID##) AND ROWNUM=1 ");
		dataMap.put( "SPL_PRACTITIONER","SELECT A.PRACTITIONER_ID,A.PRACTITIONER_NAME FROM AM_PRACTITIONER A, AM_PRACT_FOR_FACILITY B WHERE B.FACILITY_ID=$$FACILITY_ID## AND A.PRACTITIONER_ID=B.PRACTITIONER_ID AND A.EFF_STATUS='E' AND PRIMARY_SPECIALITY_CODE =$$SPECIALITY_CODE##  UNION ALL SELECT A.PRACTITIONER_ID,A.PRACTITIONER_NAME FROM AM_PRACTITIONER A, AM_PRACT_SPECIALITIES B WHERE B.FACILITY_ID=$$FACILITY_ID## AND A.PRACTITIONER_ID=B.PRACTITIONER_ID AND A.EFF_STATUS='E' AND B.SPECIALITY_CODE  =$$SPECIALITY_CODE##  ORDER BY 2 ");
		dataMap.put( "ENC_DT_OF_DISCHARGE" ,"SELECT TO_CHAR(DISCHARGE_DATE_TIME,'DD/MM/YYYY HH24:MI') FROM PR_ENCOUNTER WHERE FACILITY_ID=$$FACILITY_ID## AND ENCOUNTER_ID=$$ENCOUNTER_ID##");
		//dataMap.put( "ENC_ATTEND_PRACT" ,"SELECT B.SHORT_NAME FROM PR_ENCOUNTER A, AM_PRACTITIONER B WHERE A.FACILITY_ID=$$FACILITY_ID## AND A.ENCOUNTER_ID=$$ENCOUNTER_ID## AND B.PRACTITIONER_ID=A.ATTEND_PRACTITIONER_ID");
		dataMap.put( "ENC_ATTEND_PRACT" ,"SELECT B.PRACTITIONER_NAME FROM PR_ENCOUNTER A, AM_PRACTITIONER B WHERE A.FACILITY_ID=$$FACILITY_ID## AND A.ENCOUNTER_ID=$$ENCOUNTER_ID## AND B.PRACTITIONER_ID=A.ATTEND_PRACTITIONER_ID");//--[IN034386]
		dataMap.put("ENC_PAT_ENC_ID","SELECT $$ENCOUNTER_ID## FROM DUAL");
		dataMap.put("NB_BIRTH_DT_TM","SELECT TO_CHAR(TIME_OF_BIRTH, 'DD/MM/YYYY HH24:MI') FROM MP_BIRTH_REGISTER WHERE PATIENT_ID=$$PATIENT_ID##");
		//dataMap.put("ENC_ATT_PRACT_CR","SELECT CREDENTIAL_ID1||', '||CREDENTIAL_ID2||', '||CREDENTIAL_ID3||chr(13)||DEGREE||'  '||APC_NO prac_cred  FROM AM_PRACTITIONER A, PR_ENCOUNTER B WHERE A.PRACTITIONER_ID=B.ATTEND_PRACTITIONER_ID AND FACILITY_ID=$$FACILITY_ID## AND ENCOUNTER_ID=$$ENCOUNTER_ID##");//IN29270
		dataMap.put("ENC_ATT_PRACT_CR","SELECT RTRIM(NVL2 (CREDENTIAL_ID1, CREDENTIAL_ID1 || ', ', NULL)|| NVL2 (CREDENTIAL_ID2, CREDENTIAL_ID2 || ', ', NULL)|| NVL2 (CREDENTIAL_ID3, CREDENTIAL_ID3 || ', ', NULL)|| NVL2 (DEGREE, DEGREE || ', ', NULL)|| NVL2 (APC_NO, APC_NO || ',', NULL),',') PRAC_CRED FROM AM_PRACTITIONER A, PR_ENCOUNTER B WHERE A.PRACTITIONER_ID = B.ATTEND_PRACTITIONER_ID AND FACILITY_ID = $$FACILITY_ID## AND ENCOUNTER_ID = $$ENCOUNTER_ID##");//IN29270
		dataMap.put("ENC_ATT_PRACT_APC_NO","SELECT APC_NO med_license_num  FROM AM_PRACTITIONER A, PR_ENCOUNTER B WHERE A.PRACTITIONER_ID=B.ATTEND_PRACTITIONER_ID AND FACILITY_ID=$$FACILITY_ID## AND ENCOUNTER_ID=$$ENCOUNTER_ID##");
		dataMap.put( "ENC_EXP_DT_DISCHARGE" ,"SELECT TO_CHAR(EXPECTED_DISCHARGE_DATE ,'DD/MM/YYYY HH24:MI') FROM IP_DISCHARGE_ADVICE WHERE DIS_ADV_STATUS!='9' and  FACILITY_ID=$$FACILITY_ID## AND ENCOUNTER_ID=$$ENCOUNTER_ID##");		
		dataMap.put( "DG_PAT_EMPLYR_NAME" ,"SELECT ORGANIZATION_NAME FROM mp_pat_rel_contacts WHERE PATIENT_ID=$$PATIENT_ID##");//IN048864	
		/*dataMap.put( "DG_PAT_EMPLYR_ADD" ,"SELECT ADDR3_LINE1||','||ADDR3_LINE2||','||ADDR3_LINE3||','||ADDR3_LINE4||','||mp_get_desc.mp_res_town(contact3_res_town_code,$$LANGUAGE_ID##,1)||','||mp_get_desc.mp_res_area(contact3_res_area_code,$$LANGUAGE_ID##,1)||','||mp_get_desc.mp_region(contact3_region_code,$$LANGUAGE_ID##,1) ||','||mp_get_desc.MP_POSTAL_CODE(postal3_code,$$LANGUAGE_ID##,2)||','||mp_get_desc.mp_country(country3_code,$$LANGUAGE_ID##,1) EMPLOYER_ADD FROM mp_pat_rel_contacts WHERE PATIENT_ID=$$PATIENT_ID##");//IN048864 */
		dataMap.put( "DG_PAT_EMPLYR_ADD" ,"SELECT nvl2(ADDR3_LINE1, ADDR3_LINE1 ||',' ,ADDR3_LINE1) || nvl2(ADDR3_LINE2, ADDR3_LINE2 ||',' ,ADDR3_LINE2) || nvl2(ADDR3_LINE3, ADDR3_LINE3 ||',', ADDR3_LINE3) || nvl2(ADDR3_LINE4, ADDR3_LINE4 ||',' ,ADDR3_LINE4) || NVL2(contact3_res_town_code, mp_get_desc.mp_res_town(contact3_res_town_code,$$LANGUAGE_ID##,1)||',' , mp_get_desc.mp_res_town(contact3_res_town_code,$$LANGUAGE_ID##,1) ) || nvl2(contact3_res_area_code , mp_get_desc.mp_res_area(contact3_res_area_code,$$LANGUAGE_ID##,1)||',' , mp_get_desc.mp_res_area(contact3_res_area_code,$$LANGUAGE_ID##,1) ) || nvl2(contact3_region_code , mp_get_desc.mp_region(contact3_region_code,$$LANGUAGE_ID##,1) ||',' , mp_get_desc.mp_region(contact3_region_code,$$LANGUAGE_ID##,1) ) || nvl2(postal3_code , mp_get_desc.MP_POSTAL_CODE(postal3_code,$$LANGUAGE_ID##,2)||',' , mp_get_desc.MP_POSTAL_CODE(postal3_code,$$LANGUAGE_ID##,2) ) || mp_get_desc.mp_country(country3_code,$$LANGUAGE_ID##,1) EMPLOYER_ADD FROM mp_pat_rel_contacts WHERE PATIENT_ID=$$PATIENT_ID##");//IN048864
		dataMap.put( "RECENT_WEIGHTOF_PAT" ,"SELECT * FROM (SELECT   NVL (DISCR_MSR_RESULT_NUM, '') CURR_WEIGHT FROM   CA_ENCNTR_DISCR_MSR WHERE   DISCR_MSR_ID =(SELECT   DISCR_MSR_ID FROM   OR_ORDER_FIELD WHERE FIELD_MNEMONIC = 'WEIGHT' AND ORDER_CATEGORY = 'PH') AND PATIENT_ID = $$PATIENT_ID## AND ENCOUNTER_ID = $$ENCOUNTER_ID## ORDER BY TEST_OBSERV_DT_TM DESC ) WHERE ROWNUM = 1");//Retrieve Weight of patient from DB //Added for IN060946
		
		/*IN065908 Starts*/
		/*IN067566 starts*/
		//dataMap.put( "ACTIVE_DIAGONIS" ,"SELECT  a.term_code diag_code, d.short_desc diag_desc FROM pr_diagnosis a, mr_term_code d, mr_term_set c WHERE c.term_set_id = a.term_set_id AND d.term_set_id = a.term_set_id AND d.term_code = a.term_code AND a.patient_id = $$PATIENT_ID## AND c.term_set_id NOT LIKE 'NANDA' AND d.term_set_id NOT LIKE 'NANDA' AND NVL (a.curr_status, 'O') = 'A' AND NVL (sensitive_yn, 'N') = DECODE ('N','N', 'N', NVL (sensitive_yn, 'N'))ORDER BY a.onset_date DESC");//
		  //dataMap.put( "ACTIVE_DIAGONIS" ,"SELECT  a.term_code diag_code, d.short_desc diag_desc FROM pr_diagnosis a, mr_term_code d, mr_term_set c WHERE c.term_set_id = a.term_set_id AND d.term_set_id = a.term_set_id AND d.term_code = a.term_code AND a.patient_id = $$PATIENT_ID## AND c.term_set_id LIKE 'ICD%' AND d.term_set_id LIKE 'ICD%' AND NVL (a.curr_status, 'O') = 'A' AND NVL (sensitive_yn, 'N') = DECODE ('N','N', 'N', NVL (sensitive_yn, 'N'))ORDER BY a.onset_date DESC");//comitted for IN067855
		dataMap.put( "ACTIVE_DIAGONIS" ,"SELECT  a.term_code diag_code,a.term_code_short_desc diag_desc1,mr_get_desc.mr_term_code (a.term_set_id,a.term_code,$$LANGUAGE_ID##,'2') diag_desc FROM pr_diagnosis a, mr_term_code d, mr_term_set c WHERE c.term_set_id = a.term_set_id AND d.term_set_id = a.term_set_id AND d.term_code = a.term_code AND a.patient_id = $$PATIENT_ID## AND c.term_set_id LIKE 'ICD%' AND d.term_set_id LIKE 'ICD%' AND NVL (a.curr_status, 'O') = 'A' AND NVL (sensitive_yn, 'N') = DECODE ('N','N', 'N', NVL (sensitive_yn, 'N'))ORDER BY a.onset_date DESC");//added for IN067855
		/*IN067566 Ends*/
		/*IN067582 Starts*/
		//dataMap.put( "DRUG_ORDERS" ,"SELECT   a.order_category ,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,$$LANGUAGE_ID##,'2') order_category_short_desc,   DECODE(nvl(b.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc,  AM_GET_DESC.AM_PATIENT_CLASS(patient_class, $$LANGUAGE_ID##,'2') patient_class_short_desc,patient_class, a.order_id order_id,patient_id, encounter_id,episode_id,episode_visit_num, TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,or_get_order_catalog (a.order_id, a.order_type_code,$$LANGUAGE_ID##, 'PH',b.order_line_num) order_detail, b.order_catalog_code , source_type,source_code,b.priority ,b.order_type_code  , OR_GET_DESC.OR_ORDER_TYPE(b.order_type_code,$$LANGUAGE_ID##,'2') order_type_short_desc,  a.ord_pract_id ord_pract_id, nvl(am_get_desc.am_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1'), am_get_desc.am_ext_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1')) ordering_pract_name, order_line_status order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,$$LANGUAGE_ID##,'2') order_status_short_desc, b.ord_cosign_reqd_yn ord_cosign_reqd_yn, b.order_line_num order_line_num,b.item_narration  item_narration,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id ,TO_CHAR(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id ,TO_CHAR(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time, OR_GET_EXISTING_ORDER_OPERN (a.ordering_facility_id,a.order_id,a.order_category,a.order_type_code,nvl(b.cont_order_ind,'DO'),order_status,b.order_catalog_code,b.order_line_num,order_line_status,end_date_time,$$ENCOUNTER_ID##,$$ATTENDING_PRACTITIONER##,'CA','', 'Y' ,'PH') display_popupmenu,a.source_type source_type,a.source_code source_code,nvl(b.cont_order_ind,'DO') cont_order_ind,a.iv_prep_yn iv_prep_yn,to_char(b.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,to_char(b.end_date_time,'dd/mm/yyyy hh24:mi') end_date_time,(SELECT 'Y'                       FROM or_order_status_code WHERE order_status_code=order_line_status AND order_status_type IN         ('55','58','60','93','80','85','90','96','99')) copy_yn,b.last_action_reason_desc last_action_reason_desc, OR_ORDER_LINE_PH_COLOR(a.ordering_facility_id,a.order_id,b.order_catalog_code,b.order_line_num) ph_colors,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id,to_char(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id,to_char(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time,b.hold_pract_id hold_pract_id, to_char(b.hold_date_time,'dd/mm/yyyy hh24:mi') hold_date_time,b.last_action_reason_desc last_action_reason_desc,to_char(b.appt_date_time,'dd/mm/yyyy hh24:mi') appt_date_time,b.appt_ref_num  appt_ref_num,b.order_catalog_nature order_catalog_nature,b.has_sec_order_yn sec_order_yn, b.pri_order_id pri_order_id,b.appt_locn  appt_locn,b.appt_resched_yn appt_resched_yn,b.appt_resched_reason appt_resched_reason,b.no_of_reschedules no_of_reschedules,b.appt_reqd_yn appt_reqd_yn,b.notify_yn notify_yn,b.last_action_type last_action_type,b.accession_num accession_num,b.catalog_synonym catalog_synonym,b.ord_consent_reqd_yn ord_consent_reqd_yn,b.order_set_id order_set_id,a.performing_facility_id performing_facility_id,b.ext_appl_accession_num ext_appl_accession_num,b.billing_package_ref billing_package_ref,TO_CHAR (a.ord_date_time, 'DD/MM/YYYY') order_date,(SELECT linked_note_accession_num FROM or_result_detail WHERE order_id = b.order_id AND line_srl_no = b.order_line_num AND rownum=1) linked_note_accession_num,ph_get_alternates(A.ORDER_ID, b.ORDER_LINE_NUM) alternates,nvl((select 'N' from or_order_pend_status_log where pend_status_ind='PC' and order_id =a.order_id ),'Y') consent_rec_yn, b.barcode_appl, 'N' bt_ack_YN FROM or_order a, or_order_line b,am_duration_type c,or_catalog_synonym_lang_vw d   WHERE  a.ordeR_id =b.ordER_id  and b.order_catalog_code=d.order_catalog_code and b.durn_type = c.durn_type(+)  and d.language_id=$$LANGUAGE_ID##  AND catalog_synonym_type=or_get_synonym_type('PH',b.order_catalog_code) and  nvl(b.cont_order_ind,'DO') in ('DO','DR','CO','CR')  and substr(a.order_id,1,2) !='CS' and patient_id = ($$PATIENT_ID##) and nvl(encounter_id,0) = NVL(($$ENCOUNTER_ID##),nvl(encounter_id,0)) AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy')  BETWEEN TO_DATE(NVL(($$TO_DATE##),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL(($$FROM_DATE##),'31/12/9999'),'dd/mm/yyyy') AND order_line_status IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN (SELECT order_status_type FROM OR_STATUS_APPLICABILITY WHERE OPER_OR_GROUP_REF = 'EXT_ALL')) AND (('EXT_FUTURE_ORD' = 'EXT_ALL' and b.future_order_yn='Y')  or 'EXT_FUTURE_ORD' !='EXT_ALL' ) AND a.order_category in (select order_category from or_order_category ic where  ic.order_category =NVL ('PH', ic.order_category)) AND b.order_type_code = nvl((''),b.order_type_code) and b.priority=nvl((''),b.priority)   AND nvl(activity_type ,'!') = nvl('',nvl(activity_type,'!'))  and b.Cancelled_by_sys_yn!='Y'  ORDER BY DECODE(('D'),'D',to_char(a.Ord_Date_time,'YYYYMMDDHH24MISS'),'O',A.order_category,'T',a.OrdeR_type_code) desc, nvl(a.order_set_id,a.order_id),a.order_id, order_line_num");//
		//dataMap.put( "NON_DRUG_ORDERS" ,"SELECT   a.order_category ,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,$$LANGUAGE_ID##,'2') order_category_short_desc,   DECODE(nvl(b.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc,  AM_GET_DESC.AM_PATIENT_CLASS(patient_class, $$LANGUAGE_ID##,'2') patient_class_short_desc,patient_class, a.order_id order_id,patient_id, encounter_id,episode_id,episode_visit_num, TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,or_get_order_catalog (a.order_id, a.order_type_code,$$LANGUAGE_ID##, '',b.order_line_num) order_detail, b.order_catalog_code , source_type,source_code,b.priority ,b.order_type_code  , OR_GET_DESC.OR_ORDER_TYPE(b.order_type_code,$$LANGUAGE_ID##,'2') order_type_short_desc,  a.ord_pract_id ord_pract_id, nvl(am_get_desc.am_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1'), am_get_desc.am_ext_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1')) ordering_pract_name, order_line_status order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,$$LANGUAGE_ID##,'2') order_status_short_desc, b.ord_cosign_reqd_yn ord_cosign_reqd_yn, b.order_line_num order_line_num,b.item_narration  item_narration,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id ,TO_CHAR(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id ,TO_CHAR(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time, OR_GET_EXISTING_ORDER_OPERN (a.ordering_facility_id,a.order_id,a.order_category,a.order_type_code,nvl(b.cont_order_ind,'DO'),order_status,b.order_catalog_code,b.order_line_num,order_line_status,end_date_time,$$ENCOUNTER_ID##,$$ATTENDING_PRACTITIONER##,'CA','', 'Y' ,'') display_popupmenu,a.source_type source_type,a.source_code source_code,nvl(b.cont_order_ind,'DO') cont_order_ind,a.iv_prep_yn iv_prep_yn,to_char(b.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,to_char(b.end_date_time,'dd/mm/yyyy hh24:mi') end_date_time,(SELECT 'Y'                       FROM or_order_status_code WHERE order_status_code=order_line_status AND order_status_type IN         ('55','58','60','93','80','85','90','96','99')) copy_yn,b.last_action_reason_desc last_action_reason_desc, OR_ORDER_LINE_PH_COLOR(a.ordering_facility_id,a.order_id,b.order_catalog_code,b.order_line_num) ph_colors,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id,to_char(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id,to_char(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time,b.hold_pract_id hold_pract_id, to_char(b.hold_date_time,'dd/mm/yyyy hh24:mi') hold_date_time,b.last_action_reason_desc last_action_reason_desc,to_char(b.appt_date_time,'dd/mm/yyyy hh24:mi') appt_date_time,b.appt_ref_num  appt_ref_num,b.order_catalog_nature order_catalog_nature,b.has_sec_order_yn sec_order_yn, b.pri_order_id pri_order_id,b.appt_locn  appt_locn,b.appt_resched_yn appt_resched_yn,b.appt_resched_reason appt_resched_reason,b.no_of_reschedules no_of_reschedules,b.appt_reqd_yn appt_reqd_yn,b.notify_yn notify_yn,b.last_action_type last_action_type,b.accession_num accession_num,b.catalog_synonym catalog_synonym,b.ord_consent_reqd_yn ord_consent_reqd_yn,b.order_set_id order_set_id,a.performing_facility_id performing_facility_id,b.ext_appl_accession_num ext_appl_accession_num,b.billing_package_ref billing_package_ref,TO_CHAR (a.ord_date_time, 'DD/MM/YYYY') order_date,(SELECT linked_note_accession_num FROM or_result_detail WHERE order_id = b.order_id AND line_srl_no = b.order_line_num AND rownum=1) linked_note_accession_num,ph_get_alternates(A.ORDER_ID, b.ORDER_LINE_NUM) alternates,nvl((select 'N' from or_order_pend_status_log where pend_status_ind='PC' and order_id =a.order_id ),'Y') consent_rec_yn, b.barcode_appl, 'N' bt_ack_YN FROM or_order a, or_order_line b,am_duration_type c,or_catalog_synonym_lang_vw d   WHERE  a.ordeR_id =b.ordER_id  and b.order_catalog_code=d.order_catalog_code and b.durn_type = c.durn_type(+)  and d.language_id=$$LANGUAGE_ID##  AND catalog_synonym_type=or_get_synonym_type('',b.order_catalog_code) and  nvl(b.cont_order_ind,'DO') in ('DO','DR','CO','CR')  and substr(a.order_id,1,2) !='CS' and patient_id = ($$PATIENT_ID##) and nvl(encounter_id,0) = NVL(($$ENCOUNTER_ID##),nvl(encounter_id,0)) AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy')  BETWEEN TO_DATE(NVL(($$TO_DATE##),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL(($$FROM_DATE##),'31/12/9999'),'dd/mm/yyyy') AND order_line_status IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN (SELECT order_status_type FROM OR_STATUS_APPLICABILITY WHERE OPER_OR_GROUP_REF = 'EXT_ALL')) AND (('EXT_FUTURE_ORD' = 'EXT_ALL' and b.future_order_yn='Y')  or 'EXT_FUTURE_ORD' !='EXT_ALL' ) AND a.order_category in (select order_category from or_order_category ic where  ic.order_category =NVL ('', ic.order_category)) AND b.order_type_code = nvl((''),b.order_type_code) and b.priority=nvl((''),b.priority)   AND nvl(activity_type ,'!') = nvl('',nvl(activity_type,'!'))  and b.Cancelled_by_sys_yn!='Y' and a.order_category not in 'PH' ORDER BY DECODE(('D'),'D',to_char(a.Ord_Date_time,'YYYYMMDDHH24MISS'),'O',A.order_category,'T',a.OrdeR_type_code) desc, nvl(a.order_set_id,a.order_id),a.order_id, order_line_num");
		  /*IN067664 starts*/
	//	  dataMap.put( "DRUG_ORDERS" ,"SELECT   a.order_category ,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,$$LANGUAGE_ID##,'2') order_category_short_desc,   DECODE(nvl(b.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc,  AM_GET_DESC.AM_PATIENT_CLASS(patient_class, $$LANGUAGE_ID##,'2') patient_class_short_desc,patient_class, a.order_id order_id,patient_id, encounter_id,episode_id,episode_visit_num, TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,or_get_order_catalog (a.order_id, a.order_type_code,$$LANGUAGE_ID##, 'PH',b.order_line_num) order_detail, b.order_catalog_code , source_type,source_code,b.priority ,b.order_type_code  , OR_GET_DESC.OR_ORDER_TYPE(b.order_type_code,$$LANGUAGE_ID##,'2') order_type_short_desc,  a.ord_pract_id ord_pract_id, nvl(am_get_desc.am_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1'), am_get_desc.am_ext_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1')) ordering_pract_name, order_line_status order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,$$LANGUAGE_ID##,'2') order_status_short_desc, b.ord_cosign_reqd_yn ord_cosign_reqd_yn, b.order_line_num order_line_num,b.item_narration  item_narration,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id ,TO_CHAR(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id ,TO_CHAR(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time, OR_GET_EXISTING_ORDER_OPERN (a.ordering_facility_id,a.order_id,a.order_category,a.order_type_code,nvl(b.cont_order_ind,'DO'),order_status,b.order_catalog_code,b.order_line_num,order_line_status,end_date_time,$$ENCOUNTER_ID##,$$ATTENDING_PRACTITIONER##,'CA','', 'Y' ,'PH') display_popupmenu,a.source_type source_type,a.source_code source_code,nvl(b.cont_order_ind,'DO') cont_order_ind,a.iv_prep_yn iv_prep_yn,to_char(b.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,to_char(b.end_date_time,'dd/mm/yyyy hh24:mi') end_date_time,(SELECT 'Y'                       FROM or_order_status_code WHERE order_status_code=order_line_status AND order_status_type IN         ('55','58','60','93','80','85','90','96','99')) copy_yn,b.last_action_reason_desc last_action_reason_desc, OR_ORDER_LINE_PH_COLOR(a.ordering_facility_id,a.order_id,b.order_catalog_code,b.order_line_num) ph_colors,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id,to_char(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id,to_char(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time,b.hold_pract_id hold_pract_id, to_char(b.hold_date_time,'dd/mm/yyyy hh24:mi') hold_date_time,b.last_action_reason_desc last_action_reason_desc,to_char(b.appt_date_time,'dd/mm/yyyy hh24:mi') appt_date_time,b.appt_ref_num  appt_ref_num,b.order_catalog_nature order_catalog_nature,b.has_sec_order_yn sec_order_yn, b.pri_order_id pri_order_id,b.appt_locn  appt_locn,b.appt_resched_yn appt_resched_yn,b.appt_resched_reason appt_resched_reason,b.no_of_reschedules no_of_reschedules,b.appt_reqd_yn appt_reqd_yn,b.notify_yn notify_yn,b.last_action_type last_action_type,b.accession_num accession_num,b.catalog_synonym catalog_synonym,b.ord_consent_reqd_yn ord_consent_reqd_yn,b.order_set_id order_set_id,a.performing_facility_id performing_facility_id,b.ext_appl_accession_num ext_appl_accession_num,b.billing_package_ref billing_package_ref,TO_CHAR (a.ord_date_time, 'DD/MM/YYYY') order_date,(SELECT linked_note_accession_num FROM or_result_detail WHERE order_id = b.order_id AND line_srl_no = b.order_line_num AND rownum=1) linked_note_accession_num,ph_get_alternates(A.ORDER_ID, b.ORDER_LINE_NUM) alternates,nvl((select 'N' from or_order_pend_status_log where pend_status_ind='PC' and order_id =a.order_id ),'Y') consent_rec_yn, b.barcode_appl, 'N' bt_ack_YN FROM or_order a, or_order_line b,am_duration_type c,or_catalog_synonym_lang_vw d   WHERE  a.ordeR_id =b.ordER_id  and b.order_catalog_code=d.order_catalog_code and b.durn_type = c.durn_type(+)  and d.language_id=$$LANGUAGE_ID## AND A.ORDER_STATUS NOT IN ('HC','CN','DC') AND catalog_synonym_type=or_get_synonym_type('PH',b.order_catalog_code) and  nvl(b.cont_order_ind,'DO') in ('DO','DR','CO','CR')  and substr(a.order_id,1,2) !='CS' and patient_id = ($$PATIENT_ID##) and nvl(encounter_id,0) = NVL(($$ENCOUNTER_ID##),nvl(encounter_id,0)) AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy')  BETWEEN TO_DATE(NVL(($$TO_DATE##),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL(($$FROM_DATE##),'31/12/9999'),'dd/mm/yyyy') AND order_line_status IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN (SELECT order_status_type FROM OR_STATUS_APPLICABILITY WHERE OPER_OR_GROUP_REF = 'EXT_ALL')) AND (('EXT_FUTURE_ORD' = 'EXT_ALL' and b.future_order_yn='Y')  or 'EXT_FUTURE_ORD' !='EXT_ALL' ) AND a.order_category in (select order_category from or_order_category ic where  ic.order_category =NVL ('PH', ic.order_category)) AND b.order_type_code = nvl((''),b.order_type_code) and b.priority=nvl((''),b.priority)   AND nvl(activity_type ,'!') = nvl('',nvl(activity_type,'!'))  and b.Cancelled_by_sys_yn!='Y'  ORDER BY DECODE(('D'),'D',to_char(a.Ord_Date_time,'YYYYMMDDHH24MISS'),'O',A.order_category,'T',a.OrdeR_type_code) desc, nvl(a.order_set_id,a.order_id),a.order_id, order_line_num");
		  dataMap.put( "DRUG_ORDERS" ,"SELECT  DECODE (NVL (b.priority, 'R'),'U', 'Urgent','S', 'Stat','R', 'Routine') priority_desc,(B.QTY_VALUE||' '||i.short_desc) DOSE,(SELECT LONG_DESC FROM OR_ORDER_CATALOG_LANG_VW WHERE ORDER_CATALOG_CODE=B.order_catalog_code AND ROWNUM=1) order_detail,g.FREQ_DESC FREQUENCY ,H.ROUTE_DESC FROM or_order a,or_order_line b,am_duration_type c,or_catalog_synonym_lang_vw d,AM_FREQUENCY_LANG_VW g,PH_ROUTE_LANG_VW h,AM_UOM_LANG_VW i WHERE a.order_id = b.order_id AND b.order_catalog_code = d.order_catalog_code and b.freq_code=g.freq_code and d.language_id=g.language_id and b.route_code=h.route_code and d.language_id=h.language_id and b.qty_unit=i.uom_code and d.language_id=i.language_id AND b.durn_type = c.durn_type(+) AND d.language_id = $$LANGUAGE_ID## AND A.ORDER_STATUS NOT IN ('HC','CN','DC') AND catalog_synonym_type=or_get_synonym_type('PH',b.order_catalog_code) and  nvl(b.cont_order_ind,'DO') in ('DO','DR','CO','CR')  and substr(a.order_id,1,2) !='CS' and patient_id = ($$PATIENT_ID##) and nvl(encounter_id,0) = NVL(($$ENCOUNTER_ID##),nvl(encounter_id,0)) AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy')  BETWEEN TO_DATE(NVL(($$TO_DATE##),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL(($$FROM_DATE##),'31/12/9999'),'dd/mm/yyyy') AND order_line_status IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN (SELECT order_status_type FROM OR_STATUS_APPLICABILITY WHERE OPER_OR_GROUP_REF = 'EXT_ALL')) AND (('EXT_FUTURE_ORD' = 'EXT_ALL' and b.future_order_yn='Y')  or 'EXT_FUTURE_ORD' !='EXT_ALL' ) AND a.order_category in (select order_category from or_order_category ic where  ic.order_category =NVL ('PH', ic.order_category)) AND b.order_type_code = nvl((''),b.order_type_code) and b.priority=nvl((''),b.priority)   AND nvl(activity_type ,'!') = nvl('',nvl(activity_type,'!'))  and b.Cancelled_by_sys_yn!='Y'  ORDER BY DECODE(('D'),'D',to_char(a.Ord_Date_time,'YYYYMMDDHH24MISS'),'O',A.order_category,'T',a.OrdeR_type_code) desc, nvl(a.order_set_id,a.order_id),a.order_id, order_line_num");  
		  /*IN067664 ends*/
		  dataMap.put( "NON_DRUG_ORDERS" ,"SELECT   a.order_category ,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,$$LANGUAGE_ID##,'2') order_category_short_desc,   DECODE(nvl(b.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc,  AM_GET_DESC.AM_PATIENT_CLASS(patient_class, $$LANGUAGE_ID##,'2') patient_class_short_desc,patient_class, a.order_id order_id,patient_id, encounter_id,episode_id,episode_visit_num, TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,or_get_order_catalog (a.order_id, a.order_type_code,$$LANGUAGE_ID##, '',b.order_line_num) order_detail, b.order_catalog_code , source_type,source_code,b.priority ,b.order_type_code  , OR_GET_DESC.OR_ORDER_TYPE(b.order_type_code,$$LANGUAGE_ID##,'2') order_type_short_desc,  a.ord_pract_id ord_pract_id, nvl(am_get_desc.am_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1'), am_get_desc.am_ext_practitioner (a.ord_pract_id,$$LANGUAGE_ID##,'1')) ordering_pract_name, order_line_status order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,$$LANGUAGE_ID##,'2') order_status_short_desc, b.ord_cosign_reqd_yn ord_cosign_reqd_yn, b.order_line_num order_line_num,b.item_narration  item_narration,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id ,TO_CHAR(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id ,TO_CHAR(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time, OR_GET_EXISTING_ORDER_OPERN (a.ordering_facility_id,a.order_id,a.order_category,a.order_type_code,nvl(b.cont_order_ind,'DO'),order_status,b.order_catalog_code,b.order_line_num,order_line_status,end_date_time,$$ENCOUNTER_ID##,$$ATTENDING_PRACTITIONER##,'CA','', 'Y' ,'') display_popupmenu,a.source_type source_type,a.source_code source_code,nvl(b.cont_order_ind,'DO') cont_order_ind,a.iv_prep_yn iv_prep_yn,to_char(b.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,to_char(b.end_date_time,'dd/mm/yyyy hh24:mi') end_date_time,(SELECT 'Y'                       FROM or_order_status_code WHERE order_status_code=order_line_status AND order_status_type IN         ('55','58','60','93','80','85','90','96','99')) copy_yn,b.last_action_reason_desc last_action_reason_desc, OR_ORDER_LINE_PH_COLOR(a.ordering_facility_id,a.order_id,b.order_catalog_code,b.order_line_num) ph_colors,b.can_line_reason can_line_reason,b.can_pract_id can_pract_id,to_char(b.can_date_time,'dd/mm/yyyy hh24:mi') can_date_time,b.disc_pract_id disc_pract_id,to_char(b.disc_date_time,'dd/mm/yyyy hh24:mi') disc_date_time,b.hold_pract_id hold_pract_id, to_char(b.hold_date_time,'dd/mm/yyyy hh24:mi') hold_date_time,b.last_action_reason_desc last_action_reason_desc,to_char(b.appt_date_time,'dd/mm/yyyy hh24:mi') appt_date_time,b.appt_ref_num  appt_ref_num,b.order_catalog_nature order_catalog_nature,b.has_sec_order_yn sec_order_yn, b.pri_order_id pri_order_id,b.appt_locn  appt_locn,b.appt_resched_yn appt_resched_yn,b.appt_resched_reason appt_resched_reason,b.no_of_reschedules no_of_reschedules,b.appt_reqd_yn appt_reqd_yn,b.notify_yn notify_yn,b.last_action_type last_action_type,b.accession_num accession_num,b.catalog_synonym catalog_synonym,b.ord_consent_reqd_yn ord_consent_reqd_yn,b.order_set_id order_set_id,a.performing_facility_id performing_facility_id,b.ext_appl_accession_num ext_appl_accession_num,b.billing_package_ref billing_package_ref,TO_CHAR (a.ord_date_time, 'DD/MM/YYYY') order_date,(SELECT linked_note_accession_num FROM or_result_detail WHERE order_id = b.order_id AND line_srl_no = b.order_line_num AND rownum=1) linked_note_accession_num,ph_get_alternates(A.ORDER_ID, b.ORDER_LINE_NUM) alternates,nvl((select 'N' from or_order_pend_status_log where pend_status_ind='PC' and order_id =a.order_id ),'Y') consent_rec_yn, b.barcode_appl, 'N' bt_ack_YN FROM or_order a, or_order_line b,am_duration_type c,or_catalog_synonym_lang_vw d   WHERE  a.ordeR_id =b.ordER_id  and b.order_catalog_code=d.order_catalog_code and b.durn_type = c.durn_type(+)  and d.language_id=$$LANGUAGE_ID## AND A.ORDER_STATUS NOT IN ('HC','CN','DC') AND catalog_synonym_type=or_get_synonym_type('',b.order_catalog_code) and  nvl(b.cont_order_ind,'DO') in ('DO','DR','CO','CR')  and substr(a.order_id,1,2) !='CS' and patient_id = ($$PATIENT_ID##) and nvl(encounter_id,0) = NVL(($$ENCOUNTER_ID##),nvl(encounter_id,0)) AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy')  BETWEEN TO_DATE(NVL(($$TO_DATE##),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL(($$FROM_DATE##),'31/12/9999'),'dd/mm/yyyy') AND order_line_status IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN (SELECT order_status_type FROM OR_STATUS_APPLICABILITY WHERE OPER_OR_GROUP_REF = 'EXT_ALL')) AND (('EXT_FUTURE_ORD' = 'EXT_ALL' and b.future_order_yn='Y')  or 'EXT_FUTURE_ORD' !='EXT_ALL' ) AND a.order_category in (select order_category from or_order_category ic where  ic.order_category =NVL ('', ic.order_category)) AND b.order_type_code = nvl((''),b.order_type_code) and b.priority=nvl((''),b.priority)   AND nvl(activity_type ,'!') = nvl('',nvl(activity_type,'!'))  and b.Cancelled_by_sys_yn!='Y' and a.order_category not in 'PH' ORDER BY DECODE(('D'),'D',to_char(a.Ord_Date_time,'YYYYMMDDHH24MISS'),'O',A.order_category,'T',a.OrdeR_type_code) desc, nvl(a.order_set_id,a.order_id),a.order_id, order_line_num");
		
		  dataMap.put( "OR_ORDERING_DOCTOR" ,"SELECT NVL(AM_GET_DESC.AM_PRACTITIONER (A.ORD_PRACT_ID, $$LANGUAGE_ID##, '1'), AM_GET_DESC.AM_EXT_PRACTITIONER (A.ORD_PRACT_ID, $$LANGUAGE_ID##, '1') ) ORDERING_PRACT_NAME FROM OR_ORDER A WHERE ORDER_ID=$$ORDER_ID##");  //68801
		  dataMap.put( "OR_SPECIMEN_NUM" ,"select ACCESSION_NUM from or_order_line where order_id=$$ORDER_ID##");  //68801 
		  dataMap.put( "OR_ORDER_CATALOG_DES" ,"select or_get_order_catalog ($$ORDER_ID##,$$ORD_TYP_CODE##,$$LANGUAGE_ID##, $$PRACTITIONER_TYPE##) order_detail from dual");  //68801

		  /*IN067582 Ends*/
		  /*IN065908 ends*/
	      /*
		//NB
		dataMap.put( "NB_GENDER", "SELECT SEX FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		//DG
		
		
		
		

		
		dataMap.put( "DG_PATIENT_RES_ADD","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PATIENT_MAIL_ADD","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PAT_HOME_CON_NO","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##" );
		dataMap.put( "DG_PAT_OFF_CON_NO","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##" );
		dataMap.put( "DG_PAT_EDU_LEVEL ","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PAT_NOK_NAME","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PAT_NOK_REL","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "DG_PAT_NOK_NAT_ID","SELECT RES_TOWN_DESC FROM MP_PATIENT WHERE PATIENT_ID=$$PATIENT_ID##");
		// Ends Function 1

		dataMap.put( "ADM_PRACTITIONER" ,"SELECT practitioner_id,practitioner_name from am_practitioner");
		dataMap.put( "NB_BCG_YN" ,"SELECT BCG_YN from MP_BIRTH_REGISTER WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_HEPB_YN" ,"SELECT HEPB_YN from MP_BIRTH_REGISTER WHERE PATIENT_ID=$$PATIENT_ID##");
		dataMap.put( "NB_VITK_YN" ,"SELECT VITAMIN_K_YN from MP_BIRTH_REGISTER WHERE PATIENT_ID=$$PATIENT_ID##");*/
	}
}
