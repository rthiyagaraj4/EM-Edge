/*******************************************************************************
 * Copyright 1999-2015, Computer Sciences Corporation. All rights reserved.
 *  
 * Warning: This computer program is protected by copyright law and international treaties.
 * Unauthorized reproduction or distribution of this program, or any portion of it, 
 * may result in severe civil and criminal penalties, and will be prosecuted to 
 * the maximum extent possible under the law.
 ******************************************************************************/
package eOH.Common ;
import java.util.* ;
 
public class OHRepositoryExt {
		//private static OrRepositoryExt instance ;
		private static int i=0;

		private static HashMap dataMap ;

		static{
			dataMap = new HashMap() ;
			load() ;
		}

		public int getSqlSize(){
			return dataMap.size();
		}

		public static String getOrKeyValue( String key ) throws Exception{
				return ( getValue( key.trim().toUpperCase()) ) ;
		}

		public static int getI(){
			return i;
		}

		private static String getValue( String key ) throws Exception{
		 String value = "" ;

			try
				{
				value = (String) dataMap.get(key) ;

				if ( value == null )
				throw new Exception( key + " : Key not found" ) ;
				}
				catch ( Exception e )
				{
				throw new Exception( key + " : Key not found" ) ;
				}

			return value ;
		}


		protected void finalize() throws Throwable{
			if ( dataMap != null )
            dataMap = null ;
			}

    private static void load(){

		//Existing Order - Copy Order transaction function -Begin - 
		dataMap.put("SQL_OR_EXISTING_ORDER_COPY_OEDER_DIAG_CODE_SPECIFIC","SELECT diag_code code,SUBSTR(diag_desc,0,30) description FROM pr_problem WHERE patient_id = ? AND PROBLEM_STATUS  != 'C'");
		//dataMap.put("SQL_OR_EXISTING_ORDER_COPY_ORDER_SEARCH_BY_LINE","SELECT a.order_category order_category, OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2') order_category_short_desc,DECODE(NVL(b.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc, AM_GET_DESC.AM_PATIENT_CLASS(patient_class, ?,'2') patient_class_short_desc,patient_class,location_type||'/'||locn_short_desc location_details,a.order_id order_id,patient_id,encounter_id,TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time ,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time ,OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,1)  order_detail,b.order_catalog_code catalog_code,b.priority priority,b.order_type_code  order_type_code, OR_GET_DESC.OR_ORDER_TYPE(a.order_type_code,?,'2') order_type_short_desc, a.ord_pract_id ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ord_pract_id,?,'1') ordering_pract_name,order_line_status   order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,?,'2') order_status_short_desc,b.order_line_num order_line_num,b.item_narration  item_narration,a.source_type source_type,a.source_code source_code,NVL(b.cont_order_ind,'DO') cont_order_ind,a.sex sex,a.date_of_birth dob,a.ordering_facility_id ordering_facility_id, SM_GET_DESC.SM_FACILITY_PARAM(a.ordering_facility_id,?,'1') ordering_facility_name,a.iv_prep_yn iv_prep_yn,GET_AGE(a.date_of_birth) age,b.catalog_synonym_dc catalog_desc FROM or_order a, or_ordeR_line b,or_ordeR_status_code c  WHERE  a.ordeR_id =b.ordER_id AND NVL(b.cont_order_ind,'DO') IN ('DO','DR','CO','CR') AND patient_id = ? AND b.order_line_status = c.ordeR_status_code AND encounter_id = NVL((?),encounter_id) AND a.patient_class = NVL(?,a.patient_class) AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy') BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy') AND  a.order_category = NVL((?),a.order_Category) AND a.order_type_code = NVL((?),a.order_type_code)  AND a.ord_pract_id = NVL((?),a.ord_pract_id)  AND upper(b.catalog_synonym_dc) LIKE DECODE ((?),'S',upper(?)||'%','C','%' ||upper(?)||'%','E','%'||upper(?)) AND b.ORDER_LINE_STATUS IN (SELECT ORDER_STATUS_code FROM or_ORDER_STATUS_code WHERE ORDER_STATUS_type IN ('55','60','93','80','85','90','91','92')) AND exists (select 'X' from or_order_line where order_id = a.order_id and nvl(activity_type ,'!') = nvl(?,nvl(activity_type ,'!'))) ORDER BY TO_CHAR(a.Ord_Date_time,'YYYYMMDDHH24MI') DESC");
		dataMap.put("SQL_OR_EXISTING_ORDER_COPY_ORDER_SEARCH_BY_LINE","SELECT a.order_category order_category, OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2') order_category_short_desc,DECODE(NVL(b.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc, AM_GET_DESC.AM_PATIENT_CLASS(patient_class, ?,'2') patient_class_short_desc,patient_class,a.order_id order_id,a.patient_id,encounter_id,TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time ,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time ,OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,1)  order_detail,b.order_catalog_code catalog_code,b.priority priority,b.order_type_code  order_type_code, OR_GET_DESC.OR_ORDER_TYPE(a.order_type_code,?,'2') order_type_short_desc, a.ord_pract_id ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ord_pract_id,?,'1') ordering_pract_name,order_line_status   order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,?,'2') order_status_short_desc,b.order_line_num order_line_num,b.item_narration  item_narration,a.source_type source_type,a.source_code source_code,NVL(b.cont_order_ind,'DO') cont_order_ind,a.ordering_facility_id ordering_facility_id, SM_GET_DESC.SM_FACILITY_PARAM(a.ordering_facility_id,?,'1') ordering_facility_name,a.iv_prep_yn iv_prep_yn,b.catalog_synonym_dc catalog_desc,d.sex sex,d.date_of_birth dob, GET_AGE(d.date_of_birth) age FROM or_order a, or_ordeR_line b,or_ordeR_status_code c,mp_patient d  WHERE  a.ordeR_id =b.ordER_id and a.patient_id=d.patient_id AND NVL(b.cont_order_ind,'DO') IN ('DO','DR','CO','CR') AND a.patient_id = ? AND b.order_line_status = c.ordeR_status_code AND encounter_id = NVL((?),encounter_id) AND a.patient_class = NVL(?,a.patient_class) AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy') BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy') AND  a.order_category = NVL((?),a.order_Category) AND a.order_type_code = NVL((?),a.order_type_code)  and a.order_type_code not in ('TDM','PDC') AND a.ord_pract_id = NVL((?),a.ord_pract_id)  AND upper(b.catalog_synonym_dc) LIKE DECODE ((?),'S',upper(?)||'%','C','%' ||upper(?)||'%','E','%'||upper(?)) AND b.ORDER_LINE_STATUS IN (SELECT ORDER_STATUS_code FROM or_ORDER_STATUS_code WHERE ORDER_STATUS_type IN ('55','60','93','80','85','90','91','92')) AND exists (select 'X' from or_order_line where order_id = a.order_id and nvl(activity_type ,'!') = nvl(?,nvl(activity_type ,'!'))) and nvl(SOURCE_TYPE,'X')=NVL((?),nvl(source_TYPE,'X')) and nvl(SOURCE_code,'X') =NVL((?),nvl(source_CODE,'X')) ORDER BY TO_CHAR(a.Ord_Date_time,'YYYYMMDDHH24MI') DESC");
		//dataMap.put("SQL_OR_EXISTING_ORDER_COPY_ORDER_SEARCH_BY_HEADER", "SELECT  a.order_category order_category, OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc,   DECODE(NVL(a.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc,  AM_GET_DESC.AM_PATIENT_CLASS(a.patient_class, ?,'2') patient_class_short_desc,a.patient_class patient_class, a.location_type||'/'||a.locn_short_desc location_details ,a.order_id order_id,a.patient_id patient_id, a.encounter_id encounter_id, TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time ,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time , or_get_order_catalog(a.order_id,a.order_type_code,?)  order_detail, a.source_type source_type,a.source_code source_code,a.priority priority,a.order_type_code  order_type_code, OR_GET_DESC.OR_ORDER_TYPE(a.order_type_code,?,'2') order_type_short_desc,  a.ord_pract_id ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ord_pract_id,?,'1')  ordering_pract_name,  a.order_status order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(a.order_status,?,'2') order_status_short_desc, a.ord_cosign_reqd_yn ord_cosign_reqd_yn, a.source_type source_type,a.source_code source_code,NVL(a.cont_order_ind,'DO') cont_order_ind,a.iv_prep_yn iv_prep_yn,a.sex sex,a.date_of_birth dob,a.ordering_facility_id ordering_facility_id, SM_GET_DESC.SM_FACILITY_PARAM(a.ordering_facility_id,?,'1') ordering_facility_name,GET_AGE(a.date_of_birth) age FROM or_order a,or_order_line b WHERE a.order_id = b.order_id and a.patient_id = ? AND a.encounter_id = NVL((?),a.encounter_id) AND a.patient_class = NVL((?),a.patient_class) AND NVL(a.cont_order_ind,'DO') IN ('DO','DR','CO','CR') AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy') BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy') AND a.order_category = NVL((?),a.order_Category) AND a.order_type_code = NVL((?),a.order_type_code)  AND a.ord_pract_id = NVL((?),a.ord_pract_id)  AND upper(b.catalog_synonym_dc) LIKE DECODE ((?),'S',upper(?)||'%','C','%' ||upper(?)||'%','E','%'||upper(?)) AND a.order_status IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('55','60','93','80','85','90','91','92')) AND exists (select 'X' from or_order_line where order_id = a.order_id and nvl(activity_type ,'!') = nvl(?,nvl(activity_type,'!'))) ORDER BY TO_CHAR(a.Ord_Date_time,'YYYYMMDDHH24MI') DESC");
		dataMap.put("SQL_OR_EXISTING_ORDER_COPY_ORDER_SEARCH_BY_HEADER", "SELECT  a.order_category order_category, OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc,   DECODE(NVL(a.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc,  AM_GET_DESC.AM_PATIENT_CLASS(a.patient_class, ?,'2') patient_class_short_desc,a.patient_class patient_class,a.order_id order_id,a.patient_id patient_id, a.encounter_id encounter_id, TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time ,TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time ,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time , or_get_order_catalog(a.order_id,a.order_type_code,?)  order_detail, a.source_type source_type,a.source_code source_code,a.priority priority,a.order_type_code  order_type_code, OR_GET_DESC.OR_ORDER_TYPE(a.order_type_code,?,'2') order_type_short_desc,  a.ord_pract_id ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ord_pract_id,?,'1')  ordering_pract_name,  a.order_status order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(a.order_status,?,'2') order_status_short_desc, a.ord_cosign_reqd_yn ord_cosign_reqd_yn, a.source_type source_type,a.source_code source_code,NVL(a.cont_order_ind,'DO') cont_order_ind,a.iv_prep_yn iv_prep_yn,a.ordering_facility_id ordering_facility_id, SM_GET_DESC.SM_FACILITY_PARAM(a.ordering_facility_id,?,'1') ordering_facility_name,c.sex sex,c.date_of_birth dob, GET_AGE(c.date_of_birth) age FROM or_order a,or_order_line b,mp_patient c WHERE a.order_id = b.order_id and a.patient_id=c.patient_id and a.patient_id = ? AND a.encounter_id = NVL((?),a.encounter_id) AND a.patient_class = NVL((?),a.patient_class) AND NVL(a.cont_order_ind,'DO') IN ('DO','DR','CO','CR') AND TO_DATE(TO_CHAR(a.ord_date_time,'dd/mm/yyyy'),'dd/mm/yyyy') BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy') AND a.order_category = NVL((?),a.order_Category) AND a.order_type_code = NVL((?),a.order_type_code) and a.order_type_code not in ('TDM','PDC') AND a.ord_pract_id = NVL((?),a.ord_pract_id)  AND upper(b.catalog_synonym_dc) LIKE DECODE ((?),'S',upper(?)||'%','C','%' ||upper(?)||'%','E','%'||upper(?)) AND a.order_status IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('55','60','93','80','85','90','91','92')) AND exists (select 'X' from or_order_line where order_id = a.order_id and nvl(activity_type ,'!') = nvl(?,nvl(activity_type,'!'))) and nvl(SOURCE_TYPE,'X')=NVL((?),nvl(source_TYPE,'X')) and nvl(SOURCE_code,'X') =NVL((?),nvl(source_CODE,'X')) ORDER BY TO_CHAR(a.Ord_Date_time,'YYYYMMDDHH24MI') DESC");
		dataMap.put("SQL_OR_EXISTING_ORDER_COPY_ORDER_ORDER_LINE_SELECT","select order_line_num,order_catalog_code from or_order_line where order_id = ?");
		//dataMap.put("SQL_OR_EXISTING_ORDER_CATALOG_NATURE","select order_catalog_nature from or_order_line where order_id = ? and rownum <= 1");
		
		// Patient Orders -- Location   & External Orders
		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_NURSING" ,"SELECT a.short_desc short_desc,b.nursing_unit_code nursing_unit_code ,COUNT(occupying_patient_id) count FROM ip_nursing_unit a, ip_nursing_unit_bed b WHERE a.facility_id = b.facility_id AND a.nursing_unit_code = b.nursing_unit_code AND a.facility_id = ? AND b.nursing_unit_code IN (SELECT locn_code FROM ca_pract_by_locn_view WHERE practitioner_id= ? and facility_id = ?) AND occupying_patient_id IS NOT NULL group by a.short_Desc,b.nursing_unit_code ORDER BY 1 ");

		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_CLINIC" ,"SELECT a.short_desc short_desc, b.assign_care_locn_code assign_care_locn_code, count(patient_id) count FROM op_clinic a,pr_encounter b WHERE a.facility_id = b.facility_id  AND a.clinic_code = b.assign_care_locn_code AND b.assign_care_locn_type ='C' AND trunc(visit_adm_date_time) = trunc(sysdate)  AND a.facility_id = ? AND b.ASSIGN_CARE_LOCN_CODE IN (SELECT locn_code FROM ca_pract_by_locn_view  WHERE practitioner_id= ? and facility_id = ?) GROUP BY a.short_desc , b.assign_care_locn_code order by 1  ");
		
		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_CLINIC_MULTI_PATIENT","SELECT   locn_code code, DECODE (?,'en', locn_short_desc,(case patient_class when 'IP' then ip_get_desc.ip_nursing_unit(facility_id,locn_code,?,'2') when 'DC' then ip_get_desc.ip_nursing_unit(facility_id,locn_code,?,'2') else op_get_desc.op_clinic (facility_id, locn_code, ?, '2') end )) short_desc,1 COUNT     FROM ca_pract_by_locn_view    WHERE practitioner_id = ?     AND patient_class =NVL (DECODE (?,'C', 'OP','D', 'DC','E', 'EM','N', 'IP',?), patient_class)    AND facility_id = ? ORDER BY locn_short_desc");

		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_CLINIC_MULTI_PATIENT_PROCEDURE","SELECT CLINIC_CODE CODE, OP_GET_DESC.OP_CLINIC(FACILITY_ID,CLINIC_CODE,?,'2') SHORT_DESC FROM OP_CLINIC WHERE EFF_STATUS = 'E' AND CLINIC_TYPE = 'E'  ORDER BY  SHORT_DESC");

		/*dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_CLINIC_PAT_DETAILS","SELECT decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name))||'  (Sex / Age) '||sex||'/'|| get_age(b.date_of_birth) patient_details,  b.patient_id patient_id,  decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name)) patient_name, sex,  get_age(b.date_of_birth) age ,  to_char(a.visit_adm_date_time,'dd/mm/yyyy hh24:mi') visit_adm_date_time , AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1') practitioner_name,a.encounter_id encounter_id,a.patient_class patient_class,sex sex_details,to_char(b.date_of_birth,'dd/mm/yyyy') date_of_birth,a.episode_id  episode_id,a.op_episode_visit_num op_episode_visit_num from mp_patient b,pr_encounter a , am_practitioner c  WHERE a.PATIENT_ID = b.patient_id   AND a.attend_practitioner_id = c.practitioner_id  AND facility_id = ? AND  visit_adm_date_time between trunc(sysdate) and sysdate AND a.patient_class = ? AND a.assign_care_locn_code   =	? AND b.patient_id=NVL(?,b.patient_id) and nvl(a.SPECIALTY_CODE,'XXXX') =nvl(?,nvl(a.SPECIALTY_CODE,'XXXX')) ");
          
		dataMap.put("	","SELECT decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name))||'  (Sex / Age) '||sex||'/'|| get_age(b.date_of_birth) patient_details, b.patient_id patient_id,decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name)) patient_name, sex, get_age(b.date_of_birth) age , to_char(c.visit_adm_date_time,'dd/mm/yyyy hh24:mi') visit_adm_date_time, d.practitioner_name practitioner_name,c.encounter_id encounter_id,c.patient_class patient_class,sex sex_details,to_char(b.date_of_birth,'dd/mm/yyyy') date_of_birth,c.episode_id  episode_id,c.op_episode_visit_num op_episode_visit_num  FROM mp_patient b,ip_nursing_unit_bed a, pr_encounter c, am_practitioner d  WHERE a.OCCUPYING_PATIENT_ID = b.patient_id AND b.patient_id = c.patient_id AND c.attend_practitioner_id = d.practitioner_id AND a.facility_id = ? AND c.assign_care_locn_type = 'N' AND a.nursing_unit_code  = ? AND b.patient_id = NVL(?,b.patient_id) AND adt_status = '01' AND nvl(C.SPECIALTY_CODE,'XXXX') =nvl(?,nvl(C.SPECIALTY_CODE,'XXXX'))");*/
		dataMap.put("SQL_OR_MULTI_PAT_ORDER_PAT_LIST","SELECT decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name))||'  (Sex / Age) '||sex||'/'|| get_age(b.date_of_birth) patient_details, b.patient_id patient_id,decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name)) patient_name, sex, get_age(b.date_of_birth) age , to_char(c.QUEUE_DATE,'dd/mm/yyyy hh24:mi') visit_adm_date_time, d.practitioner_name practitioner_name,c.encounter_id encounter_id,'OP' patient_class,sex sex_details,to_char(b.date_of_birth,'dd/mm/yyyy') date_of_birth,c.episode_id  episode_id,c.op_episode_visit_num op_episode_visit_num  FROM mp_patient b, OP_CURRENT_PATIENT c, am_practitioner d  WHERE  b.patient_id = c.patient_id AND c.PRACTITIONER_ID = d.practitioner_id AND C.facility_id = ? AND c.LOCN_CODE  = NVL(?,c.LOCN_CODE)  AND b.patient_id = NVL(?,b.patient_id) AND nvl(C.SPECIALITY_CODE,'XXXX') =nvl(?,nvl(C.SPECIALITY_CODE,'XXXX'))  UNION ALL 	SELECT decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name))||'  (Sex / Age) '||sex||'/'|| get_age(b.date_of_birth) patient_details, b.patient_id patient_id,decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name)) patient_name, sex, get_age(b.date_of_birth) age , to_char(c.ADMISSION_DATE_TIME,'dd/mm/yyyy hh24:mi') visit_adm_date_time, d.practitioner_name practitioner_name,c.encounter_id encounter_id,C.PATIENT_CLASS patient_class,sex sex_details,to_char(b.date_of_birth,'dd/mm/yyyy') date_of_birth,to_number(null) episode_id ,to_number(null) op_episode_visit_num  FROM mp_patient b, IP_OPEN_ENCOUNTER c, am_practitioner d  WHERE  b.patient_id = c.patient_id AND c.ATTEND_PRACTITIONER_ID = d.practitioner_id AND C.facility_id = ? AND  c.NURSING_UNIT_CODE  = NVL(?,c.NURSING_UNIT_CODE)  AND b.patient_id = NVL(?,b.patient_id) AND nvl(C.SPECIALTY_CODE,'XXXX') =nvl(?,nvl(C.SPECIALTY_CODE,'XXXX'))");
		dataMap.put("SQL_OR_MULTI_PAT_ORDER_OP_PAT_LIST","SELECT decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name))||'  (Sex / Age) '||sex||'/'|| get_age(b.date_of_birth) patient_details, b.patient_id patient_id,decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name)) patient_name, sex, get_age(b.date_of_birth) age , to_char(c.QUEUE_DATE,'dd/mm/yyyy hh24:mi') visit_adm_date_time, d.practitioner_name practitioner_name,c.encounter_id encounter_id,'OP' patient_class,sex sex_details,to_char(b.date_of_birth,'dd/mm/yyyy') date_of_birth,c.episode_id  episode_id,c.op_episode_visit_num op_episode_visit_num  FROM mp_patient b, OP_CURRENT_PATIENT c, am_practitioner d  WHERE  b.patient_id = c.patient_id AND c.PRACTITIONER_ID = d.practitioner_id AND C.facility_id = ? AND c.LOCN_CODE  = ?  AND b.patient_id = NVL(?,b.patient_id) AND nvl(C.SPECIALITY_CODE,'XXXX') =nvl(?,nvl(C.SPECIALITY_CODE,'XXXX'))");
		
		dataMap.put("SQL_OR_MULTI_PAT_ORDER_IP_PAT_LIST","SELECT decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name))||'  (Sex / Age) '||sex||'/'|| get_age(b.date_of_birth) patient_details, b.patient_id patient_id,decode(?,'en',b.patient_name,nvl(b.patient_name_loc_lang,b.patient_name)) patient_name, sex, get_age(b.date_of_birth) age , to_char(c.ADMISSION_DATE_TIME,'dd/mm/yyyy hh24:mi') visit_adm_date_time, d.practitioner_name practitioner_name,c.encounter_id encounter_id,C.PATIENT_CLASS patient_class,sex sex_details,to_char(b.date_of_birth,'dd/mm/yyyy') date_of_birth,to_number(null) episode_id,to_number(null) op_episode_visit_num  FROM mp_patient b, IP_OPEN_ENCOUNTER c, am_practitioner d  WHERE  b.patient_id = c.patient_id  AND  c.ATTEND_PRACTITIONER_ID = d.practitioner_id  AND C.facility_id = ? AND  c.NURSING_UNIT_CODE  = ?  AND b.patient_id = NVL(?,b.patient_id) AND nvl(C.SPECIALTY_CODE,'XXXX') =nvl(?,nvl(C.SPECIALTY_CODE,'XXXX')) ");
		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_CAT_DTLS","SELECT c.short_desc short_desc, b.patient_id  patient_id, a.order_category order_category, count(patient_id) count FROM or_order_line a, or_order b,or_order_category c WHERE a.order_id = b.order_id AND a.order_category = c.order_category  AND b.patient_id  = ? GROUP BY b.patient_id,c.short_desc,a.order_category  ORDER BY 1 ");

		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_ORDER_TYPE_DTLS","SELECT a.order_type_code order_type_code, b.short_desc short_desc FROM or_order_line a,or_order_type b,or_order c WHERE a.order_id = c.order_id AND a.order_type_code = b.order_type_code AND a.order_category = ?  AND c.patient_id = ? GROUP BY b.short_desc,a.order_type_code  ORDER BY 1 ");

		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_ORDER_DTLS","SELECT a.catalog_synonym_dc  catalog_synonym_dc,count(a.catalog_synonym_dc ) count FROM or_order_line a,or_order b  WHERE a.order_id = b.order_id AND patient_id = ? and a.order_category = ? and a.order_type_code = ? GROUP BY a.catalog_synonym_dc ORDER BY 1 ");

		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_ORDER_VIEW_DTLS","SELECT distinct catalog_synonym_dc,order_catalog_code ,patient_id FROM or_order_line a,or_order b WHERE a.order_id = b.order_id AND b.patient_id in (?) ORDER BY patient_id ,catalog_synonym_dc ");

		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_ORDER_RESULT_DTLS","SELECT to_char(a.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time, a.order_id order_id,a.order_line_num order_line_num,a.order_line_status order_line_status,trunc(nvl(end_date_time,sysdate) - sysdate ) time, a.order_category order_category,c.short_desc short_desc FROM or_order_line a, or_order b ,or_order_status_code c WHERE a.order_id = b.order_id  AND a.order_line_status = c.order_status_code AND a.order_catalog_code = ? AND b.patient_id = ? AND a.cont_order_ind NOT IN ('DR','CR') ");

		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_RESULT_DTLS","SELECT b.accession_num accession_num,b.hist_rec_type hist_rec_type, b.contr_sys_event_code  contr_sys_event_code,b.contr_sys_id contr_sys_id,b.patient_id patient_id,b.facility_id facility_id,b.encounter_id encounter_id,b.visit_id visit_id,event_class ,b.event_code event_code ,event_group ,event_date ,event_end_date,hist_data_type,num_data_yn,to_char(result_num,decode(result_num_dec,1,'999999999.0',2,'999999999.90',3,'999999999.900',4,'999999999.9000',5,'999999999.90000',6,'999999999.900000',7,'999999999.9000000',8,'999999999.90000000',9,'999999999.90000000',0,'999999999','999999999')) result_num,result_num_uom,result_str,normalcy_ind,to_char(normal_low,decode(result_num_dec,1,'999999999.0',2,'999999999.90',3,'999999999.900' ,4,'999999999.9000',5,'999999999.90000',6,'999999999.900000',7,'999999999.9000000' ,8,'999999999.90000000',9,'999999999.90000000',0,'999999999','999999999')) normal_low ,TO_CHAR(NORMAL_HIGH,DECODE(RESULT_NUM_DEC,1,'999999999.0',2,'999999999.90',3,'999999999.900' ,4,'999999999.9000',5,'999999999.90000',6,'999999999.900000',7,'999999999.9000000' ,8,'999999999.90000000',9,'999999999.90000000',0,'999999999','999999999')) normal_high ,critical_low,critical_high,hist_storage_ind,hist_data_file,application_id,ext_image_obj_id ,ext_image_appl_id,b.practitioner_id practitioner_id,b.performed_by_id performed_by_id,b.event_auth_date_time event_auth_date_time,b.authorized_by_id authorized_by_id,b.security_level security_level,b.protection_ind protection_ind,e.long_desc event_short_desc,h.practitioner_name practitioner_name,b.result_num_prefix result_num_prefix ,b.status status,request_num,request_num_seq,e.long_desc long_desc FROM cr_encounter_detail b,cr_clin_event_mast e, am_practitioner h WHERE b.patient_id = ? AND b.hist_rec_type = e.hist_rec_type AND b.event_code = e.event_code AND h.practitioner_id(+) = b.performed_by_id AND SUBSTR(accession_num,INSTR(accession_num,'!')+1,15) = ? AND SUBSTR(accession_num,INSTR(accession_num,'!',1,4)+1) = ?");

		// Orders Tab -- Start
		dataMap.put("SQL_OR_USER_FOR_REVIEW_PRACTITIONER_LOOKUP","select practitioner_id code,practitioner_name description from am_practitioner where eff_status = 'E' and upper(practitioner_id) like upper(?) and upper(practitioner_name) like upper(?)");
 		dataMap.put("SQL_OR_PATIENT_CLASS_SELECT","select short_desc,patient_class from am_patient_class order by short_desc");
		dataMap.put("SQL_OR_INDEX_ORDERTAB_INSERT","insert into OR_USERS_TAB(practitioner_id,SYS_TAB_NAME,USER_TAB_NAME,SEQ_NO,patient_class,applicable_yn,Added_By_ID,Added_Date,Added_At_Ws_No,Added_Facility_ID,Modified_By_ID,Modified_Date,Modified_At_Ws_No,Modified_Facility_ID,function_id) values(?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?)");
		dataMap.put("SQL_OR_INDEX_ORDERTAB_DELETE","delete from or_users_tab where practitioner_id = ? and patient_class=? and nvl(function_id,'*A') = nvl(?,'*A')");
		 
		dataMap.put("SQL_OR_INDEX_ORDERTAB_DUPLICATE_CHECK","select practitioner_id,sys_tab_name,user_tab_name,seq_no,applicable_yn,patient_class,function_id from OR_USERS_TAB where practitioner_id = ? and patient_class = ? and nvl(function_id,'*A') = nvl(?,'*A') order by seq_no");
		dataMap.put("SQL_OR_INDEX_ORDERTAB_UPDATE","update or_users_tab set sys_tab_name=?,user_tab_name=?,seq_no=?,applicable_yn=?,modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=? where patient_class=? and practitioner_id =? and nvl(function_id,'*A') = nvl(?,'*A')");
		dataMap.put("SQL_OR_ORDERS_TAB_PRACTITIONER_SELECT","select practitioner_id code,practitioner_name description from am_practitioner where eff_status = 'E' and upper(practitioner_id) like upper(?) and upper(practitioner_name) like upper(?) union  select '*A' code ,'All' practitioner_name from dual order by 1 "); 
		dataMap.put("SQL_OR_VALID_PRACTITIONER","select practitioner_name from am_practitioner where practitioner_id= ? ");
		dataMap.put("SQL_OR_ORDERS_TAB_RESULT","select distinct nvl(c.long_desc,'All') patient_class_desc, a.patient_class patient_class,  a.practitioner_id practitioner_id,  nvl(b.PRACTITIONER_NAME,'All') PRACTITIONER_NAME,nvl(a.function_id,'*A')  function_id ,decode(nvl(a.function_id,'*A'),'ORDERS','Orders','EXTERNAL_ORDERS','External Orders','MEDICATION_ADMIN','Medication Administration','All') function_name from or_users_tab a, am_practitioner b , am_patient_class c where a.practitioner_id = b.practitioner_id(+) and a.patient_class = c.patient_class(+) and upper(a.patient_class ) like upper(?) and upper(a.practitioner_id) like upper(?)  and nvl(upper(c.long_desc),'All') like upper(?) and nvl(upper(b.practitioner_name),'All') like upper(?) ");

		// Orders Tab SQL----End

		//Refusal Orders
		dataMap.put("SQL_OR_REFUSAL_ORDER_RES","SELECT order_catalog_code,long_desc FROM or_order_catalog WHERE order_category not in( 'PH' ,'CS') and order_category=NVL(?,order_category) AND order_type_code=NVL(?,order_type_code) AND ((upper(long_desc) LIKE DECODE(?,'C',UPPER('%'|| ? ||'%'),'S',UPPER(?||'%'),'E',UPPER('%'||?)) AND 'D' = ?) OR (upper(order_catalog_code) LIKE DECODE(?,'C',UPPER('%'|| ? ||'%'),'S',UPPER(?||'%'),'E',UPPER('%'||?)) AND 'C' = ?))  AND eff_status='E' AND NVL(activity_type,'!') = NVL(?,NVL(activity_type,'!')) ORDER BY long_desc");
		dataMap.put("SQL_OR_REFUSAL_ORDER_RES_WITHOUT_PH","SELECT order_catalog_code,long_desc FROM or_order_catalog WHERE order_category not in( 'PH' ,'CS') and order_category=NVL(?,order_category) AND order_type_code=NVL(?,order_type_code) AND ((upper(long_desc) LIKE DECODE(?,'C',UPPER('%'|| ? ||'%'),'S',UPPER(?||'%'),'E',UPPER('%'||?)) AND 'D' = ? )  OR (upper(order_catalog_code) LIKE DECODE(?,'C',UPPER('%'|| ? ||'%'),'S',UPPER(?||'%'),'E',UPPER('%'||?)) AND 'C' = ?) ) AND eff_status='E'  AND NVL(activity_type,'!') = NVL(?,NVL(activity_type,'!'))   ORDER BY long_desc");

		dataMap.put("SQL_OR_REFUSAL_ORDER_RES_2","SELECT order_catalog_code,long_desc FROM or_order_catalog WHERE order_category=NVL(?,order_category) AND order_type_code=NVL(?,order_type_code)  AND UPPER(order_catalog_code)  LIKE DECODE(?,'S',UPPER(?||'%'),'C',upper('%'||?||'%'),'E',upper('%'||?)) AND eff_status='E' ORDER BY long_desc");
		dataMap.put("SQL_OR_REFUSAL_ORDER_AM","SELECT order_catalog_code,order_catalog_desc long_desc FROM am_catalog_for_speciality_vw  WHERE order_category=NVL(?,order_category) AND order_type_code=NVL(?,order_type_code)  AND ((UPPER(order_catalog_desc)  LIKE DECODE(?,'S',UPPER(?||'%'),'C',upper('%'||?||'%'),'E',upper('%'||?)) AND 'D' = ?) OR (upper(order_catalog_code) LIKE DECODE(?,'C',UPPER('%'|| ? ||'%'),'S',UPPER(?||'%'),'E',UPPER('%'||?)) AND 'C' = ?))   AND eff_status='E'  AND NVL(activity_type,'!') = NVL(?,NVL(activity_type,'!')) and speciality_code = ? ORDER BY order_catalog_desc");

		dataMap.put("SQL_OR_REFUSAL_ORDER_OP","SELECT order_catalog_code,order_catalog_desc long_desc FROM op_catalog_for_clinic_vw  WHERE order_category=NVL(?,order_category) AND order_type_code=NVL(?,order_type_code)  AND ((UPPER(order_catalog_desc)  LIKE DECODE(?,'S',UPPER(?||'%'),'C',upper('%'||?||'%'),'E',upper('%'||?)) AND 'D' = ?) OR (upper(order_catalog_code) LIKE DECODE(?,'C',UPPER('%'|| ? ||'%'),'S',UPPER(?||'%'),'E',UPPER('%'||?)) AND 'C' = ?))  AND NVL(activity_type,'!') = NVL(?,NVL(activity_type,'!')) and clinic_code = ? and facility_id =? ORDER BY order_catalog_desc");
		dataMap.put("SQL_OR_REFUSAL_ORDER_WING","SELECT DISTINCT d.order_catalog_code order_catalog_code ,short_desc long_desc FROM or_order_catalog d,(SELECT DISTINCT order_catalog_code FROM rd_exams_for_wing a,rd_exams b,rd_wings c WHERE a.exam_code = b.exam_code AND a.wing_code = c.wing_code AND a.operating_facility_id = ? AND        a.wing_code= NVL(?, a.wing_code) AND c.int_or_ext = 'I' AND b.section_code IN(SELECT X.SECTION_CODE FROM rd_exams x, rd_section y WHERE x.section_code = y.section_code AND y.service_code = NVL(?, service_code))) e WHERE d.order_catalog_code = e.order_catalog_code AND d.order_category = NVL(?,order_category) AND order_type_code=NVL(?,order_type_code) AND  ((UPPER(short_desc) LIKE DECODE(?,'S',UPPER(?||'%'),'C',upper('%'||?||'%'),'E',upper('%'||?)) AND 'D' = ?)  OR (upper(d.order_catalog_code) LIKE DECODE(?,'C',UPPER('%'|| ? ||'%'),'S',UPPER(?||'%'),'E',UPPER('%'||?)) AND 'C' = ?)) AND NVL(activity_type,'!') = NVL(?,NVL(activity_type,'!')) ORDER BY 2 ");

 		dataMap.put("SQL_OR_REFUSAL_ORDER1","select '<b>' ||  decode(?,'en',PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,PATIENT_NAME)) || '</b>                             Sex/Age :  <b>'  || sex || '/' || get_age(date_of_birth) || '<b>'  patient_name ,sex, get_age(date_of_birth) age,to_char(regn_date,'dd/mm/yyyy hh24:mi') regn_date,to_char(date_of_birth,'dd/mm/yyyy') date_of_birth,sex sex_default FROM mp_patient  WHERE patient_id = ?");
		dataMap.put("SQL_OR_REFUSAL_ORDER_VISIT_TIME","select a.encounter_id encounter_id,a.facility_id facility_id,decode(a.ASSIGN_CARE_LOCN_TYPE,'C','Clinic','N','Nursing Unit') ASSIGN_CARE_LOCN_TYPE,decode(a.ASSIGN_CARE_LOCN_TYPE,'C',(select OP_GET_DESC.OP_CLINIC(facility_id,clinic_code,?,'2') short_desc from op_clinic where facility_id = a.facility_id and clinic_code = a.ASSIGN_CARE_LOCN_CODE) ,'N', (select IP_GET_DESC.IP_NURSING_UNIT(facility_id,nursing_unit_code,?,'2') short_desc from ip_nursing_unit where facility_id = a.facility_id and nursing_unit_code = a.assign_care_locn_code)) ASSIGN_CARE_LOCN_CODE, to_char(a.VISIT_ADM_DATE_TIME,'dd/mm/yyyy hh24:mi') visit_adm_date_time, SM_GET_DESC.SM_FACILITY_PARAM(b.facility_id,?,'1') facility_name from pr_encounter a, sm_facility_param b where  a.facility_id= b.facility_id and a.patient_id=? order by a.visit_adm_date_time desc");
		dataMap.put("SQL_OR_REFUSAL_ORDER_VISIT_ADM_DATE_TIME","select VISIT_ADM_DATE_TIME from pr_encounter where patient_id = ? and encounter_id = ? ");
		dataMap.put("SQL_OR_REFUSAL_ORDER_INSERT","INSERT INTO OR_REFUSAL_ORDERABLE(PATIENT_ID, SRL_NO, FACILITY_ID, ENCOUNTER_ID, PATIENT_CLASS,REFUSAL_TYPE, ORDER_ID, ORDER_LINE_NUM, ORDER_CATALOG_CODE, ORDER_CATALOG_DESC,  REFUSED_REASON, REFUSED_DATE_TIME, REFUSED_PRACT_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO,ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, REFUSAL_FORM_ID, REFUSAL_FORM_CONTENT) VALUES(?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,empty_clob())");
		dataMap.put("SQL_OR_REFUSAL_ORDER_SRL_NO","SELECT nvl(MAX(SRL_NO),0) + 1  SRL_NO FROM OR_REFUSAL_ORDERABLE WHERE PATIENT_ID=?");
		//dataMap.put("SQL_OR_REFUSAL_ORDER_ID","select b.order_id order_id,b.order_line_num order_line_num, b.ORD_CONSENT_REQD_YN ord_consent_reqd_yn,b.catalog_synonym_dc catalog_desc,b.ORD_PRACT_ID ord_pract_id,c.practitioner_name practitioner_name,a.encounter_id encounter_id, b.order_type_code order_type_code, a.patient_class patient_class,a.source_type  location_type,a.source_code location_code,b.priority priority from or_order a, or_order_line b, am_Practitioner c  where a.order_id = b.order_id and a.order_type_code = b.order_type_code and a.order_category = b.order_category and a.ord_pract_id = c.practitioner_id and a.patient_id=? and upper(b.order_id) LIKE upper(?||'%') and a.order_category not in ('PH') and b.order_line_status not in ( select order_status_code from or_order_status_code where order_status_type in (60,70,75,85,90,93,96,97,99))   order by b.order_id desc,b.order_line_num");
		dataMap.put("SQL_OR_REFUSAL_ORDER_ID","select b.order_id order_id,b.order_line_num order_line_num, b.ORD_CONSENT_REQD_YN ord_consent_reqd_yn,b.catalog_synonym_dc catalog_desc,b.ORD_PRACT_ID ord_pract_id,c.practitioner_name practitioner_name,a.encounter_id encounter_id, b.order_type_code order_type_code, a.patient_class patient_class,a.source_type  location_type,a.source_code location_code,b.priority priority,b.order_catalog_code order_catalog_code  from or_order a, or_order_line b, am_Practitioner c  where a.order_id = b.order_id and a.order_type_code = b.order_type_code and a.order_category = b.order_category and a.ord_pract_id = c.practitioner_id and a.patient_id=? and upper(b.order_id) LIKE upper(?||'%') and a.order_category not in ('PH') and b.order_line_status not in ( select order_status_code from or_order_status_code where order_status_type in (60,70,75,85,90,93,96,97,99))   order by b.order_id desc,b.order_line_num");//Modified by Uma on 6/15/2009 for IN011372
		dataMap.put("SQL_OR_REFUSAL_ORDER_RESULT","select '<b>' ||  decode(?,'en',c.PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,c.PATIENT_NAME)) || '</b>                             Sex/Age :  <b>'  || c.sex || '/' || get_age(c.date_of_birth) || '<b>'  patient_name,c.sex sex, get_age(c.date_of_birth) age, a.patient_id patient_id, a.srl_no srl_no,a.facility_id facility_id, a.encounter_id encounter_id,a.patient_class patient_class,a.order_line_num order_line_num, a.order_catalog_code order_catalog_code, to_char(a.refused_date_time,'dd/mm/yyyy hh24:mi') refused_date_time,a.refusal_type refusal_type,decode(a.refusal_type,'O','Orderable','N','Non-Orderable') refusal_desc,a.order_catalog_desc order_catalog_dec,a.refused_reason refused_reason,a.refused_pract_id refused_pract_id,a.order_id order_id, AM_GET_DESC.AM_PRACTITIONER(b.practitioner_id,?,'1')  practitioner_name,a.refusal_form_id refusal_form_id,a.srl_no srl_no from or_refusal_orderable a, am_practitioner b , mp_patient c where a.refused_pract_id = b.PRACTITIONER_ID and a.patient_id = c.patient_id and a.patient_id=?");
		//dataMap.put("SQL_OR_REFUSAL_ORDER_EXISTING_RESULT","select '<b>' ||  decode(?,'en',c.PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,c.PATIENT_NAME)) || '</b> Sex/Age :  <b>'  || c.sex || '/' || get_age(c.date_of_birth) || '<b>'  patient_name,c.sex sex, get_age(c.date_of_birth) age, a.patient_id patient_id, a.srl_no srl_no,a.facility_id facility_id, a.encounter_id encounter_id,a.patient_class patient_class,a.order_line_num order_line_num, a.order_catalog_code order_catalog_code, to_char(a.refused_date_time,'dd/mm/yyyy hh24:mi') refused_date_time,a.refusal_type refusal_type,decode(a.refusal_type,'O','Orderable','N','Non-Orderable') refusal_desc,a.order_catalog_desc order_catalog_dec,a.refused_reason refused_reason,a.refused_pract_id refused_pract_id,a.order_id order_id, AM_GET_DESC.AM_PRACTITIONER(b.practitioner_id,?,'1')  practitioner_name,a.refusal_form_id refusal_form_id,a.srl_no srl_no from or_refusal_orderable a, am_practitioner b , mp_patient c where a.refused_pract_id = b.PRACTITIONER_ID and a.patient_id = c.patient_id and a.patient_id=? and  trunc(a.refused_date_time) BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy') and nvl(a.ORDER_CATALOG_CODE,'X') like nvl(upper(?),nvl(a.ORDER_CATALOG_CODE,'X')) and a.refusal_type like nvl(?,a.refusal_type) order by a.REFUSED_DATE_TIME desc");
		dataMap.put("SQL_OR_REFUSAL_ORDER_EXISTING_RESULT","select '<b>' ||  decode(?,'en',c.PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,c.PATIENT_NAME)) || '</b> Sex/Age :  <b>'  || c.sex || '/' || get_age(c.date_of_birth) || '<b>'  patient_name,c.sex sex, get_age(c.date_of_birth) age, a.patient_id patient_id, a.srl_no srl_no,a.facility_id facility_id, a.encounter_id encounter_id,a.patient_class patient_class,a.order_line_num order_line_num, a.order_catalog_code order_catalog_code, to_char(a.refused_date_time,'dd/mm/yyyy hh24:mi') refused_date_time,a.refusal_type refusal_type,decode(a.refusal_type,'O','Orderable','N','Non-Orderable') refusal_desc,decode(substr(a.order_id,1,2),'PH',or_get_order_catalog(a.order_id,d.order_type_code,?,?),a.order_catalog_desc) order_catalog_dec,a.refused_reason refused_reason,a.refused_pract_id refused_pract_id,a.order_id order_id, AM_GET_DESC.AM_PRACTITIONER(b.practitioner_id,?,'1')  practitioner_name,a.refusal_form_id refusal_form_id,a.srl_no srl_no from or_refusal_orderable a, am_practitioner b , mp_patient c,or_order_line d where a.refused_pract_id = b.PRACTITIONER_ID and a.order_id=d.order_id(+) and a.patient_id = c.patient_id and a.patient_id=? and  trunc(a.refused_date_time) BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy') and nvl(a.ORDER_CATALOG_CODE,'X') like nvl(upper(?),nvl(a.ORDER_CATALOG_CODE,'X')) and a.refusal_type like nvl(?,a.refusal_type) order by a.REFUSED_DATE_TIME desc");//Modified by Uma on 7/3/2009 for IN008174
		dataMap.put("SQL_OR_REFUSAL_ORDER_REFUSED_FORM_SELECT","SELECT CONSENT_FORM_ID, OR_GET_DESC.OR_CONSENT_FORM(consent_form_id,?,'1') CONSENT_FORM_LABEL FROM OR_CONSENT_FORM WHERE CONSENT_TYPE='R' and eff_status='E'");
		//dataMap.put("SQL_OR_REFUSAL_ORDER_ORDER_DTLS_SELECT","SELECT order_line_num,  order_catalog_code,catalog_synonym_dc,order_type_code order_type_code,(select consent_form_id from or_order_catalog where order_catalog_code = a.order_catalog_code) consent_form_id  from or_order_line a where order_id = ? and  a.ord_consent_reqd_yn = 'Y' and (order_line_status = ( select order_status_code from or_order_status_code where order_status_type in ('00')) or ord_consent_status='P') order by order_line_num");changed on 5/15/2007
		dataMap.put("SQL_OR_REFUSAL_ORDER_ORDER_DTLS_SELECT","SELECT order_line_num,  order_catalog_code,catalog_synonym_dc,order_type_code order_type_code,(select consent_form_id from or_order_catalog where order_catalog_code = a.order_catalog_code) consent_form_id  from or_order_line a where order_id = ? and order_line_num= ? and  a.ord_consent_reqd_yn = 'Y' and (order_line_status = ( select order_status_code from or_order_status_code where order_status_type in ('00')) or ord_consent_status='P') order by order_line_num");
		dataMap.put("SQL_OR_ORDER_TYPE_SELECT_WITHOUT_PH","SELECT order_category,order_type_code, OR_GET_DESC.OR_ORDER_TYPE(order_type_code,?,'2')short_desc FROM or_order_type WHERE eff_status='E' AND order_category not in( 'PH','CS') and order_category = nvl(?,order_category) ORDER BY short_desc");
		dataMap.put("SQL_OR_ORDER_ENTRY_ORDER_CATEGORY_WITHOUT_PH","SELECT order_category, OR_GET_DESC.OR_ORDER_CATEGORY (order_category,?,'2') short_desc FROM or_order_category where order_category not in  ('PH') ORDER BY short_desc");
		dataMap.put("SQL_OR_REFUSAL_ORDER_CLOB","SELECT refusal_form_content FROM or_refusal_orderable WHERE  patient_id = ? and srl_no = ?  FOR UPDATE");

		dataMap.put("SQL_OR_REFUSAL_ORDERS_REFUSAL_CONTENT_SELECT","SELECT refusal_form_content FROM or_refusal_orderable a, am_practitioner b , mp_patient c where a.refused_pract_id = b.PRACTITIONER_ID and a.patient_id = c.patient_id and a.refusal_form_id = ? and a.patient_id=? and a.srl_no = ?");
		
		//Refusal Orders SQL----End

		//Record Procedure
		dataMap.put("SQL_OR_RECORD_PROCEDURE_ORDER_CATALOG_SELECT", "SELECT order_line_num,order_catalog_code FROM or_order_line WHERE order_id = ?");	
  		dataMap.put("SQL_OR_RECORD_PROCEDURE_PROC_CODE_SELECT", "SELECT b.chart_result_type chart_result_type,b.discr_msr_panel_id discr_msr_panel_id,proc_coding_scheme,b.Auto_report_yn auto_report_yn,b.bill_yn bill_yn,b.charge_type_applicable  charge_type_applicable FROM or_order_line a,or_order_catalog b WHERE b.order_catalog_code = a.order_catalog_code AND a.order_id = ? AND rownum < =1 and order_line_status not in (select order_status_type from or_order_Status_type where order_status_type in ('99','93','95','96','97'))");
        dataMap.put("SQL_OR_RECORD_PROCEDURE_COUNT_ORDERABLES", "SELECT COUNT(order_line_num) FROM or_order_line WHERE order_id = ?");
        dataMap.put("SQL_OR_RECORD_PROCEDURE_SELECT_ORDERABLES", "SELECT catalog_synonym_dc,order_catalog_code,order_line_num FROM or_order_line WHERE order_id = ?");
		//Record Procedure SQL----End

		//External Orders
		//dataMap.put("SQL_OR_EXTERNAL_ORDERS_REFERRAL_SELECT", "select referral_code, AM_GET_DESC.AM_REFERRAL(referral_code,?,'1')  long_desc,source_use_at_lb_ord_yn,source_use_at_rd_ord_yn from am_referral where eff_status='E' and nvl(APPLICABILITY_FOR_DIRECT_ORD,'N')  !='N' order by long_desc");
		dataMap.put("SQL_OR_EXTERNAL_ORDERS_REFERRAL_SELECT", "select referral_code, AM_GET_DESC.AM_REFERRAL(referral_code,?,'1')  long_desc,source_use_at_lb_ord_yn,source_use_at_rd_ord_yn,applicability_for_direct_ord applicability_for_direct_ord from am_referral where eff_status='E' and nvl(APPLICABILITY_FOR_DIRECT_ORD,'N')  !='N' order by long_desc");

		dataMap.put("SQL_OR_EXTERNAL_ORDERS_PRACTITIONER_SELECT", "SELECT A.PRACTITIONER_ID PRACTITIONER_ID,AM_GET_DESC.AM_EXT_PRACTITIONER(A.PRACTITIONER_ID,?,'2') SHORT_NAME FROM AM_EXT_PRACTITIONER A,AM_EXT_PRACT_FOR_REFERRAL b WHERE A.PRACTITIONER_ID = B.PRACTITIONER_ID AND REFERRAL_CODE = ? AND A.EFF_STATUS = 'E'");
		dataMap.put("SQL_OR_EXTERNAL_ORDERS_ORDER_CAT_SELECT","select order_category, OR_GET_DESC.OR_ORDER_CATEGORY(ORDER_CATEGORY,?,'2')short_desc from or_order_category where order_category not in('CN','CS','DS','MI','NC','OT','PC','PH') order by short_desc");
		//Added by Subhash on 13th Feb 2004
		
		//External Orders SQL -- End

		//Chart Horizontal
		dataMap.put("SQL_OR_CHART_HORIZONTAL_INSERT","insert into or_chart_horizontal (chart_result_type,chart_horiz_code,long_desc,short_desc,seq_no,eff_status, added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id, modified_date,modified_at_ws_no,modified_facility_id) values(?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");                 
		dataMap.put("SQL_OR_CHART_HORIZONTAL_UPDATE","update or_chart_horizontal set long_desc=?,short_desc=?,eff_status=?,modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=? where chart_horiz_code=? and chart_result_type = ?");
		dataMap.put("SQL_OR_CHART_HORIZONTAL_RESULT_SELECT","select a.chart_result_type chart_result_type, b.chart_result_type_desc chart_result_type_desc, a.chart_horiz_code chart_horiz_code, a.long_desc long_desc, a.short_desc short_desc, a.seq_no seq_no, a.eff_status eff_status  from or_chart_horizontal a, or_chart_result_type b where a.chart_result_type = b.chart_result_type and upper(a.chart_result_type ) like upper(?) and upper(a.chart_horiz_code) like upper(?) and upper(a.long_desc) like upper(?) and upper(a.eff_status) like upper(?) ");
		dataMap.put("SQL_OR_CHART_HORIZONTAL_SELECT_UPDATE","select a.chart_result_type chart_result_type, b.chart_result_type_desc chart_result_type_desc, a.chart_horiz_code chart_verti_code, a.long_desc long_desc, a.short_desc short_desc, a.seq_no seq_no,   a.eff_status eff_status from or_chart_horizontal a, or_chart_result_type b  where a.chart_result_type = b.chart_result_type and a.chart_result_type = ? and a.chart_horiz_code = ?"); 
		dataMap.put("SQL_OR_CHART_HORIZONTAL_DUPLICATE_CHK","SELECT chart_horiz_code from or_chart_horizontal where  chart_result_type = ? and chart_horiz_code in (?)");
		//Chart Horizontal SQL -- End

		// Chart Vertical 
		dataMap.put("SQL_OR_CHART_VERTICAL_INSERT","insert into or_chart_vertical (chart_result_type,chart_verti_code,long_desc,short_desc,seq_no,discr_msr_id,copy_prev_vert_yn,eff_status, added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id, modified_date,modified_at_ws_no,modified_facility_id) values(?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");                 
		dataMap.put("SQL_OR_CHART_VERTICAL_UPDATE","update or_chart_vertical set chart_result_type=?,long_desc=?,short_desc=?,seq_no = ?, eff_status=?,modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=? where chart_verti_code=? and chart_result_type= ?");
		dataMap.put("SQL_OR_CHART_VERTICAL_RESULT_SELECT","select a.chart_result_type chart_result_type, b.chart_result_type_desc chart_result_type_desc,c.short_desc discrete_short_desc, a.chart_verti_code chart_verti_code, a.long_desc long_desc, a.short_desc short_desc, a.seq_no seq_no,a.discr_msr_id discr_msr_id, a.copy_prev_vert_yn copy_prev_vert_yn,a.eff_status eff_status  from or_chart_vertical a, or_chart_result_type b , am_discr_msr c where a.chart_result_type = b.chart_result_type(+) and a.discr_msr_id = c.discr_msr_id(+) and upper(a.chart_result_type ) like upper(?) and upper(a.chart_verti_code) like upper(?) and upper(a.long_desc) like upper(?) and upper(a.short_desc) like upper(?) and a.seq_no like ? and upper(a.eff_status) like upper(?)");
		dataMap.put("SQL_OR_CHART_VERTICAL_SELECT_UPDATE","select a.chart_result_type chart_result_type,b.chart_result_type_desc chart_result_type_desc, c.short_desc discrete_short_desc,a.chart_verti_code chart_verti_code,a.long_desc long_desc,a.short_desc short_desc, a.seq_no seq_no,a.discr_msr_id discr_msr_id, a.copy_prev_vert_yn copy_prev_vert_yn,a.eff_status eff_status from or_chart_vertical a, or_chart_result_type b, am_discr_msr c where a.chart_result_type = b.chart_result_type and a.discr_msr_id = c.discr_msr_id(+) and a.chart_result_type = ? and a.chart_verti_code=?");
		dataMap.put("SQL_OR_CHART_VERTICAL_DUPLICATE_CHK","select chart_verti_code from or_chart_vertical where chart_result_type = ? and chart_verti_code in (?)");
		dataMap.put("SQL_OR_CHART_RESULT_TYPE_SERVICE_DESC" , "SELECT long_desc from am_service WHERE eff_status='E' AND service_code LIKE ? ");

		// Chart Vertical SQL -- END 

		// Chart Result Type 
		dataMap.put("SQL_OR_CHART_RESULT_TYPE_DISCR_MSR","SELECT discr_msr_id code,short_desc description from am_discr_msr where result_type not in ('Z','V','F') and discr_msr_id like ? and short_desc like ? order by 2");
		dataMap.put("SQL_OR_CHART_RESULT_TYPE","select chart_result_type, chart_result_type_desc from or_chart_result_type where eff_status='E' order by chart_result_type");
		dataMap.put("SQL_OR_CHART_RESULT_TYPE_INSERT","insert into OR_CHART_RESULT_TYPE(chart_result_type,chart_result_type_desc,chart_horzi_desc,chart_no_columns,chart_vert_desc,service_code,eff_status,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) values(?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?) "); 
		dataMap.put("SQL_OR_CHART_RESULT_TYPE_UPDATE","update OR_CHART_RESULT_TYPE set chart_result_type_desc=?,chart_horzi_desc= ?,chart_no_columns=?,chart_vert_desc=?,service_code=?,eff_status=?,modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=? where chart_result_type=? "); 
		dataMap.put("SQL_OR_CHART_RESULT_TYPE_SELECT","SELECT chart_result_type,chart_result_type_desc,chart_horzi_desc,chart_no_columns,chart_vert_desc,service_code,eff_status FROM OR_CHART_RESULT_TYPE WHERE UPPER(chart_result_type) LIKE UPPER(?) AND UPPER(chart_result_type_desc) LIKE UPPER(?) AND UPPER(chart_horzi_desc) LIKE (?) AND UPPER(chart_vert_desc) like (?) AND UPPER(eff_status) LIKE UPPER(?)");
 		dataMap.put("SQL_OR_CHART_RESULT_TYPE_DUPLICATE_CHK","select count(*) from or_chart_result_type where chart_result_type = ?");

		dataMap.put("SQL_OR_REPORT_CATALOG","SELECT short_desc, order_catalog_code FROM or_order_catalog WHERE order_category = nvl(?,order_category) AND order_type_code between nvl(?,order_type_code) AND nvl(?,order_type_code)");

		// Register Order --> Referral
		dataMap.put("SQL_OR_REGISTER_ORDER_INSERT_OR_REFUSAL_ORDERABLE","INSERT INTO or_refusal_orderable (patient_id,srl_no,facility_id,encounter_id,patient_class,order_id,order_line_num,order_catalog_code, order_catalog_desc,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date, modified_at_ws_no,modified_facility_id,  referral_form_id,referral_date_time,referral_remarks, referral_form_content)VALUES (?,?,?,?,?,?,?,?, ?,?,sysdate,?,?,?,sysdate,?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,empty_clob())");

		dataMap.put("SQL_OR_REGISTER_ORDER_FORM_UPDATE_CLOB", "SELECT referral_form_content FROM or_refusal_orderable WHERE patient_id = ? and srl_no = ?  FOR UPDATE");

		dataMap.put("SQL_OR_REGISTER_ORDER_APPT_REF_SELECT", "SELECT appt_ref_num FROM OR_ORDER_LINE WHERE ORDER_ID= ? AND ORDER_LINE_NUM = ? ");
		dataMap.put("SQL_OR_REGISTER_ORDER_APPT_REF_UPDATE", "update oa_appt  set encounter_id = ? where facility_id = ? and appt_ref_no = ?");

		// View order
		dataMap.put("SQL_OR_VIEW_ORDER_SET_ORDER_ID_SELECT", "select a.order_id order_id,b.order_category order_category,OR_GET_DESC.OR_ORDER_CATEGORY(ORDER_CATEGORY,?,'2')b.short_desc order_category_short_desc from or_order a, or_order_category b where a.order_category = b.order_category and a.order_set_id = ?");

		dataMap.put("SQL_OR_VIEW_ORDER_PRACT_SELECT", "SELECT appl_user_name  from sm_appl_user a,or_order b where order_id = ? and b.added_by_id = a.appl_user_id and func_role_id != b.ord_pract_id");

		// View order History
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_CATALOGS", "SELECT order_catalog_code, catalog_synonym_dc, order_line_num FROM or_order_line WHERE order_id = ?"); 
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_ORDER_DTLS", "SELECT DISTINCT field_mnemonic,field_mnemonic field_legends,order_line_num FROM or_order_action WHERE order_id = ? AND order_line_num = ?");
 		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_ACTION_DTLS", "SELECT (select or_get_desc.OR_ORDER_CATALOG(order_catalog_code,?,2) from or_order_line where order_id=or_order_action_vw.order_id and order_line_num=or_order_action_vw.ORDER_LINE_NUM)  Order_catalog_desc, nvl(field_mnemonic,'') field_legends ,action_seq_num, action_user_id, to_char(action_date_time,'dd/mm/yyyy hh24:mi') action_date_time, action_facility_id, field_mnemonic, field_value_old, field_value_new, field_value_txt, order_status_old, order_status_new, freq_old_desc, freq_new_desc, durn_old_desc, durn_new_desc, uom_old_desc, uom_new_desc, perform_old_desc, perform_new_desc,order_catalog_new_desc,order_catalog_old_desc,facility_old_desc,facility_new_desc,appl_user_name FROM or_order_action_vw WHERE order_id = ? ORDER BY ORDER_LINE_NUM, action_seq_num , action_date_time");
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_ORDER_LINE_ACTION_DTLS", "SELECT (select or_get_desc.OR_ORDER_CATALOG(order_catalog_code,?,2) from or_order_line where order_id=or_order_action_vw.order_id and order_line_num=or_order_action_vw.ORDER_LINE_NUM) Order_catalog_desc, nvl(field_mnemonic,'') field_legends ,action_seq_num, action_user_id, to_char(action_date_time,'dd/mm/yyyy hh24:mi') action_date_time, action_facility_id, field_mnemonic, field_value_old, field_value_new, field_value_txt, order_status_old, order_status_new, freq_old_desc, freq_new_desc, durn_old_desc, durn_new_desc, uom_old_desc, uom_new_desc, perform_old_desc, perform_new_desc,order_catalog_new_desc,order_catalog_old_desc,facility_old_desc,facility_new_desc,appl_user_name FROM or_order_action_vw WHERE order_id = ? AND order_line_num =  ? AND field_mnemonic = nvl(?, field_mnemonic) ORDER BY action_seq_num, action_date_time");
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_USER_SELECT", "SELECT appl_user_name FROM sm_appl_user WHERE appl_user_id=?");
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_PERFORMING_LOCN_SELECT", "SELECT performing_deptloc_short_desc short_desc FROM or_performing_deptloc WHERE performing_deptloc_code = ?");
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_PH_PERFORMING_LOCN_SELECT", "SELECT short_desc FROM ph_disp_locn WHERE disp_locn_code = ?");
   		 
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_ROUTE_SELECT", "SELECT route_desc short_desc FROM ph_route WHERE route_code = ?");
		dataMap.put("SQL_OR_VIEW_ORDER_HISTORY_REMARKS_SELECT", "SELECT field_value_txt  FROM or_order_action WHERE order_id = ? and action_seq_num = ?");
		
		// Referral Report Printing
		dataMap.put("SQL_OR_ORDER_ENTRY_REFERRAL_FORM_PRINT","SELECT print_referral_at_dest_yn,print_referral_at_src_yn,referral_dest_routine_queue_1,referral_dest_routine_queue_2,referral_dest_rout_queue_dflt,referral_dest_stat_queue_1,referral_dest_stat_queue_2,referral_dest_stat_queue_dflt FROM or_order_type_routing WHERE order_type_code = nvl((?),ordeR_type_code) AND  operating_facility_id = (?) AND patient_class in ('*A',(?)) AND rownum <=1");

		// Transfer appointment in existing order
		dataMap.put("SQL_OR_EXISTING_ORDER_OA_TRANSFER_PERFORMING_LOC" , "SELECT performing_deptloc_short_desc short_desc,performing_deptloc_code performing_location from or_performing_deptloc where PERFORMING_FACILITY_ID = ?");

		dataMap.put( "SQL_OR_EXISTING_ORDER_OA_ORDER_CATEGORY","SELECT OR_GET_DESC.OR_ORDER_CATEGORY(ORDER_CATEGORY,?,'2') short_desc, order_category 	FROM OR_ORDER_CATEGORY  where order_category  not in ('PH','CS','MI') and 'Y' =  DECODE(order_category,'RD',NVL((SELECT 'N' FROM SM_MODULES_FACILITY WHERE MODULE_ID = 'RD' AND FACILITY_ID = ? AND OPERATIONAL_YN = 'Y'),'Y'), 'OT',NVL((SELECT 'N' FROM  SM_MODULES_FACILITY WHERE MODULE_ID = 'OT' AND FACILITY_ID = ? AND OPERATIONAL_YN = 'Y'),'Y'),'Y') ORDER BY SHORT_DESC");

		dataMap.put("SQL_OR_EXISTING_ORDER_OA_TRANSFER_APPT_DETAILS" , "SELECT alcn_criteria, to_char(appt_slab_from_time,'hh24:mi') appt_slab_from_time, to_char(appt_slab_to_time,'hh24:mi') appt_slab_to_time, clinic_code, practitioner_id, to_char(APPT_DATE,'dd/mm/yyyy') appt_date, appt_type_code, team_id,overbooked_yn, global_appt_yn, forced_appt_yn, care_locn_type_ind , resource_class,visit_type_ind,to_char(appt_date,'DAY') appt_day FROM oa_appt_vw WHERE facility_id = ? AND APPT_REF_NO=? ");

		// Appointment Scheduling Search
		dataMap.put("SQL_OR_APPOINTMENT_PENDING_ORDERS" , "SELECT   patient_name ||', '||SEX ||' / '||GET_AGE(DATE_OF_BIRTH) ||', ID: '||Patient_id   patient_details, a.order_category order_category, order_category_short_desc,   b.Priority  priority_desc,  patient_class_short_desc,patient_class,  a.order_id order_id, patient_id,  encounter_id,  TO_CHAR(a.ord_date_time,'DD/MM/YYYY') order_date_time ,  OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,1)  order_detail,  b.order_catalog_code catalog_code,  source_type, source_code, b.priority priority, b.order_type_code  order_type_code, a.order_type_short_desc  order_type_short_desc, a.ord_pract_id ord_pract_id, ordering_pract_name, order_line_status   order_status, b.order_line_num order_line_num, nvl(b.cont_order_ind,'DO') cont_order_ind, to_char(b.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time, to_char(b.end_date_time,'dd/mm/yyyy hh24:mi') end_date_time, OR_ORDER_LINE_COLOR ('APPT',B.ORDER_ID ,B.ORDER_TYPE_CODE,B.ORDER_CATALOG_CODE,B.ORDER_LINE_NUM,B.START_DATE_TIME,B.ORDER_CATEGORY )  wait_time_indicator,SEX ,b.start_Date_Time Start_Date FROM	or_order_vw a, or_order_line b WHERE a.order_id =b.order_id AND nvl(b.cont_order_ind,'DO') in ('DO','DR','CO','CR') and Order_line_status = (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('10')) AND appt_reqd_yn = 'Y' AND ORDERING_FACILITY_ID = ? AND  a.order_category = NVL(?,a.order_Category)  AND a.order_type_code = nvl(?,a.order_type_code)  AND nvl(activity_type ,'!') = nvl(?,nvl(activity_type,'!'))  AND b.order_catalog_Code = nvl(?,b.order_Catalog_code)  AND nvl(a.performing_deptloc_code,'!') = nvl(?,nvl(a.performing_deptloc_code,'!'))  AND b.priority=nvl(?,b.priority)  AND a.patient_id = NVL(?,patient_id)  AND a.patient_class = NVL(?,patient_class)  AND trunc(a.ord_date_time) BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy')  AND 'Y' = DECODE(B.ORDER_CATEGORY,'RD',NVL((SELECT 'N' FROM SM_MODULES_FACILITY  WHERE MODULE_ID = 'RD' AND FACILITY_ID = ? AND OPERATIONAL_YN = 'Y'),'Y'), 'OT',NVL((SELECT 'N' FROM SM_MODULES_FACILITY WHERE MODULE_ID = 'OT' AND FACILITY_ID = ? AND OPERATIONAL_YN = 'Y'),'Y'),'Y')  ORDER BY Start_Date DESC");

		//SELECT   patient_name ||', '||decode(SEX,'M','Male','F','Female','Unknown') ||' / '||GET_AGE(DATE_OF_BIRTH) ||', ID: '||Patient_id   patient_details, a.order_category order_category, order_category_short_desc,   DECODE(nvl(b.Priority,'R'),'U','Urgent','S','Stat','R','Routine') priority_desc,  patient_class_short_desc,patient_class,  a.order_id order_id, patient_id,  encounter_id,  TO_CHAR(a.ord_date_time,'DD/MM/YYYY') order_date_time ,  catalog_synonym  order_detail,  b.order_catalog_code catalog_code,  source_type, source_code, b.priority priority, b.order_type_code  order_type_code, a.order_type_short_desc  order_type_short_desc, a.ord_pract_id ord_pract_id, ordering_pract_name, order_line_status   order_status, b.order_line_num order_line_num, nvl(b.cont_order_ind,'DO') cont_order_ind, to_char(b.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time, to_char(b.end_date_time,'dd/mm/yyyy hh24:mi') end_date_time, OR_ORDER_LINE_COLOR ('APPT',B.ORDER_ID ,B.ORDER_TYPE_CODE,B.ORDER_CATALOG_CODE,B.ORDER_LINE_NUM,B.START_DATE_TIME,B.ORDER_CATEGORY )  wait_time_indicator,SEX FROM	or_order_vw a, or_order_line b WHERE a.ordeR_id =b.ordER_id AND nvl(b.cont_order_ind,'DO') in ('DO','DR','CO','CR') and Order_line_status = (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('10')) AND appt_reqd_yn = 'Y' AND ORDERING_FACILITY_ID = ? AND  a.order_category = NVL(?,a.order_Category)  AND a.order_type_code = nvl(?,a.order_type_code)  AND nvl(activity_type ,'!') = nvl(?,nvl(activity_type,'!'))  AND b.order_catalog_Code = nvl(?,b.order_Catalog_code)  AND nvl(a.performing_deptloc_code,'!') = nvl(?,nvl(a.performing_deptloc_code,'!'))  AND b.priority=nvl(?,b.priority)  AND a.patient_id = NVL(?,patient_id)  AND a.patient_class = NVL(?,patient_class)  AND trunc(a.ord_date_time) BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy')  AND 'Y' = DECODE(B.ORDER_CATEGORY,'RD',NVL((SELECT 'N' FROM SM_MODULES_FACILITY  WHERE MODULE_ID = 'RD' AND FACILITY_ID = ? AND OPERATIONAL_YN = 'Y'),'Y'), 'OT',NVL((SELECT 'N' FROM SM_MODULES_FACILITY WHERE MODULE_ID = 'OT' AND FACILITY_ID = ? AND OPERATIONAL_YN = 'Y'),'Y'),'Y')  ORDER BY start_date_time DESC"); 	

		// Replace Orderable 
		//dataMap.put("SQL_OR_REPLACE_ADD_ORDERS_SELECT" , "SELECT order_catalog_code_repl, OR_GET_DESC.OR_ORDER_CATALOG(b.order_catalog_code,?,'2') short_desc from or_order_catalog_repl a,or_order_catalog b where a.order_catalog_code_repl = b.order_Catalog_Code and a.ORDER_CATALOG_CODE  = ? order by 2");
		dataMap.put("SQL_OR_REPLACE_ADD_ORDERS_SELECT" , "SELECT order_catalog_code_repl, OR_GET_DESC.OR_ORDER_CATALOG(a.order_catalog_code_repl,?,'2') short_desc from or_order_catalog_repl a where a.ORDER_CATALOG_CODE  = ? order by 2");
		// Change Charge Type 
		dataMap.put("SQL_OR_CHANGE_CHARGE_TYPE_SELECT" , "select charge_type_code, OR_GET_DESC.OR_CHARGE_TYPE(order_category,charge_type_code,?,'1') description from OR_CHARGE_TYPE where order_category in ('*A',(?)) order by 1 ");

		// Practitioner common Lookup from AM
		// This query change is completed in OR and pending in AM to change in callGeneralPractitionerSearch.jsp with regard to passing of language id's
		dataMap.put("SQL_OR_PRACTITIONER_LOOKUP" , "SELECT DISTINCT a.practitioner_id practitioner_id, AM_GET_DESC.AM_PRACTITIONER(a.practitioner_id,?,'1') practitioner_name, AM_GET_DESC.AM_PRACT_TYPE(d.pract_type,?,'1') practitioner_type, AM_GET_DESC.AM_SPECIALITY(e.speciality_code,?,'2') primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist', 'TR','Trainee' ) job_title FROM am_practitioner a, am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code AND d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) OR UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY practitioner_name");

		dataMap.put("SQL_OR_PRACTITIONER_LOOKUP_ADMIN" , "SELECT DISTINCT a.practitioner_id practitioner_id, a.practitioner_name practitioner_name, d.desc_sysdef practitioner_type, e.short_desc primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist', 'TR','Trainee' ) job_title FROM am_practitioner a, am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code AND d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) OR UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY a.practitioner_name");

		dataMap.put("SQL_OR_CONSENT_FORM_PATIENT_TEMPLATE_SELECT","SELECT patient_id, added_date regn_date, patient_name, decode(SEX ,'F','Female','M','Male','Other') gender,sex, TO_CHAR(date_of_birth,'dd/mm/yyyy') date_of_birth, mar_status_desc mar_status_code, nationality_desc nationality_code, regn_facility_name facility_name, res_area_desc res_area_code ,  res_town_desc res_town_code , relgn_desc relgn_code , name_prefix , region_desc region_code , blood_grp,rh_factor, TO_CHAR(SYSDATE,'dd/mm/yyyy hh24:mi') sys_date_time,resi_addr_line1|| '  '||resi_addr_line2|| '  '|| resi_addr_line3||'  '|| resi_addr_line4||'  '||res_area_desc|| '  '||res_town_desc|| '  '||res_area_desc||'  '||resi_postal_code|| '  '||resi_country_name residentail_address, get_age (date_of_birth) age,national_id_no national_id_no from mp_chg_pat_dtls_vw where patient_id = ? "); 

		dataMap.put("SQL_OR_CONSENT_FORM_ENCOUNTER_TEMPLATE_SELECT","SELECT encounter_id ,decode(ASSIGN_CARE_LOCN_TYPE,'N','Nusing Unit','D', 'Day Care','E','Emergency','C','Clinic','P','Procedure Unit') ||'/'|| CLINIC_NAME Current_Location, practitioner_name attending_practitioner,specialty_desc speciality,to_char(VISIT_ADM_DATE_TIME,'DD/MM/YYYY HH24:MI') Admission_date, Decode(PATIENT_CLASS,'IP','Inpatient','OP','Outpatient','EM','Emergency','XT','External','DC','Day Care') patient_class,ASSIGN_ROOM_NUM ROOM_NUM ,assign_bed_num bed_num ,service_desc service_code FROM pr_encounter_vw WHERE facility_id = ? AND encounter_id = ?");

		//dataMap.put("SQL_OR_CONSENT_FORM_ORDER_TEMPLATE_SELECT","SELECT order_id , to_char(ORD_DATE_TIME,'dd/mm/yyyy hh24:mi') order_date, decode(PRIORITY,'R','Routine','S','Stat','U','Urgent') PRIORITY,LOCATION_TYPE    || '/'||LOCN_SHORT_DESC ORDERING_LOCATION,ORDERING_PRACT_NAME ORDERING_PRACTITIONER, ORDER_TYPE_SHORT_DESC   ORDER_TYPE, ORDER_CATEGORY_SHORT_DESC ORDER_CATEGORY,OR_GET_ORDER_CATALOG_CONSENT(order_id)  ORDERABLE,Null ANAESTHESIA,Null PREF_SURG_DATE,null PERFORM_SURGEON,null ANAESTHETIST_CODE,null REASON_REFUSAL from or_order_vw where order_id = ?");
		dataMap.put("SQL_OR_CONSENT_FORM_ORDER_TEMPLATE_SELECT","SELECT order_id , to_char(ORD_DATE_TIME,'dd/mm/yyyy hh24:mi') order_date,PRIORITY,SOURCE_TYPE,SOURCE_CODE,case when patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(ordering_facility_id,source_code,?,'2') else op_get_desc.op_clinic(ordering_facility_id,source_code,?,'2') end  location_description,am_get_desc.am_practitioner (ord_pract_id,?,'1') ORDERING_PRACTITIONER, or_get_desc.or_order_type (order_type_code,?,'2') ORDER_TYPE, or_get_desc.or_order_category(order_category,?,'2') ORDER_CATEGORY,OR_GET_ORDER_CATALOG_CONSENT(order_id)  ORDERABLE,Null ANAESTHESIA,Null PREF_SURG_DATE,null PERFORM_SURGEON,null ANAESTHETIST_CODE,null REASON_REFUSAL from or_order where order_id = ?");

		// Age Group Gender Population
		dataMap.put("SQL_OR_CONSENT_FORM_AGE_GROUP_SELECT","SELECT COUNT(age_group_code) FROM am_age_group WHERE age_group_code=? AND NVL(gender, ?)= ? AND TRUNC(sysdate)-TRUNC(to_date(?,'dd/mm/yyyy')) BETWEEN DECODE(age_unit,'Y',365,'M',30,1)*min_age and decode(age_unit,'Y',365,'M',30,1)*max_age and  eff_status='E' ");

 		//Referral Lookup
		dataMap.put("SQL_OR_REFERRAL_LOOKUP" , "SELECT referral_code code, long_desc description from am_referral where eff_status='E' and referral_code like upper(?) AND upper(long_desc) LIKE upper(?) ORDER BY 2");

		//Service Lookup
		dataMap.put("SQL_OR_SERVICE_LOOKUP" , "SELECT service_code code , long_desc description from am_service WHERE eff_status='E' AND service_code LIKE upper(?) AND upper(long_desc) LIKE upper(?) ORDER BY 2");

		//Medical team
		dataMap.put("SQL_OR_MEDICAL_TEAM_LOOKUP" , "SELECT team_id code, long_desc description from am_medical_team WHERE eff_status='E' AND TEAM_ID LIKE upper(?) AND upper(long_desc) LIKE upper(?)  ORDER BY 2");
		
		// Reprint forms 
		//dataMap.put("SQL_OR_REPRINT_FORMS_CONSENT_FORM_CONTENT","select CONSENT_FORM_CONTENT from or_refusal_orderable  where order_id = (?) and order_line_num = ? and dbms_lob.getlength (CONSENT_FORM_CONTENT) > 0");

		dataMap.put("SQL_OR_REPRINT_FORMS_CONSENT_FORM_CONTENT","SELECT FORM_CONTENT CONSENT_FORM_CONTENT FROM OR_CONSENT_REF_DTL A, OR_CONSENT_REF_HDR B WHERE A.CONSENT_REF_ID= ? AND A.ORDER_ID = ? AND A.ORDER_LINE_NUM = ? AND A.TYPE = 'C' AND B.CONSENT_REF_ID = A.CONSENT_REF_ID AND B.FORM_ID = A.FORM_ID AND DBMS_LOB.GETLENGTH (B.FORM_CONTENT) > 0");// Query modified for Consents - Murthy - 18/05/2007 

		dataMap.put("SQL_OR_REPRINT_FORMS_REFUSAL_FORM_CONTENT","select REFUSAL_FORM_CONTENT from or_refusal_orderable  where order_id = (?) and order_line_num = ? and dbms_lob.getlength (REFUSAL_FORM_CONTENT) > 0 ");

		dataMap.put("SQL_OR_REPRINT_FORMS_REFUSAL_FORM_CONTENT_PATIENT_SRL","select REFUSAL_FORM_CONTENT from or_refusal_orderable  where patient_id = (?) and srl_no = ? ");

		dataMap.put("SQL_OR_REPRINT_FORMS_REFERRAL_FORM_CONTENT","select REFERRAL_FORM_CONTENT from or_refusal_orderable  where order_id = (?) and order_line_num = ? ");
		
		//wait time Order Category
		//dataMap.put("SQL_OR_WAIT_TIME_ORD_CAT_SELECT" , "SELECT order_category,short_desc FROM or_order_category  where  order_category not in('CS','PH') order by short_desc");
		dataMap.put("SQL_OR_WAIT_TIME_ORD_TYPE_SELECT" , "select order_type_code ,short_desc from or_order_type where order_category = nvl(?,order_category) order by 2");
		dataMap.put("SQL_OR_WAIT_TIME_PENDING_INSERT" , "insert into or_param_appt_wait_ctl (order_category, order_type_code, order_catalog_code, appt_wait_time_activate_yn, appt_wait_time_green_ind, appt_wait_time_yellow_ind, appt_wait_time_red_ind, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) values( ?, ?, ?, ?, ?, ?, ?, ?, sysdate, ?, ?, ?, sysdate, ?, ?)");
		dataMap.put("SQL_OR_WAIT_TIME_PENDING_DUP_CHK" , "select count(*) from or_param_appt_wait_ctl where order_category like (?) and order_type_code like (?) and order_catalog_code like (?)");
		dataMap.put("SQL_OR_WAIT_TIME_PENDING_RESULT" , "select a.order_category order_category, a.order_type_code order_type_code, c.short_desc order_type_desc,a.order_catalog_code order_catalog_code, d.short_desc order_catalog_desc, appt_wait_time_green_ind,  appt_wait_time_yellow_ind,appt_wait_time_red_ind, appt_wait_time_activate_yn ,b.short_desc order_cat_desc from or_param_appt_wait_ctl a,or_order_category b,or_order_type c,or_order_catalog d where a.order_category = b.order_category and a.order_category like upper(?) and  c.order_type_code = a.order_type_code and a.order_type_code like upper(?) and d.order_catalog_code = a.order_catalog_code and c.short_desc like upper(?) and upper(a.order_catalog_code) like (?) and  upper(d.short_desc) like (?) and appt_wait_time_activate_yn like (?) union  select a.order_category order_category, a.order_type_code order_type_code, c.short_desc order_type_desc, '*ALL' order_catalog_code,'All' order_catalog_desc, Appt_wait_time_green_ind, appt_wait_time_yellow_ind, appt_wait_time_red_ind,  appt_wait_time_activate_yn ,b.short_desc order_cat_desc from or_param_appt_wait_ctl a, or_order_category b, or_order_type c where a.order_category = b.order_category  and a.order_category like upper(?) and  c.order_type_code = a.order_type_code and   a.order_type_code like upper(?) and a.order_catalog_code='*ALL' and appt_wait_time_activate_yn like (?) union SELECT a.order_category order_category, '*ALL'  order_type_code, 'All' order_type_desc, '*ALL' order_catalog_code,    'All' order_catalog_desc, appt_wait_time_green_ind,   appt_wait_time_yellow_ind, appt_wait_time_red_ind,       appt_wait_time_activate_yn, b.short_desc order_cat_desc  FROM or_param_appt_wait_ctl a, or_order_category b WHERE a.order_category = b.order_category   AND a.order_category LIKE UPPER (?)  AND a.order_type_code ='*ALL'   AND a.order_catalog_code = '*ALL'  AND appt_wait_time_activate_yn LIKE (?)");
		dataMap.put("SQL_OR_WAIT_TIME_PENDING_SELECT_UPDATE" , "select a.order_category order_category, order_type_code, order_catalog_code, appt_wait_time_green_ind,  appt_wait_time_yellow_ind,appt_wait_time_red_ind, appt_wait_time_activate_yn,b.short_desc category_desc from or_param_appt_wait_ctl a,or_order_category b where b.ORDER_CATEGORY = a.ORDER_CATEGORY and a.order_category like upper(?) and order_type_code like upper(?) and upper(order_catalog_code) like upper(?)");
		dataMap.put("SQL_OR_WAIT_TIME_PENDING_UPDATE" , "update or_param_appt_wait_ctl set appt_wait_time_activate_yn = ?, appt_wait_time_green_ind = ?, appt_wait_time_yellow_ind = ?, appt_wait_time_red_ind = ?,modified_by_id =?, modified_date = sysdate, modified_at_ws_no =?, modified_facility_id=? where order_category like (?) and order_type_code like (?) and order_catalog_code like (?)");

		//Result Template Editor
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_INSERT" , "insert into or_result_template_editor (result_temp_id, result_temp_desc,service_code, edit_text, html_text,added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) values( ?, ?,?, empty_clob(), empty_clob(), ?, sysdate, ?, ?, ?, sysdate, ?, ?)");
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_DUPL_CHECK" , "select count(*) from or_result_template_editor where result_temp_id = ?");

		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_UPDATE" , "update or_result_template_editor set  result_temp_desc = ?,service_code=?, edit_text = empty_clob(), html_text = empty_clob(), modified_by_id =?, modified_date = sysdate, modified_at_ws_no = ?, modified_facility_id= ? where result_temp_id = ?");
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_UPDATE_CLOB" , "select edit_text, HTML_TEXT from or_result_template_editor where RESULT_TEMP_ID = ? for update");

		//-----------Begins-----------Kavitha.K
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_DISCRETE_MEASURE_SELECT" , " select discr_msr_id code, long_desc description,result_type, num_digits_max, num_digits_min, num_digits_dec, result_template_id , numeric_prefix_yn from am_discr_msr where eff_Status ='E' and result_type not in('V','Z','G','P','A','R','X','M','S') and upper(discr_msr_id) like upper(?) and upper(long_desc) like upper(?) and nvl(RS_APPL_YN,'Y')  = 'Y' order by 2");
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_QUERY_RESULT" , " select result_temp_id, result_temp_desc from or_result_template_editor where upper(result_temp_id) like upper(?) and upper(result_temp_desc)  like upper(?)");
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_SELECT" , "select edit_text,html_text, result_temp_desc,service_code from or_result_template_editor where result_temp_id=?");
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_SERVICE_DESC" , "SELECT long_desc from am_service WHERE eff_status='E' AND service_code LIKE ? ");

		//-----------Ends-----------Kavitha.K

		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_DELETE_CHK" , "select count(*) from or_order_catalog where CHART_RESULT_TYPE='T' and DISCR_MSR_PANEL_ID= ? ");	
		
		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_DELETE" , "delete from or_result_template_editor where result_temp_id= ?");

		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_NUMERIC_SELECT" , "SELECT num_uom || '  '|| TO_CHAR(num_ref_low,DECODE(b.NUM_DIGITS_DEC,1,'999999999.0',2,'999999999.90',3,'999999999.900',4,'999999999.9000',5,'999999999.90000',6,'999999999.900000',7,'999999999.9000000',8,'999999999.90000000',9,'9',0,'999999999','999999999')) || '-'  || TO_CHAR(num_ref_high,DECODE(b.NUM_DIGITS_DEC,1,'999999999.0',2,'999999999.90',3,'999999999.900',4,'999999999.9000',5,'999999999.90000',6,'999999999.900000',7,'999999999.9000000',8,'999999999.90000000',9,'999999999.90000000',0,'999999999','999999999'))  Reference_Range FROM am_discr_msr_ref_rng_num  a,am_discr_msr b WHERE a.discr_msr_id = ? and a.discr_msr_id = b.discr_msr_id ");

		dataMap.put("SQL_OR_RESULT_TEMPLATE_EDITOR_LIST_SELECT" , "SELECT ref_rng_desc ,dflt_yn,result_value from AM_DISCR_MSR_REF_RNG_LIST where discr_msr_id = ? order by SORT_ORDER");
		
		// Specimen order
		dataMap.put("SQL_OR_SPECIMEN_ORDER_LOCATION_ORDER_WING" , "select WING_CODE code,SHORT_DESC description from rd_wings where OPERATING_FACILITY_ID= ?  and nvl(status,'E') = 'E' and upper(WING_CODE) like upper(?) and upper(SHORT_DESC) like upper(?)"); 	
		dataMap.put("SQL_OR_SPECIMEN_ORDER_LOCATION_ORDER_THEATRE" , "select OPER_ROOM_CODE code,SHORT_DESC description from OT_OPER_ROOM where OPERATING_FACILITY_ID= ? and nvl(status,'E') = 'E' and upper(OPER_ROOM_CODE) like upper(?) and upper(SHORT_DESC) like upper(?)"); 	
		// For Neonates, RL
		dataMap.put("SQL_OR_SPECIMEN_ORDER_RL_NEONATES_MOTHER_PATIENT","call RL_NEONATES.RL_NEONATE_MOTHER_PATIENT_NAME(?,?,?,?,?,?)");
		dataMap.put("SQL_OR_SPECIMEN_ORDER_RL_NEONATES_SPEC_YN","call RL_NEONATES.RL_NEONATE_SPEC_YN(?,?,?)");
		dataMap.put("SQL_OR_ORDER_ENTRY_RL_NEONATES_UPD_COLLECTION","call RL_NEONATES.RL_UPD_COLLECTION_DATE(?,?,to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'))");

		// Result Reporting (Coding)
		dataMap.put("SQL_OR_RESULT_REPORTING_CODING_SELECT" , "SELECT   order_category, OR_GET_DESC.OR_ORDER_CATEGORY (order_category,?,'2') order_category_short_desc, order_type_code, OR_GET_DESC.OR_ORDER_TYPE(order_type_code,?,'2') order_type_short_desc, priority priority_desc, AM_GET_DESC.AM_PATIENT_CLASS(patient_class,?,'2') patient_class_short_desc, patient_class,location_type || '/' || locn_short_desc location_details, order_id,         patient_id, encounter_id, TO_CHAR (ord_date_time, 'DD/MM/YYYY HH24:MI') order_date_time,   TO_CHAR (ord_date_time, 'dd/mm/yyyy') grp_date_time, or_get_order_catalog (order_id, order_type_code,?,?) order_detail, decode(?,'en',PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,PATIENT_NAME)) || ',' || sex|| ' / '|| get_age (date_of_birth)|| ', ID:'|| patient_id || ' '         || 'Encounter Dtls : ' || encounter_id || ','|| location_type|| ' / '|| locn_short_desc encounter_dtls, source_type, source_code, priority, order_type_code, ord_pract_id,          AM_GET_DESC.AM_PRACTITIONER(ord_pract_id,?,'1')  ordering_pract_name, order_status, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_status,?,'2') order_status_short_desc,ord_cosign_reqd_yn, sex sex1, source_type, source_code,get_age (date_of_birth) age, date_of_birth dob, a.performing_facility_id performing_facility_id,a.performing_deptloc_type performing_deptloc_type,a.performing_deptloc_code performing_deptloc_code FROM or_order_vw a WHERE patient_id = NVL (?, patient_id) AND NVL (encounter_id, 0) = NVL (?, NVL(encounter_id, 0)) AND order_id = NVL (?, order_id) AND order_id IN (SELECT order_id    FROM or_order_line b WHERE a.order_id = b.order_id AND TRUNC (b.start_date_time)           BETWEEN TO_DATE (NVL (?, '01/01/1000'),'dd/mm/yyyy') AND LEAST (TO_DATE (NVL ((?),         '31/12/9999'),'dd/mm/yyyy'),SYSDATE) AND order_catalog_code IN (SELECT order_catalog_code  FROM or_order_catalog WHERE order_catalog_code = b.order_catalog_code                      AND NVL (proc_link_applicable, 'Z') = 'R')) AND priority = NVL (?, priority) AND order_category IN (SELECT order_category FROM or_result_user WHERE (practitioner_id = ? OR resp_id = ?) AND order_category = NVL (?, order_category)) AND order_type_code = NVL (?, order_type_code) AND performing_facility_id = (?) AND ('Z' = (?)AND order_status  IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN             ('85', '90')) OR 'U' = (?) AND order_status  IN (SELECT order_status_code               FROM or_order_status_code WHERE order_status_type IN ('85', '90')) AND NOT EXISTS (SELECT 'X' FROM or_result_detail_proc WHERE order_id = a.order_id) OR 'C' = (?) AND order_status IN (SELECT order_status_code FROM or_order_status_code  WHERE order_status_type IN     ('85', '90')) AND EXISTS (SELECT 'X' FROM or_result_detail_proc WHERE order_id = a.order_id) ) AND NVL (source_type, 'X') = NVL (?, NVL (source_type, 'X')) AND NVL (source_code, 'X') = NVL (?, NVL (source_code, 'X')) AND 'Y' = or_module_resulting (a.performing_facility_id, a.order_category) AND TRUNC (ord_date_time) BETWEEN TO_DATE (NVL (?, '01/01/1000' ), 'dd/mm/yyyy') AND LEAST (TO_DATE (NVL ((?), '31/12/9999'),'dd/mm/yyyy' ),SYSDATE)AND EXISTS (SELECT 'X' FROM or_order_line  WHERE order_id = a.order_id AND NVL (activity_type, '!') = NVL (?, NVL (activity_type, '!'))) and (performing_appl_id IS NULL  OR performing_appl_id IN ( SELECT ext_image_appl_id FROM ca_ext_image_appl WHERE  NVL (result_entry, 'OR') = 'OR')) ORDER BY DECODE ((?), 'D', TO_CHAR (a.ord_date_time, 'yyyymmdd'), 'C', a.order_category, 'T', a.order_type_code, 'L', a.location_type, 'P', a.patient_id, 'U', priority ) DESC");//changed on 7/17/2007 by uma 

		// Result Entry (Procedure Linking)
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK" ,"SELECT B.DISCR_MSR_ID DISCR_MSR_ID, ORDER_LINE_NUM  LINE_SRL_NUM, ORDER_LINE_NUM PARENT_SRL_NO,B.SHORT_DESC  EVENT_GROUP_DESC, B.SHORT_DESC  EVENT_DESC, a.order_catalog_code order_catalog_code,a.PROC_LINK_APPLICABLE PROC_LINK_APPLICABLE, a.PROC_LINK_RESULTING_OPTION PROC_LINK_RESULTING_OPTION,E.SHORT_DESC Procedure_Desc ,F.DEFAULT_YN  DEFAULT_YN,F.PROC_CODE PROC_CODE, E.LONG_DESC LONG_DESC,F.PROC_CODING_SCHEME PROC_CODING_SCHEME ,G.TERM_SET_DESC TERM_SET_DESC,'N'   ENABLE_YN FROM OR_ORDER_LINE_VW A,AM_DISCR_MSR B, MR_TERM_CODE  E,OR_ORDER_CATALOG_PROC_LINK F ,MR_TERM_SET G WHERE A.ORDER_ID= ? AND B.RESULT_TYPE != 'Z' AND  A.DISCR_MSR_PANEL_ID = B.DISCR_MSR_ID and G.TERM_SET_ID = F.PROC_CODING_SCHEME and e.TERM_SET_ID = F.PROC_CODING_SCHEME AND e.TERM_CODE = F.PROC_CODE and e.PROCEDURE_YN = 'Y' and  F.order_Catalog_Code = a.order_Catalog_Code AND (PROC_CODING_SCHEME||proc_code) not in (SELECT  (PROC_CODING_SCHEME ||proc_code_resulted)  FROM OR_RESULT_DETAIL_PROC WHERE ORDEr_ID =  A.ORDER_ID  and PROC_CODING_SCHEME  = F.PROC_CODING_SCHEME  and  proc_code_resulted = f.proc_code ) UNION SELECT C.DISCR_MSR_ID, (C.ORDER_SRL_NO/1000+ A.ORDER_LINE_NUM)   SRL_NO  , C.ORDER_SRL_NO PARENT_SRL_NO, B.SHORT_DESC  EVENT_GROUP_DESC, D.SHORT_DESC  EVENT_DESC, a.order_catalog_code order_catalog_code, a.PROC_LINK_APPLICABLE PROC_LINK_APPLICABLE, a.PROC_LINK_RESULTING_OPTION PROC_LINK_RESULTING_OPTION ,E.SHORT_DESC Procedure_Desc ,F.DEFAULT_YN  DEFAULT_YN,F.PROC_CODE PROC_CODE, E.LONG_DESC  LONG_DESC,F.PROC_CODING_SCHEME PROC_CODING_SCHEME ,G.TERM_SET_DESC TERM_SET_DESC,'N'   ENABLE_YN  FROM OR_ORDER_LINE_VW A,AM_DISCR_MSR B,AM_DISCR_MSR_BATTERY  C,	AM_DISCR_MSR D	,MR_TERM_CODE E,OR_ORDER_CATALOG_PROC_LINK F ,MR_TERM_SET G  WHERE A.ORDER_ID=? AND A.DISCR_MSR_PANEL_ID= B.DISCR_MSR_ID AND B.RESULT_TYPE='Z' AND B.DISCR_MSR_ID  =C.DISCR_MSR_BATTERY_ID AND D.DISCR_MSR_ID =C.DISCR_MSR_ID and G.TERM_SET_ID = F.PROC_CODING_SCHEME and e.TERM_SET_ID = F.PROC_CODING_SCHEME AND e.TERM_CODE = F.PROC_CODE and e.PROCEDURE_YN = 'Y' and    F.order_Catalog_Code = a.order_Catalog_Code AND (PROC_CODING_SCHEME||proc_code) not in (SELECT  (PROC_CODING_SCHEME ||proc_code_resulted)  FROM OR_RESULT_DETAIL_PROC WHERE ORDEr_ID =  A.ORDER_ID  and PROC_CODING_SCHEME  = F.PROC_CODING_SCHEME  and  proc_code_resulted = f.proc_code )  UNION SELECT B.CHART_RESULT_TYPE DISCR_MSR_ID, ORDER_LINE_NUM  LINE_SRL_NUM, ORDER_LINE_NUM  PARENT_SRL_NO, B.CHART_RESULT_TYPE_DESC  EVENT_GROUP_DESC, B.CHART_RESULT_TYPE_DESC  EVENT_DESC, a.order_catalog_code order_catalog_code , a.PROC_LINK_APPLICABLE PROC_LINK_APPLICABLE, a.PROC_LINK_RESULTING_OPTION PROC_LINK_RESULTING_OPTION ,E.SHORT_DESC Procedure_Desc ,F.DEFAULT_YN  DEFAULT_YN,F.PROC_CODE PROC_CODE, E.LONG_DESC  LONG_DESC,F.PROC_CODING_SCHEME PROC_CODING_SCHEME ,G.TERM_SET_DESC TERM_SET_DESC,'N'   ENABLE_YN  FROM 	OR_ORDER_LINE_VW A,OR_CHART_RESULT_TYPE B, MR_TERM_CODE E, OR_ORDER_CATALOG_PROC_LINK F,MR_TERM_SET G  WHERE A.ORDER_ID= ? AND A.DISCR_MSR_PANEL_ID = B.CHART_RESULT_TYPE AND G.TERM_SET_ID = F.PROC_CODING_SCHEME and e.TERM_SET_ID = F.PROC_CODING_SCHEME AND e.TERM_CODE = F.PROC_CODE and e.PROCEDURE_YN = 'Y'  and F.order_Catalog_Code = a.order_Catalog_Code AND (PROC_CODING_SCHEME||proc_code) not in (SELECT  (PROC_CODING_SCHEME ||proc_code_resulted)  FROM OR_RESULT_DETAIL_PROC WHERE ORDEr_ID =  A.ORDER_ID  and PROC_CODING_SCHEME  = F.PROC_CODING_SCHEME  and  proc_code_resulted = f.proc_code ) UNION SELECT   b.note_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.note_type_desc event_group_desc, b.note_type_desc event_desc,a.order_catalog_code order_catalog_code, a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,ca_note_type b,mr_term_code e,or_order_catalog_proc_link f,     mr_term_set g WHERE a.order_id = ? AND a.discr_msr_panel_id = b.note_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code  AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code AND (proc_coding_scheme || proc_code) NOT IN (SELECT (proc_coding_scheme || proc_code_resulted) FROM or_result_detail_proc WHERE order_id = a.order_id AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code)    union SELECT B.DISCR_MSR_ID DISCR_MSR_ID, ORDER_LINE_NUM  LINE_SRL_NUM, ORDER_LINE_NUM PARENT_SRL_NO, B.SHORT_DESC  EVENT_GROUP_DESC, B.SHORT_DESC  EVENT_DESC, a.order_catalog_code order_catalog_code ,a.PROC_LINK_APPLICABLE PROC_LINK_APPLICABLE, a.PROC_LINK_RESULTING_OPTION PROC_LINK_RESULTING_OPTION ,E.SHORT_DESC Procedure_Desc ,'Y'   DEFAULT_YN,F.PROC_CODE PROC_CODE, E.LONG_DESC  LONG_DESC,F.PROC_CODING_SCHEME PROC_CODING_SCHEME ,G.TERM_SET_DESC TERM_SET_DESC,'Y'   ENABLE_YN FROM OR_ORDER_LINE_VW A,AM_DISCR_MSR B, MR_TERM_CODE  E,OR_ORDER_CATALOG_PROC_LINK F ,MR_TERM_SET G WHERE A.ORDER_ID= ? AND B.RESULT_TYPE != 'Z' AND  A.DISCR_MSR_PANEL_ID = B.DISCR_MSR_ID and G.TERM_SET_ID = F.PROC_CODING_SCHEME and e.TERM_SET_ID = F.PROC_CODING_SCHEME AND e.TERM_CODE = F.PROC_CODE and e.PROCEDURE_YN = 'Y' and  F.order_Catalog_Code = a.order_Catalog_Code AND (PROC_CODING_SCHEME||proc_code) in (SELECT  (PROC_CODING_SCHEME ||proc_code_resulted)  FROM OR_RESULT_DETAIL_PROC WHERE ORDEr_ID =  A.ORDER_ID  and PROC_CODING_SCHEME  = F.PROC_CODING_SCHEME  and  proc_code_resulted = f.proc_code ) UNION SELECT C.DISCR_MSR_ID, (C.ORDER_SRL_NO/1000+ A.ORDER_LINE_NUM)   SRL_NO  , C.ORDER_SRL_NO PARENT_SRL_NO, B.SHORT_DESC  EVENT_GROUP_DESC, D.SHORT_DESC  EVENT_DESC, a.order_catalog_code order_catalog_code, a.PROC_LINK_APPLICABLE PROC_LINK_APPLICABLE, a.PROC_LINK_RESULTING_OPTION PROC_LINK_RESULTING_OPTION ,E.SHORT_DESC Procedure_Desc ,'Y'  DEFAULT_YN,F.PROC_CODE PROC_CODE, E.LONG_DESC  LONG_DESC,F.PROC_CODING_SCHEME PROC_CODING_SCHEME ,G.TERM_SET_DESC TERM_SET_DESC, 'N' ENABLE_YN   FROM OR_ORDER_LINE_VW A,AM_DISCR_MSR B,AM_DISCR_MSR_BATTERY  C,	AM_DISCR_MSR D	,MR_TERM_CODE E,OR_ORDER_CATALOG_PROC_LINK F ,MR_TERM_SET G  WHERE A.ORDER_ID=? AND A.DISCR_MSR_PANEL_ID= B.DISCR_MSR_ID AND B.RESULT_TYPE='Z' AND B.DISCR_MSR_ID  =C.DISCR_MSR_BATTERY_ID AND D.DISCR_MSR_ID =C.DISCR_MSR_ID and G.TERM_SET_ID = F.PROC_CODING_SCHEME and e.TERM_SET_ID = F.PROC_CODING_SCHEME AND e.TERM_CODE = F.PROC_CODE and e.PROCEDURE_YN = 'Y' and    F.order_Catalog_Code = a.order_Catalog_Code AND (PROC_CODING_SCHEME||proc_code) in (SELECT  (PROC_CODING_SCHEME ||proc_code_resulted)  FROM OR_RESULT_DETAIL_PROC WHERE ORDEr_ID =  A.ORDER_ID  and PROC_CODING_SCHEME  = F.PROC_CODING_SCHEME  and  proc_code_resulted = f.proc_code )  UNION SELECT B.CHART_RESULT_TYPE DISCR_MSR_ID, ORDER_LINE_NUM  LINE_SRL_NUM, ORDER_LINE_NUM  PARENT_SRL_NO, B.CHART_RESULT_TYPE_DESC  EVENT_GROUP_DESC, B.CHART_RESULT_TYPE_DESC  EVENT_DESC, a.order_catalog_code order_catalog_code , a.PROC_LINK_APPLICABLE PROC_LINK_APPLICABLE, a.PROC_LINK_RESULTING_OPTION PROC_LINK_RESULTING_OPTION ,E.SHORT_DESC Procedure_Desc ,'Y' DEFAULT_YN,F.PROC_CODE PROC_CODE, E.LONG_DESC  LONG_DESC,F.PROC_CODING_SCHEME PROC_CODING_SCHEME ,G.TERM_SET_DESC TERM_SET_DESC , 'N' ENABLE_YN  FROM 	OR_ORDER_LINE_VW A,OR_CHART_RESULT_TYPE B, MR_TERM_CODE E, OR_ORDER_CATALOG_PROC_LINK F,MR_TERM_SET G  WHERE A.ORDER_ID= ? AND A.DISCR_MSR_PANEL_ID = B.CHART_RESULT_TYPE AND G.TERM_SET_ID = F.PROC_CODING_SCHEME and e.TERM_SET_ID = F.PROC_CODING_SCHEME AND e.TERM_CODE = F.PROC_CODE and e.PROCEDURE_YN = 'Y'  and  F.order_Catalog_Code = a.order_Catalog_Code  AND (PROC_CODING_SCHEME||proc_code) in (SELECT  (PROC_CODING_SCHEME ||proc_code_resulted)  FROM OR_RESULT_DETAIL_PROC WHERE ORDEr_ID =  A.ORDER_ID  and PROC_CODING_SCHEME  = F.PROC_CODING_SCHEME  and  proc_code_resulted = f.proc_code ) UNION SELECT b.note_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.note_type_desc event_group_desc,b.note_type_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, 'Y' default_yn, f.proc_code proc_code,e.long_desc long_desc, f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,ca_note_type b,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ? AND a.discr_msr_panel_id = b.note_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code AND (proc_coding_scheme || proc_code) IN ( SELECT (proc_coding_scheme || proc_code_resulted) FROM or_result_detail_proc WHERE order_id = a.order_id AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code)	order by 2,3,4,1");
		// insert 
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_INSERT","insert into OR_RESULT_DETAIL_PROC(order_type_code,order_id,report_srl_no,line_srl_no,srl_no,proc_code_scheme, proc_code_resulted,   Added_By_ID,Added_Date,Added_At_Ws_No,Added_Facility_ID,Modified_By_ID,Modified_Date,Modified_At_Ws_No,Modified_Facility_ID) values(?,?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?)");
		//dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_DELETE","delete from OR_RESULT_DETAIL_PROC where order_type_code =? and order_id =? and report_srl_no = ? and line_srl_no = ? and srl_no = ?");
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_DELETE","delete from OR_RESULT_DETAIL_PROC where order_id = ?");
		dataMap.put("SQL_OR_RESULT_ENTRY_NOTE_UPDATE","call OR_NOTE_UPDATE (?,?,?,?,?,?,?)");
		dataMap.put("SQL_OR_RESULT_ENTRY_NOTE_DATA_CLOB","select note_content from ca_encntr_note where accession_num = ? and facility_id = ?");
		dataMap.put("SQL_OR_RESULT_ENTRY_UPDATE_OR_ORDER_LINE_STATUS","update or_order_line set	order_line_status = (select order_status_code from or_order_status_code where order_status_type = '85') ,result_line_status = (select order_status_code from or_order_status_code where order_status_type = '85') ,	accession_num = nvl(?,accession_num),last_action_type = nvl(?,last_action_type), modified_by_id=(?), modified_date=SYSDATE, modified_at_ws_no=(?), modified_facility_id=(?) where order_id = ? and order_line_num = ?");

		// Order Entry -- MO Integration
		dataMap.put("SQL_OR_ORDER_ENTRY_PATIENT_DECEASED","SELECT deceased_yn FROM mp_patient WHERE patient_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_PATIENT_MO_MORTUARY_REGN_SELECT","SELECT COUNT(patient_id) FROM mo_mortuary_regn WHERE patient_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_PATIENT_MO_CATALOG_SELECT","SELECT order_catalog_code_cl_pm, order_catalog_code_ml_pm FROM mo_parameter WHERE facility_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_PATIENT_MO_ORDER_FOR_POSTMORTERM_COUNT","SELECT COUNT(patient_id) from   MO_ORDER_FOR_POSTMORTEM  where patient_id = ? and order_catalog_code =?");
		dataMap.put("SQL_OR_ORDER_ENTRY_MO_ORDER_FOR_POSTMORTERM_INSERT" , "INSERT INTO MO_ORDER_FOR_POSTMORTEM(facility_id, patient_id, order_id, ord_date_time, practitioner_id,order_catalog_code,order_line_num ,order_line_status,added_by_id,added_date ,added_at_ws_no ,added_facility_id ,modified_by_id,modified_date ,modified_at_ws_no,modified_facility_id) VALUES (?,?,?,to_date(?,'dd/mm/yyyy hh24:mi'),?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		
		//Order Entry Practitioner lookup in order Foramts
		dataMap.put("SQL_OR_ORDER_ENTRY_FORMAT_PRACT_LOOKUP" , "select b.practitioner_id code,a.short_name description from am_practitioner a,am_pract_for_facility b where a.practitioner_id = b.practitioner_id and b.facility_id = (?) and upper(b.practitioner_id) like upper(?) and upper(a.short_name) like  upper(?)");

		//Order Entry Order format Header
		dataMap.put("SQL_OR_ORDER_ENTRY_FORMAT_HDR_CHK" , "select count(*) count from or_order_field_values where order_id = ?");
		
		//Order Entry Formats for Radiology Exams
		dataMap.put("SQL_OR_ORDER_ENTRY_FORMAT_RD_EXAM" , "SELECT nvl(CONTRAST_APPLICABILITY,'N') CONTRAST_APPLICABILITY FROM RD_EXAMS WHERE ORDER_CATALOG_CODE = ?");

		// Order Entry -- Fully Resulted (auto_report_yn)
		dataMap.put("SQL_OR_ORDER_ENTRY_OR_AUTOREPORT_COMPLETION","call OR_AUTOREPORT_COMPLETION (?,?,?,?,?,?,?,?,?,?,?)");
		
		// Duplicate Check Fetching records 
		//activity not there
	 	dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_CHECK_DUPL_STAT_BEHIND_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time, b.order_id order_id,b.catalog_synonym catalog_desc, AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1')  pract_name , OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2') order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id AND b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.order_catalog_code = ? AND (b.start_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI')- (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR b.end_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI') - (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI')) AND order_line_status NOT IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('45','50', '99','97','93')) order by b.start_date_time");
	 	dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_CHECK_DUPL_STAT_BEHIND_ACTIVE_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time,b.order_id order_id, b.catalog_synonym catalog_desc, AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1')  pract_name , OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2') order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id  and b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.order_catalog_code = ? AND(b.start_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI')- (? * DECODE(? ,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR b.end_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI') - (? *DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI')) AND order_line_status IN(SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN('00','03','05','10','15','20','25','30','35','40')) order by b.start_date_time");
 		dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_CHECK_DUPL_STAT_AHEAD_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time, b.order_id order_id, b.catalog_synonym catalog_desc, AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1')  pract_name , OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2') order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id AND b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.order_catalog_code = ? AND (b.start_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') and (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60)))))  OR b.end_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') and (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60)))))) AND order_line_status NOT IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('45','50', '99','97','93')) order by b.start_date_time");
		dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_CHECK_DUPL_STAT_AHEAD_ACTIVE_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time,b.order_id order_id, b.catalog_synonym catalog_desc , AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1')  pract_name, OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2') order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id  and b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.order_catalog_code = ? AND(b.start_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') and  (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? * DECODE(? ,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) OR b.end_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') and (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? *DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60)))))) AND order_line_status IN(SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN('00','03','05','10','15','20','25','30','35','40')) order by b.start_date_time");
		// till here 

		// If activity type is there
 		dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_ACTIVITY_CHECK_DUPL_STAT_BEHIND_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time, b.order_id order_id, b.catalog_synonym  catalog_desc, AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1')  pract_name , OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2') order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id AND b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.activity_type = ? AND (b.start_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI')- (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR b.end_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI') - (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI')) AND order_line_status NOT IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('45','50', '99','97','93')) order by b.start_date_time");
 		dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_ACTIVITY_CHECK_DUPL_STAT_BEHIND_ACTIVE_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time,b.order_id order_id, b.catalog_synonym catalog_desc, AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1') pract_name , OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2') order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id  and b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.activity_type = ?  AND(b.start_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI')- (? * DECODE(? ,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI') OR b.end_date_time BETWEEN (TO_DATE(?,'DD/MM/YYYY HH24:MI') - (? *DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) AND TO_DATE(?,'DD/MM/YYYY HH24:MI')) AND order_line_status IN(SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN('00','03','05','10','15','20','25','30','35','40')) order by b.start_date_time");
 		dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_ACTIVITY_CHECK_DUPL_STAT_AHEAD_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time, b.order_id order_id, b.catalog_synonym catalog_desc , AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1')  pract_name ,OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2')  order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id AND b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.activity_type = ?  AND (b.start_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') and (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60)))))  OR b.end_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') and (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? * DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) ) AND order_line_status NOT IN (SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN ('45','50', '99','97','93')) order by b.start_date_time");
 		dataMap.put("SQL_OR_ORDER_ENTRY_DUPLICATE_ACTIVITY_CHECK_DUPL_STAT_AHEAD_ACTIVE_DETAILS","SELECT TO_CHAR(b.start_date_time,'DD/MM/YYYY HH24:MI') start_date_time,b.order_id order_id,b.catalog_synonym  catalog_desc,AM_GET_DESC.AM_PRACTITIONER(c.practitioner_id,?,'1')  pract_name ,  OR_GET_DESC.OR_ORDER_STATUS_CODE(d.order_status_code,?,'2') order_status_desc,TO_CHAR(b.end_date_time,'DD/MM/YYYY HH24:MI') end_date_time FROM or_order a, or_order_line b ,am_practitioner c ,or_order_status_code d WHERE a.order_id = b.order_id AND a.ord_pract_id = c.practitioner_id  and b.order_line_status = d.order_status_code AND a.patient_id = ? AND b.activity_type = ? AND(b.start_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? * DECODE(? ,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60))))) OR b.end_date_time BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') and (TO_DATE(?,'DD/MM/YYYY HH24:MI') + (? *DECODE(?,'D',1,'W',7,'M',30,'H',(1/24),'I',(1/(24*60)))))) AND order_line_status IN(SELECT order_status_code FROM or_order_status_code WHERE order_status_type IN('00','03','05','10','15','20','25','30','35','40')) order by b.start_date_time");
		//  Till here 

		// Replaceable Orderable
		dataMap.put("SQL_OR_REPLACEABLE_ORDERABLE_CATALOG_SELECT","SELECT order_catalog_code code,short_desc description FROM or_order_catalog where order_category not in ('CS','PH','MI') and eff_status='E' and upper(order_catalog_code) like upper(?) and upper(short_desc) like upper(?)  "); 
	//	dataMap.put("SQL_OR_REPLACEABLE_ORDERABLE_OTHER_CATALOG_SELECT","SELECT order_catalog_code code,short_desc description FROM or_order_catalog where (order_type_code || order_Category)  in (select order_type_code|| order_Category from or_order_catalog  where upper(order_catalog_code) like upper(?)) and eff_Status = 'E' and order_catalog_code like upper(?) and short_desc like upper(?)  "); 

        dataMap.put("SQL_OR_REPLACEABLE_ORDERABLE_OTHER_CATALOG_SELECT","SELECT order_catalog_code code,short_desc description FROM or_order_catalog where upper(order_catalog_code) != upper(?) and (order_type_code || order_Category)  in (select order_type_code || order_Category from or_order_catalog  where upper(order_catalog_code) like upper(?))   and eff_Status = 'E' and order_catalog_code like upper(?) and upper(short_desc) like upper(?) ");
		dataMap.put("SQL_OR_REPLACEABLE_ORDERABLE_RESULT","SELECT a.order_catalog_code order_catalog_code, b.long_desc  catalog_desc, a.order_catalog_code_repl order_catalog_code_repl, c.long_desc order_catalog_code_repl_desc from or_order_catalog_repl a, or_order_catalog b, or_order_catalog c where a.order_catalog_code = b.order_catalog_code and a.order_catalog_code_repl = c.order_catalog_code and upper(a.order_catalog_code) like upper(?) and upper(a.ORDER_CATALOG_CODE_REPL) like upper(?) and upper(b.long_desc) like upper(?) and upper(c.long_desc) like upper(?)"); 
		dataMap.put("SQL_OR_REPLACEABLE_ORDERABLE_DUPLICATE_CHK","SELECT count(rowid) FROM or_order_catalog_repl WHERE order_catalog_code =? and order_catalog_code_repl = ?");
		dataMap.put("SQL_OR_REPLACEABLE_ORDERABLE_INSERT","INSERT INTO or_order_catalog_repl(order_catalog_code, order_catalog_code_repl,added_by_id,added_date ,added_at_ws_no ,added_facility_id ,modified_by_id,modified_date ,modified_at_ws_no,modified_facility_id) VALUES (?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)"); 
	
		dataMap.put("SQL_OR_REPLACEABLE_ORDERABLE_DELETE","delete from or_order_catalog_repl where order_catalog_code = ? and order_catalog_code_repl = ?"); 
 
		//dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_SCHEME_SELECT","Select proc_code_scheme scheme,	decode(proc_code_scheme,'3','CPT4','4','ICD9-CM','6','ICD10 PCS') || '  Code'  scheme_code ,decode(proc_code_scheme,'3','CPT4','4','ICD9-CM','6','ICD10 PCS') || '  Description' scheme_desc from mr_parameter");
		//dataMap.put("SQL_OR_ORDER_ENTRY_COMPLETE_LINE_AUTOREPORT", "select b.auto_report_yn auto_report_yn, b.order_catalog_code order_catalog_code from or_order_line a,or_order_catalog b where b.order_catalog_code = a.order_catalog_code and a.order_id = ? and a.order_line_num = ?");
		//complete Order
		dataMap.put("SQL_OR_ORDER_ENTRY_COMPLETE_LINE_AUTOREPORT", "select b.auto_report_yn auto_report_yn, b.order_catalog_code order_catalog_code,b.order_type_code order_type_code from or_order_line a,or_order_catalog b where b.order_catalog_code = a.order_catalog_code and a.order_id = ? and a.order_line_num = ?");//Modified by Uma on 6/11/2009 for IN011187

		//TDMReason
		dataMap.put("SQL_OR_RESULT_ENTRY_TDMREASON", "select 'Reason for Request  :'|| (select REASON_DESC    from PH_MEDN_TRN_REASON where REASON_CODE  = a.reason_for_req_code)  || CHR(10) || 'Smoking                 :' || decode (SMOKER_YN,'Y','Yes','No') || chr(10) ||'Takes Alcohol          :' || decode(ALCOHLIC_YN,'Y','Yes','No') || chr(10) ||'Pregnant                 :' || decode(PREGNANT_YN,'Y','Yes','No') || chr(10) ||'Remarks                 :' ||  REMARKS TDMREASON from or_order_line_tdm a where ordeR_id like (?) and Order_line_num = 1");

		// Cancel Order for RL Neonates 
		dataMap.put("SQL_OR_CANCEL_ORDER_RL_CANCEL_SPECIMEN","call RL_NEONATES.RL_CANCEL_SPECIMEN (?,?,?,?,?,?)");
		
		// Discontinue Order for RL Neonates 
		dataMap.put("SQL_OR_CANCEL_ORDER_RL_DISCONTINUE_REQUEST","call RLPROCOR.RL_DISCONTINUE_REQUEST (?,?,?,?,?)");

		dataMap.put("SQL_OR_ORDER_TYPE_APPT_REQD_YN_SELECT","SELECT 'Y' appt_reqd_yn  FROM or_order_catalog WHERE order_category = ? and order_type_code = ? and appt_reqd_yn = 'Y'  and rownum <= 1 ");
		//Specimen Order for Record Collection
		dataMap.put("SQL_OR_SPECIMEN_ORDER_COLLECTION_SELECT","SELECT DISTINCT a.order_category order_category,or_get_desc.or_order_category(a.order_category,?,'2') order_category_short_desc,a.order_type_code order_type_code,or_get_desc.or_order_type(a.order_type_code,?,'2') order_type_short_desc,a.priority priority_desc,AM_GET_DESC.AM_PATIENT_CLASS(patient_class, ?,'2') patient_class_short_desc,a.patient_class patient_class,case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.ordering_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.ordering_facility_id,a.source_code,?,'2') end  location_description,a.order_id order_id, a.patient_id patient_id, a.encounter_id encounter_id,TO_CHAR (a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time,or_get_order_catalog (a.order_id,a.order_type_code,?,?) catalog_desc,(select max(accession_num) from or_order_line where order_id=a.order_id and accession_num is not null) accession_num, source_type, source_code, a.priority priority,a.order_type_code order_type_code,a.ord_pract_id ord_pract_id,am_get_desc.am_practitioner(a.ord_pract_id,?,'1') ordering_pract_name,order_status,or_get_desc.or_order_status_code(a.order_status,?,'2') order_status_short_desc,a.ord_cosign_reqd_yn ord_cosign_reqd_yn,b.specimen_type specimen_type,b.specimen_collect_yn specimen_collect_yn,b.coll_label_gen_rule coll_label_gen_rule,TO_CHAR (c.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,TO_CHAR (c.end_date_time, 'dd/mm/yyyy hh24:mi') end_date_time,or_collection_due_date(a.source_type,a.source_code,b.specimen_type,b.specimen_collect_yn,a.priority,c.start_date_time,NULL,a.order_type_code,performing_facility_id,?) or_collection_due,get_age (d.date_of_birth) age,d.sex sex,DECODE (?, 'en', d.patient_name,NVL (d.patient_name_loc_lang, d.patient_name)) PATIENT_NAME,a.source_type,start_date_time start_date_time_dt  FROM or_order a, or_order_line_lb b, or_order_line c,mp_patient d  WHERE a.patient_id=d.patient_id and a.ord_date_time BETWEEN TO_DATE (NVL (?, '01/01/1000 00:01'),'dd/mm/yyyy hh24:mi') AND TO_DATE (NVL (?, '31/12/3500 23:59'),'dd/mm/yyyy hh24:mi') AND a.order_category = NVL ( ? , a.order_category)AND	a.order_id = b.order_id AND a.order_id = c.order_id AND b.order_id = c.order_id AND b.order_line_num = c.order_line_num AND a.patient_id = NVL (?, a.patient_id) AND NVL (encounter_id, 1) = NVL (?, NVL (encounter_id, 1)) AND a.order_id = NVL (?, a.order_id) AND NVL (source_code, '!')=nvl(?,NVL (source_code, '!')) AND a.order_type_code=NVL (?, a.order_type_code) AND NVL (a.priority, 'R') = NVL (?, NVL (a.priority, 'R')) AND b.order_line_num = 1 AND (   (    NVL (b.coll_label_gen_rule, 'P') IN ('P') AND ? = 'N'  AND order_status IN ('OS', 'AB', 'AV', 'AF')) OR (    NVL (b.coll_label_gen_rule, 'P') = 'G' AND ? = 'R' AND order_status IN ('OS', 'SC', 'RG', 'AB', 'AV', 'AF')) OR (    NVL (b.coll_label_gen_rule, 'P') IN ('G', 'X') AND ? = 'C'  AND order_status IN ('SC', 'OS', 'AB', 'AV', 'AF') AND coll_reqd_yn = 'Y'  AND specimen_collect_yn = 'N'  AND specimen_dispatch_yn = 'N'  AND coll_label_gen_date_time IS NULL  ) )AND NVL (c.accession_num, 'XX') =  NVL (?, NVL (c.accession_num, 'XX')) AND NVL (source_type, '!') = NVL (?, NVL (source_type, '!')) AND ordering_facility_id = ? AND performing_facility_id = ?    AND 'Y' = or_ordering_rd_ot (?, ?, a.order_id) ORDER BY a.source_type, location_description, start_date_time_dt DESC"  );// and sysdate >= c.start_Date_time
        // Antibiotic 
		dataMap.put("SQL_OR_ANTIBIOTIC_EFF_STATUS","select eff_status from or_antibiotic where antibiotic_code = ?");
		// Privilege 
		dataMap.put("SQL_OR_PRIVILEGE_PRIV_VALUE","select privilege_id,privilege_value from or_privilege_ctx_exception where privilege_ctx_id = ? and grp_exception_id = ?");
		// Waiting List
		dataMap.put("SQL_OR_WAITING_LIST_CATALOG","select order_catalog_code code, short_desc description from OR_ORDER_CATALOG where order_category = ? and ORDER_TYPE_CODE = ? and order_catalog_code like upper(?) and short_desc like initcap(?)");

		//Register Order
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_ORDTYPE_PERFORM_LOCN_YN", "SELECT restrict_by_deptloc_yn FROM or_result_user WHERE NVL(practitioner_id,'XXX') = NVL(?,'XXX') AND order_category = ? and order_type_code = ?");
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_ORDTYPE_RESP_PERFORM_LOCN_YN", "SELECT restrict_by_deptloc_yn FROM or_result_user WHERE NVL(resp_id,'XXX') = NVL(?,'XXX') AND order_category = ? and order_type_code = ?");
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_ORDTYPE_PERFORM_LOCN_YN_ALL", "SELECT restrict_by_deptloc_yn FROM or_result_user WHERE NVL(practitioner_id,'XXX') = NVL(?,'XXX')   AND order_category = ? AND order_type_code = '*ALL'");
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_ORDTYPE_RESP_PERFORM_LOCN_YN_ALL", "SELECT  restrict_by_deptloc_yn FROM or_result_user WHERE NVL(RESP_ID,'XXX') = NVL(?, 'XXX')   AND order_category = ? AND order_type_code = '*ALL'");
		
		//Order Entry Practitioner Lookup
		dataMap.put("SQL_OR_ORDER_ENTRY_PRACT_SQL2","SELECT DISTINCT a.practitioner_id practitioner_id, a.practitioner_name practitioner_name, d.desc_sysdef practitioner_type,  e.short_desc primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist','TR','Trainee' ) job_title FROM am_practitioner  a , am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.eff_status = 'E' AND d.pract_type IN ('PS','DN','MD','SG','RD','PT') AND	a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code and d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) AND UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY a.practitioner_name ");
		dataMap.put("SQL_OR_ORDER_ENTRY_MEDICAL_ATTEND_PRACT_SQL2","SELECT DISTINCT a.practitioner_id practitioner_id, a.practitioner_name practitioner_name, d.desc_sysdef practitioner_type,  e.short_desc primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist','TR','Trainee' ) job_title FROM am_practitioner  a , am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.practitioner_id IN (SELECT practitioner_id FROM am_pract_for_team WHERE facility_id LIKE ? AND team_id IN (SELECT team_id FROM am_pract_for_team WHERE facility_id LIKE ? AND practitioner_id LIKE ?)) AND a.practitioner_id != ? AND a.eff_status = 'E' AND d.pract_type IN ('PS','DN','MD','SG','RD','PT') AND		a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code and d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) AND UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY a.practitioner_name ");
		dataMap.put("SQL_OR_ORDER_ENTRY_MEDICAL_OTHER_PRACT_SQL2","SELECT DISTINCT a.practitioner_id practitioner_id, a.practitioner_name practitioner_name, d.desc_sysdef practitioner_type,  e.short_desc primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist','TR','Trainee' ) job_title FROM am_practitioner  a , am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.practitioner_id IN (SELECT practitioner_id FROM am_pract_for_team WHERE facility_id LIKE ? AND team_id NOT IN (SELECT team_id FROM am_pract_for_team WHERE facility_id LIKE ? AND practitioner_id like ? )) AND a.practitioner_id != ? AND a.eff_status = 'E'  AND d.pract_type IN ('PS','DN','MD','SG','RD','PT') AND		a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code and d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) AND UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY a.practitioner_name");
        dataMap.put("SQL_OR_ORDER_ENTRY_LOCATION_PRACT_SQL2","SELECT DISTINCT a.practitioner_id practitioner_id, a.practitioner_name practitioner_name, d.desc_sysdef practitioner_type,  e.short_desc primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist','TR','Trainee' ) job_title FROM am_practitioner  a , am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.practitioner_id IN (SELECT practitioner_id FROM op_pract_for_clinic WHERE facility_id LIKE ? AND clinic_code LIKE ?) AND a.eff_status='E' AND d.pract_type IN ('PS','DN','MD','SG','RD','PT') AND	a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code and d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) AND UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY a.practitioner_name");
		dataMap.put("SQL_OR_ORDER_ENTRY_LOCATION_NU_PRACT_SQL2","SELECT DISTINCT f.practitioner_id practitioner_id, a.practitioner_name practitioner_name, d.desc_sysdef practitioner_type,  e.short_desc primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist','TR','Trainee' ) job_title FROM am_practitioner  a , am_pract_type d, am_pract_all_splty_vw c ,am_speciality e,ip_nursing_unit_for_pract f  WHERE f.practitioner_id = a.practitioner_id AND f.nursing_unit_code = ? and f.facility_id=? AND a.eff_status = 'E' AND d.pract_type IN ('PS','DN','MD','SG','RD','PT') AND	a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code and d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) AND UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) or a.job_title IS NULL) ORDER BY a.practitioner_name ");
		// This query change is completed in OR and pending in AM to change in callGeneralPractitionerSearch.jsp with regard to passing of language id's
		dataMap.put("SQL_OR_PRACTITIONER_LOOKUP_SQL2" , "SELECT DISTINCT a.practitioner_id practitioner_id, AM_GET_DESC.AM_PRACTITIONER(a.practitioner_id,?,'1') practitioner_name, AM_GET_DESC.AM_PRACT_TYPE(d.pract_type,?,'1') practitioner_type, AM_GET_DESC.AM_SPECIALITY(e.speciality_code,?,'2') primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist', 'TR','Trainee' ) job_title FROM am_practitioner a, am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code AND d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) AND UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY practitioner_name");
		dataMap.put("SQL_OR_PRACTITIONER_LOOKUP_SQL2_ADMIN" , "SELECT DISTINCT a.practitioner_id practitioner_id, a.practitioner_name practitioner_name, d.desc_sysdef practitioner_type, e.short_desc primary_specialty,  DECODE(a.gender,'M','Male','F','Female','U','Unknown') gender, DECODE(a.job_title,'CC','Chief Consultant', 'CO', 'Consultant', 'RG', 'Registrar', 'RS', 'Resident', 'ST', 'Specialist', 'SC', 'Sr. Consultant', 'SR', 'Sr. Resident', 'SP', 'Sr. Specialist', 'TR','Trainee' ) job_title FROM am_practitioner a, am_pract_type d, am_pract_all_splty_vw c ,am_speciality e WHERE a.pract_type = d.pract_type AND a.practitioner_id = c.practitioner_id AND a.primary_speciality_code = e.speciality_code AND d.pract_type LIKE (?) AND c.specialty_code LIKE UPPER (?) AND (UPPER(a.practitioner_id) LIKE UPPER(NVL(?,a.practitioner_id)) AND UPPER(a.practitioner_name) LIKE UPPER(NVL(?,a.practitioner_name))) AND  a.gender LIKE (?) AND (a.job_title LIKE (?) OR a.job_title IS NULL) ORDER BY a.practitioner_name");
		
		//To perform valid operation based on the status
		dataMap.put("SQL_OR_ORDER_LINE_STATUS_CHK","SELECT OR_ORDER_STATUS_FLAG( ? , ? , ? , ? , ?) PERFORM_YN FROM DUAL");
		dataMap.put("SQL_OR_ORDER_STATUS_CHK" , "SELECT OR_ORDER_STATUS_POPUPMENU (? ,? , ?) PERFORM_YN  FROM DUAL");
		dataMap.put("SQL_OR_ORDER_TYPE_CODE","SELECT ORDER_TYPE_CODE  FROM OR_ORDER WHERE ORDER_ID = ?");
		dataMap.put("SQL_OR_ORDER_OPERTIONAL_STATUS","SELECT OR_VERFY_OPRN_APPLICABLITY (? ,? , ?) OPERATION_YN FROM DUAL");
		dataMap.put("SQL_OR_ORDER_RECEIVE_RESULT_STATUS","SELECT DECODE(COUNT(*), 0 ,'Y','N')PERFORM_YN FROM CA_RESULT_REVIEW_DONE_LOG WHERE PRACT_ID = ? AND HIST_REC_TYPE = ? AND ACCESSION_NUM = ?");
		
		//consent Order
		dataMap.put("SQL_OR_CONSENT_ORDER_UPDATE_ORDER_LINE_FREQ_EXPLN_STAGE","UPDATE or_order_line SET order_line_status = (?),modified_by_id =(?),modified_date  = sysdate,modified_at_ws_no=(?),modified_facility_id=(?)  WHERE parent_order_id =(?) ");

		//Order Tracking to inclued the suspended loacations too
		//dataMap.put("SQL_OR_ORDER_TRACKING_SELECT_LOCATION","Select clinic_code locn_code,short_desc locn_short_desc from op_clinic where  facility_id = ? union all Select nursing_unit_code locn_code,short_desc locn_short_desc from IP_NURSING_UNIT where facility_id = ? union all select referral_code locn_code,long_desc locn_short_desc from am_referral where eff_Status = 'E' and nvl(APPLICABILITY_FOR_DIRECT_ORD,'N')  != 'N'  and 'R' = nvl(?,'R') order by locn_short_desc");changed by uma on 9/28/2007
		dataMap.put("SQL_OR_ORDER_TRACKING_SELECT_LOCATION","Select clinic_code locn_code,short_desc locn_short_desc from op_clinic where  facility_id = ? and 'C' = nvl(?,'C') union all Select nursing_unit_code locn_code,short_desc locn_short_desc from IP_NURSING_UNIT where facility_id = ? and 'W' = nvl(?,'W') union all select referral_code locn_code,long_desc locn_short_desc from am_referral where eff_Status = 'E' and nvl(APPLICABILITY_FOR_DIRECT_ORD,'N')  != 'N'  and 'R' = nvl(?,'R') order by locn_short_desc");
		dataMap.put("SQL_OR_GET_ORDER_LINE_REMARKS","SELECT item_narration,can_line_reason FROM or_order_line WHERE order_id =? AND order_line_num=?");
		dataMap.put("SQL_OR_GET_ORDER_REMARKS","SELECT item_narration,can_line_reason FROM or_order_line WHERE order_id =? AND order_line_status=?");
		
		//

		
		//Added by Prasad on 04/5/07 Begin
		dataMap.put("SQL_OR_MULTI_CONSENT_ORDER_CATALOG_NON_EXIST","SELECT  B.SHORT_DESC ORDER_CATEGORY_DESC,C.SHORT_DESC ORDER_TYPE_DESC,A.SHORT_DESC CATALOG_DESC,A.ORDER_CATALOG_CODE,'N' EXIST_YN FROM OR_ORDER_CATALOG A, OR_ORDER_CATEGORY_LANG_VW B, OR_ORDER_TYPE C WHERE B.LANGUAGE_ID = ? AND A.ORDER_CATEGORY=NVL(?,A.ORDER_CATEGORY) AND A.ORDER_TYPE_CODE =NVL(?, A.ORDER_TYPE_CODE) AND UPPER(A.SHORT_DESC) LIKE UPPER(?) AND (A.CONSENT_FORM_LIST ='V' OR NVL(NUM_OF_CONSENT_REQ_BO,0)+NVL(NUM_OF_CONSENT_REQ_BR,0) >1) AND  A.EFF_STATUS ='E' AND B.ORDER_CATEGORY = A.ORDER_CATEGORY  AND C.ORDER_CATEGORY=A.ORDER_CATEGORY AND C.ORDER_TYPE_CODE = A.ORDER_TYPE_CODE  AND NOT EXISTS (SELECT 'Y' FROM OR_CATALOG_CONSENT_DTL WHERE ORDER_CATALOG_CODE = A.ORDER_CATALOG_CODE AND ROWNUM=1) ORDER BY 1,2,3");
		dataMap.put("SQL_OR_MULTI_CONSENT_ORDER_CATALOG","SELECT B.SHORT_DESC ORDER_CATEGORY_DESC, C.SHORT_DESC ORDER_TYPE_DESC,  A.SHORT_DESC CATALOG_DESC,A.ORDER_CATALOG_CODE,NVL((SELECT 'Y' FROM OR_CATALOG_CONSENT_DTL WHERE ORDER_CATALOG_CODE=A.ORDER_CATALOG_CODE AND ROWNUM=1),'N') EXIST_YN FROM OR_ORDER_CATALOG A,OR_ORDER_CATEGORY_LANG_VW B,OR_ORDER_TYPE C WHERE B.LANGUAGE_ID = ? AND A.ORDER_CATEGORY=NVL(?,A.ORDER_CATEGORY) AND A.ORDER_TYPE_CODE =NVL(?, A.ORDER_TYPE_CODE) AND UPPER(A.SHORT_DESC) LIKE UPPER(?) AND (A.CONSENT_FORM_LIST ='V' OR NVL(NUM_OF_CONSENT_REQ_BO,0)+NVL(NUM_OF_CONSENT_REQ_BR,0) >1)  AND  A.EFF_STATUS ='E' AND B.ORDER_CATEGORY = A.ORDER_CATEGORY AND C.ORDER_CATEGORY=A.ORDER_CATEGORY AND C.ORDER_TYPE_CODE=A.ORDER_TYPE_CODE ORDER BY 1,2,3");
		dataMap.put("SQL_OR_MULTI_CONSENT_CATALOG_INFO","SELECT CONSENT_FORM_LIST,NVL(NUM_OF_CONSENT_REQ_BO,0) NUM_OF_CONSENT_REQ_BO, NVL(NUM_OF_CONSENT_REQ_BR,0) NUM_OF_CONSENT_REQ_BR FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=? ");
		dataMap.put("SQL_OR_MULTI_CONSENT_CATALOG_DTLS","SELECT C.CONSENT_FORM_LABEL DESCRIPTION,A.CONSENT_FORM_ID CODE, A.CONSENT_STAGE STAGE, A.DFLT_SELECT_YN DFLT_SELECTED,A.ORDER_SEQUNCE SEQUENCE_ORDER FROM OR_CATALOG_CONSENT_DTL A, OR_CONSENT_FORM_LANG_VW C  WHERE C.LANGUAGE_ID = ? AND A.ORDER_CATALOG_CODE = ? AND A.CONSENT_FORM_ID = C.CONSENT_FORM_ID ORDER BY A.ORDER_SEQUNCE ");
		dataMap.put("SQL_OR_MULTI_CONSENT_CATALOG_HEADER","SELECT order_line_num,order_catalog_code,catalog_synonym,num_of_consent_req_bo,num_of_consent_req_br FROM or_order_line WHERE order_id=?");
	/*********SRR20056-SCF-2009  Id:  3736 *****start***05/06/2008****/

		dataMap.put("SQL_OR_MULTI_CONSENT_CATALOG_LINE","SELECT order_catalog_code,catalog_synonym,num_of_consent_req_bo,num_of_consent_req_br FROM or_order_line WHERE order_id=? and order_line_num=?");
	 /*********SRR20056-SCF-2009  Id:  3736 *****start***05/06/2008****/

		dataMap.put("SQL_OR_MULTI_CONSENT_CATALOG_DEL","DELETE FROM OR_CATALOG_CONSENT_DTL WHERE order_catalog_code = ? ");
		
		dataMap.put("SQL_OR_MULTI_CONSENT_CATALOG_INS","INSERT INTO OR_CATALOG_CONSENT_DTL (ORDER_CATALOG_CODE,CONSENT_FORM_ID,CONSENT_STAGE,DFLT_SELECT_YN,ORDER_SEQUNCE,ADDED_BY_ID,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,ADDED_DATE,MODIFIED_DATE) VALUES (?,?,?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE)");
		//dataMap.put("OR_RESULT_TEMPLATE_EDITOR_JNDI" ,"java:comp/env/ejb/eOR/ORResultTemplateEditor");
		

	 //Hari Qureies 
		dataMap.put( "SQL_OR_MULTI_CONSENT_FORM_DRAFT_INSERT","insert into or_order_line_consent_draft (ORDER_ID, ORDER_LINE_NUM, CONSENT_FORM_ID, CONSENT_STAGE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) values(?,?,?,?,?,sysdate,?,?,?,sysdate,?,?)"); 
		dataMap.put( "SQL_OR_MULTI_CONSENT_FORM_DRAFT_MODIFY","UPDATE OR_ORDER_LINE_CONSENT_DRAFT SET CONSENT_STAGE=?,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?,modified_facility_id=? WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND CONSENT_FORM_ID=?"); //Added by Prasad
		dataMap.put( "SQL_OR_MULTI_CONSENT_FORM_DRAFT_DELETE","DELETE FROM or_order_line_consent_draft  WHERE ORDER_ID = ?  AND ORDER_LINE_NUM = ?"); 
		dataMap.put("SQL_OR_ASSOCIATE_CONSENT","call OR_LOG_CONSENT_INFO (?,?)");
		dataMap.put( "SQL_OR_CATALOG_CONSENT_FORMAT_MULTI_NON_IND","SELECT CONSENT_FORM_LABEL DESCRIPTION,CONSENT_FORM_ID CODE FROM OR_CONSENT_FORM_LANG_VW where LANGUAGE_ID=? AND EFF_STATUS='E' AND CONSENT_TYPE='C' AND CONSENT_FORM_ID LIKE UPPER(?) AND UPPER(CONSENT_FORM_LABEL) LIKE UPPER(?) order by 1");
		dataMap.put( "SQL_OR_MULTI_CONSENT_FIXED","SELECT a.consent_form_id consent_form_id, a.consent_stage consent_stage, consent_form_list, consent_form_label FROM OR_ORDER_CATALOG a, OR_CONSENT_FORM_LANG_VW c WHERE a.order_catalog_code = ? AND C.LANGUAGE_ID = ? AND a.consent_form_id = c.consent_form_id");
		//dataMap.put("SQL_OR_MULTI_CONSENT_FORM_NOT_ASSOCIATED_LINK","SELECT   B.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,D.CONSENT_FORM_ID CONSENT_FORM_ID,nvl(D.CONSENT_STAGE,b.consent_stage) CONSENT_STAGE,'Y' DFLT_SELECT_YN,'1' ORDER_SEQUNCE,NVL (NUM_OF_CONSENT_REQ_BO, 0) NUM_OF_CONSENT_REQ_BO,NVL (NUM_OF_CONSENT_REQ_BR, 0) NUM_OF_CONSENT_REQ_BR,CONSENT_FORM_LIST, or_get_desc.OR_CONSENT_FORM(c.CONSENT_FORM_ID,?,'2') CONSENT_FORM_LABEL,'Y' CONFIRMED_YN,(SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL E WHERE E.ORDER_ID = ? AND E.ORDER_LINE_NUM = ? AND E.FORM_ID = C.CONSENT_FORM_ID AND E.TYPE = 'C' AND ROWNUM <= 1) RECORDED_YN, C.indexed_yn ELIGIBLE_YN FROM OR_ORDER_CATALOG B, OR_CONSENT_FORM C, OR_ORDER_LINE_CONSENT_DRAFT D WHERE B.ORDER_CATALOG_CODE = ? AND D.ORDER_ID = ? AND D.ORDER_LINE_NUM = ? AND D.CONSENT_FORM_ID = C.CONSENT_FORM_ID ORDER BY CONSENT_STAGE, ORDER_SEQUNCE");
		//dataMap.put("SQL_OR_MULTI_CONSENT_LIST_DTLS","SELECT a.CONSENT_FORM_LIST, NVL(a.NUM_OF_CONSENT_REQ_BO,0)NUM_OF_CONSENT_REQ_BO, NVL(a.NUM_OF_CONSENT_REQ_BR,0) NUM_OF_CONSENT_REQ_BR ,a.CONSENT_REQD_YN,a.CONSENT_FORM_ID CONSENT_FORM_ID,DECODE(a.CONSENT_STAGE,'A','Release','R','Registration') CONSENT_STAGE,or_get_desc.OR_CONSENT_FORM(b.CONSENT_FORM_ID,?,'2') consent_form_label, b.indexed_yn indexed_yn FROM OR_ORDER_CATALOG A, OR_CONSENT_FORM b  WHERE b.consent_form_id(+) = a.consent_form_id and ORDER_CATALOG_CODE = ? ");

		// Ends Function 1
	// Uma's Qry
	dataMap.put( "SQL_OR_CONSENT_FORM_RECORDED_CONTENT","SELECT  FORM_CONTENT FROM OR_CONSENT_REF_HDR A,  OR_CONSENT_REF_DTL B WHERE A.CONSENT_REF_ID = B.CONSENT_REF_ID AND A.TYPE = B.TYPE AND  A.FORM_ID= B.FORM_ID AND A.CONSENT_REF_ID= B.CONSENT_REF_ID AND B.CONSENT_REF_ID = ? AND ORDER_ID= ? AND ORDER_LINE_NUM= ?  AND B.FORM_ID = ? AND B.TYPE = 'C'"); 
		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_LINK","SELECT A.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,A.CONSENT_FORM_ID CONSENT_FORM_ID, A.CONSENT_STAGE CONSENT_STAGE,DFLT_SELECT_YN, ORDER_SEQUNCE, NVL(NUM_OF_CONSENT_REQ_BO,0)NUM_OF_CONSENT_REQ_BO,NVL(NUM_OF_CONSENT_REQ_BR,0) NUM_OF_CONSENT_REQ_BR,CONSENT_FORM_LIST, or_get_desc.OR_CONSENT_FORM(A.CONSENT_FORM_ID,?,'1') CONSENT_FORM_LABEL,(SELECT d.CONSENT_STAGE  FROM  OR_ORDER_LINE_CONSENT_DRAFT D WHERE D.ORDER_ID=? AND D.ORDER_LINE_NUM=? AND D.CONSENT_FORM_ID = A.CONSENT_FORM_ID) CONFIRMED_YN, (SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL e WHERE e.order_id = ? AND e.order_line_num =? AND e.form_id = a.consent_form_id AND e.TYPE = 'C' AND ROWNUM <= 1) recorded_yn, C.indexed_yn ELIGIBLE_YN FROM OR_CATALOG_CONSENT_DTL A, OR_ORDER_CATALOG B, OR_CONSENT_FORM C WHERE A.ORDER_CATALOG_CODE = ? AND A.ORDER_CATALOG_CODE = B.ORDER_CATALOG_CODE AND A.CONSENT_FORM_ID = C.CONSENT_FORM_ID ORDER BY CONSENT_STAGE, ORDER_SEQUNCE ");

		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_LINK_DTL","SELECT d.CONSENT_FORM_ID CONSENT_FORM_ID,B.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,D.CONSENT_STAGE CONSENT_STAGE,NVL(e.NUM_OF_CONSENT_REQ_BO,0)NUM_OF_CONSENT_REQ_BO,NVL(e.NUM_OF_CONSENT_REQ_BR,0) NUM_OF_CONSENT_REQ_BR,CONSENT_FORM_LIST,or_get_desc.OR_CONSENT_FORM(d.CONSENT_FORM_ID,?,'1') CONSENT_FORM_LABEL,(SELECT d.CONSENT_STAGE  FROM  OR_ORDER_LINE_CONSENT_DRAFT D WHERE D.ORDER_ID=? AND D.ORDER_LINE_NUM=? and D.CONSENT_FORM_ID = c.CONSENT_FORM_ID) CONFIRMED_YN,(SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL F WHERE F.order_id = E.ORDER_ID AND F.order_line_num =E.order_line_num AND F.form_id =D.consent_form_id AND F.TYPE = 'C' AND ROWNUM <= 1) recorded_yn, C.indexed_yn ELIGIBLE_YN FROM OR_ORDER_CATALOG B,OR_CONSENT_FORM C,OR_ORDER_LINE_CONSENT_DRAFT  D,OR_ORDER_LINE E WHERE E.ORDER_ID	=? AND E.ORDER_LINE_NUM	=? AND D.ORDER_ID	=E.ORDER_ID AND D.ORDER_LINE_NUM	=E.ORDER_LINE_NUM AND D.CONSENT_FORM_ID = c.CONSENT_FORM_ID AND b.order_catalog_code=? ORDER BY D.CONSENT_STAGE");

		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_LINK_FOR_NEW","SELECT    CONSENT_FORM_ID, CONSENT_STAGE,'Y' DFLT_SELECT_YN, NVL(E.NUM_OF_CONSENT_REQ_BO,0)NUM_OF_CONSENT_REQ_BO, NVL(E.NUM_OF_CONSENT_REQ_BR,0)NUM_OF_CONSENT_REQ_BR, 'Y' PRSENT_IN_DRAFT_YN,or_get_desc.OR_CONSENT_FORM(D.CONSENT_FORM_ID,?,'1') CONSENT_FORM_LABEL,(SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL F WHERE F.order_id = E.ORDER_ID AND F.order_line_num =E.order_line_num AND F.form_id = D.consent_form_id AND F.TYPE = 'C' AND ROWNUM <= 1) RECORD_YN FROM	OR_ORDER_LINE_CONSENT_DRAFT  D,OR_ORDER_LINE E WHERE E.ORDER_ID	=? AND E.ORDER_LINE_NUM	=? AND D.ORDER_ID	=E.ORDER_ID AND D.ORDER_LINE_NUM	=E.ORDER_LINE_NUM UNION ALL SELECT    A.CONSENT_FORM_ID, A.CONSENT_STAGE  CONSENT_STAGE, NVL((SELECT 'N' FROM or_order_line_consent_draft WHERE order_id = ? AND order_line_num = ? AND ROWNUM=1 ),a.dflt_select_yn)   DFLT_SELECT_YN, NVL(B.NUM_OF_CONSENT_REQ_BO,0)NUM_OF_CONSENT_REQ_BO, NVL(B.NUM_OF_CONSENT_REQ_BR,0)NUM_OF_CONSENT_REQ_BR,'N' PRSENT_IN_DRAFT_YN,or_get_desc.OR_CONSENT_FORM(A.CONSENT_FORM_ID,?,'1') CONSENT_FORM_LABEL,(SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL F WHERE F.order_id = ? AND F.order_line_num =? AND F.form_id = A.consent_form_id AND F.TYPE = 'C' AND ROWNUM <= 1) RECORD_YN FROM	OR_CATALOG_CONSENT_DTL A, or_order_catalog B WHERE A.ORDER_CATALOG_CODE = ? AND (b.CONSENT_FORM_LIST='V' OR nvl(B.NUM_OF_CONSENT_REQ_BO,0)+NVL(B.NUM_OF_CONSENT_REQ_BR,0)>1 ) AND NOT EXISTS ( SELECT 1 FROM OR_ORDER_LINE_CONSENT_DRAFT WHERE ORDER_ID	=? AND ORDER_LINE_NUM	=? AND CONSENT_FORM_ID=A.CONSENT_FORM_ID) AND B.ORDER_CATALOG_CODE=A.ORDER_CATALOG_CODE UNION ALL SELECT    CONSENT_FORM_ID, DECODE(NVL(A.NUM_OF_CONSENT_REQ_BO,0),1,'A','R')  CONSENT_STAGE, NVL((SELECT 'N' FROM OR_CONSENT_REF_DTL WHERE ORDER_CATALOG_CODE = A.ORDER_CATALOG_CODE AND ROWNUM=1 ),'Y')  DFLT_SELECT_YN, NVL(A.NUM_OF_CONSENT_REQ_BO,0)NUM_OF_CONSENT_REQ_BO, NVL(A.NUM_OF_CONSENT_REQ_BR,0)NUM_OF_CONSENT_REQ_BR,'N' PRSENT_IN_DRAFT_YN,or_get_desc.OR_CONSENT_FORM(A.CONSENT_FORM_ID,?,'1') CONSENT_FORM_LABEL,(SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL F WHERE F.order_id = ? AND F.order_line_num =? AND F.form_id = A.consent_form_id AND F.TYPE = 'C' AND ROWNUM <= 1) RECORD_YN FROM	OR_ORDER_CATALOG A WHERE A.ORDER_CATALOG_CODE = ? and ( a.CONSENT_FORM_LIST='F' AND nvl(A.NUM_OF_CONSENT_REQ_BO,0)+NVL(A.NUM_OF_CONSENT_REQ_BR,0)=1) AND A.consent_form_id IS NOT NULL AND NOT EXISTS ( SELECT 1 FROM OR_ORDER_LINE_CONSENT_DRAFT WHERE ORDER_ID	=? AND ORDER_LINE_NUM	=? AND CONSENT_FORM_ID=A.CONSENT_FORM_ID) "); //Added by prasad
		/*********SRR20056-SCF-2009  Id:  3736 *****start***05/06/2008****/
		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_DRAFT_VALUES", "SELECT  CONSENT_FORM_ID,CONSENT_STAGE, NVL(b.NUM_OF_CONSENT_REQ_BO,0) NUM_OF_CONSENT_REQ_BO, NVL(b.NUM_OF_CONSENT_REQ_BR,0) NUM_OF_CONSENT_REQ_BR,or_get_desc.OR_CONSENT_FORM(a.CONSENT_FORM_ID,?,'1') CONSENT_FORM_LABEL,(SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL c WHERE c.order_id = b.ORDER_ID AND c.order_line_num =b.order_line_num AND c.form_id = a.consent_form_id AND c.TYPE = 'C' AND ROWNUM <= 1) RECORD_YN FROM OR_ORDER_LINE_CONSENT_DRAFT a,OR_ORDER_LINE b WHERE b.ORDER_ID=? AND b.ORDER_LINE_NUM=? AND a.ORDER_ID=b.ORDER_ID AND a.ORDER_LINE_NUM=b.ORDER_LINE_NUM"); 
		/*********SRR20056-SCF-2009  Id:  3736 *****end***05/06/2008****/

		dataMap.put("SQL_REPRINT_CONSENT_FOR_EXISTING_ORDER", "SELECT consent_ref_id,(select APPL_USER_NAME from sm_appl_user where APPL_USER_ID=a.Added_by_id) Added_by_id,to_char(Added_date,'dd/mm/yyyy hh24:mi:ss') Added_date, (select APPL_USER_NAME from sm_appl_user where APPL_USER_ID=a.MODIFIED_BY_ID) MODIFIED_BY_ID,to_char(modified_date,'dd/mm/yyyy hh24:mi:ss') modified_date FROM OR_CONSENT_REF_DTL a WHERE order_id=? AND order_line_num=? AND form_id=?"); //Added by prasad
		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_LIST","SELECT CONSENT_FORM_LIST FROM or_order_catalog WHERE order_catalog_code=?");
		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_DRAFT_DELETE_FORM","DELETE or_order_line_consent_draft WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND CONSENT_FORM_ID=?") ;
		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_DRAFT_AVAILABLE","SELECT COUNT(*) FROM or_order_line_consent_draft WHERE ORDER_ID=? AND ORDER_LINE_NUM=? AND CONSENT_FORM_ID=? ") ;
		dataMap.put("SQL_OR_MULTI_CONSENT_FORM_NOT_ASSOCIATED_LINK","SELECT   B.ORDER_CATALOG_CODE ORDER_CATALOG_CODE,D.CONSENT_FORM_ID CONSENT_FORM_ID,nvl(D.CONSENT_STAGE,b.consent_stage) CONSENT_STAGE,'Y' DFLT_SELECT_YN,'1' ORDER_SEQUNCE,NVL (NUM_OF_CONSENT_REQ_BO, 0) NUM_OF_CONSENT_REQ_BO,NVL (NUM_OF_CONSENT_REQ_BR, 0) NUM_OF_CONSENT_REQ_BR,CONSENT_FORM_LIST, or_get_desc.OR_CONSENT_FORM(C.CONSENT_FORM_ID,?,'1') CONSENT_FORM_LABEL,'Y' CONFIRMED_YN,(SELECT CONSENT_REF_ID FROM OR_CONSENT_REF_DTL E WHERE E.ORDER_ID = ? AND E.ORDER_LINE_NUM = ? AND E.FORM_ID = C.CONSENT_FORM_ID AND E.TYPE = 'C' AND ROWNUM <= 1) RECORDED_YN, C.indexed_yn ELIGIBLE_YN FROM OR_ORDER_CATALOG B, OR_CONSENT_FORM C, OR_ORDER_LINE_CONSENT_DRAFT D WHERE B.ORDER_CATALOG_CODE = ? AND D.ORDER_ID = ? AND D.ORDER_LINE_NUM = ? AND D.CONSENT_FORM_ID = C.CONSENT_FORM_ID ORDER BY CONSENT_STAGE, ORDER_SEQUNCE");
		dataMap.put("SQL_OR_MULTI_CONSENT_LIST_DTLS","SELECT a.CONSENT_FORM_LIST, NVL(a.NUM_OF_CONSENT_REQ_BO,0) NUM_OF_CONSENT_REQ_BO, NVL(a.NUM_OF_CONSENT_REQ_BR,0) NUM_OF_CONSENT_REQ_BR ,a.CONSENT_REQD_YN,a.CONSENT_FORM_ID CONSENT_FORM_ID,DECODE(a.CONSENT_STAGE,'A','Release','R','Registration') CONSENT_STAGE,or_get_desc.OR_CONSENT_FORM(b.CONSENT_FORM_ID,?,'1') consent_form_label, b.indexed_yn indexed_yn FROM OR_ORDER_CATALOG A, OR_CONSENT_FORM b  WHERE b.consent_form_id(+) = a.consent_form_id and ORDER_CATALOG_CODE = ? ");
		dataMap.put("SQL_OR_MULTI_CONSENT_SELECT_CONSENT_FORM_ID","select b.order_catalog_code order_catalog_code,or_get_desc.OR_ORDER_CATALOG(b.order_catalog_code,?,'2')  order_catalog_desc,c.consent_format consent_format ,or_get_desc.OR_CONSENT_FORM(c.CONSENT_FORM_ID,?,'1') consent_form_label from or_order_line a,or_order_catalog b, or_consent_form c where  a.order_id= ? and  a.order_line_num= ? and c.consent_form_id= ? and  b.order_catalog_code =a.order_catalog_code ");
		dataMap.put( "SQL_OR_MULTI_CONSENT_REF_HDR_INSERT","INSERT INTO OR_CONSENT_REF_HDR ( CONSENT_REF_ID, TYPE, FORM_ID, FORM_CONTENT, GIVEN_PERSON_TYPE, GIVEN_PERSON_NAME, GIVEN_RELATIONSHIP_CODE, TAKEN_PRACT_ID, TAKEN_DATE_TIME, REMARKS, PATIENT_ID, FACILITY_ID, ENCOUNTER_ID, PATIENT_CLASS, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ) VALUES ( ?, ?, ?, empty_clob() , ?, ?, ?, ?, to_date(?,'dd/mm/yyyy hh24:mi'), ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ? )"); 
		dataMap.put( "SQL_OR_MULTI_CONSENT_REF_DTL_INSERT","INSERT INTO OR_CONSENT_REF_DTL ( CONSENT_REF_ID, ORDER_ID, ORDER_LINE_NUM, TYPE, FORM_ID, ORDER_CATALOG_CODE, ORDER_CATALOG_DESC, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID ,CONSENT_STAGE ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?,  SYSDATE, ?, ?, ?,  SYSDATE, ?, ?, ?)"); 
		dataMap.put( "SQL_OR_MULTI_CONSENT_SEQ_NO","SELECT OR_CONSENT_REF_SEQ.NEXTVAL FROM DUAL"); 
		dataMap.put( "SQL_OR_MULTI_CONSENT_CLOB_UPDATE","SELECT FORM_CONTENT FROM OR_CONSENT_REF_HDR WHERE patient_id=(?) AND CONSENT_REF_ID=(?) AND FORM_ID=(?)"); 
		dataMap.put( "SQL_OR_MULTI_CONSENT_WITH_CONSENT_STATUS","SELECT   NVL (a.num_of_consent_req_bo, 0) num_of_consent_req_bo, NVL (a.num_of_consent_req_br, 0) num_of_consent_req_br, SUM (DECODE (consent_stage, 'R', 0, 1)) consents_recorded_bo, SUM (DECODE (consent_stage, 'R', 1, 0)) consents_recorded_br FROM OR_ORDER_LINE a, OR_CONSENT_REF_DTL b WHERE a.order_id = ? AND a.order_line_num = ? AND a.order_catalog_code = ? AND b.order_catalog_code = a.order_catalog_code AND b.order_id = a.order_id AND b.order_line_num = a.order_line_num AND b.TYPE = 'C' GROUP BY NVL (a.num_of_consent_req_bo, 0), NVL (a.num_of_consent_req_br, 0)"); 
		dataMap.put( "SQL_OR_MULTI_CONSENT_GET_STAGE","SELECT consent_stage FROM OR_ORDER_LINE_CONSENT_DRAFT WHERE order_id = ? AND order_line_num = ? AND consent_form_id = ? "); 
		dataMap.put( "SQL_OR_MULTI_CONSENT_GET_STAGE2","SELECT consent_stage  FROM OR_CATALOG_CONSENT_DTL WHERE order_catalog_code = ? AND consent_form_id = ?"); 
		dataMap.put( "SQL_OR_CONSENT_ORDER_UPDATE_ORDER_LINE_STAGE","UPDATE or_order_line SET order_line_status = (?),modified_by_id =(?),modified_date  = sysdate,modified_at_ws_no=(?),modified_facility_id=(?) WHERE order_id =(?) AND ORDER_LINE_NUM=?"); 
		dataMap.put( "SQL_OR_CONSENT_LINK_EXISTING_CONSENT","SELECT a.consent_ref_id consent_ref_id, order_id, order_line_num, a.form_id form_id, order_catalog_code, order_catalog_desc, to_char(taken_date_time,'dd/mm/yyyy') taken_date_time FROM or_consent_ref_hdr a, or_consent_ref_dtl b WHERE a.patient_id = ? AND a.encounter_id = DECODE( 0, ?, a.encounter_id, ?) AND a.facility_id = ? AND a.form_id = ? AND a.TYPE = 'C' AND a.taken_date_time BETWEEN TO_DATE (NVL ( ? , '01/01/1000'),'dd/mm/yyyy') AND TO_DATE (NVL ( ? ,'31/12/9999'),'dd/mm/yyyy')+ .999 AND b.consent_ref_id = a.consent_ref_id ORDER BY 1"); 
		dataMap.put( "SQL_OR_CONSENT_RECORD_EXISTING_CONSENT","INSERT INTO OR_CONSENT_REF_DTL ( CONSENT_REF_ID, ORDER_ID, ORDER_LINE_NUM, TYPE, FORM_ID, ORDER_CATALOG_CODE, ORDER_CATALOG_DESC, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID, CONSENT_STAGE )(select CONSENT_REF_ID,?,?,TYPE,FORM_ID, ?, ?, ?, SYSDATE, ?, ?, ?,  SYSDATE, ?, ?, CONSENT_STAGE from OR_CONSENT_REF_DTL where CONSENT_REF_ID = ? and ORDER_ID = ? and ORDER_LINE_NUM = ? )"); 
		dataMap.put( "SQL_OR_CONSENT_PRACT_PERFORM_CONSENT","SELECT COUNT (*) count FROM or_pract_for_consent  WHERE practitioner_id = ? AND consent_form_id = ?"); 
		dataMap.put( "SQL_OR_CONSENT_DRAFT_AMEND_DELETE","DELETE FROM OR_ORDER_LINE_CONSENT_DRAFT  WHERE order_id = ? AND order_line_num = ?");
		dataMap.put( "SQL_OR_MULTI_CONSENT_ORDER_LINE_CONSENT_STAGE_UPDATE","update or_order_line set ORD_CONSENT_STAGE = ? , modified_by_id =?,modified_date  = sysdate,modified_at_ws_no=?,modified_facility_id=? where order_id = ? and order_line_num=?"); 
		dataMap.put("SQL_OR_ORDER_GET_STATUS_CODE" , "SELECT OR_GET_ORDER_STATUS_CODE( ? ) ORDER_STATUS_CODE FROM dual");
		
		// Queries Added by Murthy - 04-05-2007 - Start
		dataMap.put( "SQL_OR_CATALOG_CONSENT_FORMAT_MULTI","SELECT CONSENT_FORM_LABEL DESCRIPTION,CONSENT_FORM_ID CODE FROM OR_CONSENT_FORM_LANG_VW where LANGUAGE_ID=? AND INDEXED_YN='Y' AND EFF_STATUS='E' AND CONSENT_TYPE='C' AND CONSENT_FORM_ID LIKE UPPER(?) AND UPPER(CONSENT_FORM_LABEL) LIKE UPPER(?) order by 1");
		dataMap.put( "SQL_PRACT_FOR_CONSENT_DB_REC","SELECT A.CONSENT_FORM_ID CODE, B.CONSENT_FORM_LABEL LONG_DESC FROM OR_PRACT_FOR_CONSENT A,OR_CONSENT_FORM_LANG_VW B WHERE B.LANGUAGE_ID=? AND A.CONSENT_FORM_ID = B.CONSENT_FORM_ID AND A.PRACTITIONER_ID = ?");
		dataMap.put( "SQL_CONSENT_FOR_PRACT_DB_REC","SELECT A.PRACTITIONER_ID CODE, B.PRACTITIONER_NAME LONG_DESC FROM OR_PRACT_FOR_CONSENT A,AM_PRACTITIONER_LANG_VW B WHERE B.LANGUAGE_ID=? AND A.PRACTITIONER_ID = B.PRACTITIONER_ID AND A.CONSENT_FORM_ID = ?");
		dataMap.put( "SQL_OR_PRACT_DESC","SELECT CONSENT_FORM_LABEL long_desc,CONSENT_FORM_ID code,NVL((SELECT 'Y' FROM OR_PRACT_FOR_CONSENT WHERE PRACTITIONER_ID=? AND CONSENT_FORM_ID=OR_CONSENT_FORM_LANG_VW.CONSENT_FORM_ID),'N') SELECT_YN FROM OR_CONSENT_FORM_LANG_VW where LANGUAGE_ID = ? AND  EFF_STATUS='E' and CONSENT_TYPE='C' and INDEXED_YN='Y' AND UPPER(CONSENT_FORM_LABEL) like ? order by 1");
		dataMap.put( "SQL_OR_PRACT_DESC_OTH","SELECT CONSENT_FORM_LABEL long_desc,CONSENT_FORM_ID code,NVL((SELECT 'Y' FROM OR_PRACT_FOR_CONSENT WHERE PRACTITIONER_ID=? AND CONSENT_FORM_ID=OR_CONSENT_FORM_LANG_VW.CONSENT_FORM_ID),'N') SELECT_YN FROM OR_CONSENT_FORM_LANG_VW where LANGUAGE_ID = ? AND EFF_STATUS='E' and CONSENT_TYPE='C' and INDEXED_YN='Y' AND UPPER(CONSENT_FORM_LABEL) NOT BETWEEN 'A' AND 'ZZ' ORDER BY 1");
		dataMap.put( "SQL_OR_CONSENT_DESC","SELECT practitioner_id code,practitioner_name long_desc,NVL((SELECT 'Y' FROM OR_PRACT_FOR_CONSENT WHERE PRACTITIONER_ID=AM_PRACTITIONER_LANG_VW.PRACTITIONER_ID AND CONSENT_FORM_ID=?),'N') SELECT_YN FROM AM_PRACTITIONER_LANG_VW where LANGUAGE_ID = ? AND UPPER(practitioner_name) like ? order by 2");
		dataMap.put( "SQL_OR_CONSENT_DESC_OTH","SELECT practitioner_id code,practitioner_name long_desc,NVL((SELECT 'Y' FROM OR_PRACT_FOR_CONSENT WHERE PRACTITIONER_ID=AM_PRACTITIONER_LANG_VW.PRACTITIONER_ID AND CONSENT_FORM_ID=?),'N') SELECT_YN FROM AM_PRACTITIONER_LANG_VW where LANGUAGE_ID = ? AND UPPER(practitioner_name) NOT BETWEEN 'A' AND 'ZZ' ORDER BY 2");
		dataMap.put( "SQL_OR_PRACT_FOR_CONSENT_DELETE","DELETE FROM OR_PRACT_FOR_CONSENT WHERE PRACTITIONER_ID = ? AND CONSENT_FORM_ID = ?");
		dataMap.put( "SQL_OR_PRACT_FOR_CONSENT_INSERT","INSERT INTO OR_PRACT_FOR_CONSENT (PRACTITIONER_ID,CONSENT_FORM_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");

		dataMap.put("SQL_OR_USER_FOR_REVIEW_PRAC_LOOKUP" , "SELECT PRACTITIONER_ID CODE,PRACTITIONER_NAME DESCRIPTION FROM AM_PRACTITIONER_LANG_VW WHERE LANGUAGE_ID = ? AND UPPER(PRACTITIONER_ID) LIKE UPPER(?) AND UPPER(PRACTITIONER_NAME) LIKE  UPPER(?)"); // Copeid from OrRepository to add language id
		// Queries Added by Murthy - 04-05-2007 - End

		dataMap.put("SQL_OR_ORDER_CATEGORY_SELECT","SELECT ORDER_CATEGORY,LONG_DESC,SHORT_DESC,CLIN_CMTS_REQD_YN,EXT_APPL_ACCESSION_GEN_YN, MULTI_PAT_RESULT_APPL_YN,PREFERRED_VIEW_RESULT_YN FROM OR_ORDER_CATEGORY order by ORDER_CATEGORY ");
		dataMap.put("SQL_OR_ORDER_CATEGORY_UPDATE","UPDATE OR_ORDER_CATEGORY SET SHORT_DESC=? , LONG_DESC=?,CLIN_CMTS_REQD_YN=?,EXT_APPL_ACCESSION_GEN_YN=?,MULTI_PAT_RESULT_APPL_YN =?,PREFERRED_VIEW_RESULT_YN=?  WHERE ORDER_CATEGORY=?");

		dataMap.put("SQL_OR_REPRINT_CONSENT_FOR_ORDER","SELECT A.FORM_ID FORM_ID, OR_GET_DESC.OR_CONSENT_FORM(A.FORM_ID,?,'1')  FORM_LABEL,A.CONSENT_REF_ID CONSENT_REF_ID FROM OR_CONSENT_REF_DTL A, OR_CONSENT_REF_HDR B WHERE A.ORDER_ID = ? AND A.ORDER_LINE_NUM = ? AND A.ORDER_CATALOG_CODE = ? AND A.TYPE = 'C' AND B.CONSENT_REF_ID = A.CONSENT_REF_ID AND B.FORM_ID = A.FORM_ID AND DBMS_LOB.GETLENGTH (B.FORM_CONTENT) > 0 ORDER BY A.CONSENT_REF_ID");

		//SpecimenForOrderable   added by Hari  on 18/06/07
		dataMap.put("SQL_OR_SPECIMEN_FOR_ORDERABLE_CATALOG_SELECT","SELECT order_catalog_code code,short_desc description FROM or_order_catalog where order_category ='LB' and eff_status='E' and upper(order_catalog_code) like upper(?) and upper(short_desc) like upper(?) order by 1  "); 
		dataMap.put("SQL_OR_ALPHANUMERIC_DESC"," SELECT KEY_REF,ALPHANUM_VALUE FROM  OR_ORDER_FIELD_REF_VALUES  WHERE ORDER_CATEGORY ='LB'  AND FIELD_MNEMONIC='SPECIMEN_TYPE'  AND UPPER(alphanum_value) LIKE UPPER (?) "); 
		dataMap.put("SQL_OR_ALPHANUMERIC_DESC_OTH"," SELECT KEY_REF,ALPHANUM_VALUE  FROM  OR_ORDER_FIELD_REF_VALUES  WHERE ORDER_CATEGORY ='LB'  AND FIELD_MNEMONIC='SPECIMEN_TYPE' AND UPPER(alphanum_value) NOT BETWEEN UPPER('A%') AND UPPER('_Z%') ORDER BY 2"); 
		dataMap.put("SQL_OR_SPECIMEN_FOR_ORDERABLE_INSERT"," INSERT INTO OR_SPECIMEN_FOR_ORDERABLE (order_catalog_code, speciment_key_ref,DEFAULT_YN, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?, ?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_OR_SPECIMEN_FOR_ORDERABLE_DELETE", "DELETE FROM OR_SPECIMEN_FOR_ORDERABLE WHERE SPECIMENT_KEY_REF = ? AND ORDER_CATALOG_CODE = ?");
	    dataMap.put("SQL_SPECIMEN_FOR_ORDERABLE_DB_REC", "SELECT A.SPECIMENT_KEY_REF KEY_REF, B.ALPHANUM_VALUE  ALPHANUM_VALUE,A.DEFAULT_YN  FROM OR_SPECIMEN_FOR_ORDERABLE A, OR_ORDER_FIELD_REF_VALUES B WHERE  A.SPECIMENT_KEY_REF = B.KEY_REF AND A.ORDER_CATALOG_CODE = ?");
		dataMap.put("SQL_OR_SPECIMEN_FOR_ORDERABLE_UPDATE_DEFAULT_YN", "UPDATE   OR_SPECIMEN_FOR_ORDERABLE  SET  DEFAULT_YN=? WHERE  ORDER_CATALOG_CODE=? AND SPECIMENT_KEY_REF=?");
   //SpecimenForOrderable ends Here

	   //AssignPrivilegeGroup   added by Hari  on 02/07/07

	   dataMap.put("SQL_OR_ASSIGN_PRIVILEGE_GROUP_SELECT", "Select PRIV_GRP_ID code, PRIV_GRP_DESC description from or_priv_group where  upper( PRIV_GRP_ID) like upper(?) and  upper( PRIV_GRP_DESC) like upper(?) "); 
	   dataMap.put("SQL_OR_ASSIGN_PRIVILEGE_RESP_SELECT", " Select RESP_ID code, RESP_NAME description from sm_resp where eff_status='E' and upper( RESP_ID) like upper(?) and  upper( RESP_NAME) like upper(?)");
       dataMap.put("SQL_OR_ASSIGN_PRIVILEGE_PRACTIONER_SELECT", "Select  PRACTITIONER_ID code, PRACTITIONER_NAME description from AM_PRACTITIONER where eff_status='E' and upper( PRACTITIONER_ID) like upper(?) and  upper( PRACTITIONER_NAME) like upper(?)");
	   dataMap.put("SQL_OR_ASSIGN_PRIV_GROUP_RESP_SELECT", "SELECT RESP_ID,RESP_NAME,NVL((SELECT 'Y' FROM OR_PRIV_APPLICABLITY WHERE PRIV_GRP_ID=?  AND APPL_LEVEL='R' AND APPL_MEMB_REF=RESP_ID),'N') FROM SM_RESP where eff_status='E' and upper(resp_name) like upper(?)");
       dataMap.put("SQL_OR_ASSIGN_PRIV_GROUP_RESP_SELECT_OTH", "SELECT RESP_ID,RESP_NAME,NVL((SELECT 'Y' FROM OR_PRIV_APPLICABLITY WHERE PRIV_GRP_ID=?  AND APPL_LEVEL='R' AND APPL_MEMB_REF=RESP_ID),'N') FROM SM_RESP where eff_status='E' and upper(resp_name)  NOT BETWEEN UPPER('A%') AND UPPER('_Z%') ORDER BY 2");
	   dataMap.put("SQL_OR_ASSIGN_PRIV_GROUP_PRACT_SELECT", "SELECT PRACTITIONER_ID,SHORT_NAME,NVL((SELECT 'Y'  FROM OR_PRIV_APPLICABLITY WHERE PRIV_GRP_ID=?  AND APPL_LEVEL='P' AND APPL_MEMB_REF=PRACTITIONER_ID),'N') FROM AM_PRACTITIONER where eff_status='E' and upper(SHORT_NAME) like upper(?)");
	   dataMap.put("SQL_OR_ASSIGN_PRIV_GROUP_PRACT_SELECT_OTH", "SELECT PRACTITIONER_ID,SHORT_NAME,NVL((SELECT 'Y'  FROM OR_PRIV_APPLICABLITY WHERE PRIV_GRP_ID=?  AND APPL_LEVEL='P' AND APPL_MEMB_REF=PRACTITIONER_ID),'N') FROM AM_PRACTITIONER where eff_status='E' and upper(SHORT_NAME) NOT BETWEEN UPPER('A%') AND UPPER('_Z%') ORDER BY 2");
	   dataMap.put("SQL_OR_ASSIGN_PRIVILEGE_GROUP_INSERT", "INSERT INTO OR_PRIV_APPLICABLITY (PRIV_GRP_ID, APPL_LEVEL,APPL_MEMB_REF, added_by_id, added_date, added_at_ws_no, added_facility_id, modified_by_id, modified_date, modified_at_ws_no, modified_facility_id) VALUES (?, ?,?, ?, SYSDATE, ?, ? , ?, SYSDATE, ?, ?)");
	   dataMap.put("SQL_OR_PRIVILEGE_GROUP_CODE_SELECT", " select  a.PRIV_GRP_ID PRIV_GRP_ID, b.PRIV_GRP_DESC PRIV_GRP_DESC from  OR_PRIV_APPLICABLITY  a,OR_Priv_Group b where a.PRIV_GRP_ID=b.PRIV_GRP_ID   and a.APPL_MEMB_REF=?");
	   dataMap.put("SQL_OR_PRIVILEGE_GROUP_CODE_UPDATE", "update  OR_PRIV_APPLICABLITY  set  PRIV_GRP_ID=?  where APPL_MEMB_REF=?");
	   dataMap.put("SQL_ASSIGN_PRIVILEGE_GROUP_DB_REC1", "select  a.APPL_MEMB_REF   APPL_MEMB_REF, b.RESP_NAME description from OR_PRIV_APPLICABLITY  a ,SM_RESP b where a. PRIV_GRP_ID=?  and a. APPL_LEVEL='R' and  a.APPL_MEMB_REF=b.RESP_ID");
	   dataMap.put("SQL_ASSIGN_PRIVILEGE_GROUP_DB_REC2", "select  a.APPL_MEMB_REF  APPL_MEMB_REF, b.SHORT_NAME description  from OR_PRIV_APPLICABLITY  a ,AM_PRACTITIONER b where a. PRIV_GRP_ID=?  and a. APPL_LEVEL='P' and  a.APPL_MEMB_REF=b.PRACTITIONER_ID");
	   dataMap.put("SQL_OR_ASSIGN_PRIVILEGE_GROUP_DELETE", " DELETE FROM OR_PRIV_APPLICABLITY WHERE  PRIV_GRP_ID= ?  AND  APPL_MEMB_REF = ?");
	   
	   //added By Hari  on 04/08/ 2007 	 For OrderingRuleByPractitionerType Fun
	   dataMap.put("SQL_OR_ORDERING_RULE_BY_PRACTTYPE_GET_PRACT_TYPE", "SELECT PRACT_TYPE CODE, NVL(DESC_USERDEF,DESC_SYSDEF)LONG_DESC FROM AM_PRACT_TYPE WHERE  EFF_STATUS ='E'");
	   //dataMap.put( "SQL_OR_CATALOG_ORDER_CATEGORY","SELECT A.SHORT_DESC,A.ORDER_CATEGORY, NVL(B.PLACE_DEPT_ONLY_YN,'N') PLACE_DEPT_ONLY_YN ,NVL(B.FORCE_AUTH_YN,'N') FORCE_AUTH_YN, NVL(B.FORCE_COSIGN_YN,'N') FORCE_COSIGN_YN	FROM OR_ORDER_CATEGORY A, or_ord_rule_by_pract  B WHERE A.ORDER_CATEGORY !='CS'  AND B.PRACT_TYPE(+) = ?  AND B.ORDER_CATEGORY_CODE(+)=A.ORDER_CATEGORY");
	   dataMap.put( "SQL_OR_CATALOG_ORDER_CATEGORY","SELECT A.SHORT_DESC,A.ORDER_CATEGORY, NVL(B.PLACE_DEPT_ONLY_YN,'N') PLACE_DEPT_ONLY_YN ,NVL(B.FORCE_AUTH_YN,'N') FORCE_AUTH_YN, NVL(B.FORCE_COSIGN_YN,'N') FORCE_COSIGN_YN	FROM OR_ORDER_CATEGORY A, or_ord_rule_by_pract  B WHERE A.ORDER_CATEGORY not in('CS','CN')  AND B.PRACT_TYPE(+) = ?  AND B.ORDER_CATEGORY_CODE(+)=A.ORDER_CATEGORY order by A.SHORT_DESC");
	   dataMap.put( "SQL_OR_ORD_RULE_BY_PRACT_INSERT","INSERT INTO or_ord_rule_by_pract (PRACT_TYPE,ORDER_CATEGORY_CODE,PLACE_DEPT_ONLY_YN,FORCE_AUTH_YN,FORCE_COSIGN_YN, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?,?,?,?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
	   dataMap.put( "SQL_OR_ORD_RULE_BY_PRACT_DELETE","DELETE FROM or_ord_rule_by_pract WHERE PRACT_TYPE = ? ");
	   
	   //added by uma 7/3/2007 for lab_install_check  
	   dataMap.put("OR_GET_INTERFACED_APPL", "SELECT OR_GET_INTERFACED_APPL(?,?,?,?) modname FROM DUAL");
	   dataMap.put("SQL_OR_VIEW_ORDER_GET_ORDER_FORMATS", "SELECT  b.order_type_code order_type_code,b.order_catalog_code order_catalog_code FROM or_order_vw  a,or_order_line b WHERE  a.order_id = b.order_id and b.order_id = ?");
	   dataMap.put("SQL_OR_BT_CHECK_SPECIMEN_VALIDITY", "CALL BT_CHECK_SPECIMEN_VALIDITY(to_date(?,'dd/mm/yyyy hh24:mi'),to_date(?,'dd/mm/yyyy hh24:mi'),?)");
	   dataMap.put("SQL_OR_DONOR_RHESUS", "select RHESUS_FACTOR_CODE rhcode,SHORT_DESC rhdesc from  MR_RHESUS_FACTOR where  EFF_STATUS='E' order by 2");
	   dataMap.put("SQL_OR_DONOR_BLOOD_GROUP", "select BLOOD_GRP bloodcode,SHORT_DESC blooddesc from   MR_BLOOD_GRP where  EFF_STATUS='E' order by 2");
	   dataMap.put("SQL_OR_GET_TRADE_NAME", "SELECT AM_GET_DESC.AM_TRADE_NAME(TRADE_CODE,?,'1') TRADE_NAME FROM OR_ORDER_LINE_PH WHERE ORDER_ID=? AND ORDER_LINE_NUM=?");
 	   dataMap.put("SQL_OR_ORDER_ENTRY_FORMAT_SPECIMEN_LIST_SELECT","SELECT A.KEY_REF,A.alphanum_value,b.DEFAULT_YN FROM or_order_field_ref_values A, OR_SPECIMEN_FOR_ORDERABLE B WHERE order_category = ? and field_mnemonic = ? AND B.ORDER_CATALOG_CODE=? AND B.SPECIMENT_KEY_REF=A.KEY_REF ORDER BY A.seq_num");

	   //Privilege group ---Begins--Anjaneya Prasad
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_INSERT","INSERT INTO OR_PRIV_GROUP  (PRIV_GRP_ID,PRIV_GRP_DESC,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE  ,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID,EFF_STATUS) VALUES (?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?)") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_INSERT_ACCESS_RIGHTS","INSERT INTO OR_PRIV_GROUP_RIGHTS  (PRIV_GRP_ID,PRIV_TYPE,MEMB_REF,MEMB_ID,ACC_PRIV,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO  ,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) VALUES (?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_DUP","SELECT COUNT(*) FROM or_priv_group WHERE PRIV_GRP_ID =? ") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_AVAILABLE","SELECT COUNT(*) FROM OR_PRIV_GROUP_RIGHTS WHERE PRIV_GRP_ID =? AND priv_type =? AND memb_ref=? AND memb_id=? ") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_STATUS","SELECT COUNT(*) FROM OR_PRIV_GROUP_RIGHTS WHERE PRIV_GRP_ID =? AND priv_type=? AND memb_ref =? AND memb_id =? AND ACC_PRIV =?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_DELETE","DELETE OR_PRIV_GROUP_RIGHTS WHERE PRIV_GRP_ID =? AND priv_type =? AND memb_ref=? AND memb_id=? ") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_UPDATE","UPDATE OR_PRIV_GROUP_RIGHTS SET ACC_PRIV=?,modified_by_id=?, modified_date=SYSDATE, modified_at_ws_no=?,modified_facility_id=? WHERE PRIV_GRP_ID =? AND priv_type=? AND memb_ref=? AND memb_id=?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_UPDATE_EFF_STATUS","UPDATE OR_PRIV_GROUP SET EFF_STATUS=? WHERE PRIV_GRP_ID =?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_SEARCH","SELECT PRIV_GRP_ID,PRIV_GRP_DESC,EFF_STATUS FROM OR_PRIV_GROUP WHERE Upper(PRIV_GRP_ID) LIKE Upper(?) AND Upper(PRIV_GRP_DESC) LIKE Upper(?) and Upper(EFF_STATUS) LIKE Upper(?)") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_ORDER_CATALOGS","SELECT a.order_catalog_code,short_desc ##FILTER$$ FROM or_order_catalog a WHERE order_category=? AND  ORDER_TYPE_CODE =? AND Upper(short_desc) LIKE Upper(?) and eff_status='E' ORDER BY short_desc") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_GET_MODIFY_VALUES","SELECT A.priv_type priv_type,A.memb_ref memb_ref,A.memb_id memb_id,A.acc_priv acc_priv,A.priv_grp_id priv_grp_id,B.EFF_STATUS EFF_STATUS FROM OR_PRIV_GROUP_RIGHTS A ,OR_PRIV_GROUP B WHERE B.PRIV_GRP_ID=A.PRIV_GRP_ID AND B.PRIV_GRP_ID=? ") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_GET_CATEGORY_VALUES","SELECT  short_desc FROM or_order_category_lang_vw  WHERE language_id=? AND order_category=?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_GET_ORDERTYPE_VALUES","SELECT  SHORT_DESC FROM or_order_type WHERE ORDER_CATEGORY = ? AND ORDER_TYPE_CODE=?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_GET_CATALOG_VALUES","SELECT short_desc FROM or_order_catalog WHERE order_category=? AND  ORDER_TYPE_CODE =? AND order_catalog_code=?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_GET_CATEGORY_CODE","SELECT  Order_category FROM or_order_type WHERE ORDER_TYPE_CODE=?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_GET_ORDERTYPE_CODE","SELECT  ORDER_TYPE_CODE FROM or_order_catalog WHERE order_catalog_code=?") ;
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_CREATE_PROCEDURE","CALL OR_POST_PRIV_GROUP_CATALOG(?,?)") ;
		
		//Privilege group ---End--Anjaneya Prasad

		//PendindingAppointment   added by Hari  on 10/08/07
	   	 dataMap.put("SQL_OR_APPT_ORDER_SELECT_STATUS_PRIORITY", "select PRIORITY||'<font color=black><b> ('||count(*)||')' priorty , count(*) totalCount , PRIORITY  PRIORITY_desc,nvl(PRIORITY,'R') PRIORITY from OR_ORDER_PEND_STATUS_LOG a  WHERE patient_id = nvl(?, patient_id) and performing_facility_id = (?) AND PEND_STATUS_IND='PA' and nvl(SOURCE_TYPE,'XX')=NVL(decode((?),'W','N',(?)), nvl(source_TYPE,'XX')) AND nvl(SOURCE_code,'XX') =NVL((?),nvl(source_CODE,'XX')) AND (source_type,source_CODE) IN (SELECT DECODE(LOCN_TYPE,'W','N',LOCN_TYPE),locn_code FROM ca_pract_by_locn_view WHERE practitioner_id=(?)) and ORDER_DATE  between to_date(nvl((?),'01/01/1000'),'dd/mm/yyyy') 			 and  to_date(nvl((?),'31/12/9998'),'dd/mm/yyyy')+.99999 Group by PRIORITY order by decode(PRIORITY,'S','1','U','2','R','3') "); //Modified by Uma on 7/25/2009 for IN012864
		 dataMap.put("SQL_OR_APPT_ORDER_SELECT_STATUS_CATEGORY", "select OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')||'<font color=black><b> ('||count(*)||')' short_desc , a.order_category,  count(*) num , OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  short_description from OR_ORDER_PEND_STATUS_LOG  a  WHERE A.patient_id = nvl(?, A.patient_id) and A.performing_facility_id = (?) and nvl(A.SOURCE_TYPE,'XX')=NVL(decode((?),'W','N',(?)), nvl(A.source_TYPE,'XX')) AND nvl(A.SOURCE_code,'XX') =NVL((?),nvl(A.source_CODE,'XX')) and (A.source_type,A.source_CODE) IN (SELECT DECODE(LOCN_TYPE,'W','N',LOCN_TYPE),locn_code FROM ca_pract_by_locn_view WHERE practitioner_id=(?))  and A.ORDER_DATE  between to_date(nvl((?),'01/01/1000'),'dd/mm/yyyy') 			 and  to_date(nvl((?),'31/12/9998'),'dd/mm/yyyy')+.9999 AND A.PEND_STATUS_IND='PA' Group by OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2'),a.order_category order by short_desc"); //Modified by Uma on 7/25/2009 for IN012864
		 dataMap.put("SQL_OR_APPT_ORDER_SELECT_STATUS_DTL", "SELECT  A.ORDER_ID, A.ORDER_LINE_NUM,TO_CHAR(A.ORDER_DATE,'DD/MM/YYYY HH24:MI') order_date_time, OR_GET_ORDER_CATALOG(A.order_id,A.ORDER_TYPE,?,'',A.ORDER_LINE_NUM)  order_detail, A.order_category, A.ORDER_TYPE ORDER_TYPE_CODE, OR_GET_DESC.OR_ORDER_CATEGORY (A.order_category,?,'2')  order_category_short_desc, A.Priority, A.Priority Priority_desc, A.ORD_PRACT_ID, AM_GET_DESC.AM_PRACTITIONER(A.ORD_PRACT_ID,?,'1') ORDERING_PRACT_NAME, nvl(A.cont_ordeR_ind,'DO') cont_order_ind, A.patient_class, AM_GET_DESC.AM_PATIENT_CLASS(A.patient_class, ?,'2') patient_class_short_desc, A.SOURCE_TYPE, A.SOURCE_CODE, DECODE(A.SOURCE_TYPE,'C',OP_GET_DESC.OP_CLINIC(A.ordering_facility_id,A.SOURCE_CODE,?,'2') ,IP_GET_DESC.IP_NURSING_UNIT (A.ordering_facility_id,A.SOURCE_CODE,?,'2') ) LOCN_DESC,A.patient_id,A.encounter_id,decode(?,'en',B.PATIENT_NAME,nvl(B.PATIENT_NAME_LOC_LANG,B.PATIENT_NAME))   patient_name , B.sex, TO_CHAR(B.date_of_birth,'DD/MM/YYYY') date_of_birth ,GET_AGE(B.DATE_OF_BIRTH) age from OR_ORDER_PEND_STATUS_LOG A, MP_PATIENT B  WHERE  B.PATIENT_ID=A.PATIENT_ID AND A.PEND_STATUS_IND='PA' AND A.patient_id = nvl(?, A.patient_id) and A.performing_facility_id = (?) and nvl(A.SOURCE_TYPE,'XX')=NVL(decode((?),'W','N',(?)), nvl(A.source_TYPE,'XX') ) AND nvl(A.SOURCE_code,'XX') =NVL((?), nvl(A.source_CODE,'XX')) and nvl(A.Priority,'R') =nvl((?),nvl(A.Priority,'R'))   and A.order_category =nvl((?),A.order_category)  and (A.source_type,A.source_CODE) IN (SELECT DECODE(LOCN_TYPE,'W','N',LOCN_TYPE),locn_code FROM ca_pract_by_locn_view WHERE practitioner_id=(?))  and A.ORDER_DATE  between to_date(nvl((?),'01/01/1000'),'dd/mm/yyyy') 			 and  to_date(nvl((?),'31/12/9998'),'dd/mm/yyyy')+.9999  order by  decode((?),'P',decode(A.priority,'S','1','U','2','R','3'),'O',A.Order_category),DECODE((?),'O',decode(A.priority,'S','1','U','2','R','3',A.ORDER_DATE))"); //Modified by Uma on 7/24/2009 for IN012864
		 
		 dataMap.put("SQL_OR_APPT_ORDER_SELECT_CATALOG","select Order_catalog_code from or_order_line where order_id=? and order_line_num=?");
		

//added on 8/22/2007 for future_order
		 //dataMap.put("SQL_OR_FUTURE_ORDER_LINK","SELECT   a.order_id order_id,a.order_category,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc,  b.Priority Priority_desc, AM_GET_DESC.AM_PATIENT_CLASS(patient_class, ?,'2') patient_class_short_desc,patient_class, LOCATION_TYPE||'/'||LOCN_SHORT_DESC location_details ,b.order_line_num order_line_num,b.bill_yn bill_yn,b.order_qty order_qty,TO_CHAR(start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,c.CONTR_MOD_ID contr_mod_id,patient_id, encounter_id, TO_CHAR(a.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') order_date_time, OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,2)  order_detail,b.ORDER_CATALOG_CODE catalog_code,decode(?,'en',PATIENT_NAME,nvl(PATIENT_NAME_LOC_LANG,PATIENT_NAME)) ||','||SEX ||'/'||GET_AGE(DATE_OF_BIRTH) ||',ID:'||Patient_id   patient_details, 'Encounter Dtls : ' || encounter_id||','||LOCATION_TYPE||'/'||LOCN_SHORT_DESC   encounter_dtls ,SOURCE_TYPE,SOURCE_CODE,b.Priority,b.ORDER_TYPE_CODE ,  a.ORD_PRACT_ID ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ORD_PRACT_ID,?,'1')  ORDERING_PRACT_NAME, ORDER_STATUS,order_status_short_desc,  a.ord_consent_reqd_yn,location_type,sex,date_of_birth, GET_AGE(DATE_OF_BIRTH) age,nvl(a.cont_order_ind,'DO')   cont_order_ind, a.ord_appr_reqd_yn, ord_appr_by_user_id, a.ord_consent_reqd_yn, ord_consent_by_id FROM or_order_vw a, or_ordeR_line b,or_order_catalog c  WHERE  a.ordeR_id =b.ordER_id  and b.ORDER_CATALOG_CODE=c.ORDER_CATALOG_CODE and ordering_facility_id = (?)  and patient_id=(?) and OR_CHECK_UNBILL_ORD_EXISTS_YN(a.patient_id, ordering_facility_id,a.order_id,b.order_line_num)='Y' order by encounter_dtls,a.order_id,a.ORD_DATE_TIME desc "); changed on 3/3/2008 
		// dataMap.put("SQL_OR_FUTURE_ORDER_LINK","SELECT   a.order_id order_id,a.order_category,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc,b.Priority Priority_desc,AM_GET_DESC.AM_PATIENT_CLASS(patient_class, ?,'2') patient_class_short_desc,patient_class, b.order_line_num order_line_num,b.bill_yn bill_yn,b.order_qty order_qty,TO_CHAR(start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,c.CONTR_MOD_ID contr_mod_id,a.patient_id, encounter_id, TO_CHAR(a.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') order_date_time, OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,2)  order_detail,b.ORDER_CATALOG_CODE catalog_code,SOURCE_TYPE,SOURCE_CODE,b.Priority,b.ORDER_TYPE_CODE ,                                  a.ORD_PRACT_ID ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ORD_PRACT_ID,?,'1')  ORDERING_PRACT_NAME,ORDER_STATUS,OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,?,'2') order_status_short_desc,  a.ord_consent_reqd_yn, sex,date_of_birth, GET_AGE(DATE_OF_BIRTH) age,nvl(a.cont_order_ind,'DO')   cont_order_ind, a.ord_appr_reqd_yn, ord_appr_by_user_id, a.ord_consent_reqd_yn, ord_consent_by_id,case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.ordering_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.ordering_facility_id,a.source_code,?,'2') end  location_description FROM or_order a, or_ordeR_line b,or_order_catalog c,mp_patient d  WHERE  a.ordeR_id =b.ordER_id  and b.ORDER_CATALOG_CODE=c.ORDER_CATALOG_CODE and a.patient_id=d.patient_id and ordering_facility_id = (?)  and a.patient_id=(?) and OR_CHECK_UNBILL_ORD_EXISTS_YN(a.patient_id, ordering_facility_id,a.order_id,b.order_line_num)='Y' and  a.cont_order_ind not in('DR','CR') and ORDER_STATUS IN ( SELECT ORDER_STATUS_CODE   FROM OR_ORDER_STATUS_CODE  WHERE ORDER_STATUS_TYPE <='25') order by encounter_id,a.order_id,a.ORD_DATE_TIME desc");
		 dataMap.put("SQL_OR_FUTURE_ORDER_LINK","SELECT   a.order_id order_id,a.order_category,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc,b.Priority Priority_desc,AM_GET_DESC.AM_PATIENT_CLASS(patient_class, ?,'2') patient_class_short_desc,patient_class, b.order_line_num order_line_num,b.bill_yn bill_yn,b.order_qty order_qty,TO_CHAR(start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,c.CONTR_MOD_ID contr_mod_id,a.patient_id, encounter_id, TO_CHAR(a.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') order_date_time, OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,2)  order_detail,b.ORDER_CATALOG_CODE catalog_code,SOURCE_TYPE,SOURCE_CODE,b.Priority,b.ORDER_TYPE_CODE ,                                  a.ORD_PRACT_ID ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ORD_PRACT_ID,?,'1')  ORDERING_PRACT_NAME,ORDER_STATUS,OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,?,'2') order_status_short_desc,  a.ord_consent_reqd_yn, sex,date_of_birth, GET_AGE(DATE_OF_BIRTH) age,nvl(a.cont_order_ind,'DO')   cont_order_ind, a.ord_appr_reqd_yn, ord_appr_by_user_id, a.ord_consent_reqd_yn, ord_consent_by_id,case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.ordering_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.ordering_facility_id,a.source_code,?,'2') end  location_description,decode(b.bill_yn,'Y', blcommon.Future_order_exists_wo_charge (a.ordering_facility_id,a.patient_id,'',a.episode_id,a.episode_visit_num,'OR', a.order_id, b.order_line_num),'Y') unbilled_yn FROM or_order a, or_ordeR_line b,or_order_catalog c,mp_patient d  WHERE  a.ordeR_id =b.ordER_id  and b.ORDER_CATALOG_CODE=c.ORDER_CATALOG_CODE and a.patient_id=d.patient_id and ordering_facility_id = (?)  and a.patient_id=(?)  /*OR_CHECK_UNBILL_ORD_EXISTS_YN(a.patient_id, ordering_facility_id,a.order_id,b.order_line_num)='Y'*/ and b.future_order_yn='Y' and 'Y'= decode(b.bill_yn,'Y', blcommon.Future_order_exists_wo_charge (a.ordering_facility_id,a.patient_id,'',a.episode_id,a.episode_visit_num,'OR', a.order_id, b.order_line_num),'Y') and  a.cont_order_ind not in('DR','CR') and ORDER_STATUS IN ( SELECT ORDER_STATUS_CODE   FROM OR_ORDER_STATUS_CODE  WHERE ORDER_STATUS_TYPE <'25') order by encounter_id,a.order_id,a.ORD_DATE_TIME desc");

		 dataMap.put("SQL_OR_FUTURE_ORDER_REVOKE_ORD_BILL","call or_revoke_ord_bill(?,?,?,?)");
		 dataMap.put("SQL_OR_FUTURE_ORDER_UPDATE","update or_order set  PATIENT_CLASS=?,ENCOUNTER_ID =?,EPISODE_ID=?,EPISODE_VISIT_NUM=?,SOURCE_TYPE=?,SOURCE_CODE=?,OLD_ENCOUNTER_ID=ENCOUNTER_ID,OLD_EPISODE_ID=EPISODE_ID,OLD_VISIT_NUM=EPISODE_VISIT_NUM,OLD_SOURCE_TYPE=SOURCE_TYPE,OLD_SOURCE_CODE =SOURCE_CODE where ORDER_ID=?");
		 dataMap.put("SQL_OR_FUTURE_ORDER_SELECT","SELECT order_line_num,order_catalog_code,catalog_desc,b.ord_pract_id,to_char(start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,order_qty,patient_id,encounter_id FROM or_order_line b,or_order a where a.order_id=b.order_id and b.order_id = ?");
		 dataMap.put("SQL_OR_FUTURE_ORDER_CHARGE_STAGE","call bl_proc_for_ext_service_mp.GET_ORDER_CATALOG_DTLS(?,?,?,?,?,?,?,?,?,?)");
		 dataMap.put("SQL_OR_ORDET_SET_ADD_DETAIL","SELECT order_catalog_code,order_category FROM or_order_catalog WHERE order_type_code=? AND short_desc=?");
		 dataMap.put("SQL_OR_ORDET_SET_ADD_DETAIL_TYPE","SELECT order_type_code FROM or_order_type WHERE short_desc=?");
		 
   //added by Hari on 20/09/2007 for OrderEntryFormatItemList values for Specimen_Type
		dataMap.put("SQL_ORDER_ENTRY_ITEM_UPDATE_LIST_VALUE","update or_order_field_ref_values set ORDER_CATEGORY=?,FIELD_MNEMONIC=?,ALPHANUM_VALUE=?,SEQ_NUM=?,ADDED_BY_ID=?,ADDED_DATE=sysdate,ADDED_AT_WS_NO=?,ADDED_FACILITY_ID=?,MODIFIED_BY_ID=?,MODIFIED_DATE=sysdate,MODIFIED_AT_WS_NO=?,MODIFIED_FACILITY_ID=? where order_category=? and field_mnemonic=? and KEY_REF=?");
		dataMap.put("SQL_ORDER_ENTRY_ITEM_DELETE_LIST_VALUE","delete from  or_order_field_ref_values  where order_category=? and field_mnemonic=? and KEY_REF=?");
		dataMap.put("SQL_ORDER_ENTRY_ITEM_GET_SEQUENCE_NUM","select KEY_REF from or_order_field_ref_values where ORDER_CATEGORY='LB' and FIELD_MNEMONIC='SPECIMEN_TYPE'");
		dataMap.put("SQL_ORDER_ENTRY_ITEM_GET_SPECIMENT_KEY_REF","SELECT 1 FROM OR_SPECIMEN_FOR_ORDERABLE WHERE SPECIMENT_KEY_REF=?  AND ROWNUM =1");
		
		
		dataMap.put("SQL_ORDER_ENTRY_FORMAT_PRESCRIPTION_REMARKS","SELECT A.REMARK_CODE   REMARK_CODE, B.REMARK_DESC  REMARK_DESC, A.DEFAULT_REMARK_YN   REMARK_YN FROM PH_PRES_REMARK_FOR_DRUG A, PH_PRES_REMARK_LANG_VW B WHERE A.DRUG_CODE = ?  AND A.REMARK_CODE = B.REMARK_CODE   AND B.FORM_CODE = NVL(?, B.FORM_CODE)   AND B.ROUTE_CODE = NVL(?, B.ROUTE_CODE)   AND B.LANGUAGE_ID = ?");
		dataMap.put("OR_GET_FORCED_STATUS","SELECT FORCE_AUTH_YN,FORCE_COSIGN_YN from OR_ORD_RULE_BY_PRACT WHERE PRACT_TYPE=? AND ORDER_CATEGORY_CODE    =?");
		dataMap.put("SQL_OR_FUTURE_ORDER_UPDATE","update or_order set  PATIENT_CLASS=?,ENCOUNTER_ID =?,EPISODE_ID=?,EPISODE_VISIT_NUM=?,SOURCE_TYPE=?,SOURCE_CODE=?,OLD_ENCOUNTER_ID=ENCOUNTER_ID,OLD_EPISODE_ID=EPISODE_ID,OLD_VISIT_NUM=EPISODE_VISIT_NUM,OLD_SOURCE_TYPE=SOURCE_TYPE,OLD_SOURCE_CODE =SOURCE_CODE where ORDER_ID=?");
		//added on 11/15/2007 by uma for future order line update
		dataMap.put("SQL_OR_FUTURE_ORDER_LINE_UPDATE","update or_order_line set  FUTURE_ORDER_CHARGE_LATER_YN='N',future_order_yn='N' where ORDER_ID=? and order_line_num=?");
		dataMap.put("SQL_OR_FUTURE_ORDER_STATUS","select 'Y' statusyn from or_order where order_id=? and  ORDER_STATUS IN ( SELECT ORDER_STATUS_CODE   FROM OR_ORDER_STATUS_CODE  WHERE ORDER_STATUS_TYPE IN ('00','03','05'))");
		dataMap.put("SQL_OR_FUTURE_ORDER_REG_COMPLETE","select nvl(a.complete_on_order_yn,'N') complete_on_order_yn , nvl(b.regn_reqd_yn,'N') regn_reqd_yn from or_order_catalog a, or_order_type b where  a.ORDER_CATALOG_CODE =? and b.order_type_code=a.order_type_code");

		dataMap.put("SQL_OR_BL_CHECK_ORDERABLE_BILLED","CALL BL_PROC_FOR_EXT_SERVICE_MP.CHECK_ORDERABLE_BILLED( ? ,? ,?, ?, ?, ?, ?, ?)"); 
		dataMap.put("SQL_ACTIVITY_TYPE_SELECT_LOOKUP", "SELECT activity_type code, short_desc description FROM or_activity_type_lang_vw WHERE language_id=? and order_category like ? AND  (order_type_code  like ? OR order_type_code ='*ALL' ) and eff_status ='E'  and upper(ACTIVITY_TYPE) like upper(?) and upper(SHORT_DESC) like upper(?)");
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_LOCN_C", "select CLINIC_CODE code,LONG_DESC description from op_clinic_lang_vw where EFF_STATUS='E' AND LANGUAGE_ID=?  and upper(CLINIC_CODE) like upper(?) and upper(LONG_DESC) like upper(?)");
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_LOCN_N", "select NURSING_UNIT_CODE code ,LONG_DESC description from Ip_NURSING_UNIT_lang_vw where EFF_STATUS='E' AND LANGUAGE_ID=?  and upper(NURSING_UNIT_CODE) like upper(?) and upper(LONG_DESC) like upper(?)");
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_LOCN_R", "select REFERRAL_CODE code ,LONG_DESC description from AM_REFERRAL_LANG_VW where EFF_STATUS='E' AND LANGUAGE_ID=?  and upper(REFERRAL_CODE) like upper(?) and upper(LONG_DESC) like upper(?)");
		//dataMap.put("SQL_OR_REGISTER_ORDER_SEARCH_DTL", "SELECT  a.order_category, OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc, OR_GET_DESC.OR_ORDER_TYPE(a.order_type_code,?,'2') order_type_short_desc,	a.Priority Priority_desc, AM_GET_DESC.AM_PATIENT_CLASS(a.patient_class, ?,'2') PATIENT_CLASS_SHORT_DESC, a.PATIENT_CLASS,a.ORDER_ID,a.patient_id, a.encounter_id,TO_CHAR(a.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') order_date_time , OR_GET_ORDER_CATALOG(a.order_id,a.order_type_code,?)  order_detail,		 decode(?,'en',b.PATIENT_NAME,nvl(b.PATIENT_NAME_LOC_LANG,b.PATIENT_NAME)) patient_name,GET_AGE(b.DATE_OF_BIRTH) patient_age ,SOURCE_TYPE,SOURCE_CODE,Priority,ORDER_TYPE_CODE ,	 ORD_PRACT_ID, AM_GET_DESC.AM_PRACTITIONER(ORD_PRACT_ID,?,'1') ORDERING_PRACT_NAME, a.ORDER_STATUS, OR_GET_DESC.OR_ORDER_STATUS_CODE(a.order_status,?,'2') ORDEr_STATUS_SHORT_DESC, a.ORD_COSIGN_REQD_YN,a.order_id,nvl(a.cont_order_ind,'DO') cont_order_ind, b.sex sex1, OR_ORDER_EXTERNAL_LOCATION ('REGISTER', a.ORDER_ID ,a.ORDER_TYPE_CODE) menu_text,a.performing_facility_id performing_facility_id,a.performing_deptloc_type performing_deptloc_type,a.performing_deptloc_code performing_deptloc_code,(select int_or_ext from or_performing_deptloc where performing_facility_id = a.performing_facility_id and performing_deptloc_type = a.performing_deptloc_type and performing_deptloc_code = a.performing_deptloc_code) int_or_ext, nvl((select notify_yn from or_order_line where order_id= a.order_id and notify_yn = 'Y' and rownum <=1),'N') notify_yn,nvl((SELECT ord_consent_status FROM or_order_line WHERE order_id = a.order_id AND ord_consent_reqd_yn = 'Y' AND ord_consent_status='P' and ROWNUM <=1),'N') consent_status, bill_yn, case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.performing_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.performing_facility_id,a.source_code,?,'2') end  location_description from or_order a ,mp_patient b WHERE b.patient_id=a.patient_id and  a.patient_id = nvl((?),a.patient_id)	and nvl(a.encounter_id,0) = nvl((?),nvl(a.encounter_id,0))	and nvl(a.cont_order_ind,'DO') in ('DO','DR','CO','CR') AND a.order_id = nvl((?),a.order_id) and exists (select order_id from or_order_line where order_id= a.order_id and trunc(start_date_time) between to_date(nvl((?),'01/01/1000'),'dd/mm/yyyy') and least(to_date(nvl((?),'31/12/9999'),'dd/mm/yyyy'),sysdate) and (appt_ref_num is null or appt_ref_num is not null and trunc(sysdate) >= trunc(appt_date_time)) )  and nvl(SOURCE_TYPE,'X')=NVL((?),nvl(source_TYPE,'X')) and nvl(SOURCE_code,'X') =NVL((?),nvl(source_CODE,'X')) and Priority=nvl((?),Priority) 	and order_category =nvl(?,order_category) and order_type_code = nvl((?),order_type_code) and performing_facility_id = ?  AND a.ord_date_time  BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy')+.9999  and (performing_appl_id IS NULL  OR performing_appl_id IN ( SELECT ext_image_appl_id FROM ca_ext_image_appl WHERE  NVL (result_entry, 'OR') = 'OR')) AND a.order_set_yn = 'N' and OR_Check_resulting_YN(?,?, a.order_category,a.order_type_code,a.order_id,a.performing_facility_id,a.performing_deptloc_type,a.performing_deptloc_code) ='Y' ##SPECI$$ ##INT_OR_EXT##  ##PERFORM_LOCN$$  ##ACTVITY_TYPE$$ order by order_category_short_desc,order_type_short_desc,ord_date_time,priority");
		dataMap.put("SQL_OR_REGISTER_ORDER_SEARCH_DTL", "SELECT  a.order_category, OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc, OR_GET_DESC.OR_ORDER_TYPE(a.order_type_code,?,'2') order_type_short_desc,	a.Priority Priority_desc, AM_GET_DESC.AM_PATIENT_CLASS(a.patient_class, ?,'2') PATIENT_CLASS_SHORT_DESC, a.PATIENT_CLASS,a.ORDER_ID,a.patient_id, a.encounter_id,TO_CHAR(a.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') order_date_time , OR_GET_ORDER_CATALOG(a.order_id,a.order_type_code,?)  order_detail,		 decode(?,'en',b.PATIENT_NAME,nvl(b.PATIENT_NAME_LOC_LANG,b.PATIENT_NAME)) patient_name,GET_AGE(b.DATE_OF_BIRTH) patient_age ,SOURCE_TYPE,SOURCE_CODE,Priority,ORDER_TYPE_CODE ,	 ORD_PRACT_ID, AM_GET_DESC.AM_PRACTITIONER(ORD_PRACT_ID,?,'1') ORDERING_PRACT_NAME, a.ORDER_STATUS, OR_GET_DESC.OR_ORDER_STATUS_CODE(a.order_status,?,'2') ORDEr_STATUS_SHORT_DESC, a.ORD_COSIGN_REQD_YN,a.order_id,nvl(a.cont_order_ind,'DO') cont_order_ind, b.sex sex1, OR_ORDER_EXTERNAL_LOCATION ('REGISTER', a.ORDER_ID ,a.ORDER_TYPE_CODE) menu_text,a.performing_facility_id performing_facility_id,a.performing_deptloc_type performing_deptloc_type,a.performing_deptloc_code performing_deptloc_code,(select int_or_ext from or_performing_deptloc where performing_facility_id = a.performing_facility_id and performing_deptloc_type = a.performing_deptloc_type and performing_deptloc_code = a.performing_deptloc_code) int_or_ext, nvl((select notify_yn from or_order_line where order_id= a.order_id and notify_yn = 'Y' and rownum <=1),'N') notify_yn,nvl((SELECT ord_consent_status FROM or_order_line WHERE order_id = a.order_id AND ord_consent_reqd_yn = 'Y' AND ord_consent_status='P' and ROWNUM <=1),'N') consent_status, bill_yn, case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.performing_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.performing_facility_id,a.source_code,?,'2') end  location_description,a.order_set_id  order_set_id from or_order a ,mp_patient b WHERE b.patient_id=a.patient_id and  a.patient_id = nvl((?),a.patient_id)	and nvl(a.encounter_id,0) = nvl((?),nvl(a.encounter_id,0)) AND a.order_category IN (SELECT order_category FROM or_result_user WHERE (practitioner_id = ? OR resp_id = ?))	and nvl(a.cont_order_ind,'DO') in ('DO','DR','CO','CR') AND a.order_id = nvl((?),a.order_id) and exists (select order_id from or_order_line where order_id= a.order_id and trunc(start_date_time) between to_date(nvl((?),'01/01/1000'),'dd/mm/yyyy') and least(to_date(nvl((?),'31/12/9999'),'dd/mm/yyyy'),sysdate) and (appt_ref_num is null or appt_ref_num is not null and trunc(sysdate) >= trunc(appt_date_time)) )  and nvl(SOURCE_TYPE,'X')=NVL((?),nvl(source_TYPE,'X')) and nvl(SOURCE_code,'X') =NVL((?),nvl(source_CODE,'X')) and Priority=nvl((?),Priority) 	and order_category =nvl(?,order_category) and order_type_code = nvl((?),order_type_code) and performing_facility_id = ?  AND a.ord_date_time  BETWEEN TO_DATE(NVL((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE(NVL((?),'31/12/9999'),'dd/mm/yyyy')+.9999  and (performing_appl_id IS NULL  OR performing_appl_id IN ( SELECT ext_image_appl_id FROM ca_ext_image_appl WHERE  NVL (result_entry, 'OR') = 'OR')) and substr(a.order_id,1,2)!='CS' and OR_Check_resulting_YN(?,?, a.order_category,a.order_type_code,a.order_id,a.performing_facility_id,a.performing_deptloc_type,a.performing_deptloc_code) ='Y' ##SPECI$$ ##INT_OR_EXT##  ##PERFORM_LOCN$$  ##ACTVITY_TYPE$$ order by order_category_short_desc,order_type_short_desc,ord_date_time,priority");//Modified by Uma on 6/26/2009 for IN011789
		dataMap.put("SQL_OR_REGISTER_ORDER_SELECT_PERFORM_LOCN_OTH", "SELECT performing_deptloc_code code,  performing_deptloc_short_desc description FROM or_performing_deptloc_lang_vw  WHERE language_id=? AND performing_deptloc_type like ? AND performing_facility_id like ? and upper(performing_deptloc_code) like upper(?) and upper(performing_deptloc_short_desc) like upper(?)");
		dataMap.put("SQL_OR_ORDER_ENTRY_ORDER_TYPE_LOOKUP","SELECT order_type_code code,  short_desc description FROM or_order_type_lang_vw WHERE language_id=? and eff_status='E' AND order_category like ? and upper(order_type_code) like upper(?) and upper(short_desc) like upper(?)");
		dataMap.put("SQL_OR_ORDER_ENTRY_ORDER_TYPE_DESC","SELECT short_desc description FROM or_order_type_lang_vw WHERE language_id=? and eff_status='E' AND order_type_code=?");
		dataMap.put("SQL_OR_INDEX_ORDER_SET_DIAG_SCHEME","SELECT TERM_SET_ID code ,TERM_SET_DESC description FROM MR_TERM_SET WHERE EFF_STATUS='E' AND DIAG_SPEC_YN='Y' ORDER BY 2");
		dataMap.put("SQL_OR_INDEX_ORDER_SET_TERM_DESC","select SHORT_DESC description from  MR_TERM_CODE  where  TERM_CODE=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_GET_DATA" ,"SELECT order_line_field_value FROM or_order_line_field_values WHERE order_id = (?) AND order_line_num =  (?) AND order_line_field_mnemonic =?");
		dataMap.put("SQL_OR_AM_PRACT" ,"SELECT practitioner_id code, practitioner_name description  FROM am_practitioner_lang_vw where  eff_status ='E'  and language_id=? and upper(practitioner_id) like upper(?) and upper(practitioner_name) like upper(?) order by 2");

		//Start of Queries for cosign, authorize and special approval function

		//dataMap.put("SQL_OR_REVIEW_ORDER_SELECT_STATUS_PRIORITY", "SELECT nvl(a.PRIORITY,'R') PRIORITY,COUNT (*) no_of_rec FROM OR_ORDER_PEND_STATUS_LOG a WHERE a.PEND_STATUS_IND=? and ORDERING_FACILITY_ID=? and  nvl(a.SOURCE_TYPE,'XX')=NVL(decode((?),'W','N',(?)), nvl(a.source_TYPE,'XX')) AND nvl(a.SOURCE_code,'XX') =NVL((?), nvl(a.source_CODE,'XX')) and a.patient_id = nvl(?,a.patient_id) and a.ORDER_DATE between TO_DATE(?,'dd/mm/yyyy') AND  TO_DATE(?,'dd/mm/yyyy')+.99999   and (a.source_type, a.source_code) IN (SELECT DECODE (locn_type, 'W', 'N', locn_type),  locn_code FROM ca_pract_by_locn_view WHERE facility_id = ? AND practitioner_id = ?) AND a.order_category in (SELECT order_category  FROM or_review_user_categories  WHERE (practitioner_id = ?  or resp_id = ?) AND decode (?,'CS',cosign_yn,'PO',AUTH_YN,'PS',SPL_APPR_YN) = 'Y') Group by nvl(a.PRIORITY,'R') order by decode(nvl(a.PRIORITY,'R'),'S','1','U','2','R','3') ");
		dataMap.put("SQL_OR_REVIEW_ORDER_SELECT_STATUS_PRIORITY", "SELECT nvl(a.PRIORITY,'R') PRIORITY,COUNT (*) no_of_rec FROM OR_ORDER_PEND_STATUS_LOG a WHERE a.PEND_STATUS_IND=? and ORDERING_FACILITY_ID=? and substr(a.order_id,1,2)!='CS' and  nvl(a.SOURCE_TYPE,'XX')=NVL(decode((?),'W','N',(?)), nvl(a.source_TYPE,'XX')) AND nvl(a.SOURCE_code,'XX') =NVL((?), nvl(a.source_CODE,'XX')) and a.patient_id = nvl(?,a.patient_id) and a.ORDER_DATE between TO_DATE(?,'dd/mm/yyyy') AND  TO_DATE(?,'dd/mm/yyyy')+.99999   and (a.source_type != 'R' AND (a.source_type, a.source_code) IN (SELECT DECODE (locn_type, 'W', 'N',locn_type),locn_code  FROM ca_pract_by_locn_view WHERE  facility_id = (?) and practitioner_id = (?)) OR a.source_type = 'R' ) AND a.order_category in (SELECT order_category  FROM or_review_user_categories  WHERE (practitioner_id = ?  or resp_id = ?) AND decode (?,'CS',cosign_yn,'PO',AUTH_YN,'PS',SPL_APPR_YN) = 'Y') ##FILTER$$ Group by nvl(a.PRIORITY,'R') order by decode(nvl(a.PRIORITY,'R'),'S','1','U','2','R','3') ");

		//dataMap.put("SQL_OR_REVIEW_ORDER_SELECT_STATUS_CATEGORY", "SELECT OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')   short_description,COUNT (*) no_of_rec, a.order_category ord_cat FROM OR_ORDER_PEND_STATUS_LOG a WHERE a.PEND_STATUS_IND=?  and ORDERING_FACILITY_ID=? and nvl(a.SOURCE_TYPE,'XX')=NVL(decode((?),'W','N',(?)),nvl(a.source_TYPE,'XX')) AND nvl(a.SOURCE_code,'XX') =NVL((?),nvl(a.source_CODE,'XX')) AND  a.patient_id = nvl(?, a.patient_id) and  a.ORDER_DATE between TO_DATE(?,'dd/mm/yyyy') AND  TO_DATE(?,'dd/mm/yyyy')+0.99999 and (a.source_type, a.source_code) IN (SELECT DECODE (locn_type, 'W', 'N', locn_type),  locn_code FROM ca_pract_by_locn_view WHERE facility_id = ? AND practitioner_id = ?) and a.order_category in (SELECT order_category  FROM or_review_user_categories  WHERE (practitioner_id = ?  or resp_id = ?) AND decode (?,'CS',cosign_yn,'PO',AUTH_YN,'PS',SPL_APPR_YN) = 'Y')  Group by  a.order_category Order by 1");
		dataMap.put("SQL_OR_REVIEW_ORDER_SELECT_STATUS_CATEGORY", "SELECT OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')   short_description,COUNT (*) no_of_rec, a.order_category ord_cat FROM OR_ORDER_PEND_STATUS_LOG a WHERE a.PEND_STATUS_IND=?  and ORDERING_FACILITY_ID=? and substr(a.order_id,1,2)!='CS' and nvl(a.SOURCE_TYPE,'XX')=NVL(decode((?),'W','N',(?)),nvl(a.source_TYPE,'XX')) AND nvl(a.SOURCE_code,'XX') =NVL((?),nvl(a.source_CODE,'XX')) AND  a.patient_id = nvl(?, a.patient_id) and  a.ORDER_DATE between TO_DATE(?,'dd/mm/yyyy') AND  TO_DATE(?,'dd/mm/yyyy')+0.99999 and (a.source_type != 'R' AND (a.source_type, a.source_code) IN (SELECT DECODE (locn_type, 'W', 'N',locn_type),locn_code  FROM ca_pract_by_locn_view WHERE  facility_id = (?) and practitioner_id = (?)) OR a.source_type = 'R' ) and a.order_category in (SELECT order_category  FROM or_review_user_categories  WHERE (practitioner_id = ?  or resp_id = ?) AND decode (?,'CS',cosign_yn,'PO',AUTH_YN,'PS',SPL_APPR_YN) = 'Y')  ##FILTER$$ Group by  a.order_category Order by 1");

		//dataMap.put("SQL_OR_REVIEW_ORDER_SELECT_STATUS_DTL", "SELECT   a.order_category order_category,         or_get_desc.or_order_category(a.order_category,?,'2') order_category_short_desc,a.priority priority_desc,am_get_desc.am_patient_class(a.patient_class,?,'2') patient_class_short_desc,a.patient_class patient_class,a.order_id order_id,a.patient_id patient_id, a.encounter_id encounter_id,TO_CHAR ( ORDER_DATE,'DD/MM/YYYY HH24:MI') order_date_time,or_get_order_catalog (a.order_id, a.order_type, ?) order_detail,DECODE (?,'en', patient_name,NVL (patient_name_loc_lang, patient_name)) patient_name, a.source_type source_type, a.source_code source_code, a.priority priority, a.order_type order_type,a.ord_pract_id ord_pract_id,am_get_desc.am_practitioner (a.ord_pract_id,?,'1') ordering_pract_name,sex, date_of_birth,get_age (date_of_birth) age,NVL (a.cont_order_ind, 'DO') cont_order_ind,c.ord_appr_reqd_yn ord_appr_reqd_yn, c.ord_appr_by_user_id ord_appr_by_user_id,c.ord_consent_reqd_yn ord_consent_reqd_yn, c.ord_consent_by_id ord_consent_by_id,c.ORDER_STATUS ORDER_STATUS,case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.ordering_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.ordering_facility_id,a.source_code,?,'2') end  location_description,OR_PRIVILEGE_BY_ORDER( 'AUTHORIZE' ,c.order_category ,c.ORDER_TYPE_CODE, Null, ?, ?, ?, c.order_id,?)  privilege_yn  FROM OR_ORDER_PEND_STATUS_LOG a, mp_patient b, or_order c WHERE a.order_id=c.order_id and a.patient_id=c.patient_id and a.PEND_STATUS_IND=?  and a.patient_id=b.patient_id and a.patient_id = NVL (?, a.patient_id) AND a.ordering_facility_id = (?)  AND NVL (a.source_type, 'XX') = NVL (DECODE ((?), 'W', 'N', (?)), NVL (a.source_type, 'XX'))  AND NVL (a.source_code, 'XX') = NVL ((?), NVL (a.source_code, 'XX')) AND NVL (a.priority, 'R') = NVL ((?), NVL (a.priority, 'R')) and a.order_category =nvl((?),a.order_category) and a.order_category in (SELECT order_category  FROM or_review_user_categories  WHERE (practitioner_id = ?  or resp_id = ?) AND decode (?,'CS',cosign_yn,'PO',AUTH_YN,'PS',SPL_APPR_YN) = 'Y')  AND (a.source_type IS NOT NULL  AND (a.source_type, a.source_code) IN (SELECT DECODE (locn_type, 'W', 'N', locn_type),locn_code  FROM ca_pract_by_locn_view WHERE practitioner_id = (?)) OR a.source_type IS NULL) AND NVL (a.cont_order_ind, 'DO') IN ('CO', 'DO', 'CR', 'DR') AND  ORDER_DATE  BETWEEN TO_DATE (NVL ((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE (NVL ((?),'31/12/9999'),'dd/mm/yyyy')+.999 ORDER BY DECODE ((?),'P', DECODE (priority, 'S', '1','U', '2', 'R', '3'),'O', order_category),DECODE ((?),'O', DECODE (priority,'S', '1', 'U', '2','R', '3',ORDER_DATE))");
		dataMap.put("SQL_OR_REVIEW_ORDER_SELECT_STATUS_DTL", "SELECT   a.order_category order_category,         or_get_desc.or_order_category(a.order_category,?,'2') order_category_short_desc,a.priority priority_desc,am_get_desc.am_patient_class(a.patient_class,?,'2') patient_class_short_desc,a.patient_class patient_class,a.order_id order_id,a.patient_id patient_id, a.encounter_id encounter_id,TO_CHAR ( ORDER_DATE,'DD/MM/YYYY HH24:MI') order_date_time,or_get_order_catalog (a.order_id, a.order_type, ?) order_detail,DECODE (?,'en', patient_name,NVL (patient_name_loc_lang, patient_name)) patient_name, a.source_type source_type, a.source_code source_code, a.priority priority, a.order_type order_type,a.ord_pract_id ord_pract_id,am_get_desc.am_practitioner (a.ord_pract_id,?,'1') ordering_pract_name,sex, date_of_birth,get_age (date_of_birth) age,NVL (a.cont_order_ind, 'DO') cont_order_ind,c.ord_appr_reqd_yn ord_appr_reqd_yn, c.ord_appr_by_user_id ord_appr_by_user_id,c.ord_consent_reqd_yn ord_consent_reqd_yn, c.ord_consent_by_id ord_consent_by_id,c.ORDER_STATUS ORDER_STATUS,case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.ordering_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.ordering_facility_id,a.source_code,?,'2') end  location_description,OR_PRIVILEGE_BY_ORDER( 'AUTHORIZE' ,c.order_category ,c.ORDER_TYPE_CODE, Null, ?, ?, ?, c.order_id,?)  privilege_yn,AM_GET_DESC.AM_speciality(speciality_code,?,'2') speciality_desc,speciality_code  speciality_code,c.order_set_id order_set_id FROM OR_ORDER_PEND_STATUS_LOG a, mp_patient b, or_order c WHERE a.order_id=c.order_id and a.patient_id=c.patient_id and a.PEND_STATUS_IND=?  and a.patient_id=b.patient_id and a.patient_id = NVL (?, a.patient_id) AND a.ordering_facility_id = (?)  AND NVL (a.source_type, 'XX') = NVL (DECODE ((?), 'W', 'N', (?)), NVL (a.source_type, 'XX'))  AND NVL (a.source_code, 'XX') = NVL ((?), NVL (a.source_code, 'XX')) AND NVL (a.priority, 'R') = NVL ((?), NVL (a.priority, 'R')) and a.order_category =nvl((?),a.order_category) and a.order_category in (SELECT order_category  FROM or_review_user_categories  WHERE (practitioner_id = ?  or resp_id = ?) AND decode (?,'CS',cosign_yn,'PO',AUTH_YN,'PS',SPL_APPR_YN) = 'Y')  AND (a.source_type IS NOT NULL and a.source_type!='R' AND (a.source_type, a.source_code) IN (SELECT DECODE (locn_type, 'W', 'N',locn_type),locn_code  FROM ca_pract_by_locn_view WHERE practitioner_id = (?) ) OR a.source_type = 'R' OR a.source_type IS NULL )  and substr(a.order_id,1,2)!='CS' AND NVL (a.cont_order_ind, 'DO') IN ('CO', 'DO', 'CR', 'DR') AND  ORDER_DATE  BETWEEN TO_DATE (NVL ((?),'01/01/1000'),'dd/mm/yyyy') AND TO_DATE (NVL ((?),'31/12/9999'),'dd/mm/yyyy')+.999 ##FILTER$$ ORDER BY DECODE ((?),'P', DECODE (priority, 'S', '1','U', '2', 'R', '3'),'O', order_category),DECODE ((?),'O', DECODE (priority,'S', '1', 'U', '2','R', '3',ORDER_DATE))");
		// End of Queries for cosign, authorize and special approval function
		dataMap.put("SQL_OR_ORDER_ENTRY_PERFORMING_LOC_APPT_REQ_YN", "select a.APPT_REQD_YN appt_yn from or_orderables_for_deptloc a,OR_PERFORMING_DEPTLOC b where b.PERFORMING_DEPTLOC_CODE=a.PERFORMING_DEPTLOC_CODE AND a.order_catalog_code=? AND a.PERFORMING_DEPTLOC_CODE = ?");

		dataMap.put("SQL_OR_ORDER_CATALOG_CHARTING_LOOKUP", "select chart_id code,short_desc description from ca_chart where  upper(chart_id) like upper(?) and upper(short_desc) like upper(?) and eff_status='E' order by 2");

		dataMap.put("SQL_OR_RESULT_ENTRY_CHART_STATUS", "SELECT 1 FROM ca_encntr_discr_msr WHERE contr_module_id = ?  AND CONTR_MODULE_TRANS_REF = ?");

		dataMap.put("SQL_OR_ORDER_ENTRY_OT_INSTALL_ANAESTHETIST_CODE", "select short_name description from sy_physician_mast where physician_id=?");

		dataMap.put("SQL_OR_ORDER_ENTRY_OT_INSTALL_SURGERY","SELECT short_desc description  FROM ot_nature_of_surgery WHERE nature_code = ?");

		dataMap.put("SQL_OR_ORDER_ENTRY_ANAESTHESIA","SELECT  AM_GET_DESC.AM_ANAESTHESIA(ANAESTHESIA_CODE,?,'2') description  FROM am_anaesthesia  where anaesthesia_code=?");
		dataMap.put("SQL_OR_PAT_ORDER_BY_LOCN_CLINIC_MULTI_PATIENT_PROCEDURE_LOOKUP","SELECT CLINIC_CODE CODE,LONG_DESC description FROM op_clinic_lang_vw WHERE EFF_STATUS = 'E' AND CLINIC_TYPE = 'E' AND LANGUAGE_ID=?  and upper(CLINIC_CODE) like upper(?) and upper(LONG_DESC) like upper(?)");

		dataMap.put("SQL_OR_CLOSED_PROCESSED_ORDER_INSERT","insert into  or_auto_close_rule (order_type_code,patient_class,elapsed_prd_close_unpr,elapsed_prd_close_inpr,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id,close_unpr_fut_ord, ingore_order_in_hrs, close_unpr_billed_ord, close_unpr_reverse_chrg, close_inpr_billed_ord,  close_inpr_reverse_chrg) values (?,?,?,?,?,sysdate,?,?,?,sysdate,?,?,?,?,?,?,?,?)");
		
		dataMap.put("SQL_OR_CLOSED_PROCESSED_ORDER_UPDATE","update  or_auto_close_rule set  elapsed_prd_close_unpr=?,elapsed_prd_close_inpr=?,added_by_id=?,added_date=sysdate,added_at_ws_no=?,added_facility_id=?,modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=?,close_unpr_fut_ord=?,  ingore_order_in_hrs=?, close_unpr_billed_ord=?,  close_unpr_reverse_chrg=?,  close_inpr_billed_ord=?	,  close_inpr_reverse_chrg=? where order_type_code=? and patient_class=?");

		dataMap.put("SQL_OR_CLOSED_PROCESSED_ORDER_DELETE" , "delete from or_auto_close_rule  where order_type_code =?");

		dataMap.put("SQL_OR_CLOSED_PROCESSED_ORDER_SELECT" , "select b.short_desc short_desc, a.patient_class patient_class,a.elapsed_prd_close_unpr elapsed_prd_close_unpr,a.elapsed_prd_close_inpr elapsed_prd_close_inpr,a.close_unpr_fut_ord close_unpr_fut_ord, a.ingore_order_in_hrs ingore_order_in_hrs, a.close_unpr_billed_ord close_unpr_billed_ord, a.close_unpr_reverse_chrg close_unpr_reverse_chrg, a.close_inpr_billed_ord close_inpr_billed_ord, a.close_inpr_reverse_chrg  close_inpr_reverse_chrg from or_auto_close_rule a, am_patient_class b  where order_type_code=?  and b.patient_class = a.patient_class  union select short_desc short_desc, patient_class patient_class, null  elapsed_prd_close_unpr, null elapsed_prd_close_inpr,null close_unpr_fut_ord,null ingore_order_in_hrs,null close_unpr_billed_ord,null close_unpr_reverse_chrg, null close_inpr_billed_ord,  null close_inpr_reverse_chrg   from am_patient_class where patient_class not in (select patient_class from or_auto_close_rule where order_type_code =?) order by 1");
		
		dataMap.put("SQL_OR_CLOSED_PROCESSED_ORDER_ALL_PATIENT_CLASS_SELECT","select patient_class patient_class,elapsed_prd_close_unpr elapsed_prd_close_unpr, elapsed_prd_close_inpr elapsed_prd_close_inpr,close_unpr_fut_ord, ingore_order_in_hrs, close_unpr_billed_ord, close_unpr_reverse_chrg, close_inpr_billed_ord,  close_inpr_reverse_chrg from or_auto_close_rule where order_type_code=? and patient_class='*A'"); 

		dataMap.put("SQL_OR_CLOSED_PROCESSED_ORDER_COUNT","select count(*) total from or_auto_close_rule where order_type_code=? and patient_class=?"); 

		dataMap.put("SQL_OR_CLOSED_PROCESSED_ORDER_QUERY_CRITERIA","SELECT d.short_desc order_category,a.order_type_code order_type_code,b.short_desc short_desc,c.short_desc patient_class,a.elapsed_prd_close_unpr elapsed_prd_close_unpr,a.close_unpr_fut_ord close_unpr_fut_ord, a.close_unpr_billed_ord close_unpr_billed_ord, a.close_unpr_reverse_chrg close_unpr_reverse_chrg, a.ingore_order_in_hrs ingore_order_in_hrs,a.elapsed_prd_close_inpr elapsed_prd_close_inpr, a.close_inpr_billed_ord close_inpr_billed_ord, a.close_inpr_reverse_chrg  close_inpr_reverse_chrg FROM or_auto_close_rule a,or_order_type b,am_patient_class c,or_order_category d where a.order_type_code=b.order_type_code and a.patient_class=c.patient_class and b.order_category=d.order_category and upper(a.order_type_code) like upper(?) and upper(b.short_desc) like upper(?) and upper(d.order_category) like (?) and upper(a.patient_class) like (?) union select d.short_desc order_category,a.order_type_code order_type_code,b.short_desc short_desc,'All' patient_class,a.elapsed_prd_close_unpr elapsed_prd_close_unpr,a.close_unpr_fut_ord close_unpr_fut_ord, a.close_unpr_billed_ord close_unpr_billed_ord, a.close_unpr_reverse_chrg close_unpr_reverse_chrg, a.ingore_order_in_hrs ingore_order_in_hrs,a.elapsed_prd_close_inpr elapsed_prd_close_inpr, a.close_inpr_billed_ord close_inpr_billed_ord, a.close_inpr_reverse_chrg  close_inpr_reverse_chrg FROM or_auto_close_rule a,or_order_type b,or_order_category d where a.order_type_code=b.order_type_code and  b.order_category=d.order_category and upper(a.order_type_code) like upper(?) and upper(b.short_desc) like upper(?) and upper(d.order_category) like (?) and  upper(a.patient_class) like (?) and a.patient_class='*A'");

		dataMap.put("SQL_OR_VIEW_ORDER_PERFORM_TEAM_SURGEON","SELECT AM_GET_DESC.AM_PRACTITIONER(c.order_field_value,?,'1') description FROM or_order_field_values c where c.order_id= ? AND c.order_field_mnemonic  ='PERFORM_TEAM_SURGEON' AND rownum <=1");
		dataMap.put("SQL_OR_ORDER_SET_COMPONENT_ROUTE","select a.ROUTE_CODE code, a.ROUTE_DESC  description from PH_ROUTE a, PH_ROUTE_FOR_FORM b,ph_drug c where c.Drug_code=? and b.form_code=c.form_code and a.route_code=b.route_code and upper(a.route_code) like upper(?) and upper(a.route_desc) like upper(?) order by 2");
		dataMap.put("SQL_OR_ORDER_SET_COMPONENT_ROUTE_DESC","select a.ROUTE_DESC  description from PH_ROUTE a where a.route_code=?");
		dataMap.put("SQL_OR_ORDER_SET_COMPONENT_ADD_SELECT","select distinct order_catalog_code catalog_code from or_order_set_component where order_set_code=? and ocurrance_num  > 1  and order_catalog_code not in (select order_catalog_code from or_order_set_component where order_set_code=? and ocurrance_num  = 1 )");
		dataMap.put("SQL_OR_ORDER_SET_COMPONENT_ADD_DELETE","delete from or_order_set_component where order_set_code=? and order_catalog_code=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_FORMAT_CATALOG","SELECT order_catalog_code code,short_desc description FROM or_order_catalog  where order_category  like ? and order_type_code like ? and upper(order_catalog_code) like upper(?)  and upper(short_desc) like upper(?) and eff_status='E'  UNION SELECT '*ALL' code,'All' description FROM DUAL");
		dataMap.put("SQL_OR_ORDER_ENTRY_FLOOR_TO_START_DAY_YN","select floor_to_start_day_yn floor_to_start_day_yn from or_param_by_category_ptcl where ORDER_CATEGORY =(select order_category from or_order_catalog where order_catalog_code=?) and PATIENT_CLASS =?");
		dataMap.put("SQL_OR_CATALOG_CONSENT_FORMAT_MULTI_SPECIFIC","SELECT or_get_desc.or_consent_form(CONSENT_FORM_ID,?,'1') DESCRIPTION,CONSENT_FORM_ID CODE FROM OR_CATALOG_CONSENT_DTL where  order_catalog_code=(select order_catalog_code from or_order_line where order_id=? and order_line_num =?)  and upper(CONSENT_FORM_ID) like upper(?) and upper(or_get_desc.or_consent_form(CONSENT_FORM_ID,?,'1')) like upper(?) order by 1");
   	   dataMap.put("SQL_OR_ORDER_ENTRY_VIEW_ORDER_PRINT", "SELECT a.order_category order_category,       or_get_desc.or_order_category(a.order_category,?,'2') order_category_short_desc,a.priority priority_desc,or_get_desc.or_order_type (a.order_type_code,?,'2') order_type_short_desc,a.patient_class,   a.order_id order_id,b.patient_name,b.sex,get_age (b.date_of_birth) age,a.Patient_id,a.encounter_id,TO_CHAR (a.ord_date_time, 'DD/MM/YYYY HH24:MI') order_date_time,or_get_order_catalog (a.order_id, a.order_type_code, ?) order_detail,a.source_type, a.source_code, a.priority priority,a.order_type_code order_type_code, a.ord_pract_id ord_pract_id,nvl(am_get_desc.am_practitioner (a.ord_pract_id,?,'1'), am_get_desc.am_ext_practitioner (a.ord_pract_id,?,'1')) ordering_pract_name,a.order_status,or_get_desc.or_order_status_code(a.order_status,?,'2') order_status_short_desc,a.ord_cosign_reqd_yn,sm_get_desc.sm_facility_param(a.ordering_facility_id,?,'1') ordering_facility,sm_get_desc.sm_facility_param(a.performing_facility_id,?,'1') performing_facility,       SUBSTR (a.order_fields_display_text, 1, 40) order_format,a.ordering_facility_id, a.iv_prep_yn,a.order_mode,a.performing_deptloc_type, a.performing_deptloc_code,a.performing_pract_id, a.ref_facility_id,TO_CHAR (a.ref_date_time, 'dd/mm/yyyy hh24:mi') ref_date_time,a.ref_sent_pract_id, a.ref_sent_remarks, a.ref_report_pract_id,TO_CHAR (a.ref_report_date_time,'dd/mm/yyyy hh24:mi' ) ref_report_date_time,TO_CHAR (a.ref_recieved_date_time,'dd/mm/yyyy hh24:mi') ref_recieved_date_time, a.ref_recieved_pract_id, a.ref_recieved_remarks,( select MAX (action_seq_num)  from  or_order_comment where order_id=a.order_id) action_seq_num, sm_get_desc.sm_appl_user(a.added_by_id,?,1) appl_user_name,nvl((select IMAGE_REF_YN from OR_order_line where order_id=a.order_id and IMAGE_REF_YN='Y'),'N') IMAGE_REF_YN,case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.ordering_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.ordering_facility_id,a.source_code,?,'2') end  location_description,mp_get_desc.mp_country(b.nationality_code,?,1) nationality_long_name,b.national_id_no  national_id_no  FROM or_order a,mp_patient b WHERE order_id = (?) and b.patient_id=a.patient_id");
   	   dataMap.put("SQL_OR_ORDER_ENTRY_VIEW_ORDER_PRINT_SITE_NAME", "SELECT 	site_name  site_name FROM 	SM_SITE_PARAM_LANG_VW where language_id = ?");
   	   dataMap.put("SQL_OR_MULTI_FAC_PROCESSING_ASSOCIATED_REC_OTHER_FACILITY", "SELECT 1  FROM OR_ORDER_FACILITY_CROSS_REF WHERE  ordering_facility_id = ? AND order_category= ? AND order_type_code= ? AND performing_facility_id!= ? AND ordering_source_type=? AND ordering_source_code=? and order_catalog_code=?");
	   dataMap.put("SQL_OR_MULTI_FAC_PROCESSING_DELETE", "delete FROM  OR_ORDER_FACILITY_CROSS_REF WHERE ordering_facility_id =? AND order_category =? AND order_type_code=? AND ordering_source_type = ? AND ordering_source_code = ? and performing_facility_id=?");
	   dataMap.put("SQL_OR_MULTI_FAC_PROCESSING_UPDATE", "update OR_ORDER_FACILITY_CROSS_REF set  PERFORMING_DEPTLOC_CODE=?, modified_by_id=?,modified_date=sysdate,modified_at_ws_no=?,modified_facility_id=? WHERE ordering_facility_id =? and ordering_source_type=? and ordering_source_code=? AND order_category =? AND order_type_code=? and performing_facility_id=? and order_catalog_code=?");
	   dataMap.put("SQL_OR_MULTI_FAC_PROCESSING_PERFORM_LOCN", "select  PERFORMING_DEPTLOC_CODE FROM  OR_ORDER_FACILITY_CROSS_REF WHERE ordering_facility_id =? AND order_category =? AND order_type_code=? AND ordering_source_type = ? AND ordering_source_code = ? and performing_facility_id=?");
	   dataMap.put("SQL_OR_CATALOG_SPLTY_DESC", "select short_desc description from am_speciality  where  speciality_code like upper(?) ");
	   dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_SPLTY_DESC"," SELECT speciality_code code, short_desc description FROM am_speciality WHERE eff_status='E' AND UPPER(short_desc) LIKE UPPER(?) order by short_desc"); 
	   dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_SPLTY_DESC_OTH"," SELECT speciality_code code,short_desc description FROM  am_speciality  WHERE UPPER(short_desc) NOT BETWEEN UPPER('A%') AND UPPER('_Z%') order by short_desc");
	   dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_CATALOG_DESC_OTH", "SELECT order_catalog_code code, long_desc description,PRI_SPLTY_CODE spec_code FROM or_order_catalog WHERE eff_status='E' AND order_catalog_nature != ('S') AND UPPER(long_desc) NOT BETWEEN UPPER('A%') AND UPPER('_Z%') order by long_desc");
        dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_CATALOG_DESC", "SELECT order_catalog_code code, long_desc description,pri_splty_code spec_code FROM or_order_catalog WHERE eff_status='E' AND order_catalog_nature != ('S') AND UPPER(long_desc) LIKE UPPER(?) order by long_desc");
		dataMap.put("SQL_SPLTY_FOR_ORDERABLE_SPLTY_DB_REC", "SELECT a.ORDER_CATALOG_CODE CODE,b.long_desc description,b.PRI_SPLTY_CODE spec_code FROM AM_CATALOG_FOR_SPECIALITY a,or_order_catalog b WHERE a.order_catalog_code=b.order_catalog_code and  a.SPECIALITY_CODE = ? order by b.short_desc");
		dataMap.put("SQL_SPLTY_FOR_ORDERABLE_SPLTY", "SELECT PRI_SPLTY_CODE spec_code FROM or_order_catalog  WHERE  order_catalog_code=?");
		dataMap.put("SQL_SPLTY_FOR_ORDERABLE_CATALOG_DB_REC", "SELECT a.SPECIALITY_CODE CODE,b.short_desc description FROM AM_CATALOG_FOR_SPECIALITY a,am_speciality b WHERE  a.speciality_code=b.speciality_code and a.ORDER_CATALOG_CODE= ? order by b.short_desc");
		dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_CATALOG","SELECT order_catalog_code code,short_desc description FROM or_order_catalog where eff_status='E' and upper(order_catalog_code) like upper(?) and upper(short_desc) like upper(?) order by 1  "); 
		dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_SPLTY_DELETE", "DELETE FROM AM_CATALOG_FOR_SPECIALITY WHERE  SPECIALITY_CODE = ?");
		dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_DELETE", "DELETE FROM AM_CATALOG_FOR_SPECIALITY WHERE  SPECIALITY_CODE = ? and order_catalog_code=?");
		dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_CATALOG_DELETE", "DELETE FROM AM_CATALOG_FOR_SPECIALITY WHERE ORDER_CATALOG_CODE = ?");
		dataMap.put("SQL_OR_SPLTY_FOR_ORDERABLE_INSERT", "insert into am_catalog_for_speciality (speciality_code ,order_catalog_code,ADDED_BY_ID,ADDED_DATE,ADDED_AT_WS_NO,ADDED_FACILITY_ID,MODIFIED_BY_ID,MODIFIED_DATE,MODIFIED_AT_WS_NO,MODIFIED_FACILITY_ID) values (?,?,?,sysdate,?,?,?,sysdate,?,?)");

		dataMap.put("SQL_OR_PLACE_ORDER_GET_PRACTITIONER","SELECT A.ALLOWED_ID CODE,B.PRACTITIONER_NAME LONG_DESC FROM OR_PLACE_ORD_FOR_OTH_PRACT A,AM_PRACTITIONER B WHERE B.EFF_STATUS='E' AND A.ALLOWED_ID=B.PRACTITIONER_ID AND A.ALLOWED_TYPE= ? ORDER BY 2");
		dataMap.put("SQL_OR_PLACE_ORDER_GET_PRACTITIONER_DESC","SELECT PRACTITIONER_ID CODE,PRACTITIONER_NAME LONG_DESC FROM AM_PRACTITIONER  where EFF_STATUS='E' AND UPPER(practitioner_name) like ? order by 2");
		dataMap.put("SQL_OR_PLACE_ORDER_GET_PRACTITIONER_DESC_OTH","SELECT PRACTITIONER_ID CODE,PRACTITIONER_NAME LONG_DESC FROM AM_PRACTITIONER  where EFF_STATUS='E' AND UPPER(practitioner_name) NOT BETWEEN 'A' AND 'ZZ' ORDER BY 2");

		dataMap.put("SQL_OR_PLACE_ORDER_GET_PRACT_TYPE","SELECT A.ALLOWED_ID CODE, NVL(B.DESC_USERDEF,B.DESC_SYSDEF)LONG_DESC FROM OR_PLACE_ORD_FOR_OTH_PRACT A,AM_PRACT_TYPE B WHERE B.EFF_STATUS='E' AND A.ALLOWED_ID=B.PRACT_TYPE AND A.ALLOWED_TYPE= ? ORDER BY 2");
		dataMap.put("SQL_OR_PLACE_ORDER_GET_SELECTED_PRACT_TYPES", "SELECT ALLOWED_ID CODE FROM OR_PLACE_ORD_FOR_OTH_PRACT WHERE ALLOWED_TYPE= ?");

		dataMap.put("SQL_OR_PLACE_ORDER_GET_RESPONSIBILITY","SELECT A.ALLOWED_ID CODE, B.RESP_NAME LONG_DESC FROM OR_PLACE_ORD_FOR_OTH_PRACT A,SM_RESP B where B.EFF_STATUS='E' AND A.ALLOWED_ID=B.RESP_ID AND A.ALLOWED_TYPE= ? order by 2");
		dataMap.put("SQL_OR_PLACE_ORDER_GET_RESPONSIBILITY_DESC","SELECT RESP_ID CODE, RESP_NAME LONG_DESC FROM SM_RESP where EFF_STATUS='E' AND UPPER(RESP_NAME) like ? order by 2");
		dataMap.put("SQL_OR_PLACE_ORDER_GET_RESPONSIBILITY_DESC_OTH","SELECT RESP_ID CODE, RESP_NAME LONG_DESC FROM SM_RESP where EFF_STATUS='E' AND UPPER(RESP_NAME) NOT BETWEEN 'A' AND 'ZZ' ORDER BY 2");

		dataMap.put( "SQL_OR_PLACE_ORDER_FOR_OTH_PRACT_DELETE","DELETE FROM OR_PLACE_ORD_FOR_OTH_PRACT WHERE ALLOWED_TYPE = ? AND ALLOWED_ID = ?");
		dataMap.put( "SQL_OR_PLACE_ORDER_FOR_OTH_PRACT_TYPE_DELETE","DELETE FROM OR_PLACE_ORD_FOR_OTH_PRACT WHERE ALLOWED_TYPE = ?");
		dataMap.put( "SQL_OR_PLACE_ORDER_FOR_OTH_PRACT_INSERT","INSERT INTO OR_PLACE_ORD_FOR_OTH_PRACT (ALLOWED_TYPE,ALLOWED_ID, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put("SQL_OR_DEPT_ONLY_CATALOG_APPL_GET_PRACT_TYPE", "SELECT PRACT_TYPE CODE, NVL(DESC_USERDEF,DESC_SYSDEF)LONG_DESC FROM AM_PRACT_TYPE WHERE  EFF_STATUS ='E'");
		
		dataMap.put( "SQL_OR_DEPT_ONLY_CATALOG_APPL_DELETE","DELETE FROM OR_DEPT_ONLY_CATALOG_APPL WHERE PRACT_TYPE = ? ");
		dataMap.put( "SQL_OR_DEPT_ONLY_CATALOG_APPL_INSERT","INSERT INTO OR_DEPT_ONLY_CATALOG_APPL (PRACT_TYPE,ORDER_CATEGORY_CODE, ADDED_BY_ID, ADDED_DATE, ADDED_AT_WS_NO, ADDED_FACILITY_ID, MODIFIED_BY_ID, MODIFIED_DATE, MODIFIED_AT_WS_NO, MODIFIED_FACILITY_ID) VALUES (?, ?, ?, SYSDATE, ?, ?, ?, SYSDATE, ?, ?)");
		dataMap.put( "SQL_OR_DEPT_ONLY_CATALOG_APPL_GET_CATEGORY","SELECT ORDER_CATEGORY_CODE SHORT_DESC FROM OR_DEPT_ONLY_CATALOG_APPL WHERE PRACT_TYPE = ? ");
		dataMap.put( "SQL_OR_CHECK_PLACE_OTH_YN","select OR_CHECK_PLACE_OTH_YN(?,?,?) or_check_place_oth_yn from dual");
		dataMap.put("SQL_OR_CHECK_SPLTY_FORCE_AUTH","call  OR_CHECK_SPLTY_FORCE_AUTH(?,?,?,?,?,?,?)");
		dataMap.put( "SQL_OR_PAT_SPLTY_CODE","select specialty_code specialty_code from pr_encounter where  encounter_id=? and facility_id=?");
		dataMap.put( "SQL_OR_GET_PRACT_SPEC_CODE","select primary_speciality_code pract_spec_code from am_practitioner where practitioner_id=?");
		dataMap.put("SQL_OR_DISPLAY_CHARTING","select  b.PANEL_DISP_ORDER_SEQ,b.DISCR_DISP_ORDER_SEQ,a.TEST_OBSERV_DT_TM ,a.DISCR_MSR_PANEL_OR_FORM_ID CHART_GROUP_ID, a.DISCR_MSR_ID, a.NORM_ABNORM_IND , to_char(a.TEST_OBSERV_DT_TM,'dd/mm/yyyy hh24:mi') dt   , a.DISCR_MSR_RESULT_TYPE, a.DISCR_MSR_RESULT_NUM , a.DISCR_MSR_RESULT_NUM_UOM ,a.DISCR_MSR_RESULT_STR, a.RESULT_NUM_PREFIX, a.TEST_OBSERV_DT_TM, (select DECODE(a.NORM_ABNORM_IND,HIGH_STR,HIGH_COLOR_CODE,LOW_STR,low_color_code,CRIT_STR,crit_color_code,ABN_STR,ABN_COLOR_CODE,CRIT_HIGH_STR,CRIT_HIGH_COLOR_CODE,CRIT_LOW_STR  ,CRIT_LOW_COLOR_CODE,'') FROM CR_CLIN_EVENT_PARAM) normal_range_color,to_char(NORMAL_LOW) NORMAL_LOW ,to_char(NORMAL_HIGH) NORMAL_HIGH , to_char(CRITICAL_LOW) CRITICAL_LOW ,to_char(CRITICAL_HIGH) CRITICAL_HIGH from CA_ENCNTR_DISCR_MSR a,   CA_CHART_SECTION_COMP B   where  nvl(a.ERROR_YN,'N') != 'Y' and a.chart_id=b.chart_id and a.DISCR_MSR_PANEL_OR_FORM_ID=b.PANEL_ID and a.discr_msr_id=b.discr_msr_id and a.DISCR_MSR_RESULT_TYPE in ('C','D','E','N','A','I','L','F','H','T') and a.CONTR_MODULE_TRANS_REF=?  order by  1,2,3");

		dataMap.put("SQL_OR_ORDER_LINE_NUM","select order_line_num from or_order_line where order_id=?");
		dataMap.put("SQL_OR_EXISTING_ORDER_COLOR","SELECT high_str_desc,high_color_code,low_str_desc,low_color_code,abn_str_desc,abn_color_code,crit_str_desc,crit_color_code,crit_high_str_desc,crit_high_color_code,crit_low_str_desc,crit_low_color_code,DELTA_FAIL_STR FROM cr_clin_event_param");
		
		dataMap.put("SQL_OR_MULTI_ORDER_BILL_DETAILS","SELECT b.order_id,order_line_num, b.order_type_code order_type_code, b.order_category order_category, patient_id, patient_class, ordering_facility_id, encounter_id, b.ord_auth_reqd_yn ord_auth_reqd_yn, ord_auth_by_pract_id,b.ord_appr_reqd_yn ord_appr_reqd_yn, ord_appr_by_user_id, b.ord_consent_reqd_yn ord_consent_reqd_yn, ord_consent_by_id, c.bill_yn bill_yn, b.cont_order_ind cont_order_ind, performing_facility_id, b.result_auth_reqd_yn result_auth_reqd_yn, b.order_catalog_code order_catalog_code, catalog_desc, order_qty, TO_CHAR (b.start_date_time, 'dd/mm/yyyy hh24:mi') start_date_time,  contr_mod_id FROM or_order a, or_order_line b, or_order_catalog c WHERE  b.order_id = a.order_id AND b.order_catalog_code = c.order_catalog_code and c.bill_yn='Y' and a.patient_id=? and a.encounter_id=? and a.patient_class=? and a.ORDERING_FACILITY_ID=? order by order_id");
		dataMap.put("SQL_OR_RESULT_ENTRY_FREQ_AUTO_CLOSE","call  OR_UPDATE_PREV_ORD_STATUS(?,?,?)");
		dataMap.put("SQL_OR_DISPLAY_CHARTING_DATES","SELECT  distinct to_char(a.TEST_OBSERV_DT_TM,'dd/mm/yyyy hh24:mi'),to_char(a.TEST_OBSERV_DT_TM,'dd/mm/yyyy hh24:mi') dt,'N' DISCR_MSR_RESULT_TYPE  from CA_ENCNTR_DISCR_MSR a ,  CA_CHART_SECTION_COMP B  where nvl(a.ERROR_YN,'N') != 'Y' and a.chart_id=b.chart_id and a.DISCR_MSR_PANEL_OR_FORM_ID=b.PANEL_ID and a.discr_msr_id=b.discr_msr_id and a.DISCR_MSR_RESULT_TYPE in('C','D','E','N','A','I','L','F','H','T')   and CONTR_MODULE_TRANS_REF = ?");
        dataMap.put("SQL_OR_ORDER_CATEG_LIST_AWC8", "SELECT  short_desc,order_category FROM or_order_category_lang_vw  WHERE language_id=? and order_category !='CS' ORDER BY short_desc");
		dataMap.put("SQL_OR_ORDER_TYPE_ORD_CATEGORY_SELECT", "SELECT short_desc,order_category,long_desc,result_applicable_yn,freq_applicable_yn,freq_update_allow_yn,soft_stop_applicable_yn,soft_stop_update_allow_yn,cont_order_applicable_yn,cont_order_update_allow_yn FROM or_order_category_lang_vw where language_id=? order by short_desc");
		dataMap.put("SQL_OR_RESULT_ENTRY_COUNT_RESULT_DETAIL_PROC","select count(*) total  FROM or_result_detail_proc WHERE order_id =?");
		//dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_CATALOG","SELECT   b.discr_msr_id discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.short_desc event_group_desc,  b.short_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         am_discr_msr b,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ?      AND b.result_type != 'Z' AND a.discr_msr_panel_id = b.discr_msr_id AND g.term_set_id = f.proc_coding_scheme      AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   c.discr_msr_id, (c.order_srl_no / 1000 + a.order_line_num) srl_no,c.order_srl_no parent_srl_no, b.short_desc event_group_desc,d.short_desc event_desc, a.order_catalog_code order_catalog_code,         a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,         e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,         f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,am_discr_msr b,am_discr_msr_battery c,am_discr_msr d,mr_term_code e,         or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ? AND a.discr_msr_panel_id = b.discr_msr_id AND b.result_type = 'Z' AND b.discr_msr_id = c.discr_msr_battery_id AND d.discr_msr_id = c.discr_msr_id AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme     AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.chart_result_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no,b.chart_result_type_desc event_group_desc,         b.chart_result_type_desc event_desc,a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         or_chart_result_type b,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g   WHERE a.order_id = ? AND a.discr_msr_panel_id = b.chart_result_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.note_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.note_type_desc event_group_desc,         b.note_type_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         ca_note_type b,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ?      AND a.discr_msr_panel_id = b.note_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code");//Modified by Uma on 6/15/2009 for IN011468
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_CATALOG","SELECT   b.discr_msr_id discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.short_desc event_group_desc,  b.short_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         am_discr_msr b,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ?      AND b.result_type != 'Z' AND a.discr_msr_panel_id = b.discr_msr_id AND g.term_set_id = f.proc_coding_scheme      AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code and a.chart_result_type!='M'  UNION ALL SELECT   c.discr_msr_id, (c.order_srl_no / 1000 + a.order_line_num) srl_no,c.order_srl_no parent_srl_no, b.short_desc event_group_desc,d.short_desc event_desc, a.order_catalog_code order_catalog_code,         a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,         e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,         f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,am_discr_msr b,am_discr_msr_battery c,am_discr_msr d,mr_term_code e,         or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ? AND a.discr_msr_panel_id = b.discr_msr_id AND b.result_type = 'Z' AND b.discr_msr_id = c.discr_msr_battery_id AND d.discr_msr_id = c.discr_msr_id AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme     AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.chart_result_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no,b.chart_result_type_desc event_group_desc,         b.chart_result_type_desc event_desc,a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         or_chart_result_type b,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g   WHERE a.order_id = ? AND a.discr_msr_panel_id = b.chart_result_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.note_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.note_type_desc event_group_desc,         b.note_type_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, f.default_yn default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         ca_note_type b,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ?      AND a.discr_msr_panel_id = b.note_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code");
		//dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURES_LINK","SELECT   b.discr_msr_id discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.short_desc event_group_desc,         b.short_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, NVL((SELECT 'Y' FROM or_result_detail_proc WHERE order_id = a.order_id AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,         f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,         g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,am_discr_msr b,         mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ? AND b.result_type != 'Z' AND a.discr_msr_panel_id = b.discr_msr_id AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y'      AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   c.discr_msr_id, (c.order_srl_no / 1000 + a.order_line_num) srl_no,c.order_srl_no parent_srl_no, b.short_desc event_group_desc,         d.short_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, NVL((SELECT 'Y'  FROM or_result_detail_proc WHERE order_id = a.order_id  AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,         g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,am_discr_msr b,         am_discr_msr_battery c,am_discr_msr d,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g    WHERE a.order_id = ? AND a.discr_msr_panel_id = b.discr_msr_id AND b.result_type = 'Z' AND b.discr_msr_id = c.discr_msr_battery_id AND d.discr_msr_id = c.discr_msr_id AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code      AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.chart_result_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no,         b.chart_result_type_desc event_group_desc,b.chart_result_type_desc event_desc,a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, NVL((SELECT 'Y' FROM or_result_detail_proc     WHERE order_id = a.order_id AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn     FROM or_order_line_vw a,or_chart_result_type b,mr_term_code e,or_order_catalog_proc_link f,         mr_term_set g WHERE a.order_id = ? AND a.discr_msr_panel_id = b.chart_result_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code      AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.note_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.note_type_desc event_group_desc,b.note_type_desc event_desc, a.order_catalog_code order_catalog_code,         a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,         e.short_desc procedure_desc, NVL((SELECT 'Y' FROM or_result_detail_proc WHERE order_id = a.order_id  AND proc_coding_scheme = f.proc_coding_scheme  AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         ca_note_type b, mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ?      AND a.discr_msr_panel_id = b.note_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code");//Modified by Uma on 6/15/2009 for IN011468
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURES_LINK","SELECT   b.discr_msr_id discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.short_desc event_group_desc,         b.short_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, NVL((SELECT 'Y' FROM or_result_detail_proc WHERE order_id = a.order_id AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,         f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,         g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,am_discr_msr b,         mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ? AND b.result_type != 'Z' AND a.discr_msr_panel_id = b.discr_msr_id AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y'      AND f.order_catalog_code = a.order_catalog_code and a.chart_result_type!='M' UNION ALL SELECT   c.discr_msr_id, (c.order_srl_no / 1000 + a.order_line_num) srl_no,c.order_srl_no parent_srl_no, b.short_desc event_group_desc,         d.short_desc event_desc, a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, NVL((SELECT 'Y'  FROM or_result_detail_proc WHERE order_id = a.order_id  AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,         g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,am_discr_msr b,         am_discr_msr_battery c,am_discr_msr d,mr_term_code e,or_order_catalog_proc_link f,mr_term_set g    WHERE a.order_id = ? AND a.discr_msr_panel_id = b.discr_msr_id AND b.result_type = 'Z' AND b.discr_msr_id = c.discr_msr_battery_id AND d.discr_msr_id = c.discr_msr_id AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code      AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.chart_result_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no,         b.chart_result_type_desc event_group_desc,b.chart_result_type_desc event_desc,a.order_catalog_code order_catalog_code,a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,e.short_desc procedure_desc, NVL((SELECT 'Y' FROM or_result_detail_proc     WHERE order_id = a.order_id AND proc_coding_scheme = f.proc_coding_scheme AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn     FROM or_order_line_vw a,or_chart_result_type b,mr_term_code e,or_order_catalog_proc_link f,         mr_term_set g WHERE a.order_id = ? AND a.discr_msr_panel_id = b.chart_result_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code      AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code UNION ALL SELECT   b.note_type discr_msr_id, order_line_num line_srl_num,order_line_num parent_srl_no, b.note_type_desc event_group_desc,b.note_type_desc event_desc, a.order_catalog_code order_catalog_code,         a.proc_link_applicable proc_link_applicable,a.proc_link_resulting_option proc_link_resulting_option,         e.short_desc procedure_desc, NVL((SELECT 'Y' FROM or_result_detail_proc WHERE order_id = a.order_id  AND proc_coding_scheme = f.proc_coding_scheme  AND proc_code_resulted = f.proc_code and rownum=1),'N') default_yn,f.proc_code proc_code, e.long_desc long_desc,f.proc_coding_scheme proc_coding_scheme,g.term_set_desc term_set_desc, 'N' enable_yn FROM or_order_line_vw a,         ca_note_type b, mr_term_code e,or_order_catalog_proc_link f,mr_term_set g WHERE a.order_id = ?      AND a.discr_msr_panel_id = b.note_type AND g.term_set_id = f.proc_coding_scheme AND e.term_set_id = f.proc_coding_scheme AND e.term_code = f.proc_code AND e.procedure_yn = 'Y' AND f.order_catalog_code = a.order_catalog_code");
		dataMap.put("SQL_OR_GET_ORDER_ID","SELECT f.order_id order_id FROM  OR_ORDER f,or_order_line g	WHERE (f.PARENT_ORDER_ID = ?  or f.order_id=?)  and f.order_id=g.order_id");
		dataMap.put("SQL_OR_REPORT_AUTHORIZATION_GET_PARENT_ORDERS","select parent_order_id,parent_order_line_num from or_order_line where order_id=? and order_line_num=?");
		dataMap.put("SQL_OR_REPORT_AUTHORIZATION_GET_PARENT_ORDERS_STATUS","select  or_get_parent_ord_status(?) parent_order_status from dual");
		dataMap.put("SQL_OR_REPORT_AUTHORIZATION_UPDATE_PARENT_ORDER_LINE","UPDATE OR_ORDER_LINE SET ORDER_LINE_STATUS = ? , RESULT_LINE_STATUS=? ,modified_by_id =(?),modified_date  = sysdate,modified_at_ws_no=(?),modified_facility_id=(?) WHERE ORDER_ID=? and order_line_num=?");
		dataMap.put("SQL_OR_EXISTING_ORDER_SECONDARY_ORDER_SELECT","select TO_CHAR(start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,or_get_desc.or_order_catalog(order_catalog_code,?,'2') description,sec_order_stage order_stage,'O' pri_sec_tasks_type from or_order_line  where pri_order_id=?  union select TO_CHAR(status_date,'dd/mm/yyyy hh24:mi') start_date_time,ca_get_desc.ca_intervention (task_code,?,'2') description,order_stage order_stage,'I' PRI_SEC_TASKS_TYPE from ca_pat_task_list  where order_id=?");
		dataMap.put("SQL_OR_EXTERNAL_ORDER_CATALOG_NATURE_ORDER_TYPE","select order_catalog_nature order_catalog_nature,order_type_code order_type_code  from or_order_catalog where order_catalog_code=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_HEADER_STATUS","select order_status_code from  or_order_status_code where order_status_type  in(select min(order_status_type) from or_order_status_code where order_status_code in(");

		dataMap.put( "SQL_OR_ORDER_ENTRY_ORDER_SET_BILL_DETAILS","SELECT SHORT_DESC order_set_desc, BILL_YN bill_yn FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_EMAIL","call APPFAXMAIL.FAX_MAIL_REPORT (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_OR_ORDER_ENTRY_EMAIL_PWD","select Translate(PATIENT_NAME,'~!@#$%^&*','          ' ) pat_name, app_password.encrypt(?) enc_pwd,email_id mailid,(select subject_text from SM_REPORT_MAIL_INFO where report_id=?) mailsubject from mp_patient where patient_id = ?");
		dataMap.put("SQL_OR_ORDER_ENTRY_EMAIL_CATALOG_DESC","select OR_GET_DESC.OR_ORDER_CATALOG(order_catalog_code,?,'2') order_catalog_desc from or_order_catalog  where order_catalog_code=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_CARE_SET", "SELECT  OR_GET_DESC.OR_ORDER_CATALOG(a.order_catalog_code,?,'2')order_catalog_desc  FROM or_order_set_component a WHERE  order_set_code = ?");
		dataMap.put("SQL_OR_ORDER_ENTRY_FUTURE_ORDER_CHK", "select 'Y' status  from dual where to_date(?,'dd/mm/yyyy hh24:mi') >to_date(?,'dd/mm/yyyy hh24:mi')");
		dataMap.put("SQL_OR_ORDER_ENTRY_GET_ORDER_SET_STATUS_TYPE_CODE", "select order_status_type from  or_order_status_code where order_status_code=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_GET_ORDER_SET_STATUS_TYPE", "select  OR_GET_ORDER_SET_STATUS(?) order_set_status from dual");
		dataMap.put("SQL_OR_ORDER_ENTRY_GET_ORDER_SET_BILL_DETAILS", "select a.order_id order_id,b.order_line_num order_line_num,TO_CHAR(b.start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,b.order_catalog_code order_catalog_code,b.order_qty order_qty,b.bill_yn bill_yn,a.order_category order_category,c.short_desc care_set_catalog_desc 	from or_order a,or_order_line b,or_order_catalog c where a.order_id=b.order_id and b.order_catalog_code=c.order_catalog_code and a.order_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_GET_ORDER_SET_ID", "select order_set_id from or_order where order_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_UPDATE_ORDER_SET_STATUS", "update or_order set order_status=? where order_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_UPDATE_ORDER_SET_LINE_STATUS", "update or_order_line  set order_line_status=? where order_id=? and order_line_num=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_ADHOC_DISCOUNT_ALLOWED", "Select BL_PROC_ITEM_VALIDATIONS_MP.Is_ADHOC_DISCOUNT_ALLOWED(?) allow_yn  from dual");
		dataMap.put("SQL_OR_ORDER_ENTRY_EMAIL_DISPLAY_DETAILS", "select EVENT_NAME EVENT_NAME,EVENT_DESC EVENT_DESC,event_hdr event_hdr  from CA_CONFIG_EMAIL_FORMAT  where report_id=? and event_status='Y' order by srl_no ");
		dataMap.put("SQL_OR_ORDER_ENTRY_EMAIL_DISPLAY_DATA_DETAILS", "select b.SPECIALTY_DESC speciality_desc,a.email_id mail_id,a.patient_name patient_name,a.national_id_no,b.VISIT_ADM_DATE_TIME VISIT_DATE,b.ASSIGN_CARE_LOCN_TYPE, case when ? in ('IP','DC') then ip_get_desc.ip_nursing_unit(?,b.ASSIGN_CARE_LOCN_CODE,?,'2') else op_get_desc.op_clinic(?,b.ASSIGN_CARE_LOCN_CODE,?,'2') end  location_description,case when ? in ('IP','DC') then ip_get_desc.ip_nursing_unit(?,?,?,'2') else op_get_desc.op_clinic(?,?,?,'2') end ordering_location  from mp_patient a,pr_encounter_vw b where a.patient_id=b.patient_id and b.encounter_id=? and a.patient_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_EMAIL_DISPLAY_EXT_DATA_DETAILS", "select null speciality_desc,email_id mail_id,patient_name patient_name,national_id_no,null VISIT_DATE, 'R' ASSIGN_CARE_LOCN_TYPE, null  location_description, null ordering_location  from mp_patient where patient_id=?");
		dataMap.put("SQL_OR_ORDER_ENTRY_EMAIL_DISPLAY_BODY_DATA_DETAILS", "select Sm_Get_Mail_Body(?,?,?,?,?,?,?,?,?,?) editor_content from dual");
		dataMap.put("SQL_OR_ORDER_ENTRY_VIEW_BILL_CATALOG_DETAILS", "SELECT order_line_num, b.order_type_code order_type_code, b.order_category order_category, patient_id, patient_class, ordering_facility_id, encounter_id, b.ord_auth_reqd_yn ord_auth_reqd_yn, ord_auth_by_pract_id,b.ord_appr_reqd_yn ord_appr_reqd_yn, ord_appr_by_user_id, b.ord_consent_reqd_yn ord_consent_reqd_yn, ord_consent_by_id, b.bill_yn bill_yn, b.cont_order_ind cont_order_ind, performing_facility_id, b.result_auth_reqd_yn result_auth_reqd_yn, b.order_catalog_code order_catalog_code,or_get_desc.or_order_catalog(b.order_catalog_code,?,2)  catalog_desc, order_qty, TO_CHAR (b.start_date_time, 'dd/mm/yyyy hh24:mi') start_date_time,  contr_mod_id FROM or_order a, or_order_line b, or_order_catalog c WHERE a.order_id = ? AND b.order_id = a.order_id AND b.order_catalog_code = c.order_catalog_code AND b.order_type_code = c.order_type_code");
		dataMap.put("SQL_OR_ORDER_ENTRY_ORDER_SET_SEARCH_DETAILS", "SELECT  nvl(b.Priority,'R') priority_desc,    TO_CHAR(a.ord_date_time,'DD/MM/YYYY HH24:MI') order_date_time , OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,2)  order_catalog_detail, b.order_catalog_code catalog_code,b.priority priority, OR_GET_DESC.OR_ORDER_TYPE(b.order_type_code,?,'2')order_type_short_desc, nvl(am_get_desc.am_practitioner (a.ord_pract_id,?,'1'), am_get_desc.am_ext_practitioner (a.ord_pract_id,?,'1')) ordering_pract_name, OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,?,'2') order_status_short_desc  FROM or_order_vw a, or_ordeR_line b  WHERE  a.ordeR_id =b.ordER_id  and a.order_set_id = ?");
		dataMap.put("SQL_OR_ORDER_ENTRY_EXTERNAL_ORDER_OR_GET_BILL_DOC_TYPE", "CALL   OR_GET_BILL_DOC_TYPE(?,?,?,?,?,?,?,?,?,?,?,?,?,?)"); //Added Against AMS-SCF-0780.1 by Gomathi on 01/04/2021
		//dataMap.put("SQL_OR_ORDER_ENTRY_EXTERNAL_ORDER_OR_GET_BILL_DOC_TYPE", "CALL   OR_GET_BILL_DOC_TYPE(?,?,?,?,?,?,?,?,?,?,?)");
		//Muti Patients Result Reporting Queries Starts Added by Uma on 7/1/2009 for IN09079
		dataMap.put("SQL_OR_GET_DATE_RANGE","select to_char(sysdate -?,'dd/mm/yyyy hh24:mi') start_date, to_char(SYSDATE - ?,'dd/mm/yyyy hh24:mi') end_date FROM dual");
		dataMap.put( "SQL_OR_CATALOG_ORDER_CATEGORY_MULTI_RESULT","SELECT or_get_desc.or_order_category(order_category,?,'2') SHORT_DESC,ORDER_CATEGORY FROM OR_ORDER_CATEGORY where ORDER_CATEGORY not in('CS','CN') AND MULTI_PAT_RESULT_APPL_YN ='Y' ORDER BY SHORT_DESC");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_CATALOG_LOOKUP","SELECT ORDER_CATALOG_CODE CODE,or_get_desc.or_order_catalog(order_catalog_code,?,'2')  DESCRIPTION FROM OR_ORDER_CATALOG WHERE ORDER_CATEGORY = ? AND ORDER_TYPE_CODE = NVL(?, ORDER_TYPE_CODE) AND ORDER_CATALOG_CODE LIKE UPPER(?) AND UPPER(SHORT_DESC) LIKE UPPER(?) order by 2");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_FORMAT_ITEM_LOOKUP","SELECT DISTINCT A.SHORT_DESC DESCRIPTION,A.DISCR_MSR_ID CODE FROM AM_DISCR_MSR A, OR_ORDER_CATALOG B WHERE B.CHART_RESULT_TYPE IN ('P','D') AND B.ORDER_CATEGORY = ? AND B.ORDER_TYPE_CODE=NVL (?, ORDER_TYPE_CODE) AND B.DISCR_MSR_PANEL_ID=A.DISCR_MSR_ID AND A.DISCR_MSR_ID LIKE UPPER(?) AND UPPER(A.SHORT_DESC) LIKE UPPER(?) ORDER BY 1");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_FORMAT_ITEM_VALUES","SELECT distinct A.SHORT_DESC DESCRIPTION,A.DISCR_MSR_ID CODE,B.CHART_RESULT_TYPE RESULT_TYPE FROM (SELECT DISTINCT order_catalog_code FROM or_order_line ia, or_order ib WHERE ib.order_id=ia.order_id and ia.START_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND TO_DATE(?,'DD/MM/YYYY HH24:MI') and ia.START_DATE_TIME<=SYSDATE AND NVL(ia.CONT_ORDER_IND,'CO') IN ('CO','DO','DS') AND ia.order_line_status IN   ('RG', 'VF', 'RV', 'RC', 'IP')    AND ia.ORDER_CATEGORY=?  AND ia.order_type_code = NVL (?, ia.order_type_code)  AND ia.ORDER_CATALOG_CODE=NVL(?,ia.ORDER_CATALOG_CODE) AND ib.patient_class like decode(?, 'N', 'IP', 'D' ,'DC', '%') and ib.ORDERING_FACILITY_ID=? AND (ib.ENCOUNTER_ID IN (SELECT ENCOUNTER_ID FROM IP_OPEN_ENCOUNTER WHERE FACILITY_ID=? AND NURSING_UNIT_CODE=NVL(?,NURSING_UNIT_CODE)))) o, AM_DISCR_MSR A, OR_ORDER_CATALOG B WHERE b.order_catalog_code = o.order_catalog_code AND B.CHART_RESULT_TYPE IN ('P','D') AND B.DISCR_MSR_PANEL_ID=A.DISCR_MSR_ID ORDER BY 1");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_FORMAT_TYPE","SELECT RESULT_TYPE FROM AM_DISCR_MSR WHERE DISCR_MSR_ID = ?");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_ORDER_VALUES","SELECT A.ORDER_ID ORDER_ID,A.ORDER_LINE_NUM ORDER_LINE_NUM, A.ORDER_CATALOG_CODE CATALOG_CODE, or_get_desc.or_order_catalog(a.order_catalog_code,?,2) catalog_desc, TO_CHAR(START_DATE_TIME,'DD/MM/YYYY HH24:MI') START_DATETIME,b.ENCOUNTER_ID ENCOUNTER_ID, b.PATIENT_CLASS PATIENT_CLASS,B.PATIENT_ID PATIENT_ID,decode(?,'en',d.patient_name,nvl(d.patient_name_loc_lang,d.patient_name)) patient_name,B.PERFORMING_DEPTLOC_TYPE LOCATION_TYPE,B.PERFORMING_DEPTLOC_CODE LOCATION_CODE,NVL((SELECT CASE WHEN PATIENT_CLASS IN ('IP','DC') THEN (SELECT ip_get_desc.ip_nursing_unit(?,ASSIGN_CARE_LOCN_CODE,?,'2') ||','||ASSIGN_ROOM_NUM||'/'||ASSIGN_BED_NUM FROM IP_NURSING_UNIT WHERE FACILITY_ID=PR_ENCOUNTER.FACILITY_ID AND NURSING_UNIT_CODE=PR_ENCOUNTER.ASSIGN_CARE_LOCN_CODE)  WHEN b.PATIENT_CLASS IN ('AE','OP') THEN (SELECT op_get_desc.op_clinic(?,ASSIGN_CARE_LOCN_CODE,?,'2') short_desc FROM OP_CLINIC WHERE FACILITY_ID=PR_ENCOUNTER.FACILITY_ID AND CLINIC_CODE=PR_ENCOUNTER.ASSIGN_CARE_LOCN_CODE) END FROM PR_ENCOUNTER WHERE FACILITY_ID=B.ORDERING_FACILITY_ID AND  ENCOUNTER_ID=B.ENCOUNTER_ID ),'External') LOCATION_NAME, A.ORDER_TYPE_CODE ORDER_TYPE_CODE,d.SEX SEX FROM OR_ORDER_LINE A, OR_ORDER B, OR_ORDER_CATALOG C,mp_patient d  WHERE a.order_line_status IN ('RG', 'VF', 'RV', 'RC', 'IP') AND  A.ORDER_ID=B.ORDER_ID AND A.ORDER_CATALOG_CODE = NVL (?, A.ORDER_CATALOG_CODE) AND A.ORDER_CATEGORY = ? AND A.ORDER_TYPE_CODE = Nvl(?,A.ORDER_TYPE_CODE) AND C.ORDER_CATALOG_CODE = A.ORDER_CATALOG_CODE and b.patient_id=d.patient_id AND C.DISCR_MSR_PANEL_ID = ? AND A.START_DATE_TIME BETWEEN TO_DATE(?,'DD/MM/YYYY HH24:MI') AND  TO_DATE(?,'DD/MM/YYYY HH24:MI') and A.START_DATE_TIME<=SYSDATE  AND NVL(A.CONT_ORDER_IND,'CO') IN ('CO','DO','DS') AND b.patient_class like decode(?, 'N', 'IP', 'D' ,'DC', '%')  and b.ORDERING_FACILITY_ID=? AND (b.ENCOUNTER_ID IN (SELECT ENCOUNTER_ID FROM IP_OPEN_ENCOUNTER WHERE FACILITY_ID=? AND NURSING_UNIT_CODE=NVL(?,NURSING_UNIT_CODE)))");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_DISCRETE_PANEL_VALUES","SELECT DISCR_MSR_ID DISCR_MSR_ID, SHORT_DESC DESCRIPTION, RESULT_TYPE RESULT_TYPE,NUM_DIGITS_MAX MAX_DIGITS, NUM_DIGITS_MIN MIN_DIGITS, NUM_DIGITS_DEC DEC_DIGITS,REF_RANGE_TYPE,UNIT_OF_MEASURE UOM, MANDATORY_YN MANDATORY FROM am_discr_msr_battery_view WHERE DISCR_MSR_BATTERY_ID = ? ORDER BY ORDER_SRL_NO");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_DISCRETE_MSR_VALUES","SELECT DISCR_MSR_ID DISCR_MSR_ID, SHORT_DESC DESCRIPTION, RESULT_TYPE RESULT_TYPE,NUM_DIGITS_MAX MAX_DIGITS, NUM_DIGITS_MIN MIN_DIGITS, NUM_DIGITS_DEC DEC_DIGITS ,REF_RANGE_TYPE FROM am_discr_msr WHERE DISCR_MSR_ID = ?");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_LIST_TYPE_VALUES","SELECT REF_RNG_DESC DESCRIPTION, REF_RANGE_SEQ SEQ FROM AM_DISCR_MSR_REF_RNG_LIST WHERE DISCR_MSR_ID =?");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_AUTH_REQD_YN","SELECT RESULT_AUTH_REQD_YN L_RESULT_AUTH_REQD_YN  FROM OR_ORDER_CATALOG WHERE ORDER_CATALOG_CODE = ?");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_LINE_VALUE","SELECT ORDER_ID ORDER_ID FROM OR_RESULT_HEADER WHERE ORDER_ID = ? AND REPORT_SRL_NO = 1");
		//dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_LINE_COUNT","SELECT COUNT(*) FROM OR_ORDER_LINE WHERE ORDER_ID = ?");
		//dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_HDR_UPDATE","UPDATE OR_RESULT_HEADER SET RESULT_STATUS = ? WHERE ORDER_ID= ?");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_GET_PARENT_LAST_CHILD","SELECT COUNT(1) FROM OR_ORDER_LINE O WHERE PARENT_ORDER_ID=? AND (ORDER_ID,ORDER_LINE_NUM) not in (select ?,? from dual) AND EXISTS (SELECT 1 FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_CODE=O.ORDER_LINE_STATUS AND ORDER_STATUS_TYPE<'85')");
		dataMap.put("SQL_OR_MULTI_PATIENT_RESULTING_GET_LINE_EXISTS_COUNT","SELECT COUNT(1) COUNT FROM OR_ORDER_LINE O WHERE ORDER_ID=? AND ORDER_LINE_NUM!=? AND EXISTS (SELECT 1 FROM OR_ORDER_STATUS_CODE WHERE ORDER_STATUS_CODE=O.ORDER_LINE_STATUS AND ORDER_STATUS_TYPE<'85')");
		dataMap.put("SQL_OR_ORDER_ENTRY_BILLING_VALIDATE_MESSAGE","call BL_ORDER_BILLED_YN (?,?,?,?,?,?)");
		//Muti Patients Result Reporting Queries Ends Added by Uma on 7/1/2009 for IN09079
		dataMap.put("SQL_OR_ORDER_ENTRY_PH_SLIDING_SCALE_YN","select sliding_scale_yn from or_order_line_ph where order_id =? and order_line_num =?");
		dataMap.put("SQL_OR_ORDER_CATALOG_CONSENT_DTL_CNT","select count(*) cnt_consent from OR_CATALOG_CONSENT_DTL where consent_stage=? and order_catalog_code=?");//Added by Uma on 5/27/2009 for IN009802
		dataMap.put("SQL_OR_INDEX_TICK_SHEET_REC_CNT","SELECT 1 FROM OR_TICK_SHEET_BY_INDEX WHERE ORDER_CATEGORY =? AND TICK_SHEET_ID =? AND INDEX_TYPE = ?  ##FILTER$$ ");//Added by Uma for IN10556 on 5/25/2009			
		dataMap.put("SQL_OR_ORDER_ENTRY_LOCATION_CLINICS", "SELECT clinic_code code , short_desc  description FROM op_clinic_lang_vw WHERE language_id=? AND eff_status='E' AND clinic_code like UPPER(NVL(?,clinic_code)) AND UPPER(short_desc) LIKE UPPER(NVL(?,short_desc))");//Added by Uma for IN011116 on 6/8/2009
		dataMap.put("SQL_OR_ORDER_GET_CHART_RESULT", "SELECT  OR_GET_CHART_RESULT(?,?) chart_result from dual");//Added by Uma for IN011277 on 6/16/2009
		/*Added by Uma for IN011572 on 6/23/2009*/
		dataMap.put("SQL_OR_TRANSPLANT_DONOR_BLOOD_GROUP", "select BLOOD_GRP code,SHORT_DESC description from   MR_BLOOD_GRP where  EFF_STATUS='E' and BLOOD_GRP like UPPER(NVL(?,BLOOD_GRP)) and upper(short_desc) like upper(nvl(?,short_desc))");
		dataMap.put("SQL_OR_TRANSPLANT_DONOR_RHESUS", "select RHESUS_FACTOR_CODE code,SHORT_DESC description from  MR_RHESUS_FACTOR where  EFF_STATUS='E' and RHESUS_FACTOR_CODE like upper(nvl(?,RHESUS_FACTOR_CODE)) and upper(short_desc) like upper(nvl(?,short_desc)) ");
		dataMap.put("SQL_OR_TRANSPLANT_DONOR_BLOOD_GROUP_DESC", "select SHORT_DESC description from   MR_BLOOD_GRP where  EFF_STATUS='E' and BLOOD_GRP like UPPER(NVL(?,BLOOD_GRP))");
		dataMap.put("SQL_OR_TRANSPLANT_DONOR_RHESUS_DESC", "select SHORT_DESC description from  MR_RHESUS_FACTOR where  EFF_STATUS='E' and RHESUS_FACTOR_CODE like upper(nvl(?,RHESUS_FACTOR_CODE))");
		/*Added by Uma for IN011572 on 6/23/2009*/
		/*Added by Uma on 7/17/2009 for CRF-288,303*/
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_ENCOUNTER_INSERT", "insert into   pr_encounter_procedure(facility_id,encounter_id,srl_no,practitioner_id,patient_id,proc_code,proc_code_scheme,patient_class,order_id,order_line_num,record_type,proc_date,order_category,contr_mod_id,accession_num,code_extn_yn,added_by_id,added_date,added_at_ws_no,added_facility_id,modified_by_id,modified_date,modified_at_ws_no,modified_facility_id) values (?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?)");
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_ENCOUNTER_DELETE", "delete from pr_encounter_procedure where order_id=?");
		dataMap.put("SQL_OR_RESULT_ENTRY_PROCEDURE_LINK_ENCOUNTER_SRL_NO", "select NVL(max(srl_no),0)+1 srl_no from pr_encounter_procedure where facility_id=? and encounter_id=?");
		/*End*/
		/* Added by Uma on 8/18/2009 for PMG20089-640*/
		dataMap.put("SQL_OR_ORDER_ENTRY_FUTURE_ORDER_YN", "select nvl((select to_char(sysdate+nvl(FUTURE_ORDER_PERIOD*decode(FUTURE_ORDER_PERIOD_unit,'M',(1/1440),'H',(1/24),'D',1,'m',30,'Y',365,0),0),'dd/mm/yyyy hh24:mi')  from or_param_by_category_ptcl where ORDER_CATEGORY =(select order_category from or_order_catalog where order_catalog_code=?) and PATIENT_CLASS =?) ,to_char(sysdate,'dd/mm/yyyy hh24:mi')) future_order_date from dual");

		dataMap.put("SQL_OR_FUTURE_ORDER_EXISTING_ORDER_LINK","SELECT   a.order_id order_id,a.order_category,OR_GET_DESC.OR_ORDER_CATEGORY (a.order_category,?,'2')  order_category_short_desc,b.Priority Priority_desc,AM_GET_DESC.AM_PATIENT_CLASS(patient_class, ?,'2') patient_class_short_desc,patient_class, b.order_line_num order_line_num,b.bill_yn bill_yn,b.order_qty order_qty,TO_CHAR(start_date_time,'dd/mm/yyyy hh24:mi') start_date_time,c.CONTR_MOD_ID contr_mod_id,a.patient_id, encounter_id, TO_CHAR(a.ORD_DATE_TIME,'DD/MM/YYYY HH24:MI') order_date_time, OR_GET_DESC.OR_ORDER_CATALOG(b.ORDER_CATALOG_CODE,?,2)  order_detail,b.ORDER_CATALOG_CODE catalog_code,SOURCE_TYPE,SOURCE_CODE,b.Priority,b.ORDER_TYPE_CODE ,                                  a.ORD_PRACT_ID ord_pract_id, AM_GET_DESC.AM_PRACTITIONER(a.ORD_PRACT_ID,?,'1')  ORDERING_PRACT_NAME,ORDER_STATUS,OR_GET_DESC.OR_ORDER_STATUS_CODE(order_line_status,?,'2') order_status_short_desc,  a.ord_consent_reqd_yn, sex,date_of_birth, GET_AGE(DATE_OF_BIRTH) age,nvl(a.cont_order_ind,'DO')   cont_order_ind, a.ord_appr_reqd_yn, ord_appr_by_user_id, a.ord_consent_reqd_yn, ord_consent_by_id,case when a.patient_class in ('IP','DC') then ip_get_desc.ip_nursing_unit(a.ordering_facility_id,a.source_code,?,'2') else op_get_desc.op_clinic(a.ordering_facility_id,a.source_code,?,'2') end  location_description,decode(b.bill_yn,'Y', blcommon.Future_order_exists_wo_charge (a.ordering_facility_id,a.patient_id,'',a.episode_id,a.episode_visit_num,'OR', a.order_id, b.order_line_num),'Y') unbilled_yn FROM or_order a, or_ordeR_line b,or_order_catalog c,mp_patient d  WHERE  a.ordeR_id =b.ordER_id  and b.ORDER_CATALOG_CODE=c.ORDER_CATALOG_CODE and a.patient_id=d.patient_id and ordering_facility_id = (?)  and a.patient_id=(?) and a.order_id=?  /*OR_CHECK_UNBILL_ORD_EXISTS_YN(a.patient_id, ordering_facility_id,a.order_id,b.order_line_num)='Y'*/ and  a.cont_order_ind not in('DR','CR') and ORDER_line_STATUS IN ( SELECT ORDER_STATUS_CODE   FROM OR_ORDER_STATUS_CODE  WHERE ORDER_STATUS_TYPE <'25') order by encounter_id,a.order_id,a.ORD_DATE_TIME desc");
		dataMap.put("SQL_OR_FUTURE_ORDER_NEW_ORDER","call  or_order_linkto_current_encntr(?,?,?,?,?,?,?,?,?,?,?)");
		dataMap.put("SQL_OR_FUTURE_ORDER_CANCEL_LINE","UPDATE  or_order_line SET order_line_status = (SELECT order_Status_code FROM or_order_status_code WHERE order_Status_type =('99')),future_order_yn='N',future_order_charge_later_yn='N', modified_by_id=(?), modified_date=SYSDATE, modified_at_ws_no=(?), modified_facility_id=(?),can_line_reason=(?)  WHERE order_id = (?) AND order_line_num  = (?) ");
		dataMap.put("SQL_OR_FUTURE_ORDER_CANCEL_LINE","UPDATE  or_order_line SET order_line_status = (SELECT order_Status_code FROM or_order_status_code WHERE order_Status_type =('99')),future_order_yn='N',future_order_charge_later_yn='N', modified_by_id=(?), modified_date=SYSDATE, modified_at_ws_no=(?), modified_facility_id=(?),can_line_reason=(?)  WHERE order_id = (?) AND order_line_num  = (?) ");
		/*End by Uma on 8/18/2009 for PMG20089-640*/

		/* Added by Uma on 8/18/2009 for PMG20089-641*/
		dataMap.put("SQL_OR_PARAM_PRIV_TO_AUTHORISE","select allow_priv_to_authorise_yn allow_priv_to_authorise_yn from or_param where module_id='OR'");
		dataMap.put("SQL_OR_POST_ORD_PRIV_REC","call OR_POST_ORD_PRIV_REC(?,?,?)");
		dataMap.put("SQL_OR_POST_CATALOG_PRIV_REC","call OR_POST_CATALOG_PRIV_REC(?,?)");
		dataMap.put("SQL_OR_ASSIGN_PRIVILIEGE_GROUP_BY_PRIVILEGE","Select PRIV_GRP_ID code, PRIV_GRP_DESC description from or_priv_group order by PRIV_GRP_DESC");
		dataMap.put("SQL_OR_ASSIGN_PRIVILEGE_COUNT","select count(*) from OR_PRIV_APPLICABLITY where PRIV_GRP_ID = ? and APPL_MEMB_REF=? and APPL_LEVEL=?");
		dataMap.put("SQL_OR_ASSIGN_PRIVILEGE_TO_PRACTITIONER_DELETE"," DELETE FROM OR_PRIV_APPLICABLITY WHERE  APPL_MEMB_REF = ? and APPL_LEVEL =?");
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_AUTHORISE","select 'Y' auth_reqd_yn FROM OR_ORDER_CATALOG_BY_PTCL WHERE ORDER_CATALOG_CODE=? AND ORD_AUTH_REQD_YN='Y' and rownum=1");
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_ALL_COUNT","select count(*) from OR_PRIV_APPLICABLITY where PRIV_GRP_ID =? and APPL_MEMB_REF='*ALL'");
		dataMap.put("SQL_OR_PRIVILEGE_GROUP_ALL_DELETE","DELETE from OR_PRIV_APPLICABLITY where PRIV_GRP_ID =? and APPL_MEMB_REF='*ALL'");

		
		/* JNDI locations start */																													  
		dataMap.put("OR_REFUSAL_ORDERS_JNDI" ,"java:comp/env/ORRefusalOrders");
		dataMap.put("OR_ORDERS_TAB_JNDI" ,"java:comp/env/OROrdersTab");
		dataMap.put("OR_PRIV_EXCEPTION_GRP_JNDI"	,"java:comp/env/ORPrivilegeExceptionGrp");
		dataMap.put("OR_ORGANISM_JNDI" ,"java:comp/env/OROrganism");
		dataMap.put("OR_ANTIBIOTIC_JNDI" ,"java:comp/env/ORAntibiotic");
		dataMap.put("OR_PRACT_FOR_CONSENT_JNDI" ,"java:comp/env/ORPractForConsent");
		dataMap.put("OR_MULTICONSENT_JNDI" ,"java:comp/env/OROrderCatalogMultiConsent");
		dataMap.put("OR_SPECIMEN_FOR_ORDERABLE_JNDI" ,"java:comp/env/ORSpecimenForOrderable");
		dataMap.put("OR_SPECIALITY_FOR_ORDERABLE_JNDI" ,"java:comp/env/ORSpecialityForOrderable");
		dataMap.put("OR_ASSIGN_PRIVILEGE_GROUP_JNDI" ,"java:comp/env/ORAssignPrivilegeGroup");
		dataMap.put("PRIVILEGE_GROUP_JNDI","java:comp/env/ORPrivilegeGroup");
		dataMap.put("OR_FUTURE_ORDER_JNDI","java:comp/env/ORFutureOrder");
		dataMap.put("CLOSING_PROCESS_ORDER_JNDI","java:comp/env/ORClosingProcess");
		dataMap.put("OR_MULTI_PATIENT_ORDERS_RESULTING_JNDI" ,"java:comp/env/ORMultiPatientOrdersResulting");

		/* JNDI locations end */ 
	}
}
